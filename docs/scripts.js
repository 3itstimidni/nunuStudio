!function(n,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Nunu=o():n.Nunu=o()}(self,()=>(()=>{var __webpack_modules__={872:(n,o,l)=>{"use strict";l(590),l(435),l(806);var x=l(808);o.fG=x.StaticPair},590:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),L=l(285);o.Decoder=class{constructor(D=[],z,M={}){this.dict=D,this.progressive=z,this.options=M}decode(D){D instanceof x||(D=x.wrap(D));const z=D.littleEndian;try{const M=this.decodeValue(D.LE());return D.littleEndian=z,M}catch(M){throw D.littleEndian=z,M}}decodeValue(D){let z=D.readUint8();if(z<=L.MAX)return x.zigZagDecode32(z);switch(z){case L.NULL:return null;case L.TRUE:return!0;case L.FALSE:return!1;case L.EOBJECT:return{};case L.EARRAY:return[];case L.ESTRING:return"";case L.OBJECT:z=D.readVarint32();const M={};for(;--z>=0;)M[this.decodeValue(D)]=this.decodeValue(D);return M;case L.ARRAY:z=D.readVarint32();const P=[];for(;--z>=0;)P.push(this.decodeValue(D));return P;case L.INTEGER:return D.readVarint32ZigZag();case L.LONG:const de=D.readVarint64ZigZag();return de.lessThanOrEqual(Number.MAX_SAFE_INTEGER)&&de.greaterThanOrEqual(Number.MIN_SAFE_INTEGER)?de.toNumber():de;case L.FLOAT:return D.readFloat32();case L.DOUBLE:return D.readFloat64();case L.STRING:return D.readVString();case L.STRING_ADD:const ye=D.readVString();return this.dict.push(ye),ye;case L.STRING_GET:return this.dict[D.readVarint32()];case L.BINARY:z=D.readVarint32();const he=D.slice(D.offset,D.offset+z);return D.offset+=z,he;default:throw new Error(`Illegal type at ${D.offset}: ${z}`)}}}},435:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),L=l(285),D=l(734),z=new x(4);z.compact(0,4),o.Encoder=class{constructor(M=[],P,de){if(this.progressive=P,this.dict=new Map,this.next=0,M)for(;this.next<M.length;)this.dict.set(M[this.next],this.next++)}encode(M,P){let de=!1;P||(P=new x,de=!0);const ye=P.littleEndian;try{return this.encodeValue(M,P.LE()),P.littleEndian=ye,de?P.flip():P}catch(he){throw P.littleEndian=ye,he}}encodeValue(M,P){if(null!==M)switch(typeof M){case"function":M=M.toString();case"string":0===M.length?P.writeUint8(L.ESTRING):this.dict.has(M)?(P.writeUint8(L.STRING_GET),P.writeVarint32(this.dict.get(M))):(P.writeUint8(L.STRING),P.writeVString(M));break;case"number":if(M%1==0)if(M<=2147483647&&M>=-2147483648){const ye=x.zigZagEncode32(M);ye<=L.MAX?P.writeUint8(ye):(P.writeUint8(L.INTEGER),P.writeVarint32ZigZag(M))}else P.writeUint8(L.LONG),P.writeVarint64ZigZag(M);else z.writeFloat32(M,0),M===z.readFloat32(0)?(P.writeUint8(L.FLOAT),P.writeFloat32(M)):(P.writeUint8(L.DOUBLE),P.writeFloat64(M));break;case"boolean":P.writeUint8(M?L.TRUE:L.FALSE);break;case"object":let de;if(Array.isArray(M))if(0===M.length)P.writeUint8(L.EARRAY);else for(P.writeUint8(L.ARRAY),P.writeVarint32(M.length),de=0;de<M.length;de++)this.encodeValue(M[de],P);else if(M instanceof D)P.writeUint8(L.LONG),P.writeVarint64ZigZag(M);else if(M instanceof Buffer||M instanceof ArrayBuffer||M instanceof Uint8Array||M instanceof x)M=x.wrap(M),P.writeUint8(L.BINARY),P.writeVarint32(M.remaining()),P.append(M);else{const ye=Object.keys(M);let he=0;for(de=0;de<ye.length;de++)void 0!==M[ye[de]]&&he++;if(0===he)P.writeUint8(L.EOBJECT);else for(P.writeUint8(L.OBJECT),P.writeVarint32(he),de=0;de<ye.length;de++){const ae=ye[de];void 0!==M[ae]&&(this.dict.has(ae)?(P.writeUint8(L.STRING_GET),P.writeVarint32(this.dict.get(ae))):(this.progressive?(this.dict.set(ae,this.next++),P.writeUint8(L.STRING_ADD)):P.writeUint8(L.STRING),P.writeVString(ae)),this.encodeValue(M[ae],P))}}break;case"undefined":P.writeUint8(L.NULL)}else P.writeUint8(L.NULL)}}},606:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Pair=class{encode(l){return this.encoder.encode(l)}toArrayBuffer(l){return this.encoder.encode(l).toArrayBuffer()}toBuffer(l){return this.encoder.encode(l).toBuffer()}decode(l){return this.decoder.decode(l)}}},806:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),L=l(435),D=l(590);o.ProgressivePair=class z extends x.Pair{constructor(P,de){super(),this.encoder=new L.Encoder(P,!0,de),this.decoder=new D.Decoder(P,!0,de)}}},808:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),L=l(435),D=l(590);o.StaticPair=class z extends x.Pair{constructor(P,de){super(),this.encoder=new L.Encoder(P,!1,de),this.decoder=new D.Decoder(P,!1,de)}}},285:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ZERO=0,o.MAX=239,o.NULL=240,o.TRUE=241,o.FALSE=242,o.EOBJECT=243,o.EARRAY=244,o.ESTRING=245,o.OBJECT=246,o.ARRAY=247,o.INTEGER=248,o.LONG=249,o.FLOAT=250,o.DOUBLE=251,o.STRING=252,o.STRING_ADD=253,o.STRING_GET=254,o.BINARY=255},175:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>ei,AddEquation:()=>Pe,AddOperation:()=>rr,AdditiveAnimationBlendMode:()=>th,AdditiveBlending:()=>H,AlphaFormat:()=>dp,AlwaysDepth:()=>Ln,AlwaysStencilFunc:()=>da,AmbientLight:()=>am,AmbientLightProbe:()=>kf,AnimationClip:()=>$n,AnimationLoader:()=>Ji,AnimationMixer:()=>sa,AnimationObjectGroup:()=>Qd,AnimationUtils:()=>Je,ArcCurve:()=>cu,ArrayCamera:()=>zi,ArrowHelper:()=>B_,Audio:()=>Ff,AudioAnalyser:()=>_m,AudioContext:()=>cm,AudioListener:()=>fm,AudioLoader:()=>Wm,AxesHelper:()=>b_,AxisHelper:()=>m,BackSide:()=>q,BasicDepthPacking:()=>W,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>Z,Bone:()=>jl,BooleanKeyframeTrack:()=>jt,BoundingBoxHelper:()=>g,Box2:()=>mh,Box3:()=>Ui,Box3Helper:()=>C_,BoxBufferGeometry:()=>tc,BoxGeometry:()=>tc,BoxHelper:()=>v_,BufferAttribute:()=>Pi,BufferGeometry:()=>br,BufferGeometryLoader:()=>o_,ByteType:()=>Wl,Cache:()=>lr,Camera:()=>Rl,CameraHelper:()=>$_,CanvasRenderer:()=>K,CanvasTexture:()=>gf,CatmullRomCurve3:()=>Gi,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>su,CircleGeometry:()=>su,ClampToEdgeWrapping:()=>Jr,Clock:()=>dm,Color:()=>er,ColorKeyframeTrack:()=>It,CompressedTexture:()=>Iu,CompressedTextureLoader:()=>fo,ConeBufferGeometry:()=>Zp,ConeGeometry:()=>Zp,CubeCamera:()=>gl,CubeReflectionMapping:()=>Ei,CubeRefractionMapping:()=>So,CubeTexture:()=>nc,CubeTextureLoader:()=>Uo,CubeUVReflectionMapping:()=>Ni,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>ia,CubicBezierCurve3:()=>Ki,CubicInterpolant:()=>at,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>z,Curve:()=>Ua,CurvePath:()=>Ga,CustomBlending:()=>xe,CustomToneMapping:()=>Wr,CylinderBufferGeometry:()=>rl,CylinderGeometry:()=>rl,Cylindrical:()=>bm,DataTexture:()=>Os,DataTexture2DArray:()=>Qr,DataTexture3D:()=>Cn,DataTextureLoader:()=>cs,DataUtils:()=>R_,DecrementStencilOp:()=>Bt,DecrementWrapStencilOp:()=>pn,DefaultLoadingManager:()=>pr,DepthFormat:()=>To,DepthStencilFormat:()=>Zs,DepthTexture:()=>qd,DirectionalLight:()=>nd,DirectionalLightHelper:()=>A_,DiscreteInterpolant:()=>Tt,DodecahedronBufferGeometry:()=>to,DodecahedronGeometry:()=>to,DoubleSide:()=>Y,DstAlphaFactor:()=>sn,DstColorFactor:()=>Mn,DynamicBufferAttribute:()=>V_,DynamicCopyUsage:()=>fa,DynamicDrawUsage:()=>Br,DynamicReadUsage:()=>qi,EdgesGeometry:()=>lu,EdgesHelper:()=>E,EllipseCurve:()=>Fu,EqualDepth:()=>ir,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Xs,EquirectangularRefractionMapping:()=>ua,Euler:()=>co,EventDispatcher:()=>Ds,ExtrudeBufferGeometry:()=>ja,ExtrudeGeometry:()=>ja,FaceColors:()=>k_,FileLoader:()=>Or,FlatShading:()=>A,Float16BufferAttribute:()=>Zr,Float32Attribute:()=>t,Float32BufferAttribute:()=>hn,Float64Attribute:()=>u,Float64BufferAttribute:()=>Qc,FloatType:()=>Xo,Fog:()=>ka,FogExp2:()=>Lu,Font:()=>Vm,FontLoader:()=>u_,FrontSide:()=>le,Frustum:()=>Dr,GLBufferAttribute:()=>Uf,GLSL1:()=>ma,GLSL3:()=>Ri,GammaEncoding:()=>Ql,GreaterDepth:()=>or,GreaterEqualDepth:()=>ur,GreaterEqualStencilFunc:()=>es,GreaterStencilFunc:()=>Ar,GridHelper:()=>t_,Group:()=>ln,HalfFloatType:()=>ps,HemisphereLight:()=>ap,HemisphereLightHelper:()=>M_,HemisphereLightProbe:()=>um,IcosahedronBufferGeometry:()=>sp,IcosahedronGeometry:()=>sp,ImageBitmapLoader:()=>l_,ImageLoader:()=>wo,ImageUtils:()=>As,ImmediateRenderObject:()=>Km,IncrementStencilOp:()=>At,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>ou,InstancedBufferGeometry:()=>Of,InstancedInterleavedBuffer:()=>Ma,InstancedMesh:()=>Dc,Int16Attribute:()=>Y_,Int16BufferAttribute:()=>oh,Int32Attribute:()=>Z_,Int32BufferAttribute:()=>Pa,Int8Attribute:()=>W_,Int8BufferAttribute:()=>Pd,IntType:()=>Hp,InterleavedBuffer:()=>Oc,InterleavedBufferAttribute:()=>Ii,Interpolant:()=>pt,InterpolateDiscrete:()=>Jl,InterpolateLinear:()=>Zl,InterpolateSmooth:()=>Ku,InvertStencilOp:()=>Fn,JSONLoader:()=>me,KeepStencilOp:()=>qe,KeyframeTrack:()=>Yt,LOD:()=>ph,LatheBufferGeometry:()=>vi,LatheGeometry:()=>vi,Layers:()=>Qs,LensFlare:()=>Se,LessDepth:()=>mn,LessEqualDepth:()=>cr,LessEqualStencilFunc:()=>ti,LessStencilFunc:()=>xn,Light:()=>Hl,LightProbe:()=>Zd,Line:()=>Da,Line3:()=>Qm,LineBasicMaterial:()=>kt,LineCurve:()=>oa,LineCurve3:()=>yl,LineDashedMaterial:()=>je,LineLoop:()=>Qo,LinePieces:()=>I_,LineSegments:()=>fr,LineStrip:()=>P_,LinearEncoding:()=>Zi,LinearFilter:()=>ai,LinearInterpolant:()=>Mt,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>kh,LinearMipmapLinearFilter:()=>sl,LinearMipmapNearestFilter:()=>Gc,LinearToneMapping:()=>mi,Loader:()=>Yn,LoaderUtils:()=>vf,LoadingManager:()=>jn,LogLuvEncoding:()=>Wh,LoopOnce:()=>gu,LoopPingPong:()=>bc,LoopRepeat:()=>qa,LuminanceAlphaFormat:()=>Wu,LuminanceFormat:()=>Vc,MOUSE:()=>L,Material:()=>Cs,MaterialLoader:()=>lm,Math:()=>yu,MathUtils:()=>yu,Matrix3:()=>lt,Matrix4:()=>tn,MaxEquation:()=>Ke,Mesh:()=>Ro,MeshBasicMaterial:()=>fl,MeshDepthMaterial:()=>Vd,MeshDistanceMaterial:()=>Op,MeshFaceMaterial:()=>D_,MeshLambertMaterial:()=>Oe,MeshMatcapMaterial:()=>Fe,MeshNormalMaterial:()=>Ie,MeshPhongMaterial:()=>Te,MeshPhysicalMaterial:()=>be,MeshStandardMaterial:()=>ve,MeshToonMaterial:()=>Le,MinEquation:()=>Xe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>U_,MultiplyBlending:()=>Q,MultiplyOperation:()=>Kr,NearestFilter:()=>Ir,NearestMipMapLinearFilter:()=>Ys,NearestMipMapNearestFilter:()=>Hu,NearestMipmapLinearFilter:()=>hs,NearestMipmapNearestFilter:()=>Va,NeverDepth:()=>On,NeverStencilFunc:()=>on,NoBlending:()=>X,NoColors:()=>O_,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>eh,NormalBlending:()=>oe,NotEqualDepth:()=>ni,NotEqualStencilFunc:()=>fs,NumberKeyframeTrack:()=>Nt,Object3D:()=>Pr,ObjectLoader:()=>Hm,ObjectSpaceNormalMap:()=>Ne,OctahedronBufferGeometry:()=>xr,OctahedronGeometry:()=>xr,OneFactor:()=>dt,OneMinusDstAlphaFactor:()=>gt,OneMinusDstColorFactor:()=>Bn,OneMinusSrcAlphaFactor:()=>Dt,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>rc,PCFShadowMap:()=>he,PCFSoftShadowMap:()=>ae,PMREMGenerator:()=>we,ParametricBufferGeometry:()=>a,ParametricGeometry:()=>a,Particle:()=>S_,ParticleBasicMaterial:()=>j_,ParticleSystem:()=>i_,ParticleSystemMaterial:()=>G_,Path:()=>ks,PerspectiveCamera:()=>Po,Plane:()=>Ia,PlaneBufferGeometry:()=>Eu,PlaneGeometry:()=>Eu,PlaneHelper:()=>L_,PointCloud:()=>w_,PointCloudMaterial:()=>z_,PointLight:()=>If,PointLightHelper:()=>tf,Points:()=>ra,PointsMaterial:()=>gi,PolarGridHelper:()=>Tm,PolyhedronBufferGeometry:()=>au,PolyhedronGeometry:()=>au,PositionalAudio:()=>mm,PropertyBinding:()=>mo,PropertyMixer:()=>Jm,QuadraticBezierCurve:()=>so,QuadraticBezierCurve3:()=>Ko,Quaternion:()=>$i,QuaternionKeyframeTrack:()=>$t,QuaternionLinearInterpolant:()=>ft,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>lo,RGBAIntegerFormat:()=>yh,RGBA_ASTC_10x10_Format:()=>ul,RGBA_ASTC_10x5_Format:()=>Ju,RGBA_ASTC_10x6_Format:()=>cl,RGBA_ASTC_10x8_Format:()=>zh,RGBA_ASTC_12x10_Format:()=>jh,RGBA_ASTC_12x12_Format:()=>Zu,RGBA_ASTC_4x4_Format:()=>Xu,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>Wc,RGBA_ASTC_6x6_Format:()=>_c,RGBA_ASTC_8x5_Format:()=>xh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Yu,RGBA_BPTC_Format:()=>vc,RGBA_ETC2_EAC_Format:()=>Xl,RGBA_PVRTC_2BPPV1_Format:()=>ql,RGBA_PVRTC_4BPPV1_Format:()=>Ml,RGBA_S3TC_DXT1_Format:()=>mc,RGBA_S3TC_DXT3_Format:()=>Dh,RGBA_S3TC_DXT5_Format:()=>bh,RGBDEncoding:()=>vu,RGBEEncoding:()=>Yc,RGBEFormat:()=>vh,RGBFormat:()=>Fs,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>nh,RGBM7Encoding:()=>xc,RGB_ETC1_Format:()=>qu,RGB_ETC2_Format:()=>ds,RGB_PVRTC_2BPPV1_Format:()=>Tl,RGB_PVRTC_4BPPV1_Format:()=>Uh,RGB_S3TC_DXT1_Format:()=>Fh,RGFormat:()=>mu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>Mu,Ray:()=>fn,Raycaster:()=>$d,RectAreaLight:()=>Gm,RedFormat:()=>Vp,RedIntegerFormat:()=>ll,ReinhardToneMapping:()=>go,RepeatWrapping:()=>vo,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Ae,RingBufferGeometry:()=>r,RingGeometry:()=>r,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Gh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Hh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>yc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>wh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>_u,SRGB8_ALPHA8_ASTC_6x5_Format:()=>qc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Xc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Qu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Yl,Scene:()=>Gs,SceneUtils:()=>ge,ShaderChunk:()=>ui,ShaderLib:()=>Ol,ShaderMaterial:()=>Ps,ShadowMaterial:()=>ne,Shape:()=>qs,ShapeBufferGeometry:()=>h,ShapeGeometry:()=>h,ShapePath:()=>c_,ShapeUtils:()=>Es,ShortType:()=>Wa,Skeleton:()=>rp,SkeletonHelper:()=>zf,SkinnedMesh:()=>zl,SmoothShading:()=>N,Sphere:()=>xo,SphereBufferGeometry:()=>p,SphereGeometry:()=>p,Spherical:()=>__,SphericalHarmonics3:()=>rd,SplineCurve:()=>ws,SpotLight:()=>fh,SpotLightHelper:()=>zp,Sprite:()=>Fc,SpriteMaterial:()=>Jp,SrcAlphaFactor:()=>Gt,SrcAlphaSaturateFactor:()=>dn,SrcColorFactor:()=>Pt,StaticCopyUsage:()=>wc,StaticDrawUsage:()=>bi,StaticReadUsage:()=>Wi,StereoCamera:()=>h_,StreamCopyUsage:()=>pl,StreamDrawUsage:()=>Xa,StreamReadUsage:()=>qh,StringKeyframeTrack:()=>Zt,SubtractEquation:()=>Ge,SubtractiveBlending:()=>Ce,TOUCH:()=>D,TangentSpaceNormalMap:()=>Me,TetrahedronBufferGeometry:()=>y,TetrahedronGeometry:()=>y,TextBufferGeometry:()=>b,TextGeometry:()=>b,Texture:()=>$s,TextureLoader:()=>Ws,TorusBufferGeometry:()=>R,TorusGeometry:()=>R,TorusKnotBufferGeometry:()=>O,TorusKnotGeometry:()=>O,Triangle:()=>eo,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Vh,TubeBufferGeometry:()=>T,TubeGeometry:()=>T,UVMapping:()=>yi,Uint16Attribute:()=>J_,Uint16BufferAttribute:()=>sh,Uint32Attribute:()=>Q_,Uint32BufferAttribute:()=>li,Uint8Attribute:()=>q_,Uint8BufferAttribute:()=>Cp,Uint8ClampedAttribute:()=>X_,Uint8ClampedBufferAttribute:()=>Ra,Uniform:()=>Ad,UniformsLib:()=>sr,UniformsUtils:()=>Rs,UnsignedByteType:()=>ha,UnsignedInt248Type:()=>Ms,UnsignedIntType:()=>Js,UnsignedShort4444Type:()=>Vu,UnsignedShort5551Type:()=>du,UnsignedShort565Type:()=>fu,UnsignedShortType:()=>Hc,VSMShadowMap:()=>fe,Vector2:()=>zn,Vector3:()=>ht,Vector4:()=>Di,VectorKeyframeTrack:()=>Tn,Vertex:()=>H_,VertexColors:()=>F_,VideoTexture:()=>Dp,WebGL1Renderer:()=>kp,WebGLCubeRenderTarget:()=>Bc,WebGLMultipleRenderTargets:()=>ri,WebGLMultisampleRenderTarget:()=>Jc,WebGLRenderTarget:()=>io,WebGLRenderTargetCube:()=>J,WebGLRenderer:()=>Yi,WebGLUtils:()=>Wd,WireframeGeometry:()=>U,WireframeHelper:()=>I,WrapAroundEnding:()=>Al,XHRLoader:()=>G,ZeroCurvatureEnding:()=>La,ZeroFactor:()=>yt,ZeroSlopeEnding:()=>pa,ZeroStencilOp:()=>Ve,sRGBEncoding:()=>hl});const x="132",L={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},z=0,M=1,P=2,de=3,ye=0,he=1,ae=2,fe=3,le=0,q=1,Y=2,A=1,N=2,X=0,oe=1,H=2,Ce=3,Q=4,xe=5,Pe=100,Ge=101,Ae=102,Xe=103,Ke=104,yt=200,dt=201,Pt=202,wt=203,Gt=204,Dt=205,sn=206,gt=207,Mn=208,Bn=209,dn=210,On=0,Ln=1,mn=2,cr=3,ir=4,ur=5,or=6,ni=7,Kr=0,pi=1,rr=2,vr=0,mi=1,go=2,Nr=3,ei=4,Wr=5,yi=300,Ei=301,So=302,Xs=303,ua=304,Ni=306,Eo=307,vo=1e3,Jr=1001,os=1002,Ir=1003,Va=1004,Hu=1004,hs=1005,Ys=1005,ai=1006,Gc=1007,kh=1007,sl=1008,Gp=1008,ha=1009,Wl=1010,Wa=1011,Hc=1012,Hp=1013,Js=1014,Xo=1015,ps=1016,Vu=1017,du=1018,fu=1019,Ms=1020,dp=1021,Fs=1022,lo=1023,Vc=1024,Wu=1025,vh=lo,To=1026,Zs=1027,Vp=1028,ll=1029,mu=1030,fp=1031,mp=1032,yh=1033,Fh=33776,mc=33777,Dh=33778,bh=33779,Uh=35840,Tl=35841,Ml=35842,ql=35843,qu=36196,ds=37492,Xl=37496,Xu=37808,_p=37809,gp=37810,Wc=37811,_c=37812,xh=37813,vp=37814,Yu=37815,Ju=37816,cl=37817,zh=37818,ul=37819,jh=37820,Zu=37821,vc=36492,yc=37840,wh=37841,_u=37842,qc=37843,yp=37844,Xc=37845,Qu=37846,Yl=37847,bp=37848,Gh=37849,xp=37850,wp=37851,Hh=37852,Wp=37853,gu=2200,qa=2201,bc=2202,Jl=2300,Zl=2301,Ku=2302,La=2400,pa=2401,Al=2402,eh=2500,th=2501,Vh=0,Sp=1,Ep=2,Zi=3e3,hl=3001,Ql=3007,Yc=3002,Wh=3003,xc=3004,nh=3005,vu=3006,W=3200,pe=3201,Me=0,Ne=1,Ve=0,qe=7680,et=7681,At=7682,Bt=7683,Xt=34055,pn=34056,Fn=5386,on=512,xn=513,Er=514,ti=515,Ar=516,fs=517,es=518,da=519,bi=35044,Br=35048,Xa=35040,Wi=35045,qi=35049,qh=35041,wc=35046,fa=35050,pl=35042,ma="100",Ri="300 es";class Ds{addEventListener(e,c){void 0===this._listeners&&(this._listeners={});const d=this._listeners;void 0===d[e]&&(d[e]=[]),-1===d[e].indexOf(c)&&d[e].push(c)}hasEventListener(e,c){if(void 0===this._listeners)return!1;const d=this._listeners;return void 0!==d[e]&&-1!==d[e].indexOf(c)}removeEventListener(e,c){if(void 0===this._listeners)return;const d=this._listeners[e];if(void 0!==d){const _=d.indexOf(c);-1!==_&&d.splice(_,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const c=this._listeners[e.type];if(void 0!==c){e.target=this;const d=c.slice(0);for(let _=0,S=d.length;_<S;_++)d[_].call(this,e);e.target=null}}}const tr=[];for(let w=0;w<256;w++)tr[w]=(w<16?"0":"")+w.toString(16);let wn=1234567;const Ho=Math.PI/180,ss=180/Math.PI;function Qi(){const w=4294967295*Math.random()|0,e=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(tr[255&w]+tr[w>>8&255]+tr[w>>16&255]+tr[w>>24&255]+"-"+tr[255&e]+tr[e>>8&255]+"-"+tr[e>>16&15|64]+tr[e>>24&255]+"-"+tr[63&c|128]+tr[c>>8&255]+"-"+tr[c>>16&255]+tr[c>>24&255]+tr[255&d]+tr[d>>8&255]+tr[d>>16&255]+tr[d>>24&255]).toUpperCase()}function Hr(w,e,c){return Math.max(e,Math.min(c,w))}function di(w,e){return(w%e+e)%e}function xi(w,e,c){return(1-c)*w+c*e}function Us(w){return 0==(w&w-1)&&0!==w}function Xh(w){return Math.pow(2,Math.ceil(Math.log(w)/Math.LN2))}function yo(w){return Math.pow(2,Math.floor(Math.log(w)/Math.LN2))}var yu=Object.freeze({__proto__:null,DEG2RAD:Ho,RAD2DEG:ss,generateUUID:Qi,clamp:Hr,euclideanModulo:di,mapLinear:function(w,e,c,d,_){return d+(w-e)*(_-d)/(c-e)},inverseLerp:function(w,e,c){return w!==e?(c-w)/(e-w):0},lerp:xi,damp:function(w,e,c,d){return xi(w,e,1-Math.exp(-c*d))},pingpong:function(w,e=1){return e-Math.abs(di(w,2*e)-e)},smoothstep:function(w,e,c){return w<=e?0:w>=c?1:(w=(w-e)/(c-e))*w*(3-2*w)},smootherstep:function(w,e,c){return w<=e?0:w>=c?1:(w=(w-e)/(c-e))*w*w*(w*(6*w-15)+10)},randInt:function(w,e){return w+Math.floor(Math.random()*(e-w+1))},randFloat:function(w,e){return w+Math.random()*(e-w)},randFloatSpread:function(w){return w*(.5-Math.random())},seededRandom:function(w){return void 0!==w&&(wn=w%2147483647),wn=16807*wn%2147483647,(wn-1)/2147483646},degToRad:function(w){return w*Ho},radToDeg:function(w){return w*ss},isPowerOfTwo:Us,ceilPowerOfTwo:Xh,floorPowerOfTwo:yo,setQuaternionFromProperEuler:function(w,e,c,d,_){const S=Math.cos,B=Math.sin,k=S(c/2),F=B(c/2),V=S((e+d)/2),te=B((e+d)/2),ce=S((e-d)/2),ue=B((e-d)/2),_e=S((d-e)/2),Ee=B((d-e)/2);switch(_){case"XYX":w.set(k*te,F*ce,F*ue,k*V);break;case"YZY":w.set(F*ue,k*te,F*ce,k*V);break;case"ZXZ":w.set(F*ce,F*ue,k*te,k*V);break;case"XZX":w.set(k*te,F*Ee,F*_e,k*V);break;case"YXY":w.set(F*_e,k*te,F*Ee,k*V);break;case"ZYZ":w.set(F*Ee,F*_e,k*te,k*V);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}});class zn{constructor(e=0,c=0){this.x=e,this.y=c}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,c){return this.x=e,this.y=c,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const c=this.x,d=this.y,_=e.elements;return this.x=_[0]*c+_[3]*d+_[6],this.y=_[1]*c+_[4]*d+_[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,d=this.y-e.y;return c*c+d*d}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this}rotateAround(e,c){const d=Math.cos(c),_=Math.sin(c),S=this.x-e.x,B=this.y-e.y;return this.x=S*d-B*_+e.x,this.y=S*_+B*d+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}zn.prototype.isVector2=!0;class lt{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,c,d,_,S,B,k,F,V){const te=this.elements;return te[0]=e,te[1]=_,te[2]=k,te[3]=c,te[4]=S,te[5]=F,te[6]=d,te[7]=B,te[8]=V,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const c=this.elements,d=e.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],this}extractBasis(e,c,d){return e.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const c=e.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const d=e.elements,_=c.elements,S=this.elements,B=d[0],k=d[3],F=d[6],V=d[1],te=d[4],ce=d[7],ue=d[2],_e=d[5],Ee=d[8],$e=_[0],Be=_[3],Re=_[6],We=_[1],tt=_[4],Ze=_[7],ot=_[2],st=_[5],Ct=_[8];return S[0]=B*$e+k*We+F*ot,S[3]=B*Be+k*tt+F*st,S[6]=B*Re+k*Ze+F*Ct,S[1]=V*$e+te*We+ce*ot,S[4]=V*Be+te*tt+ce*st,S[7]=V*Re+te*Ze+ce*Ct,S[2]=ue*$e+_e*We+Ee*ot,S[5]=ue*Be+_e*tt+Ee*st,S[8]=ue*Re+_e*Ze+Ee*Ct,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[3]*=e,c[6]*=e,c[1]*=e,c[4]*=e,c[7]*=e,c[2]*=e,c[5]*=e,c[8]*=e,this}determinant(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],B=e[4],k=e[5],F=e[6],V=e[7],te=e[8];return c*B*te-c*k*V-d*S*te+d*k*F+_*S*V-_*B*F}invert(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],B=e[4],k=e[5],F=e[6],V=e[7],te=e[8],ce=te*B-k*V,ue=k*F-te*S,_e=V*S-B*F,Ee=c*ce+d*ue+_*_e;if(0===Ee)return this.set(0,0,0,0,0,0,0,0,0);const $e=1/Ee;return e[0]=ce*$e,e[1]=(_*V-te*d)*$e,e[2]=(k*d-_*B)*$e,e[3]=ue*$e,e[4]=(te*c-_*F)*$e,e[5]=(_*S-k*c)*$e,e[6]=_e*$e,e[7]=(d*F-V*c)*$e,e[8]=(B*c-d*S)*$e,this}transpose(){let e;const c=this.elements;return e=c[1],c[1]=c[3],c[3]=e,e=c[2],c[2]=c[6],c[6]=e,e=c[5],c[5]=c[7],c[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const c=this.elements;return e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8],this}setUvTransform(e,c,d,_,S,B,k){const F=Math.cos(S),V=Math.sin(S);return this.set(d*F,d*V,-d*(F*B+V*k)+B+e,-_*V,_*F,-_*(-V*B+F*k)+k+c,0,0,1),this}scale(e,c){const d=this.elements;return d[0]*=e,d[3]*=e,d[6]*=e,d[1]*=c,d[4]*=c,d[7]*=c,this}rotate(e){const c=Math.cos(e),d=Math.sin(e),_=this.elements,S=_[0],B=_[3],k=_[6],F=_[1],V=_[4],te=_[7];return _[0]=c*S+d*F,_[3]=c*B+d*V,_[6]=c*k+d*te,_[1]=-d*S+c*F,_[4]=-d*B+c*V,_[7]=-d*k+c*te,this}translate(e,c){const d=this.elements;return d[0]+=e*d[2],d[3]+=e*d[5],d[6]+=e*d[8],d[1]+=c*d[2],d[4]+=c*d[5],d[7]+=c*d[8],this}equals(e){const c=this.elements,d=e.elements;for(let _=0;_<9;_++)if(c[_]!==d[_])return!1;return!0}fromArray(e,c=0){for(let d=0;d<9;d++)this.elements[d]=e[d+c];return this}toArray(e=[],c=0){const d=this.elements;return e[c]=d[0],e[c+1]=d[1],e[c+2]=d[2],e[c+3]=d[3],e[c+4]=d[4],e[c+5]=d[5],e[c+6]=d[6],e[c+7]=d[7],e[c+8]=d[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let $l;lt.prototype.isMatrix3=!0;class As{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let c;if(e instanceof HTMLCanvasElement)c=e;else{void 0===$l&&($l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$l.width=e.width,$l.height=e.height;const d=$l.getContext("2d");e instanceof ImageData?d.putImageData(e,0,0):d.drawImage(e,0,0,e.width,e.height),c=$l}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}}let Tp=0;class $s extends Ds{constructor(e=$s.DEFAULT_IMAGE,c=$s.DEFAULT_MAPPING,d=Jr,_=Jr,S=ai,B=sl,k=lo,F=ha,V=1,te=Zi){super(),Object.defineProperty(this,"id",{value:Tp++}),this.uuid=Qi(),this.name="",this.image=e,this.mipmaps=[],this.mapping=c,this.wrapS=d,this.wrapT=_,this.magFilter=S,this.minFilter=B,this.anisotropy=V,this.format=k,this.internalFormat=null,this.type=F,this.offset=new zn(0,0),this.repeat=new zn(1,1),this.center=new zn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new lt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=te,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const c=void 0===e||"string"==typeof e;if(!c&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const _=this.image;if(void 0===_.uuid&&(_.uuid=Qi()),!c&&void 0===e.images[_.uuid]){let S;if(Array.isArray(_)){S=[];for(let B=0,k=_.length;B<k;B++)S.push(Sc(_[B].isDataTexture?_[B].image:_[B]))}else S=Sc(_);e.images[_.uuid]={uuid:_.uuid,url:S}}d.image=_.uuid}return c||(e.textures[this.uuid]=d),d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==yi)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vo:e.x=e.x-Math.floor(e.x);break;case Jr:e.x=e.x<0?0:1;break;case os:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case vo:e.y=e.y-Math.floor(e.y);break;case Jr:e.y=e.y<0?0:1;break;case os:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function Sc(w){return typeof HTMLImageElement<"u"&&w instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&w instanceof ImageBitmap?As.getDataURL(w):w.data?{data:Array.prototype.slice.call(w.data),width:w.width,height:w.height,type:w.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}$s.DEFAULT_IMAGE=void 0,$s.DEFAULT_MAPPING=yi,$s.prototype.isTexture=!0;class Di{constructor(e=0,c=0,d=0,_=1){this.x=e,this.y=c,this.z=d,this.w=_}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,c,d,_){return this.x=e,this.y=c,this.z=d,this.w=_,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this.w=e.w+c.w,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this.w+=e.w*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this.w=e.w-c.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const c=this.x,d=this.y,_=this.z,S=this.w,B=e.elements;return this.x=B[0]*c+B[4]*d+B[8]*_+B[12]*S,this.y=B[1]*c+B[5]*d+B[9]*_+B[13]*S,this.z=B[2]*c+B[6]*d+B[10]*_+B[14]*S,this.w=B[3]*c+B[7]*d+B[11]*_+B[15]*S,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const c=Math.sqrt(1-e.w*e.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/c,this.y=e.y/c,this.z=e.z/c),this}setAxisAngleFromRotationMatrix(e){let c,d,_,S;const F=e.elements,V=F[0],te=F[4],ce=F[8],ue=F[1],_e=F[5],Ee=F[9],$e=F[2],Be=F[6],Re=F[10];if(Math.abs(te-ue)<.01&&Math.abs(ce-$e)<.01&&Math.abs(Ee-Be)<.01){if(Math.abs(te+ue)<.1&&Math.abs(ce+$e)<.1&&Math.abs(Ee+Be)<.1&&Math.abs(V+_e+Re-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const tt=(V+1)/2,Ze=(_e+1)/2,ot=(Re+1)/2,st=(te+ue)/4,Ct=(ce+$e)/4,Ft=(Ee+Be)/4;return tt>Ze&&tt>ot?tt<.01?(d=0,_=.707106781,S=.707106781):(d=Math.sqrt(tt),_=st/d,S=Ct/d):Ze>ot?Ze<.01?(d=.707106781,_=0,S=.707106781):(_=Math.sqrt(Ze),d=st/_,S=Ft/_):ot<.01?(d=.707106781,_=.707106781,S=0):(S=Math.sqrt(ot),d=Ct/S,_=Ft/S),this.set(d,_,S,c),this}let We=Math.sqrt((Be-Ee)*(Be-Ee)+(ce-$e)*(ce-$e)+(ue-te)*(ue-te));return Math.abs(We)<.001&&(We=1),this.x=(Be-Ee)/We,this.y=(ce-$e)/We,this.z=(ue-te)/We,this.w=Math.acos((V+_e+Re-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this.w=Math.max(e.w,Math.min(c.w,this.w)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this.w=Math.max(e,Math.min(c,this.w)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this.w+=(e.w-this.w)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this.z=e.z+(c.z-e.z)*d,this.w=e.w+(c.w-e.w)*d,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this.w=e[c+3],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e[c+3]=this.w,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this.w=e.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Di.prototype.isVector4=!0;class io extends Ds{constructor(e,c,d={}){super(),this.width=e,this.height=c,this.depth=1,this.scissor=new Di(0,0,e,c),this.scissorTest=!1,this.viewport=new Di(0,0,e,c),this.texture=new $s(void 0,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:c,depth:1},this.texture.generateMipmaps=void 0!==d.generateMipmaps&&d.generateMipmaps,this.texture.internalFormat=void 0!==d.internalFormat?d.internalFormat:null,this.texture.minFilter=void 0!==d.minFilter?d.minFilter:ai,this.depthBuffer=void 0===d.depthBuffer||d.depthBuffer,this.stencilBuffer=void 0!==d.stencilBuffer&&d.stencilBuffer,this.depthTexture=void 0!==d.depthTexture?d.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,c,d=1){this.width===e&&this.height===c&&this.depth===d||(this.width=e,this.height=c,this.depth=d,this.texture.image.width=e,this.texture.image.height=c,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}io.prototype.isWebGLRenderTarget=!0;class ri extends io{constructor(e,c,d){super(e,c);const _=this.texture;this.texture=[];for(let S=0;S<d;S++)this.texture[S]=_.clone()}setSize(e,c,d=1){if(this.width!==e||this.height!==c||this.depth!==d){this.width=e,this.height=c,this.depth=d;for(let _=0,S=this.texture.length;_<S;_++)this.texture[_].image.width=e,this.texture[_].image.height=c,this.texture[_].image.depth=d;this.dispose()}return this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let c=0,d=e.texture.length;c<d;c++)this.texture[c]=e.texture[c].clone();return this}}ri.prototype.isWebGLMultipleRenderTargets=!0;class Jc extends io{constructor(e,c,d){super(e,c,d),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}Jc.prototype.isWebGLMultisampleRenderTarget=!0;class $i{constructor(e=0,c=0,d=0,_=1){this._x=e,this._y=c,this._z=d,this._w=_}static slerp(e,c,d,_){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),d.slerpQuaternions(e,c,_)}static slerpFlat(e,c,d,_,S,B,k){let F=d[_+0],V=d[_+1],te=d[_+2],ce=d[_+3];const ue=S[B+0],_e=S[B+1],Ee=S[B+2],$e=S[B+3];if(0===k)return e[c+0]=F,e[c+1]=V,e[c+2]=te,void(e[c+3]=ce);if(1===k)return e[c+0]=ue,e[c+1]=_e,e[c+2]=Ee,void(e[c+3]=$e);if(ce!==$e||F!==ue||V!==_e||te!==Ee){let Be=1-k;const Re=F*ue+V*_e+te*Ee+ce*$e,We=Re>=0?1:-1,tt=1-Re*Re;if(tt>Number.EPSILON){const ot=Math.sqrt(tt),st=Math.atan2(ot,Re*We);Be=Math.sin(Be*st)/ot,k=Math.sin(k*st)/ot}const Ze=k*We;if(F=F*Be+ue*Ze,V=V*Be+_e*Ze,te=te*Be+Ee*Ze,ce=ce*Be+$e*Ze,Be===1-k){const ot=1/Math.sqrt(F*F+V*V+te*te+ce*ce);F*=ot,V*=ot,te*=ot,ce*=ot}}e[c]=F,e[c+1]=V,e[c+2]=te,e[c+3]=ce}static multiplyQuaternionsFlat(e,c,d,_,S,B){const k=d[_],F=d[_+1],V=d[_+2],te=d[_+3],ce=S[B],ue=S[B+1],_e=S[B+2],Ee=S[B+3];return e[c]=k*Ee+te*ce+F*_e-V*ue,e[c+1]=F*Ee+te*ue+V*ce-k*_e,e[c+2]=V*Ee+te*_e+k*ue-F*ce,e[c+3]=te*Ee-k*ce-F*ue-V*_e,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,c,d,_){return this._x=e,this._y=c,this._z=d,this._w=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,c){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const d=e._x,_=e._y,S=e._z,B=e._order,k=Math.cos,F=Math.sin,V=k(d/2),te=k(_/2),ce=k(S/2),ue=F(d/2),_e=F(_/2),Ee=F(S/2);switch(B){case"XYZ":this._x=ue*te*ce+V*_e*Ee,this._y=V*_e*ce-ue*te*Ee,this._z=V*te*Ee+ue*_e*ce,this._w=V*te*ce-ue*_e*Ee;break;case"YXZ":this._x=ue*te*ce+V*_e*Ee,this._y=V*_e*ce-ue*te*Ee,this._z=V*te*Ee-ue*_e*ce,this._w=V*te*ce+ue*_e*Ee;break;case"ZXY":this._x=ue*te*ce-V*_e*Ee,this._y=V*_e*ce+ue*te*Ee,this._z=V*te*Ee+ue*_e*ce,this._w=V*te*ce-ue*_e*Ee;break;case"ZYX":this._x=ue*te*ce-V*_e*Ee,this._y=V*_e*ce+ue*te*Ee,this._z=V*te*Ee-ue*_e*ce,this._w=V*te*ce+ue*_e*Ee;break;case"YZX":this._x=ue*te*ce+V*_e*Ee,this._y=V*_e*ce+ue*te*Ee,this._z=V*te*Ee-ue*_e*ce,this._w=V*te*ce-ue*_e*Ee;break;case"XZY":this._x=ue*te*ce-V*_e*Ee,this._y=V*_e*ce-ue*te*Ee,this._z=V*te*Ee+ue*_e*ce,this._w=V*te*ce+ue*_e*Ee;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+B)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(e,c){const d=c/2,_=Math.sin(d);return this._x=e.x*_,this._y=e.y*_,this._z=e.z*_,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(e){const c=e.elements,d=c[0],_=c[4],S=c[8],B=c[1],k=c[5],F=c[9],V=c[2],te=c[6],ce=c[10],ue=d+k+ce;if(ue>0){const _e=.5/Math.sqrt(ue+1);this._w=.25/_e,this._x=(te-F)*_e,this._y=(S-V)*_e,this._z=(B-_)*_e}else if(d>k&&d>ce){const _e=2*Math.sqrt(1+d-k-ce);this._w=(te-F)/_e,this._x=.25*_e,this._y=(_+B)/_e,this._z=(S+V)/_e}else if(k>ce){const _e=2*Math.sqrt(1+k-d-ce);this._w=(S-V)/_e,this._x=(_+B)/_e,this._y=.25*_e,this._z=(F+te)/_e}else{const _e=2*Math.sqrt(1+ce-d-k);this._w=(B-_)/_e,this._x=(S+V)/_e,this._y=(F+te)/_e,this._z=.25*_e}return this._onChangeCallback(),this}setFromUnitVectors(e,c){let d=e.dot(c)+1;return d<Number.EPSILON?(d=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=d):(this._x=0,this._y=-e.z,this._z=e.y,this._w=d)):(this._x=e.y*c.z-e.z*c.y,this._y=e.z*c.x-e.x*c.z,this._z=e.x*c.y-e.y*c.x,this._w=d),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Hr(this.dot(e),-1,1)))}rotateTowards(e,c){const d=this.angleTo(e);if(0===d)return this;const _=Math.min(1,c/d);return this.slerp(e,_),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,c)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,c){const d=e._x,_=e._y,S=e._z,B=e._w,k=c._x,F=c._y,V=c._z,te=c._w;return this._x=d*te+B*k+_*V-S*F,this._y=_*te+B*F+S*k-d*V,this._z=S*te+B*V+d*F-_*k,this._w=B*te-d*k-_*F-S*V,this._onChangeCallback(),this}slerp(e,c){if(0===c)return this;if(1===c)return this.copy(e);const d=this._x,_=this._y,S=this._z,B=this._w;let k=B*e._w+d*e._x+_*e._y+S*e._z;if(k<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,k=-k):this.copy(e),k>=1)return this._w=B,this._x=d,this._y=_,this._z=S,this;const F=1-k*k;if(F<=Number.EPSILON){const _e=1-c;return this._w=_e*B+c*this._w,this._x=_e*d+c*this._x,this._y=_e*_+c*this._y,this._z=_e*S+c*this._z,this.normalize(),this._onChangeCallback(),this}const V=Math.sqrt(F),te=Math.atan2(V,k),ce=Math.sin((1-c)*te)/V,ue=Math.sin(c*te)/V;return this._w=B*ce+this._w*ue,this._x=d*ce+this._x*ue,this._y=_*ce+this._y*ue,this._z=S*ce+this._z*ue,this._onChangeCallback(),this}slerpQuaternions(e,c,d){this.copy(e).slerp(c,d)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,c=0){return this._x=e[c],this._y=e[c+1],this._z=e[c+2],this._w=e[c+3],this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._w,e}fromBufferAttribute(e,c){return this._x=e.getX(c),this._y=e.getY(c),this._z=e.getZ(c),this._w=e.getW(c),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}$i.prototype.isQuaternion=!0;class ht{constructor(e=0,c=0,d=0){this.x=e,this.y=c,this.z=d}set(e,c,d){return void 0===d&&(d=this.z),this.x=e,this.y=c,this.z=d,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,c)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,c){return this.x=e.x*c.x,this.y=e.y*c.y,this.z=e.z*c.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Mp.setFromEuler(e))}applyAxisAngle(e,c){return this.applyQuaternion(Mp.setFromAxisAngle(e,c))}applyMatrix3(e){const c=this.x,d=this.y,_=this.z,S=e.elements;return this.x=S[0]*c+S[3]*d+S[6]*_,this.y=S[1]*c+S[4]*d+S[7]*_,this.z=S[2]*c+S[5]*d+S[8]*_,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const c=this.x,d=this.y,_=this.z,S=e.elements,B=1/(S[3]*c+S[7]*d+S[11]*_+S[15]);return this.x=(S[0]*c+S[4]*d+S[8]*_+S[12])*B,this.y=(S[1]*c+S[5]*d+S[9]*_+S[13])*B,this.z=(S[2]*c+S[6]*d+S[10]*_+S[14])*B,this}applyQuaternion(e){const c=this.x,d=this.y,_=this.z,S=e.x,B=e.y,k=e.z,F=e.w,V=F*c+B*_-k*d,te=F*d+k*c-S*_,ce=F*_+S*d-B*c,ue=-S*c-B*d-k*_;return this.x=V*F+ue*-S+te*-k-ce*-B,this.y=te*F+ue*-B+ce*-S-V*-k,this.z=ce*F+ue*-k+V*-B-te*-S,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const c=this.x,d=this.y,_=this.z,S=e.elements;return this.x=S[0]*c+S[4]*d+S[8]*_,this.y=S[1]*c+S[5]*d+S[9]*_,this.z=S[2]*c+S[6]*d+S[10]*_,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this.z=e.z+(c.z-e.z)*d,this}cross(e,c){return void 0!==c?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,c)):this.crossVectors(this,e)}crossVectors(e,c){const d=e.x,_=e.y,S=e.z,B=c.x,k=c.y,F=c.z;return this.x=_*F-S*k,this.y=S*B-d*F,this.z=d*k-_*B,this}projectOnVector(e){const c=e.lengthSq();if(0===c)return this.set(0,0,0);const d=e.dot(this)/c;return this.copy(e).multiplyScalar(d)}projectOnPlane(e){return bu.copy(this).projectOnVector(e),this.sub(bu)}reflect(e){return this.sub(bu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const c=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===c)return Math.PI/2;const d=this.dot(e)/c;return Math.acos(Hr(d,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,d=this.y-e.y,_=this.z-e.z;return c*c+d*d+_*_}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,c,d){const _=Math.sin(c)*e;return this.x=_*Math.sin(d),this.y=Math.cos(c)*e,this.z=_*Math.cos(d),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,c,d){return this.x=e*Math.sin(c),this.y=d,this.z=e*Math.cos(c),this}setFromMatrixPosition(e){const c=e.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(e){const c=this.setFromMatrixColumn(e,0).length(),d=this.setFromMatrixColumn(e,1).length(),_=this.setFromMatrixColumn(e,2).length();return this.x=c,this.y=d,this.z=_,this}setFromMatrixColumn(e,c){return this.fromArray(e.elements,4*c)}setFromMatrix3Column(e,c){return this.fromArray(e.elements,3*c)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}ht.prototype.isVector3=!0;const bu=new ht,Mp=new $i;class Ui{constructor(e=new ht(1/0,1/0,1/0),c=new ht(-1/0,-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromArray(e){let c=1/0,d=1/0,_=1/0,S=-1/0,B=-1/0,k=-1/0;for(let F=0,V=e.length;F<V;F+=3){const te=e[F],ce=e[F+1],ue=e[F+2];te<c&&(c=te),ce<d&&(d=ce),ue<_&&(_=ue),te>S&&(S=te),ce>B&&(B=ce),ue>k&&(k=ue)}return this.min.set(c,d,_),this.max.set(S,B,k),this}setFromBufferAttribute(e){let c=1/0,d=1/0,_=1/0,S=-1/0,B=-1/0,k=-1/0;for(let F=0,V=e.count;F<V;F++){const te=e.getX(F),ce=e.getY(F),ue=e.getZ(F);te<c&&(c=te),ce<d&&(d=ce),ue<_&&(_=ue),te>S&&(S=te),ce>B&&(B=ce),ue>k&&(k=ue)}return this.min.set(c,d,_),this.max.set(S,B,k),this}setFromPoints(e){this.makeEmpty();for(let c=0,d=e.length;c<d;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const d=qr.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const c=e.geometry;void 0!==c&&(null===c.boundingBox&&c.computeBoundingBox(),Ya.copy(c.boundingBox),Ya.applyMatrix4(e.matrixWorld),this.union(Ya));const d=e.children;for(let _=0,S=d.length;_<S;_++)this.expandByObject(d[_]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qr),qr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let c,d;return e.normal.x>0?(c=e.normal.x*this.min.x,d=e.normal.x*this.max.x):(c=e.normal.x*this.max.x,d=e.normal.x*this.min.x),e.normal.y>0?(c+=e.normal.y*this.min.y,d+=e.normal.y*this.max.y):(c+=e.normal.y*this.max.y,d+=e.normal.y*this.min.y),e.normal.z>0?(c+=e.normal.z*this.min.z,d+=e.normal.z*this.max.z):(c+=e.normal.z*this.max.z,d+=e.normal.z*this.min.z),c<=-e.constant&&d>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sh),Tc.subVectors(this.max,Sh),bo.subVectors(e.a,Sh),_a.subVectors(e.b,Sh),xu.subVectors(e.c,Sh),Ec.subVectors(_a,bo),Zc.subVectors(xu,_a),wu.subVectors(bo,xu);let c=[0,-Ec.z,Ec.y,0,-Zc.z,Zc.y,0,-wu.z,wu.y,Ec.z,0,-Ec.x,Zc.z,0,-Zc.x,wu.z,0,-wu.x,-Ec.y,Ec.x,0,-Zc.y,Zc.x,0,-wu.y,wu.x,0];return!!Ja(c,bo,_a,xu,Tc)&&(c=[1,0,0,0,1,0,0,0,1],!!Ja(c,bo,_a,xu,Tc)&&(Kn.crossVectors(Ec,Zc),c=[Kn.x,Kn.y,Kn.z],Ja(c,bo,_a,xu,Tc)))}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qr).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ui.prototype.isBox3=!0;const kr=[new ht,new ht,new ht,new ht,new ht,new ht,new ht,new ht],qr=new ht,Ya=new Ui,bo=new ht,_a=new ht,xu=new ht,Ec=new ht,Zc=new ht,wu=new ht,Sh=new ht,Tc=new ht,Kn=new ht,Cl=new ht;function Ja(w,e,c,d,_){for(let S=0,B=w.length-3;S<=B;S+=3){Cl.fromArray(w,S);const k=_.x*Math.abs(Cl.x)+_.y*Math.abs(Cl.y)+_.z*Math.abs(Cl.z),F=e.dot(Cl),V=c.dot(Cl),te=d.dot(Cl);if(Math.max(-Math.max(F,V,te),Math.min(F,V,te))>k)return!1}return!0}const Ba=new Ui,Kl=new ht,Su=new ht,Na=new ht;class xo{constructor(e=new ht,c=-1){this.center=e,this.radius=c}set(e,c){return this.center.copy(e),this.radius=c,this}setFromPoints(e,c){const d=this.center;void 0!==c?d.copy(c):Ba.setFromPoints(e).getCenter(d);let _=0;for(let S=0,B=e.length;S<B;S++)_=Math.max(_,d.distanceToSquared(e[S]));return this.radius=Math.sqrt(_),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const c=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=c*c}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,c){const d=this.center.distanceToSquared(e);return c.copy(e),d>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Na.subVectors(e,this.center);const c=Na.lengthSq();if(c>this.radius*this.radius){const d=Math.sqrt(c),_=.5*(d-this.radius);this.center.add(Na.multiplyScalar(_/d)),this.radius+=_}return this}union(e){return Su.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Kl.copy(e.center).add(Su)),this.expandByPoint(Kl.copy(e.center).sub(Su)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const zs=new ht,Mc=new ht,it=new ht,xt=new ht,Ut=new ht,yn=new ht,qt=new ht;class fn{constructor(e=new ht,c=new ht(0,0,-1)){this.origin=e,this.direction=c}set(e,c){return this.origin.copy(e),this.direction.copy(c),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,c){return c.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,zs)),this}closestPointToPoint(e,c){c.subVectors(e,this.origin);const d=c.dot(this.direction);return d<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const c=zs.subVectors(e,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(e):(zs.copy(this.direction).multiplyScalar(c).add(this.origin),zs.distanceToSquared(e))}distanceSqToSegment(e,c,d,_){Mc.copy(e).add(c).multiplyScalar(.5),it.copy(c).sub(e).normalize(),xt.copy(this.origin).sub(Mc);const S=.5*e.distanceTo(c),B=-this.direction.dot(it),k=xt.dot(this.direction),F=-xt.dot(it),V=xt.lengthSq(),te=Math.abs(1-B*B);let ce,ue,_e,Ee;if(te>0)if(ce=B*F-k,ue=B*k-F,Ee=S*te,ce>=0)if(ue>=-Ee)if(ue<=Ee){const $e=1/te;ce*=$e,ue*=$e,_e=ce*(ce+B*ue+2*k)+ue*(B*ce+ue+2*F)+V}else ue=S,ce=Math.max(0,-(B*ue+k)),_e=-ce*ce+ue*(ue+2*F)+V;else ue=-S,ce=Math.max(0,-(B*ue+k)),_e=-ce*ce+ue*(ue+2*F)+V;else ue<=-Ee?(ce=Math.max(0,-(-B*S+k)),ue=ce>0?-S:Math.min(Math.max(-S,-F),S),_e=-ce*ce+ue*(ue+2*F)+V):ue<=Ee?(ce=0,ue=Math.min(Math.max(-S,-F),S),_e=ue*(ue+2*F)+V):(ce=Math.max(0,-(B*S+k)),ue=ce>0?S:Math.min(Math.max(-S,-F),S),_e=-ce*ce+ue*(ue+2*F)+V);else ue=B>0?-S:S,ce=Math.max(0,-(B*ue+k)),_e=-ce*ce+ue*(ue+2*F)+V;return d&&d.copy(this.direction).multiplyScalar(ce).add(this.origin),_&&_.copy(it).multiplyScalar(ue).add(Mc),_e}intersectSphere(e,c){zs.subVectors(e.center,this.origin);const d=zs.dot(this.direction),_=zs.dot(zs)-d*d,S=e.radius*e.radius;if(_>S)return null;const B=Math.sqrt(S-_),k=d-B,F=d+B;return k<0&&F<0?null:this.at(k<0?F:k,c)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const c=e.normal.dot(this.direction);if(0===c)return 0===e.distanceToPoint(this.origin)?0:null;const d=-(this.origin.dot(e.normal)+e.constant)/c;return d>=0?d:null}intersectPlane(e,c){const d=this.distanceToPlane(e);return null===d?null:this.at(d,c)}intersectsPlane(e){const c=e.distanceToPoint(this.origin);return 0===c||e.normal.dot(this.direction)*c<0}intersectBox(e,c){let d,_,S,B,k,F;const V=1/this.direction.x,te=1/this.direction.y,ce=1/this.direction.z,ue=this.origin;return V>=0?(d=(e.min.x-ue.x)*V,_=(e.max.x-ue.x)*V):(d=(e.max.x-ue.x)*V,_=(e.min.x-ue.x)*V),te>=0?(S=(e.min.y-ue.y)*te,B=(e.max.y-ue.y)*te):(S=(e.max.y-ue.y)*te,B=(e.min.y-ue.y)*te),d>B||S>_?null:((S>d||d!=d)&&(d=S),(B<_||_!=_)&&(_=B),ce>=0?(k=(e.min.z-ue.z)*ce,F=(e.max.z-ue.z)*ce):(k=(e.max.z-ue.z)*ce,F=(e.min.z-ue.z)*ce),d>F||k>_?null:((k>d||d!=d)&&(d=k),(F<_||_!=_)&&(_=F),_<0?null:this.at(d>=0?d:_,c)))}intersectsBox(e){return null!==this.intersectBox(e,zs)}intersectTriangle(e,c,d,_,S){Ut.subVectors(c,e),yn.subVectors(d,e),qt.crossVectors(Ut,yn);let B,k=this.direction.dot(qt);if(k>0){if(_)return null;B=1}else{if(!(k<0))return null;B=-1,k=-k}xt.subVectors(this.origin,e);const F=B*this.direction.dot(yn.crossVectors(xt,yn));if(F<0)return null;const V=B*this.direction.dot(Ut.cross(xt));if(V<0||F+V>k)return null;const te=-B*xt.dot(qt);return te<0?null:this.at(te/k,S)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,c,d,_,S,B,k,F,V,te,ce,ue,_e,Ee,$e,Be){const Re=this.elements;return Re[0]=e,Re[4]=c,Re[8]=d,Re[12]=_,Re[1]=S,Re[5]=B,Re[9]=k,Re[13]=F,Re[2]=V,Re[6]=te,Re[10]=ce,Re[14]=ue,Re[3]=_e,Re[7]=Ee,Re[11]=$e,Re[15]=Be,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new tn).fromArray(this.elements)}copy(e){const c=this.elements,d=e.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this}copyPosition(e){const c=this.elements,d=e.elements;return c[12]=d[12],c[13]=d[13],c[14]=d[14],this}setFromMatrix3(e){const c=e.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(e,c,d){return e.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(e,c,d){return this.set(e.x,c.x,d.x,0,e.y,c.y,d.y,0,e.z,c.z,d.z,0,0,0,0,1),this}extractRotation(e){const c=this.elements,d=e.elements,_=1/qn.setFromMatrixColumn(e,0).length(),S=1/qn.setFromMatrixColumn(e,1).length(),B=1/qn.setFromMatrixColumn(e,2).length();return c[0]=d[0]*_,c[1]=d[1]*_,c[2]=d[2]*_,c[3]=0,c[4]=d[4]*S,c[5]=d[5]*S,c[6]=d[6]*S,c[7]=0,c[8]=d[8]*B,c[9]=d[9]*B,c[10]=d[10]*B,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,d=e.x,_=e.y,S=e.z,B=Math.cos(d),k=Math.sin(d),F=Math.cos(_),V=Math.sin(_),te=Math.cos(S),ce=Math.sin(S);if("XYZ"===e.order){const ue=B*te,_e=B*ce,Ee=k*te,$e=k*ce;c[0]=F*te,c[4]=-F*ce,c[8]=V,c[1]=_e+Ee*V,c[5]=ue-$e*V,c[9]=-k*F,c[2]=$e-ue*V,c[6]=Ee+_e*V,c[10]=B*F}else if("YXZ"===e.order){const ue=F*te,_e=F*ce,Ee=V*te,$e=V*ce;c[0]=ue+$e*k,c[4]=Ee*k-_e,c[8]=B*V,c[1]=B*ce,c[5]=B*te,c[9]=-k,c[2]=_e*k-Ee,c[6]=$e+ue*k,c[10]=B*F}else if("ZXY"===e.order){const ue=F*te,_e=F*ce,Ee=V*te,$e=V*ce;c[0]=ue-$e*k,c[4]=-B*ce,c[8]=Ee+_e*k,c[1]=_e+Ee*k,c[5]=B*te,c[9]=$e-ue*k,c[2]=-B*V,c[6]=k,c[10]=B*F}else if("ZYX"===e.order){const ue=B*te,_e=B*ce,Ee=k*te,$e=k*ce;c[0]=F*te,c[4]=Ee*V-_e,c[8]=ue*V+$e,c[1]=F*ce,c[5]=$e*V+ue,c[9]=_e*V-Ee,c[2]=-V,c[6]=k*F,c[10]=B*F}else if("YZX"===e.order){const ue=B*F,_e=B*V,Ee=k*F,$e=k*V;c[0]=F*te,c[4]=$e-ue*ce,c[8]=Ee*ce+_e,c[1]=ce,c[5]=B*te,c[9]=-k*te,c[2]=-V*te,c[6]=_e*ce+Ee,c[10]=ue-$e*ce}else if("XZY"===e.order){const ue=B*F,_e=B*V,Ee=k*F,$e=k*V;c[0]=F*te,c[4]=-ce,c[8]=V*te,c[1]=ue*ce+$e,c[5]=B*te,c[9]=_e*ce-Ee,c[2]=Ee*ce-_e,c[6]=k*te,c[10]=$e*ce+ue}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sr,e,$r)}lookAt(e,c,d){const _=this.elements;return fi.subVectors(e,c),0===fi.lengthSq()&&(fi.z=1),fi.normalize(),yr.crossVectors(d,fi),0===yr.lengthSq()&&(1===Math.abs(d.z)?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),yr.crossVectors(d,fi)),yr.normalize(),Xr.crossVectors(fi,yr),_[0]=yr.x,_[4]=Xr.x,_[8]=fi.x,_[1]=yr.y,_[5]=Xr.y,_[9]=fi.y,_[2]=yr.z,_[6]=Xr.z,_[10]=fi.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,c)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const d=e.elements,_=c.elements,S=this.elements,B=d[0],k=d[4],F=d[8],V=d[12],te=d[1],ce=d[5],ue=d[9],_e=d[13],Ee=d[2],$e=d[6],Be=d[10],Re=d[14],We=d[3],tt=d[7],Ze=d[11],ot=d[15],st=_[0],Ct=_[4],Ft=_[8],Qe=_[12],nt=_[1],Et=_[5],Jt=_[9],ct=_[13],Lt=_[2],_t=_[6],zt=_[10],Rt=_[14],nn=_[3],en=_[7],En=_[11],rt=_[15];return S[0]=B*st+k*nt+F*Lt+V*nn,S[4]=B*Ct+k*Et+F*_t+V*en,S[8]=B*Ft+k*Jt+F*zt+V*En,S[12]=B*Qe+k*ct+F*Rt+V*rt,S[1]=te*st+ce*nt+ue*Lt+_e*nn,S[5]=te*Ct+ce*Et+ue*_t+_e*en,S[9]=te*Ft+ce*Jt+ue*zt+_e*En,S[13]=te*Qe+ce*ct+ue*Rt+_e*rt,S[2]=Ee*st+$e*nt+Be*Lt+Re*nn,S[6]=Ee*Ct+$e*Et+Be*_t+Re*en,S[10]=Ee*Ft+$e*Jt+Be*zt+Re*En,S[14]=Ee*Qe+$e*ct+Be*Rt+Re*rt,S[3]=We*st+tt*nt+Ze*Lt+ot*nn,S[7]=We*Ct+tt*Et+Ze*_t+ot*en,S[11]=We*Ft+tt*Jt+Ze*zt+ot*En,S[15]=We*Qe+tt*ct+Ze*Rt+ot*rt,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[4]*=e,c[8]*=e,c[12]*=e,c[1]*=e,c[5]*=e,c[9]*=e,c[13]*=e,c[2]*=e,c[6]*=e,c[10]*=e,c[14]*=e,c[3]*=e,c[7]*=e,c[11]*=e,c[15]*=e,this}determinant(){const e=this.elements,c=e[0],d=e[4],_=e[8],S=e[12],B=e[1],k=e[5],F=e[9],V=e[13],te=e[2],ce=e[6],ue=e[10],_e=e[14];return e[3]*(+S*F*ce-_*V*ce-S*k*ue+d*V*ue+_*k*_e-d*F*_e)+e[7]*(+c*F*_e-c*V*ue+S*B*ue-_*B*_e+_*V*te-S*F*te)+e[11]*(+c*V*ce-c*k*_e-S*B*ce+d*B*_e+S*k*te-d*V*te)+e[15]*(-_*k*te-c*F*ce+c*k*ue+_*B*ce-d*B*ue+d*F*te)}transpose(){const e=this.elements;let c;return c=e[1],e[1]=e[4],e[4]=c,c=e[2],e[2]=e[8],e[8]=c,c=e[6],e[6]=e[9],e[9]=c,c=e[3],e[3]=e[12],e[12]=c,c=e[7],e[7]=e[13],e[13]=c,c=e[11],e[11]=e[14],e[14]=c,this}setPosition(e,c,d){const _=this.elements;return e.isVector3?(_[12]=e.x,_[13]=e.y,_[14]=e.z):(_[12]=e,_[13]=c,_[14]=d),this}invert(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],B=e[4],k=e[5],F=e[6],V=e[7],te=e[8],ce=e[9],ue=e[10],_e=e[11],Ee=e[12],$e=e[13],Be=e[14],Re=e[15],We=ce*Be*V-$e*ue*V+$e*F*_e-k*Be*_e-ce*F*Re+k*ue*Re,tt=Ee*ue*V-te*Be*V-Ee*F*_e+B*Be*_e+te*F*Re-B*ue*Re,Ze=te*$e*V-Ee*ce*V+Ee*k*_e-B*$e*_e-te*k*Re+B*ce*Re,ot=Ee*ce*F-te*$e*F-Ee*k*ue+B*$e*ue+te*k*Be-B*ce*Be,st=c*We+d*tt+_*Ze+S*ot;if(0===st)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Ct=1/st;return e[0]=We*Ct,e[1]=($e*ue*S-ce*Be*S-$e*_*_e+d*Be*_e+ce*_*Re-d*ue*Re)*Ct,e[2]=(k*Be*S-$e*F*S+$e*_*V-d*Be*V-k*_*Re+d*F*Re)*Ct,e[3]=(ce*F*S-k*ue*S-ce*_*V+d*ue*V+k*_*_e-d*F*_e)*Ct,e[4]=tt*Ct,e[5]=(te*Be*S-Ee*ue*S+Ee*_*_e-c*Be*_e-te*_*Re+c*ue*Re)*Ct,e[6]=(Ee*F*S-B*Be*S-Ee*_*V+c*Be*V+B*_*Re-c*F*Re)*Ct,e[7]=(B*ue*S-te*F*S+te*_*V-c*ue*V-B*_*_e+c*F*_e)*Ct,e[8]=Ze*Ct,e[9]=(Ee*ce*S-te*$e*S-Ee*d*_e+c*$e*_e+te*d*Re-c*ce*Re)*Ct,e[10]=(B*$e*S-Ee*k*S+Ee*d*V-c*$e*V-B*d*Re+c*k*Re)*Ct,e[11]=(te*k*S-B*ce*S-te*d*V+c*ce*V+B*d*_e-c*k*_e)*Ct,e[12]=ot*Ct,e[13]=(te*$e*_-Ee*ce*_+Ee*d*ue-c*$e*ue-te*d*Be+c*ce*Be)*Ct,e[14]=(Ee*k*_-B*$e*_-Ee*d*F+c*$e*F+B*d*Be-c*k*Be)*Ct,e[15]=(B*ce*_-te*k*_+te*d*F-c*ce*F-B*d*ue+c*k*ue)*Ct,this}scale(e){const c=this.elements,d=e.x,_=e.y,S=e.z;return c[0]*=d,c[4]*=_,c[8]*=S,c[1]*=d,c[5]*=_,c[9]*=S,c[2]*=d,c[6]*=_,c[10]*=S,c[3]*=d,c[7]*=_,c[11]*=S,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,c,d){return this.set(1,0,0,e,0,1,0,c,0,0,1,d,0,0,0,1),this}makeRotationX(e){const c=Math.cos(e),d=Math.sin(e);return this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1),this}makeRotationY(e){const c=Math.cos(e),d=Math.sin(e);return this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1),this}makeRotationZ(e){const c=Math.cos(e),d=Math.sin(e);return this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,c){const d=Math.cos(c),_=Math.sin(c),S=1-d,B=e.x,k=e.y,F=e.z,V=S*B,te=S*k;return this.set(V*B+d,V*k-_*F,V*F+_*k,0,V*k+_*F,te*k+d,te*F-_*B,0,V*F-_*k,te*F+_*B,S*F*F+d,0,0,0,0,1),this}makeScale(e,c,d){return this.set(e,0,0,0,0,c,0,0,0,0,d,0,0,0,0,1),this}makeShear(e,c,d,_,S,B){return this.set(1,d,S,0,e,1,B,0,c,_,1,0,0,0,0,1),this}compose(e,c,d){const _=this.elements,S=c._x,B=c._y,k=c._z,F=c._w,V=S+S,te=B+B,ce=k+k,ue=S*V,_e=S*te,Ee=S*ce,$e=B*te,Be=B*ce,Re=k*ce,We=F*V,tt=F*te,Ze=F*ce,ot=d.x,st=d.y,Ct=d.z;return _[0]=(1-($e+Re))*ot,_[1]=(_e+Ze)*ot,_[2]=(Ee-tt)*ot,_[3]=0,_[4]=(_e-Ze)*st,_[5]=(1-(ue+Re))*st,_[6]=(Be+We)*st,_[7]=0,_[8]=(Ee+tt)*Ct,_[9]=(Be-We)*Ct,_[10]=(1-(ue+$e))*Ct,_[11]=0,_[12]=e.x,_[13]=e.y,_[14]=e.z,_[15]=1,this}decompose(e,c,d){const _=this.elements;let S=qn.set(_[0],_[1],_[2]).length();const B=qn.set(_[4],_[5],_[6]).length(),k=qn.set(_[8],_[9],_[10]).length();this.determinant()<0&&(S=-S),e.x=_[12],e.y=_[13],e.z=_[14],Gn.copy(this);const F=1/S,V=1/B,te=1/k;return Gn.elements[0]*=F,Gn.elements[1]*=F,Gn.elements[2]*=F,Gn.elements[4]*=V,Gn.elements[5]*=V,Gn.elements[6]*=V,Gn.elements[8]*=te,Gn.elements[9]*=te,Gn.elements[10]*=te,c.setFromRotationMatrix(Gn),d.x=S,d.y=B,d.z=k,this}makePerspective(e,c,d,_,S,B){void 0===B&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const k=this.elements,V=2*S/(d-_),te=(c+e)/(c-e),ce=(d+_)/(d-_),ue=-(B+S)/(B-S),_e=-2*B*S/(B-S);return k[0]=2*S/(c-e),k[4]=0,k[8]=te,k[12]=0,k[1]=0,k[5]=V,k[9]=ce,k[13]=0,k[2]=0,k[6]=0,k[10]=ue,k[14]=_e,k[3]=0,k[7]=0,k[11]=-1,k[15]=0,this}makeOrthographic(e,c,d,_,S,B){const k=this.elements,F=1/(c-e),V=1/(d-_),te=1/(B-S),ce=(c+e)*F,ue=(d+_)*V,_e=(B+S)*te;return k[0]=2*F,k[4]=0,k[8]=0,k[12]=-ce,k[1]=0,k[5]=2*V,k[9]=0,k[13]=-ue,k[2]=0,k[6]=0,k[10]=-2*te,k[14]=-_e,k[3]=0,k[7]=0,k[11]=0,k[15]=1,this}equals(e){const c=this.elements,d=e.elements;for(let _=0;_<16;_++)if(c[_]!==d[_])return!1;return!0}fromArray(e,c=0){for(let d=0;d<16;d++)this.elements[d]=e[d+c];return this}toArray(e=[],c=0){const d=this.elements;return e[c]=d[0],e[c+1]=d[1],e[c+2]=d[2],e[c+3]=d[3],e[c+4]=d[4],e[c+5]=d[5],e[c+6]=d[6],e[c+7]=d[7],e[c+8]=d[8],e[c+9]=d[9],e[c+10]=d[10],e[c+11]=d[11],e[c+12]=d[12],e[c+13]=d[13],e[c+14]=d[14],e[c+15]=d[15],e}}tn.prototype.isMatrix4=!0;const qn=new ht,Gn=new tn,Sr=new ht(0,0,0),$r=new ht(1,1,1),yr=new ht,Xr=new ht,fi=new ht,Rr=new tn,ts=new $i;class co{constructor(e=0,c=0,d=0,_=co.DefaultOrder){this._x=e,this._y=c,this._z=d,this._order=_}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,c,d,_=this._order){return this._x=e,this._y=c,this._z=d,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,c=this._order,d=!0){const _=e.elements,S=_[0],B=_[4],k=_[8],F=_[1],V=_[5],te=_[9],ce=_[2],ue=_[6],_e=_[10];switch(c){case"XYZ":this._y=Math.asin(Hr(k,-1,1)),Math.abs(k)<.9999999?(this._x=Math.atan2(-te,_e),this._z=Math.atan2(-B,S)):(this._x=Math.atan2(ue,V),this._z=0);break;case"YXZ":this._x=Math.asin(-Hr(te,-1,1)),Math.abs(te)<.9999999?(this._y=Math.atan2(k,_e),this._z=Math.atan2(F,V)):(this._y=Math.atan2(-ce,S),this._z=0);break;case"ZXY":this._x=Math.asin(Hr(ue,-1,1)),Math.abs(ue)<.9999999?(this._y=Math.atan2(-ce,_e),this._z=Math.atan2(-B,V)):(this._y=0,this._z=Math.atan2(F,S));break;case"ZYX":this._y=Math.asin(-Hr(ce,-1,1)),Math.abs(ce)<.9999999?(this._x=Math.atan2(ue,_e),this._z=Math.atan2(F,S)):(this._x=0,this._z=Math.atan2(-B,V));break;case"YZX":this._z=Math.asin(Hr(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(-te,V),this._y=Math.atan2(-ce,S)):(this._x=0,this._y=Math.atan2(k,_e));break;case"XZY":this._z=Math.asin(-Hr(B,-1,1)),Math.abs(B)<.9999999?(this._x=Math.atan2(ue,V),this._y=Math.atan2(k,S)):(this._x=Math.atan2(-te,_e),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,!0===d&&this._onChangeCallback(),this}setFromQuaternion(e,c,d){return Rr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Rr,c,d)}setFromVector3(e,c=this._order){return this.set(e.x,e.y,e.z,c)}reorder(e){return ts.setFromEuler(this),this.setFromQuaternion(ts,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ht(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}co.prototype.isEuler=!0,co.DefaultOrder="XYZ",co.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Qs{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}}let Bo=0;const ec=new ht,Yo=new $i,Xi=new tn,Ac=new ht,Yh=new ht,rh=new ht,Ap=new $i,Eh=new ht(1,0,0),cd=new ht(0,1,0),Th=new ht(0,0,1),Rd={type:"added"},ud={type:"removed"};class Pr extends Ds{constructor(){super(),Object.defineProperty(this,"id",{value:Bo++}),this.uuid=Qi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pr.DefaultUp.clone();const e=new ht,c=new co,d=new $i,_=new ht(1,1,1);c._onChange(function(){d.setFromEuler(c,!1)}),d._onChange(function(){c.setFromQuaternion(d,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:d},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new tn},normalMatrix:{value:new lt}}),this.matrix=new tn,this.matrixWorld=new tn,this.matrixAutoUpdate=Pr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Qs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,c){this.quaternion.setFromAxisAngle(e,c)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,c){return Yo.setFromAxisAngle(e,c),this.quaternion.multiply(Yo),this}rotateOnWorldAxis(e,c){return Yo.setFromAxisAngle(e,c),this.quaternion.premultiply(Yo),this}rotateX(e){return this.rotateOnAxis(Eh,e)}rotateY(e){return this.rotateOnAxis(cd,e)}rotateZ(e){return this.rotateOnAxis(Th,e)}translateOnAxis(e,c){return ec.copy(e).applyQuaternion(this.quaternion),this.position.add(ec.multiplyScalar(c)),this}translateX(e){return this.translateOnAxis(Eh,e)}translateY(e){return this.translateOnAxis(cd,e)}translateZ(e){return this.translateOnAxis(Th,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Xi.copy(this.matrixWorld).invert())}lookAt(e,c,d){e.isVector3?Ac.copy(e):Ac.set(e,c,d);const _=this.parent;this.updateWorldMatrix(!0,!1),Yh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xi.lookAt(Yh,Ac,this.up):Xi.lookAt(Ac,Yh,this.up),this.quaternion.setFromRotationMatrix(Xi),_&&(Xi.extractRotation(_.matrixWorld),Yo.setFromRotationMatrix(Xi),this.quaternion.premultiply(Yo.invert()))}add(e){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Rd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.remove(arguments[d]);return this}const c=this.children.indexOf(e);return-1!==c&&(e.parent=null,this.children.splice(c,1),e.dispatchEvent(ud)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const c=this.children[e];c.parent=null,c.dispatchEvent(ud)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Xi.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Xi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,c){if(this[e]===c)return this;for(let d=0,_=this.children.length;d<_;d++){const S=this.children[d].getObjectByProperty(e,c);if(void 0!==S)return S}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yh,e,rh),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yh,Ap,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(e){e(this);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].traverseVisible(e)}traverseAncestors(e){const c=this.parent;null!==c&&(e(c),c.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].updateMatrixWorld(e)}updateWorldMatrix(e,c){const d=this.parent;if(!0===e&&null!==d&&d.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===c){const _=this.children;for(let S=0,B=_.length;S<B;S++)_[S].updateWorldMatrix(!1,!0)}}toJSON(e){const c=void 0===e||"string"==typeof e,d={};c&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},d.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const _={};function S(k,F){return void 0===k[F.uuid]&&(k[F.uuid]=F.toJSON(e)),F.uuid}if(_.uuid=this.uuid,_.type=this.type,""!==this.name&&(_.name=this.name),!0===this.castShadow&&(_.castShadow=!0),!0===this.receiveShadow&&(_.receiveShadow=!0),!1===this.visible&&(_.visible=!1),!1===this.frustumCulled&&(_.frustumCulled=!1),0!==this.renderOrder&&(_.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(_.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(_.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=S(e.geometries,this.geometry);const k=this.geometry.parameters;if(void 0!==k&&void 0!==k.shapes){const F=k.shapes;if(Array.isArray(F))for(let V=0,te=F.length;V<te;V++)S(e.shapes,F[V]);else S(e.shapes,F)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(S(e.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const k=[];for(let F=0,V=this.material.length;F<V;F++)k.push(S(e.materials,this.material[F]));_.material=k}else _.material=S(e.materials,this.material);if(this.children.length>0){_.children=[];for(let k=0;k<this.children.length;k++)_.children.push(this.children[k].toJSON(e).object)}if(this.animations.length>0){_.animations=[];for(let k=0;k<this.animations.length;k++)_.animations.push(S(e.animations,this.animations[k]))}if(c){const k=B(e.geometries),F=B(e.materials),V=B(e.textures),te=B(e.images),ce=B(e.shapes),ue=B(e.skeletons),_e=B(e.animations);k.length>0&&(d.geometries=k),F.length>0&&(d.materials=F),V.length>0&&(d.textures=V),te.length>0&&(d.images=te),ce.length>0&&(d.shapes=ce),ue.length>0&&(d.skeletons=ue),_e.length>0&&(d.animations=_e)}return d.object=_,d;function B(k){const F=[];for(const V in k){const te=k[V];delete te.metadata,F.push(te)}return F}}clone(e){return(new this.constructor).copy(this,e)}copy(e,c=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===c)for(let d=0;d<e.children.length;d++)this.add(e.children[d].clone());return this}}Pr.DefaultUp=new ht(0,1,0),Pr.DefaultMatrixAutoUpdate=!0,Pr.prototype.isObject3D=!0;const $c=new ht,Ks=new ht,$p=new ht,ar=new ht,Ll=new ht,Mh=new ht,Jh=new ht,ga=new ht,hd=new ht,zr=new ht;class eo{constructor(e=new ht,c=new ht,d=new ht){this.a=e,this.b=c,this.c=d}static getNormal(e,c,d,_){_.subVectors(d,c),$c.subVectors(e,c),_.cross($c);const S=_.lengthSq();return S>0?_.multiplyScalar(1/Math.sqrt(S)):_.set(0,0,0)}static getBarycoord(e,c,d,_,S){$c.subVectors(_,c),Ks.subVectors(d,c),$p.subVectors(e,c);const B=$c.dot($c),k=$c.dot(Ks),F=$c.dot($p),V=Ks.dot(Ks),te=Ks.dot($p),ce=B*V-k*k;if(0===ce)return S.set(-2,-1,-1);const ue=1/ce,_e=(V*F-k*te)*ue,Ee=(B*te-k*F)*ue;return S.set(1-_e-Ee,Ee,_e)}static containsPoint(e,c,d,_){return this.getBarycoord(e,c,d,_,ar),ar.x>=0&&ar.y>=0&&ar.x+ar.y<=1}static getUV(e,c,d,_,S,B,k,F){return this.getBarycoord(e,c,d,_,ar),F.set(0,0),F.addScaledVector(S,ar.x),F.addScaledVector(B,ar.y),F.addScaledVector(k,ar.z),F}static isFrontFacing(e,c,d,_){return $c.subVectors(d,c),Ks.subVectors(e,c),$c.cross(Ks).dot(_)<0}set(e,c,d){return this.a.copy(e),this.b.copy(c),this.c.copy(d),this}setFromPointsAndIndices(e,c,d,_){return this.a.copy(e[c]),this.b.copy(e[d]),this.c.copy(e[_]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $c.subVectors(this.c,this.b),Ks.subVectors(this.a,this.b),.5*$c.cross(Ks).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return eo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,c){return eo.getBarycoord(e,this.a,this.b,this.c,c)}getUV(e,c,d,_,S){return eo.getUV(e,this.a,this.b,this.c,c,d,_,S)}containsPoint(e){return eo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return eo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,c){const d=this.a,_=this.b,S=this.c;let B,k;Ll.subVectors(_,d),Mh.subVectors(S,d),ga.subVectors(e,d);const F=Ll.dot(ga),V=Mh.dot(ga);if(F<=0&&V<=0)return c.copy(d);hd.subVectors(e,_);const te=Ll.dot(hd),ce=Mh.dot(hd);if(te>=0&&ce<=te)return c.copy(_);const ue=F*ce-te*V;if(ue<=0&&F>=0&&te<=0)return B=F/(F-te),c.copy(d).addScaledVector(Ll,B);zr.subVectors(e,S);const _e=Ll.dot(zr),Ee=Mh.dot(zr);if(Ee>=0&&_e<=Ee)return c.copy(S);const $e=_e*V-F*Ee;if($e<=0&&V>=0&&Ee<=0)return k=V/(V-Ee),c.copy(d).addScaledVector(Mh,k);const Be=te*Ee-_e*ce;if(Be<=0&&ce-te>=0&&_e-Ee>=0)return Jh.subVectors(S,_),k=(ce-te)/(ce-te+(_e-Ee)),c.copy(_).addScaledVector(Jh,k);const Re=1/(Be+$e+ue);return B=$e*Re,k=ue*Re,c.copy(d).addScaledVector(Ll,B).addScaledVector(Mh,k)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let No=0;class Cs extends Ds{constructor(){super(),Object.defineProperty(this,"id",{value:No++}),this.uuid=Qi(),this.name="",this.type="Material",this.fog=!0,this.blending=oe,this.side=le,this.vertexColors=!1,this.opacity=1,this.format=lo,this.transparent=!1,this.blendSrc=Gt,this.blendDst=Dt,this.blendEquation=Pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=cr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=da,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qe,this.stencilZFail=qe,this.stencilZPass=qe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const c in e){const d=e[c];if(void 0===d){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if("shading"===c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=d===A;continue}const _=this[c];void 0!==_?_&&_.isColor?_.set(d):_&&_.isVector3&&d&&d.isVector3?_.copy(d):this[c]=d:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")}}toJSON(e){const c=void 0===e||"string"==typeof e;c&&(e={textures:{},images:{}});const d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function _(S){const B=[];for(const k in S){const F=S[k];delete F.metadata,B.push(F)}return B}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(d.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(d.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(e).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(e).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(e).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(e).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(e).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(d.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(d.combine=this.combine)),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(d.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(d.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(d.size=this.size),null!==this.shadowSide&&(d.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),this.blending!==oe&&(d.blending=this.blending),this.side!==le&&(d.side=this.side),this.vertexColors&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),this.format!==lo&&(d.format=this.format),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.colorWrite=this.colorWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(d.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(d.flatShading=this.flatShading),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c){const S=_(e.textures),B=_(e.images);S.length>0&&(d.textures=S),B.length>0&&(d.images=B)}return d}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const c=e.clippingPlanes;let d=null;if(null!==c){const _=c.length;d=new Array(_);for(let S=0;S!==_;++S)d[S]=c[S].clone()}return this.clippingPlanes=d,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}Cs.prototype.isMaterial=!0;const Vr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dl={h:0,s:0,l:0},Cc={h:0,s:0,l:0};function ih(w,e,c){return c<0&&(c+=1),c>1&&(c-=1),c<.16666666666666666?w+6*(e-w)*c:c<.5?e:c<.6666666666666666?w+6*(e-w)*(.6666666666666666-c):w}function Zh(w){return w<.04045?.0773993808*w:Math.pow(.9478672986*w+.0521327014,2.4)}function Bl(w){return w<.0031308?12.92*w:1.055*Math.pow(w,.41666)-.055}class er{constructor(e,c,d){return void 0===c&&void 0===d?this.set(e):this.setRGB(e,c,d)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,c,d){return this.r=e,this.g=c,this.b=d,this}setHSL(e,c,d){if(e=di(e,1),c=Hr(c,0,1),d=Hr(d,0,1),0===c)this.r=this.g=this.b=d;else{const _=d<=.5?d*(1+c):d+c-d*c,S=2*d-_;this.r=ih(S,_,e+.3333333333333333),this.g=ih(S,_,e),this.b=ih(S,_,e-.3333333333333333)}return this}setStyle(e){function c(_){void 0!==_&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let d;if(d=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let _;const B=d[2];switch(d[1]){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,c(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,c(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(B)){const k=parseFloat(_[1])/360,F=parseInt(_[2],10)/100,V=parseInt(_[3],10)/100;return c(_[4]),this.setHSL(k,F,V)}}}else if(d=/^\#([A-Fa-f\d]+)$/.exec(e)){const _=d[1],S=_.length;if(3===S)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(6===S)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const c=Vr[e.toLowerCase()];return void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,c=2){return this.r=Math.pow(e.r,c),this.g=Math.pow(e.g,c),this.b=Math.pow(e.b,c),this}copyLinearToGamma(e,c=2){const d=c>0?1/c:1;return this.r=Math.pow(e.r,d),this.g=Math.pow(e.g,d),this.b=Math.pow(e.b,d),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Zh(e.r),this.g=Zh(e.g),this.b=Zh(e.b),this}copyLinearToSRGB(e){return this.r=Bl(e.r),this.g=Bl(e.g),this.b=Bl(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const c=this.r,d=this.g,_=this.b,S=Math.max(c,d,_),B=Math.min(c,d,_);let k,F;const V=(B+S)/2;if(B===S)k=0,F=0;else{const te=S-B;switch(F=V<=.5?te/(S+B):te/(2-S-B),S){case c:k=(d-_)/te+(d<_?6:0);break;case d:k=(_-c)/te+2;break;case _:k=(c-d)/te+4}k/=6}return e.h=k,e.s=F,e.l=V,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,c,d){return this.getHSL(dl),dl.h+=e,dl.s+=c,dl.l+=d,this.setHSL(dl.h,dl.s,dl.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,c){return this.r=e.r+c.r,this.g=e.g+c.g,this.b=e.b+c.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,c){return this.r+=(e.r-this.r)*c,this.g+=(e.g-this.g)*c,this.b+=(e.b-this.b)*c,this}lerpColors(e,c,d){return this.r=e.r+(c.r-e.r)*d,this.g=e.g+(c.g-e.g)*d,this.b=e.b+(c.b-e.b)*d,this}lerpHSL(e,c){this.getHSL(dl),e.getHSL(Cc);const d=xi(dl.h,Cc.h,c),_=xi(dl.s,Cc.s,c),S=xi(dl.l,Cc.l,c);return this.setHSL(d,_,S),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,c=0){return this.r=e[c],this.g=e[c+1],this.b=e[c+2],this}toArray(e=[],c=0){return e[c]=this.r,e[c+1]=this.g,e[c+2]=this.b,e}fromBufferAttribute(e,c){return this.r=e.getX(c),this.g=e.getY(c),this.b=e.getZ(c),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}er.NAMES=Vr,er.prototype.isColor=!0,er.prototype.r=1,er.prototype.g=1,er.prototype.b=1;class fl extends Cs{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new er(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}fl.prototype.isMeshBasicMaterial=!0;const Un=new ht,Nl=new zn;class Pi{constructor(e,c,d){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=c,this.count=void 0!==e?e.length/c:0,this.normalized=!0===d,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,c,d){e*=this.itemSize,d*=c.itemSize;for(let _=0,S=this.itemSize;_<S;_++)this.array[e+_]=c.array[d+_];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let B=e[_];void 0===B&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",_),B=new er),c[d++]=B.r,c[d++]=B.g,c[d++]=B.b}return this}copyVector2sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let B=e[_];void 0===B&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",_),B=new zn),c[d++]=B.x,c[d++]=B.y}return this}copyVector3sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let B=e[_];void 0===B&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",_),B=new ht),c[d++]=B.x,c[d++]=B.y,c[d++]=B.z}return this}copyVector4sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let B=e[_];void 0===B&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",_),B=new Di),c[d++]=B.x,c[d++]=B.y,c[d++]=B.z,c[d++]=B.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let c=0,d=this.count;c<d;c++)Nl.fromBufferAttribute(this,c),Nl.applyMatrix3(e),this.setXY(c,Nl.x,Nl.y);else if(3===this.itemSize)for(let c=0,d=this.count;c<d;c++)Un.fromBufferAttribute(this,c),Un.applyMatrix3(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}applyMatrix4(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.applyMatrix4(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}applyNormalMatrix(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.applyNormalMatrix(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}transformDirection(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.transformDirection(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}set(e,c=0){return this.array.set(e,c),this}getX(e){return this.array[e*this.itemSize]}setX(e,c){return this.array[e*this.itemSize]=c,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,c){return this.array[e*this.itemSize+1]=c,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,c){return this.array[e*this.itemSize+2]=c,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,c){return this.array[e*this.itemSize+3]=c,this}setXY(e,c,d){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this}setXYZ(e,c,d,_){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this.array[e+2]=_,this}setXYZW(e,c,d,_,S){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this.array[e+2]=_,this.array[e+3]=S,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==bi&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}Pi.prototype.isBufferAttribute=!0;class Pd extends Pi{constructor(e,c,d){super(new Int8Array(e),c,d)}}class Cp extends Pi{constructor(e,c,d){super(new Uint8Array(e),c,d)}}class Ra extends Pi{constructor(e,c,d){super(new Uint8ClampedArray(e),c,d)}}class oh extends Pi{constructor(e,c,d){super(new Int16Array(e),c,d)}}class sh extends Pi{constructor(e,c,d){super(new Uint16Array(e),c,d)}}class Pa extends Pi{constructor(e,c,d){super(new Int32Array(e),c,d)}}class li extends Pi{constructor(e,c,d){super(new Uint32Array(e),c,d)}}class Zr extends Pi{constructor(e,c,d){super(new Uint16Array(e),c,d)}}Zr.prototype.isFloat16BufferAttribute=!0;class hn extends Pi{constructor(e,c,d){super(new Float32Array(e),c,d)}}class Qc extends Pi{constructor(e,c,d){super(new Float64Array(e),c,d)}}function ci(w){if(0===w.length)return-1/0;let e=w[0];for(let c=1,d=w.length;c<d;++c)w[c]>e&&(e=w[c]);return e}const va={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Za(w,e){return new va[w](e)}let Rn=0;const wi=new tn,ms=new Pr,gs=new ht,Ls=new Ui,ii=new Ui,Tr=new ht;class br extends Ds{constructor(){super(),Object.defineProperty(this,"id",{value:Rn++}),this.uuid=Qi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ci(e)>65535?li:sh)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,c){return this.attributes[e]=c,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,c,d=0){this.groups.push({start:e,count:c,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(e,c){this.drawRange.start=e,this.drawRange.count=c}applyMatrix4(e){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(e),c.needsUpdate=!0);const d=this.attributes.normal;if(void 0!==d){const S=(new lt).getNormalMatrix(e);d.applyNormalMatrix(S),d.needsUpdate=!0}const _=this.attributes.tangent;return void 0!==_&&(_.transformDirection(e),_.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return wi.makeRotationFromQuaternion(e),this.applyMatrix4(wi),this}rotateX(e){return wi.makeRotationX(e),this.applyMatrix4(wi),this}rotateY(e){return wi.makeRotationY(e),this.applyMatrix4(wi),this}rotateZ(e){return wi.makeRotationZ(e),this.applyMatrix4(wi),this}translate(e,c,d){return wi.makeTranslation(e,c,d),this.applyMatrix4(wi),this}scale(e,c,d){return wi.makeScale(e,c,d),this.applyMatrix4(wi),this}lookAt(e){return ms.lookAt(e),ms.updateMatrix(),this.applyMatrix4(ms.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(gs).negate(),this.translate(gs.x,gs.y,gs.z),this}setFromPoints(e){const c=[];for(let d=0,_=e.length;d<_;d++){const S=e[d];c.push(S.x,S.y,S.z||0)}return this.setAttribute("position",new hn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ui);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ht(-1/0,-1/0,-1/0),new ht(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),c)for(let d=0,_=c.length;d<_;d++)Ls.setFromBufferAttribute(c[d]),this.morphTargetsRelative?(Tr.addVectors(this.boundingBox.min,Ls.min),this.boundingBox.expandByPoint(Tr),Tr.addVectors(this.boundingBox.max,Ls.max),this.boundingBox.expandByPoint(Tr)):(this.boundingBox.expandByPoint(Ls.min),this.boundingBox.expandByPoint(Ls.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new xo);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ht,1/0);if(e){const d=this.boundingSphere.center;if(Ls.setFromBufferAttribute(e),c)for(let S=0,B=c.length;S<B;S++)ii.setFromBufferAttribute(c[S]),this.morphTargetsRelative?(Tr.addVectors(Ls.min,ii.min),Ls.expandByPoint(Tr),Tr.addVectors(Ls.max,ii.max),Ls.expandByPoint(Tr)):(Ls.expandByPoint(ii.min),Ls.expandByPoint(ii.max));Ls.getCenter(d);let _=0;for(let S=0,B=e.count;S<B;S++)Tr.fromBufferAttribute(e,S),_=Math.max(_,d.distanceToSquared(Tr));if(c)for(let S=0,B=c.length;S<B;S++){const k=c[S],F=this.morphTargetsRelative;for(let V=0,te=k.count;V<te;V++)Tr.fromBufferAttribute(k,V),F&&(gs.fromBufferAttribute(e,V),Tr.add(gs)),_=Math.max(_,d.distanceToSquared(Tr))}this.boundingSphere.radius=Math.sqrt(_),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,c=this.attributes;if(null===e||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const d=e.array,_=c.position.array,S=c.normal.array,B=c.uv.array,k=_.length/3;void 0===c.tangent&&this.setAttribute("tangent",new Pi(new Float32Array(4*k),4));const F=c.tangent.array,V=[],te=[];for(let nt=0;nt<k;nt++)V[nt]=new ht,te[nt]=new ht;const ce=new ht,ue=new ht,_e=new ht,Ee=new zn,$e=new zn,Be=new zn,Re=new ht,We=new ht;function tt(nt,Et,Jt){ce.fromArray(_,3*nt),ue.fromArray(_,3*Et),_e.fromArray(_,3*Jt),Ee.fromArray(B,2*nt),$e.fromArray(B,2*Et),Be.fromArray(B,2*Jt),ue.sub(ce),_e.sub(ce),$e.sub(Ee),Be.sub(Ee);const ct=1/($e.x*Be.y-Be.x*$e.y);isFinite(ct)&&(Re.copy(ue).multiplyScalar(Be.y).addScaledVector(_e,-$e.y).multiplyScalar(ct),We.copy(_e).multiplyScalar($e.x).addScaledVector(ue,-Be.x).multiplyScalar(ct),V[nt].add(Re),V[Et].add(Re),V[Jt].add(Re),te[nt].add(We),te[Et].add(We),te[Jt].add(We))}let Ze=this.groups;0===Ze.length&&(Ze=[{start:0,count:d.length}]);for(let nt=0,Et=Ze.length;nt<Et;++nt){const Jt=Ze[nt],ct=Jt.start;for(let Lt=ct,_t=ct+Jt.count;Lt<_t;Lt+=3)tt(d[Lt+0],d[Lt+1],d[Lt+2])}const ot=new ht,st=new ht,Ct=new ht,Ft=new ht;function Qe(nt){Ct.fromArray(S,3*nt),Ft.copy(Ct);const Et=V[nt];ot.copy(Et),ot.sub(Ct.multiplyScalar(Ct.dot(Et))).normalize(),st.crossVectors(Ft,Et);const Jt=st.dot(te[nt])<0?-1:1;F[4*nt]=ot.x,F[4*nt+1]=ot.y,F[4*nt+2]=ot.z,F[4*nt+3]=Jt}for(let nt=0,Et=Ze.length;nt<Et;++nt){const Jt=Ze[nt],ct=Jt.start;for(let Lt=ct,_t=ct+Jt.count;Lt<_t;Lt+=3)Qe(d[Lt+0]),Qe(d[Lt+1]),Qe(d[Lt+2])}}computeVertexNormals(){const e=this.index,c=this.getAttribute("position");if(void 0!==c){let d=this.getAttribute("normal");if(void 0===d)d=new Pi(new Float32Array(3*c.count),3),this.setAttribute("normal",d);else for(let ue=0,_e=d.count;ue<_e;ue++)d.setXYZ(ue,0,0,0);const _=new ht,S=new ht,B=new ht,k=new ht,F=new ht,V=new ht,te=new ht,ce=new ht;if(e)for(let ue=0,_e=e.count;ue<_e;ue+=3){const Ee=e.getX(ue+0),$e=e.getX(ue+1),Be=e.getX(ue+2);_.fromBufferAttribute(c,Ee),S.fromBufferAttribute(c,$e),B.fromBufferAttribute(c,Be),te.subVectors(B,S),ce.subVectors(_,S),te.cross(ce),k.fromBufferAttribute(d,Ee),F.fromBufferAttribute(d,$e),V.fromBufferAttribute(d,Be),k.add(te),F.add(te),V.add(te),d.setXYZ(Ee,k.x,k.y,k.z),d.setXYZ($e,F.x,F.y,F.z),d.setXYZ(Be,V.x,V.y,V.z)}else for(let ue=0,_e=c.count;ue<_e;ue+=3)_.fromBufferAttribute(c,ue+0),S.fromBufferAttribute(c,ue+1),B.fromBufferAttribute(c,ue+2),te.subVectors(B,S),ce.subVectors(_,S),te.cross(ce),d.setXYZ(ue+0,te.x,te.y,te.z),d.setXYZ(ue+1,te.x,te.y,te.z),d.setXYZ(ue+2,te.x,te.y,te.z);this.normalizeNormals(),d.needsUpdate=!0}}merge(e,c){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===c&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const d=this.attributes;for(const _ in d){if(void 0===e.attributes[_])continue;const S=d[_].array,B=e.attributes[_],k=B.array,F=B.itemSize*c,V=Math.min(k.length,S.length-F);for(let te=0,ce=F;te<V;te++,ce++)S[ce]=k[te]}return this}normalizeNormals(){const e=this.attributes.normal;for(let c=0,d=e.count;c<d;c++)Tr.fromBufferAttribute(e,c),Tr.normalize(),e.setXYZ(c,Tr.x,Tr.y,Tr.z)}toNonIndexed(){function e(k,F){const V=k.array,te=k.itemSize,ce=k.normalized,ue=new V.constructor(F.length*te);let _e=0,Ee=0;for(let $e=0,Be=F.length;$e<Be;$e++){_e=k.isInterleavedBufferAttribute?F[$e]*k.data.stride+k.offset:F[$e]*te;for(let Re=0;Re<te;Re++)ue[Ee++]=V[_e++]}return new Pi(ue,te,ce)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new br,d=this.index.array,_=this.attributes;for(const k in _){const F=e(_[k],d);c.setAttribute(k,F)}const S=this.morphAttributes;for(const k in S){const F=[],V=S[k];for(let te=0,ce=V.length;te<ce;te++){const ue=e(V[te],d);F.push(ue)}c.morphAttributes[k]=F}c.morphTargetsRelative=this.morphTargetsRelative;const B=this.groups;for(let k=0,F=B.length;k<F;k++){const V=B[k];c.addGroup(V.start,V.count,V.materialIndex)}return c}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const F=this.parameters;for(const V in F)void 0!==F[V]&&(e[V]=F[V]);return e}e.data={attributes:{}};const c=this.index;null!==c&&(e.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const d=this.attributes;for(const F in d)e.data.attributes[F]=d[F].toJSON(e.data);const _={};let S=!1;for(const F in this.morphAttributes){const V=this.morphAttributes[F],te=[];for(let ce=0,ue=V.length;ce<ue;ce++)te.push(V[ce].toJSON(e.data));te.length>0&&(_[F]=te,S=!0)}S&&(e.data.morphAttributes=_,e.data.morphTargetsRelative=this.morphTargetsRelative);const B=this.groups;B.length>0&&(e.data.groups=JSON.parse(JSON.stringify(B)));const k=this.boundingSphere;return null!==k&&(e.data.boundingSphere={center:k.center.toArray(),radius:k.radius}),e}clone(){return(new br).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=e.name;const d=e.index;null!==d&&this.setIndex(d.clone(c));const _=e.attributes;for(const V in _)this.setAttribute(V,_[V].clone(c));const S=e.morphAttributes;for(const V in S){const te=[],ce=S[V];for(let ue=0,_e=ce.length;ue<_e;ue++)te.push(ce[ue].clone(c));this.morphAttributes[V]=te}this.morphTargetsRelative=e.morphTargetsRelative;const B=e.groups;for(let V=0,te=B.length;V<te;V++){const ce=B[V];this.addGroup(ce.start,ce.count,ce.materialIndex)}const k=e.boundingBox;null!==k&&(this.boundingBox=k.clone());const F=e.boundingSphere;return null!==F&&(this.boundingSphere=F.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}br.prototype.isBufferGeometry=!0;const ml=new tn,Lc=new fn,ah=new xo,Qa=new ht,ns=new ht,Ci=new ht,Qh=new ht,Ah=new ht,Kh=new ht,mr=new ht,Jo=new ht,_l=new ht,Fr=new zn,Bs=new zn,lh=new zn,Kc=new ht,Ns=new ht;class Ro extends Pr{constructor(e=new br,c=new fl){super(),this.type="Mesh",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,B=_.length;S<B;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,c){const d=this.geometry,_=this.material,S=this.matrixWorld;if(void 0===_||(null===d.boundingSphere&&d.computeBoundingSphere(),ah.copy(d.boundingSphere),ah.applyMatrix4(S),!1===e.ray.intersectsSphere(ah))||(ml.copy(S).invert(),Lc.copy(e.ray).applyMatrix4(ml),null!==d.boundingBox&&!1===Lc.intersectsBox(d.boundingBox)))return;let B;if(d.isBufferGeometry){const k=d.index,F=d.attributes.position,V=d.morphAttributes.position,te=d.morphTargetsRelative,ce=d.attributes.uv,ue=d.attributes.uv2,_e=d.groups,Ee=d.drawRange;if(null!==k)if(Array.isArray(_))for(let $e=0,Be=_e.length;$e<Be;$e++){const Re=_e[$e],We=_[Re.materialIndex];for(let tt=Math.max(Re.start,Ee.start),Ze=Math.min(Re.start+Re.count,Ee.start+Ee.count);tt<Ze;tt+=3){const ot=k.getX(tt),st=k.getX(tt+1),Ct=k.getX(tt+2);B=ep(this,We,e,Lc,F,V,te,ce,ue,ot,st,Ct),B&&(B.faceIndex=Math.floor(tt/3),B.face.materialIndex=Re.materialIndex,c.push(B))}}else for(let $e=Math.max(0,Ee.start),Be=Math.min(k.count,Ee.start+Ee.count);$e<Be;$e+=3){const Re=k.getX($e),We=k.getX($e+1),tt=k.getX($e+2);B=ep(this,_,e,Lc,F,V,te,ce,ue,Re,We,tt),B&&(B.faceIndex=Math.floor($e/3),c.push(B))}else if(void 0!==F)if(Array.isArray(_))for(let $e=0,Be=_e.length;$e<Be;$e++){const Re=_e[$e],We=_[Re.materialIndex];for(let tt=Math.max(Re.start,Ee.start),Ze=Math.min(Re.start+Re.count,Ee.start+Ee.count);tt<Ze;tt+=3)B=ep(this,We,e,Lc,F,V,te,ce,ue,tt,tt+1,tt+2),B&&(B.faceIndex=Math.floor(tt/3),B.face.materialIndex=Re.materialIndex,c.push(B))}else for(let $e=Math.max(0,Ee.start),Be=Math.min(F.count,Ee.start+Ee.count);$e<Be;$e+=3)B=ep(this,_,e,Lc,F,V,te,ce,ue,$e,$e+1,$e+2),B&&(B.faceIndex=Math.floor($e/3),c.push(B))}else d.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function ep(w,e,c,d,_,S,B,k,F,V,te,ce){Qa.fromBufferAttribute(_,V),ns.fromBufferAttribute(_,te),Ci.fromBufferAttribute(_,ce);const ue=w.morphTargetInfluences;if(S&&ue){mr.set(0,0,0),Jo.set(0,0,0),_l.set(0,0,0);for(let Ee=0,$e=S.length;Ee<$e;Ee++){const Be=ue[Ee],Re=S[Ee];0!==Be&&(Qh.fromBufferAttribute(Re,V),Ah.fromBufferAttribute(Re,te),Kh.fromBufferAttribute(Re,ce),B?(mr.addScaledVector(Qh,Be),Jo.addScaledVector(Ah,Be),_l.addScaledVector(Kh,Be)):(mr.addScaledVector(Qh.sub(Qa),Be),Jo.addScaledVector(Ah.sub(ns),Be),_l.addScaledVector(Kh.sub(Ci),Be)))}Qa.add(mr),ns.add(Jo),Ci.add(_l)}w.isSkinnedMesh&&(w.boneTransform(V,Qa),w.boneTransform(te,ns),w.boneTransform(ce,Ci));const _e=function(Ee,$e,Be,Re,We,tt,Ze,ot){let st;if(st=$e.side===q?Re.intersectTriangle(Ze,tt,We,!0,ot):Re.intersectTriangle(We,tt,Ze,$e.side!==Y,ot),null===st)return null;Ns.copy(ot),Ns.applyMatrix4(Ee.matrixWorld);const Ct=Be.ray.origin.distanceTo(Ns);return Ct<Be.near||Ct>Be.far?null:{distance:Ct,point:Ns.clone(),object:Ee}}(w,e,c,d,Qa,ns,Ci,Kc);if(_e){k&&(Fr.fromBufferAttribute(k,V),Bs.fromBufferAttribute(k,te),lh.fromBufferAttribute(k,ce),_e.uv=eo.getUV(Kc,Qa,ns,Ci,Fr,Bs,lh,new zn)),F&&(Fr.fromBufferAttribute(F,V),Bs.fromBufferAttribute(F,te),lh.fromBufferAttribute(F,ce),_e.uv2=eo.getUV(Kc,Qa,ns,Ci,Fr,Bs,lh,new zn));const Ee={a:V,b:te,c:ce,normal:new ht,materialIndex:0};eo.getNormal(Qa,ns,Ci,Ee.normal),_e.face=Ee}return _e}Ro.prototype.isMesh=!0;class tc extends br{constructor(e=1,c=1,d=1,_=1,S=1,B=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:c,depth:d,widthSegments:_,heightSegments:S,depthSegments:B};const k=this;_=Math.floor(_),S=Math.floor(S),B=Math.floor(B);const F=[],V=[],te=[],ce=[];let ue=0,_e=0;function Ee($e,Be,Re,We,tt,Ze,ot,st,Ct,Ft,Qe){const nt=Ze/Ct,Et=ot/Ft,Jt=Ze/2,ct=ot/2,Lt=st/2,_t=Ct+1,zt=Ft+1;let Rt=0,nn=0;const en=new ht;for(let En=0;En<zt;En++){const rt=En*Et-ct;for(let ut=0;ut<_t;ut++)en[$e]=(ut*nt-Jt)*We,en[Be]=rt*tt,en[Re]=Lt,V.push(en.x,en.y,en.z),en[$e]=0,en[Be]=0,en[Re]=st>0?1:-1,te.push(en.x,en.y,en.z),ce.push(ut/Ct),ce.push(1-En/Ft),Rt+=1}for(let En=0;En<Ft;En++)for(let rt=0;rt<Ct;rt++){const rn=ue+rt+_t*(En+1),un=ue+(rt+1)+_t*(En+1),_n=ue+(rt+1)+_t*En;F.push(ue+rt+_t*En,rn,_n),F.push(rn,un,_n),nn+=6}k.addGroup(_e,nn,Qe),_e+=nn,ue+=Rt}Ee("z","y","x",-1,-1,d,c,e,B,S,0),Ee("z","y","x",1,-1,d,c,-e,B,S,1),Ee("x","z","y",1,1,e,d,c,_,B,2),Ee("x","z","y",1,-1,e,d,-c,_,B,3),Ee("x","y","z",1,-1,e,c,d,_,S,4),Ee("x","y","z",-1,-1,e,c,-d,_,S,5),this.setIndex(F),this.setAttribute("position",new hn(V,3)),this.setAttribute("normal",new hn(te,3)),this.setAttribute("uv",new hn(ce,2))}static fromJSON(e){return new tc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function uo(w){const e={};for(const c in w){e[c]={};for(const d in w[c]){const _=w[c][d];e[c][d]=_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture||_.isQuaternion)?_.clone():Array.isArray(_)?_.slice():_}}return e}function Ai(w){const e={};for(let c=0;c<w.length;c++){const d=uo(w[c]);for(const _ in d)e[_]=d[_]}return e}const Rs={clone:uo,merge:Ai};class Ps extends Cs{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=uo(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const c=super.toJSON(e);c.glslVersion=this.glslVersion,c.uniforms={};for(const _ in this.uniforms){const S=this.uniforms[_].value;c.uniforms[_]=S&&S.isTexture?{type:"t",value:S.toJSON(e).uuid}:S&&S.isColor?{type:"c",value:S.getHex()}:S&&S.isVector2?{type:"v2",value:S.toArray()}:S&&S.isVector3?{type:"v3",value:S.toArray()}:S&&S.isVector4?{type:"v4",value:S.toArray()}:S&&S.isMatrix3?{type:"m3",value:S.toArray()}:S&&S.isMatrix4?{type:"m4",value:S.toArray()}:{value:S}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const d={};for(const _ in this.extensions)!0===this.extensions[_]&&(d[_]=!0);return Object.keys(d).length>0&&(c.extensions=d),c}}Ps.prototype.isShaderMaterial=!0;class Rl extends Pr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tn,this.projectionMatrix=new tn,this.projectionMatrixInverse=new tn}copy(e,c){return super.copy(e,c),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,c){super.updateWorldMatrix(e,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Rl.prototype.isCamera=!0;class Po extends Rl{constructor(e=50,c=1,d=.1,_=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=d,this.far=_,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const c=.5*this.getFilmHeight()/e;this.fov=2*ss*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ho*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ss*Math.atan(Math.tan(.5*Ho*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,c,d,_,S,B){this.aspect=e/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=_,this.view.width=S,this.view.height=B,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let c=e*Math.tan(.5*Ho*this.fov)/this.zoom,d=2*c,_=this.aspect*d,S=-.5*_;const B=this.view;if(null!==this.view&&this.view.enabled){const F=B.fullWidth,V=B.fullHeight;S+=B.offsetX*_/F,c-=B.offsetY*d/V,_*=B.width/F,d*=B.height/V}const k=this.filmOffset;0!==k&&(S+=e*k/this.getFilmWidth()),this.projectionMatrix.makePerspective(S,S+_,c,c-d,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}Po.prototype.isPerspectiveCamera=!0;class gl extends Pr{constructor(e,c,d){if(super(),this.type="CubeCamera",!0!==d.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=d;const _=new Po(90,1,e,c);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new ht(1,0,0)),this.add(_);const S=new Po(90,1,e,c);S.layers=this.layers,S.up.set(0,-1,0),S.lookAt(new ht(-1,0,0)),this.add(S);const B=new Po(90,1,e,c);B.layers=this.layers,B.up.set(0,0,1),B.lookAt(new ht(0,1,0)),this.add(B);const k=new Po(90,1,e,c);k.layers=this.layers,k.up.set(0,0,-1),k.lookAt(new ht(0,-1,0)),this.add(k);const F=new Po(90,1,e,c);F.layers=this.layers,F.up.set(0,-1,0),F.lookAt(new ht(0,0,1)),this.add(F);const V=new Po(90,1,e,c);V.layers=this.layers,V.up.set(0,-1,0),V.lookAt(new ht(0,0,-1)),this.add(V)}update(e,c){null===this.parent&&this.updateMatrixWorld();const d=this.renderTarget,[_,S,B,k,F,V]=this.children,te=e.xr.enabled,ce=e.getRenderTarget();e.xr.enabled=!1;const ue=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,e.setRenderTarget(d,0),e.render(c,_),e.setRenderTarget(d,1),e.render(c,S),e.setRenderTarget(d,2),e.render(c,B),e.setRenderTarget(d,3),e.render(c,k),e.setRenderTarget(d,4),e.render(c,F),d.texture.generateMipmaps=ue,e.setRenderTarget(d,5),e.render(c,V),e.setRenderTarget(ce),e.xr.enabled=te}}class nc extends $s{constructor(e,c,d,_,S,B,k,F,V,te){super(e=void 0!==e?e:[],c=void 0!==c?c:Ei,d,_,S,B,k=void 0!==k?k:Fs,F,V,te),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}nc.prototype.isCubeTexture=!0;class Bc extends io{constructor(e,c,d){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=d),super(e,e,c),this.texture=new nc(void 0,(c=c||{}).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:ai,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,c){this.texture.type=c.type,this.texture.format=lo,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const B=new tc(5,5,5),k=new Ps({name:"CubemapFromEquirect",uniforms:uo({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:q,blending:X});k.uniforms.tEquirect.value=c;const F=new Ro(B,k),V=c.minFilter;return c.minFilter===sl&&(c.minFilter=ai),new gl(1,10,this).update(e,F),c.minFilter=V,F.geometry.dispose(),F.material.dispose(),this}clear(e,c,d,_){const S=e.getRenderTarget();for(let B=0;B<6;B++)e.setRenderTarget(this,B),e.clear(c,d,_);e.setRenderTarget(S)}}Bc.prototype.isWebGLCubeRenderTarget=!0;const eu=new ht,hr=new ht,Lp=new lt;class Ia{constructor(e=new ht(1,0,0),c=0){this.normal=e,this.constant=c}set(e,c){return this.normal.copy(e),this.constant=c,this}setComponents(e,c,d,_){return this.normal.set(e,c,d),this.constant=_,this}setFromNormalAndCoplanarPoint(e,c){return this.normal.copy(e),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(e,c,d){const _=eu.subVectors(d,c).cross(hr.subVectors(e,c)).normalize();return this.setFromNormalAndCoplanarPoint(_,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,c){const d=e.delta(eu),_=this.normal.dot(d);if(0===_)return 0===this.distanceToPoint(e.start)?c.copy(e.start):null;const S=-(e.start.dot(this.normal)+this.constant)/_;return S<0||S>1?null:c.copy(d).multiplyScalar(S).add(e.start)}intersectsLine(e){const c=this.distanceToPoint(e.start),d=this.distanceToPoint(e.end);return c<0&&d>0||d<0&&c>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,c){const d=c||Lp.getNormalMatrix(e),_=this.coplanarPoint(eu).applyMatrix4(e),S=this.normal.applyMatrix3(d).normalize();return this.constant=-_.dot(S),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Ia.prototype.isPlane=!0;const Ka=new xo,Il=new ht;class Dr{constructor(e=new Ia,c=new Ia,d=new Ia,_=new Ia,S=new Ia,B=new Ia){this.planes=[e,c,d,_,S,B]}set(e,c,d,_,S,B){const k=this.planes;return k[0].copy(e),k[1].copy(c),k[2].copy(d),k[3].copy(_),k[4].copy(S),k[5].copy(B),this}copy(e){const c=this.planes;for(let d=0;d<6;d++)c[d].copy(e.planes[d]);return this}setFromProjectionMatrix(e){const c=this.planes,d=e.elements,_=d[0],S=d[1],B=d[2],k=d[3],F=d[4],V=d[5],te=d[6],ce=d[7],ue=d[8],_e=d[9],Ee=d[10],$e=d[11],Be=d[12],Re=d[13],We=d[14],tt=d[15];return c[0].setComponents(k-_,ce-F,$e-ue,tt-Be).normalize(),c[1].setComponents(k+_,ce+F,$e+ue,tt+Be).normalize(),c[2].setComponents(k+S,ce+V,$e+_e,tt+Re).normalize(),c[3].setComponents(k-S,ce-V,$e-_e,tt-Re).normalize(),c[4].setComponents(k-B,ce-te,$e-Ee,tt-We).normalize(),c[5].setComponents(k+B,ce+te,$e+Ee,tt+We).normalize(),this}intersectsObject(e){const c=e.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),Ka.copy(c.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ka)}intersectsSprite(e){return Ka.center.set(0,0,0),Ka.radius=.7071067811865476,Ka.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ka)}intersectsSphere(e){const c=this.planes,d=e.center,_=-e.radius;for(let S=0;S<6;S++)if(c[S].distanceToPoint(d)<_)return!1;return!0}intersectsBox(e){const c=this.planes;for(let d=0;d<6;d++){const _=c[d];if(Il.x=_.normal.x>0?e.max.x:e.min.x,Il.y=_.normal.y>0?e.max.y:e.min.y,Il.z=_.normal.z>0?e.max.z:e.min.z,_.distanceToPoint(Il)<0)return!1}return!0}containsPoint(e){const c=this.planes;for(let d=0;d<6;d++)if(c[d].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Nc(){let w=null,e=!1,c=null,d=null;function _(S,B){c(S,B),d=w.requestAnimationFrame(_)}return{start:function(){!0!==e&&null!==c&&(d=w.requestAnimationFrame(_),e=!0)},stop:function(){w.cancelAnimationFrame(d),e=!1},setAnimationLoop:function(S){c=S},setContext:function(S){w=S}}}function qp(w,e){const c=e.isWebGL2,d=new WeakMap;return{get:function(_){return _.isInterleavedBufferAttribute&&(_=_.data),d.get(_)},remove:function(_){_.isInterleavedBufferAttribute&&(_=_.data);const S=d.get(_);S&&(w.deleteBuffer(S.buffer),d.delete(_))},update:function(_,S){if(_.isGLBufferAttribute){const k=d.get(_);return void((!k||k.version<_.version)&&d.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version}))}_.isInterleavedBufferAttribute&&(_=_.data);const B=d.get(_);void 0===B?d.set(_,function(k,F){const V=k.array,te=k.usage,ce=w.createBuffer();w.bindBuffer(F,ce),w.bufferData(F,V,te),k.onUploadCallback();let ue=5126;return V instanceof Float32Array?ue=5126:V instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):V instanceof Uint16Array?k.isFloat16BufferAttribute?c?ue=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ue=5123:V instanceof Int16Array?ue=5122:V instanceof Uint32Array?ue=5125:V instanceof Int32Array?ue=5124:V instanceof Int8Array?ue=5120:(V instanceof Uint8Array||V instanceof Uint8ClampedArray)&&(ue=5121),{buffer:ce,type:ue,bytesPerElement:V.BYTES_PER_ELEMENT,version:k.version}}(_,S)):B.version<_.version&&(function(k,F,V){const te=F.array,ce=F.updateRange;w.bindBuffer(V,k),-1===ce.count?w.bufferSubData(V,0,te):(c?w.bufferSubData(V,ce.offset*te.BYTES_PER_ELEMENT,te,ce.offset,ce.count):w.bufferSubData(V,ce.offset*te.BYTES_PER_ELEMENT,te.subarray(ce.offset,ce.offset+ce.count)),ce.count=-1)}(B.buffer,_,S),B.version=_.version)}}}class Eu extends br{constructor(e=1,c=1,d=1,_=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:c,widthSegments:d,heightSegments:_};const S=e/2,B=c/2,k=Math.floor(d),F=Math.floor(_),V=k+1,te=F+1,ce=e/k,ue=c/F,_e=[],Ee=[],$e=[],Be=[];for(let Re=0;Re<te;Re++){const We=Re*ue-B;for(let tt=0;tt<V;tt++)Ee.push(tt*ce-S,-We,0),$e.push(0,0,1),Be.push(tt/k),Be.push(1-Re/F)}for(let Re=0;Re<F;Re++)for(let We=0;We<k;We++){const Ze=We+V*(Re+1),ot=We+1+V*(Re+1),st=We+1+V*Re;_e.push(We+V*Re,Ze,st),_e.push(Ze,ot,st)}this.setIndex(_e),this.setAttribute("position",new hn(Ee,3)),this.setAttribute("normal",new hn($e,3)),this.setAttribute("uv",new hn(Be,2))}static fromJSON(e){return new Eu(e.width,e.height,e.widthSegments,e.heightSegments)}}const ui={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotVH = saturate( dot( geometry.viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float NoH ) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float NoV, float NoL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );\n}\nvec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in GeometricContext geometry ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = transmission.a;\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},sr={common:{diffuse:{value:new er(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new lt},uv2Transform:{value:new lt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new er(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new er(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lt}},sprite:{diffuse:{value:new er(16777215)},opacity:{value:1},center:{value:new zn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lt}}},Ol={basic:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.fog]),vertexShader:ui.meshbasic_vert,fragmentShader:ui.meshbasic_frag},lambert:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.fog,sr.lights,{emissive:{value:new er(0)}}]),vertexShader:ui.meshlambert_vert,fragmentShader:ui.meshlambert_frag},phong:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,sr.lights,{emissive:{value:new er(0)},specular:{value:new er(1118481)},shininess:{value:30}}]),vertexShader:ui.meshphong_vert,fragmentShader:ui.meshphong_frag},standard:{uniforms:Ai([sr.common,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.roughnessmap,sr.metalnessmap,sr.fog,sr.lights,{emissive:{value:new er(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag},toon:{uniforms:Ai([sr.common,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.gradientmap,sr.fog,sr.lights,{emissive:{value:new er(0)}}]),vertexShader:ui.meshtoon_vert,fragmentShader:ui.meshtoon_frag},matcap:{uniforms:Ai([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,{matcap:{value:null}}]),vertexShader:ui.meshmatcap_vert,fragmentShader:ui.meshmatcap_frag},points:{uniforms:Ai([sr.points,sr.fog]),vertexShader:ui.points_vert,fragmentShader:ui.points_frag},dashed:{uniforms:Ai([sr.common,sr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ui.linedashed_vert,fragmentShader:ui.linedashed_frag},depth:{uniforms:Ai([sr.common,sr.displacementmap]),vertexShader:ui.depth_vert,fragmentShader:ui.depth_frag},normal:{uniforms:Ai([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,{opacity:{value:1}}]),vertexShader:ui.meshnormal_vert,fragmentShader:ui.meshnormal_frag},sprite:{uniforms:Ai([sr.sprite,sr.fog]),vertexShader:ui.sprite_vert,fragmentShader:ui.sprite_frag},background:{uniforms:{uvTransform:{value:new lt},t2D:{value:null}},vertexShader:ui.background_vert,fragmentShader:ui.background_frag},cube:{uniforms:Ai([sr.envmap,{opacity:{value:1}}]),vertexShader:ui.cube_vert,fragmentShader:ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ui.equirect_vert,fragmentShader:ui.equirect_frag},distanceRGBA:{uniforms:Ai([sr.common,sr.displacementmap,{referencePosition:{value:new ht},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ui.distanceRGBA_vert,fragmentShader:ui.distanceRGBA_frag},shadow:{uniforms:Ai([sr.lights,sr.fog,{color:{value:new er(0)},opacity:{value:1}}]),vertexShader:ui.shadow_vert,fragmentShader:ui.shadow_frag}};function tu(w,e,c,d,_){const S=new er(0);let B,k,F=0,V=null,te=0,ce=null;function ue(_e,Ee){c.buffers.color.setClear(_e.r,_e.g,_e.b,Ee,_)}return{getClearColor:function(){return S},setClearColor:function(_e,Ee=1){S.set(_e),F=Ee,ue(S,F)},getClearAlpha:function(){return F},setClearAlpha:function(_e){F=_e,ue(S,F)},render:function(_e,Ee){let $e=!1,Be=!0===Ee.isScene?Ee.background:null;Be&&Be.isTexture&&(Be=e.get(Be));const Re=w.xr,We=Re.getSession&&Re.getSession();We&&"additive"===We.environmentBlendMode&&(Be=null),null===Be?ue(S,F):Be&&Be.isColor&&(ue(Be,1),$e=!0),(w.autoClear||$e)&&w.clear(w.autoClearColor,w.autoClearDepth,w.autoClearStencil),Be&&(Be.isCubeTexture||Be.mapping===Ni)?(void 0===k&&(k=new Ro(new tc(1,1,1),new Ps({name:"BackgroundCubeMaterial",uniforms:uo(Ol.cube.uniforms),vertexShader:Ol.cube.vertexShader,fragmentShader:Ol.cube.fragmentShader,side:q,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.deleteAttribute("normal"),k.geometry.deleteAttribute("uv"),k.onBeforeRender=function(tt,Ze,ot){this.matrixWorld.copyPosition(ot.matrixWorld)},Object.defineProperty(k.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(k)),k.material.uniforms.envMap.value=Be,k.material.uniforms.flipEnvMap.value=Be.isCubeTexture&&!1===Be.isRenderTargetTexture?-1:1,V===Be&&te===Be.version&&ce===w.toneMapping||(k.material.needsUpdate=!0,V=Be,te=Be.version,ce=w.toneMapping),_e.unshift(k,k.geometry,k.material,0,0,null)):Be&&Be.isTexture&&(void 0===B&&(B=new Ro(new Eu(2,2),new Ps({name:"BackgroundMaterial",uniforms:uo(Ol.background.uniforms),vertexShader:Ol.background.vertexShader,fragmentShader:Ol.background.fragmentShader,side:le,depthTest:!1,depthWrite:!1,fog:!1})),B.geometry.deleteAttribute("normal"),Object.defineProperty(B.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(B)),B.material.uniforms.t2D.value=Be,!0===Be.matrixAutoUpdate&&Be.updateMatrix(),B.material.uniforms.uvTransform.value.copy(Be.matrix),V===Be&&te===Be.version&&ce===w.toneMapping||(B.material.needsUpdate=!0,V=Be,te=Be.version,ce=w.toneMapping),_e.unshift(B,B.geometry,B.material,0,0,null))}}}function Mo(w,e,c,d){const _=w.getParameter(34921),S=d.isWebGL2?null:e.get("OES_vertex_array_object"),B=d.isWebGL2||null!==S,k={},F=ue(null);let V=F;function te(Ze){return d.isWebGL2?w.bindVertexArray(Ze):S.bindVertexArrayOES(Ze)}function ce(Ze){return d.isWebGL2?w.deleteVertexArray(Ze):S.deleteVertexArrayOES(Ze)}function ue(Ze){const ot=[],st=[],Ct=[];for(let Ft=0;Ft<_;Ft++)ot[Ft]=0,st[Ft]=0,Ct[Ft]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ot,enabledAttributes:st,attributeDivisors:Ct,object:Ze,attributes:{},index:null}}function _e(){const Ze=V.newAttributes;for(let ot=0,st=Ze.length;ot<st;ot++)Ze[ot]=0}function Ee(Ze){$e(Ze,0)}function $e(Ze,ot){const Ct=V.enabledAttributes,Ft=V.attributeDivisors;V.newAttributes[Ze]=1,0===Ct[Ze]&&(w.enableVertexAttribArray(Ze),Ct[Ze]=1),Ft[Ze]!==ot&&((d.isWebGL2?w:e.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ze,ot),Ft[Ze]=ot)}function Be(){const Ze=V.newAttributes,ot=V.enabledAttributes;for(let st=0,Ct=ot.length;st<Ct;st++)ot[st]!==Ze[st]&&(w.disableVertexAttribArray(st),ot[st]=0)}function Re(Ze,ot,st,Ct,Ft,Qe){!0!==d.isWebGL2||5124!==st&&5125!==st?w.vertexAttribPointer(Ze,ot,st,Ct,Ft,Qe):w.vertexAttribIPointer(Ze,ot,st,Ft,Qe)}function We(){tt(),V!==F&&(V=F,te(V.object))}function tt(){F.geometry=null,F.program=null,F.wireframe=!1}return{setup:function(Ze,ot,st,Ct,Ft){let Qe=!1;if(B){const nt=function(Et,Jt,ct){const Lt=!0===ct.wireframe;let _t=k[Et.id];void 0===_t&&(_t={},k[Et.id]=_t);let zt=_t[Jt.id];void 0===zt&&(zt={},_t[Jt.id]=zt);let Rt=zt[Lt];return void 0===Rt&&(Rt=ue(d.isWebGL2?w.createVertexArray():S.createVertexArrayOES()),zt[Lt]=Rt),Rt}(Ct,st,ot);V!==nt&&(V=nt,te(V.object)),Qe=function(Et,Jt){const ct=V.attributes,Lt=Et.attributes;let _t=0;for(const zt in Lt){const Rt=ct[zt],nn=Lt[zt];if(void 0===Rt||Rt.attribute!==nn||Rt.data!==nn.data)return!0;_t++}return V.attributesNum!==_t||V.index!==Jt}(Ct,Ft),Qe&&function(Et,Jt){const ct={},Lt=Et.attributes;let _t=0;for(const zt in Lt){const Rt=Lt[zt],nn={};nn.attribute=Rt,Rt.data&&(nn.data=Rt.data),ct[zt]=nn,_t++}V.attributes=ct,V.attributesNum=_t,V.index=Jt}(Ct,Ft)}else{const nt=!0===ot.wireframe;V.geometry===Ct.id&&V.program===st.id&&V.wireframe===nt||(V.geometry=Ct.id,V.program=st.id,V.wireframe=nt,Qe=!0)}!0===Ze.isInstancedMesh&&(Qe=!0),null!==Ft&&c.update(Ft,34963),Qe&&(function(nt,Et,Jt,ct){if(!1===d.isWebGL2&&(nt.isInstancedMesh||ct.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;_e();const Lt=ct.attributes,_t=Jt.getAttributes(),zt=Et.defaultAttributeValues;for(const Rt in _t){const nn=_t[Rt];if(nn.location>=0){let en=Lt[Rt];if(void 0===en&&("instanceMatrix"===Rt&&nt.instanceMatrix&&(en=nt.instanceMatrix),"instanceColor"===Rt&&nt.instanceColor&&(en=nt.instanceColor)),void 0!==en){const En=en.normalized,rt=en.itemSize,ut=c.get(en);if(void 0===ut)continue;const rn=ut.buffer,un=ut.type,_n=ut.bytesPerElement;if(en.isInterleavedBufferAttribute){const kn=en.data,Jn=kn.stride,Zn=en.offset;if(kn&&kn.isInstancedInterleavedBuffer){for(let cn=0;cn<nn.locationSize;cn++)$e(nn.location+cn,kn.meshPerAttribute);!0!==nt.isInstancedMesh&&void 0===ct._maxInstanceCount&&(ct._maxInstanceCount=kn.meshPerAttribute*kn.count)}else for(let cn=0;cn<nn.locationSize;cn++)Ee(nn.location+cn);w.bindBuffer(34962,rn);for(let cn=0;cn<nn.locationSize;cn++)Re(nn.location+cn,rt/nn.locationSize,un,En,Jn*_n,(Zn+rt/nn.locationSize*cn)*_n)}else{if(en.isInstancedBufferAttribute){for(let kn=0;kn<nn.locationSize;kn++)$e(nn.location+kn,en.meshPerAttribute);!0!==nt.isInstancedMesh&&void 0===ct._maxInstanceCount&&(ct._maxInstanceCount=en.meshPerAttribute*en.count)}else for(let kn=0;kn<nn.locationSize;kn++)Ee(nn.location+kn);w.bindBuffer(34962,rn);for(let kn=0;kn<nn.locationSize;kn++)Re(nn.location+kn,rt/nn.locationSize,un,En,rt*_n,rt/nn.locationSize*kn*_n)}}else if(void 0!==zt){const En=zt[Rt];if(void 0!==En)switch(En.length){case 2:w.vertexAttrib2fv(nn.location,En);break;case 3:w.vertexAttrib3fv(nn.location,En);break;case 4:w.vertexAttrib4fv(nn.location,En);break;default:w.vertexAttrib1fv(nn.location,En)}}}}Be()}(Ze,ot,st,Ct),null!==Ft&&w.bindBuffer(34963,c.get(Ft).buffer))},reset:We,resetDefaultState:tt,dispose:function(){We();for(const Ze in k){const ot=k[Ze];for(const st in ot){const Ct=ot[st];for(const Ft in Ct)ce(Ct[Ft].object),delete Ct[Ft];delete ot[st]}delete k[Ze]}},releaseStatesOfGeometry:function(Ze){if(void 0===k[Ze.id])return;const ot=k[Ze.id];for(const st in ot){const Ct=ot[st];for(const Ft in Ct)ce(Ct[Ft].object),delete Ct[Ft];delete ot[st]}delete k[Ze.id]},releaseStatesOfProgram:function(Ze){for(const ot in k){const st=k[ot];if(void 0===st[Ze.id])continue;const Ct=st[Ze.id];for(const Ft in Ct)ce(Ct[Ft].object),delete Ct[Ft];delete st[Ze.id]}},initAttributes:_e,enableAttribute:Ee,disableUnusedAttributes:Be}}function Vn(w,e,c,d){const _=d.isWebGL2;let S;this.setMode=function(B){S=B},this.render=function(B,k){w.drawArrays(S,B,k),c.update(k,S,1)},this.renderInstances=function(B,k,F){if(0===F)return;let V,te;if(_)V=w,te="drawArraysInstanced";else if(V=e.get("ANGLE_instanced_arrays"),te="drawArraysInstancedANGLE",null===V)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");V[te](S,B,k,F),c.update(k,S,F)}}function nu(w,e,c){let d;function _(Ze){if("highp"===Ze){if(w.getShaderPrecisionFormat(35633,36338).precision>0&&w.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Ze="mediump"}return"mediump"===Ze&&w.getShaderPrecisionFormat(35633,36337).precision>0&&w.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const S=typeof WebGL2RenderingContext<"u"&&w instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&w instanceof WebGL2ComputeRenderingContext;let B=void 0!==c.precision?c.precision:"highp";const k=_(B);k!==B&&(console.warn("THREE.WebGLRenderer:",B,"not supported, using",k,"instead."),B=k);const F=S||e.has("WEBGL_draw_buffers"),V=!0===c.logarithmicDepthBuffer,te=w.getParameter(34930),ce=w.getParameter(35660),ue=w.getParameter(3379),_e=w.getParameter(34076),Ee=w.getParameter(34921),$e=w.getParameter(36347),Be=w.getParameter(36348),Re=w.getParameter(36349),We=ce>0,tt=S||e.has("OES_texture_float");return{isWebGL2:S,drawBuffers:F,getMaxAnisotropy:function(){if(void 0!==d)return d;if(!0===e.has("EXT_texture_filter_anisotropic")){const Ze=e.get("EXT_texture_filter_anisotropic");d=w.getParameter(Ze.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d},getMaxPrecision:_,precision:B,logarithmicDepthBuffer:V,maxTextures:te,maxVertexTextures:ce,maxTextureSize:ue,maxCubemapSize:_e,maxAttributes:Ee,maxVertexUniforms:$e,maxVaryings:Be,maxFragmentUniforms:Re,vertexTextures:We,floatFragmentTextures:tt,floatVertexTextures:We&&tt,maxSamples:S?w.getParameter(36183):0}}function Tu(w){const e=this;let c=null,d=0,_=!1,S=!1;const B=new Ia,k=new lt,F={value:null,needsUpdate:!1};function V(){F.value!==c&&(F.value=c,F.needsUpdate=d>0),e.numPlanes=d,e.numIntersection=0}function te(ce,ue,_e,Ee){const $e=null!==ce?ce.length:0;let Be=null;if(0!==$e){if(Be=F.value,!0!==Ee||null===Be){const Re=_e+4*$e,We=ue.matrixWorldInverse;k.getNormalMatrix(We),(null===Be||Be.length<Re)&&(Be=new Float32Array(Re));for(let tt=0,Ze=_e;tt!==$e;++tt,Ze+=4)B.copy(ce[tt]).applyMatrix4(We,k),B.normal.toArray(Be,Ze),Be[Ze+3]=B.constant}F.value=Be,F.needsUpdate=!0}return e.numPlanes=$e,e.numIntersection=0,Be}this.uniform=F,this.numPlanes=0,this.numIntersection=0,this.init=function(ce,ue,_e){const Ee=0!==ce.length||ue||0!==d||_;return _=ue,c=te(ce,_e,0),d=ce.length,Ee},this.beginShadows=function(){S=!0,te(null)},this.endShadows=function(){S=!1,V()},this.setState=function(ce,ue,_e){const Ee=ce.clippingPlanes,$e=ce.clipIntersection,Be=ce.clipShadows,Re=w.get(ce);if(!_||null===Ee||0===Ee.length||S&&!Be)S?te(null):V();else{const We=S?0:d,tt=4*We;let Ze=Re.clippingState||null;F.value=Ze,Ze=te(Ee,ue,tt,_e);for(let ot=0;ot!==tt;++ot)Ze[ot]=c[ot];Re.clippingState=Ze,this.numIntersection=$e?this.numPlanes:0,this.numPlanes+=We}}}function vl(w){let e=new WeakMap;function c(_,S){return S===Xs?_.mapping=Ei:S===ua&&(_.mapping=So),_}function d(_){const S=_.target;S.removeEventListener("dispose",d);const B=e.get(S);void 0!==B&&(e.delete(S),B.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const S=_.mapping;if(S===Xs||S===ua){if(e.has(_))return c(e.get(_).texture,_.mapping);{const B=_.image;if(B&&B.height>0){const k=w.getRenderTarget(),F=new Bc(B.height/2);return F.fromEquirectangularTexture(w,_),e.set(_,F),w.setRenderTarget(k),_.addEventListener("dispose",d),c(F.texture,_.mapping)}return null}}}return _},dispose:function(){e=new WeakMap}}}Ol.physical={uniforms:Ai([Ol.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new zn(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new er(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new zn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new er(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new er(1,1,1)},specularTintMap:{value:null}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag};class rc extends Rl{constructor(e=-1,c=1,d=1,_=-1,S=.1,B=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=c,this.top=d,this.bottom=_,this.near=S,this.far=B,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,c,d,_,S,B){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=_,this.view.width=S,this.view.height=B,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,_=(this.top+this.bottom)/2;let S=d-e,B=d+e,k=_+c,F=_-c;if(null!==this.view&&this.view.enabled){const V=(this.right-this.left)/this.view.fullWidth/this.zoom,te=(this.top-this.bottom)/this.view.fullHeight/this.zoom;S+=V*this.view.offsetX,B=S+V*this.view.width,k-=te*this.view.offsetY,F=k-te*this.view.height}this.projectionMatrix.makeOrthographic(S,B,k,F,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}rc.prototype.isOrthographicCamera=!0;class Mu extends Ps{constructor(e){super(e),this.type="RawShaderMaterial"}}Mu.prototype.isRawShaderMaterial=!0;const ya=Math.pow(2,8),ch=[.125,.215,.35,.446,.526,.582],pd=5+ch.length,ru={[Zi]:0,[hl]:1,[Yc]:2,[xc]:3,[nh]:4,[vu]:5,[Ql]:6},$h=new rc,{_lodPlanes:Rc,_sizeLods:uh,_sigmas:ba}=function Ye(){const w=[],e=[],c=[];let d=8;for(let _=0;_<pd;_++){const S=Math.pow(2,d);e.push(S);let B=1/S;_>4?B=ch[_-8+4-1]:0==_&&(B=0),c.push(B);const k=1/(S-1),F=-k/2,V=1+k/2,te=[F,F,V,F,V,V,F,F,V,V,F,V],ce=6,ue=6,_e=3,Ee=2,$e=1,Be=new Float32Array(_e*ue*ce),Re=new Float32Array(Ee*ue*ce),We=new Float32Array($e*ue*ce);for(let Ze=0;Ze<ce;Ze++){const ot=Ze%3*2/3-1,st=Ze>2?0:-1;Be.set([ot,st,0,ot+2/3,st,0,ot+2/3,st+1,0,ot,st,0,ot+2/3,st+1,0,ot,st+1,0],_e*ue*Ze),Re.set(te,Ee*ue*Ze),We.set([Ze,Ze,Ze,Ze,Ze,Ze],$e*ue*Ze)}const tt=new br;tt.setAttribute("position",new Pi(Be,_e)),tt.setAttribute("uv",new Pi(Re,Ee)),tt.setAttribute("faceIndex",new Pi(We,$e)),w.push(tt),d>4&&d--}return{_lodPlanes:w,_sizeLods:e,_sigmas:c}}(),Io=new er;let Is=null;const ke=(1+Math.sqrt(5))/2,De=1/ke,He=[new ht(1,1,1),new ht(-1,1,1),new ht(1,1,-1),new ht(-1,1,-1),new ht(0,ke,De),new ht(0,ke,-De),new ht(De,0,ke),new ht(-De,0,ke),new ht(ke,De,0),new ht(-ke,De,0)];class we{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(c){const d=new Float32Array(20),_=new ht(0,1,0);return new Mu({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:_},inputEncoding:{value:ru[Zi]},outputEncoding:{value:ru[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,c=0,d=.1,_=100){Is=this._renderer.getRenderTarget();const S=this._allocateTargets();return this._sceneToCubeUV(e,d,_,S),c>0&&this._blur(S,0,0,c),this._applyPMREM(S),this._cleanup(S),S}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=In(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Wt(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Rc.length;e++)Rc[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Is),e.scissorTest=!1,Ot(e,0,0,e.width,e.height)}_fromTexture(e){Is=this._renderer.getRenderTarget();const c=this._allocateTargets(e);return this._textureToCubeUV(e,c),this._applyPMREM(c),this._cleanup(c),c}_allocateTargets(e){const c={magFilter:Ir,minFilter:Ir,generateMipmaps:!1,type:ha,format:vh,encoding:(w=e,void 0===w||w.type!==ha||w.encoding!==Zi&&w.encoding!==hl&&w.encoding!==Ql?Yc:e.encoding),depthBuffer:!1},d=bt(c);var w;return d.depthBuffer=!e,this._pingPongRenderTarget=bt(c),d}_compileMaterial(e){const c=new Ro(Rc[0],e);this._renderer.compile(c,$h)}_sceneToCubeUV(e,c,d,_){const S=new Po(90,1,c,d),B=[1,-1,1,1,1,1],k=[1,1,1,-1,-1,-1],F=this._renderer,V=F.autoClear,te=F.outputEncoding,ce=F.toneMapping;F.getClearColor(Io),F.toneMapping=vr,F.outputEncoding=Zi,F.autoClear=!1;const ue=new fl({name:"PMREM.Background",side:q,depthWrite:!1,depthTest:!1}),_e=new Ro(new tc,ue);let Ee=!1;const $e=e.background;$e?$e.isColor&&(ue.color.copy($e),e.background=null,Ee=!0):(ue.color.copy(Io),Ee=!0);for(let Be=0;Be<6;Be++){const Re=Be%3;0==Re?(S.up.set(0,B[Be],0),S.lookAt(k[Be],0,0)):1==Re?(S.up.set(0,0,B[Be]),S.lookAt(0,k[Be],0)):(S.up.set(0,B[Be],0),S.lookAt(0,0,k[Be])),Ot(_,Re*ya,Be>2?ya:0,ya,ya),F.setRenderTarget(_),Ee&&F.render(_e,S),F.render(e,S)}_e.geometry.dispose(),_e.material.dispose(),F.toneMapping=ce,F.outputEncoding=te,F.autoClear=V,e.background=$e}_textureToCubeUV(e,c){const d=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=In()):null==this._equirectShader&&(this._equirectShader=Wt());const _=e.isCubeTexture?this._cubemapShader:this._equirectShader,S=new Ro(Rc[0],_),B=_.uniforms;B.envMap.value=e,e.isCubeTexture||B.texelSize.value.set(1/e.image.width,1/e.image.height),B.inputEncoding.value=ru[e.encoding],B.outputEncoding.value=ru[c.texture.encoding],Ot(c,0,0,3*ya,2*ya),d.setRenderTarget(c),d.render(S,$h)}_applyPMREM(e){const c=this._renderer,d=c.autoClear;c.autoClear=!1;for(let _=1;_<pd;_++){const S=Math.sqrt(ba[_]*ba[_]-ba[_-1]*ba[_-1]);this._blur(e,_-1,_,S,He[(_-1)%He.length])}c.autoClear=d}_blur(e,c,d,_,S){const B=this._pingPongRenderTarget;this._halfBlur(e,B,c,d,_,"latitudinal",S),this._halfBlur(B,e,d,d,_,"longitudinal",S)}_halfBlur(e,c,d,_,S,B,k){const F=this._renderer,V=this._blurMaterial;"latitudinal"!==B&&"longitudinal"!==B&&console.error("blur direction must be either latitudinal or longitudinal!");const te=new Ro(Rc[_],V),ce=V.uniforms,ue=uh[d]-1,_e=isFinite(S)?Math.PI/(2*ue):2*Math.PI/39,Ee=S/_e,$e=isFinite(S)?1+Math.floor(3*Ee):20;$e>20&&console.warn(`sigmaRadians, ${S}, is too large and will clip, as it requested ${$e} samples when the maximum is set to 20`);const Be=[];let Re=0;for(let tt=0;tt<20;++tt){const Ze=tt/Ee,ot=Math.exp(-Ze*Ze/2);Be.push(ot),0==tt?Re+=ot:tt<$e&&(Re+=2*ot)}for(let tt=0;tt<Be.length;tt++)Be[tt]=Be[tt]/Re;ce.envMap.value=e.texture,ce.samples.value=$e,ce.weights.value=Be,ce.latitudinal.value="latitudinal"===B,k&&(ce.poleAxis.value=k),ce.dTheta.value=_e,ce.mipInt.value=8-d,ce.inputEncoding.value=ru[e.texture.encoding],ce.outputEncoding.value=ru[e.texture.encoding];const We=uh[_];Ot(c,3*Math.max(0,ya-2*We),(0===_?0:2*ya)+2*We*(_>4?_-8+4:0),3*We,2*We),F.setRenderTarget(c),F.render(te,$h)}}function bt(w){const e=new io(3*ya,3*ya,w);return e.texture.mapping=Ni,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Ot(w,e,c,d,_){w.viewport.set(e,c,d,_),w.scissor.set(e,c,d,_)}function Wt(){const w=new zn(1,1);return new Mu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:w},inputEncoding:{value:ru[Zi]},outputEncoding:{value:ru[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function In(){return new Mu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ru[Zi]},outputEncoding:{value:ru[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function Sn(w){let e=new WeakMap,c=null;function d(_){const S=_.target;S.removeEventListener("dispose",d);const B=e.get(S);void 0!==B&&(e.delete(S),B.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const S=_.mapping,B=S===Xs||S===ua,k=S===Ei||S===So;if(B||k){if(e.has(_))return e.get(_).texture;{const F=_.image;if(B&&F&&F.height>0||k&&F&&function(V){let te=0;for(let ce=0;ce<6;ce++)void 0!==V[ce]&&te++;return 6===te}(F)){const V=w.getRenderTarget();null===c&&(c=new we(w));const te=B?c.fromEquirectangular(_):c.fromCubemap(_);return e.set(_,te),w.setRenderTarget(V),_.addEventListener("dispose",d),te.texture}return null}}}return _},dispose:function(){e=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function Hn(w){const e={};function c(d){if(void 0!==e[d])return e[d];let _;switch(d){case"WEBGL_depth_texture":_=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_=w.getExtension(d)}return e[d]=_,_}return{has:function(d){return null!==c(d)},init:function(d){d.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float")},get:function(d){const _=c(d);return null===_&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),_}}}function Cr(w,e,c,d){const _={},S=new WeakMap;function B(F){const V=F.target;null!==V.index&&e.remove(V.index);for(const ce in V.attributes)e.remove(V.attributes[ce]);V.removeEventListener("dispose",B),delete _[V.id];const te=S.get(V);te&&(e.remove(te),S.delete(V)),d.releaseStatesOfGeometry(V),!0===V.isInstancedBufferGeometry&&delete V._maxInstanceCount,c.memory.geometries--}function k(F){const V=[],te=F.index,ce=F.attributes.position;let ue=0;if(null!==te){const $e=te.array;ue=te.version;for(let Be=0,Re=$e.length;Be<Re;Be+=3){const We=$e[Be+0],tt=$e[Be+1],Ze=$e[Be+2];V.push(We,tt,tt,Ze,Ze,We)}}else{ue=ce.version;for(let Be=0,Re=ce.array.length/3-1;Be<Re;Be+=3){const We=Be+0,tt=Be+1,Ze=Be+2;V.push(We,tt,tt,Ze,Ze,We)}}const _e=new(ci(V)>65535?li:sh)(V,1);_e.version=ue;const Ee=S.get(F);Ee&&e.remove(Ee),S.set(F,_e)}return{get:function(F,V){return!0===_[V.id]||(V.addEventListener("dispose",B),_[V.id]=!0,c.memory.geometries++),V},update:function(F){const V=F.attributes;for(const ce in V)e.update(V[ce],34962);const te=F.morphAttributes;for(const ce in te){const ue=te[ce];for(let _e=0,Ee=ue.length;_e<Ee;_e++)e.update(ue[_e],34962)}},getWireframeAttribute:function(F){const V=S.get(F);if(V){const te=F.index;null!==te&&V.version<te.version&&k(F)}else k(F);return S.get(F)}}}function Ur(w,e,c,d){const _=d.isWebGL2;let S,B,k;this.setMode=function(F){S=F},this.setIndex=function(F){B=F.type,k=F.bytesPerElement},this.render=function(F,V){w.drawElements(S,V,B,F*k),c.update(V,S,1)},this.renderInstances=function(F,V,te){if(0===te)return;let ce,ue;if(_)ce=w,ue="drawElementsInstanced";else if(ce=e.get("ANGLE_instanced_arrays"),ue="drawElementsInstancedANGLE",null===ce)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ce[ue](S,V,B,F*k,te),c.update(V,S,te)}}function Lr(w){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(c,d,_){switch(e.calls++,d){case 4:e.triangles+=_*(c/3);break;case 1:e.lines+=_*(c/2);break;case 3:e.lines+=_*(c-1);break;case 2:e.lines+=_*c;break;case 0:e.points+=_*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Qt(w,e){return w[0]-e[0]}function Ao(w,e){return Math.abs(e[1])-Math.abs(w[1])}function ic(w){const e={},c=new Float32Array(8),d=[];for(let _=0;_<8;_++)d[_]=[_,0];return{update:function(_,S,B,k){const F=_.morphTargetInfluences,V=void 0===F?0:F.length;let te=e[S.id];if(void 0===te||te.length!==V){te=[];for(let $e=0;$e<V;$e++)te[$e]=[$e,0];e[S.id]=te}for(let $e=0;$e<V;$e++){const Be=te[$e];Be[0]=$e,Be[1]=F[$e]}te.sort(Ao);for(let $e=0;$e<8;$e++)$e<V&&te[$e][1]?(d[$e][0]=te[$e][0],d[$e][1]=te[$e][1]):(d[$e][0]=Number.MAX_SAFE_INTEGER,d[$e][1]=0);d.sort(Qt);const ce=S.morphAttributes.position,ue=S.morphAttributes.normal;let _e=0;for(let $e=0;$e<8;$e++){const Be=d[$e],Re=Be[0],We=Be[1];Re!==Number.MAX_SAFE_INTEGER&&We?(ce&&S.getAttribute("morphTarget"+$e)!==ce[Re]&&S.setAttribute("morphTarget"+$e,ce[Re]),ue&&S.getAttribute("morphNormal"+$e)!==ue[Re]&&S.setAttribute("morphNormal"+$e,ue[Re]),c[$e]=We,_e+=We):(ce&&!0===S.hasAttribute("morphTarget"+$e)&&S.deleteAttribute("morphTarget"+$e),ue&&!0===S.hasAttribute("morphNormal"+$e)&&S.deleteAttribute("morphNormal"+$e),c[$e]=0)}const Ee=S.morphTargetsRelative?1:1-_e;k.getUniforms().setValue(w,"morphTargetBaseInfluence",Ee),k.getUniforms().setValue(w,"morphTargetInfluences",c)}}}function el(w,e,c,d){let _=new WeakMap;function S(B){const k=B.target;k.removeEventListener("dispose",S),c.remove(k.instanceMatrix),null!==k.instanceColor&&c.remove(k.instanceColor)}return{update:function(B){const k=d.render.frame,V=e.get(B,B.geometry);return _.get(V)!==k&&(e.update(V),_.set(V,k)),B.isInstancedMesh&&(!1===B.hasEventListener("dispose",S)&&B.addEventListener("dispose",S),c.update(B.instanceMatrix,34962),null!==B.instanceColor&&c.update(B.instanceColor,34962)),V},dispose:function(){_=new WeakMap}}}class Qr extends $s{constructor(e=null,c=1,d=1,_=1){super(null),this.image={data:e,width:c,height:d,depth:_},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Qr.prototype.isDataTexture2DArray=!0;class Cn extends $s{constructor(e=null,c=1,d=1,_=1){super(null),this.image={data:e,width:c,height:d,depth:_},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Cn.prototype.isDataTexture3D=!0;const Id=new $s,Cm=new Qr,gr=new Cn,rf=new nc,of=[],Af=[],Au=new Float32Array(16),$f=new Float32Array(9),xa=new Float32Array(4);function oc(w,e,c){const d=w[0];if(d<=0||d>0)return w;const _=e*c;let S=of[_];if(void 0===S&&(S=new Float32Array(_),of[_]=S),0!==e){d.toArray(S,0);for(let B=1,k=0;B!==e;++B)k+=c,w[B].toArray(S,k)}return S}function ys(w,e){if(w.length!==e.length)return!1;for(let c=0,d=w.length;c<d;c++)if(w[c]!==e[c])return!1;return!0}function tl(w,e){for(let c=0,d=e.length;c<d;c++)w[c]=e[c]}function sf(w,e){let c=Af[e];void 0===c&&(c=new Int32Array(e),Af[e]=c);for(let d=0;d!==e;++d)c[d]=w.allocateTextureUnit();return c}function Vf(w,e){const c=this.cache;c[0]!==e&&(w.uniform1f(this.addr,e),c[0]=e)}function Wf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y||(w.uniform2f(this.addr,e.x,e.y),c[0]=e.x,c[1]=e.y);else{if(ys(c,e))return;w.uniform2fv(this.addr,e),tl(c,e)}}function Cf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z||(w.uniform3f(this.addr,e.x,e.y,e.z),c[0]=e.x,c[1]=e.y,c[2]=e.z);else if(void 0!==e.r)c[0]===e.r&&c[1]===e.g&&c[2]===e.b||(w.uniform3f(this.addr,e.r,e.g,e.b),c[0]=e.r,c[1]=e.g,c[2]=e.b);else{if(ys(c,e))return;w.uniform3fv(this.addr,e),tl(c,e)}}function qf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z&&c[3]===e.w||(w.uniform4f(this.addr,e.x,e.y,e.z,e.w),c[0]=e.x,c[1]=e.y,c[2]=e.z,c[3]=e.w);else{if(ys(c,e))return;w.uniform4fv(this.addr,e),tl(c,e)}}function Lm(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(ys(c,e))return;w.uniformMatrix2fv(this.addr,!1,e),tl(c,e)}else{if(ys(c,d))return;xa.set(d),w.uniformMatrix2fv(this.addr,!1,xa),tl(c,d)}}function Bp(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(ys(c,e))return;w.uniformMatrix3fv(this.addr,!1,e),tl(c,e)}else{if(ys(c,d))return;$f.set(d),w.uniformMatrix3fv(this.addr,!1,$f),tl(c,d)}}function Xf(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(ys(c,e))return;w.uniformMatrix4fv(this.addr,!1,e),tl(c,e)}else{if(ys(c,d))return;Au.set(d),w.uniformMatrix4fv(this.addr,!1,Au),tl(c,d)}}function Bm(w,e){const c=this.cache;c[0]!==e&&(w.uniform1i(this.addr,e),c[0]=e)}function Yf(w,e){const c=this.cache;ys(c,e)||(w.uniform2iv(this.addr,e),tl(c,e))}function Jf(w,e){const c=this.cache;ys(c,e)||(w.uniform3iv(this.addr,e),tl(c,e))}function Od(w,e){const c=this.cache;ys(c,e)||(w.uniform4iv(this.addr,e),tl(c,e))}function Nm(w,e){const c=this.cache;c[0]!==e&&(w.uniform1ui(this.addr,e),c[0]=e)}function Rm(w,e){const c=this.cache;ys(c,e)||(w.uniform2uiv(this.addr,e),tl(c,e))}function kd(w,e){const c=this.cache;ys(c,e)||(w.uniform3uiv(this.addr,e),tl(c,e))}function dd(w,e){const c=this.cache;ys(c,e)||(w.uniform4uiv(this.addr,e),tl(c,e))}function Zf(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.safeSetTexture2D(e||Id,_)}function Fd(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.setTexture3D(e||gr,_)}function tp(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.safeSetTextureCube(e||rf,_)}function Pm(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.setTexture2DArray(e||Cm,_)}function Im(w,e){w.uniform1fv(this.addr,e)}function Om(w,e){const c=oc(e,this.size,2);w.uniform2fv(this.addr,c)}function Qf(w,e){const c=oc(e,this.size,3);w.uniform3fv(this.addr,c)}function km(w,e){const c=oc(e,this.size,4);w.uniform4fv(this.addr,c)}function Dd(w,e){const c=oc(e,this.size,4);w.uniformMatrix2fv(this.addr,!1,c)}function Kf(w,e){const c=oc(e,this.size,9);w.uniformMatrix3fv(this.addr,!1,c)}function Fm(w,e){const c=oc(e,this.size,16);w.uniformMatrix4fv(this.addr,!1,c)}function Pc(w,e){w.uniform1iv(this.addr,e)}function Lf(w,e){w.uniform2iv(this.addr,e)}function em(w,e){w.uniform3iv(this.addr,e)}function tm(w,e){w.uniform4iv(this.addr,e)}function af(w,e){w.uniform1uiv(this.addr,e)}function Dm(w,e){w.uniform2uiv(this.addr,e)}function nm(w,e){w.uniform3uiv(this.addr,e)}function Um(w,e){w.uniform4uiv(this.addr,e)}function Bf(w,e,c){const d=e.length,_=sf(c,d);w.uniform1iv(this.addr,_);for(let S=0;S!==d;++S)c.safeSetTexture2D(e[S]||Id,_[S])}function zm(w,e,c){const d=e.length,_=sf(c,d);w.uniform1iv(this.addr,_);for(let S=0;S!==d;++S)c.safeSetTextureCube(e[S]||rf,_[S])}function lf(w,e,c){this.id=w,this.addr=c,this.cache=[],this.setValue=function(d){switch(d){case 5126:return Vf;case 35664:return Wf;case 35665:return Cf;case 35666:return qf;case 35674:return Lm;case 35675:return Bp;case 35676:return Xf;case 5124:case 35670:return Bm;case 35667:case 35671:return Yf;case 35668:case 35672:return Jf;case 35669:case 35673:return Od;case 5125:return Nm;case 36294:return Rm;case 36295:return kd;case 36296:return dd;case 35678:case 36198:case 36298:case 36306:case 35682:return Zf;case 35679:case 36299:case 36307:return Fd;case 35680:case 36300:case 36308:case 36293:return tp;case 36289:case 36303:case 36311:case 36292:return Pm}}(e.type)}function Ud(w,e,c){this.id=w,this.addr=c,this.cache=[],this.size=e.size,this.setValue=function(d){switch(d){case 5126:return Im;case 35664:return Om;case 35665:return Qf;case 35666:return km;case 35674:return Dd;case 35675:return Kf;case 35676:return Fm;case 5124:case 35670:return Pc;case 35667:case 35671:return Lf;case 35668:case 35672:return em;case 35669:case 35673:return tm;case 5125:return af;case 36294:return Dm;case 36295:return nm;case 36296:return Um;case 35678:case 36198:case 36298:case 36306:case 35682:return Bf;case 35680:case 36300:case 36308:case 36293:return zm}}(e.type)}function np(w){this.id=w,this.seq=[],this.map={}}Ud.prototype.updateCache=function(w){const e=this.cache;w instanceof Float32Array&&e.length!==w.length&&(this.cache=new Float32Array(w.length)),tl(e,w)},np.prototype.setValue=function(w,e,c){const d=this.seq;for(let _=0,S=d.length;_!==S;++_){const B=d[_];B.setValue(w,e[B.id],c)}};const ta=/(\w+)(\])?(\[|\.)?/g;function Ch(w,e){w.seq.push(e),w.map[e.id]=e}function Ic(w,e,c){const d=w.name,_=d.length;for(ta.lastIndex=0;;){const S=ta.exec(d);let k=S[1];const V=S[3];if("]"===S[2]&&(k|=0),void 0===V||"["===V&&ta.lastIndex+2===_){Ch(c,void 0===V?new lf(k,w,e):new Ud(k,w,e));break}{let te=c.map[k];void 0===te&&(te=new np(k),Ch(c,te)),c=te}}}function sc(w,e){this.seq=[],this.map={};const c=w.getProgramParameter(e,35718);for(let d=0;d<c;++d){const _=w.getActiveUniform(e,d);Ic(_,w.getUniformLocation(e,_.name),this)}}function ac(w,e,c){const d=w.createShader(e);return w.shaderSource(d,c),w.compileShader(d),d}sc.prototype.setValue=function(w,e,c,d){const _=this.map[e];void 0!==_&&_.setValue(w,c,d)},sc.prototype.setOptional=function(w,e,c){const d=e[c];void 0!==d&&this.setValue(w,c,d)},sc.upload=function(w,e,c,d){for(let _=0,S=e.length;_!==S;++_){const B=e[_],k=c[B.id];!1!==k.needsUpdate&&B.setValue(w,k.value,d)}},sc.seqWithValue=function(w,e){const c=[];for(let d=0,_=w.length;d!==_;++d){const S=w[d];S.id in e&&c.push(S)}return c};let fd=0;function zd(w){switch(w){case Zi:return["Linear","( value )"];case hl:return["sRGB","( value )"];case Yc:return["RGBE","( value )"];case xc:return["RGBM","( value, 7.0 )"];case nh:return["RGBM","( value, 16.0 )"];case vu:return["RGBD","( value, 256.0 )"];case Ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Wh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",w),["Linear","( value )"]}}function md(w,e,c){const d=w.getShaderParameter(e,35713),_=w.getShaderInfoLog(e).trim();return d&&""===_?"":c.toUpperCase()+"\n\n"+_+"\n\n"+function(S){const B=S.split("\n");for(let k=0;k<B.length;k++)B[k]=k+1+": "+B[k];return B.join("\n")}(w.getShaderSource(e))}function wa(w,e){const c=zd(e);return"vec4 "+w+"( vec4 value ) { return "+c[0]+"ToLinear"+c[1]+"; }"}function Np(w,e){const c=zd(e);return"vec4 "+w+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function cf(w,e){let c;switch(e){case mi:c="Linear";break;case go:c="Reinhard";break;case Nr:c="OptimizedCineon";break;case ei:c="ACESFilmic";break;case Wr:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),c="Linear"}return"vec3 "+w+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function jd(w){return""!==w}function _d(w,e){return w.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function uf(w,e){return w.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const hf=/^[ \t]*#include +<([\w\d./]+)>/gm;function Xp(w){return w.replace(hf,Oa)}function Oa(w,e){const c=ui[e];if(void 0===c)throw new Error("Can not resolve #include <"+e+">");return Xp(c)}const $u=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Lh=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _i(w){return w.replace(Lh,vd).replace($u,gd)}function gd(w,e,c,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),vd(0,e,c,d)}function vd(w,e,c,d){let _="";for(let S=parseInt(e);S<parseInt(c);S++)_+=d.replace(/\[\s*i\s*\]/g,"[ "+S+" ]").replace(/UNROLLED_LOOP_INDEX/g,S);return _}function Rp(w){let e="precision "+w.precision+" float;\nprecision "+w.precision+" int;";return"highp"===w.precision?e+="\n#define HIGH_PRECISION":"mediump"===w.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===w.precision&&(e+="\n#define LOW_PRECISION"),e}function yd(w,e,c,d){const _=w.getContext(),S=c.defines;let B=c.vertexShader,k=c.fragmentShader;const F=function(Ft){let Qe="SHADOWMAP_TYPE_BASIC";return Ft.shadowMapType===he?Qe="SHADOWMAP_TYPE_PCF":Ft.shadowMapType===ae?Qe="SHADOWMAP_TYPE_PCF_SOFT":Ft.shadowMapType===fe&&(Qe="SHADOWMAP_TYPE_VSM"),Qe}(c),V=function(Ft){let Qe="ENVMAP_TYPE_CUBE";if(Ft.envMap)switch(Ft.envMapMode){case Ei:case So:Qe="ENVMAP_TYPE_CUBE";break;case Ni:case Eo:Qe="ENVMAP_TYPE_CUBE_UV"}return Qe}(c),te=function(Ft){let Qe="ENVMAP_MODE_REFLECTION";if(Ft.envMap)switch(Ft.envMapMode){case So:case Eo:Qe="ENVMAP_MODE_REFRACTION"}return Qe}(c),ce=function(Ft){let Qe="ENVMAP_BLENDING_NONE";if(Ft.envMap)switch(Ft.combine){case Kr:Qe="ENVMAP_BLENDING_MULTIPLY";break;case pi:Qe="ENVMAP_BLENDING_MIX";break;case rr:Qe="ENVMAP_BLENDING_ADD"}return Qe}(c),ue=w.gammaFactor>0?w.gammaFactor:1,_e=c.isWebGL2?"":[(Ft=c).extensionDerivatives||Ft.envMapCubeUV||Ft.bumpMap||Ft.tangentSpaceNormalMap||Ft.clearcoatNormalMap||Ft.flatShading||"physical"===Ft.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(Ft.extensionFragDepth||Ft.logarithmicDepthBuffer)&&Ft.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Ft.extensionDrawBuffers&&Ft.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Ft.extensionShaderTextureLOD||Ft.envMap||Ft.transmission)&&Ft.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jd).join("\n"),Ee=function(Ft){const Qe=[];for(const nt in Ft){const Et=Ft[nt];!1!==Et&&Qe.push("#define "+nt+" "+Et)}return Qe.join("\n")}(S),$e=_.createProgram();var Ft;let Be,Re,We=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(Be=[Ee].filter(jd).join("\n"),Be.length>0&&(Be+="\n"),Re=[_e,Ee].filter(jd).join("\n"),Re.length>0&&(Re+="\n")):(Be=[Rp(c),"#define SHADER_NAME "+c.shaderName,Ee,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+ue,"#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+te:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jd).join("\n"),Re=[_e,Rp(c),"#define SHADER_NAME "+c.shaderName,Ee,"#define GAMMA_FACTOR "+ue,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+V:"",c.envMap?"#define "+te:"",c.envMap?"#define "+ce:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheenTint?"#define USE_SHEEN":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==vr?"#define TONE_MAPPING":"",c.toneMapping!==vr?ui.tonemapping_pars_fragment:"",c.toneMapping!==vr?cf("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.format===Fs?"#define OPAQUE":"",ui.encodings_pars_fragment,c.map?wa("mapTexelToLinear",c.mapEncoding):"",c.matcap?wa("matcapTexelToLinear",c.matcapEncoding):"",c.envMap?wa("envMapTexelToLinear",c.envMapEncoding):"",c.emissiveMap?wa("emissiveMapTexelToLinear",c.emissiveMapEncoding):"",c.specularTintMap?wa("specularTintMapTexelToLinear",c.specularTintMapEncoding):"",c.lightMap?wa("lightMapTexelToLinear",c.lightMapEncoding):"",Np("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(jd).join("\n")),B=Xp(B),B=_d(B,c),B=uf(B,c),k=Xp(k),k=_d(k,c),k=uf(k,c),B=_i(B),k=_i(k),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(We="#version 300 es\n",Be=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+Be,Re=["#define varying in",c.glslVersion===Ri?"":"out highp vec4 pc_fragColor;",c.glslVersion===Ri?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Re);const tt=We+Re+k,Ze=ac(_,35633,We+Be+B),ot=ac(_,35632,tt);if(_.attachShader($e,Ze),_.attachShader($e,ot),void 0!==c.index0AttributeName?_.bindAttribLocation($e,0,c.index0AttributeName):!0===c.morphTargets&&_.bindAttribLocation($e,0,"position"),_.linkProgram($e),w.debug.checkShaderErrors){const Ft=_.getProgramInfoLog($e).trim(),Qe=_.getShaderInfoLog(Ze).trim(),nt=_.getShaderInfoLog(ot).trim();let Et=!0,Jt=!0;if(!1===_.getProgramParameter($e,35714)){Et=!1;const ct=md(_,Ze,"vertex"),Lt=md(_,ot,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_.getError()+" - VALIDATE_STATUS "+_.getProgramParameter($e,35715)+"\n\nProgram Info Log: "+Ft+"\n"+ct+"\n"+Lt)}else""!==Ft?console.warn("THREE.WebGLProgram: Program Info Log:",Ft):""!==Qe&&""!==nt||(Jt=!1);Jt&&(this.diagnostics={runnable:Et,programLog:Ft,vertexShader:{log:Qe,prefix:Be},fragmentShader:{log:nt,prefix:Re}})}let st,Ct;return _.deleteShader(Ze),_.deleteShader(ot),this.getUniforms=function(){return void 0===st&&(st=new sc(_,$e)),st},this.getAttributes=function(){return void 0===Ct&&(Ct=function(Ft,Qe){const nt={},Et=Ft.getProgramParameter(Qe,35721);for(let Jt=0;Jt<Et;Jt++){const ct=Ft.getActiveAttrib(Qe,Jt),Lt=ct.name;let _t=1;35674===ct.type&&(_t=2),35675===ct.type&&(_t=3),35676===ct.type&&(_t=4),nt[Lt]={type:ct.type,location:Ft.getAttribLocation(Qe,Lt),locationSize:_t}}return nt}(_,$e)),Ct},this.destroy=function(){d.releaseStatesOfProgram(this),_.deleteProgram($e),this.program=void 0},this.name=c.shaderName,this.id=fd++,this.cacheKey=e,this.usedTimes=1,this.program=$e,this.vertexShader=Ze,this.fragmentShader=ot,this}function Pp(w,e,c,d,_,S,B){const k=[],F=_.isWebGL2,V=_.logarithmicDepthBuffer,te=_.floatVertexTextures,ce=_.maxVertexUniforms,ue=_.vertexTextures;let _e=_.precision;const Ee={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},$e=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function Be(Re){let We;return Re&&Re.isTexture?We=Re.encoding:Re&&Re.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),We=Re.texture.encoding):We=Zi,We}return{getParameters:function(Re,We,tt,Ze,ot){const st=Ze.fog,Ft=(Re.isMeshStandardMaterial?c:e).get(Re.envMap||(Re.isMeshStandardMaterial?Ze.environment:null)),Qe=Ee[Re.type],nt=ot.isSkinnedMesh?function(zt){const Rt=zt.skeleton.bones;if(te)return 1024;{const en=Math.floor((ce-20)/4),En=Math.min(en,Rt.length);return En<Rt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Rt.length+" bones. This GPU supports "+En+"."),0):En}}(ot):0;let Et,Jt;if(null!==Re.precision&&(_e=_.getMaxPrecision(Re.precision),_e!==Re.precision&&console.warn("THREE.WebGLProgram.getParameters:",Re.precision,"not supported, using",_e,"instead.")),Qe){const zt=Ol[Qe];Et=zt.vertexShader,Jt=zt.fragmentShader}else Et=Re.vertexShader,Jt=Re.fragmentShader;const ct=w.getRenderTarget(),Lt=Re.alphaTest>0,_t=Re.clearcoat>0;return{isWebGL2:F,shaderID:Qe,shaderName:Re.type,vertexShader:Et,fragmentShader:Jt,defines:Re.defines,isRawShaderMaterial:!0===Re.isRawShaderMaterial,glslVersion:Re.glslVersion,precision:_e,instancing:!0===ot.isInstancedMesh,instancingColor:!0===ot.isInstancedMesh&&null!==ot.instanceColor,supportsVertexTextures:ue,outputEncoding:null!==ct?Be(ct.texture):w.outputEncoding,map:!!Re.map,mapEncoding:Be(Re.map),matcap:!!Re.matcap,matcapEncoding:Be(Re.matcap),envMap:!!Ft,envMapMode:Ft&&Ft.mapping,envMapEncoding:Be(Ft),envMapCubeUV:!!Ft&&(Ft.mapping===Ni||Ft.mapping===Eo),lightMap:!!Re.lightMap,lightMapEncoding:Be(Re.lightMap),aoMap:!!Re.aoMap,emissiveMap:!!Re.emissiveMap,emissiveMapEncoding:Be(Re.emissiveMap),bumpMap:!!Re.bumpMap,normalMap:!!Re.normalMap,objectSpaceNormalMap:Re.normalMapType===Ne,tangentSpaceNormalMap:Re.normalMapType===Me,clearcoat:_t,clearcoatMap:_t&&!!Re.clearcoatMap,clearcoatRoughnessMap:_t&&!!Re.clearcoatRoughnessMap,clearcoatNormalMap:_t&&!!Re.clearcoatNormalMap,displacementMap:!!Re.displacementMap,roughnessMap:!!Re.roughnessMap,metalnessMap:!!Re.metalnessMap,specularMap:!!Re.specularMap,specularIntensityMap:!!Re.specularIntensityMap,specularTintMap:!!Re.specularTintMap,specularTintMapEncoding:Be(Re.specularTintMap),alphaMap:!!Re.alphaMap,alphaTest:Lt,gradientMap:!!Re.gradientMap,sheenTint:!!Re.sheenTint&&(Re.sheenTint.r>0||Re.sheenTint.g>0||Re.sheenTint.b>0),transmission:Re.transmission>0,transmissionMap:!!Re.transmissionMap,thicknessMap:!!Re.thicknessMap,combine:Re.combine,vertexTangents:!!Re.normalMap&&!!ot.geometry&&!!ot.geometry.attributes.tangent,vertexColors:Re.vertexColors,vertexAlphas:!0===Re.vertexColors&&!!ot.geometry&&!!ot.geometry.attributes.color&&4===ot.geometry.attributes.color.itemSize,vertexUvs:!!(Re.map||Re.bumpMap||Re.normalMap||Re.specularMap||Re.alphaMap||Re.emissiveMap||Re.roughnessMap||Re.metalnessMap||Re.clearcoatMap||Re.clearcoatRoughnessMap||Re.clearcoatNormalMap||Re.displacementMap||Re.transmissionMap||Re.thicknessMap||Re.specularIntensityMap||Re.specularTintMap),uvsVertexOnly:!(Re.map||Re.bumpMap||Re.normalMap||Re.specularMap||Re.alphaMap||Re.emissiveMap||Re.roughnessMap||Re.metalnessMap||Re.clearcoatNormalMap||Re.transmission>0||Re.transmissionMap||Re.thicknessMap||Re.specularIntensityMap||Re.specularTintMap||!Re.displacementMap),fog:!!st,useFog:Re.fog,fogExp2:st&&st.isFogExp2,flatShading:!!Re.flatShading,sizeAttenuation:Re.sizeAttenuation,logarithmicDepthBuffer:V,skinning:!0===ot.isSkinnedMesh&&nt>0,maxBones:nt,useVertexTexture:te,morphTargets:!!ot.geometry&&!!ot.geometry.morphAttributes.position,morphNormals:!!ot.geometry&&!!ot.geometry.morphAttributes.normal,numDirLights:We.directional.length,numPointLights:We.point.length,numSpotLights:We.spot.length,numRectAreaLights:We.rectArea.length,numHemiLights:We.hemi.length,numDirLightShadows:We.directionalShadowMap.length,numPointLightShadows:We.pointShadowMap.length,numSpotLightShadows:We.spotShadowMap.length,numClippingPlanes:B.numPlanes,numClipIntersection:B.numIntersection,format:Re.format,dithering:Re.dithering,shadowMapEnabled:w.shadowMap.enabled&&tt.length>0,shadowMapType:w.shadowMap.type,toneMapping:Re.toneMapped?w.toneMapping:vr,physicallyCorrectLights:w.physicallyCorrectLights,premultipliedAlpha:Re.premultipliedAlpha,doubleSided:Re.side===Y,flipSided:Re.side===q,depthPacking:void 0!==Re.depthPacking&&Re.depthPacking,index0AttributeName:Re.index0AttributeName,extensionDerivatives:Re.extensions&&Re.extensions.derivatives,extensionFragDepth:Re.extensions&&Re.extensions.fragDepth,extensionDrawBuffers:Re.extensions&&Re.extensions.drawBuffers,extensionShaderTextureLOD:Re.extensions&&Re.extensions.shaderTextureLOD,rendererExtensionFragDepth:F||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:F||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:F||d.has("EXT_shader_texture_lod"),customProgramCacheKey:Re.customProgramCacheKey()}},getProgramCacheKey:function(Re){const We=[];if(Re.shaderID?We.push(Re.shaderID):(We.push(Re.fragmentShader),We.push(Re.vertexShader)),void 0!==Re.defines)for(const tt in Re.defines)We.push(tt),We.push(Re.defines[tt]);if(!1===Re.isRawShaderMaterial){for(let tt=0;tt<$e.length;tt++)We.push(Re[$e[tt]]);We.push(w.outputEncoding),We.push(w.gammaFactor)}return We.push(Re.customProgramCacheKey),We.join()},getUniforms:function(Re){const We=Ee[Re.type];let tt;return tt=We?Rs.clone(Ol[We].uniforms):Re.uniforms,tt},acquireProgram:function(Re,We){let tt;for(let Ze=0,ot=k.length;Ze<ot;Ze++){const st=k[Ze];if(st.cacheKey===We){tt=st,++tt.usedTimes;break}}return void 0===tt&&(tt=new yd(w,We,Re,S),k.push(tt)),tt},releaseProgram:function(Re){if(0==--Re.usedTimes){const We=k.indexOf(Re);k[We]=k[k.length-1],k.pop(),Re.destroy()}},programs:k}}function Gd(){let w=new WeakMap;return{get:function(e){let c=w.get(e);return void 0===c&&(c={},w.set(e,c)),c},remove:function(e){w.delete(e)},update:function(e,c,d){w.get(e)[c]=d},dispose:function(){w=new WeakMap}}}function lc(w,e){return w.groupOrder!==e.groupOrder?w.groupOrder-e.groupOrder:w.renderOrder!==e.renderOrder?w.renderOrder-e.renderOrder:w.program!==e.program?w.program.id-e.program.id:w.material.id!==e.material.id?w.material.id-e.material.id:w.z!==e.z?w.z-e.z:w.id-e.id}function Hd(w,e){return w.groupOrder!==e.groupOrder?w.groupOrder-e.groupOrder:w.renderOrder!==e.renderOrder?w.renderOrder-e.renderOrder:w.z!==e.z?e.z-w.z:w.id-e.id}function bd(w){const e=[];let c=0;const d=[],_=[],S=[],B={id:-1};function k(F,V,te,ce,ue,_e){let Ee=e[c];const $e=w.get(te);return void 0===Ee?(Ee={id:F.id,object:F,geometry:V,material:te,program:$e.program||B,groupOrder:ce,renderOrder:F.renderOrder,z:ue,group:_e},e[c]=Ee):(Ee.id=F.id,Ee.object=F,Ee.geometry=V,Ee.material=te,Ee.program=$e.program||B,Ee.groupOrder=ce,Ee.renderOrder=F.renderOrder,Ee.z=ue,Ee.group=_e),c++,Ee}return{opaque:d,transmissive:_,transparent:S,init:function(){c=0,d.length=0,_.length=0,S.length=0},push:function(F,V,te,ce,ue,_e){const Ee=k(F,V,te,ce,ue,_e);te.transmission>0?_.push(Ee):!0===te.transparent?S.push(Ee):d.push(Ee)},unshift:function(F,V,te,ce,ue,_e){const Ee=k(F,V,te,ce,ue,_e);te.transmission>0?_.unshift(Ee):!0===te.transparent?S.unshift(Ee):d.unshift(Ee)},finish:function(){for(let F=c,V=e.length;F<V;F++){const te=e[F];if(null===te.id)break;te.id=null,te.object=null,te.geometry=null,te.material=null,te.program=null,te.group=null}},sort:function(F,V){d.length>1&&d.sort(F||lc),_.length>1&&_.sort(V||Hd),S.length>1&&S.sort(V||Hd)}}}function pf(w){let e=new WeakMap;return{get:function(c,d){let _;return!1===e.has(c)?(_=new bd(w),e.set(c,[_])):d>=e.get(c).length?(_=new bd(w),e.get(c).push(_)):_=e.get(c)[d],_},dispose:function(){e=new WeakMap}}}function Nf(){const w={};return{get:function(e){if(void 0!==w[e.id])return w[e.id];let c;switch(e.type){case"DirectionalLight":c={direction:new ht,color:new er};break;case"SpotLight":c={position:new ht,direction:new ht,color:new er,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new ht,color:new er,distance:0,decay:0};break;case"HemisphereLight":c={direction:new ht,skyColor:new er,groundColor:new er};break;case"RectAreaLight":c={color:new er,position:new ht,halfWidth:new ht,halfHeight:new ht}}return w[e.id]=c,c}}}let Rf=0;function rm(w,e){return(e.castShadow?1:0)-(w.castShadow?1:0)}function nl(w,e){const c=new Nf,d=function(){const F={};return{get:function(V){if(void 0!==F[V.id])return F[V.id];let te;switch(V.type){case"DirectionalLight":case"SpotLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"PointLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn,shadowCameraNear:1,shadowCameraFar:1e3}}return F[V.id]=te,te}}}(),_={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let F=0;F<9;F++)_.probe.push(new ht);const S=new ht,B=new tn,k=new tn;return{setup:function(F,V){let te=0,ce=0,ue=0;for(let Ct=0;Ct<9;Ct++)_.probe[Ct].set(0,0,0);let _e=0,Ee=0,$e=0,Be=0,Re=0,We=0,tt=0,Ze=0;F.sort(rm);const ot=!0!==V?Math.PI:1;for(let Ct=0,Ft=F.length;Ct<Ft;Ct++){const Qe=F[Ct],nt=Qe.color,Et=Qe.intensity,Jt=Qe.distance,ct=Qe.shadow&&Qe.shadow.map?Qe.shadow.map.texture:null;if(Qe.isAmbientLight)te+=nt.r*Et*ot,ce+=nt.g*Et*ot,ue+=nt.b*Et*ot;else if(Qe.isLightProbe)for(let Lt=0;Lt<9;Lt++)_.probe[Lt].addScaledVector(Qe.sh.coefficients[Lt],Et);else if(Qe.isDirectionalLight){const Lt=c.get(Qe);if(Lt.color.copy(Qe.color).multiplyScalar(Qe.intensity*ot),Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,_.directionalShadow[_e]=zt,_.directionalShadowMap[_e]=ct,_.directionalShadowMatrix[_e]=Qe.shadow.matrix,We++}_.directional[_e]=Lt,_e++}else if(Qe.isSpotLight){const Lt=c.get(Qe);if(Lt.position.setFromMatrixPosition(Qe.matrixWorld),Lt.color.copy(nt).multiplyScalar(Et*ot),Lt.distance=Jt,Lt.coneCos=Math.cos(Qe.angle),Lt.penumbraCos=Math.cos(Qe.angle*(1-Qe.penumbra)),Lt.decay=Qe.decay,Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,_.spotShadow[$e]=zt,_.spotShadowMap[$e]=ct,_.spotShadowMatrix[$e]=Qe.shadow.matrix,Ze++}_.spot[$e]=Lt,$e++}else if(Qe.isRectAreaLight){const Lt=c.get(Qe);Lt.color.copy(nt).multiplyScalar(Et),Lt.halfWidth.set(.5*Qe.width,0,0),Lt.halfHeight.set(0,.5*Qe.height,0),_.rectArea[Be]=Lt,Be++}else if(Qe.isPointLight){const Lt=c.get(Qe);if(Lt.color.copy(Qe.color).multiplyScalar(Qe.intensity*ot),Lt.distance=Qe.distance,Lt.decay=Qe.decay,Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,zt.shadowCameraNear=_t.camera.near,zt.shadowCameraFar=_t.camera.far,_.pointShadow[Ee]=zt,_.pointShadowMap[Ee]=ct,_.pointShadowMatrix[Ee]=Qe.shadow.matrix,tt++}_.point[Ee]=Lt,Ee++}else if(Qe.isHemisphereLight){const Lt=c.get(Qe);Lt.skyColor.copy(Qe.color).multiplyScalar(Et*ot),Lt.groundColor.copy(Qe.groundColor).multiplyScalar(Et*ot),_.hemi[Re]=Lt,Re++}}Be>0&&(e.isWebGL2||!0===w.has("OES_texture_float_linear")?(_.rectAreaLTC1=sr.LTC_FLOAT_1,_.rectAreaLTC2=sr.LTC_FLOAT_2):!0===w.has("OES_texture_half_float_linear")?(_.rectAreaLTC1=sr.LTC_HALF_1,_.rectAreaLTC2=sr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_.ambient[0]=te,_.ambient[1]=ce,_.ambient[2]=ue;const st=_.hash;st.directionalLength===_e&&st.pointLength===Ee&&st.spotLength===$e&&st.rectAreaLength===Be&&st.hemiLength===Re&&st.numDirectionalShadows===We&&st.numPointShadows===tt&&st.numSpotShadows===Ze||(_.directional.length=_e,_.spot.length=$e,_.rectArea.length=Be,_.point.length=Ee,_.hemi.length=Re,_.directionalShadow.length=We,_.directionalShadowMap.length=We,_.pointShadow.length=tt,_.pointShadowMap.length=tt,_.spotShadow.length=Ze,_.spotShadowMap.length=Ze,_.directionalShadowMatrix.length=We,_.pointShadowMatrix.length=tt,_.spotShadowMatrix.length=Ze,st.directionalLength=_e,st.pointLength=Ee,st.spotLength=$e,st.rectAreaLength=Be,st.hemiLength=Re,st.numDirectionalShadows=We,st.numPointShadows=tt,st.numSpotShadows=Ze,_.version=Rf++)},setupView:function(F,V){let te=0,ce=0,ue=0,_e=0,Ee=0;const $e=V.matrixWorldInverse;for(let Be=0,Re=F.length;Be<Re;Be++){const We=F[Be];if(We.isDirectionalLight){const tt=_.directional[te];tt.direction.setFromMatrixPosition(We.matrixWorld),S.setFromMatrixPosition(We.target.matrixWorld),tt.direction.sub(S),tt.direction.transformDirection($e),te++}else if(We.isSpotLight){const tt=_.spot[ue];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),tt.direction.setFromMatrixPosition(We.matrixWorld),S.setFromMatrixPosition(We.target.matrixWorld),tt.direction.sub(S),tt.direction.transformDirection($e),ue++}else if(We.isRectAreaLight){const tt=_.rectArea[_e];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),k.identity(),B.copy(We.matrixWorld),B.premultiply($e),k.extractRotation(B),tt.halfWidth.set(.5*We.width,0,0),tt.halfHeight.set(0,.5*We.height,0),tt.halfWidth.applyMatrix4(k),tt.halfHeight.applyMatrix4(k),_e++}else if(We.isPointLight){const tt=_.point[ce];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),ce++}else if(We.isHemisphereLight){const tt=_.hemi[Ee];tt.direction.setFromMatrixPosition(We.matrixWorld),tt.direction.transformDirection($e),tt.direction.normalize(),Ee++}}},state:_}}function Ip(w,e){const c=new nl(w,e),d=[],_=[];return{init:function(){d.length=0,_.length=0},state:{lightsArray:d,shadowsArray:_,lights:c},setupLights:function(S){c.setup(d,S)},setupLightsView:function(S){c.setupView(d,S)},pushLight:function(S){d.push(S)},pushShadow:function(S){_.push(S)}}}function df(w,e){let c=new WeakMap;return{get:function(d,_=0){let S;return!1===c.has(d)?(S=new Ip(w,e),c.set(d,[S])):_>=c.get(d).length?(S=new Ip(w,e),c.get(d).push(S)):S=c.get(d)[_],S},dispose:function(){c=new WeakMap}}}class Vd extends Cs{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=W,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Vd.prototype.isMeshDepthMaterial=!0;class Op extends Cs{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ht,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Op.prototype.isMeshDistanceMaterial=!0;var ff="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",im="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function om(w,e,c){let d=new Dr;const _=new zn,S=new zn,B=new Di,k=new Vd({depthPacking:pe}),F=new Op,V={},te=c.maxTextureSize,ce={0:q,1:le,2:Y},ue=new Ps({uniforms:{shadow_pass:{value:null},resolution:{value:new zn},radius:{value:4},samples:{value:8}},vertexShader:im,fragmentShader:ff}),_e=ue.clone();_e.defines.HORIZONTAL_PASS=1;const Ee=new br;Ee.setAttribute("position",new Pi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const $e=new Ro(Ee,ue),Be=this;function Re(Ze,ot){const st=e.update($e);ue.uniforms.shadow_pass.value=Ze.map.texture,ue.uniforms.resolution.value=Ze.mapSize,ue.uniforms.radius.value=Ze.radius,ue.uniforms.samples.value=Ze.blurSamples,w.setRenderTarget(Ze.mapPass),w.clear(),w.renderBufferDirect(ot,null,st,ue,$e,null),_e.uniforms.shadow_pass.value=Ze.mapPass.texture,_e.uniforms.resolution.value=Ze.mapSize,_e.uniforms.radius.value=Ze.radius,_e.uniforms.samples.value=Ze.blurSamples,w.setRenderTarget(Ze.map),w.clear(),w.renderBufferDirect(ot,null,st,_e,$e,null)}function We(Ze,ot,st,Ct,Ft,Qe,nt){let Et=null;const Jt=!0===Ct.isPointLight?Ze.customDistanceMaterial:Ze.customDepthMaterial;if(Et=void 0!==Jt?Jt:!0===Ct.isPointLight?F:k,w.localClippingEnabled&&!0===st.clipShadows&&0!==st.clippingPlanes.length||st.displacementMap&&0!==st.displacementScale||st.alphaMap&&st.alphaTest>0){const ct=Et.uuid,Lt=st.uuid;let _t=V[ct];void 0===_t&&(_t={},V[ct]=_t);let zt=_t[Lt];void 0===zt&&(zt=Et.clone(),_t[Lt]=zt),Et=zt}return Et.visible=st.visible,Et.wireframe=st.wireframe,Et.side=nt===fe?null!==st.shadowSide?st.shadowSide:st.side:null!==st.shadowSide?st.shadowSide:ce[st.side],Et.alphaMap=st.alphaMap,Et.alphaTest=st.alphaTest,Et.clipShadows=st.clipShadows,Et.clippingPlanes=st.clippingPlanes,Et.clipIntersection=st.clipIntersection,Et.displacementMap=st.displacementMap,Et.displacementScale=st.displacementScale,Et.displacementBias=st.displacementBias,Et.wireframeLinewidth=st.wireframeLinewidth,Et.linewidth=st.linewidth,!0===Ct.isPointLight&&!0===Et.isMeshDistanceMaterial&&(Et.referencePosition.setFromMatrixPosition(Ct.matrixWorld),Et.nearDistance=Ft,Et.farDistance=Qe),Et}function tt(Ze,ot,st,Ct,Ft){if(!1===Ze.visible)return;if(Ze.layers.test(ot.layers)&&(Ze.isMesh||Ze.isLine||Ze.isPoints)&&(Ze.castShadow||Ze.receiveShadow&&Ft===fe)&&(!Ze.frustumCulled||d.intersectsObject(Ze))){Ze.modelViewMatrix.multiplyMatrices(st.matrixWorldInverse,Ze.matrixWorld);const nt=e.update(Ze),Et=Ze.material;if(Array.isArray(Et)){const Jt=nt.groups;for(let ct=0,Lt=Jt.length;ct<Lt;ct++){const _t=Jt[ct],zt=Et[_t.materialIndex];if(zt&&zt.visible){const Rt=We(Ze,0,zt,Ct,st.near,st.far,Ft);w.renderBufferDirect(st,null,nt,Rt,Ze,_t)}}}else if(Et.visible){const Jt=We(Ze,0,Et,Ct,st.near,st.far,Ft);w.renderBufferDirect(st,null,nt,Jt,Ze,null)}}const Qe=Ze.children;for(let nt=0,Et=Qe.length;nt<Et;nt++)tt(Qe[nt],ot,st,Ct,Ft)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=he,this.render=function(Ze,ot,st){if(!1===Be.enabled||!1===Be.autoUpdate&&!1===Be.needsUpdate||0===Ze.length)return;const Ct=w.getRenderTarget(),Ft=w.getActiveCubeFace(),Qe=w.getActiveMipmapLevel(),nt=w.state;nt.setBlending(X),nt.buffers.color.setClear(1,1,1,1),nt.buffers.depth.setTest(!0),nt.setScissorTest(!1);for(let Et=0,Jt=Ze.length;Et<Jt;Et++){const ct=Ze[Et],Lt=ct.shadow;if(void 0===Lt){console.warn("THREE.WebGLShadowMap:",ct,"has no shadow.");continue}if(!1===Lt.autoUpdate&&!1===Lt.needsUpdate)continue;_.copy(Lt.mapSize);const _t=Lt.getFrameExtents();if(_.multiply(_t),S.copy(Lt.mapSize),(_.x>te||_.y>te)&&(_.x>te&&(S.x=Math.floor(te/_t.x),_.x=S.x*_t.x,Lt.mapSize.x=S.x),_.y>te&&(S.y=Math.floor(te/_t.y),_.y=S.y*_t.y,Lt.mapSize.y=S.y)),null===Lt.map&&!Lt.isPointLightShadow&&this.type===fe){const Rt={minFilter:ai,magFilter:ai,format:lo};Lt.map=new io(_.x,_.y,Rt),Lt.map.texture.name=ct.name+".shadowMap",Lt.mapPass=new io(_.x,_.y,Rt),Lt.camera.updateProjectionMatrix()}null===Lt.map&&(Lt.map=new io(_.x,_.y,{minFilter:Ir,magFilter:Ir,format:lo}),Lt.map.texture.name=ct.name+".shadowMap",Lt.camera.updateProjectionMatrix()),w.setRenderTarget(Lt.map),w.clear();const zt=Lt.getViewportCount();for(let Rt=0;Rt<zt;Rt++){const nn=Lt.getViewport(Rt);B.set(S.x*nn.x,S.y*nn.y,S.x*nn.z,S.y*nn.w),nt.viewport(B),Lt.updateMatrices(ct,Rt),d=Lt.getFrustum(),tt(ot,st,Lt.camera,ct,this.type)}Lt.isPointLightShadow||this.type!==fe||Re(Lt,st),Lt.needsUpdate=!1}Be.needsUpdate=!1,w.setRenderTarget(Ct,Ft,Qe)}}function mf(w,e,c){const d=c.isWebGL2,_=new function(){let mt=!1;const Kt=new Di;let Vt=null;const vn=new Di(0,0,0,0);return{setMask:function(Nn){Vt===Nn||mt||(w.colorMask(Nn,Nn,Nn,Nn),Vt=Nn)},setLocked:function(Nn){mt=Nn},setClear:function(Nn,dr,_r,jr,ki){!0===ki&&(Nn*=jr,dr*=jr,_r*=jr),Kt.set(Nn,dr,_r,jr),!1===vn.equals(Kt)&&(w.clearColor(Nn,dr,_r,jr),vn.copy(Kt))},reset:function(){mt=!1,Vt=null,vn.set(-1,0,0,0)}}},S=new function(){let mt=!1,Kt=null,Vt=null,vn=null;return{setTest:function(Nn){Nn?rt(2929):ut(2929)},setMask:function(Nn){Kt===Nn||mt||(w.depthMask(Nn),Kt=Nn)},setFunc:function(Nn){if(Vt!==Nn){if(Nn)switch(Nn){case On:w.depthFunc(512);break;case Ln:w.depthFunc(519);break;case mn:w.depthFunc(513);break;case cr:w.depthFunc(515);break;case ir:w.depthFunc(514);break;case ur:w.depthFunc(518);break;case or:w.depthFunc(516);break;case ni:w.depthFunc(517);break;default:w.depthFunc(515)}else w.depthFunc(515);Vt=Nn}},setLocked:function(Nn){mt=Nn},setClear:function(Nn){vn!==Nn&&(w.clearDepth(Nn),vn=Nn)},reset:function(){mt=!1,Kt=null,Vt=null,vn=null}}},B=new function(){let mt=!1,Kt=null,Vt=null,vn=null,Nn=null,dr=null,_r=null,jr=null,ki=null;return{setTest:function(_o){mt||(_o?rt(2960):ut(2960))},setMask:function(_o){Kt===_o||mt||(w.stencilMask(_o),Kt=_o)},setFunc:function(_o,El,zo){Vt===_o&&vn===El&&Nn===zo||(w.stencilFunc(_o,El,zo),Vt=_o,vn=El,Nn=zo)},setOp:function(_o,El,zo){dr===_o&&_r===El&&jr===zo||(w.stencilOp(_o,El,zo),dr=_o,_r=El,jr=zo)},setLocked:function(_o){mt=_o},setClear:function(_o){ki!==_o&&(w.clearStencil(_o),ki=_o)},reset:function(){mt=!1,Kt=null,Vt=null,vn=null,Nn=null,dr=null,_r=null,jr=null,ki=null}}};let k={},F=null,V={},te=null,ce=!1,ue=null,_e=null,Ee=null,$e=null,Be=null,Re=null,We=null,tt=!1,Ze=null,ot=null,st=null,Ct=null,Ft=null;const Qe=w.getParameter(35661);let nt=!1,Et=0;const Jt=w.getParameter(7938);-1!==Jt.indexOf("WebGL")?(Et=parseFloat(/^WebGL (\d)/.exec(Jt)[1]),nt=Et>=1):-1!==Jt.indexOf("OpenGL ES")&&(Et=parseFloat(/^OpenGL ES (\d)/.exec(Jt)[1]),nt=Et>=2);let ct=null,Lt={};const _t=w.getParameter(3088),zt=w.getParameter(2978),Rt=(new Di).fromArray(_t),nn=(new Di).fromArray(zt);function en(mt,Kt,Vt){const vn=new Uint8Array(4),Nn=w.createTexture();w.bindTexture(mt,Nn),w.texParameteri(mt,10241,9728),w.texParameteri(mt,10240,9728);for(let dr=0;dr<Vt;dr++)w.texImage2D(Kt+dr,0,6408,1,1,0,6408,5121,vn);return Nn}const En={};function rt(mt){!0!==k[mt]&&(w.enable(mt),k[mt]=!0)}function ut(mt){!1!==k[mt]&&(w.disable(mt),k[mt]=!1)}En[3553]=en(3553,3553,1),En[34067]=en(34067,34069,6),_.setClear(0,0,0,1),S.setClear(1),B.setClear(0),rt(2929),S.setFunc(cr),kn(!1),Jn(M),rt(2884),_n(X);const rn={[Pe]:32774,[Ge]:32778,[Ae]:32779};if(d)rn[Xe]=32775,rn[Ke]=32776;else{const mt=e.get("EXT_blend_minmax");null!==mt&&(rn[Xe]=mt.MIN_EXT,rn[Ke]=mt.MAX_EXT)}const un={[yt]:0,[dt]:1,[Pt]:768,[Gt]:770,[dn]:776,[Mn]:774,[sn]:772,[wt]:769,[Dt]:771,[Bn]:775,[gt]:773};function _n(mt,Kt,Vt,vn,Nn,dr,_r,jr){if(mt!==X){if(!1===ce&&(rt(3042),ce=!0),mt===xe)Nn=Nn||Kt,dr=dr||Vt,_r=_r||vn,Kt===_e&&Nn===Be||(w.blendEquationSeparate(rn[Kt],rn[Nn]),_e=Kt,Be=Nn),Vt===Ee&&vn===$e&&dr===Re&&_r===We||(w.blendFuncSeparate(un[Vt],un[vn],un[dr],un[_r]),Ee=Vt,$e=vn,Re=dr,We=_r),ue=mt,tt=null;else if(mt!==ue||jr!==tt){if(_e===Pe&&Be===Pe||(w.blendEquation(32774),_e=Pe,Be=Pe),jr)switch(mt){case oe:w.blendFuncSeparate(1,771,1,771);break;case H:w.blendFunc(1,1);break;case Ce:w.blendFuncSeparate(0,0,769,771);break;case Q:w.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",mt)}else switch(mt){case oe:w.blendFuncSeparate(770,771,1,771);break;case H:w.blendFunc(770,1);break;case Ce:w.blendFunc(0,769);break;case Q:w.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",mt)}Ee=null,$e=null,Re=null,We=null,ue=mt,tt=jr}}else!0===ce&&(ut(3042),ce=!1)}function kn(mt){Ze!==mt&&(w.frontFace(mt?2304:2305),Ze=mt)}function Jn(mt){mt!==z?(rt(2884),mt!==ot&&w.cullFace(mt===M?1029:mt===P?1028:1032)):ut(2884),ot=mt}function Zn(mt,Kt,Vt){mt?(rt(32823),Ct===Kt&&Ft===Vt||(w.polygonOffset(Kt,Vt),Ct=Kt,Ft=Vt)):ut(32823)}function cn(mt){void 0===mt&&(mt=33984+Qe-1),ct!==mt&&(w.activeTexture(mt),ct=mt)}return{buffers:{color:_,depth:S,stencil:B},enable:rt,disable:ut,bindFramebuffer:function(mt,Kt){return null===Kt&&null!==F&&(Kt=F),V[mt]!==Kt&&(w.bindFramebuffer(mt,Kt),V[mt]=Kt,d&&(36009===mt&&(V[36160]=Kt),36160===mt&&(V[36009]=Kt)),!0)},bindXRFramebuffer:function(mt){mt!==F&&(w.bindFramebuffer(36160,mt),F=mt)},useProgram:function(mt){return te!==mt&&(w.useProgram(mt),te=mt,!0)},setBlending:_n,setMaterial:function(mt,Kt){mt.side===Y?ut(2884):rt(2884);let Vt=mt.side===q;Kt&&(Vt=!Vt),kn(Vt),mt.blending===oe&&!1===mt.transparent?_n(X):_n(mt.blending,mt.blendEquation,mt.blendSrc,mt.blendDst,mt.blendEquationAlpha,mt.blendSrcAlpha,mt.blendDstAlpha,mt.premultipliedAlpha),S.setFunc(mt.depthFunc),S.setTest(mt.depthTest),S.setMask(mt.depthWrite),_.setMask(mt.colorWrite);const vn=mt.stencilWrite;B.setTest(vn),vn&&(B.setMask(mt.stencilWriteMask),B.setFunc(mt.stencilFunc,mt.stencilRef,mt.stencilFuncMask),B.setOp(mt.stencilFail,mt.stencilZFail,mt.stencilZPass)),Zn(mt.polygonOffset,mt.polygonOffsetFactor,mt.polygonOffsetUnits),!0===mt.alphaToCoverage?rt(32926):ut(32926)},setFlipSided:kn,setCullFace:Jn,setLineWidth:function(mt){mt!==st&&(nt&&w.lineWidth(mt),st=mt)},setPolygonOffset:Zn,setScissorTest:function(mt){mt?rt(3089):ut(3089)},activeTexture:cn,bindTexture:function(mt,Kt){null===ct&&cn();let Vt=Lt[ct];void 0===Vt&&(Vt={type:void 0,texture:void 0},Lt[ct]=Vt),Vt.type===mt&&Vt.texture===Kt||(w.bindTexture(mt,Kt||En[mt]),Vt.type=mt,Vt.texture=Kt)},unbindTexture:function(){const mt=Lt[ct];void 0!==mt&&void 0!==mt.type&&(w.bindTexture(mt.type,null),mt.type=void 0,mt.texture=void 0)},compressedTexImage2D:function(){try{w.compressedTexImage2D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},texImage2D:function(){try{w.texImage2D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},texImage3D:function(){try{w.texImage3D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},scissor:function(mt){!1===Rt.equals(mt)&&(w.scissor(mt.x,mt.y,mt.z,mt.w),Rt.copy(mt))},viewport:function(mt){!1===nn.equals(mt)&&(w.viewport(mt.x,mt.y,mt.z,mt.w),nn.copy(mt))},reset:function(){w.disable(3042),w.disable(2884),w.disable(2929),w.disable(32823),w.disable(3089),w.disable(2960),w.disable(32926),w.blendEquation(32774),w.blendFunc(1,0),w.blendFuncSeparate(1,0,1,0),w.colorMask(!0,!0,!0,!0),w.clearColor(0,0,0,0),w.depthMask(!0),w.depthFunc(513),w.clearDepth(1),w.stencilMask(4294967295),w.stencilFunc(519,0,4294967295),w.stencilOp(7680,7680,7680),w.clearStencil(0),w.cullFace(1029),w.frontFace(2305),w.polygonOffset(0,0),w.activeTexture(33984),w.bindFramebuffer(36160,null),!0===d&&(w.bindFramebuffer(36009,null),w.bindFramebuffer(36008,null)),w.useProgram(null),w.lineWidth(1),w.scissor(0,0,w.canvas.width,w.canvas.height),w.viewport(0,0,w.canvas.width,w.canvas.height),k={},ct=null,Lt={},F=null,V={},te=null,ce=!1,ue=null,_e=null,Ee=null,$e=null,Be=null,Re=null,We=null,tt=!1,Ze=null,ot=null,st=null,Ct=null,Ft=null,Rt.set(0,0,w.canvas.width,w.canvas.height),nn.set(0,0,w.canvas.width,w.canvas.height),_.reset(),S.reset(),B.reset()}}}function Cu(w,e,c,d,_,S,B){const k=_.isWebGL2,F=_.maxTextures,V=_.maxCubemapSize,te=_.maxTextureSize,ce=_.maxSamples,ue=new WeakMap;let _e,Ee=!1;try{Ee=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function $e(rt,ut){return Ee?new OffscreenCanvas(rt,ut):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function Be(rt,ut,rn,un){let _n=1;if((rt.width>un||rt.height>un)&&(_n=un/Math.max(rt.width,rt.height)),_n<1||!0===ut){if(typeof HTMLImageElement<"u"&&rt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&rt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&rt instanceof ImageBitmap){const kn=ut?yo:Math.floor,Jn=kn(_n*rt.width),Zn=kn(_n*rt.height);void 0===_e&&(_e=$e(Jn,Zn));const cn=rn?$e(Jn,Zn):_e;return cn.width=Jn,cn.height=Zn,cn.getContext("2d").drawImage(rt,0,0,Jn,Zn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+rt.width+"x"+rt.height+") to ("+Jn+"x"+Zn+")."),cn}return"data"in rt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+rt.width+"x"+rt.height+")."),rt}return rt}function Re(rt){return Us(rt.width)&&Us(rt.height)}function We(rt,ut){return rt.generateMipmaps&&ut&&rt.minFilter!==Ir&&rt.minFilter!==ai}function tt(rt,ut,rn,un,_n=1){w.generateMipmap(rt),d.get(ut).__maxMipLevel=Math.log2(Math.max(rn,un,_n))}function Ze(rt,ut,rn){if(!1===k)return ut;if(null!==rt){if(void 0!==w[rt])return w[rt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+rt+"'")}let un=ut;return 6403===ut&&(5126===rn&&(un=33326),5131===rn&&(un=33325),5121===rn&&(un=33321)),6407===ut&&(5126===rn&&(un=34837),5131===rn&&(un=34843),5121===rn&&(un=32849)),6408===ut&&(5126===rn&&(un=34836),5131===rn&&(un=34842),5121===rn&&(un=32856)),33325!==un&&33326!==un&&34842!==un&&34836!==un||e.get("EXT_color_buffer_float"),un}function ot(rt){return rt===Ir||rt===Va||rt===hs?9728:9729}function st(rt){const ut=rt.target;ut.removeEventListener("dispose",st),function(rn){const un=d.get(rn);void 0!==un.__webglInit&&(w.deleteTexture(un.__webglTexture),d.remove(rn))}(ut),ut.isVideoTexture&&ue.delete(ut),B.memory.textures--}function Ct(rt){const ut=rt.target;ut.removeEventListener("dispose",Ct),function(rn){const un=rn.texture,_n=d.get(rn),kn=d.get(un);if(rn){if(void 0!==kn.__webglTexture&&(w.deleteTexture(kn.__webglTexture),B.memory.textures--),rn.depthTexture&&rn.depthTexture.dispose(),rn.isWebGLCubeRenderTarget)for(let Jn=0;Jn<6;Jn++)w.deleteFramebuffer(_n.__webglFramebuffer[Jn]),_n.__webglDepthbuffer&&w.deleteRenderbuffer(_n.__webglDepthbuffer[Jn]);else w.deleteFramebuffer(_n.__webglFramebuffer),_n.__webglDepthbuffer&&w.deleteRenderbuffer(_n.__webglDepthbuffer),_n.__webglMultisampledFramebuffer&&w.deleteFramebuffer(_n.__webglMultisampledFramebuffer),_n.__webglColorRenderbuffer&&w.deleteRenderbuffer(_n.__webglColorRenderbuffer),_n.__webglDepthRenderbuffer&&w.deleteRenderbuffer(_n.__webglDepthRenderbuffer);if(rn.isWebGLMultipleRenderTargets)for(let Jn=0,Zn=un.length;Jn<Zn;Jn++){const cn=d.get(un[Jn]);cn.__webglTexture&&(w.deleteTexture(cn.__webglTexture),B.memory.textures--),d.remove(un[Jn])}d.remove(un),d.remove(rn)}}(ut)}let Ft=0;function Qe(rt,ut){const rn=d.get(rt);if(rt.isVideoTexture&&function(un){const _n=B.render.frame;ue.get(un)!==_n&&(ue.set(un,_n),un.update())}(rt),rt.version>0&&rn.__version!==rt.version){const un=rt.image;if(void 0===un)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==un.complete)return void _t(rn,rt,ut);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.activeTexture(33984+ut),c.bindTexture(3553,rn.__webglTexture)}function nt(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?function(un,_n,kn){if(6!==_n.image.length)return;Lt(un,_n),c.activeTexture(33984+kn),c.bindTexture(34067,un.__webglTexture),w.pixelStorei(37440,_n.flipY),w.pixelStorei(37441,_n.premultiplyAlpha),w.pixelStorei(3317,_n.unpackAlignment),w.pixelStorei(37443,0);const Jn=_n&&(_n.isCompressedTexture||_n.image[0].isCompressedTexture),Zn=_n.image[0]&&_n.image[0].isDataTexture,cn=[];for(let _r=0;_r<6;_r++)cn[_r]=Jn||Zn?Zn?_n.image[_r].image:_n.image[_r]:Be(_n.image[_r],!1,!0,V);const mt=cn[0],Kt=Re(mt)||k,Vt=S.convert(_n.format),vn=S.convert(_n.type),Nn=Ze(_n.internalFormat,Vt,vn);let dr;if(ct(34067,_n,Kt),Jn){for(let _r=0;_r<6;_r++){dr=cn[_r].mipmaps;for(let jr=0;jr<dr.length;jr++){const ki=dr[jr];_n.format!==lo&&_n.format!==Fs?null!==Vt?c.compressedTexImage2D(34069+_r,jr,Nn,ki.width,ki.height,0,ki.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(34069+_r,jr,Nn,ki.width,ki.height,0,Vt,vn,ki.data)}}un.__maxMipLevel=dr.length-1}else{dr=_n.mipmaps;for(let _r=0;_r<6;_r++)if(Zn){c.texImage2D(34069+_r,0,Nn,cn[_r].width,cn[_r].height,0,Vt,vn,cn[_r].data);for(let jr=0;jr<dr.length;jr++){const ki=dr[jr].image[_r].image;c.texImage2D(34069+_r,jr+1,Nn,ki.width,ki.height,0,Vt,vn,ki.data)}}else{c.texImage2D(34069+_r,0,Nn,Vt,vn,cn[_r]);for(let jr=0;jr<dr.length;jr++)c.texImage2D(34069+_r,jr+1,Nn,Vt,vn,dr[jr].image[_r])}un.__maxMipLevel=dr.length}We(_n,Kt)&&tt(34067,_n,mt.width,mt.height),un.__version=_n.version,_n.onUpdate&&_n.onUpdate(_n)}(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(34067,rn.__webglTexture))}const Et={[vo]:10497,[Jr]:33071,[os]:33648},Jt={[Ir]:9728,[Va]:9984,[hs]:9986,[ai]:9729,[Gc]:9985,[sl]:9987};function ct(rt,ut,rn){if(rn?(w.texParameteri(rt,10242,Et[ut.wrapS]),w.texParameteri(rt,10243,Et[ut.wrapT]),32879!==rt&&35866!==rt||w.texParameteri(rt,32882,Et[ut.wrapR]),w.texParameteri(rt,10240,Jt[ut.magFilter]),w.texParameteri(rt,10241,Jt[ut.minFilter])):(w.texParameteri(rt,10242,33071),w.texParameteri(rt,10243,33071),32879!==rt&&35866!==rt||w.texParameteri(rt,32882,33071),ut.wrapS===Jr&&ut.wrapT===Jr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),w.texParameteri(rt,10240,ot(ut.magFilter)),w.texParameteri(rt,10241,ot(ut.minFilter)),ut.minFilter!==Ir&&ut.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const un=e.get("EXT_texture_filter_anisotropic");if(ut.type===Xo&&!1===e.has("OES_texture_float_linear")||!1===k&&ut.type===ps&&!1===e.has("OES_texture_half_float_linear"))return;(ut.anisotropy>1||d.get(ut).__currentAnisotropy)&&(w.texParameterf(rt,un.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ut.anisotropy,_.getMaxAnisotropy())),d.get(ut).__currentAnisotropy=ut.anisotropy)}}function Lt(rt,ut){void 0===rt.__webglInit&&(rt.__webglInit=!0,ut.addEventListener("dispose",st),rt.__webglTexture=w.createTexture(),B.memory.textures++)}function _t(rt,ut,rn){let un=3553;ut.isDataTexture2DArray&&(un=35866),ut.isDataTexture3D&&(un=32879),Lt(rt,ut),c.activeTexture(33984+rn),c.bindTexture(un,rt.__webglTexture),w.pixelStorei(37440,ut.flipY),w.pixelStorei(37441,ut.premultiplyAlpha),w.pixelStorei(3317,ut.unpackAlignment),w.pixelStorei(37443,0);const _n=(vn=ut,!k&&(vn.wrapS!==Jr||vn.wrapT!==Jr||vn.minFilter!==Ir&&vn.minFilter!==ai)&&!1===Re(ut.image)),kn=Be(ut.image,_n,!1,te),Jn=Re(kn)||k,Zn=S.convert(ut.format);var vn;let cn,mt=S.convert(ut.type),Kt=Ze(ut.internalFormat,Zn,mt);ct(un,ut,Jn);const Vt=ut.mipmaps;if(ut.isDepthTexture)Kt=6402,k?Kt=ut.type===Xo?36012:ut.type===Js?33190:ut.type===Ms?35056:33189:ut.type===Xo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ut.format===To&&6402===Kt&&ut.type!==Hc&&ut.type!==Js&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ut.type=Hc,mt=S.convert(ut.type)),ut.format===Zs&&6402===Kt&&(Kt=34041,ut.type!==Ms&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ut.type=Ms,mt=S.convert(ut.type))),c.texImage2D(3553,0,Kt,kn.width,kn.height,0,Zn,mt,null);else if(ut.isDataTexture)if(Vt.length>0&&Jn){for(let vn=0,Nn=Vt.length;vn<Nn;vn++)cn=Vt[vn],c.texImage2D(3553,vn,Kt,cn.width,cn.height,0,Zn,mt,cn.data);ut.generateMipmaps=!1,rt.__maxMipLevel=Vt.length-1}else c.texImage2D(3553,0,Kt,kn.width,kn.height,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(ut.isCompressedTexture){for(let vn=0,Nn=Vt.length;vn<Nn;vn++)cn=Vt[vn],ut.format!==lo&&ut.format!==Fs?null!==Zn?c.compressedTexImage2D(3553,vn,Kt,cn.width,cn.height,0,cn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(3553,vn,Kt,cn.width,cn.height,0,Zn,mt,cn.data);rt.__maxMipLevel=Vt.length-1}else if(ut.isDataTexture2DArray)c.texImage3D(35866,0,Kt,kn.width,kn.height,kn.depth,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(ut.isDataTexture3D)c.texImage3D(32879,0,Kt,kn.width,kn.height,kn.depth,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(Vt.length>0&&Jn){for(let vn=0,Nn=Vt.length;vn<Nn;vn++)cn=Vt[vn],c.texImage2D(3553,vn,Kt,Zn,mt,cn);ut.generateMipmaps=!1,rt.__maxMipLevel=Vt.length-1}else c.texImage2D(3553,0,Kt,Zn,mt,kn),rt.__maxMipLevel=0;We(ut,Jn)&&tt(un,ut,kn.width,kn.height),rt.__version=ut.version,ut.onUpdate&&ut.onUpdate(ut)}function zt(rt,ut,rn,un,_n){const kn=S.convert(rn.format),Jn=S.convert(rn.type),Zn=Ze(rn.internalFormat,kn,Jn);32879===_n||35866===_n?c.texImage3D(_n,0,Zn,ut.width,ut.height,ut.depth,0,kn,Jn,null):c.texImage2D(_n,0,Zn,ut.width,ut.height,0,kn,Jn,null),c.bindFramebuffer(36160,rt),w.framebufferTexture2D(36160,un,_n,d.get(rn).__webglTexture,0),c.bindFramebuffer(36160,null)}function Rt(rt,ut,rn){if(w.bindRenderbuffer(36161,rt),ut.depthBuffer&&!ut.stencilBuffer){let un=33189;if(rn){const _n=ut.depthTexture;_n&&_n.isDepthTexture&&(_n.type===Xo?un=36012:_n.type===Js&&(un=33190));const kn=nn(ut);w.renderbufferStorageMultisample(36161,kn,un,ut.width,ut.height)}else w.renderbufferStorage(36161,un,ut.width,ut.height);w.framebufferRenderbuffer(36160,36096,36161,rt)}else if(ut.depthBuffer&&ut.stencilBuffer){if(rn){const un=nn(ut);w.renderbufferStorageMultisample(36161,un,35056,ut.width,ut.height)}else w.renderbufferStorage(36161,34041,ut.width,ut.height);w.framebufferRenderbuffer(36160,33306,36161,rt)}else{const un=!0===ut.isWebGLMultipleRenderTargets?ut.texture[0]:ut.texture,_n=S.convert(un.format),kn=S.convert(un.type),Jn=Ze(un.internalFormat,_n,kn);if(rn){const Zn=nn(ut);w.renderbufferStorageMultisample(36161,Zn,Jn,ut.width,ut.height)}else w.renderbufferStorage(36161,Jn,ut.width,ut.height)}w.bindRenderbuffer(36161,null)}function nn(rt){return k&&rt.isWebGLMultisampleRenderTarget?Math.min(ce,rt.samples):0}let en=!1,En=!1;this.allocateTextureUnit=function(){const rt=Ft;return rt>=F&&console.warn("THREE.WebGLTextures: Trying to use "+rt+" texture units while this GPU supports only "+F),Ft+=1,rt},this.resetTextureUnits=function(){Ft=0},this.setTexture2D=Qe,this.setTexture2DArray=function(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?_t(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(35866,rn.__webglTexture))},this.setTexture3D=function(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?_t(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(32879,rn.__webglTexture))},this.setTextureCube=nt,this.setupRenderTarget=function(rt){const ut=rt.texture,rn=d.get(rt),un=d.get(ut);rt.addEventListener("dispose",Ct),!0!==rt.isWebGLMultipleRenderTargets&&(un.__webglTexture=w.createTexture(),un.__version=ut.version,B.memory.textures++);const _n=!0===rt.isWebGLCubeRenderTarget,kn=!0===rt.isWebGLMultipleRenderTargets,Jn=!0===rt.isWebGLMultisampleRenderTarget,Zn=ut.isDataTexture3D||ut.isDataTexture2DArray,cn=Re(rt)||k;if(!k||ut.format!==Fs||ut.type!==Xo&&ut.type!==ps||(ut.format=lo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),_n){rn.__webglFramebuffer=[];for(let mt=0;mt<6;mt++)rn.__webglFramebuffer[mt]=w.createFramebuffer()}else if(rn.__webglFramebuffer=w.createFramebuffer(),kn)if(_.drawBuffers){const mt=rt.texture;for(let Kt=0,Vt=mt.length;Kt<Vt;Kt++){const vn=d.get(mt[Kt]);void 0===vn.__webglTexture&&(vn.__webglTexture=w.createTexture(),B.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Jn)if(k){rn.__webglMultisampledFramebuffer=w.createFramebuffer(),rn.__webglColorRenderbuffer=w.createRenderbuffer(),w.bindRenderbuffer(36161,rn.__webglColorRenderbuffer);const mt=S.convert(ut.format),Kt=S.convert(ut.type),Vt=Ze(ut.internalFormat,mt,Kt),vn=nn(rt);w.renderbufferStorageMultisample(36161,vn,Vt,rt.width,rt.height),c.bindFramebuffer(36160,rn.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(36160,36064,36161,rn.__webglColorRenderbuffer),w.bindRenderbuffer(36161,null),rt.depthBuffer&&(rn.__webglDepthRenderbuffer=w.createRenderbuffer(),Rt(rn.__webglDepthRenderbuffer,rt,!0)),c.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(_n){c.bindTexture(34067,un.__webglTexture),ct(34067,ut,cn);for(let mt=0;mt<6;mt++)zt(rn.__webglFramebuffer[mt],rt,ut,36064,34069+mt);We(ut,cn)&&tt(34067,ut,rt.width,rt.height),c.unbindTexture()}else if(kn){const mt=rt.texture;for(let Kt=0,Vt=mt.length;Kt<Vt;Kt++){const vn=mt[Kt],Nn=d.get(vn);c.bindTexture(3553,Nn.__webglTexture),ct(3553,vn,cn),zt(rn.__webglFramebuffer,rt,vn,36064+Kt,3553),We(vn,cn)&&tt(3553,vn,rt.width,rt.height)}c.unbindTexture()}else{let mt=3553;Zn&&(k?mt=ut.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(mt,un.__webglTexture),ct(mt,ut,cn),zt(rn.__webglFramebuffer,rt,ut,36064,mt),We(ut,cn)&&tt(mt,ut,rt.width,rt.height,rt.depth),c.unbindTexture()}rt.depthBuffer&&function(mt){const Kt=d.get(mt),Vt=!0===mt.isWebGLCubeRenderTarget;if(mt.depthTexture){if(Vt)throw new Error("target.depthTexture not supported in Cube render targets");!function(vn,Nn){if(Nn&&Nn.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(36160,vn),!Nn.depthTexture||!Nn.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(Nn.depthTexture).__webglTexture&&Nn.depthTexture.image.width===Nn.width&&Nn.depthTexture.image.height===Nn.height||(Nn.depthTexture.image.width=Nn.width,Nn.depthTexture.image.height=Nn.height,Nn.depthTexture.needsUpdate=!0),Qe(Nn.depthTexture,0);const dr=d.get(Nn.depthTexture).__webglTexture;if(Nn.depthTexture.format===To)w.framebufferTexture2D(36160,36096,3553,dr,0);else{if(Nn.depthTexture.format!==Zs)throw new Error("Unknown depthTexture format");w.framebufferTexture2D(36160,33306,3553,dr,0)}}(Kt.__webglFramebuffer,mt)}else if(Vt){Kt.__webglDepthbuffer=[];for(let vn=0;vn<6;vn++)c.bindFramebuffer(36160,Kt.__webglFramebuffer[vn]),Kt.__webglDepthbuffer[vn]=w.createRenderbuffer(),Rt(Kt.__webglDepthbuffer[vn],mt,!1)}else c.bindFramebuffer(36160,Kt.__webglFramebuffer),Kt.__webglDepthbuffer=w.createRenderbuffer(),Rt(Kt.__webglDepthbuffer,mt,!1);c.bindFramebuffer(36160,null)}(rt)},this.updateRenderTargetMipmap=function(rt){const ut=Re(rt)||k,rn=!0===rt.isWebGLMultipleRenderTargets?rt.texture:[rt.texture];for(let un=0,_n=rn.length;un<_n;un++){const kn=rn[un];if(We(kn,ut)){const Jn=rt.isWebGLCubeRenderTarget?34067:3553,Zn=d.get(kn).__webglTexture;c.bindTexture(Jn,Zn),tt(Jn,kn,rt.width,rt.height),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function(rt){if(rt.isWebGLMultisampleRenderTarget)if(k){const ut=rt.width,rn=rt.height;let un=16384;rt.depthBuffer&&(un|=256),rt.stencilBuffer&&(un|=1024);const _n=d.get(rt);c.bindFramebuffer(36008,_n.__webglMultisampledFramebuffer),c.bindFramebuffer(36009,_n.__webglFramebuffer),w.blitFramebuffer(0,0,ut,rn,0,0,ut,rn,un,9728),c.bindFramebuffer(36008,null),c.bindFramebuffer(36009,_n.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(rt,ut){rt&&rt.isWebGLRenderTarget&&(!1===en&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),en=!0),rt=rt.texture),Qe(rt,ut)},this.safeSetTextureCube=function(rt,ut){rt&&rt.isWebGLCubeRenderTarget&&(!1===En&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),En=!0),rt=rt.texture),nt(rt,ut)}}function Wd(w,e,c){const d=c.isWebGL2;return{convert:function(_){let S;if(_===ha)return 5121;if(_===Vu)return 32819;if(_===du)return 32820;if(_===fu)return 33635;if(_===Wl)return 5120;if(_===Wa)return 5122;if(_===Hc)return 5123;if(_===Hp)return 5124;if(_===Js)return 5125;if(_===Xo)return 5126;if(_===ps)return d?5131:(S=e.get("OES_texture_half_float"),null!==S?S.HALF_FLOAT_OES:null);if(_===dp)return 6406;if(_===Fs)return 6407;if(_===lo)return 6408;if(_===Vc)return 6409;if(_===Wu)return 6410;if(_===To)return 6402;if(_===Zs)return 34041;if(_===Vp)return 6403;if(_===ll)return 36244;if(_===mu)return 33319;if(_===fp)return 33320;if(_===mp)return 36248;if(_===yh)return 36249;if(_===Fh||_===mc||_===Dh||_===bh){if(S=e.get("WEBGL_compressed_texture_s3tc"),null===S)return null;if(_===Fh)return S.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===mc)return S.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===Dh)return S.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===bh)return S.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===Uh||_===Tl||_===Ml||_===ql){if(S=e.get("WEBGL_compressed_texture_pvrtc"),null===S)return null;if(_===Uh)return S.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===Tl)return S.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===Ml)return S.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===ql)return S.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===qu)return S=e.get("WEBGL_compressed_texture_etc1"),null!==S?S.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===ds||_===Xl)&&(S=e.get("WEBGL_compressed_texture_etc"),null!==S)){if(_===ds)return S.COMPRESSED_RGB8_ETC2;if(_===Xl)return S.COMPRESSED_RGBA8_ETC2_EAC}return _===Xu||_===_p||_===gp||_===Wc||_===_c||_===xh||_===vp||_===Yu||_===Ju||_===cl||_===zh||_===ul||_===jh||_===Zu||_===yc||_===wh||_===_u||_===qc||_===yp||_===Xc||_===Qu||_===Yl||_===bp||_===Gh||_===xp||_===wp||_===Hh||_===Wp?(S=e.get("WEBGL_compressed_texture_astc"),null!==S?_:null):_===vc?(S=e.get("EXT_texture_compression_bptc"),null!==S?_:null):_===Ms?d?34042:(S=e.get("WEBGL_depth_texture"),null!==S?S.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class zi extends Po{constructor(e=[]){super(),this.cameras=e}}zi.prototype.isArrayCamera=!0;class ln extends Pr{constructor(){super(),this.type="Group"}}ln.prototype.isGroup=!0;const Yp={type:"move"};class Zo{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ln,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ln,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ht,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ht),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ln,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ht,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ht),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,c,d){let _=null,S=null,B=null;const k=this._targetRay,F=this._grip,V=this._hand;if(e&&"visible-blurred"!==c.session.visibilityState)if(null!==k&&(_=c.getPose(e.targetRaySpace,d),null!==_&&(k.matrix.fromArray(_.transform.matrix),k.matrix.decompose(k.position,k.rotation,k.scale),_.linearVelocity?(k.hasLinearVelocity=!0,k.linearVelocity.copy(_.linearVelocity)):k.hasLinearVelocity=!1,_.angularVelocity?(k.hasAngularVelocity=!0,k.angularVelocity.copy(_.angularVelocity)):k.hasAngularVelocity=!1,this.dispatchEvent(Yp))),V&&e.hand){B=!0;for(const $e of e.hand.values()){const Be=c.getJointPose($e,d);if(void 0===V.joints[$e.jointName]){const We=new ln;We.matrixAutoUpdate=!1,We.visible=!1,V.joints[$e.jointName]=We,V.add(We)}const Re=V.joints[$e.jointName];null!==Be&&(Re.matrix.fromArray(Be.transform.matrix),Re.matrix.decompose(Re.position,Re.rotation,Re.scale),Re.jointRadius=Be.radius),Re.visible=null!==Be}const ue=V.joints["index-finger-tip"].position.distanceTo(V.joints["thumb-tip"].position),_e=.02,Ee=.005;V.inputState.pinching&&ue>_e+Ee?(V.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!V.inputState.pinching&&ue<=_e-Ee&&(V.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==F&&e.gripSpace&&(S=c.getPose(e.gripSpace,d),null!==S&&(F.matrix.fromArray(S.transform.matrix),F.matrix.decompose(F.position,F.rotation,F.scale),S.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(S.linearVelocity)):F.hasLinearVelocity=!1,S.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(S.angularVelocity)):F.hasAngularVelocity=!1));return null!==k&&(k.visible=null!==_),null!==F&&(F.visible=null!==S),null!==V&&(V.visible=null!==B),this}}class $o extends Ds{constructor(e,c){super();const d=this,_=e.state;let S=null,B=1,k=null,F="local-floor",V=null,te=null,ce=null,ue=null,_e=null,Ee=!1,$e=null,Be=null,Re=null,We=null,tt=null,Ze=null;const ot=[],st=new Map,Ct=new Po;Ct.layers.enable(1),Ct.viewport=new Di;const Ft=new Po;Ft.layers.enable(2),Ft.viewport=new Di;const Qe=[Ct,Ft],nt=new zi;nt.layers.enable(1),nt.layers.enable(2);let Et=null,Jt=null;function ct(rt){const ut=st.get(rt.inputSource);ut&&ut.dispatchEvent({type:rt.type,data:rt.inputSource})}function Lt(){st.forEach(function(rt,ut){rt.disconnect(ut)}),st.clear(),Et=null,Jt=null,_.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),ce&&c.deleteFramebuffer(ce),$e&&c.deleteFramebuffer($e),Be&&c.deleteRenderbuffer(Be),Re&&c.deleteRenderbuffer(Re),ce=null,$e=null,Be=null,Re=null,_e=null,ue=null,te=null,S=null,En.stop(),d.isPresenting=!1,d.dispatchEvent({type:"sessionend"})}function _t(rt){const ut=S.inputSources;for(let rn=0;rn<ot.length;rn++)st.set(ut[rn],ot[rn]);for(let rn=0;rn<rt.removed.length;rn++){const un=rt.removed[rn],_n=st.get(un);_n&&(_n.dispatchEvent({type:"disconnected",data:un}),st.delete(un))}for(let rn=0;rn<rt.added.length;rn++){const un=rt.added[rn],_n=st.get(un);_n&&_n.dispatchEvent({type:"connected",data:un})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getTargetRaySpace()},this.getControllerGrip=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getGripSpace()},this.getHand=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getHandSpace()},this.setFramebufferScaleFactor=function(rt){B=rt,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(rt){F=rt,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return k},this.getBaseLayer=function(){return null!==ue?ue:_e},this.getBinding=function(){return te},this.getFrame=function(){return We},this.getSession=function(){return S},this.setSession=async function(rt){if(S=rt,null!==S){S.addEventListener("select",ct),S.addEventListener("selectstart",ct),S.addEventListener("selectend",ct),S.addEventListener("squeeze",ct),S.addEventListener("squeezestart",ct),S.addEventListener("squeezeend",ct),S.addEventListener("end",Lt),S.addEventListener("inputsourceschange",_t);const ut=c.getContextAttributes();if(!0!==ut.xrCompatible&&await c.makeXRCompatible(),void 0===S.renderState.layers)_e=new XRWebGLLayer(S,c,{antialias:ut.antialias,alpha:ut.alpha,depth:ut.depth,stencil:ut.stencil,framebufferScaleFactor:B}),S.updateRenderState({baseLayer:_e});else if(c instanceof WebGLRenderingContext)_e=new XRWebGLLayer(S,c,{antialias:!0,alpha:ut.alpha,depth:ut.depth,stencil:ut.stencil,framebufferScaleFactor:B}),S.updateRenderState({layers:[_e]});else{Ee=ut.antialias;let rn=null;ut.depth&&(Ze=256,ut.stencil&&(Ze|=1024),tt=ut.stencil?33306:36096,rn=ut.stencil?35056:33190);const un={colorFormat:ut.alpha?32856:32849,depthFormat:rn,scaleFactor:B};te=new XRWebGLBinding(S,c),ue=te.createProjectionLayer(un),ce=c.createFramebuffer(),S.updateRenderState({layers:[ue]}),Ee&&($e=c.createFramebuffer(),Be=c.createRenderbuffer(),c.bindRenderbuffer(36161,Be),c.renderbufferStorageMultisample(36161,4,32856,ue.textureWidth,ue.textureHeight),_.bindFramebuffer(36160,$e),c.framebufferRenderbuffer(36160,36064,36161,Be),c.bindRenderbuffer(36161,null),null!==rn&&(Re=c.createRenderbuffer(),c.bindRenderbuffer(36161,Re),c.renderbufferStorageMultisample(36161,4,rn,ue.textureWidth,ue.textureHeight),c.framebufferRenderbuffer(36160,tt,36161,Re),c.bindRenderbuffer(36161,null)),_.bindFramebuffer(36160,null))}k=await S.requestReferenceSpace(F),En.setContext(S),En.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"})}};const zt=new ht,Rt=new ht;function nn(rt,ut){null===ut?rt.matrixWorld.copy(rt.matrix):rt.matrixWorld.multiplyMatrices(ut.matrixWorld,rt.matrix),rt.matrixWorldInverse.copy(rt.matrixWorld).invert()}this.updateCamera=function(rt){if(null===S)return;nt.near=Ft.near=Ct.near=rt.near,nt.far=Ft.far=Ct.far=rt.far,Et===nt.near&&Jt===nt.far||(S.updateRenderState({depthNear:nt.near,depthFar:nt.far}),Et=nt.near,Jt=nt.far);const ut=rt.parent,rn=nt.cameras;nn(nt,ut);for(let _n=0;_n<rn.length;_n++)nn(rn[_n],ut);nt.matrixWorld.decompose(nt.position,nt.quaternion,nt.scale),rt.position.copy(nt.position),rt.quaternion.copy(nt.quaternion),rt.scale.copy(nt.scale),rt.matrix.copy(nt.matrix),rt.matrixWorld.copy(nt.matrixWorld);const un=rt.children;for(let _n=0,kn=un.length;_n<kn;_n++)un[_n].updateMatrixWorld(!0);2===rn.length?function(_n,kn,Jn){zt.setFromMatrixPosition(kn.matrixWorld),Rt.setFromMatrixPosition(Jn.matrixWorld);const Zn=zt.distanceTo(Rt),cn=kn.projectionMatrix.elements,mt=Jn.projectionMatrix.elements,Kt=cn[14]/(cn[10]-1),Vt=cn[14]/(cn[10]+1),vn=(cn[9]+1)/cn[5],Nn=(cn[9]-1)/cn[5],dr=(cn[8]-1)/cn[0],_r=(mt[8]+1)/mt[0],jr=Kt*dr,ki=Kt*_r,_o=Zn/(-dr+_r),El=_o*-dr;kn.matrixWorld.decompose(_n.position,_n.quaternion,_n.scale),_n.translateX(El),_n.translateZ(_o),_n.matrixWorld.compose(_n.position,_n.quaternion,_n.scale),_n.matrixWorldInverse.copy(_n.matrixWorld).invert();const zo=Kt+_o,$a=Vt+_o;_n.projectionMatrix.makePerspective(jr-El,ki+(Zn-El),vn*Vt/$a*zo,Nn*Vt/$a*zo,zo,$a)}(nt,Ct,Ft):nt.projectionMatrix.copy(Ct.projectionMatrix)},this.getCamera=function(){return nt},this.getFoveation=function(){return null!==ue?ue.fixedFoveation:null!==_e?_e.fixedFoveation:void 0},this.setFoveation=function(rt){null!==ue&&(ue.fixedFoveation=rt),null!==_e&&void 0!==_e.fixedFoveation&&(_e.fixedFoveation=rt)};let en=null;const En=new Nc;En.setAnimationLoop(function(rt,ut){if(V=ut.getViewerPose(k),We=ut,null!==V){const un=V.views;null!==_e&&_.bindXRFramebuffer(_e.framebuffer);let _n=!1;un.length!==nt.cameras.length&&(nt.cameras.length=0,_n=!0);for(let kn=0;kn<un.length;kn++){const Jn=un[kn];let Zn=null;if(null!==_e)Zn=_e.getViewport(Jn);else{const mt=te.getViewSubImage(ue,Jn);_.bindXRFramebuffer(ce),void 0!==mt.depthStencilTexture&&c.framebufferTexture2D(36160,tt,3553,mt.depthStencilTexture,0),c.framebufferTexture2D(36160,36064,3553,mt.colorTexture,0),Zn=mt.viewport}const cn=Qe[kn];cn.matrix.fromArray(Jn.transform.matrix),cn.projectionMatrix.fromArray(Jn.projectionMatrix),cn.viewport.set(Zn.x,Zn.y,Zn.width,Zn.height),0===kn&&nt.matrix.copy(cn.matrix),!0===_n&&nt.cameras.push(cn)}Ee&&(_.bindXRFramebuffer($e),null!==Ze&&c.clear(Ze))}const rn=S.inputSources;for(let un=0;un<ot.length;un++)ot[un].update(rn[un],ut,k);if(en&&en(rt,ut),Ee){const un=ue.textureWidth,_n=ue.textureHeight;_.bindFramebuffer(36008,$e),_.bindFramebuffer(36009,ce),c.invalidateFramebuffer(36008,[tt]),c.invalidateFramebuffer(36009,[tt]),c.blitFramebuffer(0,0,un,_n,0,0,un,_n,16384,9728),c.invalidateFramebuffer(36008,[36064]),_.bindFramebuffer(36008,null),_.bindFramebuffer(36009,null),_.bindFramebuffer(36160,$e)}We=null}),this.setAnimationLoop=function(rt){en=rt},this.dispose=function(){}}}function sm(w){function e(d,_){d.opacity.value=_.opacity,_.color&&d.diffuse.value.copy(_.color),_.emissive&&d.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(d.map.value=_.map),_.alphaMap&&(d.alphaMap.value=_.alphaMap),_.specularMap&&(d.specularMap.value=_.specularMap),_.alphaTest>0&&(d.alphaTest.value=_.alphaTest);const S=w.get(_).envMap;if(S){d.envMap.value=S,d.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,d.reflectivity.value=_.reflectivity,d.ior.value=_.ior,d.refractionRatio.value=_.refractionRatio;const F=w.get(S).__maxMipLevel;void 0!==F&&(d.maxMipLevel.value=F)}let B,k;_.lightMap&&(d.lightMap.value=_.lightMap,d.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(d.aoMap.value=_.aoMap,d.aoMapIntensity.value=_.aoMapIntensity),_.map?B=_.map:_.specularMap?B=_.specularMap:_.displacementMap?B=_.displacementMap:_.normalMap?B=_.normalMap:_.bumpMap?B=_.bumpMap:_.roughnessMap?B=_.roughnessMap:_.metalnessMap?B=_.metalnessMap:_.alphaMap?B=_.alphaMap:_.emissiveMap?B=_.emissiveMap:_.clearcoatMap?B=_.clearcoatMap:_.clearcoatNormalMap?B=_.clearcoatNormalMap:_.clearcoatRoughnessMap?B=_.clearcoatRoughnessMap:_.specularIntensityMap?B=_.specularIntensityMap:_.specularTintMap?B=_.specularTintMap:_.transmissionMap?B=_.transmissionMap:_.thicknessMap&&(B=_.thicknessMap),void 0!==B&&(B.isWebGLRenderTarget&&(B=B.texture),!0===B.matrixAutoUpdate&&B.updateMatrix(),d.uvTransform.value.copy(B.matrix)),_.aoMap?k=_.aoMap:_.lightMap&&(k=_.lightMap),void 0!==k&&(k.isWebGLRenderTarget&&(k=k.texture),!0===k.matrixAutoUpdate&&k.updateMatrix(),d.uv2Transform.value.copy(k.matrix))}function c(d,_){d.roughness.value=_.roughness,d.metalness.value=_.metalness,_.roughnessMap&&(d.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(d.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(d.emissiveMap.value=_.emissiveMap),_.bumpMap&&(d.bumpMap.value=_.bumpMap,d.bumpScale.value=_.bumpScale,_.side===q&&(d.bumpScale.value*=-1)),_.normalMap&&(d.normalMap.value=_.normalMap,d.normalScale.value.copy(_.normalScale),_.side===q&&d.normalScale.value.negate()),_.displacementMap&&(d.displacementMap.value=_.displacementMap,d.displacementScale.value=_.displacementScale,d.displacementBias.value=_.displacementBias),w.get(_).envMap&&(d.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(d,_){d.fogColor.value.copy(_.color),_.isFog?(d.fogNear.value=_.near,d.fogFar.value=_.far):_.isFogExp2&&(d.fogDensity.value=_.density)},refreshMaterialUniforms:function(d,_,S,B,k){var V;_.isMeshBasicMaterial?e(d,_):_.isMeshLambertMaterial?(e(d,_),(V=_).emissiveMap&&(d.emissiveMap.value=V.emissiveMap)):_.isMeshToonMaterial?(e(d,_),function(F,V){V.gradientMap&&(F.gradientMap.value=V.gradientMap),V.emissiveMap&&(F.emissiveMap.value=V.emissiveMap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===q&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===q&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshPhongMaterial?(e(d,_),function(F,V){F.specular.value.copy(V.specular),F.shininess.value=Math.max(V.shininess,1e-4),V.emissiveMap&&(F.emissiveMap.value=V.emissiveMap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===q&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===q&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshStandardMaterial?(e(d,_),_.isMeshPhysicalMaterial?function(F,V,te){c(F,V),F.ior.value=V.ior,V.sheenTint&&F.sheenTint.value.copy(V.sheenTint),V.clearcoat>0&&(F.clearcoat.value=V.clearcoat,F.clearcoatRoughness.value=V.clearcoatRoughness,V.clearcoatMap&&(F.clearcoatMap.value=V.clearcoatMap),V.clearcoatRoughnessMap&&(F.clearcoatRoughnessMap.value=V.clearcoatRoughnessMap),V.clearcoatNormalMap&&(F.clearcoatNormalScale.value.copy(V.clearcoatNormalScale),F.clearcoatNormalMap.value=V.clearcoatNormalMap,V.side===q&&F.clearcoatNormalScale.value.negate())),V.transmission>0&&(F.transmission.value=V.transmission,F.transmissionSamplerMap.value=te.texture,F.transmissionSamplerSize.value.set(te.width,te.height),V.transmissionMap&&(F.transmissionMap.value=V.transmissionMap),F.thickness.value=V.thickness,V.thicknessMap&&(F.thicknessMap.value=V.thicknessMap),F.attenuationDistance.value=V.attenuationDistance,F.attenuationTint.value.copy(V.attenuationTint)),F.specularIntensity.value=V.specularIntensity,F.specularTint.value.copy(V.specularTint),V.specularIntensityMap&&(F.specularIntensityMap.value=V.specularIntensityMap),V.specularTintMap&&(F.specularTintMap.value=V.specularTintMap)}(d,_,k):c(d,_)):_.isMeshMatcapMaterial?(e(d,_),function(F,V){V.matcap&&(F.matcap.value=V.matcap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===q&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===q&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshDepthMaterial?(e(d,_),function(F,V){V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshDistanceMaterial?(e(d,_),function(F,V){V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias),F.referencePosition.value.copy(V.referencePosition),F.nearDistance.value=V.nearDistance,F.farDistance.value=V.farDistance}(d,_)):_.isMeshNormalMaterial?(e(d,_),function(F,V){V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===q&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===q&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isLineBasicMaterial?(function(F,V){F.diffuse.value.copy(V.color),F.opacity.value=V.opacity}(d,_),_.isLineDashedMaterial&&function(F,V){F.dashSize.value=V.dashSize,F.totalSize.value=V.dashSize+V.gapSize,F.scale.value=V.scale}(d,_)):_.isPointsMaterial?function(F,V,te,ce){let ue;F.diffuse.value.copy(V.color),F.opacity.value=V.opacity,F.size.value=V.size*te,F.scale.value=.5*ce,V.map&&(F.map.value=V.map),V.alphaMap&&(F.alphaMap.value=V.alphaMap),V.alphaTest>0&&(F.alphaTest.value=V.alphaTest),V.map?ue=V.map:V.alphaMap&&(ue=V.alphaMap),void 0!==ue&&(!0===ue.matrixAutoUpdate&&ue.updateMatrix(),F.uvTransform.value.copy(ue.matrix))}(d,_,S,B):_.isSpriteMaterial?function(F,V){let te;F.diffuse.value.copy(V.color),F.opacity.value=V.opacity,F.rotation.value=V.rotation,V.map&&(F.map.value=V.map),V.alphaMap&&(F.alphaMap.value=V.alphaMap),V.alphaTest>0&&(F.alphaTest.value=V.alphaTest),V.map?te=V.map:V.alphaMap&&(te=V.alphaMap),void 0!==te&&(!0===te.matrixAutoUpdate&&te.updateMatrix(),F.uvTransform.value.copy(te.matrix))}(d,_):_.isShadowMaterial?(d.color.value.copy(_.color),d.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function Yi(w={}){const e=void 0!==w.canvas?w.canvas:function(){const vt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return vt.style.display="block",vt}(),c=void 0!==w.context?w.context:null,d=void 0!==w.alpha&&w.alpha,_=void 0===w.depth||w.depth,S=void 0===w.stencil||w.stencil,B=void 0!==w.antialias&&w.antialias,k=void 0===w.premultipliedAlpha||w.premultipliedAlpha,F=void 0!==w.preserveDrawingBuffer&&w.preserveDrawingBuffer,V=void 0!==w.powerPreference?w.powerPreference:"default",te=void 0!==w.failIfMajorPerformanceCaveat&&w.failIfMajorPerformanceCaveat;let ce=null,ue=null;const _e=[],Ee=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Zi,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1;const $e=this;let Be=!1,Re=0,We=0,tt=null,Ze=-1,ot=null;const st=new Di,Ct=new Di;let Ft=null,Qe=e.width,nt=e.height,Et=1,Jt=null,ct=null;const Lt=new Di(0,0,Qe,nt),_t=new Di(0,0,Qe,nt);let zt=!1;const Rt=[],nn=new Dr;let en=!1,En=!1,rt=null;const ut=new tn,rn=new ht,un={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function _n(){return null===tt?Et:1}let kn,Jn,Zn,cn,mt,Kt,Vt,vn,Nn,dr,_r,jr,ki,_o,El,zo,$a,ju,Ld,Bd,Oh,gh,St,Ht=c;function gn(vt,bn){for(let an=0;an<vt.length;an++){const Wn=e.getContext(vt[an],bn);if(null!==Wn)return Wn}return null}try{const vt={alpha:d,depth:_,stencil:S,antialias:B,premultipliedAlpha:k,preserveDrawingBuffer:F,powerPreference:V,failIfMajorPerformanceCaveat:te};if(e.addEventListener("webglcontextlost",Mi,!1),e.addEventListener("webglcontextrestored",Fi,!1),null===Ht){const bn=["webgl2","webgl","experimental-webgl"];if(!0===$e.isWebGL1Renderer&&bn.shift(),Ht=gn(bn,vt),null===Ht)throw gn(bn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ht.getShaderPrecisionFormat&&(Ht.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(vt){throw console.error("THREE.WebGLRenderer: "+vt.message),vt}function Dn(){kn=new Hn(Ht),Jn=new nu(Ht,kn,w),kn.init(Jn),gh=new Wd(Ht,kn,Jn),Zn=new mf(Ht,kn,Jn),Rt[0]=1029,cn=new Lr(Ht),mt=new Gd,Kt=new Cu(Ht,kn,Zn,mt,Jn,gh,cn),Vt=new vl($e),vn=new Sn($e),Nn=new qp(Ht,Jn),St=new Mo(Ht,kn,Nn,Jn),dr=new Cr(Ht,Nn,cn,St),_r=new el(Ht,dr,Nn,cn),Ld=new ic(Ht),zo=new Tu(mt),jr=new Pp($e,Vt,vn,kn,Jn,St,zo),ki=new sm(mt),_o=new pf(mt),El=new df(kn,Jn),ju=new tu($e,Vt,Zn,_r,k),$a=new om($e,_r,Jn),Bd=new Vn(Ht,kn,cn,Jn),Oh=new Ur(Ht,kn,cn,Jn),cn.programs=jr.programs,$e.capabilities=Jn,$e.extensions=kn,$e.properties=mt,$e.renderLists=_o,$e.shadowMap=$a,$e.state=Zn,$e.info=cn}Dn();const nr=new $o($e,Ht);function Mi(vt){vt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Be=!0}function Fi(){console.log("THREE.WebGLRenderer: Context Restored."),Be=!1;const vt=cn.autoReset,bn=$a.enabled,an=$a.autoUpdate,An=$a.needsUpdate,Wn=$a.type;Dn(),cn.autoReset=vt,$a.enabled=bn,$a.autoUpdate=an,$a.needsUpdate=An,$a.type=Wn}function oi(vt){const bn=vt.target;var an;bn.removeEventListener("dispose",oi),function(An){const Wn=mt.get(An).programs;void 0!==Wn&&Wn.forEach(function(Si){jr.releaseProgram(Si)})}(an=bn),mt.remove(an)}this.xr=nr,this.getContext=function(){return Ht},this.getContextAttributes=function(){return Ht.getContextAttributes()},this.forceContextLoss=function(){const vt=kn.get("WEBGL_lose_context");vt&&vt.loseContext()},this.forceContextRestore=function(){const vt=kn.get("WEBGL_lose_context");vt&&vt.restoreContext()},this.getPixelRatio=function(){return Et},this.setPixelRatio=function(vt){void 0!==vt&&(Et=vt,this.setSize(Qe,nt,!1))},this.getSize=function(vt){return vt.set(Qe,nt)},this.setSize=function(vt,bn,an){nr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qe=vt,nt=bn,e.width=Math.floor(vt*Et),e.height=Math.floor(bn*Et),!1!==an&&(e.style.width=vt+"px",e.style.height=bn+"px"),this.setViewport(0,0,vt,bn))},this.getDrawingBufferSize=function(vt){return vt.set(Qe*Et,nt*Et).floor()},this.setDrawingBufferSize=function(vt,bn,an){Qe=vt,nt=bn,Et=an,e.width=Math.floor(vt*an),e.height=Math.floor(bn*an),this.setViewport(0,0,vt,bn)},this.getCurrentViewport=function(vt){return vt.copy(st)},this.getViewport=function(vt){return vt.copy(Lt)},this.setViewport=function(vt,bn,an,An){vt.isVector4?Lt.set(vt.x,vt.y,vt.z,vt.w):Lt.set(vt,bn,an,An),Zn.viewport(st.copy(Lt).multiplyScalar(Et).floor())},this.getScissor=function(vt){return vt.copy(_t)},this.setScissor=function(vt,bn,an,An){vt.isVector4?_t.set(vt.x,vt.y,vt.z,vt.w):_t.set(vt,bn,an,An),Zn.scissor(Ct.copy(_t).multiplyScalar(Et).floor())},this.getScissorTest=function(){return zt},this.setScissorTest=function(vt){Zn.setScissorTest(zt=vt)},this.setOpaqueSort=function(vt){Jt=vt},this.setTransparentSort=function(vt){ct=vt},this.getClearColor=function(vt){return vt.copy(ju.getClearColor())},this.setClearColor=function(){ju.setClearColor.apply(ju,arguments)},this.getClearAlpha=function(){return ju.getClearAlpha()},this.setClearAlpha=function(){ju.setClearAlpha.apply(ju,arguments)},this.clear=function(vt,bn,an){let An=0;(void 0===vt||vt)&&(An|=16384),(void 0===bn||bn)&&(An|=256),(void 0===an||an)&&(An|=1024),Ht.clear(An)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Mi,!1),e.removeEventListener("webglcontextrestored",Fi,!1),_o.dispose(),El.dispose(),mt.dispose(),Vt.dispose(),vn.dispose(),_r.dispose(),St.dispose(),nr.dispose(),nr.removeEventListener("sessionstart",aa),nr.removeEventListener("sessionend",la),rt&&(rt.dispose(),rt=null),jo.stop()},this.renderBufferImmediate=function(vt,bn){St.initAttributes();const an=mt.get(vt);vt.hasPositions&&!an.position&&(an.position=Ht.createBuffer()),vt.hasNormals&&!an.normal&&(an.normal=Ht.createBuffer()),vt.hasUvs&&!an.uv&&(an.uv=Ht.createBuffer()),vt.hasColors&&!an.color&&(an.color=Ht.createBuffer());const An=bn.getAttributes();vt.hasPositions&&(Ht.bindBuffer(34962,an.position),Ht.bufferData(34962,vt.positionArray,35048),St.enableAttribute(An.position.location),Ht.vertexAttribPointer(An.position.location,3,5126,!1,0,0)),vt.hasNormals&&(Ht.bindBuffer(34962,an.normal),Ht.bufferData(34962,vt.normalArray,35048),St.enableAttribute(An.normal.location),Ht.vertexAttribPointer(An.normal.location,3,5126,!1,0,0)),vt.hasUvs&&(Ht.bindBuffer(34962,an.uv),Ht.bufferData(34962,vt.uvArray,35048),St.enableAttribute(An.uv.location),Ht.vertexAttribPointer(An.uv.location,2,5126,!1,0,0)),vt.hasColors&&(Ht.bindBuffer(34962,an.color),Ht.bufferData(34962,vt.colorArray,35048),St.enableAttribute(An.color.location),Ht.vertexAttribPointer(An.color.location,3,5126,!1,0,0)),St.disableUnusedAttributes(),Ht.drawArrays(4,0,vt.count),vt.count=0},this.renderBufferDirect=function(vt,bn,an,An,Wn,Si){null===bn&&(bn=un);const Gr=Wn.isMesh&&Wn.matrixWorld.determinant()<0,Li=nf(vt,bn,An,Wn);Zn.setMaterial(An,Gr);let no=an.index;const Ts=an.attributes.position;if(null===no){if(void 0===Ts||0===Ts.count)return}else if(0===no.count)return;let Go,ro=1;!0===An.wireframe&&(no=dr.getWireframeAttribute(an),ro=2),void 0===an.morphAttributes.position&&void 0===an.morphAttributes.normal||Ld.update(Wn,an,An,Li),St.setup(Wn,An,Li,an,no);let Bi=Bd;null!==no&&(Go=Nn.get(no),Bi=Oh,Bi.setIndex(Go));const Gf=null!==no?no.count:Ts.count,ol=an.drawRange.start*ro,Tf=an.drawRange.count*ro,sd=null!==Si?Si.start*ro:0,Hf=null!==Si?Si.count*ro:1/0,Mf=Math.max(ol,sd),jc=Math.min(Gf,ol+Tf,sd+Hf)-1,Nd=Math.max(0,jc-Mf+1);if(0!==Nd){if(Wn.isMesh)!0===An.wireframe?(Zn.setLineWidth(An.wireframeLinewidth*_n()),Bi.setMode(1)):Bi.setMode(4);else if(Wn.isLine){let Gu=An.linewidth;void 0===Gu&&(Gu=1),Zn.setLineWidth(Gu*_n()),Bi.setMode(Wn.isLineSegments?1:Wn.isLineLoop?2:3)}else Wn.isPoints?Bi.setMode(0):Wn.isSprite&&Bi.setMode(4);if(Wn.isInstancedMesh)Bi.renderInstances(Mf,Nd,Wn.count);else if(an.isInstancedBufferGeometry){const Gu=Math.min(an.instanceCount,an._maxInstanceCount);Bi.renderInstances(Mf,Nd,Gu)}else Bi.render(Mf,Nd)}},this.compile=function(vt,bn){ue=El.get(vt),ue.init(),Ee.push(ue),vt.traverseVisible(function(an){an.isLight&&an.layers.test(bn.layers)&&(ue.pushLight(an),an.castShadow&&ue.pushShadow(an))}),ue.setupLights($e.physicallyCorrectLights),vt.traverse(function(an){const An=an.material;if(An)if(Array.isArray(An))for(let Wn=0;Wn<An.length;Wn++)zc(An[Wn],vt,an);else zc(An,vt,an)}),Ee.pop(),ue=null};let us=null;function aa(){jo.stop()}function la(){jo.start()}const jo=new Nc;function Vi(vt,bn,an,An){if(!1===vt.visible)return;if(vt.layers.test(bn.layers))if(vt.isGroup)an=vt.renderOrder;else if(vt.isLOD)!0===vt.autoUpdate&&vt.update(bn);else if(vt.isLight)ue.pushLight(vt),vt.castShadow&&ue.pushShadow(vt);else if(vt.isSprite){if(!vt.frustumCulled||nn.intersectsSprite(vt)){An&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut);const Si=_r.update(vt),Gr=vt.material;Gr.visible&&ce.push(vt,Si,Gr,an,rn.z,null)}}else if(vt.isImmediateRenderObject)An&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut),ce.push(vt,null,vt.material,an,rn.z,null);else if((vt.isMesh||vt.isLine||vt.isPoints)&&(vt.isSkinnedMesh&&vt.skeleton.frame!==cn.render.frame&&(vt.skeleton.update(),vt.skeleton.frame=cn.render.frame),!vt.frustumCulled||nn.intersectsObject(vt))){An&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut);const Si=_r.update(vt),Gr=vt.material;if(Array.isArray(Gr)){const Li=Si.groups;for(let no=0,Ts=Li.length;no<Ts;no++){const Go=Li[no],ro=Gr[Go.materialIndex];ro&&ro.visible&&ce.push(vt,Si,ro,an,rn.z,Go)}}else Gr.visible&&ce.push(vt,Si,Gr,an,rn.z,null)}const Wn=vt.children;for(let Si=0,Gr=Wn.length;Si<Gr;Si++)Vi(Wn[Si],bn,an,An)}function ca(vt,bn,an,An){const Wn=vt.opaque,Si=vt.transmissive,Gr=vt.transparent;ue.setupLightsView(an),Si.length>0&&function(Li,no,Ts){null===rt&&(rt=new(!0===B&&!0===Jn.isWebGL2?Jc:io)(1024,1024,{generateMipmaps:!0,type:null!==gh.convert(ps)?ps:ha,minFilter:sl,magFilter:Ir,wrapS:Jr,wrapT:Jr}));const Go=$e.getRenderTarget();$e.setRenderTarget(rt),$e.clear();const ro=$e.toneMapping;$e.toneMapping=vr,Ca(Li,no,Ts),$e.toneMapping=ro,Kt.updateMultisampleRenderTarget(rt),Kt.updateRenderTargetMipmap(rt),$e.setRenderTarget(Go)}(Wn,bn,an),An&&Zn.viewport(st.copy(An)),Wn.length>0&&Ca(Wn,bn,an),Si.length>0&&Ca(Si,bn,an),Gr.length>0&&Ca(Gr,bn,an)}function Ca(vt,bn,an){const An=!0===bn.isScene?bn.overrideMaterial:null;for(let Wn=0,Si=vt.length;Wn<Si;Wn++){const Gr=vt[Wn],Li=Gr.object,no=Gr.geometry,Ts=null===An?Gr.material:An,Go=Gr.group;Li.layers.test(an.layers)&&is(Li,bn,an,no,Ts,Go)}}function is(vt,bn,an,An,Wn,Si){if(vt.onBeforeRender($e,bn,an,An,Wn,Si),vt.modelViewMatrix.multiplyMatrices(an.matrixWorldInverse,vt.matrixWorld),vt.normalMatrix.getNormalMatrix(vt.modelViewMatrix),vt.isImmediateRenderObject){const Gr=nf(an,bn,Wn,vt);Zn.setMaterial(Wn),St.reset(),no=Gr,vt.render(function(Ts){$e.renderBufferImmediate(Ts,no)})}else!0===Wn.transparent&&Wn.side===Y?(Wn.side=q,Wn.needsUpdate=!0,$e.renderBufferDirect(an,bn,An,Wn,vt,Si),Wn.side=le,Wn.needsUpdate=!0,$e.renderBufferDirect(an,bn,An,Wn,vt,Si),Wn.side=Y):$e.renderBufferDirect(an,bn,An,Wn,vt,Si);var no;vt.onAfterRender($e,bn,an,An,Wn,Si)}function zc(vt,bn,an){!0!==bn.isScene&&(bn=un);const An=mt.get(vt),Wn=ue.state.lights,Gr=Wn.state.version,Li=jr.getParameters(vt,Wn.state,ue.state.shadowsArray,bn,an),no=jr.getProgramCacheKey(Li);let Ts=An.programs;An.environment=vt.isMeshStandardMaterial?bn.environment:null,An.fog=bn.fog,An.envMap=(vt.isMeshStandardMaterial?vn:Vt).get(vt.envMap||An.environment),void 0===Ts&&(vt.addEventListener("dispose",oi),Ts=new Map,An.programs=Ts);let Go=Ts.get(no);if(void 0!==Go){if(An.currentProgram===Go&&An.lightsStateVersion===Gr)return Vl(vt,Li),Go}else Li.uniforms=jr.getUniforms(vt),vt.onBuild(Li,$e),vt.onBeforeCompile(Li,$e),Go=jr.acquireProgram(Li,no),Ts.set(no,Go),An.uniforms=Li.uniforms;const ro=An.uniforms;var ol;(vt.isShaderMaterial||vt.isRawShaderMaterial)&&!0!==vt.clipping||(ro.clippingPlanes=zo.uniform),Vl(vt,Li),An.needsLights=(ol=vt).isMeshLambertMaterial||ol.isMeshToonMaterial||ol.isMeshPhongMaterial||ol.isMeshStandardMaterial||ol.isShadowMaterial||ol.isShaderMaterial&&!0===ol.lights,An.lightsStateVersion=Gr,An.needsLights&&(ro.ambientLightColor.value=Wn.state.ambient,ro.lightProbe.value=Wn.state.probe,ro.directionalLights.value=Wn.state.directional,ro.directionalLightShadows.value=Wn.state.directionalShadow,ro.spotLights.value=Wn.state.spot,ro.spotLightShadows.value=Wn.state.spotShadow,ro.rectAreaLights.value=Wn.state.rectArea,ro.ltc_1.value=Wn.state.rectAreaLTC1,ro.ltc_2.value=Wn.state.rectAreaLTC2,ro.pointLights.value=Wn.state.point,ro.pointLightShadows.value=Wn.state.pointShadow,ro.hemisphereLights.value=Wn.state.hemi,ro.directionalShadowMap.value=Wn.state.directionalShadowMap,ro.directionalShadowMatrix.value=Wn.state.directionalShadowMatrix,ro.spotShadowMap.value=Wn.state.spotShadowMap,ro.spotShadowMatrix.value=Wn.state.spotShadowMatrix,ro.pointShadowMap.value=Wn.state.pointShadowMap,ro.pointShadowMatrix.value=Wn.state.pointShadowMatrix);const Bi=Go.getUniforms(),Gf=sc.seqWithValue(Bi.seq,ro);return An.currentProgram=Go,An.uniformsList=Gf,Go}function Vl(vt,bn){const an=mt.get(vt);an.outputEncoding=bn.outputEncoding,an.instancing=bn.instancing,an.skinning=bn.skinning,an.morphTargets=bn.morphTargets,an.morphNormals=bn.morphNormals,an.numClippingPlanes=bn.numClippingPlanes,an.numIntersection=bn.numClipIntersection,an.vertexAlphas=bn.vertexAlphas,an.vertexTangents=bn.vertexTangents}function nf(vt,bn,an,An){!0!==bn.isScene&&(bn=un),Kt.resetTextureUnits();const Wn=bn.fog,Gr=null===tt?$e.outputEncoding:tt.texture.encoding,Li=(an.isMeshStandardMaterial?vn:Vt).get(an.envMap||(an.isMeshStandardMaterial?bn.environment:null)),no=!0===an.vertexColors&&!!An.geometry&&!!An.geometry.attributes.color&&4===An.geometry.attributes.color.itemSize,Ts=!!An.geometry&&!!An.geometry.attributes.tangent,Go=!!An.geometry&&!!An.geometry.morphAttributes.position,ro=!!An.geometry&&!!An.geometry.morphAttributes.normal,Bi=mt.get(an),Gf=ue.state.lights;!0!==en||!0!==En&&vt===ot||zo.setState(an,vt,vt===ot&&an.id===Ze);let ol=!1;an.version===Bi.__version?Bi.needsLights&&Bi.lightsStateVersion!==Gf.state.version||Bi.outputEncoding!==Gr||An.isInstancedMesh&&!1===Bi.instancing?ol=!0:An.isInstancedMesh||!0!==Bi.instancing?An.isSkinnedMesh&&!1===Bi.skinning?ol=!0:An.isSkinnedMesh||!0!==Bi.skinning?Bi.envMap!==Li||an.fog&&Bi.fog!==Wn?ol=!0:void 0===Bi.numClippingPlanes||Bi.numClippingPlanes===zo.numPlanes&&Bi.numIntersection===zo.numIntersection?(Bi.vertexAlphas!==no||Bi.vertexTangents!==Ts||Bi.morphTargets!==Go||Bi.morphNormals!==ro)&&(ol=!0):ol=!0:ol=!0:ol=!0:(ol=!0,Bi.__version=an.version);let Tf=Bi.currentProgram;!0===ol&&(Tf=zc(an,bn,An));let sd=!1,Hf=!1,Mf=!1;const jc=Tf.getUniforms(),Nd=Bi.uniforms;if(Zn.useProgram(Tf.program)&&(sd=!0,Hf=!0,Mf=!0),an.id!==Ze&&(Ze=an.id,Hf=!0),sd||ot!==vt){if(jc.setValue(Ht,"projectionMatrix",vt.projectionMatrix),Jn.logarithmicDepthBuffer&&jc.setValue(Ht,"logDepthBufFC",2/(Math.log(vt.far+1)/Math.LN2)),ot!==vt&&(ot=vt,Hf=!0,Mf=!0),an.isShaderMaterial||an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshStandardMaterial||an.envMap){const ld=jc.map.cameraPosition;void 0!==ld&&ld.setValue(Ht,rn.setFromMatrixPosition(vt.matrixWorld))}(an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshLambertMaterial||an.isMeshBasicMaterial||an.isMeshStandardMaterial||an.isShaderMaterial)&&jc.setValue(Ht,"isOrthographic",!0===vt.isOrthographicCamera),(an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshLambertMaterial||an.isMeshBasicMaterial||an.isMeshStandardMaterial||an.isShaderMaterial||an.isShadowMaterial||An.isSkinnedMesh)&&jc.setValue(Ht,"viewMatrix",vt.matrixWorldInverse)}if(An.isSkinnedMesh){jc.setOptional(Ht,An,"bindMatrix"),jc.setOptional(Ht,An,"bindMatrixInverse");const ld=An.skeleton;ld&&(Jn.floatVertexTextures?(null===ld.boneTexture&&ld.computeBoneTexture(),jc.setValue(Ht,"boneTexture",ld.boneTexture,Kt),jc.setValue(Ht,"boneTextureSize",ld.boneTextureSize)):jc.setOptional(Ht,ld,"boneMatrices"))}var Gu,ad;return(Hf||Bi.receiveShadow!==An.receiveShadow)&&(Bi.receiveShadow=An.receiveShadow,jc.setValue(Ht,"receiveShadow",An.receiveShadow)),Hf&&(jc.setValue(Ht,"toneMappingExposure",$e.toneMappingExposure),Bi.needsLights&&((Gu=Nd).ambientLightColor.needsUpdate=ad=Mf,Gu.lightProbe.needsUpdate=ad,Gu.directionalLights.needsUpdate=ad,Gu.directionalLightShadows.needsUpdate=ad,Gu.pointLights.needsUpdate=ad,Gu.pointLightShadows.needsUpdate=ad,Gu.spotLights.needsUpdate=ad,Gu.spotLightShadows.needsUpdate=ad,Gu.rectAreaLights.needsUpdate=ad,Gu.hemisphereLights.needsUpdate=ad),Wn&&an.fog&&ki.refreshFogUniforms(Nd,Wn),ki.refreshMaterialUniforms(Nd,an,Et,nt,rt),sc.upload(Ht,Bi.uniformsList,Nd,Kt)),an.isShaderMaterial&&!0===an.uniformsNeedUpdate&&(sc.upload(Ht,Bi.uniformsList,Nd,Kt),an.uniformsNeedUpdate=!1),an.isSpriteMaterial&&jc.setValue(Ht,"center",An.center),jc.setValue(Ht,"modelViewMatrix",An.modelViewMatrix),jc.setValue(Ht,"normalMatrix",An.normalMatrix),jc.setValue(Ht,"modelMatrix",An.matrixWorld),Tf}jo.setAnimationLoop(function(vt){us&&us(vt)}),typeof window<"u"&&jo.setContext(window),this.setAnimationLoop=function(vt){us=vt,nr.setAnimationLoop(vt),null===vt?jo.stop():jo.start()},nr.addEventListener("sessionstart",aa),nr.addEventListener("sessionend",la),this.render=function(vt,bn){if(void 0===bn||!0===bn.isCamera){if(!0!==Be){if(!0===vt.autoUpdate&&vt.updateMatrixWorld(),null===bn.parent&&bn.updateMatrixWorld(),!0===nr.enabled&&!0===nr.isPresenting&&(!0===nr.cameraAutoUpdate&&nr.updateCamera(bn),bn=nr.getCamera()),!0===vt.isScene&&vt.onBeforeRender($e,vt,bn,tt),ue=El.get(vt,Ee.length),ue.init(),Ee.push(ue),ut.multiplyMatrices(bn.projectionMatrix,bn.matrixWorldInverse),nn.setFromProjectionMatrix(ut),En=this.localClippingEnabled,en=zo.init(this.clippingPlanes,En,bn),ce=_o.get(vt,_e.length),ce.init(),_e.push(ce),Vi(vt,bn,0,$e.sortObjects),ce.finish(),!0===$e.sortObjects&&ce.sort(Jt,ct),!0===en&&zo.beginShadows(),$a.render(ue.state.shadowsArray,vt,bn),!0===en&&zo.endShadows(),!0===this.info.autoReset&&this.info.reset(),ju.render(ce,vt),ue.setupLights($e.physicallyCorrectLights),bn.isArrayCamera){const An=bn.cameras;for(let Wn=0,Si=An.length;Wn<Si;Wn++){const Gr=An[Wn];ca(ce,vt,Gr,Gr.viewport)}}else ca(ce,vt,bn);null!==tt&&(Kt.updateMultisampleRenderTarget(tt),Kt.updateRenderTargetMipmap(tt)),!0===vt.isScene&&vt.onAfterRender($e,vt,bn),Zn.buffers.depth.setTest(!0),Zn.buffers.depth.setMask(!0),Zn.buffers.color.setMask(!0),Zn.setPolygonOffset(!1),St.resetDefaultState(),Ze=-1,ot=null,Ee.pop(),ue=Ee.length>0?Ee[Ee.length-1]:null,_e.pop(),ce=_e.length>0?_e[_e.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Re},this.getActiveMipmapLevel=function(){return We},this.getRenderTarget=function(){return tt},this.setRenderTarget=function(vt,bn=0,an=0){tt=vt,Re=bn,We=an,vt&&void 0===mt.get(vt).__webglFramebuffer&&Kt.setupRenderTarget(vt);let An=null,Wn=!1,Si=!1;if(vt){const Gr=vt.texture;(Gr.isDataTexture3D||Gr.isDataTexture2DArray)&&(Si=!0);const Li=mt.get(vt).__webglFramebuffer;vt.isWebGLCubeRenderTarget?(An=Li[bn],Wn=!0):An=vt.isWebGLMultisampleRenderTarget?mt.get(vt).__webglMultisampledFramebuffer:Li,st.copy(vt.viewport),Ct.copy(vt.scissor),Ft=vt.scissorTest}else st.copy(Lt).multiplyScalar(Et).floor(),Ct.copy(_t).multiplyScalar(Et).floor(),Ft=zt;if(Zn.bindFramebuffer(36160,An)&&Jn.drawBuffers){let Gr=!1;if(vt)if(vt.isWebGLMultipleRenderTargets){const Li=vt.texture;if(Rt.length!==Li.length||36064!==Rt[0]){for(let no=0,Ts=Li.length;no<Ts;no++)Rt[no]=36064+no;Rt.length=Li.length,Gr=!0}}else 1===Rt.length&&36064===Rt[0]||(Rt[0]=36064,Rt.length=1,Gr=!0);else 1===Rt.length&&1029===Rt[0]||(Rt[0]=1029,Rt.length=1,Gr=!0);Gr&&(Jn.isWebGL2?Ht.drawBuffers(Rt):kn.get("WEBGL_draw_buffers").drawBuffersWEBGL(Rt))}if(Zn.viewport(st),Zn.scissor(Ct),Zn.setScissorTest(Ft),Wn){const Gr=mt.get(vt.texture);Ht.framebufferTexture2D(36160,36064,34069+bn,Gr.__webglTexture,an)}else if(Si){const Gr=mt.get(vt.texture);Ht.framebufferTextureLayer(36160,36064,Gr.__webglTexture,an||0,bn||0)}Ze=-1},this.readRenderTargetPixels=function(vt,bn,an,An,Wn,Si,Gr){if(!vt||!vt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Li=mt.get(vt).__webglFramebuffer;if(vt.isWebGLCubeRenderTarget&&void 0!==Gr&&(Li=Li[Gr]),Li){Zn.bindFramebuffer(36160,Li);try{const no=vt.texture,Ts=no.format,Go=no.type;if(Ts!==lo&&gh.convert(Ts)!==Ht.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ro=Go===ps&&(kn.has("EXT_color_buffer_half_float")||Jn.isWebGL2&&kn.has("EXT_color_buffer_float"));if(!(Go===ha||gh.convert(Go)===Ht.getParameter(35738)||Go===Xo&&(Jn.isWebGL2||kn.has("OES_texture_float")||kn.has("WEBGL_color_buffer_float"))||ro))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Ht.checkFramebufferStatus(36160)?bn>=0&&bn<=vt.width-An&&an>=0&&an<=vt.height-Wn&&Ht.readPixels(bn,an,An,Wn,gh.convert(Ts),gh.convert(Go),Si):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const no=null!==tt?mt.get(tt).__webglFramebuffer:null;Zn.bindFramebuffer(36160,no)}}},this.copyFramebufferToTexture=function(vt,bn,an=0){const An=Math.pow(2,-an),Wn=Math.floor(bn.image.width*An),Si=Math.floor(bn.image.height*An);let Gr=gh.convert(bn.format);Jn.isWebGL2&&(6407===Gr&&(Gr=32849),6408===Gr&&(Gr=32856)),Kt.setTexture2D(bn,0),Ht.copyTexImage2D(3553,an,Gr,vt.x,vt.y,Wn,Si,0),Zn.unbindTexture()},this.copyTextureToTexture=function(vt,bn,an,An=0){const Wn=bn.image.width,Si=bn.image.height,Gr=gh.convert(an.format),Li=gh.convert(an.type);Kt.setTexture2D(an,0),Ht.pixelStorei(37440,an.flipY),Ht.pixelStorei(37441,an.premultiplyAlpha),Ht.pixelStorei(3317,an.unpackAlignment),bn.isDataTexture?Ht.texSubImage2D(3553,An,vt.x,vt.y,Wn,Si,Gr,Li,bn.image.data):bn.isCompressedTexture?Ht.compressedTexSubImage2D(3553,An,vt.x,vt.y,bn.mipmaps[0].width,bn.mipmaps[0].height,Gr,bn.mipmaps[0].data):Ht.texSubImage2D(3553,An,vt.x,vt.y,Gr,Li,bn.image),0===An&&an.generateMipmaps&&Ht.generateMipmap(3553),Zn.unbindTexture()},this.copyTextureToTexture3D=function(vt,bn,an,An,Wn=0){if($e.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Si=vt.max.x-vt.min.x+1,Gr=vt.max.y-vt.min.y+1,Li=vt.max.z-vt.min.z+1,no=gh.convert(An.format),Ts=gh.convert(An.type);let Go;if(An.isDataTexture3D)Kt.setTexture3D(An,0),Go=32879;else{if(!An.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Kt.setTexture2DArray(An,0),Go=35866}Ht.pixelStorei(37440,An.flipY),Ht.pixelStorei(37441,An.premultiplyAlpha),Ht.pixelStorei(3317,An.unpackAlignment);const ro=Ht.getParameter(3314),Bi=Ht.getParameter(32878),Gf=Ht.getParameter(3316),ol=Ht.getParameter(3315),Tf=Ht.getParameter(32877),sd=an.isCompressedTexture?an.mipmaps[0]:an.image;Ht.pixelStorei(3314,sd.width),Ht.pixelStorei(32878,sd.height),Ht.pixelStorei(3316,vt.min.x),Ht.pixelStorei(3315,vt.min.y),Ht.pixelStorei(32877,vt.min.z),an.isDataTexture||an.isDataTexture3D?Ht.texSubImage3D(Go,Wn,bn.x,bn.y,bn.z,Si,Gr,Li,no,Ts,sd.data):an.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ht.compressedTexSubImage3D(Go,Wn,bn.x,bn.y,bn.z,Si,Gr,Li,no,sd.data)):Ht.texSubImage3D(Go,Wn,bn.x,bn.y,bn.z,Si,Gr,Li,no,Ts,sd),Ht.pixelStorei(3314,ro),Ht.pixelStorei(32878,Bi),Ht.pixelStorei(3316,Gf),Ht.pixelStorei(3315,ol),Ht.pixelStorei(32877,Tf),0===Wn&&An.generateMipmaps&&Ht.generateMipmap(Go),Zn.unbindTexture()},this.initTexture=function(vt){Kt.setTexture2D(vt,0),Zn.unbindTexture()},this.resetState=function(){Re=0,We=0,tt=null,Zn.reset(),St.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class kp extends Yi{}kp.prototype.isWebGL1Renderer=!0;class Lu{constructor(e,c=25e-5){this.name="",this.color=new er(e),this.density=c}clone(){return new Lu(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Lu.prototype.isFogExp2=!0;class ka{constructor(e,c=1,d=1e3){this.name="",this.color=new er(e),this.near=c,this.far=d}clone(){return new ka(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}ka.prototype.isFog=!0;class Gs extends Pr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,c){return super.copy(e,c),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const c=super.toJSON(e);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),c}}Gs.prototype.isScene=!0;class Oc{constructor(e,c){this.array=e,this.stride=c,this.count=void 0!==e?e.length/c:0,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Qi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,c,d){e*=this.stride,d*=c.stride;for(let _=0,S=this.stride;_<S;_++)this.array[e+_]=c.array[d+_];return this}set(e,c=0){return this.array.set(e,c),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),d=new this.constructor(c,this.stride);return d.setUsage(this.usage),d}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Qi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Oc.prototype.isInterleavedBuffer=!0;const bs=new ht;class Ii{constructor(e,c,d,_=!1){this.name="",this.data=e,this.itemSize=c,this.offset=d,this.normalized=!0===_}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let c=0,d=this.data.count;c<d;c++)bs.x=this.getX(c),bs.y=this.getY(c),bs.z=this.getZ(c),bs.applyMatrix4(e),this.setXYZ(c,bs.x,bs.y,bs.z);return this}applyNormalMatrix(e){for(let c=0,d=this.count;c<d;c++)bs.x=this.getX(c),bs.y=this.getY(c),bs.z=this.getZ(c),bs.applyNormalMatrix(e),this.setXYZ(c,bs.x,bs.y,bs.z);return this}transformDirection(e){for(let c=0,d=this.count;c<d;c++)bs.x=this.getX(c),bs.y=this.getY(c),bs.z=this.getZ(c),bs.transformDirection(e),this.setXYZ(c,bs.x,bs.y,bs.z);return this}setX(e,c){return this.data.array[e*this.data.stride+this.offset]=c,this}setY(e,c){return this.data.array[e*this.data.stride+this.offset+1]=c,this}setZ(e,c){return this.data.array[e*this.data.stride+this.offset+2]=c,this}setW(e,c){return this.data.array[e*this.data.stride+this.offset+3]=c,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,c,d){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this}setXYZ(e,c,d,_){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this.data.array[e+2]=_,this}setXYZW(e,c,d,_,S){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this.data.array[e+2]=_,this.data.array[e+3]=S,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const _=d*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)c.push(this.data.array[_+S])}return new Pi(new this.array.constructor(c),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ii(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const _=d*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)c.push(this.data.array[_+S])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ii.prototype.isInterleavedBufferAttribute=!0;class Jp extends Cs{constructor(e){super(),this.type="SpriteMaterial",this.color=new er(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let kl;Jp.prototype.isSpriteMaterial=!0;const Vo=new ht,Fl=new ht,na=new ht,Fa=new zn,kc=new zn,cc=new tn,xd=new ht,uc=new ht,iu=new ht,Bu=new zn,hc=new zn,hh=new zn;class Fc extends Pr{constructor(e){if(super(),this.type="Sprite",void 0===kl){kl=new br;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new Oc(c,5);kl.setIndex([0,1,2,0,2,3]),kl.setAttribute("position",new Ii(d,3,0,!1)),kl.setAttribute("uv",new Ii(d,2,3,!1))}this.geometry=kl,this.material=void 0!==e?e:new Jp,this.center=new zn(.5,.5)}raycast(e,c){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Fl.setFromMatrixScale(this.matrixWorld),cc.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),na.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Fl.multiplyScalar(-na.z);const d=this.material.rotation;let _,S;0!==d&&(S=Math.cos(d),_=Math.sin(d));const B=this.center;Nu(xd.set(-.5,-.5,0),na,B,Fl,_,S),Nu(uc.set(.5,-.5,0),na,B,Fl,_,S),Nu(iu.set(.5,.5,0),na,B,Fl,_,S),Bu.set(0,0),hc.set(1,0),hh.set(1,1);let k=e.ray.intersectTriangle(xd,uc,iu,!1,Vo);if(null===k&&(Nu(uc.set(-.5,.5,0),na,B,Fl,_,S),hc.set(0,1),k=e.ray.intersectTriangle(xd,iu,uc,!1,Vo),null===k))return;const F=e.ray.origin.distanceTo(Vo);F<e.near||F>e.far||c.push({distance:F,point:Vo.clone(),uv:eo.getUV(Vo,xd,uc,iu,Bu,hc,hh,new zn),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Nu(w,e,c,d,_,S){Fa.subVectors(w,c).addScalar(.5).multiply(d),void 0!==_?(kc.x=S*Fa.x-_*Fa.y,kc.y=_*Fa.x+S*Fa.y):kc.copy(Fa),w.copy(e),w.x+=kc.x,w.y+=kc.y,w.applyMatrix4(cc)}Fc.prototype.isSprite=!0;const xs=new ht,Ru=new ht;class ph extends Pr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const c=e.levels;for(let d=0,_=c.length;d<_;d++){const S=c[d];this.addLevel(S.object.clone(),S.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,c=0){c=Math.abs(c);const d=this.levels;let _;for(_=0;_<d.length&&!(c<d[_].distance);_++);return d.splice(_,0,{distance:c,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const c=this.levels;if(c.length>0){let d,_;for(d=1,_=c.length;d<_&&!(e<c[d].distance);d++);return c[d-1].object}return null}raycast(e,c){if(this.levels.length>0){xs.setFromMatrixPosition(this.matrixWorld);const d=e.ray.origin.distanceTo(xs);this.getObjectForDistance(d).raycast(e,c)}}update(e){const c=this.levels;if(c.length>1){xs.setFromMatrixPosition(e.matrixWorld),Ru.setFromMatrixPosition(this.matrixWorld);const d=xs.distanceTo(Ru)/e.zoom;let _,S;for(c[0].object.visible=!0,_=1,S=c.length;_<S&&d>=c[_].distance;_++)c[_-1].object.visible=!1,c[_].object.visible=!0;for(this._currentLevel=_-1;_<S;_++)c[_].object.visible=!1}}toJSON(e){const c=super.toJSON(e);!1===this.autoUpdate&&(c.object.autoUpdate=!1),c.object.levels=[];const d=this.levels;for(let _=0,S=d.length;_<S;_++){const B=d[_];c.object.levels.push({object:B.object.uuid,distance:B.distance})}return c}}const Bh=new ht,Hs=new Di,Dl=new Di,Sa=new ht,Ul=new tn;class zl extends Ro{constructor(e,c){super(e,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tn,this.bindMatrixInverse=new tn}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,c){this.skeleton=e,void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Di,c=this.geometry.attributes.skinWeight;for(let d=0,_=c.count;d<_;d++){e.x=c.getX(d),e.y=c.getY(d),e.z=c.getZ(d),e.w=c.getW(d);const S=1/e.manhattanLength();S!==1/0?e.multiplyScalar(S):e.set(1,0,0,0),c.setXYZW(d,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,c){const d=this.skeleton,_=this.geometry;Hs.fromBufferAttribute(_.attributes.skinIndex,e),Dl.fromBufferAttribute(_.attributes.skinWeight,e),Bh.fromBufferAttribute(_.attributes.position,e).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let S=0;S<4;S++){const B=Dl.getComponent(S);if(0!==B){const k=Hs.getComponent(S);Ul.multiplyMatrices(d.bones[k].matrixWorld,d.boneInverses[k]),c.addScaledVector(Sa.copy(Bh).applyMatrix4(Ul),B)}}return c.applyMatrix4(this.bindMatrixInverse)}}zl.prototype.isSkinnedMesh=!0;class jl extends Pr{constructor(){super(),this.type="Bone"}}jl.prototype.isBone=!0;class Os extends $s{constructor(e=null,c=1,d=1,_,S,B,k,F,V=Ir,te=Ir,ce,ue){super(null,B,k,F,V,te,_,S,ce,ue),this.image={data:e,width:c,height:d},this.magFilter=V,this.minFilter=te,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Os.prototype.isDataTexture=!0;const Nh=new tn,Co=new tn;class rp{constructor(e=[],c=[]){this.uuid=Qi(),this.bones=e.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===c.length)this.calculateInverses();else if(e.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,_=this.bones.length;d<_;d++)this.boneInverses.push(new tn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,c=this.bones.length;e<c;e++){const d=new tn;this.bones[e]&&d.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let e=0,c=this.bones.length;e<c;e++){const d=this.bones[e];d&&d.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,c=this.bones.length;e<c;e++){const d=this.bones[e];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){const e=this.bones,c=this.boneInverses,d=this.boneMatrices,_=this.boneTexture;for(let S=0,B=e.length;S<B;S++)Nh.multiplyMatrices(e[S]?e[S].matrixWorld:Co,c[S]),Nh.toArray(d,16*S);null!==_&&(_.needsUpdate=!0)}clone(){return new rp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Xh(e),e=Math.max(e,4);const c=new Float32Array(e*e*4);c.set(this.boneMatrices);const d=new Os(c,e,e,lo,Xo);return this.boneMatrices=c,this.boneTexture=d,this.boneTextureSize=e,this}getBoneByName(e){for(let c=0,d=this.bones.length;c<d;c++){const _=this.bones[c];if(_.name===e)return _}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,c){this.uuid=e.uuid;for(let d=0,_=e.bones.length;d<_;d++){const S=e.bones[d];let B=c[S];void 0===B&&(console.warn("THREE.Skeleton: No bone found with UUID:",S),B=new jl),this.bones.push(B),this.boneInverses.push((new tn).fromArray(e.boneInverses[d]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const c=this.bones,d=this.boneInverses;for(let _=0,S=c.length;_<S;_++)e.bones.push(c[_].uuid),e.boneInverses.push(d[_].toArray());return e}}class ou extends Pi{constructor(e,c,d,_=1){"number"==typeof d&&(_=d,d=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,c,d),this.meshPerAttribute=_}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}ou.prototype.isInstancedBufferAttribute=!0;const _f=new tn,Pu=new tn,Oo=[],Lo=new Ro;class Dc extends Ro{constructor(e,c,d){super(e,c),this.instanceMatrix=new ou(new Float32Array(16*d),16),this.instanceColor=null,this.count=d,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,c){c.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,c){c.fromArray(this.instanceMatrix.array,16*e)}raycast(e,c){const d=this.matrixWorld,_=this.count;if(Lo.geometry=this.geometry,Lo.material=this.material,void 0!==Lo.material)for(let S=0;S<_;S++){this.getMatrixAt(S,_f),Pu.multiplyMatrices(d,_f),Lo.matrixWorld=Pu,Lo.raycast(e,Oo);for(let B=0,k=Oo.length;B<k;B++){const F=Oo[B];F.instanceId=S,F.object=this,c.push(F)}Oo.length=0}}setColorAt(e,c){null===this.instanceColor&&(this.instanceColor=new ou(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,c){c.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Dc.prototype.isInstancedMesh=!0;class kt extends Cs{constructor(e){super(),this.type="LineBasicMaterial",this.color=new er(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}kt.prototype.isLineBasicMaterial=!0;const Fp=new ht,ji=new ht,Vs=new tn,ko=new fn,oo=new xo;class Da extends Pr{constructor(e=new br,c=new kt){super(),this.type="Line",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,d=[0];for(let _=1,S=c.count;_<S;_++)Fp.fromBufferAttribute(c,_-1),ji.fromBufferAttribute(c,_),d[_]=d[_-1],d[_]+=Fp.distanceTo(ji);e.setAttribute("lineDistance",new hn(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,c){const d=this.geometry,_=this.matrixWorld,S=e.params.Line.threshold,B=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),oo.copy(d.boundingSphere),oo.applyMatrix4(_),oo.radius+=S,!1===e.ray.intersectsSphere(oo))return;Vs.copy(_).invert(),ko.copy(e.ray).applyMatrix4(Vs);const k=S/((this.scale.x+this.scale.y+this.scale.z)/3),F=k*k,V=new ht,te=new ht,ce=new ht,ue=new ht,_e=this.isLineSegments?2:1;if(d.isBufferGeometry){const Ee=d.index,$e=d.attributes.position;if(null!==Ee)for(let Be=Math.max(0,B.start),Re=Math.min(Ee.count,B.start+B.count)-1;Be<Re;Be+=_e){const We=Ee.getX(Be),tt=Ee.getX(Be+1);if(V.fromBufferAttribute($e,We),te.fromBufferAttribute($e,tt),ko.distanceSqToSegment(V,te,ue,ce)>F)continue;ue.applyMatrix4(this.matrixWorld);const Ze=e.ray.origin.distanceTo(ue);Ze<e.near||Ze>e.far||c.push({distance:Ze,point:ce.clone().applyMatrix4(this.matrixWorld),index:Be,face:null,faceIndex:null,object:this})}else for(let Be=Math.max(0,B.start),Re=Math.min($e.count,B.start+B.count)-1;Be<Re;Be+=_e){if(V.fromBufferAttribute($e,Be),te.fromBufferAttribute($e,Be+1),ko.distanceSqToSegment(V,te,ue,ce)>F)continue;ue.applyMatrix4(this.matrixWorld);const We=e.ray.origin.distanceTo(ue);We<e.near||We>e.far||c.push({distance:We,point:ce.clone().applyMatrix4(this.matrixWorld),index:Be,face:null,faceIndex:null,object:this})}}else d.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,B=_.length;S<B;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Da.prototype.isLine=!0;const ip=new ht,Pf=new ht;class fr extends Da{constructor(e,c){super(e,c),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,d=[];for(let _=0,S=c.count;_<S;_+=2)ip.fromBufferAttribute(c,_),Pf.fromBufferAttribute(c,_+1),d[_]=0===_?0:d[_-1],d[_+1]=d[_]+ip.distanceTo(Pf);e.setAttribute("lineDistance",new hn(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}fr.prototype.isLineSegments=!0;class Qo extends Da{constructor(e,c){super(e,c),this.type="LineLoop"}}Qo.prototype.isLineLoop=!0;class gi extends Cs{constructor(e){super(),this.type="PointsMaterial",this.color=new er(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}gi.prototype.isPointsMaterial=!0;const Wo=new tn,hi=new fn,Fo=new xo,pc=new ht;class ra extends Pr{constructor(e=new br,c=new gi){super(),this.type="Points",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,c){const d=this.geometry,_=this.matrixWorld,S=e.params.Points.threshold,B=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),Fo.copy(d.boundingSphere),Fo.applyMatrix4(_),Fo.radius+=S,!1===e.ray.intersectsSphere(Fo))return;Wo.copy(_).invert(),hi.copy(e.ray).applyMatrix4(Wo);const k=S/((this.scale.x+this.scale.y+this.scale.z)/3),F=k*k;if(d.isBufferGeometry){const V=d.index,te=d.attributes.position;if(null!==V)for(let ce=Math.max(0,B.start),ue=Math.min(V.count,B.start+B.count);ce<ue;ce++){const _e=V.getX(ce);pc.fromBufferAttribute(te,_e),wd(pc,_e,F,_,e,c,this)}else for(let ce=Math.max(0,B.start),ue=Math.min(te.count,B.start+B.count);ce<ue;ce++)pc.fromBufferAttribute(te,ce),wd(pc,ce,F,_,e,c,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,B=_.length;S<B;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function wd(w,e,c,d,_,S,B){const k=hi.distanceSqToPoint(w);if(k<c){const F=new ht;hi.closestPointToPoint(w,F),F.applyMatrix4(d);const V=_.ray.origin.distanceTo(F);if(V<_.near||V>_.far)return;S.push({distance:V,distanceToRay:Math.sqrt(k),point:F,index:e,face:null,object:B})}}ra.prototype.isPoints=!0;class Dp extends $s{constructor(e,c,d,_,S,B,k,F,V){super(e,c,d,_,S,B,k,F,V),this.format=void 0!==k?k:Fs,this.minFilter=void 0!==B?B:ai,this.magFilter=void 0!==S?S:ai,this.generateMipmaps=!1;const te=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function ce(){te.needsUpdate=!0,e.requestVideoFrameCallback(ce)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Dp.prototype.isVideoTexture=!0;class Iu extends $s{constructor(e,c,d,_,S,B,k,F,V,te,ce,ue){super(null,B,k,F,V,te,_,S,ce,ue),this.image={width:c,height:d},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Iu.prototype.isCompressedTexture=!0;class gf extends $s{constructor(e,c,d,_,S,B,k,F,V){super(e,c,d,_,S,B,k,F,V),this.needsUpdate=!0}}gf.prototype.isCanvasTexture=!0;class qd extends $s{constructor(e,c,d,_,S,B,k,F,V,te){if((te=void 0!==te?te:To)!==To&&te!==Zs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===d&&te===To&&(d=Hc),void 0===d&&te===Zs&&(d=Ms),super(null,_,S,B,k,F,te,d,V),this.image={width:e,height:c},this.magFilter=void 0!==k?k:Ir,this.minFilter=void 0!==F?F:Ir,this.flipY=!1,this.generateMipmaps=!1}}qd.prototype.isDepthTexture=!0;class su extends br{constructor(e=1,c=8,d=0,_=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:c,thetaStart:d,thetaLength:_},c=Math.max(3,c);const S=[],B=[],k=[],F=[],V=new ht,te=new zn;B.push(0,0,0),k.push(0,0,1),F.push(.5,.5);for(let ce=0,ue=3;ce<=c;ce++,ue+=3){const _e=d+ce/c*_;V.x=e*Math.cos(_e),V.y=e*Math.sin(_e),B.push(V.x,V.y,V.z),k.push(0,0,1),te.x=(B[ue]/e+1)/2,te.y=(B[ue+1]/e+1)/2,F.push(te.x,te.y)}for(let ce=1;ce<=c;ce++)S.push(ce,ce+1,0);this.setIndex(S),this.setAttribute("position",new hn(B,3)),this.setAttribute("normal",new hn(k,3)),this.setAttribute("uv",new hn(F,2))}static fromJSON(e){return new su(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class rl extends br{constructor(e=1,c=1,d=1,_=8,S=1,B=!1,k=0,F=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:c,height:d,radialSegments:_,heightSegments:S,openEnded:B,thetaStart:k,thetaLength:F};const V=this;_=Math.floor(_),S=Math.floor(S);const te=[],ce=[],ue=[],_e=[];let Ee=0;const $e=[],Be=d/2;let Re=0;function We(tt){const Ze=Ee,ot=new zn,st=new ht;let Ct=0;const Ft=!0===tt?e:c,Qe=!0===tt?1:-1;for(let Et=1;Et<=_;Et++)ce.push(0,Be*Qe,0),ue.push(0,Qe,0),_e.push(.5,.5),Ee++;const nt=Ee;for(let Et=0;Et<=_;Et++){const Jt=Et/_*F+k,ct=Math.cos(Jt),Lt=Math.sin(Jt);st.x=Ft*Lt,st.y=Be*Qe,st.z=Ft*ct,ce.push(st.x,st.y,st.z),ue.push(0,Qe,0),ot.x=.5*ct+.5,ot.y=.5*Lt*Qe+.5,_e.push(ot.x,ot.y),Ee++}for(let Et=0;Et<_;Et++){const Jt=Ze+Et,ct=nt+Et;!0===tt?te.push(ct,ct+1,Jt):te.push(ct+1,ct,Jt),Ct+=3}V.addGroup(Re,Ct,!0===tt?1:2),Re+=Ct}(function(){const tt=new ht,Ze=new ht;let ot=0;const st=(c-e)/d;for(let Ct=0;Ct<=S;Ct++){const Ft=[],Qe=Ct/S,nt=Qe*(c-e)+e;for(let Et=0;Et<=_;Et++){const Jt=Et/_,ct=Jt*F+k,Lt=Math.sin(ct),_t=Math.cos(ct);Ze.x=nt*Lt,Ze.y=-Qe*d+Be,Ze.z=nt*_t,ce.push(Ze.x,Ze.y,Ze.z),tt.set(Lt,st,_t).normalize(),ue.push(tt.x,tt.y,tt.z),_e.push(Jt,1-Qe),Ft.push(Ee++)}$e.push(Ft)}for(let Ct=0;Ct<_;Ct++)for(let Ft=0;Ft<S;Ft++){const nt=$e[Ft+1][Ct],Et=$e[Ft+1][Ct+1],Jt=$e[Ft][Ct+1];te.push($e[Ft][Ct],nt,Jt),te.push(nt,Et,Jt),ot+=6}V.addGroup(Re,ot,0),Re+=ot})(),!1===B&&(e>0&&We(!0),c>0&&We(!1)),this.setIndex(te),this.setAttribute("position",new hn(ce,3)),this.setAttribute("normal",new hn(ue,3)),this.setAttribute("uv",new hn(_e,2))}static fromJSON(e){return new rl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zp extends rl{constructor(e=1,c=1,d=8,_=1,S=!1,B=0,k=2*Math.PI){super(0,e,c,d,_,S,B,k),this.type="ConeGeometry",this.parameters={radius:e,height:c,radialSegments:d,heightSegments:_,openEnded:S,thetaStart:B,thetaLength:k}}static fromJSON(e){return new Zp(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class au extends br{constructor(e,c,d=1,_=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:c,radius:d,detail:_};const S=[],B=[];function k(ue,_e,Ee,$e){const Be=$e+1,Re=[];for(let We=0;We<=Be;We++){Re[We]=[];const tt=ue.clone().lerp(Ee,We/Be),Ze=_e.clone().lerp(Ee,We/Be),ot=Be-We;for(let st=0;st<=ot;st++)Re[We][st]=0===st&&We===Be?tt:tt.clone().lerp(Ze,st/ot)}for(let We=0;We<Be;We++)for(let tt=0;tt<2*(Be-We)-1;tt++){const Ze=Math.floor(tt/2);tt%2==0?(F(Re[We][Ze+1]),F(Re[We+1][Ze]),F(Re[We][Ze])):(F(Re[We][Ze+1]),F(Re[We+1][Ze+1]),F(Re[We+1][Ze]))}}function F(ue){S.push(ue.x,ue.y,ue.z)}function V(ue,_e){const Ee=3*ue;_e.x=e[Ee+0],_e.y=e[Ee+1],_e.z=e[Ee+2]}function te(ue,_e,Ee,$e){$e<0&&1===ue.x&&(B[_e]=ue.x-1),0===Ee.x&&0===Ee.z&&(B[_e]=$e/2/Math.PI+.5)}function ce(ue){return Math.atan2(ue.z,-ue.x)}(function(ue){const _e=new ht,Ee=new ht,$e=new ht;for(let Be=0;Be<c.length;Be+=3)V(c[Be+0],_e),V(c[Be+1],Ee),V(c[Be+2],$e),k(_e,Ee,$e,ue)})(_),function(ue){const _e=new ht;for(let Ee=0;Ee<S.length;Ee+=3)_e.x=S[Ee+0],_e.y=S[Ee+1],_e.z=S[Ee+2],_e.normalize().multiplyScalar(ue),S[Ee+0]=_e.x,S[Ee+1]=_e.y,S[Ee+2]=_e.z}(d),function(){const ue=new ht;for(let Ee=0;Ee<S.length;Ee+=3){ue.x=S[Ee+0],ue.y=S[Ee+1],ue.z=S[Ee+2];const $e=ce(ue)/2/Math.PI+.5,Be=(_e=ue,Math.atan2(-_e.y,Math.sqrt(_e.x*_e.x+_e.z*_e.z))/Math.PI+.5);B.push($e,1-Be)}var _e;(function(){const Ee=new ht,$e=new ht,Be=new ht,Re=new ht,We=new zn,tt=new zn,Ze=new zn;for(let ot=0,st=0;ot<S.length;ot+=9,st+=6){Ee.set(S[ot+0],S[ot+1],S[ot+2]),$e.set(S[ot+3],S[ot+4],S[ot+5]),Be.set(S[ot+6],S[ot+7],S[ot+8]),We.set(B[st+0],B[st+1]),tt.set(B[st+2],B[st+3]),Ze.set(B[st+4],B[st+5]),Re.copy(Ee).add($e).add(Be).divideScalar(3);const Ct=ce(Re);te(We,st+0,Ee,Ct),te(tt,st+2,$e,Ct),te(Ze,st+4,Be,Ct)}})(),function(){for(let Ee=0;Ee<B.length;Ee+=6){const $e=B[Ee+0],Be=B[Ee+2],Re=B[Ee+4],We=Math.max($e,Be,Re),tt=Math.min($e,Be,Re);We>.9&&tt<.1&&($e<.2&&(B[Ee+0]+=1),Be<.2&&(B[Ee+2]+=1),Re<.2&&(B[Ee+4]+=1))}}()}(),this.setAttribute("position",new hn(S,3)),this.setAttribute("normal",new hn(S.slice(),3)),this.setAttribute("uv",new hn(B,2)),0===_?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new au(e.vertices,e.indices,e.radius,e.details)}}class to extends au{constructor(e=1,c=0){const d=(1+Math.sqrt(5))/2,_=1/d;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-d,0,-_,d,0,_,-d,0,_,d,-_,-d,0,-_,d,0,_,-d,0,_,d,0,-d,0,-_,d,0,-_,-d,0,_,d,0,_],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,c),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new to(e.radius,e.detail)}}const Mr=new ht,Yr=new ht,Ou=new ht,ku=new eo;class lu extends br{constructor(e,c){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:c},c=void 0!==c?c:1,!0===e.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const d=Math.pow(10,4),_=Math.cos(Ho*c),S=e.getIndex(),B=e.getAttribute("position"),k=S?S.count:B.count,F=[0,0,0],V=["a","b","c"],te=new Array(3),ce={},ue=[];for(let _e=0;_e<k;_e+=3){S?(F[0]=S.getX(_e),F[1]=S.getX(_e+1),F[2]=S.getX(_e+2)):(F[0]=_e,F[1]=_e+1,F[2]=_e+2);const{a:Ee,b:$e,c:Be}=ku;if(Ee.fromBufferAttribute(B,F[0]),$e.fromBufferAttribute(B,F[1]),Be.fromBufferAttribute(B,F[2]),ku.getNormal(Ou),te[0]=`${Math.round(Ee.x*d)},${Math.round(Ee.y*d)},${Math.round(Ee.z*d)}`,te[1]=`${Math.round($e.x*d)},${Math.round($e.y*d)},${Math.round($e.z*d)}`,te[2]=`${Math.round(Be.x*d)},${Math.round(Be.y*d)},${Math.round(Be.z*d)}`,te[0]!==te[1]&&te[1]!==te[2]&&te[2]!==te[0])for(let Re=0;Re<3;Re++){const We=(Re+1)%3,tt=te[Re],Ze=te[We],ot=ku[V[Re]],st=ku[V[We]],Ct=`${tt}_${Ze}`,Ft=`${Ze}_${tt}`;Ft in ce&&ce[Ft]?(Ou.dot(ce[Ft].normal)<=_&&(ue.push(ot.x,ot.y,ot.z),ue.push(st.x,st.y,st.z)),ce[Ft]=null):Ct in ce||(ce[Ct]={index0:F[Re],index1:F[We],normal:Ou.clone()})}}for(const _e in ce)if(ce[_e]){const{index0:Ee,index1:$e}=ce[_e];Mr.fromBufferAttribute(B,Ee),Yr.fromBufferAttribute(B,$e),ue.push(Mr.x,Mr.y,Mr.z),ue.push(Yr.x,Yr.y,Yr.z)}this.setAttribute("position",new hn(ue,3))}}class Ua{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,c){const d=this.getUtoTmapping(e);return this.getPoint(d,c)}getPoints(e=5){const c=[];for(let d=0;d<=e;d++)c.push(this.getPoint(d/e));return c}getSpacedPoints(e=5){const c=[];for(let d=0;d<=e;d++)c.push(this.getPointAt(d/e));return c}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let d,_=this.getPoint(0),S=0;c.push(0);for(let B=1;B<=e;B++)d=this.getPoint(B/e),S+=d.distanceTo(_),c.push(S),_=d;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,c){const d=this.getLengths();let _=0;const S=d.length;let B;B=c||e*d[S-1];let k,F=0,V=S-1;for(;F<=V;)if(_=Math.floor(F+(V-F)/2),k=d[_]-B,k<0)F=_+1;else{if(!(k>0)){V=_;break}V=_-1}if(_=V,d[_]===B)return _/(S-1);const te=d[_];return(_+(B-te)/(d[_+1]-te))/(S-1)}getTangent(e,c){let _=e-1e-4,S=e+1e-4;_<0&&(_=0),S>1&&(S=1);const B=this.getPoint(_),k=this.getPoint(S),F=c||(B.isVector2?new zn:new ht);return F.copy(k).sub(B).normalize(),F}getTangentAt(e,c){const d=this.getUtoTmapping(e);return this.getTangent(d,c)}computeFrenetFrames(e,c){const d=new ht,_=[],S=[],B=[],k=new ht,F=new tn;for(let _e=0;_e<=e;_e++)_[_e]=this.getTangentAt(_e/e,new ht),_[_e].normalize();S[0]=new ht,B[0]=new ht;let V=Number.MAX_VALUE;const te=Math.abs(_[0].x),ce=Math.abs(_[0].y),ue=Math.abs(_[0].z);te<=V&&(V=te,d.set(1,0,0)),ce<=V&&(V=ce,d.set(0,1,0)),ue<=V&&d.set(0,0,1),k.crossVectors(_[0],d).normalize(),S[0].crossVectors(_[0],k),B[0].crossVectors(_[0],S[0]);for(let _e=1;_e<=e;_e++){if(S[_e]=S[_e-1].clone(),B[_e]=B[_e-1].clone(),k.crossVectors(_[_e-1],_[_e]),k.length()>Number.EPSILON){k.normalize();const Ee=Math.acos(Hr(_[_e-1].dot(_[_e]),-1,1));S[_e].applyMatrix4(F.makeRotationAxis(k,Ee))}B[_e].crossVectors(_[_e],S[_e])}if(!0===c){let _e=Math.acos(Hr(S[0].dot(S[e]),-1,1));_e/=e,_[0].dot(k.crossVectors(S[0],S[e]))>0&&(_e=-_e);for(let Ee=1;Ee<=e;Ee++)S[Ee].applyMatrix4(F.makeRotationAxis(_[Ee],_e*Ee)),B[Ee].crossVectors(_[Ee],S[Ee])}return{tangents:_,normals:S,binormals:B}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Fu extends Ua{constructor(e=0,c=0,d=1,_=1,S=0,B=2*Math.PI,k=!1,F=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=c,this.xRadius=d,this.yRadius=_,this.aStartAngle=S,this.aEndAngle=B,this.aClockwise=k,this.aRotation=F}getPoint(e,c){const d=c||new zn,_=2*Math.PI;let S=this.aEndAngle-this.aStartAngle;const B=Math.abs(S)<Number.EPSILON;for(;S<0;)S+=_;for(;S>_;)S-=_;S<Number.EPSILON&&(S=B?0:_),!0!==this.aClockwise||B||(S===_?S=-_:S-=_);const k=this.aStartAngle+e*S;let F=this.aX+this.xRadius*Math.cos(k),V=this.aY+this.yRadius*Math.sin(k);if(0!==this.aRotation){const te=Math.cos(this.aRotation),ce=Math.sin(this.aRotation),ue=F-this.aX,_e=V-this.aY;F=ue*te-_e*ce+this.aX,V=ue*ce+_e*te+this.aY}return d.set(F,V)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Fu.prototype.isEllipseCurve=!0;class cu extends Fu{constructor(e,c,d,_,S,B){super(e,c,d,d,_,S,B),this.type="ArcCurve"}}function Xn(){let w=0,e=0,c=0,d=0;function _(S,B,k,F){w=S,e=k,c=-3*S+3*B-2*k-F,d=2*S-2*B+k+F}return{initCatmullRom:function(S,B,k,F,V){_(B,k,V*(k-S),V*(F-B))},initNonuniformCatmullRom:function(S,B,k,F,V,te,ce){let ue=(B-S)/V-(k-S)/(V+te)+(k-B)/te,_e=(k-B)/te-(F-B)/(te+ce)+(F-k)/ce;ue*=te,_e*=te,_(B,k,ue,_e)},calc:function(S){const B=S*S;return w+e*S+c*B+d*(B*S)}}}cu.prototype.isArcCurve=!0;const Oi=new ht,Rh=new Xn,Pn=new Xn,Do=new Xn;class Gi extends Ua{constructor(e=[],c=!1,d="centripetal",_=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=c,this.curveType=d,this.tension=_}getPoint(e,c=new ht){const d=c,_=this.points,S=_.length,B=(S-(this.closed?0:1))*e;let k,F,V=Math.floor(B),te=B-V;this.closed?V+=V>0?0:(Math.floor(Math.abs(V)/S)+1)*S:0===te&&V===S-1&&(V=S-2,te=1),this.closed||V>0?k=_[(V-1)%S]:(Oi.subVectors(_[0],_[1]).add(_[0]),k=Oi);const ce=_[V%S],ue=_[(V+1)%S];if(this.closed||V+2<S?F=_[(V+2)%S]:(Oi.subVectors(_[S-1],_[S-2]).add(_[S-1]),F=Oi),"centripetal"===this.curveType||"chordal"===this.curveType){const _e="chordal"===this.curveType?.5:.25;let Ee=Math.pow(k.distanceToSquared(ce),_e),$e=Math.pow(ce.distanceToSquared(ue),_e),Be=Math.pow(ue.distanceToSquared(F),_e);$e<1e-4&&($e=1),Ee<1e-4&&(Ee=$e),Be<1e-4&&(Be=$e),Rh.initNonuniformCatmullRom(k.x,ce.x,ue.x,F.x,Ee,$e,Be),Pn.initNonuniformCatmullRom(k.y,ce.y,ue.y,F.y,Ee,$e,Be),Do.initNonuniformCatmullRom(k.z,ce.z,ue.z,F.z,Ee,$e,Be)}else"catmullrom"===this.curveType&&(Rh.initCatmullRom(k.x,ce.x,ue.x,F.x,this.tension),Pn.initCatmullRom(k.y,ce.y,ue.y,F.y,this.tension),Do.initCatmullRom(k.z,ce.z,ue.z,F.z,this.tension));return d.set(Rh.calc(te),Pn.calc(te),Do.calc(te)),d}copy(e){super.copy(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++)this.points.push(e.points[c].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,d=this.points.length;c<d;c++)e.points.push(this.points[c].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++){const _=e.points[c];this.points.push((new ht).fromArray(_))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Qp(w,e,c,d,_){const S=.5*(d-e),B=.5*(_-c),k=w*w;return(2*c-2*d+S+B)*(w*k)+(-3*c+3*d-2*S-B)*k+S*w+c}function Ph(w,e,c,d){return function(_,S){const B=1-_;return B*B*S}(w,e)+2*(1-(_=w))*_*c+function(_,S){return _*_*S}(w,d);var _}function Du(w,e,c,d,_){return function(S,B){const k=1-S;return k*k*k*B}(w,e)+function(S,B){const k=1-S;return 3*k*k*S*B}(w,c)+3*(1-(S=w))*S*S*d+function(S,B){return S*S*S*B}(w,_);var S}Gi.prototype.isCatmullRomCurve3=!0;class ia extends Ua{constructor(e=new zn,c=new zn,d=new zn,_=new zn){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=c,this.v2=d,this.v3=_}getPoint(e,c=new zn){const d=c,_=this.v0,S=this.v1,B=this.v2,k=this.v3;return d.set(Du(e,_.x,S.x,B.x,k.x),Du(e,_.y,S.y,B.y,k.y)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}ia.prototype.isCubicBezierCurve=!0;class Ki extends Ua{constructor(e=new ht,c=new ht,d=new ht,_=new ht){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=c,this.v2=d,this.v3=_}getPoint(e,c=new ht){const d=c,_=this.v0,S=this.v1,B=this.v2,k=this.v3;return d.set(Du(e,_.x,S.x,B.x,k.x),Du(e,_.y,S.y,B.y,k.y),Du(e,_.z,S.z,B.z,k.z)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Ki.prototype.isCubicBezierCurve3=!0;class oa extends Ua{constructor(e=new zn,c=new zn){super(),this.type="LineCurve",this.v1=e,this.v2=c}getPoint(e,c=new zn){const d=c;return 1===e?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(e).add(this.v1)),d}getPointAt(e,c){return this.getPoint(e,c)}getTangent(e,c){const d=c||new zn;return d.copy(this.v2).sub(this.v1).normalize(),d}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}oa.prototype.isLineCurve=!0;class yl extends Ua{constructor(e=new ht,c=new ht){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=c}getPoint(e,c=new ht){const d=c;return 1===e?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(e).add(this.v1)),d}getPointAt(e,c){return this.getPoint(e,c)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class so extends Ua{constructor(e=new zn,c=new zn,d=new zn){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=c,this.v2=d}getPoint(e,c=new zn){const d=c,_=this.v0,S=this.v1,B=this.v2;return d.set(Ph(e,_.x,S.x,B.x),Ph(e,_.y,S.y,B.y)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}so.prototype.isQuadraticBezierCurve=!0;class Ko extends Ua{constructor(e=new ht,c=new ht,d=new ht){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=c,this.v2=d}getPoint(e,c=new ht){const d=c,_=this.v0,S=this.v1,B=this.v2;return d.set(Ph(e,_.x,S.x,B.x),Ph(e,_.y,S.y,B.y),Ph(e,_.z,S.z,B.z)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ko.prototype.isQuadraticBezierCurve3=!0;class ws extends Ua{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,c=new zn){const d=c,_=this.points,S=(_.length-1)*e,B=Math.floor(S),k=S-B,F=_[0===B?B:B-1],V=_[B],te=_[B>_.length-2?_.length-1:B+1],ce=_[B>_.length-3?_.length-1:B+2];return d.set(Qp(k,F.x,V.x,te.x,ce.x),Qp(k,F.y,V.y,te.y,ce.y)),d}copy(e){super.copy(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++)this.points.push(e.points[c].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,d=this.points.length;c<d;c++)e.points.push(this.points[c].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++){const _=e.points[c];this.points.push((new zn).fromArray(_))}return this}}ws.prototype.isSplineCurve=!0;var ho=Object.freeze({__proto__:null,ArcCurve:cu,CatmullRomCurve3:Gi,CubicBezierCurve:ia,CubicBezierCurve3:Ki,EllipseCurve:Fu,LineCurve:oa,LineCurve3:yl,QuadraticBezierCurve:so,QuadraticBezierCurve3:Ko,SplineCurve:ws});function qo(w,e,c,d,_){let S,B;if(_===function(k,F,V,te){let ce=0;for(let ue=F,_e=V-te;ue<V;ue+=te)ce+=(k[_e]-k[ue])*(k[ue+1]+k[_e+1]),_e=ue;return ce}(w,e,c,d)>0)for(S=e;S<c;S+=d)B=Yd(S,w[S],w[S+1],B);else for(S=c-d;S>=e;S-=d)B=Yd(S,w[S],w[S+1],B);return B&&dh(B,B.next)&&(Ti(B),B=B.next),B}function rs(w,e){if(!w)return w;e||(e=w);let c,d=w;do{if(c=!1,d.steiner||!dh(d,d.next)&&0!==po(d.prev,d,d.next))d=d.next;else{if(Ti(d),d=e=d.prev,d===d.next)break;c=!0}}while(c||d!==e);return e}function Ea(w,e,c,d,_,S,B){if(!w)return;!B&&S&&function(te,ce,ue,_e){let Ee=te;do{null===Ee.z&&(Ee.z=Kp(Ee.x,Ee.y,ce,ue,_e)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next}while(Ee!==te);Ee.prevZ.nextZ=null,Ee.prevZ=null,function($e){let Be,Re,We,tt,Ze,ot,st,Ct,Ft=1;do{for(Re=$e,$e=null,Ze=null,ot=0;Re;){for(ot++,We=Re,st=0,Be=0;Be<Ft&&(st++,We=We.nextZ,We);Be++);for(Ct=Ft;st>0||Ct>0&&We;)0!==st&&(0===Ct||!We||Re.z<=We.z)?(tt=Re,Re=Re.nextZ,st--):(tt=We,We=We.nextZ,Ct--),Ze?Ze.nextZ=tt:$e=tt,tt.prevZ=Ze,Ze=tt;Re=We}Ze.nextZ=null,Ft*=2}while(ot>1)}(Ee)}(w,d,_,S);let k,F,V=w;for(;w.prev!==w.next;)if(k=w.prev,F=w.next,S?ao(w,d,_,S):Ih(w))e.push(k.i/c),e.push(w.i/c),e.push(F.i/c),Ti(w),w=F.next,V=F.next;else if((w=F)===V){B?1===B?Ea(w=Ta(rs(w),e,c),e,c,d,_,S,2):2===B&&xl(w,e,c,d,_,S):Ea(rs(w),e,c,d,_,S,1);break}}function Ih(w){const e=w.prev,c=w,d=w.next;if(po(e,c,d)>=0)return!1;let _=w.next.next;for(;_!==w.prev;){if(Gl(e.x,e.y,c.x,c.y,d.x,d.y,_.x,_.y)&&po(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function ao(w,e,c,d){const _=w.prev,S=w,B=w.next;if(po(_,S,B)>=0)return!1;const V=_.x>S.x?_.x>B.x?_.x:B.x:S.x>B.x?S.x:B.x,te=_.y>S.y?_.y>B.y?_.y:B.y:S.y>B.y?S.y:B.y,ce=Kp(_.x<S.x?_.x<B.x?_.x:B.x:S.x<B.x?S.x:B.x,_.y<S.y?_.y<B.y?_.y:B.y:S.y<B.y?S.y:B.y,e,c,d),ue=Kp(V,te,e,c,d);let _e=w.prevZ,Ee=w.nextZ;for(;_e&&_e.z>=ce&&Ee&&Ee.z<=ue;){if(_e!==w.prev&&_e!==w.next&&Gl(_.x,_.y,S.x,S.y,B.x,B.y,_e.x,_e.y)&&po(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Ee!==w.prev&&Ee!==w.next&&Gl(_.x,_.y,S.x,S.y,B.x,B.y,Ee.x,Ee.y)&&po(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;_e&&_e.z>=ce;){if(_e!==w.prev&&_e!==w.next&&Gl(_.x,_.y,S.x,S.y,B.x,B.y,_e.x,_e.y)&&po(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Ee&&Ee.z<=ue;){if(Ee!==w.prev&&Ee!==w.next&&Gl(_.x,_.y,S.x,S.y,B.x,B.y,Ee.x,Ee.y)&&po(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function Ta(w,e,c){let d=w;do{const _=d.prev,S=d.next.next;!dh(_,S)&&hu(_,d,d.next,S)&&Ss(_,S)&&Ss(S,_)&&(e.push(_.i/c),e.push(d.i/c),e.push(S.i/c),Ti(d),Ti(d.next),d=w=S),d=d.next}while(d!==w);return rs(d)}function xl(w,e,c,d,_,S){let B=w;do{let k=B.next.next;for(;k!==B.prev;){if(B.i!==k.i&&Uu(B,k)){let F=Xd(B,k);return B=rs(B,B.next),F=rs(F,F.next),Ea(B,e,c,d,_,S),void Ea(F,e,c,d,_,S)}k=k.next}B=B.next}while(B!==w)}function uu(w,e){return w.x-e.x}function za(w,e){if(e=function(c,d){let _=d;const S=c.x,B=c.y;let k,F=-1/0;do{if(B<=_.y&&B>=_.next.y&&_.next.y!==_.y){const Ee=_.x+(B-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(Ee<=S&&Ee>F){if(F=Ee,Ee===S){if(B===_.y)return _;if(B===_.next.y)return _.next}k=_.x<_.next.x?_:_.next}}_=_.next}while(_!==d);if(!k)return null;if(S===F)return k;const V=k,te=k.x,ce=k.y;let ue,_e=1/0;_=k;do{S>=_.x&&_.x>=te&&S!==_.x&&Gl(B<ce?S:F,B,te,ce,B<ce?F:S,B,_.x,_.y)&&(ue=Math.abs(B-_.y)/(S-_.x),Ss(_,c)&&(ue<_e||ue===_e&&(_.x>k.x||_.x===k.x&&as(k,_)))&&(k=_,_e=ue)),_=_.next}while(_!==V);return k}(w,e)){const c=Xd(e,w);rs(e,e.next),rs(c,c.next)}}function as(w,e){return po(w.prev,w,e.prev)<0&&po(e.next,w,w.next)<0}function Kp(w,e,c,d,_){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=32767*(w-c)*_)|w<<8))|w<<4))|w<<2))|w<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-d)*_)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wl(w){let e=w,c=w;do{(e.x<c.x||e.x===c.x&&e.y<c.y)&&(c=e),e=e.next}while(e!==w);return c}function Gl(w,e,c,d,_,S,B,k){return(_-B)*(e-k)-(w-B)*(S-k)>=0&&(w-B)*(d-k)-(c-B)*(e-k)>=0&&(c-B)*(S-k)-(_-B)*(d-k)>=0}function Uu(w,e){return w.next.i!==e.i&&w.prev.i!==e.i&&!function(c,d){let _=c;do{if(_.i!==c.i&&_.next.i!==c.i&&_.i!==d.i&&_.next.i!==d.i&&hu(_,_.next,c,d))return!0;_=_.next}while(_!==c);return!1}(w,e)&&(Ss(w,e)&&Ss(e,w)&&function(c,d){let _=c,S=!1;const B=(c.x+d.x)/2,k=(c.y+d.y)/2;do{_.y>k!=_.next.y>k&&_.next.y!==_.y&&B<(_.next.x-_.x)*(k-_.y)/(_.next.y-_.y)+_.x&&(S=!S),_=_.next}while(_!==c);return S}(w,e)&&(po(w.prev,w,e.prev)||po(w,e.prev,e))||dh(w,e)&&po(w.prev,w,w.next)>0&&po(e.prev,e,e.next)>0)}function po(w,e,c){return(e.y-w.y)*(c.x-e.x)-(e.x-w.x)*(c.y-e.y)}function dh(w,e){return w.x===e.x&&w.y===e.y}function hu(w,e,c,d){const _=Hi(po(w,e,c)),S=Hi(po(w,e,d)),B=Hi(po(c,d,w)),k=Hi(po(c,d,e));return _!==S&&B!==k||!(0!==_||!ls(w,c,e))||!(0!==S||!ls(w,d,e))||!(0!==B||!ls(c,w,d))||!(0!==k||!ls(c,e,d))}function ls(w,e,c){return e.x<=Math.max(w.x,c.x)&&e.x>=Math.min(w.x,c.x)&&e.y<=Math.max(w.y,c.y)&&e.y>=Math.min(w.y,c.y)}function Hi(w){return w>0?1:w<0?-1:0}function Ss(w,e){return po(w.prev,w,w.next)<0?po(w,e,w.next)>=0&&po(w,w.prev,e)>=0:po(w,e,w.prev)<0||po(w,w.next,e)<0}function Xd(w,e){const c=new dc(w.i,w.x,w.y),d=new dc(e.i,e.x,e.y),_=w.next,S=e.prev;return w.next=e,e.prev=w,c.next=_,_.prev=c,d.next=c,c.prev=d,S.next=d,d.prev=S,d}function Yd(w,e,c,d){const _=new dc(w,e,c);return d?(_.next=d.next,_.prev=d,d.next.prev=_,d.next=_):(_.prev=_,_.next=_),_}function Ti(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function dc(w,e,c){this.i=w,this.x=e,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Es{static area(e){const c=e.length;let d=0;for(let _=c-1,S=0;S<c;_=S++)d+=e[_].x*e[S].y-e[S].x*e[_].y;return.5*d}static isClockWise(e){return Es.area(e)<0}static triangulateShape(e,c){const d=[],_=[],S=[];ed(e),td(d,e);let B=e.length;c.forEach(ed);for(let F=0;F<c.length;F++)_.push(B),B+=c[F].length,td(d,c[F]);const k=function(F,V,te=2){const ce=V&&V.length,ue=ce?V[0]*te:F.length;let _e=qo(F,0,ue,te,!0);const Ee=[];if(!_e||_e.next===_e.prev)return Ee;let $e,Be,Re,We,tt,Ze,ot;if(ce&&(_e=function(st,Ct,Ft,Qe){const nt=[];let Et,Jt,ct,Lt,_t;for(Et=0,Jt=Ct.length;Et<Jt;Et++)ct=Ct[Et]*Qe,Lt=Et<Jt-1?Ct[Et+1]*Qe:st.length,_t=qo(st,ct,Lt,Qe,!1),_t===_t.next&&(_t.steiner=!0),nt.push(wl(_t));for(nt.sort(uu),Et=0;Et<nt.length;Et++)za(nt[Et],Ft),Ft=rs(Ft,Ft.next);return Ft}(F,V,_e,te)),F.length>80*te){$e=Re=F[0],Be=We=F[1];for(let st=te;st<ue;st+=te)tt=F[st],Ze=F[st+1],tt<$e&&($e=tt),Ze<Be&&(Be=Ze),tt>Re&&(Re=tt),Ze>We&&(We=Ze);ot=Math.max(Re-$e,We-Be),ot=0!==ot?1/ot:0}return Ea(_e,Ee,te,$e,Be,ot),Ee}(d,_);for(let F=0;F<k.length;F+=3)S.push(k.slice(F,F+3));return S}}function ed(w){const e=w.length;e>2&&w[e-1].equals(w[0])&&w.pop()}function td(w,e){for(let c=0;c<e.length;c++)w.push(e[c].x),w.push(e[c].y)}class ja extends br{constructor(e,c){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:c},e=Array.isArray(e)?e:[e];const d=this,_=[],S=[];for(let k=0,F=e.length;k<F;k++)B(e[k]);function B(k){const F=[],V=void 0!==c.curveSegments?c.curveSegments:12,te=void 0!==c.steps?c.steps:1;let ce=void 0!==c.depth?c.depth:100,ue=void 0===c.bevelEnabled||c.bevelEnabled,_e=void 0!==c.bevelThickness?c.bevelThickness:6,Ee=void 0!==c.bevelSize?c.bevelSize:_e-2,$e=void 0!==c.bevelOffset?c.bevelOffset:0,Be=void 0!==c.bevelSegments?c.bevelSegments:3;const Re=c.extrudePath,We=void 0!==c.UVGenerator?c.UVGenerator:pu;void 0!==c.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ce=c.amount);let tt,Ze,ot,st,Ct,Ft=!1;Re&&(tt=Re.getSpacedPoints(te),Ft=!0,ue=!1,Ze=Re.computeFrenetFrames(te,!1),ot=new ht,st=new ht,Ct=new ht),ue||(Be=0,_e=0,Ee=0,$e=0);const Qe=k.extractPoints(V);let nt=Qe.shape;const Et=Qe.holes;if(!Es.isClockWise(nt)){nt=nt.reverse();for(let cn=0,mt=Et.length;cn<mt;cn++){const Kt=Et[cn];Es.isClockWise(Kt)&&(Et[cn]=Kt.reverse())}}const Jt=Es.triangulateShape(nt,Et),ct=nt;for(let cn=0,mt=Et.length;cn<mt;cn++)nt=nt.concat(Et[cn]);function Lt(cn,mt,Kt){return mt||console.error("THREE.ExtrudeGeometry: vec does not exist"),mt.clone().multiplyScalar(Kt).add(cn)}const _t=nt.length,zt=Jt.length;function Rt(cn,mt,Kt){let Vt,vn,Nn;const dr=cn.x-mt.x,_r=cn.y-mt.y,jr=Kt.x-cn.x,ki=Kt.y-cn.y,_o=dr*dr+_r*_r;if(Math.abs(dr*ki-_r*jr)>Number.EPSILON){const zo=Math.sqrt(_o),$a=Math.sqrt(jr*jr+ki*ki),ju=mt.x-_r/zo,Ld=mt.y+dr/zo,Bd=((Kt.x-ki/$a-ju)*ki-(Kt.y+jr/$a-Ld)*jr)/(dr*ki-_r*jr);Vt=ju+dr*Bd-cn.x,vn=Ld+_r*Bd-cn.y;const Oh=Vt*Vt+vn*vn;if(Oh<=2)return new zn(Vt,vn);Nn=Math.sqrt(Oh/2)}else{let zo=!1;dr>Number.EPSILON?jr>Number.EPSILON&&(zo=!0):dr<-Number.EPSILON?jr<-Number.EPSILON&&(zo=!0):Math.sign(_r)===Math.sign(ki)&&(zo=!0),zo?(Vt=-_r,vn=dr,Nn=Math.sqrt(_o)):(Vt=dr,vn=_r,Nn=Math.sqrt(_o/2))}return new zn(Vt/Nn,vn/Nn)}const nn=[];for(let cn=0,mt=ct.length,Kt=mt-1,Vt=cn+1;cn<mt;cn++,Kt++,Vt++)Kt===mt&&(Kt=0),Vt===mt&&(Vt=0),nn[cn]=Rt(ct[cn],ct[Kt],ct[Vt]);const en=[];let En,rt=nn.concat();for(let cn=0,mt=Et.length;cn<mt;cn++){const Kt=Et[cn];En=[];for(let Vt=0,vn=Kt.length,Nn=vn-1,dr=Vt+1;Vt<vn;Vt++,Nn++,dr++)Nn===vn&&(Nn=0),dr===vn&&(dr=0),En[Vt]=Rt(Kt[Vt],Kt[Nn],Kt[dr]);en.push(En),rt=rt.concat(En)}for(let cn=0;cn<Be;cn++){const mt=cn/Be,Kt=_e*Math.cos(mt*Math.PI/2),Vt=Ee*Math.sin(mt*Math.PI/2)+$e;for(let vn=0,Nn=ct.length;vn<Nn;vn++){const dr=Lt(ct[vn],nn[vn],Vt);un(dr.x,dr.y,-Kt)}for(let vn=0,Nn=Et.length;vn<Nn;vn++){const dr=Et[vn];En=en[vn];for(let _r=0,jr=dr.length;_r<jr;_r++){const ki=Lt(dr[_r],En[_r],Vt);un(ki.x,ki.y,-Kt)}}}const ut=Ee+$e;for(let cn=0;cn<_t;cn++){const mt=ue?Lt(nt[cn],rt[cn],ut):nt[cn];Ft?(st.copy(Ze.normals[0]).multiplyScalar(mt.x),ot.copy(Ze.binormals[0]).multiplyScalar(mt.y),Ct.copy(tt[0]).add(st).add(ot),un(Ct.x,Ct.y,Ct.z)):un(mt.x,mt.y,0)}for(let cn=1;cn<=te;cn++)for(let mt=0;mt<_t;mt++){const Kt=ue?Lt(nt[mt],rt[mt],ut):nt[mt];Ft?(st.copy(Ze.normals[cn]).multiplyScalar(Kt.x),ot.copy(Ze.binormals[cn]).multiplyScalar(Kt.y),Ct.copy(tt[cn]).add(st).add(ot),un(Ct.x,Ct.y,Ct.z)):un(Kt.x,Kt.y,ce/te*cn)}for(let cn=Be-1;cn>=0;cn--){const mt=cn/Be,Kt=_e*Math.cos(mt*Math.PI/2),Vt=Ee*Math.sin(mt*Math.PI/2)+$e;for(let vn=0,Nn=ct.length;vn<Nn;vn++){const dr=Lt(ct[vn],nn[vn],Vt);un(dr.x,dr.y,ce+Kt)}for(let vn=0,Nn=Et.length;vn<Nn;vn++){const dr=Et[vn];En=en[vn];for(let _r=0,jr=dr.length;_r<jr;_r++){const ki=Lt(dr[_r],En[_r],Vt);Ft?un(ki.x,ki.y+tt[te-1].y,tt[te-1].x+Kt):un(ki.x,ki.y,ce+Kt)}}}function rn(cn,mt){let Kt=cn.length;for(;--Kt>=0;){const Vt=Kt;let vn=Kt-1;vn<0&&(vn=cn.length-1);for(let Nn=0,dr=te+2*Be;Nn<dr;Nn++){const _r=_t*Nn,jr=_t*(Nn+1);kn(mt+Vt+_r,mt+vn+_r,mt+vn+jr,mt+Vt+jr)}}}function un(cn,mt,Kt){F.push(cn),F.push(mt),F.push(Kt)}function _n(cn,mt,Kt){Jn(cn),Jn(mt),Jn(Kt);const Vt=_.length/3,vn=We.generateTopUV(d,_,Vt-3,Vt-2,Vt-1);Zn(vn[0]),Zn(vn[1]),Zn(vn[2])}function kn(cn,mt,Kt,Vt){Jn(cn),Jn(mt),Jn(Vt),Jn(mt),Jn(Kt),Jn(Vt);const vn=_.length/3,Nn=We.generateSideWallUV(d,_,vn-6,vn-3,vn-2,vn-1);Zn(Nn[0]),Zn(Nn[1]),Zn(Nn[3]),Zn(Nn[1]),Zn(Nn[2]),Zn(Nn[3])}function Jn(cn){_.push(F[3*cn+0]),_.push(F[3*cn+1]),_.push(F[3*cn+2])}function Zn(cn){S.push(cn.x),S.push(cn.y)}(function(){const cn=_.length/3;if(ue){let mt=0,Kt=_t*mt;for(let Vt=0;Vt<zt;Vt++){const vn=Jt[Vt];_n(vn[2]+Kt,vn[1]+Kt,vn[0]+Kt)}mt=te+2*Be,Kt=_t*mt;for(let Vt=0;Vt<zt;Vt++){const vn=Jt[Vt];_n(vn[0]+Kt,vn[1]+Kt,vn[2]+Kt)}}else{for(let mt=0;mt<zt;mt++){const Kt=Jt[mt];_n(Kt[2],Kt[1],Kt[0])}for(let mt=0;mt<zt;mt++){const Kt=Jt[mt];_n(Kt[0]+_t*te,Kt[1]+_t*te,Kt[2]+_t*te)}}d.addGroup(cn,_.length/3-cn,0)})(),function(){const cn=_.length/3;let mt=0;rn(ct,mt),mt+=ct.length;for(let Kt=0,Vt=Et.length;Kt<Vt;Kt++){const vn=Et[Kt];rn(vn,mt),mt+=vn.length}d.addGroup(cn,_.length/3-cn,1)}()}this.setAttribute("position",new hn(_,3)),this.setAttribute("uv",new hn(S,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(c,d,_){if(_.shapes=[],Array.isArray(c))for(let S=0,B=c.length;S<B;S++)_.shapes.push(c[S].uuid);else _.shapes.push(c.uuid);return void 0!==d.extrudePath&&(_.options.extrudePath=d.extrudePath.toJSON()),_}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,c){const d=[];for(let S=0,B=e.shapes.length;S<B;S++)d.push(c[e.shapes[S]]);const _=e.options.extrudePath;return void 0!==_&&(e.options.extrudePath=(new ho[_.type]).fromJSON(_)),new ja(d,e.options)}}const pu={generateTopUV:function(w,e,c,d,_){const k=e[3*d],F=e[3*d+1],V=e[3*_],te=e[3*_+1];return[new zn(e[3*c],e[3*c+1]),new zn(k,F),new zn(V,te)]},generateSideWallUV:function(w,e,c,d,_,S){const B=e[3*c],k=e[3*c+1],F=e[3*c+2],V=e[3*d],te=e[3*d+1],ce=e[3*d+2],ue=e[3*_],_e=e[3*_+1],Ee=e[3*_+2],$e=e[3*S],Be=e[3*S+1],Re=e[3*S+2];return Math.abs(k-te)<Math.abs(B-V)?[new zn(B,1-F),new zn(V,1-ce),new zn(ue,1-Ee),new zn($e,1-Re)]:[new zn(k,1-F),new zn(te,1-ce),new zn(_e,1-Ee),new zn(Be,1-Re)]}};class sp extends au{constructor(e=1,c=0){const d=(1+Math.sqrt(5))/2;super([-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,c),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new sp(e.radius,e.detail)}}class vi extends br{constructor(e,c=12,d=0,_=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:c,phiStart:d,phiLength:_},c=Math.floor(c),_=Hr(_,0,2*Math.PI);const S=[],B=[],k=[],F=1/c,V=new ht,te=new zn;for(let ce=0;ce<=c;ce++){const ue=d+ce*F*_,_e=Math.sin(ue),Ee=Math.cos(ue);for(let $e=0;$e<=e.length-1;$e++)V.x=e[$e].x*_e,V.y=e[$e].y,V.z=e[$e].x*Ee,B.push(V.x,V.y,V.z),te.x=ce/c,te.y=$e/(e.length-1),k.push(te.x,te.y)}for(let ce=0;ce<c;ce++)for(let ue=0;ue<e.length-1;ue++){const _e=ue+ce*e.length,$e=_e+e.length,Be=_e+e.length+1,Re=_e+1;S.push(_e,$e,Re),S.push($e,Be,Re)}if(this.setIndex(S),this.setAttribute("position",new hn(B,3)),this.setAttribute("uv",new hn(k,2)),this.computeVertexNormals(),_===2*Math.PI){const ce=this.attributes.normal.array,ue=new ht,_e=new ht,Ee=new ht,$e=c*e.length*3;for(let Be=0,Re=0;Be<e.length;Be++,Re+=3)ue.x=ce[Re+0],ue.y=ce[Re+1],ue.z=ce[Re+2],_e.x=ce[$e+Re+0],_e.y=ce[$e+Re+1],_e.z=ce[$e+Re+2],Ee.addVectors(ue,_e).normalize(),ce[Re+0]=ce[$e+Re+0]=Ee.x,ce[Re+1]=ce[$e+Re+1]=Ee.y,ce[Re+2]=ce[$e+Re+2]=Ee.z}}static fromJSON(e){return new vi(e.points,e.segments,e.phiStart,e.phiLength)}}class xr extends au{constructor(e=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,c),this.type="OctahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new xr(e.radius,e.detail)}}class a extends br{constructor(e,c,d){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:c,stacks:d};const _=[],S=[],B=[],k=[],F=1e-5,V=new ht,te=new ht,ce=new ht,ue=new ht,_e=new ht;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const Ee=c+1;for(let $e=0;$e<=d;$e++){const Be=$e/d;for(let Re=0;Re<=c;Re++){const We=Re/c;e(We,Be,te),S.push(te.x,te.y,te.z),We-F>=0?(e(We-F,Be,ce),ue.subVectors(te,ce)):(e(We+F,Be,ce),ue.subVectors(ce,te)),Be-F>=0?(e(We,Be-F,ce),_e.subVectors(te,ce)):(e(We,Be+F,ce),_e.subVectors(ce,te)),V.crossVectors(ue,_e).normalize(),B.push(V.x,V.y,V.z),k.push(We,Be)}}for(let $e=0;$e<d;$e++)for(let Be=0;Be<c;Be++){const We=$e*Ee+Be+1,tt=($e+1)*Ee+Be+1,Ze=($e+1)*Ee+Be;_.push($e*Ee+Be,We,Ze),_.push(We,tt,Ze)}this.setIndex(_),this.setAttribute("position",new hn(S,3)),this.setAttribute("normal",new hn(B,3)),this.setAttribute("uv",new hn(k,2))}}class r extends br{constructor(e=.5,c=1,d=8,_=1,S=0,B=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:c,thetaSegments:d,phiSegments:_,thetaStart:S,thetaLength:B},d=Math.max(3,d);const k=[],F=[],V=[],te=[];let ce=e;const ue=(c-e)/(_=Math.max(1,_)),_e=new ht,Ee=new zn;for(let $e=0;$e<=_;$e++){for(let Be=0;Be<=d;Be++){const Re=S+Be/d*B;_e.x=ce*Math.cos(Re),_e.y=ce*Math.sin(Re),F.push(_e.x,_e.y,_e.z),V.push(0,0,1),Ee.x=(_e.x/c+1)/2,Ee.y=(_e.y/c+1)/2,te.push(Ee.x,Ee.y)}ce+=ue}for(let $e=0;$e<_;$e++){const Be=$e*(d+1);for(let Re=0;Re<d;Re++){const We=Re+Be,Ze=We+d+1,ot=We+d+2,st=We+1;k.push(We,Ze,st),k.push(Ze,ot,st)}}this.setIndex(k),this.setAttribute("position",new hn(F,3)),this.setAttribute("normal",new hn(V,3)),this.setAttribute("uv",new hn(te,2))}static fromJSON(e){return new r(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class h extends br{constructor(e,c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:c};const d=[],_=[],S=[],B=[];let k=0,F=0;if(!1===Array.isArray(e))V(e);else for(let te=0;te<e.length;te++)V(e[te]),this.addGroup(k,F,te),k+=F,F=0;function V(te){const ce=_.length/3,ue=te.extractPoints(c);let _e=ue.shape;const Ee=ue.holes;!1===Es.isClockWise(_e)&&(_e=_e.reverse());for(let Be=0,Re=Ee.length;Be<Re;Be++){const We=Ee[Be];!0===Es.isClockWise(We)&&(Ee[Be]=We.reverse())}const $e=Es.triangulateShape(_e,Ee);for(let Be=0,Re=Ee.length;Be<Re;Be++)_e=_e.concat(Ee[Be]);for(let Be=0,Re=_e.length;Be<Re;Be++){const We=_e[Be];_.push(We.x,We.y,0),S.push(0,0,1),B.push(We.x,We.y)}for(let Be=0,Re=$e.length;Be<Re;Be++){const We=$e[Be];d.push(We[0]+ce,We[1]+ce,We[2]+ce),F+=3}}this.setIndex(d),this.setAttribute("position",new hn(_,3)),this.setAttribute("normal",new hn(S,3)),this.setAttribute("uv",new hn(B,2))}toJSON(){const e=super.toJSON();return function(c,d){if(d.shapes=[],Array.isArray(c))for(let _=0,S=c.length;_<S;_++)d.shapes.push(c[_].uuid);else d.shapes.push(c.uuid);return d}(this.parameters.shapes,e)}static fromJSON(e,c){const d=[];for(let _=0,S=e.shapes.length;_<S;_++)d.push(c[e.shapes[_]]);return new h(d,e.curveSegments)}}class p extends br{constructor(e=1,c=32,d=16,_=0,S=2*Math.PI,B=0,k=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:c,heightSegments:d,phiStart:_,phiLength:S,thetaStart:B,thetaLength:k},c=Math.max(3,Math.floor(c)),d=Math.max(2,Math.floor(d));const F=Math.min(B+k,Math.PI);let V=0;const te=[],ce=new ht,ue=new ht,_e=[],Ee=[],$e=[],Be=[];for(let Re=0;Re<=d;Re++){const We=[],tt=Re/d;let Ze=0;0==Re&&0==B?Ze=.5/c:Re==d&&F==Math.PI&&(Ze=-.5/c);for(let ot=0;ot<=c;ot++){const st=ot/c;ce.x=-e*Math.cos(_+st*S)*Math.sin(B+tt*k),ce.y=e*Math.cos(B+tt*k),ce.z=e*Math.sin(_+st*S)*Math.sin(B+tt*k),Ee.push(ce.x,ce.y,ce.z),ue.copy(ce).normalize(),$e.push(ue.x,ue.y,ue.z),Be.push(st+Ze,1-tt),We.push(V++)}te.push(We)}for(let Re=0;Re<d;Re++)for(let We=0;We<c;We++){const Ze=te[Re][We],ot=te[Re+1][We],st=te[Re+1][We+1];(0!==Re||B>0)&&_e.push(te[Re][We+1],Ze,st),(Re!==d-1||F<Math.PI)&&_e.push(Ze,ot,st)}this.setIndex(_e),this.setAttribute("position",new hn(Ee,3)),this.setAttribute("normal",new hn($e,3)),this.setAttribute("uv",new hn(Be,2))}static fromJSON(e){return new p(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class y extends au{constructor(e=1,c=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,c),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new y(e.radius,e.detail)}}class b extends ja{constructor(e,c={}){const d=c.font;if(!d||!d.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new br;const _=d.generateShapes(e,c.size);c.depth=void 0!==c.height?c.height:50,void 0===c.bevelThickness&&(c.bevelThickness=10),void 0===c.bevelSize&&(c.bevelSize=8),void 0===c.bevelEnabled&&(c.bevelEnabled=!1),super(_,c),this.type="TextGeometry"}}class R extends br{constructor(e=1,c=.4,d=8,_=6,S=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:c,radialSegments:d,tubularSegments:_,arc:S},d=Math.floor(d),_=Math.floor(_);const B=[],k=[],F=[],V=[],te=new ht,ce=new ht,ue=new ht;for(let _e=0;_e<=d;_e++)for(let Ee=0;Ee<=_;Ee++){const $e=Ee/_*S,Be=_e/d*Math.PI*2;ce.x=(e+c*Math.cos(Be))*Math.cos($e),ce.y=(e+c*Math.cos(Be))*Math.sin($e),ce.z=c*Math.sin(Be),k.push(ce.x,ce.y,ce.z),te.x=e*Math.cos($e),te.y=e*Math.sin($e),ue.subVectors(ce,te).normalize(),F.push(ue.x,ue.y,ue.z),V.push(Ee/_),V.push(_e/d)}for(let _e=1;_e<=d;_e++)for(let Ee=1;Ee<=_;Ee++){const Be=(_+1)*(_e-1)+Ee-1,Re=(_+1)*(_e-1)+Ee,We=(_+1)*_e+Ee;B.push((_+1)*_e+Ee-1,Be,We),B.push(Be,Re,We)}this.setIndex(B),this.setAttribute("position",new hn(k,3)),this.setAttribute("normal",new hn(F,3)),this.setAttribute("uv",new hn(V,2))}static fromJSON(e){return new R(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class O extends br{constructor(e=1,c=.4,d=64,_=8,S=2,B=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:c,tubularSegments:d,radialSegments:_,p:S,q:B},d=Math.floor(d),_=Math.floor(_);const k=[],F=[],V=[],te=[],ce=new ht,ue=new ht,_e=new ht,Ee=new ht,$e=new ht,Be=new ht,Re=new ht;for(let tt=0;tt<=d;++tt){const Ze=tt/d*S*Math.PI*2;We(Ze,S,B,e,_e),We(Ze+.01,S,B,e,Ee),Be.subVectors(Ee,_e),Re.addVectors(Ee,_e),$e.crossVectors(Be,Re),Re.crossVectors($e,Be),$e.normalize(),Re.normalize();for(let ot=0;ot<=_;++ot){const st=ot/_*Math.PI*2,Ct=-c*Math.cos(st),Ft=c*Math.sin(st);ce.x=_e.x+(Ct*Re.x+Ft*$e.x),ce.y=_e.y+(Ct*Re.y+Ft*$e.y),ce.z=_e.z+(Ct*Re.z+Ft*$e.z),F.push(ce.x,ce.y,ce.z),ue.subVectors(ce,_e).normalize(),V.push(ue.x,ue.y,ue.z),te.push(tt/d),te.push(ot/_)}}for(let tt=1;tt<=d;tt++)for(let Ze=1;Ze<=_;Ze++){const st=(_+1)*tt+(Ze-1),Ct=(_+1)*tt+Ze,Ft=(_+1)*(tt-1)+Ze;k.push((_+1)*(tt-1)+(Ze-1),st,Ft),k.push(st,Ct,Ft)}function We(tt,Ze,ot,st,Ct){const Ft=Math.cos(tt),Qe=Math.sin(tt),nt=ot/Ze*tt,Et=Math.cos(nt);Ct.x=st*(2+Et)*.5*Ft,Ct.y=st*(2+Et)*Qe*.5,Ct.z=st*Math.sin(nt)*.5}this.setIndex(k),this.setAttribute("position",new hn(F,3)),this.setAttribute("normal",new hn(V,3)),this.setAttribute("uv",new hn(te,2))}static fromJSON(e){return new O(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class T extends br{constructor(e,c=64,d=1,_=8,S=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:c,radius:d,radialSegments:_,closed:S};const B=e.computeFrenetFrames(c,S);this.tangents=B.tangents,this.normals=B.normals,this.binormals=B.binormals;const k=new ht,F=new ht,V=new zn;let te=new ht;const ce=[],ue=[],_e=[],Ee=[];function $e(Be){te=e.getPointAt(Be/c,te);const Re=B.normals[Be],We=B.binormals[Be];for(let tt=0;tt<=_;tt++){const Ze=tt/_*Math.PI*2,ot=Math.sin(Ze),st=-Math.cos(Ze);F.x=st*Re.x+ot*We.x,F.y=st*Re.y+ot*We.y,F.z=st*Re.z+ot*We.z,F.normalize(),ue.push(F.x,F.y,F.z),k.x=te.x+d*F.x,k.y=te.y+d*F.y,k.z=te.z+d*F.z,ce.push(k.x,k.y,k.z)}}(function(){for(let Be=0;Be<c;Be++)$e(Be);$e(!1===S?c:0),function(){for(let Be=0;Be<=c;Be++)for(let Re=0;Re<=_;Re++)V.x=Be/c,V.y=Re/_,_e.push(V.x,V.y)}(),function(){for(let Be=1;Be<=c;Be++)for(let Re=1;Re<=_;Re++){const tt=(_+1)*Be+(Re-1),Ze=(_+1)*Be+Re,ot=(_+1)*(Be-1)+Re;Ee.push((_+1)*(Be-1)+(Re-1),tt,ot),Ee.push(tt,Ze,ot)}}()})(),this.setIndex(Ee),this.setAttribute("position",new hn(ce,3)),this.setAttribute("normal",new hn(ue,3)),this.setAttribute("uv",new hn(_e,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new T((new ho[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class U extends br{constructor(e){if(super(),this.type="WireframeGeometry",!0===e.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const c=[],d=new Set,_=new ht,S=new ht;if(null!==e.index){const B=e.attributes.position,k=e.index;let F=e.groups;0===F.length&&(F=[{start:0,count:k.count,materialIndex:0}]);for(let V=0,te=F.length;V<te;++V){const ce=F[V],ue=ce.start;for(let _e=ue,Ee=ue+ce.count;_e<Ee;_e+=3)for(let $e=0;$e<3;$e++){const Be=k.getX(_e+$e),Re=k.getX(_e+($e+1)%3);_.fromBufferAttribute(B,Be),S.fromBufferAttribute(B,Re),!0===ee(_,S,d)&&(c.push(_.x,_.y,_.z),c.push(S.x,S.y,S.z))}}}else{const B=e.attributes.position;for(let k=0,F=B.count/3;k<F;k++)for(let V=0;V<3;V++){const ce=3*k+(V+1)%3;_.fromBufferAttribute(B,3*k+V),S.fromBufferAttribute(B,ce),!0===ee(_,S,d)&&(c.push(_.x,_.y,_.z),c.push(S.x,S.y,S.z))}}this.setAttribute("position",new hn(c,3))}}function ee(w,e,c){const d=`${w.x},${w.y},${w.z}-${e.x},${e.y},${e.z}`,_=`${e.x},${e.y},${e.z}-${w.x},${w.y},${w.z}`;return!0!==c.has(d)&&!0!==c.has(_)&&(c.add(d,_),!0)}var ie=Object.freeze({__proto__:null,BoxGeometry:tc,BoxBufferGeometry:tc,CircleGeometry:su,CircleBufferGeometry:su,ConeGeometry:Zp,ConeBufferGeometry:Zp,CylinderGeometry:rl,CylinderBufferGeometry:rl,DodecahedronGeometry:to,DodecahedronBufferGeometry:to,EdgesGeometry:lu,ExtrudeGeometry:ja,ExtrudeBufferGeometry:ja,IcosahedronGeometry:sp,IcosahedronBufferGeometry:sp,LatheGeometry:vi,LatheBufferGeometry:vi,OctahedronGeometry:xr,OctahedronBufferGeometry:xr,ParametricGeometry:a,ParametricBufferGeometry:a,PlaneGeometry:Eu,PlaneBufferGeometry:Eu,PolyhedronGeometry:au,PolyhedronBufferGeometry:au,RingGeometry:r,RingBufferGeometry:r,ShapeGeometry:h,ShapeBufferGeometry:h,SphereGeometry:p,SphereBufferGeometry:p,TetrahedronGeometry:y,TetrahedronBufferGeometry:y,TextGeometry:b,TextBufferGeometry:b,TorusGeometry:R,TorusBufferGeometry:R,TorusKnotGeometry:O,TorusKnotBufferGeometry:O,TubeGeometry:T,TubeBufferGeometry:T,WireframeGeometry:U});class ne extends Cs{constructor(e){super(),this.type="ShadowMaterial",this.color=new er(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}ne.prototype.isShadowMaterial=!0;class ve extends Cs{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new er(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new er(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}ve.prototype.isMeshStandardMaterial=!0;class be extends ve{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenTint=new er(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new er(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new er(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}be.prototype.isMeshPhysicalMaterial=!0;class Te extends Cs{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new er(16777215),this.specular=new er(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new er(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Te.prototype.isMeshPhongMaterial=!0;class Le extends Cs{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new er(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new er(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Le.prototype.isMeshToonMaterial=!0;class Ie extends Cs{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Ie.prototype.isMeshNormalMaterial=!0;class Oe extends Cs{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new er(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new er(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Oe.prototype.isMeshLambertMaterial=!0;class Fe extends Cs{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new er(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Fe.prototype.isMeshMatcapMaterial=!0;class je extends kt{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}je.prototype.isLineDashedMaterial=!0;var Ue=Object.freeze({__proto__:null,ShadowMaterial:ne,SpriteMaterial:Jp,RawShaderMaterial:Mu,ShaderMaterial:Ps,PointsMaterial:gi,MeshPhysicalMaterial:be,MeshStandardMaterial:ve,MeshPhongMaterial:Te,MeshToonMaterial:Le,MeshNormalMaterial:Ie,MeshLambertMaterial:Oe,MeshDepthMaterial:Vd,MeshDistanceMaterial:Op,MeshBasicMaterial:fl,MeshMatcapMaterial:Fe,LineDashedMaterial:je,LineBasicMaterial:kt,Material:Cs});const Je={arraySlice:function(w,e,c){return Je.isTypedArray(w)?new w.constructor(w.subarray(e,void 0!==c?c:w.length)):w.slice(e,c)},convertArray:function(w,e,c){return!w||!c&&w.constructor===e?w:"number"==typeof e.BYTES_PER_ELEMENT?new e(w):Array.prototype.slice.call(w)},isTypedArray:function(w){return ArrayBuffer.isView(w)&&!(w instanceof DataView)},getKeyframeOrder:function(w){const e=w.length,c=new Array(e);for(let d=0;d!==e;++d)c[d]=d;return c.sort(function(d,_){return w[d]-w[_]}),c},sortedArray:function(w,e,c){const d=w.length,_=new w.constructor(d);for(let S=0,B=0;B!==d;++S){const k=c[S]*e;for(let F=0;F!==e;++F)_[B++]=w[k+F]}return _},flattenJSON:function(w,e,c,d){let _=1,S=w[0];for(;void 0!==S&&void 0===S[d];)S=w[_++];if(void 0===S)return;let B=S[d];if(void 0!==B)if(Array.isArray(B))do{B=S[d],void 0!==B&&(e.push(S.time),c.push.apply(c,B)),S=w[_++]}while(void 0!==S);else if(void 0!==B.toArray)do{B=S[d],void 0!==B&&(e.push(S.time),B.toArray(c,c.length)),S=w[_++]}while(void 0!==S);else do{B=S[d],void 0!==B&&(e.push(S.time),c.push(B)),S=w[_++]}while(void 0!==S)},subclip:function(w,e,c,d,_=30){const S=w.clone();S.name=e;const B=[];for(let F=0;F<S.tracks.length;++F){const V=S.tracks[F],te=V.getValueSize(),ce=[],ue=[];for(let _e=0;_e<V.times.length;++_e){const Ee=V.times[_e]*_;if(!(Ee<c||Ee>=d)){ce.push(V.times[_e]);for(let $e=0;$e<te;++$e)ue.push(V.values[_e*te+$e])}}0!==ce.length&&(V.times=Je.convertArray(ce,V.times.constructor),V.values=Je.convertArray(ue,V.values.constructor),B.push(V))}S.tracks=B;let k=1/0;for(let F=0;F<S.tracks.length;++F)k>S.tracks[F].times[0]&&(k=S.tracks[F].times[0]);for(let F=0;F<S.tracks.length;++F)S.tracks[F].shift(-1*k);return S.resetDuration(),S},makeClipAdditive:function(w,e=0,c=w,d=30){d<=0&&(d=30);const _=c.tracks.length,S=e/d;for(let B=0;B<_;++B){const k=c.tracks[B],F=k.ValueTypeName;if("bool"===F||"string"===F)continue;const V=w.tracks.find(function(Re){return Re.name===k.name&&Re.ValueTypeName===F});if(void 0===V)continue;let te=0;const ce=k.getValueSize();k.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(te=ce/3);let ue=0;const _e=V.getValueSize();V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ue=_e/3);const Ee=k.times.length-1;let $e;if(S<=k.times[0])$e=Je.arraySlice(k.values,te,ce-te);else if(S>=k.times[Ee]){const Re=Ee*ce+te;$e=Je.arraySlice(k.values,Re,Re+ce-te)}else{const Re=k.createInterpolant(),We=te,tt=ce-te;Re.evaluate(S),$e=Je.arraySlice(Re.resultBuffer,We,tt)}"quaternion"===F&&(new $i).fromArray($e).normalize().conjugate().toArray($e);const Be=V.times.length;for(let Re=0;Re<Be;++Re){const We=Re*_e+ue;if("quaternion"===F)$i.multiplyQuaternionsFlat(V.values,We,$e,0,V.values,We);else{const tt=_e-2*ue;for(let Ze=0;Ze<tt;++Ze)V.values[We+Ze]-=$e[Ze]}}}return w.blendMode=th,w}};class pt{constructor(e,c,d,_){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==_?_:new c.constructor(d),this.sampleValues=c,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(e){const c=this.parameterPositions;let d=this._cachedIndex,_=c[d],S=c[d-1];e:{t:{let B;n:{r:if(!(e<_)){for(let k=d+2;;){if(void 0===_){if(e<S)break r;return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,e,S)}if(d===k)break;if(S=_,_=c[++d],e<_)break t}B=c.length;break n}if(e>=S)break e;{const k=c[1];e<k&&(d=2,S=k);for(let F=d-2;;){if(void 0===S)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(d===F)break;if(_=S,S=c[--d-1],e>=S)break t}B=d,d=0}}for(;d<B;){const k=d+B>>>1;e<c[k]?B=k:d=k+1}if(_=c[d],S=c[d-1],void 0===S)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(void 0===_)return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,S,e)}this._cachedIndex=d,this.intervalChanged_(d,S,_)}return this.interpolate_(d,S,e,_)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const c=this.resultBuffer,d=this.sampleValues,_=this.valueSize,S=e*_;for(let B=0;B!==_;++B)c[B]=d[S+B];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}pt.prototype.beforeStart_=pt.prototype.copySampleValue_,pt.prototype.afterEnd_=pt.prototype.copySampleValue_;class at extends pt{constructor(e,c,d,_){super(e,c,d,_),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:La,endingEnd:La}}intervalChanged_(e,c,d){const _=this.parameterPositions;let S=e-2,B=e+1,k=_[S],F=_[B];if(void 0===k)switch(this.getSettings_().endingStart){case pa:S=e,k=2*c-d;break;case Al:S=_.length-2,k=c+_[S]-_[S+1];break;default:S=e,k=d}if(void 0===F)switch(this.getSettings_().endingEnd){case pa:B=e,F=2*d-c;break;case Al:B=1,F=d+_[1]-_[0];break;default:B=e-1,F=c}const V=.5*(d-c),te=this.valueSize;this._weightPrev=V/(c-k),this._weightNext=V/(F-d),this._offsetPrev=S*te,this._offsetNext=B*te}interpolate_(e,c,d,_){const S=this.resultBuffer,B=this.sampleValues,k=this.valueSize,F=e*k,V=F-k,te=this._offsetPrev,ce=this._offsetNext,ue=this._weightPrev,_e=this._weightNext,Ee=(d-c)/(_-c),$e=Ee*Ee,Be=$e*Ee,Re=-ue*Be+2*ue*$e-ue*Ee,We=(1+ue)*Be+(-1.5-2*ue)*$e+(-.5+ue)*Ee+1,tt=(-1-_e)*Be+(1.5+_e)*$e+.5*Ee,Ze=_e*Be-_e*$e;for(let ot=0;ot!==k;++ot)S[ot]=Re*B[te+ot]+We*B[V+ot]+tt*B[F+ot]+Ze*B[ce+ot];return S}}class Mt extends pt{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e,c,d,_){const S=this.resultBuffer,B=this.sampleValues,k=this.valueSize,F=e*k,V=F-k,te=(d-c)/(_-c),ce=1-te;for(let ue=0;ue!==k;++ue)S[ue]=B[V+ue]*ce+B[F+ue]*te;return S}}class Tt extends pt{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e){return this.copySampleValue_(e-1)}}class Yt{constructor(e,c,d,_){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Je.convertArray(c,this.TimeBufferType),this.values=Je.convertArray(d,this.ValueBufferType),this.setInterpolation(_||this.DefaultInterpolation)}static toJSON(e){const c=e.constructor;let d;if(c.toJSON!==this.toJSON)d=c.toJSON(e);else{d={name:e.name,times:Je.convertArray(e.times,Array),values:Je.convertArray(e.values,Array)};const _=e.getInterpolation();_!==e.DefaultInterpolation&&(d.interpolation=_)}return d.type=e.ValueTypeName,d}InterpolantFactoryMethodDiscrete(e){return new Tt(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Mt(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new at(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let c;switch(e){case Jl:c=this.InterpolantFactoryMethodDiscrete;break;case Zl:c=this.InterpolantFactoryMethodLinear;break;case Ku:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jl;case this.InterpolantFactoryMethodLinear:return Zl;case this.InterpolantFactoryMethodSmooth:return Ku}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const c=this.times;for(let d=0,_=c.length;d!==_;++d)c[d]+=e}return this}scale(e){if(1!==e){const c=this.times;for(let d=0,_=c.length;d!==_;++d)c[d]*=e}return this}trim(e,c){const d=this.times,_=d.length;let S=0,B=_-1;for(;S!==_&&d[S]<e;)++S;for(;-1!==B&&d[B]>c;)--B;if(++B,0!==S||B!==_){S>=B&&(B=Math.max(B,1),S=B-1);const k=this.getValueSize();this.times=Je.arraySlice(d,S,B),this.values=Je.arraySlice(this.values,S*k,B*k)}return this}validate(){let e=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const d=this.times,_=this.values,S=d.length;0===S&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let B=null;for(let k=0;k!==S;k++){const F=d[k];if("number"==typeof F&&isNaN(F)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,k,F),e=!1;break}if(null!==B&&B>F){console.error("THREE.KeyframeTrack: Out of order keys.",this,k,F,B),e=!1;break}B=F}if(void 0!==_&&Je.isTypedArray(_))for(let k=0,F=_.length;k!==F;++k){const V=_[k];if(isNaN(V)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,k,V),e=!1;break}}return e}optimize(){const e=Je.arraySlice(this.times),c=Je.arraySlice(this.values),d=this.getValueSize(),_=this.getInterpolation()===Ku,S=e.length-1;let B=1;for(let k=1;k<S;++k){let F=!1;const V=e[k];if(V!==e[k+1]&&(1!==k||V!==e[0]))if(_)F=!0;else{const te=k*d,ce=te-d,ue=te+d;for(let _e=0;_e!==d;++_e){const Ee=c[te+_e];if(Ee!==c[ce+_e]||Ee!==c[ue+_e]){F=!0;break}}}if(F){if(k!==B){e[B]=e[k];const te=k*d,ce=B*d;for(let ue=0;ue!==d;++ue)c[ce+ue]=c[te+ue]}++B}}if(S>0){e[B]=e[S];for(let k=S*d,F=B*d,V=0;V!==d;++V)c[F+V]=c[k+V];++B}return B!==e.length?(this.times=Je.arraySlice(e,0,B),this.values=Je.arraySlice(c,0,B*d)):(this.times=e,this.values=c),this}clone(){const e=Je.arraySlice(this.times,0),c=Je.arraySlice(this.values,0),d=new this.constructor(this.name,e,c);return d.createInterpolant=this.createInterpolant,d}}Yt.prototype.TimeBufferType=Float32Array,Yt.prototype.ValueBufferType=Float32Array,Yt.prototype.DefaultInterpolation=Zl;class jt extends Yt{}jt.prototype.ValueTypeName="bool",jt.prototype.ValueBufferType=Array,jt.prototype.DefaultInterpolation=Jl,jt.prototype.InterpolantFactoryMethodLinear=void 0,jt.prototype.InterpolantFactoryMethodSmooth=void 0;class It extends Yt{}It.prototype.ValueTypeName="color";class Nt extends Yt{}Nt.prototype.ValueTypeName="number";class ft extends pt{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e,c,d,_){const S=this.resultBuffer,B=this.sampleValues,k=this.valueSize,F=(d-c)/(_-c);let V=e*k;for(let te=V+k;V!==te;V+=4)$i.slerpFlat(S,0,B,V-k,B,V,F);return S}}class $t extends Yt{InterpolantFactoryMethodLinear(e){return new ft(this.times,this.values,this.getValueSize(),e)}}$t.prototype.ValueTypeName="quaternion",$t.prototype.DefaultInterpolation=Zl,$t.prototype.InterpolantFactoryMethodSmooth=void 0;class Zt extends Yt{}Zt.prototype.ValueTypeName="string",Zt.prototype.ValueBufferType=Array,Zt.prototype.DefaultInterpolation=Jl,Zt.prototype.InterpolantFactoryMethodLinear=void 0,Zt.prototype.InterpolantFactoryMethodSmooth=void 0;class Tn extends Yt{}Tn.prototype.ValueTypeName="vector";class $n{constructor(e,c=-1,d,_=eh){this.name=e,this.tracks=d,this.duration=c,this.blendMode=_,this.uuid=Qi(),this.duration<0&&this.resetDuration()}static parse(e){const c=[],d=e.tracks,_=1/(e.fps||1);for(let B=0,k=d.length;B!==k;++B)c.push(Qn(d[B]).scale(_));const S=new this(e.name,e.duration,c,e.blendMode);return S.uuid=e.uuid,S}static toJSON(e){const c=[],d=e.tracks,_={name:e.name,duration:e.duration,tracks:c,uuid:e.uuid,blendMode:e.blendMode};for(let S=0,B=d.length;S!==B;++S)c.push(Yt.toJSON(d[S]));return _}static CreateFromMorphTargetSequence(e,c,d,_){const S=c.length,B=[];for(let k=0;k<S;k++){let F=[],V=[];F.push((k+S-1)%S,k,(k+1)%S),V.push(0,1,0);const te=Je.getKeyframeOrder(F);F=Je.sortedArray(F,1,te),V=Je.sortedArray(V,1,te),_||0!==F[0]||(F.push(S),V.push(V[0])),B.push(new Nt(".morphTargetInfluences["+c[k].name+"]",F,V).scale(1/d))}return new this(e,-1,B)}static findByName(e,c){let d=e;Array.isArray(e)||(d=e.geometry&&e.geometry.animations||e.animations);for(let _=0;_<d.length;_++)if(d[_].name===c)return d[_];return null}static CreateClipsFromMorphTargetSequences(e,c,d){const _={},S=/^([\w-]*?)([\d]+)$/;for(let k=0,F=e.length;k<F;k++){const V=e[k],te=V.name.match(S);if(te&&te.length>1){const ce=te[1];let ue=_[ce];ue||(_[ce]=ue=[]),ue.push(V)}}const B=[];for(const k in _)B.push(this.CreateFromMorphTargetSequence(k,_[k],c,d));return B}static parseAnimation(e,c){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(te,ce,ue,_e,Ee){if(0!==ue.length){const $e=[],Be=[];Je.flattenJSON(ue,$e,Be,_e),0!==$e.length&&Ee.push(new te(ce,$e,Be))}},_=[],S=e.name||"default",B=e.fps||30,k=e.blendMode;let F=e.length||-1;const V=e.hierarchy||[];for(let te=0;te<V.length;te++){const ce=V[te].keys;if(ce&&0!==ce.length)if(ce[0].morphTargets){const ue={};let _e;for(_e=0;_e<ce.length;_e++)if(ce[_e].morphTargets)for(let Ee=0;Ee<ce[_e].morphTargets.length;Ee++)ue[ce[_e].morphTargets[Ee]]=-1;for(const Ee in ue){const $e=[],Be=[];for(let Re=0;Re!==ce[_e].morphTargets.length;++Re){const We=ce[_e];$e.push(We.time),Be.push(We.morphTarget===Ee?1:0)}_.push(new Nt(".morphTargetInfluence["+Ee+"]",$e,Be))}F=ue.length*(B||1)}else{const ue=".bones["+c[te].name+"]";d(Tn,ue+".position",ce,"pos",_),d($t,ue+".quaternion",ce,"rot",_),d(Tn,ue+".scale",ce,"scl",_)}}return 0===_.length?null:new this(S,F,_,k)}resetDuration(){let e=0;for(let c=0,d=this.tracks.length;c!==d;++c){const _=this.tracks[c];e=Math.max(e,_.times[_.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let c=0;c<this.tracks.length;c++)e=e&&this.tracks[c].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let c=0;c<this.tracks.length;c++)e.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Qn(w){if(void 0===w.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Nt;case"vector":case"vector2":case"vector3":case"vector4":return Tn;case"color":return It;case"quaternion":return $t;case"bool":case"boolean":return jt;case"string":return Zt}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(w.type);if(void 0===w.times){const c=[],d=[];Je.flattenJSON(w.keys,c,d,"value"),w.times=c,w.values=d}return void 0!==e.parse?e.parse(w):new e(w.name,w.times,w.values,w.interpolation)}const lr={enabled:!1,files:{},add:function(w,e){!1!==this.enabled&&(this.files[w]=e)},get:function(w){if(!1!==this.enabled)return this.files[w]},remove:function(w){delete this.files[w]},clear:function(){this.files={}}};class jn{constructor(e,c,d){const _=this;let S,B=!1,k=0,F=0;const V=[];this.onStart=void 0,this.onLoad=e,this.onProgress=c,this.onError=d,this.itemStart=function(te){F++,!1===B&&void 0!==_.onStart&&_.onStart(te,k,F),B=!0},this.itemEnd=function(te){k++,void 0!==_.onProgress&&_.onProgress(te,k,F),k===F&&(B=!1,void 0!==_.onLoad&&_.onLoad())},this.itemError=function(te){void 0!==_.onError&&_.onError(te)},this.resolveURL=function(te){return S?S(te):te},this.setURLModifier=function(te){return S=te,this},this.addHandler=function(te,ce){return V.push(te,ce),this},this.removeHandler=function(te){const ce=V.indexOf(te);return-1!==ce&&V.splice(ce,2),this},this.getHandler=function(te){for(let ce=0,ue=V.length;ce<ue;ce+=2){const _e=V[ce],Ee=V[ce+1];if(_e.global&&(_e.lastIndex=0),_e.test(te))return Ee}return null}}}const pr=new jn;class Yn{constructor(e){this.manager=void 0!==e?e:pr,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,c){const d=this;return new Promise(function(_,S){d.load(e,_,c,S)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const wr={};class Or extends Yn{constructor(e){super(e)}load(e,c,d,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,B=lr.get(e);if(void 0!==B)return S.manager.itemStart(e),setTimeout(function(){c&&c(B),S.manager.itemEnd(e)},0),B;if(void 0!==wr[e])return void wr[e].push({onLoad:c,onProgress:d,onError:_});const k=e.match(/^data:(.*?)(;base64)?,(.*)$/);let F;if(k){const V=k[1],te=!!k[2];let ce=k[3];ce=decodeURIComponent(ce),te&&(ce=atob(ce));try{let ue;const _e=(this.responseType||"").toLowerCase();switch(_e){case"arraybuffer":case"blob":const Ee=new Uint8Array(ce.length);for(let Be=0;Be<ce.length;Be++)Ee[Be]=ce.charCodeAt(Be);ue="blob"===_e?new Blob([Ee.buffer],{type:V}):Ee.buffer;break;case"document":ue=(new DOMParser).parseFromString(ce,V);break;case"json":ue=JSON.parse(ce);break;default:ue=ce}setTimeout(function(){c&&c(ue),S.manager.itemEnd(e)},0)}catch(ue){setTimeout(function(){_&&_(ue),S.manager.itemError(e),S.manager.itemEnd(e)},0)}}else{wr[e]=[],wr[e].push({onLoad:c,onProgress:d,onError:_}),F=new XMLHttpRequest,F.open("GET",e,!0),F.addEventListener("load",function(V){const te=this.response,ce=wr[e];if(delete wr[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),lr.add(e,te);for(let ue=0,_e=ce.length;ue<_e;ue++){const Ee=ce[ue];Ee.onLoad&&Ee.onLoad(te)}S.manager.itemEnd(e)}else{for(let ue=0,_e=ce.length;ue<_e;ue++){const Ee=ce[ue];Ee.onError&&Ee.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)}},!1),F.addEventListener("progress",function(V){const te=wr[e];for(let ce=0,ue=te.length;ce<ue;ce++){const _e=te[ce];_e.onProgress&&_e.onProgress(V)}},!1),F.addEventListener("error",function(V){const te=wr[e];delete wr[e];for(let ce=0,ue=te.length;ce<ue;ce++){const _e=te[ce];_e.onError&&_e.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)},!1),F.addEventListener("abort",function(V){const te=wr[e];delete wr[e];for(let ce=0,ue=te.length;ce<ue;ce++){const _e=te[ce];_e.onError&&_e.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)},!1),void 0!==this.responseType&&(F.responseType=this.responseType),void 0!==this.withCredentials&&(F.withCredentials=this.withCredentials),F.overrideMimeType&&F.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const V in this.requestHeader)F.setRequestHeader(V,this.requestHeader[V]);F.send(null)}return S.manager.itemStart(e),F}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Ji extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=new Or(this.manager);B.setPath(this.path),B.setRequestHeader(this.requestHeader),B.setWithCredentials(this.withCredentials),B.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c=[];for(let d=0;d<e.length;d++){const _=$n.parse(e[d]);c.push(_)}return c}}class fo extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=[],k=new Iu,F=new Or(this.manager);F.setPath(this.path),F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setWithCredentials(S.withCredentials);let V=0;function te(ce){F.load(e[ce],function(ue){const _e=S.parse(ue,!0);B[ce]={width:_e.width,height:_e.height,format:_e.format,mipmaps:_e.mipmaps},V+=1,6===V&&(1===_e.mipmapCount&&(k.minFilter=ai),k.image=B,k.format=_e.format,k.needsUpdate=!0,c&&c(k))},d,_)}if(Array.isArray(e))for(let ce=0,ue=e.length;ce<ue;++ce)te(ce);else F.load(e,function(ce){const ue=S.parse(ce,!0);if(ue.isCubemap){const _e=ue.mipmaps.length/ue.mipmapCount;for(let Ee=0;Ee<_e;Ee++){B[Ee]={mipmaps:[]};for(let $e=0;$e<ue.mipmapCount;$e++)B[Ee].mipmaps.push(ue.mipmaps[Ee*ue.mipmapCount+$e]),B[Ee].format=ue.format,B[Ee].width=ue.width,B[Ee].height=ue.height}k.image=B}else k.image.width=ue.width,k.image.height=ue.height,k.mipmaps=ue.mipmaps;1===ue.mipmapCount&&(k.minFilter=ai),k.format=ue.format,k.needsUpdate=!0,c&&c(k)},d,_);return k}}class wo extends Yn{constructor(e){super(e)}load(e,c,d,_){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,B=lr.get(e);if(void 0!==B)return S.manager.itemStart(e),setTimeout(function(){c&&c(B),S.manager.itemEnd(e)},0),B;const k=document.createElementNS("http://www.w3.org/1999/xhtml","img");function F(){k.removeEventListener("load",F,!1),k.removeEventListener("error",V,!1),lr.add(e,this),c&&c(this),S.manager.itemEnd(e)}function V(te){k.removeEventListener("load",F,!1),k.removeEventListener("error",V,!1),_&&_(te),S.manager.itemError(e),S.manager.itemEnd(e)}return k.addEventListener("load",F,!1),k.addEventListener("error",V,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(k.crossOrigin=this.crossOrigin),S.manager.itemStart(e),k.src=e,k}}class Uo extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=new nc,B=new wo(this.manager);B.setCrossOrigin(this.crossOrigin),B.setPath(this.path);let k=0;function F(V){B.load(e[V],function(te){S.images[V]=te,k++,6===k&&(S.needsUpdate=!0,c&&c(S))},void 0,_)}for(let V=0;V<e.length;++V)F(V);return S}}class cs extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=new Os,k=new Or(this.manager);return k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(S.withCredentials),k.load(e,function(F){const V=S.parse(F);V&&(void 0!==V.image?B.image=V.image:void 0!==V.data&&(B.image.width=V.width,B.image.height=V.height,B.image.data=V.data),B.wrapS=void 0!==V.wrapS?V.wrapS:Jr,B.wrapT=void 0!==V.wrapT?V.wrapT:Jr,B.magFilter=void 0!==V.magFilter?V.magFilter:ai,B.minFilter=void 0!==V.minFilter?V.minFilter:ai,B.anisotropy=void 0!==V.anisotropy?V.anisotropy:1,void 0!==V.encoding&&(B.encoding=V.encoding),void 0!==V.flipY&&(B.flipY=V.flipY),void 0!==V.format&&(B.format=V.format),void 0!==V.type&&(B.type=V.type),void 0!==V.mipmaps&&(B.mipmaps=V.mipmaps,B.minFilter=sl),1===V.mipmapCount&&(B.minFilter=ai),void 0!==V.generateMipmaps&&(B.generateMipmaps=V.generateMipmaps),B.needsUpdate=!0,c&&c(B,V))},d,_),B}}class Ws extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=new $s,B=new wo(this.manager);return B.setCrossOrigin(this.crossOrigin),B.setPath(this.path),B.load(e,function(k){S.image=k;const F=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);S.format=F?Fs:lo,S.needsUpdate=!0,void 0!==c&&c(S)},d,_),S}}class Ga extends Ua{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);e.equals(c)||this.curves.push(new oa(c,e))}getPoint(e){const c=e*this.getLength(),d=this.getCurveLengths();let _=0;for(;_<d.length;){if(d[_]>=c){const S=d[_]-c,B=this.curves[_],k=B.getLength();return B.getPointAt(0===k?0:1-S/k)}_++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let c=0;for(let d=0,_=this.curves.length;d<_;d++)c+=this.curves[d].getLength(),e.push(c);return this.cacheLengths=e,e}getSpacedPoints(e=40){const c=[];for(let d=0;d<=e;d++)c.push(this.getPoint(d/e));return this.autoClose&&c.push(c[0]),c}getPoints(e=12){const c=[];let d;for(let _=0,S=this.curves;_<S.length;_++){const B=S[_],F=B.getPoints(B&&B.isEllipseCurve?2*e:B&&(B.isLineCurve||B.isLineCurve3)?1:B&&B.isSplineCurve?e*B.points.length:e);for(let V=0;V<F.length;V++){const te=F[V];d&&d.equals(te)||(c.push(te),d=te)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(e){super.copy(e),this.curves=[];for(let c=0,d=e.curves.length;c<d;c++)this.curves.push(e.curves[c].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let c=0,d=this.curves.length;c<d;c++)e.curves.push(this.curves[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let c=0,d=e.curves.length;c<d;c++){const _=e.curves[c];this.curves.push((new ho[_.type]).fromJSON(_))}return this}}class ks extends Ga{constructor(e){super(),this.type="Path",this.currentPoint=new zn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let c=1,d=e.length;c<d;c++)this.lineTo(e[c].x,e[c].y);return this}moveTo(e,c){return this.currentPoint.set(e,c),this}lineTo(e,c){const d=new oa(this.currentPoint.clone(),new zn(e,c));return this.curves.push(d),this.currentPoint.set(e,c),this}quadraticCurveTo(e,c,d,_){const S=new so(this.currentPoint.clone(),new zn(e,c),new zn(d,_));return this.curves.push(S),this.currentPoint.set(d,_),this}bezierCurveTo(e,c,d,_,S,B){const k=new ia(this.currentPoint.clone(),new zn(e,c),new zn(d,_),new zn(S,B));return this.curves.push(k),this.currentPoint.set(S,B),this}splineThru(e){const c=[this.currentPoint.clone()].concat(e),d=new ws(c);return this.curves.push(d),this.currentPoint.copy(e[e.length-1]),this}arc(e,c,d,_,S,B){return this.absarc(e+this.currentPoint.x,c+this.currentPoint.y,d,_,S,B),this}absarc(e,c,d,_,S,B){return this.absellipse(e,c,d,d,_,S,B),this}ellipse(e,c,d,_,S,B,k,F){return this.absellipse(e+this.currentPoint.x,c+this.currentPoint.y,d,_,S,B,k,F),this}absellipse(e,c,d,_,S,B,k,F){const V=new Fu(e,c,d,_,S,B,k,F);if(this.curves.length>0){const ce=V.getPoint(0);ce.equals(this.currentPoint)||this.lineTo(ce.x,ce.y)}this.curves.push(V);const te=V.getPoint(1);return this.currentPoint.copy(te),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class qs extends ks{constructor(e){super(e),this.uuid=Qi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const c=[];for(let d=0,_=this.holes.length;d<_;d++)c[d]=this.holes[d].getPoints(e);return c}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let c=0,d=e.holes.length;c<d;c++)this.holes.push(e.holes[c].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let c=0,d=this.holes.length;c<d;c++)e.holes.push(this.holes[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let c=0,d=e.holes.length;c<d;c++){const _=e.holes[c];this.holes.push((new ks).fromJSON(_))}return this}}class Hl extends Pr{constructor(e,c=1){super(),this.type="Light",this.color=new er(e),this.intensity=c}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const c=super.toJSON(e);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}Hl.prototype.isLight=!0;class ap extends Hl{constructor(e,c,d){super(e,d),this.type="HemisphereLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.groundColor=new er(c)}copy(e){return Hl.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}ap.prototype.isHemisphereLight=!0;const lp=new tn,Up=new ht,Sd=new ht;class Uc{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zn(512,512),this.map=null,this.mapPass=null,this.matrix=new tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Dr,this._frameExtents=new zn(1,1),this._viewportCount=1,this._viewports=[new Di(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const c=this.camera,d=this.matrix;Up.setFromMatrixPosition(e.matrixWorld),c.position.copy(Up),Sd.setFromMatrixPosition(e.target.matrixWorld),c.lookAt(Sd),c.updateMatrixWorld(),lp.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lp),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(c.projectionMatrix),d.multiply(c.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class up extends Uc{constructor(){super(new Po(50,1,.5,500)),this.focus=1}updateMatrices(e){const c=this.camera,d=2*ss*e.angle*this.focus,_=this.mapSize.width/this.mapSize.height,S=e.distance||c.far;d===c.fov&&_===c.aspect&&S===c.far||(c.fov=d,c.aspect=_,c.far=S,c.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}up.prototype.isSpotLightShadow=!0;class fh extends Hl{constructor(e,c,d=0,_=Math.PI/3,S=0,B=1){super(e,c),this.type="SpotLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.distance=d,this.angle=_,this.penumbra=S,this.decay=B,this.shadow=new up}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}fh.prototype.isSpotLight=!0;const il=new tn,hp=new ht,jm=new ht;class Ed extends Uc{constructor(){super(new Po(90,1,.5,500)),this._frameExtents=new zn(4,2),this._viewportCount=6,this._viewports=[new Di(2,1,1,1),new Di(0,1,1,1),new Di(3,1,1,1),new Di(1,1,1,1),new Di(3,0,1,1),new Di(1,0,1,1)],this._cubeDirections=[new ht(1,0,0),new ht(-1,0,0),new ht(0,0,1),new ht(0,0,-1),new ht(0,1,0),new ht(0,-1,0)],this._cubeUps=[new ht(0,1,0),new ht(0,1,0),new ht(0,1,0),new ht(0,1,0),new ht(0,0,1),new ht(0,0,-1)]}updateMatrices(e,c=0){const d=this.camera,_=this.matrix,S=e.distance||d.far;S!==d.far&&(d.far=S,d.updateProjectionMatrix()),hp.setFromMatrixPosition(e.matrixWorld),d.position.copy(hp),jm.copy(d.position),jm.add(this._cubeDirections[c]),d.up.copy(this._cubeUps[c]),d.lookAt(jm),d.updateMatrixWorld(),_.makeTranslation(-hp.x,-hp.y,-hp.z),il.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(il)}}Ed.prototype.isPointLightShadow=!0;class If extends Hl{constructor(e,c,d=0,_=1){super(e,c),this.type="PointLight",this.distance=d,this.decay=_,this.shadow=new Ed}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}If.prototype.isPointLight=!0;class Jd extends Uc{constructor(){super(new rc(-5,5,5,-5,.5,500))}}Jd.prototype.isDirectionalLightShadow=!0;class nd extends Hl{constructor(e,c){super(e,c),this.type="DirectionalLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.shadow=new Jd}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}nd.prototype.isDirectionalLight=!0;class am extends Hl{constructor(e,c){super(e,c),this.type="AmbientLight"}}am.prototype.isAmbientLight=!0;class Gm extends Hl{constructor(e,c,d=10,_=10){super(e,c),this.type="RectAreaLight",this.width=d,this.height=_}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const c=super.toJSON(e);return c.object.width=this.width,c.object.height=this.height,c}}Gm.prototype.isRectAreaLight=!0;class rd{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ht)}set(e){for(let c=0;c<9;c++)this.coefficients[c].copy(e[c]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,c){const d=e.x,_=e.y,S=e.z,B=this.coefficients;return c.copy(B[0]).multiplyScalar(.282095),c.addScaledVector(B[1],.488603*_),c.addScaledVector(B[2],.488603*S),c.addScaledVector(B[3],.488603*d),c.addScaledVector(B[4],d*_*1.092548),c.addScaledVector(B[5],_*S*1.092548),c.addScaledVector(B[6],.315392*(3*S*S-1)),c.addScaledVector(B[7],d*S*1.092548),c.addScaledVector(B[8],.546274*(d*d-_*_)),c}getIrradianceAt(e,c){const d=e.x,_=e.y,S=e.z,B=this.coefficients;return c.copy(B[0]).multiplyScalar(.886227),c.addScaledVector(B[1],1.023328*_),c.addScaledVector(B[2],1.023328*S),c.addScaledVector(B[3],1.023328*d),c.addScaledVector(B[4],.858086*d*_),c.addScaledVector(B[5],.858086*_*S),c.addScaledVector(B[6],.743125*S*S-.247708),c.addScaledVector(B[7],.858086*d*S),c.addScaledVector(B[8],.429043*(d*d-_*_)),c}add(e){for(let c=0;c<9;c++)this.coefficients[c].add(e.coefficients[c]);return this}addScaledSH(e,c){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(e.coefficients[d],c);return this}scale(e){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(e);return this}lerp(e,c){for(let d=0;d<9;d++)this.coefficients[d].lerp(e.coefficients[d],c);return this}equals(e){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(e.coefficients[c]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,c=0){const d=this.coefficients;for(let _=0;_<9;_++)d[_].fromArray(e,c+3*_);return this}toArray(e=[],c=0){const d=this.coefficients;for(let _=0;_<9;_++)d[_].toArray(e,c+3*_);return e}static getBasisAt(e,c){const d=e.x,_=e.y,S=e.z;c[0]=.282095,c[1]=.488603*_,c[2]=.488603*S,c[3]=.488603*d,c[4]=1.092548*d*_,c[5]=1.092548*_*S,c[6]=.315392*(3*S*S-1),c[7]=1.092548*d*S,c[8]=.546274*(d*d-_*_)}}rd.prototype.isSphericalHarmonics3=!0;class Zd extends Hl{constructor(e=new rd,c=1){super(void 0,c),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const c=super.toJSON(e);return c.object.sh=this.sh.toArray(),c}}Zd.prototype.isLightProbe=!0;class lm extends Yn{constructor(e){super(e),this.textures={}}load(e,c,d,_){const S=this,B=new Or(S.manager);B.setPath(S.path),B.setRequestHeader(S.requestHeader),B.setWithCredentials(S.withCredentials),B.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c=this.textures;function d(S){return void 0===c[S]&&console.warn("THREE.MaterialLoader: Undefined texture",S),c[S]}const _=new Ue[e.type];if(void 0!==e.uuid&&(_.uuid=e.uuid),void 0!==e.name&&(_.name=e.name),void 0!==e.color&&void 0!==_.color&&_.color.setHex(e.color),void 0!==e.roughness&&(_.roughness=e.roughness),void 0!==e.metalness&&(_.metalness=e.metalness),void 0!==e.sheenTint&&(_.sheenTint=(new er).setHex(e.sheenTint)),void 0!==e.emissive&&void 0!==_.emissive&&_.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==_.specular&&_.specular.setHex(e.specular),void 0!==e.specularIntensity&&(_.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==_.specularTint&&_.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(_.shininess=e.shininess),void 0!==e.clearcoat&&(_.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(_.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(_.transmission=e.transmission),void 0!==e.thickness&&(_.thickness=e.thickness),void 0!==e.attenuationDistance&&(_.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==_.attenuationTint&&_.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(_.fog=e.fog),void 0!==e.flatShading&&(_.flatShading=e.flatShading),void 0!==e.blending&&(_.blending=e.blending),void 0!==e.combine&&(_.combine=e.combine),void 0!==e.side&&(_.side=e.side),void 0!==e.shadowSide&&(_.shadowSide=e.shadowSide),void 0!==e.opacity&&(_.opacity=e.opacity),void 0!==e.format&&(_.format=e.format),void 0!==e.transparent&&(_.transparent=e.transparent),void 0!==e.alphaTest&&(_.alphaTest=e.alphaTest),void 0!==e.depthTest&&(_.depthTest=e.depthTest),void 0!==e.depthWrite&&(_.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(_.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(_.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(_.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(_.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(_.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(_.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(_.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(_.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(_.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(_.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(_.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(_.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(_.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(_.rotation=e.rotation),1!==e.linewidth&&(_.linewidth=e.linewidth),void 0!==e.dashSize&&(_.dashSize=e.dashSize),void 0!==e.gapSize&&(_.gapSize=e.gapSize),void 0!==e.scale&&(_.scale=e.scale),void 0!==e.polygonOffset&&(_.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(_.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(_.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(_.dithering=e.dithering),void 0!==e.alphaToCoverage&&(_.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(_.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(_.visible=e.visible),void 0!==e.toneMapped&&(_.toneMapped=e.toneMapped),void 0!==e.userData&&(_.userData=e.userData),void 0!==e.vertexColors&&(_.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const S in e.uniforms){const B=e.uniforms[S];switch(_.uniforms[S]={},B.type){case"t":_.uniforms[S].value=d(B.value);break;case"c":_.uniforms[S].value=(new er).setHex(B.value);break;case"v2":_.uniforms[S].value=(new zn).fromArray(B.value);break;case"v3":_.uniforms[S].value=(new ht).fromArray(B.value);break;case"v4":_.uniforms[S].value=(new Di).fromArray(B.value);break;case"m3":_.uniforms[S].value=(new lt).fromArray(B.value);break;case"m4":_.uniforms[S].value=(new tn).fromArray(B.value);break;default:_.uniforms[S].value=B.value}}if(void 0!==e.defines&&(_.defines=e.defines),void 0!==e.vertexShader&&(_.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(_.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const S in e.extensions)_.extensions[S]=e.extensions[S];if(void 0!==e.shading&&(_.flatShading=1===e.shading),void 0!==e.size&&(_.size=e.size),void 0!==e.sizeAttenuation&&(_.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(_.map=d(e.map)),void 0!==e.matcap&&(_.matcap=d(e.matcap)),void 0!==e.alphaMap&&(_.alphaMap=d(e.alphaMap)),void 0!==e.bumpMap&&(_.bumpMap=d(e.bumpMap)),void 0!==e.bumpScale&&(_.bumpScale=e.bumpScale),void 0!==e.normalMap&&(_.normalMap=d(e.normalMap)),void 0!==e.normalMapType&&(_.normalMapType=e.normalMapType),void 0!==e.normalScale){let S=e.normalScale;!1===Array.isArray(S)&&(S=[S,S]),_.normalScale=(new zn).fromArray(S)}return void 0!==e.displacementMap&&(_.displacementMap=d(e.displacementMap)),void 0!==e.displacementScale&&(_.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(_.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(_.roughnessMap=d(e.roughnessMap)),void 0!==e.metalnessMap&&(_.metalnessMap=d(e.metalnessMap)),void 0!==e.emissiveMap&&(_.emissiveMap=d(e.emissiveMap)),void 0!==e.emissiveIntensity&&(_.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(_.specularMap=d(e.specularMap)),void 0!==e.specularIntensityMap&&(_.specularIntensityMap=d(e.specularIntensityMap)),void 0!==e.specularTintMap&&(_.specularTintMap=d(e.specularTintMap)),void 0!==e.envMap&&(_.envMap=d(e.envMap)),void 0!==e.envMapIntensity&&(_.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(_.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(_.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(_.lightMap=d(e.lightMap)),void 0!==e.lightMapIntensity&&(_.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(_.aoMap=d(e.aoMap)),void 0!==e.aoMapIntensity&&(_.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(_.gradientMap=d(e.gradientMap)),void 0!==e.clearcoatMap&&(_.clearcoatMap=d(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap=d(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(_.clearcoatNormalMap=d(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(_.clearcoatNormalScale=(new zn).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(_.transmissionMap=d(e.transmissionMap)),void 0!==e.thicknessMap&&(_.thicknessMap=d(e.thicknessMap)),_}setTextures(e){return this.textures=e,this}}class vf{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let c="";for(let d=0,_=e.length;d<_;d++)c+=String.fromCharCode(e[d]);try{return decodeURIComponent(escape(c))}catch{return c}}static extractUrlBase(e){const c=e.lastIndexOf("/");return-1===c?"./":e.substr(0,c+1)}}class Of extends br{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Of.prototype.isInstancedBufferGeometry=!0;class o_ extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=new Or(S.manager);B.setPath(S.path),B.setRequestHeader(S.requestHeader),B.setWithCredentials(S.withCredentials),B.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c={},d={};function _(ce,ue){if(void 0!==c[ue])return c[ue];const _e=ce.interleavedBuffers[ue],Ee=function(Re,We){if(void 0!==d[We])return d[We];const Ze=new Uint32Array(Re.arrayBuffers[We]).buffer;return d[We]=Ze,Ze}(ce,_e.buffer),$e=Za(_e.type,Ee),Be=new Oc($e,_e.stride);return Be.uuid=_e.uuid,c[ue]=Be,Be}const S=e.isInstancedBufferGeometry?new Of:new br,B=e.data.index;if(void 0!==B){const ce=Za(B.type,B.array);S.setIndex(new Pi(ce,1))}const k=e.data.attributes;for(const ce in k){const ue=k[ce];let _e;if(ue.isInterleavedBufferAttribute){const Ee=_(e.data,ue.data);_e=new Ii(Ee,ue.itemSize,ue.offset,ue.normalized)}else{const Ee=Za(ue.type,ue.array);_e=new(ue.isInstancedBufferAttribute?ou:Pi)(Ee,ue.itemSize,ue.normalized)}void 0!==ue.name&&(_e.name=ue.name),void 0!==ue.usage&&_e.setUsage(ue.usage),void 0!==ue.updateRange&&(_e.updateRange.offset=ue.updateRange.offset,_e.updateRange.count=ue.updateRange.count),S.setAttribute(ce,_e)}const F=e.data.morphAttributes;if(F)for(const ce in F){const ue=F[ce],_e=[];for(let Ee=0,$e=ue.length;Ee<$e;Ee++){const Be=ue[Ee];let Re;if(Be.isInterleavedBufferAttribute){const We=_(e.data,Be.data);Re=new Ii(We,Be.itemSize,Be.offset,Be.normalized)}else{const We=Za(Be.type,Be.array);Re=new Pi(We,Be.itemSize,Be.normalized)}void 0!==Be.name&&(Re.name=Be.name),_e.push(Re)}S.morphAttributes[ce]=_e}e.data.morphTargetsRelative&&(S.morphTargetsRelative=!0);const V=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==V)for(let ce=0,ue=V.length;ce!==ue;++ce){const _e=V[ce];S.addGroup(_e.start,_e.count,_e.materialIndex)}const te=e.data.boundingSphere;if(void 0!==te){const ce=new ht;void 0!==te.center&&ce.fromArray(te.center),S.boundingSphere=new xo(ce,te.radius)}return e.name&&(S.name=e.name),e.userData&&(S.userData=e.userData),S}}class Hm extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=""===this.path?vf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||B;const k=new Or(this.manager);k.setPath(this.path),k.setRequestHeader(this.requestHeader),k.setWithCredentials(this.withCredentials),k.load(e,function(F){let V=null;try{V=JSON.parse(F)}catch(ce){return void 0!==_&&_(ce),void console.error("THREE:ObjectLoader: Can't parse "+e+".",ce.message)}const te=V.metadata;void 0!==te&&void 0!==te.type&&"geometry"!==te.type.toLowerCase()?S.parse(V,c):console.error("THREE.ObjectLoader: Can't load "+e)},d,_)}async loadAsync(e,c){const d=""===this.path?vf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const _=new Or(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);const S=await _.loadAsync(e,c),B=JSON.parse(S),k=B.metadata;if(void 0===k||void 0===k.type||"geometry"===k.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(B)}parse(e,c){const d=this.parseAnimations(e.animations),_=this.parseShapes(e.shapes),S=this.parseGeometries(e.geometries,_),B=this.parseImages(e.images,function(){void 0!==c&&c(V)}),k=this.parseTextures(e.textures,B),F=this.parseMaterials(e.materials,k),V=this.parseObject(e.object,S,F,k,d),te=this.parseSkeletons(e.skeletons,V);if(this.bindSkeletons(V,te),void 0!==c){let ce=!1;for(const ue in B)if(B[ue]instanceof HTMLImageElement){ce=!0;break}!1===ce&&c(V)}return V}async parseAsync(e){const c=this.parseAnimations(e.animations),d=this.parseShapes(e.shapes),_=this.parseGeometries(e.geometries,d),S=await this.parseImagesAsync(e.images),B=this.parseTextures(e.textures,S),k=this.parseMaterials(e.materials,B),F=this.parseObject(e.object,_,k,B,c),V=this.parseSkeletons(e.skeletons,F);return this.bindSkeletons(F,V),F}parseShapes(e){const c={};if(void 0!==e)for(let d=0,_=e.length;d<_;d++){const S=(new qs).fromJSON(e[d]);c[S.uuid]=S}return c}parseSkeletons(e,c){const d={},_={};if(c.traverse(function(S){S.isBone&&(_[S.uuid]=S)}),void 0!==e)for(let S=0,B=e.length;S<B;S++){const k=(new rp).fromJSON(e[S],_);d[k.uuid]=k}return d}parseGeometries(e,c){const d={};if(void 0!==e){const _=new o_;for(let S=0,B=e.length;S<B;S++){let k;const F=e[S];switch(F.type){case"BufferGeometry":case"InstancedBufferGeometry":k=_.parse(F);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:F.type in ie?k=ie[F.type].fromJSON(F,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${F.type}"`)}k.uuid=F.uuid,void 0!==F.name&&(k.name=F.name),!0===k.isBufferGeometry&&void 0!==F.userData&&(k.userData=F.userData),d[F.uuid]=k}}return d}parseMaterials(e,c){const d={},_={};if(void 0!==e){const S=new lm;S.setTextures(c);for(let B=0,k=e.length;B<k;B++){const F=e[B];if("MultiMaterial"===F.type){const V=[];for(let te=0;te<F.materials.length;te++){const ce=F.materials[te];void 0===d[ce.uuid]&&(d[ce.uuid]=S.parse(ce)),V.push(d[ce.uuid])}_[F.uuid]=V}else void 0===d[F.uuid]&&(d[F.uuid]=S.parse(F)),_[F.uuid]=d[F.uuid]}}return _}parseAnimations(e){const c={};if(void 0!==e)for(let d=0;d<e.length;d++){const S=$n.parse(e[d]);c[S.uuid]=S}return c}parseImages(e,c){const d=this,_={};let S;function B(k){if("string"==typeof k){const F=k;return V=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(F)?F:d.resourcePath+F,d.manager.itemStart(V),S.load(V,function(){d.manager.itemEnd(V)},void 0,function(){d.manager.itemError(V),d.manager.itemEnd(V)})}var V;return k.data?{data:Za(k.type,k.data),width:k.width,height:k.height}:null}if(void 0!==e&&e.length>0){const k=new jn(c);S=new wo(k),S.setCrossOrigin(this.crossOrigin);for(let F=0,V=e.length;F<V;F++){const te=e[F],ce=te.url;if(Array.isArray(ce)){_[te.uuid]=[];for(let ue=0,_e=ce.length;ue<_e;ue++){const Ee=B(ce[ue]);null!==Ee&&(Ee instanceof HTMLImageElement?_[te.uuid].push(Ee):_[te.uuid].push(new Os(Ee.data,Ee.width,Ee.height)))}}else{const ue=B(te.url);null!==ue&&(_[te.uuid]=ue)}}}return _}async parseImagesAsync(e){const c=this,d={};let _;async function S(B){if("string"==typeof B){const k=B,F=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(k)?k:c.resourcePath+k;return await _.loadAsync(F)}return B.data?{data:Za(B.type,B.data),width:B.width,height:B.height}:null}if(void 0!==e&&e.length>0){_=new wo(this.manager),_.setCrossOrigin(this.crossOrigin);for(let B=0,k=e.length;B<k;B++){const F=e[B],V=F.url;if(Array.isArray(V)){d[F.uuid]=[];for(let te=0,ce=V.length;te<ce;te++){const ue=V[te],_e=await S(ue);null!==_e&&(_e instanceof HTMLImageElement?d[F.uuid].push(_e):d[F.uuid].push(new Os(_e.data,_e.width,_e.height)))}}else{const te=await S(F.url);null!==te&&(d[F.uuid]=te)}}}return d}parseTextures(e,c){function d(S,B){return"number"==typeof S?S:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",S),B[S])}const _={};if(void 0!==e)for(let S=0,B=e.length;S<B;S++){const k=e[S];let F;void 0===k.image&&console.warn('THREE.ObjectLoader: No "image" specified for',k.uuid),void 0===c[k.image]&&console.warn("THREE.ObjectLoader: Undefined image",k.image);const V=c[k.image];Array.isArray(V)?(F=new nc(V),6===V.length&&(F.needsUpdate=!0)):(F=V&&V.data?new Os(V.data,V.width,V.height):new $s(V),V&&(F.needsUpdate=!0)),F.uuid=k.uuid,void 0!==k.name&&(F.name=k.name),void 0!==k.mapping&&(F.mapping=d(k.mapping,E_)),void 0!==k.offset&&F.offset.fromArray(k.offset),void 0!==k.repeat&&F.repeat.fromArray(k.repeat),void 0!==k.center&&F.center.fromArray(k.center),void 0!==k.rotation&&(F.rotation=k.rotation),void 0!==k.wrap&&(F.wrapS=d(k.wrap[0],s_),F.wrapT=d(k.wrap[1],s_)),void 0!==k.format&&(F.format=k.format),void 0!==k.type&&(F.type=k.type),void 0!==k.encoding&&(F.encoding=k.encoding),void 0!==k.minFilter&&(F.minFilter=d(k.minFilter,a_)),void 0!==k.magFilter&&(F.magFilter=d(k.magFilter,a_)),void 0!==k.anisotropy&&(F.anisotropy=k.anisotropy),void 0!==k.flipY&&(F.flipY=k.flipY),void 0!==k.premultiplyAlpha&&(F.premultiplyAlpha=k.premultiplyAlpha),void 0!==k.unpackAlignment&&(F.unpackAlignment=k.unpackAlignment),_[k.uuid]=F}return _}parseObject(e,c,d,_,S){let B,k,F;function V(ue){return void 0===c[ue]&&console.warn("THREE.ObjectLoader: Undefined geometry",ue),c[ue]}function te(ue){if(void 0!==ue){if(Array.isArray(ue)){const _e=[];for(let Ee=0,$e=ue.length;Ee<$e;Ee++){const Be=ue[Ee];void 0===d[Be]&&console.warn("THREE.ObjectLoader: Undefined material",Be),_e.push(d[Be])}return _e}return void 0===d[ue]&&console.warn("THREE.ObjectLoader: Undefined material",ue),d[ue]}}function ce(ue){return void 0===_[ue]&&console.warn("THREE.ObjectLoader: Undefined texture",ue),_[ue]}switch(e.type){case"Scene":B=new Gs,void 0!==e.background&&(B.background=Number.isInteger(e.background)?new er(e.background):ce(e.background)),void 0!==e.environment&&(B.environment=ce(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?B.fog=new ka(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(B.fog=new Lu(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":B=new Po(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(B.focus=e.focus),void 0!==e.zoom&&(B.zoom=e.zoom),void 0!==e.filmGauge&&(B.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(B.filmOffset=e.filmOffset),void 0!==e.view&&(B.view=Object.assign({},e.view));break;case"OrthographicCamera":B=new rc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(B.zoom=e.zoom),void 0!==e.view&&(B.view=Object.assign({},e.view));break;case"AmbientLight":B=new am(e.color,e.intensity);break;case"DirectionalLight":B=new nd(e.color,e.intensity);break;case"PointLight":B=new If(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":B=new Gm(e.color,e.intensity,e.width,e.height);break;case"SpotLight":B=new fh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":B=new ap(e.color,e.groundColor,e.intensity);break;case"LightProbe":B=(new Zd).fromJSON(e);break;case"SkinnedMesh":k=V(e.geometry),F=te(e.material),B=new zl(k,F),void 0!==e.bindMode&&(B.bindMode=e.bindMode),void 0!==e.bindMatrix&&B.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(B.skeleton=e.skeleton);break;case"Mesh":k=V(e.geometry),F=te(e.material),B=new Ro(k,F);break;case"InstancedMesh":k=V(e.geometry),F=te(e.material);const _e=e.instanceMatrix,Ee=e.instanceColor;B=new Dc(k,F,e.count),B.instanceMatrix=new ou(new Float32Array(_e.array),16),void 0!==Ee&&(B.instanceColor=new ou(new Float32Array(Ee.array),Ee.itemSize));break;case"LOD":B=new ph;break;case"Line":B=new Da(V(e.geometry),te(e.material));break;case"LineLoop":B=new Qo(V(e.geometry),te(e.material));break;case"LineSegments":B=new fr(V(e.geometry),te(e.material));break;case"PointCloud":case"Points":B=new ra(V(e.geometry),te(e.material));break;case"Sprite":B=new Fc(te(e.material));break;case"Group":B=new ln;break;case"Bone":B=new jl;break;default:B=new Pr}if(B.uuid=e.uuid,void 0!==e.name&&(B.name=e.name),void 0!==e.matrix?(B.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(B.matrixAutoUpdate=e.matrixAutoUpdate),B.matrixAutoUpdate&&B.matrix.decompose(B.position,B.quaternion,B.scale)):(void 0!==e.position&&B.position.fromArray(e.position),void 0!==e.rotation&&B.rotation.fromArray(e.rotation),void 0!==e.quaternion&&B.quaternion.fromArray(e.quaternion),void 0!==e.scale&&B.scale.fromArray(e.scale)),void 0!==e.castShadow&&(B.castShadow=e.castShadow),void 0!==e.receiveShadow&&(B.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(B.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(B.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(B.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&B.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(B.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(B.visible=e.visible),void 0!==e.frustumCulled&&(B.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(B.renderOrder=e.renderOrder),void 0!==e.userData&&(B.userData=e.userData),void 0!==e.layers&&(B.layers.mask=e.layers),void 0!==e.children){const ue=e.children;for(let _e=0;_e<ue.length;_e++)B.add(this.parseObject(ue[_e],c,d,_,S))}if(void 0!==e.animations){const ue=e.animations;for(let _e=0;_e<ue.length;_e++)B.animations.push(S[ue[_e]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(B.autoUpdate=e.autoUpdate);const ue=e.levels;for(let _e=0;_e<ue.length;_e++){const Ee=ue[_e],$e=B.getObjectByProperty("uuid",Ee.object);void 0!==$e&&B.addLevel($e,Ee.distance)}}return B}bindSkeletons(e,c){0!==Object.keys(c).length&&e.traverse(function(d){if(!0===d.isSkinnedMesh&&void 0!==d.skeleton){const _=c[d.skeleton];void 0===_?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(_,d.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const E_={UVMapping:yi,CubeReflectionMapping:Ei,CubeRefractionMapping:So,EquirectangularReflectionMapping:Xs,EquirectangularRefractionMapping:ua,CubeUVReflectionMapping:Ni,CubeUVRefractionMapping:Eo},s_={RepeatWrapping:vo,ClampToEdgeWrapping:Jr,MirroredRepeatWrapping:os},a_={NearestFilter:Ir,NearestMipmapNearestFilter:Va,NearestMipmapLinearFilter:hs,LinearFilter:ai,LinearMipmapNearestFilter:Gc,LinearMipmapLinearFilter:sl};class l_ extends Yn{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,c,d,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,B=lr.get(e);if(void 0!==B)return S.manager.itemStart(e),setTimeout(function(){c&&c(B),S.manager.itemEnd(e)},0),B;const k={};k.credentials="anonymous"===this.crossOrigin?"same-origin":"include",k.headers=this.requestHeader,fetch(e,k).then(function(F){return F.blob()}).then(function(F){return createImageBitmap(F,Object.assign(S.options,{colorSpaceConversion:"none"}))}).then(function(F){lr.add(e,F),c&&c(F),S.manager.itemEnd(e)}).catch(function(F){_&&_(F),S.manager.itemError(e),S.manager.itemEnd(e)}),S.manager.itemStart(e)}}l_.prototype.isImageBitmapLoader=!0;class c_{constructor(){this.type="ShapePath",this.color=new er,this.subPaths=[],this.currentPath=null}moveTo(e,c){return this.currentPath=new ks,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,c),this}lineTo(e,c){return this.currentPath.lineTo(e,c),this}quadraticCurveTo(e,c,d,_){return this.currentPath.quadraticCurveTo(e,c,d,_),this}bezierCurveTo(e,c,d,_,S,B){return this.currentPath.bezierCurveTo(e,c,d,_,S,B),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,c){function d(We){const tt=[];for(let Ze=0,ot=We.length;Ze<ot;Ze++){const st=We[Ze],Ct=new qs;Ct.curves=st.curves,tt.push(Ct)}return tt}function _(We,tt){const Ze=tt.length;let ot=!1;for(let st=Ze-1,Ct=0;Ct<Ze;st=Ct++){let Ft=tt[st],Qe=tt[Ct],nt=Qe.x-Ft.x,Et=Qe.y-Ft.y;if(Math.abs(Et)>Number.EPSILON){if(Et<0&&(Ft=tt[Ct],nt=-nt,Qe=tt[st],Et=-Et),We.y<Ft.y||We.y>Qe.y)continue;if(We.y===Ft.y){if(We.x===Ft.x)return!0}else{const Jt=Et*(We.x-Ft.x)-nt*(We.y-Ft.y);if(0===Jt)return!0;if(Jt<0)continue;ot=!ot}}else{if(We.y!==Ft.y)continue;if(Qe.x<=We.x&&We.x<=Ft.x||Ft.x<=We.x&&We.x<=Qe.x)return!0}}return ot}const S=Es.isClockWise,B=this.subPaths;if(0===B.length)return[];if(!0===c)return d(B);let k,F,V;const te=[];if(1===B.length)return F=B[0],V=new qs,V.curves=F.curves,te.push(V),te;let ce=!S(B[0].getPoints());ce=e?!ce:ce;const ue=[],_e=[];let Ee,$e,Be=[],Re=0;_e[Re]=void 0,Be[Re]=[];for(let We=0,tt=B.length;We<tt;We++)F=B[We],Ee=F.getPoints(),k=S(Ee),k=e?!k:k,k?(!ce&&_e[Re]&&Re++,_e[Re]={s:new qs,p:Ee},_e[Re].s.curves=F.curves,ce&&Re++,Be[Re]=[]):Be[Re].push({h:F,p:Ee[0]});if(!_e[0])return d(B);if(_e.length>1){let We=!1;const tt=[];for(let Ze=0,ot=_e.length;Ze<ot;Ze++)ue[Ze]=[];for(let Ze=0,ot=_e.length;Ze<ot;Ze++){const st=Be[Ze];for(let Ct=0;Ct<st.length;Ct++){const Ft=st[Ct];let Qe=!0;for(let nt=0;nt<_e.length;nt++)_(Ft.p,_e[nt].p)&&(Ze!==nt&&tt.push({froms:Ze,tos:nt,hole:Ct}),Qe?(Qe=!1,ue[nt].push(Ft)):We=!0);Qe&&ue[Ze].push(Ft)}}tt.length>0&&(We||(Be=ue))}for(let We=0,tt=_e.length;We<tt;We++){V=_e[We].s,te.push(V),$e=Be[We];for(let Ze=0,ot=$e.length;Ze<ot;Ze++)V.holes.push($e[Ze].h)}return te}}class Vm{constructor(e){this.type="Font",this.data=e}generateShapes(e,c=100){const d=[],_=function(S,B,k){const F=Array.from(S),V=B/k.resolution,te=(k.boundingBox.yMax-k.boundingBox.yMin+k.underlineThickness)*V,ce=[];let ue=0,_e=0;for(let Ee=0;Ee<F.length;Ee++){const $e=F[Ee];if("\n"===$e)ue=0,_e-=te;else{const Be=T_($e,V,ue,_e,k);ue+=Be.offsetX,ce.push(Be.path)}}return ce}(e,c,this.data);for(let S=0,B=_.length;S<B;S++)Array.prototype.push.apply(d,_[S].toShapes());return d}}function T_(w,e,c,d,_){const S=_.glyphs[w]||_.glyphs["?"];if(!S)return void console.error('THREE.Font: character "'+w+'" does not exists in font family '+_.familyName+".");const B=new c_;let k,F,V,te,ce,ue,_e,Ee;if(S.o){const $e=S._cachedOutline||(S._cachedOutline=S.o.split(" "));for(let Be=0,Re=$e.length;Be<Re;)switch($e[Be++]){case"m":k=$e[Be++]*e+c,F=$e[Be++]*e+d,B.moveTo(k,F);break;case"l":k=$e[Be++]*e+c,F=$e[Be++]*e+d,B.lineTo(k,F);break;case"q":V=$e[Be++]*e+c,te=$e[Be++]*e+d,ce=$e[Be++]*e+c,ue=$e[Be++]*e+d,B.quadraticCurveTo(ce,ue,V,te);break;case"b":V=$e[Be++]*e+c,te=$e[Be++]*e+d,ce=$e[Be++]*e+c,ue=$e[Be++]*e+d,_e=$e[Be++]*e+c,Ee=$e[Be++]*e+d,B.bezierCurveTo(ce,ue,_e,Ee,V,te)}}return{offsetX:S.ha*e,path:B}}Vm.prototype.isFont=!0;class u_ extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=new Or(this.manager);B.setPath(this.path),B.setRequestHeader(this.requestHeader),B.setWithCredentials(S.withCredentials),B.load(e,function(k){let F;try{F=JSON.parse(k)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),F=JSON.parse(k.substring(65,k.length-2))}const V=S.parse(F);c&&c(V)},d,_)}parse(e){return new Vm(e)}}let Sl;const cm={getContext:function(){return void 0===Sl&&(Sl=new(window.AudioContext||window.webkitAudioContext)),Sl},setContext:function(w){Sl=w}};class Wm extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,B=new Or(this.manager);B.setResponseType("arraybuffer"),B.setPath(this.path),B.setRequestHeader(this.requestHeader),B.setWithCredentials(this.withCredentials),B.load(e,function(k){try{const F=k.slice(0);cm.getContext().decodeAudioData(F,function(V){c(V)})}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}}class um extends Zd{constructor(e,c,d=1){super(void 0,d);const _=(new er).set(e),S=(new er).set(c),B=new ht(_.r,_.g,_.b),k=new ht(S.r,S.g,S.b),F=Math.sqrt(Math.PI),V=F*Math.sqrt(.75);this.sh.coefficients[0].copy(B).add(k).multiplyScalar(F),this.sh.coefficients[1].copy(B).sub(k).multiplyScalar(V)}}um.prototype.isHemisphereLightProbe=!0;class kf extends Zd{constructor(e,c=1){super(void 0,c);const d=(new er).set(e);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}}kf.prototype.isAmbientLightProbe=!0;const hm=new tn,pm=new tn;class h_{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Po,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Po,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const c=this._cache;if(c.focus!==e.focus||c.fov!==e.fov||c.aspect!==e.aspect*this.aspect||c.near!==e.near||c.far!==e.far||c.zoom!==e.zoom||c.eyeSep!==this.eyeSep){c.focus=e.focus,c.fov=e.fov,c.aspect=e.aspect*this.aspect,c.near=e.near,c.far=e.far,c.zoom=e.zoom,c.eyeSep=this.eyeSep;const d=e.projectionMatrix.clone(),_=c.eyeSep/2,S=_*c.near/c.focus,B=c.near*Math.tan(Ho*c.fov*.5)/c.zoom;let k,F;pm.elements[12]=-_,hm.elements[12]=_,k=-B*c.aspect+S,F=B*c.aspect+S,d.elements[0]=2*c.near/(F-k),d.elements[8]=(F+k)/(F-k),this.cameraL.projectionMatrix.copy(d),k=-B*c.aspect-S,F=B*c.aspect-S,d.elements[0]=2*c.near/(F-k),d.elements[8]=(F+k)/(F-k),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(pm),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(hm)}}class dm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=p_(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=p_();e=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=e}return e}}function p_(){return(typeof performance>"u"?Date:performance).now()}const Td=new ht,qm=new $i,Xm=new ht,Md=new ht;class fm extends Pr{constructor(){super(),this.type="AudioListener",this.context=cm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const c=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Td,qm,Xm),Md.set(0,0,-1).applyQuaternion(qm),c.positionX){const _=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(Td.x,_),c.positionY.linearRampToValueAtTime(Td.y,_),c.positionZ.linearRampToValueAtTime(Td.z,_),c.forwardX.linearRampToValueAtTime(Md.x,_),c.forwardY.linearRampToValueAtTime(Md.y,_),c.forwardZ.linearRampToValueAtTime(Md.z,_),c.upX.linearRampToValueAtTime(d.x,_),c.upY.linearRampToValueAtTime(d.y,_),c.upZ.linearRampToValueAtTime(d.z,_)}else c.setPosition(Td.x,Td.y,Td.z),c.setOrientation(Md.x,Md.y,Md.z,d.x,d.y,d.z)}}class Ff extends Pr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const pp=new ht,Ym=new $i,yf=new ht,zu=new ht;class mm extends Ff{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,c,d){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=d,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(pp,Ym,yf),zu.set(0,0,1).applyQuaternion(Ym);const c=this.panner;if(c.positionX){const d=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(pp.x,d),c.positionY.linearRampToValueAtTime(pp.y,d),c.positionZ.linearRampToValueAtTime(pp.z,d),c.orientationX.linearRampToValueAtTime(zu.x,d),c.orientationY.linearRampToValueAtTime(zu.y,d),c.orientationZ.linearRampToValueAtTime(zu.z,d)}else c.setPosition(pp.x,pp.y,pp.z),c.setOrientation(zu.x,zu.y,zu.z)}}class _m{constructor(e,c=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const c=this.getFrequencyData();for(let d=0;d<c.length;d++)e+=c[d];return e/c.length}}class Jm{constructor(e,c,d){let _,S,B;switch(this.binding=e,this.valueSize=d,c){case"quaternion":_=this._slerp,S=this._slerpAdditive,B=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*d),this._workIndex=5;break;case"string":case"bool":_=this._select,S=this._select,B=this._setAdditiveIdentityOther,this.buffer=new Array(5*d);break;default:_=this._lerp,S=this._lerpAdditive,B=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*d)}this._mixBufferRegion=_,this._mixBufferRegionAdditive=S,this._setIdentity=B,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,c){const d=this.buffer,_=this.valueSize,S=e*_+_;let B=this.cumulativeWeight;if(0===B){for(let k=0;k!==_;++k)d[S+k]=d[k];B=c}else B+=c,this._mixBufferRegion(d,S,0,c/B,_);this.cumulativeWeight=B}accumulateAdditive(e){const c=this.buffer,d=this.valueSize,_=d*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,_,0,e,d),this.cumulativeWeightAdditive+=e}apply(e){const c=this.valueSize,d=this.buffer,_=e*c+c,S=this.cumulativeWeight,B=this.cumulativeWeightAdditive,k=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,S<1&&this._mixBufferRegion(d,_,c*this._origIndex,1-S,c),B>0&&this._mixBufferRegionAdditive(d,_,this._addIndex*c,1,c);for(let F=c,V=c+c;F!==V;++F)if(d[F]!==d[F+c]){k.setValue(d,_);break}}saveOriginalState(){const c=this.buffer,d=this.valueSize,_=d*this._origIndex;this.binding.getValue(c,_);for(let S=d,B=_;S!==B;++S)c[S]=c[_+S%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,c=e+this.valueSize;for(let d=e;d<c;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[c+d]=this.buffer[e+d]}_select(e,c,d,_,S){if(_>=.5)for(let B=0;B!==S;++B)e[c+B]=e[d+B]}_slerp(e,c,d,_){$i.slerpFlat(e,c,e,c,e,d,_)}_slerpAdditive(e,c,d,_,S){const B=this._workIndex*S;$i.multiplyQuaternionsFlat(e,B,e,c,e,d),$i.slerpFlat(e,c,e,c,e,B,_)}_lerp(e,c,d,_,S){const B=1-_;for(let k=0;k!==S;++k){const F=c+k;e[F]=e[F]*B+e[d+k]*_}}_lerpAdditive(e,c,d,_,S){for(let B=0;B!==S;++B){const k=c+B;e[k]=e[k]+e[d+B]*_}}}const od="\\[\\]\\.:\\/",bf=new RegExp("["+od+"]","g"),Zm="[^"+od+"]",d_="[^"+od.replace("\\.","")+"]",f_=/((?:WC+[\/:])*)/.source.replace("WC",Zm),xf=/(WCOD+)?/.source.replace("WCOD",d_),Df=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Zm),gm=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Zm),m_=new RegExp("^"+f_+xf+Df+gm+"$"),vm=["material","materials","bones"];class mo{constructor(e,c,d){this.path=c,this.parsedPath=d||mo.parseTrackName(c),this.node=mo.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,c,d){return e&&e.isAnimationObjectGroup?new mo.Composite(e,c,d):new mo(e,c,d)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(bf,"")}static parseTrackName(e){const c=m_.exec(e);if(!c)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const d={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]},_=d.nodeName&&d.nodeName.lastIndexOf(".");if(void 0!==_&&-1!==_){const S=d.nodeName.substring(_+1);-1!==vm.indexOf(S)&&(d.nodeName=d.nodeName.substring(0,_),d.objectName=S)}if(null===d.propertyName||0===d.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return d}static findNode(e,c){if(!c||""===c||"."===c||-1===c||c===e.name||c===e.uuid)return e;if(e.skeleton){const d=e.skeleton.getBoneByName(c);if(void 0!==d)return d}if(e.children){const d=function(S){for(let B=0;B<S.length;B++){const k=S[B];if(k.name===c||k.uuid===c)return k;const F=d(k.children);if(F)return F}return null},_=d(e.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,c){e[c]=this.targetObject[this.propertyName]}_getValue_array(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)e[c++]=d[_]}_getValue_arrayElement(e,c){e[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,c){this.resolvedProperty.toArray(e,c)}_setValue_direct(e,c){this.targetObject[this.propertyName]=e[c]}_setValue_direct_setNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++]}_setValue_array_setNeedsUpdate(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,c){this.resolvedProperty[this.propertyIndex]=e[c]}_setValue_arrayElement_setNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,c){this.resolvedProperty.fromArray(e,c)}_setValue_fromArray_setNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,c){this.bind(),this.getValue(e,c)}_setValue_unbound(e,c){this.bind(),this.setValue(e,c)}bind(){let e=this.node;const c=this.parsedPath,d=c.objectName,_=c.propertyName;let S=c.propertyIndex;if(e||(e=mo.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(d){let V=c.objectIndex;switch(d){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let te=0;te<e.length;te++)if(e[te].name===V){V=te;break}break;default:if(void 0===e[d])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[d]}if(void 0!==V){if(void 0===e[V])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[V]}}const B=e[_];if(void 0===B)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+c.nodeName+"."+_+" but it wasn't found.",e);let k=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?k=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(k=this.Versioning.MatrixWorldNeedsUpdate);let F=this.BindingType.Direct;if(void 0!==S){if("morphTargetInfluences"===_){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[S]&&(S=e.morphTargetDictionary[S])}F=this.BindingType.ArrayElement,this.resolvedProperty=B,this.propertyIndex=S}else void 0!==B.fromArray&&void 0!==B.toArray?(F=this.BindingType.HasFromToArray,this.resolvedProperty=B):Array.isArray(B)?(F=this.BindingType.EntireArray,this.resolvedProperty=B):this.propertyName=_;this.getValue=this.GetterByBindingType[F],this.setValue=this.SetterByBindingTypeAndVersioning[F][k]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}mo.Composite=class{constructor(w,e,c){const d=c||mo.parseTrackName(e);this._targetGroup=w,this._bindings=w.subscribe_(e,d)}getValue(w,e){this.bind();const d=this._bindings[this._targetGroup.nCachedObjects_];void 0!==d&&d.getValue(w,e)}setValue(w,e){const c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,_=c.length;d!==_;++d)c[d].setValue(w,e)}bind(){const w=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=w.length;e!==c;++e)w[e].bind()}unbind(){const w=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=w.length;e!==c;++e)w[e].unbind()}},mo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},mo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},mo.prototype.GetterByBindingType=[mo.prototype._getValue_direct,mo.prototype._getValue_array,mo.prototype._getValue_arrayElement,mo.prototype._getValue_toArray],mo.prototype.SetterByBindingTypeAndVersioning=[[mo.prototype._setValue_direct,mo.prototype._setValue_direct_setNeedsUpdate,mo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_array,mo.prototype._setValue_array_setNeedsUpdate,mo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_arrayElement,mo.prototype._setValue_arrayElement_setNeedsUpdate,mo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_fromArray,mo.prototype._setValue_fromArray_setNeedsUpdate,mo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Qd{constructor(){this.uuid=Qi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let d=0,_=arguments.length;d!==_;++d)e[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const e=this._objects,c=this._indicesByUUID,d=this._paths,_=this._parsedPaths,S=this._bindings,B=S.length;let k,F=e.length,V=this.nCachedObjects_;for(let te=0,ce=arguments.length;te!==ce;++te){const ue=arguments[te],_e=ue.uuid;let Ee=c[_e];if(void 0===Ee){Ee=F++,c[_e]=Ee,e.push(ue);for(let $e=0,Be=B;$e!==Be;++$e)S[$e].push(new mo(ue,d[$e],_[$e]))}else if(Ee<V){k=e[Ee];const $e=--V,Be=e[$e];c[Be.uuid]=Ee,e[Ee]=Be,c[_e]=$e,e[$e]=ue;for(let Re=0,We=B;Re!==We;++Re){const tt=S[Re];let ot=tt[Ee];tt[Ee]=tt[$e],void 0===ot&&(ot=new mo(ue,d[Re],_[Re])),tt[$e]=ot}}else e[Ee]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=V}remove(){const e=this._objects,c=this._indicesByUUID,d=this._bindings,_=d.length;let S=this.nCachedObjects_;for(let B=0,k=arguments.length;B!==k;++B){const F=arguments[B],V=F.uuid,te=c[V];if(void 0!==te&&te>=S){const ce=S++,ue=e[ce];c[ue.uuid]=te,e[te]=ue,c[V]=ce,e[ce]=F;for(let _e=0,Ee=_;_e!==Ee;++_e){const $e=d[_e],Re=$e[te];$e[te]=$e[ce],$e[ce]=Re}}}this.nCachedObjects_=S}uncache(){const e=this._objects,c=this._indicesByUUID,d=this._bindings,_=d.length;let S=this.nCachedObjects_,B=e.length;for(let k=0,F=arguments.length;k!==F;++k){const V=arguments[k].uuid,te=c[V];if(void 0!==te)if(delete c[V],te<S){const ce=--S,ue=e[ce],_e=--B,Ee=e[_e];c[ue.uuid]=te,e[te]=ue,c[Ee.uuid]=ce,e[ce]=Ee,e.pop();for(let $e=0,Be=_;$e!==Be;++$e){const Re=d[$e],tt=Re[_e];Re[te]=Re[ce],Re[ce]=tt,Re.pop()}}else{const ce=--B,ue=e[ce];ce>0&&(c[ue.uuid]=te),e[te]=ue,e.pop();for(let _e=0,Ee=_;_e!==Ee;++_e){const $e=d[_e];$e[te]=$e[ce],$e.pop()}}}this.nCachedObjects_=S}subscribe_(e,c){const d=this._bindingsIndicesByPath;let _=d[e];const S=this._bindings;if(void 0!==_)return S[_];const B=this._paths,k=this._parsedPaths,F=this._objects,te=this.nCachedObjects_,ce=new Array(F.length);_=S.length,d[e]=_,B.push(e),k.push(c),S.push(ce);for(let ue=te,_e=F.length;ue!==_e;++ue)ce[ue]=new mo(F[ue],e,c);return ce}unsubscribe_(e){const c=this._bindingsIndicesByPath,d=c[e];if(void 0!==d){const _=this._paths,S=this._parsedPaths,B=this._bindings,k=B.length-1,F=B[k];c[e[k]]=d,B[d]=F,B.pop(),S[d]=S[k],S.pop(),_[d]=_[k],_.pop()}}}Qd.prototype.isAnimationObjectGroup=!0;class ym{constructor(e,c,d=null,_=c.blendMode){this._mixer=e,this._clip=c,this._localRoot=d,this.blendMode=_;const S=c.tracks,B=S.length,k=new Array(B),F={endingStart:La,endingEnd:La};for(let V=0;V!==B;++V){const te=S[V].createInterpolant(null);k[V]=te,te.settings=F}this._interpolantSettings=F,this._interpolants=k,this._propertyBindings=new Array(B),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,c){return this.loop=e,this.repetitions=c,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,c,d){if(e.fadeOut(c),this.fadeIn(c),d){const _=this._clip.duration,S=e._clip.duration,k=_/S;e.warp(1,S/_,c),this.warp(k,1,c)}return this}crossFadeTo(e,c,d){return e.crossFadeFrom(this,c,d)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,c,d){const _=this._mixer,S=_.time,B=this.timeScale;let k=this._timeScaleInterpolant;null===k&&(k=_._lendControlInterpolant(),this._timeScaleInterpolant=k);const F=k.parameterPositions,V=k.sampleValues;return F[0]=S,F[1]=S+d,V[0]=e/B,V[1]=c/B,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,c,d,_){if(!this.enabled)return void this._updateWeight(e);const S=this._startTime;if(null!==S){const F=(e-S)*d;if(F<0||0===d)return;this._startTime=null,c=d*F}c*=this._updateTimeScale(e);const B=this._updateTime(c),k=this._updateWeight(e);if(k>0){const F=this._interpolants,V=this._propertyBindings;if(this.blendMode===th)for(let te=0,ce=F.length;te!==ce;++te)F[te].evaluate(B),V[te].accumulateAdditive(k);else for(let te=0,ce=F.length;te!==ce;++te)F[te].evaluate(B),V[te].accumulate(_,k)}}_updateWeight(e){let c=0;if(this.enabled){c=this.weight;const d=this._weightInterpolant;if(null!==d){const _=d.evaluate(e)[0];c*=_,e>d.parameterPositions[1]&&(this.stopFading(),0===_&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(e){let c=0;if(!this.paused){c=this.timeScale;const d=this._timeScaleInterpolant;null!==d&&(c*=d.evaluate(e)[0],e>d.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c))}return this._effectiveTimeScale=c,c}_updateTime(e){const c=this._clip.duration,d=this.loop;let _=this.time+e,S=this._loopCount;const B=d===bc;if(0===e)return-1===S?_:B&&1==(1&S)?c-_:_;if(d===gu){-1===S&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=c)_=c;else{if(!(_<0)){this.time=_;break e}_=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===S&&(e>=0?(S=0,this._setEndings(!0,0===this.repetitions,B)):this._setEndings(0===this.repetitions,!0,B)),_>=c||_<0){const k=Math.floor(_/c);_-=c*k,S+=Math.abs(k);const F=this.repetitions-S;if(F<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=e>0?c:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===F){const V=e<0;this._setEndings(V,!V,B)}else this._setEndings(!1,!1,B);this._loopCount=S,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:k})}}else this.time=_;if(B&&1==(1&S))return c-_}return _}_setEndings(e,c,d){const _=this._interpolantSettings;d?(_.endingStart=pa,_.endingEnd=pa):(_.endingStart=e?this.zeroSlopeAtStart?pa:La:Al,_.endingEnd=c?this.zeroSlopeAtEnd?pa:La:Al)}_scheduleFading(e,c,d){const _=this._mixer,S=_.time;let B=this._weightInterpolant;null===B&&(B=_._lendControlInterpolant(),this._weightInterpolant=B);const k=B.parameterPositions,F=B.sampleValues;return k[0]=S,F[0]=c,k[1]=S+e,F[1]=d,this}}class sa extends Ds{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,c){const d=e._localRoot||this._root,_=e._clip.tracks,S=_.length,B=e._propertyBindings,k=e._interpolants,F=d.uuid,V=this._bindingsByRootAndName;let te=V[F];void 0===te&&(te={},V[F]=te);for(let ce=0;ce!==S;++ce){const ue=_[ce],_e=ue.name;let Ee=te[_e];if(void 0!==Ee)B[ce]=Ee;else{if(Ee=B[ce],void 0!==Ee){null===Ee._cacheIndex&&(++Ee.referenceCount,this._addInactiveBinding(Ee,F,_e));continue}Ee=new Jm(mo.create(d,_e,c&&c._propertyBindings[ce].binding.parsedPath),ue.ValueTypeName,ue.getValueSize()),++Ee.referenceCount,this._addInactiveBinding(Ee,F,_e),B[ce]=Ee}k[ce].resultBuffer=Ee.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const d=(e._localRoot||this._root).uuid,_=e._clip.uuid,S=this._actionsByClip[_];this._bindAction(e,S&&S.knownActions[0]),this._addInactiveAction(e,_,d)}const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==S.useCount++&&(this._lendBinding(S),S.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==--S.useCount&&(S.restoreOriginalState(),this._takeBackBinding(S))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const c=e._cacheIndex;return null!==c&&c<this._nActiveActions}_addInactiveAction(e,c,d){const _=this._actions,S=this._actionsByClip;let B=S[c];if(void 0===B)B={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,S[c]=B;else{const k=B.knownActions;e._byClipCacheIndex=k.length,k.push(e)}e._cacheIndex=_.length,_.push(e),B.actionByRoot[d]=e}_removeInactiveAction(e){const c=this._actions,d=c[c.length-1],_=e._cacheIndex;d._cacheIndex=_,c[_]=d,c.pop(),e._cacheIndex=null;const S=e._clip.uuid,B=this._actionsByClip,k=B[S],F=k.knownActions,V=F[F.length-1],te=e._byClipCacheIndex;V._byClipCacheIndex=te,F[te]=V,F.pop(),e._byClipCacheIndex=null,delete k.actionByRoot[(e._localRoot||this._root).uuid],0===F.length&&delete B[S],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==--S.referenceCount&&this._removeInactiveBinding(S)}}_lendAction(e){const c=this._actions,d=e._cacheIndex,_=this._nActiveActions++,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_takeBackAction(e){const c=this._actions,d=e._cacheIndex,_=--this._nActiveActions,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_addInactiveBinding(e,c,d){const _=this._bindingsByRootAndName,S=this._bindings;let B=_[c];void 0===B&&(B={},_[c]=B),B[d]=e,e._cacheIndex=S.length,S.push(e)}_removeInactiveBinding(e){const c=this._bindings,d=e.binding,_=d.rootNode.uuid,S=d.path,B=this._bindingsByRootAndName,k=B[_],F=c[c.length-1],V=e._cacheIndex;F._cacheIndex=V,c[V]=F,c.pop(),delete k[S],0===Object.keys(k).length&&delete B[_]}_lendBinding(e){const c=this._bindings,d=e._cacheIndex,_=this._nActiveBindings++,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_takeBackBinding(e){const c=this._bindings,d=e._cacheIndex,_=--this._nActiveBindings,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_lendControlInterpolant(){const e=this._controlInterpolants,c=this._nActiveControlInterpolants++;let d=e[c];return void 0===d&&(d=new Mt(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),d.__cacheIndex=c,e[c]=d),d}_takeBackControlInterpolant(e){const c=this._controlInterpolants,d=e.__cacheIndex,_=--this._nActiveControlInterpolants,S=c[_];e.__cacheIndex=_,c[_]=e,S.__cacheIndex=d,c[d]=S}clipAction(e,c,d){const _=c||this._root,S=_.uuid;let B="string"==typeof e?$n.findByName(_,e):e;const k=null!==B?B.uuid:e,F=this._actionsByClip[k];let V=null;if(void 0===d&&(d=null!==B?B.blendMode:eh),void 0!==F){const ce=F.actionByRoot[S];if(void 0!==ce&&ce.blendMode===d)return ce;V=F.knownActions[0],null===B&&(B=V._clip)}if(null===B)return null;const te=new ym(this,B,c,d);return this._bindAction(te,V),this._addInactiveAction(te,k,S),te}existingAction(e,c){const d=c||this._root,_=d.uuid,S="string"==typeof e?$n.findByName(d,e):e,k=this._actionsByClip[S?S.uuid:e];return void 0!==k&&k.actionByRoot[_]||null}stopAllAction(){const e=this._actions;for(let c=this._nActiveActions-1;c>=0;--c)e[c].stop();return this}update(e){const c=this._actions,d=this._nActiveActions,_=this.time+=e*=this.timeScale,S=Math.sign(e),B=this._accuIndex^=1;for(let V=0;V!==d;++V)c[V]._update(_,e,S,B);const k=this._bindings,F=this._nActiveBindings;for(let V=0;V!==F;++V)k[V].apply(B);return this}setTime(e){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const c=this._actions,d=e.uuid,_=this._actionsByClip,S=_[d];if(void 0!==S){const B=S.knownActions;for(let k=0,F=B.length;k!==F;++k){const V=B[k];this._deactivateAction(V);const te=V._cacheIndex,ce=c[c.length-1];V._cacheIndex=null,V._byClipCacheIndex=null,ce._cacheIndex=te,c[te]=ce,c.pop(),this._removeInactiveBindingsForAction(V)}delete _[d]}}uncacheRoot(e){const c=e.uuid,d=this._actionsByClip;for(const S in d){const B=d[S].actionByRoot[c];void 0!==B&&(this._deactivateAction(B),this._removeInactiveAction(B))}const _=this._bindingsByRootAndName[c];if(void 0!==_)for(const S in _){const B=_[S];B.restoreOriginalState(),this._removeInactiveBinding(B)}}uncacheAction(e,c){const d=this.existingAction(e,c);null!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}}sa.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Ad{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Ad(void 0===this.value.clone?this.value:this.value.clone())}}class Ma extends Oc{constructor(e,c,d=1){super(e,c),this.meshPerAttribute=d}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const c=super.clone(e);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(e){const c=super.toJSON(e);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}Ma.prototype.isInstancedInterleavedBuffer=!0;class Uf{constructor(e,c,d,_,S){this.buffer=e,this.type=c,this.itemSize=d,this.elementSize=_,this.count=S,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,c){return this.type=e,this.elementSize=c,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}Uf.prototype.isGLBufferAttribute=!0;class $d{constructor(e,c,d=0,_=1/0){this.ray=new fn(e,c),this.near=d,this.far=_,this.camera=null,this.layers=new Qs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,c){this.ray.set(e,c)}setFromCamera(e,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(e,c=!1,d=[]){return Kd(e,this,d,c),d.sort(wf),d}intersectObjects(e,c=!1,d=[]){for(let _=0,S=e.length;_<S;_++)Kd(e[_],this,d,c);return d.sort(wf),d}}function wf(w,e){return w.distance-e.distance}function Kd(w,e,c,d){if(w.layers.test(e.layers)&&w.raycast(e,c),!0===d){const _=w.children;for(let S=0,B=_.length;S<B;S++)Kd(_[S],e,c,!0)}}class __{constructor(e=1,c=0,d=0){return this.radius=e,this.phi=c,this.theta=d,this}set(e,c,d){return this.radius=e,this.phi=c,this.theta=d,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,d){return this.radius=Math.sqrt(e*e+c*c+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,d),this.phi=Math.acos(Hr(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class bm{constructor(e=1,c=0,d=0){return this.radius=e,this.theta=c,this.y=d,this}set(e,c,d){return this.radius=e,this.theta=c,this.y=d,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,d){return this.radius=Math.sqrt(e*e+d*d),this.theta=Math.atan2(e,d),this.y=c,this}clone(){return(new this.constructor).copy(this)}}const xm=new zn;class mh{constructor(e=new zn(1/0,1/0),c=new zn(-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromPoints(e){this.makeEmpty();for(let c=0,d=e.length;c<d;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const d=xm.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return xm.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}mh.prototype.isBox2=!0;const Sf=new ht,_h=new ht;class Qm{constructor(e=new ht,c=new ht){this.start=e,this.end=c}set(e,c){return this.start.copy(e),this.end.copy(c),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,c){return this.delta(c).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,c){Sf.subVectors(e,this.start),_h.subVectors(this.end,this.start);const d=_h.dot(_h);let _=_h.dot(Sf)/d;return c&&(_=Hr(_,0,1)),_}closestPointToPoint(e,c,d){const _=this.closestPointToPointParameter(e,c);return this.delta(d).multiplyScalar(_).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class Km extends Pr{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}Km.prototype.isImmediateRenderObject=!0;const ef=new ht;class zp extends Pr{constructor(e,c){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const d=new br,_=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let B=0,k=1,F=32;B<F;B++,k++){const V=B/F*Math.PI*2,te=k/F*Math.PI*2;_.push(Math.cos(V),Math.sin(V),1,Math.cos(te),Math.sin(te),1)}d.setAttribute("position",new hn(_,3));const S=new kt({fog:!1,toneMapped:!1});this.cone=new fr(d,S),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,c=e*Math.tan(this.light.angle);this.cone.scale.set(c,c,e),ef.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ef),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const jp=new ht,Cd=new tn,wm=new tn;class zf extends fr{constructor(e){const c=Sm(e),d=new br,_=[],S=[],B=new er(0,0,1),k=new er(0,1,0);for(let F=0;F<c.length;F++){const V=c[F];V.parent&&V.parent.isBone&&(_.push(0,0,0),_.push(0,0,0),S.push(B.r,B.g,B.b),S.push(k.r,k.g,k.b))}d.setAttribute("position",new hn(_,3)),d.setAttribute("color",new hn(S,3)),super(d,new kt({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=c,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const c=this.bones,d=this.geometry,_=d.getAttribute("position");wm.copy(this.root.matrixWorld).invert();for(let S=0,B=0;S<c.length;S++){const k=c[S];k.parent&&k.parent.isBone&&(Cd.multiplyMatrices(wm,k.matrixWorld),jp.setFromMatrixPosition(Cd),_.setXYZ(B,jp.x,jp.y,jp.z),Cd.multiplyMatrices(wm,k.parent.matrixWorld),jp.setFromMatrixPosition(Cd),_.setXYZ(B+1,jp.x,jp.y,jp.z),B+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Sm(w){const e=[];w&&w.isBone&&e.push(w);for(let c=0;c<w.children.length;c++)e.push.apply(e,Sm(w.children[c]));return e}class tf extends Ro{constructor(e,c,d){super(new p(c,4,2),new fl({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ef=new ht,e_=new er,Em=new er;class M_ extends Pr{constructor(e,c,d){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=d;const _=new xr(c);_.rotateY(.5*Math.PI),this.material=new fl({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const S=_.getAttribute("position"),B=new Float32Array(3*S.count);_.setAttribute("color",new Pi(B,3)),this.add(new Ro(_,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=e.geometry.getAttribute("color");e_.copy(this.light.color),Em.copy(this.light.groundColor);for(let d=0,_=c.count;d<_;d++){const S=d<_/2?e_:Em;c.setXYZ(d,S.r,S.g,S.b)}c.needsUpdate=!0}e.lookAt(Ef.setFromMatrixPosition(this.light.matrixWorld).negate())}}class t_ extends fr{constructor(e=10,c=10,d=4473924,_=8947848){d=new er(d),_=new er(_);const S=c/2,B=e/c,k=e/2,F=[],V=[];for(let ce=0,ue=0,_e=-k;ce<=c;ce++,_e+=B){F.push(-k,0,_e,k,0,_e),F.push(_e,0,-k,_e,0,k);const Ee=ce===S?d:_;Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3}const te=new br;te.setAttribute("position",new hn(F,3)),te.setAttribute("color",new hn(V,3)),super(te,new kt({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Tm extends fr{constructor(e=10,c=16,d=8,_=64,S=4473924,B=8947848){S=new er(S),B=new er(B);const k=[],F=[];for(let te=0;te<=c;te++){const ce=te/c*(2*Math.PI),ue=Math.sin(ce)*e,_e=Math.cos(ce)*e;k.push(0,0,0),k.push(ue,0,_e);const Ee=1&te?S:B;F.push(Ee.r,Ee.g,Ee.b),F.push(Ee.r,Ee.g,Ee.b)}for(let te=0;te<=d;te++){const ce=1&te?S:B,ue=e-e/d*te;for(let _e=0;_e<_;_e++){let Ee=_e/_*(2*Math.PI),$e=Math.sin(Ee)*ue,Be=Math.cos(Ee)*ue;k.push($e,0,Be),F.push(ce.r,ce.g,ce.b),Ee=(_e+1)/_*(2*Math.PI),$e=Math.sin(Ee)*ue,Be=Math.cos(Ee)*ue,k.push($e,0,Be),F.push(ce.r,ce.g,ce.b)}}const V=new br;V.setAttribute("position",new hn(k,3)),V.setAttribute("color",new hn(F,3)),super(V,new kt({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const n_=new ht,jf=new ht,g_=new ht;class A_ extends Pr{constructor(e,c,d){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,void 0===c&&(c=1);let _=new br;_.setAttribute("position",new hn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const S=new kt({fog:!1,toneMapped:!1});this.lightPlane=new Da(_,S),this.add(this.lightPlane),_=new br,_.setAttribute("position",new hn([0,0,0,0,0,1],3)),this.targetLine=new Da(_,S),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){n_.setFromMatrixPosition(this.light.matrixWorld),jf.setFromMatrixPosition(this.light.target.matrixWorld),g_.subVectors(jf,n_),this.lightPlane.lookAt(jf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(jf),this.targetLine.scale.z=g_.length()}}const Mm=new ht,Aa=new Rl;class $_ extends fr{constructor(e){const c=new br,d=new kt({color:16777215,vertexColors:!0,toneMapped:!1}),_=[],S=[],B={},k=new er(16755200),F=new er(16711680),V=new er(43775),te=new er(16777215),ce=new er(3355443);function ue(Ee,$e,Be){_e(Ee,Be),_e($e,Be)}function _e(Ee,$e){_.push(0,0,0),S.push($e.r,$e.g,$e.b),void 0===B[Ee]&&(B[Ee]=[]),B[Ee].push(_.length/3-1)}ue("n1","n2",k),ue("n2","n4",k),ue("n4","n3",k),ue("n3","n1",k),ue("f1","f2",k),ue("f2","f4",k),ue("f4","f3",k),ue("f3","f1",k),ue("n1","f1",k),ue("n2","f2",k),ue("n3","f3",k),ue("n4","f4",k),ue("p","n1",F),ue("p","n2",F),ue("p","n3",F),ue("p","n4",F),ue("u1","u2",V),ue("u2","u3",V),ue("u3","u1",V),ue("c","t",te),ue("p","c",ce),ue("cn1","cn2",ce),ue("cn3","cn4",ce),ue("cf1","cf2",ce),ue("cf3","cf4",ce),c.setAttribute("position",new hn(_,3)),c.setAttribute("color",new hn(S,3)),super(c,d),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=B,this.update()}update(){const e=this.geometry,c=this.pointMap;Aa.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ha("c",c,e,Aa,0,0,-1),Ha("t",c,e,Aa,0,0,1),Ha("n1",c,e,Aa,-1,-1,-1),Ha("n2",c,e,Aa,1,-1,-1),Ha("n3",c,e,Aa,-1,1,-1),Ha("n4",c,e,Aa,1,1,-1),Ha("f1",c,e,Aa,-1,-1,1),Ha("f2",c,e,Aa,1,-1,1),Ha("f3",c,e,Aa,-1,1,1),Ha("f4",c,e,Aa,1,1,1),Ha("u1",c,e,Aa,.7,1.1,-1),Ha("u2",c,e,Aa,-.7,1.1,-1),Ha("u3",c,e,Aa,0,2,-1),Ha("cf1",c,e,Aa,-1,0,1),Ha("cf2",c,e,Aa,1,0,1),Ha("cf3",c,e,Aa,0,-1,1),Ha("cf4",c,e,Aa,0,1,1),Ha("cn1",c,e,Aa,-1,0,-1),Ha("cn2",c,e,Aa,1,0,-1),Ha("cn3",c,e,Aa,0,-1,-1),Ha("cn4",c,e,Aa,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ha(w,e,c,d,_,S,B){Mm.set(_,S,B).unproject(d);const k=e[w];if(void 0!==k){const F=c.getAttribute("position");for(let V=0,te=k.length;V<te;V++)F.setXYZ(k[V],Mm.x,Mm.y,Mm.z)}}const Am=new Ui;class v_ extends fr{constructor(e,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new Float32Array(24),S=new br;S.setIndex(new Pi(d,1)),S.setAttribute("position",new Pi(_,3)),super(S,new kt({color:c,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Am.setFromObject(this.object),Am.isEmpty())return;const c=Am.min,d=Am.max,_=this.geometry.attributes.position,S=_.array;S[0]=d.x,S[1]=d.y,S[2]=d.z,S[3]=c.x,S[4]=d.y,S[5]=d.z,S[6]=c.x,S[7]=c.y,S[8]=d.z,S[9]=d.x,S[10]=c.y,S[11]=d.z,S[12]=d.x,S[13]=d.y,S[14]=c.z,S[15]=c.x,S[16]=d.y,S[17]=c.z,S[18]=c.x,S[19]=c.y,S[20]=c.z,S[21]=d.x,S[22]=c.y,S[23]=c.z,_.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return fr.prototype.copy.call(this,e),this.object=e.object,this}}class C_ extends fr{constructor(e,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new br;_.setIndex(new Pi(d,1)),_.setAttribute("position",new hn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(_,new kt({color:c,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class L_ extends Da{constructor(e,c=1,d=16776960){const _=d,S=new br;S.setAttribute("position",new hn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),S.computeBoundingSphere(),super(S,new kt({color:_,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=c;const B=new br;B.setAttribute("position",new hn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),B.computeBoundingSphere(),this.add(new Ro(B,new fl({color:_,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?q:le,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const y_=new ht;let $m,r_;class B_ extends Pr{constructor(e=new ht(0,0,1),c=new ht(0,0,0),d=1,_=16776960,S=.2*d,B=.2*S){super(),this.type="ArrowHelper",void 0===$m&&($m=new br,$m.setAttribute("position",new hn([0,0,0,0,1,0],3)),r_=new rl(0,.5,1,5,1),r_.translate(0,-.5,0)),this.position.copy(c),this.line=new Da($m,new kt({color:_,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ro(r_,new fl({color:_,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(d,S,B)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{y_.set(e.z,0,-e.x).normalize();const c=Math.acos(e.y);this.quaternion.setFromAxisAngle(y_,c)}}setLength(e,c=.2*e,d=.2*c){this.line.scale.set(1,Math.max(1e-4,e-c),1),this.line.updateMatrix(),this.cone.scale.set(d,c,d),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class b_ extends fr{constructor(e=1){const c=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],d=new br;d.setAttribute("position",new hn(c,3)),d.setAttribute("color",new hn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(d,new kt({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,c,d){const _=new er,S=this.geometry.attributes.color.array;return _.set(e),_.toArray(S,0),_.toArray(S,3),_.set(c),_.toArray(S,6),_.toArray(S,9),_.set(d),_.toArray(S,12),_.toArray(S,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const x_=new Float32Array(1),N_=new Int32Array(x_.buffer);class R_{static toHalfFloat(e){x_[0]=e;const c=N_[0];let d=c>>16&32768,_=c>>12&2047;const S=c>>23&255;return S<103?d:S>142?(d|=31744,d|=(255==S?0:1)&&8388607&c,d):S<113?(_|=2048,d|=(_>>114-S)+(_>>113-S&1),d):(d|=S-112<<10|_>>1,d+=1&_,d)}}const P_=0,I_=1,O_=0,k_=1,F_=2;function D_(w){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),w}function U_(w=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),w.isMultiMaterial=!0,w.materials=w,w.clone=function(){return w.slice()},w}function w_(w,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ra(w,e)}function S_(w){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Fc(w)}function i_(w,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ra(w,e)}function z_(w){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function j_(w){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function G_(w){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function H_(w,e,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ht(w,e,c)}function V_(w,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Pi(w,e).setUsage(Br)}function W_(w,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Pd(w,e)}function q_(w,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Cp(w,e)}function X_(w,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ra(w,e)}function Y_(w,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new oh(w,e)}function J_(w,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new sh(w,e)}function Z_(w,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Pa(w,e)}function Q_(w,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new li(w,e)}function t(w,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new hn(w,e)}function u(w,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Qc(w,e)}function m(w){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new b_(w)}function g(w,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new v_(w,e)}function E(w,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new fr(new lu(w.geometry),new kt({color:void 0!==e?e:16777215}))}function I(w,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new fr(new U(w.geometry),new kt({color:void 0!==e?e:16777215}))}function G(w){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Or(w)}function Z(w){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new cs(w)}function J(w,e,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Bc(w,c)}function K(){console.error("THREE.CanvasRenderer has been removed")}function me(){console.error("THREE.JSONLoader has been removed.")}Ua.create=function(w,e){return console.log("THREE.Curve.create() has been deprecated"),w.prototype=Object.create(Ua.prototype),w.prototype.constructor=w,w.prototype.getPoint=e,w},ks.prototype.fromPoints=function(w){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(w)},t_.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},zf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Yn.prototype.extractUrlBase=function(w){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),vf.extractUrlBase(w)},Yn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},mh.prototype.center=function(w){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(w)},mh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},mh.prototype.isIntersectionBox=function(w){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},mh.prototype.size=function(w){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(w)},Ui.prototype.center=function(w){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(w)},Ui.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ui.prototype.isIntersectionBox=function(w){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},Ui.prototype.isIntersectionSphere=function(w){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(w)},Ui.prototype.size=function(w){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(w)},xo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Dr.prototype.setFromMatrix=function(w){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(w)},Qm.prototype.center=function(w){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(w)},lt.prototype.flattenToArrayOffset=function(w,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(w,e)},lt.prototype.multiplyVector3=function(w){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),w.applyMatrix3(this)},lt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},lt.prototype.applyToBufferAttribute=function(w){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),w.applyMatrix3(this)},lt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},lt.prototype.getInverse=function(w){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(w).invert()},tn.prototype.extractPosition=function(w){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(w)},tn.prototype.flattenToArrayOffset=function(w,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(w,e)},tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ht).setFromMatrixColumn(this,3)},tn.prototype.setRotationFromQuaternion=function(w){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(w)},tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tn.prototype.multiplyVector3=function(w){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.multiplyVector4=function(w){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tn.prototype.rotateAxis=function(w){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),w.transformDirection(this)},tn.prototype.crossVector=function(w){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tn.prototype.applyToBufferAttribute=function(w){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tn.prototype.makeFrustum=function(w,e,c,d,_,S){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(w,e,d,c,_,S)},tn.prototype.getInverse=function(w){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(w).invert()},Ia.prototype.isIntersectionLine=function(w){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(w)},$i.prototype.multiplyVector3=function(w){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),w.applyQuaternion(this)},$i.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},fn.prototype.isIntersectionBox=function(w){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},fn.prototype.isIntersectionPlane=function(w){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(w)},fn.prototype.isIntersectionSphere=function(w){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(w)},eo.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},eo.prototype.barycoordFromPoint=function(w,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(w,e)},eo.prototype.midpoint=function(w){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(w)},eo.prototypenormal=function(w){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(w)},eo.prototype.plane=function(w){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(w)},eo.barycoordFromPoint=function(w,e,c,d,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),eo.getBarycoord(w,e,c,d,_)},eo.normal=function(w,e,c,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),eo.getNormal(w,e,c,d)},qs.prototype.extractAllPoints=function(w){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(w)},qs.prototype.extrude=function(w){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ja(this,w)},qs.prototype.makeGeometry=function(w){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new h(this,w)},zn.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},zn.prototype.distanceToManhattan=function(w){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(w)},zn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ht.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ht.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ht.prototype.getPositionFromMatrix=function(w){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(w)},ht.prototype.getScaleFromMatrix=function(w){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(w)},ht.prototype.getColumnFromMatrix=function(w,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,w)},ht.prototype.applyProjection=function(w){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(w)},ht.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},ht.prototype.distanceToManhattan=function(w){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(w)},ht.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Di.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},Di.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Pr.prototype.getChildByName=function(w){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(w)},Pr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Pr.prototype.translate=function(w,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,w)},Pr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Pr.prototype.applyMatrix=function(w){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(w)},Object.defineProperties(Pr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(w){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=w}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ro.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ro.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Vh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),zl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Po.prototype.setLens=function(w,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(w)},Object.defineProperties(Hl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(w){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=w}},shadowCameraLeft:{set:function(w){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=w}},shadowCameraRight:{set:function(w){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=w}},shadowCameraTop:{set:function(w){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=w}},shadowCameraBottom:{set:function(w){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=w}},shadowCameraNear:{set:function(w){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=w}},shadowCameraFar:{set:function(w){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=w}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(w){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=w}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(w){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=w}},shadowMapHeight:{set:function(w){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=w}}}),Object.defineProperties(Pi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Br},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Br)}}}),Pi.prototype.setDynamic=function(w){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===w?Br:bi),this},Pi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Pi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},br.prototype.addIndex=function(w){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(w)},br.prototype.addAttribute=function(w,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===w?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(w,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(w,new Pi(arguments[1],arguments[2])))},br.prototype.addDrawCall=function(w,e,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(w,e)},br.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},br.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},br.prototype.removeAttribute=function(w){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(w)},br.prototype.applyMatrix=function(w){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(w)},Object.defineProperties(br.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Oc.prototype.setDynamic=function(w){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===w?Br:bi),this},Oc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ja.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},ja.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},ja.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Gs.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Ad.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Cs.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new er}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(w){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=w===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(w){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=w}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Ps.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(w){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=w}}}),Yi.prototype.clearTarget=function(w,e,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(w),this.clear(e,c,d)},Yi.prototype.animate=function(w){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(w)},Yi.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Yi.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Yi.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Yi.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Yi.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Yi.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Yi.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Yi.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Yi.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Yi.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Yi.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Yi.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Yi.prototype.enableScissorTest=function(w){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(w)},Yi.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Yi.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Yi.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Yi.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Yi.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Yi.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Yi.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Yi.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Yi.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Yi.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Yi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(w){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=w}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(w){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=w}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(w){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===w?hl:Zi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(om.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(io.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(w){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=w}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(w){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=w}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(w){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=w}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(w){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=w}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(w){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=w}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(w){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=w}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(w){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=w}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(w){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=w}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(w){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=w}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(w){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=w}}}),Ff.prototype.load=function(w){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Wm).load(w,function(c){e.setBuffer(c)}),this},_m.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},gl.prototype.updateCubeMap=function(w,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(w,e)},gl.prototype.clear=function(w,e,c,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(w,e,c,d)},As.crossOrigin=void 0,As.loadTexture=function(w,e,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const _=new Ws;_.setCrossOrigin(this.crossOrigin);const S=_.load(w,c,void 0,d);return e&&(S.mapping=e),S},As.loadTextureCube=function(w,e,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const _=new Uo;_.setCrossOrigin(this.crossOrigin);const S=_.load(w,c,void 0,d);return e&&(S.mapping=e),S},As.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},As.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const ge={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Se(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=x)},980:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var process={release:{name:""}},__BRYTHON__=__BRYTHON__||{};try{eval("async function* f(){}")}catch(n){console.warn("Your browser is not fully supported. If you are using Microsoft Edge, please upgrade to the latest version")}(function(n){var o;n.isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,n.isNode=void 0!==process&&"node"===process.release.name;var l,x=(o=n.isNode?{location:{href:"",origin:"",pathname:""},navigator:{userLanguage:""}}:self).location.href;if(n.protocol=x.split(":")[0],n.BigInt=o.BigInt,void 0===n.brython_path){var L;if(n.isWebWorker)(L=o.location.href).startsWith("blob:")&&(L=L.substr(5));else{var D=document.getElementsByTagName("script");L=D[D.length-1].src}var z=L.split("/");z.pop(),l=n.brython_path=z.join("/")+"/"}else n.brython_path.endsWith("/")||(n.brython_path+="/"),l=n.brython_path;var M=(o.location.origin+o.location.pathname).split("/");M.pop();var P=n.script_dir=M.join("/");if(n.__ARGV=[],n.webworkers={},n.$py_module_path={},n.file_cache={},n.$py_src={},n.path=[l+"Lib",l+"libs",P,l+"Lib/site-packages"],n.async_enabled=!1,n.async_enabled&&(n.block={}),n.imported={},n.precompiled={},n.frames_stack=[],n.builtins={},n.builtins_scope={id:"__builtins__",module:"__builtins__",binding:{}},n.builtin_funcs={},n.builtin_classes=[],n.__getattr__=function(de){return this[de]},n.__setattr__=function(de,ye){if(!(["debug","stdout","stderr"].indexOf(de)>-1))throw n.builtins.AttributeError.$factory("__BRYTHON__ object has no attribute "+de);n[de]=ye},n.language=o.navigator.userLanguage||o.navigator.language,n.locale="C",n.charset=n.isWebWorker?"utf-8":document.characterSet||document.inputEncoding||"utf-8",n.max_int=Math.pow(2,53)-1,n.min_int=-n.max_int,n.$py_next_hash=Math.pow(2,53)-1,n.$py_UUID=0,n.lambda_magic=Math.random().toString(36).substr(2,8),n.set_func_names=function(de,ye){if(de.$infos){var he=de.$infos.__name__;de.$infos.__module__=ye,de.$infos.__qualname__=he}else de.$infos={__name__:he=de.__name__,__module__:ye,__qualname__:he};for(var ae in de.__module__=ye,de)"function"==typeof de[ae]&&(de[ae].$infos={__doc__:de[ae].__doc__||"",__module__:ye,__qualname__:he+"."+ae,__name__:ae},"classmethod"==de[ae].$type&&(de[ae].__class__=n.method))},typeof Storage<"u"){n.has_local_storage=!1;try{localStorage&&(n.local_storage=localStorage,n.has_local_storage=!0)}catch{}n.has_session_storage=!1;try{sessionStorage&&(n.session_storage=sessionStorage,n.has_session_storage=!0)}catch{}}else n.has_local_storage=!1,n.has_session_storage=!1;n.globals=function(){return n.frames_stack[n.frames_stack.length-1][3]},n.scripts={},n.$options={},n.update_VFS=function(de){n.VFS=n.VFS||{};var ye=de.$timestamp;for(var he in void 0!==ye&&delete de.$timestamp,de)n.VFS.hasOwnProperty(he)&&console.warn("Virtual File System: duplicate entry "+he),n.VFS[he]=de[he],n.VFS[he].timestamp=ye},n.add_files=function(de){for(var ye in n.files=n.files||{},de)n.files[ye]=de[ye]},n.python_to_js=function(de,ye){return n.meta_path=n.$meta_path.slice(),n.use_VFS||n.meta_path.shift(),void 0===ye&&(ye="__main__"),"(function() {\n var $locals_"+ye+" = {}\n"+__BRYTHON__.py2js(de,ye,ye).to_js()+"\n}())"},o.py=function(de){var ye=n.py2js(de[0],"script","script").to_js();n.set_import_paths(),new Function("$locals_script",ye)({})}})(__BRYTHON__),__BRYTHON__.implementation=[3,8,10,"final",0],__BRYTHON__.__MAGIC__="3.8.10",__BRYTHON__.version_info=[3,8,0,"final",0],__BRYTHON__.compiled_date="2020-10-06 14:56:18.181563",__BRYTHON__.timestamp=1601988978181,__BRYTHON__.builtin_module_names=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","array","builtins","dis","hashlib","long_int","marshal","math","math1","modulefinder","posix","random","unicodedata"],function($B){var js,$pos,res,$op;Number.isInteger=Number.isInteger||function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n},Number.isSafeInteger=Number.isSafeInteger||function(n){return Number.isInteger(n)&&Math.abs(n)<=Number.MAX_SAFE_INTEGER};var _b_=$B.builtins,_window;_window=$B.isNode?{location:{href:"",origin:"",pathname:""}}:self,$B.parser={};var clone=$B.clone=function(n){var o={};for(var l in n)o[l]=n[l];return o};$B.last=function(n){return void 0===n&&console.log($B.frames_stack.slice()),n[n.length-1]},$B.list2obj=function(n,o){var l={},x=n.length;for(void 0===o&&(o=!0);x-- >0;)l[n[x]]=o;return l},$B.op2method={operations:{"**":"pow","//":"floordiv","<<":"lshift",">>":"rshift","+":"add","-":"sub","*":"mul","/":"truediv","%":"mod","@":"matmul"},augmented_assigns:{"//=":"ifloordiv",">>=":"irshift","<<=":"ilshift","**=":"ipow","+=":"iadd","-=":"isub","*=":"imul","/=":"itruediv","%=":"imod","&=":"iand","|=":"ior","^=":"ixor","@=":"imatmul"},binary:{"&":"and","|":"or","~":"invert","^":"xor"},comparisons:{"<":"lt",">":"gt","<=":"le",">=":"ge","==":"eq","!=":"ne"},boolean:{or:"or",and:"and",in:"in",not:"not",is:"is",not_in:"not_in",is_not:"is_not"},subset:function(){var n={},o=[];if("all"==arguments[0])(o=Object.keys($B.op2method)).splice(o.indexOf("subset"),1);else for(var l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);for(l=0,x=o.length;l<x;l++){var L=o[l],D=$B.op2method[L];if(void 0===D)throw Error(L);for(var z in D)n[z]=D[z]}return n}};var $operators=$B.op2method.subset("all"),$augmented_assigns=$B.augmented_assigns=$B.op2method.augmented_assigns,noassign=$B.list2obj(["True","False","None","__debug__"]),$op_order=[["or"],["and"],["not"],["in","not_in"],["<","<=",">",">=","!=","==","is","is_not"],["|"],["^"],["&"],[">>","<<"],["+"],["-"],["*","@","/","//","%"],["unary_neg","unary_inv","unary_pos"],["**"]],$op_weight={},$weight=1;$op_order.forEach(function(n){n.forEach(function(o){$op_weight[o]=$weight}),$weight++});var $loop_num=0,create_temp_name=$B.parser.create_temp_name=function(n){return(n||"$temp")+$loop_num++},replace_node=$B.parser.replace_node=function(n,o){var l=n.parent,x=get_rank_in_parent(n);l.children[x]=o,o.parent=l,o.bindings=n.bindings},get_rank_in_parent=$B.parser.get_rank_in_parent=function(n){return n.parent.children.indexOf(n)},add_identnode=$B.parser.add_identnode=function(n,o,l,x){var L=new $Node;L.parent=n,L.locals=n.locals,L.module=n.module;var D=new $NodeCtx(L),z=new $ExprCtx(D,"id",!0),M=(new $IdCtx(z,l),new $AssignCtx(z));return-1===o?n.add(L):n.insert(o,L),M.tree[1]=x,L},chained_comp_num=0,$_SyntaxError=$B.parser.$_SyntaxError=function(n,o,l){for(var x=n;"node"!==x.type;)x=x.parent;for(var L=x.node,D=L;void 0!==D.parent;)D=D.parent;var z=L.module,M=D.src,P=L.line_num;if(M&&(P=M.substr(0,$pos).split("\n").length),D.line_info&&(P=D.line_info),void 0!==l&&"number"==typeof l)throw $B.$IndentationError(z,o,M,$pos,P,D);Array.isArray(o)&&$B.$SyntaxError(z,o[0],M,$pos,P,D),"Triple string end not found"===o&&$B.$SyntaxError(z,"invalid syntax : triple string end not found",M,$pos,P,D);var de="invalid syntax";o.startsWith("token ")||(de+=" ("+o+")"),$B.$SyntaxError(z,de,M,$pos,P,D)};function SyntaxWarning(n,o){var l=$get_node(n),x=$get_module(n),L=x.src.split("\n"),D=`Module ${x.module}line ${l.line_num}:${o}\n    `+L[l.line_num-1];$B.$getattr($B.stderr,"write")(D)}function check_assignment(n){for(var o=n,l=["assert","del","import","raise","return"];o;)l.indexOf(o.type)>-1?$_SyntaxError(n,"invalid syntax - assign"):"expr"==o.type&&"op"==o.tree[0].type&&$_SyntaxError(n,void 0!==$B.op2method.comparisons[o.tree[0].op]?["cannot assign to comparison"]:["cannot assign to operator"]),o=o.parent}var $Node=$B.parser.$Node=function(n){this.type=n,this.children=[]};$Node.prototype.add=function(n){this.children[this.children.length]=n,n.parent=this,n.module=this.module},$Node.prototype.insert=function(n,o){this.children.splice(n,0,o),o.parent=this,o.module=this.module},$Node.prototype.toString=function(){return"<object 'Node'>"},$Node.prototype.show=function(n){var o="";return"module"===this.type?(this.children.forEach(function(l){o+=l.show(n)}),o):(o+=" ".repeat(n=n||0),o+=this.C,this.children.length>0&&(o+="{"),o+="\n",this.children.forEach(function(l){o+="["+i+"] "+l.show(n+4)}),this.children.length>0&&(o+=" ".repeat(n),o+="}\n"),o)},$Node.prototype.to_js=function(n){if(void 0!==this.js)return this.js;if(this.res=[],this.unbound=[],"module"===this.type)return this.children.forEach(function(l){this.res.push(l.to_js())},this),this.js=this.res.join(""),this.js;n=n||0;var o=this.C.to_js();return o&&(this.res.push(" ".repeat(n)),this.res.push(o),this.children.length>0&&this.res.push("{"),this.res.push("\n"),this.children.forEach(function(l){this.res.push(l.to_js(n+4))},this),this.children.length>0&&(this.res.push(" ".repeat(n)),this.res.push("}\n"))),this.js=this.res.join(""),this.js},$Node.prototype.transform=function(n){if(this.has_await)return this.parent.insert(n,$NodeJS("var save_stack = $B.save_stack()")),this.parent.insert(n+2,$NodeJS("$B.restore_stack(save_stack, $locals)")),this.has_await=!1,1;if(this.has_yield&&!this.has_yield.transformed){var o=this.parent;if(this.has_yield.from){var l=new $Node,x=new $NodeCtx(l),L=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(L,`var _i${this.has_yield.from_num}`),z=new $AssignCtx(L);new $ExprCtx(z).tree=this.has_yield.tree,o.insert(n,l),$get_node(this.has_yield);var M=this.has_yield.from_num;return o.insert(n+1,$NodeJS(`$B.$import("sys",[],{})\n_i${M}=_b_.iter(_i${M})\nvar $failed${M}=false\ntry{var _y${M}=_b_.next(_i${M})}catch(_e){$B.set_exc(_e)\n$failed${M}=true\n$B.pmframe=$B.last($B.frames_stack)\n_e=$B.exception(_e)\nif(_e.__class__===_b_.StopIteration){var _r${M}=$B.$getattr(_e,"value")}else{throw _e}}\nif(! $failed${M}){while(true){var $failed1${M}=false\ntry{$B.leave_frame({$locals})\nvar _s${M}=yield _y${M}\n$B.frames_stack.push($top_frame)}catch(_e){if(_e.__class__===_b_.GeneratorExit){var $failed2${M}=false\ntry{var _m${M}=$B.$geatttr(_i${M},"close")}catch(_e1){$failed2${M}=true\nif(_e1.__class__ !==_b_.AttributeError){throw _e1}}\nif(! $failed2${M}){$B.$call(_m${M})()}\nthrow _e}else if($B.is_exc(_e,[_b_.BaseException])){var _x=$B.$call($B.$getattr($locals.sys,"exc_info"))()\nvar $failed3${M}=false\ntry{var _m${M}=$B.$getattr(_i${M},"throw")}catch(err){$failed3${M}=true\nif($B.is_exc(err,[_b_.AttributeError])){throw err}}\nif(! $failed3${M}){try{_y${M}=$B.$call(_m${M}).apply(null,_b_.list.$factory(_x${M}))}catch(err){if($B.$is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}\nif(! $failed1${M}){try{if(_s${M}===_b_.None){_y${M}=_b_.next(_i${M})}else{_y${M}=$B.$call($B.$getattr(_i${M},"send"))(_s${M})}}catch(err){if($B.is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}`)),3}o.children.splice(n,1),"abstract_expr"===this.has_yield.tree[0].type?l=$NodeJS("var result = _b_.None"):(l=new $Node,x=new $NodeCtx(l),L=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(L,"var result"),(z=new $AssignCtx(L)).tree[1]=this.has_yield.tree[0],D.parent=z),l.line_num=this.line_num,o.insert(n,l);var de=new $NodeJS("try");de.add($NodeJS("$B.leave_frame({$locals})")),de.add(this),o.insert(n+1,de),this.has_yield.to_js=function(){return"yield result"},this.has_yield.transformed=!0;for(var ye=0;ye<de.children.length;)void 0===(le=de.children[ye].transform(ye))&&(le=1),ye+=le;var he=$NodeJS(`catch(err${this.line_num})`);return he.add($NodeJS("$B.frames_stack.push($top_frame)")),he.add($NodeJS(`throw err${this.line_num}`)),o.insert(n+2,he),o.insert(n+3,$NodeJS("$B.frames_stack.push($top_frame)")),2}if("module"!==this.type){var ae,fe=this.C.tree[0];for(void 0===fe&&console.log(this),void 0!==fe.transform&&(ae=fe.transform(this,n)),ye=0;ye<this.children.length;)void 0===(le=this.children[ye].transform(ye))&&(le=1),ye+=le;return void 0===ae&&(ae=1),ae}for(this.__doc__=$get_docstring(this),ye=0;ye<this.children.length;){var le;void 0===(le=this.children[ye].transform(ye))&&(le=1),ye+=le}},$Node.prototype.clone=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];return n},$Node.prototype.clone_tree=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];n.children=[];for(var l=0,x=this.children.length;l<x;l++)n.add(this.children[l].clone_tree());return n};var $AbstractExprCtx=$B.parser.$AbstractExprCtx=function(n,o){this.type="abstract_expr",this.with_commas=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AbstractExprCtx.prototype.toString=function(){return"(abstract_expr "+this.with_commas+") "+this.tree},$AbstractExprCtx.prototype.transition=function(n,o){var l=this,x=l.packed,L=l.is_await,D=l.assign;if(!D)switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":case"yield":l.parent.tree.pop();var z=l.with_commas;(l=l.parent).packed=x,l.is_await=L,D&&(console.log("set assign to parent",l),l.assign=D)}switch(n){case"await":return new $AwaitCtx(l);case"id":return new $IdCtx(new $ExprCtx(l,"id",z),o);case"str":return new $StringCtx(new $ExprCtx(l,"str",z),o);case"bytes":return new $StringCtx(new $ExprCtx(l,"bytes",z),o);case"int":return new $NumberCtx("int",new $ExprCtx(l,"int",z),o);case"float":return new $NumberCtx("float",new $ExprCtx(l,"float",z),o);case"imaginary":return new $NumberCtx("imaginary",new $ExprCtx(l,"imaginary",z),o);case"(":return new $ListOrTupleCtx(new $ExprCtx(l,"tuple",z),"tuple");case"[":return new $ListOrTupleCtx(new $ExprCtx(l,"list",z),"list");case"{":return new $DictOrSetCtx(new $ExprCtx(l,"dict_or_set",z));case".":return new $EllipsisCtx(new $ExprCtx(l,"ellipsis",z));case"not":return"op"==l.type&&"is"==l.op?(l.op="is_not",l):new $NotCtx(new $ExprCtx(l,"not",z));case"lambda":return new $LambdaCtx(new $ExprCtx(l,"lambda",z));case"op":var M=o;switch(M){case"*":return l.parent.tree.pop(),z=l.with_commas,new $PackedCtx(new $ExprCtx(l=l.parent,"expr",z));case"-":case"~":case"+":l.parent.tree.pop();var P=new $UnaryCtx(l.parent,M);if("-"==M)var de=new $OpCtx(P,"unary_neg");else de=new $OpCtx(P,"+"==M?"unary_pos":"unary_inv");return new $AbstractExprCtx(de,!1);case"not":return l.parent.tree.pop(),z=l.with_commas,new $NotCtx(new $ExprCtx(l=l.parent,"not",z))}$_SyntaxError(l,"token "+n+" after "+l);case"=":$_SyntaxError(l,"token "+n+" after "+l);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case":":return"sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type?new $AbstractExprCtx(new $SliceCtx(l.parent),!1):$transition(l.parent,n,o);case")":case",":switch(l.parent.type){case"list_or_tuple":case"slice":case"call_arg":case"op":case"yield":break;case"annotation":$_SyntaxError(l,"empty annotation");default:$_SyntaxError(l,n)}}return $transition(l.parent,n,o)},$AbstractExprCtx.prototype.to_js=function(){return this.js_processed=!0,"list"===this.type?"["+$to_js(this.tree)+"]":$to_js(this.tree)};var $AliasCtx=$B.parser.$AliasCtx=function(n){this.type="ctx_manager_alias",this.parent=n,this.tree=[],n.tree[n.tree.length-1].alias=this};$AliasCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":case":":return l.parent.set_alias(l.tree[0].tree[0]),$transition(l.parent,n,o)}$_SyntaxError(l,"token "+n+" after "+l)};var $AnnotationCtx=$B.parser.$AnnotationCtx=function(n){this.type="annotation",this.parent=n,this.tree=[],n.annotation=this;var o=$get_scope(n);if(void 0===o.binding.__annotations__&&(o.binding.__annotations__=!0,n.create_annotations=!0),"def"==o.ntype&&n.tree&&n.tree.length>0&&"id"==n.tree[0].type){var l=n.tree[0].value;o.globals&&o.globals.has(l)>-1&&$_SyntaxError(n,["annotated name '"+l+"' can't be global"]),o.annotations=o.annotations||new Set,o.annotations.add(l),n.$in_parens||(o.binding=o.binding||{},o.binding[l]=!0)}};$AnnotationCtx.prototype.toString=function(){return"(annotation) "+this.tree},$AnnotationCtx.prototype.transition=function(n,o){var l=this;return"eol"==n&&1==l.tree.length&&0==l.tree[0].tree.length?$_SyntaxError(l,"empty annotation"):":"==n&&"def"!=l.parent.type?$_SyntaxError(l,"more than one annotation"):"augm_assign"==n?$_SyntaxError(l,"augmented assign as annotation"):"op"==n&&$_SyntaxError(l,"operator as annotation"),$transition(l.parent,n)},$AnnotationCtx.prototype.to_js=function(){return $to_js(this.tree)};var $AssertCtx=$B.parser.$AssertCtx=function(n){this.type="assert",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AssertCtx.prototype.toString=function(){return"(assert) "+this.tree},$AssertCtx.prototype.transition=function(n,o){var l=this;return","==n?(this.tree.length>1&&$_SyntaxError(l,"too many commas after assert"),new $AbstractExprCtx(this,!1)):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,n)},$AssertCtx.prototype.transform=function(n,o){if(this.tree.length>1)var l=this.tree[0],x=this.tree[1];else l=this.tree[0],x=null;"expr"==this.tree[0].type&&"tuple"==this.tree[0].name&&this.tree[0].tree[0].tree.length>1&&SyntaxWarning(this,"assertion is always true, perhaps remove parentheses?");var L=new $ConditionCtx(n.C,"if");new $NotCtx(L).tree=[l],n.C=L;var D=new $Node,z="throw _b_.AssertionError.$factory()";null!==x&&(z="throw _b_.AssertionError.$factory(_b_.str.$factory("+x.to_js()+"))"),new $NodeJSCtx(D,z),n.add(D)};var $AssignCtx=$B.parser.$AssignCtx=function(n,o){check_assignment(n),"expr"==n.type&&"lambda"==n.tree[0].type&&$_SyntaxError(n,["cannot assign to lambda"]),this.type="assign","expression"==o&&(this.expression=!0,console.log("parent of assign expr",n.parent)),n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.parent=n.parent,this.tree=[n];var l=$get_scope(this);if("expr"==n.type&&"call"==n.tree[0].type)$_SyntaxError(n,["cannot assign to function call "]);else if("list_or_tuple"==n.type||"expr"==n.type&&"list_or_tuple"==n.tree[0].type)"expr"==n.type&&(n=n.tree[0]),n.bind_ids(l);else if("assign"==n.type)n.tree.forEach(function(D){var z=D.tree[0];"id"==z.type&&$bind(z.value,l,this)},this);else{var x=n.tree[0];if(x&&"id"==x.type)if(!0===noassign[x.value]&&$_SyntaxError(n,["cannot assign to keyword"]),x.bound=!0,l.globals&&l.globals.has(x.value)){var L=$get_module(n);x.global_module=L.module,$bind(x.value,L,this)}else $get_node(this).bound_before=Object.keys(l.binding),$bind(x.value,l,this);else["str","int","float","complex"].indexOf(x.type)>-1?$_SyntaxError(n,["cannot assign to literal"]):"unary"==x.type&&$_SyntaxError(n,["cannot assign to operator"])}};$AssignCtx.prototype.guess_type=function(){},$AssignCtx.prototype.toString=function(){return"(assign) "+this.tree[0]+"="+this.tree[1]},$AssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),l.guess_type(),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AssignCtx.prototype.transform=function(n,o){for(var l=$get_scope(this),x=this.tree[0],L=this.tree[1],D=[];"assign"==x.type;)D.push(x.tree[1]),x=x.tree[0];if(D.length>0){D.push(x);var z=n.C;z.tree=[];var M=new $RawJSCtx(z,"var $temp"+$loop_num);return M.tree=z.tree,new $AssignCtx(M).tree[1]=L,D.forEach(function(Ce){"expr"==Ce.type&&"list_or_tuple"==Ce.tree[0].type&&"tuple"==Ce.tree[0].real&&1==Ce.tree[0].tree.length&&(Ce=Ce.tree[0].tree[0]);var Q=new $Node,xe=new $NodeCtx(Q);Q.locals=n.locals,Q.line_num=n.line_num,n.parent.insert(o+1,Q),Ce.parent=xe;var Pe=new $AssignCtx(Ce);new $RawJSCtx(Pe,"$temp"+$loop_num)}),$loop_num++,void(this.tree[0]=x)}var P=null;switch(x.type){case"expr":x.tree.length>1?P=x.tree:"list_or_tuple"==x.tree[0].type||"target_list"==x.tree[0].type?P=x.tree[0].tree:"id"==x.tree[0].type&&(l.globals&&l.globals.has(x.tree[0].value)||(x.tree[0].bound=!0));break;case"target_list":case"list_or_tuple":P=x.tree}if(L=this.tree[1],null!==P){var ye=null;if(("list"==L.type||"tuple"==L.type||"expr"==L.type&&L.tree.length>1)&&(ye=L.tree),null!==ye){if(ye.length>P.length)throw Error("ValueError : too many values to unpack (expected "+P.length+")");if(ye.length<P.length)throw Error("ValueError : need more than "+ye.length+" to unpack");var he=[],ae=0;(Y=new $Node).line_num=n.line_num,new $NodeJSCtx(Y,"void(0)"),he[ae++]=Y;var fe="$temp"+$loop_num;(Y=new $Node).line_num=n.line_num,new $NodeJSCtx(Y,"var "+fe+" = [], $pos = 0"),he[ae++]=Y,ye.forEach(function(Ce){var Q=fe+"[$pos++] = "+Ce.to_js(),xe=new $Node;xe.line_num=n.line_num,new $NodeJSCtx(xe,Q),he[ae++]=xe});var le=$get_node(this);P.forEach(function(Ce){var Q=new $Node;Q.id=le.module,Q.locals=le.locals,Q.line_num=n.line_num;var xe=new $NodeCtx(Q);Ce.parent=xe,new $AssignCtx(Ce,!1).tree[1]=new $JSCode(fe+"["+q+"]"),he[ae++]=Q},this),n.parent.children.splice(o,1);for(var q=he.length-1;q>=0;q--)n.parent.insert(o,he[q]);$loop_num++}else{n.parent.children.splice(o,1);var Y,A=create_temp_name("$right"),N=create_temp_name("$rlist");(Y=$NodeJS("var "+A+" = $B.$getattr($B.$iter("+L.to_js()+'), "__next__");')).line_num=n.line_num,n.parent.insert(o++,Y),n.parent.insert(o++,$NodeJS("var "+N+"=[], $pos=0;while(1){try{"+N+"[$pos++] = "+A+"()}catch(err){break}}"));var X=null,oe=P.length;for(q=0;q<P.length;q++){var H=P[q];if("packed"==H.type||"expr"==H.type&&"packed"==H.tree[0].type){X=q,oe--;break}}n.parent.insert(o++,$NodeJS("if("+N+".length<"+oe+'){throw _b_.ValueError.$factory("need more than " +'+N+'.length + " value" + ('+N+'.length > 1 ? "s" : "") + " to unpack")}')),null==X&&n.parent.insert(o++,$NodeJS("if("+N+".length>"+oe+'){throw _b_.ValueError.$factory("too many values to unpack (expected '+P.length+')")}')),P.forEach(function(Ce,Q){var xe=new $Node;xe.id=l.id,xe.line_num=n.line_num,n.parent.insert(o++,xe);var Pe=new $NodeCtx(xe);Ce.parent=Pe;var Ge=new $AssignCtx(Ce,!1),Ae=N;Ge.tree[1]=new $JSCode(Ae+=null==X||Q<X?"["+Q+"]":Q==X?".slice("+Q+","+N+".length-"+(P.length-Q-1)+")":"["+N+".length-"+(P.length-Q)+"]")}),$loop_num++}}else x.tree[0].bound&&"expr"==L.type&&"int"==L.name&&(n.bindings=n.bindings||{},n.bindings[x.tree[0].value]="int")},$AssignCtx.prototype.to_js=function(){if(this.js_processed=!0,"call"==this.parent.type)return'{$nat:"kw",name:'+this.tree[0].to_js()+",value:"+this.tree[1].to_js()+"}";for(var n=this.tree[0];"expr"==n.type&&!n.assign;)n=n.tree[0];var o=this.tree[1];if("attribute"==n.type||"sub"==n.type){var l=o.to_js(),x="",L="",D="$temp"+$loop_num;if("expr"!=o.type||void 0===o.tree[0]||"call"!=o.tree[0].type||"eval"!=o.tree[0].func.value&&"exec"!=o.tree[0].func.value?"expr"==o.type&&void 0!==o.tree[0]&&"sub"==o.tree[0].type?(x+="var "+D+" = "+l+";\n",L=D):L=l:(x+="var "+D+" = "+l+";\n",L=D),"attribute"==n.type){$loop_num++,n.func="setattr";var z=n.to_js();return n.func="getattr",n.assign_self?x+z[0]+L+z[1]+L+")":(x=(x+=z).substr(0,x.length-1))+","+L+");_b_.None;"}if("sub"==n.type){var M,P=n.value.to_js(),de="$temp"+$loop_num;return"id"==n.value.type&&(M=$get_node(this).locals[n.value.value]),$loop_num++,x="var "+de+" = "+P+"\n","list"!==M&&(x+="if(Array.isArray("+de+") && !"+de+".__class__){"),1==n.tree.length?x+="$B.set_list_key("+de+","+(n.tree[0].to_js()+""||"null")+","+o.to_js()+")":2==n.tree.length?x+="$B.set_list_slice("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+o.to_js()+")":3==n.tree.length&&(x+="$B.set_list_slice_step("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+(n.tree[2].to_js()+""||"null")+","+o.to_js()+")"),"list"==M||(x+="\n}else{",1==n.tree.length?x+="$B.$setitem("+n.value.to_js()+","+n.tree[0].to_js()+","+l+")};_b_.None;":(n.func="setitem",x=(x+=n.to_js()).substr(0,x.length-1),n.func="getitem",x+=","+l+")};_b_.None;")),x}}return n.to_js()+" = "+o.to_js()};var $AsyncCtx=$B.parser.$AsyncCtx=function(n){this.type="async",this.parent=n,n.async=!0};$AsyncCtx.prototype.toString=function(){return"(async)"},$AsyncCtx.prototype.transition=function(n,o){var l=this;if("def"==n)return $transition(l.parent,n,o);if("for"==n||"with"==n){var x=$get_scope(l).ntype;"def"!==x&&"generator"!=x&&$_SyntaxError(l,["'async "+n+"' outside async function"]);var L=$transition(l.parent,n,o);return L.parent.async=!0,L}$_SyntaxError(l,"token "+n+" after "+l)};var $AttrCtx=$B.parser.$AttrCtx=function(n){this.type="attribute",this.value=n.tree[0],this.parent=n,n.tree.pop(),n.tree[n.tree.length]=this,this.tree=[],this.func="getattr"};$AttrCtx.prototype.toString=function(){return"(attr) "+this.value+"."+this.name},$AttrCtx.prototype.transition=function(n,o){var l=this;if("id"===n){var x=o;return!0===noassign[x]&&$_SyntaxError(l,["cannot assign to "+x]),x=$mangle(x,l),l.name=x,l.parent}$_SyntaxError(l,n)},$AttrCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.value.to_js();if("setattr"==this.func&&"id"==this.value.type){var o=$get_scope(this),l=o.parent;if("def"==o.ntype&&"class"==l.ntype&&this.value.value==o.C.tree[0].positional_list[0]&&l.C&&void 0===l.C.tree[0].args)return this.assign_self=!0,[n+".__class__ && "+n+".__dict__ && !"+n+".__class__.$has_setattr && ! "+n+".$is_class ? _b_.dict.$setitem("+n+".__dict__, '"+this.name+"', ",") : $B.$setattr("+n+', "'+this.name+'", ']}return"setattr"==this.func?"$B.$setattr("+n+',"'+this.name+'")':"$B.$getattr("+n+',"'+this.name+'")'};var $AugmentedAssignCtx=$B.parser.$AugmentedAssignCtx=function(n,o){check_assignment(n),this.type="augm_assign",this.C=n,this.parent=n.parent,n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.op=o,this.tree=[n];var l=this.scope=$get_scope(this);if("expr"==n.type){var x=n.tree[0];if("id"==x.type){var L=x.value;!0===noassign[L]?$_SyntaxError(n,["cannot assign to keyword"]):"def"!=l.ntype&&"generator"!=l.ntype||void 0!==l.binding[L]||void 0!==l.globals&&l.globals.has(L)||(x.unbound=!0)}else["str","int","float","complex"].indexOf(x.type)>-1&&$_SyntaxError(n,["cannot assign to literal"])}$get_node(this).bound_before=Object.keys(l.binding),this.module=l.module};$AugmentedAssignCtx.prototype.toString=function(){return"(augm assign) "+this.tree},$AugmentedAssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AugmentedAssignCtx.prototype.transform=function(n,o){var l=this.C,x=this.op,L="__"+$operators[x]+"__",D=0,z=n.parent,M=n.line_num,P=!1;z.children.splice(o,1);var de="expr"==this.tree[0].type&&"id"==this.tree[0].tree[0].type;if(de){var ye="int"==this.tree[0].tree[0].bindingType(this.scope);if(this.tree[0].tree[0].augm_assign=!0,$B.debug>0){var he=$NodeJS("if("+this.tree[0].to_js()+" === undefined){throw _b_.NameError.$factory(\"name '"+this.tree[0].tree[0].value+"' is not defined\")}");n.parent.insert(o,he),D++}var ae=this.tree[0].tree[0].value,fe=void 0!==this.scope.binding[ae],le=this.tree[0].tree[0].unbound}var q="expr"==this.tree[1].type&&"int"==this.tree[1].tree[0].type;if(q){var Y=this.tree[1].tree[0].value,A=parseInt(Y[1],Y[0]);q=A>$B.min_int&&A<$B.max_int}var N=q?this.tree[1].tree[0].to_js():"$temp";if(!q){(Ae=new $Node).line_num=M,P=!0,new $NodeJSCtx(Ae,"var $temp,$left;"),z.insert(o,Ae),D++,(Ae=new $Node).id=this.scope.id;var X=new $NodeCtx(Ae),oe=new $ExprCtx(X,"js",!1),H=new $RawJSCtx(oe,"$temp"),Ce=new $AssignCtx(oe);Ce.tree[1]=this.tree[1],H.parent=Ce,z.insert(o+D,Ae),D++}var Q="",xe=!1;switch(x){case"+=":case"-=":case"*=":case"/=":if(de){var Pe=this.scope,Ge="$local_"+Pe.module.replace(/\./g,"_");switch(Pe.ntype){case"module":Q=Ge;break;case"def":case"generator":Q=Pe.globals&&Pe.globals.has(l.tree[0].value)?Ge:"$locals";break;case"class":var Ae=new $Node;P||(Ae.line_num=M,P=!0),new $NodeJSCtx(Ae,"var $left = "+l.to_js()),z.insert(o+D,Ae),xe=!0,D++}}}var Xe=l.tree[0].to_js();if("id"==l.tree[0].type){var Ke=l.tree[0].firstBindingScopeId(),yt=l.tree[0].value;Xe=Ke?"$locals_"+Ke.replace(/\./g,"_")+'["'+yt+'"]':'$locals["'+yt+'"]'}if(ye&&q&&"//="!=x)return z.insert(o+D,$NodeJS(Xe+" "+x+" "+N)),D++;Q=Q&&!l.tree[0].unknown_binding&&!le;var dt=x.charAt(0);if(Q){var Pt=xe?"$left":Xe;Ae=new $Node,P||(Ae.line_num=M,P=!0),Gt=q?"if(":'if(typeof $temp.valueOf() == "number" && ',Gt+=Pt+".constructor === Number",Gt+=" && Number.isSafeInteger("+Xe+dt+N+")){"+(q?"(":'(typeof $temp == "number" && ')+"typeof "+Pt+' == "number") ? ',Gt+=Xe+x+N,new $NodeJSCtx(Ae,Gt+=" : "+Xe+" = new Number("+Xe+dt+(q?N:N+".valueOf()")+")}"),z.insert(o+D,Ae),D++}if("sub"==l.tree[0].type&&("+="==x||"-="==x||"*="==x)&&1==l.tree[0].tree.length){var wt="$B.augm_item_"+{"+=":"add","-=":"sub","*=":"mul"}[x]+"("+l.tree[0].value.to_js()+","+l.tree[0].tree[0].to_js()+","+N+");_b_.None;";return Ae=new $Node,P||(Ae.line_num=M,P=!0),new $NodeJSCtx(Ae,wt),z.insert(o+D,Ae),void D++}Ae=new $Node,P||(Ae.line_num=M,P=!0);var Gt="";Q&&(Gt+="else "),Gt+="if(! _b_.hasattr("+l.to_js()+',"'+L+'"))',new $NodeJSCtx(Ae,Gt),z.insert(o+D,Ae),D++;var Dt=new $Node;Dt.id=this.scope.id,Dt.line_num=n.line_num,Ae.add(Dt);var sn=new $NodeCtx(Dt),gt=new $ExprCtx(sn,"clone",!1);le?new $RawJSCtx(gt,Xe):(gt.tree=l.tree,gt.tree.forEach(function(ir){ir.parent=gt}));var Mn=new $AssignCtx(gt),Bn=new $OpCtx(gt,x.substr(0,x.length-1));Bn.parent=Mn,new $RawJSCtx(Bn,N),Mn.tree.push(Bn),gt.parent.tree.pop(),gt.parent.tree.push(Mn);var dn=$NodeJS("else");z.insert(o+D,dn);var On=new $Node;On.line_num=n.line_num,dn.add(On);var Ln=new $NodeCtx(On),mn=new $ExprCtx(Ln,"clone",!1);le?(Gt=Xe,Ke||(Gt='$B.$local_search("'+yt+'");'+Xe),new $RawJSCtx(mn,Gt)):(mn.tree=l.tree,mn.tree.forEach(function(ir){ir.parent=mn}));var cr=new $AssignCtx(mn);return cr.tree.push($NodeJS("$B.$getattr("+l.to_js()+',"'+L+'")('+N+")")),mn.parent.tree.pop(),mn.parent.tree.push(cr),!de||fe||this.scope.blurred||(this.scope.binding[ae]=void 0),D},$AugmentedAssignCtx.prototype.to_js=function(){return""};var $AwaitCtx=$B.parser.$AwaitCtx=function(n){this.type="await",this.parent=n,this.tree=[],n.tree.push(this);for(var o=n;o;)"list_or_tuple"==o.type&&(o.is_await=!0),o=o.parent};$AwaitCtx.prototype.transition=function(n,o){return this.parent.is_await=!0,$transition(this.parent,n,o)},$AwaitCtx.prototype.to_js=function(){return"var save_stack = $B.save_stack();await ($B.promise("+$to_js(this.tree)+"));$B.restore_stack(save_stack, $locals); "};var $BodyCtx=$B.parser.$BodyCtx=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node,x=new $Node;return x.is_body_node=!0,x.line_num=l.line_num,l.insert(0,x),new $NodeCtx(x)},set_loop_context=$B.parser.set_loop_context=function(n,o){for(var l=n;"node"!==l.type;)l=l.parent;for(var x=l.node.parent,L=!1;;)if("module"==x.type)$_SyntaxError(n,o+" outside of a loop");else{var D=x.C.tree[0];if("condition"==D.type&&"while"==D.token){this.loop_ctx=D,D["has_"+o]=!0;break}switch(D.type){case"for":this.loop_ctx=D,D["has_"+o]=!0,L=!0;break;case"def":case"generator":case"class":$_SyntaxError(n,o+" outside of a loop");default:x=x.parent}if(L)break}},$BreakCtx=$B.parser.$BreakCtx=function(n){this.type="break",this.parent=n,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"break"])};$BreakCtx.prototype.toString=function(){return"break "},$BreakCtx.prototype.transition=function(n,o){if("eol"==n)return $transition(this.parent,"eol");$_SyntaxError(this,n)},$BreakCtx.prototype.to_js=function(){return this.js_processed=!0,";$locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_ctx.loop_num+'"] = false'+("asyncfor"!=this.loop_ctx.type?";break":";throw _b_.StopIteration.$factory("+this.loop_ctx.loop_num+")")};var $CallArgCtx=$B.parser.$CallArgCtx=function(n){this.type="call_arg",this.parent=n,this.start=$pos,this.tree=[],n.tree.push(this),this.expect="id"};$CallArgCtx.prototype.toString=function(){return"call_arg "+this.tree},$CallArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":if("id"==l.expect){l.expect=",";var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o)}break;case"=":if(","==l.expect)return new $ExprCtx(new $KwArgCtx(l),"kw_value",!1);break;case"for":this.parent.tree.length>1&&$_SyntaxError(l,"non-parenthesized generator expression");var L=new $ListOrTupleCtx(l,"gen_expr");L.vars=l.vars,L.locals=l.locals,L.intervals=[l.start],l.tree.pop(),L.expression=l.tree,l.tree=[L],L.tree=[];var D=new $ComprehensionCtx(L);return new $TargetListCtx(new $CompForCtx(D));case"op":if("id"==l.expect){var z=o;switch(l.expect=",",z){case"+":case"-":case"~":return $transition(new $AbstractExprCtx(l,!1),n,z);case"*":return new $StarArgCtx(l);case"**":return new $DoubleStarArgCtx(l)}}$_SyntaxError(l,"token "+n+" after "+l);case")":if(l.parent.kwargs&&$B.last(l.parent.tree).tree[0]&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),l.tree.length>0){var M=l.tree[l.tree.length-1];"list_or_tuple"==M.type&&"gen_expr"==M.real&&M.intervals.push($pos)}return $transition(l.parent,n);case":":if(","==l.expect&&"lambda"==l.parent.parent.type)return $transition(l.parent.parent,n);break;case",":if(","==l.expect)return l.parent.kwargs&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),$transition(l.parent,n,o)}console.log("token ",n," after ",l),$_SyntaxError(l,"token "+n+" after "+l)},$CallArgCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CallCtx=$B.parser.$CallCtx=function(n){this.type="call",this.func=n.tree[0],void 0!==this.func&&(this.func.parent=this),this.parent=n,"class"!=n.type?(n.tree.pop(),n.tree[n.tree.length]=this):n.args=this,this.expect="id",this.tree=[],this.start=$pos,this.func&&"attribute"==this.func.type&&"wait"==this.func.name&&"id"==this.func.value.type&&"time"==this.func.value.value&&(console.log("call",this.func),$get_node(this).blocking={type:"wait",call:this}),this.func&&"input"==this.func.value&&($get_node(this).blocking={type:"input"})};$CallCtx.prototype.toString=function(){return"(call) "+this.func+"("+this.tree+")"},$CallCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":return"id"==l.expect&&$_SyntaxError(l,n),l.expect="id",l;case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case")":return l.end=$pos,l.parent;case"op":switch(l.expect=",",o){case"-":case"~":case"+":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case"*":return l.has_star=!0,new $StarArgCtx(l);case"**":return l.has_dstar=!0,new $DoubleStarArgCtx(l)}$_SyntaxError(l,n);case"yield":$_SyntaxError(l,n)}return $transition(l.parent,n,o)},$CallCtx.prototype.to_js=function(){this.js_processed=!0,this.tree.length>0&&0==this.tree[this.tree.length-1].tree.length&&this.tree.pop();var n=this.func.to_js();if(void 0!==this.func){if("classmethod"===this.func.value)return"_b_.classmethod.$factory("+$to_js(this.tree)+")";if("unary"==this.func.type){var o="$B.$getattr("+$to_js(this.tree);switch(this.func.op){case"+":return o+',"__pos__")()';case"-":return o+',"__neg__")()';case"~":return o+',"__invert__")()'}}var l,x=[],L=[],D=!1,z=[];if(this.tree.forEach(function(fe){switch(fe.type){case"star_arg":D=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":z.push(fe.tree[0].tree[0].to_js());break;case"id":x.push([fe.to_js(),"s"]);break;default:switch(fe.tree[0].type){case"expr":case"list_or_tuple":case"op":default:x.push([fe.to_js(),"s"]);break;case"kwarg":L.push(fe.tree[0].tree[0].value+":"+fe.tree[0].tree[1].to_js());break;case"star_arg":D=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":z.push(fe.tree[0].tree[0].to_js())}}}),D){for(var M=[],P=0,de=x.length;P<de;P++)if(arg=x[P],"*"==arg[1])M.push("_b_.list.$factory("+arg[0]+")");else{var ye=[x[P][0]];for(P++;P<de&&"s"==x[P][1];)ye.push(x[P][0]),P++;P--,M.push("["+ye.join(",")+"]")}for(l=M[0],P=1;P<M.length;P++)l+=".concat("+M[P]+")"}else{for(P=0,de=x.length;P<de;P++)x[P]=x[P][0];l=x.join(", ")}var he="{"+L.join(", ")+"}";he=z.length?'{$nat:"kw",kw:['+he+","+z.join(", ")+"]}":"{}"!=he?'{$nat:"kw",kw:'+he+"}":"",D&&he?l+=".concat(["+he+"])":l&&he?l+=","+he:l||(l=he);var ae="$B.$call("+n+")"+(l=D?".apply(null,"+l+")":"("+l+")");return this.tree.length>-1&&"id"==this.func.type&&this.func.is_builtin&&void 0!==$B.builtin_funcs[this.func.value]?-1==["complex","bytes","bytearray","object","memoryview","int","float","str","list","tuple","dict","set","frozenset","range","slice","zip","bool","type","classmethod","staticmethod","enumerate","reversed","property","$$super","zip","map","filter"].indexOf(this.func.value)?n+l:n+".$factory"+l:ae}};var $ClassCtx=$B.parser.$ClassCtx=function(n){this.type="class",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id";var o=this.scope=$get_scope(this);this.parent.node.parent_block=o,this.parent.node.bound={},this.parent.node.binding={__annotations__:!0}};$ClassCtx.prototype.toString=function(){return"(class) "+this.name+" "+this.tree+" args "+this.args},$ClassCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.set_name(o),l.expect="(:",l;break;case"(":return new $CallCtx(l);case":":return $BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ClassCtx.prototype.set_name=function(n){var o=this.parent;this.random=$B.UUID(),this.name=n,this.id=o.node.module+"_"+n+"_"+this.random,this.binding={},this.parent.node.id=this.id;for(var l=this.scope,x=l,L=l,D=[];"class"==L.ntype;)D.splice(0,0,L.C.tree[0].name),L=L.parent;for(this.qualname=D.concat([n]).join(".");x.C&&"class"==x.C.tree[0].type;)x=x.parent;for(;x.C&&"def"!=x.C.tree[0].type&&"generator"!=x.C.tree[0].type;)x=x.parent;this.parent.node.parent_block=x,$bind(n,l,this),l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$ClassCtx.prototype.transform=function(n,o){this.doc_string=$get_docstring(n),this.module=$get_module(this).module.replace(/\./g,"_");var l="\n"+" ".repeat(n.indent+12),x=new $Node,L="$locals_"+this.id.replace(/\./g,"_");new $NodeJSCtx(x,M="var "+L+" = {__annotations__: $B.empty_dict()}, "+l+"$locals = "+L),n.insert(0,x);for(var D=this.scope;"__builtins__"!==D.parent_block.id;)D=D.parent_block;var z="$locals_"+D.id.replace(/\./g,"_"),M=" ".repeat(n.indent+4)+'$locals.$name = "'+this.name+'"'+l+'$locals.$qualname = "'+this.qualname+'"'+l+"$locals.$is_class = true; "+l+'$locals.$line_info = "'+n.line_num+","+this.module+'";'+l+'var $top_frame = ["'+L+'", $locals,"'+D.id+'", '+z+"]"+l+"$locals.$f_trace = $B.enter_frame($top_frame);"+l+"if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_line()}";n.insert(1,$NodeJS(M)),n.add($NodeJS("if($locals.$f_trace !== _b_.None){$B.trace_return(_b_.None)}")),n.add($NodeJS("$B.leave_frame({$locals})"));var P=new $Node;new $NodeJSCtx(P,"return "+L+";"),n.insert(n.children.length,P);var de=new $Node;new $NodeJSCtx(de,")();"),n.parent.insert(o+1,de),o++,n.parent.insert(o+1,$NodeJS("$"+this.name+"_"+this.random+".__module__ = $locals_"+this.module+".__name__"));var he=$get_scope(this),ae=";$locals_"+he.id.replace(/\./g,"_"),fe=1;if((M=[(ae+='["'+this.name+'"]')+' = $B.$class_constructor("'+this.name])[fe++]='", $'+this.name+"_"+this.random,void 0!==this.args){var q=[],Y=[];this.args.tree.forEach(function(Q){"kwarg"==Q.tree[0].type?Y.push(Q.tree[0]):q.push(Q.to_js())}),M[fe++]=", _b_.tuple.$factory(["+q.join(",")+"]),[";var A=new RegExp('"',"g"),N=[],X=0;q.forEach(function(Q){N[X++]='"'+Q.replace(A,'\\"')+'"'}),M[fe++]=N.join(",")+"]",N=[],X=0,Y.forEach(function(Q){N[X++]='["'+Q.tree[0].value+'",'+Q.tree[1].to_js()+"]"}),M[fe++]=",["+N.join(",")+"]"}else M[fe++]=", _b_.tuple.$factory([]),[],[]";M[fe++]=")";var oe=new $Node;new $NodeJSCtx(oe,M.join("")),o++,n.parent.insert(o+1,oe),o++;var H=new $Node;if(new $NodeJSCtx(H,M=ae+".__doc__ = "+(this.doc_string||"_b_.None")+";"),n.parent.insert(o+1,H),"module"==he.ntype){var Ce=new $Node;new $NodeJSCtx(Ce,'$locals["'+this.name+'"] = '+this.name)}n.parent.insert(o+2,$NodeJS("_b_.None;")),this.transformed=!0},$ClassCtx.prototype.to_js=function(){return this.js_processed=!0,"var $"+this.name+"_"+this.random+" = (function()"};var $CompIfCtx=$B.parser.$CompIfCtx=function(n){this.type="comp_if",n.parent.intervals.push($pos),this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIfCtx.prototype.toString=function(){return"(comp if) "+this.tree},$CompIfCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIfCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ComprehensionCtx=$B.parser.$ComprehensionCtx=function(n){this.type="comprehension",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ComprehensionCtx.prototype.toString=function(){return"(comprehension) "+this.tree},$ComprehensionCtx.prototype.transition=function(n,o){var l=this;switch(n){case"if":return new $AbstractExprCtx(new $CompIfCtx(l),!1);case"for":return new $TargetListCtx(new $CompForCtx(l))}return $transition(l.parent,n,o)},$ComprehensionCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.tree.forEach(function(o){n.push(o.start)}),n};var $CompForCtx=$B.parser.$CompForCtx=function(n){this.type="comp_for",n.parent.intervals.push($pos),this.parent=n,this.tree=[],this.expect="in",n.tree[n.tree.length]=this};$CompForCtx.prototype.toString=function(){return"(comp for) "+this.tree},$CompForCtx.prototype.transition=function(n,o){var l=this;return"in"==n&&"in"==l.expect?(l.expect=null,new $AbstractExprCtx(new $CompIterableCtx(l),!0)):null===l.expect?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$CompForCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CompIterableCtx=$B.parser.$CompIterableCtx=function(n){this.type="comp_iterable",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIterableCtx.prototype.toString=function(){return"(comp iter) "+this.tree},$CompIterableCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIterableCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ConditionCtx=$B.parser.$ConditionCtx=function(n,o){this.type="condition",this.token=o,this.parent=n,this.tree=[],this.scope=$get_scope(this),"while"==o&&(this.loop_num=$loop_num++),n.tree[n.tree.length]=this};$ConditionCtx.prototype.toString=function(){return this.token+" "+this.tree},$ConditionCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return"abstract_expr"==l.tree[0].type&&0==l.tree[0].tree.length&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$ConditionCtx.prototype.transform=function(n,o){if($get_scope(this),"while"==this.token){n.parent.insert(o,$NodeJS('$locals["$no_break'+this.loop_num+'"] = true'));var l=$get_module(this).module;return"return"!=$B.last(n.children).C.tree[0].type&&n.add($NodeJS('$locals.$line_info = "'+n.line_num+","+l+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),2}},$ConditionCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.token;"elif"==n&&(n="else if");var o=[n+"($B.$bool("];if("while"==n)o.push('$locals["$no_break'+this.loop_num+'"] && ');else if("else if"==n){var l=$get_node(this).line_num+","+$get_scope(this).id;o.push('($B.set_line("'+l+'")) && ')}return 1==this.tree.length?o.push($to_js(this.tree)+"))"):(o.push(this.tree[0].to_js()+"))"),this.tree[1].tree.length>0&&o.push("{"+this.tree[1].to_js()+"}")),o.join("")};var $ContinueCtx=$B.parser.$ContinueCtx=function(n){this.type="continue",this.parent=n,$get_node(this).is_continue=!0,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"continue"])};$ContinueCtx.prototype.toString=function(){return"(continue)"},$ContinueCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$ContinueCtx.prototype.to_js=function(){this.js_processed=!0;var n="continue";return this.loop_ctx.has_break&&(n=`$locals["$no_break${this.loop_ctx.loop_num}"]=true;${n}`),n};var $DebuggerCtx=$B.parser.$DebuggerCtx=function(n){this.type="continue",this.parent=n,n.tree[n.tree.length]=this};$DebuggerCtx.prototype.toString=function(){return"(debugger)"},$DebuggerCtx.prototype.transition=function(n,o){},$DebuggerCtx.prototype.to_js=function(){return this.js_processed=!0,"debugger"};var $DecoratorCtx=$B.parser.$DecoratorCtx=function(n){this.type="decorator",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DecoratorCtx.prototype.toString=function(){return"(decorator) "+this.tree},$DecoratorCtx.prototype.transition=function(n,o){var l=this;return"id"==n&&0==l.tree.length?$transition(new $AbstractExprCtx(l,!1),n,o):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,"token "+n+" after "+l)},$DecoratorCtx.prototype.transform=function(n,o){for(var l=o+1,x=n.parent.children,L=[this.tree];;)if(l>=x.length)$_SyntaxError(C,["decorator expects function"]);else if("node_js"==x[l].C.type)l++;else{if("decorator"!=x[l].C.tree[0].type)break;L.push(x[l].C.tree[0].tree),x.splice(l,1)}this.dec_ids=[],L.forEach(function(){this.dec_ids.push("$id"+$B.UUID())},this);var D=x[l].C.tree[0];"def"==D.type&&(D.decorated=!0,D.alias="$dec"+$B.UUID());var z="",M=$get_scope(this),P='$locals["';M.globals&&M.globals.has(D.name)&&(P="$locals_"+$get_module(this).id+'["');var de=(P+=D.name+'"]')+" = ";L.forEach(function(ye,he){de+="$B.$call("+this.dec_ids[he]+")(",z+=")"},this),de+=(D.decorated?D.alias:P)+z+";",$bind(D.name,M,this),n.parent.insert(l+1,$NodeJS(de)),this.decorators=L},$DecoratorCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.decorators.forEach(function(o,l){n.push("var "+this.dec_ids[l]+" = "+$to_js(o)+";")},this),n.join("")};var $DefCtx=$B.parser.$DefCtx=function(n){this.type="def",this.name=null,this.parent=n,this.tree=[],this.async=n.async,this.locals=[],n.tree[n.tree.length]=this,this.enclosing=[];var o=this.scope=$get_scope(this);o.C&&"class"==o.C.tree[0].type&&(this.class_name=o.C.tree[0].name),n.node.binding={};for(var l=o;l.C&&"class"==l.C.tree[0].type;)l=l.parent;for(;l.C&&"def"!=l.C.tree[0].type;)l=l.parent;this.parent.node.parent_block=l;var x=l;for(this.is_comp=x.is_comp;x&&x.C;){if("def"==x.C.tree[0].type){this.inside_function=!0;break}x=x.parent_block}this.module=o.module,this.root=$get_module(this),this.num=$loop_num,$loop_num++,this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$DefCtx.prototype.set_name=function(n){try{n=$mangle(n,this.parent.tree[0])}catch(x){throw console.log(x),console.log("parent",this.parent),x}var o=new $IdCtx(this,n);this.name=n,this.id=this.scope.id+"_"+n,this.id=this.id.replace(/\./g,"_"),this.id+="_"+$B.UUID(),this.parent.node.id=this.id,this.parent.node.module=this.module,this.binding={};var l=this.scope;void 0!==l.globals&&l.globals.has(n)?$bind(n,this.root,this):$bind(n,l,this),o.bound=!0,l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$DefCtx.prototype.toString=function(){return"def "+this.name+"("+this.tree+")"},$DefCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.name&&$_SyntaxError(l,"token "+n+" after "+l),l.set_name(o),l;case"(":return null==l.name&&$_SyntaxError(l,"missing name in function definition"),l.has_args=!0,new $FuncArgs(l);case"annotation":return new $AbstractExprCtx(new $AnnotationCtx(l),!0);case":":if(l.has_args)return $BodyCtx(l);$_SyntaxError(l,"missing function parameters");case"eol":l.has_args&&$_SyntaxError(l,"missing colon")}$_SyntaxError(l,"token "+n+" after "+l)},$DefCtx.prototype.transform=function(n,o){if(this.is_comp&&($get_node(this).is_comp=!0),void 0===this.transformed){var l=this.scope;this.doc_string=$get_docstring(n),this.rank=o;var x=n.indent+12;if(this.name.substr(0,15)=="lambda_"+$B.lambda_magic){var L=l.parent_block;L.C&&"def"==L.C.tree[0].type&&this.enclosing.push(L)}for(var D=this.parent.node;D.parent&&D.parent.is_def_func;)this.enclosing.push(D.parent.parent),D=D.parent.parent;var z=[],M=[],P=!1;this.argcount=0,this.kwonlyargcount=0,this.kwonlyargsdefaults=[],this.otherdefaults=[],this.varnames={},this.args=[],this.__defaults__=[],this.slots=[];var de=[],ye=[],he=[];this.annotation&&he.push('"return":'+this.annotation.to_js()),this.func_name=this.tree[0].to_js();var ae=this.func_name;this.decorated&&(this.func_name="var "+this.alias,ae=this.alias),this.tree[1].tree.forEach(function(or){if("end_positional"==or.type?(this.args.push("/"),de.push('"/"'),P=!0):(this.args.push(or.name),this.varnames[or.name]=!0),"func_arg_id"==or.type?(this.star_arg?(this.kwonlyargcount++,or.has_default&&this.kwonlyargsdefaults.push(or.name)):(this.argcount++,or.has_default&&this.otherdefaults.push(or.name)),this.slots.push(or.name+":null"),de.push('"'+or.name+'"'),ye.push(or.name+":"+or.name),or.tree.length>0&&(z.push('"'+or.name+'"'),M.push(or.name+":"+$to_js(or.tree)),this.__defaults__.push($to_js(or.tree)))):"func_star_arg"==or.type&&("*"==or.op?this.star_arg=or.name:"**"==or.op&&(this.kw_arg=or.name)),or.annotation){var ni=$mangle(or.name,this);he.push(ni+": "+or.annotation.to_js())}},this),ye="{"+ye.join(", ")+"}";var fe=67;this.star_arg&&(fe|=4),this.kw_arg&&(fe|=8),"generator"==this.type&&(fe|=32),this.async&&(fe|=128);for(var le=[],q=l;q.parent_block&&"__builtins__"!==q.parent_block.id;)q=q.parent_block;var Y="$locals_"+q.id.replace(/\./g,"_"),A=this.name+this.num,N="$locals_"+this.id;H="var "+N+" = {},"+(gt="\n"+" ".repeat(x))+"$locals = "+N+";",(Ce=new $Node).locals_def=!0,Ce.func_node=n,new $NodeJSCtx(Ce,H),le.push(Ce);var X=[$NodeJS('$locals.$line_info = "'+n.line_num+","+this.module+'"'),$NodeJS(`var $top_frame=["${this.id}",$locals,"`+q.id+'", '+Y+", "+(this.is_comp?this.name:A)+"]"),$NodeJS("$locals.$f_trace = $B.enter_frame($top_frame)"),$NodeJS("var $stack_length = $B.frames_stack.length;")];"generator"==this.type&&X.push($NodeJS("$locals.$is_generator = true")),this.async&&X.splice(1,0,$NodeJS(`$locals.$async="${this.id}"`)),X.forEach(function(or){or.enter_frame=!0}),this.is_comp&&le.push($NodeJS("var $defaults = {}")),this.env=[];var oe=[],H=N+' = $locals = $B.args("'+this.name+'", '+this.argcount+", {"+this.slots.join(", ")+"}, ["+de.join(", ")+"], arguments, $defaults, "+this.other_args+", "+this.other_kw+");",Ce=new $Node;new $NodeJSCtx(Ce,H),oe.push(Ce);var Q=!1;if(null!==this.other_args||null!==this.other_kw||0!=this.after_star.length||P)le.push(oe[0]),oe.length>1&&le.push(oe[1]);else{Q=!0,le.push($NodeJS("var $len = arguments.length;")),Ce=new $Node,new $NodeJSCtx(Ce,H="if($len > 0 && arguments[$len - 1].$nat !== undefined)"),le.push(Ce),oe.forEach(function(or){Ce.add(or)});var xe=new $Node;new $NodeJSCtx(xe,"else"),le.push(xe);var Pe=this.slots.length,Ge=$NodeJS("if($len == "+Pe+")");xe.add(Ge),Ge.add($NodeJS(N+" = $locals = "+ye)),xe.add($NodeJS("else if($len > "+Pe+'){$B.wrong_nb_args("'+this.name+'", $len, '+Pe+", ["+de+"])}")),Pe>0&&(xe.add($NodeJS("else if($len + Object.keys($defaults).length < "+Pe+'){$B.wrong_nb_args("'+this.name+'", $len, '+Pe+", ["+de+"])}")),subelse_node=$NodeJS("else"),xe.add(subelse_node),subelse_node.add($NodeJS(N+" = $locals = "+ye)),subelse_node.add($NodeJS("var defparams = ["+de+"]")),subelse_node.add($NodeJS("for(var i = $len; i < defparams.length; i++){$locals[defparams[i]] = $defaults[defparams[i]]}")))}le=le.concat(X),"class"==l.ntype&&(class_ref="$locals_"+l.parent_block.id.replace(/\./g,"_")+"."+l.C.tree[0].qualname,this.parent.node.binding.__class__=!0,le.push($NodeJS("$locals.__class__ = "+class_ref))),le.push($NodeJS("$B.js_this = this;"));for(var Ae=le.length-1;Ae>=0;Ae--)n.children.splice(0,0,le[Ae]);var Xe=new $Node;this.params="",Q&&(this.params=Object.keys(this.varnames).join(", ")),new $NodeJSCtx(Xe,""),Xe.is_def_func=!0,Xe.module=this.module;var Ke=n.children[n.children.length-1];x=Ke.indent,"return"!=Ke.C.tree[0].type&&(H="if($locals.$f_trace !== _b_.None){\n"+"    ".repeat(x)+"$B.trace_return(_b_.None)\n"+"    ".repeat(x)+"}\n"+"    ".repeat(x),H+="$B.leave_frame","$exec"==this.id.substr(0,5)&&(H+="_exec"),n.add($NodeJS(H+="({$locals});return _b_.None")));var yt=[];if(this.parent.node.referenced)for(var dt in this.parent.node.referenced)this.parent.node.binding[dt]||yt.push('"'+dt+'"');n.add(Xe);var Pt=1;if(x=n.indent,!this.is_comp){n.parent.insert(o+Pt++,$NodeJS(A+".$is_func = true")),this.$has_yield_in_cm&&n.parent.insert(o+Pt++,$NodeJS(A+".$has_yield_in_cm = true")),n.parent.insert(o+Pt++,$NodeJS(A+".$infos = {"));var wt=this.name;"$$"==this.name.substr(0,2)&&(wt=wt.substr(2)),wt.substr(0,15)=="lambda_"+$B.lambda_magic&&(wt="<lambda>"),n.parent.insert(o+Pt++,$NodeJS(H='    __name__:"'+wt+'",'));var Gt=wt;if(this.class_name&&(Gt=this.class_name+"."+wt),n.parent.insert(o+Pt++,$NodeJS(H='    __qualname__:"'+Gt+'",')),this.otherdefaults.length>0){var Dt=[];this.otherdefaults.forEach(function(or){Dt.push("$defaults."+or)}),n.parent.insert(o+Pt++,$NodeJS("    __defaults__ : $B.fast_tuple(["+Dt.join(", ")+"]),"))}else n.parent.insert(o+Pt++,$NodeJS("    __defaults__ : _b_.None,"));this.kwonlyargsdefaults.lengh>0?(Dt=[],this.kwonlyargsdefaults.forEach(function(or){Dt.push("$defaults."+or)}),n.parent.insert(o+Pt++,$NodeJS("    __kwdefaults__ : $B.fast_tuple(["+Dt.join(", ")+"]),"))):n.parent.insert(o+Pt++,$NodeJS("    __kwdefaults__ : _b_.None,")),n.parent.insert(o+Pt++,$NodeJS("    __annotations__: {"+he.join(",")+"},")),n.parent.insert(o+Pt++,$NodeJS("    __dict__: $B.empty_dict(),")),n.parent.insert(o+Pt++,$NodeJS("    __doc__: "+(this.doc_string||"_b_.None")+","));var sn=$get_module(this);for(var dt in n.parent.insert(o+Pt++,$NodeJS('    __module__ : "'+sn.module+'",')),this.binding)this.varnames[dt]=!0;var gt,Mn=[];for(var dt in this.varnames)Mn.push('"'+$B.from_alias(dt)+'"');H="    __code__:{"+(gt="\n"+" ".repeat(x+8))+"    co_argcount:"+this.argcount;var Bn=","+gt+" ".repeat(4);H+=Bn+"co_filename:$locals_"+$get_module(this).module.replace(/\./g,"_")+'["__file__"] || "<string>"'+Bn+"co_firstlineno:"+n.line_num+Bn+"co_flags:"+fe+Bn+"co_freevars: ["+yt+"]"+Bn+"co_kwonlyargcount:"+this.kwonlyargcount+Bn+'co_name: "'+this.name+'"'+Bn+"co_nlocals: "+Mn.length+Bn+"co_posonlyargcount: "+(this.pos_only||0)+Bn+"co_varnames: $B.fast_tuple(["+Mn.join(", ")+"])"+gt+"}\n"+" ".repeat(x+4)+"};",n.parent.insert(o+Pt++,$NodeJS(H+="_b_.None;"))}if(this.default_str="{"+M.join(", ")+"}",!this.is_comp){var dn=A;"generator"==this.type&&(dn=`$B.generator.$factory(${A})`);var On="return "+dn;this.async&&(On="generator"==this.type?`return $B.async_generator.$factory(${A})`:"return $B.make_async("+dn+")"),n.parent.insert(o+Pt++,$NodeJS(On+"}")),n.parent.insert(o+Pt++,$NodeJS(this.func_name+" = "+this.name+"$"+this.num+"("+this.default_str+")")),n.parent.insert(o+Pt++,$NodeJS(ae+".$set_defaults = function(value){return "+ae+" = "+this.name+"$"+this.num+"(value)}")),this.$has_yield_in_cm&&n.parent.insert(o+Pt++,$NodeJS(`${ae}.$has_yield_in_cm=true`))}for(var Ln=n,mn=0;mn<Ln.children.length&&Ln.children[mn]!==$B.last(X);mn++);var cr=$NodeJS("try"),ir=Ln.children.slice(mn+1);Ln.insert(mn+1,cr),ir.forEach(function(or){or.is_def_func?or.children.forEach(function(ni){cr.add(ni)}):cr.add(or)}),Ln.children.splice(mn+2,Ln.children.length);var ur=$NodeJS("catch(err)");return ur.add($NodeJS("$B.set_exc(err)")),ur.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),ur.add($NodeJS("$B.leave_frame({$locals});throw err")),Ln.add(ur),this.transformed=!0,Pt}},$DefCtx.prototype.to_js=function(n){return this.js_processed=!0,this.is_comp?"var "+this.name+" = "+(this.async?" async ":"")+"function* (expr)":(n=n||this.tree[0].to_js(),this.decorated&&(n="var "+this.alias),"var "+this.name+"$"+this.num+" = function($defaults){"+(this.async?"async ":"")+"function"+("generator"==this.type?"* ":" ")+this.name+this.num+"("+this.params+")")};var $DelCtx=$B.parser.$DelCtx=function(n){this.type="del",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DelCtx.prototype.toString=function(){return"del "+this.tree},$DelCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return $transition(l.parent,n);$_SyntaxError(l,"token "+n+" after "+l)},$DelCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent;if("list_or_tuple"==this.tree[0].type){var o=[];return this.tree[0].tree.forEach(function(D){var z=new $DelCtx(n);z.tree=[D],o.push(z.to_js()),n.tree.pop()}),this.tree=[],o.join(";")}if("expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type)return this.tree[0]=this.tree[0].tree[0],this.to_js();var l=this.tree[0].tree[0];switch(l.type){case"id":var x=$get_scope(this),L=!1;if(("def"==x.ntype||"generator"==x.ntype)&&x.globals&&x.globals.has(l.value)){for(x=x.parent;x.parent&&"__builtins__"!==x.parent.id;)x=x.parent;L=!0}return o='$B.$delete("'+l.value+'"'+(L?', "global"':"")+");",delete x.binding[l.value],o;case"list_or_tuple":return o=[],l.tree.forEach(function(D){o.push("delete "+D.to_js())}),o.join(";");case"sub":return l.func="delitem",js=l.to_js(),l.func="getitem",js;case"op":$_SyntaxError(this,["cannot delete operator"]);case"call":$_SyntaxError(this,["cannot delete function call"]);case"attribute":return"_b_.delattr("+l.value.to_js()+',"'+l.name+'")';default:$_SyntaxError(this,["cannot delete "+l.type])}};var $DictOrSetCtx=$B.parser.$DictOrSetCtx=function(n){this.type="dict_or_set",this.real="dict_or_set",this.expect="id",this.closed=!1,this.start=$pos,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DictOrSetCtx.prototype.toString=function(){switch(this.real){case"dict":return"(dict) {"+this.items+"}";case"set":return"(set) {"+this.tree+"}"}return"(dict_or_set) {"+this.tree+"}"},$DictOrSetCtx.prototype.transition=function(n,o){var l=this;if(l.closed){switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return new $CallArgCtx(new $CallCtx(l.parent))}return $transition(l.parent,n,o)}if(","==l.expect){switch(n){case"}":switch(l.real){case"dict_or_set":if(1!=l.tree.length)break;l.real="set";case"set":case"set_comp":case"dict_comp":return l.items=l.tree,l.tree=[],l.closed=!0,l;case"dict":if(l.nb_dict_items()%2==0)return l.items=l.tree,l.tree=[],l.closed=!0,l}$_SyntaxError(l,"token "+n+" after "+l);case",":return"dict_or_set"==l.real&&(l.real="set"),"dict"==l.real&&l.nb_dict_items()%2&&$_SyntaxError(l,"token "+n+" after "+l),l.expect="id",l;case":":if("dict_or_set"==l.real&&(l.real="dict"),"dict"==l.real)return l.expect=",",new $AbstractExprCtx(l,!1);$_SyntaxError(l,"token "+n+" after "+l);case"for":l.real="dict_or_set"==l.real?"set_comp":"dict_comp";var x=new $ListOrTupleCtx(l,"dict_or_set_comp");x.intervals=[l.start+1],x.vars=l.vars,l.tree.pop(),x.expression=l.tree,l.yields&&(x.expression.yields=l.yields,delete l.yields),l.tree=[x],x.tree=[];var L=new $ComprehensionCtx(x);return new $TargetListCtx(new $CompForCtx(L))}$_SyntaxError(l,"token "+n+" after "+l)}else if("id"==l.expect){switch(n){case"}":return 0==l.tree.length?(l.items=[],l.real="dict"):l.items=l.tree,l.tree=[],l.closed=!0,l;case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":l.expect=",";var D=new $AbstractExprCtx(l,!1);return $transition(D,n,o);case"op":switch(o){case"*":case"**":return l.expect=",",(D=new $AbstractExprCtx(l,!1)).packed=o.length,"dict_or_set"==l.real?l.real="*"==o?"set":"dict":("set"==l.real&&"**"==o||"dict"==l.real&&"*"==o)&&$_SyntaxError(l,"token "+n+" after "+l),D;case"+":return l;case"-":case"~":l.expect=",";var z=new $UnaryCtx(l,o);if("-"==o)var M=new $OpCtx(z,"unary_neg");else M=new $OpCtx(z,"+"==o?"unary_pos":"unary_inv");return new $AbstractExprCtx(M,!1)}$_SyntaxError(l,"token "+n+" after "+l)}$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$DictOrSetCtx.prototype.nb_dict_items=function(){var n=0;return this.tree.forEach(function(o){o.packed?n+=2:n++}),n},$DictOrSetCtx.prototype.packed_indices=function(){var n=[];return this.items.forEach(function(o,l){"expr"==o.type&&o.packed&&n.push(l)}),n},$DictOrSetCtx.prototype.unpack_dict=function(n){for(var o,l,x,L="",D=0;D<this.items.length;)l=0==D,"expr"==(x=this.items[D]).type&&x.packed?(o="_b_.list.$factory(_b_.dict.items("+x.to_js()+"))",D++):(o="[["+x.to_js()+","+this.items[D+1].to_js()+"]]",D+=2),l||(o=".concat("+o+")"),L+=o;return L},$DictOrSetCtx.prototype.unpack_set=function(n){var o,l="";return this.items.forEach(function(x,L){o=n.indexOf(L)>-1?"_b_.list.$factory("+x.to_js()+")":"["+x.to_js()+"]",L>0&&(o=".concat("+o+")"),l+=o}),l},$DictOrSetCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.real){case"dict":if((l=this.packed_indices()).length>0)return"_b_.dict.$factory("+this.unpack_dict(l)+")"+$to_js(this.tree);for(var n=[],o=0;o<this.items.length;o+=2)n.push("["+this.items[o].to_js()+","+this.items[o+1].to_js()+"]");return"_b_.dict.$factory(["+n.join(",")+"])"+$to_js(this.tree);case"set_comp":return"_b_.set.$factory("+$to_js(this.items)+")"+$to_js(this.tree);case"dict_comp":return"_b_.dict.$factory("+$to_js(this.items)+")"+$to_js(this.tree)}var l;return(l=this.packed_indices()).length>0?"_b_.set.$factory("+this.unpack_set(l)+")":"_b_.set.$factory(["+$to_js(this.items)+"])"+$to_js(this.tree)};var $DoubleStarArgCtx=$B.parser.$DoubleStarArgCtx=function(n){this.type="double_star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DoubleStarArgCtx.prototype.toString=function(){return"**"+this.tree},$DoubleStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return $transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$DoubleStarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"pdict",arg:'+$to_js(this.tree)+"}"};var $EllipsisCtx=$B.parser.$EllipsisCtx=function(n){this.type="ellipsis",this.parent=n,this.nbdots=1,this.start=$pos,n.tree[n.tree.length]=this};$EllipsisCtx.prototype.toString=function(){return"ellipsis"},$EllipsisCtx.prototype.transition=function(n,o){var l=this;return"."==n?(l.nbdots++,3==l.nbdots&&$pos-l.start==2&&(l.$complete=!0),l):l.$complete?$transition(l.parent,n,o):($pos--,void $_SyntaxError(l,"token "+n+" after "+l))},$EllipsisCtx.prototype.to_js=function(){return this.js_processed=!0,'$B.builtins["Ellipsis"]'};var $EndOfPositionalCtx=$B.parser.$EndOfConditionalCtx=function(n){this.type="end_positional",this.parent=n,n.has_end_positional=!0,n.parent.pos_only=n.tree.length,n.tree.push(this)};$EndOfPositionalCtx.prototype.transition=function(n,o){var l=this;if(","==n||")"==n)return $transition(l.parent,n,o);$_SyntaxError(l,"token "+n+" after "+l)},$EndOfPositionalCtx.prototype.to_js=function(){return"/"};var $ExceptCtx=$B.parser.$ExceptCtx=function(n){this.type="except",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="id",this.scope=$get_scope(this)};$ExceptCtx.prototype.toString=function(){return"(except) "},$ExceptCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);case"as":if("as"==l.expect&&void 0===l.has_alias)return l.expect="alias",l.has_alias=!0,l;case"id":if("alias"==l.expect)return l.expect=":",l.set_alias(o),l;break;case":":var x=l.expect;if("id"==x||"as"==x||":"==x)return $BodyCtx(l);break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;break;case")":if(","==l.expect||"as"==l.expect)return l.expect="as",l;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&("as"==l.expect||","==l.expect))return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$ExceptCtx.prototype.set_alias=function(n){this.tree[0].alias=$mangle(n,this),$bind(n,this.scope,this)},$ExceptCtx.prototype.transform=function(n,o){var l=$NodeJS("void(0)");l.line_num=n.line_num,n.insert(0,l);var x=$B.last(n.children);x.C.tree&&x.C.tree[0]&&"return"==x.C.tree[0].type||n.add($NodeJS("$B.del_exc()"))},$ExceptCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.tree.length){case 0:return"else";case 1:if("Exception"==this.tree[0].name)return"else if(1)"}var n=[];this.tree.forEach(function(x){n.push(x.to_js())});var o="";if($B.debug>0){var l=$get_module(this);o='($locals.$line_info = "'+$get_node(this).line_num+","+l.id+'") && '}return"else if("+o+"$B.is_exc("+this.error_name+",["+n.join(",")+"]))"};var $ExprCtx=$B.parser.$ExprCtx=function(n,o,l){if(this.type="expr",this.name=o,this.with_commas=l,this.expect=",",this.parent=n,n.packed&&(this.packed=n.packed),n.is_await){var x=$get_node(this);x.has_await=x.has_await||[],this.is_await=n.is_await,x.has_await.push(this)}n.assign&&(this.assign=n.assign),this.tree=[],n.tree[n.tree.length]=this};$ExprCtx.prototype.toString=function(){return"(expr "+this.with_commas+") "+this.tree},$ExprCtx.prototype.transition=function(n,o){var l=this;switch(n){case"bytes":case"float":case"id":case"imaginary":case"int":case"lambda":case"pass":case"str":$_SyntaxError(l,"token "+n+" after "+l);break;case"{":return"id"==l.tree[0].type&&-1!=["print","exec"].indexOf(l.tree[0].value)||$_SyntaxError(l,"token "+n+" after "+l),new $DictOrSetCtx(l);case"[":case"(":case".":case"not":if("expr"==l.expect)return l.expect=",",$transition(new $AbstractExprCtx(l,!1),n,o)}switch(n){case"not":if(","==l.expect)return new $ExprNot(l);break;case"in":if("target_list"==l.parent.type)return $transition(l.parent,n);if(","==l.expect)return $transition(l,"op","in");break;case",":if(","==l.expect&&(l.with_commas||["assign","return"].indexOf(l.parent.type)>-1)){$parent_match(l,{type:"yield",from:!0})&&$_SyntaxError(l,"no implicit tuple for yield from"),l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.has_comma=!0,x.tree=[l],l.parent=x,x}return $transition(l.parent,n);case".":return new $AttrCtx(l);case"[":return new $AbstractExprCtx(new $SubCtx(l),!0);case"(":return new $CallCtx(l);case"op":var L=l.parent,D=o;if("ternary"==L.type&&L.in_else){var z=new $OpCtx(l,D);return new $AbstractExprCtx(z,!1)}for(var M=l.parent,P=null;;)if("expr"==M.type)M=M.parent;else if("op"==M.type&&$op_weight[M.op]>=$op_weight[D]&&("**"!=M.op||"**"!=D))P=M,M=M.parent;else{if(!("not"==M.type&&$op_weight.not>$op_weight[D]))break;P=M,M=M.parent}if(null===P){for(;l.parent!==M;)L=(l=l.parent).parent;var de;return l.parent.tree.pop(),(de=new $ExprCtx(L,"operand",l.with_commas)).expect=",",l.parent=de,z=new $OpCtx(l,D),new $AbstractExprCtx(z,!1)}if("and"===D||"or"===D)for(;"not"==P.parent.type||"expr"==P.parent.type&&"not"==P.parent.parent.type;)L=(P=P.parent).parent;if("op"==P.type){var ye=!1;switch(P.op){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":ye=!0}if(ye)switch(D){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":var he=P.tree[1],ae=he.to_js(),fe=new Object;for(var le in he)fe[le]=he[le];var q="$c"+chained_comp_num;for(he.to_js=function(){return q},fe.to_js=function(){return q},chained_comp_num++;P.parent&&"op"==P.parent.type&&$op_weight[P.parent.op]<$op_weight[P.op];)P=P.parent;P.parent.tree.pop();var Y=new $OpCtx(P,"and");return Y.wrap={name:q,js:ae},fe.parent=Y,Y.tree.push("xxx"),z=new $OpCtx(fe,D),new $AbstractExprCtx(z,!1)}}return P.parent.tree.pop(),(de=new $ExprCtx(P.parent,"operand",!1)).tree=[M],P.parent=de,z=new $OpCtx(P,D),new $AbstractExprCtx(z,!1);case"augm_assign":for(var A=l.parent;A;)"assign"==A.type||"augm_assign"==A.type?$_SyntaxError(l,"augmented assignment inside assignment"):"op"==A.type&&$_SyntaxError(l,["cannot assign to operator"]),A=A.parent;return","==l.expect?new $AbstractExprCtx(new $AugmentedAssignCtx(l,o),!0):$transition(l.parent,n,o);case":":if("sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type)return new $AbstractExprCtx(new $SliceCtx(l.parent),!1);if("slice"==l.parent.type)return $transition(l.parent,n,o);if("node"==l.parent.type){if(1==l.tree.length){var N=l.tree[0];if(["id","sub","attribute"].indexOf(N.type)>-1)return new $AbstractExprCtx(new $AnnotationCtx(l),!1);if("tuple"==N.real&&","==N.expect&&1==N.tree.length)return new $AbstractExprCtx(new $AnnotationCtx(N.tree[0]),!1)}$_SyntaxError(l,"invalid target for annotation")}break;case"=":var X;if(","==l.expect){if("call_arg"==l.parent.type)return"id"!=l.tree[0].type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']),new $AbstractExprCtx(new $KwArgCtx(l),!0);if(X=function(Ke,yt){for(;Ke.parent;){if("annotation"==Ke.parent.type)return Ke.parent;Ke=Ke.parent}return!1}(l))return $transition(X,n,o);if("op"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("not"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("list_or_tuple"==l.parent.type)for(var oe=0;oe<l.parent.tree.length;oe++){var H=l.parent.tree[oe];"expr"==H.type&&"operand"==H.name&&$_SyntaxError(l,["cannot assign to operator"])}else l.tree.length>0&&l.tree[0].assign?$_SyntaxError(l,["cannot assign to named expression"]):"expr"==l.parent.type&&"target list"==l.parent.name?$_SyntaxError(l,"token "+n+" after "+l):"lambda"==l.parent.type&&"node"!=l.parent.parent.parent.type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']);for(;void 0!==l.parent;)"condition"==(l=l.parent).type?$_SyntaxError(l,"token "+n+" after "+l):"augm_assign"==l.type&&$_SyntaxError(l,"assignment inside augmented assignment");return new $AbstractExprCtx(new $AssignCtx(l=l.tree[0]),!0)}break;case":=":var Ce=l.parent.type;if(["node","assign","kwarg","annotation"].indexOf(Ce)>-1||"func_arg_id"==Ce&&l.parent.tree.length>0?$_SyntaxError(l,":= invalid, parent "+Ce):"call_arg"==Ce&&"call"==l.parent.parent.type&&"lambda"==l.parent.parent.parent.type&&$_SyntaxError(l,":= invalid inside function arguments"),1==l.tree.length&&"id"==l.tree[0].type){for(var Q=$get_scope(l),xe=l.tree[0].value;Q.is_comp;)Q=Q.parent_block;$bind(xe,Q,l),(A=l.parent).tree.pop();var Pe=new $AbstractExprCtx(A,!1);return Pe.assign=l.tree[0],Pe}$_SyntaxError(l,"token "+n+" after "+l);case"if":for(var Ge=!1,Ae=l.parent;"list_or_tuple"!=Ae.type;){if("comp_for"==Ae.type||"comp_if"==Ae.type){Ge=!0;break}if("call_arg"==Ae.type||void 0===Ae.parent)break;Ae=Ae.parent}if(Ge)break;for(Ae=l;Ae.parent&&("op"==Ae.parent.type||"expr"==Ae.parent.type&&"operand"==Ae.parent.name);)Ae=Ae.parent;return new $AbstractExprCtx(new $TernaryCtx(Ae),!0);case"eol":if(2==l.tree.length&&"id"==l.tree[0].type&&["print","exec"].indexOf(l.tree[0].value)>-1&&$_SyntaxError(l,["Missing parentheses in call to '"+l.tree[0].value+"'."]),-1==["dict_or_set","list_or_tuple"].indexOf(l.parent.type)){var Xe=l.tree[0];("packed"==Xe.type||"call"==Xe.type&&"packed"==Xe.func.type)&&$_SyntaxError(l,["can't use starred expression here"])}}return $transition(l.parent,n)},$ExprCtx.prototype.to_js=function(n){var o;if(this.js_processed=!0,o="list"==this.type?"["+$to_js(this.tree)+"]":1==this.tree.length?this.tree[0].to_js(n):"_b_.tuple.$factory(["+$to_js(this.tree)+"])",this.is_await&&(o="await ($B.promise("+o+"))"),this.assign){for(var l=$get_scope(this);l.is_comp;)l=l.parent_block;if(l.globals&&l.globals.has(this.assign.value))for(;l.parent_block&&"__builtins__"!==l.parent_block.id;)l=l.parent_block;else l.nonlocals&&l.nonlocals[this.assign.value]&&(l=l.parent_block);o="($locals_"+l.id.replace(/\./g,"_")+'["'+this.assign.value+'"] = '+o+")"}return o};var $ExprNot=$B.parser.$ExprNot=function(n){this.type="expr_not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ExprNot.prototype.transition=function(n,o){var l=this;if("in"==n)return l.parent.tree.pop(),new $AbstractExprCtx(new $OpCtx(l.parent,"not_in"),!1);$_SyntaxError(l,"token "+n+" after "+l)},$ExprNot.prototype.toString=function(){return"(expr_not)"};var $ForExpr=$B.parser.$ForExpr=function(n){n.node.parent.is_comp&&(n.node.parent.first_for=this),this.type="for",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.loop_num=$loop_num,this.scope=$get_scope(this),this.module=this.scope.module,$loop_num++};$ForExpr.prototype.toString=function(){return"(for) "+this.tree},$ForExpr.prototype.transition=function(n,o){var l=this;switch(n){case"in":return 0==l.tree[0].tree.length&&$_SyntaxError(l,"missing target between 'for' and 'in'"),new $AbstractExprCtx(new $ExprCtx(l,"target list",!0),!1);case":":return(l.tree.length<2||"abstract_expr"==l.tree[1].tree[0].type)&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ForExpr.prototype.transform=function(n,o){for(var l=this.parent.node.parent;l;){if(l.is_comp){var x=$get_module(this);void 0===x.outermost_expr&&(l.outermost_expr=this.tree[1],x.outermost_expr=this.tree[1],this.tree.pop(),new $RawJSCtx(this,"expr"));break}l=l.parent}if(this.async)return this.transform_async(n,o);var L=$get_scope(this),D=this.tree[0],z=1==D.tree.length&&"id"==D.expect,M=this.tree[1],P=this.loop_num,de="$locals_"+L.id.replace(/\./g,"_"),ye="\n"+" ".repeat(n.indent+4),he=!1;if(1==D.tree.length&&!L.blurred&&"id"!=D.expct&&"expr"==M.type&&"expr"==M.tree[0].type&&"call"==M.tree[0].tree[0].type){var ae=M.tree[0].tree[0];"id"==ae.func.type&&"range"==ae.func.value&&ae.tree.length<3&&ae.tree.length>0&&(he=ae)}var fe=[],le=0,q=n.children;if(he){this.has_break&&(Pt=new $Node,new $NodeJSCtx(Pt,de+'["$no_break'+P+'"] = true'),fe[le++]=Pt);for(var Y,A=$get_scope(this),N=[];A.binding.range&&N.push(A.id),A.parent_block;)A=A.parent_block;Y=1==N.length&&"__builtins__"==N[0];var X=new $Node;X.module=n.parent.module,new $NodeJSCtx(X,Y?"if(1)":"if("+ae.func.to_js()+" === _b_.range)"),fe[le++]=X;var oe=D.to_js(),H=!1;if(1==he.tree.length){if("int"==(xe=he.tree[0].tree[0]).tree[0].type&&0<(xe=parseInt(xe.to_js()))<$B.max_int){H=!0;var Ce="$i"+$B.UUID();(Ge=$NodeJS("for (var "+Ce+" = 0; "+Ce+" < "+xe+"; "+Ce+"++)")).add($NodeJS(oe+" = "+Ce))}var Q=0,xe=he.tree[0].to_js()}else Q=he.tree[0].to_js(),xe=he.tree[1].to_js();if(!H){var Pe="var $stop_"+P+" = $B.int_or_bool("+xe+"),"+ye+"        $next"+P+" = "+Q+","+ye+"        $safe"+P+" = typeof $next"+P+' == "number" && typeof $stop_'+P+' == "number";'+ye+"    while(true)",Ge=new $Node;new $NodeJSCtx(Ge,Pe),Ge.add($NodeJS("if($safe"+P+" && $next"+P+">= $stop_"+P+"){break}")),Ge.add($NodeJS("else if(!$safe"+P+" && $B.ge($next"+P+", $stop_"+P+")){break}")),Ge.add($NodeJS(oe+" = $next"+P)),Ge.add($NodeJS("if($safe"+P+"){$next"+P+" += 1}")),Ge.add($NodeJS("else{$next"+P+" = $B.add($next"+P+",1)}"))}q.forEach(function(On){Ge.add(On.clone_tree())}),"return"!=$B.last(n.children).C.tree[0].type&&Ge.add($NodeJS(Pe='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;'));var Ae=!1;if("module"==L.ntype)for(l=n.parent;l;){if(l.for_wrapper){Ae=!0;break}l=l.parent}if("module"!=L.ntype||Ae)X.add(Ge);else{var Xe=new $Node;Xe.for_wrapper=!0,Pe="function $f"+P+"(",this.has_break&&(Pe+="$no_break"+P),new $NodeJSCtx(Xe,Pe+=")"),X.add(Xe),Xe.add(Ge),this.has_break&&Xe.add($NodeJS("return $no_break"+P)),X.add($NodeJS("var $res"+P+" = $f"+P+"();")),this.has_break&&X.add($NodeJS("var $no_break"+P+" = $res"+P))}if(Y){n.parent.children.splice(o,1);var Ke=0;return this.has_break&&(n.parent.insert(o,fe[0]),Ke++),fe[Ke].children.forEach(function(On){n.parent.insert(o+Ke,On)}),n.parent.children[o].line_num=n.line_num,n.parent.children[o].bindings=n.bindings,n.children=[],0}var yt=$NodeJS("else");fe[le++]=yt;for(var dt=fe.length-1;dt>=0;dt--)n.parent.insert(o+1,fe[dt]);this.test_range=!0,fe=[],le=0}var Pt=new $Node;Pt.line_num=$get_node(this).line_num;var wt=M.to_js(),Gt="$iter"+P;new $NodeJSCtx(Pt,Pe="var "+Gt+" = "+wt+';$locals["$next'+P+'"] = $B.$getattr($B.$iter('+Gt+'),"__next__")'),fe[le++]=Pt,this.has_break&&(fe[le++]=$NodeJS(de+'["$no_break'+P+'"] = true;'));var Dt=new $Node;if(new $NodeJSCtx(Dt,Pe=this.has_break?"while("+de+'["$no_break'+P+'"])':"while(true)"),Dt.C.loop_num=P,Dt.C.type="for",fe[le++]=Dt,n.parent.children.splice(o,1),this.test_range)for(dt=fe.length-1;dt>=0;dt--)yt.insert(0,fe[dt]);else for(dt=fe.length-1;dt>=0;dt--)n.parent.insert(o,fe[dt]);var sn=$NodeJS("try");sn.bindings=n.bindings,Dt.add(sn);var gt=new $Node;gt.id=this.module;var Mn=new $NodeCtx(gt),Bn=new $ExprCtx(Mn,"left",!0);if(z){var dn=new $ListOrTupleCtx(Bn);dn.real="tuple",dn.tree=D.tree}else Bn.tree=D.tree;return new $AssignCtx(Bn).tree[1]=new $JSCode('$locals["$next'+P+'"]()'),sn.add(gt),Dt.add($NodeJS("catch($err){if($B.is_exc($err, [_b_.StopIteration])){break;}else{throw($err)}}")),q.forEach(function(On){Dt.add(On.clone())}),0==n.children.length&&console.log("bizarre",this),"return"!=$B.last(n.children).C.tree[0].type&&Dt.add($NodeJS(Pe='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),n.children=[],0},$ForExpr.prototype.transform_async=function(n,o){var l=$get_scope(this),x=this.tree[0],L=this.tree[1],D=this.loop_num,z=(l.id.replace(/\./g,"_")," ".repeat(n.indent+4),[]),M="$iter"+D,P="$type"+D,de="$running"+D,ye="$anext"+D,he="var "+M+" = "+L.to_js();z.push($NodeJS(he)),z.push($NodeJS("var "+P+" = _b_.type.$factory( "+M+")")),z.push($NodeJS(he=M+" = $B.$call($B.$getattr("+P+', "__aiter__"))('+M+")")),z.push($NodeJS("var "+de+" = true")),z.push($NodeJS("var "+ye+" = $B.$call($B.$getattr("+P+', "__anext__"))'));var ae=$NodeJS("while("+de+")");z.push(ae);var fe=$NodeJS("try");if(ae.add(fe),1==x.tree.length)he=x.to_js()+" = await ($B.promise("+ye+"("+M+")))",fe.add($NodeJS(he));else{var le=new $Node,q=new $NodeCtx(le),Y=new $ExprCtx(q,"left",!1);Y.tree.push(x),x.parent=Y;var A=new $AssignCtx(Y);new $RawJSCtx(A,"await ($B.promise("+ye+"("+M+")))"),fe.add(le)}var N=$NodeJS("catch(err)");ae.add(N),N.add($NodeJS(he="if(err.__class__ === _b_.StopAsyncIteration){"+de+" = false; continue}else{throw err}")),n.children.forEach(function(oe){ae.add(oe)}),n.parent.children.splice(o,1);for(var X=z.length-1;X>=0;X--)n.parent.insert(o,z[X]);return n.children=[],0},$ForExpr.prototype.to_js=function(){this.js_processed=!0;var n=this.tree.pop();return"for ("+$to_js(this.tree)+" in "+n.to_js()+")"};var $FromCtx=$B.parser.$FromCtx=function(n){this.type="from",this.parent=n,this.module="",this.names=[],n.tree[n.tree.length]=this,this.expect="module",this.scope=$get_scope(this)};$FromCtx.prototype.add_name=function(n){this.names[this.names.length]=n,"*"==n&&(this.scope.blurred=!0)},$FromCtx.prototype.bind_names=function(){var n=$get_scope(this);this.names.forEach(function(o){Array.isArray(o)&&(o=o[1]),$bind(o,n,this)},this)},$FromCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.add_name(o),l.expect=",",l;if("alias"==l.expect)return l.names[l.names.length-1]=[$B.last(l.names),o],l.expect=",",l;case".":if("module"==l.expect)return l.module+="id"==n?o:".",l;case"import":if("module"==l.expect)return l.expect="id",l;case"op":if("*"==o&&"id"==l.expect&&0==l.names.length)return"module"!==$get_scope(l).ntype&&$_SyntaxError(l,["import * only allowed at module level"]),l.add_name("*"),l.expect="eol",l;case",":if(","==l.expect)return l.expect="id",l;case"eol":switch(l.expect){case",":case"eol":return l.bind_names(),$transition(l.parent,n);case"id":$_SyntaxError(l,["trailing comma not allowed without surrounding parentheses"]);default:$_SyntaxError(l,["invalid syntax"])}case"as":if(","==l.expect||"eol"==l.expect)return l.expect="alias",l;case"(":if("id"==l.expect)return l.expect="id",l;case")":if(","==l.expect||"id"==l.expect)return l.expect="eol",l}$_SyntaxError(l,"token "+n+" after "+l)},$FromCtx.prototype.toString=function(){return"(from) "+this.module+" (import) "+this.names},$FromCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=$get_module(this),l=o.module,x=[],L=0,D=$get_node(this).indent,z=" ".repeat(D);if(l.startsWith("$exec")){var M=$B.last($B.frames_stack)[1];M.module&&M.module.__name__&&(l=M.module.__name__)}for(var P=this.module.split("."),de=0;de<P.length;de++)o.imports[P.slice(0,de+1).join(".")]=!0;for(var ye,he=this.module.replace(/\$/g,""),ae=[];he.length>0&&"."==he.charAt(0);){if(void 0===ye?void 0!==$B.imported[l]&&(ae=(ye=$B.imported[l].__package__).split(".")):(ye=$B.imported[ye],ae.pop()),void 0===ye)return"throw _b_.SystemError.$factory(\"Parent module '' not loaded, cannot perform relative import\")";"None"==ye&&console.log("package is None !"),he=he.substr(1)}he&&ae.push(he),this.module=ae.join(".");var fe=this.module.replace(/\$/g,"");x[L++]='var module = $B.$import("',x[L++]=fe+'",["';for(var le=[],q=(de=0,this.names.length);de<q;de++)Array.isArray(this.names[de])?le.push(this.names[de][0]):le.push(this.names[de]);x[L++]=le.join('","')+'"], {';var Y="";for(var A in this.aliases)x[L++]=Y+'"'+A+'": "'+this.aliases[A]+'"',Y=",";return x[L++]="}, {}, true);","*"==this.names[0]?(n.blurred=!0,x[L++]="\n"+z+"$B.import_all($locals, module);"):this.names.forEach(function(N){var X=N;Array.isArray(N)&&(X=N[1],N=N[0]),o.imports[this.module+"."+N]=!0,x[L++]="\n"+z+'$locals["'+X+'"] = $B.$getattr($B.imported["'+fe+'"], "'+N+'");'},this),x[L++]="\n"+z+"_b_.None;",x.join("")};var $FuncArgs=$B.parser.$FuncArgs=function(n){this.type="func_args",this.parent=n,this.tree=[],this.names=[],n.tree[n.tree.length]=this,this.expect="id",this.has_default=!1,this.has_star_arg=!1,this.has_kw_arg=!1};$FuncArgs.prototype.toString=function(){return"func args "+this.tree},$FuncArgs.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument"),"id"==l.expect&&(l.expect=",",l.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"])),new $FuncArgIdCtx(l,o);case",":if(","==l.expect)return l.expect="id",l;$_SyntaxError(l,"token "+n+" after "+l);case")":var x=$B.last(l.tree);return x&&"func_star_arg"==x.type&&"*"==x.name&&$_SyntaxError(l,"*"==l.op?["named arguments must follow bare *"]:"invalid syntax"),l.parent;case"op":l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument");var L=o;if(l.expect=",","*"==L)return l.has_star_arg&&$_SyntaxError(l,"duplicate star argument"),new $FuncStarArgCtx(l,"*");if("**"==L)return new $FuncStarArgCtx(l,"**");if("/"==L)return l.has_end_positional?$_SyntaxError(l,["duplicate / in function parameters"]):l.has_star_arg&&$_SyntaxError(l,["/ after * in function parameters"]),new $EndOfPositionalCtx(l);$_SyntaxError(l,"token "+L+" after "+l);case":":if("lambda"==l.parent.type)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgs.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $FuncArgIdCtx=$B.parser.$FuncArgIdCtx=function(n,o){this.type="func_arg_id",this.name=o,this.parent=n,n.has_star_arg?n.parent.after_star.push(o):n.parent.positional_list.push(o);var l=$get_node(this);l.binding[o]&&$_SyntaxError(n,["duplicate argument '"+o+"' in function definition"]),$bind(o,l,this),this.tree=[],n.tree[n.tree.length]=this;for(var x=n;void 0!==x.parent;){if("def"==x.type){x.locals.push(o);break}x=x.parent}this.expect="="};$FuncArgIdCtx.prototype.toString=function(){return"func arg id "+this.name+"="+this.tree},$FuncArgIdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":if("="==l.expect){l.has_default=!0;var x=l.parent.parent;return x.default_list.push(l.parent.has_star_arg?x.after_star.pop():x.positional_list.pop()),new $AbstractExprCtx(l,!1)}break;case",":case")":if(!l.parent.has_default||0!=l.tree.length||void 0!==l.parent.has_star_arg)return $transition(l.parent,n);$pos-=l.name.length,$_SyntaxError(l,["non-default argument follows default argument"]);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(l.has_default&&$_SyntaxError(l,"token "+n+" after "+l),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgIdCtx.prototype.to_js=function(){return this.js_processed=!0,this.name+$to_js(this.tree)};var $FuncStarArgCtx=$B.parser.$FuncStarArgCtx=function(n,o){this.type="func_star_arg",this.op=o,this.parent=n,this.node=$get_node(this),n.has_star_arg="*"==o,n.has_kw_arg="**"==o,n.tree[n.tree.length]=this};$FuncStarArgCtx.prototype.toString=function(){return"(func star arg "+this.op+") "+this.name},$FuncStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return void 0===l.name&&l.parent.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"]),l.set_name(o),l.parent.names.push(o),l;case",":case")":return void 0===l.name&&(l.set_name("*"),l.parent.names.push("*")),$transition(l.parent,n);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(void 0===l.name&&$_SyntaxError(l,"annotation on an unnamed parameter"),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncStarArgCtx.prototype.set_name=function(n){this.name=n,this.node.binding[n]&&$_SyntaxError(C,["duplicate argument '"+n+"' in function definition"]),$bind(n,this.node,this);for(var o=this.parent;void 0!==o.parent;){if("def"==o.type){o.locals.push(n);break}o=o.parent}"*"==this.op?o.other_args='"'+n+'"':o.other_kw='"'+n+'"'};var $GlobalCtx=$B.parser.$GlobalCtx=function(n){for(this.type="global",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.globals=this.scope.globals||new Set,this.module=$get_module(this);this.module.module!=this.module.id;)this.module=this.module.parent_block;this.module.binding=this.module.binding||{}};$GlobalCtx.prototype.toString=function(){return"global "+this.tree},$GlobalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$GlobalCtx.prototype.add=function(n){this.scope.annotations&&this.scope.annotations.has(n)&&$_SyntaxError(C,["annotated name '"+n+"' can't be global"]),this.scope.globals.add(n);var o=this.scope.parent_block;if(this.module.module.startsWith("$exec"))for(;o&&o.parent_block!==this.module;)o._globals=o._globals||{},o._globals[n]=this.module.id,delete o.binding[n],o=o.parent_block;this.module.binding[n]=!0},$GlobalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $IdCtx=$B.parser.$IdCtx=function(n,o){this.type="id",this.value=$mangle(o,n),this.parent=n,this.tree=[],n.tree[n.tree.length]=this;var l=this.scope=$get_scope(this);this.blurred_scope=this.scope.blurred,this.env=clone(this.scope.binding),["def","generator"].indexOf(l.ntype)>-1&&(l.referenced=l.referenced||{},$B.builtins[this.value]||(l.referenced[this.value]=!0)),"call_arg"==n.parent.type&&(this.call_arg=!0);for(var x=n;void 0!==x.parent;){switch(x.type){case"ctx_manager_alias":$bind(o,l,this);break;case"list_or_tuple":case"dict_or_set":case"call_arg":case"def":case"lambda":void 0===x.vars?x.vars=[o]:-1==x.vars.indexOf(o)&&x.vars.push(o),this.call_arg&&"lambda"==x.type&&(void 0===x.locals?x.locals=[o]:x.locals.push(o))}x=x.parent}if($parent_match(n,{type:"target_list"})&&(this.no_bindings=!0,$bind(o,l,this),this.bound=!0),["def","generator"].indexOf(l.ntype)>-1){for(var L=this.parent;L;){if("list_or_tuple"==L.type&&L.is_comp()){this.in_comp=!0;break}L=L.parent}"expr"==n.type&&"comp_if"==n.parent.type||"global"==n.type&&(void 0===l.globals?l.globals=new Set([o]):l.globals.add(o))}};$IdCtx.prototype.toString=function(){return"(id) "+this.value+":"+(this.tree||"")},$IdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":return"expr"==l.parent.type&&void 0!==l.parent.parent&&"call_arg"==l.parent.parent.type?new $AbstractExprCtx(new $KwArgCtx(l.parent),!1):$transition(l.parent,n,o);case"op":return $transition(l.parent,n,o);case"id":case"str":case"int":case"float":case"imaginary":["print","exec"].indexOf(l.value)>-1&&$_SyntaxError(l,["missing parenthesis in call to '"+l.value+"'"]),$_SyntaxError(l,"token "+n+" after "+l)}return"packed"==this.parent.parent.type&&-1==[".","[","("].indexOf(n)?this.parent.parent.transition(n,o):$transition(l.parent,n,o)},$IdCtx.prototype.firstBindingScopeId=function(){for(var n=this.scope;n;){if(n.globals&&n.globals.has(this.value))return $get_module(this).id;if(n.binding&&n.binding[this.value])return n.id;n=n.parent}},$IdCtx.prototype.boundBefore=function(n){for(var o=$get_node(this);o.parent;){var l=o.parent;if(l.bindings&&l.bindings[this.value])return l.bindings[this.value];for(var x=0;x<l.children.length;x++){var L=l.children[x];if(L===o)break;if(L.bindings&&L.bindings[this.value])return L.bindings[this.value]}if(l===n)break;o=l}return!1},$IdCtx.prototype.bindingType=function(n){for(var o,l,x=0,L=$get_node(this),D=!1;!D&&L.parent&&x++<100;){var z=L.parent;if(z.bindings&&z.bindings[this.value])return z.bindings[this.value];for(var M=0;M<z.children.length;M++){var P=z.children[M];if(P===L)break;P.bindings&&P.bindings[this.value]&&(D=P.bindings[this.value],l=M)}if(D){for(var de=l+1;de<z.children.length;de++){if((P=z.children[de]).children.length>0){o=!0;break}if(P===L)break}return o||D}if(z===n)break;L=z}return D},$IdCtx.prototype.to_js=function(n){if(void 0!==this.result&&"generator"==this.scope.ntype)return this.result;var o=this.value;if("__BRYTHON__"==o||"$B"==o)return o;if(o.startsWith("comp_result_"+$B.lambda_magic))return this.bound?"var "+o:o;if(this.js_processed=!0,this.scope._globals&&this.scope._globals[o]&&(this.global_module=this.scope._globals[o]),this.global_module)return"$locals_"+this.global_module.replace(/\./g,"_")+'["'+o+'"]';var l=void 0!==this.scope.binding[o],x=$get_node(this),L=x.bound_before;if(this.nonlocal=this.scope.nonlocals&&void 0!==this.scope.nonlocals[o],this.unbound=this.unbound||l&&!this.bound&&L&&-1==L.indexOf(o),!this.bound&&this.scope.C&&"class"==this.scope.ntype&&this.scope.C.tree[0].name==o)return'$B.$search("'+o+'")';if(this.unbound&&!this.nonlocal)return"def"==this.scope.ntype||"generator"==this.scope.ntype?'$B.$local_search("'+o+'")':'$B.$search("'+o+'")';for(var D=$get_scope(this),z=D,M=[],P=['"'+D.id+'"'],de=D;;){if(de.parent_block){if(de.parent_block==$B.builtins_scope||void 0===de.parent_block.id)break;de=de.parent_block}P.push('"'+de.id+'"')}if(P="["+P.join(", ")+"]",D.globals&&D.globals.has(o)&&(P=['"'+de.id+'"'],D=de),this.nonlocal||this.bound){var ye=this.firstBindingScopeId();if(void 0!==ye)return"$locals_"+ye.replace(/\./g,"_")+'["'+o+'"]';if(this.bound)return"$locals_"+D.id.replace(/\./g,"_")+'["'+o+'"]'}for(var he="$locals_"+de.id.replace(/\./g,"_");;){if(void 0!==z.globals&&z.globals.has(o))return this.boundBefore(de)||this.augm_assign?he+'["'+o+'"]':'$B.$global_search("'+o+'", '+P+")";if(z===D){if(L)(L.indexOf(o)>-1||z.C&&"def"==z.C.tree[0].type&&z.C.tree[0].env.indexOf(o)>-1)&&M.push(z);else if(z.binding[o]){if(void 0!==x.locals[o]){M.push(z);break}z.is_comp||z.parent_block&&z.parent_block.is_comp||M.push(z)}}else void 0===z.binding&&console.log("scope",z,o,"no binding",D),z.binding[o]&&M.push(z);if(!z.parent_block)break;z=z.parent_block}if(this.found=M,this.nonlocal&&M[0]===D&&M.shift(),M.length>0){if(M[0].C&&M[0]===D&&"$"!=o.charAt(0)){var ae=x.locals||{},fe=D.nonlocals;try{if(void 0===ae[o]&&!this.augm_assign&&("def"!=D.type||"generator"!=D.type)&&"class"!=D.ntype&&D.C.tree[0].args&&-1==D.C.tree[0].args.indexOf(o)&&(void 0===fe||void 0===fe[o]))return this.result='$B.$local_search("'+o+'")',this.result}catch(N){throw console.log("error",o,D),N}}if(M.length>1&&M[0].C&&"class"==M[0].C.tree[0].type){var le="$locals_"+M[0].id.replace(/\./g,"_"),q="$locals_"+M[1].id.replace(/\./g,"_");if(L)return L.indexOf(o)>-1?(this.found=M[0].binding[o],Y=le):(this.found=M[1].binding[o],Y=q),this.result=Y+'["'+o+'"]',this.result;this.found=!1;var Y=le+'["'+o+'"] !== undefined ? ';return this.result="("+(Y+=le+'["'+o+'"] : ')+q+'["'+o+'"])',this.result}this.found=(z=M[0]).binding[o];var A="$locals_"+z.id.replace(/\./g,"_");if(void 0===z.C)if("__builtins__"==z.id)de.blurred?o="("+he+'["'+o+'"] || _b_.'+o+")":(o="_b_."+o,this.is_builtin=!0);else if(this.bound||this.augm_assign)o=A+'["'+o+'"]';else{if(z===D&&void 0===this.env[o])return this.result='$B.$search("'+o+'")',this.result;o=this.boundBefore(z)?A+'["'+o+'"]':'$B.$check_def("'+o+'",'+A+'["'+o+'"])'}else o=z===D?z.globals&&z.globals.has(o)?he+'["'+o+'"]':this.bound||this.augm_assign||this.boundBefore(z)?'$locals["'+o+'"]':'$B.$check_def_local("'+o+'",$locals["'+o+'"])':this.augm_assign?A+'["'+o+'"]':'$B.$check_def_free("'+o+'",'+A+'["'+o+'"])';return this.result=o+$to_js(this.tree,""),this.result}return this.unknown_binding=!0,this.result='$B.$global_search("'+o+'", '+P+")",this.result};var $ImportCtx=$B.parser.$ImportCtx=function(n){this.type="import",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id"};$ImportCtx.prototype.toString=function(){return"import "+this.tree},$ImportCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $ImportedModuleCtx(l,o),l.expect=",",l;if("qual"==l.expect)return l.expect=",",l.tree[l.tree.length-1].name+="."+o,l.tree[l.tree.length-1].alias+="."+o,l;if("alias"==l.expect)return l.expect=",",l.tree[l.tree.length-1].alias=o,l;break;case".":if(","==l.expect)return l.expect="qual",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"as":if(","==l.expect)return l.expect="alias",l;break;case"eol":if(","==l.expect)return l.bind_names(),$transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$ImportCtx.prototype.bind_names=function(){var n=$get_scope(this);this.tree.forEach(function(o){if(o.name==o.alias){var l=o.name,x=l.split("."),L=l;x.length>1&&(L=x[0])}else L=o.alias;$bind(L,n,this)},this)},$ImportCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=[],l=$get_module(this);return this.tree.forEach(function(x){for(var L=x.name,D=x.name==x.alias?"{}":'{"'+L+'" : "'+x.alias+'"}',z="$locals_"+n.id.replace(/\./g,"_"),M=x.name.split("."),P=0;P<M.length;P++)l.imports[M.slice(0,P+1).join(".")]=!0;o.push('$B.$import("'+L+'", [],'+D+","+z+", true);")}),o.join("")+"_b_.None;"};var $ImportedModuleCtx=$B.parser.$ImportedModuleCtx=function(n,o){this.type="imported module",this.parent=n,this.name=o,this.alias=o,n.tree[n.tree.length]=this};$ImportedModuleCtx.prototype.toString=function(){return" (imported module) "+this.name},$ImportedModuleCtx.prototype.transition=function(n,o){},$ImportedModuleCtx.prototype.to_js=function(){return this.js_processed=!0,'"'+this.name+'"'};var $JSCode=$B.parser.$JSCode=function(n){this.js=n};$JSCode.prototype.toString=function(){return this.js},$JSCode.prototype.transition=function(n,o){},$JSCode.prototype.to_js=function(){return this.js_processed=!0,this.js};var $KwArgCtx=$B.parser.$KwArgCtx=function(n){this.type="kwarg",this.parent=n.parent,this.tree=[n.tree[0]],n.parent.tree.pop(),n.parent.tree.push(this),n.parent.parent.has_kw=!0;var o=this.tree[0].value,l=n.parent.parent;void 0===l.kwargs?l.kwargs=[o]:-1==l.kwargs.indexOf(o)?l.kwargs.push(o):$_SyntaxError(n,["keyword argument repeated"])};$KwArgCtx.prototype.toString=function(){return"kwarg "+this.tree[0]+"="+this.tree[1]},$KwArgCtx.prototype.transition=function(n,o){return","==n?new $CallArgCtx(this.parent.parent):$transition(this.parent,n)},$KwArgCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.tree[0].value;return"$$"==n.substr(0,2)&&(n=n.substr(2)),'{$nat:"kw",name:"'+n+'",value:'+$to_js(this.tree.slice(1,this.tree.length))+"}"};var $LambdaCtx=$B.parser.$LambdaCtx=function(n){this.type="lambda",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.args_start=$pos+6,this.vars=[],this.locals=[],this.node=$get_node(this),this.node.binding={},this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$LambdaCtx.prototype.toString=function(){return"(lambda) "+this.args_start+" "+this.body_start},$LambdaCtx.prototype.transition=function(n,o){var l=this;return":"==n&&void 0===l.args?(l.args=l.tree,l.tree=[],l.body_start=$pos,new $AbstractExprCtx(l,!1)):void 0!==l.args?(l.body_end=$pos,$transition(l.parent,n)):void 0===l.args&&"("!=n?$transition(new $FuncArgs(l),n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$LambdaCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent,o=this.node,l=$get_module(this),x=$get_src(n),L=x.substring(this.args_start,this.body_start),D=x.substring(this.body_start+1,this.body_end);D=(D=D.replace(/\\\n/g," ")).replace(/\n/g," ");var z=$get_scope(this),M=$B.UUID(),P="lambda_"+$B.lambda_magic+"_"+M,de="def "+P+"("+L+"):";de+="    return "+D;var ye="lambda"+M,he=l.id.replace(/\./g,"_"),ae=$B.py2js(de,he,ye,z,o.line_num).to_js(),fe=`$locals_${ye}`;return L="{}",l.is_comp&&(fe+=`,$locals_${l.id.replace(/\./g,"_")}`,L+=`,typeof $locals_${l.id.replace(/\./g,"_")}==="undefined" ?{}:$locals_${l.id.replace(/\./g,"_")}`),ae=`(function(${fe}){\n`+ae+`\nreturn $locals.${P}})(${L})`,$B.clear_ns(ye),$B.$py_src[ye]=null,delete $B.$py_src[ye],ae};var $ListOrTupleCtx=$B.parser.$ListOrTupleCtx=function(n,o){this.type="list_or_tuple",this.start=$pos,this.real=o,this.expect="id",this.closed=!1,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ListOrTupleCtx.prototype.toString=function(){switch(this.real){case"list":return"(list) ["+this.tree+"]";case"list_comp":case"gen_expr":return"("+this.real+") ["+this.intervals+"-"+this.tree+"]";default:return"(tuple) ("+this.tree+")"}},$ListOrTupleCtx.prototype.transition=function(n,o){var l=this;if(l.closed)return"["==n?new $AbstractExprCtx(new $SubCtx(l.parent),!1):"("==n?new $CallCtx(l.parent):$transition(l.parent,n,o);if(","==l.expect){switch(l.real){case"tuple":case"gen_expr":if(")"==n){for(var x=!0;"list_or_tuple"==l.type&&"tuple"==l.real&&"expr"==l.parent.type&&"node"==l.parent.parent.type&&1==l.tree.length;){x=!1;var L=l.parent.parent,D=L.tree.indexOf(l.parent);(P=l.tree[0]).parent=L,P.$in_parens=!0,L.tree.splice(D,1,P),l=P.tree[0]}if(x&&l.close(),"gen_expr"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside generator expression"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.parent:"abstract_expr"==l.parent.type&&l.parent.assign?(l.parent.parent.tree.pop(),(P=new $ExprCtx(l.parent.parent,"assign",!1)).tree=l.parent.tree,P.tree[0].parent=P,P.assign=l.parent.assign,P):l.parent}break;case"list":case"list_comp":if("]"==n){if(l.close(),"list_comp"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside list comprehension"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.tree.length>0?l.parent.tree[0]:l.parent.parent:l.parent}break;case"dict_or_set_comp":if("}"==n){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,[`'yield' inside ${"set_comp"==l.parent.real?"set":"dict"}comprehension`]);return l.intervals.push($pos),$transition(l.parent,n)}}switch(n){case",":return"tuple"==l.real&&(l.has_comma=!0),l.expect="id",l;case"for":"list"==l.real?(this.tree.length>1&&$_SyntaxError(l,"unparenthesized expression before 'for'"),l.real="list_comp"):l.real="gen_expr",l.intervals=[l.start+1],l.expression=l.tree,l.yields&&(l.expression.yields=l.yields,delete l.yields),l.tree=[];var M=new $ComprehensionCtx(l);return new $TargetListCtx(new $CompForCtx(M))}return $transition(l.parent,n,o)}if("id"!=l.expect)return $transition(l.parent,n,o);switch(l.real){case"tuple":if(")"==n)return l.close(),l.parent;if("eol"==n&&!0===l.implicit)return l.close(),$transition(l.parent,n);break;case"gen_expr":if(")"==n)return l.close(),$transition(l.parent,n);break;case"list":if("]"==n)return l.close(),l}switch(n){case"=":if("tuple"==l.real&&!0===l.implicit)return l.close(),l.parent.tree.pop(),(P=new $ExprCtx(l.parent,"tuple",!1)).tree=[l],l.parent=P,$transition(l.parent,n);break;case")":break;case"]":if("tuple"==l.real&&!0===l.implicit)return $transition(l.parent,n,o);break;case",":$_SyntaxError(l,"unexpected comma inside list");default:l.expect=",";var P=new $AbstractExprCtx(l,!1);return $transition(P,n,o)}},$ListOrTupleCtx.prototype.close=function(){this.closed=!0;for(var n=0,o=this.tree.length;n<o;n++){var l=this.tree[n];"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&","==l.tree[0].expect&&(this.tree[n]=l.tree[0].tree[0],this.tree[n].parent=this)}},$ListOrTupleCtx.prototype.is_comp=function(){switch(this.real){case"list_comp":case"gen_expr":case"dict_or_set_comp":return!0}return!1},$ListOrTupleCtx.prototype.get_src=function(){var n=$get_module(this).src,o=$get_scope(this);return void 0===o.comments||o.comments.forEach(function(l){var x=l[0],L=l[1];n=n.substr(0,x)+" ".repeat(L+1)+n.substr(x+L+1)}),n},$ListOrTupleCtx.prototype.bind_ids=function(n){this.tree.forEach(function(o){if("id"==o.type)$bind(o.value,n,this),o.bound=!0;else if("expr"==o.type&&"id"==o.tree[0].type)$bind(o.tree[0].value,n,this),o.tree[0].bound=!0;else if("expr"==o.type&&"packed"==o.tree[0].type){var l=o.tree[0].tree[0];"expr"==l.type&&"id"==l.tree[0].type&&($bind(l.tree[0].value,n,this),l.tree[0].bound=!0)}else("list_or_tuple"==o.type||"expr"==o.type&&"list_or_tuple"==o.tree[0].type)&&("expr"==o.type&&(o=o.tree[0]),o.bind_ids(n))},this)},$ListOrTupleCtx.prototype.packed_indices=function(){for(var n=[],o=0;o<this.tree.length;o++){var l=this.tree[o];"expr"==l.type&&("packed"==(l=l.tree[0]).type||"call"==l.type&&"packed"==l.func.type)&&n.push(o)}return n},$ListOrTupleCtx.prototype.unpack=function(n){for(var o,l="",x=0;x<this.tree.length;x++)o=n.indexOf(x)>-1?"_b_.list.$factory("+this.tree[x].to_js()+")":"["+this.tree[x].to_js()+"]",x>0&&(o=".concat("+o+")"),l+=o;return l},$ListOrTupleCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=(n.id.replace(/\//g,"_"),0),l=(A=$get_module(this)).module;switch(this.real){case"list":return(Ae=this.packed_indices()).length>0?"$B.$list("+this.unpack(Ae)+")":"$B.$list(["+$to_js(this.tree)+"])";case"list_comp":case"gen_expr":case"dict_or_set_comp":for(var x=this.get_src(),L=[],D=[],z=new RegExp('"',"g"),M=A.comments,P=1;P<this.intervals.length;P++){for(var de=this.intervals[P-1],ye=this.intervals[P],he=x.substring(de,ye),ae=M.length-1;ae>=0;ae--){var fe=M[ae];fe[0]>de&&fe[0]<ye&&(he=he.substr(0,o=fe[0]-de)+" ".repeat(fe[1])+he.substr(o+fe[1]+1))}he=he.replace(/\\\n/g," "),D.push(he);var le=he.split("\n"),q=[];le.forEach(function(Xe){0!=Xe.replace(/ /g,"").length&&(Xe=(Xe=(Xe=Xe.replace(/\n/g," ")).replace(/\\/g,"\\\\")).replace(z,'\\"'),q.push('"'+Xe+'"'))}),L.push("["+q.join(",")+"]")}var Y=$get_node(this).line_num;switch(this.real){case"list_comp":var A,N=$B.$list_comp(D),oe=N[1],H="lc"+$B.lambda_magic+oe,Ce=$pos,xe=(A=$B.py2js({src:N[0],is_comp:!0,line_info:Y+","+l},l,H,n,1)).outermost_expr;$get_node(this).has_yield&&(xe=this.tree[0].tree[0].tree[1]),void 0===xe&&(xe=A.first_for.tree[1]);var Pe=xe.to_js();$pos=Ce;var Ge=A.to_js();return A=null,$B.clear_ns(H),delete $B.$py_src[H],Ge=`function(expr){${Ge+="return $locals_"+H+'["x'+oe+'"]'}})(${Pe})`,this.is_await&&(Ge="async "+Ge),"("+Ge;case"dict_or_set_comp":return 1==this.expression.length?$B.$gen_expr(l,n,D,Y,!0):$B.$dict_comp(l,n,D,Y)}return $B.$gen_expr(l,n,D,Y);case"tuple":var Ae;return(Ae=this.packed_indices()).length>0?"$B.fast_tuple("+this.unpack(Ae)+")":1==this.tree.length&&void 0===this.has_comma?this.tree[0].to_js():"$B.fast_tuple(["+$to_js(this.tree)+"])"}};var $NodeCtx=$B.parser.$NodeCtx=function(n){this.node=n,n.C=this,this.tree=[],this.type="node";for(var o=null,l=n;l.parent&&"module"!=l.parent.type;){var x=!1;switch(l.parent.C.tree[0].type){case"def":case"class":case"generator":o=l.parent,x=!0}if(x)break;l=l.parent}null===o&&(o=l.parent||l),this.node.locals=clone(o.binding),this.scope=o};$NodeCtx.prototype.toString=function(){return"node "+this.tree},$NodeCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":case".":var x=new $AbstractExprCtx(l,!0);return $transition(x,n,o);case"op":switch(o){case"*":case"+":case"-":case"~":return x=new $AbstractExprCtx(l,!0),$transition(x,n,o)}break;case"async":return new $AsyncCtx(l);case"await":return new $AbstractExprCtx(new $AwaitCtx(l),!0);case"class":return new $ClassCtx(l);case"continue":return new $ContinueCtx(l);case"__debugger__":return new $DebuggerCtx(l);case"break":return new $BreakCtx(l);case"def":return new $DefCtx(l);case"for":return new $TargetListCtx(new $ForExpr(l));case"if":case"while":return new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"elif":var L=$previous(l);return-1!=["condition"].indexOf(L.type)&&"while"!=L.token||$_SyntaxError(l,"elif after "+L.type),new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"else":return L=$previous(l),-1==["condition","except","for"].indexOf(L.type)&&$_SyntaxError(l,"else after "+L.type),new $SingleKwCtx(l,n);case"finally":return L=$previous(l),-1!=["try","except"].indexOf(L.type)||"single_kw"==L.type&&"else"==L.token||$_SyntaxError(l,"finally after "+L.type),new $SingleKwCtx(l,n);case"try":return new $TryCtx(l);case"except":return L=$previous(l),-1==["try","except"].indexOf(L.type)&&$_SyntaxError(l,"except after "+L.type),new $ExceptCtx(l);case"assert":return new $AbstractExprCtx(new $AssertCtx(l),!1,!0);case"from":return new $FromCtx(l);case"import":return new $ImportCtx(l);case"global":return new $GlobalCtx(l);case"nonlocal":return new $NonlocalCtx(l);case"lambda":return new $LambdaCtx(l);case"pass":return new $PassCtx(l);case"raise":return new $AbstractExprCtx(new $RaiseCtx(l),!0);case"return":return new $AbstractExprCtx(new $ReturnCtx(l),!0);case"with":return new $AbstractExprCtx(new $WithCtx(l),!1);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case"del":return new $AbstractExprCtx(new $DelCtx(l),!0);case"@":return new $DecoratorCtx(l);case",":l.tree&&0==l.tree.length&&$_SyntaxError(l,"token "+n+" after "+l);var D=l.tree[0];l.tree=[];var z=new $ListOrTupleCtx(l);return z.real="tuple",z.implicit=0,z.tree.push(D),D.parent=z,z;case"eol":return 0==l.tree.length?(l.node.parent.children.pop(),l.node.parent.C):l}$_SyntaxError(l,"token "+n+" after "+l)},$NodeCtx.prototype.to_js=function(){if(void 0!==this.js)return this.js;if(this.js_processed=!0,this.tree.length>1){var n=new $Node;new $NodeCtx(n).tree=[this.tree[1]],n.indent=node.indent+4,this.tree.pop(),node.add(n)}if(this.js="",this.tree[0]){var o="def"!=this.scope.ntype;if(this.tree[0].annotation)if(o){if("expr"==this.tree[0].type&&!this.tree[0].$in_parens&&"id"==this.tree[0].tree[0].type){var l="";return this.create_annotations&&(l+="$locals.__annotations__ = $B.empty_dict();"),l+"_b_.dict.$setitem($locals.__annotations__, '"+this.tree[0].tree[0].value+"', "+this.tree[0].annotation.to_js()+");"}"def"==this.tree[0].type?this.js=this.tree[0].annotation.to_js()+";":(this.js="",this.tree=[])}else"def"!=this.tree[0].type&&(this.tree=[]);else if("assign"==this.tree[0].type&&!this.tree[0].tree[0].$in_parens&&this.tree[0].tree[0].annotation){var x=this.tree[0].tree[0],L=this.tree[0].tree[1];if(this.create_annotations&&(this.js+="$locals.__annotations__ = $B.empty_dict();"),this.js+="var $value = "+L.to_js()+";",this.tree[0].tree.splice(1,1),new $RawJSCtx(this.tree[0],"$value"),!x.tree[0]||"id"!=x.tree[0].type||!o)return this.js+=$to_js(this.tree)+";",o&&(this.js+=x.annotation.to_js()),this.js;this.js+="_b_.dict.$setitem($locals.__annotations__, '"+x.tree[0].value+"', "+x.annotation.to_js()+");"}}return this.js+=0==this.node.children.length?$to_js(this.tree)+";":$to_js(this.tree),this.js};var $NodeJS=$B.parser.$NodeJS=function(n){var o=new $Node;return new $NodeJSCtx(o,n),o},$NodeJSCtx=$B.parser.$NodeJSCtx=function(n,o){this.node=n,n.C=this,this.type="node_js",this.tree=[o]};$NodeJSCtx.prototype.toString=function(){return"js "+js},$NodeJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.tree[0]};var $NonlocalCtx=$B.parser.$NonlocalCtx=function(n){this.type="nonlocal",this.parent=n,this.tree=[],this.names={},n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.nonlocals=this.scope.nonlocals||{},void 0===this.scope.C&&$_SyntaxError(n,["nonlocal declaration not allowed at module level"])};$NonlocalCtx.prototype.toString=function(){return"nonlocal "+this.tree},$NonlocalCtx.prototype.add=function(n){"arg"==this.scope.binding[n]&&$_SyntaxError(C,["name '"+n+"' is parameter and nonlocal"]),this.names[n]=[!1,$pos],this.scope.nonlocals[n]=!0},$NonlocalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$NonlocalCtx.prototype.transform=function(n,o){var l=this.parent,x=this.scope.parent_block;if(void 0===x.C)$_SyntaxError(l,["no binding for nonlocal '"+$B.last(Object.keys(this.names))+"' found"]);else{for(;void 0!==x&&void 0!==x.C;){for(var L in this.names)void 0!==x.binding[L]&&(this.names[L]=[!0]);x=x.parent_block}for(var L in this.names)this.names[L][0]||(console.log("nonlocal error, C "+l),$pos=this.names[L][1],$_SyntaxError(l,["no binding for nonlocal '"+L+"' found"]))}},$NonlocalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $NotCtx=$B.parser.$NotCtx=function(n){this.type="not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$NotCtx.prototype.toString=function(){return"not ("+this.tree+")"},$NotCtx.prototype.transition=function(n,o){var l=this;switch(n){case"in":return l.parent.parent.tree.pop(),new $ExprCtx(new $OpCtx(l.parent,"not_in"),"op",!1);case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"op":if("+"==o||"-"==o||"~"==o)return x=new $AbstractExprCtx(l,!1),$transition(x,n,o)}return $transition(l.parent,n)},$NotCtx.prototype.to_js=function(){return this.js_processed=!0,"!$B.$bool("+$to_js(this.tree)+")"};var $NumberCtx=$B.parser.$NumberCtx=function(n,o,l){this.type=n,this.value=l,this.parent=o,this.tree=[],o.tree[o.tree.length]=this};$NumberCtx.prototype.toString=function(){return this.type+" "+this.value},$NumberCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$NumberCtx.prototype.to_js=function(){this.js_processed=!0;var type=this.type,value=this.value;if("int"==type){var v=parseInt(value[1],value[0]);if(v>$B.min_int&&v<$B.max_int)return this.unary_op&&(v=eval(this.unary_op+v)),v;var v=$B.long_int.$factory(value[1],value[0]);switch(this.unary_op){case"-":v=$B.long_int.__neg__(v);break;case"~":v=$B.long_int.__invert__(v)}return'{__class__: $B.long_int, value: "'+v.value+'", pos: '+v.pos+"}"}return"float"==type?/^\d+$/.exec(value)||/^\d+\.\d*$/.exec(value)?"(new Number("+this.value+"))":"_b_.float.$factory("+value+")":"imaginary"==type?"$B.make_complex(0,"+value+")":void 0};var $OpCtx=$B.parser.$OpCtx=function(n,o){if(this.type="op",this.op=o,this.parent=n.parent,this.tree=[n],this.scope=$get_scope(this),"expr"==n.type)if(["int","float","str"].indexOf(n.tree[0].type)>-1)this.left_type=n.tree[0].type;else if("id"==n.tree[0].type){var l=this.scope.binding[n.tree[0].value];l&&(this.left_type=l.type)}n.parent.tree.pop(),n.parent.tree.push(this)};$OpCtx.prototype.toString=function(){return"(op "+this.op+") ["+this.tree+"]"},$OpCtx.prototype.transition=function(n,o){var l=this;if(void 0===l.op&&$_SyntaxError(l,["C op undefined "+l]),"unary"==l.op.substr(0,5)){if("eol"!=n&&("assign"==l.parent.type||"return"==l.parent.type)){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.tree.push(l),l.parent=x,x}2==l.tree.length&&"expr"==l.tree[1].type&&"int"==l.tree[1].tree[0].type&&(l.parent.tree.pop(),l.parent.tree.push(l.tree[1]),l.tree[1].parent=l.parent,l.tree[1].tree[0].unary_op=l.tree[0].op)}switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case"op":switch(o){case"+":case"-":case"~":return new $UnaryCtx(l,o)}default:"abstract_expr"==l.tree[l.tree.length-1].type&&$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n)},$OpCtx.prototype.to_js=function(){this.js_processed=!0;var n={"==":"eq","!=":"ne",">=":"ge","<=":"le","<":"lt",">":"gt"};if(void 0!==n[this.op]){var o=n[this.op];if("expr"==this.tree[0].type&&"expr"==this.tree[1].type){var l=this.tree[0].tree[0],x=this.tree[1].tree[0],L=l.to_js(),D=x.to_js();switch(x.type){case"int":switch(l.type){case"int":return Number.isSafeInteger(l.value)&&Number.isSafeInteger(x.value)?L+this.op+D:"$B.$getattr("+this.tree[0].to_js()+',"__'+o+'__")('+this.tree[1].to_js()+")";case"str":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  int() '+this.op+' str()")'}case"id":return"(typeof "+L+' == "number" ? '+L+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"str":switch(l.type){case"str":return L+this.op+D;case"int":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  str() '+this.op+' int()")'}case"id":return"(typeof "+L+' == "string" ? '+L+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"id":if("id"==l.type)return"typeof "+L+'!="object" && typeof '+L+'!="function" && typeof '+L+" == typeof "+D+" ? "+L+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")"}}}switch(this.op){case"and":var z=this.tree[0].to_js(),M=this.tree[1].to_js();return void 0!==this.wrap?"(function(){var "+this.wrap.name+" = "+this.wrap.js+";return $B.$test_expr($B.$test_item("+z+") && $B.$test_item("+M+"))})()":"$B.$test_expr($B.$test_item("+z+")&&$B.$test_item("+M+"))";case"or":return(X="$B.$test_expr($B.$test_item("+this.tree[0].to_js()+")||")+"$B.$test_item("+this.tree[1].to_js()+"))";case"in":return"$B.$is_member("+$to_js(this.tree)+")";case"not_in":return"!$B.$is_member("+$to_js(this.tree)+")";case"unary_neg":case"unary_pos":case"unary_inv":if("unary_neg"==this.op?(ye="-",o="__neg__"):"unary_pos"==this.op?(ye="+",o="__pos__"):(ye="~",o="__invert__"),"expr"==this.tree[1].type){var P=this.tree[1].tree[0];switch(P.type){case"int":var de=parseInt(P.value[1],P.value[0]);return Number.isSafeInteger(de)?ye+de:"$B.$getattr("+P.to_js()+', "'+o+'")()';case"float":return"_b_.float.$factory("+ye+P.value+")";case"imaginary":return"$B.make_complex(0,"+ye+P.value+")"}}return"$B.$getattr("+this.tree[1].to_js()+',"'+o+'")()';case"is":return"$B.$is("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"is_not":return this.tree[0].to_js()+"!=="+this.tree[1].to_js();case"+":return"$B.add("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"*":case"-":let Q=function(xe,Pe){var Ge;return["int","float","str"].indexOf(Pe.type)>-1?Ge=Pe.type:"id"==Pe.type&&xe[Pe.value]&&(Ge=xe[Pe.value].type),Ge};var ye=this.op,he=[],ae=!1,fe=$get_scope(this),le=this.tree[0],q=this.tree[1];if(function xe(Pe){if("expr"==Pe.type&&"int"==Pe.tree[0].type)return!0;if("expr"==Pe.type&&"float"==Pe.tree[0].type)return ae=!0,!0;if("expr"==Pe.type&&"list_or_tuple"==Pe.tree[0].type&&"tuple"==Pe.tree[0].real&&1==Pe.tree[0].tree.length&&"expr"==Pe.tree[0].tree[0].type)return xe(Pe.tree[0].tree[0].tree[0]);if("expr"==Pe.type&&"id"==Pe.tree[0].type){var Ge=Pe.tree[0].to_js();return-1==he.indexOf(Ge)&&he.push(Ge),!0}if("op"==Pe.type&&["*","+","-"].indexOf(Pe.op)>-1){for(var Ae=0;Ae<Pe.tree.length;Ae++)if(!xe(Pe.tree[Ae]))return!1;return!0}return!1}(this)){var Y=this.tree[0].tree[0],A=this.tree[1].tree[0];if(0!=he.length||ae){if(0==he.length)return"new Number("+this.simple_js()+")";var N=fe.binding;if(l=Q(N,Y),x=Q(N,A),"float"==l&&"float"==x||"+"==this.op&&"str"==l&&"str"==x)return this.result_type=l,Y.to_js()+this.op+A.to_js();if(["int","float"].indexOf(l)>-1&&["int","float"].indexOf(x)>-1)switch(this.result_type="int"==l&&"int"==x?"int":"float",this.op){case"-":return"$B.sub("+Y.to_js()+","+A.to_js()+")";case"*":return"$B.mul("+Y.to_js()+","+A.to_js()+")"}var X,oe=[],H=[];return he.forEach(function(xe){oe.push("typeof "+xe+'.valueOf() == "number"'),H.push("typeof "+xe+' == "number"')}),(X=[oe.join(" && ")+" ? "]).push("("+H.join(" && ")+" ? "),X.push(this.simple_js()),X.push(" : new Number("+this.simple_js()+")"),X.push(")"),l=this.tree[0].to_js(),x=this.tree[1].to_js(),"+"==this.op&&X.push(" : (typeof "+l+' == "string" && typeof '+x+' == "string") ? '+l+"+"+x),X.push(': $B.rich_op("'+$operators[this.op]+'",'+l+","+x+")"),"("+X.join("")+")"}return this.simple_js()}return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+le.to_js()+","+q.to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+le.to_js()+", "+q.to_js()+")";default:return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+this.tree[0].to_js()+", "+this.tree[1].to_js()+")"}},$OpCtx.prototype.simple_js=function(){var n=this.op;function o(l){return"op"==l.type?l.simple_js():"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&"expr"==l.tree[0].tree[0].type?"("+l.tree[0].tree[0].tree[0].simple_js()+")":l.tree[0].to_js()}return"+"==n?"$B.add("+o(this.tree[0])+","+o(this.tree[1])+")":"-"==n?"$B.sub("+o(this.tree[0])+","+o(this.tree[1])+")":"*"==n?"$B.mul("+o(this.tree[0])+","+o(this.tree[1])+")":"/"==n?"$B.div("+o(this.tree[0])+","+o(this.tree[1])+")":o(this.tree[0])+n+o(this.tree[1])};var $PackedCtx=$B.parser.$PackedCtx=function(n){if(this.type="packed","list_or_tuple"==n.parent.type&&"node"==n.parent.parent.type)for(var o=0;o<n.parent.tree.length;o++){var l=n.parent.tree[o];"expr"==l.type&&l.tree.length>0&&"packed"==l.tree[0].type&&$_SyntaxError(n,["two starred expressions in assignment"])}this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PackedCtx.prototype.toString=function(){return"(packed) "+this.tree},$PackedCtx.prototype.transition=function(n,o){var l=this;if(l.tree.length>0&&"["==n)return $transition(l.tree[0],n,o);if("id"==n){var x=new $AbstractExprCtx(l,!1);return x.packed=!0,l.parent.expect=",",$transition(x,n,o)}return"["==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"list")):"("==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"tuple")):"]"==n?$transition(l.parent,n,o):"{"==n?(l.parent.expect=",",new $DictOrSetCtx(l)):l.parent.transition(n,l)},$PackedCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $PassCtx=$B.parser.$PassCtx=function(n){this.type="pass",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PassCtx.prototype.toString=function(){return"(pass)"},$PassCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$PassCtx.prototype.to_js=function(){return this.js_processed=!0,"void(0)"};var $RaiseCtx=$B.parser.$RaiseCtx=function(n){this.type="raise",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope_type=$get_scope(this).ntype};$RaiseCtx.prototype.toString=function(){return" (raise) "+this.tree},$RaiseCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if(0==l.tree.length)return new $IdCtx(new $ExprCtx(l,"exc",!1),o);break;case"from":if(l.tree.length>0)return new $AbstractExprCtx(l,!1);break;case"eol":return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$RaiseCtx.prototype.to_js=function(){return this.js_processed=!0,"$B.$raise("+(0==this.tree.length?"":this.tree[0].to_js())+")"};var $RawJSCtx=$B.parser.$RawJSCtx=function(n,o){this.type="raw_js",n.tree[n.tree.length]=this,this.parent=n,this.js=o};$RawJSCtx.prototype.toString=function(){return"(js) "+this.js},$RawJSCtx.prototype.transition=function(n,o){},$RawJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.js};var $ReturnCtx=$B.parser.$ReturnCtx=function(n){this.type="return",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope=$get_scope(this),-1==["def","generator"].indexOf(this.scope.ntype)&&$_SyntaxError(n,["'return' outside function"]);for(var o=this.node=$get_node(this);o.parent;){if(o.parent.C){var l=o.parent.C.tree[0];if("for"==l.type){l.has_return=!0;break}("try"==l.type||"single_kw"==l.type&&"finally"==l.token)&&(l.has_return=!0)}o=o.parent}};$ReturnCtx.prototype.toString=function(){return"return "+this.tree},$ReturnCtx.prototype.transition=function(n,o){return $transition(this.parent,n)},$ReturnCtx.prototype.to_js=function(){this.js_processed=!0,1==this.tree.length&&"abstract_expr"==this.tree[0].type&&(this.tree.pop(),new $IdCtx(new $ExprCtx(this,"rvalue",!1),"None"));var n=this.scope;if("generator"==n.ntype)return"var $res = "+$to_js(this.tree)+"; $B.leave_frame({$locals});return $B.generator_return($res)";var o="    ".repeat(this.node.indent-1),l="var $res = "+$to_js(this.tree)+";\n"+o+"if($locals.$f_trace !== _b_.None){$B.trace_return($res)}\n"+o+"$B.leave_frame";return"$exec_"==n.id.substr(0,6)&&(l+="_exec"),l+"({$locals});\n"+o+"return $res"};var $SingleKwCtx=$B.parser.$SingleKwCtx=function(n,o){if(this.type="single_kw",this.token=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this,"else"==o){for(var l=n.node,x=l.parent,L=0;L<x.children.length&&x.children[L]!==l;L++);var D=x.children[L-1].C;if(D.tree.length>0){var z=D.tree[0];("for"==z.type||"asyncfor"==z.type||"condition"==z.type&&"while"==z.token)&&(z.has_break=!0,z.else_node=$get_node(this),this.loop_num=z.loop_num)}}};$SingleKwCtx.prototype.toString=function(){return this.token},$SingleKwCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$SingleKwCtx.prototype.transform=function(n,o){if("finally"==this.token){var l=$get_scope(this);n.insert(0,$NodeJS("var $exit;if($B.frames_stack.length < $stack_length){$exit = true;$B.frames_stack.push($top_frame)}")),l.id.replace(/\./g,"_"),"return"!=n.children[n.children.length-1].C.tree[0].type&&n.add($NodeJS("if($exit){$B.leave_frame({$locals})}"))}},$SingleKwCtx.prototype.to_js=function(){return this.js_processed=!0,"finally"==this.token?this.token:void 0!==this.loop_num?"if($locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_num+'"])':this.token};var $SliceCtx=$B.parser.$SliceCtx=function(n){this.type="slice",this.parent=n,this.tree=n.tree.length>0?[n.tree.pop()]:[],n.tree.push(this)};$SliceCtx.prototype.transition=function(n,o){return":"==n?new $AbstractExprCtx(this,!1):$transition(this.parent,n,o)},$SliceCtx.prototype.to_js=function(){for(var n=0;n<this.tree.length;n++)"abstract_expr"==this.tree[n].type&&(this.tree[n].to_js=function(){return"_b_.None"});return"_b_.slice.$factory("+$to_js(this.tree)+")"};var $StarArgCtx=$B.parser.$StarArgCtx=function(n){this.type="star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$StarArgCtx.prototype.toString=function(){return"(star arg) "+this.tree},$StarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return"target_list"==l.parent.type?(l.tree.push(o),l.parent.expect=",",l.parent):$transition(new $AbstractExprCtx(l,!1),n,o);case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return 0==l.tree.length&&$_SyntaxError(l,"unnamed star argument"),$transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$StarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"ptuple",arg:'+$to_js(this.tree)+"}"};var $StringCtx=$B.parser.$StringCtx=function(n,o){this.type="str",this.parent=n,this.tree=[o],n.tree[n.tree.length]=this,this.raw=!1};$StringCtx.prototype.toString=function(){return"string "+(this.tree||"")},$StringCtx.prototype.transition=function(n,o){var l=this;switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return l.parent.tree[0]=l,new $CallCtx(l.parent);case"str":return l.tree.push(o),l}return $transition(l.parent,n,o)},$StringCtx.prototype.to_js=function(){this.js_processed=!0;var n="",o=null,l=$get_scope(this),x=!1;function L(he){for(var ae=0;ae<he.length;ae++){try{code=he.charCodeAt(ae)}catch(fe){throw console.log("err for s",he),fe}if(code>=55296&&code<=56319)return!0}return!1}function D(he){for(var ae=[],fe=0;fe<he.length;fe++)if("expression"==he[fe].type){for(var le=he[fe].expression,q=0,Y=[],A=[le];q<le.length;){var N=le.charAt(q);if(":"==N&&0==Y.length){A=[le.substr(0,q),le.substr(q+1)];break}"{[(".indexOf(N)>-1?Y.push(N):")]}".indexOf(N)>-1&&Y.pop(),q++}var X=$pos,oe=$B.py2js(le=A[0],l.module,l.id,l);oe.to_js(),$pos=X;for(var H=0;H<oe.children.length;H++){var Ce=oe.children[H];if(Ce.C.tree&&1==Ce.C.tree.length&&"try"==Ce.C.tree[0]){for(var Q=0;Q<Ce.children.length;Q++)if(!Ce.children[Q].is_line_num){for(var xe=Ce.children[Q].js;"\n;".indexOf(xe.charAt(xe.length-1))>-1;)xe=xe.substr(0,xe.length-1);break}break}}switch(he[fe].conversion){case"a":xe="_b_.ascii("+xe+")";break;case"r":xe="_b_.repr("+xe+")";break;case"s":xe="_b_.str.$factory("+xe+")"}var Pe=A[1];if(void 0!==Pe){var Ge=$B.parse_fstring(Pe),Ae="_b_.str.format('{0:' + "+(Pe=Ge.length>1?D(Ge):"'"+Pe+"'")+" + '}', "+xe+")";ae.push(Ae)}else null===he[fe].conversion&&(xe="_b_.str.$factory("+xe+")"),ae.push(xe)}else{var Xe=new RegExp("'","g"),Ke=he[fe].replace(Xe,"\\'").replace(/\n/g,"\\n");x=x||L(Ke),ae.push("'"+Ke+"'")}return ae.join(" + ")}function z(he){return(he=he.replace(/\n/g,"\\n\\\n")).replace(/\\U([A-Fa-f0-9]{8})/gm,function(ae){return String.fromCharCode("0x"+ae.slice(2))})}for(var M=0;M<this.tree.length;M++){if("call"==this.tree[M].type)return"(function(){throw _b_.TypeError.$factory(\"'str' object is not callable\")}())";var P=this.tree[M],de=Array.isArray(P),ye=!1;if(de||(ye="b"==P.charAt(0)),null==o)o=ye,ye&&(n+="_b_.bytes.$new(_b_.bytes, ");else if(o!=ye)return'$B.$TypeError("can\'t concat bytes to str")';ye?n+=z(P.substr(1)):de?n+=D(P):(x=x||L(P),n+=z(P)),M<this.tree.length-1&&(n+="+")}return ye&&(n+=',"ISO-8859-1")'),0==n.length&&(n='""'),x&&(n="_b_.str.$surrogate.$factory("+n+")"),n};var $SubCtx=$B.parser.$SubCtx=function(n){this.type="sub",this.func="getitem",this.value=n.tree[0],n.tree.pop(),n.tree[n.tree.length]=this,this.parent=n,this.tree=[]};$SubCtx.prototype.toString=function(){return"(sub) (value) "+this.value+" (tree) "+this.tree},$SubCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"]":if(l.parent.packed)return l.parent.tree[0];if(l.tree[0].tree.length>0)return l.parent;break;case":":return new $AbstractExprCtx(new $SliceCtx(l),!1);case",":return new $AbstractExprCtx(l,!1)}$_SyntaxError(l,"token "+n+" after "+l)},$SubCtx.prototype.to_js=function(){if(this.js_processed=!0,"getitem"==this.func&&"id"==this.value.type){var n=$get_node(this).locals[this.value.value],o=this.value.to_js();if("list"==n||"tuple"==n){if(1==this.tree.length)return"$B.list_key("+o+", "+this.tree[0].to_js()+")";if(2==this.tree.length)return"$B.list_slice("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+")";if(3==this.tree.length)return"$B.list_slice_step("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+","+(this.tree[2].to_js()||"null")+")"}}if("getitem"==this.func&&1==this.tree.length)return"slice"==this.tree[0].type?`$B.getitem_slice(${this.value.to_js()},${this.tree[0].to_js()})`:"$B.$getitem("+this.value.to_js()+","+this.tree[0].to_js()+")";var l="",x=!1;if("delitem"!==this.func&&1==this.tree.length&&!this.in_sub){var L="",D=this;for(x=!0;"sub"==D.value.type;)L+="["+D.tree[0].to_js()+"]",D.value.in_sub=!0,D=D.value;var z=D.value.to_js()+"["+D.tree[0].to_js()+"]((Array.isArray("+D.value.to_js()+") || typeof "+D.value.to_js()+' == "string") && '+z+" !== undefined ?"+z+L+" : "}if(l+="$B.$getattr("+(o=this.value.to_js())+',"__'+this.func+'__")(',1==this.tree.length)l+=this.tree[0].to_js()+")";else{var M=[];this.tree.forEach(function(P){M.push("abstract_expr"==P.type?"_b_.None":P.to_js())}),l+="_b_.tuple.$factory(["+M.join(",")+"]))"}return x?l+")":l};var $TargetListCtx=$B.parser.$TargetListCtx=function(n){this.type="target_list",this.parent=n,this.tree=[],this.expect="id",n.tree[n.tree.length]=this};$TargetListCtx.prototype.toString=function(){return"(target list) "+this.tree},$TargetListCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect=",",new $IdCtx(new $ExprCtx(l,"target",!1),o);case"op":if("id"==l.expect&&"*"==o)return new $PackedCtx(l);case"(":case"[":if("id"==l.expect)return l.expect=",",new $ListOrTupleCtx(l,"("==n?"tuple":"list");case")":case"]":if(","==l.expect)return l.parent;case",":if(","==l.expect)return l.expect="id",l}return","==l.expect||"in"==n?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$TargetListCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $TernaryCtx=$B.parser.$TernaryCtx=function(n){this.type="ternary",this.parent=n.parent,n.parent.tree.pop(),n.parent.tree.push(this),n.parent=this,this.tree=[n]};$TernaryCtx.prototype.toString=function(){return"(ternary) "+this.tree},$TernaryCtx.prototype.transition=function(n,o){var l=this;if("else"==n)return l.in_else=!0,new $AbstractExprCtx(l,!1);if(l.in_else){if(","==n&&["assign","augm_assign","node","return"].indexOf(l.parent.type)>-1){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.tree[0]=l,l.parent=x,x.expect="id",x}}else $_SyntaxError(l,"token "+n+" after "+l);return $transition(l.parent,n,o)},$TernaryCtx.prototype.to_js=function(){this.js_processed=!0;var n="$B.$bool("+this.tree[1].to_js()+") ? ";return(n+=this.tree[0].to_js()+" : ")+this.tree[2].to_js()};var $TryCtx=$B.parser.$TryCtx=function(n){this.type="try",this.parent=n,n.tree[n.tree.length]=this};$TryCtx.prototype.toString=function(){return"(try) "},$TryCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$TryCtx.prototype.transform=function(n,o){if(n.parent.children.length==o+1)$_SyntaxError(C,["unexpected EOF while parsing"]);else switch(n.parent.children[o+1].C.tree[0].type){case"except":case"finally":case"single_kw":break;default:$_SyntaxError(C,"no clause after try")}var l=$get_scope(this),x=create_temp_name("$err"),L="$locals."+create_temp_name("$failed"),D=L+" = false;\n"+" ".repeat(n.indent+4)+"try";new $NodeJSCtx(n,D),n.has_return=this.has_return;var z=$NodeJS("catch("+x+")");n.parent.insert(o+1,z),z.add($NodeJS("$B.set_exc("+x+")")),z.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),z.add($NodeJS(L+" = true;$B.pmframe = $B.last($B.frames_stack);if(false){}"));for(var M=o+2,P=!1,de=!1,ye=!1;M!=n.parent.children.length&&void 0!==(q=n.parent.children[M].C.tree[0]);)if("except"==q.type)de&&$_SyntaxError(C,"'except' or 'finally' after 'else'"),ye&&$_SyntaxError(C,"'except' after 'finally'"),q.error_name=x,q.tree.length>0&&null!=q.tree[0].alias&&n.parent.children[M].insert(0,$NodeJS('$locals["'+q.tree[0].alias+'"] = $B.exception('+x+")")),z.insert(z.children.length,n.parent.children[M]),0==q.tree.length&&(P&&$_SyntaxError(C,"more than one except: line"),P=!0),n.parent.children.splice(M,1);else if("single_kw"==q.type&&"finally"==q.token){ye=!0;var ae=n.parent.children[M];M++}else{if("single_kw"!=q.type||"else"!=q.token)break;de&&$_SyntaxError(C,"more than one 'else'"),ye&&$_SyntaxError(C,"'else' after 'finally'"),de=!0;var fe=n.parent.children[M];n.parent.children.splice(M,1)}if(!P){var le=new $Node,q=new $NodeCtx(le);z.insert(z.children.length,le),new $SingleKwCtx(q,"else"),le.add($NodeJS("throw "+x))}if(de){var Y=new $Node;Y.module=l.module,new $NodeJSCtx(Y,"if(!"+L+")"),fe.children.forEach(function(A){Y.add(A)}),ye?ae.insert(0,Y):n.parent.insert(M,Y),M++}$loop_num++},$TryCtx.prototype.to_js=function(){return this.js_processed=!0,"try"};var $UnaryCtx=$B.parser.$UnaryCtx=function(n,o){this.type="unary",this.op=o,this.parent=n,n.tree[n.tree.length]=this};$UnaryCtx.prototype.toString=function(){return"(unary) "+this.op},$UnaryCtx.prototype.transition=function(n,o){var l=this;switch(n){case"int":case"float":case"imaginary":var x=l.parent;return l.parent.parent.tree.pop(),"-"==l.op?o="-"+o:"~"==l.op&&(o=~o),$transition(l.parent.parent,n,o);case"id":l.parent.parent.tree.pop(),x=new $ExprCtx(l.parent.parent,"call",!1);var L=new $ExprCtx(x,"id",!1);return new $IdCtx(L,o),new $AttrCtx(x).name="+"==l.op?"__pos__":"-"==l.op?"__neg__":"__invert__",L;case"op":if("+"==o||"-"==o)return l.op=l.op===o?"+":"-",l}return $transition(l.parent,n,o)},this.to_js=function(){return this.js_processed=!0,this.op};var $WithCtx=$B.parser.$WithCtx=function(n){this.type="with",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="as",this.scope=$get_scope(this)};$WithCtx.prototype.toString=function(){return"(with) "+this.tree},$WithCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);$_SyntaxError(l,"token "+n+" after "+l);case"as":return new $AbstractExprCtx(new $AliasCtx(l));case":":switch(l.expect){case"id":case"as":case":":return $BodyCtx(l)}break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;if("alias"==l.expect)return l.expect=":",new $TargetListCtx(l,!1);break;case")":if(","==l.expect||"as"==l.expect)return l.expect=":",l;break;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&(","==l.expect||"as"==l.expect)||"as"==l.expect||":"==l.expect)return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$WithCtx.prototype.set_alias=function(n){var o=[];"id"==n.type?o=[n]:"list_or_tuple"==n.type&&n.tree.forEach(function(D){"expr"==D.type&&"id"==D.tree[0].type&&o.push(D.tree[0])});for(var l=0,x=o.length;l<x;l++){var L=o[l];$bind(L.value,this.scope,this),L.bound=!0,"module"!==this.scope.ntype&&this.scope.C.tree[0].locals.push(L.value)}},$WithCtx.prototype.transform=function(n,o){for(;this.tree.length>1;){var l=n.children,x=this.tree.pop(),L=new $Node,D=new $NodeCtx(L),z=new $WithCtx(D);x.parent=z,z.tree=[x],z.async=this.async,l.forEach(function(X){L.add(X)}),n.children=[L]}if(!this.transformed){if(this.prefix="",this.tree.length>1){var M=new $Node;D=new $NodeCtx(M),M.parent=n,M.module=n.module,M.indent=n.indent+4;var P=new $WithCtx(D);return P.async=this.async,P.tree=this.tree.slice(1),n.children.forEach(function(X){M.add(X)}),n.children=[M],void(this.transformed=!0)}if(this.async)return this.transform_async(n,o);var de=$NodeJS("try");n.parent.insert(o+1,de);var ye=this.num=$loop_num++;if(de.ctx_manager_num=ye,this.cm_name=this.prefix+"$ctx_manager"+ye,this.cmexit_name=this.prefix+"$ctx_manager_exit"+ye,this.exc_name=this.prefix+"$exc"+ye,this.err_name="$err"+ye,this.val_name="$value"+ye,this.yield_name=this.prefix+"$yield"+ye,null===this.tree[0].alias&&(this.tree[0].alias="$temp"),"expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type){"expr"==this.tree[1].type&&"list_or_tuple"==this.tree[1].tree[0].type||$_SyntaxError(C),this.tree[0].tree[0].tree.length!=this.tree[1].tree[0].tree.length&&$_SyntaxError(C,["wrong number of alias"]);var he=this.tree[0].tree[0].tree,ae=this.tree[1].tree[0].tree;this.tree.shift(),this.tree.shift();for(var fe=he.length-1;fe>=0;fe--)he[fe].alias=ae[fe].value,this.tree.splice(0,0,he[fe])}var le=n.children;n.children=[];var q=new $Node;new $NodeJSCtx(q,"try"),de.add(q),this.tree[0].alias&&q.add($NodeJS('$locals["'+(ae=this.tree[0].alias.tree[0].tree[0].value)+'"] = '+this.val_name)),le.forEach(function(X){q.add(X)});var Y=new $Node;new $NodeJSCtx(Y,"catch("+this.err_name+")");var A=this.exc_name+" = false;"+this.err_name+" = $B.exception("+this.err_name+", true)\n"+" ".repeat(n.indent+4)+"var $b = "+this.cmexit_name+"("+this.err_name+".__class__,"+this.err_name+",$B.$getattr("+this.err_name+', "__traceback__"));';"generator"==this.scope.ntype&&(A+="$B.set_cm_in_generator("+this.cmexit_name+");"),Y.add($NodeJS(A+="if(!$B.$bool($b)){throw "+this.err_name+"}")),de.add(Y);var N=new $Node;new $NodeJSCtx(N,"finally"),N.C.type="single_kw",N.C.token="finally",N.C.in_ctx_manager=!0,N.is_except=!0,N.in_ctx_manager=!0,A="if("+this.exc_name,A+="){"+this.cmexit_name+"(_b_.None, _b_.None, _b_.None);","generator"==this.scope.ntype&&(A+="delete "+this.cmexit_name),N.add($NodeJS(A+="};")),n.parent.insert(o+2,N),this.transformed=!0}},$WithCtx.prototype.transform_async=function(n,o){$get_scope(this);var l=this.tree[0],x=this.tree[0].alias,L=[],D=this.num=$loop_num++;this.cm_name="$ctx_manager"+D,this.cmexit_name="$ctx_manager_exit"+D,this.exc_name="$exc"+D;var z="$ctx_mgr_type"+D,M="$ctx_manager_enter"+D,P="$err"+D,de="var "+this.cm_name+" = "+l.to_js()+",";if(L.push($NodeJS(de)),L.push($NodeJS("    "+z+" = _b_.type.$factory("+this.cm_name+"),")),L.push($NodeJS("    "+this.cmexit_name+" = $B.$call($B.$getattr("+z+', "__aexit__")),')),L.push($NodeJS("    "+M+" = $B.$call($B.$getattr("+z+', "__aenter__"))('+this.cm_name+"),")),L.push($NodeJS("    "+this.exc_name+" = false")),de="",x)if("list_or_tuple"!=x.tree[0].tree[0].type)de=x.tree[0].to_js()+" = await ($B.promise("+M+"))",L.push($NodeJS(de));else{var ye=new $Node,he=new $NodeCtx(ye);(l=new $ExprCtx(he,"left",!1)).tree.push(x.tree[0].tree[0]),x.tree[0].tree[0].parent=l;var ae=new $AssignCtx(l);new $RawJSCtx(ae,"await ($B.promise("+M+"))"),L.push(ye)}else L.push($NodeJS("await ($B.promise("+M+"))"));var fe=new $NodeJS("try");n.children.forEach(function(N){fe.add(N)}),L.push(fe);var le=new $NodeJS("catch(err)");L.push(le),le.add($NodeJS(this.exc_name+" = true")),le.add($NodeJS("var "+P+' = $B.imported["_sys"].exc_info()'));var q=$NodeJS("if(! await ($B.promise("+this.cmexit_name+"("+this.cm_name+", "+P+"[0], "+P+"[1], "+P+"[2]))))");le.add(q),q.add($NodeJS("$B.$raise()"));var Y=$NodeJS("if(! "+this.exc_name+")");L.push(Y),Y.add($NodeJS("await ($B.promise("+this.cmexit_name+"("+this.cm_name+", _b_.None, _b_.None, _b_.None)))")),n.parent.children.splice(o,1);for(var A=L.length-1;A>=0;A--)n.parent.insert(o,L[A]);return n.children=[],0},$WithCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_node(this).indent,o=" ".repeat(n),l=this.num,x=""==this.prefix?"var ":this.prefix,L="$ctx_manager"+l,D=x+"$ctx_manager_exit"+l,z=x+"$exc"+l,M="$value"+l;return"var "+L+" = "+this.tree[0].to_js()+"\n"+o+D+" = $B.$getattr("+L+',"__exit__")\n'+o+"var "+M+" = $B.$getattr("+L+',"__enter__")()\n'+o+z+" = true\n"};var $YieldCtx=$B.parser.$YieldCtx=function(n,o){this.type="yield",this.parent=n,this.tree=[],this.is_await=o,n.tree[n.tree.length]=this,"list_or_tuple"==n.type&&n.tree.length>1&&$_SyntaxError(n,"non-parenthesized yield"),$parent_match(n,{type:"annotation"})&&$_SyntaxError(n,["'yield' outside function"]);for(var l=this;;){var x=$parent_match(l,{type:"list_or_tuple"});if(!x)break;x.yields=x.yields||[],x.yields.push([this,$pos]),l=x}for(l=this;;){var L=$parent_match(l,{type:"dict_or_set"});if(!L)break;L.yields=L.yields||[],L.yields.push([this,$pos]),l=L}var D=$get_module(this);D.yields_func_check=D.yields_func_check||[],D.yields_func_check.push([this,$pos]);var z=this.scope=$get_scope(this,!0),M=$get_node(this);M.has_yield=this;var P=$parent_match(this,{type:"comprehension"});if($get_scope(this).id.startsWith("lc"+$B.lambda_magic)&&delete M.has_yield,P){var de=P.tree[0].tree[1];for(l=n;l&&l!==de;)l=l.parent;l||$_SyntaxError(n,["'yield' inside list comprehension"])}var ye=!1;for(l=n;l;){if("lambda"==l.type){ye=!0,this.in_lambda=!0;break}l=l.parent}for(l=M.parent;l;){if(l.C&&l.C.tree.length>0&&"with"==l.C.tree[0].type){z.C.tree[0].$has_yield_in_cm=!0;break}l=l.parent}if(!ye)switch(n.type){case"node":case"assign":case"list_or_tuple":break;default:$_SyntaxError(n,"yield atom must be inside ()")}};$YieldCtx.prototype.toString=function(){return"(yield) "+(this.from?"(from) ":"")+this.tree},$YieldCtx.prototype.transition=function(n,o){var l=this;return"from"==n?("abstract_expr"!=l.tree[0].type&&$_SyntaxError(l,"'from' must follow 'yield'"),l.from=!0,l.from_num=$B.UUID(),l.tree[0]):$transition(l.parent,n)},$YieldCtx.prototype.transform=function(n,o){for(var l=n.parent;l;){if(void 0!==l.ctx_manager_num){n.parent.insert(o+1,$NodeJS("$top_frame[1].$has_yield_in_cm = true"));break}l=l.parent}},$YieldCtx.prototype.to_js=function(){return this.from?`_r${this.from_num}`:"yield "+$to_js(this.tree)},$YieldCtx.prototype.check_in_function=function(){if(!this.in_lambda){var n=$get_scope(this),o=n.is_function,l=n;if(!o&&n.is_comp){for(var x=n.parent_block;x.is_comp;)x=parent_block;o=x.is_function,l=x}o?this.is_await||(l.C.tree[0].type="generator"):$_SyntaxError(this.parent,["'yield' outside function"])}};var $add_line_num=$B.parser.$add_line_num=function(n,o,l){if("module"!=n.type){if("marker"!==n.type){for(var x=n.C.tree[0],L=1,D=!0,z=n;void 0!==z.parent;)z=z.parent;var P=n.line_num;if(void 0===P&&(D=!1),("condition"==x.type&&"elif"==x.token||"except"==x.type||"single_kw"==x.type)&&(D=!1),D){var de=';$locals.$line_info = "'+(void 0===l?P+","+z.id:l)+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;',ye=new $Node;ye.is_line_num=!0,new $NodeJSCtx(ye,de),n.parent.insert(o,ye),L=2}for(he=0;he<n.children.length;)he+=$add_line_num(n.children[he],he,l);return L}return 1}for(var he=0;he<n.children.length;)he+=$add_line_num(n.children[he],he,l)},$bind=$B.parser.$bind=function(n,o,l){if(!o.nonlocals||!o.nonlocals[n])if(o.globals&&o.globals.has(n))$get_module(l).binding[n]=!0;else{if(!l.no_bindings){var x=$get_node(l);x.bindings=x.bindings||{},x.bindings[n]=!0}o.binding=o.binding||{},void 0===o.binding[n]&&(o.binding[n]=!0)}};function $parent_match(n,o){for(var l;n.parent;){for(var x in l=!0,o)if(n.parent[x]!=o[x]){l=!1;break}if(l)return n.parent;n=n.parent}return!1}var $previous=$B.parser.$previous=function(n){var o=n.node.parent.children[n.node.parent.children.length-2];return o&&o.C||$_SyntaxError(n,"keyword not following correct keyword"),o.C.tree[0]},$get_docstring=$B.parser.$get_docstring=function(n){var o="";if(n.children.length>0){var l=n.children[0];if(l.C.tree&&l.C.tree.length>0&&"expr"==l.C.tree[0].type){var x=l.C.tree[0].tree[0];"str"!=x.type||Array.isArray(x.tree[0])||(o=l.C.tree[0].tree[0].to_js())}}return o},$get_scope=$B.parser.$get_scope=function(n,o){for(var l=n.parent;"node"!==l.type;)l=l.parent;for(var x=l.node,L=null;x.parent&&"module"!==x.parent.type;){var D=x.parent.C.tree[0].type;switch(D){case"def":case"class":case"generator":return(L=x.parent).ntype=D,L.is_function="class"!=D,L}x=x.parent}return(L=x.parent||x).ntype="module",L},$get_line_num=$B.parser.$get_line_num=function(n){var o=$get_node(n),l=o.line_num;if(void 0===o.line_num){for(o=o.parent;o&&void 0===o.line_num;)o=o.parent;o&&o.line_num&&(l=o.line_num)}return l},$get_module=$B.parser.$get_module=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node;if("module"==l.ntype)return l;for(var x=null;"module"!=l.parent.type;)l=l.parent;return(x=l.parent).ntype="module",x},$get_src=$B.parser.$get_src=function(n){for(var o=$get_node(n);void 0!==o.parent;)o=o.parent;return o.src},$get_node=$B.parser.$get_node=function(n){for(var o=n;o.parent;)o=o.parent;return o.node},$to_js_map=$B.parser.$to_js_map=function(n){if(void 0!==n.to_js)return n.to_js();throw Error("no to_js() for "+n)},$to_js=$B.parser.$to_js=function(n,o){return void 0===o&&(o=","),n.map($to_js_map).join(o)},$mangle=$B.parser.$mangle=function(n,o){if("__"!=n.substr(0,2)||"__"===n.substr(n.length-2))return n;for(var l=$get_scope(o);;){if("module"==l.ntype)return n;if("class"==l.ntype){for(var x=l.C.tree[0].name;"_"==x.charAt(0);)x=x.substr(1);return"_"+x+n}if(!l.parent||!l.parent.C)return n;l=$get_scope(l.C.tree[0])}},$transition=$B.parser.$transition=function(n,o,l){return n.transition(o,l)};$B.forbidden=["alert","arguments","case","catch","const","constructor","Date","debugger","delete","default","do","document","enum","export","eval","extends","Error","history","function","instanceof","keys","length","location","Math","message","new","null","Number","RegExp","String","super","switch","this","throw","typeof","var","window","toLocaleString","toString","void"],$B.aliased_names=$B.list2obj($B.forbidden);for(var s_escaped="abfnrtvxuU\"0123456789'\\",is_escaped={},i=0;i<s_escaped.length;i++)is_escaped[s_escaped.charAt(i)]=!0;var $tokenize=$B.parser.$tokenize=function(root,src){for(var br_close={")":"(","]":"[","}":"{"},br_stack="",br_pos=[],kwdict=["class","return","break","for","lambda","try","finally","raise","def","from","nonlocal","while","del","global","with","as","elif","else","if","yield","assert","import","except","raise","in","pass","with","continue","__debugger__","async","await"],unsupported=[],$indented=["class","def","for","condition","single_kw","try","except","with"],int_pattern=/^(\d[0-9_]*)(j|J)?/,float_pattern1=/^(\d[\d_]*)\.(\d+(_\d+)*)?([eE][+-]?\d+(_\d+)*)?(j|J)?/,float_pattern2=/^(\d[\d_]*)([eE][+-]?\d+(_\d+)*)(j|J)?/,hex_pattern=/^0[xX]([\da-fA-F_]+)/,octal_pattern=/^0[oO]([0-7_]+)/,binary_pattern=/^0[bB]([01_]+)/,C=null,new_node=new $Node,current=root,name="",_type=null,pos=0,indent=null,string_modifier=!1,module=root.module,lnum=root.line_num||1;pos<src.length;){function rmuf(n){return(n.search("__")>-1||n.endsWith("_"))&&$_SyntaxError(C,"invalid literal"),n.replace(/_/g,"")}function check_int(n){if(rmuf(n),n.startsWith("0")){if(!(n.substr(1).search(/[^0_]/)>-1))return"0";$_SyntaxError(C,"invalid literal")}}function rmu(n){return n.replace(/_/g,"")}var car=src.charAt(pos);if(null!==indent)if("#"!=car)if('"'!=car&&"'"!=car){if(""==name&&"$"!=car){if($B.unicode_tables.XID_Start[car.charCodeAt(0)]){name=car;var p0=pos;for(pos++;pos<src.length&&$B.unicode_tables.XID_Continue[src.charCodeAt(pos)];)name+=src.charAt(pos),pos++}if(name){if(kwdict.indexOf(name)>-1)$pos=pos-name.length,unsupported.indexOf(name)>-1&&$_SyntaxError(C,"Unsupported Python keyword '"+name+"'"),C=$transition(C,name);else if("string"==typeof $operators[name]&&-1==["is_not","not_in"].indexOf(name))if("is"==name){var re=/^\s+not\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","is_not")):($pos=pos-name.length,C=$transition(C,"op",name))}else if("not"==name){var re=/^\s+in\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","not_in")):($pos=pos-name.length,C=$transition(C,name))}else $pos=pos-name.length,C=$transition(C,"op",name);else{if(('"'==src.charAt(pos)||"'"==src.charAt(pos))&&-1!==["r","b","u","rb","br","f","fr","rf"].indexOf(name.toLowerCase())){string_modifier=name.toLowerCase(),name="";continue}$B.forbidden.indexOf(name)>-1&&(name="$$"+name),$pos=pos-name.length,C=$transition(C,"id",name)}name="";continue}}switch(car){case" ":case"\t":pos++;break;case".":if(pos<src.length-1&&/^\d$/.test(src.charAt(pos+1))){for(var j=pos+1;j<src.length&&src.charAt(j).search(/\d|e|E|_/)>-1;)j++;"j"==src.charAt(j)?(C=$transition(C,"imaginary","0"+rmu(src.substr(pos,j-pos))),j++):C=$transition(C,"float","0"+rmu(src.substr(pos,j-pos))),pos=j;break}$pos=pos,C=$transition(C,"."),pos++;break;case"0":var res=hex_pattern.exec(src.substr(pos));if(res){rmuf(res[1]),C=$transition(C,"int",[16,rmu(res[1])]),pos+=res[0].length;break}var res=octal_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[8,rmuf(res[1])]),pos+=res[0].length;break}var res=binary_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[2,rmuf(res[1])]),pos+=res[0].length;break}if(src.charAt(pos+1).search(/\d/)>-1){if(0===parseInt(src.substr(pos))){res=int_pattern.exec(src.substr(pos)),$pos=pos,check_int(res[0]),C=$transition(C,"int",[10,rmu(res[0])]),pos+=res[0].length;break}$_SyntaxError(C,"invalid literal starting with 0")}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var res=float_pattern1.exec(src.substr(pos));res?(check_int(res[1]),res[2]&&rmuf(res[2]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=float_pattern2.exec(src.substr(pos)),res?(check_int(res[1]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=int_pattern.exec(src.substr(pos)),check_int(res[1]),$pos=pos,C=void 0!==res[2]?$transition(C,"imaginary",rmu(res[1])):$transition(C,"int",[10,rmu(res[0])]))),pos+=res[0].length;break;case"\n":lnum++,br_stack.length>0||(current.C.tree.length>0||current.C.async?($pos=pos,C=$transition(C,"eol"),indent=null,new_node=new $Node):new_node.line_num=lnum),pos++;break;case"(":case"[":case"{":br_stack+=car,br_pos[br_stack.length-1]=[C,pos],$pos=pos,C=$transition(C,car),pos++;break;case")":case"]":case"}":""==br_stack?($pos=pos,$_SyntaxError(C,"Unexpected closing bracket")):br_close[car]!=br_stack.charAt(br_stack.length-1)?($pos=pos,$_SyntaxError(C,"Unbalanced bracket")):(br_stack=br_stack.substr(0,br_stack.length-1),$pos=pos,C=$transition(C,car),pos++);break;case"=":"="!=src.charAt(pos+1)?($pos=pos,C=$transition(C,"="),pos++):($pos=pos,C=$transition(C,"op","=="),pos+=2);break;case",":case":":$pos=pos,":="==src.substr(pos,2)?(C=$transition(C,":="),pos++):C=$transition(C,car),pos++;break;case";":$transition(C,"eol"),0==current.C.tree.length&&($pos=pos,$_SyntaxError(C,"invalid syntax"));for(var pos1=pos+1,ends_line=!1;pos1<src.length;){var _s=src.charAt(pos1);if("\n"==_s||"#"==_s){ends_line=!0;break}if(" "!=_s)break;pos1++}if(ends_line){pos++;break}new_node=new $Node,new_node.indent=$get_node(C).indent,new_node.line_num=lnum,new_node.module=module,$get_node(C).parent.add(new_node),current=new_node,C=new $NodeCtx(new_node),pos++;break;case"/":case"%":case"&":case">":case"<":case"-":case"+":case"*":case"@":case"/":case"^":case"=":case"|":case"~":case"!":if("-"==car&&">"==src.charAt(pos+1)){C=$transition(C,"annotation"),pos+=2;continue}if("@"==car&&"node"==C.type){$pos=pos,C=$transition(C,car),pos++;break}var op_match="";for(var op_sign in $operators)op_sign==src.substr(pos,op_sign.length)&&op_sign.length>op_match.length&&(op_match=op_sign);$pos=pos,op_match.length>0?(C=$transition(C,op_match in $augmented_assigns?"augm_assign":"op",op_match),pos+=op_match.length):$_SyntaxError(C,"invalid character: "+car);break;case"\\":if("\n"==src.charAt(pos+1)){lnum++,pos+=2,pos==src.length?$_SyntaxError(C,["unexpected EOF while parsing"]):"node"==C.type&&$_SyntaxError(C,"nothing before \\");break}$pos=pos,$_SyntaxError(C,["unexpected character after line continuation character"]);case String.fromCharCode(12):pos+=1;break;default:$pos=pos,$_SyntaxError(C,"unknown token ["+car+"]")}}else{var raw="str"==C.type&&C.raw,bytes=!1,fstring=!1,sm_length,end=null;if(string_modifier){switch(string_modifier){case"r":raw=!0;break;case"u":break;case"b":bytes=!0;break;case"rb":case"br":bytes=!0,raw=!0;break;case"f":fstring=!0,sm_length=1;break;case"rf":fstring=!0,sm_length=2,raw=!0}string_modifier=!1}src.substr(pos,3)==car+car+car?(_type="triple_string",end=pos+3):(_type="string",end=pos+1);for(var escaped=!1,zone=car,found=!1;end<src.length;)if(escaped)"a"==src.charAt(end)?zone=zone.substr(0,zone.length-1)+"\x07":(zone+=src.charAt(end),raw&&"\\"==src.charAt(end)&&(zone+="\\")),escaped=!1,end++;else if("\\"==src.charAt(end))if(raw)end<src.length-1&&src.charAt(end+1)==car?(zone+="\\\\"+car,end+=2):(zone+="\\\\",end++),escaped=!0;else if("\n"==src.charAt(end+1))end+=2,lnum++;else if("N{"==src.substr(end+1,2)){var end_lit=end+3,re=new RegExp("[-a-zA-Z0-9 ]+"),search=re.exec(src.substr(end_lit));null===search&&$_SyntaxError(C,"(unicode error) malformed \\N character escape",pos);var end_lit=end_lit+search[0].length;"}"!=src.charAt(end_lit)&&$_SyntaxError(C,"(unicode error) malformed \\N character escape");var description=search[0].toUpperCase();if(void 0===$B.unicodedb){var xhr=new XMLHttpRequest;xhr.open("GET",$B.brython_path+"unicode.txt",!1),xhr.onreadystatechange=function(){4==this.readyState&&(200==this.status?$B.unicodedb=this.responseText:console.log("Warning - could not load unicode.txt"))},xhr.send()}if(void 0!==$B.unicodedb){var re=new RegExp("^([0-9A-F]+);"+description+";.*$","m");search=re.exec($B.unicodedb),null===search&&$_SyntaxError(C,"(unicode error) unknown Unicode character name");var cp="0x"+search[1];zone+=String.fromCodePoint(eval(cp)),end=end_lit+1}else end++}else end<src.length-1&&void 0===is_escaped[src.charAt(end+1)]&&(zone+="\\"),zone+="\\",escaped=!0,end++;else if("\n"==src.charAt(end)&&"triple_string"!=_type)console.log(pos,end,src.substring(pos,end)),$pos=end,$_SyntaxError(C,["EOL while scanning string literal"]);else if(src.charAt(end)==car){if("triple_string"!=_type||src.substr(end,3)==car+car+car){found=!0,$pos=pos;for(var $string=zone.substr(1),string="",i=0;i<$string.length;i++){var $car=$string.charAt(i);$car!=car||!raw&&0!=i&&"\\"==$string.charAt(i-1)||(string+="\\"),string+=$car}if(fstring)try{var re=new RegExp("\\\\"+car,"g"),string_no_bs=string.replace(re,car),elts=$B.parse_fstring(string_no_bs)}catch(n){$_SyntaxError(C,[n.toString()])}bytes?C=$transition(C,"str","b"+car+string+car):fstring?($pos-=sm_length,C=$transition(C,"str",elts),$pos+=sm_length):C=$transition(C,"str",car+string+car),C.raw=raw,pos=end+1,"triple_string"==_type&&(pos=end+3);break}zone+=src.charAt(end),end++}else zone+=src.charAt(end),"\n"==src.charAt(end)&&lnum++,end++;found||$_SyntaxError(C,"triple_string"===_type?"Triple string end not found":"String end not found")}else{var end=src.substr(pos+1).search("\n");-1==end&&(end=src.length-1),root.comments.push([pos,end]),pos+=end+1}else{for(var indent=0;pos<src.length;){var _s=src.charAt(pos);if(" "==_s)indent++,pos++;else{if("\t"!=_s)break;indent++,pos++,indent%8>0&&(indent+=8-indent%8)}}var _s=src.charAt(pos);if("\n"==_s){pos++,lnum++,indent=null;continue}if("#"==_s){var offset=src.substr(pos).search(/\n/);if(-1==offset)break;pos+=offset+1,lnum++,indent=null;continue}if(new_node.indent=indent,new_node.line_num=lnum,new_node.module=module,current.is_body_node&&(current.indent=indent),indent>current.indent)null!==C&&-1==$indented.indexOf(C.tree[0].type)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos)),current.add(new_node);else if(indent<=current.indent&&C&&C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1&&C.tree.length<2)$pos=pos,$_SyntaxError(C,"expected an indented block",pos);else{for(;indent!==current.indent;)current=current.parent,(void 0===current||indent>current.indent)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos));current.parent.add(new_node)}current=new_node,C=new $NodeCtx(new_node)}}if(0!=br_stack.length){var br_err=br_pos[0];$pos=br_err[1];var lines=src.split("\n"),id=root.id,fname=id.startsWith("$")?"<string>":id;$_SyntaxError(br_err[0],["unexpected EOF while parsing ("+fname+", line "+(lines.length-1)+")"])}if(null!==C){if("async"==C.type)throw console.log("error with async",pos,src,src.substr(pos)),$pos=pos-7,$_SyntaxError(C,"car "+car+"after async",pos);if(C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1)$pos=pos-1,$_SyntaxError(C,"expected an indented block",pos);else{var parent=current.parent;if(parent.C&&parent.C.tree&&parent.C.tree[0]&&"try"==parent.C.tree[0].type&&($pos=pos-1,$_SyntaxError(C,["unexpected EOF while parsing"])),root.yields_func_check){var save_pos=$pos;for(const n of root.yields_func_check)$pos=n[1],n[0].check_in_function();$pos=save_pos}}}},$create_root_node=$B.parser.$create_root_node=function(n,o,l,x,L){var D=new $Node("module");return D.module=o,D.id=l,D.binding={__doc__:!0,__name__:!0,__file__:!0,__package__:!0},D.parent_block=x,D.line_num=L,D.indent=-1,D.comments=[],D.imports={},"object"==typeof n&&(D.is_comp=n.is_comp,n.has_annotations&&(D.binding.__annotations__=!0),n=n.src),D.src=n,D};$B.py2js=function(n,o,l,x,L){if($pos=0,"object"==typeof o){var D=o.__package__;o=o.__name__}else D="";x=x||$B.builtins_scope;var z=(new Date).getTime(),M=!1,P=!0;if("object"==typeof n){M=n.is_comp,P=n.has_annotations;var de=n.line_info,ye=n.ix;void 0!==de&&(L=parseInt(de.split(",")[0])),n=n.src}(n=n.replace(/\r\n/gm,"\n")).endsWith("\\")&&!n.endsWith("\\\\")&&(n=n.substr(0,n.length-1)),"\n"!=n.charAt(n.length-1)&&(n+="\n"),Array.isArray(l)&&(l=l[0]),l.charAt(0);var he="$locals_"+l.replace(/\./g,"_"),ae="$locals_"+o.replace(/\./g,"_"),fe=$create_root_node({src:n,is_comp:M,has_annotations:P},o,l,x,L);$tokenize(fe,n),fe.is_comp=M,null!=ye&&(fe.ix=ye),fe.transform();var le=1;(A=["var $B = __BRYTHON__;\n"])[le++]="var _b_ = __BRYTHON__.builtins;\n",A[2]="var $locals = "+he,M&&(A[2]+=" = {}");var q=0;fe.insert(0,$NodeJS(A.join(""))),q++,fe.insert(q++,$NodeJS(he+'.__package__ = "'+D+'"')),fe.binding.__annotations__&&fe.insert(q++,$NodeJS("$locals.__annotations__ = $B.empty_dict()"));var Y=q,A='var $top_frame = ["'+l.replace(/\./g,"_")+'", '+he+', "'+o.replace(/\./g,"_")+'", '+ae+"]\n$locals.$f_trace = $B.enter_frame($top_frame)\nvar $stack_length = $B.frames_stack.length;";fe.insert(q++,$NodeJS(A));var N=new $NodeJS("try"),X=fe.children.slice(Y+1,fe.children.length);fe.insert(Y+1,N),0==X.length&&(X=[$NodeJS("")]),X.forEach(function(Ce){N.add(Ce)}),N.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),fe.children.splice(Y+2,fe.children.length);var oe=$NodeJS("catch(err)");oe.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),oe.add($NodeJS("throw err")),fe.add(oe),$add_line_num(fe,null,de);var H=(new Date).getTime();return $B.debug>2&&o==l&&console.log("module "+o+" translated in "+(H-z)+" ms"),$B.compile_time+=H-z,fe},$B.set_import_paths=function(){var n=[],o=[];$B.use_VFS&&n.push($B.finders.VFS),!1!==$B.$options.static_stdlib_import&&"file"!=$B.protocol&&(n.push($B.finders.stdlib_static),$B.path.length>3&&($B.path.shift(),$B.path.shift())),"file"!==$B.protocol&&(n.push($B.finders.path),o.push($B.$path_hooks[0])),$B.$options.cpython_import&&("replace"==$B.$options.cpython_import&&$B.path.pop(),n.push($B.finders.CPython)),$B.meta_path=n,$B.path_hooks=o};var brython=$B.parser.brython=function(n){void 0===n&&(n={debug:1}),"number"==typeof n&&(n={debug:n}),void 0===n.debug&&(n.debug=1),$B.debug=n.debug,_b_.__debug__=$B.debug>0,$B.compile_time=0,void 0===n.profile&&(n.profile=0),$B.profile=n.profile,void 0===n.indexedDB&&(n.indexedDB=!0),void 0===n.static_stdlib_import&&(n.static_stdlib_import=!0),$B.static_stdlib_import=n.static_stdlib_import,$B.$options=n,$B.set_import_paths();var o=($B.script_path=_window.location.href).split("/");if(o.pop(),($B.isWebWorker||$B.isNode)&&o.pop(),$B.curdir=o.join("/"),void 0!==n.pythonpath&&($B.path=n.pythonpath,$B.$options.static_stdlib_import=!1),n.python_paths&&n.python_paths.forEach(function(P){var de,ye;"string"!=typeof P&&(de=P.lang,ye=P.prefetch,P=P.path),$B.path.push(P),".vfs.js"!=P.slice(-7).toLowerCase()||void 0!==ye&&!0!==ye||($B.path_importer_cache[P+"/"]=$B.imported._importlib.VFSPathFinder(P)),de&&L.optimize_import_for_path(P,de)}),!$B.isWebWorker&&!$B.isNode)for(var l,x=document.querySelectorAll("head link[rel~=pythonpath]"),L=$B.imported._importlib,D=0;l=x[D];++D){var z=l.href;-1!=(" "+l.rel+" ").indexOf(" prepend ")?$B.path.unshift(z):$B.path.push(z);var M=l.hreflang;M&&("x-"==M.slice(0,2)&&(M=M.slice(2)),L.optimize_import_for_path(l.href,M))}$B.__ARGV=$B.$options.args?$B.$options.args:_b_.list.$factory([]),$B.isWebWorker||$B.isNode||_run_scripts(n)};$B.run_script=function(n,o,l){$B.$py_module_path[o]=$B.script_path;try{var x=$B.py2js(n,o,o),L=x.to_js(),D={__doc__:x.__doc__,js:L,__name__:o,$src:n,__file__:$B.script_path+($B.script_path.endsWith("/")?"":"/")+o};$B.file_cache[D.__file__]=n,$B.debug>1&&console.log(L)}catch(P){$B.handle_error(P)}if($B.hasOwnProperty("VFS")&&$B.has_indexedDB){var z=Object.keys(x.imports).slice().filter(function(P){return $B.VFS.hasOwnProperty(P)});Object.keys(z).forEach(function(P){if($B.VFS.hasOwnProperty(P)){var de=$B.VFS[P],ye=de[0];if(".py"==ye){var he=de[2];".py"==ye&&required_stdlib_imports(he),he.forEach(function(ae){-1==z.indexOf(ae)&&z.push(ae)})}}});for(var M=0;M<z.length;M++)$B.tasks.push([$B.inImported,z[M]]);x=null}$B.tasks.push(["execute",D]),l&&$B.loop()};var $log=$B.$log=function(n){n.split("\n").forEach(function(o,l){console.log(l+1,":",o)})},_run_scripts=$B.parser._run_scripts=function(options){var kk=Object.keys(_window),defined_ids={};if(void 0!==options.ipy_id){var $elts=[];options.ipy_id.forEach(function(n){$elts.push(document.getElementById(n))})}else for(var scripts=document.getElementsByTagName("script"),$elts=[],webworkers=[],i=0;i<scripts.length;i++){var script=scripts[i];if("text/python"==script.type||"text/python3"==script.type)if("webworker"==script.className){if(void 0===script.id)throw _b_.AttributeError.$factory("webworker script has no attribute 'id'");webworkers.push(script)}else $elts.push(script)}var first_script=!0,module_name;if(void 0!==options.ipy_id){module_name="__main__";var $src="",js,root;$B.$py_module_path[module_name]=$B.script_path,$elts.forEach(function(n){$src+=n.innerHTML||n.textContent});try{root=$B.py2js($src,module_name,module_name),js=root.to_js(),$B.debug>1&&$log(js),eval(js),$B.clear_ns(module_name),root=null,js=null}catch(n){if(root=null,js=null,console.log(n),$B.debug>1)for(var attr in console.log(n),n)console.log(attr+" : ",n[attr]);void 0===n.$py_error&&(console.log("Javascript error",n),n=_b_.RuntimeError.$factory(n+""));var $trace=$B.$getattr(n,"info")+"\n"+n.__name__+": "+n.args;try{$B.$getattr($B.stderr,"write")($trace)}catch{console.log($trace)}throw n}}else{$elts.length>0&&options.indexedDB&&$B.has_indexedDB&&$B.hasOwnProperty("VFS")&&$B.tasks.push([$B.idb_open]);for(var i=0;i<$elts.length;i++){var elt=$elts[i];if(elt.id){if(defined_ids[elt.id])throw Error("Brython error : Found 2 scripts with the same id '"+elt.id+"'");defined_ids[elt.id]=!0}}for(var src,i=0,len=webworkers.length;i<len;i++){var worker=webworkers[i];worker.src?$B.tasks.push([$B.ajax_load_script,{name:worker.id,url:worker.src,is_ww:!0}]):(src=worker.innerHTML||worker.textContent,src=src.replace(/^\n/,""),$B.webworkers[worker.id]=src)}for(var i=0;i<$elts.length;i++){var elt=$elts[i];if("text/python"==elt.type||"text/python3"==elt.type){if(elt.id)module_name=elt.id;else for(first_script?(module_name="__main__",first_script=!1):module_name="__main__"+$B.UUID();void 0!==defined_ids[module_name];)module_name="__main__"+$B.UUID();elt.src?$B.tasks.push([$B.ajax_load_script,{name:module_name,url:elt.src}]):(src=elt.innerHTML||elt.textContent,src=src.replace(/^\n/,""),$B.run_script(src,module_name))}}}void 0===options.ipy_id&&$B.loop()};$B.$operators=$operators,$B.$Node=$Node,$B.$NodeJSCtx=$NodeJSCtx,$B.brython=brython}(__BRYTHON__);var brython=__BRYTHON__.brython;__BRYTHON__.isNode&&(__webpack_require__.g.__BRYTHON__=__BRYTHON__,module.exports={__BRYTHON__}),function(n){var o=n.builtins;function l(z,M,P,de,ye){var he=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules"),ae=(he.openCursor(),{name:z,content:M,imports:de,origin,timestamp:__BRYTHON__.timestamp,source_ts:P,is_package:ye}),fe=he.put(ae);n.debug>1&&console.log("store precompiled",z,"package",ye),document.dispatchEvent(new CustomEvent("precompile",{detail:"cache module "+z}));var le=n.outdated.indexOf(z);le>-1&&n.outdated.splice(le,1),fe.onsuccess=function(q){n.tasks.splice(0,0,[x,z]),D()}}function x(z){var M=n.idb_cx.result.transaction("modules","readonly");try{var P=M.objectStore("modules");req=P.get(z),req.onsuccess=function(de){!function(ye,he){var ae=ye.target.result;if(void 0===ae||ae.timestamp!=n.timestamp||n.VFS[he]&&ae.source_ts!==n.VFS[he].timestamp){if(void 0!==n.VFS[he]){var fe=(Ge=n.VFS[he])[0],le=Ge[1];if(".py"==fe){var q,Y,A=Ge[2],N=4==Ge.length,X=Ge.timestamp;N?q=he:((Y=he.split(".")).pop(),q=Y.join(".")),n.imported[he]=n.module.$factory(he,"",q);try{var oe=n.py2js(le,he,he).to_js()}catch(Xe){n.handle_error(Xe)}delete n.imported[he],n.debug>1&&console.log("precompile",he),(Y=he.split(".")).length>1&&Y.pop(),n.stdlib.hasOwnProperty(Y.join("."))&&(A=(A=Ge[2]).join(","),n.tasks.splice(0,0,[l,he,oe,X,A,N]))}else console.log("bizarre",he,fe)}}else if(n.precompiled[he]=ae.is_package?[ae.content]:ae.content,ae.imports.length>0){n.debug>1&&console.log(he,"imports",ae.imports);for(var H=ae.imports.split(","),Ce=0;Ce<H.length;Ce++){var Q=H[Ce];if(Q.startsWith(".")){for(var xe=he.split("."),Pe=0;Q.startsWith(".");)Pe++,Q=Q.substr(1);var Ge=xe.slice(0,Pe);Q&&(Ge=Ge.concat([Q])),Q=Ge.join(".")}if(!n.imported.hasOwnProperty(Q)&&!n.precompiled.hasOwnProperty(Q)&&n.VFS.hasOwnProperty(Q)){var Ae=n.VFS[Q];fe=Ae[0],le=Ae[1],".py"==Ae[0]?n.tasks.splice(0,0,[x,Q]):L(Q,le)}}}D()}(de,z)}}catch(de){console.info("error",de)}}function L(z,M){M+="\nvar $locals_"+z.replace(/\./g,"_")+" = $module",n.precompiled[z]=M}n.VFS_timestamp&&n.VFS_timestamp>n.timestamp&&(n.timestamp=n.VFS_timestamp),n.idb_open=function(z){n.idb_name="brython-cache";var M=n.idb_cx=indexedDB.open(n.idb_name);M.onsuccess=function(){var P=M.result;if(P.objectStoreNames.contains("modules")){n.debug>1&&console.info("using indexedDB for stdlib modules cache");var de,ye=P.transaction("modules","readwrite").objectStore("modules"),he=[],ae=ye.openCursor();ae.onerror=function(le){console.log("open cursor error",le)},ae.onsuccess=function(le){cursor=le.target.result,cursor?((de=cursor.value).timestamp==n.timestamp?n.VFS&&n.VFS[de.name]&&n.VFS[de.name].timestamp!=de.source_ts?he.push(de.name):(n.precompiled[de.name]=de.is_package?[de.content]:de.content,n.debug>1&&console.info("load from cache",de.name)):he.push(de.name),cursor.continue()):(n.debug>1&&console.log("done"),n.outdated=he,D())}}else{var fe=P.version;P.close(),console.info("create object store",fe),(M=indexedDB.open(n.idb_name,fe+1)).onupgradeneeded=function(){console.info("upgrade needed"),n.idb_cx.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onversionchanged=function(){console.log("version changed")},M.onsuccess=function(){console.info("db opened",M),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D}}},M.onupgradeneeded=function(){console.info("upgrade needed"),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onerror=function(){console.info("could not open indexedDB database"),n.idb_cx=null,n.idb_name=null,n.$options.indexedDB=!1,D()}},n.ajax_load_script=function(z){var M=z.url,P=z.name;if(n.files&&n.files.hasOwnProperty(P))n.tasks.splice(0,0,[n.run_script,n.files[P],P,!0]);else{if("file"==n.protocol)throw o.IOError.$factory("can't load external script at "+z.url+" (Ajax calls not supported with protocol file:///)");var de=new XMLHttpRequest,ye=n.$options.cache?"":(M.search(/\?/)>-1?"&":"?")+Date.now();de.open("GET",M+ye,!0),de.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var he=this.responseText;z.is_ww?n.webworkers[P]=he:n.tasks.splice(0,0,[n.run_script,he,P,!0]),D()}else if(404==this.status)throw Error(M+" not found")},de.send()}},n.inImported=function(z){if(!n.imported.hasOwnProperty(z))if(__BRYTHON__.VFS&&__BRYTHON__.VFS.hasOwnProperty(z)){var M=__BRYTHON__.VFS[z];void 0===M&&console.log("bizarre",z);var de=M[1];".py"==M[0]?n.idb_cx&&!n.idb_cx.$closed&&n.tasks.splice(0,0,[x,z]):L(z,de)}else console.log("bizarre",z);D()};var D=n.loop=function(){if(0!=n.tasks.length){var z=n.tasks.shift(),M=z[0],P=z.slice(1);if("execute"==M){try{var de=z[1],ye=de.__name__.replace(/\./g,"_");(ae=n.module.$factory(de.__name__)).$src=de.$src,ae.__file__=de.__file__,n.imported[ye]=ae,new Function("$locals_"+ye,de.js)(ae)}catch(fe){void 0===fe.__class__&&(console.log("Javascript error",fe),n.is_recursion_error(fe)?fe=o.RecursionError.$factory("too much recursion"):(n.print_stack(),fe=o.RuntimeError.$factory(fe+""))),n.debug>1&&(console.log("handle error",fe.__class__,fe.args,fe.$stack),console.log(n.frames_stack.slice())),n.handle_error(fe)}D()}else try{M.apply(null,P)}catch(fe){n.handle_error(fe)}}else if(n.idb_cx&&!n.idb_cx.$closed){for(var he=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules");n.outdated.length>0;){var ae=n.outdated.pop();he.delete(ae).onsuccess=function(fe){n.debug>1&&console.info("delete outdated",ae),document.dispatchEvent(new CustomEvent("precompile",{detail:"remove outdated "+ae+" from cache"}))}}document.dispatchEvent(new CustomEvent("precompile",{detail:"close"})),n.idb_cx.result.close(),n.idb_cx.$closed=!0}};n.tasks=[],n.has_indexedDB=void 0!==self.indexedDB,n.handle_error=function(z){if(n.debug>1&&console.log("handle error",z.__class__,z.args),void 0!==z.__class__){var M=n.class_name(z),P=n.$getattr(z,"info");"SyntaxError"==M||"IndentationError"==M?P+="\n    "+" ".repeat(z.args[3])+"^\n"+M+": "+z.args[0]:(P+="\n"+M,z.args[0]&&z.args[0]!==o.None&&(P+=": "+o.str.$factory(z.args[0])))}else console.log(z),P=z+"";try{n.$getattr(n.stderr,"write")(P);try{n.$getattr(n.stderr,"flush")()}catch(ye){console.log(ye)}}catch{console.log(P)}throw z}}(__BRYTHON__),__BRYTHON__.builtins.object=function(n){var o=n.builtins,l={$infos:{__name__:"object"},$is_class:!0,$native:!0};function x(L){return n.$getattr(L,"__new__").apply(null,arguments)}return l.__delattr__=function(L,D){if(D=n.from_alias(D),L.__dict__&&L.__dict__.$string_dict&&void 0!==L.__dict__.$string_dict[D])return delete L.__dict__.$string_dict[D],o.None;if(void 0===L.__dict__&&void 0!==L[D])return delete L[D],o.None;var z=L.__class__;if(z){var M=n.$getattr(z,D);if(M.__class__===o.property&&void 0!==M.__delete__)return M.__delete__(L),o.None}throw o.AttributeError.$factory(D)},l.__dir__=function(L){var D;if(L.$is_class)D=[L].concat(L.__mro__);else{var z=L.__class__||n.get_class(L);D=[L,z].concat(z.__mro__)}for(var M=[],P=0,de=D.length;P<de;P++)for(var ye in D[P])"$"!=ye.charAt(0)?isNaN(parseInt(ye.charAt(0)))&&"__mro__"!=ye&&M.push(ye):"$"==ye.charAt(1)&&M.push(ye.substr(2));if(L.__dict__)for(var ye in L.__dict__.$string_dict)"$$"==ye.substr(0,2)?M.push(ye.substr(2)):"$"!=ye.charAt(0)&&M.push(ye);return M=o.list.$factory(o.set.$factory(M)),o.list.sort(M),M},l.__eq__=function(L,D){return L===D||o.NotImplemented},l.__format__=function(){var L=n.args("__format__",2,{self:null,spec:null},["self","spec"],arguments,{},null,null);if(""!==L.spec)throw o.TypeError.$factory("non-empty format string passed to object.__format__");return o.getattr(L.self,"__str__")()},l.__ge__=function(){return o.NotImplemented},l.__getattribute__=function(L,D){var z=L.__class__||n.get_class(L),M=!1;if("__class__"===D)return z;var P=L[D];if(Array.isArray(L)&&void 0!==Array.prototype[D]&&(P=void 0),void 0===P&&L.__dict__){var de=L.__dict__;if(de.$string_dict.hasOwnProperty(D))return de.$string_dict[D][0]}if(void 0===P){let oe=function(H,Ce,Q){var xe=Ce[Q];if(void 0!==xe)return xe};if(void 0===(P=oe(0,z,D)))for(var ye=0,he=(A=z.__mro__).length;ye<he&&void 0===(P=oe(0,A[ye],D));ye++);else P.__class__!==n.method&&void 0===P.__get__&&(M=!0)}else if(void 0===P.__set__)return P;if(void 0!==P){if(P.__class__===o.property)return P.__get__(P,L,z);if(P.__class__===n.method)return void 0===P.__get__&&console.log("bizarre",L,D,P),P.__get__(L,z);if(void 0===(ae=P.__get__)&&P.__class__){var ae=P.__class__.__get__;for(ye=0;ye<P.__class__.__mro__.length&&void 0===ae;ye++)ae=P.__class__.__mro__[ye].__get__}var fe=void 0===ae?null:n.$getattr(P,"__get__",null);if(null!==fe)try{return fe.apply(null,[L,z])}catch(oe){throw console.log("error in get.apply",oe),console.log("get attr",D,"of",L),console.log(fe+""),oe}if("object"==typeof P&&fe&&"function"==typeof fe&&(get_func=function(oe,H){return fe.apply(oe,[H,z.$factory])}),null===fe&&"function"==typeof P&&(fe=function(oe){return oe}),null!==fe){P.__name__=D,"__new__"==D&&(P.$type="staticmethod");var le=fe.apply(null,[P,L,z]);if("function"==typeof le){if(le.__class__===n.method||"staticmethod"==P.$type)return P;var q=P.__class__===n.method?z:L,Y=function(){for(var oe=[q],H=0,Ce=arguments.length;H<Ce;H++)oe.push(arguments[H]);return P.apply(this,oe)};return Y.__class__=n.method,(Y.__get__=function(oe,H){var Ce=P.bind(null,H);return Ce.__class__=n.method,Ce.$infos={__self__:H,__func__:P,__name__:P.$infos.__name__,__qualname__:H.$infos.__name__+"."+P.$infos.__name__},Ce}).__class__=n.method_wrapper,Y.__get__.$infos=P.$infos,void 0===z.$infos&&(console.log("no $infos",z),console.log(n.last(n.frames_stack))),Y.$infos={__self__:q,__func__:P,__name__:D,__qualname__:z.$infos.__name__+"."+D},M&&(L.$method_cache=L.$method_cache||{},L.$method_cache[D]=[Y,P]),Y}return le}return P}var A,N=L.__getattr__;if(void 0===N&&void 0===(N=z.__getattr__))for(ye=0,he=(A=z.__mro__).length;ye<he&&void 0===(N=A[ye].__getattr__);ye++);if(void 0!==N)return z===n.module?N(D):N(L,D);throw o.AttributeError.$factory(D)},l.__gt__=function(){return o.NotImplemented},l.__hash__=function(L){var D=L.__hashvalue__;return void 0!==D?D:L.__hashvalue__=n.$py_next_hash--},l.__init__=function(){if(0==arguments.length)throw o.TypeError.$factory("descriptor '__init__' of 'object' object needs an argument");return o.None},l.__init_subclass__=function(){return n.args("__init_subclass__",0,{},[],arguments,{},null,null),o.None},l.__init_subclass__.$type="staticmethod",l.__le__=function(){return o.NotImplemented},l.__lt__=function(){return o.NotImplemented},l.__mro__=[],l.__new__=function(L,...D){if(void 0===L)throw o.TypeError.$factory("object.__new__(): not enough arguments");if(n.$getattr(L,"__init__")===l.__init__&&D.length>0)throw o.TypeError.$factory("object() takes no parameters");return{__class__:L,__dict__:n.empty_dict()}},l.__ne__=function(L,D){if(L===D)return!1;var z=n.$getattr(L,"__eq__",null);if(null!==z){var M=n.$call(z)(D);return M===o.NotImplemented?M:!n.$bool(M)}return o.NotImplemented},l.__reduce__=function(L){function D(de){return n.$call(de)()}D.$infos={__qualname__:"_reconstructor"};var z=[D];z.push(o.tuple.$factory([L.__class__].concat(L.__class__.__mro__)));var M=n.empty_dict();for(var P in L.__dict__.$string_dict)o.dict.$setitem(M.$string_dict,P,L.__dict__.$string_dict[P][0]);return console.log("object.__reduce__, d",M),z.push(M),o.tuple.$factory(z)},x.$infos={__name__:"__newobj__",__qualname__:"__newobj__"},o.__newobj__=x,l.__reduce_ex__=function(L){var D=[x],z=o.tuple.$factory([L.__class__]);Array.isArray(L)&&L.forEach(function(ye){z.push(ye)}),D.push(z);var M=n.empty_dict(),P=0;if(void 0===L.__dict__)throw o.TypeError.$factory("cannot pickle '"+n.class_name(L)+"' object");for(var de in L.__dict__.$string_dict)"__class__"==de||de.startsWith("$")||(o.dict.$setitem(M,de,L.__dict__.$string_dict[de][0]),P++);return 0==P&&(M=o.None),D.push(M),D.push(o.None),o.tuple.$factory(D)},l.__repr__=function(L){if(L===l)return"<class 'object'>";if(L.__class__===o.type)return"<class '"+L.__name__+"'>";var D=L.__class__.$infos.__module__;return void 0===D||D.startsWith("$")||"builtins"===D?"<"+n.class_name(L)+" object>":"<"+L.__class__.$infos.__module__+"."+n.class_name(L)+" object>"},l.__setattr__=function(L,D,z){if(void 0===z)throw o.TypeError.$factory("can't set attributes of built-in/extension type 'object'");if(L.__class__===l)throw o.AttributeError.$factory(void 0===l[D]?"'object' object has no attribute '"+D+"'":"'object' object attribute '"+D+"' is read-only");return n.aliased_names[D]&&(D="$$"+D),L.__dict__?o.dict.$setitem(L.__dict__,D,z):L[D]=z,o.None},l.__setattr__.__get__=function(L){return function(D,z){l.__setattr__(L,D,z)}},l.__setattr__.__str__=function(){return"method object.setattr"},l.__str__=function(L){var D=n.$getattr(L,"__repr__");return n.$call(D)()},l.__subclasshook__=function(){return o.NotImplemented},l.$factory=function(){var L={__class__:l},D=[L].concat(Array.prototype.slice.call(arguments));return l.__init__.apply(null,D),L},n.set_func_names(l,"builtins"),n.make_class=function(L,D){var z={__class__:o.type,__mro__:[l],$infos:{__name__:L},$is_class:!0};return z.$factory=D,z},l}(__BRYTHON__),function(n){var o=n.builtins;n.$class_constructor=function(M,P,de,ye,he){var ae;de=de||[];var fe=P.__module__;void 0===fe&&(fe=P.__module__=n.last(n.frames_stack)[2]);for(var le=0;le<de.length;le++)if(void 0===de[le])throw n.line_info=P.$def_line,o.NameError.$factory("name '"+ye[le]+"' is not defined");var q={},Y={};if(he)for(le=0;le<he.length;le++){var N=he[le][1];"metaclass"==(A=he[le][0])?ae=N:q[A]=N,Y[A]=N}var X=P;void 0!==P.__eq__&&void 0===P.__hash__&&(P.__hash__=o.None);var oe=de.slice(),H=!1;for(le=0;le<de.length;le++)if(void 0===de[le]||void 0===de[le].__mro__){var Ce=n.$getattr(de[le],"__mro_entries__",o.None);if(Ce!==o.None){var Q=o.list.$factory(Ce(de));de.splice(le,1,...Q),H=!0,le--;continue}}if(void 0===ae)if(de&&de.length>0){if(void 0===(ae=de[0].__class__)){if("function"!=typeof de[0])throw o.TypeError.$factory("Argument of "+M+"is not a class (type '"+n.class_name(de[0])+"')");if(1!=de.length)throw o.TypeError.$factory("A Brython class can inherit at most 1 Javascript constructor");ae=de[0].__class__=n.JSMeta,n.set_func_names(de[0],fe)}for(le=1;le<de.length;le++){var xe=de[le].__class__;if(xe!==ae&&!o.issubclass(ae,xe))if(o.issubclass(xe,ae))ae=xe;else if(ae.__bases__&&-1==ae.__bases__.indexOf(xe))throw o.TypeError.$factory("metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases")}}else ae=o.type;var Pe=n.$getattr(ae,"__prepare__",o.None),Ge=n.$call(Pe)(M,de);for(var Ae in set_class_item=Ge.__class__!==o.dict?n.$getattr(Ge,"__setitem__"):function(dn,On){Ge.$string_dict[dn]=[On,Ge.$order++]},P)if("__annotations__"==Ae)for(var A in void 0===Ge.$string_dict[Ae]&&(Ge.$string_dict[Ae]=[n.empty_dict(),Ge.$order++]),P[Ae].$string_dict)n.$setitem(Ge.$string_dict[Ae][0],A,P[Ae].$string_dict[A][0]);else"$"==Ae.charAt(0)&&"$$"!=Ae.substr(0,2)||set_class_item(Ae,P[Ae]);H&&set_class_item("__orig_bases__",o.tuple.$factory(oe));var Xe={__bases__:de,__class__:ae,__dict__:Ge};if(Ge.__class__===o.dict)for(var A in Ge.$string_dict)Xe[A]=Ge.$string_dict[A][0];else for(var Ke=n.$getattr(Ge,"__getitem__"),yt=o.iter(Ge);;)try{Xe[A=o.next(yt)]=Ke(A)}catch{break}Xe.__mro__=o.type.mro(Xe).slice(1);var dt=!0,Pt={},wt={},Gt=[Xe].concat(Xe.__mro__);for(le=0;le<Gt.length;le++){var Dt=0==le?X:Gt[le];for(var Ae in Dt)if(!Pt[Ae]){var sn=Dt[Ae];"function"==typeof sn&&(!0===sn.__isabstractmethod__||sn.$attrs&&sn.$attrs.__isabstractmethod__?(dt=!1,wt[Ae]=!0):Pt[Ae]=!0)}}var gt=P.__slots__;for(void 0!==gt&&(gt="string"==typeof gt?[gt]:o.list.$factory(gt),Ge.__slots__=gt),le=0;le<Gt.length-1;le++)for(var Ae in Gt[le]){if("__setattr__"==Ae){Ge.$has_setattr=!0;break}if(Gt[le][Ae]&&(Gt[le][Ae].__get__||Gt[le][Ae].__class__&&Gt[le][Ae].__class__.__get__)){Ge.$has_setattr=!0;break}}var Mn=o.type.__getattribute__(ae,"__new__")(ae,M,de,Ge);for(var Ae in Mn.__module__=fe,Mn.$infos={__module__:fe,__name__:n.from_alias(M),__qualname__:P.$qualname},Mn.$subclasses=[],P)"$"==Ae.charAt(0)&&"$$"!=Ae.substr(0,2)||"function"==typeof P[Ae]&&(P[Ae].$infos.$class=Mn);for(Mn.__class__===ae&&o.type.__getattribute__(ae,"__init__")(Mn,M,de,Ge),le=0;le<de.length;le++)de[le].$subclasses=de[le].$subclasses||[],de[le].$subclasses.push(Mn);var Bn=o.$$super.$factory(Mn,Mn);return o.$$super.__getattribute__(Bn,"__init_subclass__")({$nat:"kw",kw:q}),dt||(Mn.$factory=function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods "+Object.keys(wt).join(", "))}),Mn.__qualname__=M.replace("$$",""),Mn};var l=n.make_class("type",function(M,P,de){return 1==arguments.length?void 0===M?n.UndefinedClass:M.__class__||n.get_class(M):l.__new__(l,M,P,de)});l.__call__=function(){for(var M=[],P=arguments[0],de=1,ye=arguments.length;de<ye;de++)M.push(arguments[de]);var he=o.type.__getattribute__(P,"__new__").apply(null,arguments);if(he.__class__===P){var ae=o.type.__getattribute__(P,"__init__");if(ae!==o.object.__init__){var fe=[he].concat(M);ae.apply(null,fe)}}return he},l.__class__=l,l.__format__=function(M,P){return o.str.$factory(M)},l.__getattribute__=function(M,P){switch(P){case"__annotations__":for(var de=0,ye=(le=[M].concat(M.__mro__)).length;de<ye;de++)if(le[de].__dict__){var he=le[de].__dict__.$string_dict.__annotations__[0];if(he)if(void 0===N)N=he;else if(N.__class__===o.dict&&he.__class__===o.dict)for(var ae in he.$string_dict)N.$string_dict[ae]=he.$string_dict[ae]}return void 0===N&&(N=n.empty_dict()),N;case"__bases__":return(N=M.__bases__||o.tuple.$factory()).__class__=o.tuple,0==N.length&&N.push(o.object),N;case"__class__":return M.__class__;case"__doc__":return M.__doc__||o.None;case"__setattr__":if(void 0!==M.__setattr__)var fe=M.__setattr__;else fe=function(Ce,Q,xe){Ce[Q]=xe};return L.$factory(P,M,fe);case"__delattr__":return void 0!==M.__delattr__?M.__delattr__:L.$factory(P,M,function(Ce){delete M[Ce]})}if(void 0===(N=M[P])&&M.__slots__&&M.__slots__.indexOf(P)>-1)return D.$factory(P,M);if(M.__class__&&M.__class__[P]&&M.__class__[P].__get__&&M.__class__[P].__set__)return M.__class__[P].__get__(M);if(void 0===N){var le;if(void 0===(q=M[P]))for(void 0===(le=M.__mro__)&&console.log("pas de mro pour",M),de=0;de<le.length;de++){var q;if(void 0!==(q=le[de][P])){N=q;break}}else N=q;if(void 0===N){var Y=M.__class__||n.get_class(M);if(void 0===(N=Y[P])){var A=Y.__mro__;for(de=0;de<A.length;de++){var N;if(void 0!==(N=A[de][P]))break}}if(void 0!==N){if(N.__class__===o.property)return N.fget(M);if("function"==typeof N){var X=N.bind(null,M);return X.__class__=n.method,X.$infos={__self__:M,__func__:N,__name__:P,__qualname__:M.$infos.__name__+"."+P,__module__:N.$infos?N.$infos.__module__:""},X}}if(void 0===N){var oe=Y.__getattr__;if(void 0===oe)for(de=0;de<A.length;de++)if(void 0!==A[de].__getattr__){oe=A[de].__getattr__;break}if(void 0!==oe)return oe(M,P)}}}if(void 0!==N){if(N.__class__===o.property)return N;if(N.__get__){if(N.__class__===z){var H=N.__get__(N.__func__,M);H.$infos={__func__:N,__name__:N.$infos.__name__,__qualname__:M.$infos.__name__+"."+N.$infos.__name__,__self__:M}}else H=N.__get__(M);return H}return!N.__class__||!N.__class__.__get__||P.startsWith("__")&&P.endsWith("__")?"function"==typeof N?(void 0===N.$infos&&n.debug>1&&console.log("warning: no attribute $infos for",N,"klass",M,"attr",P),"__new__"==P&&(N.$type="staticmethod"),"__class_getitem__"==P&&N.__class__!==n.method&&(N=o.classmethod.$factory(N)),"__init_subclass__"==P&&(N=o.classmethod.$factory(N)),N.__class__===n.method?N.__get__(null,M):N):N:N.__class__.__get__(N,o.None,M)}},l.__hash__=function(M){return o.hash(M)},l.__init__=function(){},l.__init_subclass__=function(){var M=n.args("__init_subclass__",1,{},[],arguments,{},"args","kwargs");if(void 0!==M.kwargs&&(M.kwargs.__class__!==o.dict||Object.keys(M.kwargs.$string_dict).length>0))throw o.TypeError.$factory("__init_subclass__() takes no keyword arguments");return o.None},l.__instancecheck__=function(M,P){var de=P.__class__||n.get_class(P);if(de===M)return!0;for(var ye=0;ye<de.__mro__.length;ye++)if(de.__mro__[ye]===M)return!0;return!1},l.__instancecheck__.$type="staticmethod",l.__name__={__get__:function(M){return M.$infos.__name__},__set__:function(M,P){M.$infos.__name__=P},__str__:function(M){return"type"},__eq__:function(M,P){return M.$infos.__name__==P}},l.__new__=function(M,P,de,ye){var he=ye.$string_dict.__module__;he&&(he=he[0]);var ae={__class__:M,__bases__:de,__dict__:ye,$infos:{__name__:P.replace("$$",""),__module__:he},$is_class:!0,$has_setattr:ye.$has_setattr};ae.__mro__=l.mro(ae).slice(1);for(var fe=n.dict_to_list(ye),le=0;le<fe.length;le++){var q=n.to_alias(fe[le][0]),Y=fe[le][1];if("__module__"!==q&&void 0!==Y){if(ae[q]=Y,Y.__class__){var A=n.$getattr(Y.__class__,"__set_name__",o.None);A!==o.None&&A(Y,ae,q)}"function"==typeof Y&&(void 0===Y.$infos&&(console.log("type new",Y,Y+""),console.log(n.frames_stack.slice())),Y.$infos.$class=ae,Y.$infos.__qualname__=P+"."+Y.$infos.__name__,Y.$infos.$defaults)&&n.Function.__setattr__(Y,"__defaults__",Y.$infos.$defaults)}}return ae},l.__repr__=l.__str__=function(M){void 0===M.$infos&&console.log("no $infos",M);var P=M.$infos.__qualname__;return M.$infos.__module__&&"builtins"!=M.$infos.__module__&&!M.$infos.__module__.startsWith("$")&&(P=M.$infos.__module__+"."+P),"<class '"+P+"'>"},l.__prepare__=function(){return n.empty_dict()},l.__qualname__={__get__:function(M){return M.$infos.__qualname__||M.$infos.__name__},__set__:function(M,P){M.$infos.__qualname__=P},__str__:function(M){console.log("type.__qualname__")},__eq__:function(M,P){return M.$infos.__qualname__==P}},l.mro=function(M){for(var P=M.__bases__,de=[],ye=0,he=0;he<P.length;he++){P[he]===o.str&&(P[he]=n.StringSubclass);var ae=[],fe=0;if(void 0===P[he]||void 0===P[he].__mro__){if(void 0===P[he].__class__)return[o.object];throw o.TypeError.$factory("Object passed as base class is not a class")}ae[fe++]=P[he];var le=P[he].__mro__;le[0]===P[he]&&le.splice(0,1);for(var q=0;q<le.length;q++)ae[fe++]=le[q];de[ye++]=ae}-1==P.indexOf(o.object)&&(P=P.concat(o.tuple.$factory([o.object]))),de[ye++]=P.slice();for(var Y=[M],A=1;;){var N=[];for(fe=0,he=0;he<de.length;he++)de[he].length>0&&(N[fe++]=de[he]);if(0==N.length)break;for(he=0;he<N.length;he++){for(var X=N[he][0],oe=[],H=(fe=0,0);H<N.length;H++){var Ce=N[H];Ce.slice(1).indexOf(X)>-1&&(oe[fe++]=Ce)}if(!(oe.length>0))break;X=null}if(null===X)throw o.TypeError.$factory("inconsistent hierarchy, no C3 MRO is possible");for(Y[A++]=X,he=0;he<de.length;he++)de[he][0]===X&&de[he].shift()}return Y[Y.length-1]!==o.object&&(Y[A++]=o.object),Y},l.__subclasscheck__=function(M,P){var de=M;return de===o.str?de=n.StringSubclass:de===o.float&&(de=n.FloatSubclass),void 0===P.__bases__?M===o.object:P.__bases__.indexOf(de)>-1},n.set_func_names(l,"builtins"),o.type=l;var x=n.make_class("wrapper_descriptor");n.set_func_names(x,"builtins"),l.__call__.__class__=x,n.$instance_creator=function(M){if(void 0!==M.$instanciable)return function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods")};var P,de=M.__class__;if(de!==o.type||M.__bases__&&0!=M.__bases__.length){P=o.type.__getattribute__(de,"__call__");var ye=function(){return P.bind(null,M).apply(null,arguments)}}else ye=M.hasOwnProperty("__new__")?M.hasOwnProperty("__init__")?function(){var he=M.__new__.bind(null,M).apply(null,arguments);return M.__init__.bind(null,he).apply(null,arguments),he}:function(){return M.__new__.bind(null,M).apply(null,arguments)}:M.hasOwnProperty("__init__")?function(){var he={__class__:M,__dict__:n.empty_dict()};return M.__init__.bind(null,he).apply(null,arguments),he}:function(){if(arguments.length>0&&(1!=arguments.length||!arguments[0].$nat||0!=Object.keys(arguments[0].kw).length))throw o.TypeError.$factory("object() takes no parameters");return{__class__:M,__dict__:n.empty_dict()}};return ye.__class__=n.Function,ye.$infos={__name__:M.$infos.__name__,__module__:M.$infos.__module__},ye};var L=n.method_wrapper=n.make_class("method_wrapper",function(M,P,de){var ye=function(){return de.apply(null,arguments)};return ye.$infos={__name__:M,__module__:P.__module__},ye});L.__str__=L.__repr__=function(M){return"<method '"+M.$infos.__name__+"' of function object>"};var D=n.make_class("member_descriptor",function(M,P){return{__class__:D,cls:P,attr:M}});D.__str__=D.__repr__=function(M){return"<member '"+M.attr+"' of '"+M.cls.$infos.__name__+"' objects>"},n.set_func_names(D,"builtins");var z=n.method=n.make_class("method",function(M,P){var de=function(){return n.$call(M).bind(null,P).apply(null,arguments)};return de.__class__=z,de.$infos=M.$infos,de});z.__eq__=function(M,P){return void 0!==M.$infos&&void 0!==P.$infos&&M.$infos.__func__===P.$infos.__func__&&M.$infos.__self__===P.$infos.__self__},z.__ne__=function(M,P){return!n.method.__eq__(M,P)},z.__get__=function(M){var P=function(){return M(arguments)};return P.__class__=n.method_wrapper,P.$infos=z.$infos,P},z.__getattribute__=function(M,P){var de=M.$infos;if(de&&de[P]){if("__code__"==P){var ye={__class__:n.Code};for(var P in de.__code__)ye[P]=de.__code__[P];return ye}return de[P]}return z.hasOwnProperty(P)?o.object.__getattribute__(M,P):n.Function.__getattribute__(M.$infos.__func__,P)},z.__repr__=z.__str__=function(M){return"<bound method "+M.$infos.__qualname__+" of "+o.str.$factory(M.$infos.__self__)+">"},z.__setattr__=function(M,P,de){throw"__class__"==P?o.TypeError.$factory("__class__ assignment only supported for heap types or ModuleType subclasses"):o.AttributeError.$factory("'method' object has no attribute '"+P+"'")},n.set_func_names(z,"builtins"),n.method_descriptor=n.make_class("method_descriptor"),n.classmethod_descriptor=n.make_class("classmethod_descriptor"),n.GenericAlias=n.make_class("GenericAlias",function(M,P){return{__class__:n.GenericAlias,origin_class:M,items:P}}),n.GenericAlias.__args__={__get__:function(M){return n.fast_tuple(M.items)}},n.GenericAlias.__call__=function(M,...P){return M.origin_class.$factory.apply(null,P)},n.GenericAlias.__eq__=function(M,P){return n.rich_comp("__eq__",M.origin_class,P.origin_class)&&n.rich_comp("__eq__",M.items,P.items)},n.GenericAlias.__getitem__=function(M,P){throw o.TypeError.$factory("descriptor '__getitem__' for '"+M.origin_class.$infos.__name__+"' objects doesn't apply to a '"+n.class_name(P)+"' object")},n.GenericAlias.__origin__={__get__:function(M){return M.origin_class}},n.GenericAlias.__parameters__={__get__:function(M){return n.fast_tuple([])}},n.GenericAlias.__repr__=function(M){for(var P=M.items,de=0,ye=P.length;de<ye;de++)P[de]=P[de]===o.Ellipsis?"...":P[de].$infos.__name__;return M.origin_class.$infos.__qualname__+"["+P.join(", ")+"]"},o.object.__class__=l}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator;function index_error(n){throw _b_.IndexError.$factory(("string"==typeof n?"string":"list")+" index out of range")}$B.args=function(n,o,l,x,L,D,z,M){n.startsWith("lambda_"+$B.lambda_magic)&&(n="<lambda>");var P,de,ye=!1,he=L.length,ae=0,fe=x.indexOf("/");if(-1!=fe&&(x.splice(fe,1),de=x.slice(0,fe)),he>0&&L[he-1].$nat&&(he--,Object.keys(L[he].kw).length>0)){ye=!0;var le=L[he].kw;if(Array.isArray(le)){for(var q=le[0],Y=1,A=le.length;Y<A;Y++){var N=le[Y];if(N.__class__===_b_.dict){for(var X in N.$numeric_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in N.$object_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in N.$string_dict){if(void 0!==q[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");q[X]=N.$string_dict[X][0]}}else for(var oe=_b_.iter(N),H=$B.$getattr(N,"__getitem__");;)try{if("string"!=typeof(X=_b_.next(oe)))throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==q[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");q[X]=H(X)}catch(Xe){if($B.is_exc(Xe,[_b_.StopIteration]))break;throw Xe}}le=q}}if(z&&(l[z]=[],l[z].__class__=_b_.tuple),M&&(P=$B.empty_dict()),he>o){if(null===z||"*"==z)throw _b_.TypeError.$factory(Ae=n+"() takes "+o+" positional argument"+(o>1?"s":"")+" but more were given");for(Y=o;Y<he;Y++)l[z].push(L[Y]);he=o}for(Y=0;Y<he;Y++)l[x[Y]]=L[Y],ae++;if(ae==o&&o===x.length&&!ye)return M&&(l[M]=P),l;if(ye)for(var Ce in le){var Q=le[Ce],xe=$B.to_alias(Ce);if(void 0===l[xe]){if(!M)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Ce+"'");"$$"==Ce.substr(0,2)&&(Ce=Ce.substr(2)),P.$string_dict[Ce]=[Q,P.$order++]}else{if(null!==l[xe])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+Ce+"'");if(de&&de.indexOf(xe)>-1)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Ce+"'");l[xe]=Q}}var Pe=[];for(var Ge in l)null===l[Ge]&&(void 0!==D[Ge]?l[Ge]=D[Ge]:Pe.push("'"+Ge+"'"));if(Pe.length>0){if(1==Pe.length)throw _b_.TypeError.$factory(n+" missing 1 positional argument: "+Pe[0]);var Ae=n+" missing "+Pe.length+" positional arguments: ";throw Ae+=Pe.join(" and "),_b_.TypeError.$factory(Ae)}return M&&(l[M]=P),l},$B.wrong_nb_args=function(n,o,l,x){if(o<l){var L=l-o;throw _b_.TypeError.$factory(n+"() missing "+L+" positional argument"+(L>1?"s":"")+": "+x.slice(o))}throw _b_.TypeError.$factory(n+"() takes "+l+" positional argument"+(l>1?"s":"")+" but more were given")},$B.get_class=function(n){if(null===n)return $B.$NoneDict;if(void 0===n)return $B.UndefinedClass;var o=n.__class__;if(void 0===o)switch(typeof n){case"number":return n%1==0?_b_.int:_b_.float;case"string":return _b_.str;case"boolean":return _b_.bool;case"function":return n.$is_js_func?$B.JSObj:(n.__class__=$B.Function,$B.Function);case"object":if(Array.isArray(n)){if(Object.getPrototypeOf(n)===Array.prototype)return n.__class__=_b_.list,_b_.list}else{if(n.constructor===Number)return _b_.float;if(typeof Node<"u"&&n instanceof Node)return $B.DOMNode}}return void 0===o?$B.JSObj:o},$B.class_name=function(n){var o=$B.get_class(n);return o===$B.JSObj?"Javascript "+n.constructor.name:o.$infos.__name__},$B.$list_comp=function(n){for(var o=$B.UUID(),l="x"+o+" = []\n",x=0,L=1,D=n.length;L<D;L++){var z=n[L].replace(/\s+$/,"").replace(/\n/g,"");l+=" ".repeat(x)+z+":\n",x+=4}return l+=" ".repeat(x),[l+="x"+o+".append("+n[0]+")\n",o]},$B.$dict_comp=function(n,o,l,x){for(var L=$B.UUID(),D="comp_result_"+$B.lambda_magic+L,z=D+" = {}\n",M=0,P=1,de=l.length;P<de;P++){var ye=l[P].replace(/\s+$/,"").replace(/\n/g,"");z+="    ".repeat(M)+ye+":\n",M++}z+="    ".repeat(M)+D+".update({"+l[0]+"})";var ae="dc"+L,fe=$B.py2js({src:z,is_comp:!0,line_info:x+","+n},n,ae,o,x),le=fe.outermost_expr.to_js(),q=fe.to_js();return q="(function(expr){"+(q+="\nreturn "+D+"\n")+"})("+le+")",$B.clear_ns(ae),delete $B.$py_src[ae],q},$B.$gen_expr=function(n,o,l,x,L){for(var D=$B.UUID(),z=(L?"set_comp"+$B.lambda_magic:"__ge")+D,M=`def ${z}(expr):\n`,P=1,de=1,ye=l.length;de<ye;de++){var he=l[de].replace(/\s+$/,"").replace(/\n/g,"");M+=" ".repeat(P)+he+":\n",P+=4}M+=" ".repeat(P);var fe=$B.py2js({src:M+="yield ("+l[0]+")",is_comp:!0,line_info:x+","+n,ix:D},z,z,o,x),le=fe.to_js(),q=le.split("\n");void 0===fe.outermost_expr&&console.log("no outermost",n,o);var Y=fe.outermost_expr.to_js();return le=q.join("\n"),"(function($locals_"+z+"){"+(le+="\nvar $res = $B.generator.$factory("+z+")("+Y+");\nreturn $res\n")+"})($locals)\n"},$B.copy_namespace=function(){var n={};for(const l of $B.frames_stack)for(const x of[l[1],l[3]])for(var o in x)!o.startsWith("$$")&&o.startsWith("$")||(n[o]=x[o]);return n},$B.clear_ns=function(n){n.startsWith("__ge")&&console.log("clear ns",n);var o=n.length;for(var l in $B.$py_module_path)l.substr(0,o)==n&&($B.$py_module_path[l]=null,delete $B.$py_module_path[l]);$B.$py_src[n]=null,delete $B.$py_src[n];var x=n.replace(/\./g,"_");x!=n&&$B.clear_ns(x)},$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.$search=function(n,o){var l=$B.last($B.frames_stack);if(void 0!==l[1][n])return l[1][n];if(void 0!==l[3][n])return l[3][n];if(void 0!==_b_[n])return _b_[n];throw l[0]==l[2]||"class"==l[1].$type||l[1].$exec_locals?_b_.NameError.$factory("name '"+n+"' is not defined"):_b_.UnboundLocalError.$factory("local variable '"+n+"' referenced before assignment")},$B.$global_search=function(n,o){for(var l=0;l<$B.frames_stack.length;l++){var x=$B.frames_stack[l];if(o.indexOf(x[0])>-1&&void 0!==x[1][n])return x[1][n];if(o.indexOf(x[2])>-1&&void 0!==x[3][n])return x[3][n]}for(l=0;l<o.length;l++){var L=o[l];if($B.imported[L]&&$B.imported[L][n])return $B.imported[L][n]}throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$local_search=function(n){var o=$B.last($B.frames_stack);if(void 0!==o[1][n])return o[1][n];throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def=function(n,o){if(void 0!==o)return o;if(void 0!==_b_[n])return _b_[n];var l=$B.last($B.frames_stack);if(void 0!==l[3][n])return l[3][n];throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$check_def_local=function(n,o){if(void 0!==o)return o;throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def_free=function(n,o){if(void 0!==o)return o;for(var l,x=$B.frames_stack.length-1;x>=0;x--)if(void 0!==(l=$B.frames_stack[x][1][n])||void 0!==(l=$B.frames_stack[x][3][n]))return l;throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$check_def_free1=function(n,o){for(var l,x=$B.frames_stack.length-1;x>=0;x--){var L=$B.frames_stack[x];if(void 0!==(l=L[1][n])||L[1].$parent&&void 0!==(l=L[1].$parent[n])||L[2]==o&&void 0!==(l=L[3][n]))return l}throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$JS2Py=function(n){return"number"==typeof n?n%1==0?n:_b_.float.$factory(n):null==n?_b_.None:(Array.isArray(n)&&Object.getPrototypeOf(n)===Array.prototype&&(n.$brython_class="js"),n)},$B.list_key=function(n,o){(o=$B.$GetInt(o))<0&&(o+=n.length);var l=n[o];if(void 0===l)throw _b_.IndexError.$factory("list index out of range");return l},$B.list_slice=function(n,o,l){return null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l?n.slice(o):((l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length)),n.slice(o,l))},$B.list_slice_step=function(n,o,l,x){if(null===x||1==x)return $B.list_slice(n,o,l);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),null===o?o=x>=0?0:n.length-1:(o=$B.$GetInt(o))<0&&(o=Math.min(0,o+n.length)),null===l?l=x>=0?n.length:-1:(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var L=[];if(x>0)for(var D=o;D<l;D+=x)L.push(n[D]);else for(D=o;D>l;D+=x)L.push(n[D]);return L},$B.$getitem=function(n,o){var l=Array.isArray(n)&&n.__class__===_b_.list;if("number"==typeof o&&(l||"string"==typeof n)){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}try{o=$B.$GetInt(o)}catch{}if((l||"string"==typeof n)&&"number"==typeof o){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}if(n.$is_class){var x=$B.$getattr(n,"__class_getitem__",_b_.None);if(x!==_b_.None)return x(o);if(n.__class__&&(x=$B.$getattr(n.__class__,"__getitem__",_b_.None))!==_b_.None)return x(n,o)}if(l)return _b_.list.$getitem(n,o);var L=$B.$getattr(n,"__getitem__",_b_.None);if(L!==_b_.None)return L(o);throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not subscriptable")},$B.getitem_slice=function(n,o){var l;return Array.isArray(n)?(o.start===_b_.None&&o.stop===_b_.None?o.step===_b_.None||1==o.step?l=n.slice():-1==o.step&&(l=n.slice().reverse()):o.step===_b_.None&&(o.start===_b_.None&&(o.start=0),o.stop===_b_.None&&(o.stop=n.length),"number"==typeof o.start&&"number"==typeof o.stop&&(o.start<0&&(o.start+=n.length),o.stop<0&&(o.stop+=n.length),l=n.slice(o.start,o.stop))),l?(l.__class__=n.__class__,l):_b_.list.$getitem(n,o)):$B.$getattr(n,"__getitem__")(o)},$B.set_list_key=function(n,o,l){try{o=$B.$GetInt(o)}catch{if(_b_.isinstance(o,_b_.slice)){var x=_b_.slice.$conv_for_seq(o,n.length);return $B.set_list_slice_step(n,x.start,x.stop,x.step,l)}}if(o<0&&(o+=n.length),void 0===n[o])throw console.log(n,o),_b_.IndexError.$factory("list assignment index out of range");n[o]=l},$B.set_list_slice=function(n,o,l,x){null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l&&(l=n.length),(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var L=_b_.list.$factory(x);n.splice.apply(n,[o,l-o].concat(L))},$B.set_list_slice_step=function(n,o,l,x,L){if(null===x||1==x)return $B.set_list_slice(n,o,l,L);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),o=null===o?x>0?0:n.length-1:$B.$GetInt(o),l=null===l?x>0?n.length:-1:$B.$GetInt(l);var D,z=_b_.list.$factory(L),M=0,P=0;D=x>0?function(ye){return ye<l}:function(ye){return ye>l};for(var de=o;D(de);de+=x)P++;if(P!=z.length)throw _b_.ValueError.$factory("attempt to assign sequence of size "+z.length+" to extended slice of size "+P);for(de=o;D(de);de+=x)n[de]=z[M],M++},$B.$setitem=function(n,o,l){if(!Array.isArray(n)||void 0!==n.__class__||"number"!=typeof o||_b_.isinstance(n,_b_.tuple)){if(n.__class__!==_b_.dict)return n.__class__===_b_.list?_b_.list.$setitem(n,o,l):void $B.$getattr(n,"__setitem__")(o,l);_b_.dict.$setitem(n,o,l)}else{if(o<0&&(o+=n.length),void 0===n[o])throw _b_.IndexError.$factory("list assignment index out of range");n[o]=l}},$B.augm_item_add=function(n,o,l){if(Array.isArray(n)&&"number"==typeof o&&void 0!==n[o]){if(Array.isArray(n[o])&&Array.isArray(l)){for(var x=0,L=l.length;x<L;x++)n[o].push(l[x]);return}if("string"==typeof n[o]&&"string"==typeof l)return void(n[o]+=l)}var D=$B.$getattr;try{var z=D(D(n,"__getitem__")(o),"__iadd__")}catch{return void D(n,"__setitem__")(o,D(D(n,"__getitem__")(o),"__add__")(l))}z(l)};for(var augm_item_src=""+$B.augm_item_add,augm_ops=[["-=","sub"],["*=","mul"]],i=0,len=augm_ops.length;i<len;i++){var augm_code=augm_item_src.replace(/add/g,augm_ops[i][1]);augm_code=augm_code.replace(/\+=/g,augm_ops[i][0]),eval("$B.augm_item_"+augm_ops[i][1]+"="+augm_code)}$B.extend=function(n,o){for(var l=2;l<arguments.length;l++)for(var x=arguments[l],L=_b_.iter(x),D=$B.$getattr(x,"__getitem__");;)try{var z=_b_.next(L);if("string"!=typeof z)throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==o[z])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+z+"'");o[z]=D(z)}catch(M){if(_b_.isinstance(M,[_b_.StopIteration]))break;throw M}return o},$B.extend_list=function(){for(var n=Array.prototype.slice.call(arguments,0,arguments.length-1),o=$B.last(arguments),l=_b_.iter(o);;)try{n.push(_b_.next(l))}catch(x){if(_b_.isinstance(x,[_b_.StopIteration]))break;throw x}return n},$B.$test_item=function(n){return $B.$test_result=n,_b_.bool.$factory(n)},$B.$test_expr=function(){return $B.$test_result},$B.$is=function(n,o){return n instanceof Number&&o instanceof Number?n.valueOf()==o.valueOf():n===_b_.int&&o==$B.long_int||n===$B.long_int&&o===_b_.int||n===o},$B.$is_member=function(n,o){var l,x,L;try{L=$B.$getattr(o.__class__||$B.get_class(o),"__contains__")}catch{}if(L)return $B.$call(L)(o,n);try{x=_b_.iter(o)}catch{}if(x)for(;;)try{var D=_b_.next(x);if($B.rich_comp("__eq__",D,n))return!0}catch{return!1}try{l=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(o)+"' object is not iterable")}if(l)for(var z=-1;;){z++;try{if(D=l(z),$B.rich_comp("__eq__",D,n))return!0}catch(M){if(M.__class__===_b_.IndexError)return!1;throw M}}},$B.$call=function(n){if(n.__class__===$B.method||n.$is_func||"function"==typeof n)return n;if(n.$factory)return n.$factory;if(n.$is_class)return n.$factory=$B.$instance_creator(n);try{return $B.$getattr(n,"__call__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not callable")}};var $io=$B.make_class("io",function(n){return{__class__:$io,out:n}});function $err(n,o,l){var x="unsupported operand type(s) for "+n+" : '"+o.$infos.__name__+"' and '"+$B.class_name(l)+"'";throw _b_.TypeError.$factory(x)}$io.flush=function(){},$io.write=function(n,o){return console[n.out](o),_b_.None},$B.stderr=void 0!==console.error?$io.$factory("error"):$io.$factory("log"),$B.stdout=$io.$factory("log"),$B.stdin={__class__:$io,__original__:!0,closed:!1,len:1,pos:0,read:function(){return""},readline:function(){return""}},$B.make_iterator_class=function(n){var o={__class__:_b_.type,__mro__:[_b_.object],$factory:function(l){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:l,len:l.length}},$infos:{__name__:n},$is_class:!0,__iter__:function(l){return l.counter=void 0===l.counter?-1:l.counter,l.len=l.items.length,l},__len__:function(l){return l.items.length},__next__:function(l){if("function"==typeof l.len_func&&l.len_func()!=l.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(l.counter++,l.counter<l.items.length){var x=l.items[l.counter];return"js"==l.items.$brython_class&&(x=$B.$JS2Py(x)),x}throw _b_.StopIteration.$factory("StopIteration")},__reduce_ex__:function(l,x){return $B.fast_tuple([_b_.iter,_b_.tuple.$factory([l.items])])}};return $B.set_func_names(o,"builtins"),o};var ropnames=["add","sub","mul","truediv","floordiv","mod","pow","lshift","rshift","and","xor","or"],ropsigns=["+","-","*","/","//","%","**","<<",">>","&","^","|"];function exit_ctx_managers_in_generators(n){for(key in n[1])n[1][key]&&n[1][key].__class__==$B.generator&&n[1][key].return()}$B.make_rmethods=function(n){for(var o=0,l=ropnames.length;o<l;o++)void 0===n["__"+ropnames[o]+"__"]&&(n["__"+ropnames[o]+"__"]=function(x,L){return function(D,z){try{return $B.$getattr(z,"__r"+x+"__")(D)}catch{$err(L,n,z)}}}(ropnames[o],ropsigns[o]))},$B.UUID=function(){return $B.$py_UUID++},$B.InjectBuiltins=function(){var n=["var _b_ = $B.builtins"],o=1;for(var l in $B.builtins)n[o++]="var "+l+'=_b_["'+l+'"]';return n.join(";")},$B.$GetInt=function(n){if("number"==typeof n||n.constructor===Number)return n;if("boolean"==typeof n)return n?1:0;if(_b_.isinstance(n,_b_.int))return n;if(_b_.isinstance(n,_b_.float))return n.valueOf();if(!n.$is_class){try{return $B.$getattr(n,"__int__")()}catch{}try{return $B.$getattr(n,"__index__")()}catch{}}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")},$B.to_num=function(n,o){for(var l={__complex__:_b_.complex,__float__:_b_.float,__index__:_b_.int,__int__:_b_.int},x=n.__class__||$B.get_class(n),L=0;L<o.length;L++){var D={},z=$B.$getattr(x,o[L],D);if(z!==D){var M=z(n);if(!_b_.isinstance(M,l[o[L]]))throw console.log(M,o[L],l[o[L]]),_b_.TypeError.$factory(o[L]+"returned non-"+l[o[L]].$infos.__name__+"(type "+$B.get_class(M)+")");return M}}return null},$B.PyNumber_Index=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;if(_b_.isinstance(n,_b_.int))return n.$brython_value;var o=$B.$getattr(n,"__index__",_b_.None);if(o!==_b_.None)return o="function"==typeof o?o:$B.$getattr(o,"__call__"),$B.int_or_bool(o());default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.int_or_bool=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer");default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.enter_frame=function(n){if($B.frames_stack.push(n),$B.tracefunc&&$B.tracefunc!==_b_.None){if(n[4]===$B.tracefunc||$B.tracefunc.$infos&&n[4]&&n[4]===$B.tracefunc.$infos.__func__)return $B.tracefunc.$frame_id=n[0],_b_.None;for(var o=$B.frames_stack.length-1;o>=0;o--)if($B.frames_stack[o][0]==$B.tracefunc.$frame_id)return _b_.None;return $B.tracefunc($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"call",_b_.None)}return _b_.None},$B.trace_exception=function(){var n=$B.last($B.frames_stack);if(n[0]==$B.tracefunc.$current_frame_id)return _b_.None;var l=n[1].$current_exception;return(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"exception",$B.fast_tuple([l.__class__,l,$B.traceback.$factory(l)]))},$B.trace_line=function(){var n=$B.last($B.frames_stack);return n[0]==$B.tracefunc.$current_frame_id?_b_.None:(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"line",_b_.None)},$B.set_line=function(n){var o=$B.last($B.frames_stack);if($B.tracefunc&&o[0]==$B.tracefunc.$current_frame_id)return _b_.None;o[1].$line_info=n;var l=o[1].$f_trace;if(l!==_b_.None){var x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);o[1].$ftrace=l(x,"line",_b_.None)}return!0},$B.trace_return=function(n){var o=$B.last($B.frames_stack),l=o[1].$f_trace,x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);if(o[0]==$B.tracefunc.$current_frame_id)return _b_.None;l(x,"return",n)},$B.set_cm_in_generator=function(n){void 0!==n&&$B.frames_stack.forEach(function(o){o[1].$cm_in_gen=o[1].$cm_in_gen||new Set,o[1].$cm_in_gen.add(n)})},$B.leave_frame=function(n){if(0!=$B.frames_stack.length){n&&void 0!==n.value&&$B.tracefunc&&(void 0===$B.last($B.frames_stack)[1].$f_trace&&($B.last($B.frames_stack)[1].$f_trace=$B.tracefunc),$B.last($B.frames_stack)[1].$f_trace!==_b_.None&&$B.trace_return(n.value));var o=$B.frames_stack.pop();if(o[1].$current_exception=void 0,o[1].$close_generators)for(var l=0,x=o[1].$close_generators.length;l<x;l++){var L=o[1].$close_generators[l];L.$has_run&&L.return()}return _b_.None}console.log("empty stack")},$B.leave_frame_exec=function(n){if($B.profile>0&&$B.$profile.return(),0!=$B.frames_stack.length){var o=$B.frames_stack.pop();exit_ctx_managers_in_generators(o);for(var l=$B.frames_stack.length-1;l>=0;l--)$B.frames_stack[l][2]==o[2]&&($B.frames_stack[l][3]=o[3])}else console.log("empty stack")};var min_int=Math.pow(-2,53),max_int=Math.pow(2,53)-1;$B.is_safe_int=function(){for(var n=0;n<arguments.length;n++){var o=arguments[n];if(o<min_int||o>max_int)return!1}return!0},$B.add=function(n,o){if("number"==typeof n.valueOf()&&"number"==typeof o.valueOf()){if("number"==typeof n&&"number"==typeof o){var l=n+o;return l<$B.max_int&&l>$B.min_int?l:l===1/0?_b_.float.$factory("inf"):l===-1/0?_b_.float.$factory("-inf"):isNaN(l)?_b_.float.$factory("nan"):$B.long_int.__add__($B.long_int.$factory(n),$B.long_int.$factory(o))}return new Number(n+o)}if("string"==typeof n&&"string"==typeof o)return n+o;try{var x=$B.$getattr(n.__class__||$B.get_class(n),"__add__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("unsupported operand type(s) for +: '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'"):D}var L=$B.$call(x)(n,o);return L===_b_.NotImplemented?$B.rich_op("add",n,o):L},$B.div=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?l:$B.long_int.__truediv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.eq=function(n,o){return n>min_int&&n<max_int&&o>min_int&&o<max_int?n==o:$B.long_int.__eq__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.floordiv=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?Math.floor(l):$B.long_int.__floordiv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.mul=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n*o):n*o;if(n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int)return l;if("number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o))return _b_.float.$factory("nan");switch(n){case 1/0:case-1/0:return 0==o?_b_.float.$factory("nan"):o>0?n:-n}return $B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.sub=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n-o):n-o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int?l:"number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o)?_b_.float.$factory("nan"):$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.ge=function(n,o){return"number"==typeof n&&"number"==typeof o?n>=o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__ge__(n,o)},$B.gt=function(n,o){return"number"==typeof n&&"number"==typeof o?n>o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__gt__(n,o)};var reversed_op={__lt__:"__gt__",__le__:"__ge__",__gt__:"__lt__",__ge__:"__le__"},method2comp={__lt__:"<",__le__:"<=",__gt__:">",__ge__:">="};$B.rich_comp=function(n,o,l){var x,L,D=o.valueOf(),z=l.valueOf();if("number"==typeof D&&"number"==typeof z&&void 0===o.__class__&&void 0===l.__class__)switch(n){case"__eq__":return D==z;case"__ne__":return D!=z;case"__le__":return D<=z;case"__lt__":return D<z;case"__ge__":return D>=z;case"__gt__":return D>z}if(o.$is_class||o.$factory){if("__eq__"==n)return o===l;if("__ne__"==n)return o!==l;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if(o.__class__&&l.__class__&&l.__class__.__mro__.indexOf(o.__class__)>-1&&($B.$getattr(l,L=reversed_op[n]||n),(x=$B.$call($B.$getattr(l,L))(o))!==_b_.NotImplemented)||(x=$B.$call($B.$getattr(o,n))(l))!==_b_.NotImplemented||(x=$B.$call($B.$getattr(l,L=reversed_op[n]||n))(o))!==_b_.NotImplemented)return x;if("__eq__"==n)return _b_.False;if("__ne__"==n)return _b_.True;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")};var opname2opsign={sub:"-",xor:"^",mul:"*"};$B.rich_op=function(n,o,l){var x,L,D=o.__class__||$B.get_class(o);if(D===(l.__class__||$B.get_class(l))){if(D===_b_.int)return _b_.int["__"+n+"__"](o,l);try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__===_b_.AttributeError){var z=$B.class_name(o);throw _b_.TypeError.$factory("unsupported operand type(s) for "+opname2opsign[n]+" : '"+z+"' and '"+z+"'")}throw M}return x(l)}try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__!==_b_.AttributeError)throw M;if((L=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return L;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if((L=x(l))===_b_.NotImplemented){if((L=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return L;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}return L},$B.is_none=function(n){return null==n||n==_b_.None};var repr_stack=new Set;$B.repr={enter:function(n){if(repr_stack.has(n))return!0;repr_stack.add(n)},leave:function(n){repr_stack.delete(n)}}}(__BRYTHON__),function($B){var _b_=$B.builtins;_b_.__debug__=!1,$B.$comps={">":"gt",">=":"ge","<":"lt","<=":"le"},$B.$inv_comps={">":"lt",">=":"le","<":"gt","<=":"ge"};var check_nb_args=$B.check_nb_args=function(n,o,l){var x=l.length,L=l[x-1];if(L&&"kw"==L.$nat){var D=L.kw;Array.isArray(D)&&D[1]&&D[1].__class__===_b_.dict&&0==Object.keys(D[1].$string_dict).length&&x--}if(x!=o)throw _b_.TypeError.$factory(0==o?n+"() takes no argument ("+x+" given)":n+"() takes exactly "+o+" argument"+(o<2?"":"s")+" ("+x+" given)")},check_no_kw=$B.check_no_kw=function(n,o,l){if(void 0===o&&console.log("x undef",n,o,l),o.$nat&&o.kw&&o.kw[0]&&o.kw[0].length>0||void 0!==l&&l.$nat)throw _b_.TypeError.$factory(n+"() takes no keyword arguments")},NoneType={$factory:function(){return None},$infos:{__name__:"NoneType",__module__:"builtins"},__bool__:function(n){return False},__class__:_b_.type,__hash__:function(n){return 0},__mro__:[_b_.object],__repr__:function(n){return"None"},__str__:function(n){return"None"},$is_class:!0,__setattr__:function(n,o){return no_set_attr(NoneType,o)}},None={__class__:NoneType};for(var $op in $B.$comps){var key=$B.$comps[$op];switch(key){case"ge":case"gt":case"le":case"lt":NoneType["__"+key+"__"]=function(n){return _b_.NotImplemented}}}for(var $func in None)"function"==typeof None[$func]&&(None[$func].__str__=function(n){return function(){return"<method-wrapper "+n+" of NoneType object>"}}($func));function abs(n){if(check_nb_args("abs",1,arguments),check_no_kw("abs",n),isinstance(n,_b_.int))return n.__class__===$B.long_int?{__class__:$B.long_int,value:n.value,pos:!0}:_b_.int.$factory(Math.abs(n));if(isinstance(n,_b_.float))return _b_.float.$factory(Math.abs(_b_.float.numerator(n)));var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__abs__")}catch(x){throw x.__class__===_b_.AttributeError?_b_.TypeError.$factory("Bad operand type for abs(): '"+$B.class_name(n)+"'"):x}return $B.$call(l)(n)}function all(n){check_nb_args("all",1,arguments),check_no_kw("all",n);for(var o=iter(n);;)try{var l=next(o);if(!$B.$bool(l))return!1}catch{return!0}}function any(n){check_nb_args("any",1,arguments),check_no_kw("any",n);for(var o=iter(n);;)try{var l=next(o);if($B.$bool(l))return!0}catch{return!1}}function ascii(n){check_nb_args("ascii",1,arguments),check_no_kw("ascii",n);for(var o,l=repr(n),x="",L=0;L<l.length;L++)if((o=l.charCodeAt(L))<128)x+=l.charAt(L);else if(o<256)x+="\\x"+o.toString(16);else{var D=o.toString(16);D.length%2==1&&(D="0"+D),x+="\\u"+D}return x}function $builtin_base_convert_helper(n,o){var l="";switch(o){case 2:l="0b";break;case 8:l="0o";break;case 16:l="0x";break;default:console.log("invalid base:"+o)}if(n.__class__===$B.long_int){var x=l+$B.long_int.to_base(n,o);return n.pos||(x="-"+x),x}var L=$B.$GetInt(n);if(void 0===L)throw _b_.TypeError.$factory("Error, argument must be an integer or contains an __index__ function");return L>=0?l+L.toString(o):"-"+l+(-L).toString(o)}function bin_hex_oct(n,o){if(isinstance(o,_b_.int))return $builtin_base_convert_helper(o,n);try{var l=o.__class__||$B.get_class(o),x=$B.$getattr(l,"__index__")}catch(L){throw L.__class__===_b_.AttributeError?_b_.TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer"):L}return $builtin_base_convert_helper($B.$call(x)(o),n)}function bin(n){return check_nb_args("bin",1,arguments),check_no_kw("bin",n),bin_hex_oct(2,n)}function breakpoint(){$B.$import("sys",[]);var n={},o=$B.$getattr($B.imported.sys,"breakpointhook",n);if(o===n)throw _b_.RuntimeError.$factory("lost sys.breakpointhook");return $B.$call(o).apply(null,arguments)}function callable(n){return check_nb_args("callable",1,arguments),check_no_kw("callable",n),hasattr(n,"__call__")}function chr(n){if(check_nb_args("chr",1,arguments),check_no_kw("chr",n),n<0||n>1114111)throw _b_.ValueError.$factory("Outside valid range");return String.fromCodePoint(n)}$B.set_func_names(NoneType,"builtins");var classmethod=$B.make_class("classmethod",function(n){check_nb_args("classmethod",1,arguments),check_no_kw("classmethod",n);var o=function(){return n.apply(null,arguments)};if(o.__class__=$B.method,n.$attrs)for(var l in n.$attrs)o[l]=n.$attrs[l];return o.$infos={__func__:n,__name__:n.$infos.__name__},o.__get__=function(x,L){var D=function(){return o(L,...arguments)};return D.__class__=$B.method,D.$infos={__self__:L,__func__:o,__name__:n.$infos.__name__,__qualname__:L.$infos.__name__+"."+n.$infos.__name__},D},o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});$B.set_func_names(classmethod,"builtins");var code=$B.code=$B.make_class("code");function compile(){var n=$B.args("compile",6,{source:null,filename:null,mode:null,flags:null,dont_inherit:null,optimize:null,_feature_version:null},["source","filename","mode","flags","dont_inherit","optimize","_feature_version"],arguments,{flags:0,dont_inherit:!1,optimize:-1,_feature_version:0},null,null),o="$exec_"+$B.UUID();if($B.clear_ns(o),n.__class__=code,n.co_flags=n.flags,n.name="<module>","single"==n.mode&&512&n.flags&&!n.source.endsWith("\n")){var l=n.source.split("\n");if($B.last(l).startsWith(" "))throw _b_.SyntaxError.$factory("unexpected EOF while parsing")}return $B.py2js(n.source,o,o),n}code.__repr__=code.__str__=function(n){return"<code object "+n.co_name+", file "+n.co_filename+">"},code.__getattribute__=function(n,o){return n[o]},$B.set_func_names(code,"builtins");var __debug__=$B.debug>0;function delattr(n,o){if(check_no_kw("delattr",n,o),check_nb_args("delattr",2,arguments),"string"!=typeof o)throw _b_.TypeError.$factory("attribute name must be string, not '"+$B.class_name(o)+"'");return $B.$getattr(n,"__delattr__")(o)}function dir(n){if(void 0===n){var o=$B.last($B.frames_stack);for(var l in locals_obj=o[1],L=_b_.list.$factory(),D=0,locals_obj)"$"==l.charAt(0)&&"$"!=l.charAt(1)||(L[D++]=l);return _b_.list.sort(L),L}if(check_nb_args("dir",1,arguments),check_no_kw("dir",n),n.__class__||$B.get_class(n),n.$is_class){var x=$B.$getattr(n.__class__,"__dir__");return $B.$call(x)(n)}try{var L=$B.$call($B.$getattr(n,"__dir__"))();return _b_.list.$factory(L)}catch{}L=[];var D=0;for(var l in n)"$"!==l.charAt(0)&&"__class__"!==l&&void 0!==n[l]&&(L[D++]=l);return L.sort(),L}function divmod(n,o){check_no_kw("divmod",n,o),check_nb_args("divmod",2,arguments);var l=n.__class__||$B.get_class(n),x=$B.$getattr(l,"__divmod__",_b_.None);return x!==_b_.None?x(n,o):_b_.tuple.$factory([$B.$getattr(l,"__floordiv__")(n,o),$B.$getattr(l,"__mod__")(n,o)])}$B.$delete=function(n,o){function l(D){D.__class__===$B.generator&&D.return()}var x=!1,L=$B.last($B.frames_stack);if(o?L[2]!=L[0]&&void 0!==L[3][n]&&(x=!0,l(L[3][n]),delete L[3][n]):void 0!==L[1][n]&&(x=!0,l(L[1][n]),delete L[1][n]),!x)throw _b_.NameError.$factory(n)};var enumerate=$B.make_class("enumerate",function(){var n=$B.args("enumerate",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null),o=iter(n.iterable),l=n.start;return{__class__:enumerate,__name__:"enumerate iterator",counter:l-1,iter:o,start:l}});function $$eval(src,_globals,_locals){var $=$B.args("eval",4,{src:null,globals:null,locals:null,mode:null},["src","globals","locals","mode"],arguments,{globals:_b_.None,locals:_b_.None,mode:"eval"},null,null),src=$.src,_globals=$.globals,_locals=$.locals,mode=$.mode;$.src.mode&&"single"==$.src.mode&&["<console>","<stdin>"].indexOf($.src.filename)>-1&&_b_.print(">",$.src.source.trim());var current_frame=$B.frames_stack[$B.frames_stack.length-1];if(void 0!==current_frame)var current_locals_id=current_frame[0].replace(/\./g,"_"),current_globals_id=current_frame[2].replace(/\./g,"_");var stack_len=$B.frames_stack.length;if(src.__class__===code)mode=src.mode,src=src.source;else if("string"!=typeof src)throw _b_.TypeError.$factory("eval() arg 1 must be a string, bytes or code object");var globals_id="$exec_"+$B.UUID(),globals_name=globals_id,locals_id="$exec_"+$B.UUID(),parent_scope;if(_globals===_b_.None){current_locals_id==current_globals_id&&(locals_id=globals_id);var local_scope={module:globals_id,id:locals_id,binding:{},bindings:{}};for(var attr in current_frame[1])local_scope.binding[attr]=!0,local_scope.bindings[attr]=!0;var global_scope={module:globals_id,id:globals_id,binding:{},bindings:{}};for(var attr in current_frame[3])global_scope.binding[attr]=!0,global_scope.bindings[attr]=!0;local_scope.parent_block=global_scope,global_scope.parent_block=$B.builtins_scope,parent_scope=local_scope,eval("$locals_"+parent_scope.id+" = current_frame[1]")}else{if(_globals.__class__!=_b_.dict)throw _b_.TypeError.$factory("exec() globals must be a dict, not "+$B.class_name(_globals));if(_globals.globals_id&&(globals_id=globals_name=_globals.globals_id),_globals.globals_id=globals_id,_locals===_globals||_locals===_b_.None)locals_id=globals_id,parent_scope=$B.builtins_scope;else{var grandparent_scope={id:globals_id,parent_block:$B.builtins_scope,binding:{}};for(var attr in parent_scope={id:locals_id,parent_block:grandparent_scope,binding:{}},_globals.$string_dict)grandparent_scope.binding[attr]=!0;for(var attr in _locals.$string_dict)parent_scope.binding[attr]=!0}}if($B.$py_module_path[globals_id]=$B.$py_module_path[current_globals_id],eval("var $locals_"+globals_id+" = {}\nvar $locals_"+locals_id+" = {}"),_globals===_b_.None){var gobj=current_frame[3],ex="var $locals_"+globals_id+" = gobj;",obj={};for(var attr in eval(ex),gobj)attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=gobj[attr]);eval("$locals_"+globals_id+" = obj")}else{var globals_is_dict=!1;if(_globals.$jsobj)var items=_globals.$jsobj;else{var items=_b_.dict.$to_obj(_globals);_globals.$jsobj=items,globals_is_dict=!0}for(var item in eval("$locals_"+globals_id+" = _globals.$jsobj"),items){var item1=$B.to_alias(item);try{eval("$locals_"+globals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}}if(_globals.$is_namespace=!0,_locals===_b_.None)if(_globals!==_b_.None)eval("var $locals_"+locals_id+" = $locals_"+globals_id);else{var lobj=current_frame[1],ex="",obj={};for(var attr in current_frame[1])attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=lobj[attr]);eval("$locals_"+locals_id+" = obj")}else{var locals_is_dict=!1;if(_locals.$jsobj)var items=_locals.$jsobj;else{locals_id_dict=!0;var items=_b_.dict.$to_obj(_locals);_locals.$jsobj=items}for(var item in items){var item1=$B.to_alias(item);try{eval("$locals_"+locals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}eval("$locals_"+locals_id+".$exec_locals = true")}_locals.$is_namespace=!0,_globals===_b_.None&&_locals===_b_.None&&current_frame[0]==current_frame[2]||eval("$locals_"+locals_id+".$src = src");var root=$B.py2js(src,globals_id,locals_id,parent_scope),js,gns,lns;if(_globals!==_b_.None&&_locals==_b_.None)for(var attr in _globals.$string_dict)root.binding[attr]=!0;try{var try_node=root.children[root.children.length-2],instr=try_node.children[try_node.children.length-2],type=instr.C.tree[0].type;switch(type){case"expr":case"list_or_tuple":case"op":case"ternary":var children=try_node.children;root.children.splice(root.children.length-2,2);for(var i=0;i<children.length-1;i++)root.add(children[i]);break;default:if("eval"==mode)throw _b_.SyntaxError.$factory("eval() argument must be an expression","<string>",1,1,src)}if("eval"!=mode){var last=$B.last(root.children),js=last.to_js();-1==["node_js"].indexOf(last.C.type)&&(last.to_js=function(){for(;js.endsWith("\n");)js=js.substr(0,js.length-1);for(;js.endsWith(";");)js=js.substr(0,js.length-1);return"return ("+js+")"}),js=root.to_js();var locals_obj=eval("$locals_"+locals_id),globals_obj=eval("$locals_"+globals_id);if(_globals===_b_.None)var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,js)(globals_obj,locals_obj);else{current_globals_obj=current_frame[3],current_locals_obj=current_frame[1];var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,"$locals_"+current_globals_id,"$locals_"+current_locals_id,js)(globals_obj,locals_obj,current_globals_obj,current_locals_obj)}$.src.mode&&"single"==$.src.mode&&"<stdin>"==$.src.filename&&res!==_b_.None&&void 0!==res&&_b_.print(_b_.repr(res))}else{js=root.to_js();var res=eval(js)}if("<console>"==$.src.filename&&"single"==$.src.mode&&void 0!==res&&res!==_b_.None&&_b_.print(res),gns=eval("$locals_"+globals_id),$B.frames_stack[$B.frames_stack.length-1][2]==globals_id&&(gns=$B.frames_stack[$B.frames_stack.length-1][3]),_locals!==_b_.None)for(var attr in lns=eval("$locals_"+locals_id),lns){var attr1=$B.from_alias(attr);"$"!=attr1.charAt(0)&&(_locals.$jsobj?_locals.$jsobj[attr]=lns[attr]:_b_.dict.$setitem(_locals,attr1,lns[attr]))}else for(var attr in lns)"$src"!==attr&&(current_frame[1][attr]=lns[attr]);if(_globals!==_b_.None){if(globals_is_dict){var jsobj=_globals.$jsobj;delete _globals.$jsobj}for(var attr in gns)attr1=$B.from_alias(attr),"$"!=attr1.charAt(0)&&(globals_is_dict?_b_.dict.$setitem(_globals,attr,gns[attr]):_globals.$jsobj[attr1]=gns[attr]);for(var attr in _globals.$string_dict)attr.startsWith("$")&&!attr.startsWith("$$")&&delete _globals.$string_dict[attr]}else for(var attr in gns)"$src"!==attr&&(current_frame[3][attr]=gns[attr]);return void 0===res?_b_.None:res}catch(n){throw n.src=src,n.module=globals_id,void 0===n.$py_error?$B.exception(n):n}finally{$B.frames_stack.length==stack_len+1&&$B.frames_stack.pop(),root=null,js=null,gns=null,lns=null,$B.clear_ns(globals_id),$B.clear_ns(locals_id)}}function exec(n,o,l){var x=$B.args("exec",3,{src:null,globals:null,locals:null},["src","globals","locals"],arguments,{globals:_b_.None,locals:_b_.None},null,null);return $$eval(x.src,x.globals,x.locals,"exec")||_b_.None}function exit(){throw _b_.SystemExit}enumerate.__iter__=function(n){return n.counter=n.start-1,n},enumerate.__next__=function(n){return n.counter++,$B.fast_tuple([n.counter,next(n.iter)])},$B.set_func_names(enumerate,"builtins"),$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.to_alias=function(n){return $B.aliased_names[n]?"$$"+n:n},$$eval.$is_func=!0,exec.$is_func=!0,exit.__repr__=exit.__str__=function(){return"Use exit() or Ctrl-Z plus Return to exit"};var filter=$B.make_class("filter",function(n,o){return check_no_kw("filter",n,o),check_nb_args("filter",2,arguments),o=iter(o),n===_b_.None&&(n=$B.$bool),{__class__:filter,func:n,iterable:o}});function format(n,o){var l=$B.args("format",2,{value:null,format_spec:null},["value","format_spec"],arguments,{format_spec:""},null,null),x=n.__class__||$B.get_class(n);try{var L=$B.$getattr(x,"__format__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.NotImplementedError("__format__ is not implemented for object '"+_b_.str.$factory(n)+"'"):D}return $B.$call(L)(n,l.format_spec)}function attr_error(n,o){var l="bad operand type for unary #: '"+o+"'";switch(n){case"__neg__":throw _b_.TypeError.$factory(l.replace("#","-"));case"__pos__":throw _b_.TypeError.$factory(l.replace("#","+"));case"__invert__":throw _b_.TypeError.$factory(l.replace("#","~"));case"__call__":throw _b_.TypeError.$factory("'"+o+"' object is not callable");default:for(;"$"==n.charAt(0);)n=n.substr(1);throw _b_.AttributeError.$factory("'"+o+"' object has no attribute '"+n+"'")}}function getattr(){var n={},o=$B.args("getattr",3,{obj:null,attr:null,_default:null},["obj","attr","_default"],arguments,{_default:n},null,null);return $B.$getattr(o.obj,o.attr,o._default===n?void 0:o._default)}function in_mro(n,o){if(void 0===n)return!1;if(n.hasOwnProperty(o))return n[o];for(var l=n.__mro__,x=0,L=l.length;x<L;x++)if(l[x].hasOwnProperty(o))return l[x][o];return!1}function globals(){check_nb_args("globals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[3]);return n.$jsobj.__BRYTHON__=$B.JSObj.$factory($B),n.$is_namespace=!0,n}function hasattr(n,o){check_no_kw("hasattr",n,o),check_nb_args("hasattr",2,arguments);try{return $B.$getattr(n,o),!0}catch{return!1}}filter.__iter__=function(n){return n},filter.__next__=function(n){for(;;){var o=next(n.iterable);if(n.func(o))return o}},$B.set_func_names(filter,"builtins"),$B.$getattr=function(n,o,l){if(o=$B.to_alias(o),n.$method_cache&&n.$method_cache[o]&&n.__class__&&n.__class__[o]==n.$method_cache[o][1])return n.$method_cache[o][0];var x=o;void 0===n&&console.log("get attr",o,"of undefined");var L,D=n.$is_class||n.$factory,z=n.__class__;if(void 0!==z&&z.__bases__&&(0==z.__bases__.length||1==z.__bases__.length&&z.__bases__[0]===_b_.object)){if(n.hasOwnProperty(o))return n[o];if(n.__dict__&&n.__dict__.$string_dict.hasOwnProperty(o)&&(!z.hasOwnProperty(o)||!z[o].__get__))return n.__dict__.$string_dict[o][0];if(z.hasOwnProperty(o)&&"function"!=typeof z[o]&&"__dict__"!=o&&void 0===z[o].__get__&&!in_mro(z[o].__class__,"__get__"))return z[o]}if(void 0===z)if("string"==typeof n)z=_b_.str;else if("number"==typeof n)z=n%1==0?_b_.int:_b_.float;else if(n instanceof Number)z=_b_.float;else if(void 0===(z=$B.get_class(n))){if(void 0!==(P=n[o])){if("function"==typeof P){var M=function(){return P.apply(n,arguments)};return M.$infos={__name__:o,__qualname__:o},M}return $B.$JS2Py(P)}if(void 0!==l)return l;throw _b_.AttributeError.$factory("object has no attribute "+x)}switch(o){case"__call__":if("function"==typeof n){var P=function(){return n.apply(null,arguments)};return P.__class__=method_wrapper,P.$infos={__name__:"__call__"},P}break;case"__class__":return z;case"__dict__":if(D){var de={};for(var ye in n){var he=$B.from_alias(ye);he.startsWith("$")||(de[he]=n[ye])}return de.__dict__=$B.getset_descriptor.$factory(n,"__dict__"),$B.mappingproxy.$factory(de)}if(n.hasOwnProperty(o))return n[o];if(n.$infos){if(n.$infos.hasOwnProperty("__dict__"))return n.$infos.__dict__;if(n.$infos.hasOwnProperty("__func__"))return n.$infos.__func__.$infos.__dict__}return $B.obj_dict(n);case"__doc__":for(var ae=0;ae<builtin_names.length;ae++)if(n===_b_[builtin_names[ae]])return _get_builtins_doc(),$B.builtins_doc[builtin_names[ae]];break;case"__mro__":if(n.$is_class)return _b_.tuple.$factory([n].concat(n.__mro__));if(n.__dict__&&void 0!==n.__dict__.$string_dict.__mro__)return n.__dict__.$string_dict.__mro__;throw _b_.AttributeError.$factory(o);case"__subclasses__":if(z.$factory||z.$is_class){var fe=n.$subclasses||[];return function(){return fe}}}if("function"==typeof n){var le=n[o];if(void 0!==le&&"__module__"==o)return le}if(!D&&z.$native){if(n.$method_cache&&n.$method_cache[o])return n.$method_cache[o];if("__doc__"==o&&void 0===z[o]&&z.$infos&&(_get_builtins_doc(),z[o]=$B.builtins_doc[z.$infos.__name__]),void 0===z[o]){var q=_b_.object[o];if(void 0===q){var Y=n.__dict__;return Y&&void 0!==(q=Y.$string_dict[o])?q[0]:(void 0===l&&attr_error(o,z.$infos.__name__),l)}z[o]=q}if(z.$descriptors&&void 0!==z.$descriptors[o])return z[o](n);if("function"==typeof z[o]){var A=z[o];if("__new__"==o&&(A.$type="staticmethod"),"staticmethod"==A.$type)return A;var N=z[o].__class__==$B.method?z:n,X=z[o].bind(null,N);return X.__class__=$B.method,X.$infos={__func__:A,__name__:o,__self__:N,__qualname__:z.$infos.__name__+"."+o},"object"==typeof n&&(n.__class__=z,n.$method_cache=n.$method_cache||{},n.$method_cache[o]=X),X}if(void 0!==z[o])return z[o];attr_error(x,z.$infos.__name__)}if(D)L=_b_.type.__getattribute__;else if(void 0===(L=z.__getattribute__)){var oe;void 0===(oe=z.__mro__)&&console.log(n,o,"no mro, klass",z),ae=0;for(var H=oe.length;ae<H&&void 0===(L=oe[ae].__getattribute__);ae++);}if("function"!=typeof L&&console.log(o+" is not a function "+L,z),L===_b_.object.__getattribute__){if(P=n[o],Array.isArray(n)&&void 0!==Array.prototype[o]&&(P=void 0),null===P)return null;if(void 0===P&&n.hasOwnProperty(o)||void 0!==P&&(void 0===P.__set__||P.$is_class))return P}try{P=L(n,o)}catch(Q){if(void 0!==l)return l;throw Q}if(void 0!==P)return P;if(void 0!==l)return l;var Ce=z.$infos.__name__;D&&(Ce=n.$infos.__name__),attr_error(x,Ce)};var hash_cache={};function hash(n){if(check_no_kw("hash",n),check_nb_args("hash",1,arguments),void 0!==n.__hashvalue__)return n.__hashvalue__;if(isinstance(n,_b_.bool))return _b_.int.$factory(n);if(isinstance(n,_b_.int))return void 0===n.$brython_value?n.valueOf():n.__hashvalue__=n.$brython_value;if(n.$is_class||n.__class__===_b_.type||n.__class__===$B.Function)return n.__hashvalue__=$B.$py_next_hash--;if("string"==typeof n){var o=hash_cache[n];return void 0!==o?o:hash_cache[n]=_b_.str.__hash__(n)}var l=n.__class__||$B.get_class(n);if(void 0===l)throw _b_.TypeError.$factory("unhashable type: '"+_b_.str.$factory($B.JSObj.$factory(n))+"'");var x=$B.$getattr(l,"__hash__",_b_.None);if(x===_b_.None)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'");if(x.$infos.__func__===_b_.object.__hash__){if($B.$getattr(n,"__eq__").$infos.__func__!==_b_.object.__eq__)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'","hash");return n.__hashvalue__=_b_.object.__hash__(n)}return $B.$call(x)(n)}function _get_builtins_doc(){if(void 0===$B.builtins_doc){var url=$B.brython_path;"/"==url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url+="/builtins_docstrings.js";var f=_b_.open(url);eval(f.$string),$B.builtins_doc=docs}}function help(n){if(void 0===n&&(n="help"),"string"==typeof n&&void 0!==_b_[n]){_get_builtins_doc();var o=$B.builtins_doc[n];if(void 0!==o&&""!=o)return void _b_.print(o)}for(var l=0;l<builtin_names.length;l++)n===_b_[builtin_names[l]]&&(_get_builtins_doc(),_b_.print(o=$B.builtins_doc[builtin_names[l]]));if("string"!=typeof n)try{return $B.$getattr(n,"__doc__")}catch{return""}else $B.$import("pydoc"),$B.$getattr($B.$getattr($B.imported.pydoc,"help"),"__call__")(n)}function hex(n){return check_no_kw("hex",n),check_nb_args("hex",1,arguments),bin_hex_oct(16,n)}function id(n){return check_no_kw("id",n),check_nb_args("id",1,arguments),isinstance(n,[_b_.str,_b_.int,_b_.float])&&!isinstance(n,$B.long_int)?$B.$getattr(_b_.str.$factory(n),"__hash__")():void 0!==n.$id?n.$id:n.$id=$B.UUID()}function __import__(n,o,l,x,L){var D=$B.args("__import__",5,{name:null,globals:null,locals:null,fromlist:null,level:null},["name","globals","locals","fromlist","level"],arguments,{globals:None,locals:None,fromlist:_b_.tuple.$factory(),level:0},null,null);return $B.$__import__(D.name,D.globals,D.locals,D.fromlist)}function input(n){var o=prompt(n||"")||"";return $B.imported.sys&&$B.imported.sys.ps1&&(n!=$B.imported.sys.ps1&&n!=$B.imported.sys.ps2||console.log(n,o)),o}function isinstance(n,o){if(check_no_kw("isinstance",n,o),check_nb_args("isinstance",2,arguments),null===n)return o===None;if(void 0===n)return!1;if(o.constructor===Array){for(var l=0;l<o.length;l++)if(isinstance(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("isinstance() arg 2 cannot be a parameterized generic");if(!o.__class__||void 0===o.$factory&&void 0===o.$is_class)throw _b_.TypeError.$factory("isinstance() arg 2 must be a type or tuple of types");if(o===_b_.int&&(n===True||n===False))return True;if(o===_b_.bool)switch(typeof n){case"string":case"number":return!1;case"boolean":return!0}var x=n.__class__;if(null==x){if("string"==typeof n){if(o==_b_.str)return!0;if($B.builtin_classes.indexOf(o)>-1)return!1}else if(n.contructor===Number&&Number.isFinite(n)){if(o==_b_.float)return!0}else if("number"==typeof n&&Number.isFinite(n)&&Number.isFinite(n)&&o==_b_.int)return!0;x=$B.get_class(n)}if(void 0===x)return!1;function L(M,P){return M===P||P===_b_.str&&M===$B.StringSubclass||P===_b_.int&&M===$B.IntSubclass||void 0}if(L(x,o))return!0;var D=x.__mro__;for(l=0;l<D.length;l++)if(L(D[l],o))return!0;var z=$B.$getattr(o.__class__||$B.get_class(o),"__instancecheck__",_b_.None);return z!==_b_.None&&z(o,n)}function issubclass(n,o){if(check_no_kw("issubclass",n,o),check_nb_args("issubclass",2,arguments),!n.__class__||void 0===n.$factory&&void 0===n.$is_class)throw _b_.TypeError.$factory("issubclass() arg 1 must be a class");if(isinstance(o,_b_.tuple)){for(var l=0;l<o.length;l++)if(issubclass(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("issubclass() arg 2 cannot be a parameterized generic");if((o.$factory||o.$is_class)&&(n===o||n.__mro__.indexOf(o)>-1))return!0;var x=$B.$getattr(o.__class__||$B.get_class(o),"__subclasscheck__",_b_.None);return x!=_b_.None&&x(o,n)}help.__repr__=help.__str__=function(){return"Type help() for interactive help, or help(object) for help about object."};var iterator_class=$B.make_class("iterator",function(n,o){return{__class__:iterator_class,getitem:n,len:o,counter:-1}});function iter(){var n=$B.args("iter",1,{obj:null},["obj"],arguments,{},"args","kw");if(n.args.length>0)var o=n.args[0];return $B.$iter(n.obj,o)}function len(n){check_no_kw("len",n),check_nb_args("len",1,arguments);var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__len__")}catch{throw _b_.TypeError.$factory("object of type '"+$B.class_name(n)+"' has no len()")}return $B.$call(l)(n)}function locals(){check_nb_args("locals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[1]);return n.$is_namespace=!0,delete n.$jsobj.__annotations__,n}iterator_class.__next__=function(n){if(n.counter++,null!==n.len&&n.counter==n.len)throw _b_.StopIteration.$factory("");try{return n.getitem(n.counter)}catch{throw _b_.StopIteration.$factory("")}},callable_iterator=$B.make_class("callable_iterator",function(n,o){return{__class__:callable_iterator,func:n,sentinel:o}}),callable_iterator.__iter__=function(n){return n},callable_iterator.__next__=function(n){var o=n.func();if($B.rich_comp("__eq__",o,n.sentinel))throw _b_.StopIteration.$factory();return o},$B.$iter=function(n,o){if(void 0===o){var l=n.__class__||$B.get_class(n);try{var x=$B.$call($B.$getattr(l,"__iter__"))}catch(z){if(z.__class__===_b_.AttributeError)try{var L=$B.$call($B.$getattr(l,"__getitem__"));return len(n),iterator_class.$factory(function(M){return L(n,M)},len)}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not iterable")}throw z}var D=$B.$call(x)(n);try{$B.$getattr(D,"__next__")}catch(z){if(isinstance(z,_b_.AttributeError))throw _b_.TypeError.$factory("iter() returned non-iterator of type '"+$B.class_name(D)+"'")}return D}return callable_iterator.$factory(n,o)};var map=$B.make_class("map",function(){var n=$B.args("map",2,{func:null,it1:null},["func","it1"],arguments,{},"args",null),o=$B.$call(n.func),l=[$B.$iter(n.it1)];return n.args.forEach(function(x){l.push($B.$iter(x))}),{__class__:map,args:l,func:o}});function $extreme(n,o){var l="min";if("__gt__"===o&&(l="max"),0==n.length)throw _b_.TypeError.$factory(l+" expected 1 arguments, got 0");var x=n[n.length-1],L=n.length,D=!1,z=!1;if("kw"==x.$nat)for(var M in L--,x=x.kw)switch(M){case"key":z=x[M];break;case"$$default":var P=x[M];D=!0;break;default:throw _b_.TypeError.$factory("'"+M+"' is an invalid keyword argument for this function")}if(z||(z=function(fe){return fe}),0==L)throw _b_.TypeError.$factory(l+" expected 1 argument, got 0");if(1!=L){if(D)throw _b_.TypeError.$factory("Cannot specify a default for "+l+"() with multiple positional arguments");he=null;for(var de=0;de<L;de++)ae=n[de],(null===he||$B.$bool($B.$getattr(z(ae),o)(z(he))))&&(he=ae);return he}for(var ye=iter(n[0]),he=null;;)try{var ae=next(ye);(null===he||$B.$bool($B.$getattr(z(ae),o)(z(he))))&&(he=ae)}catch(fe){if(fe.__class__==_b_.StopIteration){if(null===he){if(D)return P;throw _b_.ValueError.$factory(l+"() arg is an empty sequence")}return he}throw fe}}function max(){return $extreme(arguments,"__gt__")}map.__iter__=function(n){return n},map.__next__=function(n){for(var o=[],l=0;l<n.args.length;l++)o.push(next(n.args[l]));return n.func.apply(null,o)},$B.set_func_names(map,"builtins");var memoryview=$B.make_class("memoryview",function(n){if(check_no_kw("memoryview",n),check_nb_args("memoryview",1,arguments),n.__class__===memoryview)return n;if($B.get_class(n).$buffer_protocol)return{__class__:memoryview,obj:n,format:"B",itemsize:1,ndim:1,shape:_b_.tuple.$factory([_b_.len(n)]),strides:_b_.tuple.$factory([1]),suboffsets:_b_.tuple.$factory([]),c_contiguous:!0,f_contiguous:!0,contiguous:!0};throw _b_.TypeError.$factory("memoryview: a bytes-like object is required, not '"+$B.class_name(n)+"'")});function min(){return $extreme(arguments,"__lt__")}function next(n){check_no_kw("next",n);var o={},l=$B.args("next",2,{obj:null,def:null},["obj","def"],arguments,{def:o},null,null),x=n.__class__||$B.get_class(n),L=$B.$call($B.$getattr(x,"__next__"));if(void 0!==L)try{return $B.$call(L)(n)}catch(D){if(D.__class__===_b_.StopIteration&&l.def!==o)return l.def;throw D}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not an iterator")}memoryview.__eq__=function(n,o){return o.__class__===memoryview&&$B.$getattr(n.obj,"__eq__")(o.obj)},memoryview.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o*n.itemsize;if("I"==n.format){for(var x=n.obj.source[l],L=256,D=1;D<4;D++)x+=n.obj.source[l+D]*L,L*=256;return x}if("B".indexOf(n.format)>-1){if(o>n.obj.source.length-1)throw _b_.KeyError.$factory(o);return n.obj.source[o]}return n.obj.source[o]}if(x=n.obj.__class__.__getitem__(n.obj,o),o.__class__===_b_.slice)return memoryview.$factory(x)},memoryview.__len__=function(n){return len(n.obj)/n.itemsize},memoryview.cast=function(n,o){switch(o){case"B":return memoryview.$factory(n.obj);case"I":var l=memoryview.$factory(n.obj),x=len(n.obj);if(l.itemsize=4,l.format="I",x%4!=0)throw _b_.TypeError.$factory("memoryview: length is not a multiple of itemsize");return l}},memoryview.hex=function(n){var o="";return _b_.bytes.$factory(n).source.forEach(function(l){o+=l.toString(16)}),o},memoryview.tobytes=function(n){return _b_.bytes.$factory(n.obj)},memoryview.tolist=function(n){if(1==n.itemsize)return _b_.list.$factory(_b_.bytes.$factory(n.obj));if(4==n.itemsize&&"I"==n.format){for(var o=[],l=0;l<n.obj.source.length;l+=4){for(var x=n.obj.source[l],L=256,D=1;D<4;D++)x+=L*n.obj.source[l+D],L*=256;o.push(x)}return o}},$B.set_func_names(memoryview,"builtins");var NotImplementedType=$B.make_class("NotImplementedType",function(){return NotImplemented});NotImplementedType.__repr__=NotImplementedType.__str__=function(n){return"NotImplemented"};var NotImplemented={__class__:NotImplementedType};function $not(n){return!$B.$bool(n)}function oct(n){return check_no_kw("oct",n),check_nb_args("oct",1,arguments),bin_hex_oct(8,n)}function ord(n){if(check_no_kw("ord",n),check_nb_args("ord",1,arguments),"string"==typeof n){if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found")}switch($B.get_class(n)){case _b_.str:if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found");case _b_.str.$surrogate:if(1==n.items.length)return n.items[0].codePointAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.items.length+" found");case _b_.bytes:case _b_.bytearray:if(1==n.source.length)return n.source[0];throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.source.length+" found");default:throw _b_.TypeError.$factory("ord() expected a character, but "+$B.class_name(n)+" was found")}}function pow(){var n=$B.args("pow",3,{x:null,y:null,mod:null},["x","y","mod"],arguments,{mod:None},null,null),o=n.x,l=n.y,x=n.mod,L=o.__class__||$B.get_class(o);if(x===_b_.None)return $B.$call($B.$getattr(L,"__pow__"))(o,l);if(o!=_b_.int.$factory(o)||l!=_b_.int.$factory(l))throw _b_.TypeError.$factory("pow() 3rd argument not allowed unless all arguments are integers");return $B.$call($B.$getattr(L,"__pow__"))(o,l,x)}function $print(){var n=$B.args("print",0,{},[],arguments,{},"args","kw"),o=n.kw.$string_dict,l=void 0===o.end||o.end===None?"\n":o.end[0],x=void 0===o.sep||o.sep===None?" ":o.sep[0],L=void 0===o.file?$B.stdout:o.file[0],z=[];n.args.forEach(function(de){z.push(_b_.str.$factory(de))});var M=z.join(x)+l;M=M.replace(new RegExp("\x07","g"),"").replace(new RegExp("(.)\b","g"),""),$B.$getattr(L,"write")(M);var P=$B.$getattr(L,"flush",None);return P!==None&&P(),None}$print.__name__="print",$print.is_func=!0;var property=$B.make_class("property",function(n,o,l,x){var L={__class__:property};return property.__init__(L,n,o,l,x),L});function quit(){throw _b_.SystemExit}function repr(n){check_no_kw("repr",n),check_nb_args("repr",1,arguments);var o=n.__class__||$B.get_class(n);return $B.$call($B.$getattr(o,"__repr__"))(n)}property.__init__=function(n,o,l,x,L){if(n.__doc__=L||"",n.$type=o.$type,n.fget=o,n.fset=l,n.fdel=x,o&&o.$attrs)for(var D in o.$attrs)n[D]=o.$attrs[D];n.__get__=function(z,M,P){if(void 0===M)return z;if(void 0===z.fget)throw _b_.AttributeError.$factory("unreadable attribute");return $B.$call(z.fget)(M)},void 0!==l&&(n.__set__=function(z,M,P){if(void 0===z.fset)throw _b_.AttributeError.$factory("can't set attribute");$B.$getattr(z.fset,"__call__")(M,P)}),n.__delete__=x,n.getter=function(z){return property.$factory(z,n.fset,n.fdel,n.__doc__)},n.setter=function(z){return property.$factory(n.fget,z,n.fdel,n.__doc__)},n.deleter=function(z){return property.$factory(n.fget,n.fset,z,n.__doc__)}},property.__repr__=function(n){return _b_.repr(n.fget(n))},property.__str__=function(n){return _b_.str.$factory(n.fget(n))},$B.set_func_names(property,"builtins"),quit.__repr__=quit.__str__=function(){return"Use quit() or Ctrl-Z plus Return to exit"};var reversed=$B.make_class("reversed",function(n){check_no_kw("reversed",n),check_nb_args("reversed",1,arguments);var o=n.__class__||$B.get_class(n),l=$B.$getattr(o,"__reversed__",null);if(null!==l)return $B.$call(l)(n);try{var x=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("argument to reversed() must be a sequence")}return{__class__:reversed,$counter:_b_.len(n),getter:function(D){return $B.$call(x)(n,D)}}});function round(){var n=$B.args("round",2,{number:null,ndigits:null},["number","ndigits"],arguments,{ndigits:None},null,null),o=n.number,l=n.ndigits===None?0:n.ndigits;if(!isinstance(o,[_b_.int,_b_.float])){var x=o.__class__||$B.get_class(o);try{return $B.$call($B.$getattr(x,"__round__")).apply(null,arguments)}catch(P){throw P.__class__===_b_.AttributeError?_b_.TypeError.$factory("type "+$B.class_name(o)+" doesn't define __round__ method"):P}}if(isinstance(o,_b_.float)&&(o.value===1/0||o.value===-1/0))throw _b_.OverflowError.$factory("cannot convert float infinity to integer");if(!isinstance(l,_b_.int))throw _b_.TypeError.$factory("'"+$B.class_name(l)+"' object cannot be interpreted as an integer");var L,D=Math.pow(10,l),z=o*D,M=Math.floor(z);return.5==Math.abs(z-M)?(M%2&&(M+=1),L=_b_.int.__truediv__(M,D)):L=_b_.int.__truediv__(Math.round(z),D),n.ndigits===None?L.valueOf():o instanceof Number?new Number(L):L.valueOf()}function setattr(){var n=$B.args("setattr",3,{obj:null,attr:null,value:null},["obj","attr","value"],arguments,{},null,null),o=n.obj,l=n.attr,x=n.value;if("string"!=typeof l)throw _b_.TypeError.$factory("setattr(): attribute name must be string");return $B.$setattr(o,l,x)}function sorted(){for(var n=$B.args("sorted",1,{iterable:null},["iterable"],arguments,{},null,"kw"),o=_b_.list.$factory(iter(n.iterable)),l=[o],x=1;x<arguments.length;x++)l.push(arguments[x]);return _b_.list.sort.apply(null,l),o}reversed.__iter__=function(n){return n},reversed.__next__=function(n){if(n.$counter--,n.$counter<0)throw _b_.StopIteration.$factory("");return n.getter(n.$counter)},$B.set_func_names(reversed,"builtins"),$B.$setattr=function(n,o,l){if($B.aliased_names[o])o="$$"+o;else{if("__dict__"==o){if(!isinstance(l,_b_.dict))throw _b_.TypeError.$factory("__dict__ must be set to a dictionary, not a '"+$B.class_name(l)+"'");return n.$infos?(n.$infos.__dict__=l,None):(n.__dict__=l,None)}if("__class__"==o){let A=function(N){throw _b_.TypeError.$factory(N)};if(l.__class__)if("builtins"==l.__module__)A("__class__ assignement only supported for heap types or ModuleType subclasses");else if(Array.isArray(l.__bases__))for(var x=0;x<l.__bases__.length;x++)"builtins"==l.__bases__[x].__module__&&A("__class__ assignment: '"+$B.class_name(n)+"' object layout differs from '"+$B.class_name(l)+"'");return n.__class__=l,None}"__doc__"==o&&n.__class__===_b_.property&&(n[o]=l)}if(n.$factory||n.$is_class){var L=n.__class__;return L&&L[o]&&L[o].__get__&&L[o].__set__?(L[o].__set__(n,l),None):(n[o]=l,"__init__"==o||"__new__"==o?n.$factory=$B.$instance_creator(n):"__bases__"==o&&(n.__mro__=_b_.type.mro(n)),None)}var D=n[o],z=n.__class__||$B.get_class(n);if(void 0===D&&z&&void 0===(D=z[o])){var M=(ae=z.__mro__).length;for(x=0;x<M&&void 0===(D=ae[x][o]);x++);}if(null!=D){if(void 0!==D.__set__)return D.__set__(D,n,l),None;var P,de=D.__class__;if(void 0!==de&&void 0===(P=de.__set__))for(x=0,M=(ae=de.__mro__).length;x<M&&!(P=ae[x].__set__);x++);if(void 0!==P){var ye=$B.$getattr(D,"__set__",null);if(ye&&"function"==typeof ye)return ye.apply(D,[n,l]),None}else if(z&&void 0!==z.$descriptors&&void 0!==z[o]){var he=z[o].setter;if("function"==typeof he)return he(n,l),None;throw _b_.AttributeError.$factory("readonly attribute")}}var ae,fe=!1;if(void 0!==z&&void 0===(fe=z.__setattr__))for(x=0,M=(ae=z.__mro__).length-1;x<M&&!(fe=ae[x].__setattr__);x++);if(z&&z.__slots__&&-1==["__module__"].indexOf(o)&&!fe){let A=function(N){return N.__slots__?Array.isArray(N.__slots__)?N.__slots__.map(function(X){return X.startsWith("__")&&!X.endsWith("_")?"_"+N.$infos.__name__+X:X}):N.__slots__:[]};var le=!1;if(A(z).indexOf(o)>-1)le=!0;else for(x=0;x<z.__mro__.length;x++)if(A(z.__mro__[x]).indexOf(o)>-1){le=!0;break}if(!le)throw _b_.AttributeError.$factory("'"+z.$infos.__name__+"' object has no attribute '"+o+"'")}return fe?fe(n,o,l):void 0===n.__dict__?n[o]=l:_b_.dict.$setitem(n.__dict__,o,l),None};var staticmethod=$B.make_class("staticmethod",function(n){var o={$infos:n.$infos,__get__:function(){return n}};return o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});function sum(n,o){var l=$B.args("sum",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null);if(n=l.iterable,_b_.isinstance(o=l.start,[_b_.str,_b_.bytes]))throw _b_.TypeError.$factory("TypeError: sum() can't sum bytes [use b''.join(seq) instead]");var x=o;for(n=iter(n);;)try{var L=next(n);x=$B.$getattr(x,"__add__")(L)}catch(D){if(D.__class__===_b_.StopIteration)break;throw D}return x}$B.set_func_names(staticmethod,"builtins"),$B.missing_super2=function(n){return n.$missing=!0,n};var $$super=$B.make_class("super",function(n,o){if(void 0===n&&void 0===o){var l=$B.last($B.frames_stack),x=$B.imported._sys.Getframe();if(!x.f_code||!x.f_code.co_varnames||void 0===(n=l[1].__class__))throw _b_.RuntimeError.$factory("super(): no arguments");o=l[1][x.f_code.co_varnames[0]]}return Array.isArray(o)&&(o=o[0]),{__class__:$$super,__thisclass__:n,__self_class__:o}});function vars(){var n={},o=$B.args("vars",1,{obj:null},["obj"],arguments,{obj:n},null,null);if(o.obj===n)return _b_.locals();try{return $B.$getattr(o.obj,"__dict__")}catch(l){throw l.__class__===_b_.AttributeError?_b_.TypeError.$factory("vars() argument must have __dict__ attribute"):l}}$$super.__get__=function(n,o,l){return $$super.$factory(n.__thisclass__,o)},$$super.__getattribute__=function(n,o){var l=n.__thisclass__.__mro__,x=n.__self_class__;if(void 0!==x){x.$is_class||(x=x.__class__||$B.get_class(x));for(var L=[x].concat(x.__mro__),D=0;D<L.length;D++)if(L[D]===n.__thisclass__){l=L.slice(D+1);break}}D=0;for(var z,M,P=l.length;D<P;D++)if(void 0!==l[D][o]){z=l[D][o];break}if(void 0===z){if(void 0!==$$super[o])return M=n,function(){for(var ae=[M],fe=0,le=arguments.length;fe<le;fe++)ae.push(arguments[fe]);return $$super[o].apply(null,ae)};throw _b_.AttributeError.$factory(o)}if("staticmethod"==z.$type||"__new__"==o||"function"!=typeof z)return z;z.__class__===$B.method&&(z=z.$infos.__func__);var de,ye=$B.$call(z),he=function(){return ye(n.__self_class__,...arguments)};return he.__class__=$B.method,void 0!==z.$infos?de=z.$infos.__module__:z.__class__===property?de=z.fget.$infos.__module:z.$is_class&&(de=z.__module__),he.$infos={__self__:n.__self_class__,__func__:z,__name__:o,__module__:de,__qualname__:n.__thisclass__.$infos.__name__+"."+o},he},$$super.__repr__=$$super.__str__=function(n){var o="<super: <class '"+n.__thisclass__.$infos.__name__+"'>";return(o+=void 0!==n.__self_class__?", <"+n.__self_class__.__class__.$infos.__name__+" object>":", NULL")+">"},$B.set_func_names($$super,"builtins");var $Reader=$B.make_class("Reader");function make_content(n){n.$binary&&void 0===n.$bytes?n.$bytes=_b_.str.encode(n.$string,n.encoding):n.$binary||void 0!==n.$string||(n.$string=_b_.bytes.decode(n.$bytes,n.encoding))}function make_lines(n){if(void 0===n.$lines)if(make_content(n),n.$binary){console.log("make lines, binary");for(var o=[],l=n.$bytes.source;;){var x=l.indexOf(10);if(-1==x){o.push({__class__:_b_.bytes,source:l});break}o.push({__class__:_b_.bytes,source:l.slice(0,x+1)}),l=l.slice(x+1)}n.$lines=o}else n.$lines=n.$string.split("\n")}$Reader.__enter__=function(n){return n},$Reader.__exit__=function(n){return!1},$Reader.__iter__=function(n){return iter($Reader.readlines(n))},$Reader.__len__=function(n){return n.lines.length},$Reader.close=function(n){n.closed=!0},$Reader.flush=function(n){return None},$Reader.read=function(){var n=$B.args("read",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null),o=n.self,l=$B.$GetInt(n.size);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");return make_content(o),l<0&&(l=(o.$binary?o.$bytes.source.length:o.$string.length)-o.$counter),res=o.$binary?_b_.bytes.$factory(o.$bytes.source.slice(o.$counter,o.$counter+l)):o.$string.substr(o.$counter,l),o.$counter+=l,res},$Reader.readable=function(n){return!0},$Reader.readline=function(n,o){var l=$B.args("readline",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null);if(n=l.self,o=$B.$GetInt(l.size),n.$lc=void 0===n.$lc?-1:n.$lc,!0===n.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(make_content(n),n.$binary){var x;if(-1==(x=n.$bytes.source.indexOf(10,n.$counter)))return _b_.bytes.$factory();var L={__class__:_b_.bytes,source:n.$bytes.source.slice(n.$counter,x+1)};return n.$counter=x+1,L}return-1==(x=n.$string.indexOf("\n",n.$counter))?"":(L=n.$string.substring(n.$counter,x+1),n.$counter=x+1,n.$lc+=1,L)},$Reader.readlines=function(){var n=$B.args("readlines",2,{self:null,hint:null},["self","hint"],arguments,{hint:-1},null,null),o=n.self,l=$B.$GetInt(n.hint);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(o.$lc=void 0===o.$lc?-1:o.$lc,make_lines(o),l<0)var x=o.$lines.slice(o.$lc+1);else for(x=[];o.$lc<o.$lines.length&&0<l;)o.$lc++,x.push(o.$lines[o.$lc]);for(;""==x[x.length-1];)x.pop();return x},$Reader.seek=function(n,o,l){if(n.closed===True)throw _b_.ValueError.$factory("I/O operation on closed file");void 0===l&&(l=0),0===l?n.$counter=o:1===l?n.$counter+=o:2===l&&(n.$counter=n.$content.length+o)},$Reader.seekable=function(n){return!0},$Reader.tell=function(n){return n.$counter},$Reader.writable=function(n){return!1},$B.set_func_names($Reader,"builtins");var $BufferedReader=$B.make_class("_io.BufferedReader");$BufferedReader.__mro__=[$Reader,_b_.object];var $TextIOWrapper=$B.make_class("_io.TextIOWrapper",function(){var n=$B.args("TextIOWrapper",6,{buffer:null,encoding:null,errors:null,newline:null,line_buffering:null,write_through:null},["buffer","encoding","errors","newline","line_buffering","write_through"],arguments,{encoding:"utf-8",errors:_b_.None,newline:_b_.None,line_buffering:_b_.False,write_through:_b_.False},null,null);return{__class__:$TextIOWrapper,$bytes:n.buffer.$bytes,encoding:n.encoding,errors:n.errors,newline:n.newline}});function $url_open(){var $ns=$B.args("open",3,{file:null,mode:null,encoding:null},["file","mode","encoding"],arguments,{mode:"r",encoding:"utf-8"},"args","kw"),$bytes,$string,$res;for(var attr in $ns)eval("var "+attr+'=$ns["'+attr+'"]');if(args.length>0)var mode=args[0];if(args.length>1)var encoding=args[1];if(mode.search("w")>-1)throw _b_.IOError.$factory("Browsers cannot write on disk");if(-1==["r","rb"].indexOf(mode))throw _b_.ValueError.$factory("Invalid mode '"+mode+"'");if(isinstance(file,_b_.str)){var is_binary=mode.search("b")>-1;if($B.file_cache.hasOwnProperty($ns.file))$string=$B.file_cache[$ns.file];else if($B.files&&$B.files.hasOwnProperty($ns.file)){$res=atob($B.files[$ns.file].content);var source=[];for(const n of $res)source.push(n.charCodeAt(0));$bytes=_b_.bytes.$factory(),$bytes.source=source}else{if("file"==$B.protocol)throw _b_.FileNotFoundError.$factory("cannot use 'open()' with protocol 'file'");if(is_binary)throw _b_.IOError.$factory("open() in binary mode is not supported");var req=new XMLHttpRequest;req.onreadystatechange=function(){try{var n=this.status;$res=404==n?_b_.FileNotFoundError.$factory(file):200!=n?_b_.IOError.$factory("Could not open file "+file+" : status "+n):this.responseText}catch(o){$res=_b_.IOError.$factory("Could not open file "+file+" : error "+o)}};var fake_qs=$B.$options.cache?"":"?foo="+(new Date).getTime();if(req.open("GET",file+fake_qs,!1),req.overrideMimeType("text/plain; charset=utf-8"),req.send(),$res.constructor===Error)throw $res;$string=$res}if(void 0===$string&&void 0===$bytes)throw _b_.FileNotFoundError.$factory($ns.file);var res={$binary:is_binary,$string,$bytes,$counter:0,closed:False,encoding,mode,name:file};return res.__class__=is_binary?$BufferedReader:$TextIOWrapper,res}throw _b_.TypeError.$factory("invalid argument for open(): "+_b_.str.$factory(file))}$TextIOWrapper.__mro__=[$Reader,_b_.object],$B.set_func_names($TextIOWrapper,"builtins"),$B.Reader=$Reader,$B.TextIOWrapper=$TextIOWrapper,$B.BufferedReader=$BufferedReader;var zip=$B.make_class("zip",function(){var n={__class__:zip,items:[]};if(0==arguments.length)return n;for(var o=$B.args("zip",0,{},[],arguments,{},"args","kw").args,l=[],x=0;x<o.length;x++)l.push(iter(o[x]));for(var L=0,D=[];;){var z=[],M=!0;for(x=0;x<l.length;x++)try{z.push(next(l[x]))}catch(P){if(P.__class__==_b_.StopIteration){M=!1;break}throw P}if(!M)break;D[L++]=_b_.tuple.$factory(z)}return n.items=D,n}),zip_iterator=$B.make_iterator_class("zip_iterator");function no_set_attr(n,o){throw _b_.AttributeError.$factory(void 0!==n[o]?"'"+n.$infos.__name__+"' object attribute '"+o+"' is read-only":"'"+n.$infos.__name__+"' object has no attribute '"+o+"'")}zip.__iter__=function(n){return zip_iterator.$factory(n.items)},$B.set_func_names(zip,"builtins");var True=!0,False=!1,ellipsis=$B.make_class("ellipsis",function(){return Ellipsis}),Ellipsis={__class__:ellipsis,__bool__:function(){return True}};for(var $key in $B.$comps)switch($B.$comps[$key]){case"ge":case"gt":case"le":case"lt":ellipsis["__"+$B.$comps[$key]+"__"]=function(n){return function(o){throw _b_.TypeError.$factory("unorderable types: ellipsis() "+n+" "+$B.class_name(o))}}($key)}for(var $func in Ellipsis)"function"==typeof Ellipsis[$func]&&(Ellipsis[$func].__str__=function(o){return function(){return"<method-wrapper "+o+" of Ellipsis object>"}}($func));$B.set_func_names(ellipsis);var FunctionCode=$B.make_class("function code"),FunctionGlobals=$B.make_class("function globals");$B.Function={__class__:_b_.type,__code__:{__class__:FunctionCode,__name__:"function code"},__globals__:{__class__:FunctionGlobals,__name__:"function globals"},__mro__:[_b_.object],$infos:{__name__:"function",__module__:"builtins"},$is_class:!0},$B.Function.__delattr__=function(n,o){if("__dict__"==o)throw _b_.TypeError.$factory("can't deleted function __dict__")},$B.Function.__dir__=function(n){var l=n.$attrs||{};return Object.keys(n.$infos||{}).concat(Object.keys(l))},$B.Function.__eq__=function(n,o){return n===o},$B.Function.__get__=function(n,o){if(o===_b_.None)return n;var l=function(){return n(o,...arguments)};return l.__class__=$B.method,void 0===n.$infos&&(console.log("no $infos",n),console.log($B.last($B.frames_stack))),l.$infos={__name__:n.$infos.__name__,__qualname__:$B.class_name(o)+"."+n.$infos.__name__,__self__:o,__func__:n},l},$B.Function.__getattribute__=function(n,o){if(!n.$infos||void 0===n.$infos[o]){if(n.$infos&&n.$infos.__dict__&&void 0!==n.$infos.__dict__.$string_dict[o])return n.$infos.__dict__.$string_dict[o][0];if("__closure__"==o){var l=n.$infos.__code__.co_freevars;if(0==l.length)return None;for(var x=[],L=0;L<l.length;L++)try{x.push($B.cell.$factory($B.$check_def_free(l[L])))}catch{x.push($B.cell.$factory(None))}return _b_.tuple.$factory(x)}return"__globals__"==o?$B.obj_dict($B.imported[n.$infos.__module__]):n.$attrs&&void 0!==n.$attrs[o]?n.$attrs[o]:_b_.object.__getattribute__(n,o)}if("__code__"==o){var D={__class__:code};for(var o in n.$infos.__code__)D[o]=n.$infos.__code__[o];return D.name=n.$infos.__name__,D.filename=n.$infos.__code__.co_filename,D.co_code=n+"",D}return"__annotations__"==o?$B.obj_dict(n.$infos[o]):n.$infos.hasOwnProperty(o)?n.$infos[o]:void 0},$B.Function.__repr__=$B.Function.__str__=function(n){return void 0===n.$infos?"<function "+n.name+">":"<function "+n.$infos.__qualname__+">"},$B.Function.__mro__=[_b_.object],$B.Function.__setattr__=function(n,o,l){if("__closure__"==o)throw _b_.AttributeError.$factory("readonly attribute");if("__defaults__"==o){if(l===_b_.None)l=[];else if(!isinstance(l,_b_.tuple))throw _b_.TypeError.$factory("__defaults__ must be set to a tuple object");var x=n.$set_defaults;if(void 0===x||!n.$infos||!n.$infos.__code__)throw _b_.AttributeError.$factory("cannot set attribute "+o+" of "+_b_.str.$factory(n));for(var D=n.$infos.__code__.co_varnames.slice(0,n.$infos.__code__.co_argcount),z={},M=l.length-1;M>=0;M--){var P=D.length-l.length+M;if(P<0)break;z[D[P]]=l[M]}var de=n.$infos.$class,ye=x(z);return ye.$set_defaults=x,de?(de[n.$infos.__name__]=ye,ye.$infos.$class=de,ye.$infos.__defaults__=l):(n.$infos.$defaults=l,n.$infos.__defaults__=l),_b_.None}void 0!==n.$infos[o]?n.$infos[o]=l:(n.$attrs=n.$attrs||{},n.$attrs[o]=l)},$B.Function.$factory=function(){},$B.set_func_names($B.Function,"builtins"),_b_.__BRYTHON__=__BRYTHON__,$B.builtin_funcs=["abs","all","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dir","divmod","eval","exec","exit","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","locals","max","min","next","oct","open","ord","pow","print","quit","repr","round","setattr","sorted","sum","vars"];var builtin_function=$B.builtin_function=$B.make_class("builtin_function_or_method");builtin_function.__getattribute__=$B.Function.__getattribute__,builtin_function.__reduce_ex__=builtin_function.__reduce__=function(n){return n.$infos.__name__},builtin_function.__repr__=builtin_function.__str__=function(n){return"<built-in function "+n.$infos.__name__+">"},$B.set_func_names(builtin_function,"builtins");var method_wrapper=$B.make_class("method_wrapper");method_wrapper.__repr__=method_wrapper.__str__=function(n){return"<method wrapper '"+n.$infos.__name__+"' of function object>"},$B.set_func_names(method_wrapper,"builtins");var wrapper_descriptor=$B.wrapper_descriptor=$B.make_class("wrapper_descriptor");wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,wrapper_descriptor.__repr__=wrapper_descriptor.__str__=function(n){return"<slot wrapper '"+n.$infos.__name__+"' of '"+n.__objclass__.$infos.__name__+"' object>"},$B.set_func_names(wrapper_descriptor,"builtins"),$B.builtin_classes=["bool","bytearray","bytes","classmethod","complex","dict","enumerate","filter","float","frozenset","int","list","map","memoryview","object","property","range","reversed","set","slice","staticmethod","str","super","tuple","type","zip"];for(var other_builtins=["Ellipsis","False","None","True","__debug__","__import__","copyright","credits","license","NotImplemented"],builtin_names=$B.builtin_funcs.concat($B.builtin_classes).concat(other_builtins),i=0;i<builtin_names.length;i++){var name=builtin_names[i],orig_name=name,name1=name;"open"==name&&(name1="$url_open"),"super"==name&&(name=name1="$$super"),"eval"==name&&(name=name1="$$eval"),"print"==name&&(name1="$print");try{_b_[name]=eval(name1),$B.builtin_funcs.indexOf(orig_name)>-1&&(_b_[name].__class__=builtin_function,_b_[name].$infos={__module__:"builtins",__name__:orig_name,__qualname__:orig_name})}catch(n){}}_b_.open=$url_open,_b_.print=$print,_b_.$$super=$$super,_b_.object.__init__.__class__=wrapper_descriptor,_b_.object.__new__.__class__=builtin_function}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns),$B.del_exc=function(){$B.last($B.frames_stack)[1].$current_exception=void 0},$B.set_exc=function(n){var o=$B.last($B.frames_stack);void 0===o&&console.log("no frame",n),o[1].$current_exception=$B.exception(n)},$B.get_exc=function(){return $B.last($B.frames_stack)[1].$current_exception},$B.$raise=function(n){if(void 0===n){var o=$B.get_exc();throw void 0!==o?o:_b_.RuntimeError.$factory("No active exception to reraise")}throw isinstance(n,BaseException)?(n.__class__===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator&&(n=_b_.RuntimeError.$factory("generator raised StopIteration")),n):n.$is_class&&issubclass(n,BaseException)?n===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator?_b_.RuntimeError.$factory("generator raised StopIteration"):$B.$call(n)():_b_.TypeError.$factory("exceptions must derive from BaseException")},$B.$syntax_err_line=function(n,o,l,x,L){var D={},z=1;if(o="$"==o.charAt(0)?"<string>":o,void 0===l)n.$line_info=L+","+o,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,L,0,0]);else{for(var M={1:0},P=0,de=l.length;P<de;P++)D[P]=z,"\n"==l.charAt(P)&&(M[++z]=P);for(;void 0===L;)L=D[x],x--;n.$line_info=L+","+o;var ye=l.split("\n")[L-1],he=x-M[L];for(de=ye.length,n.text=ye,(he-=de-ye.length)<0&&(he=0);" "==ye.charAt(0);)ye=ye.substr(1),he>0&&he--;n.offset=he,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,L,he,ye])}n.lineno=L,n.msg=n.args[0],n.filename=o},$B.$SyntaxError=function(n,o,l,x,L,D){void 0!==D&&void 0!==D.line_info&&(L=D.line_info);var z=_b_.SyntaxError.$factory(o);throw $B.$syntax_err_line(z,n,l,x,L),z},$B.$IndentationError=function(n,o,l,x,L,D){$B.frames_stack.push([n,{$line_info:L+","+n},n,{$src:l}]),void 0!==D&&void 0!==D.line_info&&(L=D.line_info);var z=_b_.IndentationError.$factory(o);throw $B.$syntax_err_line(z,n,l,x,L),z},$B.print_stack=function(n){var o=[];return(n=n||$B.frames_stack).forEach(function(l){var x=l[1].$line_info;if(void 0!==x){var L=x.split(",");L[1].startsWith("$exec")&&(L[1]="<module>"),o.push(L[1]+" line "+L[0]);var D=$B.file_cache[l[3].__file__];if(D){var z=D.split("\n")[parseInt(L[0])-1];o.push("  "+z.trim())}}}),console.log("print stack ok",o),o.join("\n")};var traceback=$B.traceback=$B.make_class("traceback",function(n,o){return $B.last($B.frames_stack),void 0===o&&(o=n.$stack),{__class__:traceback,$stack:o,exc:n}});traceback.__getattribute__=function(n,o){var l;if("tb_frame"===o||"tb_lineno"===o||"tb_lasti"===o||"tb_next"===o){0==n.$stack.length&&console.log("no stack",o);var x=n.$stack[0];l=n.exc.$line_infos[n.exc.$line_infos.length-n.$stack.length]}switch(o){case"tb_frame":return frame.$factory(n.$stack);case"tb_lineno":return void 0===l||x[0].startsWith($B.lambda_magic)?x[4]&&x[4].$infos&&x[4].$infos.__code__?x[4].$infos.__code__.co_firstlineno:-1:parseInt(l.split(",")[0]);case"tb_lasti":if(void 0===l)return console.log("no line info",n.$stack),"";for(var L,D,z=l.split(","),M=n.$stack.length-1;M>=0;M--){var P=n.$stack[M];if(P[2]==z[1].replace(/\./g,"_")){D=P[3].__file__;break}}if(void 0===L&&($B.file_cache.hasOwnProperty(D)?L=$B.file_cache[D]:$B.imported[z[1]]&&$B.imported[z[1]].__file__&&(L=$B.file_cache[$B.imported[z[1]].__file__],console.log("from filecache",l,$B.imported[z[1]].__file__))),void 0===L)return console.log(D),console.log("no src for",z),"";try{return L.split("\n")[parseInt(z[0]-1)].trim()}catch(de){throw console.log("error in attr tb_lasti of",n),console.log(L,z),de}case"tb_next":return n.$stack.length<=1?None:traceback.$factory(n.exc,n.$stack.slice(1));default:return _b_.object.__getattribute__(n,o)}},$B.set_func_names(traceback,"builtins");var frame=$B.make_class("frame",function(n,o){var l=n,x={__class__:frame,f_builtins:{},$stack:n.slice()};if(void 0===o&&(o=0),x.$pos=o,l.length){var L,D=l[o],z=D[0];try{x.f_locals=$B.obj_dict(D[1])}catch(ye){throw console.log("err "+ye),ye}if(x.f_globals=$B.obj_dict(D[3]),void 0!==D[3].__file__&&(L=D[3].__file__),z.startsWith("$exec")&&(L="<string>"),void 0===D[1].$line_info)x.f_lineno=-1;else{var M=D[1].$line_info.split(",");x.f_lineno=parseInt(M[0]);var P=M[1];$B.imported.hasOwnProperty(P)&&(L=$B.imported[P].__file__),x.f_lineno=parseInt(D[1].$line_info.split(",")[0])}var de=z.startsWith("$exec")?"<module>":z;z==D[2]?de="<module>":z.startsWith("lc"+$B.lambda_magic)?de="<listcomp>":D[1].$name?de=D[1].$name:D[1].$dict_comp?de="<dictcomp>":D[1].$list_comp?de="<listcomp>":D.length>4&&(de=D[4].$infos?D[4].$infos.__name__:D[4].name,void 0===D[4].$infos?D[4].name.startsWith("__ge")?de="<genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?de="<setcomp>":D[4].name.startsWith("lambda"+$B.lambda_magic)&&(de="<lambda>"):void 0===L&&D[4].$infos.__code__&&(void 0===(L=D[4].$infos.__code__.co_filename)&&(L=D[4].$infos.__module__),x.f_lineno=D[4].$infos.__code__.co_firstlineno)),x.f_code=D.length>4&&void 0!==D[4].$infos?D[4].$infos.__code__:{co_name:de,co_filename:L},x.f_code.__class__=$B.code,x.f_code.co_code=_b_.None,void 0===L&&(x.f_code.co_filename="<string>")}return x});frame.__delattr__=function(n,o){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=_b_.None)},frame.__getattr__=function(n,o){if("f_back"==o)return n.$pos>0?frame.$factory(n.$stack.slice(0,n.$stack.length-1),n.$pos-1):_b_.None;if("clear"==o)return function(){};if("f_trace"==o){var l=$B.last(n.$stack)[1];return void 0===l.$f_trace?_b_.None:l.$f_trace}},frame.__setattr__=function(n,o,l){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=l)},frame.__str__=frame.__repr__=function(n){return"<frame object, file "+n.f_code.co_filename+", line "+n.f_lineno+", code "+n.f_code.co_name+">"},$B.set_func_names(frame,"builtins"),$B._frame=frame;var BaseException=_b_.BaseException={__class__:_b_.type,__bases__:[_b_.object],__mro__:[_b_.object],args:[],$infos:{__name__:"BaseException",__module__:"builtins"},$is_class:!0};BaseException.__init__=function(n){n.args=_b_.tuple.$factory(void 0===arguments[1]?[]:[arguments[1]])},BaseException.__repr__=function(n){var o=n.__class__.$infos.__name__;return n.args[0]&&(o+="("+repr(n.args[0])),n.args.length>1&&(o+=", "+repr($B.fast_tuple(n.args.slice(1)))),o+")"},BaseException.__str__=function(n){return n.args.length>0?_b_.str.$factory(n.args[0]):n.__class__.$infos.__name__},BaseException.__new__=function(n){var o=_b_.BaseException.$factory();return o.__class__=n,o.__dict__=$B.empty_dict(),o};var getExceptionTrace=function(n,o){if(void 0===n.__class__)return $B.debug>1&&console.log("no class",n),n+"";var l="";void 0!==n.$js_exc&&o&&(l+="\nJS stack:\n"+n.$js_exc.stack+"\n"),l+="Traceback (most recent call last):";for(var x=n.$line_info,L=0;L<n.$stack.length;L++){var D=n.$stack[L];if(D[1]&&D[1].$line_info){var z;if(x=D[1].$line_info.split(","),n.module==x[1]&&(z=n.src),!o&&void 0===(z=D[3].$src))if($B.VFS&&$B.VFS.hasOwnProperty(D[2]))z=$B.VFS[D[2]][1];else if(!(z=$B.file_cache[D[3].__file__]))continue;var M=D[3].__file__||"<string>",P=x[1],de="$"==P.charAt(0);if(de&&(P="<module>"),l+="\n  File "+M+" line "+x[0],D.length>4)if(D[4].$infos){var ye=D[4].$infos.__name__;ye.startsWith("lc"+$B.lambda_magic)?l+=",in <listcomp>":l+=", in "+ye}else D[4].name.startsWith("__ge")?l+=", in <genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?l+=", in <setcomp>":D[4].name.startsWith("lc"+$B.lambda_magic)?l+=", in <listcomp>":console.log("frame[4]",D[4]);else l+=D[1].$list_comp?", in <listcomp>":D[1].$dict_comp?", in <dictcomp>":", in <module>";if(void 0!==z&&!de){var he=z.split("\n")[parseInt(x[0])-1];he&&(he=he.replace(/^[ ]+/g,"")),l+="\n    "+he}}}return n.__class__===_b_.SyntaxError&&(l+="\n  File "+n.args[1]+", line "+n.args[2]+"\n    "+n.args[4]),l};BaseException.__getattr__=function(n,o){if("info"==o)return getExceptionTrace(n,!1);if("infoWithInternal"==o)return getExceptionTrace(n,!0);if("__traceback__"==o)return void 0!==n.$traceback?n.$traceback:traceback.$factory(n);throw _b_.AttributeError.$factory(n.__class__.$infos.__name__+" has no attribute '"+o+"'")},BaseException.with_traceback=function(n,o){return n.$traceback=o,n},$B.deep_copy=function(n){var o=[];for(const L of n){var l=[L[0],{},L[2],{}];void 0!==L[4]&&l.push(L[4]);for(const D of[1,3])for(var x in L[D])l[D][x]=L[D][x];o.push(l)}return o},$B.save_stack=function(){return $B.deep_copy($B.frames_stack)},$B.restore_stack=function(n,o){$B.frames_stack=n,$B.frames_stack[$B.frames_stack.length-1][1]=o},$B.freeze=function(n){if(void 0===n.$stack){n.$line_infos=[];for(var o=0,l=$B.frames_stack.length;o<l;o++)n.$line_infos.push($B.frames_stack[o][1].$line_info);n.$stack=$B.frames_stack.slice(),$B.frames_stack.length&&(n.$line_info=$B.last($B.frames_stack)[1].$line_info)}};var show_stack=$B.show_stack=function(n){n=n||$B.frames_stack;for(const o of n)console.log(o[0],o[1].$line_info)};function $make_exc(names,parent){for(var _str=[],pos=0,i=0;i<names.length;i++){var name=names[i],code="";if(Array.isArray(name))var code=name[1],name=name[0];$B.builtins_scope[name]=!0;var $exc=(BaseException.$factory+"").replace(/BaseException/g,name);$exc=$exc.replace("//placeholder//",code),_str[pos++]="_b_."+name+" = {__class__:_b_.type, __mro__: [_b_."+parent.$infos.__name__+"].concat(parent.__mro__), $is_class: true,$infos: {__name__:'"+name+"'}}",_str[pos++]="_b_."+name+".$factory = "+$exc,_str[pos++]="_b_."+name+'.$factory.$infos = {__name__: "'+name+'", __qualname__: "'+name+'"}',_str[pos++]="$B.set_func_names(_b_."+name+", 'builtins')"}try{eval(_str.join(";"))}catch(n){throw console.log("--err"+n),n}}BaseException.$factory=function(){var err=Error();return err.args=$B.fast_tuple(Array.prototype.slice.call(arguments)),err.__class__=_b_.BaseException,err.$py_error=!0,$B.freeze(err),eval("//placeholder//"),err.__cause__=_b_.None,err.__context__=_b_.None,err.__suppress_context__=!1,err},BaseException.$factory.$infos={__name__:"BaseException",__qualname__:"BaseException"},$B.set_func_names(BaseException),_b_.BaseException=BaseException,$B.exception=function(n,o){if(n.__class__){if($B.freeze(D=n),o)for(var l=$B.last($B.frames_stack)[0],x=0,L=D.$stack.length;x<L;x++)if(D.$stack[x][0]==l){D.$stack=D.$stack.slice(x),D.$traceback=traceback.$factory(D);break}}else{var D;if(console.log("Javascript exception:",n),console.log($B.last($B.frames_stack)),console.log("recursion error ?",$B.is_recursion_error(n)),(D=Error()).__name__="Internal Javascript error: "+(n.__name__||n.name),D.__class__=_b_.Exception,D.$js_exc=n,$B.is_recursion_error(n))return _b_.RecursionError.$factory("too much recursion");"ReferenceError"==n.name?(D.__name__="NameError",D.__class__=_b_.NameError,n.message=n.message.replace("$$","")):"InternalError"==n.name&&(D.__name__="RuntimeError",D.__class__=_b_.RuntimeError),D.__cause__=_b_.None,D.__context__=_b_.None,D.__suppress_context__=!1,D.args=_b_.tuple.$factory(["<Javascript "+n.name+">: "+(n.message||"<"+n+">")]),D.$py_error=!0,$B.freeze(D)}return D},$B.is_exc=function(n,o){void 0===n.__class__&&(n=$B.exception(n));for(var l=n.$is_class?n:n.__class__,x=0;x<o.length;x++){var L=o[x];if(void 0===l&&console.log("exc class undefined",n),issubclass(l,L))return!0}return!1},$B.is_recursion_error=function(n){console.log("test is js exc is recursion error",n,n+"");var o=(n+"").split(":"),l=o[0].trim(),x=o[1].trim();return"InternalError"==l&&"too much recursion"==x||"Error"==l&&"Out of stack space"==x||"RangeError"==l&&"Maximum call stack size exceeded"==x},$make_exc(["SystemExit","KeyboardInterrupt","GeneratorExit","Exception"],BaseException),$make_exc([["StopIteration","err.value = arguments[0]"],["StopAsyncIteration","err.value = arguments[0]"],"ArithmeticError","AssertionError","AttributeError","BufferError","EOFError",["ImportError","err.name = arguments[0]"],"LookupError","MemoryError","NameError","OSError","ReferenceError","RuntimeError",["SyntaxError","err.msg = arguments[0]"],"SystemError","TypeError","ValueError","Warning"],_b_.Exception),$make_exc(["FloatingPointError","OverflowError","ZeroDivisionError"],_b_.ArithmeticError),$make_exc([["ModuleNotFoundError","err.name = arguments[0]"]],_b_.ImportError),$make_exc(["IndexError","KeyError"],_b_.LookupError),$make_exc(["UnboundLocalError"],_b_.NameError),$make_exc(["BlockingIOError","ChildProcessError","ConnectionError","FileExistsError","FileNotFoundError","InterruptedError","IsADirectoryError","NotADirectoryError","PermissionError","ProcessLookupError","TimeoutError"],_b_.OSError),$make_exc(["BrokenPipeError","ConnectionAbortedError","ConnectionRefusedError","ConnectionResetError"],_b_.ConnectionError),$make_exc(["NotImplementedError","RecursionError"],_b_.RuntimeError),$make_exc(["IndentationError"],_b_.SyntaxError),$make_exc(["TabError"],_b_.IndentationError),$make_exc(["UnicodeError"],_b_.ValueError),$make_exc(["UnicodeDecodeError","UnicodeEncodeError","UnicodeTranslateError"],_b_.UnicodeError),$make_exc(["DeprecationWarning","PendingDeprecationWarning","RuntimeWarning","SyntaxWarning","UserWarning","FutureWarning","ImportWarning","UnicodeWarning","BytesWarning","ResourceWarning"],_b_.Warning),$make_exc(["EnvironmentError","IOError","VMSError","WindowsError"],_b_.OSError),$B.$TypeError=function(n){throw _b_.TypeError.$factory(n)};var se=_b_.SyntaxError.$factory;_b_.SyntaxError.$factory=function(){var n=arguments[0];if(n.__class__===_b_.SyntaxError)return n;var o=se.apply(null,arguments),l=$B.last($B.frames_stack);if(l){line_info=l[1].$line_info,o.filename=l[3].__file__,o.lineno=parseInt(line_info.split(",")[0]);var x=$B.file_cache[l[3].__file__];x&&(lines=x.split("\n"),o.text=lines[o.lineno-1]),o.offset=n.offset}return o},_b_}(__BRYTHON__),function(n){var o=n.builtins,l=o.None,x={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"range"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function L(P,de){var ye=x.__len__(P);return 0==ye?P.start:de>ye?P.stop:n.add(P.start,n.mul(P.step,de))}x.__contains__=function(P,de){if(0==x.__len__(P))return!1;try{de=n.int_or_bool(de)}catch{try{return x.index(P,de),!0}catch{return!1}}var ye=n.sub(de,P.start),he=n.floordiv(ye,P.step),ae=n.mul(P.step,he);return!!n.eq(ae,ye)&&(n.gt(P.stop,P.start)?n.ge(de,P.start)&&n.gt(P.stop,de):n.ge(P.start,de)&&n.gt(de,P.stop))},x.__delattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},x.__eq__=function(P,de){if(o.isinstance(de,x)){var ye=x.__len__(P);return!!n.eq(ye,x.__len__(de))&&(0==ye||!!n.eq(P.start,de.start)&&(1==ye||n.eq(P.step,de.step)))}return!1},x.__getitem__=function(P,de){if(o.isinstance(de,o.slice)){var ye=o.slice.$conv_for_seq(de,x.__len__(P)),he=n.mul(P.step,ye.step),ae=L(P,ye.start),fe=L(P,ye.stop);return x.$factory(ae,fe,he)}"number"!=typeof de&&(de=n.$GetInt(de)),n.gt(0,de)&&(de=n.add(de,x.__len__(P)));var le=n.add(P.start,n.mul(de,P.step));if(n.gt(P.step,0)&&(n.ge(le,P.stop)||n.gt(P.start,le))||n.gt(0,P.step)&&(n.ge(P.stop,le)||n.gt(le,P.start)))throw o.IndexError.$factory("range object index out of range");return le},x.__hash__=function(P){var de=x.__len__(P);return o.hash(o.tuple.$factory(0==de?[0,l,l]:1==de?[1,P.start,l]:[de,P.start,P.step]))};var D={__class__:o.type,__mro__:[o.object],__iter__:function(P){return P},__next__:function(P){return o.next(P.obj)},$infos:{__name__:"range_iterator",__module__:"builtins"},$is_class:!0,$factory:function(P){return{__class__:D,obj:P}}};n.set_func_names(D,"builtins"),x.__iter__=function(P){var de={__class__:x,start:P.start,stop:P.stop,step:P.step};return de.$counter=P.$safe?P.start-P.step:n.sub(P.start,P.step),D.$factory(de)},x.__len__=function(P){var de;if(n.gt(P.step,0)){if(n.ge(P.start,P.stop))return 0;var ye=n.sub(P.stop,n.add(1,P.start)),he=n.floordiv(ye,P.step);de=n.add(1,he)}else{if(n.ge(P.stop,P.start))return 0;ye=n.sub(P.start,n.add(1,P.stop)),he=n.floordiv(ye,n.mul(-1,P.step)),de=n.add(1,he)}return void 0===n.maxsize&&(n.maxsize=n.long_int.__pow__(n.long_int.$factory(2),63),n.maxsize=n.long_int.__sub__(n.maxsize,1)),de},x.__next__=function(P){if(P.$safe){if(P.$counter+=P.step,P.step>0&&P.$counter>=P.stop||P.step<0&&P.$counter<=P.stop)throw o.StopIteration.$factory("")}else if(P.$counter=n.add(P.$counter,P.step),n.gt(P.step,0)&&n.ge(P.$counter,P.stop)||n.gt(0,P.step)&&n.ge(P.stop,P.$counter))throw o.StopIteration.$factory("");return P.$counter},x.__reversed__=function(P){var de=n.sub(x.__len__(P),1);return x.$factory(n.add(P.start,n.mul(de,P.step)),n.sub(P.start,P.step),n.mul(-1,P.step))},x.__repr__=x.__str__=function(P){var de="range("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop);return 1!=P.step&&(de+=", "+o.str.$factory(P.step)),de+")"},x.__setattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},x.start=function(P){return P.start},x.step=function(P){return P.step},x.stop=function(P){return P.stop},x.count=function(P,de){if(o.isinstance(de,[o.int,o.float,o.bool]))return o.int.$factory(x.__contains__(P,de));for(var ye=x.__iter__(P),he=D.__next__,ae=0;;)try{fe=he(ye),n.rich_comp("__eq__",de,fe)&&ae++}catch(le){if(o.isinstance(le,o.StopIteration))return ae;throw le}var fe},x.index=function(P,de){var ye,he=n.args("index",2,{self:null,other:null},["self","other"],arguments,{},null,null);P=he.self,de=he.other;try{de=n.int_or_bool(de)}catch{for(var ae=x.__iter__(P),fe=D.__next__,le=0;;)try{if(ye=fe(ae),n.rich_comp("__eq__",de,ye))return le;le++}catch(X){throw o.isinstance(X,o.StopIteration)?o.ValueError.$factory(o.str.$factory(de)+" not in range"):X}}var q=n.sub(de,P.start),Y=n.floordiv(q,P.step),A=n.mul(P.step,Y);if(n.eq(A,q)){if(n.gt(P.stop,P.start)&&n.ge(de,P.start)&&n.gt(P.stop,de)||n.ge(P.start,P.stop)&&n.ge(P.start,de)&&n.gt(de,P.stop))return Y;throw o.ValueError.$factory(o.str.$factory(de)+" not in range")}throw o.ValueError.$factory(o.str.$factory(de)+" not in range")},x.$factory=function(){var P=n.args("range",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{start:null,stop:null,step:null},null,null),de=P.start,ye=P.stop,he=P.step;if(null===ye&&null===he){if(null==de)throw o.TypeError.$factory("range expected 1 arguments, got 0");return ye=n.PyNumber_Index(de),{__class__:x,start:0,stop:ye,step:1,$is_range:!0,$safe:"number"==typeof ye}}if(null===he&&(he=1),de=n.PyNumber_Index(de),ye=n.PyNumber_Index(ye),0==(he=n.PyNumber_Index(he)))throw o.ValueError.$factory("range arg 3 must not be zero");return{__class__:x,start:de,stop:ye,step:he,$is_range:!0,$safe:"number"==typeof de&&"number"==typeof ye&&"number"==typeof he}},n.set_func_names(x,"builtins");var z={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"slice"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function M(P){for(var de=["start","stop","step"],ye=[],he=0;he<de.length;he++){var ae=P[de[he]];if(ae===o.None)ye.push(ae);else try{ye.push(n.PyNumber_Index(ae))}catch{throw o.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}}return ye}z.__eq__=function(P,de){var ye=M(P),he=M(de);return ye[0]==he[0]&&ye[1]==he[1]&&ye[2]==he[2]},z.__repr__=z.__str__=function(P){return"slice("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop)+", "+o.str.$factory(P.step)+")"},z.__setattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},z.$conv_for_seq=function(P,de){var ye,he=P.step===l?1:n.PyNumber_Index(P.step),ae=n.gt(0,he),fe=n.sub(de,1);if(0==he)throw o.ValueError.$factory("slice step cannot be zero");return P.start===l?ye=ae?fe:0:(ye=n.PyNumber_Index(P.start),n.gt(0,ye)&&(ye=n.add(ye,de),n.gt(0,ye)&&(ye=0)),n.ge(ye,de)&&(ye=he<0?fe:de)),P.stop===l?stop=ae?-1:de:(stop=n.PyNumber_Index(P.stop),n.gt(0,stop)&&(stop=n.add(stop,de)),n.ge(stop,de)&&(stop=ae?fe:de)),{start:ye,stop,step:he}},z.start=function(P){return P.start},z.step=function(P){return P.step},z.stop=function(P){return P.stop},z.indices=function(P,de){var ye=n.args("indices",2,{self:null,length:null},["self","length"],arguments,{},null,null),he=n.$GetInt(ye.length);he<0&&o.ValueError.$factory("length should not be negative");var ae=P.step==o.None?1:P.step;if(ae<0){var fe=P.start,le=P.stop;fe=fe==o.None?he-1:fe<0?o.max(-1,fe+he):o.min(he-1,P.start),le=P.stop==o.None?-1:le<0?o.max(-1,le+he):o.min(he-1,P.stop)}else fe=P.start==o.None?0:o.min(he,P.start),le=P.stop==o.None?he:o.min(he,P.stop),fe<0&&(fe=o.max(0,fe+he)),le<0&&(le=o.max(0,le+he));return o.tuple.$factory([fe,le,ae])},z.$factory=function(){var P,de,ye,he=n.args("slice",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{stop:null,step:null},null,null);null===he.stop&&null===he.step?(P=o.None,de=he.start,ye=o.None):(P=he.start,de=he.stop,ye=null===he.step?o.None:he.step);var ae={__class__:z,start:P,stop:de,step:ye};return M(ae),ae},n.set_func_names(z,"builtins"),o.range=x,o.slice=z}(__BRYTHON__),function(n){var o=n.builtins,l={},x={};function L(q,Y,A){if(void 0===Y){Y=[];for(var N="\r\n \t",X=0,oe=N.length;X<oe;X++)Y.push(N.charCodeAt(X))}else{if(!o.isinstance(Y,P))throw o.TypeError.$factory("Type str doesn't support the buffer API");Y=Y.source}if("l"==A){for(X=0,oe=q.source.length;X<oe&&-1!=Y.indexOf(q.source[X]);X++);return P.$factory(q.source.slice(X))}for(X=q.source.length-1;X>=0&&-1!=Y.indexOf(q.source[X]);X--);return P.$factory(q.source.slice(0,X+1))}function D(q){return!o.isinstance(q,[P,z])}n.to_bytes=function(q){var Y;if(o.isinstance(q,[P,z]))Y=q.source;else{var A=n.$getattr(q,"tobytes",null);if(null===A)throw o.TypeError.$factory("object doesn't support the buffer protocol");Y=n.$call(A)().source}return Y};var z={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytearray"},$is_class:!0};["__delitem__","clear","copy","count","index","pop","remove","reverse","sort"].forEach(function(q){var Y;z[q]=(Y=q,function(A){for(var N=[A.source],X=1,oe=1,H=arguments.length;oe<H;oe++)N[X++]=arguments[oe];return o.list[Y].apply(null,N)})});var M=n.make_iterator_class("bytearray_iterator");z.__iter__=function(q){return M.$factory(q.source)},z.__mro__=[o.object],z.__repr__=z.__str__=function(q){return"bytearray("+P.__repr__(q)+")"},z.__setitem__=function(q,Y,A){if(o.isinstance(Y,o.int)){if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");var N=Y;if(Y<0&&(N=q.source.length+N),!(N>=0&&N<q.source.length))throw o.IndexError.$factory("list index out of range");q.source[N]=A}else{if(!o.isinstance(Y,o.slice))throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(Y));var X=Y.start===o.None?0:Y.start,oe=Y.stop===o.None?q.source.length:Y.stop;X<0&&(X=q.source.length+X),oe<0&&(oe=q.source.length+oe),q.source.splice(X,oe-X);try{for(var H=o.list.$factory(A),Ce=H.length-1;Ce>=0;Ce--){if(!o.isinstance(H[Ce],o.int))throw o.TypeError.$factory("an integer is required");if(H[Ce]>255)throw ValueError.$factory("byte must be in range(0, 256)");q.source.splice(X,0,H[Ce])}}catch{throw o.TypeError.$factory("can only assign an iterable")}}},z.append=function(q,Y){if(2!=arguments.length)throw o.TypeError.$factory("append takes exactly one argument ("+(arguments.length-1)+" given)");if(!o.isinstance(Y,o.int))throw o.TypeError.$factory("an integer is required");if(Y>255)throw ValueError.$factory("byte must be in range(0, 256)");q.source[q.source.length]=Y},z.extend=function(q,Y){if(Y.__class__===z||Y.__class__===P)return Y.source.forEach(function(N){q.source.push(N)}),o.None;for(var A=o.iter(Y);;)try{z.__add__(q,o.next(A))}catch(N){if(N===o.StopIteration)break;throw N}return o.None},z.insert=function(q,Y,A){if(3!=arguments.length)throw o.TypeError.$factory("insert takes exactly 2 arguments ("+(arguments.length-1)+" given)");if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw ValueError.$factory("byte must be in range(0, 256)");o.list.insert(q.source,Y,A)},z.$factory=function(){for(var q=[z],Y=0,A=arguments.length;Y<A;Y++)q.push(arguments[Y]);return z.__new__.apply(null,q)};var P={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytes"},$is_class:!0,__add__:function(q,Y){if(o.isinstance(Y,P))return q.__class__.$factory(q.source.concat(Y.source));if(o.isinstance(Y,z))return q.__class__.$factory(P.__add__(q,P.$factory(Y)));if(o.isinstance(Y,o.memoryview))return q.__class__.$factory(P.__add__(q,o.memoryview.tobytes(Y)));throw o.TypeError.$factory("can't concat bytes to "+o.str.$factory(Y))},__contains__:function(q,Y){if("number"==typeof Y)return q.source.indexOf(Y)>-1;if(q.source.length<Y.source.length)return!1;for(var A=Y.source.length,N=0;N<q.source.length-Y.source.length+1;N++){for(var X=!0,oe=0;oe<A;oe++)if(Y.source[N+oe]!=q.source[oe]){X=!1;break}if(X)return!0}return!1}},de=n.make_iterator_class("bytes_iterator");function ye(q,Y,A){throw o.UnicodeEncodeError.$factory("'"+q+"' codec can't encode character "+o.hex(Y)+" in position "+A)}function he(q){var Y=q.toLowerCase();return"windows"==Y.substr(0,7)&&(Y="cp"+Y.substr(7)),(Y.startsWith("cp")||Y.startsWith("iso"))&&(Y=Y.replace("-","")),Y.replace(/-/g,"_")}P.__iter__=function(q){return de.$factory(q.source)},P.__eq__=function(q,Y){return!D(Y)&&n.$getattr(q.source,"__eq__")(Y.source)},P.__ge__=function(q,Y){return D(Y)?o.NotImplemented:o.list.__ge__(q.source,Y.source)},P.__getitem__=function(q,Y){if(o.isinstance(Y,o.int)){var A=Y;if(Y<0&&(A=q.source.length+A),A>=0&&A<q.source.length)return q.source[A];throw o.IndexError.$factory("index out of range")}if(o.isinstance(Y,o.slice)){var N=o.slice.$conv_for_seq(Y,q.source.length),X=N.start,oe=N.stop,H=N.step,Ce=[],Q=null;if(A=0,H>0){if((oe=Math.min(oe,q.source.length))<=X)return P.$factory([]);for(Q=X;Q<oe;Q+=H)Ce[A++]=q.source[Q]}else{if(oe>=X)return P.$factory([]);for(oe=Math.max(0,oe),Q=X;Q>=oe;Q+=H)Ce[A++]=q.source[Q]}return P.$factory(Ce)}if(o.isinstance(Y,o.bool))return q.source.__getitem__(o.int.$factory(Y))},P.__gt__=function(q,Y){return D(Y)?o.NotImplemented:o.list.__gt__(q.source,Y.source)},P.__hash__=function(q){if(void 0===q)return P.__hashvalue__||n.$py_next_hash--;for(var Y=1,A=0,N=q.source.length;A<N;A++)Y=101*Y+q.source[A]&4294967295;return Y},P.__init__=function(){return o.None},P.__le__=function(q,Y){return D(Y)?o.NotImplemented:o.list.__le__(q.source,Y.source)},P.__len__=function(q){return q.source.length},P.__lt__=function(q,Y){return D(Y)?o.NotImplemented:o.list.__lt__(q.source,Y.source)},P.__mod__=function(q,Y){var A=ae(q,"ascii","strict"),N=o.str.__mod__(A,Y);return o.str.encode(N,"ascii")},P.__mul__=function(){for(var q=n.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null),Y=n.PyNumber_Index(q.other),A=[],N=q.self.source,X=N.length,oe=0;oe<Y;oe++)for(var H=0;H<X;H++)A.push(N[H]);var Ce=P.$factory();return Ce.source=A,Ce},P.__ne__=function(q,Y){return!P.__eq__(q,Y)},P.__new__=function(q,Y,A,N){var X=n.args("__new__",4,{cls:null,source:null,encoding:null,errors:null},["cls","source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(X.cls,X.source,X.encoding,X.errors)},P.$new=function(q,Y,A,N){var X={__class__:q},oe=[],H=0;if(void 0!==Y)if("number"==typeof Y||o.isinstance(Y,o.int))for(var Ce=Y;Ce--;)oe[H++]=0;else if("string"==typeof Y||o.isinstance(Y,o.str)){if(void 0===A)throw o.TypeError.$factory("string argument without an encoding");oe=fe(Y,A||"utf-8",N||"strict")}else for(oe=o.list.$factory(Y),Ce=0;Ce<oe.length;Ce++){try{var Q=o.int.$factory(oe[Ce])}catch{throw o.TypeError.$factory("'"+n.class_name(oe[Ce])+"' object cannot be interpreted as an integer")}if(Q<0||Q>255)throw o.ValueError.$factory("bytes must be in range(0, 256)")}return X.source=oe,X.encoding=A,X.errors=N,X},P.__repr__=P.__str__=function(q){for(var Y="",A=0,N=q.source.length;A<N;A++){var X=q.source[A];if(10==X)Y+="\\n";else if(X<32||X>=128){var oe=X.toString(16);Y+="\\x"+(oe=(1==oe.length?"0":"")+oe)}else X=="\\".charCodeAt(0)?Y+="\\\\":Y+=String.fromCharCode(X)}return Y.indexOf("'")>-1&&-1==Y.indexOf('"')?'b"'+Y+'"':"b'"+Y.replace(new RegExp("'","g"),"\\'")+"'"},P.__reduce_ex__=function(q){return P.__repr__(q)},P.capitalize=function(q){var Y=q.source,A=Y.length,N=Y.slice();N[0]>96&&N[0]<123&&(N[0]-=32);for(var X=1;X<A;++X)N[X]>64&&N[X]<91&&(N[X]+=32);return P.$factory(N)},P.center=function(){var q=n.args("center",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null),Y=q.width-q.self.source.length;if(Y<=0)return P.$factory(q.self.source);var A=P.ljust(q.self,q.self.source.length+Math.floor(Y/2),q.fillbyte);return P.rjust(A,q.width,q.fillbyte)},P.count=function(){var q=n.args("count",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Y=0,A=-1,N=0;if("number"==typeof q.sub){if(q.sub<0||q.sub>255)throw o.ValueError.$factory("byte must be in range(0, 256)");N=1}else{if(!q.sub.__class__||!q.sub.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(q.sub)+"'");N=q.sub.source.length}do{-1!=(A=P.find(q.self,q.sub,Math.max(A+N,q.start),q.end))&&Y++}while(-1!=A);return Y},P.decode=function(q,Y,A){var N=n.args("decode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);switch(N.errors){case"strict":case"ignore":case"replace":case"surrogateescape":case"surrogatepass":case"xmlcharrefreplace":case"backslashreplace":return ae(N.self,N.encoding,N.errors)}},P.endswith=function(){var q=n.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:-1,end:-1},null,null);if(o.isinstance(q.suffix,P)){for(var Y=-1==q.start?q.self.source.length-q.suffix.source.length:Math.min(q.self.source.length-q.suffix.source.length,q.start),A=-1==q.end?-1==q.start?q.self.source.length:Y+q.suffix.source.length:Math.min(q.self.source.length-1,q.end),N=!0,X=q.suffix.source.length-1,oe=q.suffix.source.length;X>=0&&N;--X)N=q.self.source[A-oe+X]==q.suffix.source[X];return N}if(o.isinstance(q.suffix,o.tuple)){for(X=0;X<q.suffix.length;++X){if(!o.isinstance(q.suffix[X],P))throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(q.suffix));if(P.endswith(q.self,q.suffix[X],q.start,q.end))return!0}return!1}throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(q.suffix))},P.expandtabs=function(){var q=n.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),Y=[];for(let N=0;N<q.tabsize;++N)Y.push(32);var A=q.self.source.slice();for(let N=0;N<A.length;++N)9===A[N]&&A.splice.apply(A,[N,1].concat(Y));return o.bytes.$factory(A)},P.find=function(q,Y){if(2!=arguments.length)var A=n.args("find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),N=(Y=A.sub,A.start),X=A.end;else N=0,X=-1;if("number"==typeof Y){if(Y<0||Y>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return q.source.slice(0,-1==X?void 0:X).indexOf(Y,N)}if(!Y.__class__||!Y.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(Y)+"'");X=-1==X?q.source.length:Math.min(q.source.length,X);for(var oe=Y.source.length,H=N;H<=X-oe;H++){for(var Ce=q.source.slice(H,H+oe),Q=!0,xe=0;xe<oe;xe++)if(Ce[xe]!=Y.source[xe]){Q=!1;break}if(Q)return H}return-1},P.fromhex=function(){for(var q=n.args("fromhex",2,{cls:null,string:null},["cls","string"],arguments,{},null,null),Y=q.string.replace(/\s/g,""),A=[],N=0;N<Y.length;N+=2){if(N+2>Y.length)throw o.ValueError.$factory("non-hexadecimal number found in fromhex() arg");A.push(o.int.$factory(Y.substr(N,2),16))}return q.cls.$factory(A)},P.hex=function(){for(var q=n.args("hex",1,{self:null},["self"],arguments,{},null,null).self,Y="",A=0,N=q.source.length;A<N;A++){var X=q.source[A].toString(16);X.length<2&&(X="0"+X),Y+=X}return Y},P.index=function(){var q=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Y=P.find(q.self,q.sub,q.start,q.end);if(-1==Y)throw o.ValueError.$factory("subsection not found");return Y},P.isalnum=function(q){for(var Y=q.source,A=Y.length,N=A>0,X=0;X<A&&N;++X)N=Y[X]>96&&Y[X]<123||Y[X]>64&&Y[X]<91||Y[X]>47&&Y[X]<58;return N},P.isalpha=function(q){for(var Y=q.source,A=Y.length,N=A>0,X=0;X<A&&N;++X)N=Y[X]>96&&Y[X]<123||Y[X]>64&&Y[X]<91;return N},P.isdigit=function(q){var Y=q.source,A=Y.length,N=A>0;for(let X=0;X<A&&N;++X)N=Y[X]>47&&Y[X]<58;return N},P.islower=function(q){var Y=q.source,A=Y.length,N=!1;for(let X=0;X<A;++X)if(N=N||Y[X]>96&&Y[X]<123,Y[X]>64&&Y[X]<91)return!1;return N},P.isspace=function(q){var Y=q.source,A=Y.length;for(let N=0;N<A;++N)switch(Y[N]){case 9:case 10:case 11:case 12:case 13:case 32:break;default:return!1}return!0},P.isupper=function(q){var Y=q.source,A=Y.length,N=!1;for(let X=0;X<A;++X)if(N=N||Y[X]>64&&Y[X]<91,Y[X]>96&&Y[X]<123)return!1;return N},P.istitle=function(q){for(var Y=q.source,A=Y.length,N=!1,X=!1,oe=!1,H=!1,Ce=0;Ce<A;++Ce){if(oe=Y[Ce]>64&&Y[Ce]<91,(N=(H=Y[Ce]>96&&Y[Ce]<123)||oe)&&X&&oe||!X&&H)return!1;X=N}return!0},P.join=function(){for(var q=n.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{}),Y=q.self,N=n.$getattr(o.iter(q.iterable),"__next__"),X=Y.__class__.$factory(),oe=!0;;)try{var H=N();oe?oe=!1:X=P.__add__(X,Y),X=P.__add__(X,H)}catch(Ce){if(o.isinstance(Ce,o.StopIteration))break;throw Ce}return X},P.lower=function(q){for(var Y,A=[],N=0,X=0,oe=q.source.length;X<oe;X++)q.source[X]&&(A[N++]=(Y=q.source[X])>=65&&Y<=90?Y+32:Y);return P.$factory(A)},P.ljust=function(){var q=n.args("ljust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!q.fillbyte.__class__||!q.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(q.fillbyte)+"'");for(var Y=[],A=q.width-q.self.source.length,N=0;N<A;++N)Y.push(q.fillbyte.source[0]);return P.$factory(q.self.source.concat(Y))},P.lstrip=function(q,Y){return L(q,Y,"l")},P.maketrans=function(q,Y){for(var A=[],N=(Y=n.to_bytes(Y),0);N<256;N++)A[N]=N;N=0;for(var X=q.source.length;N<X;N++)A[q.source[N]]=Y[N];return P.$factory(A)},P.partition=function(){var q=n.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!q.sep.__class__||!q.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(q.sep)+"'");var Y=q.sep.source.length,A=q.self.source,N=P.find(q.self,q.sep);return o.tuple.$factory([P.$factory(A.slice(0,N)),P.$factory(A.slice(N,N+Y)),P.$factory(A.slice(N+Y))])},P.removeprefix=function(){var q=n.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!o.isinstance(q.prefix,[P,z]))throw o.ValueError.$factory(`prefix should be bytes, not '${n.class_name(q.prefix)}'`);return P.startswith(q.self,q.prefix)?P.__getitem__(q.self,o.slice.$factory(q.prefix.source.length,o.None)):P.__getitem__(q.self,o.slice.$factory(0,o.None))},P.removesuffix=function(){var q=n.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!o.isinstance(q.suffix,[P,z]))throw o.ValueError.$factory(`suffix should be bytes, not '${n.class_name(q.suffix)}'`);return P.endswith(q.self,q.suffix)?P.__getitem__(q.self,o.slice.$factory(0,q.suffix.source.length+1)):P.__getitem__(q.self,o.slice.$factory(0,o.None))},P.replace=function(){var q=n.args("replace",4,{self:null,old:null,new:null,count:null},["self","old","new","count"],arguments,{count:-1},null,null),Y=[],A=q.self,N=A.source,X=N.length,oe=q.old,H=q.new,Ce=q.count>=0?q.count:N.length;if(!q.old.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(q.old)+"'");if(!q.old.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(q.sep)+"'");if(!q.new.__class__)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(q.old)+"'");if(!q.new.__class__.$buffer_protocol)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(q.sep)+"'");for(var Q=0;Q<X;Q++)if(P.startswith(A,oe,Q)&&Ce){for(var xe=0;xe<H.source.length;xe++)Y.push(H.source[xe]);Q+=oe.source.length-1,Ce--}else Y.push(N[Q]);return P.$factory(Y)},P.rfind=function(q,Y){if(2==arguments.length&&Y.__class__===P)var A=Y,N=0,X=-1;else{var oe=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null);q=oe.self,A=oe.sub,N=oe.start,X=oe.end}if("number"==typeof A){if(A<0||A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return oe.self.source.slice(N,-1==oe.end?void 0:oe.end).lastIndexOf(A)+N}if(!A.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(oe.sub)+"'");if(!A.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(A)+"'");X=-1==X?q.source.length:Math.min(q.source.length,X);for(var H=A.source.length,Ce=X-H;Ce>=N;--Ce){for(var Q=q.source.slice(Ce,Ce+H),xe=!0,Pe=0;Pe<H;Pe++)if(Q[Pe]!=A.source[Pe]){xe=!1;break}if(xe)return Ce}return-1},P.rindex=function(){var q=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Y=P.rfind(q.self,q.sub,q.start,q.end);if(-1==Y)throw o.ValueError.$factory("subsection not found");return Y},P.rjust=function(){var q=n.args("rjust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!q.fillbyte.__class__||!q.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(q.fillbyte)+"'");for(var Y=[],A=q.width-q.self.source.length,N=0;N<A;++N)Y.push(q.fillbyte.source[0]);return P.$factory(Y.concat(q.self.source))},P.rpartition=function(){var q=n.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!q.sep.__class__||!q.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(q.sep)+"'");var Y=q.sep.source.length,A=q.self.source,N=P.rfind(q.self,q.sep);return o.tuple.$factory([P.$factory(A.slice(0,N)),P.$factory(A.slice(N,N+Y)),P.$factory(A.slice(N+Y))])},P.rstrip=function(q,Y){return L(q,Y,"r")},P.split=function(){var q=n.args("split",2,{self:null,sep:null},["self","sep"],arguments,{},null,null),Y=[],A=0,N=0;if(!q.sep.__class__||!q.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(q.sep)+"'");for(var X=q.sep.source,oe=X.length,H=q.self.source,Ce=H.length;N<Ce;){for(var Q=!0,xe=0;xe<oe&&Q;xe++)H[N+xe]!=X[xe]&&(Q=!1);Q?(Y.push(P.$factory(H.slice(A,N))),N=A=N+oe):N++}return(Q||N>A)&&Y.push(P.$factory(H.slice(A,N))),Y},P.splitlines=function(q){var Y=n.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!o.isinstance(Y.keepends,[o.bool,o.int]))throw o.TypeError("integer argument expected, got "+n.get_class(Y.keepends).__name);var A=o.int.$factory(Y.keepends),N=[],X=Y.self.source,oe=0,H=0;if(!X.length)return N;for(;H<X.length;)H<X.length-1&&13==X[H]&&10==X[H+1]?(N.push(P.$factory(X.slice(oe,A?H+2:H))),oe=H+=2):13==X[H]||10==X[H]?(N.push(P.$factory(X.slice(oe,A?H+1:H))),oe=H+=1):H++;return oe<X.length&&N.push(P.$factory(X.slice(oe))),N},P.startswith=function(){var q=n.args("startswith",3,{self:null,prefix:null,start:null},["self","prefix","start"],arguments,{start:0},null,null),Y=q.start;if(o.isinstance(q.prefix,P)){for(var A=!0,N=0;N<q.prefix.source.length&&A;N++)A=q.self.source[Y+N]==q.prefix.source[N];return A}if(o.isinstance(q.prefix,o.tuple)){var X=[];for(N=0;N<q.prefix.length;N++){if(!o.isinstance(q.prefix[N],P))throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(q.prefix));X=X.concat(q.prefix[N].source)}var oe=P.$factory(X);return P.startswith(q.self,oe,Y)}throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(q.prefix))},P.strip=function(q,Y){var A=P.lstrip(q,Y);return P.rstrip(A,Y)},P.swapcase=function(q){for(var Y=q.source,A=Y.length,N=Y.slice(),X=0;X<A;++X)N[X]>96&&N[X]<123?N[X]-=32:N[X]>64&&N[X]<91&&(N[X]+=32);return P.$factory(N)},P.title=function(q){var Y=q.source,A=Y.length;buffer=Y.slice(),current_char_is_letter=!1,prev_char_was_letter=!1,is_uppercase=!1,is_lowercase=!1;for(var N=0;N<A;++N)is_lowercase=buffer[N]>96&&buffer[N]<123,is_uppercase=buffer[N]>64&&buffer[N]<91,current_char_is_letter=is_lowercase||is_uppercase,current_char_is_letter&&(prev_char_was_letter&&is_uppercase?buffer[N]+=32:!prev_char_was_letter&&is_lowercase&&(buffer[N]-=32)),prev_char_was_letter=current_char_is_letter;return P.$factory(buffer)},P.translate=function(q,Y,A){if(void 0===A)A=[];else{if(!o.isinstance(A,P))throw o.TypeError.$factory("Type "+n.get_class(A).__name+" doesn't support the buffer API");A=A.source}var N=[],X=0;if(o.isinstance(Y,P)&&256==Y.source.length)for(var oe=0,H=q.source.length;oe<H;oe++)A.indexOf(q.source[oe])>-1||(N[X++]=Y.source[q.source[oe]]);return P.$factory(N)},P.upper=function(q){for(var Y,A=[],N=0,X=0,oe=q.source.length;X<oe;X++)q.source[X]&&(A[N++]=(Y=q.source[X])>=97&&Y<=122?Y-32:Y);return P.$factory(A)},P.zfill=function(q,Y){for(var A=q.source.slice(),N=43==A[0]||45==A[0]?1:0,X=Y-q.source.length,oe=[],H=0;H<X;++H)oe.push(48);return A.splice.apply(A,[N,0].concat(oe)),P.$factory(A)};var ae=n.decode=function(q,Y,A){var N="",X=q.source,oe=he(Y),H=!1;switch(oe){case"utf_8":case"utf-8":case"utf8":case"U8":case"UTF":var Ce,Q=0;for(N="";Q<X.length;){var xe=X[Q];if(Ce=null,128&xe)if(xe>>5==6)if(void 0===X[Q+1]?Ce=[xe,Q,"end"]:128!=(192&X[Q+1])&&(Ce=[xe,Q,"continuation"]),null!==Ce){if("ignore"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Ce[0].toString(16)+"  in position "+Ce[1]+("end"==Ce[2]?": unexpected end of data":": invalid continuation byte"));Q++}else{var Pe=31&xe;Pe<<=6,Pe+=63&X[Q+1],N+=String.fromCodePoint(Pe),Q+=2}else if(xe>>4==14)if(void 0===X[Q+1]?Ce=[xe,Q,"end",Q+1]:128!=(192&X[Q+1])?Ce=[xe,Q,"continuation",Q+2]:void 0===X[Q+2]?Ce=[xe,Q+"-"+(Q+1),"end",Q+2]:128!=(192&X[Q+2])&&(Ce=[xe,Q,"continuation",Q+3]),null!==Ce)if("ignore"==A)Q=Ce[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Ce[0].toString(16)+"  in position "+Ce[1]+("end"==Ce[2]?": unexpected end of data":": invalid continuation byte"));for(var Ge=Q;Ge<Ce[3];Ge++)N+=String.fromCodePoint(56448+X[Ge]-128);Q=Ce[3]}else Pe=15&xe,Pe<<=12,Pe+=(63&X[Q+1])<<6,Pe+=63&X[Q+2],N+=String.fromCodePoint(Pe),Q+=3;else if(xe>>3==30)if(H=!0,void 0===X[Q+1]?Ce=[xe,Q,"end",Q+1]:128!=(192&X[Q+1])?Ce=[xe,Q,"continuation",Q+2]:void 0===X[Q+2]?Ce=[xe,Q+"-"+(Q+1),"end",Q+2]:128!=(192&X[Q+2])?Ce=[xe,Q,"continuation",Q+3]:void 0===X[Q+3]?Ce=[xe,Q+"-"+(Q+1)+"-"+(Q+2),"end",Q+3]:128!=(192&X[Q+2])&&(Ce=[xe,Q,"continuation",Q+3]),null!==Ce)if("ignore"==A)Q=Ce[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Ce[0].toString(16)+"  in position "+Ce[1]+("end"==Ce[2]?": unexpected end of data":": invalid continuation byte"));for(Ge=Q;Ge<Ce[3];Ge++)N+=String.fromCodePoint(56448+X[Ge]-128);Q=Ce[3]}else Pe=15&xe,Pe<<=18,Pe+=(63&X[Q+1])<<12,Pe+=(63&X[Q+2])<<6,Pe+=63&X[Q+3],N+=String.fromCodePoint(Pe),Q+=4;else if("ignore"==A)Q++;else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+xe.toString(16)+" in position "+Q+": invalid start byte");N+=String.fromCodePoint(56448+X[Q]-128),Q++}else N+=String.fromCodePoint(xe),Q++}return H?o.str.$surrogate.$factory(N):N;case"latin_1":case"windows1252":case"iso-8859-1":case"iso8859-1":case"8859":case"cp819":case"latin":case"latin1":case"L1":X.forEach(function(Ke){N+=String.fromCharCode(Ke)});break;case"unicode_escape":return q.__class__!==P&&q.__class__!==z||(q=ae(q,"latin-1","strict")),q.replace(/\\n/g,"\n").replace(/\\a/g,"\x07").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\t/g,"\t").replace(/\\'/g,"'").replace(/\\"/g,'"');case"raw_unicode_escape":return q.__class__!==P&&q.__class__!==z||(q=ae(q,"latin-1","strict")),q.replace(/\\u([a-fA-F0-9]{4})/g,function(Ke){var yt=parseInt(Ke.substr(2),16);return String.fromCharCode(yt)});case"ascii":Ge=0;for(var Ae=X.length;Ge<Ae;Ge++)if((Pe=X[Ge])<=127)N+=String.fromCharCode(Pe);else if("ignore"!=A){var Xe="'ascii' codec can't decode byte 0x"+Pe.toString(16)+" in position "+Ge+": ordinal not in range(128)";throw o.UnicodeDecodeError.$factory(Xe)}break;default:try{!function(Ke){if(void 0===x[Ke]){var yt=o.__import__("encodings."+Ke);yt[Ke].getregentry&&(x[Ke]=n.$getattr(yt[Ke].getregentry(),"decode"))}}(oe)}catch(Ke){throw console.log(X,Y,"error load_decoder",Ke),o.LookupError.$factory("unknown encoding: "+oe)}return x[oe](q)[0]}return N},fe=n.encode=function(){var q=n.args("encode",3,{s:null,encoding:null,errors:null},["s","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null),Y=q.s,A=q.encoding,N=q.errors,X=[],oe=0,H=he(A);switch(H){case"utf-8":case"utf_8":case"utf8":for(var Ce=[],Q=0,xe=Y.length;Q<xe;Q++)(Pe=Y.charCodeAt(Q))<127?Ce.push(Pe):Pe<2047?Ce.push(192+(Pe>>6),128+(63&Pe)):Pe<65535?Ce.push(224+(Pe>>12),128+((4095&Pe)>>6),128+(63&Pe)):console.log("4 bytes");return Ce;case"latin":case"latin1":case"latin-1":case"latin_1":case"L1":case"iso8859_1":case"iso_8859_1":case"8859":case"cp819":case"windows1252":for(Q=0,xe=Y.length;Q<xe;Q++)(Pe=Y.charCodeAt(Q))<=255?X[oe++]=Pe:"ignore"!=N&&ye(A,Q);break;case"ascii":for(Q=0,xe=Y.length;Q<xe;Q++)(Pe=Y.charCodeAt(Q))<=127?X[oe++]=Pe:"ignore"!=N&&ye(A,Q);break;case"raw_unicode_escape":for(Q=0,xe=Y.length;Q<xe;Q++){var Pe;if((Pe=Y.charCodeAt(Q))<256)X[oe++]=Pe;else{var Ge=Pe.toString(16);Ge.length%2&&(Ge="0"+Ge),Ge="\\u"+Ge;for(var Ae=0;Ae<Ge.length;Ae++)X[oe++]=Ge.charCodeAt(Ae)}}break;default:try{!function(Xe){if(void 0===l[Xe]){var Ke=o.__import__("encodings."+Xe);Ke[Xe].getregentry&&(l[Xe]=n.$getattr(Ke[Xe].getregentry(),"encode"))}}(H)}catch{throw o.LookupError.$factory("unknown encoding: "+A)}X=l[H](Y)[0].source}return X};for(var le in P.$factory=function(q,Y,A){var N=n.args("bytes",3,{source:null,encoding:null,errors:null},["source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(P,N.source,N.encoding,N.errors)},P.__class__=o.type,P.$is_class=!0,P)void 0===z[le]&&"function"==typeof P[le]&&(z[le]=function(q){return function(){return P[q].apply(null,arguments)}}(le));n.set_func_names(P,"builtins"),P.fromhex=o.classmethod.$factory(P.fromhex),n.set_func_names(z,"builtins"),z.fromhex=o.classmethod.$factory(z.fromhex),o.bytes=P,o.bytearray=z}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,$N=_b_.None;function create_type(n){return $B.get_class(n).$factory()}function clone(n){var o=create_type(n);for(key in o.$items=n.$items.slice(),n.$hashes)o.$hashes[key]=n.$hashes[key];return o}var set={__class__:_b_.type,$infos:{__module__:"builtins",__name__:"set"},$is_class:!0,$native:!0,__add__:function(n,o){throw _b_.TypeError.$factory("unsupported operand type(s) for +: 'set' and "+typeof o)},__and__:function(n,o,l){try{$test(l,o)}catch{return _b_.NotImplemented}for(var x=create_type(n),L=0,D=n.$items.length;L<D;L++)_b_.getattr(o,"__contains__")(n.$items[L])&&set.add(x,n.$items[L]);return x},__class_getitem__:function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},__contains__:function(n,o){if(n.$simple){if("number"==typeof o||o instanceof Number){if(isNaN(o)){for(var l=n.$items.length-1;l>=0;l--)if(isNaN(n.$items[l]))return!0;return!1}return o instanceof Number?n.$numbers.indexOf(o.valueOf())>-1:n.$items.indexOf(o)>-1}if("string"==typeof o)return n.$items.indexOf(o)>-1}_b_.isinstance(o,set)||$B.$getattr(o,"__hash__");var x=_b_.hash(o);if(n.$hashes[x]){l=0;for(var L=n.$hashes[x].length;l<L;l++)if($B.rich_comp("__eq__",n.$hashes[x][l],o))return!0}return!1},__eq__:function(n,o){if(void 0===o)return n===set;if(_b_.isinstance(o,[_b_.set,_b_.frozenset])){if(o.$items.length==n.$items.length){for(var l=0,x=n.$items.length;l<x;l++)if(!1===set.__contains__(n,o.$items[l]))return!1;return!0}return!1}return _b_.NotImplemented},__format__:function(n,o){return set.__str__(n)},__ge__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(o,n):_b_.NotImplemented},__gt__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__lt__(o,n):_b_.NotImplemented}};set.__hash__=_b_.None,set.__init__=function(n,o,l){if(void 0===l&&Array.isArray(o)){for(var x=0,L=o.length;x<L;x++)$add(n,o[x]);return $N}var D=$B.args("__init__",2,{self:null,iterable:null},["self","iterable"],arguments,{iterable:[]},null,null);if(n=D.self,_b_.isinstance(o=D.iterable,[set,frozenset])){for(var z in n.$items=o.$items.slice(),n.$hashes={},o.$hashes)n.$hashes[z]=o.$hashes[z];return $N}for(var M=$B.$iter(o);;)try{$add(n,_b_.next(M))}catch(P){if(_b_.isinstance(P,_b_.StopIteration))break;throw P}return $N};var set_iterator=$B.make_iterator_class("set iterator");function $test(n,o,l){if(void 0===n&&!_b_.isinstance(o,[set,frozenset]))throw _b_.TypeError.$factory("unsupported operand type(s) for "+l+": 'set' and '"+$B.class_name(o)+"'")}function $add(n,o){var x=!1;if(("string"==typeof o||"number"==typeof o||o instanceof Number)&&(x=!0),x){var L=n.$items.indexOf(o);if(-1==L){if(!(o instanceof Number&&n.$numbers.indexOf(o.valueOf())>-1||"number"==typeof o&&n.$numbers.indexOf(o)>-1)){n.$items.push(o);var D=o.valueOf();"number"==typeof D&&n.$numbers.push(D)}}else o!==n.$items[L]&&n.$items.push(o)}else{var z=_b_.hash(o);if(void 0===(M=n.$hashes[z]))n.$hashes[z]=[o],n.$items.push(o);else{for(var M,P=0,de=(M=n.$hashes[z]).length;P<de;P++)if($B.rich_comp("__eq__",o,M[P]))return $N;n.$hashes[z].push(o),n.$items.push(o)}}return $N}set.__iter__=function(n){return n.$items.sort(),set_iterator.$factory(n.$items)},set.__le__=function(n,o){if(_b_.isinstance(o,[set,frozenset])){for(var l=_b_.getattr(o,"__contains__"),x=0,L=n.$items.length;x<L;x++)if(!l(n.$items[x]))return!1;return!0}return _b_.NotImplemented},set.__len__=function(n){return n.$items.length},set.__lt__=function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(n,o)&&set.__len__(n)<_b_.getattr(o,"__len__")():_b_.NotImplemented},set.__mro__=[_b_.object],set.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("set.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}},set.__or__=function(n,o,l){for(var x=clone(n),L=_b_.getattr($B.$iter(o),"__next__");;)try{set.add(x,L())}catch(D){if(_b_.isinstance(D,_b_.StopIteration))break;throw D}return x.__class__=n.__class__,x},set.__rand__=function(n,o){return set.__and__(n,o)},set.__reduce__=function(n){return _b_.tuple.$factory([n.__class__,_b_.tuple.$factory([n.$items]),$N])},set.__reduce_ex__=function(n,o){return set.__reduce__(n)},set.__rsub__=function(n,o){return set.__sub__(n,o)},set.__rxor__=function(n,o){return set.__xor__(n,o)},set.__str__=set.__repr__=function(n){var o=$B.class_name(n);if(0===n.$items.length)return o+"()";var l=o+"({",x="})";"set({"==l&&(l="{",x="}");var L=[];if($B.repr.enter(n))return o+"(...)";n.$items.sort();for(var D=0,z=n.$items.length;D<z;D++){var M=_b_.repr(n.$items[D]);L.push(M===n||M===n.$items[D]?"{...}":M)}return L=L.join(", "),$B.repr.leave(n),l+L+x},set.__sub__=function(n,o,l){try{$test(l,o,"-")}catch{return _b_.NotImplemented}for(var x=create_type(n),L=_b_.getattr(o,"__contains__"),D=[],z=0,M=n.$items.length;z<M;z++)L(n.$items[z])||D.push(n.$items[z]);return set.__init__.call(null,x,D),x},set.__xor__=function(n,o,l){try{$test(l,o,"^")}catch{return _b_.NotImplemented}for(var x=create_type(n),L=_b_.getattr(o,"__contains__"),D=0,z=n.$items.length;D<z;D++)L(n.$items[D])||set.add(x,n.$items[D]);for(D=0,z=o.$items.length;D<z;D++)set.__contains__(n,o.$items[D])||set.add(x,o.$items[D]);return x},$B.make_rmethods(set),set.add=function(){var n=$B.args("add",2,{self:null,item:null},["self","item"],arguments,{},null,null);return $add(n.self,n.item)},set.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null);return n.self.$items=[],n.self.$hashes={},$N},set.copy=function(){var n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null);if(_b_.isinstance(n.self,frozenset))return n.self;var o=set.$factory();for(key in n.self.$items.forEach(function(l){o.$items.push(l)}),n.self.$numbers.forEach(function(l){o.$numbers.push(l)}),self.$hashes)o.$hashes[key]=self.$hashes[key];return o},set.difference_update=function(n){for(var o=$B.args("difference_update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x,L=set.$factory(o.args[l]),D=_b_.getattr($B.$iter(L),"__next__");;)try{var z=typeof(x=D());if("string"==z||"number"==z){var M=n.$items.indexOf(x);M>-1&&n.$items.splice(M,1)}else for(var P=0;P<n.$items.length;P++)if($B.rich_comp("__eq__",n.$items[P],x)){n.$items.splice(P,1);var de=_b_.hash(x);if(n.$hashes[de])for(var ye=0;ye<n.$hashes[de].length;ye++)if($B.rich_comp("__eq__",n.$hashes[de][ye],x)){n.$hashes[de].splice(ye,1);break}}}catch(he){if(_b_.isinstance(he,_b_.StopIteration))break;throw he}return $N},set.discard=function(){var n=$B.args("discard",2,{self:null,item:null},["self","item"],arguments,{},null,null);try{set.remove(n.self,n.item)}catch(o){if(!_b_.isinstance(o,[_b_.KeyError,_b_.LookupError]))throw o}return $N},set.intersection_update=function(){for(var n=$B.args("intersection_update",1,{self:null},["self"],arguments,{},"args",null),o=n.self,l=0;l<n.args.length;l++){for(var x=[],L=set.$factory(n.args[l]),D=0;D<o.$items.length;D++){var z=o.$items[D],M=typeof z;if("string"==M||"number"==M)-1==L.$items.indexOf(z)&&x.push(D);else{var P=!1,de=_b_.hash(z);if(L.$hashes[de]){for(var ye=L.$hashes[de],he=0;!P&&he<ye.length;he++)$B.rich_comp("__eq__",ye[he],z)&&(P=!0);if(!P)for(x.push(D),ye=o.$hashes[de],he=0;!P&&he<ye.length;he++)$B.rich_comp("__eq__",ye[he],z)&&o.$hashes.splice(he,1)}}}for(x.sort(function(ae,fe){return ae-fe}).reverse(),D=0;D<x.length;D++)o.$items.splice(x[D],1)}return $N},set.isdisjoint=function(){for(var n=$B.args("is_disjoint",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=0,l=n.self.$items.length;o<l;o++)if(_b_.getattr(n.other,"__contains__")(n.self.$items[o]))return!1;return!0},set.pop=function(n){if(0===n.$items.length)throw _b_.KeyError.$factory("pop from an empty set");var o=n.$items.pop();if("string"!=typeof o&&"number"!=typeof o)for(var l=_b_.hash(o),x=n.$hashes[l],L=0;L<x.length;L++)if($B.rich_comp("__eq__",x[L],o)){n.$hashes[l].splice(L,1);break}return o},set.remove=function(n,o){var l=$B.args("remove",2,{self:null,item:null},["self","item"],arguments,{},null,null);if(n=l.self,_b_.isinstance(o=l.item,set)||_b_.hash(o),"string"==typeof o||"number"==typeof o){var x=n.$items.indexOf(o);if(-1==x)throw _b_.KeyError.$factory(o);return n.$items.splice(x,1),"number"==typeof o&&n.$numbers.splice(n.$numbers.indexOf(o),1),$N}var L=_b_.hash(o);if(n.$hashes[L]){for(var D=0,z=n.$items.length;D<z;D++)if($B.rich_comp("__eq__",n.$items[D],o)){n.$items.splice(D,1),o instanceof Number&&n.$numbers.splice(n.$numbers.indexOf(o.valueOf()),1);break}for(D=0,z=n.$hashes[L].length;D<z;D++)if($B.rich_comp("__eq__",n.$hashes[L][D],o)){n.$hashes[L].splice(D,1);break}return $N}throw _b_.KeyError.$factory(o)},set.symmetric_difference_update=function(n,o){for(var l,x=$B.args("symmetric_difference_update",2,{self:null,s:null},["self","s"],arguments,{},null,null),L=(n=x.self,_b_.getattr($B.$iter(o=x.s),"__next__")),D=[],z=[];;)try{var M=typeof(l=L());if("string"==M||"number"==M){var P=n.$items.indexOf(l);P>-1?D.push(P):z.push(l)}else{for(var de=!1,ye=0;!de&&ye<n.$items.length;ye++)$B.rich_comp("__eq__",n.$items[ye],l)&&(D.push(ye),de=!0);de||z.push(l)}}catch(ae){if(_b_.isinstance(ae,_b_.StopIteration))break;throw ae}D.sort(function(ae,fe){return ae-fe}).reverse();for(var he=0;he<D.length;he++)D[he]!=D[he-1]&&n.$items.splice(D[he],1);for(he=0;he<z.length;he++)set.add(n,z[he]);return $N},set.update=function(n){for(var o=$B.args("update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x=set.$factory(o.args[l]),L=0,D=x.$items.length;L<D;L++)$add(n,x.$items[L]);return $N},set.difference=function(){var n=$B.args("difference",1,{self:null},["self"],arguments,{},"args",null);if(0==n.args.length)return set.copy(n.self);for(var o=clone(n.self),l=0;l<n.args.length;l++)o=set.__sub__(o,set.$factory(n.args[l]),!0);return o};var fc=set.difference+"";function $accept_only_set(n,o){return function(l,x,L){return $test(L,x,o),n(l,x),l}}eval("set.intersection = "+fc.replace(/difference/g,"intersection").replace("__sub__","__and__")),eval("set.symmetric_difference = "+fc.replace(/difference/g,"symmetric_difference").replace("__sub__","__xor__")),eval("set.union = "+fc.replace(/difference/g,"union").replace("__sub__","__or__")),set.issubset=function(){for(var n=$B.args("issubset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.other,"__contains__"),l=0,x=n.self.$items.length;l<x;l++)if(!o(n.self.$items[l]))return!1;return!0},set.issuperset=function(){for(var n=$B.args("issuperset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.self,"__contains__"),l=$B.$iter(n.other);;)try{if(!o(_b_.next(l)))return!1}catch(x){if(_b_.isinstance(x,_b_.StopIteration))return!0;throw x}return!0},set.__iand__=$accept_only_set(set.intersection_update,"&="),set.__isub__=$accept_only_set(set.difference_update,"-="),set.__ixor__=$accept_only_set(set.symmetric_difference_update,"^="),set.__ior__=$accept_only_set(set.update,"|="),set.$factory=function(){var n={__class__:set,$simple:!0,$items:[],$numbers:[],$hashes:{}},o=[n].concat(Array.prototype.slice.call(arguments));return set.__init__.apply(null,o),n},$B.set_func_names(set,"builtins"),set.__class_getitem__=_b_.classmethod.$factory(set.__class_getitem__);var frozenset={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"frozenset"},$is_class:!0,$native:!0};for(var attr in set)switch(attr){case"add":case"clear":case"discard":case"pop":case"remove":case"update":break;default:null==frozenset[attr]&&(frozenset[attr]="function"==typeof set[attr]?function(n){return function(){return set[n].apply(null,arguments)}}(attr):set[attr])}frozenset.__hash__=function(n){if(void 0===n)return frozenset.__hashvalue__||$B.$py_next_hash--;if(void 0!==n.__hashvalue__)return n.__hashvalue__;var o=1927868237;o*=n.$items.length;for(var l=0,x=n.$items.length;l<x;l++){var L=_b_.hash(n.$items[l]);o^=3644798167*(89869747^L^L<<16)}return-1==(o=69069*o+907133923)&&(o=590923713),n.__hashvalue__=o},frozenset.__init__=function(){return $N},frozenset.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("frozenset.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}};var singleton_id=Math.floor(Math.random()*Math.pow(2,40));function empty_frozenset(){var n=frozenset.__new__(frozenset);return n.$id=singleton_id,n}frozenset.$factory=function(){var n=$B.args("frozenset",1,{iterable:null},["iterable"],arguments,{iterable:null},null,null);if(null===n.iterable)return empty_frozenset();if(n.iterable.__class__==frozenset)return n.iterable;var o=set.$factory(n.iterable);return 0==o.$items.length?empty_frozenset():(o.__class__=frozenset,o)},$B.set_func_names(frozenset,"builtins"),_b_.set=set,_b_.frozenset=frozenset}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,_window=self;function to_simple(n){switch(typeof n){case"string":case"number":return n;case"boolean":return n?"true":"false";case"object":if(n===_b_.None)return"null";if(n instanceof Number)return n.valueOf();default:throw console.log("erreur",n),_b_.TypeError.$factory("keys must be str, int, float, bool or None, not "+$B.class_name(n))}}$B.pyobj2structuredclone=function(n,o){if(o=void 0===o||o,"boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(n===_b_.None)return null;if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var l=[],x=0,L=n.length;x<L;x++)l.push($B.pyobj2structuredclone(n[x]));return l}if(_b_.isinstance(n,_b_.dict)){if(o&&(Object.keys(n.$numeric_dict).length>0||Object.keys(n.$object_dict).length>0))throw _b_.TypeError.$factory("a dictionary with non-string keys does not support structured clone");var D=$B.dict_to_list(n);for(l={},x=0,L=D.length;x<L;x++)l[to_simple(D[x][0])]=$B.pyobj2structuredclone(D[x][1]);return l}return n},$B.structuredclone2pyobj=function(n){if(null===n)return _b_.None;if(void 0===n)return $B.Undefined;if("boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var o=_b_.list.$factory(),l=0,x=n.length;l<x;l++)o.push($B.structuredclone2pyobj(n[l]));return o}if("object"==typeof n){for(var L in o=$B.empty_dict(),n)_b_.dict.$setitem(o,L,$B.structuredclone2pyobj(n[L]));return o}throw console.log(n,Array.isArray(n),n.__class__,_b_.list,n.__class__===_b_.list),_b_.TypeError.$factory(_b_.str.$factory(n)+" does not support the structured clone algorithm")};var JSConstructor={__class__:_b_.type,__mro__:[object],$infos:{__module__:"<javascript>",__name__:"JSConstructor"},$is_class:!0,__call__:function(n){return function(){for(var o=[null],l=0,x=arguments.length;l<x;l++)o.push(pyobj2jsobj(arguments[l]));var L=new(n.func.bind.apply(n.func,o));return $B.$JS2Py(L)}},__getattribute__:function(n,o){return"__call__"==o?function(){for(var l=[null],x=0,L=arguments.length;x<L;x++)l.push(pyobj2jsobj(arguments[x]));var D=new(n.func.bind.apply(n.func,l));return $B.$JS2Py(D)}:JSObject.__getattribute__(n,o)},$factory:function(n){return{__class__:JSConstructor,js:n,func:n.js_func}}},jsobj2pyobj=$B.jsobj2pyobj=function(n){switch(n){case!0:case!1:return n}return void 0===n?$B.Undefined:null===n?_b_.None:Array.isArray(n)?_b_.list.$factory(n.map(jsobj2pyobj)):"number"==typeof n?-1==n.toString().indexOf(".")?_b_.int.$factory(n):_b_.float.$factory(n):"kw"===n.$nat?n:$B.$isNode(n)?$B.DOMNode.$factory(n):$B.JSObj.$factory(n)},pyobj2jsobj=$B.pyobj2jsobj=function(n){if(!0===n||!1===n)return n;if(n===_b_.None)return null;if(n!==$B.Undefined){var o=$B.get_class(n);if(void 0===o)return n;if(o===JSConstructor)return void 0!==n.js_func?n.js_func:n.js;if(o===$B.DOMNode||o.__mro__.indexOf($B.DOMNode)>-1)return n;if([_b_.list,_b_.tuple].indexOf(o)>-1){var l=[];return n.forEach(function(L){l.push(pyobj2jsobj(L))}),l}if(o===_b_.dict||_b_.issubclass(o,_b_.dict)){var x={};return _b_.list.$factory(_b_.dict.items(n)).forEach(function(L){"function"==typeof L[1]&&L[1].bind(x),x[L[0]]=pyobj2jsobj(L[1])}),x}return o===_b_.float?n.valueOf():o===$B.Function||o===$B.method?function(){try{for(var L=[],D=0;D<arguments.length;D++)L.push(void 0===arguments[D]?_b_.None:jsobj2pyobj(arguments[D]));return pyobj2jsobj(n.apply(this,L))}catch(z){throw console.log(z),console.log($B.$getattr(z,"info")),console.log($B.class_name(z)+":",z.args.length>0?z.args[0]:""),z}}:n}};function pyargs2jsargs(n){for(var o=[],l=0,x=n.length;l<x;l++){var L=n[l];if(null!=L&&void 0!==L.$nat){var D=L.kw;if(Array.isArray(D)&&(D=$B.extend(js_attr.name,...D)),Object.keys(D).length>0)throw _b_.TypeError.$factory("A Javascript function can't take keyword arguments")}else o.push($B.pyobj2jsobj(L))}return o}$B.JSConstructor=JSConstructor,$B.JSObj=$B.make_class("JSObj",function(n){if(!Array.isArray(n))if("function"==typeof n)n.$is_js_func=!0;else if("number"==typeof n&&!Number.isInteger(n))return new Number(n);return n}),$B.JSObj.__sub__=function(n,o){if("bigint"==typeof n&&"bigint"==typeof o)return n-o;throw _b_.TypeError.$factory("unsupported operand type(s) for - : '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'")};var ops={"+":"__add__","*":"__mul__","**":"__pow__","%":"__mod__"};for(var op in ops)eval("$B.JSObj."+ops[op]+" = "+($B.JSObj.__sub__+"").replace(/-/g,op));$B.JSObj.__eq__=function(n,o){if("object"==typeof n){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(var l in n)if(!$B.JSObj.__eq__(n[l],o[l]))return!1}return n===o},$B.JSObj.__ne__=function(n,o){return!$B.JSObj.__eq__(n,o)},$B.JSObj.__getattribute__=function(n,o){if("$$new"==o&&"function"==typeof n)return n.$js_func?function(){var z=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n.$js_func(...z))}:function(){var z=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n(...z))};"string"==typeof o&&(o=$B.from_alias(o));var l=n[o];if(null==l&&"function"==typeof n&&n.$js_func&&(l=n.$js_func[o]),void 0===l){if("function"==typeof n.getNamedItem&&void 0!==(D=n.getNamedItem(o)))return $B.JSObj.$factory(D);var x=$B.get_class(n);if(x&&x[o]){var L=x[o];return"function"==typeof L?function(){for(var z=[n],M=0,P=arguments.length;M<P;M++)z.push(arguments[M]);return $B.JSObj.$factory(L.apply(null,z))}:L}if("bind"==o&&"function"==typeof n.addEventListener)return function(z,M){return n.addEventListener(z,M)};throw _b_.AttributeError.$factory(o)}if("function"==typeof l){var D=function(){var z=pyargs2jsargs(arguments),M=n.$js_func||n;try{var P=l.apply(M,z)}catch(de){throw console.log("error",de),console.log("attribute",o,"of self",n,l,z,arguments),de}return void 0===P?$B.Undefined:null===P?_b_.None:$B.JSObj.$factory(P)};return D.prototype=l.prototype,D.$js_func=l,D.__mro__=[_b_.object],D.$infos={__name__:l.name,__qualname__:l.name},$B.frames_stack.length>0&&(D.$infos.__module__=$B.last($B.frames_stack)[3].__name__),$B.JSObj.$factory(D)}return $B.JSObj.$factory(l)},$B.JSObj.__setattr__=function(n,o,l){return"string"==typeof o&&(o=$B.from_alias(o)),n[o]=$B.pyobj2structuredclone(l),_b_.None},$B.JSObj.__getitem__=function(n,o){if("string"==typeof o)return $B.JSObj.__getattribute__(n,o);if("number"==typeof o){if(void 0!==n[o])return $B.JSObj.$factory(n[o]);if("number"==typeof n.length&&("number"==typeof o||"boolean"==typeof o)&&"function"==typeof n.item){var l=_b_.int.$factory(o);l<0&&(l+=n.length);var x=n.item(l);if(null===x)throw _b_.IndexError.$factory(l);return $B.JSObj.$factory(x)}}throw _b_.KeyError.$factory(l)},$B.JSObj.__setitem__=$B.JSObj.__setattr__;var JSObj_iterator=$B.make_iterator_class("JS object iterator");$B.JSObj.__iter__=function(n){var o=[];if(_window.Symbol&&void 0!==n[Symbol.iterator]){if(o=[],void 0!==n.next)for(;;){var l=n.next();if(l.done)break;o.push($B.JSObj.$factory(l.value))}else if(void 0!==n.length&&void 0!==n.item)for(var x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.item(x)));return JSObj_iterator.$factory(o)}if(void 0!==n.length&&void 0!==n.item){for(x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.js.item(x)));return JSObj_iterator.$factory(o)}var L=$B.JSObj.to_dict(n);return _b_.dict.__iter__(L)},$B.JSObj.__len__=function(n){if("number"==typeof n.length)return n.length;throw _b_.AttributeError.$factory(n+" has no attribute __len__")},$B.JSObj.__repr__=$B.JSObj.__str__=function(n){return"<Javascript "+n.constructor.name+" object: "+n.toString()+">"},$B.JSObj.bind=function(n,o,l){return n.addEventListener(o,function(x){return l(jsobj2pyobj(x))}),_b_.None},$B.JSObj.to_dict=function(n){return $B.structuredclone2pyobj(n)},$B.set_func_names($B.JSObj,"builtins"),$B.JSMeta=$B.make_class("JSMeta"),$B.JSMeta.__call__=function(n){for(var o=[],l=1,x=arguments.length;l<x;l++)o.push(arguments[l]);return new n.__mro__[0].$js_func(...o)},$B.JSMeta.__mro__=[_b_.type,_b_.object],$B.JSMeta.__getattribute__=function(n,o){return void 0!==n[o]?n[o]:void 0!==$B.JSMeta[o]?$B.JSMeta[o]:_b_.type.__getattribute__(n,o)},$B.JSMeta.__init_subclass__=function(){},$B.set_func_names($B.JSMeta,"builtins")}(__BRYTHON__),function(n){n.stdlib={};for(var o=["VFS_import","__future__","_abcoll","_codecs","_collections","_collections_abc","_compat_pickle","_contextvars","_csv","_dummy_thread","_frozen_importlib","_functools","_imp","_io","_markupbase","_operator","_py_abc","_pydecimal","_queue","_random","_socket","_sre","_struct","_sysconfigdata","_sysconfigdata_0_brython_","_testcapi","_thread","_threading_local","_weakref","_weakrefset","abc","antigravity","argparse","atexit","base64","bdb","binascii","bisect","browser.aio","browser.ajax","browser.highlight","browser.html","browser.indexed_db","browser.local_storage","browser.markdown","browser.object_storage","browser.session_storage","browser.svg","browser.template","browser.timer","browser.webcomponent","browser.websocket","browser.webworker","browser.worker","calendar","cmath","cmd","code","codecs","codeop","colorsys","configparser","contextlib","contextvars","copy","copyreg","csv","dataclasses","datetime","decimal","difflib","doctest","enum","errno","external_import","faulthandler","fnmatch","formatter","fractions","functools","gc","genericpath","getopt","gettext","glob","heapq","hmac","imp","inspect","interpreter","io","ipaddress","itertools","json","keyword","linecache","locale","mimetypes","nntplib","ntpath","numbers","opcode","operator","optparse","os","pathlib","pdb","pickle","pkgutil","platform","posixpath","pprint","profile","pwd","py_compile","pydoc","queue","quopri","re","reprlib","select","selectors","shlex","shutil","signal","site","site-packages.__future__","site-packages.docs","site-packages.header","site-packages.test","site-packages.test_sp","socket","sre_compile","sre_constants","sre_parse","stat","string","stringprep","struct","subprocess","sys","sysconfig","tarfile","tb","tempfile","test.namespace_pkgs.module_and_namespace_package.a_test","textwrap","this","threading","time","timeit","token","tokenize","traceback","turtle","types","typing","uu","uuid","warnings","weakref","webbrowser","zipfile","zipimport","zlib"],l=0;l<o.length;l++)n.stdlib[o[l]]=["py"];var x=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","aes","array","builtins","dis","hashlib","hmac-md5","hmac-ripemd160","hmac-sha1","hmac-sha224","hmac-sha256","hmac-sha3","hmac-sha384","hmac-sha512","long_int","marshal","math","math1","md5","modulefinder","pbkdf2","posix","rabbit","rabbit-legacy","random","rc4","ripemd160","sha1","sha224","sha256","sha3","sha384","sha512","tripledes","unicodedata"];for(l=0;l<x.length;l++)n.stdlib[x[l]]=["js"];var L=["browser.widgets","collections","concurrent","concurrent.futures","email","email.mime","encodings","html","http","importlib","logging","multiprocessing","multiprocessing.dummy","pydoc_data","site-packages.foobar","site-packages.simpleaio","site-packages.simpy","site-packages.simpy.resources","site-packages.ui","test","test.encoded_modules","test.leakers","test.namespace_pkgs.not_a_namespace_pkg.foo","test.support","test.test_email","test.test_importlib","test.test_importlib.builtin","test.test_importlib.extension","test.test_importlib.frozen","test.test_importlib.import_","test.test_importlib.source","test.test_json","test.tracedmodules","unittest","unittest.test","unittest.test.testmock","urllib"];for(l=0;l<L.length;l++)n.stdlib[L[l]]=["py",!0]}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,module=$B.module={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"module"},$is_class:!0};function parent_package(n){var o=n.split(".");return o.pop(),o.join(".")}function $download_module(n,o,l){var x=new XMLHttpRequest,L="?v="+(new Date).getTime(),D=null,z=n.__name__,M=_window.setTimeout(function(){x.abort()},5e3);if(x.open("GET",$B.$options.cache?o:o+L,!1),x.send(),$B.$CORS?D=200==x.status||0==x.status?x.responseText:_b_.ModuleNotFoundError.$factory("No module named '"+z+"'"):4==x.readyState&&(200==x.status?(D=x.responseText,n.$last_modified=x.getResponseHeader("Last-Modified")):(console.info("Error "+x.status+" means that Python module "+z+" was not found at url "+o),D=_b_.ModuleNotFoundError.$factory("No module named '"+z+"'"))),_window.clearTimeout(M),null==D)throw _b_.ModuleNotFoundError.$factory("No module named '"+z+"' (res is null)");if(D.constructor===Error)throw D;return D}function import_js(n,o){try{var l=$download_module(n,o,void 0)}catch{return null}return run_js(l,o,n),!0}function run_js(n,o,l){try{var x=new Function(n+";\nreturn $module")();$B.$options.store&&(l.$js=n)}catch(D){throw console.log(D),console.log(o,l),D}for(var L in x.__name__=l.__name__,x)"function"==typeof x[L]&&(x[L].$infos={__module__:l.__name__,__name__:L,__qualname__:L});if(void 0!==l){for(var L in x)l[L]=x[L];(x=l).__class__=module}else x.__class__=module,x.__name__=l.__name__,x.__repr__=x.__str__=function(){return $B.builtin_module_names.indexOf(l.name)>-1?"<module '"+l.__name__+"' (built-in)>":"<module '"+l.__name__+"' from "+o+" >"},"builtins"!=l.name&&(x.__file__=o);return $B.imported[l.__name__]=x,!0}function show_ns(){for(var kk=Object.keys(_window),i=0,len=kk.length;i<len;i++)console.log(kk[i]),"$"==kk[i].charAt(0)&&console.log(eval(kk[i]));console.log("---")}function import_py(n,o,l){var x=n.__name__,L=$download_module(n,o,l);if(n.$src=L,$B.imported[x].$is_package=n.$is_package,$B.imported[x].$last_modified=n.$last_modified,"/__init__.py"==o.substr(o.length-12))$B.imported[x].__package__=x,$B.imported[x].__path__=o,$B.imported[x].$is_package=n.$is_package=!0;else if(l)$B.imported[x].__package__=l;else{var D=x.split(".");D.pop(),$B.imported[x].__package__=D.join(".")}return $B.imported[x].__file__=o,run_py(L,o,n)}function run_py(module_contents,path,module,compiled){$B.file_cache[path]=module_contents;var root,js,mod_name=module.__name__;if(!compiled){var $Node=$B.$Node,$NodeJSCtx=$B.$NodeJSCtx;$B.$py_module_path[module.__name__]=path;var src={src:module_contents,has_annotations:!1};root=$B.py2js(src,module,module.__name__,$B.builtins_scope),void 0!==module.__package__&&(root.binding.__package__=!0)}try{js=compiled?module_contents:root.to_js(),10==$B.$options.debug&&(console.log("code for module "+module.__name__),console.log(js));var src=js;js="var $module = (function(){\n"+js+"return $locals_"+module.__name__.replace(/\./g,"_")+"})(__BRYTHON__)\nreturn $module";var module_id="$locals_"+module.__name__.replace(/\./g,"_"),$module=new Function(module_id,js)(module)}catch(n){for(var attr in console.log(n+" for module "+module.__name__),console.log("module",module),console.log(root),$B.debug>1&&console.log(js),n)console.log(attr,n[attr]);throw console.log(_b_.getattr(n,"info","[no info]")),console.log("message: "+n.$message),console.log("filename: "+n.fileName),console.log("linenum: "+n.lineNumber),$B.debug>0&&console.log("line info "+$B.line_info),n}finally{$B.clear_ns(module.__name__)}try{var mod=eval("$module");for(var attr in mod)module[attr]=mod[attr];return module.__initializing__=!1,$B.imported[module.__name__]=module,{content:src,name:mod_name,imports:Object.keys(root.imports).join(",")}}catch(n){for(var attr in console.log(n+"  for module "+module.__name__),n)console.log(attr+" "+n[attr]);throw $B.debug>0&&console.log("line info "+__BRYTHON__.line_info),n}}function new_spec(n){return n.__class__=module,n}module.__init__=function(){},module.__new__=function(n,o,l,x){return{__class__:n,__name__:o,__doc__:l||_b_.None,__package__:x||_b_.None}},module.__repr__=module.__str__=function(n){var o="<module "+n.__name__;return void 0===n.__file__&&(o+=" (built-in)"),o+">"},module.__setattr__=function(n,o,l){"__builtins__"==n.__name__?$B.builtins[o]=l:n[o]=l},module.$factory=function(n,o,l){return{__class__:module,__name__:n,__doc__:o||_b_.None,__package__:l||_b_.None}},$B.set_func_names(module,"builtins"),$B.$download_module=$download_module,$B.run_py=run_py;var finder_VFS={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"VFSFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state.stored,x=o.__spec__.loader_state.timestamp;delete o.__spec__.loader_state;var L=l[0],D=l[1];o.$is_package=l[3]||!1;var z="VFS."+o.__name__;if(o.__file__=z+=o.$is_package?"/__init__.py":L,$B.file_cache[o.__file__]=$B.VFS[o.__name__][1],".js"==L)run_js(D,o.__path__,o);else{if($B.precompiled.hasOwnProperty(o.__name__)){$B.debug>1&&console.info("load",o.__name__,"from precompiled");for(var M=o.__name__.split("."),P=0;P<M.length;P++){var de=M.slice(0,P+1).join(".");if(!$B.imported.hasOwnProperty(de)||!$B.imported[de].__initialized__){var ye=$B.precompiled[de],he=o.$is_package;Array.isArray(ye)&&(ye=ye[0]);var ae=$B.imported[de]=module.$factory(de,void 0,he);ae.__initialized__=!0,he?(ae.__path__="<stdlib>",ae.__package__=de):((N=de.split(".")).pop(),ae.__package__=N.join(".")),ae.__file__=z;try{var fe=de.replace(/\./g,"_");ye+="return $locals_"+fe;var le=new Function("$locals_"+fe,ye)(ae)}catch(oe){if($B.debug>1){for(var q in console.log(oe),oe)console.log(q,oe[q]);console.log(Object.keys($B.imported)),$B.debug>2&&console.log(o,"mod_js",ye)}throw oe}for(var Y in le)ae[Y]=le[Y];le.__file__=z,P>0&&$B.builtins.setattr($B.imported[M.slice(0,P).join(".")],M[P],le)}}return le}var A=o.__name__;$B.debug>1&&console.log("run Python code from VFS",A);var N,X=run_py(D,o.__path__,o);X.is_package=o.$is_package,X.timestamp=$B.timestamp,X.source_ts=x,$B.precompiled[A]=X.is_package?[X.content]:X.content,(N=A.split(".")).length>1&&N.pop(),$B.$options.indexedDB&&self.indexedDB&&$B.idb_name&&(indexedDB.open($B.idb_name).onsuccess=function(oe){var H=oe.target.result.transaction("modules","readwrite").objectStore("modules"),Ce=(H.openCursor(),H.put(X));Ce.onsuccess=function(){$B.debug>1&&console.info(o.__name__,"stored in db")},Ce.onerror=function(){console.info("could not store "+o.__name__)}})}},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,L){var D=n.find_spec(n,x,L),z=module.$factory(x);$B.imported[x]=z,z.__spec__=D,n.exec_module(n,z)}}},find_spec:function(n,o,l,x){var L,D,z;return $B.use_VFS?void 0===(L=$B.VFS[o])?_b_.None:(D=L[3]||!1,z=L.timestamp,L?new_spec({name:o,loader:n,origin:$B.builtin_module_names.indexOf(o)>-1?"built-in":"brython_stdlib",submodule_search_locations:D?[]:_b_.None,loader_state:{stored:L,timestamp:z},cached:_b_.None,parent:D?o:parent_package(o),has_location:_b_.False}):void 0):_b_.None}};for(var method in $B.set_func_names(finder_VFS,"<import>"),finder_VFS)"function"==typeof finder_VFS[method]&&(finder_VFS[method]=_b_.classmethod.$factory(finder_VFS[method]));finder_VFS.$factory=function(){return{__class__:finder_VFS}};var finder_cpython={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"CPythonFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){console.log("exec PYthon module",o);var l=o.__spec__.loader_state,x=l.content;delete o.__spec__.loader_state,o.$is_package=l.is_package,o.__file__=l.__file__,$B.file_cache[o.__file__]=x,$B.debug>1&&console.log("run Python code from CPython",o.__name__),run_py(x,o.__path__,o)},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,L){var D=n.find_spec(n,x,L),z=module.$factory(x);$B.imported[x]=z,z.__spec__=D,n.exec_module(n,z)}}},find_spec:function(n,o,l,x){console.log("finder cpython",o);var L,D=new XMLHttpRequest;return D.open("GET","/cpython_import?module="+o,!1),D.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var M=JSON.parse(this.responseText);L=new_spec({name:o,loader:n,origin:"CPython",submodule_search_locations:M.is_package?[]:_b_.None,loader_state:{content:M.content},cached:_b_.None,parent:M.is_package?o:parent_package(o),has_location:_b_.False})}},D.send(),L}};for(var method in $B.set_func_names(finder_cpython,"<import>"),finder_cpython)"function"==typeof finder_cpython[method]&&(finder_cpython[method]=_b_.classmethod.$factory(finder_cpython[method]));finder_cpython.$factory=function(){return{__class__:finder_cpython}};var finder_stdlib_static={$factory:finder_stdlib_static,__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"StdlibStatic"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state;o.$is_package=l.is_package,"py"==l.ext?import_py(o,l.path,o.__package__):import_js(o,l.path),delete o.__spec__.loader_state},find_module:function(n,o,l){var x=n.find_spec(n,o,l);return x===_b_.None?_b_.None:{__class__:Loader,load_module:function(L,D){var z=module.$factory(L);$B.imported[L]=z,z.__spec__=x,z.__package__=x.parent,n.exec_module(n,z)}}},find_spec:function(n,o,l,x){if($B.stdlib&&$B.$options.static_stdlib_import){var L=$B.stdlib[o];if(void 0===L){var D=o.split(".");if(D.length>1){D.pop();var z=$B.stdlib[D.join(".")];z&&z[1]&&(L=["py"])}}if(void 0!==L){var M=L[0],P=void 0!==L[1],de={ext:M,is_package:P,path:(l=$B.brython_path+("py"==M?"Lib/":"libs/")+o.replace(/\./g,"/"))+(P?"/__init__.py":"py"==M?".py":".js"),address:L};return new_spec({name:o,loader:n,origin:de.path,submodule_search_locations:P?[l]:_b_.None,loader_state:de,cached:_b_.None,parent:P?o:parent_package(o),has_location:_b_.True})}}return _b_.None}};for(var method in $B.set_func_names(finder_stdlib_static,"<import>"),finder_stdlib_static)"function"==typeof finder_stdlib_static[method]&&(finder_stdlib_static[method]=_b_.classmethod.$factory(finder_stdlib_static[method]));finder_stdlib_static.$factory=function(){return{__class__:finder_stdlib_static}};var finder_path={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"ImporterPath"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=$B.$getattr(o,"__spec__"),x=l.loader_state.code;o.$is_package=l.loader_state.is_package,delete l.loader_state.code;var L=l.loader_state.type;"py"==L||"pyc.js"==L?run_py(x,l.origin,o,"pyc.js"==L):"js"==l.loader_state.type&&run_js(x,l.origin,o)},find_module:function(n,o,l){return finder_path.find_spec(n,o,l)},find_spec:function(n,o,l,x){var L=$B.last($B.frames_stack)[2];if($B.VFS&&$B.VFS[L])return _b_.None;$B.is_none(l)&&(l=$B.path);for(var D=0,z=l.length;D<z;++D){var M=l[D];"/"!=M[M.length-1]&&(M+="/");var P=$B.path_importer_cache[M];if(void 0===P){for(var de=!0,ye=0,he=$B.path_hooks.length;ye<he&&de;++ye){var ae=$B.path_hooks[ye].$factory;try{P=("function"==typeof ae?ae:$B.$getattr(ae,"__call__"))(M),de=!1}catch(q){if(q.__class__!==_b_.ImportError)throw q}}de&&($B.path_importer_cache[M]=_b_.None)}if(!$B.is_none(P)){var fe=$B.$getattr(P,"find_spec"),le=("function"==typeof fe?fe:$B.$getattr(fe,"__call__"))(o,x);if(!$B.is_none(le))return le}}return _b_.None}};for(var method in $B.set_func_names(finder_path,"<import>"),finder_path)"function"==typeof finder_path[method]&&(finder_path[method]=_b_.classmethod.$factory(finder_path[method]));finder_path.$factory=function(){return{__class__:finder_path}};var url_hook={__class__:_b_.type,__mro__:[_b_.object],__repr__:function(n){return"<UrlPathFinder"+(n.hint?" for '"+n.hint+"'":"(unbound)")+" at "+n.path_entry+">"},$infos:{__module__:"builtins",__name__:"UrlPathFinder"},find_spec:function(n,o,l){var x={},L=!0,D=n.hint,z=n.path_entry+o.match(/[^.]+$/g)[0],M=[];(void 0===D||"py"==D)&&(M=M.concat([[z+".py","py",!1],[z+"/__init__.py","py",!0]]));for(var P=0;L&&P<M.length;++P)try{var de=M[P];x.code=$download_module({__name__:o,$is_package:!1},de[0],void 0),L=!1,x.type=de[1],x.is_package=de[2],void 0===D&&(n.hint=de[1],$B.path_importer_cache[n.path_entry]=n),x.is_package&&($B.path_importer_cache[z+"/"]=url_hook.$factory(z+"/",n.hint)),x.path=de[0]}catch{}return L?_b_.None:new_spec({name:o,loader:finder_path,origin:x.path,submodule_search_locations:x.is_package?[z]:_b_.None,loader_state:x,cached:_b_.None,parent:x.is_package?o:parent_package(o),has_location:_b_.True})},invalidate_caches:function(n){},$factory:function(n,o){return{__class__:url_hook,path_entry:n.endsWith("/")?n:n+"/",hint:o}}};$B.set_func_names(url_hook,"<import>"),$B.path_importer_cache={};for(var _sys_paths=[[$B.script_dir+"/","py"],[$B.brython_path+"Lib/","py"],[$B.brython_path+"Lib/site-packages/","py"],[$B.brython_path+"libs/","js"]],i=0;i<_sys_paths.length;++i){var _path=_sys_paths[i],_type=_path[1];_path=_path[0],$B.path_importer_cache[_path]=url_hook.$factory(_path,_type)}function import_error(n){var o=_b_.ImportError.$factory(n);throw o.name=n,o}function optimize_import_for_path(n,o){"/"!=n.slice(-1)&&(n+="/");var l="none"==o?_b_.None:url_hook.$factory(n,o);$B.path_importer_cache[n]=l}$B.$__import__=function(n,o,l,x,L){var D=!1;if(o.$jsobj&&o.$jsobj.__file__){var z=o.$jsobj.__file__;(z.startsWith($B.brython_path+"Lib/")&&!z.startsWith($B.brython_path+"Lib/site-packages/")||z.startsWith($B.brython_path+"libs/")||z.startsWith("VFS."))&&(D=!0)}var M=$B.imported[n],P=n.split("."),de=x.length>0;if(M==_b_.None&&import_error(n),void 0===M){$B.is_none(x)&&(x=[]);for(var ye=0,he="",ae="",fe=P.length-1,le=_b_.None;ye<=fe;++ye){var q=ae;if(ae+=he+P[ye],he=".",(M=$B.imported[ae])==_b_.None)import_error(ae);else if(void 0===M){try{$B.import_hooks(ae,le,D)}catch(A){throw delete $B.imported[ae],A}$B.is_none($B.imported[ae])?import_error(ae):q&&_b_.setattr($B.imported[q],P[ye],$B.imported[ae])}else $B.imported[q]&&void 0===$B.imported[q][P[ye]]&&_b_.setattr($B.imported[q],P[ye],$B.imported[ae]);if(ye<fe)try{le=$B.$getattr($B.imported[ae],"__path__")}catch{if(ye==fe-1&&$B.imported[ae][P[fe]]&&$B.imported[ae][P[fe]].__class__===module)return $B.imported[ae][P[fe]];if(!de){var Y=_b_.ModuleNotFoundError.$factory();throw Y.msg="No module named '"+n+"'; '"+ae+"' is not a package",Y.args=$B.fast_tuple([Y.msg]),Y.name=n,Y.path=_b_.None,Y}import_error(n)}}}else if($B.imported[P[0]]&&2==P.length)try{void 0===$B.imported[P[0]][P[1]]&&$B.$setattr($B.imported[P[0]],P[1],M)}catch(A){throw console.log("error",P,M),A}return x.length>0?$B.imported[n]:$B.imported[P[0]]},$B.$import=function(n,o,l,x){o=void 0===o?[]:o,l=void 0===l?{}:l,x=void 0===x?{}:x;var L=n.split(".");"."==n[n.length-1]&&L.pop();for(var D=[],z=!0,M=0,P=L.length;M<P;M++){var de=L[M];if(z&&""==de){if(elt=D.pop(),void 0===elt)throw _b_.ImportError.$factory("Parent module '' not loaded, cannot perform relative import")}else z=!1,D.push("$$"==de.substr(0,2)?de.substr(2):de)}n=D.join("."),10==$B.$options.debug&&(console.log("$import "+n),console.log("use VFS ? "+$B.use_VFS),console.log("use static stdlib paths ? "+$B.static_stdlib_import));var ye=$B.frames_stack[$B.frames_stack.length-1],he=ye[3],ae=he.__import__,fe=$B.obj_dict(he);void 0===ae&&(ae=$B.$__import__);var le=("function"==typeof ae?ae:$B.$getattr(ae,"__call__"))(n,fe,void 0,o,0);if(o&&0!=o.length){var q=o,Y={};if(o&&"*"==o[0]&&(q=$B.$getattr(le,"__all__",Y))!==Y&&(l={}),q===Y)for(var A in le)"_"!==A[0]&&(x[A]=le[A]);else{M=0;for(var N=q.length;M<N;++M){var X=q[M],oe=l[X]||X;try{x[oe]=$B.$getattr(le,X)}catch{try{var H=$B.from_alias(X);$B.$getattr(ae,"__call__")(n+"."+H,fe,void 0,[],0),x[oe]=$B.$getattr(le,H)}catch(Ge){if("__future__"===n){var Ce=$B.last($B.frames_stack),Q=Ce[3].$line_info.split(","),xe=parseInt(Q[0]);$B.$SyntaxError(Ce[2],"future feature "+X+" is not defined",ye[3].src,void 0,xe)}throw Ge.$py_error?(Ge.__class__!==_b_.ImportError&&Ge.__class__!==_b_.ModuleNotFoundError&&$B.handle_error(Ge),_b_.ImportError.$factory("cannot import name '"+X+"'")):($B.debug>1&&(console.log(Ge),console.log($B.last($B.frames_stack))),_b_.ImportError.$factory("cannot import name '"+X+"'"))}}}}return x}(oe=l[n])?x[oe]=$B.imported[n]:x[$B.to_alias(D[0])]=le},$B.import_all=function(n,o){for(var l in o)(l.startsWith("$$")||-1=="_$".indexOf(l.charAt(0)))&&(n[l]=o[l])},$B.$path_hooks=[url_hook],$B.$meta_path=[finder_VFS,finder_stdlib_static,finder_path],$B.finders={VFS:finder_VFS,stdlib_static:finder_stdlib_static,path:finder_path,CPython:finder_cpython};var Loader={__class__:$B.$type,__mro__:[_b_.object],__name__:"Loader"},_importlib_module={__class__:module,__name__:"_importlib",Loader,VFSFinder:finder_VFS,StdlibStatic:finder_stdlib_static,ImporterPath:finder_path,UrlPathFinder:url_hook,optimize_import_for_path};_importlib_module.__repr__=_importlib_module.__str__=function(){return"<module '_importlib' (built-in)>"},$B.imported._importlib=_importlib_module}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var object=_b_.object;function $err(n,o){var l="unsupported operand type(s) for "+n+": 'float' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function float_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var float={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"float"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="eEfFgGn%".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'float'");if(isNaN(n))return"f"==o.type||"g"==o.type?"nan":"NAN";if(n==Number.POSITIVE_INFINITY)return"f"==o.type||"g"==o.type?"inf":"INF";if(void 0===o.precision&&void 0!==o.type&&(o.precision=6),"%"==o.type&&(n*=100),"e"==o.type){var l=n.toExponential(o.precision),x=parseInt(l.substr(l.search("e")+1));return Math.abs(x)<10&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),l}if(void 0!==o.precision){var L=o.precision;if(0==L)return Math.round(n)+"";var D=(l=n.toFixed(L)).indexOf(".");if(void 0===o.type||"%"!=o.type&&"f"!=o.type.toLowerCase()){if(o.type&&"g"==o.type.toLowerCase()){var z=preformat(n,{type:"e"}).split("e"),M=(l=-4<=(x=parseInt(z[1]))&&x<o.precision?preformat(n,{type:"f",precision:o.precision-1-x}):preformat(n,{type:"e",precision:o.precision-1})).split("e");if(o.alternate)-1==M[0].search(/\./)&&(M[0]+=".");else if(M[1]){for(var P=M[0];P.endsWith("0");)P=P.substr(0,P.length-1);P.endsWith(".")&&(P=P.substr(0,P.length-1)),M[0]=P}return l=M.join("e"),"G"==o.type&&(l=l.toUpperCase()),l}if(void 0===o.type)o.type="g",l=preformat(n,o),o.type=void 0;else{var de=n.toExponential(o.precision-1);if((x=parseInt(de.substr(de.search("e")+1)))<-4||x>=o.precision-1){for(var ye=de.split("e");ye[0].endsWith("0");)ye[0]=ye[0].substr(0,ye[0].length-1);l=ye.join("e")}}}else if(-1==D)l+="."+"0".repeat(o.precision);else{var he=o.precision-l.length+D+1;he>0&&(l+="0".repeat(he))}}else l=_b_.str.$factory(n);if(void 0===o.type||-1!="gGn".indexOf(o.type)){if(-1==l.search("e"))for(;"0"==l.charAt(l.length-1);)l=l.substr(0,l.length-1);"."==l.charAt(l.length-1)&&(void 0===o.type?l+="0":l=l.substr(0,l.length-1))}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>0&&(l=o.sign+l),"%"==o.type&&(l+="%"),l}float.numerator=function(n){return float_value(n)},float.denominator=function(n){return _b_.int.$factory(1)},float.imag=function(n){return _b_.int.$factory(0)},float.real=function(n){return float_value(n)},float.__float__=function(n){return float_value(n)},float.as_integer_ratio=function(n){if((n=float_value(n)).valueOf()==Number.POSITIVE_INFINITY||n.valueOf()==Number.NEGATIVE_INFINITY)throw _b_.OverflowError.$factory("Cannot pass infinity to float.as_integer_ratio.");if(!Number.isFinite(n.valueOf()))throw _b_.ValueError.$factory("Cannot pass NaN to float.as_integer_ratio.");for(var o=_b_.$frexp(n.valueOf()),l=o[0],x=o[1],L=0;L<300&&l!=Math.floor(l);L++)l*=2,x--;return numerator=float.$factory(l),py_exponent=abs(x),denominator=1,py_exponent=_b_.getattr(_b_.int.$factory(denominator),"__lshift__")(py_exponent),x>0?numerator*=py_exponent:denominator=py_exponent,_b_.tuple.$factory([_b_.int.$factory(numerator),_b_.int.$factory(denominator)])},float.__bool__=function(n){return n=float_value(n),_b_.bool.$factory(n.valueOf())},float.__eq__=function(n,o){return n=float_value(n),o=float_value(o),(!isNaN(n)||!isNaN(o))&&(isinstance(o,_b_.int)?n==o:isinstance(o,float)?n.valueOf()==o.valueOf():isinstance(o,_b_.complex)?0==o.$imag&&n==o.$real:_b_.NotImplemented)},float.__floordiv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(Math.floor(n/o))}if(hasattr(o,"__rfloordiv__"))return getattr(o,"__rfloordiv__")(n);$err("//",o)},float.fromhex=function(n){if(!isinstance(n,_b_.str))throw _b_.ValueError.$factory("argument must be a string");var o,l=n.trim();switch(l.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return $FloatClass(1/0);case"-inf":case"-infinity":return $FloatClass(-1/0);case"+nan":case"nan":return $FloatClass(Number.NaN);case"-nan":return $FloatClass(-Number.NaN);case"":throw _b_.ValueError.$factory("could not convert string to float")}if(null!==(o=/^(\d*\.?\d*)$/.exec(l)))return $FloatClass(parseFloat(o[1]));if(null==(o=/^(\+|-)?(0x)?([0-9A-F]+\.?)?(\.[0-9A-F]+)?(p(\+|-)?\d+)?$/i.exec(l)))throw _b_.ValueError.$factory("invalid hexadecimal floating-point string");var x=o[1],L=parseInt(o[3]||"0",16),D=o[4]||".0",z=o[5]||"p0";x="-"==x?-1:1;for(var M=L,P=1,de=D.length;P<de;P++)M+=parseInt(D.charAt(P),16)/Math.pow(16,P);return new Number(x*M*Math.pow(2,parseInt(z.substring(1))))},float.__getformat__=function(n){if("double"==n||"float"==n)return"IEEE, little-endian";throw _b_.ValueError.$factory("__getformat__() argument 1 must be 'double' or 'float'")},float.__format__=function(n,o){n=float_value(n);var l=new $B.parse_format_spec(o);l.align=l.align||">";var x=preformat(n,l).split("."),L=x[0];if(l.comma){for(var D=L.length,z=Math.ceil(L.length/3),M=[],P=0;P<z;P++)M.push(L.substring(D-3*P-3,D-3*P));M.reverse(),x[0]=M.join(",")}return $B.format_width(x.join("."),l)},float.__hash__=function(n){if(void 0===n)return float.__hashvalue__||$B.$py_next_hash--;var o=n.valueOf();if(o===1/0)return 314159;if(o===-1/0)return-271828;if(isNaN(o))return 0;if(o==Math.round(o))return Math.round(o);var l=_b_.$frexp(o);l[0]*=Math.pow(2,31);var x=_b_.int.$factory(l[0]);return l[0]=(l[0]-x)*Math.pow(2,31),4294967295&x+_b_.int.$factory(l[0])+(l[1]<<15)},_b_.$isninf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==-1/0||o==Number.NEGATIVE_INFINITY},_b_.$isinf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==1/0||o==-1/0||o==Number.POSITIVE_INFINITY||o==Number.NEGATIVE_INFINITY},_b_.$fabs=function(n){return float.$factory(n>0?n:-n)},_b_.$frexp=function(n){var o=n;if(isinstance(n,float)&&(o=n.valueOf()),isNaN(o)||_b_.$isinf(o))return[o,-1];if(0==o)return[0,0];var l=1,x=0,L=o;for(L<0&&(l=-l,L=-L);L<.5;)L*=2,x--;for(;L>=1;)L*=.5,x++;return[L*=l,x]},_b_.$ldexp=function(n,o){if(_b_.$isninf(n))return float.$factory("-inf");if(_b_.$isinf(n))return float.$factory("inf");var l=n;if(isinstance(n,float)&&(l=n.valueOf()),0==l)return l;var x=o;return isinstance(o,float)&&(x=o.valueOf()),l*Math.pow(2,x)},float.hex=function(n){switch((n=float_value(n)).valueOf()){case 1/0:case-1/0:case Number.NaN:case-Number.NaN:return n;case-0:return"-0x0.0p0";case 0:return"0x0.0p0"}var o=_b_.$frexp(_b_.$fabs(n.valueOf())),l=o[0],x=o[1],L=1-Math.max(-1021-x,0);l=_b_.$ldexp(l,L),x-=L;var D="0123456789ABCDEF".split(""),z=D[Math.floor(l)];z+=".",l-=Math.floor(l);for(var M=0;M<13;M++)l*=16,z+=D[Math.floor(l)],l-=Math.floor(l);var P="+";return x<0&&(P="-",x=-x),n.value<0?"-0x"+z+"p"+P+x:"0x"+z+"p"+P+x},float.__init__=function(n,o){return _b_.None},float.__int__=function(n){return parseInt(n)},float.is_integer=function(n){return _b_.int.$factory(n)==n},float.__mod__=function(n,o){if(n=float_value(n),0==(o=float_value(o)))throw ZeroDivisionError.$factory("float modulo");if(isinstance(o,_b_.int))return new Number((n%o+o)%o);if(isinstance(o,float)){var l=Math.floor(n/o);return new Number(n-o*l)}if(isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),new Number((n%x+x)%x)}if(hasattr(o,"__rmod__"))return getattr(o,"__rmod__")(n);$err("%",o)},float.__mro__=[object],float.__mul__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return new Number(o.__class__==$B.long_int?n*parseFloat(o.value):n*o);if(isinstance(o,float))return new Number(n*float_value(o));if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),new Number(n*l)}return isinstance(o,_b_.complex)?$B.make_complex(float.$factory(n*o.$real),float.$factory(n*o.$imag)):hasattr(o,"__rmul__")?getattr(o,"__rmul__")(n):void $err("*",o)},float.__ne__=function(n,o){var l=float.__eq__(n,o);return l===_b_.NotImplemented?l:!l},float.__neg__=function(n,o){return float.$factory(-float_value(n))},float.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("float.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("float.__new__(X): X is not a type object");return n===float?float.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},float.__pos__=function(n){return float_value(n)},float.__pow__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int)||isinstance(o,float)){if(1==n)return n;if(0==o)return new Number(1);if(!(-1!=n||isFinite(o)&&o.__class__!==$B.long_int&&$B.is_safe_int(o)||isNaN(o)))return new Number(1);if(0==n&&isFinite(o)&&o<0)throw _b_.ZeroDivisionError.$factory("0.0 cannot be raised to a negative power");return n!=Number.NEGATIVE_INFINITY||isNaN(o)?n!=Number.POSITIVE_INFINITY||isNaN(o)?o!=Number.NEGATIVE_INFINITY||isNaN(n)?o!=Number.POSITIVE_INFINITY||isNaN(n)?n<0&&!_b_.getattr(o,"__eq__")(_b_.int.$factory(o))?_b_.complex.__pow__($B.make_complex(n,0),o):float.$factory(Math.pow(n,o)):Math.abs(n)<1?new Number(0):Number.POSITIVE_INFINITY:Math.abs(n)<1?Number.POSITIVE_INFINITY:new Number(0):o>0?n:new Number(0):o<0&&o%2==1?new Number(-0):o<0?new Number(0):o>0&&o%2==1?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}if(isinstance(o,_b_.complex)){var l=Math.pow(n,o.$real),x=Math.log(n);return $B.make_complex(l*Math.cos(x),l*Math.sin(x))}if(hasattr(o,"__rpow__"))return getattr(o,"__rpow__")(n);$err("** or pow()",o)},float.__repr__=float.__str__=function(n){if((n=float_value(n)).valueOf()==1/0)return"inf";if(n.valueOf()==-1/0)return"-inf";if(isNaN(n.valueOf()))return"nan";var o,l,x=n.valueOf()+"";if(-1==x.indexOf(".")&&(x+=".0"),[o,l]=x.split("."),o.length>16){for(var L=o.length-1,D=o[0],z=o.substr(1)+l;z.endsWith("0");)z=z.substr(0,z.length-1);var M=D;return z.length>0&&(M+="."+z),M+"e+"+L}if("0"==o){for(L=0;L<l.length&&"0"==l.charAt(L);)L++;if(L>3){var P=l.substr(L);for(L=(L+1).toString();P.endsWith("0");)P=P.substr(0,x.length-1);return M=P[0],P.length>1&&(M+="."+P.substr(1)),1==L.length&&(L="0"+L),M+"e-"+L}}return _b_.str.$factory(x)},float.__setattr__=function(n,o,l){if(n.constructor===Number)throw void 0===float[o]?_b_.AttributeError.$factory("'float' object has no attribute '"+o+"'"):_b_.AttributeError.$factory("'float' object attribute '"+o+"' is read-only");return n[o]=l,_b_.None},float.__truediv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(n/o)}if(isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw ZeroDivisionError.$factory("division by zero");return $B.make_complex(float.$factory(n*o.$real/l),float.$factory(-n*o.$imag/l))}if(hasattr(o,"__rtruediv__"))return getattr(o,"__rtruediv__")(n);$err("/",o)};var $op_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return"boolean"==typeof o?o?n-1:n:float.$factory(o.__class__===$B.long_int?n-parseInt(o.value):n-o);if(isinstance(o,float))return float.$factory(n-o);if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),float.$factory(n-l)}return isinstance(o,_b_.complex)?$B.make_complex(n-o.$real,-o.$imag):hasattr(o,"__rsub__")?getattr(o,"__rsub__")(n):void $err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var $opf=$op_func.replace(/-/gm,$op);$opf=$opf.replace(/__rsub__/gm,"__r"+$ops[$op]+"__"),eval("float.__"+$ops[$op]+"__ = "+$opf)}var $comp_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return o.__class__===$B.long_int?n>parseInt(o.value):n>o.valueOf();if(isinstance(o,float))return n>o;if(isinstance(o,_b_.bool))return n.valueOf()>_b_.bool.__hash__(o);if(hasattr(o,"__int__")||hasattr(o,"__index__"))return _b_.int.__gt__(n,$B.$GetInt(o));var l=getattr(o,"__le__",None);if(l!==None)return l(n);throw _b_.TypeError.$factory("unorderable types: float() > "+$B.class_name(o)+"()")};for(var $op in $comp_func+="",$B.$comps)eval("float.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__le__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(float);var $notimplemented=function(n,o){throw _b_.TypeError.$factory("unsupported operand types for OPERATOR: 'float' and '"+$B.class_name(o)+"'")};for(var $op in $notimplemented+="",$B.$operators)if(void 0===$B.augmented_assigns[$op]){var $opfunc="__"+$B.$operators[$op]+"__";void 0===float[$opfunc]&&eval("float."+$opfunc+"="+$notimplemented.replace(/OPERATOR/gm,$op))}function $FloatClass(n){return new Number(n)}function to_digits(n){for(var o="",l=0;l<n.length;l++){var x="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".indexOf(n[l]);o+=x>-1?x:n[l]}return o}float.$factory=function(value){switch(value){case void 0:return $FloatClass(0);case Number.MAX_VALUE:return $FloatClass(1/0);case-Number.MAX_VALUE:return $FloatClass(-1/0);case!0:return new Number(1);case!1:return new Number(0)}if("number"==typeof value)return new Number(value);if(isinstance(value,float))return float_value(value);if(isinstance(value,bytes)){var s=getattr(value,"decode")("latin-1");return float.$factory(getattr(value,"decode")("latin-1"))}if("string"==typeof value)switch(value=value.trim(),value.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return Number.POSITIVE_INFINITY;case"-inf":case"-infinity":return Number.NEGATIVE_INFINITY;case"+nan":case"nan":return Number.NaN;case"-nan":return-Number.NaN;case"":throw _b_.ValueError.$factory("count not convert string to float");default:if(value=value.charAt(0)+value.substr(1).replace(/_/g,""),value=to_digits(value),isFinite(value))return $FloatClass(eval(value));throw _b_.str.encode(value,"latin-1"),_b_.ValueError.$factory("Could not convert to float(): '"+_b_.str.$factory(value)+"'")}var klass=value.__class__||$B.get_class(value),num_value=$B.to_num(value,["__float__","__index__"]);if(null!==num_value)return num_value;throw _b_.TypeError.$factory("float() argument must be a string or a number, not '"+$B.class_name(value)+"'")},$B.$FloatClass=$FloatClass,$B.set_func_names(float,"builtins");var FloatSubclass=$B.FloatSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"float"},$is_class:!0};for(var $attr in float)"function"==typeof float[$attr]&&(FloatSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,L=arguments.length;x<L;x++)o[l++]=arguments[x]}return float[n].apply(null,o)}}($attr));$B.set_func_names(FloatSubclass,"builtins"),_b_.float=float}(__BRYTHON__),function($B){var _b_=$B.builtins;function $err(n,o){var l="unsupported operand type(s) for "+n+" : 'int' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function int_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var int={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="bcdoxXn".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'int'");var l;switch(o.type){case void 0:case"d":l=n.toString();break;case"b":l=(o.alternate?"0b":"")+n.toString(2);break;case"c":l=_b_.chr(n);break;case"o":l=(o.alternate?"0o":"")+n.toString(8);break;case"x":l=(o.alternate?"0x":"")+n.toString(16);break;case"X":l=(o.alternate?"0X":"")+n.toString(16).toUpperCase();break;case"n":return n}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>=0&&(l=o.sign+l),l}function extended_euclidean(n,o){var l,x,L;return 0==o?[n,1,0]:([l,x,L]=extended_euclidean(o,n%o),[l,L,x-Math.floor(n/o)*L])}int.as_integer_ratio=function(){var n=$B.args("as_integer_ratio",1,{self:null},["self"],arguments,{},null,null);return $B.$list([n.self,1])},int.from_bytes=function(){var n,o,l=$B.args("from_bytes",3,{bytes:null,byteorder:null,signed:null},["bytes","byteorder","signed"],arguments,{signed:!1},null,null),x=l.bytes,L=l.byteorder,D=l.signed;if(_b_.isinstance(x,[_b_.bytes,_b_.bytearray]))n=x.source,o=x.source.length;else{o=(n=_b_.list.$factory(x)).length;for(var z=0;z<o;z++)_b_.bytes.$factory([n[z]])}switch(L){case"big":var M=n[o-1],P=256;for(z=o-2;z>=0;z--)M=$B.add($B.mul(P,n[z]),M),P=$B.mul(P,256);return D?n[0]<128?M:$B.sub(M,P):M;case"little":for((M=n[0])>=128&&(M-=256),P=256,z=1;z<o;z++)M=$B.add($B.mul(P,n[z]),M),P=$B.mul(P,256);return D?n[o-1]<128?M:$B.sub(M,P):M}throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'")},int.to_bytes=function(){var n=$B.args("to_bytes",3,{self:null,len:null,byteorder:null},["self","len","byteorder"],arguments,{},"args","kw"),o=n.self,l=n.len,x=n.byteorder,L=n.kw;if(!_b_.isinstance(l,_b_.int))throw _b_.TypeError.$factory("integer argument expected, got "+$B.class_name(l));if(-1==["little","big"].indexOf(x))throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'");var z=[];if(o<0){if(!L.$string_dict.signed)throw _b_.OverflowError.$factory("can't convert negative int to unsigned");o=Math.pow(256,l)+o}for(var M=o;;){var P=Math.floor(M/256);if(z.push(M-256*P),0==P)break;M=P}if(z.length>l)throw _b_.OverflowError.$factory("int too big to convert");for(;z.length<l;)z=z.concat([0]);return"big"==x&&(z=z.reverse()),{__class__:_b_.bytes,source:z}},int.__abs__=function(n){return _b_.abs(n)},int.__bool__=function(n){return 0!=int_value(n).valueOf()},int.__ceil__=function(n){return Math.ceil(int_value(n))},int.__divmod__=function(n,o){return $B.fast_tuple([int.__floordiv__(n,o),int.__mod__(n,o)])},int.__eq__=function(n,o){return void 0===o?n===int:_b_.isinstance(o,int)?n.valueOf()==int_value(o).valueOf():_b_.isinstance(o,_b_.float)?n.valueOf()==o.valueOf():_b_.isinstance(o,_b_.complex)?0!=o.$imag?False:n.valueOf()==o.$real:_b_.NotImplemented},int.__float__=function(n){return new Number(n)},int.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(l.type&&-1!="eEfFgG%".indexOf(l.type))return _b_.float.__format__(n,o);l.align=l.align||">";var x=preformat(n,l);if(l.comma){for(var L="-"==x[0]?"-":"",D=x.substr(L.length),z=D.length,M=Math.ceil(D.length/3),P=[],de=0;de<M;de++)P.push(D.substring(z-3*de-3,z-3*de));P.reverse(),x=L+P.join(",")}return $B.format_width(x,l)},int.__floordiv__=function(n,o){if(o.__class__===$B.long_int)return $B.long_int.__floordiv__($B.long_int.$factory(n),o);if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.hasattr(o,"__rfloordiv__"))return $B.$getattr(o,"__rfloordiv__")(n);$err("//",o)},int.__hash__=function(n){return void 0===n?int.__hashvalue__||$B.$py_next_hash--:n.valueOf()},int.__index__=function(n){return int_value(n)},int.__init__=function(n,o){return void 0===o&&(o=0),n.toString=function(){return o},_b_.None},int.__int__=function(n){return n},int.__invert__=function(n){return~n},int.__lshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__lshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rlshift__",_b_.None);if(l!==_b_.None)return l(n);$err("<<",o)},int.__mod__=function(n,o){if(_b_.isinstance(o,_b_.tuple)&&1==o.length&&(o=o[0]),o.__class__===$B.long_int)return $B.long_int.__mod__($B.long_int.$factory(n),o);if(_b_.isinstance(o,[int,_b_.float,bool])){if(!1===(o=int_value(o))?o=0:!0===o&&(o=1),0==o)throw _b_.ZeroDivisionError.$factory("integer division or modulo by zero");return(n%o+o)%o}if(_b_.hasattr(o,"__rmod__"))return $B.$getattr(o,"__rmod__")(n);$err("%",o)},int.__mro__=[_b_.object],int.__mul__=function(n,o){var l=n.valueOf();if("string"==typeof o)return o.repeat(l);if(_b_.isinstance(o,int))return(x=n*(o=int_value(o)))>$B.min_int&&x<$B.max_int?x:int.$factory($B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o)));if(_b_.isinstance(o,_b_.float))return new Number(n*o);if(_b_.isinstance(o,_b_.bool))return o.valueOf()?n:int.$factory(0);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(int.__mul__(n,o.$real),int.__mul__(n,o.$imag));if(_b_.isinstance(o,[_b_.list,_b_.tuple])){for(var x=[],L=o.slice(0,o.length),D=0;D<l;D++)x=x.concat(L);return _b_.isinstance(o,_b_.tuple)&&(x=_b_.tuple.$factory(x)),x}if(_b_.hasattr(o,"__rmul__"))return $B.$getattr(o,"__rmul__")(n);$err("*",o)},int.__ne__=function(n,o){var l=int.__eq__(n,o);return l===_b_.NotImplemented?l:!l},int.__neg__=function(n){return-n},int.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("int.__new__(X): X is not a type object");return n===int?int.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},int.__pos__=function(n){return n},$B.use_bigint=0,int.__pow__=function(n,o,l){if("number"==typeof o||_b_.isinstance(o,int)){switch((o=int_value(o)).valueOf()){case 0:return int.$factory(1);case 1:return int.$factory(n.valueOf())}if(void 0!==l&&l!==_b_.None){if(1==l)return 0;var x=1,L=n%l,D=o,z=$B.long_int;if(D<0){var M,P,de;if([M,P,de]=extended_euclidean(n,l),1!==M)throw _b_.ValueError.$factory("not relative primes: "+n+" and "+l);return int.__pow__(P,-D,l)}for(;D>0;)D%2==1&&(x*L>$B.max_int?(x=z.__mul__(z.$factory(x),z.$factory(L)),x=z.__mod__(x,l)):x=x*L%l),D>>=1,L*L>$B.max_int?(L=z.__mul__(z.$factory(L),z.$factory(L)),L=z.__mod__(L,l)):L=L*L%l;return x}var ye=Math.pow(n.valueOf(),o.valueOf());return ye>$B.min_int&&ye<$B.max_int?ye:ye===1/0||isFinite(ye)?$B.BigInt?($B.use_bigint++,{__class__:$B.long_int,value:($B.BigInt(n)**$B.BigInt(o)).toString(),pos:!0}):$B.long_int.__pow__($B.long_int.$from_int(n),$B.long_int.$from_int(o)):ye}if(_b_.isinstance(o,_b_.float))return n>=0?new Number(Math.pow(n,o.valueOf())):_b_.complex.__pow__($B.make_complex(n,0),o);if(_b_.isinstance(o,_b_.complex)){var he=Math.pow(n,o.$real),ae=Math.log(n);return $B.make_complex(he*Math.cos(ae),he*Math.sin(ae))}var fe=$B.$getattr(o,"__rpow__",_b_.None);if(fe!==_b_.None)return fe(n);$err("**",o)},int.__repr__=function(n){return n===int?"<class 'int'>":n.toString()},int.__rshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__rshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rrshift__",_b_.None);if(l!==_b_.None)return l(n);$err(">>",o)},int.__setattr__=function(n,o,l){if("number"==typeof n)throw _b_.AttributeError.$factory(void 0===int.$factory[o]?"'int' object has no attribute '"+o+"'":"'int' object attribute '"+o+"' is read-only");return _b_.dict.$setitem(n.__dict__,o,l),_b_.None},int.__str__=int.__repr__,int.__truediv__=function(n,o){if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(o.__class__===$B.long_int?n/parseInt(o.value):n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(n/o)}if(_b_.isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw _b_.ZeroDivisionError.$factory("division by zero");return $B.make_complex(n*o.$real/l,-n*o.$imag/l)}if(_b_.hasattr(o,"__rtruediv__"))return $B.$getattr(o,"__rtruediv__")(n);$err("/",o)},int.bit_length=function(n){return s=_b_.bin(n),s=$B.$getattr(s,"lstrip")("-0b"),s.length},int.numerator=function(n){return n},int.denominator=function(n){return int.$factory(1)},int.imag=function(n){return int.$factory(0)},int.real=function(n){return n},$B.max_int32=2147483647,$B.min_int32=-$B.max_int32;var $op_func=function(n,o){if(_b_.isinstance(o,int))return o.__class__===$B.long_int?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):(o=int_value(o),n>$B.max_int32||n<$B.min_int32||o>$B.max_int32||o<$B.min_int32?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):n-o);if(_b_.isinstance(o,_b_.bool))return n-o;var l=$B.$getattr(o,"__rsub__",_b_.None);if(l!==_b_.None)return l(n);$err("-",o)};$op_func+="";var $ops={"&":"and","|":"or","^":"xor"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $op_func=function(n,o){if(_b_.isinstance(o,int)){if("number"==typeof(o=int_value(o))){var l=n.valueOf()-o.valueOf();return l>$B.min_int&&l<$B.max_int?l:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}return"boolean"==typeof o?o?n-1:n:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}if(_b_.isinstance(o,_b_.float))return new Number(n-o);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n-o.$real,-o.$imag);if(_b_.isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),n-x}if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n.valueOf()-o.$real,o.$imag);var L=$B.$getattr(o,"__rsub__",_b_.None);if(L!==_b_.None)return L(n);throw console.log("err",n,o),console.log($B.frames_stack.slice()),$err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $comp_func=function(n,o){return o.__class__===$B.long_int?$B.long_int.__lt__(o,$B.long_int.$factory(n)):_b_.isinstance(o,int)?(o=int_value(o),n.valueOf()>o.valueOf()):_b_.isinstance(o,_b_.float)?n.valueOf()>o.valueOf():_b_.isinstance(o,_b_.bool)?n.valueOf()>_b_.bool.__hash__(o):_b_.hasattr(o,"__int__")||_b_.hasattr(o,"__index__")?int.__gt__(n,$B.$GetInt(o)):_b_.NotImplemented};for(var $op in $comp_func+="",$B.$comps)eval("int.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__lt__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(int);var $valid_digits=function(n){var o="";if(0===n)return"0";if(n<10){for(var l=0;l<n;l++)o+=String.fromCharCode(l+48);return o}for(o="0123456789",l=10;l<n;l++)o+=String.fromCharCode(l+55);return o};int.$factory=function(n,o){if(void 0===n)return 0;if("number"==typeof n&&(void 0===o||10==o))return parseInt(n);if(_b_.isinstance(n,_b_.complex))throw _b_.TypeError.$factory("can't convert complex to int");var l=$B.args("int",2,{x:null,base:null},["x","base"],arguments,{base:10},null,null);if(o=l.base,_b_.isinstance(n=l.x,_b_.float)&&10==o)return(n=_b_.float.numerator(n))<$B.min_int||n>$B.max_int?$B.long_int.$from_float(n):n>0?Math.floor(n):Math.ceil(n);if(!(o>=2&&o<=36)&&0!=o)throw _b_.ValueError.$factory("invalid base");if("number"==typeof n){if(10==o)return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n):n;if(n.toString().search("e")>-1)throw _b_.OverflowError.$factory("can't convert to base "+o);var x=parseInt(n,o);return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n,o):x}if(!0===n)return Number(1);if(!1===n)return Number(0);if(n.__class__===$B.long_int){var L=parseInt(n.value);return L>$B.min_int&&L<$B.max_int?L:n}function D(ye,he){throw _b_.ValueError.$factory("invalid literal for int() with base "+he+": '"+_b_.str.$factory(ye)+"'")}if(o=$B.$GetInt(o),_b_.isinstance(n,_b_.str)&&(n=n.valueOf()),"string"==typeof n){var z=n.trim();if(2==z.length&&0==o&&("0b"==z||"0o"==z||"0x"==z))throw _b_.ValueError.$factory("invalid value");if(z.length>2){var M=z.substr(0,2).toUpperCase();if(0==o?("0B"==M&&(o=2),"0O"==M&&(o=8),"0X"==M&&(o=16)):("0X"==M&&16!=o||"0O"==M&&8!=o)&&D(z,o),"0B"==M&&2==o||"0O"==M||"0X"==M)for(z=z.substr(2);z.startsWith("_");)z=z.substr(1)}else 0==o&&(o=10);var P=$valid_digits(o);return null===new RegExp("^[+-]?["+P+"]["+P+"_]*$","i").exec(z)?D(n,o):n=z.replace(/_/g,""),o<=10&&!isFinite(n)&&D(z,o),(x=parseInt(n,o))<$B.min_int||x>$B.max_int?$B.long_int.$factory(n,o):x}if(_b_.isinstance(n,[_b_.bytes,_b_.bytearray]))return int.$factory($B.$getattr(n,"decode")("latin-1"),o);var de=$B.to_num(n,["__int__","__index__","__trunc__"]);if(null===de)throw _b_.TypeError.$factory("int() argument must be a string, a bytes-like object or a number, not '"+$B.class_name(n)+"'");return de},$B.set_func_names(int,"builtins"),_b_.int=int,$B.$bool=function(n){if(null==n)return!1;switch(typeof n){case"boolean":return n;case"number":case"string":return!!n;default:if(n.$is_class)return!0;var o=n.__class__||$B.get_class(n),l={},x=$B.$getattr(o,"__bool__",l);if(x!==l){var L=$B.$call(x)(n);if(!0!==L&&!1!==L)throw _b_.TypeError.$factory("__bool__ should return bool, returned "+$B.class_name(L));return L}try{return _b_.len(n)>0}catch{return!0}}};var bool={__bases__:[int],__class__:_b_.type,__mro__:[int,_b_.object],$infos:{__name__:"bool",__module__:"builtins"},$is_class:!0,$native:!0},methods=$B.op2method.subset("operations","binary","comparisons","boolean");for(var op in methods){var method="__"+methods[op]+"__";bool[method]=function(n){return function(o,l){if(void 0!==int[n])return int[n](o?1:0,l)}}(method)}bool.__and__=function(n,o){return _b_.isinstance(o,bool)?n&&o:_b_.isinstance(o,int)?int.__and__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__hash__=bool.__index__=bool.__int__=function(n){return n.valueOf()?1:0},bool.__neg__=function(n){return-$B.int_or_bool(n)},bool.__or__=function(n,o){return _b_.isinstance(o,bool)?n||o:_b_.isinstance(o,int)?int.__or__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__pos__=$B.int_or_bool,bool.__repr__=bool.__str__=function(n){return n?"True":"False"},bool.__setattr__=function(n,o){if(_b_.dir(n).indexOf(o)>-1)var l="attribute '"+o+"' of 'int' objects is not writable";else l="'bool' object has no attribute '"+o+"'";throw _b_.AttributeError.$factory(l)},bool.__xor__=function(n,o){return _b_.isinstance(o,bool)?!!(n^o):_b_.isinstance(o,int)?int.__xor__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.$factory=function(){var n=$B.args("bool",1,{x:null},["x"],arguments,{x:!1},null,null);return $B.$bool(n.x)},_b_.bool=bool,$B.set_func_names(bool,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);try{eval("window")}catch(n){window=self}var long_int={__class__:_b_.type,__mro__:[int,object],$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function add_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)+BigInt(o)).toString(),pos:!0};for(var l,x="",L=0,D=n.length,z=o.length-1;z>=0;z--)2==(l=(L+(--D<0?0:parseInt(n.charAt(D)))+parseInt(o.charAt(z))).toString()).length?(x=l.charAt(1)+x,L=parseInt(l.charAt(0))):(x=l+x,L=0);for(;D>0;)D--,2==(l=(L+parseInt(n.charAt(D))).toString()).length?(x=l.charAt(1)+x,L=parseInt(l.charAt(0))):(x=l+x,L=0);return L&&(x=L+x),{__class__:long_int,value:x,pos:!0}}var len=(Math.pow(2,53)-1+"").length-1;function binary_pos(n){for(var o,l,x,L,D=Math.ceil(n.length/len),z=[],M=[],P=0;P<D;P++)x=(o=n.length-(P+1)*len)-(l=Math.max(0,o)),z.push(n.substr(l,len+x));(z=z.reverse()).forEach(function(ye,he){z[he]=parseInt(ye)});for(var de=Math.pow(10,15);z[z.length-1]>0;)z.forEach(function(ye,he){L=ye%2,z[he]=Math.floor(ye/2),L&&he<z.length-1&&(z[he+1]+=de)}),M.push(L),0==z[0]&&z.shift();return M.reverse().join("")}function binary(n){var o=binary_pos(n.value);if(n.pos)return o;for(var l="",x=0,L=o.length;x<L;x++)l+="0"==o.charAt(x)?"1":"0";var D=add_pos(l,"1").value;return l.substr(0,l.length-D.length)+D}function check_shift(n){if(!isinstance(n,long_int))throw TypeError.$factory("shift must be int, not '"+$B.class_name(n)+"'");if(!n.pos)throw ValueError.$factory("negative shift count")}function clone(n){var o={};for(var l in n)o[l]=n[l];return o}function comp_pos(n,o){return n.length>o.length?1:n.length<o.length?-1:n>o?1:n<o?-1:0}function divmod_by_safe_int(n,o){if(1==o)return[n,0];for(var l,x,L,D=(Math.floor((Math.pow(2,53)-1)/o)+"").length-1,z=Math.ceil(n.length/D),M=[],P=0;P<z;P++)L=(l=n.length-(P+1)*D)-(x=Math.max(0,l)),M.push(n.substr(x,D+L));(M=M.reverse()).forEach(function(ae,fe){M[fe]=parseInt(ae)});var de,ye,he=Math.pow(10,D);for(M.forEach(function(ae,fe){de=ae%o,M[fe]=Math.floor(ae/o),fe<M.length-1&&(M[fe+1]+=he*de)});0==M[0];)if(M.shift(),0==M.length)return[0,de];return ye=M[0]+"",M.forEach(function(ae,fe){fe>0&&(ye+="0".repeat(D-ae.toString().length)+ae)}),[ye,de]}function divmod_pos(n,o){if(window.BigInt)return[{__class__:long_int,value:(BigInt(n)/BigInt(o)).toString(),pos:!0},{__class__:long_int,value:(BigInt(n)%BigInt(o)).toString(),pos:!0}];var l,x=parseInt(n),L=parseInt(o);if(x<$B.max_int&&L<$B.max_int){var D=x%L,z=Math.floor(x/L).toString();return[{__class__:long_int,value:z.toString(),pos:!0},{__class__:long_int,value:D.toString(),pos:!0}]}if(L<$B.max_int){var M=divmod_by_safe_int(n,L);return[long_int.$factory(M[0]),long_int.$factory(M[1])]}if(-1==comp_pos(n,o))P="0",l=long_int.$factory(n);else if(o==n)P="1",l=long_int.$factory("0");else{var P="",de=n.substr(0,o.length);n<o&&(de=n.substr(0,o.length+1));for(var ye=n.substr(de.length),he={};;){var ae=Math.floor(parseInt(de)/parseInt(o))+"";if("10"==ae&&(ae="9"),void 0===he[ae]&&(he[ae]=mul_pos(o,ae).value),-1==comp_pos(de,he[ae])&&void 0===he[--ae]&&(he[ae]=mul_pos(o,ae).value),P+=ae,de=sub_pos(de,he[ae]).value,0==ye.length)break;de+=ye.charAt(0),ye=ye.substr(1)}l=sub_pos(n,mul_pos(P,o).value)}return[long_int.$factory(P),l]}function split_chunks(n,o){for(var l=Math.ceil(n.length/o),x=[],L=n.length,D=0;D<l;D++){var z=L-o*(D+1);z<0&&(o+=z,z=0),x.push(parseInt(n.substr(z,o)))}return x}function mul_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)*BigInt(o)).toString(),pos:!0};var l,x=parseInt(n)*parseInt(o);if(x<$B.max_int)return{__class__:long_int,value:x.toString(),pos:!0};for(var L=split_chunks(n,6),D=split_chunks(o,6),z={},M=L.length+D.length,P=0;P<M-1;P++)z[P]=0;for(P=0;P<L.length;P++)for(var de=0;de<D.length;de++)z[P+de]+=L[P]*D[de];for(P=0;P<M-1;P++){var ye=split_chunks(z[P].toString(),6);for(de=1;de<ye.length;de++)void 0===z[l=P+de]?z[l]=parseInt(ye[de]):z[l]+=parseInt(ye[de]);z[P]=ye[0]}var he,ae="";for(P=0;void 0!==z[P];)he=z[P].toString(),void 0!==z[P+1]&&(he="0".repeat(6-he.length)+he),ae=he+ae,P++;try{return long_int.$factory(ae)}catch(fe){throw console.log(n,o,z,ae),fe}}function sub_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)-BigInt(o)).toString(),pos:!0};for(var l,x="",L=0,D=n.length,z=0,M=o.length-1;M>=0;M--)D--,l=(z=parseInt(n.charAt(D)))-L-parseInt(o.charAt(M)),isNaN(l)&&console.log("x is NaN",n.length,o.length,M,D,z,L,M,o.charAt(M)),l<0?(x=10+l+x,L=1):(x=l+x,L=0);for(x.startsWith("NaN")&&alert(x);D>0;)D--,(l=parseInt(n.charAt(D))-L)<0?(x=10+l+x,L=1):(x=l+x,L=0);for(;"0"==x.charAt(0)&&x.length>1;)x=x.substr(1);return x.startsWith("NaN")&&console.log("hoho !!",n,o,n>=o,x),{__class__:long_int,value:x,pos:!0}}function to_BigInt(n){var o=$B.BigInt(n.value);return n.pos?o:-o}function from_BigInt(n){var o=n>=0;return n=(n=(n=n.toString()).endsWith("n")?n.substr(0,n.length-1):n).startsWith("-")?n.substr(1):n,intOrLong({__class__:long_int,value:n,pos:o})}function digits(n){for(var o={},l=0;l<n&&10!=l;l++)o[l]=!0;if(n>10)for(l=0;l<n-10;l++)o[String.fromCharCode(65+l)]=!0,o[String.fromCharCode(97+l)]=!0;return o}long_int.$from_float=function(n){var o=Math.abs(n).toString(),l=o;if(o.search("e")>-1){var x=/-?(\d)(\.\d+)?e([+-])(\d*)/.exec(o),L=x[1],D=x[2],M=x[4];"+"==x[3]&&(l=void 0===D?L+"0".repeat(M-1):L+D+"0".repeat(M-1-D.length))}return{__class__:long_int,value:l,pos:n>=0}},long_int.__abs__=function(n){return{__class__:long_int,value:n.value,pos:!0}},long_int.__add__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)+o.value);if("number"==typeof o)o=long_int.$factory(_b_.str.$factory(o));else if(o.__class__!==long_int)if(isinstance(o,_b_.bool))o=long_int.$factory(o?1:0);else{if(!isinstance(o,int))return _b_.NotImplemented;o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)))}var l;if(n.pos&&o.pos)return add_pos(n.value,o.value);if(n.pos||o.pos){if(n.pos&&!o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)}return(l=add_pos(n.value,o.value)).pos=!1,intOrLong(l)},long_int.__and__=function(n,o){if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),$B.BigInt)return from_BigInt(to_BigInt(n)&to_BigInt(o));var l="",x=!n.pos&&!o.pos;x&&(n=long_int.__neg__(n),o=long_int.__neg__(o));var L,D,z=binary(n),M=z.length,P=binary(o),de=P.length,ye=1;for(l="";!(ye>M&&ye>de);)L=ye>M?n.pos?"0":"1":z.charAt(M-ye),D=ye>de?o.pos?"0":"1":P.charAt(de-ye),l="1"==L&&"1"==D?"1"+l:"0"+l,ye++;for(;"0"==l.charAt(0);)l=l.substr(1);return l=$B.long_int.$factory(l,2),x&&(l.pos=!1),intOrLong(l)},long_int.__divmod__=function(n,o){"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o)));var l=divmod_pos(n.value,o.value);return n.pos!==o.pos&&("0"!=l[0].value&&(l[0].pos=!1),"0"!=l[1].value&&(l[0]=long_int.__sub__(l[0],long_int.$factory("1")),l[1]=long_int.__sub__(n,long_int.__mul__(o,long_int.$factory(l[0]))))),$B.fast_tuple([intOrLong(l[0]),intOrLong(l[1])])},long_int.__eq__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.value==o.value&&n.pos==o.pos},long_int.__float__=function(n){return new Number(parseFloat(n.value))},long_int.__floordiv__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);if("number"==typeof o){var l=divmod_by_safe_int(n.value,o);return{__class__:long_int,value:l[0],pos:o>0?n.pos:!n.pos}}return intOrLong(long_int.__divmod__(n,o)[0])},long_int.__ge__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!=o.pos?!o.pos:n.value.length>o.value.length?n.pos:n.value.length<o.value.length?!n.pos:n.pos?n.value>=o.value:n.value<=o.value},long_int.__gt__=function(n,o){return!long_int.__le__(n,o)},long_int.__index__=function(n){for(var o,l="",x=n.value;l=(o=divmod_pos(x,"2"))[1].value+l,"0"!=(x=o[0].value););if(n.pos)l="0"+l;else{for(var L="",D=!1,z=l.length-1;z>=0;z--)"0"==l.charAt(z)?L=D?"1"+L:"0"+L:D?L="0"+L:(D=!0,L="1"+L);l=L="1"+L}return intOrLong(l)},long_int.__invert__=function(n){return long_int.__sub__(long_int.$factory("-1"),n)},long_int.__le__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!==o.pos||n.value.length>o.value.length?!n.pos:n.value.length<o.value.length?n.pos:n.pos?n.value<=o.value:n.value>=o.value},long_int.__lt__=function(n,o){return!long_int.__ge__(n,o)},long_int.__lshift__=function(n,o){if(window.BigInt)return o.__class__==long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)<<BigInt(o)).toString(),pos:n.pos});var l;if(o.__class__===long_int){var x=parseInt(o.value);if(x<0)throw _b_.ValueError.$factory("negative shift count");x<$B.max_int&&(l=!0,o=x)}if(l){if(0==x)return n}else if("0"==(o=long_int.$factory(o)).value)return n;for(var L=n.value;;){for(var D,z=0,M="",P=L.length-1;P>=0;P--)2==(D=(z+2*parseInt(L.charAt(P))).toString()).length?(M=D.charAt(1)+M,z=parseInt(D.charAt(0))):(M=D+M,z=0);if(z&&(M=z+M),L=M,l){if(0==--o)break}else if("0"==(o=sub_pos(o.value,"1")).value)break}return intOrLong({__class__:long_int,value:L,pos:n.pos})},long_int.__mod__=function(n,o){return intOrLong(long_int.__divmod__(n,o)[1])},long_int.__mro__=[_b_.int,_b_.object],long_int.__mul__=function(n,o){switch(n){case Number.NEGATIVE_INFINITY:case Number.POSITIVE_INFINITY:return $B.rich_comp("__eq__",o,0)?NaN:_b_.getattr(o,"__gt__")(0)?n:-n}if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)*o);if("number"==typeof o&&(o=long_int.$factory(o)),other_value=o.value,other_pos=o.pos,o.__class__!==long_int&&isinstance(o,int)){var l=int.__index__(o);other_value=_b_.str.$factory(l),other_pos=l>0}if($B.BigInt)return from_BigInt(to_BigInt(n)*to_BigInt(o));var x=mul_pos(n.value,other_value);return n.pos==other_pos||(x.pos=!1),intOrLong(x)},long_int.__neg__=function(n){return{__class__:long_int,value:n.value,pos:!n.pos}},long_int.__or__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var L=x;x=l,l=L}for(var D=l.length-x.length,z=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)||"1"==x.charAt(M)?z+="1":z+="0";return intOrLong(long_int.$factory(z,2))},long_int.__pos__=function(n){return n},long_int.__pow__=function(n,o,l){if("number"==typeof o)o=long_int.$from_int(o);else if(isinstance(o,int))o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)));else if(!isinstance(o,long_int))throw TypeError.$factory("power must be an integer, not '"+$B.class_name(o)+"'");if(!o.pos)return"1"==n.value?n:long_int.$factory("0");if("0"==o.value)return long_int.$factory("1");if($B.BigInt){var x=$B.BigInt(n.value),L=$B.BigInt(1),D=$B.BigInt(o.value);if(void 0===(l=void 0===l?l:$B.BigInt("number"==typeof l?l:l.value)))return{__class__:long_int,value:(x**D).toString(),pos:!0};for(;D>0;)D%$B.BigInt(2)==1&&(L*=x),(D/=$B.BigInt(2))>0&&(x*=x),void 0!==l&&(L%=l);return{__class__:long_int,value:L.toString(),pos:!0}}L={__class__:long_int,value:"1",pos:!0},x=n;for(var z,M=o.value;"string"==typeof M&&parseInt(M)<$B.max_int&&(M=parseInt(M)),0!=M;)"string"==typeof M?(parseInt(M.charAt(M.length-1))%2==1&&(L=long_int.__mul__(L,x)),M=long_int.__floordiv__(M,2)):(M%2==1&&(L="number"==typeof L&&"number"==typeof x&&(z=L*x)<$B.max_int?z:long_int.__mul__(long_int.$factory(L),long_int.$factory(x))),M=Math.floor(M/2)),M>0&&("number"==typeof x&&(z=x*x)<$B.max_int?x=z:(x=long_int.$factory(x),x=long_int.__mul__(x,x))),void 0!==l&&(L=long_int.__mod__(L,l));return intOrLong(L)},long_int.__rshift__=function(n,o){if(window.BigInt)return o.__class__===long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)>>BigInt(o)).toString(),pos:n.pos});if("number"==typeof o){var l=Math.pow(2,o);if(l<$B.max_int){var x=divmod_by_safe_int(n.value,l);return intOrLong({__class__:long_int,value:x[0],pos:n.pos})}}if("0"==(o=long_int.$factory(o)).value)return n;for(x=n.value;"0"!=(x=divmod_pos(x,"2")[0].value).value&&"0"!=(o=sub_pos(o.value,"1")).value;);return intOrLong({__class__:long_int,value:x,pos:n.pos})},long_int.__str__=long_int.__repr__=function(n){var o="";return n.pos||(o+="-"),o+n.value},long_int.__sub__=function(n,o){if(isinstance(o,_b_.float))return o=o instanceof Number?o:o.$brython_value,_b_.float.$factory(parseInt(n.value)-o);var l;if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos&&o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}if(n.pos||o.pos)return n.pos&&!o.pos?intOrLong(add_pos(n.value,o.value)):((l=add_pos(n.value,o.value)).pos=!1,intOrLong(l));switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)},long_int.__truediv__=function(n,o){if(isinstance(o,long_int))return _b_.float.$factory(parseInt(n.value)/parseInt(o.value));if(isinstance(o,_b_.int)||isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);throw TypeError.$factory("unsupported operand type(s) for /: 'int' and '"+$B.class_name(o)+"'")},long_int.__xor__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var L=x;x=l,l=L}for(var D=l.length-x.length,z=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)&&"0"==x.charAt(M)||"0"==l.charAt(D+M)&&"1"==x.charAt(M)?z+="1":z+="0";return intOrLong(long_int.$factory(z,2))},long_int.numerator=function(n){return n},long_int.denominator=function(n){return _b_.int.$factory(1)},long_int.imag=function(n){return _b_.int.$factory(0)},long_int.real=function(n){return n},long_int.to_base=function(n,o){if(2==o)return binary_pos(n.value);for(var l="",x=n.value;x>0;){var L=divmod_pos(x,o.toString());if(l=parseInt(L[1].value).toString(o)+l,0==(x=L[0].value))break}return l};var MAX_SAFE_INTEGER=Math.pow(2,53)-1,MIN_SAFE_INTEGER=-MAX_SAFE_INTEGER;function isSafeInteger(n){return"number"==typeof n&&Math.round(n)===n&&MIN_SAFE_INTEGER<=n&&n<=MAX_SAFE_INTEGER}function intOrLong(n){var o=parseInt(n.value)*(n.pos?1:-1);return o>MIN_SAFE_INTEGER&&o<MAX_SAFE_INTEGER?o:n}long_int.$from_int=function(n){return{__class__:long_int,value:n.toString(),pos:n>0}},long_int.$factory=function(n,o){if(arguments.length>2)throw _b_.TypeError.$factory("long_int takes at most 2 arguments ("+arguments.length+" given)");if(void 0===o)o=10;else if(!isinstance(o,int))throw TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer");if(o<0||1==o||o>36)throw ValueError.$factory("long_int.$factory() base must be >= 2 and <= 36");if("number"==typeof n){var l=n>0;if(isSafeInteger(n=Math.abs(n)))P=long_int.$from_int(n);else{if(n.constructor!=Number)throw ValueError.$factory("argument of long_int is not a safe integer");var x=n.toString(),L=x.search("e");if(L>-1){var D=x.substr(0,L),z=parseInt(x.substr(L+1));if((ae=D.search(/\./))>-1){var M=D.substr(ae+1).length;if(M>z){var P=D.substr(0,ae)+D.substr(ae+1).substr(0,z);P=long_int.$from_int(P)}else P=D.substr(0,ae)+D.substr(ae+1)+"0".repeat(z-M),P=long_int.$from_int(P)}else P=long_int.$from_int(D+"0".repeat(z))}else P=(ae=x.search(/\./))>-1?long_int.$from_int(x.substr(0,ae)):long_int.$from_int(x)}return P.pos=l,P}if(isinstance(n,_b_.float)){if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)return n;n=new Number(n>=0?Math.round(n.value):Math.ceil(n.value))}else{if(isinstance(n,_b_.bool))return n.valueOf()?int.$factory(1):int.$factory(0);if(n.__class__===long_int)return n;if(isinstance(n,int))n=n.$brython_value+"";else if(isinstance(n,_b_.bool))n=_b_.bool.__int__(n)+"";else if("string"!=typeof n)throw ValueError.$factory("argument of long_int must be a string, not "+$B.class_name(n))}for(var de=!1,ye=(l=!0,0);" "==n.charAt(0)&&n.length;)n=n.substr(1);for(;" "==n.charAt(n.length-1)&&n.length;)n=n.substr(0,n.length-1);if("+"==n.charAt(0)?de=!0:"-"==n.charAt(0)&&(de=!0,l=!1),de){if(1==n.length)throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');n=n.substr(1)}for(;ye<n.length-1&&"0"==n.charAt(ye);)ye++;n=n.substr(ye);for(var he=digits(o),ae=-1,fe=0;fe<n.length;fe++)if("."==n.charAt(fe)&&-1==ae)ae=fe;else if(!he[n.charAt(fe)])throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');if(-1!=ae&&(n=n.substr(0,ae)),10!=o){for(var le="1",q=long_int.$factory(0),Y=n.length;Y--;){var A=mul_pos(le,parseInt(n.charAt(Y),o).toString()).value;q=add_pos(q.value,A),le=mul_pos(le,o.toString()).value}return q}return{__class__:long_int,value:n,pos:l}},$B.set_func_names(long_int,"builtins"),$B.long_int=long_int}(__BRYTHON__),function($B){var _b_=$B.builtins;function $UnsupportedOpType(n,o,l){throw _b_.TypeError.$factory("unsupported operand type(s) for "+n+": '"+o+"' and '"+l+"'")}var complex={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"complex"},$is_class:!0,$native:!0,$descriptors:{real:!0,imag:!0}};function complex2expo(n){var o=Math.sqrt(n.$real*n.$real+n.$imag*n.$imag),l=n.$imag/o,x=n.$real/o;return{norm:o,angle:0==x?1==l?Math.PI/2:3*Math.PI/2:0==l?1==x?0:Math.PI:Math.atan(l/x)}}complex.__abs__=function(n){var o=isFinite(n.$real),l=isFinite(n.$imag);if(o&&isNaN(n.$imag)||l&&isNaN(n.$real)||isNaN(n.$imag)&&isNaN(n.$real))return NaN;if(!o||!l)return 1/0;var x=Math.sqrt(Math.pow(n.$real,2)+Math.pow(n.$imag,2));if(!isFinite(x)&&o&&l)throw _b_.OverflowError.$factory("absolute value too large");return x},complex.__bool__=function(n){return 0!=n.$real||0!=n.$imag},complex.__eq__=function(n,o){return _b_.isinstance(o,complex)?n.$real.valueOf()==o.$real.valueOf()&&n.$imag.valueOf()==o.$imag.valueOf():_b_.isinstance(o,_b_.int)||_b_.isinstance(o,_b_.float)?0==n.$imag&&n.$real==o.valueOf():_b_.NotImplemented},complex.__floordiv__=function(n,o){$UnsupportedOpType("//","complex",$B.get_class(o))},complex.__hash__=function(n){return 1000003*n.$imag+n.$real},complex.__init__=function(){return _b_.None},complex.__invert__=function(n){return~n},complex.__mod__=function(n,o){throw _b_.TypeError.$factory("TypeError: can't mod complex numbers.")},complex.__mro__=[_b_.object],complex.__mul__=function(n,o){return _b_.isinstance(o,complex)?make_complex(n.$real*o.$real-n.$imag*o.$imag,n.$imag*o.$real+n.$real*o.$imag):_b_.isinstance(o,_b_.int)?make_complex(n.$real*o.valueOf(),n.$imag*o.valueOf()):_b_.isinstance(o,_b_.float)?make_complex(n.$real*o,n.$imag*o):_b_.isinstance(o,_b_.bool)?o.valueOf()?n:make_complex(0,0):void $UnsupportedOpType("*",complex,o)},complex.__ne__=function(n,o){var l=complex.__eq__(n,o);return l===_b_.NotImplemented?l:!l},complex.__neg__=function(n){return make_complex(-n.$real,-n.$imag)},complex.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("complex.__new__(): not enough arguments");var o={},l=$B.args("complex",3,{cls:null,real:null,imag:null},["cls","real","imag"],arguments,{real:0,imag:o},null,null),x=l.real,L=l.imag;if("string"==typeof x){if(L!==o)throw _b_.TypeError.$factory("complex() can't take second arg if first is a string");{let de=function(ye){var he=parseFloat(ye.charAt(0)+ye.substr(1).replace(/_/g,""));if(isNaN(he))throw _b_.ValueError.$factory("could not convert string to complex: '"+D+"'");return he};var D=x;(x=x.trim()).startsWith("(")&&x.endsWith(")")&&(x=(x=x.substr(1)).substr(0,x.length-1));var z=/^\s*([\+\-]*[0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)([\+\-]?)([0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)(j?)\s*$/i.exec(x);if(null===z||"."==z[_real]||"."==z[_imag]||".e"==z[_real]||".e"==z[_imag]||"e"==z[_real]||"e"==z[_imag])throw _b_.ValueError.$factory("complex() arg is a malformed string");return""!=z[_j]?""==z[_sign]?(x=0,L="+"==z[_real]||""==z[_real]?1:"-"==z[_real]?-1:de(z[_real])):(x=de(z[_real]),L=""==z[_imag]?1:de(z[_imag]),L="-"==z[_sign]?-L:L):(x=de(z[_real]),L=0),{__class__:complex,$real:x||0,$imag:L||0}}}if(L=L===o?0:L,1==arguments.length&&x.__class__===complex&&0==L)return x;if(_b_.isinstance(x,[_b_.float,_b_.int])&&_b_.isinstance(L,[_b_.float,_b_.int]))return{__class__:complex,$real:x,$imag:L};var M=$B.to_num(x,["__complex__","__float__","__index__"]);if(null===M)throw _b_.TypeError.$factory("complex() first argument must be a  string or a number, not '"+$B.class_name(x)+"'");if(x=M,L=_convert(L),!_b_.isinstance(x,_b_.float)&&!_b_.isinstance(x,_b_.int)&&!_b_.isinstance(x,_b_.complex))throw _b_.TypeError.$factory("complex() argument must be a string or a number");if("string"==typeof L)throw _b_.TypeError.$factory("complex() second arg can't be a string");if(!_b_.isinstance(L,_b_.float)&&!_b_.isinstance(L,_b_.int)&&!_b_.isinstance(L,_b_.complex)&&L!==o)throw _b_.TypeError.$factory("complex() argument must be a string or a number");return L=complex.__mul__(complex.$factory("1j"),L),complex.__add__(L,x)},complex.__pos__=function(n){return n},complex.__pow__=function(n,o){var l=complex2expo(n),x=l.angle,L=Math.pow(l.norm,o);if(_b_.isinstance(o,[_b_.int,_b_.float]))return make_complex(L*Math.cos(x*o),L*Math.sin(x*o));if(_b_.isinstance(o,complex)){var D=o.$real,z=o.$imag,M=Math.pow(l.norm,D)*Math.pow(Math.E,-z*x),P=z*Math.log(l.norm)-D*x;return make_complex(M*Math.cos(P),M*Math.sin(P))}throw _b_.TypeError.$factory("unsupported operand type(s) for ** or pow(): 'complex' and '"+$B.class_name(o)+"'")},complex.__str__=complex.__repr__=function(n){return 0==n.$real?1/n.$real<0?n.$imag<0?"(-0"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"(-0-"+n.$imag+"j)":"(-0+"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"-"+n.$imag+"j":n.$imag+"j":n.$imag>0?"("+n.$real+"+"+n.$imag+"j)":0==n.$imag?1/n.$imag<0?"("+n.$real+"-"+n.$imag+"j)":"("+n.$real+"+"+n.$imag+"j)":"("+n.$real+"-"+-n.$imag+"j)"},complex.__sqrt__=function(n){if(0==n.$imag)return complex(Math.sqrt(n.$real));var o=n.$real,l=n.$imag,x=Math.sqrt((o+sqrt)/2),L=Number.sign(l)*Math.sqrt((-o+sqrt)/2);return make_complex(x,L)},complex.__truediv__=function(n,o){if(_b_.isinstance(o,complex)){if(0==o.$real&&0==o.$imag)throw _b_.ZeroDivisionError.$factory("division by zero");var x=o.$real*o.$real+o.$imag*o.$imag;return make_complex((n.$real*o.$real+n.$imag*o.$imag)/x,(n.$imag*o.$real-n.$real*o.$imag)/x)}if(_b_.isinstance(o,_b_.int)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}$UnsupportedOpType("//","complex",o.__class__)},complex.conjugate=function(n){return make_complex(n.$real,-n.$imag)};var $op_func=function(n,o){throw _b_.TypeError.$factory("TypeError: unsupported operand type(s) for -: 'complex' and '"+$B.class_name(o)+"'")};$op_func+="";var $ops={"&":"and","|":"ior","<<":"lshift",">>":"rshift","^":"xor"};for(var $op in $ops)eval("complex.__"+$ops[$op]+"__ = "+$op_func.replace(/-/gm,$op));complex.__ior__=complex.__or__;var $op_func=function(n,o){if(_b_.isinstance(o,complex))return make_complex(n.$real-o.$real,n.$imag-o.$imag);if(_b_.isinstance(o,_b_.int))return make_complex($B.sub(n.$real,o.valueOf()),n.$imag);if(_b_.isinstance(o,_b_.float))return make_complex(n.$real-o.valueOf(),n.$imag);if(_b_.isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),make_complex(n.$real-l,n.$imag)}throw _b_.TypeError.$factory("unsupported operand type(s) for -: "+n.__repr__()+" and '"+$B.class_name(o)+"'")};complex.__sub__=$op_func,$op_func+="",$op_func=$op_func.replace(/-/gm,"+").replace(/sub/gm,"add"),eval("complex.__add__ = "+$op_func);var $comp_func=function(n,o){if(void 0===o||o==_b_.None)return _b_.NotImplemented;throw _b_.TypeError.$factory("TypeError: no ordering relation is defined for complex numbers")};for(var $op in $comp_func+="",$B.$comps)eval("complex.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(complex),complex.real=function(n){return new Number(n.$real)},complex.real.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")},complex.imag=function(n){return new Number(n.$imag)},complex.imag.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")};var _real=1,_real_mantissa=2,_sign=3,_imag=4,_imag_mantissa=5,_j=6,type_conversions=["__complex__","__float__","__index__"],_convert=function(n){for(var o=n.__class__||$B.get_class(n),l=0;l<type_conversions.length;l++){var x={},L=$B.$getattr(o,type_conversions[l],x);if(L!==x)return L(n)}return null},make_complex=$B.make_complex=function(n,o){return{__class__:complex,$real:n,$imag:o}};complex.$factory=function(){return complex.__new__(complex,...arguments)},$B.set_func_names(complex,"builtins"),_b_.complex=complex}(__BRYTHON__),function(n){var l=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function x(ae){return ae<1e5?ae<100?ae<10?0:1:ae<1e4?ae<1e3?2:3:4:ae<1e7?ae<1e6?5:6:ae<1e9?ae<1e8?7:8:9}function L(ae,fe){if(ae===fe)return 0;if(~~ae===ae&&~~fe===fe){if(0===ae||0===fe)return ae<fe?-1:1;if(ae<0||fe<0){if(fe>=0)return-1;if(ae>=0)return 1;ae=-ae,fe=-fe}al=x(ae),bl=x(fe);var le=0;return al<bl?(ae*=l[bl-al-1],fe/=10,le=-1):al>bl&&(fe*=l[al-bl-1],ae/=10,le=1),ae===fe?le:ae<fe?-1:1}var q=String(ae),Y=String(fe);return q===Y?0:q<Y?-1:1}function D(ae,fe,le,q){var Y=fe+1;if(Y===le)return 1;if(q(ae[Y++],ae[fe])<0){for(;Y<le&&q(ae[Y],ae[Y-1])<0;)Y++;!function(A,N,X){for(X--;N<X;){var oe=A[N];A[N++]=A[X],A[X--]=oe}}(ae,fe,Y)}else for(;Y<le&&q(ae[Y],ae[Y-1])>=0;)Y++;return Y-fe}function z(ae,fe,le,q,Y){for(q===fe&&q++;q<le;q++){for(var A=ae[q],N=fe,X=q;N<X;){var oe=N+X>>>1;Y(A,ae[oe])<0?X=oe:N=oe+1}var H=q-N;switch(H){case 3:ae[N+3]=ae[N+2];case 2:ae[N+2]=ae[N+1];case 1:ae[N+1]=ae[N];break;default:for(;H>0;)ae[N+H]=ae[N+H-1],H--}ae[N]=A}}function M(ae,fe,le,q,Y,A){var N=0,X=0,oe=1;if(A(ae,fe[le+Y])>0){for(X=q-Y;oe<X&&A(ae,fe[le+Y+oe])>0;)N=oe,(oe=1+(oe<<1))<=0&&(oe=X);oe>X&&(oe=X),N+=Y,oe+=Y}else{for(X=Y+1;oe<X&&A(ae,fe[le+Y-oe])<=0;)N=oe,(oe=1+(oe<<1))<=0&&(oe=X);oe>X&&(oe=X);var H=N;N=Y-oe,oe=Y-H}for(N++;N<oe;){var Ce=N+(oe-N>>>1);A(ae,fe[le+Ce])>0?N=Ce+1:oe=Ce}return oe}function P(ae,fe,le,q,Y,A){var N=0,X=0,oe=1;if(A(ae,fe[le+Y])<0){for(X=Y+1;oe<X&&A(ae,fe[le+Y-oe])<0;)N=oe,(oe=1+(oe<<1))<=0&&(oe=X);oe>X&&(oe=X);var H=N;N=Y-oe,oe=Y-H}else{for(X=q-Y;oe<X&&A(ae,fe[le+Y+oe])>=0;)N=oe,(oe=1+(oe<<1))<=0&&(oe=X);oe>X&&(oe=X),N+=Y,oe+=Y}for(N++;N<oe;){var Ce=N+(oe-N>>>1);A(ae,fe[le+Ce])<0?oe=Ce:N=Ce+1}return oe}var de="TimSortAssertion",ye=function(ae){this.name=de,this.message=ae},he=function(ae,fe){var le={array:ae,compare:fe,minGallop:7,length:ae.length,tmpStorageLength:256,stackLength:0,runStart:null,runLength:null,stackSize:0,pushRun:function(q,Y){this.runStart[this.stackSize]=q,this.runLength[this.stackSize]=Y,this.stackSize+=1},mergeRuns:function(){for(;this.stackSize>1;){var q=this.stackSize-2;if(q>=1&&this.runLength[q-1]<=this.runLength[q]+this.runLength[q+1]||q>=2&&this.runLength[q-2]<=this.runLength[q]+this.runLength[q-1])this.runLength[q-1]<this.runLength[q+1]&&q--;else if(this.runLength[q]>this.runLength[q+1])break;this.mergeAt(q)}},forceMergeRuns:function(){for(;this.stackSize>1;){var q=this.stackSize-2;q>0&&this.runLength[q-1]<this.runLength[q+1]&&q--,this.mergeAt(q)}},mergeAt:function(q){var Y=this.compare,A=this.array,N=this.runStart[q],X=this.runLength[q],oe=this.runStart[q+1],H=this.runLength[q+1];this.runLength[q]=X+H,q===this.stackSize-3&&(this.runStart[q+1]=this.runStart[q+2],this.runLength[q+1]=this.runLength[q+2]),this.stackSize--;var Ce=P(A[oe],A,N,X,0,Y);N+=Ce,0!=(X-=Ce)&&0!==(H=M(A[N+X-1],A,oe,H,H-1,Y))&&(X<=H?this.mergeLow(N,X,oe,H):this.mergeHigh(N,X,oe,H))},mergeLow:function(q,Y,A,N){var X=this.compare,oe=this.array,H=this.tmp,Ce=0;for(Ce=0;Ce<Y;Ce++)H[Ce]=oe[q+Ce];var Q=0,xe=A,Pe=q;if(oe[Pe++]=oe[xe++],0!=--N)if(1!==Y){for(var Ge=this.minGallop;;){var Ae=0,Xe=0,Ke=!1;do{if(X(oe[xe],H[Q])<0){if(oe[Pe++]=oe[xe++],Xe++,Ae=0,0==--N){Ke=!0;break}}else if(oe[Pe++]=H[Q++],Ae++,Xe=0,1==--Y){Ke=!0;break}}while((Ae|Xe)<Ge);if(Ke)break;do{if(0!==(Ae=P(oe[xe],H,Q,Y,0,X))){for(Ce=0;Ce<Ae;Ce++)oe[Pe+Ce]=H[Q+Ce];if(Pe+=Ae,Q+=Ae,(Y-=Ae)<=1){Ke=!0;break}}if(oe[Pe++]=oe[xe++],0==--N){Ke=!0;break}if(0!==(Xe=M(H[Q],oe,xe,N,0,X))){for(Ce=0;Ce<Xe;Ce++)oe[Pe+Ce]=oe[xe+Ce];if(Pe+=Xe,xe+=Xe,0==(N-=Xe)){Ke=!0;break}}if(oe[Pe++]=H[Q++],1==--Y){Ke=!0;break}Ge--}while(Ae>=7||Xe>=7);if(Ke)break;Ge<0&&(Ge=0),Ge+=2}if(this.minGallop=Ge,Ge<1&&(this.minGallop=1),1===Y){for(Ce=0;Ce<N;Ce++)oe[Pe+Ce]=oe[xe+Ce];oe[Pe+N]=H[Q]}else{if(0===Y)throw new ye("mergeLow preconditions were not respected");for(Ce=0;Ce<Y;Ce++)oe[Pe+Ce]=H[Q+Ce]}}else{for(Ce=0;Ce<N;Ce++)oe[Pe+Ce]=oe[xe+Ce];oe[Pe+N]=H[Q]}else for(Ce=0;Ce<Y;Ce++)oe[Pe+Ce]=H[Q+Ce]},mergeHigh:function(q,Y,A,N){var X=this.compare,oe=this.array,H=this.tmp,Ce=0;for(Ce=0;Ce<N;Ce++)H[Ce]=oe[A+Ce];var Q=q+Y-1,xe=N-1,Pe=A+N-1,Ge=0,Ae=0;if(oe[Pe--]=oe[Q--],0!=--Y)if(1!==N){for(var Xe=this.minGallop;;){var Ke=0,yt=0,dt=!1;do{if(X(H[xe],oe[Q])<0){if(oe[Pe--]=oe[Q--],Ke++,yt=0,0==--Y){dt=!0;break}}else if(oe[Pe--]=H[xe--],yt++,Ke=0,1==--N){dt=!0;break}}while((Ke|yt)<Xe);if(dt)break;do{if(0!=(Ke=Y-P(H[xe],oe,q,Y,Y-1,X))){for(Y-=Ke,Ae=1+(Pe-=Ke),Ge=1+(Q-=Ke),Ce=Ke-1;Ce>=0;Ce--)oe[Ae+Ce]=oe[Ge+Ce];if(0===Y){dt=!0;break}}if(oe[Pe--]=H[xe--],1==--N){dt=!0;break}if(0!=(yt=N-M(oe[Q],H,0,N,N-1,X))){for(N-=yt,Ae=1+(Pe-=yt),Ge=1+(xe-=yt),Ce=0;Ce<yt;Ce++)oe[Ae+Ce]=H[Ge+Ce];if(N<=1){dt=!0;break}}if(oe[Pe--]=oe[Q--],0==--Y){dt=!0;break}Xe--}while(Ke>=7||yt>=7);if(dt)break;Xe<0&&(Xe=0),Xe+=2}if(this.minGallop=Xe,Xe<1&&(this.minGallop=1),1===N){for(Ae=1+(Pe-=Y),Ge=1+(Q-=Y),Ce=Y-1;Ce>=0;Ce--)oe[Ae+Ce]=oe[Ge+Ce];oe[Pe]=H[xe]}else{if(0==N)throw new ye("mergeHigh preconditions were not respected");for(Ge=Pe-(N-1),Ce=0;Ce<N;Ce++)oe[Ge+Ce]=H[Ce]}}else{for(Ae=1+(Pe-=Y),Ge=1+(Q-=Y),Ce=Y-1;Ce>=0;Ce--)oe[Ae+Ce]=oe[Ge+Ce];oe[Pe]=H[xe]}else for(Ge=Pe-(N-1),Ce=0;Ce<N;Ce++)oe[Ge+Ce]=H[Ce]}};return le.length<512&&(le.tmpStorageLength=le.length>>>1),le.tmp=new Array(le.tmpStorageLength),le.stackLength=le.length<120?5:le.length<1542?10:le.length<119151?19:40,le.runStart=new Array(le.stackLength),le.runLength=new Array(le.stackLength),le};n.$TimSort=function(ae,fe){try{!function(le,q,Y,A){if(!Array.isArray(le))throw TypeError.$factory("Can only sort arrays");q?"function"!=typeof q&&(A=Y,Y=q,q=L):q=L,Y||(Y=0),A||(A=le.length);var N=A-Y;if(!(N<2)){var X=0;if(N<32)z(le,Y,A,Y+(X=D(le,Y,A,q)),q);else{var oe=new he(le,q),H=function(Q){for(var xe=0;Q>=32;)xe|=1&Q,Q>>=1;return Q+xe}(N);do{if((X=D(le,Y,A,q))<H){var Ce=N;Ce>H&&(Ce=H),z(le,Y,Y+Ce,Y+X,q),X=Ce}oe.pushRun(Y,X),oe.mergeRuns(),N-=X,Y+=X}while(0!==N);oe.forceMergeRuns()}}}(ae,fe,0,ae.length)}catch(le){if(le.name!=de)throw le;ae.sort(fe)}},n.$AlphabeticalCompare=L}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=n.$getattr,L=o.isinstance,D=o.None;function z(le,q){if(le.__class__===ae)throw o.AttributeError.$factory("'tuple' object has no attribute '"+q+"'")}var M={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"list"},$is_class:!0,$native:!0,__dir__:l.__dir__,__add__:function(le,q){if(n.get_class(le)!==n.get_class(q)){var Y=x(q,"__radd__",o.NotImplemented);if(Y!==o.NotImplemented)return Y(le);throw o.TypeError.$factory('can only concatenate list (not "'+n.class_name(q)+'") to list')}var A=le.slice(),N="js"==q.$brython_class;for(const X of q)A.push(N?n.$JS2Py(X):X);return A.__brython__=!0,L(le,ae)&&(A=ae.$factory(A)),A},__class_getitem__:function(le,q){return Array.isArray(q)||(q=[q]),n.GenericAlias.$factory(le,q)},__contains__:function(le,q){for(var A=n.args("__contains__",2,{self:null,item:null},["self","item"],arguments,{},null,null),N=(le=A.self,q=A.item,0);N<le.length;){if(n.rich_comp("__eq__",q,le[N]))return!0;N++}return!1},__delitem__:function(le,q){if(L(q,o.int)){var Y=q;if(q<0&&(Y=le.length+Y),Y>=0&&Y<le.length)return le.splice(Y,1),D;throw o.IndexError.$factory(n.class_name(le)+" index out of range")}if(L(q,o.slice)){var A=q.step;A===D&&(A=1);var N=q.start;N===D&&(N=A>0?0:le.length);var X=q.stop;X===D&&(X=A>0?le.length:0),N<0&&(N=le.length+N),X<0&&(X=le.length+X);var oe=[],H=null;if(Y=0,A>0){if(X>N)for(H=N;H<X;H+=A)void 0!==le[H]&&(oe[Y++]=H)}else if(X<N){for(H=N;H>X;H+=A)void 0!==le[H]&&(oe[Y++]=H);oe.reverse()}for(H=oe.length;H--;)le.splice(oe[H],1);return D}if(o.hasattr(q,"__int__")||o.hasattr(q,"__index__"))return M.__delitem__(le,o.int.$factory(q)),D;throw o.TypeError.$factory(n.class_name(le)+" indices must be integer, not "+n.class_name(q))},__eq__:function(le,q){if(L(le,M))var Y=M;else Y=ae;if(L(q,Y)&&q.length==le.length){for(var A=le.length;A--;)if(!n.rich_comp("__eq__",le[A],q[A]))return!1;return!0}return o.NotImplemented},__getitem__:function(le,q){return n.check_no_kw("__getitem__",le,q),n.check_nb_args("__getitem__",2,arguments),M.$getitem(le,q)},$getitem:function(le,q){var Y=(le.__class__||n.get_class(le)).$factory;if(L(q,o.int)){var A=le.valueOf(),N=q;if(q<0&&(N=A.length+N),N>=0&&N<A.length)return A[N];throw o.IndexError.$factory(n.class_name(le)+" index out of range")}if(q.__class__===o.slice||L(q,o.slice)){if(q.start===o.None&&q.stop===o.None&&q.step===o.None)return le.slice();var X=o.slice.$conv_for_seq(q,le.length),oe=[],H=null,Ce=(A=le.valueOf(),N=0,X.start),Q=X.stop,xe=X.step;if(xe>0){if(Q<=Ce)return Y(oe);for(H=Ce;H<Q;H+=xe)oe[N++]=A[H];return Y(oe)}if(Q>Ce)return Y(oe);for(H=Ce;H>Q;H+=xe)oe[N++]=A[H];return Y(oe)}if(o.hasattr(q,"__int__")||o.hasattr(q,"__index__"))return M.__getitem__(le,o.int.$factory(q));throw o.TypeError.$factory(n.class_name(le)+" indices must be integer, not "+n.class_name(q))},__ge__:function(le,q){if(!L(q,[M,o.tuple]))return o.NotImplemented;for(var Y=0;Y<le.length;){if(Y>=q.length)return!0;if(!n.rich_comp("__eq__",le[Y],q[Y])){if(res=x(le[Y],"__ge__")(q[Y]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[Y])+"() >= "+n.class_name(q[Y])+"()");return res}Y++}return q.length==le.length},__gt__:function(le,q){if(!L(q,[M,o.tuple]))return o.NotImplemented;for(var Y=0;Y<le.length;){if(Y>=q.length)return!0;if(!n.rich_comp("__eq__",le[Y],q[Y])){if(res=x(le[Y],"__gt__")(q[Y]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[Y])+"() > "+n.class_name(q[Y])+"()");return res}Y++}return!1}};M.__hash__=D,M.__iadd__=function(){var le=n.args("__iadd__",2,{self:null,x:null},["self","x"],arguments,{},null,null),q=x(le.x,"__radd__",o.NotImplemented);if(q!==o.NotImplemented)return q(le.self);for(var Y=M.$factory(n.$iter(le.x)),A=0;A<Y.length;A++)le.self.push(Y[A]);return le.self},M.__imul__=function(){var le=n.args("__imul__",2,{self:null,x:null},["self","x"],arguments,{},null,null),q=n.$GetInt(le.x),Y=le.self.length,A=Y;if(0==q)return M.clear(le.self),le.self;for(var N=1;N<q;N++)for(j=0;j<Y;j++)le.self[A++]=le.self[j];return le.self},M.__init__=function(le,q){var Y=n.$call(x(le,"__len__")),A=x(le,"pop",D);if(A!==D)for(A=n.$call(A);Y();)A();if(void 0===q)return D;q=n.$iter(q);for(var N=n.$call(x(q,"__next__")),X=Y();;)try{var oe=N();le[X++]=oe}catch(H){if(H.__class__===o.StopIteration)break;throw H}return D};var P=n.make_iterator_class("list_iterator");P.__reduce__=P.__reduce_ex__=function(le){return n.fast_tuple([o.iter,n.fast_tuple([M.$factory(le)]),0])},M.__iter__=function(le){return P.$factory(le)},M.__le__=function(le,q){var Y=M.__ge__(le,q);return Y===o.NotImplemented?Y:!Y},M.__len__=function(le){return le.length},M.__lt__=function(le,q){if(!L(q,[M,o.tuple]))return o.NotImplemented;for(var Y=0;Y<le.length;){if(Y>=q.length)return!1;if(!n.rich_comp("__eq__",le[Y],q[Y])){if(res=x(le[Y],"__lt__")(q[Y]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[Y])+"() >= "+n.class_name(q[Y])+"()");return res}Y++}return q.length>le.length},M.__mul__=function(le,q){if(L(q,o.int)){for(var Y=[],A=le.slice(),N=A.length,X=0;X<q;X++)for(var oe=0;oe<N;oe++)Y.push(A[oe]);return Y.__class__=le.__class__,Y}if(o.hasattr(q,"__int__")||o.hasattr(q,"__index__"))return M.__mul__(le,o.int.$factory(q));var H=n.$getattr(q,"__rmul__",o.NotImplemented);if(H!==o.NotImplemented)return H(le);throw o.TypeError.$factory("can't multiply sequence by non-int of type '"+n.class_name(q)+"'")},M.__new__=function(le,...q){if(void 0===le)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Y=[];return Y.__class__=le,Y.__brython__=!0,Y.__dict__=n.empty_dict(),Y},M.__repr__=function(le){if(n.repr.enter(le))return"[...]";for(var q,Y=[],A=0;A<le.length;A++)Y.push(o.repr(le[A]));return q=le.__class__===ae?1==le.length?"("+Y[0]+",)":"("+Y.join(", ")+")":"["+Y.join(", ")+"]",n.repr.leave(le),q},M.__setattr__=function(le,q,Y){if(le.__class__===M)throw M.hasOwnProperty(q)?o.AttributeError.$factory("'list' object attribute '"+q+"' is read-only"):o.AttributeError.$factory("'list' object has no attribute '"+q+"'");return o.dict.$setitem(le.__dict__,q,Y),D},M.__setitem__=function(){var le=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);M.$setitem(le.self,le.key,le.value)},M.$setitem=function(le,q,Y){if("number"==typeof q||L(q,o.int)){var A=q;if(q<0&&(A=le.length+A),!(A>=0&&A<le.length))throw o.IndexError.$factory("list index out of range");return le[A]=Y,D}if(L(q,o.slice)){var N=o.slice.$conv_for_seq(q,le.length);return null===q.step?n.set_list_slice(le,N.start,N.stop,Y):n.set_list_slice_step(le,N.start,N.stop,N.step,Y),D}if(o.hasattr(q,"__int__")||o.hasattr(q,"__index__"))return M.__setitem__(le,o.int.$factory(q),Y),D;throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(q))},n.make_rmethods(M),M.append=function(le,q){return n.check_no_kw("append",le,q),n.check_nb_args("append",2,arguments),le.push(q),D},M.clear=function(){for(var le=n.args("clear",1,{self:null},["self"],arguments,{},null,null);le.self.length;)le.self.pop();return D},M.copy=function(){return n.args("copy",1,{self:null},["self"],arguments,{},null,null).self.slice()},M.count=function(){for(var q=n.args("count",2,{self:null,x:null},["self","x"],arguments,{},null,null),Y=0,A=q.self.length;A--;)n.rich_comp("__eq__",q.x,q.self[A])&&Y++;return Y},M.extend=function(){for(var le=n.args("extend",2,{self:null,t:null},["self","t"],arguments,{},null,null),q=M.$factory(n.$iter(le.t)),Y=0;Y<q.length;Y++)le.self.push(q[Y]);return D},M.index=function(){var q={},Y=n.args("index",4,{self:null,x:null,start:null,stop:null},["self","x","start","stop"],arguments,{start:0,stop:q},null,null),A=Y.self,N=Y.start,X=Y.stop;N.__class__===n.long_int&&(N=parseInt(N.value)*(N.pos?1:-1)),N<0&&(N=Math.max(0,N+A.length)),X===q?X=A.length:(X.__class__===n.long_int&&(X=parseInt(X.value)*(X.pos?1:-1)),X<0&&(X=Math.min(A.length,X+A.length)),X=Math.min(X,A.length));for(var oe=N;oe<X;oe++)if(n.rich_comp("__eq__",Y.x,A[oe]))return oe;throw o.ValueError.$factory(o.repr(Y.x)+" is not in "+n.class_name(A))},M.insert=function(){var le=n.args("insert",3,{self:null,i:null,item:null},["self","i","item"],arguments,{},null,null);return le.self.splice(le.i,0,le.item),D},M.pop=function(){var le={},q=n.args("pop",2,{self:null,pos:null},["self","pos"],arguments,{pos:le},null,null),Y=q.self,A=q.pos;z(Y,"pop"),A===le&&(A=Y.length-1),(A=n.$GetInt(A))<0&&(A+=Y.length);var N=Y[A];if(void 0===N)throw o.IndexError.$factory("pop index out of range");return Y.splice(A,1),N},M.remove=function(){for(var le=n.args("remove",2,{self:null,x:null},["self","x"],arguments,{},null,null),q=0,Y=le.self.length;q<Y;q++)if(n.rich_comp("__eq__",le.self[q],le.x))return le.self.splice(q,1),D;throw o.ValueError.$factory(o.str.$factory(le.x)+" is not in list")},M.reverse=function(le){for(var q=n.args("reverse",1,{self:null},["self"],arguments,{},null,null),Y=q.self.length-1,A=parseInt(q.self.length/2);A--;){var N=q.self[A];q.self[A]=q.self[Y-A],q.self[Y-A]=N}return D},M.sort=function(le){var H,q=n.args("sort",1,{self:null},["self"],arguments,{},null,"kw");z(le,"sort");for(var Y=D,A=!1,N=q.kw,X=o.list.$factory(o.dict.$$keys(N)),oe=0;oe<X.length;oe++)if("key"==X[oe])Y=N.$string_dict[X[oe]][0];else{if("reverse"!=X[oe])throw o.TypeError.$factory("'"+X[oe]+"' is an invalid keyword argument for this function");A=N.$string_dict[X[oe]][0]}if(0!=le.length)return Y!==D&&(Y=n.$call(Y)),le.$cl=function(Ce){if(0==Ce.length)return null;for(var Q=n.get_class(Ce[0]),xe=Ce.length;xe--;)if(n.get_class(Ce[xe])!==Q)return!1;return Q}(le),H=Y===D&&le.$cl===o.str?A?function(Ce,Q){return n.$AlphabeticalCompare(Q,Ce)}:function(Ce,Q){return n.$AlphabeticalCompare(Ce,Q)}:Y===D&&le.$cl===o.int?A?function(Ce,Q){return Q-Ce}:function(Ce,Q){return Ce-Q}:Y===D?A?function(Ce,Q){if(res=x(Q,"__lt__")(Ce),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Ce)+"() < "+n.class_name(Q)+"()");return res?Q==Ce?0:-1:1}:function(Ce,Q){if(res=x(Ce,"__lt__")(Q),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Ce)+"() < "+n.class_name(Q)+"()");return res?Ce==Q?0:-1:1}:A?function(Ce,Q){var xe=Y(Q),Pe=Y(Ce);if(res=x(xe,"__lt__")(Pe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Ce)+"() < "+n.class_name(Q)+"()");return res?xe==Pe?0:-1:1}:function(Ce,Q){var xe=Y(Ce),Pe=Y(Q);if(res=n.$getattr(xe,"__lt__")(Pe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Ce)+"() < "+n.class_name(Q)+"()");return res?xe==Pe?0:-1:1},n.$TimSort(le,H),le.__brython__?D:le},n.$list=function(le){return le.__brython__=!0,le},M.$factory=function(){if(0==arguments.length)return[];var le=n.args("list",1,{obj:null},["obj"],arguments,{},null,null).obj;if(Array.isArray(le))return(le=le.slice()).__brython__=!0,le.__class__==ae?((q=le.slice()).__class__=M,q):le;for(var q=[],Y=0,A=n.$iter(le),N=n.$call(x(A,"__next__"));;)try{q[Y++]=N()}catch(X){if(!L(X,o.StopIteration))throw X;break}return q.__brython__=!0,q},n.set_func_names(M,"builtins"),M.__class_getitem__=o.classmethod.$factory(M.__class_getitem__);var de=n.JSArray=n.make_class("JSArray",function(le){return{__class__:de,js:le}});function ye(le){for(var q=[le[0].js],Y=1,A=le.length;Y<A;Y++)q.push(le[Y]);return q}for(var he in de.__repr__=de.__str__=function(){return"<JSArray object>"},M)void 0===n.JSArray[he]&&"function"==typeof M[he]&&(n.JSArray[he]=function(le){return function(){return n.$JS2Py(M[le].apply(null,ye(arguments)))}}(he));n.set_func_names(n.JSArray,"builtins");var ae={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"tuple"},$is_class:!0,$native:!0},fe=n.make_iterator_class("tuple_iterator");for(var he in ae.__iter__=function(q){return fe.$factory(q)},ae.$factory=function(){var q=M.$factory(...arguments);return q.__class__=ae,q},n.fast_tuple=function(q){return q.__class__=ae,q.__brython__=!0,q.__dict__=n.empty_dict(),q},M)switch(he){case"__delitem__":case"__iadd__":case"__imul__":case"__setitem__":case"append":case"extend":case"insert":case"remove":case"reverse":break;default:void 0===ae[he]&&"function"==typeof M[he]&&(ae[he]=function(q){return function(){return M[q].apply(null,arguments)}}(he))}ae.__eq__=function(le,q){return void 0===q?le===ae:M.__eq__(le,q)},ae.__hash__=function(le){for(var q,Y=54880137,A=0,N=le.length;A<N;A++){var X=o.hash(le[A]);q=Y,s=(parseInt(1000003)*q&4294967295).toString(16),Y=parseInt(s.substr(0,s.length-1),16)^4294967295&X}return Y},ae.__init__=function(){return D},ae.__new__=function(le,...q){if(void 0===le)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Y=[];Y.__class__=le,Y.__brython__=!0,Y.__dict__=n.empty_dict();for(var A=n.$iter(q[0]),N=n.$call(x(A,"__next__"));;)try{var X=N();Y.push(X)}catch(oe){if(oe.__class__===o.StopIteration)break;throw oe}return Y},n.set_func_names(ae,"builtins"),o.list=M,o.tuple=ae,o.object.__bases__=ae.$factory()}(__BRYTHON__);var $B=__BRYTHON__;for(var gc in $B.unicode={Cc:[[0,32],[127,33]],Zs:[32,160,5760,6158,[8192,11],8239,8287,12288],Po:[[33,3],[37,3],[42,3,2],47,58,59,63,64,92,161,183,191,894,903,[1370,6],1417,[1472,3,3],1523,1524,1545,1546,1548,1549,1563,1566,1567,[1642,4],1748,[1792,14],[2039,3],[2096,15],2404,2405,2416,3572,3663,3674,3675,[3844,15],3973,[4048,5],[4170,6],4347,[4961,8],5741,5742,[5867,3],5941,5942,[6100,3],[6104,3],[6144,6],[6151,4],6468,6469,6622,6623,6686,6687,[6816,7],[6824,6],[7002,7],[7227,5],7294,7295,7379,8214,8215,[8224,8],[8240,9],[8251,4],[8257,3],[8263,11],8275,[8277,10],[11513,4],11518,11519,11776,11777,[11782,3],11787,[11790,9],11800,11801,11803,11806,11807,[11818,5],11824,11825,[12289,3],12349,12539,42238,42239,[42509,3],42611,42622,[42738,6],[43124,4],43214,43215,[43256,3],43310,43311,43359,[43457,13],43486,43487,[43612,4],43742,43743,44011,[65040,7],65049,65072,65093,65094,[65097,4],[65104,3],[65108,4],[65119,3],65128,65130,65131,[65281,3],[65285,3],[65290,3,2],65295,65306,65307,65311,65312,65340,65377,65380,65381,65792,65793,66463,66512,67671,67871,67903,[68176,9],68223,[68409,7],69819,69820,[69822,4],[74864,4]],Sc:[36,[162,4],1547,2546,2547,2555,2801,3065,3647,6107,[8352,25],43064,65020,65129,65284,65504,65505,65509,65510],Ps:[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,9001,[10088,7,2],10181,[10214,5,2],[10627,11,2],10712,10714,10748,[11810,4,2],[12296,5,2],[12308,4,2],12317,64830,65047,[65077,8,2],65095,[65113,3,2],65288,65339,65371,65375,65378],Pe:[41,93,125,3899,3901,5788,8262,8318,8334,9002,[10089,7,2],10182,[10215,5,2],[10628,11,2],10713,10715,10749,[11811,4,2],[12297,5,2],[12309,4,2],12318,12319,64831,65048,[65078,8,2],65096,[65114,3,2],65289,65341,[65373,3,3]],Sm:[43,[60,3],124,126,172,177,215,247,1014,[1542,3],8260,8274,[8314,3],[8330,3],[8512,5],8523,[8592,5],8602,8603,[8608,3,3],8622,8654,8655,8658,8660,[8692,268],[8968,4],8992,8993,9084,[9115,25],[9180,6],9655,9665,[9720,8],9839,[10176,5],[10183,4],10188,[10192,22],[10224,16],[10496,131],[10649,63],[10716,32],[10750,258],[11056,21],[11079,6],64297,65122,[65124,3],65291,[65308,3],65372,65374,65506,[65513,4],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771],Pd:[45,1418,1470,5120,6150,[8208,6],11799,11802,12316,12336,12448,65073,65074,65112,65123,65293],Nd:[[48,10],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],[42528,10],[43216,10],[43264,10],[43472,10],[43600,10],[44016,10],[65296,10],[66720,10],[120782,50]],Lu:[[65,26],[192,23],[216,7],[256,28,2],[313,8,2],[330,24,2],[377,3,2],385,[386,3,2],391,[393,3],[398,4],403,404,[406,3],412,413,415,[416,4,2],423,425,428,430,431,[433,3],437,439,440,444,[452,4,3],[463,7,2],[478,9,2],497,500,[502,3],[506,29,2],570,571,573,574,577,[579,4],[584,4,2],880,882,886,902,[904,3],908,910,911,[913,17],[931,9],975,[978,3],[984,12,2],1012,1015,1017,1018,[1021,51],[1120,17,2],[1162,28,2],[1217,7,2],[1232,43,2],[1329,38],[4256,38],[7680,75,2],[7838,49,2],[7944,8],[7960,6],[7976,8],[7992,8],[8008,6],[8025,4,2],[8040,8],[8120,4],[8136,4],[8152,4],[8168,5],[8184,4],8450,8455,[8459,3],[8464,3],8469,[8473,5],[8484,4,2],[8491,3],[8496,4],8510,8511,8517,8579,[11264,47],11360,[11362,3],[11367,4,2],[11374,3],11378,11381,[11390,3],[11394,49,2],11499,11501,[42560,16,2],[42594,6,2],[42624,12,2],[42786,7,2],[42802,31,2],[42873,3,2],[42878,5,2],42891,[65313,26],[66560,40],[119808,26],[119860,26],[119912,26],119964,119966,[119967,3,3],119974,[119977,4],[119982,8],[120016,26],120068,120069,[120071,4],[120077,8],[120086,7],120120,120121,[120123,4],[120128,5],120134,[120138,7],[120172,26],[120224,26],[120276,26],[120328,26],[120380,26],[120432,26],[120488,25],[120546,25],[120604,25],[120662,25],[120720,25],120778],Sk:[94,96,168,175,180,184,[706,4],[722,14],[741,7],749,[751,17],885,900,901,8125,[8127,3],[8141,3],[8157,3],[8173,3],8189,8190,12443,12444,[42752,23],42784,42785,42889,42890,65342,65344,65507],Pc:[95,8255,8256,8276,65075,65076,[65101,3],65343],Ll:[[97,26],170,181,186,[223,24],[248,8],[257,28,2],[312,9,2],[329,24,2],[378,3,2],383,384,387,389,392,396,397,402,405,[409,3],414,[417,3,2],424,426,427,429,432,436,438,441,442,[445,3],[454,3,3],[462,8,2],[477,10,2],496,499,501,[505,30,2],[564,6],572,575,576,578,[583,5,2],[592,68],[661,27],881,[883,3,4],892,893,912,[940,35],976,977,[981,3],[985,12,2],[1008,4],[1013,3,3],1020,[1072,48],[1121,17,2],[1163,27,2],[1218,7,2],[1231,44,2],[1377,39],[7424,44],[7522,22],[7545,34],[7681,75,2],[7830,8],[7839,49,2],[7936,8],[7952,6],[7968,8],[7984,8],[8e3,6],[8016,8],[8032,8],[8048,14],[8064,8],[8080,8],[8096,8],[8112,5],8118,8119,8126,[8130,3],8134,8135,[8144,4],8150,8151,[8160,8],[8178,3],8182,8183,8458,8462,8463,8467,[8495,3,5],8508,8509,[8518,4],8526,8580,[11312,47],11361,11365,[11366,4,2],11377,11379,11380,[11382,7],[11393,50,2],11492,11500,11502,[11520,38],[42561,16,2],[42595,6,2],[42625,12,2],[42787,7,2],42800,[42801,33,2],[42866,7],42874,42876,[42879,5,2],42892,[64256,7],[64275,5],[65345,26],[66600,40],[119834,26],[119886,7],[119894,18],[119938,26],[119990,4],119995,[119997,7],[120005,11],[120042,26],[120094,26],[120146,26],[120198,26],[120250,26],[120302,26],[120354,26],[120406,26],[120458,28],[120514,25],[120540,6],[120572,25],[120598,6],[120630,25],[120656,6],[120688,25],[120714,6],[120746,25],[120772,6],120779],So:[166,167,169,174,176,182,1154,1550,1551,1769,1789,1790,2038,2554,2928,[3059,6],3066,3199,3313,3314,3449,[3841,3],[3859,5],[3866,6],[3892,3,2],[4030,8],[4039,6],4046,4047,[4053,4],4254,4255,4960,[5008,10],6464,[6624,32],[7009,10],[7028,9],8448,8449,[8451,4],8456,8457,8468,[8470,3],[8478,6],[8485,3,2],8494,8506,8507,8522,8524,8525,8527,[8597,5],[8604,4],8609,8610,8612,8613,[8615,7],[8623,31],8656,[8657,3,2],[8662,30],[8960,8],[8972,20],[8994,7],[9003,81],[9085,30],[9140,40],[9186,7],[9216,39],[9280,11],[9372,78],[9472,183],[9656,9],[9666,54],[9728,111],[9840,94],[9935,19],9955,[9960,24],[9985,4],[9990,4],[9996,28],[10025,35],10061,[10063,4],[10070,9],[10081,7],10132,[10136,24],[10161,14],[10240,256],[11008,48],11077,11078,[11088,10],[11493,6],[11904,26],[11931,89],[12032,214],[12272,12],12292,12306,12307,12320,12342,12343,12350,12351,12688,12689,[12694,10],[12736,36],[12800,31],[12842,39],[12896,32],[12938,39],[12992,63],[13056,256],[19904,64],[42128,55],[43048,4],43062,43063,43065,[43639,3],65021,65508,65512,65517,65518,65532,65533,65794,[65847,9],[65913,17],[65936,12],[66e3,45],[118784,246],[119040,39],[119081,60],[119146,3],119171,119172,[119180,30],[119214,48],[119296,66],119365,[119552,87],[126976,44],[127024,100],[127248,31],127281,127293,127295,[127298,3,4],[127307,4],127319,127327,127353,127355,127356,127359,[127370,4],127376,127488,[127504,34],[127552,9]],Pi:[171,8216,8219,8220,8223,8249,11778,11780,11785,11788,11804,11808],Cf:[173,[1536,4],1757,1807,6068,6069,[8203,5],[8234,5],[8288,5],[8298,6],65279,[65529,3],69821,[119155,8],917505,[917536,96]],No:[178,179,185,[188,3],[2548,6],[3056,3],[3192,7],[3440,6],[3882,10],[4969,20],[6128,10],8304,[8308,6],[8320,10],[8528,16],8585,[9312,60],[9450,22],[10102,30],11517,[12690,4],[12832,10],[12881,15],[12928,10],[12977,15],[43056,6],[65799,45],[65909,4],65930,[66336,4],[67672,8],[67862,6],[68160,8],68221,68222,[68440,8],[68472,8],[69216,31],[119648,18],[127232,11]],Pf:[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],Lo:[443,[448,4],660,[1488,27],[1520,3],[1569,31],[1601,10],1646,1647,[1649,99],1749,1774,1775,[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2048,22],[2308,54],2365,2384,[2392,10],2418,[2425,7],[2437,8],2447,2448,[2451,22],[2474,7],2482,[2486,4],2493,2510,2524,2525,[2527,3],2544,2545,[2565,6],2575,2576,[2579,22],[2602,7],2610,2611,2613,2614,2616,2617,[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],2738,2739,[2741,5],2749,2768,2784,2785,[2821,8],2831,2832,[2835,22],[2858,7],2866,2867,[2869,5],2877,2908,2909,[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],2969,[2970,3,2],2975,2979,2980,[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,3160,3161,3168,3169,[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,3296,3297,[3333,8],[3342,3],[3346,23],[3370,16],3389,3424,3425,[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,3635,[3648,6],3713,3714,3716,3719,3720,3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,3754,3755,[3757,4],3762,3763,3773,[3776,5],3804,3805,3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,4197,4198,[4206,3],[4213,13],4238,[4304,43],[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6108,[6176,35],[6212,52],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],[6917,47],[6981,7],[7043,30],7086,7087,[7168,36],[7245,3],[7258,30],[7401,4],[7406,4],[8501,4],[11568,54],[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12294,12348,[12353,86],12447,[12449,90],12543,[12549,41],[12593,94],[12704,24],[12784,16],13312,19893,19968,40907,[40960,21],[40982,1143],[42192,40],[42240,268],[42512,16],42538,42539,42606,[42656,70],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],[43520,41],[43584,3],[43588,8],[43616,16],[43633,6],43642,[43648,48],43697,43701,43702,[43705,5],43712,43714,43739,43740,[43968,35],44032,55203,[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],64285,[64287,10],[64298,13],[64312,5],64318,64320,64321,64323,64324,[64326,108],[64467,363],[64848,64],[64914,54],[65008,12],[65136,5],[65142,135],[65382,10],[65393,45],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],65596,65597,[65599,15],[65616,14],[65664,123],[66176,29],[66208,49],[66304,31],[66352,17],[66370,8],[66432,30],[66464,36],[66504,8],[66640,78],[67584,6],67592,[67594,44],67639,67640,67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[77824,1071],131072,173782,173824,177972,[194560,542]],Lt:[[453,3,3],498,[8072,8],[8088,8],[8104,8],8124,8140,8188],Lm:[[688,18],[710,12],[736,5],748,750,884,890,1369,1600,1765,1766,2036,2037,2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,6],[7468,54],7544,[7579,37],8305,8319,[8336,5],11389,11631,11823,12293,[12337,5],12347,12445,12446,[12540,3],40981,[42232,6],42508,42623,[42775,9],42864,42888,43471,43632,43741,65392,65438,65439],Mn:[[768,112],[1155,5],[1425,45],1471,1473,1474,1476,1477,1479,[1552,11],[1611,20],1648,[1750,7],[1759,6],1767,1768,[1770,4],1809,[1840,27],[1958,11],[2027,9],[2070,4],[2075,9],[2085,3],[2089,5],[2304,3],2364,[2369,8],2381,[2385,5],2402,2403,2433,2492,[2497,4],2509,2530,2531,2561,2562,2620,2625,2626,2631,2632,[2635,3],2641,2672,2673,2677,2689,2690,2748,[2753,5],2759,2760,2765,2786,2787,2817,2876,2879,[2881,4],2893,2902,2914,2915,2946,3008,3021,[3134,3],[3142,3],[3146,4],3157,3158,3170,3171,3260,3263,3270,3276,3277,3298,3299,[3393,4],3405,3426,3427,3530,[3538,3],3542,3633,[3636,7],[3655,8],3761,[3764,6],3771,3772,[3784,6],3864,3865,[3893,3,2],[3953,14],[3968,5],3974,3975,[3984,8],[3993,36],4038,[4141,4],[4146,6],4153,4154,4157,4158,4184,4185,[4190,3],[4209,4],4226,4229,4230,4237,4253,4959,[5906,3],[5938,3],5970,5971,6002,6003,[6071,7],6086,[6089,11],6109,[6155,3],6313,[6432,3],6439,6440,6450,[6457,3],6679,6680,6742,[6744,7],6752,6754,[6757,8],[6771,10],6783,[6912,4],6964,[6966,5],6972,6978,[7019,9],7040,7041,[7074,4],7080,7081,[7212,8],7222,7223,[7376,3],[7380,13],[7394,7],7405,[7616,39],[7677,3],[8400,13],8417,[8421,12],[11503,3],[11744,32],[12330,6],12441,12442,42607,42620,42621,42736,42737,43010,43014,43019,43045,43046,43204,[43232,18],[43302,8],[43335,11],[43392,3],43443,[43446,4],43452,[43561,6],43569,43570,43573,43574,43587,43596,43696,[43698,3],43703,43704,43710,43711,43713,44005,44008,44013,64286,[65024,16],[65056,7],66045,[68097,3],68101,68102,[68108,4],[68152,3],68159,69760,69761,[69811,4],69817,69818,[119143,3],[119163,8],[119173,7],[119210,4],[119362,3],[917760,240]],Me:[1160,1161,1758,[8413,4],[8418,3],[42608,3]],Mc:[2307,[2366,3],[2377,4],2382,2434,2435,[2494,3],2503,2504,2507,2508,2519,2563,[2622,3],2691,[2750,3],2761,2763,2764,2818,2819,2878,2880,2887,2888,2891,2892,2903,3006,3007,3009,3010,[3014,3],[3018,3],3031,[3073,3],[3137,4],3202,3203,3262,[3264,5],3271,3272,3274,3275,3285,3286,3330,3331,[3390,3],[3398,3],[3402,3],3415,3458,3459,[3535,3],[3544,8],3570,3571,3902,3903,3967,4139,4140,4145,4152,4155,4156,4182,4183,[4194,3],[4199,7],4227,4228,[4231,6],4239,[4250,3],6070,[6078,8],6087,6088,[6435,4],[6441,3],6448,6449,[6451,6],[6576,17],6600,6601,[6681,3],6741,6743,6753,6755,6756,[6765,6],6916,6965,6971,[6973,5],6979,6980,7042,7073,7078,7079,7082,[7204,8],7220,7221,7393,7410,43043,43044,43047,43136,43137,[43188,16],43346,43347,43395,43444,43445,43450,43451,[43453,4],43567,43568,43571,43572,43597,43643,44003,44004,44006,44007,44009,44010,44012,69762,[69808,3],69815,69816,119141,119142,[119149,6]],Nl:[[5870,3],[8544,35],[8581,4],12295,[12321,9],[12344,3],[42726,10],[65856,53],66369,66378,[66513,5],[74752,99]],Zl:[8232],Zp:[8233],Cs:[55296,56191,56192,56319,56320,57343],Co:[57344,63743,983040,1048573,1048576,1114109],digits:[[48,10],178,179,185,[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3558,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[4969,9],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[9312,9],[9332,9],[9352,9],9450,[9461,9],9471,[10102,9],[10112,9],[10122,9],[42528,10],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],[65296,10],[66720,10],[68160,4],[68912,10],[69216,9],[69714,9],[69734,10],[69872,10],[69942,10],[70096,10],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,10],[71904,10],[72784,10],[73040,10],[73120,10],[92768,10],[93008,10],[120782,50],[123200,10],[123632,10],[125264,10],[127232,11]],numeric:[[48,10],178,179,185,[188,3],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2548,6],[2662,10],[2790,10],[2918,10],[2930,6],[3046,13],[3174,10],[3192,7],[3302,10],[3416,7],[3430,19],[3558,10],[3664,10],[3792,10],[3872,20],[4160,10],[4240,10],[4969,20],[5870,3],[6112,10],[6128,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[8528,51],[8581,5],[9312,60],[9450,22],[10102,30],11517,12295,[12321,9],[12344,3],[12690,4],[12832,10],[12872,8],[12881,15],[12928,10],[12977,15],13317,13443,14378,15181,19968,19971,19975,19977,20061,20108,20116,20118,20159,20160,20191,20200,20237,20336,20740,20806,[20841,3,2],21313,[21315,3],21324,[21441,4],22235,22769,22777,24186,24318,24319,[24332,3],24336,25342,25420,26578,28422,29590,30334,32902,33836,36014,36019,36144,38433,38470,38476,38520,38646,[42528,10],[42726,10],[43056,6],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],63851,63859,63864,63922,63953,63955,63997,[65296,10],[65799,45],[65856,57],65930,65931,[66273,27],[66336,4],66369,66378,[66513,5],[66720,10],[67672,8],[67705,7],[67751,9],[67835,5],[67862,6],68028,68029,[68032,16],[68050,46],[68160,9],68221,68222,[68253,3],[68331,5],[68440,8],[68472,8],[68521,7],[68858,6],[68912,10],[69216,31],[69405,10],[69457,4],[69714,30],[69872,10],[69942,10],[70096,10],[70113,20],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,12],[71904,19],[72784,29],[73040,10],[73120,10],[73664,21],[74752,111],[92768,10],[93008,10],[93019,7],[93824,23],[119520,20],[119648,25],[120782,50],[123200,10],[123632,10],[125127,9],[125264,10],[126065,59],[126125,3],[126129,4],[126209,45],[126255,15],[127232,13],131073,131172,131298,131361,133418,133507,133516,133532,133866,133885,133913,140176,141720,146203,156269,194704],Cn:[[888,2],[896,4],[907,1],[909,1],[930,1],[1328,1],[1367,2],[1419,2],[1424,1],[1480,8],[1515,4],[1525,11],[1565,1],[1806,1],[1867,2],[1970,14],[2043,2],[2094,2],[2111,1],[2140,2],[2143,1],[2155,53],[2229,1],[2238,21],[2436,1],[2445,2],[2449,2],[2473,1],[2481,1],[2483,3],[2490,2],[2501,2],[2505,2],[2511,8],[2520,4],[2526,1],[2532,2],[2559,2],[2564,1],[2571,4],[2577,2],[2601,1],[2609,1],[2612,1],[2615,1],[2618,2],[2621,1],[2627,4],[2633,2],[2638,3],[2642,7],[2653,1],[2655,7],[2679,10],[2692,1],[2702,1],[2706,1],[2729,1],[2737,1],[2740,1],[2746,2],[2758,1],[2762,1],[2766,2],[2769,15],[2788,2],[2802,7],[2816,1],[2820,1],[2829,2],[2833,2],[2857,1],[2865,1],[2868,1],[2874,2],[2885,2],[2889,2],[2894,8],[2904,4],[2910,1],[2916,2],[2936,10],[2948,1],[2955,3],[2961,1],[2966,3],[2971,1],[2973,1],[2976,3],[2981,3],[2987,3],[3002,4],[3011,3],[3017,1],[3022,2],[3025,6],[3032,14],[3067,5],[3085,1],[3089,1],[3113,1],[3130,3],[3141,1],[3145,1],[3150,7],[3159,1],[3163,5],[3172,2],[3184,7],[3213,1],[3217,1],[3241,1],[3252,1],[3258,2],[3269,1],[3273,1],[3278,7],[3287,7],[3295,1],[3300,2],[3312,1],[3315,13],[3332,1],[3341,1],[3345,1],[3397,1],[3401,1],[3408,4],[3428,2],[3456,2],[3460,1],[3479,3],[3506,1],[3516,1],[3518,2],[3527,3],[3531,4],[3541,1],[3543,1],[3552,6],[3568,2],[3573,12],[3643,4],[3676,37],[3715,1],[3717,1],[3723,1],[3748,1],[3750,1],[3774,2],[3781,1],[3783,1],[3790,2],[3802,2],[3808,32],[3912,1],[3949,4],[3992,1],[4029,1],[4045,1],[4059,37],[4294,1],[4296,5],[4302,2],[4681,1],[4686,2],[4695,1],[4697,1],[4702,2],[4745,1],[4750,2],[4785,1],[4790,2],[4799,1],[4801,1],[4806,2],[4823,1],[4881,1],[4886,2],[4955,2],[4989,3],[5018,6],[5110,2],[5118,2],[5789,3],[5881,7],[5901,1],[5909,11],[5943,9],[5972,12],[5997,1],[6001,1],[6004,12],[6110,2],[6122,6],[6138,6],[6159,1],[6170,6],[6265,7],[6315,5],[6390,10],[6431,1],[6444,4],[6460,4],[6465,3],[6510,2],[6517,11],[6572,4],[6602,6],[6619,3],[6684,2],[6751,1],[6781,2],[6794,6],[6810,6],[6830,2],[6847,65],[6988,4],[7037,3],[7156,8],[7224,3],[7242,3],[7305,7],[7355,2],[7368,8],[7419,5],[7674,1],[7958,2],[7966,2],[8006,2],[8014,2],[8024,1],[8026,1],[8028,1],[8030,1],[8062,2],[8117,1],[8133,1],[8148,2],[8156,1],[8176,2],[8181,1],[8191,1],[8293,1],[8306,2],[8335,1],[8349,3],[8384,16],[8433,15],[8588,4],[9255,25],[9291,21],[11124,2],[11158,2],[11311,1],[11359,1],[11508,5],[11558,1],[11560,5],[11566,2],[11624,7],[11633,14],[11671,9],[11687,1],[11695,1],[11703,1],[11711,1],[11719,1],[11727,1],[11735,1],[11743,1],[11856,48],[11930,1],[12020,12],[12246,26],[12284,4],[12352,1],[12439,2],[12544,5],[12592,1],[12687,1],[12731,5],[12772,12],[12831,1],[19894,10],[40944,16],[42125,3],[42183,9],[42540,20],[42744,8],[42944,2],[42951,48],[43052,4],[43066,6],[43128,8],[43206,8],[43226,6],[43348,11],[43389,3],[43470,1],[43482,4],[43519,1],[43575,9],[43598,2],[43610,2],[43715,24],[43767,10],[43783,2],[43791,2],[43799,9],[43815,1],[43823,1],[43880,8],[44014,2],[44026,6],[55204,12],[55239,4],[55292,4],[64110,2],[64218,38],[64263,12],[64280,5],[64311,1],[64317,1],[64319,1],[64322,1],[64325,1],[64450,17],[64832,16],[64912,2],[64968,40],[65022,2],[65050,6],[65107,1],[65127,1],[65132,4],[65141,1],[65277,2],[65280,1],[65471,3],[65480,2],[65488,2],[65496,2],[65501,3],[65511,1],[65519,10],[65534,2],[65548,1],[65575,1],[65595,1],[65598,1],[65614,2],[65630,34],[65787,5],[65795,4],[65844,3],[65935,1],[65948,4],[65953,47],[66046,130],[66205,3],[66257,15],[66300,4],[66340,9],[66379,5],[66427,5],[66462,1],[66500,4],[66518,42],[66718,2],[66730,6],[66772,4],[66812,4],[66856,8],[66916,11],[66928,144],[67383,9],[67414,10],[67432,152],[67590,2],[67593,1],[67638,1],[67641,3],[67645,2],[67670,1],[67743,8],[67760,48],[67827,1],[67830,5],[67868,3],[67898,5],[67904,64],[68024,4],[68048,2],[68100,1],[68103,5],[68116,1],[68120,1],[68150,2],[68155,4],[68169,7],[68185,7],[68256,32],[68327,4],[68343,9],[68406,3],[68438,2],[68467,5],[68498,7],[68509,12],[68528,80],[68681,55],[68787,13],[68851,7],[68904,8],[68922,294],[69247,129],[69416,8],[69466,134],[69623,9],[69710,4],[69744,15],[69826,11],[69838,2],[69865,7],[69882,6],[69941,1],[69959,9],[70007,9],[70094,2],[70112,1],[70133,11],[70162,1],[70207,65],[70279,1],[70281,1],[70286,1],[70302,1],[70314,6],[70379,5],[70394,6],[70404,1],[70413,2],[70417,2],[70441,1],[70449,1],[70452,1],[70458,1],[70469,2],[70473,2],[70478,2],[70481,6],[70488,5],[70500,2],[70509,3],[70517,139],[70746,1],[70748,1],[70752,32],[70856,8],[70874,166],[71094,2],[71134,34],[71237,11],[71258,6],[71277,19],[71353,7],[71370,54],[71451,2],[71468,4],[71488,192],[71740,100],[71923,12],[71936,160],[72104,2],[72152,2],[72165,27],[72264,8],[72355,29],[72441,263],[72713,1],[72759,1],[72774,10],[72813,3],[72848,2],[72872,1],[72887,73],[72967,1],[72970,1],[73015,3],[73019,1],[73022,1],[73032,8],[73050,6],[73062,1],[73065,1],[73103,1],[73106,1],[73113,7],[73130,310],[73465,199],[73714,13],[74650,102],[74863,1],[74869,11],[75076,2748],[78895,1],[78905,4039],[83527,8633],[92729,7],[92767,1],[92778,4],[92784,96],[92910,2],[92918,10],[92998,10],[93018,1],[93026,1],[93048,5],[93072,688],[93851,101],[94027,4],[94088,7],[94112,64],[94180,28],[100344,8],[101107,9485],[110879,49],[110931,17],[110952,8],[111356,2308],[113771,5],[113789,3],[113801,7],[113818,2],[113828,4956],[119030,10],[119079,2],[119273,23],[119366,154],[119540,12],[119639,9],[119673,135],[119893,1],[119965,1],[119968,2],[119971,2],[119975,2],[119981,1],[119994,1],[119996,1],[120004,1],[120070,1],[120075,2],[120085,1],[120093,1],[120122,1],[120127,1],[120133,1],[120135,3],[120145,1],[120486,2],[120780,2],[121484,15],[121504,1],[121520,1360],[122887,1],[122905,2],[122914,1],[122917,1],[122923,213],[123181,3],[123198,2],[123210,4],[123216,368],[123642,5],[123648,1280],[125125,2],[125143,41],[125260,4],[125274,4],[125280,785],[126133,76],[126270,194],[126468,1],[126496,1],[126499,1],[126501,2],[126504,1],[126515,1],[126520,1],[126522,1],[126524,6],[126531,4],[126536,1],[126538,1],[126540,1],[126544,1],[126547,1],[126549,2],[126552,1],[126554,1],[126556,1],[126558,1],[126560,1],[126563,1],[126565,2],[126571,1],[126579,1],[126584,1],[126589,1],[126591,1],[126602,1],[126620,5],[126628,1],[126634,1],[126652,52],[126706,270],[127020,4],[127124,12],[127151,2],[127168,1],[127184,1],[127222,10],[127245,3],[127341,3],[127405,57],[127491,13],[127548,4],[127561,7],[127570,14],[127590,154],[128726,10],[128749,3],[128763,5],[128884,12],[128985,7],[129004,20],[129036,4],[129096,8],[129114,6],[129160,8],[129198,82],[129292,1],[129394,1],[129399,3],[129443,2],[129451,3],[129483,2],[129620,12],[129646,2],[129652,4],[129659,5],[129667,13],[129686,1386],[173783,41],[177973,11],[178206,2],[183970,14],[191457,3103],[195102,722403],[917506,30],[917632,128],[918e3,65040],[1048574,2]]},$B.unicode_casefold={223:[115,115],304:[105,775],329:[700,110],496:[106,780],912:[953,776,769],944:[965,776,769],1415:[1381,1410],7830:[104,817],7831:[116,776],7832:[119,778],7833:[121,778],7834:[97,702],7838:[223],8016:[965,787],8018:[965,787,768],8020:[965,787,769],8022:[965,787,834],8064:[7936,953],8065:[7937,953],8066:[7938,953],8067:[7939,953],8068:[7940,953],8069:[7941,953],8070:[7942,953],8071:[7943,953],8072:[8064],8073:[8065],8074:[8066],8075:[8067],8076:[8068],8077:[8069],8078:[8070],8079:[8071],8080:[7968,953],8081:[7969,953],8082:[7970,953],8083:[7971,953],8084:[7972,953],8085:[7973,953],8086:[7974,953],8087:[7975,953],8088:[8080],8089:[8081],8090:[8082],8091:[8083],8092:[8084],8093:[8085],8094:[8086],8095:[8087],8096:[8032,953],8097:[8033,953],8098:[8034,953],8099:[8035,953],8100:[8036,953],8101:[8037,953],8102:[8038,953],8103:[8039,953],8104:[8096],8105:[8097],8106:[8098],8107:[8099],8108:[8100],8109:[8101],8110:[8102],8111:[8103],8114:[8048,953],8115:[945,953],8116:[940,953],8118:[945,834],8119:[945,834,953],8124:[8115],8130:[8052,953],8131:[951,953],8132:[942,953],8134:[951,834],8135:[951,834,953],8140:[8131],8146:[953,776,768],8147:[953,776,769],8150:[953,834],8151:[953,776,834],8162:[965,776,768],8163:[965,776,769],8164:[961,787],8166:[965,834],8167:[965,776,834],8178:[8060,953],8179:[969,953],8180:[974,953],8182:[969,834],8183:[969,834,953],8188:[8179],64256:[102,102],64257:[102,105],64258:[102,108],64259:[102,102,105],64260:[102,102,108],64261:[115,116],64262:[115,116],64275:[1396,1398],64276:[1396,1381],64277:[1396,1387],64278:[1406,1398],64279:[1396,1389]},$B.unicode_bidi_whitespace=[9,10,11,12,13,28,29,30,31,32,133,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8287,12288],$B.unicode_identifiers={XID_Start:[95,[65,26],[97,26],170,181,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[880,5],[886,2],[891,3],902,[904,3],908,[910,20],[931,83],[1015,139],[1162,156],[1329,38],1369,[1377,39],[1488,27],[1520,3],[1569,42],[1646,2],[1649,99],1749,[1765,2],[1774,2],[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2036,2],2042,[2048,22],2074,2084,2088,[2308,54],2365,2384,[2392,10],2417,2418,[2425,7],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2493,2510,[2524,2],[2527,3],[2544,2],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2749,2768,[2784,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2877,[2908,2],[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3160,2],[3168,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,[3296,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3424,2],[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,[3648,7],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,4],3762,3773,[3776,5],3782,[3804,2],3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,[4197,2],[4206,3],[4213,13],4238,[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6103,6108,[6176,88],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],6823,[6917,47],[6981,7],[7043,30],[7086,2],[7168,36],[7245,3],[7258,36],[7401,4],[7406,4],[7424,192],[7680,278],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],8305,8319,[8336,5],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,4],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12293,12294,12295,[12321,9],[12337,5],[12344,5],[12353,86],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,16],[42538,2],[42560,32],[42594,13],42623,[42624,24],[42656,80],[42775,9],[42786,103],[42891,2],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],43471,[43520,41],[43584,3],[43588,8],[43616,23],43642,[43648,48],43697,[43701,2],[43705,5],43712,43714,[43739,3],[43968,35],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],65137,65139,65143,65145,65147,65149,[65151,126],[65313,26],[65345,26],[65382,56],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[74752,99],[77824,1071],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[131072,42711],[173824,4149],[194560,542]],XID_Continue:[[48,10],[65,26],95,[97,26],170,181,183,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[768,117],[886,2],[891,3],902,903,[904,3],908,[910,20],[931,83],[1015,139],[1155,5],[1162,156],[1329,38],1369,[1377,39],[1425,45],1471,[1473,2],[1476,2],1479,[1488,27],[1520,3],[1552,11],[1569,62],[1632,10],[1646,102],1749,[1750,7],[1759,10],[1770,19],1791,1808,1809,[1810,57],[1869,101],[1984,54],2042,[2048,46],[2304,58],2364,2365,[2366,17],2384,[2385,5],[2392,12],[2406,10],2417,2418,[2425,7],2433,[2434,2],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2492,2493,[2494,7],[2503,2],[2507,4],2519,[2524,2],[2527,5],[2534,12],[2561,3],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],2620,[2622,5],[2631,2],[2635,3],2641,[2649,4],2654,[2662,16],[2689,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2748,2749,[2750,8],[2759,3],[2763,3],2768,[2784,4],[2790,10],2817,[2818,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2876,2877,2878,2879,2880,[2881,4],[2887,2],[2891,3],2902,2903,[2908,2],[2911,5],[2918,10],2929,2946,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],[3006,5],[3014,3],[3018,4],3024,3031,[3046,10],[3073,3],[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3134,7],[3142,3],[3146,4],[3157,2],[3160,2],[3168,4],[3174,10],[3202,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3260,3261,3262,3263,[3264,5],3270,[3271,2],[3274,4],[3285,2],3294,[3296,4],[3302,10],[3330,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3390,7],[3398,3],[3402,4],3415,[3424,4],[3430,10],[3450,6],[3458,2],[3461,18],[3482,24],[3507,9],3517,[3520,7],3530,[3535,6],3542,[3544,8],[3570,2],[3585,58],[3648,15],[3664,10],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,13],[3771,3],[3776,5],3782,[3784,6],[3792,10],[3804,2],3840,[3864,2],[3872,10],3893,3895,3897,[3902,10],[3913,36],[3953,20],[3974,6],[3984,8],[3993,36],4038,[4096,74],[4176,78],[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],4959,[4969,9],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,7],[5920,21],[5952,20],[5984,13],[5998,3],[6002,2],[6016,52],6070,[6071,29],6103,6108,6109,[6112,10],[6155,3],[6160,10],[6176,88],[6272,43],[6320,70],[6400,29],[6432,12],[6448,12],[6470,40],[6512,5],[6528,44],[6576,26],[6608,11],[6656,28],[6688,63],6752,6753,6754,[6755,26],6783,[6784,10],[6800,10],6823,[6912,76],[6992,10],[7019,9],[7040,43],[7086,12],[7168,56],[7232,10],[7245,49],[7376,3],[7380,31],[7424,231],[7677,281],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],[8255,2],8276,8305,8319,[8336,5],[8400,13],8417,[8421,12],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,7],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],[11744,32],12293,12294,12295,[12321,15],[12337,5],[12344,5],[12353,86],[12441,2],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,28],[42560,32],[42594,14],[42620,2],42623,[42624,24],[42656,82],[42775,9],[42786,103],[42891,2],[43003,45],[43072,52],[43136,69],[43216,10],[43232,24],43259,[43264,46],[43312,36],[43360,29],[43392,65],43471,[43472,10],[43520,55],[43584,14],[43600,10],[43616,23],43642,43643,[43648,67],[43739,3],[43968,43],44012,44013,[44016,10],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,64286,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],[65024,16],[65056,7],[65075,2],[65101,3],65137,65139,65143,65145,65147,65149,[65151,126],[65296,10],[65313,26],65343,[65345,26],[65382,89],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],66045,[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[66720,10],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68097,3],[68101,2],[68108,8],[68117,3],[68121,27],[68152,3],68159,[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69760,59],[73728,879],[74752,99],[77824,1071],[119141,5],[119149,6],[119163,8],[119173,7],[119210,4],[119362,3],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[120782,50],[131072,42711],[173824,4149],[194560,542],[917760,240]]},$B.unicode_tables={},$B.unicode)$B.unicode_tables[gc]={},$B.unicode[gc].forEach(function(n){if(Array.isArray(n))for(var o=n[2]||1,l=0,x=n[1];l<x;l+=1)$B.unicode_tables[gc][n[0]+l*o]=!0;else $B.unicode_tables[gc][n]=!0});for(var key in $B.unicode_identifiers){$B.unicode_tables[key]={};for(const n of $B.unicode_identifiers[key])if(Array.isArray(n))for(var i=0;i<n[1];i++)$B.unicode_tables[key][n[0]+i]=!0;else $B.unicode_tables[key][n]=!0}$B.is_unicode_cn=function(n){for(var o=$B.unicode.Cn,l=0,x=o.length;l<x;l++)return n>=o[l][0]&&n<o[l][0]+o[l][1];return!1},function($B){var bltns=$B.InjectBuiltins();eval(bltns);var unicode_tables=$B.unicode_tables,str={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"str"},$is_class:!0,$native:!0};function normalize_start_end(n){if(null===n.start||n.start===_b_.None?n.start=0:n.start<0&&(n.start+=n.self.length,n.start=Math.max(0,n.start)),null===n.end||n.end===_b_.None?n.end=n.self.length:n.end<0&&(n.end+=n.self.length,n.end=Math.max(0,n.end)),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}function reverse(n){return n.split("").reverse().join("")}function check_str(n){if(!_b_.isinstance(n,str))throw _b_.TypeError.$factory("can't convert '"+$B.class_name(n)+"' object to str implicitly")}function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&"s"!=o.type)throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'str'");return n}str.__add__=function(n,o){if("string"!=typeof o)try{return getattr(o,"__radd__")(n)}catch{throw _b_.TypeError.$factory("Can't convert "+$B.class_name(o)+" to str implicitly")}return n+o},str.__contains__=function(n,o){if(!_b_.isinstance(o,str))throw _b_.TypeError.$factory("'in <string>' requires string as left operand, not "+o.__class__);if("string"==typeof o)var l=o.length;else l=_b_.len(o);if(0==l)return!0;if(0==n.length)return 0==l;for(var x=0,L=n.length;x<L;x++)if(n.substr(x,l)==o)return!0;return!1},str.__delitem__=function(){throw _b_.TypeError.$factory("'str' object doesn't support item deletion")},str.__dir__=object.__dir__,str.__eq__=function(n,o){return void 0===o?n===str:_b_.isinstance(o,_b_.str)?o.valueOf()==n.valueOf():_b_.NotImplemented},str.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(void 0!==l.sign)throw _b_.ValueError.$factory("Sign not allowed in string format specifier");return l.precision&&(n=n.substr(0,l.precision)),l.align=l.align||"<",$B.format_width(preformat(n,l),l)},str.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.length),l>=0&&l<n.length)return n.charAt(l);throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.length),L=x.start,D=x.stop,z=x.step,M="",P=null;if(z>0){if(D<=L)return"";for(P=L;P<D;P+=z)M+=n.charAt(P)}else{if(D>=L)return"";for(P=L;P>D;P+=z)M+=n.charAt(P)}return M}if(isinstance(o,_b_.bool))return n.__getitem__(_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")};var prefix=2,suffix=3,mask=2**32-1,str_hash_cache={};function fnv(n){if(0==n.length)return 0;var o=prefix;o=(o^n.charCodeAt(0)<<7)&mask;for(var l=0,x=n.length;l<x;l++)o=(1000003*o^n.charCodeAt(l))&mask;return-1==(o=((o=(o^n.length)&mask)^suffix)&mask)&&(o=-2),o}str.$nb_str_hash_cache=0,str.__hash__=function(n){return void 0!==str_hash_cache[n]?str_hash_cache[n]:(str.$nb_str_hash_cache++,str.$nb_str_hash_cache>1e5&&(str.$nb_str_hash_cache=0,str_hash_cache={}),str_hash_cache[n]=fnv(n))},str.__init__=function(n,o){return n.valueOf=function(){return o},n.toString=function(){return o},_b_.None};var str_iterator=$B.make_iterator_class("str_iterator");str.__iter__=function(n){var o=n.split("");return str_iterator.$factory(o)},str.__len__=function(n){return n.length};var kwarg_key=new RegExp("([^\\)]*)\\)"),NotANumber=function(){this.name="NotANumber"},number_check=function(n){if(!isinstance(n,[_b_.int,_b_.float]))throw new NotANumber},get_char_array=function(n,o){return n<=0?"":new Array(n+1).join(o)},format_padding=function(n,o,l){var x=o.padding;return x?(n=n.toString(),x=parseInt(x,10),l&&(x-=1),o.left?n+get_char_array(x-n.length,o.pad_char):get_char_array(x-n.length,o.pad_char)+n):n},format_int_precision=function(n,o){var l,x=o.precision;return x?(x=parseInt(x,10),"-"===(l=n.__class__===$B.long_int?$B.long_int.to_base(n,10):n.toString())[0]?"-"+get_char_array(x-l.length+1,"0")+l.slice(1):get_char_array(x-l.length,"0")+l):n.toString()},format_float_precision=function(n,o,l,x){var L=l.precision;return isFinite(n)?x(n,L,l,o):(n=n===1/0?"inf":n===-1/0?"-inf":"nan",o?n.toUpperCase():n)},format_sign=function(n,o){if(o.sign){if(n>=0)return"+"}else if(o.space&&n>=0)return" ";return""},str_format=function(n,o){return o.pad_char=" ",format_padding(str.$factory(n),o)},num_format=function(n,o){number_check(n),n=n.__class__===$B.long_int?$B.long_int.to_base(n,10):parseInt(n);var l=format_int_precision(n,o);if("0"===o.pad_char){if(n<0)return l=l.substring(1),"-"+format_padding(l,o,!0);var x=format_sign(n,o);if(""!==x)return x+format_padding(l,o,!0)}return format_padding(format_sign(n,o)+l,o)},repr_format=function(n,o){return o.pad_char=" ",format_padding(repr(n),o)},ascii_format=function(n,o){return o.pad_char=" ",format_padding(ascii(n),o)},_float_helper=function(n,o){return number_check(n),o.precision?(o.precision=parseInt(o.precision,10),validate_precision(o.precision)):o.precision=o.decimal_point?0:6,parseFloat(n)},trailing_zeros=/(.*?)(0+)([eE].*)/,leading_zeros=/\.(0*)/,trailing_dot=/\.$/,validate_precision=function(n){n>20&&(n=20)},floating_point_format=function(n,o,l){if(n=_float_helper(n,l),v=n.toString(),v_len=v.length,dot_idx=v.indexOf("."),dot_idx<0&&(dot_idx=v_len),n<1&&n>-1){var x,L=leading_zeros.exec(v);return(x=L?L[1].length:0)>=4?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):(l.precision=(l.precision||0)+x,format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(z,M){return z.toFixed(min(M,v_len-dot_idx)+x)}),l))}var D;return dot_idx>l.precision?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(z,M){return l.decimal_point?M>v_len&&(l.alternate||(M=v_len)):M=min(v_len-1,6),M<dot_idx&&(M=dot_idx),z.toFixed(M-dot_idx)}),l)},_floating_g_exp_helper=function(n,o,l,x){o&&--o;var L=(n=n.toExponential(o)).lastIndexOf("e");return L>n.length-4&&(n=n.substring(0,L+2)+"0"+n.substring(L+2)),x?n.toUpperCase():n},floating_point_decimal_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(x,L,D){return x=x.toFixed(L),0===L&&D.alternate&&(x+="."),x}),l)},_floating_exp_helper=function(n,o,l,x){var L=(n=n.toExponential(o)).lastIndexOf("e");return L>n.length-4&&(n=n.substring(0,L+2)+"0"+n.substring(L+2)),x?n.toUpperCase():n},floating_point_exponential_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,_floating_exp_helper),l)},signed_hex_format=function(n,o,l){var x;if(number_check(n),x=n.__class__===$B.long_int?$B.long_int.to_base(n,16):(x=parseInt(n)).toString(16),x=format_int_precision(x,l),o&&(x=x.toUpperCase()),"0"===l.pad_char){n<0&&(x=x.substring(1),x="-"+format_padding(x,l,!0));var L=format_sign(n,l);""!==L&&(x=L+format_padding(x,l,!0))}return l.alternate&&(x="-"===x.charAt(0)?o?"-0X"+x.slice(1):"-0x"+x.slice(1):o?"0X"+x:"0x"+x),format_padding(format_sign(n,l)+x,l)},octal_format=function(n,o){var l;if(number_check(n),l=n.__class__===$B.long_int?$B.long_int.to_base(8):(l=parseInt(n)).toString(8),l=format_int_precision(l,o),"0"===o.pad_char){n<0&&(l=l.substring(1),l="-"+format_padding(l,o,!0));var x=format_sign(n,o);""!==x&&(l=x+format_padding(l,o,!0))}return o.alternate&&(l="-"===l.charAt(0)?"-0o"+l.slice(1):"0o"+l),format_padding(l,o)};function series_of_bytes(n,o){if(n.__class__&&n.__class__.$buffer_protocol)for(var l=_b_.iter(n),x=[];;)try{x.push(_b_.next(l))}catch(D){if(D.__class__===_b_.StopIteration){var L=_b_.bytes.$factory(x);return format_padding(_b_.bytes.decode(L,"ascii"),o)}throw D}else try{return bytes_obj=$B.$getattr(n,"__bytes__"),format_padding(_b_.bytes.decode(bytes_obj),o)}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("%b does not accept '"+$B.class_name(n)+"'"):D}}var single_char_format=function(n,o){if(isinstance(n,str)&&1==n.length)return n;if(isinstance(n,bytes)&&1==n.source.length)n=n.source[0];else try{n=_b_.int.$factory(n)}catch{throw _b_.TypeError.$factory("%c requires int or char")}return format_padding(chr(n),o)},num_flag=function(n,o){"0"!==n||o.padding||o.decimal_point||o.left?o.decimal_point?o.precision=(o.precision||"")+n:o.padding=(o.padding||"")+n:o.pad_char="0"},decimal_point_flag=function(n,o){if(o.decimal_point)throw new UnsupportedChar;o.decimal_point=!0},neg_flag=function(n,o){o.pad_char=" ",o.left=!0},space_flag=function(n,o){o.space=!0},sign_flag=function(n,o){o.sign=!0},alternate_flag=function(n,o){o.alternate=!0},char_mapping={b:series_of_bytes,s:str_format,d:num_format,i:num_format,u:num_format,o:octal_format,r:repr_format,a:ascii_format,g:function(n,o){return floating_point_format(n,!1,o)},G:function(n,o){return floating_point_format(n,!0,o)},f:function(n,o){return floating_point_decimal_format(n,!1,o)},F:function(n,o){return floating_point_decimal_format(n,!0,o)},e:function(n,o){return floating_point_exponential_format(n,!1,o)},E:function(n,o){return floating_point_exponential_format(n,!0,o)},x:function(n,o){return signed_hex_format(n,!1,o)},X:function(n,o){return signed_hex_format(n,!0,o)},c:single_char_format,0:function(n,o){return num_flag("0",o)},1:function(n,o){return num_flag("1",o)},2:function(n,o){return num_flag("2",o)},3:function(n,o){return num_flag("3",o)},4:function(n,o){return num_flag("4",o)},5:function(n,o){return num_flag("5",o)},6:function(n,o){return num_flag("6",o)},7:function(n,o){return num_flag("7",o)},8:function(n,o){return num_flag("8",o)},9:function(n,o){return num_flag("9",o)},"-":neg_flag," ":space_flag,"+":sign_flag,".":decimal_point_flag,"#":alternate_flag},UnsupportedChar=function(){this.name="UnsupportedChar"};str.__mod__=function(n,o){var l,x=n.length,L=0,D=null;_b_.isinstance(o,_b_.tuple)?D=0:l=_b_.getattr(o,"__getitem__",_b_.None);var z="",M=function(ae){++L;var fe=kwarg_key.exec(ae.substring(he));if(!fe)throw _b_.ValueError.$factory("incomplete format key");var le=fe[1];he+=fe[0].length;try{var q=l(le)}catch(Y){throw"KeyError"===Y.name?Y:_b_.TypeError.$factory("format requires a mapping")}return de(ae,q)},P=function(ae){var fe;if(null===D)fe=o;else if(void 0===(fe=o[D++]))throw _b_.TypeError.$factory("not enough arguments for format string");return de(ae,fe)},de=function(ae,fe){for(var le={pad_char:" "};;){var q=char_mapping[ae[he]];try{if(void 0===q)throw new UnsupportedChar;var Y=q(fe,le);if(void 0!==Y)return Y;++he}catch(X){if("UnsupportedChar"==X.name)throw invalid_char=ae[he],void 0===invalid_char?_b_.ValueError.$factory("incomplete format"):_b_.ValueError.$factory("unsupported format character '"+invalid_char+"' (0x"+invalid_char.charCodeAt(0).toString(16)+") at index "+he);if("NotANumber"===X.name){var N=fe.__class__;throw N=N?N.$infos.__name__:"string"==typeof fe?"str":typeof fe,_b_.TypeError.$factory("%"+ae[he]+" format: a number is required, not "+N)}throw X}}},ye=0;do{var he=n.indexOf("%",L);if(he<0){z+=n.substring(L);break}if(z+=n.substring(L,he),!(++he<x))throw _b_.ValueError.$factory("incomplete format");"%"===n[he]?z+="%":(ye++,"("===n[he]?(++he,z+=M(n)):z+=P(n)),L=he+1}while(L<x);if(null!==D){if(o.length>D)throw _b_.TypeError.$factory("not enough arguments for format string");if(o.length<D)throw _b_.TypeError.$factory("not all arguments converted during string formatting")}else if(0==ye)throw _b_.TypeError.$factory("not all arguments converted during string formatting");return z},str.__mro__=[object],str.__mul__=function(){var n=$B.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null);if(!isinstance(n.other,_b_.int))throw _b_.TypeError.$factory("Can't multiply sequence by non-int of type '"+$B.class_name(n.other)+"'");for(var o="",l=0;l<n.other;l++)o+=n.self.valueOf();return o},str.__ne__=function(n,o){return o!==n.valueOf()},str.__repr__=function(n){var o=n;o=(o=(o=n.replace(/\\/g,"\\\\")).replace(new RegExp("\x07","g"),"\\x07").replace(new RegExp("\b","g"),"\\x08").replace(new RegExp("\v","g"),"\\x0b").replace(new RegExp("\f","g"),"\\x0c").replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r").replace(new RegExp("\t","g"),"\\t")).replace(combining_re,"\u200b$1");for(var l="",x=0;x<o.length;x++)if($B.is_unicode_cn(o.codePointAt(x))){for(var L=o.codePointAt(x).toString(16);L.length<4;)L="0"+L;l+="\\u"+L}else l+=o.charAt(x);if(-1==(o=l).search('"')&&-1==o.search("'"))return"'"+o+"'";if(-1==n.search('"'))return'"'+o+'"';var D=new RegExp("'","g");return"'"+o.replace(D,"\\'")+"'"},str.__setitem__=function(n,o,l){throw _b_.TypeError.$factory("'str' object does not support item assignment")};for(var combining=[],cp=768;cp<=879;cp++)combining.push(String.fromCharCode(cp));var combining_re=new RegExp("("+combining.join("|")+")");str.__str__=function(n){return n.replace(combining_re,"\u200b$1")},str.toString=function(){return"string!"};var $comp_func=function(n,o){return"string"!=typeof o?_b_.NotImplemented:n>o};$comp_func+="";var $comps={">":"gt",">=":"ge","<":"lt","<=":"le"};for(var $op in $comps)eval("str.__"+$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(str);var $notimplemented=function(n,o){throw NotImplementedError.$factory("OPERATOR not implemented for class str")};str.capitalize=function(n){return $B.args("capitalize",1,{self:n},["self"],arguments,{},null,null),0==n.length?"":n.charAt(0).toUpperCase()+n.substr(1)},str.casefold=function(n){$B.args("casefold",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",L=0,D=n.length;L<D;L++)o=n.charCodeAt(L),(l=$B.unicode_casefold[o])?l.forEach(function(z){x+=String.fromCharCode(z)}):x+=n.charAt(L).toLowerCase();return x},str.center=function(){var n=$B.args("center",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null),o=n.self;if(n.width<=o.length)return o;var l=parseInt((n.width-o.length)/2),x=n.fillchar.repeat(l);return(x+=o+x).length<n.width&&(x+=n.fillchar),x},str.count=function(){var n=$B.args("count",4,{self:null,sub:null,start:null,stop:null},["self","sub","start","stop"],arguments,{start:null,stop:null},null,null);if("string"!=typeof n.sub)throw _b_.TypeError.$factory("Can't convert '"+$B.class_name(n.sub)+"' object to str implicitly");var o,l=n.self;if(null!==n.start)o=null!==n.stop?_b_.slice.$factory(n.start,n.stop):_b_.slice.$factory(n.start,n.self.length),l=str.__getitem__.apply(null,[n.self].concat(o));else if(n.self.length+n.sub.length==0)return 1;if(0==n.sub.length)return n.start==n.self.length?1:0==l.length?0:l.length+1;for(var x=0,L=0;L<l.length&&(L=l.indexOf(n.sub,L))>=0;)x++,L+=n.sub.length;return x},str.encode=function(){var n=$B.args("encode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);if("rot13"==n.encoding||"rot_13"==n.encoding){for(var o="",l=0,x=n.self.length;l<x;l++){var L=n.self.charAt(l);o+="a"<=L&&L<="m"||"A"<=L&&L<="M"?String.fromCharCode(String.charCodeAt(L)+13):"m"<L&&L<="z"||"M"<L&&L<="Z"?String.fromCharCode(String.charCodeAt(L)-13):L}return o}return _b_.bytes.__new__(_b_.bytes,n.self,n.encoding,n.errors)},str.endswith=function(){var n=$B.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.suffix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,L=o.length;x<L;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(D.length<=l.length&&l.substr(l.length-D.length)==D)return!0}return!1},str.expandtabs=function(n,o){var l=$B.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),x=$B.$GetInt(l.tabsize),L=0,D=0,z="";if(1==x)return n.replace(/\t/g," ");for(;D<n.length;){var M=n.charAt(D);switch(M){case"\t":for(;L%x>0;)z+=" ",L++;break;case"\r":case"\n":z+=M,L=0;break;default:z+=M,L++}D++}return z},str.find=function(){var n=$B.args("str.find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(check_str(n.sub),normalize_start_end(n),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method");for(var o="",l=n.start;l<n.end;l++)o+=n.self.charAt(l);if(0==n.sub.length&&n.start==n.self.length)return n.self.length;if(o.length+n.sub.length==0)return-1;var x=o.length-n.sub.length;for(l=0;l<=x;l++)if(o.substr(l,n.sub.length)==n.sub)return n.start+l;return-1},$B.parse_format=function(n){var o,l,x,L=n.split(":"),D=[];return 1==L.length?o=n:(o=L[0],x=L.splice(1).join(":")),(L=o.split("!")).length>1&&(o=L[0],l=L[1]),void 0!==o&&(o=o.replace(/\.[_a-zA-Z][_a-zA-Z0-9]*|\[[_a-zA-Z][_a-zA-Z0-9]*\]|\[[0-9]+\]/g,function(z){return D.push(z),""})),{name:o,name_ext:D,conv:l,spec:x||"",string:n}},$B.split_format=function(n){for(var o,l=0,x=n.length,L="",D=[],z=0;l<x;)if("{"==(o=n.charAt(l))&&"{"==n.charAt(l+1))L+="{",l+=2;else if("}"==o&&"}"==n.charAt(l+1))L+="}",l+=2;else if("{"==o){D.push(L);for(var M=l+1,P=1;M<x;)if("{"==n.charAt(M))P++,M++;else if("}"==n.charAt(M)){if(M++,0==--P){var de=n.substring(l+1,M-1),ye=$B.parse_format(de);if(ye.raw_name=ye.name,ye.raw_spec=ye.spec,ye.name||(ye.name=z+"",z++),void 0!==ye.spec){ye.spec=ye.spec.replace(/\{(.*?)\}/g,function(fe,le){return""==le?"{"+z+++"}":"{"+le+"}"})}D.push(ye),L="";break}}else M++;if(P>0)throw ValueError.$factory("wrong format "+n);l=M}else L+=o,l++;return L&&D.push(L),D},str.format=function(n){for(var o,l=$B.args("format",1,{self:null},["self"],arguments,{},"$args","$kw"),x=$B.split_format(l.self),L="",D=0;D<x.length;D++)if("string"!=typeof x[D]){if(void 0!==(o=x[D]).spec){o.spec=o.spec.replace(/\{(.*?)\}/g,function(fe,le){return/\d+/.exec(le)?_b_.tuple.__getitem__(l.$args,parseInt(le)):_b_.dict.__getitem__(l.$kw,le)})}if(o.name.charAt(0).search(/\d/)>-1)var z=parseInt(o.name),M=_b_.tuple.__getitem__(l.$args,z);else M=_b_.dict.__getitem__(l.$kw,o.name);for(var P=0;P<o.name_ext.length;P++){var de=o.name_ext[P];if("."==de.charAt(0))M=_b_.getattr(M,de.substr(1));else{var ye=de.substr(1,de.length-2);ye.charAt(0).search(/\d/)>-1&&(ye=parseInt(ye)),M=_b_.getattr(M,"__getitem__")(ye)}}"a"==o.conv?M=_b_.ascii(M):"r"==o.conv?M=_b_.repr(M):"s"==o.conv&&(M=_b_.str.$factory(M)),L+=M.$is_class||M.$factory?M.__class__.__format__(M,o.spec):$B.$getattr(M,"__format__")(o.spec)}else L+=x[D];return L},str.format_map=function(n){throw NotImplementedError.$factory("function format_map not implemented yet")},str.index=function(n){var o=str.find.apply(null,arguments);if(-1===o)throw _b_.ValueError.$factory("substring not found");return o},str.isascii=function(n){for(var o=0,l=n.length;o<l;o++)if(n.charCodeAt(o)>127)return!1;return!0},str.isalnum=function(n){$B.args("isalnum",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]||unicode_tables.Nd[o]||unicode_tables.digits[o]||unicode_tables.numeric[o]))return!1;return!0},str.isalpha=function(n){$B.args("isalpha",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]))return!1;return!0},str.isdecimal=function(n){$B.args("isdecimal",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Nd[o])return!1;return n.length>0},str.isdigit=function(n){$B.args("isdigit",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.digits[o])return!1;return n.length>0},str.isidentifier=function(n){if($B.args("isidentifier",1,{self:null},["self"],arguments,{},null,null),0==n.length||void 0===unicode_tables.XID_Start[n.charCodeAt(0)])return!1;for(var o=1,l=n.length;o<l;o++)if(void 0===unicode_tables.XID_Continue[n.charCodeAt(o)])return!1;return!0},str.islower=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,L=n.length;x<L;x++)if(o=n.charCodeAt(x),unicode_tables.Ll[o])l=!0;else if(unicode_tables.Lu[o]||unicode_tables.Lt[o])return!1;return l},str.isnumeric=function(n){$B.args("isnumeric",1,{self:null},["self"],arguments,{},null,null);for(var o=0,l=n.length;o<l;o++)if(!unicode_tables.numeric[n.charCodeAt(o)])return!1;return n.length>0};var unprintable={},unprintable_gc=["Cc","Cf","Co","Cs","Zl","Zp","Zs"];function $re_escape(n){for(var o="[.*+?|()$^",l=0,x=o.length;l<x;l++){var L=new RegExp("\\"+o.charAt(l),"g");n=n.replace(L,"\\"+o.charAt(l))}return n}str.isprintable=function(n){if(0==Object.keys(unprintable).length){for(var o=0;o<unprintable_gc.length;o++){var l=unicode_tables[unprintable_gc[o]];for(var x in l)unprintable[x]=!0}unprintable[32]=!0}$B.args("isprintable",1,{self:null},["self"],arguments,{},null,null),o=0;for(var L=n.length;o<L;o++)if(unprintable[n.charCodeAt(o)])return!1;return!0},str.isspace=function(n){$B.args("isspace",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Zs[o]&&-1==$B.unicode_bidi_whitespace.indexOf(o))return!1;return n.length>0},str.istitle=function(n){return $B.args("istitle",1,{self:null},["self"],arguments,{},null,null),n.length>0&&str.title(n)==n},str.isupper=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,L=n.length;x<L;x++)if(o=n.charCodeAt(x),unicode_tables.Lu[o])l=!0;else if(unicode_tables.Ll[o]||unicode_tables.Lt[o])return!1;return l},str.join=function(){for(var n=$B.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{},null,null),o=_b_.iter(n.iterable),l=[];;)try{var x=_b_.next(o);if(!isinstance(x,str))throw _b_.TypeError.$factory("sequence item 0: expected str instance, "+$B.class_name(x)+" found");l.push(x)}catch(L){if(_b_.isinstance(L,_b_.StopIteration))break;throw L}return l.join(n.self)},str.ljust=function(n){var o=$B.args("ljust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:n+o.fillchar.repeat(o.width-n.length)},str.lower=function(n){return $B.args("lower",1,{self:null},["self"],arguments,{},null,null),n.toLowerCase()},str.lstrip=function(n,o){var l=$B.args("lstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimLeft();for(var x=0;x<l.self.length;x++)if(-1===l.chars.indexOf(l.self.charAt(x)))return l.self.substring(x);return""},str.maketrans=function(){var n=$B.args("maketrans",3,{x:null,y:null,z:null},["x","y","z"],arguments,{y:null,z:null},null,null),o=$B.empty_dict();if(null===n.y&&null===n.z){if(!_b_.isinstance(n.x,_b_.dict))throw _b_.TypeError.$factory("maketrans only argument must be a dict");for(var l=_b_.list.$factory(_b_.dict.items(n.x)),x=0,L=l.length;x<L;x++){var D=l[x][0],z=l[x][1];if(!_b_.isinstance(D,_b_.int)){if(!_b_.isinstance(D,_b_.str)||1!=D.length)throw _b_.TypeError.$factory("dictionary key "+D+" is not int or 1-char string");D=_b_.ord(D)}if(z!==_b_.None&&!_b_.isinstance(z,[_b_.int,_b_.str]))throw _b_.TypeError.$factory("dictionary value "+z+" is not None, integer or string");_b_.dict.$setitem(o,D,z)}return o}if(_b_.isinstance(n.x,_b_.str)&&_b_.isinstance(n.y,_b_.str)){if(n.x.length!==n.y.length)throw _b_.TypeError.$factory("maketrans arguments must be strings or same length");var M={};if(null!==n.z){if(!_b_.isinstance(n.z,_b_.str))throw _b_.TypeError.$factory("maketrans third argument must be a string");for(x=0,L=n.z.length;x<L;x++)M[_b_.ord(n.z.charAt(x))]=!0}for(x=0,L=n.x.length;x<L;x++){var P=_b_.ord(n.x.charAt(x)),de=n.y.charCodeAt(x);_b_.dict.$setitem(o,P,de)}for(var D in M)_b_.dict.$setitem(o,parseInt(D),_b_.None);return o}throw _b_.TypeError.$factory("maketrans arguments must be strings")},str.maketrans.$type="staticmethod",str.partition=function(){var n=$B.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(""==n.sep)throw _b_.ValueError.$factory("empty separator");check_str(n.sep);var o=n.self.indexOf(n.sep);return-1==o?_b_.tuple.$factory([n.self,"",""]):_b_.tuple.$factory([n.self.substring(0,o),n.sep,n.self.substring(o+n.sep.length)])},str.removeprefix=function(){var n=$B.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!_b_.isinstance(n.prefix,str))throw _b_.ValueError.$factory(`prefix should be str, not '${$B.class_name(n.prefix)}'`);return str.startswith(n.self,n.prefix)?n.self.substr(n.prefix.length):n.self.substr(0)},str.removesuffix=function(){var n=$B.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!_b_.isinstance(n.suffix,str))throw _b_.ValueError.$factory(`suffix should be str, not '${$B.class_name(n.prefix)}'`);return n.suffix.length>0&&str.endswith(n.self,n.suffix)?n.self.substr(0,n.self.length-n.suffix.length):n.self.substr(0)},str.replace=function(n,o,l,x){var L=$B.args("replace",4,{self:null,old:null,$$new:null,count:null},["self","old","$$new","count"],arguments,{count:-1},null,null);if(x=L.count,n=L.self,l=L.$$new,check_str(o=L.old),check_str(l),!isinstance(x,[_b_.int,_b_.float]))throw _b_.TypeError.$factory("'"+$B.class_name(x)+"' object cannot be interpreted as an integer");if(isinstance(x,_b_.float))throw _b_.TypeError.$factory("integer argument expected, got float");if(0==x)return n;if(x.__class__==$B.long_int&&(x=parseInt(x.value)),""==o){if(""==l)return n;if(""==n)return l;var D=n.split("");if(x>-1&&D.length>=x){var z=D.slice(x).join("");return l+D.slice(0,x).join(l)+z}return l+D.join(l)+l}D=str.split(n,o,x);var M=n,P=-1;if(0==o.length){M=l;for(var de=0;de<D.length;de++)M+=D[de]+l;return M+z}for(x<0&&(x=M.length);x>0&&!((P=M.indexOf(o,P))<0);)M=M.substr(0,P)+l+M.substr(P+o.length),P+=l.length,x--;return M},str.rfind=function(n,o){if(2==arguments.length&&"string"==typeof o)return n.lastIndexOf(o);var l=$B.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(normalize_start_end(l),check_str(l.sub),0==l.sub.length)return l.start>l.self.length?-1:l.self.length;for(var x=l.sub.length,L=l.end-x;L>=l.start;L--)if(l.self.substr(L,x)==l.sub)return L;return-1},str.rindex=function(){var n=str.rfind.apply(null,arguments);if(-1==n)throw _b_.ValueError.$factory("substring not found");return n},str.rjust=function(n){var o=$B.args("rjust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:o.fillchar.repeat(o.width-n.length)+n},str.rpartition=function(n,o){var l=$B.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);check_str(l.sep),n=reverse(l.self),o=reverse(l.sep);for(var x=str.partition(n,o).reverse(),L=0;L<x.length;L++)x[L]=x[L].split("").reverse().join("");return x},str.rsplit=function(n){var o=$B.args("rsplit",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),l=o.sep,x=reverse(o.self),L=l===_b_.None?l:reverse(o.sep),D=str.split(x,L,o.maxsplit);D.reverse();for(var z=0;z<D.length;z++)D[z]=reverse(D[z]);return D},str.rstrip=function(n,o){var l=$B.args("rstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimRight();for(var x=l.self.length-1;x>=0;x--)if(-1==l.chars.indexOf(l.self.charAt(x)))return l.self.substring(0,x+1);return""},str.split=function(){var n=$B.args("split",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),o=n.sep,l=n.maxsplit,x=n.self,L=0;if(l.__class__===$B.long_int&&(l=parseInt(l.value)),""==o)throw _b_.ValueError.$factory("empty separator");if(o===_b_.None){for(var D=[];L<x.length&&x.charAt(L).search(/\s/)>-1;)L++;if(L===x.length-1)return[x];for(var z="";;){if(-1==x.charAt(L).search(/\s/))""==z?z=x.charAt(L):z+=x.charAt(L);else if(""!==z){if(D.push(z),-1!==l&&D.length==l+1)return D.pop(),D.push(z+x.substr(L)),D;z=""}if(++L>x.length-1){z&&D.push(z);break}}return D}D=[];var M="",P=o.length;if(0==l)return[x];for(;L<x.length;)if(x.substr(L,P)==o){if(D.push(M),L+=P,l>-1&&D.length>=l)return D.push(x.substr(L)),D;M=""}else M+=x.charAt(L),L++;return D.push(M),D},str.splitlines=function(n){var o=$B.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!_b_.isinstance(o.keepends,[_b_.bool,_b_.int]))throw _b_.TypeError("integer argument expected, got "+$B.get_class(o.keepends).__name);var l=_b_.int.$factory(o.keepends),x=[],L=0,D=0;if(!(n=o.self).length)return x;for(;D<n.length;)"\r\n"==n.substr(D,2)?(x.push(n.slice(L,l?D+2:D)),L=D+=2):"\r"==n[D]||"\n"==n[D]?(x.push(n.slice(L,l?D+1:D)),L=D+=1):D++;return L<n.length&&x.push(n.slice(L)),x},str.startswith=function(){var n=$B.args("startswith",4,{self:null,prefix:null,start:null,end:null},["self","prefix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.prefix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,L=o.length;x<L;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(l.substr(0,D.length)==D)return!0}return!1},str.strip=function(){var n=$B.args("strip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(n.chars===_b_.None)return n.self.trim();for(var o=0;o<n.self.length&&-1!=n.chars.indexOf(n.self.charAt(o));o++);for(var l=n.self.length-1;l>=o&&-1!=n.chars.indexOf(n.self.charAt(l));l--);return n.self.substring(o,l+1)},str.swapcase=function(n){$B.args("swapcase",1,{self:n},["self"],arguments,{},null,null);for(var o,l="",x=0,L=n.length;x<L;x++)o=n.charCodeAt(x),l+=unicode_tables.Ll[o]?n.charAt(x).toUpperCase():unicode_tables.Lu[o]?n.charAt(x).toLowerCase():n.charAt(x);return l},str.title=function(n){$B.args("title",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",L=0,D=n.length;L<D;L++)l=n.charCodeAt(L),unicode_tables.Ll[l]?o?x+=n.charAt(L):(x+=n.charAt(L).toUpperCase(),o="word"):unicode_tables.Lu[l]||unicode_tables.Lt[l]?(x+=o?n.charAt(L).toLowerCase():n.charAt(L),o="word"):(o=null,x+=n.charAt(L));return x},str.translate=function(n,o){for(var l=[],x=$B.$getattr(o,"__getitem__"),L=0,D=n.length;L<D;L++)try{var z=x(n.charCodeAt(L));z!==_b_.None&&("string"==typeof z?l.push(z):"number"==typeof z&&l.push(String.fromCharCode(z)))}catch{l.push(n.charAt(L))}return l.join("")},str.upper=function(n){return $B.args("upper",1,{self:null},["self"],arguments,{},null,null),n.toUpperCase()},str.zfill=function(n,o){var l=$B.args("zfill",2,{self:null,width:null},["self","width"],arguments,{},null,null);if(l.width<=n.length)return n;switch(n.charAt(0)){case"+":case"-":return n.charAt(0)+"0".repeat(l.width-n.length)+n.substr(1);default:return"0".repeat(o-n.length)+n}},str.$factory=function(n,o,l){if(0==arguments.length)return"";if(void 0===n)return $B.UndefinedClass.__str__();if(void 0!==o){var x=$B.args("str",3,{arg:null,encoding:null,errors:null},["arg","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);o=x.encoding,l=x.errors}switch(typeof n){case"string":return str.__str__(n);case"number":if(isFinite(n))return n.toString()}try{if(n.$is_class||n.$factory)return $B.$getattr(n.__class__,"__str__")(n);if(n.__class__&&n.__class__===_b_.bytes&&void 0!==o)return _b_.bytes.decode(n,x.encoding,x.errors);var L=n.__class__||$B.get_class(n);if(void 0===L)return $B.JSObj.__str__($B.JSObj.$factory(n));if(null===(D=$B.$getattr(L,"__str__",null))||n.__class__&&n.__class__!==_b_.object&&D.$infos&&D.$infos.__func__===_b_.object.__str__)var D=$B.$getattr(L,"__repr__")}catch(z){throw console.log("no __str__ for",n),console.log("err ",z),$B.debug>1&&console.log(z),console.log("Warning - no method __str__ or __repr__, default to toString",n),z}return $B.$call(D)(n)},str.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("str.__new__(): not enough arguments");return{__class__:n}},$B.set_func_names(str,"builtins");var StringSubclass=$B.StringSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"str"},$is_class:!0};for(var $attr in str)"function"==typeof str[$attr]&&(StringSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,L=arguments.length;x<L;x++)o[l++]=arguments[x]}return str[n].apply(null,o)}}($attr));function fstring_expression(){this.type="expression",this.expression="",this.conversion=null,this.fmt=null}StringSubclass.__new__=function(n){return{__class__:n}},$B.set_func_names(StringSubclass,"builtins"),_b_.str=str,$B.parse_format_spec=function(n){if(""==n)this.empty=!0;else{var o=0,l="<>=^",x="0123456789",L=l.indexOf(n.charAt(0));-1!=L?n.charAt(1)&&-1!=l.indexOf(n.charAt(1))?(this.fill=n.charAt(0),this.align=n.charAt(1),o=2):(this.align=l[L],this.fill=" ",o++):(L=l.indexOf(n.charAt(1)),n.charAt(1)&&-1!=L&&(this.align=l[L],this.fill=n.charAt(0),o=2));var D=n.charAt(o);for("+"!=D&&"-"!=D&&" "!=D||(this.sign=D,o++,D=n.charAt(o)),"#"==D&&(this.alternate=!0,o++,D=n.charAt(o)),"0"==D&&(this.fill="0",-1==L&&(this.align="="),o++,D=n.charAt(o));D&&x.indexOf(D)>-1;)void 0===this.width?this.width=D:this.width+=D,o++,D=n.charAt(o);if(void 0!==this.width&&(this.width=parseInt(this.width)),void 0===this.width&&"{"==D){var z=n.substr(o).search("}");this.width=n.substring(o,z),console.log("width","["+this.width+"]"),o+=z+1}if(","==D&&(this.comma=!0,o++,D=n.charAt(o)),"."==D){if(-1==x.indexOf(n.charAt(o+1)))throw _b_.ValueError.$factory("Missing precision in format spec");for(this.precision=n.charAt(o+1),D=n.charAt(o+=2);D&&x.indexOf(D)>-1;)this.precision+=D,o++,D=n.charAt(o);this.precision=parseInt(this.precision)}if(D&&"bcdeEfFgGnosxX%".indexOf(D)>-1&&(this.type=D,o++,D=n.charAt(o)),o!==n.length)throw _b_.ValueError.$factory("Invalid format specifier: "+n)}this.toString=function(){return(void 0===this.fill?"":_b_.str.$factory(this.fill))+(this.align||"")+(this.sign||"")+(this.alternate?"#":"")+(this.sign_aware?"0":"")+(this.width||"")+(this.comma?",":"")+(this.precision?"."+this.precision:"")+(this.type||"")}},$B.format_width=function(n,o){if(o.width&&n.length<o.width){var l=o.fill||" ",L=o.width-n.length;switch(o.align||"<"){case"<":return n+l.repeat(L);case">":return l.repeat(L)+n;case"=":return"+-".indexOf(n.charAt(0))>-1?n.charAt(0)+l.repeat(L)+n.substr(1):l.repeat(L)+n;case"^":var D=parseInt(L/2);return l.repeat(D)+n+l.repeat(L-D)}}return n},$B.parse_fstring=function(n){for(var o,l=[],x=0,L="",D=null,z=0;x<n.length;)if(null===D)if("{"==(o=n.charAt(x)))"{"==n.charAt(x+1)?(D="string",L="{",x+=2):(D="expression",z=1,x++);else if("}"==o){if(n.charAt(x+1)!=o)throw Error(" f-string: single '}' is not allowed");D="string",L="}",x+=2}else D="string",L=o,x++;else if("string"==D){for(var M=x;M<n.length;)if("{"==(o=n.charAt(M))){if("{"!=n.charAt(M+1)){l.push(L),D="expression",x=M+1;break}L+="{",M+=2}else if("}"==o){if(n.charAt(M+1)!=o)throw Error(" f-string: single '}' is not allowed");L+=o,M+=2}else L+=o,M++;x=M+1}else if("debug"==D){for(;" "==n.charAt(M);)M++;"}"==n.charAt(M)&&(l.push(L),D=null,L="",x=M+1)}else{M=x,z=1;var P=0;for(L=new fstring_expression;M<n.length;)if("{"==(o=n.charAt(M))&&0==P)z++,L.expression+=o,M++;else if("}"==o&&0==P){if(0==(z-=1)){l.push(L),D=null,L="",x=M+1;break}L.expression+=o,M++}else{if("\\"==o)throw Error("f-string expression part cannot include a backslash");if(0==P&&"!"==o&&null===L.fmt&&":}".indexOf(n.charAt(M+2))>-1){if(0==L.expression.length)throw Error("f-string: empty expression not allowed");if(-1=="ars".indexOf(n.charAt(M+1)))throw Error("f-string: invalid conversion character: expected 's', 'r', or 'a'");L.conversion=n.charAt(M+1),M+=2}else if("("==o)P++,L.expression+=o,M++;else if(")"==o)P--,L.expression+=o,M++;else if('"'==o)if('"""'==n.substr(M,3)){if(-1==(ye=n.indexOf('"""',M+3)))throw Error("f-string: unterminated string");var de=n.substring(M,ye+3);de=de.replace("\n","\\n\\"),L.expression+=de,M=ye+3}else{var ye;if(-1==(ye=n.indexOf('"',M+1)))throw Error("f-string: unterminated string");L.expression+=n.substring(M,ye+1),M=ye+1}else if(0==P&&":"==o)L.fmt=!0,L.expression+=o,M++;else if("="==o){var he=L.expression,ae=he.charAt(he.length-1),fe=("()".indexOf(ae)>-1?"\\":"")+ae;if(0==he.length||"="==n.charAt(M+1)||"=!<>:".search(fe)>-1)L.expression+=o+n.charAt(M+1),M+=2;else{for(tail=o;n.charAt(M+1).match(/\s/);)tail+=n.charAt(M+1),M++;for(l.push(L.expression+tail);he.match(/\s$/);)he=he.substr(0,he.length-1);L.expression=he,D="debug",M++}}else L.expression+=o,M++}if(z>0)throw Error("f-string: expected '}'")}return L.length>0&&l.push(L),l};var surrogate=str.$surrogate=$B.make_class("surrogate_string",function(n){for(var o=[],l=0,x=n.length;l<x;l++){var L=n.charCodeAt(l);L>=55296&&L<=56319&&(l++,L=1024*(L-55296)+(n.charCodeAt(l)-56320)+65536),o.push(String.fromCodePoint(L))}return{__class__:str.$surrogate,items:o}});surrogate.__mro__=[str,object],surrogate.__contains__=function(n,o){return str.__contains__(n.items.join(""),o)},surrogate.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.items.length),l>=0&&l<n.items.length)return 2==n.items[l].length?surrogate.$factory(n.items[l]):n.items[l];throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.items.length),L=x.start,D=x.stop,z=x.step,M="",P=null;if(z>0){if(D<=L)return"";for(P=L;P<D;P+=z)M+=n.items[P]}else{if(D>=L)return"";for(P=L;P>D;P+=z)M+=n.items[P]}return M}if(isinstance(o,_b_.bool))return surrogate.__getitem__(n,_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")},surrogate.__hash__=function(n){return str.__hash__(n.items.join(""))},surrogate.__iter__=function(n){return str_iterator.$factory(n.items)},surrogate.__len__=function(n){return n.items.length},surrogate.__repr__=function(n){return str.__repr__(n.items.join(""))},surrogate.__str__=function(n){return str.__str__(n.items.join(""))},$B.set_func_names(surrogate,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var str_hash=_b_.str.__hash__,$N=_b_.None,set_ops=["eq","le","lt","ge","gt","sub","rsub","and","or","xor"];function is_sublist(n,o){for(var l=0,x=n.length;l<x;l++){for(var L=n[l],D=!1,z=0,M=o.length;z<M;z++)if($B.rich_comp("__eq__",L,o[z])){o.splice(z,1),D=!0;break}if(!D)return!1}return!0}dict_view_op={__eq__:function(n,o){return n.length==o.length&&is_sublist(n,o)},__ne__:function(n,o){return!dict_view_op.__eq__(n,o)},__lt__:function(n,o){return n.length<o.length&&is_sublist(n,o)},__gt__:function(n,o){return dict_view_op.__lt__(o,n)},__le__:function(n,o){return n.length<=o.length&&is_sublist(n,o)},__ge__:function(n,o){return dict_view_op.__le__(o,n)},__and__:function(n,o){for(var l=[],x=0,L=n.length;x<L;x++){var D=n[x];flag=!1;for(var z=0,M=o.length;z<M;z++)if($B.rich_comp("__eq__",D,o[z])){o.splice(z,1),l.push(D);break}}return l},__or__:function(n,o){for(var l=n,x=0,L=o.length;x<L;x++){for(var D=o[x],z=!1,M=0,P=n.length;M<P;M++)if($B.rich_comp("__eq__",D,n[M])){o.splice(x,1),z=!0;break}z||l.push(D)}return l}},$B.make_view=function(n){for(var o=$B.make_class(n,function(D,z){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:D,len:D.length,set_like:z}}),l=0,x=set_ops.length;l<x;l++){var L="__"+set_ops[l]+"__";o[L]=function(D){return function(z,M){if(z.set_like)return _b_.set[D](_b_.set.$factory(z),_b_.set.$factory(M));if(M.__class__!==o)return!1;var P=_b_.list.$factory(M);return dict_view_op[D](z.items,P)}}(L)}return o.__iter__=function(D){var z=o.$iterator.$factory(D.items);return z.len_func=D.len_func,z},o.__len__=function(D){return D.len},o.__repr__=function(D){return o.$infos.__name__+"("+_b_.repr(D.items)+")"},$B.set_func_names(o,"builtins"),o};var dict={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"dict"},$is_class:!0,$native:!0};function to_list(n,o){var l=[];if(n.$jsobj){for(var x in l=[],n.$jsobj)if("$"!=x.charAt(0)){var L=n.$jsobj[x];void 0===L?L=_b_.NotImplemented:null===L&&(L=$N),l.push([x,L])}}else if(_b_.isinstance(n,_b_.dict)){for(var D in n.$numeric_dict)l.push([parseFloat(D),n.$numeric_dict[D]]);for(var D in n.$string_dict)l.push([D,n.$string_dict[D]]);for(var D in n.$object_dict)n.$object_dict[D].forEach(function(M){l.push(M)});l.sort(function(z,M){return z[1][1]-M[1][1]}),l=l.map(function(z){return[z[0],z[1][0]]})}return void 0!==o?l.map(function(z){return z[o]}):(l.__class__=_b_.tuple,l.map(function(z){return z.__class__=_b_.tuple,z}))}function dict_iterator_next(n){if(n.len_func()!=n.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(n.counter++,n.counter<n.items.length)return n.items[n.counter];throw _b_.StopIteration.$factory("StopIteration")}dict.$to_obj=function(n){var o={};for(var l in n.$string_dict)o[l]=n.$string_dict[l][0];return o},$B.dict_to_list=to_list;var $copy_dict=function(n,o){var l=to_list(o),x=dict.$setitem;o.$version=o.$version||0;for(var L=o.$version||0,D=0,z=l.length;D<z;D++)if(x(n,l[D][0],l[D][1]),o.$version!=L)throw _b_.RuntimeError.$factory("dict mutated during update")};function rank(n,o,l){var x=n.$object_dict[o];if(void 0!==x)for(var L=0,D=x.length;L<D;L++)if($B.rich_comp("__eq__",l,x[L][0]))return L;return-1}function init_from_list(n,o){for(var l=-1,x=o.length-1,L=dict.__setitem__;l++<x;){var D=o[l];switch(typeof D[0]){case"string":n.$string_dict[D[0]]=[D[1],n.$order++],n.$str_hash[str_hash(D[0])]=D[0],n.$version++;break;case"number":if(0!=D[0]&&1!=D[0]){n.$numeric_dict[D[0]]=[D[1],n.$order++],n.$version++;break}default:L(n,D[0],D[1])}}}dict.__bool__=function(){var n=$B.args("__bool__",1,{self:null},["self"],arguments,{},null,null);return dict.__len__(n.self)>0},dict.__class_getitem__=function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},dict.__contains__=function(){var n=$B.args("__contains__",2,{self:null,key:null},["self","key"],arguments,{},null,null),o=n.self,l=n.key;if(o.$is_namespace&&(l=$B.to_alias(l)),o.$jsobj)return void 0!==o.$jsobj[l];switch(typeof l){case"string":return void 0!==o.$string_dict[l];case"number":return void 0!==o.$numeric_dict[l]}var x=_b_.hash(l);return!(void 0===o.$str_hash[x]||!$B.rich_comp("__eq__",l,o.$str_hash[x]))||!(void 0===o.$numeric_dict[x]||!$B.rich_comp("__eq__",l,x))||rank(o,x,l)>-1},dict.__delitem__=function(){var n=$B.args("__eq__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null),o=n.self,l=n.arg;if(o.$jsobj){if(void 0===o.$jsobj[l])throw _b_.KeyError.$factory(l);return delete o.$jsobj[l],$N}switch(typeof l){case"string":if(void 0===o.$string_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$string_dict[l],delete o.$str_hash[str_hash(l)],o.$version++,$N;case"number":if(void 0===o.$numeric_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$numeric_dict[l],o.$version++,$N}var x,L=_b_.hash(l);if(!((x=rank(o,L,l))>-1))throw _b_.KeyError.$factory(_b_.str.$factory(l));return o.$object_dict[L].splice(x,1),o.$version++,$N},dict.__eq__=function(){var n=$B.args("__eq__",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=n.self,l=n.other;if(!_b_.isinstance(l,dict)||(o.$jsobj&&(o=jsobj2dict(o.$jsobj)),l.$jsobj&&(l=jsobj2dict(l.$jsobj)),dict.__len__(o)!=dict.__len__(l))||o.$string_dict.length!=l.$string_dict.length)return!1;for(var x in o.$numeric_dict)if(l.$numeric_dict.hasOwnProperty(x)){if(!$B.rich_comp("__eq__",l.$numeric_dict[x][0],o.$numeric_dict[x][0]))return!1}else{if(!l.$object_dict.hasOwnProperty(x))return!1;for(var L=!1,D=0,z=(P=l.$object_dict[x]).length;D<z;D++)if($B.rich_comp("__eq__",x,P[D][0])&&$B.rich_comp("__eq__",o.$numeric_dict[x],P[D][1])){L=!0;break}if(!L)return!1}for(var x in o.$string_dict)if(!l.$string_dict.hasOwnProperty(x)||!$B.rich_comp("__eq__",l.$string_dict[x][0],o.$string_dict[x][0]))return!1;for(var M in o.$object_dict){var P=o.$object_dict[M],de=[];if(void 0!==l.$numeric_dict[M]&&de.push([M,l.$numeric_dict[M]]),void 0!==l.$object_dict[M]&&(de=de.concat(l.$object_dict[M])),0==de.length)return!1;D=0;for(var ye=P.length;D<ye;D++){L=!1;for(var he=P[D][0],ae=P[D][1][0],fe=0,le=de.length;fe<le;fe++)if($B.rich_comp("__eq__",he,de[fe][0])&&$B.rich_comp("__eq__",ae,de[fe][1][0])){L=!0;break}if(!L)return!1}}return!0},dict.__getitem__=function(){var n=$B.args("__getitem__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null);return dict.$getitem(n.self,n.arg)},dict.$getitem=function(n,o){if(n.$jsobj){if(void 0===n.$jsobj[o]){if(n.$jsobj.hasOwnProperty(o))return $B.Undefined;throw _b_.KeyError.$factory(o)}return n.$jsobj[o]}switch(typeof o){case"string":if(void 0!==n.$string_dict[o])return n.$string_dict[o][0];break;case"number":if(void 0!==n.$numeric_dict[o])return n.$numeric_dict[o][0]}var l=_b_.hash(o),x=function(P){return $B.rich_comp("__eq__",o,P)};"object"==typeof o&&(o.$hash=l);var L=n.$str_hash[l];if(void 0!==L&&x(L))return n.$string_dict[L][0];if(void 0!==n.$numeric_dict[l]&&x(l))return n.$numeric_dict[l][0];if(_b_.isinstance(o,_b_.str)){var D=n.$string_dict[o.valueOf()];if(void 0!==D)return D[0]}var z=rank(n,l,o);if(z>-1)return n.$object_dict[l][z][1][0];if(n.__class__!==dict){try{var M=getattr(n.__class__,"__missing__",_b_.None)}catch(P){console.log(P)}if(M!==_b_.None)return M(n,o)}throw _b_.KeyError.$factory(o)},dict.__hash__=_b_.None,dict.__init__=function(n,o,l){var x;if(void 0===o)return $N;if(void 0===l){if("kw"!=o.$nat&&$B.get_class(o)===$B.JSObj){for(var L in o)n.$string_dict[L]=[o[L],n.$order++];return _b_.None}if(o.$jsobj){for(var D in n.$jsobj={},o.$jsobj)n.$jsobj[D]=o.$jsobj[D];return $N}if(Array.isArray(o))return init_from_list(n,o),$N}var z=(x=x||$B.args("dict",1,{self:null},["self"],arguments,{},"first","second")).first;if(z.length>1)throw _b_.TypeError.$factory("dict expected at most 1 argument, got 2");if(1==z.length)if((z=z[0]).__class__===dict)["$string_dict","$str_hash","$numeric_dict","$object_dict"].forEach(function(ae){for(L in z[ae])n[ae][L]=z[ae][L]});else if(_b_.isinstance(z,dict))$copy_dict(n,z);else{var M=$B.$getattr(z,"keys",null);if(null!==M){var P=$B.$getattr(z,"__getitem__",null);if(null!==P){P=$B.$call(P);for(var de=_b_.iter($B.$call(M)());;)try{var ye=P(L=_b_.next(de));dict.__setitem__(n,L,ye)}catch(ae){if(ae.__class__===_b_.StopIteration)break;throw ae}return $N}}Array.isArray(z)||(z=_b_.list.$factory(z)),init_from_list(n,z)}var he=x.second.$string_dict;for(var D in he)switch(typeof D){case"string":n.$string_dict[D]=[he[D][0],n.$order++],n.$str_hash[str_hash(D)]=D;break;case"number":n.$numeric_dict[D]=[he[D][0],n.$order++];break;default:si(n,D,he[D][0])}return $N},dict.__iter__=function(n){return _b_.iter(dict.$$keys(n))},dict.__ior__=function(n,o){return dict.update(n,o),n},dict.__len__=function(n){var o=0;if(n.$jsobj){for(var l in n.$jsobj)"$"!=l.charAt(0)&&o++;return o}for(var x in n.$numeric_dict)o++;for(var x in n.$string_dict)o++;for(var L in n.$object_dict)o+=n.$object_dict[L].length;return o},dict.__ne__=function(n,o){return!dict.__eq__(n,o)},dict.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");var o={__class__:n,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0};return n!==dict&&(o.__dict__=$B.empty_dict()),o},dict.__or__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(n);return dict.update(l,o),l},dict.__repr__=function(n){if(n.$jsobj)return dict.__repr__(jsobj2dict(n.$jsobj));if($B.repr.enter(n))return"{...}";var o=[];return to_list(n).forEach(function(l){try{o.push(repr(l[0])+": "+repr(l[1]))}catch(x){throw x}}),$B.repr.leave(n),"{"+o.join(", ")+"}"},dict.__ror__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(o);return dict.update(l,n),l},dict.__setitem__=function(n,o,l){var x=$B.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);return dict.$setitem(x.self,x.key,x.value)},dict.$setitem=function(n,o,l,x){if(n.$jsobj)return n.$from_js&&(l=$B.pyobj2jsobj(l)),n.$jsobj.__class__===_b_.type?(n.$jsobj[o]=l,"__init__"!=o&&"__new__"!=o||(n.$jsobj.$factory=$B.$instance_creator(n.$jsobj))):n.$jsobj[o]=l,$N;switch(typeof o){case"string":return void 0===n.$string_dict&&console.log("pas de string dict",n,o,l),void 0!==n.$string_dict[o]?n.$string_dict[o][0]=l:(n.$string_dict[o]=[l,n.$order++],n.$str_hash[str_hash(o)]=o,n.$version++),$N;case"number":if(void 0!==n.$numeric_dict[o])n.$numeric_dict[o][0]=l;else{var L=!1;if((0==o||1==o)&&void 0!==n.$object_dict[o])for(const he of n.$object_dict[o])(0==o&&!1===he[0]||1==o&&!0===he[0])&&(he[1][0]=l,L=!0);L||(n.$numeric_dict[o]=[l,n.$order++]),n.$version++}return $N;case"boolean":var D=o?1:0;if(void 0!==n.$numeric_dict[D])return void(n.$numeric_dict[D]=[l,n.$numeric_dict[D][1]]);void 0!==n.$object_dict[D]?n.$object_dict[D].push([o,[l,n.$order++]]):n.$object_dict[D]=[[o,[l,n.$order++]]]}var M=void 0===x?_b_.hash(o):x,P=function(he){return $B.rich_comp("__eq__",o,he)};if(void 0!==n.$numeric_dict[M]&&P(M))return n.$numeric_dict[M]=[l,n.$numeric_dict[M][1]],n.$version++,$N;var de=n.$str_hash[M];if(void 0!==de&&P(de))return n.$string_dict[de]=[l,n.$string_dict[de][1]],n.$version++,$N;if(x)return void 0!==n.$object_dict[x]?n.$object_dict[x].push([o,[l,n.$order++]]):n.$object_dict[x]=[[o,[l,n.$order++]]],n.$version++,$N;var ye=rank(n,M,o);return ye>-1?(n.$object_dict[M][ye][1]=[l,n.$object_dict[M][ye][1][1]],$N):(n.$object_dict.hasOwnProperty(M)?n.$object_dict[M].push([o,[l,n.$order++]]):n.$object_dict[M]=[[o,[l,n.$order++]]],n.$version++,$N)},dict.__str__=function(){return dict.__repr__.apply(null,arguments)},$B.make_rmethods(dict),dict.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null).self;if(n.$numeric_dict={},n.$string_dict={},n.$str_hash={},n.$object_dict={},n.$jsobj)for(var o in n.$jsobj)"$"!==o.charAt(0)&&"__class__"!==o&&delete n.$jsobj[o];return n.$version++,n.$order=0,$N},dict.copy=function(n){n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null).self;var o=$B.empty_dict();return $copy_dict(o,n),o},dict.fromkeys=function(){for(var n=$B.args("fromkeys",3,{cls:null,keys:null,value:null},["cls","keys","value"],arguments,{value:_b_.None},null,null),o=n.keys,l=n.value,x=n.cls,L=$B.$call(x)(),D=$B.$iter(o);;)try{var z=_b_.next(D);x===dict?dict.$setitem(L,z,l):$B.$getattr(L,"__setitem__")(z,l)}catch(M){if($B.is_exc(M,[_b_.StopIteration]))return L;throw M}},dict.get=function(){var n=$B.args("get",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null);try{return dict.__getitem__(n.self,n.key)}catch(o){if(_b_.isinstance(o,_b_.KeyError))return n._default;throw o}};var dict_items=$B.make_view("dict_items",!0);dict_items.$iterator=$B.make_iterator_class("dict_itemiterator"),dict.items=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("items() takes no arguments ("+(arguments.length-1)+" given)");for(var l=to_list(n),x=!0,L=0,D=l.length;L<D;L++)try{_b_.hash(l[L][1])}catch{x=!1;break}var z=dict_items.$factory(to_list(n),x);return z.len_func=function(){return dict.__len__(n)},z};var dict_keys=$B.make_view("dict_keys");dict_keys.$iterator=$B.make_iterator_class("dict_keyiterator"),dict.$$keys=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("keys() takes no arguments ("+(arguments.length-1)+" given)");var l=dict_keys.$factory(to_list(n,0),!0);return l.len_func=function(){return dict.__len__(n)},l},dict.pop=function(){var n={},o=$B.args("pop",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:n},null,null),l=o.self,x=o.key,L=o._default;try{var D=dict.__getitem__(l,x);return dict.__delitem__(l,x),D}catch(z){if(z.__class__===_b_.KeyError){if(L!==n)return L;throw z}throw z}},dict.popitem=function(n){try{var o=_b_.next(_b_.iter(dict.items(n)));return dict.__delitem__(n,o[0]),_b_.tuple.$factory(o)}catch(l){if(l.__class__==_b_.StopIteration)throw _b_.KeyError.$factory("'popitem(): dictionary is empty'")}},dict.setdefault=function(){var n=$B.args("setdefault",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null),o=n.self,l=n.key,x=n._default;try{return dict.__getitem__(o,l)}catch(D){if(D.__class__!==_b_.KeyError)throw D;void 0===x&&(x=$N);var L=l.$hash;return l.$hash=void 0,dict.$setitem(o,l,x,L),x}},dict.update=function(n){var o=$B.args("update",1,{self:null},["self"],arguments,{},"args","kw"),l=(n=o.self,o.args),x=o.kw;if(l.length>0){var L=l[0];if(_b_.isinstance(L,dict))L.$jsobj&&(L=jsobj2dict(L.$jsobj)),$copy_dict(n,L);else if(_b_.hasattr(L,"keys"))for(var D=_b_.list.$factory($B.$call($B.$getattr(L,"keys"))()),z=0,M=D.length;z<M;z++){var P=getattr(L,"__getitem__")(D[z]);dict.$setitem(n,D[z],P)}else{var de=_b_.iter(L);for(z=0;;){try{var ye=_b_.next(de)}catch(he){if(he.__class__===_b_.StopIteration)break;throw he}try{key_value=_b_.list.$factory(ye)}catch{throw _b_.TypeError.$factory("cannot convert dictionary update sequence element #"+z+" to a sequence")}if(2!==key_value.length)throw _b_.ValueError.$factory("dictionary update sequence element #"+z+" has length "+key_value.length+"; 2 is required");dict.$setitem(n,key_value[0],key_value[1]),z++}}}return $copy_dict(n,x),n.$version++,$N};var dict_values=$B.make_view("dict_values");dict_values.$iterator=$B.make_iterator_class("dict_valueiterator"),dict.values=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("values() takes no arguments ("+(arguments.length-1)+" given)");to_list(n,1);var l=dict_values.$factory(to_list(n,1),!1);return l.len_func=function(){return dict.__len__(n)},l},dict.$factory=function(){for(var n=dict.__new__(dict),o=[n],l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);return dict.__init__.apply(null,o),n},_b_.dict=dict,$B.set_func_names(dict,"builtins"),dict.__class_getitem__=_b_.classmethod.$factory(dict.__class_getitem__),$B.empty_dict=function(){return{__class__:dict,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0}},dict.fromkeys=_b_.classmethod.$factory(dict.fromkeys),$B.getset_descriptor=$B.make_class("getset_descriptor",function(n,o){return{__class__:$B.getset_descriptor,__doc__:_b_.None,cls:n,attr:o}}),$B.getset_descriptor.__repr__=$B.getset_descriptor.__str__=function(n){return`<attribute '${n.attr}' of '${n.cls.$infos.__name__}' objects>`},$B.set_func_names($B.getset_descriptor,"builtins");var mappingproxy=$B.mappingproxy=$B.make_class("mappingproxy",function(n){if(_b_.isinstance(n,dict))var o=$B.obj_dict(dict.$to_obj(n));else o=$B.obj_dict(n);return o.__class__=mappingproxy,o});for(var attr in mappingproxy.__setitem__=function(){throw _b_.TypeError.$factory("'mappingproxy' object does not support item assignment")},dict)void 0!==mappingproxy[attr]||["__class__","__mro__","__new__","__init__","__delitem__","clear","fromkeys","pop","popitem","setdefault","update"].indexOf(attr)>-1||(mappingproxy[attr]="function"==typeof dict[attr]?function(n){return function(){return dict[n].apply(null,arguments)}}(attr):dict[attr]);function jsobj2dict(n){var o=$B.empty_dict();for(var l in n)if("$"!=l.charAt(0)&&"__class__"!==l)if(null===n[l])o.$string_dict[l]=[_b_.None,o.$order++];else{if(void 0===n[l])continue;o.$string_dict[l]=n[l].$jsobj===n?[o,o.$order++]:[$B.$JS2Py(n[l]),o.$order++]}return o}$B.set_func_names(mappingproxy,"builtins"),$B.obj_dict=function(n,o){var l=n.__class__||$B.get_class(n);if(void 0!==l&&l.$native)throw _b_.AttributeError.$factory(l.__name__+" has no attribute '__dict__'");var x=$B.empty_dict();return x.$jsobj=n,x.$from_js=o,x}}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=self;function L(Q){var xe=0,Pe=0,Ge=Q.width||Q.offsetWidth,Ae=Q.height||Q.offsetHeight;for(document;Q.offsetParent;)xe+=Q.offsetLeft,Pe+=Q.offsetTop,Q=Q.offsetParent;if(xe+=Q.offsetLeft||0,Pe+=Q.offsetTop||0,Q.parentElement){var Xe=L(Q.parentElement);xe+=Xe.left,Pe+=Xe.top}return{left:xe,top:Pe,width:Ge,height:Ae}}function D(Q){if(Q.type.startsWith("touch"))return(xe={}).x=o.int.$factory(Q.touches[0].screenX),xe.y=o.int.$factory(Q.touches[0].screenY),xe.__getattr__=function(Ae){return this[Ae]},xe.__class__="MouseCoords",xe;var xe,Pe=0,Ge=0;return Q||(Q=x.event),Q.pageX||Q.pageY?(Pe=Q.pageX,Ge=Q.pageY):(Q.clientX||Q.clientY)&&(Pe=Q.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,Ge=Q.clientY+document.body.scrollTop+document.documentElement.scrollTop),(xe={}).x=o.int.$factory(Pe),xe.y=o.int.$factory(Ge),xe.__getattr__=function(Ae){return this[Ae]},xe.__class__="MouseCoords",xe}n.$isNode=function(Q){return"object"==typeof Node?Q instanceof Node:Q&&"object"==typeof Q&&"number"==typeof Q.nodeType&&"string"==typeof Q.nodeName},n.$isNodeList=function(Q){try{var xe=Object.prototype.toString.call(Q),Pe=new RegExp("^\\[object (HTMLCollection|NodeList)\\]$");return"object"==typeof Q&&null!==Pe.exec(xe)&&void 0!==Q.length&&(0==Q.length||"object"==typeof Q[0]&&Q[0].nodeType>0)}catch{return!1}};var z=["NONE","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","type","target","currentTarget","eventPhase","bubbles","cancelable","timeStamp","stopPropagation","preventDefault","initEvent"],M=["altKey","altLeft","button","cancelBubble","clientX","clientY","contentOverflow","ctrlKey","ctrlLeft","data","dataFld","dataTransfer","fromElement","keyCode","nextPage","offsetX","offsetY","origin","propertyName","reason","recordset","repeat","screenX","screenY","shiftKey","shiftLeft","source","srcElement","srcFilter","srcUrn","toElement","type","url","wheelDelta","x","y"];n.$isEvent=function(Q){for(var xe=!0,Pe=0;Pe<z.length;Pe++)if(void 0===Q[z[Pe]]){xe=!1;break}if(xe)return!0;for(Pe=0;Pe<M.length;Pe++)if(void 0===Q[M[Pe]])return!1;return!0};var P={1:"ELEMENT",2:"ATTRIBUTE",3:"TEXT",4:"CDATA_SECTION",5:"ENTITY_REFERENCE",6:"ENTITY",7:"PROCESSING_INSTRUCTION",8:"COMMENT",9:"DOCUMENT",10:"DOCUMENT_TYPE",11:"DOCUMENT_FRAGMENT",12:"NOTATION"},de=n.make_class("Attributes",function(Q){return{__class__:de,elt:Q}});de.__contains__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);return Q.self.elt instanceof SVGElement?Q.self.elt.hasAttributeNS(null,Q.key):"function"==typeof Q.self.elt.hasAttribute&&Q.self.elt.hasAttribute(Q.key)},de.__delitem__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(!de.__contains__(Q.self,Q.key))throw o.KeyError.$factory(Q.key);return Q.self.elt instanceof SVGElement?(Q.self.elt.removeAttributeNS(null,Q.key),o.None):"function"==typeof Q.self.elt.hasAttribute?(Q.self.elt.removeAttribute(Q.key),o.None):void 0},de.__getitem__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(Q.self.elt instanceof SVGElement&&Q.self.elt.hasAttributeNS(null,Q.key))return Q.self.elt.getAttributeNS(null,Q.key);if("function"==typeof Q.self.elt.hasAttribute&&Q.self.elt.hasAttribute(Q.key))return Q.self.elt.getAttribute(Q.key);throw o.KeyError.$factory(Q.key)},de.__iter__=function(Q){Q.$counter=0;for(var xe=Q.elt.attributes,Pe=[],Ge=0;Ge<xe.length;Ge++)Pe.push(xe[Ge].name);return Q.$items=Pe,Q},de.__next__=function(){var Q=n.args("__next__",1,{self:null},["self"],arguments,{},null,null);if(Q.self.$counter<Q.self.$items.length){var xe=Q.self.$items[Q.self.$counter];return Q.self.$counter++,xe}throw o.StopIteration.$factory("")},de.__setitem__=function(){var Q=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);if(Q.self.elt instanceof SVGElement&&"function"==typeof Q.self.elt.setAttributeNS)return Q.self.elt.setAttributeNS(null,Q.key,Q.value),o.None;if("function"==typeof Q.self.elt.setAttribute)return Q.self.elt.setAttribute(Q.key,Q.value),o.None;throw o.TypeError.$factory("Can't set attributes on element")},de.__repr__=de.__str__=function(Q){for(var xe=Q.elt.attributes,Pe=[],Ge=0;Ge<xe.length;Ge++)Pe.push(xe[Ge].name+': "'+Q.elt.getAttributeNS(null,xe[Ge].name)+'"');return"{"+Pe.join(", ")+"}"},de.get=function(){var Q=n.args("get",3,{self:null,key:null,deflt:null},["self","key","deflt"],arguments,{deflt:o.None},null,null);try{return de.__getitem__(Q.self,Q.key)}catch(xe){if(xe.__class__===o.KeyError)return Q.deflt;throw xe}},de.keys=function(){return de.__iter__.apply(null,arguments)},de.items=function(){for(var Q=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,xe=[],Pe=0;Pe<Q.length;Pe++)xe.push([Q[Pe].name,Q[Pe].value]);return o.list.__iter__(xe)},de.values=function(){for(var Q=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,xe=[],Pe=0;Pe<Q.length;Pe++)xe.push(Q[Pe].value);return o.list.__iter__(xe)},n.set_func_names(de,"<dom>");var ye=n.DOMEvent={__class__:o.type,__mro__:[l],$infos:{__name__:"DOMEvent"}};function he(Q,xe){var Pe=Q.createSVGPoint();return Pe.x=xe.x,Pe.y=xe.y,Pe.matrixTransform(Q.getScreenCTM().inverse())}ye.__new__=function(Q,xe){var Pe=new Event(xe);return Pe.__class__=ye,void 0===Pe.preventDefault&&(Pe.preventDefault=function(){Pe.returnValue=!1}),void 0===Pe.stopPropagation&&(Pe.stopPropagation=function(){Pe.cancelBubble=!0}),Pe},ye.__getattribute__=function(Q,xe){switch(xe){case"__repr__":case"__str__":return function(){return"<DOMEvent object>"};case"x":return D(Q).x;case"y":return D(Q).y;case"data":return null!==Q.dataTransfer?fe.$factory(Q.dataTransfer):n.$JS2Py(Q.data);case"target":if(void 0!==Q.target)return A.$factory(Q.target);case"char":return String.fromCharCode(Q.which);case"svgX":if(Q.target instanceof SVGSVGElement)return Math.floor(he(Q.target,D(Q)).x);throw o.AttributeError.$factory("event target is not an SVG element");case"svgY":if(Q.target instanceof SVGSVGElement)return Math.floor(he(Q.target,D(Q)).y);throw o.AttributeError.$factory("event target is not an SVG element")}var Pe=Q[xe];if(void 0!==Pe){if("function"==typeof Pe){var Ge=function(){for(var Ae=[],Xe=0;Xe<arguments.length;Xe++)Ae.push(n.pyobj2jsobj(arguments[Xe]));return Pe.apply(Q,arguments)};return Ge.$infos={__name__:Pe.name,__qualname__:Pe.name},Ge}return n.$JS2Py(Pe)}throw o.AttributeError.$factory("object DOMEvent has no attribute '"+xe+"'")},ye.$factory=function(Q){return ye.__new__(ye,Q)};var ae=n.$DOMEvent=function(Q){return Q.__class__=ye,Q.$no_dict=!0,void 0===Q.preventDefault&&(Q.preventDefault=function(){Q.returnValue=!1}),void 0===Q.stopPropagation&&(Q.stopPropagation=function(){Q.cancelBubble=!0}),Q};n.set_func_names(ye,"browser");var fe={__class__:o.type,$infos:{__module__:"browser",__name__:"Clipboard"},__getitem__:function(Q,xe){return Q.data.getData(xe)}};fe.__mro__=[l],fe.__setitem__=function(Q,xe,Pe){Q.data.setData(xe,Pe)},fe.$factory=function(Q){return{__class__:fe,__dict__:n.empty_dict(),data:Q}},n.set_func_names(fe,"<dom>");var le=n.OpenFile={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"OpenFile"}};le.$factory=function(Q,xe,Pe){var Ge={__class__:$OpenFileDict,file:Q,reader:new FileReader};return"r"===xe?Ge.reader.readAsText(Q,Pe):"rb"===xe&&Ge.reader.readAsBinaryString(Q),Ge},le.__getattr__=function(Q,xe){return void 0!==Q["get_"+xe]?Q["get_"+xe]:Q.reader[xe]},le.__setattr__=function(Q,xe,Pe){var Ge=Q.reader;if("on"==xe.substr(0,2))Ge.addEventListener(xe.substr(2),function(Ae){return Pe(ae(Ae))});else{if("set_"+xe in Ge)return Ge["set_"+xe](Pe);xe in Ge?Ge[xe]=Pe:setattr(Ge,xe,Pe)}},n.set_func_names(le,"<dom>");var q={File:function(){},FileReader:function(){}};q.File.__class__=o.type,q.File.__str__=function(){return"<class 'File'>"},q.FileReader.__class__=o.type,q.FileReader.__str__=function(){return"<class 'FileReader'>"};var Y={__class__:o.type,__delitem__:function(Q,xe){Q.parent.options.remove(xe.elt)},__getitem__:function(Q,xe){return A.$factory(Q.parent.options[xe])},__len__:function(Q){return Q.parent.options.length},__mro__:[l],__setattr__:function(Q,xe,Pe){Q.parent.options[xe]=Pe},__setitem__:function(Q,xe,Pe){Q.parent.options[xe]=n.$JS2Py(Pe)},__str__:function(Q){return"<object Options wraps "+Q.parent.options+">"},append:function(Q,xe){Q.parent.options.add(xe.elt)},insert:function(Q,xe,Pe){void 0===xe?Q.parent.options.add(Pe.elt):Q.parent.options.add(Pe.elt,xe)},item:function(Q,xe){return Q.parent.options.item(xe)},namedItem:function(Q,xe){return Q.parent.options.namedItem(xe)},remove:function(Q,xe){Q.parent.options.remove(xe.elt)},$infos:{__module__:"<pydom>",__name__:"Options"},$factory:function(Q){return{__class__:Y,parent:Q}}};n.set_func_names(Y,"<dom>");var A={__class__:o.type,__mro__:[l],$infos:{__module__:"browser",__name__:"DOMNode"}};function N(Q){for(var xe=[],Pe=0;Pe<Q.length;Pe++)xe.push(A.$factory(Q[Pe]));return xe}A.$factory=function(Q,xe){if(Q.__class__===A||"number"==typeof Q||"boolean"==typeof Q||"string"==typeof Q)return Q;if(void 0===xe&&void 0!==A.tags){var Pe=A.tags.$string_dict;if(void 0!==Pe&&Pe.hasOwnProperty(Q.tagName)){try{var Ge=Pe[Q.tagName][0]}catch(Ae){throw console.log("tdict",Pe,"tag name",Q.tagName),Ae}if(void 0!==Ge)return Ge.$elt_wrap=Q,Ge.$factory()}}return void 0!==Q.$brython_id&&9!=Q.nodeType||(Q.$brython_id="DOM-"+n.UUID()),Q},A.__add__=function(Q,xe){var Pe=H.$factory();if(Pe.children=[Q],pos=1,o.isinstance(xe,H))Pe.children=Pe.children.concat(xe.children);else if(o.isinstance(xe,[o.str,o.int,o.float,o.list,o.dict,o.set,o.tuple]))Pe.children[pos++]=A.$factory(document.createTextNode(o.str.$factory(xe)));else if(o.isinstance(xe,A))Pe.children[pos++]=xe;else try{Pe.children=Pe.children.concat(o.list.$factory(xe))}catch{throw o.TypeError.$factory("can't add '"+n.class_name(xe)+"' object to DOMNode instance")}return Pe},A.__bool__=function(Q){return!0},A.__contains__=function(Q,xe){if(9==Q.nodeType&&"string"==typeof xe)return null!==document.getElementById(xe);if(void 0!==Q.length&&"function"==typeof Q.item)for(var Pe=0,Ge=Q.length;Pe<Ge;Pe++)if(Q.item(Pe)===xe)return!0;return!1},A.__del__=function(Q){if(!Q.parentNode)throw o.ValueError.$factory("can't delete "+o.str.$factory(Q));Q.parentNode.removeChild(Q)},A.__delattr__=function(Q,xe){if(void 0===Q[xe])throw o.AttributeError.$factory(`cannot delete DOMNode attribute '${xe}'`);return delete Q[xe],o.None},A.__delitem__=function(Q,xe){if(9==Q.nodeType){var Pe=Q.getElementById(xe);if(!Pe)throw o.KeyError.$factory(xe);Pe.parentNode.removeChild(Pe)}else Q.parentNode.removeChild(Q)},A.__dir__=function(Q){var xe=[];for(var Pe in Q)"$"!=Pe.charAt(0)&&xe.push(Pe);return xe.sort(),xe},A.__eq__=function(Q,xe){return Q==xe},A.__getattribute__=function(Q,xe){switch("$$"==xe.substr(0,2)&&(xe=xe.substr(2)),xe){case"attrs":return de.$factory(Q);case"class_name":case"html":case"id":case"parent":case"text":return A[xe](Q);case"height":case"left":case"top":case"width":if("CANVAS"==Q.tagName&&Q[xe])return Q[xe];if(Q instanceof SVGElement)return Q[xe].baseVal.value;if(Q.style[xe])return parseInt(Q.style[xe]);var Pe=window.getComputedStyle(Q)[xe];if(void 0!==Pe)return Math.floor(parseFloat(Pe)+.5);throw o.AttributeError.$factory("style."+xe+" is not set for "+o.str.$factory(Q));case"x":case"y":if(!(Q instanceof SVGElement)){var Ge=L(Q);return"x"==xe?Ge.left:Ge.top}case"clear":case"closest":return function(){return A[xe](Q,arguments[0])};case"headers":if(9==Q.nodeType){var Ae=new XMLHttpRequest;Ae.open("GET",document.location,!1),Ae.send(null);var Xe=Ae.getAllResponseHeaders();Xe=Xe.split("\r\n");for(var Ke=n.empty_dict(),yt=0;yt<Xe.length;yt++){var dt=Xe[yt];0!=dt.strip().length&&(Ge=dt.search(":"),Ke.__setitem__(dt.substr(0,Ge),dt.substr(Ge+1).lstrip()))}return Ke}break;case"$$location":xe="location"}if("select"==xe&&1==Q.nodeType&&["INPUT","TEXTAREA"].indexOf(Q.tagName.toUpperCase())>-1)return function(dn){return void 0===dn?(Q.select(),o.None):A.select(Q,dn)};if("query"==xe&&9==Q.nodeType){Ke={__class__:X,_keys:[],_values:{}};var Pt=location.search.substr(1).split("&");if(""!=location.search)for(yt=0;yt<Pt.length;yt++){Ge=Pt[yt].search("=");var wt=[Pt[yt].substr(0,Ge),Pt[yt].substr(Ge+1)],Gt=decodeURIComponent(wt[0]),Dt=decodeURIComponent(wt[1]);Ke._keys.indexOf(Gt)>-1?Ke._values[Gt].push(Dt):(Ke._keys.push(Gt),Ke._values[Gt]=[Dt])}return Ke}var dn,On,sn=Q[xe];if(void 0===sn&&n.aliased_names[xe]&&(sn=Q["$$"+xe]),void 0===sn){if(Q.tagName){var gt=customElements.get(Q.tagName.toLowerCase());if(void 0!==gt&&void 0!==gt.$cls){var Mn=Q.__class__;Q.__class__=gt.$cls;try{return Ke=o.object.__getattribute__(Q,xe),Q.__class__=Mn,Ke}catch(dn){if(Q.__class__=Mn,!n.is_exc(dn,[o.AttributeError]))throw dn}}}return l.__getattribute__(Q,xe)}if(void 0!==(Ke=sn)){if(null===Ke)return o.None;if("function"==typeof Ke){var Bn=(dn=Ke,On=Q,function(){for(var Ln=[],mn=0,cr=0;cr<arguments.length;cr++){var ir=arguments[cr];if("function"==typeof ir){if(ir.$cache)var ur=ir.$cache;else ur=function(ni){return function(){try{return ni.apply(null,arguments)}catch(Kr){n.handle_error(Kr)}}}(ir),ir.$cache=ur;Ln[mn++]=ur}else o.isinstance(ir,A)?Ln[mn++]=ir:Ln[mn++]=ir===o.None?null:ir.__class__==o.dict?o.dict.$to_obj(ir):ir}var or=dn.apply(On,Ln);return n.$JS2Py(or)});return Bn.$infos={__name__:xe,__qualname__:xe},Bn.$is_func=!0,Bn}return"options"==xe?Y.$factory(Q):"style"==xe?n.JSObj.$factory(Q[xe]):Array.isArray(Ke)?Ke:n.$JS2Py(Ke)}return l.__getattribute__(Q,xe)},A.__getitem__=function(Q,xe){if(9==Q.nodeType){if("string"==typeof xe){if(Ge=Q.getElementById(xe))return A.$factory(Ge);throw o.KeyError.$factory(xe)}try{for(var Pe=Q.getElementsByTagName(xe.$infos.__name__),Ge=[],Ae=0;Ae<Pe.length;Ae++)Ge.push(A.$factory(Pe[Ae]));return Ge}catch{throw o.KeyError.$factory(o.str.$factory(xe))}}else{if(("number"==typeof xe||"boolean"==typeof xe)&&"function"==typeof Q.item){var Xe=o.int.$factory(xe);if(Xe<0&&(Xe+=Q.length),void 0===(Ge=A.$factory(Q.item(Xe))))throw o.KeyError.$factory(xe);return Ge}if("string"==typeof xe&&Q.attributes&&"function"==typeof Q.attributes.getNamedItem){var Ke=Q.attributes.getNamedItem(xe);if(Ke)return Ke.value;throw o.KeyError.$factory(xe)}}},A.__hash__=function(Q){return void 0===Q.__hashvalue__?Q.__hashvalue__=n.$py_next_hash--:Q.__hashvalue__},A.__iter__=function(Q){if(void 0!==Q.length&&"function"==typeof Q.item)for(var xe=[],Pe=0,Ge=Q.length;Pe<Ge;Pe++)xe.push(A.$factory(Q.item(Pe)));else if(void 0!==Q.childNodes)for(xe=[],Pe=0,Ge=Q.childNodes.length;Pe<Ge;Pe++)xe.push(A.$factory(Q.childNodes[Pe]));return n.$iter(xe)},A.__le__=function(Q,xe){if(9==Q.nodeType&&(Q=Q.body),o.isinstance(xe,H))for(var Pe=0;Pe<xe.children.length;Pe++)Q.appendChild(xe.children[Pe]);else if("string"==typeof xe||"number"==typeof xe){var Ge=document.createTextNode(xe.toString());Q.appendChild(Ge)}else if(o.isinstance(xe,A))Q.appendChild(xe);else try{o.list.$factory(xe).forEach(function(Ae){A.__le__(Q,Ae)})}catch{throw o.TypeError.$factory("can't add '"+n.class_name(xe)+"' object to DOMNode instance")}return!0},A.__len__=function(Q){return Q.length},A.__mul__=function(Q,xe){if(o.isinstance(xe,o.int)&&xe.valueOf()>0){for(var Pe=H.$factory(),Ge=Pe.children.length,Ae=0;Ae<xe.valueOf();Ae++)Pe.children[Ge++]=A.clone(Q)();return Pe}throw o.ValueError.$factory("can't multiply "+Q.__class__+"by "+xe)},A.__ne__=function(Q,xe){return!A.__eq__(Q,xe)},A.__next__=function(Q){if(Q.$counter++,Q.$counter<Q.childNodes.length)return A.$factory(Q.childNodes[Q.$counter]);throw o.StopIteration.$factory("StopIteration")},A.__radd__=function(Q,xe){var Pe=H.$factory(),Ge=A.$factory(document.createTextNode(xe));return Pe.children=[Ge,Q],Pe},A.__str__=A.__repr__=function(Q){var xe=Q.attributes;if(void 0!==xe)for(var Pe=[],Ge=0;Ge<xe.length;Ge++)Pe.push(xe[Ge].name+'="'+Q.getAttributeNS(null,xe[Ge].name)+'"');var Ae=Object.getPrototypeOf(Q);if(Ae){var Xe=Ae.constructor.name;if(void 0===Xe){var Ke=Ae.constructor.toString();Xe=Ke.substring(8,Ke.length-1)}return Pe.splice(0,0,Xe),"<"+Pe.join(" ")+">"}return"<DOMNode object type '"+P[Q.nodeType]+"' name '"+Q.nodeName+"'>"},A.__setattr__=function(Q,xe,Pe){if("on"!=xe.substr(0,2)){let yt=function(dt){console.log(dt);var Pt=n.last(n.frames_stack);if(n.debug>0){var wt=Pt[1].$line_info.split(",");console.log("module",wt[1],"line",wt[0]),n.$py_src.hasOwnProperty(wt[1])&&console.log(n.$py_src[wt[1]].split("\n")[parseInt(wt[0])-1])}else console.log("module",Pt[2])};switch(xe){case"left":case"top":case"width":case"height":if(o.isinstance(Pe,o.int)&&1==Q.nodeType)return Q.style[xe]=Pe+"px",o.None;throw o.ValueError.$factory(xe+" value should be an integer, not "+n.class_name(Pe))}if(void 0!==A["set_"+xe])return A["set_"+xe](Q,Pe);for(var Ge=Object.getPrototypeOf(Q),Ae=0;Ge&&Ge!==Object.prototype&&Ae++<10;){var Xe=Object.getOwnPropertyDescriptors(Ge);if(!Xe||"function"!=typeof Xe.hasOwnProperty)break;if(Xe.hasOwnProperty(xe)){Xe[xe].writable||void 0!==Xe[xe].set||yt("Warning: property '"+xe+"' is not writable. Use element.attrs['"+xe+"'] instead.");break}Ge=Object.getPrototypeOf(Ge)}return Q.style&&void 0!==Q.style[xe]&&yt("Warning: '"+xe+"' is a property of element.style"),Q[xe]=Pe,o.None}n.$bool(Pe)?A.bind(Q,xe.substr(2),Pe):A.unbind(Q,xe.substr(2))},A.__setitem__=function(Q,xe,Pe){"number"==typeof xe?Q.childNodes[xe]=Pe:"string"==typeof xe&&Q.attributes&&(Q instanceof SVGElement?Q.setAttributeNS(null,xe,Pe):"function"==typeof Q.setAttribute&&Q.setAttribute(xe,Pe))},A.abs_left={__get__:function(Q){return L(Q).left},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_left' is read-only")}},A.abs_top={__get__:function(Q){return L(Q).top},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_top' is read-only")}},A.attach=A.__le__,A.bind=function(Q,xe){var Pe=n.args("bind",4,{self:null,event:null,func:null,options:null},["self","event","func","options"],arguments,{func:o.None,options:o.None},null,null),Ge=(Q=Pe.self,xe=Pe.event,Pe.func),Ae=Pe.options;if(Ge===o.None)return function(yt){return A.bind(Q,xe,yt)};var Xe,Ke=(Xe=Ge,function(yt){try{return Xe(ae(yt))}catch(dt){if(void 0!==dt.__class__)n.handle_error(dt);else try{n.$getattr(n.stderr,"write")(dt)}catch{console.log(dt)}}});return Ke.$infos=Ge.$infos,Ke.$attrs=Ge.$attrs||{},Ke.$func=Ge,"boolean"==typeof Ae?Q.addEventListener(xe,Ke,Ae):Ae.__class__===o.dict?Q.addEventListener(xe,Ke,o.dict.$to_obj(Ae)):Ae===o.None&&Q.addEventListener(xe,Ke,!1),Q.$events=Q.$events||{},Q.$events[xe]=Q.$events[xe]||[],Q.$events[xe].push([Ge,Ke]),Q},A.children=function(Q){var xe=[];return 9==Q.nodeType&&(Q=Q.body),Q.childNodes.forEach(function(Pe){xe.push(A.$factory(Pe))}),xe},A.clear=function(Q){for(9==Q.nodeType&&(Q=Q.body);Q.firstChild;)Q.removeChild(Q.firstChild)},A.Class=function(Q){return void 0!==Q.className?Q.className:o.None},A.class_name=function(Q){return A.Class(Q)},A.clone=function(Q){var xe=A.$factory(Q.cloneNode(!0)),Pe=Q.$events||{};for(var Ge in Pe)Pe[Ge].forEach(function(Ae){A.bind(xe,Ge,Ae[0])});return xe},A.closest=function(Q,xe){var Pe=Q.closest(xe);if(null===Pe)throw o.KeyError.$factory("no parent with selector "+xe);return A.$factory(Pe)},A.events=function(Q,xe){Q.$events=Q.$events||{};var Pe=Q.$events[xe]=Q.$events[xe]||[],Ge=[];return Pe.forEach(function(Ae){Ge.push(Ae[1])}),Ge},A.focus=function(Q){return xe=Q,function(){setTimeout(function(){xe.focus()},10)};var xe},A.get=function(Q){for(var xe=[],Pe=1;Pe<arguments.length;Pe++)xe.push(arguments[Pe]);var Ge=n.args("get",0,{},[],xe,{},null,"kw"),Ae={};if(o.list.$factory(o.dict.items(Ge.kw)).forEach(function(Ke){Ae[Ke[0]]=Ke[1]}),void 0!==Ae.name){if(void 0===Q.getElementsByName)throw o.TypeError.$factory("DOMNode object doesn't support selection by name");return N(Q.getElementsByName(Ae.name))}if(void 0!==Ae.tag){if(void 0===Q.getElementsByTagName)throw o.TypeError.$factory("DOMNode object doesn't support selection by tag name");return N(Q.getElementsByTagName(Ae.tag))}if(void 0!==Ae.classname){if(void 0===Q.getElementsByClassName)throw o.TypeError.$factory("DOMNode object doesn't support selection by class name");return N(Q.getElementsByClassName(Ae.classname))}if(void 0!==Ae.id){if(void 0===Q.getElementById)throw o.TypeError.$factory("DOMNode object doesn't support selection by id");var Xe=document.getElementById(Ae.id);return Xe?[A.$factory(Xe)]:[]}if(void 0!==Ae.selector){if(void 0===Q.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return N(Q.querySelectorAll(Ae.selector))}return res},A.getContext=function(Q){if(!("getContext"in Q))throw o.AttributeError.$factory("object has no attribute 'getContext'");return function(xe){return n.JSObj.$factory(Q.getContext(xe))}},A.getSelectionRange=function(Q){if(void 0!==Q.getSelectionRange)return Q.getSelectionRange.apply(null,arguments)},A.html=function(Q){var xe=Q.innerHTML;return void 0===xe&&(xe=9==Q.nodeType?Q.body.innerHTML:o.None),xe},A.id=function(Q){return void 0!==Q.id?Q.id:o.None},A.index=function(Q,xe){var Pe;Pe=void 0===xe?Q.parentElement.childNodes:Q.parentElement.querySelectorAll(xe);for(var Ge=-1,Ae=0;Ae<Pe.length;Ae++)if(Pe[Ae]===Q){Ge=Ae;break}return Ge},A.inside=function(Q,xe){for(var Pe=Q;;){if(xe===Pe)return!0;if(!(Pe=Pe.parentElement))return!1}},A.options=function(Q){return new $OptionsClass(Q)},A.parent=function(Q){return Q.parentElement?A.$factory(Q.parentElement):o.None},A.reset=function(Q){return function(){Q.reset()}},A.scrolled_left={__get__:function(Q){return L(Q).left-document.scrollingElement.scrollLeft},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_left' is read-only")}},A.scrolled_top={__get__:function(Q){return L(Q).top-document.scrollingElement.scrollTop},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_top' is read-only")}},A.select=function(Q,xe){if(void 0===Q.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return N(Q.querySelectorAll(xe))},A.select_one=function(Q,xe){if(void 0===Q.querySelector)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");var Pe=Q.querySelector(xe);return null===Pe?o.None:A.$factory(Pe)},A.style=function(Q){return Q.style.float=Q.style.cssFloat||Q.styleFloat,n.JSObj.$factory(Q.style)},A.setSelectionRange=function(Q){return void 0!==this.setSelectionRange?(xe=this,function(){return xe.setSelectionRange.apply(xe,arguments)}):void 0!==this.createTextRange?(Pe=this,function(Ge,Ae){null==Ae&&(Ae=Ge);var Xe=Pe.createTextRange();Xe.collapse(!0),Xe.moveEnd("character",Ge),Xe.moveStart("character",Ae),Xe.select()}):void 0;var Pe,xe},A.set_class_name=function(Q,xe){Q.setAttribute("class",xe)},A.set_html=function(Q,xe){9==Q.nodeType&&(Q=Q.body),Q.innerHTML=o.str.$factory(xe)},A.set_style=function(Q,xe){if(!o.isinstance(xe,o.dict))throw o.TypeError.$factory("style must be dict, not "+n.class_name(xe));for(var Pe=o.list.$factory(o.dict.items(xe)),Ge=0;Ge<Pe.length;Ge++){var Ae=Pe[Ge][0],Xe=Pe[Ge][1];if("float"==Ae.toLowerCase())Q.style.cssFloat=Xe,Q.style.styleFloat=Xe;else{switch(Ae){case"top":case"left":case"width":case"borderWidth":o.isinstance(Xe,o.int)&&(Xe+="px")}Q.style[Ae]=Xe}}},A.set_text=function(Q,xe){9==Q.nodeType&&(Q=Q.body),Q.innerText=o.str.$factory(xe),Q.textContent=o.str.$factory(xe)},A.set_value=function(Q,xe){Q.value=o.str.$factory(xe)},A.submit=function(Q){return function(){Q.submit()}},A.text=function(Q){9==Q.nodeType&&(Q=Q.body);var xe=Q.innerText||Q.textContent;return null===xe&&(xe=o.None),xe},A.toString=function(Q){return void 0===Q?"DOMNode":Q.nodeName},A.trigger=function(Q,xe){if(Q.fireEvent)Q.fireEvent("on"+xe);else{var Pe=document.createEvent("Events");Pe.initEvent(xe,!0,!1),Q.dispatchEvent(Pe)}},A.unbind=function(Q,xe){if(Q.$events=Q.$events||{},Q.$events==={})return o.None;if(void 0===xe){for(var xe in Q.$events)A.unbind(Q,xe);return o.None}if(void 0===Q.$events[xe]||0==Q.$events[xe].length)return o.None;var Pe=Q.$events[xe];if(2==arguments.length){for(var Ge=0;Ge<Pe.length;Ge++){var Ae=Pe[Ge][1];Q.removeEventListener(xe,Ae,!1)}return Q.$events[xe]=[],o.None}for(Ge=2;Ge<arguments.length;Ge++){var Xe=!1;if(void 0===(dt=(Ae=arguments[Ge]).$func)){for(var Ke=!1,yt=0;yt<Pe.length;yt++)if(Pe[yt][0]===Ae){var dt=Ae;Ke=!0;break}if(!Ke)throw o.TypeError.$factory("function is not an event callback")}for(yt=0;yt<Pe.length;yt++)if(n.$getattr(dt,"__eq__")(Pe[yt][0])){Q.removeEventListener(xe,Ae=Pe[yt][1],!1),Pe.splice(yt,1),Xe=!0;break}if(!Xe)throw o.KeyError.$factory("missing callback for event "+xe)}},n.set_func_names(A,"browser");var X={__class__:o.type,__mro__:[o.object],$infos:{__name__:"query"},__contains__:function(Q,xe){return Q._keys.indexOf(xe)>-1},__getitem__:function(Q,xe){var Pe=Q._values[xe];if(void 0===Pe)throw o.KeyError.$factory(xe);return 1==Pe.length?Pe[0]:Pe}},oe=n.make_iterator_class("query string iterator");X.__iter__=function(Q){return oe.$factory(Q._keys)},X.__setitem__=function(Q,xe,Pe){return Q._values[xe]=[Pe],o.None},X.__str__=X.__repr__=function(Q){var xe=[];for(var Pe in Q._values)for(const Ge of Q._values[Pe])xe.push(encodeURIComponent(Pe)+"="+encodeURIComponent(Ge));return 0==xe.length?"":"?"+xe.join("&")},X.getfirst=function(Q,xe,Pe){var Ge=Q._values[xe];return void 0===Ge?void 0===Pe?o.None:Pe:Ge[0]},X.getlist=function(Q,xe){var Pe=Q._values[xe];return void 0===Pe?[]:Pe},X.getvalue=function(Q,xe,Pe){try{return X.__getitem__(Q,xe)}catch{return void 0===Pe?o.None:Pe}},X.keys=function(Q){return Q._keys},n.set_func_names(X,"<dom>");var H={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"TagSum"},appendChild:function(Q,xe){Q.children.push(xe)},__add__:function(Q,xe){return n.get_class(xe)===H?Q.children=Q.children.concat(xe.children):o.isinstance(xe,[o.str,o.int,o.float,o.dict,o.set,o.list])?Q.children=Q.children.concat(A.$factory(document.createTextNode(xe))):Q.children.push(xe),Q},__radd__:function(Q,xe){var Pe=H.$factory();return Pe.children=Q.children.concat(A.$factory(document.createTextNode(xe))),Pe},__repr__:function(Q){for(var xe="<object TagSum> ",Pe=0;Pe<Q.children.length;Pe++)xe+=Q.children[Pe],"[object Text]"==Q.children[Pe].toString()&&(xe+=" ["+Q.children[Pe].textContent+"]\n");return xe}};H.__str__=H.toString=H.__repr__,H.clone=function(Q){for(var xe=H.$factory(),Pe=0;Pe<Q.children.length;Pe++)xe.children.push(Q.children[Pe].cloneNode(!0));return xe},H.$factory=function(){return{__class__:H,children:[],toString:function(){return"(TagSum)"}}},n.set_func_names(H,"<dom>"),n.TagSum=H;var Ce=n.JSObj.$factory(x);Ce.get_postMessage=function(Q,xe){if(o.isinstance(Q,dict)){var Pe={__class__:"dict"};o.list.$factory(o.dict.items(Q)).forEach(function(Ge){Pe[Ge[0]]=Ge[1]}),Q=Pe}return x.postMessage(Q,xe)},n.DOMNode=A,n.win=Ce}(__BRYTHON__),function($B){var _b_=$B.builtins,bltns=$B.InjectBuiltins();eval(bltns);var $GeneratorReturn={};$B.generator_return=function(n){return{__class__:$GeneratorReturn,value:n}},$B.generator=$B.make_class("generator",function(n){var o=function(){var l=n.apply(null,arguments);if(l.$name=n.name,l.$func=n,l.$has_run=!1,l.__class__=$B.generator,n.$has_yield_in_cm){var x=$B.last($B.frames_stack)[1];x.$close_generators=x.$close_generators||[],x.$close_generators.push(l)}return l};return o.$infos=n.$infos,o.$is_genfunc=!0,o}),$B.generator.__iter__=function(n){return n},$B.generator.__next__=function(n){return $B.generator.send(n,_b_.None)},$B.generator.close=function(n){try{$B.generator.$$throw(n,_b_.GeneratorExit.$factory())}catch(o){if(!$B.is_exc(o,[_b_.GeneratorExit,_b_.StopIteration]))throw _b_.RuntimeError.$factory("generator ignored GeneratorExit")}},$B.generator.send=function(n,o){if(n.$has_run=!0,n.$finished)throw _b_.StopIteration.$factory(o);if(!0===n.gi_running)throw _b_.ValueError.$factory("generator already executing");n.gi_running=!0;try{var l=n.next(o)}catch(x){throw n.$finished=!0,x}if(l.value&&l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopIteration.$factory(l.value.value);if(n.gi_running=!1,l.done)throw _b_.StopIteration.$factory(l.value);return l.value},$B.generator.$$throw=function(n,o,l,x){var L=o;if(L.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l?L=$B.$call(L)():_b_.isinstance(l,o)&&(L=l)}else void 0===l?l=L:L=$B.$call(L)(l);void 0!==x&&(L.$traceback=x);var D=n.throw(L);if(D.done)throw _b_.StopIteration.$factory("StopIteration");return D.value},$B.set_func_names($B.generator,"builtins"),$B.async_generator=$B.make_class("async_generator",function(n){return function(){var o=n.apply(null,arguments);return o.__class__=$B.async_generator,o}});var ag_closed={};function rstrip(n,o){for(var l=o||" \t\n",x=0,L=n.length;x<L&&l.indexOf(n.charAt(L-1-x))>-1;)x++;return n.substr(0,L-x)}$B.async_generator.__aiter__=function(n){return n},$B.async_generator.__anext__=function(n){return $B.async_generator.asend(n,_b_.None)},$B.async_generator.aclose=function(n){return n.$finished=!0,_b_.None},$B.async_generator.asend=async function(n,o){if(n.$finished)throw _b_.StopAsyncIteration.$factory(o);if(!0===n.ag_running)throw _b_.ValueError.$factory("generator already executing");n.ag_running=!0;try{var l=await n.next(o)}catch(x){throw n.$finished=!0,x}if(l.done)throw _b_.StopAsyncIteration.$factory(o);if(l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopAsyncIteration.$factory(l.value.value);return n.ag_running=!1,l.value},$B.async_generator.athrow=async function(n,o,l,x){var L=o;if(L.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l&&(l=$B.$call(L)())}else void 0===l?l=L:L=$B.$call(L)(l);void 0!==x&&(L.$traceback=x),await n.throw(l)},$B.set_func_names($B.async_generator,"builtins")}(__BRYTHON__),function($B){var _b_=$B.builtins,update=function(n,o){for(attr in o)n[attr]=o[attr]},_window=self,modules={},browser={$package:!0,$is_package:!0,__initialized__:!0,__package__:"browser",__file__:$B.brython_path.replace(/\/*$/g,"")+"/Lib/browser/__init__.py",bind:function(){var n=$B.args("bind",3,{elt:null,evt:null,options:null},["elt","evt","options"],arguments,{options:_b_.None},null,null),o=n.options;return"boolean"==typeof o||o.__class__===_b_.dict&&(o=o.$string_dict),function(l){if($B.get_class(n.elt)===$B.JSObj)return n.elt.addEventListener(n.evt,function(M){try{return l($B.JSObj.$factory(M))}catch(P){$B.handle_error(P)}},o),l;if(_b_.isinstance(n.elt,$B.DOMNode))return $B.DOMNode.bind(n.elt,n.evt,l,o),l;if(_b_.isinstance(n.elt,_b_.str)){for(var x=document.querySelectorAll(n.elt),L=0;L<x.length;L++)$B.DOMNode.bind($B.DOMNode.$factory(x[L]),n.evt,l,o);return l}try{for(var D=$B.$iter(n.elt);;)try{var z=_b_.next(D);$B.DOMNode.bind(z,n.evt,l)}catch(M){if(_b_.isinstance(M,_b_.StopIteration))break;throw M}}catch(M){throw _b_.isinstance(M,_b_.AttributeError)&&$B.DOMNode.bind(n.elt,n.evt,l),M}return l}},console:self.console&&$B.JSObj.$factory(self.console),self:$B.win,win:$B.win,$$window:$B.win};browser.__path__=browser.__file__,$B.isNode?(delete browser.$$window,delete browser.win):$B.isWebWorker?(browser.is_webworker=!0,delete browser.$$window,delete browser.win,browser.self.send=self.postMessage):(browser.is_webworker=!1,update(browser,{$$alert:function(n){window.alert($B.builtins.str.$factory(n||""))},confirm:$B.JSObj.$factory(window.confirm),$$document:$B.DOMNode.$factory(document),doc:$B.DOMNode.$factory(document),DOMEvent:$B.DOMEvent,DOMNode:$B.DOMNode,load:function(script_url){var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},mouseCoords:function(n){return $B.JSObj.$factory($mouseCoords(n))},prompt:function(n,o){return $B.JSObj.$factory(window.prompt(n,o||""))},reload:function(){var n=document.getElementsByTagName("script"),o=[];for(var l in n.forEach(function(x){void 0!==x.type&&"text/javascript"!=x.type||(o.push(x),x.src&&console.log(x.src))}),console.log(o),$B.imported)$B.imported[l].$last_modified?console.log("check",l,$B.imported[l].__file__,$B.imported[l].$last_modified):console.log("no date for mod",l)},run_script:function(){var n=$B.args("run_script",2,{src:null,name:null},["src","name"],arguments,{name:"script_"+$B.UUID()},null,null);$B.run_script(n.src,n.name,!0)},URLParameter:function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(location.search);return o=null===o?"":decodeURIComponent(o[1].replace(/\+/g," ")),$B.builtins.str.$factory(o)}}),modules["browser.html"]=function($B){var _b_=$B.builtins,TagSum=$B.TagSum;function makeTagDict(tagName){var dict={__class__:_b_.type,$infos:{__name__:tagName,__module__:"browser.html"},__init__:function(){var $ns=$B.args("pow",1,{self:null},["self"],arguments,{},"args","kw"),self=$ns.self,args=$ns.args;if(1==args.length){var first=args[0];if(_b_.isinstance(first,[_b_.str,_b_.int,_b_.float]))self.innerHTML=_b_.str.$factory(first);else if(first.__class__===TagSum)for(var i=0,len=first.children.length;i<len;i++)self.appendChild(first.children[i]);else if(_b_.isinstance(first,$B.DOMNode))self.appendChild(first);else try{var items=_b_.list.$factory(first);items.forEach(function(n){$B.DOMNode.__le__(self,n)})}catch(n){$B.debug>1&&(console.log(n,n.__class__,n.args),console.log("first",first),console.log(arguments)),$B.handle_error(n)}}for(var items=_b_.list.$factory(_b_.dict.items($ns.kw)),i=0,len=items.length;i<len;i++){var arg=items[i][0],value=items[i][1];if("on"==arg.toLowerCase().substr(0,2)){var js='$B.DOMNode.bind(self,"'+arg.toLowerCase().substr(2);eval(js+'",function(){'+value+"})")}else if("style"==arg.toLowerCase())$B.DOMNode.set_style(self,value);else if(!1!==value)try{arg=$B.imported["browser.html"].attribute_mapper(arg),self.setAttribute(arg,value)}catch(n){throw _b_.ValueError.$factory("can't set attribute "+arg)}}}};return dict.__mro__=[$B.DOMNode,$B.builtins.object],dict.__new__=function(n){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{var l;(l=$B.DOMNode.$factory(document.createElement(tagName),!0))._wrapped=!1}return l.__class__=n,l.__dict__=$B.empty_dict(),l},$B.set_func_names(dict,"browser.html"),dict}function makeFactory(n){return function(){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{if("SVG"==n.$infos.__name__)var l=$B.DOMNode.$factory(document.createElementNS("http://www.w3.org/2000/svg","svg"),!0);else o=document.createElement(n.$infos.__name__),l=$B.DOMNode.$factory(o,!0);l._wrapped=!1}return l.__class__=n,n.__init__(l,...arguments),l}}var tags=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","B","BASE","BASEFONT","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HR","HTML","I","IFRAME","IMG","INPUT","INS","ISINDEX","KBD","LABEL","LEGEND","LI","LINK","MAP","MENU","META","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","P","PARAM","PRE","Q","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRIKE","STRONG","STYLE","SUB","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL","VAR","ARTICLE","ASIDE","AUDIO","BDI","CANVAS","COMMAND","DATA","DATALIST","EMBED","FIGCAPTION","FIGURE","FOOTER","HEADER","KEYGEN","MAIN","MARK","MATH","METER","NAV","OUTPUT","PROGRESS","RB","RP","RT","RTC","RUBY","SECTION","SOURCE","TEMPLATE","TIME","TRACK","VIDEO","WBR","DETAILS","DIALOG","MENUITEM","PICTURE","SUMMARY"],obj={tags:$B.empty_dict()},dicts={};function maketag(n){if("string"!=typeof n)throw _b_.TypeError.$factory("html.maketag expects a string as argument");var o=dicts[n]=makeTagDict(n);return o.$factory=makeFactory(o),_b_.dict.$setitem(obj.tags,n,o),o}return $B.DOMNode.tags=obj.tags,tags.forEach(function(n){obj[n]=maketag(n)}),obj.maketag=maketag,obj.attribute_mapper=function(n){return n.replace(/_/g,"-")},obj}(__BRYTHON__)),modules.browser=browser,$B.UndefinedClass=$B.make_class("Undefined",function(){return $B.Undefined}),$B.UndefinedClass.__mro__=[_b_.object],$B.UndefinedClass.__bool__=function(n){return!1},$B.UndefinedClass.__repr__=$B.UndefinedClass.__str__=function(n){return"<Javascript undefined>"},$B.Undefined={__class__:$B.UndefinedClass},$B.set_func_names($B.UndefinedClass,"javascript"),modules.javascript={$$this:function(){return void 0===$B.js_this?$B.builtins.None:$B.JSObj.$factory($B.js_this)},$$Date:self.Date&&$B.JSObj.$factory(self.Date),$$extends:function(n){return function(o){if("function"==typeof o){var l=function(){n.call(this,...arguments),o.apply(this,arguments)};return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l}if(o.$is_class){for(var x in console.log("obj",o),"Named"==n.$js_func.name&&console.log("-- Named"),l=function(){if(console.log("call parent class",o.$parent_class),o.$parent_class.call(this,...arguments),o.$$constructor){for(var D=[this],z=0,M=arguments.length;z<M;z++)D.push(arguments[z]);o.$$constructor.apply(this,D)}},l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l.$class=o,o.$parent_class=n,o.__dict__.$string_dict){var L=o.__dict__.$string_dict[x][0];l.prototype[x]="function"==typeof L?function(D){return function(){for(var z=[this],M=0,P=arguments.length;M<P;M++)z.push($B.pyobj2jsobj(arguments[M]));return D.apply(this,z)}}(L):$B.pyobj2jsobj(L)}return l}}},JSON:{__class__:$B.make_class("JSON"),parse:function(){return $B.structuredclone2pyobj(JSON.parse.apply(this,arguments))},stringify:function(n,o,l){return JSON.stringify($B.pyobj2structuredclone(n,!1),$B.JSObj.$factory(o),l)}},jsobj2pyobj:function(n){return $B.jsobj2pyobj(n)},load:function(script_url){console.log('"javascript.load" is deprecrated. Use browser.load instead.');var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},$$Math:self.Math&&$B.JSObj.$factory(self.Math),NULL:null,$$Number:self.Number&&$B.JSObj.$factory(self.Number),py2js:function(n,o){return void 0===o&&(o="__main__"+$B.UUID()),$B.py2js(n,o,o,$B.builtins_scope).to_js()},pyobj2jsobj:function(n){return $B.pyobj2jsobj(n)},$$RegExp:self.RegExp&&$B.JSObj.$factory(self.RegExp),$$String:self.String&&$B.JSObj.$factory(self.String),UNDEFINED:$B.Undefined,UndefinedType:$B.UndefinedClass};var arraybuffers=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];arraybuffers.forEach(function(n){void 0!==self[n]&&(modules.javascript[n]=$B.JSObj.$factory(self[n]))});var _b_=$B.builtins;function load(n,o){for(var l in o.__class__=$B.module,o.__name__=n,$B.imported[n]=o,o)if("function"==typeof o[l]){var x=$B.from_alias(l);o[l].$infos={__module__:n,__name__:x,__qualname__:n+"."+x}}}for(var attr in modules._sys={Getframe:function(){var n=$B.args("_getframe",1,{depth:null},["depth"],arguments,{depth:0},null,null).depth;return $B._frame.$factory($B.frames_stack,$B.frames_stack.length-n-1)},breakpointhook:function(){var n,o,l,x,L=$B.$options.breakpoint;void 0===L&&(L="pdb.set_trace"),[n,o,l]=_b_.str.rpartition(L,"."),""==o&&(n="builtins");try{$B.$import(n),x=$B.$getattr($B.imported[n],l)}catch{return console.warn("cannot import breakpoint",L),_b_.None}return $B.$call(x).apply(null,arguments)},exc_info:function(){for(var n=$B.frames_stack.length-1;n>=0;n--){var o=$B.frames_stack[n][1].$current_exception;if(o)return _b_.tuple.$factory([o.__class__,o,$B.$getattr(o,"__traceback__")])}return _b_.tuple.$factory([_b_.None,_b_.None,_b_.None])},excepthook:function(n,o,l){$B.handle_error(o)},gettrace:function(){return $B.tracefunc||_b_.None},modules:_b_.property.$factory(function(){return $B.obj_dict($B.imported)},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.modules'")}),path:_b_.property.$factory(function(){return $B.path},function(n,o,l){$B.path=l}),meta_path:_b_.property.$factory(function(){return $B.meta_path},function(n,o,l){$B.meta_path=l}),path_hooks:_b_.property.$factory(function(){return $B.path_hooks},function(n,o,l){$B.path_hooks=l}),path_importer_cache:_b_.property.$factory(function(){return _b_.dict.$factory($B.JSObj.$factory($B.path_importer_cache))},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.path_importer_cache'")}),settrace:function(){var n=$B.args("settrace",1,{tracefunc:null},["tracefunc"],arguments,{},null,null);return $B.tracefunc=n.tracefunc,$B.last($B.frames_stack)[1].$f_trace=$B.tracefunc,$B.tracefunc.$current_frame_id=$B.last($B.frames_stack)[0],_b_.None},stderr:_b_.property.$factory(function(){return $B.stderr},function(n,o){$B.stderr=o}),stdout:_b_.property.$factory(function(){return $B.stdout},function(n,o){$B.stdout=o}),stdin:_b_.property.$factory(function(){return $B.stdin},function(n,o){$B.stdin=o}),vfs:_b_.property.$factory(function(){return $B.hasOwnProperty("VFS")?$B.obj_dict($B.VFS):_b_.None},function(){throw _b_.TypeError.$factory("Read only property 'sys.vfs'")})},modules._sys.__breakpointhook__=modules._sys.breakpointhook,modules._sys.stderr.write=function(n){return $B.$getattr(_sys.stderr.__get__(),"write")(n)},modules._sys.stdout.write=function(n){return $B.$getattr(_sys.stdout.__get__(),"write")(n)},modules)load(attr,modules[attr]);$B.isWebWorker||$B.isNode||(modules.browser.html=modules["browser.html"]);var _b_=$B.builtins;for(var attr in _b_.__builtins__=$B.module.$factory("__builtins__","Python builtins"),_b_)_b_.__builtins__[attr]=_b_[attr],$B.builtins_scope.binding[attr]=!0;for(var name in _b_.__builtins__.__setattr__=function(n,o){_b_[n]=o},$B.method_descriptor.__getattribute__=$B.Function.__getattribute__,$B.wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,_b_)if(_b_[name].__class__===_b_.type)for(var key in $B.builtin_classes.push(_b_[name]),_b_[name]){var value=_b_[name][key];void 0!==value&&(value.__class__||"function"==typeof value&&(value.__class__="__new__"==key?$B.builtin_function:key.startsWith("__")?$B.wrapper_descriptor:$B.method_descriptor,value.__objclass__=_b_[name]))}for(var attr in $B)Array.isArray($B[attr])&&($B[attr].__class__=_b_.list);$B.cell=$B.make_class("cell",function(n){return{__class__:$B.cell,$cell_contents:n}}),$B.cell.cell_contents=$B.$call(_b_.property)(function(n){if(null===n.$cell_contents)throw _b_.ValueError.$factory("empty cell");return n.$cell_contents},function(n,o){n.$cell_contents=o});var $comps=Object.values($B.$comps).concat(["eq","ne"]);$comps.forEach(function(n){var l,o="__"+n+"__";$B.cell[o]=(l=o,function(x,L){return _b_.isinstance(L,$B.cell)?null===x.$cell_contents?null===L.$cell_contents?"__eq__"==l:["__ne__","__lt__","__le__"].indexOf(l)>-1:null===L.$cell_contents?["__ne__","__gt__","__ge__"].indexOf(l)>-1:$B.rich_comp(l,x.$cell_contents,L.$cell_contents):NotImplemented})}),$B.set_func_names($B.cell,"builtins")}(__BRYTHON__);var docs={ArithmeticError:"Base class for arithmetic errors.",AssertionError:"Assertion failed.",AttributeError:"Attribute not found.",BaseException:"Common base class for all exceptions",BlockingIOError:"I/O operation would block.",BrokenPipeError:"Broken pipe.",BufferError:"Buffer error.",BytesWarning:"Base class for warnings about bytes and buffer related problems, mostly\nrelated to conversion from str or comparing to str.",ChildProcessError:"Child process error.",ConnectionAbortedError:"Connection aborted.",ConnectionError:"Connection error.",ConnectionRefusedError:"Connection refused.",ConnectionResetError:"Connection reset.",DeprecationWarning:"Base class for warnings about deprecated features.",EOFError:"Read beyond end of file.",Ellipsis:"",EnvironmentError:"Base class for I/O related errors.",Exception:"Common base class for all non-exit exceptions.",False:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",FileExistsError:"File already exists.",FileNotFoundError:"File not found.",FloatingPointError:"Floating point operation failed.",FutureWarning:"Base class for warnings about constructs that will change semantically\nin the future.",GeneratorExit:"Request that a generator exit.",IOError:"Base class for I/O related errors.",ImportError:"Import can't find module, or can't find name in module.",ImportWarning:"Base class for warnings about probable mistakes in module imports",IndentationError:"Improper indentation.",IndexError:"Sequence index out of range.",InterruptedError:"Interrupted by signal.",IsADirectoryError:"Operation doesn't work on directories.",KeyError:"Mapping key not found.",KeyboardInterrupt:"Program interrupted by user.",LookupError:"Base class for lookup errors.",MemoryError:"Out of memory.",NameError:"Name not found globally.",None:"",NotADirectoryError:"Operation only works on directories.",NotImplemented:"",NotImplementedError:"Method or function hasn't been implemented yet.",OSError:"Base class for I/O related errors.",OverflowError:"Result too large to be represented.",PendingDeprecationWarning:"Base class for warnings about features which will be deprecated\nin the future.",PermissionError:"Not enough permissions.",ProcessLookupError:"Process not found.",ReferenceError:"Weak ref proxy used after referent went away.",ResourceWarning:"Base class for warnings about resource usage.",RuntimeError:"Unspecified run-time error.",RuntimeWarning:"Base class for warnings about dubious runtime behavior.",StopIteration:"Signal the end from iterator.__next__().",SyntaxError:"Invalid syntax.",SyntaxWarning:"Base class for warnings about dubious syntax.",SystemError:"Internal error in the Python interpreter.\n\nPlease report this to the Python maintainer, along with the traceback,\nthe Python version, and the hardware/OS platform and version.",SystemExit:"Request to exit from the interpreter.",TabError:"Improper mixture of spaces and tabs.",TimeoutError:"Timeout expired.",True:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",TypeError:"Inappropriate argument type.",UnboundLocalError:"Local name referenced but not bound to a value.",UnicodeDecodeError:"Unicode decoding error.",UnicodeEncodeError:"Unicode encoding error.",UnicodeError:"Unicode related error.",UnicodeTranslateError:"Unicode translation error.",UnicodeWarning:"Base class for warnings about Unicode related problems, mostly\nrelated to conversion problems.",UserWarning:"Base class for warnings generated by user code.",ValueError:"Inappropriate argument value (of correct type).",Warning:"Base class for warning categories.",WindowsError:"Base class for I/O related errors.",ZeroDivisionError:"Second argument to a division or modulo operation was zero.",__debug__:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",abs:"abs(number) -> number\n\nReturn the absolute value of the argument.",all:"all(iterable) -> bool\n\nReturn True if bool(x) is True for all values x in the iterable.\nIf the iterable is empty, return True.",any:"any(iterable) -> bool\n\nReturn True if bool(x) is True for any x in the iterable.\nIf the iterable is empty, return False.",ascii:"ascii(object) -> string\n\nAs repr(), return a string containing a printable representation of an\nobject, but escape the non-ASCII characters in the string returned by\nrepr() using \\x, \\u or \\U escapes.  This generates a string similar\nto that returned by repr() in Python 2.",bin:"bin(number) -> string\n\nReturn the binary representation of an integer.\n\n   >>> bin(2796202)\n   '0b1010101010101010101010'\n",bool:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",bytearray:"bytearray(iterable_of_ints) -> bytearray\nbytearray(string, encoding[, errors]) -> bytearray\nbytearray(bytes_or_buffer) -> mutable copy of bytes_or_buffer\nbytearray(int) -> bytes array of size given by the parameter initialized with null bytes\nbytearray() -> empty bytes array\n\nConstruct an mutable bytearray object from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - a bytes or a buffer object\n  - any object implementing the buffer API.\n  - an integer",bytes:"bytes(iterable_of_ints) -> bytes\nbytes(string, encoding[, errors]) -> bytes\nbytes(bytes_or_buffer) -> immutable copy of bytes_or_buffer\nbytes(int) -> bytes object of size given by the parameter initialized with null bytes\nbytes() -> empty bytes object\n\nConstruct an immutable array of bytes from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - any object implementing the buffer API.\n  - an integer",callable:"callable(object) -> bool\n\nReturn whether the object is callable (i.e., some kind of function).\nNote that classes are callable, as are instances of classes with a\n__call__() method.",chr:"chr(i) -> Unicode character\n\nReturn a Unicode string of one character with ordinal i; 0 <= i <= 0x10ffff.",classmethod:"classmethod(function) -> method\n\nConvert a function to be a class method.\n\nA class method receives the class as implicit first argument,\njust like an instance method receives the instance.\nTo declare a class method, use this idiom:\n\n  class C:\n      def f(cls, arg1, arg2, ...): ...\n      f = classmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\nIf a class method is called for a derived class, the derived class\nobject is passed as the implied first argument.\n\nClass methods are different than C++ or Java static methods.\nIf you want those, see the staticmethod builtin.",compile:"compile(source, filename, mode[, flags[, dont_inherit]]) -> code object\n\nCompile the source (a Python module, statement or expression)\ninto a code object that can be executed by exec() or eval().\nThe filename will be used for run-time error messages.\nThe mode must be 'exec' to compile a module, 'single' to compile a\nsingle (interactive) statement, or 'eval' to compile an expression.\nThe flags argument, if present, controls which future statements influence\nthe compilation of the code.\nThe dont_inherit argument, if non-zero, stops the compilation inheriting\nthe effects of any future statements in effect in the code calling\ncompile; if absent or zero these statements do influence the compilation,\nin addition to any features explicitly specified.",complex:"complex(real[, imag]) -> complex number\n\nCreate a complex number from a real part and an optional imaginary part.\nThis is equivalent to (real + imag*1j) where imag defaults to 0.",copyright:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",credits:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",delattr:"delattr(object, name)\n\nDelete a named attribute on an object; delattr(x, 'y') is equivalent to\n``del x.y''.",dict:"dict() -> new empty dictionary\ndict(mapping) -> new dictionary initialized from a mapping object's\n    (key, value) pairs\ndict(iterable) -> new dictionary initialized as if via:\n    d = {}\n    for k, v in iterable:\n        d[k] = v\ndict(**kwargs) -> new dictionary initialized with the name=value pairs\n    in the keyword argument list.  For example:  dict(one=1, two=2)",dir:"dir([object]) -> list of strings\n\nIf called without an argument, return the names in the current scope.\nElse, return an alphabetized list of names comprising (some of) the attributes\nof the given object, and of attributes reachable from it.\nIf the object supplies a method named __dir__, it will be used; otherwise\nthe default dir() logic is used and returns:\n  for a module object: the module's attributes.\n  for a class object:  its attributes, and recursively the attributes\n    of its bases.\n  for any other object: its attributes, its class's attributes, and\n    recursively the attributes of its class's base classes.",divmod:"divmod(x, y) -> (div, mod)\n\nReturn the tuple ((x-x%y)/y, x%y).  Invariant: div*y + mod == x.",enumerate:"enumerate(iterable[, start]) -> iterator for index, value of iterable\n\nReturn an enumerate object.  iterable must be another object that supports\niteration.  The enumerate object yields pairs containing a count (from\nstart, which defaults to zero) and a value yielded by the iterable argument.\nenumerate is useful for obtaining an indexed list:\n    (0, seq[0]), (1, seq[1]), (2, seq[2]), ...",eval:"eval(source[, globals[, locals]]) -> value\n\nEvaluate the source in the C of globals and locals.\nThe source may be a string representing a Python expression\nor a code object as returned by compile().\nThe globals must be a dictionary and locals can be any mapping,\ndefaulting to the current globals and locals.\nIf only globals is given, locals defaults to it.\n",exec:"exec(object[, globals[, locals]])\n\nRead and execute code from an object, which can be a string or a code\nobject.\nThe globals and locals are dictionaries, defaulting to the current\nglobals and locals.  If only globals is given, locals defaults to it.",exit:"",filter:"filter(function or None, iterable) --\x3e filter object\n\nReturn an iterator yielding those items of iterable for which function(item)\nis true. If function is None, return the items that are true.",float:"float(x) -> floating point number\n\nConvert a string or number to a floating point number, if possible.",format:'format(value[, format_spec]) -> string\n\nReturns value.__format__(format_spec)\nformat_spec defaults to ""',frozenset:"frozenset()-> empty frozenset object\nfrozenset(iterable)-> frozenset object\n\nBuild an immutable unordered collection of unique elements.",getattr:"getattr(object,name[,default])-> value\n\nGet a named attribute from an object;getattr(x,'y')is equivalent to x.y.\nWhen a default argument is given,it is returned when the attribute doesn't\nexist; without it, an exception is raised in that case.",globals:"globals() -> dictionary\n\nReturn the dictionary containing the current scope's global variables.",hasattr:"hasattr(object,name)-> bool\n\nReturn whether the object has an attribute with the given name.\n(This is done by calling getattr(object,name)and catching AttributeError.)",hash:"hash(object)-> integer\n\nReturn a hash value for the object. Two objects with the same value have\nthe same hash value. The reverse is not necessarily true,but likely.",help:"Define the builtin 'help'.\n\n This is a wrapper around pydoc.help that provides a helpful message\n when 'help' is typed at the Python interactive prompt.\n\n Calling help()at the Python prompt starts an interactive help session.\n Calling help(thing)prints help for the python object 'thing'.\n ",hex:"hex(number)-> string\n\nReturn the hexadecimal representation of an integer.\n\n >>> hex(3735928559)\n '0xdeadbeef'\n",id:"id(object)-> integer\n\nReturn the identity of an object. This is guaranteed to be unique among\nsimultaneously existing objects.(Hint:it's the object's memory address.)",input:"input([prompt])-> string\n\nRead a string from standard input. The trailing newline is stripped.\nIf the user hits EOF(Unix:Ctl-D,Windows:Ctl-Z+Return),raise EOFError.\nOn Unix,GNU readline is used if enabled. The prompt string,if given,\nis printed without a trailing newline before reading.",int:"int(x=0)-> integer\nint(x,base=10)-> integer\n\nConvert a number or string to an integer,or return 0 if no arguments\nare given. If x is a number,return x.__int__(). For floating point\nnumbers,this truncates towards zero.\n\nIf x is not a number or if base is given,then x must be a string,\nbytes,or bytearray instance representing an integer literal in the\ngiven base. The literal can be preceded by '+' or '-' and be surrounded\nby whitespace. The base defaults to 10. Valid bases are 0 and 2-36.\nBase 0 means to interpret the base from the string as an integer literal.\n>>> int('0b100',base=0)\n4",isinstance:"isinstance(object,class-or-type-or-tuple)-> bool\n\nReturn whether an object is an instance of a class or of a subclass thereof.\nWith a type as second argument,return whether that is the object's type.\nThe form using a tuple, isinstance(x, (A, B, ...)), is a shortcut for\nisinstance(x, A) or isinstance(x, B) or ... (etc.).",issubclass:"issubclass(C, B) -> bool\n\nReturn whether class C is a subclass (i.e., a derived class) of class B.\nWhen using a tuple as the second argument issubclass(X, (A, B, ...)),\nis a shortcut for issubclass(X, A) or issubclass(X, B) or ... (etc.).",iter:"iter(iterable) -> iterator\niter(callable, sentinel) -> iterator\n\nGet an iterator from an object.  In the first form, the argument must\nsupply its own iterator, or be a sequence.\nIn the second form, the callable is called until it returns the sentinel.",len:"len(object)\n\nReturn the number of items of a sequence or collection.",license:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",list:"list() -> new empty list\nlist(iterable) -> new list initialized from iterable's items",locals:"locals()-> dictionary\n\nUpdate and return a dictionary containing the current scope's local variables.",map:"map(func, *iterables) --\x3e map object\n\nMake an iterator that computes the function using arguments from\neach of the iterables.  Stops when the shortest iterable is exhausted.",max:"max(iterable, *[, default=obj, key=func]) -> value\nmax(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its biggest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the largest argument.",memoryview:"memoryview(object)\n\nCreate a new memoryview object which references the given object.",min:"min(iterable, *[, default=obj, key=func]) -> value\nmin(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its smallest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the smallest argument.",next:"next(iterator[, default])\n\nReturn the next item from the iterator. If default is given and the iterator\nis exhausted, it is returned instead of raising StopIteration.",object:"The most base type",oct:"oct(number) -> string\n\nReturn the octal representation of an integer.\n\n   >>> oct(342391)\n   '0o1234567'\n",open:"open(file, mode='r', buffering=-1, encoding=None,\n     errors=None, newline=None, closefd=True, opener=None) -> file object\n\nOpen file and return a stream.  Raise IOError upon failure.\n\nfile is either a text or byte string giving the name (and the path\nif the file isn't in the current working directory)of the file to\nbe opened or an integer file descriptor of the file to be\nwrapped.(If a file descriptor is given,it is closed when the\nreturned I/O object is closed,unless closefd is set to False.)\n\nmode is an optional string that specifies the mode in which the file\nis opened. It defaults to 'r' which means open for reading in text\nmode. Other common values are 'w' for writing(truncating the file if\nit already exists),'x' for creating and writing to a new file,and\n'a' for appending(which on some Unix systems,means that all writes\nappend to the end of the file regardless of the current seek position).\nIn text mode,if encoding is not specified the encoding used is platform\ndependent:locale.getpreferredencoding(False)is called to get the\ncurrent locale encoding.(For reading and writing raw bytes use binary\nmode and leave encoding unspecified.)The available modes are:\n\n========================================================================\nCharacter Meaning\n------------------------------------------------------------------------\n'r' open for reading(default)\n'w' open for writing,truncating the file first\n'x' create a new file and open it for writing\n'a' open for writing,appending to the end of the file if it exists\n'b' binary mode\n't' text mode(default)\n'+' open a disk file for updating(reading and writing)\n'U' universal newline mode(deprecated)\n========================================================================\n\nThe default mode is 'rt'(open for reading text). For binary random\naccess,the mode 'w+b' opens and truncates the file to 0 bytes,while\n'r+b' opens the file without truncation. The 'x' mode implies 'w' and\nraises an `FileExistsError` if the file already exists.\n\nPython distinguishes between files opened in binary and text modes,\neven when the underlying operating system doesn't. Files opened in\nbinary mode (appending 'b' to the mode argument) return contents as\nbytes objects without any decoding. In text mode (the default, or when\n't' is appended to the mode argument), the contents of the file are\nreturned as strings, the bytes having been first decoded using a\nplatform-dependent encoding or using the specified encoding if given.\n\n'U' mode is deprecated and will raise an exception in future versions\nof Python.  It has no effect in Python 3.  Use newline to control\nuniversal newlines mode.\n\nbuffering is an optional integer used to set the buffering policy.\nPass 0 to switch buffering off (only allowed in binary mode), 1 to select\nline buffering (only usable in text mode), and an integer > 1 to indicate\nthe size of a fixed-size chunk buffer.  When no buffering argument is\ngiven, the default buffering policy works as follows:\n\n* Binary files are buffered in fixed-size chunks; the size of the buffer\n  is chosen using a heuristic trying to determine the underlying device's\n \"block size\" and falling back on `io.DEFAULT_BUFFER_SIZE`.\n  On many systems, the buffer will typically be 4096 or 8192 bytes long.\n\n* \"Interactive\" text files (files for which isatty() returns True)\n  use line buffering.  Other text files use the policy described above\n  for binary files.\n\nencoding is the name of the encoding used to decode or encode the\nfile. This should only be used in text mode. The default encoding is\nplatform dependent, but any encoding supported by Python can be\npassed.  See the codecs module for the list of supported encodings.\n\nerrors is an optional string that specifies how encoding errors are to\nbe handled---this argument should not be used in binary mode. Pass\n'strict' to raise a ValueError exception if there is an encoding error\n(the default of None has the same effect), or pass 'ignore' to ignore\nerrors. (Note that ignoring encoding errors can lead to data loss.)\nSee the documentation for codecs.register or run 'help(codecs.Codec)'\nfor a list of the permitted encoding error strings.\n\nnewline controls how universal newlines works (it only applies to text\nmode). It can be None, '', '\\n', '\\r', and '\\r\\n'.  It works as\nfollows:\n\n* On input, if newline is None, universal newlines mode is\n  enabled. Lines in the input can end in '\\n', '\\r', or '\\r\\n', and\n  these are translated into '\\n' before being returned to the\n  caller. If it is '', universal newline mode is enabled, but line\n  endings are returned to the caller untranslated. If it has any of\n  the other legal values, input lines are only terminated by the given\n  string, and the line ending is returned to the caller untranslated.\n\n* On output, if newline is None, any '\\n' characters written are\n  translated to the system default line separator, os.linesep. If\n  newline is '' or '\\n', no translation takes place. If newline is any\n  of the other legal values, any '\\n' characters written are translated\n  to the given string.\n\nIf closefd is False, the underlying file descriptor will be kept open\nwhen the file is closed. This does not work when a file name is given\nand must be True in that case.\n\nA custom opener can be used by passing a callable as *opener*. The\nunderlying file descriptor for the file object is then obtained by\ncalling *opener* with (*file*, *flags*). *opener* must return an open\nfile descriptor (passing os.open as *opener* results in functionality\nsimilar to passing None).\n\nopen() returns a file object whose type depends on the mode, and\nthrough which the standard file operations such as reading and writing\nare performed. When open() is used to open a file in a text mode ('w',\n'r', 'wt', 'rt', etc.), it returns a TextIOWrapper. When used to open\na file in a binary mode, the returned class varies: in read binary\nmode, it returns a BufferedReader; in write binary and append binary\nmodes, it returns a BufferedWriter, and in read/write mode, it returns\na BufferedRandom.\n\nIt is also possible to use a string or bytearray as a file for both\nreading and writing. For strings StringIO can be used like a file\nopened in a text mode, and for bytes a BytesIO can be used like a file\nopened in a binary mode.\n",ord:"ord(c) -> integer\n\nReturn the integer ordinal of a one-character string.",pow:"pow(x, y[, z]) -> number\n\nWith two arguments, equivalent to x**y.  With three arguments,\nequivalent to (x**y) % z, but may be more efficient (e.g. for ints).",print:"print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n\nPrints the values to a stream, or to sys.stdout by default.\nOptional keyword arguments:\nfile:  a file-like object (stream); defaults to the current sys.stdout.\nsep:   string inserted between values, default a space.\nend:   string appended after the last value, default a newline.\nflush: whether to forcibly flush the stream.",property:"property(fget=None, fset=None, fdel=None, doc=None) -> property attribute\n\nfget is a function to be used for getting an attribute value, and likewise\nfset is a function for setting, and fdel a function for del'ing, an\nattribute.  Typical use is to define a managed attribute x:\n\nclass C(object):\n    def getx(self): return self._x\n    def setx(self, value): self._x = value\n    def delx(self): del self._x\n    x = property(getx, setx, delx, \"I'm the 'x' property.\")\n\nDecorators make defining new properties or modifying existing ones easy:\n\nclass C(object):\n    @property\n    def x(self):\n        \"I am the 'x' property.\"\n        return self._x\n    @x.setter\n    def x(self, value):\n        self._x = value\n    @x.deleter\n    def x(self):\n        del self._x\n",quit:"",range:"range(stop) -> range object\nrange(start, stop[, step]) -> range object\n\nReturn a virtual sequence of numbers from start to stop by step.",repr:"repr(object) -> string\n\nReturn the canonical string representation of the object.\nFor most object types, eval(repr(object)) == object.",reversed:"reversed(sequence) -> reverse iterator over values of the sequence\n\nReturn a reverse iterator",round:"round(number[, ndigits]) -> number\n\nRound a number to a given precision in decimal digits (default 0 digits).\nThis returns an int when called with one argument, otherwise the\nsame type as the number. ndigits may be negative.",set:"set() -> new empty set object\nset(iterable) -> new set object\n\nBuild an unordered collection of unique elements.",setattr:"setattr(object, name, value)\n\nSet a named attribute on an object; setattr(x, 'y', v) is equivalent to\n``x.y = v''.",slice:"slice(stop)\nslice(start, stop[, step])\n\nCreate a slice object.  This is used for extended slicing (e.g. a[0:10:2]).",sorted:"sorted(iterable, key=None, reverse=False) --\x3e new sorted list",staticmethod:"staticmethod(function) -> method\n\nConvert a function to be a static method.\n\nA static method does not receive an implicit first argument.\nTo declare a static method, use this idiom:\n\n     class C:\n     def f(arg1, arg2, ...): ...\n     f = staticmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\n\nStatic methods in Python are similar to those found in Java or C++.\nFor a more advanced concept, see the classmethod builtin.",str:"str(object='') -> str\nstr(bytes_or_buffer[, encoding[, errors]]) -> str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.",sum:"sum(iterable[, start]) -> value\n\nReturn the sum of an iterable of numbers (NOT strings) plus the value\nof parameter 'start' (which defaults to 0).  When the iterable is\nempty, return start.",super:"super() -> same as super(__class__, <first argument>)\nsuper(type) -> unbound super object\nsuper(type, obj) -> bound super object; requires isinstance(obj, type)\nsuper(type, type2) -> bound super object; requires issubclass(type2, type)\nTypical use to call a cooperative superclass method:\nclass C(B):\n    def meth(self, arg):\n        super().meth(arg)\nThis works for class methods too:\nclass C(B):\n    @classmethod\n    def cmeth(cls, arg):\n        super().cmeth(arg)\n",tuple:"tuple() -> empty tuple\ntuple(iterable) -> tuple initialized from iterable's items\n\nIf the argument is a tuple, the return value is the same object.",type:"type(object_or_name, bases, dict)\ntype(object) -> the object's type\ntype(name, bases, dict) -> a new type",vars:"vars([object]) -> dictionary\n\nWithout arguments, equivalent to locals().\nWith an argument, equivalent to object.__dict__.",zip:"zip(iter1 [,iter2 [...]]) --\x3e zip object\n\nReturn a zip object whose .__next__() method returns a tuple where\nthe i-th element comes from the i-th iterable argument.  The .__next__()\nmethod continues until the shortest iterable in the argument sequence\nis exhausted and then it raises StopIteration."},n,o;return __BRYTHON__.builtins_doc=docs,n=__BRYTHON__,o=n.builtins,n.import_hooks=function(l,x,L){var D,z,M=n.meta_path.slice(),P=n.imported;if(L){var de=M.indexOf(n.finders.path);de>-1&&M.splice(de,1)}for(var ye=0,he=M.length;ye<he;ye++){var ae=M[ye],fe=n.$getattr(ae,"find_spec",o.None);if(fe==o.None){var le=n.$getattr(ae,"find_module",o.None);if(le!==o.None&&(D=le(l,x))!==o.None){var q=n.$getattr(D,"load_module"),Y=n.$call(q)(l);return P[l]=Y,Y}}else if(z=fe(l,x),!n.is_none(z)){if(void 0!==(Y=n.imported[z.name]))return P[z.name]=Y;D=o.getattr(z,"loader",o.None);break}}if(void 0===D){message=l,"file"==n.protocol&&(message+=" (warning: cannot import local files with protocol 'file')");var A=o.ModuleNotFoundError.$factory(message);throw A.name=l,A}if(n.is_none(Y)){if(z===o.None)throw o.ModuleNotFoundError.$factory(l);var N=o.getattr(z,"name");if(!n.is_none(D)){var X=o.getattr(D,"create_module",o.None);n.is_none(X)||(Y=n.$call(X)(z))}if(void 0===Y)throw o.ImportError.$factory(l);if(n.is_none(Y)){Y=n.module.$factory(l);var oe=o.getattr(z,"origin");oe=o.getattr(z,"has_location")?"from '"+oe+"'":"("+oe+")"}}Y.__name__=N,Y.__loader__=D,Y.__package__=o.getattr(z,"parent",""),Y.__spec__=z;var H=o.getattr(z,"submodule_search_locations");(Y.$is_package=!n.is_none(H))&&(Y.__path__=H),o.getattr(z,"has_location")&&(Y.__file__=o.getattr(z,"origin"),n.$py_module_path[Y.__name__]=Y.__file__);var Ce=o.getattr(z,"cached");if(n.is_none(Ce)||(Y.__cached__=Ce),n.is_none(D)){if(n.is_none(H))throw o.ImportError.$factory(l);P[N]=Y}else{var Q=o.getattr(D,"exec_module",o.None);if(n.is_none(Q))Y=o.getattr(D,"load_module")(N);else{P[N]=Y;try{Q(Y)}catch(xe){throw delete P[N],xe}}}return P[N]},function(n){var o=n.coroutine=n.make_class("coroutine");o.close=function(l){},o.send=function(l){return l.$func.apply(null,l.$args)},o.__repr__=o.__str__=function(l){return l.$func.$infos?"<coroutine "+l.$func.$infos.__name__+">":"<coroutine object>"},n.set_func_names(o,"builtins"),n.make_async=l=>{if(l.$is_genfunc)return l;var x=function(){var L=arguments,D=n.deep_copy(n.frames_stack);return{__class__:o,$args:L,$func:l,$stack:D}};return x.$infos=l.$infos,x},n.promise=function(l){return l.__class__===o?o.send(l):"function"==typeof l?l():l}}(__BRYTHON__),window.__BRYTHON__=__BRYTHON__,__BRYTHON__},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},561:n=>{var o=Object.prototype.toString;n.exports=function(l){return l.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===o.call(l.buffer)||Array.isArray(l)}},355:n=>{n.exports=function(o,l){return"number"==typeof o?o:"number"==typeof l?l:0}},546:function(n,o,l){var x,L,D;L=[l(734)],x=function(z){"use strict";var M=function(A,N,X){if(void 0===A&&(A=M.DEFAULT_CAPACITY),void 0===N&&(N=M.DEFAULT_ENDIAN),void 0===X&&(X=M.DEFAULT_NOASSERT),!X){if((A|=0)<0)throw RangeError("Illegal capacity");N=!!N,X=!!X}this.buffer=0===A?de:new ArrayBuffer(A),this.view=0===A?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=A,this.littleEndian=N,this.noAssert=X};M.VERSION="5.0.1",M.LITTLE_ENDIAN=!0,M.BIG_ENDIAN=!1,M.DEFAULT_CAPACITY=16,M.DEFAULT_ENDIAN=M.BIG_ENDIAN,M.DEFAULT_NOASSERT=!1,M.Long=z||null;var P=M.prototype;Object.defineProperty(P,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var de=new ArrayBuffer(0),ye=String.fromCharCode;function he(A){var N=0;return function(){return N<A.length?A.charCodeAt(N++):null}}function ae(){var A=[],N=[];return function(){if(0===arguments.length)return N.join("")+ye.apply(String,A);A.length+arguments.length>1024&&(N.push(ye.apply(String,A)),A.length=0),Array.prototype.push.apply(A,arguments)}}function fe(A,N,X,oe,H){var Ce,Q,xe=8*H-oe-1,Pe=(1<<xe)-1,Ge=Pe>>1,Ae=-7,Xe=X?H-1:0,Ke=X?-1:1,yt=A[N+Xe];for(Xe+=Ke,Ce=yt&(1<<-Ae)-1,yt>>=-Ae,Ae+=xe;Ae>0;Ce=256*Ce+A[N+Xe],Xe+=Ke,Ae-=8);for(Q=Ce&(1<<-Ae)-1,Ce>>=-Ae,Ae+=oe;Ae>0;Q=256*Q+A[N+Xe],Xe+=Ke,Ae-=8);if(0===Ce)Ce=1-Ge;else{if(Ce===Pe)return Q?NaN:1/0*(yt?-1:1);Q+=Math.pow(2,oe),Ce-=Ge}return(yt?-1:1)*Q*Math.pow(2,Ce-oe)}function le(A,N,X,oe,H,Ce){var Q,xe,Pe,Ge=8*Ce-H-1,Ae=(1<<Ge)-1,Xe=Ae>>1,Ke=23===H?Math.pow(2,-24)-Math.pow(2,-77):0,yt=oe?0:Ce-1,dt=oe?1:-1,Pt=N<0||0===N&&1/N<0?1:0;for(N=Math.abs(N),isNaN(N)||N===1/0?(xe=isNaN(N)?1:0,Q=Ae):(Q=Math.floor(Math.log(N)/Math.LN2),N*(Pe=Math.pow(2,-Q))<1&&(Q--,Pe*=2),(N+=Q+Xe>=1?Ke/Pe:Ke*Math.pow(2,1-Xe))*Pe>=2&&(Q++,Pe/=2),Q+Xe>=Ae?(xe=0,Q=Ae):Q+Xe>=1?(xe=(N*Pe-1)*Math.pow(2,H),Q+=Xe):(xe=N*Math.pow(2,Xe-1)*Math.pow(2,H),Q=0));H>=8;A[X+yt]=255&xe,yt+=dt,xe/=256,H-=8);for(Q=Q<<H|xe,Ge+=H;Ge>0;A[X+yt]=255&Q,yt+=dt,Q/=256,Ge-=8);A[X+yt-dt]|=128*Pt}M.accessor=function(){return Uint8Array},M.allocate=function(A,N,X){return new M(A,N,X)},M.concat=function(A,N,X,oe){"boolean"!=typeof N&&"string"==typeof N||(oe=X,X=N,N=void 0);for(var H,Ce=0,Q=0,xe=A.length;Q<xe;++Q)M.isByteBuffer(A[Q])||(A[Q]=M.wrap(A[Q],N)),(H=A[Q].limit-A[Q].offset)>0&&(Ce+=H);if(0===Ce)return new M(0,X,oe);var Pe,Ge=new M(Ce,X,oe);for(Q=0;Q<xe;)(H=(Pe=A[Q++]).limit-Pe.offset)<=0||(Ge.view.set(Pe.view.subarray(Pe.offset,Pe.limit),Ge.offset),Ge.offset+=H);return Ge.limit=Ge.offset,Ge.offset=0,Ge},M.isByteBuffer=function(A){return!0===(A&&A.__isByteBuffer__)},M.type=function(){return ArrayBuffer},M.wrap=function(A,N,X,oe){if("string"!=typeof N&&(oe=X,X=N,N=void 0),"string"==typeof A)switch(void 0===N&&(N="utf8"),N){case"base64":return M.fromBase64(A,X);case"hex":return M.fromHex(A,X);case"binary":return M.fromBinary(A,X);case"utf8":return M.fromUTF8(A,X);case"debug":return M.fromDebug(A,X);default:throw Error("Unsupported encoding: "+N)}if(null===A||"object"!=typeof A)throw TypeError("Illegal buffer");var H;if(M.isByteBuffer(A))return(H=P.clone.call(A)).markedOffset=-1,H;if(A instanceof Uint8Array)H=new M(0,X,oe),A.length>0&&(H.buffer=A.buffer,H.offset=A.byteOffset,H.limit=A.byteOffset+A.byteLength,H.view=new Uint8Array(A.buffer));else if(A instanceof ArrayBuffer)H=new M(0,X,oe),A.byteLength>0&&(H.buffer=A,H.offset=0,H.limit=A.byteLength,H.view=A.byteLength>0?new Uint8Array(A):null);else{if("[object Array]"!==Object.prototype.toString.call(A))throw TypeError("Illegal buffer");(H=new M(A.length,X,oe)).limit=A.length;for(var Ce=0;Ce<A.length;++Ce)H.view[Ce]=A[Ce]}return H},P.writeBitSet=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if(!(A instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe,H=N,Ce=A.length,Q=Ce>>3,xe=0;for(N+=this.writeVarint32(Ce,N);Q--;)oe=1&!!A[xe++]|(1&!!A[xe++])<<1|(1&!!A[xe++])<<2|(1&!!A[xe++])<<3|(1&!!A[xe++])<<4|(1&!!A[xe++])<<5|(1&!!A[xe++])<<6|(1&!!A[xe++])<<7,this.writeByte(oe,N++);if(xe<Ce){var Pe=0;for(oe=0;xe<Ce;)oe|=(1&!!A[xe++])<<Pe++;this.writeByte(oe,N++)}return X?(this.offset=N,this):N-H},P.readBitSet=function(A){var N=void 0===A;N&&(A=this.offset);var X,oe=this.readVarint32(A),H=oe.value,Ce=H>>3,Q=0,xe=[];for(A+=oe.length;Ce--;)X=this.readByte(A++),xe[Q++]=!!(1&X),xe[Q++]=!!(2&X),xe[Q++]=!!(4&X),xe[Q++]=!!(8&X),xe[Q++]=!!(16&X),xe[Q++]=!!(32&X),xe[Q++]=!!(64&X),xe[Q++]=!!(128&X);if(Q<H){var Pe=0;for(X=this.readByte(A++);Q<H;)xe[Q++]=!!(X>>Pe++&1)}return N&&(this.offset=A),xe},P.readBytes=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+"+A+") <= "+this.buffer.byteLength)}var oe=this.slice(N,N+A);return X&&(this.offset+=A),oe},P.writeBytes=P.append,P.writeInt8=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=1)>oe&&this.resize((oe*=2)>N?oe:N),this.view[N-=1]=A,X&&(this.offset+=1),this},P.writeByte=P.writeInt8,P.readInt8=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return 128==(128&X)&&(X=-(255-X+1)),N&&(this.offset+=1),X},P.readByte=P.readInt8,P.writeUint8=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=1)>oe&&this.resize((oe*=2)>N?oe:N),this.view[N-=1]=A,X&&(this.offset+=1),this},P.writeUInt8=P.writeUint8,P.readUint8=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return N&&(this.offset+=1),X},P.readUInt8=P.readUint8,P.writeInt16=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=2)>oe&&this.resize((oe*=2)>N?oe:N),N-=2,this.littleEndian?(this.view[N+1]=(65280&A)>>>8,this.view[N]=255&A):(this.view[N]=(65280&A)>>>8,this.view[N+1]=255&A),X&&(this.offset+=2),this},P.writeShort=P.writeInt16,P.readInt16=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),32768==(32768&X)&&(X=-(65535-X+1)),N&&(this.offset+=2),X},P.readShort=P.readInt16,P.writeUint16=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=2)>oe&&this.resize((oe*=2)>N?oe:N),N-=2,this.littleEndian?(this.view[N+1]=(65280&A)>>>8,this.view[N]=255&A):(this.view[N]=(65280&A)>>>8,this.view[N+1]=255&A),X&&(this.offset+=2),this},P.writeUInt16=P.writeUint16,P.readUint16=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),N&&(this.offset+=2),X},P.readUInt16=P.readUint16,P.writeInt32=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=4)>oe&&this.resize((oe*=2)>N?oe:N),N-=4,this.littleEndian?(this.view[N+3]=A>>>24&255,this.view[N+2]=A>>>16&255,this.view[N+1]=A>>>8&255,this.view[N]=255&A):(this.view[N]=A>>>24&255,this.view[N+1]=A>>>16&255,this.view[N+2]=A>>>8&255,this.view[N+3]=255&A),X&&(this.offset+=4),this},P.writeInt=P.writeInt32,P.readInt32=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),X|=0,N&&(this.offset+=4),X},P.readInt=P.readInt32,P.writeUint32=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=4)>oe&&this.resize((oe*=2)>N?oe:N),N-=4,this.littleEndian?(this.view[N+3]=A>>>24&255,this.view[N+2]=A>>>16&255,this.view[N+1]=A>>>8&255,this.view[N]=255&A):(this.view[N]=A>>>24&255,this.view[N+1]=A>>>16&255,this.view[N+2]=A>>>8&255,this.view[N+3]=255&A),X&&(this.offset+=4),this},P.writeUInt32=P.writeUint32,P.readUint32=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),N&&(this.offset+=4),X},P.readUInt32=P.readUint32,z&&(P.writeInt64=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"==typeof A)A=z.fromNumber(A);else if("string"==typeof A)A=z.fromString(A);else if(!(A&&A instanceof z))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=z.fromNumber(A):"string"==typeof A&&(A=z.fromString(A));var oe=this.buffer.byteLength;(N+=8)>oe&&this.resize((oe*=2)>N?oe:N),N-=8;var H=A.low,Ce=A.high;return this.littleEndian?(this.view[N+3]=H>>>24&255,this.view[N+2]=H>>>16&255,this.view[N+1]=H>>>8&255,this.view[N]=255&H,this.view[(N+=4)+3]=Ce>>>24&255,this.view[N+2]=Ce>>>16&255,this.view[N+1]=Ce>>>8&255,this.view[N]=255&Ce):(this.view[N]=Ce>>>24&255,this.view[N+1]=Ce>>>16&255,this.view[N+2]=Ce>>>8&255,this.view[N+3]=255&Ce,this.view[N+=4]=H>>>24&255,this.view[N+1]=H>>>16&255,this.view[N+2]=H>>>8&255,this.view[N+3]=255&H),X&&(this.offset+=8),this},P.writeLong=P.writeInt64,P.readInt64=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,oe=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,oe=this.view[(A+=4)+2]<<16,oe|=this.view[A+1]<<8,oe|=this.view[A],oe+=this.view[A+3]<<24>>>0):(oe=this.view[A+1]<<16,oe|=this.view[A+2]<<8,oe|=this.view[A+3],oe+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var H=new z(X,oe,!1);return N&&(this.offset+=8),H},P.readLong=P.readInt64,P.writeUint64=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"==typeof A)A=z.fromNumber(A);else if("string"==typeof A)A=z.fromString(A);else if(!(A&&A instanceof z))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=z.fromNumber(A):"string"==typeof A&&(A=z.fromString(A));var oe=this.buffer.byteLength;(N+=8)>oe&&this.resize((oe*=2)>N?oe:N),N-=8;var H=A.low,Ce=A.high;return this.littleEndian?(this.view[N+3]=H>>>24&255,this.view[N+2]=H>>>16&255,this.view[N+1]=H>>>8&255,this.view[N]=255&H,this.view[(N+=4)+3]=Ce>>>24&255,this.view[N+2]=Ce>>>16&255,this.view[N+1]=Ce>>>8&255,this.view[N]=255&Ce):(this.view[N]=Ce>>>24&255,this.view[N+1]=Ce>>>16&255,this.view[N+2]=Ce>>>8&255,this.view[N+3]=255&Ce,this.view[N+=4]=H>>>24&255,this.view[N+1]=H>>>16&255,this.view[N+2]=H>>>8&255,this.view[N+3]=255&H),X&&(this.offset+=8),this},P.writeUInt64=P.writeUint64,P.readUint64=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,oe=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,oe=this.view[(A+=4)+2]<<16,oe|=this.view[A+1]<<8,oe|=this.view[A],oe+=this.view[A+3]<<24>>>0):(oe=this.view[A+1]<<16,oe|=this.view[A+2]<<8,oe|=this.view[A+3],oe+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var H=new z(X,oe,!0);return N&&(this.offset+=8),H},P.readUInt64=P.readUint64),P.writeFloat32=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=4)>oe&&this.resize((oe*=2)>N?oe:N),le(this.view,A,N-=4,this.littleEndian,23,4),X&&(this.offset+=4),this},P.writeFloat=P.writeFloat32,P.readFloat32=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=fe(this.view,A,this.littleEndian,23,4);return N&&(this.offset+=4),X},P.readFloat=P.readFloat32,P.writeFloat64=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe=this.buffer.byteLength;return(N+=8)>oe&&this.resize((oe*=2)>N?oe:N),le(this.view,A,N-=8,this.littleEndian,52,8),X&&(this.offset+=8),this},P.writeDouble=P.writeFloat64,P.readFloat64=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=fe(this.view,A,this.littleEndian,52,8);return N&&(this.offset+=8),X},P.readDouble=P.readFloat64,M.MAX_VARINT32_BYTES=5,M.calculateVarint32=function(A){return(A>>>=0)<128?1:A<16384?2:A<2097152?3:A<268435456?4:5},M.zigZagEncode32=function(A){return((A|=0)<<1^A>>31)>>>0},M.zigZagDecode32=function(A){return A>>>1^-(1&A)|0},P.writeVarint32=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var H=M.calculateVarint32(A),Ce=this.buffer.byteLength;for((N+=H)>Ce&&this.resize((Ce*=2)>N?Ce:N),N-=H,A>>>=0;A>=128;)this.view[N++]=127&A|128,A>>>=7;return this.view[N++]=A,X?(this.offset=N,this):H},P.writeVarint32ZigZag=function(A,N){return this.writeVarint32(M.zigZagEncode32(A),N)},P.readVarint32=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,oe=0,H=0;do{if(!this.noAssert&&A>this.limit){var Ce=Error("Truncated");throw Ce.truncated=!0,Ce}X=this.view[A++],oe<5&&(H|=(127&X)<<7*oe),++oe}while(128&X);return H|=0,N?(this.offset=A,H):{value:H,length:oe}},P.readVarint32ZigZag=function(A){var N=this.readVarint32(A);return"object"==typeof N?N.value=M.zigZagDecode32(N.value):N=M.zigZagDecode32(N),N},z&&(M.MAX_VARINT64_BYTES=10,M.calculateVarint64=function(A){"number"==typeof A?A=z.fromNumber(A):"string"==typeof A&&(A=z.fromString(A));var N=A.toInt()>>>0,X=A.shiftRightUnsigned(28).toInt()>>>0,oe=A.shiftRightUnsigned(56).toInt()>>>0;return 0==oe?0==X?N<16384?N<128?1:2:N<2097152?3:4:X<16384?X<128?5:6:X<2097152?7:8:oe<128?9:10},M.zigZagEncode64=function(A){return"number"==typeof A?A=z.fromNumber(A,!1):"string"==typeof A?A=z.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftLeft(1).xor(A.shiftRight(63)).toUnsigned()},M.zigZagDecode64=function(A){return"number"==typeof A?A=z.fromNumber(A,!1):"string"==typeof A?A=z.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftRightUnsigned(1).xor(A.and(z.ONE).toSigned().negate()).toSigned()},P.writeVarint64=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("number"==typeof A)A=z.fromNumber(A);else if("string"==typeof A)A=z.fromString(A);else if(!(A&&A instanceof z))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=z.fromNumber(A,!1):"string"==typeof A?A=z.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned());var oe=M.calculateVarint64(A),H=A.toInt()>>>0,Ce=A.shiftRightUnsigned(28).toInt()>>>0,Q=A.shiftRightUnsigned(56).toInt()>>>0,xe=this.buffer.byteLength;switch((N+=oe)>xe&&this.resize((xe*=2)>N?xe:N),N-=oe,oe){case 10:this.view[N+9]=Q>>>7&1;case 9:this.view[N+8]=9!==oe?128|Q:127&Q;case 8:this.view[N+7]=8!==oe?Ce>>>21|128:Ce>>>21&127;case 7:this.view[N+6]=7!==oe?Ce>>>14|128:Ce>>>14&127;case 6:this.view[N+5]=6!==oe?Ce>>>7|128:Ce>>>7&127;case 5:this.view[N+4]=5!==oe?128|Ce:127&Ce;case 4:this.view[N+3]=4!==oe?H>>>21|128:H>>>21&127;case 3:this.view[N+2]=3!==oe?H>>>14|128:H>>>14&127;case 2:this.view[N+1]=2!==oe?H>>>7|128:H>>>7&127;case 1:this.view[N]=1!==oe?128|H:127&H}return X?(this.offset+=oe,this):oe},P.writeVarint64ZigZag=function(A,N){return this.writeVarint64(M.zigZagEncode64(A),N)},P.readVarint64=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,oe=0,H=0,Ce=0,Q=0;if(oe=127&(Q=this.view[A++]),128&Q&&(oe|=(127&(Q=this.view[A++]))<<7,(128&Q||this.noAssert&&void 0===Q)&&(oe|=(127&(Q=this.view[A++]))<<14,(128&Q||this.noAssert&&void 0===Q)&&(oe|=(127&(Q=this.view[A++]))<<21,(128&Q||this.noAssert&&void 0===Q)&&(H=127&(Q=this.view[A++]),(128&Q||this.noAssert&&void 0===Q)&&(H|=(127&(Q=this.view[A++]))<<7,(128&Q||this.noAssert&&void 0===Q)&&(H|=(127&(Q=this.view[A++]))<<14,(128&Q||this.noAssert&&void 0===Q)&&(H|=(127&(Q=this.view[A++]))<<21,(128&Q||this.noAssert&&void 0===Q)&&(Ce=127&(Q=this.view[A++]),(128&Q||this.noAssert&&void 0===Q)&&(Ce|=(127&(Q=this.view[A++]))<<7,128&Q||this.noAssert&&void 0===Q))))))))))throw Error("Buffer overrun");var xe=z.fromBits(oe|H<<28,H>>>4|Ce<<24,!1);return N?(this.offset=A,xe):{value:xe,length:A-X}},P.readVarint64ZigZag=function(A){var N=this.readVarint64(A);return N&&N.value instanceof z?N.value=M.zigZagDecode64(N.value):N=M.zigZagDecode64(N),N}),P.writeCString=function(A,N){var X=void 0===N;X&&(N=this.offset);var oe,H=A.length;if(!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");for(oe=0;oe<H;++oe)if(0===A.charCodeAt(oe))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}H=Y.calculateUTF16asUTF8(he(A))[1];var Ce=this.buffer.byteLength;return(N+=H+1)>Ce&&this.resize((Ce*=2)>N?Ce:N),N-=H+1,Y.encodeUTF16toUTF8(he(A),function(Q){this.view[N++]=Q}.bind(this)),this.view[N++]=0,X?(this.offset=N,this):H},P.readCString=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,oe=A,H=-1;return Y.decodeUTF8toUTF16(function(){if(0===H)return null;if(A>=this.limit)throw RangeError("Illegal range: Truncated data, "+A+" < "+this.limit);return 0===(H=this.view[A++])?null:H}.bind(this),X=ae(),!0),N?(this.offset=A,X()):{string:X(),length:A-oe}},P.writeIString=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe,H=N;oe=Y.calculateUTF16asUTF8(he(A),this.noAssert)[1];var Ce=this.buffer.byteLength;if((N+=4+oe)>Ce&&this.resize((Ce*=2)>N?Ce:N),N-=4+oe,this.littleEndian?(this.view[N+3]=oe>>>24&255,this.view[N+2]=oe>>>16&255,this.view[N+1]=oe>>>8&255,this.view[N]=255&oe):(this.view[N]=oe>>>24&255,this.view[N+1]=oe>>>16&255,this.view[N+2]=oe>>>8&255,this.view[N+3]=255&oe),N+=4,Y.encodeUTF16toUTF8(he(A),function(Q){this.view[N++]=Q}.bind(this)),N!==H+4+oe)throw RangeError("Illegal range: Truncated data, "+N+" == "+(N+4+oe));return X?(this.offset=N,this):N-H},P.readIString=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=A,oe=this.readUint32(A),H=this.readUTF8String(oe,M.METRICS_BYTES,A+=4);return A+=H.length,N?(this.offset=A,H.string):{string:H.string,length:A-X}},M.METRICS_CHARS="c",M.METRICS_BYTES="b",P.writeUTF8String=function(A,N){var X,oe=void 0===N;if(oe&&(N=this.offset),!this.noAssert){if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var H=N;X=Y.calculateUTF16asUTF8(he(A))[1];var Ce=this.buffer.byteLength;return(N+=X)>Ce&&this.resize((Ce*=2)>N?Ce:N),N-=X,Y.encodeUTF16toUTF8(he(A),function(Q){this.view[N++]=Q}.bind(this)),oe?(this.offset=N,this):N-H},P.writeString=P.writeUTF8String,M.calculateUTF8Chars=function(A){return Y.calculateUTF16asUTF8(he(A))[0]},M.calculateUTF8Bytes=function(A){return Y.calculateUTF16asUTF8(he(A))[1]},M.calculateString=M.calculateUTF8Bytes,P.readUTF8String=function(A,N,X){"number"==typeof N&&(X=N,N=void 0);var oe=void 0===X;if(oe&&(X=this.offset),void 0===N&&(N=M.METRICS_CHARS),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");if(A|=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}var H,Ce=0,Q=X;if(N===M.METRICS_CHARS){if(H=ae(),Y.decodeUTF8(function(){return Ce<A&&X<this.limit?this.view[X++]:null}.bind(this),function(Pe){++Ce,Y.UTF8toUTF16(Pe,H)}),Ce!==A)throw RangeError("Illegal range: Truncated data, "+Ce+" == "+A);return oe?(this.offset=X,H()):{string:H(),length:X-Q}}if(N===M.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+"+A+") <= "+this.buffer.byteLength)}var xe=X+A;if(Y.decodeUTF8toUTF16(function(){return X<xe?this.view[X++]:null}.bind(this),H=ae(),this.noAssert),X!==xe)throw RangeError("Illegal range: Truncated data, "+X+" == "+xe);return oe?(this.offset=X,H()):{string:H(),length:X-Q}}throw TypeError("Unsupported metrics: "+N)},P.readString=P.readUTF8String,P.writeVString=function(A,N){var X=void 0===N;if(X&&(N=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: "+N+" (not an integer)");if((N>>>=0)<0||N+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+N+" (+0) <= "+this.buffer.byteLength)}var oe,H,Ce=N;oe=Y.calculateUTF16asUTF8(he(A),this.noAssert)[1],H=M.calculateVarint32(oe);var Q=this.buffer.byteLength;if((N+=H+oe)>Q&&this.resize((Q*=2)>N?Q:N),N-=H+oe,N+=this.writeVarint32(oe,N),Y.encodeUTF16toUTF8(he(A),function(xe){this.view[N++]=xe}.bind(this)),N!==Ce+oe+H)throw RangeError("Illegal range: Truncated data, "+N+" == "+(N+oe+H));return X?(this.offset=N,this):N-Ce},P.readVString=function(A){var N=void 0===A;if(N&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,oe=this.readVarint32(A),H=this.readUTF8String(oe.value,M.METRICS_BYTES,A+=oe.length);return A+=H.length,N?(this.offset=A,H.string):{string:H.string,length:A-X}},P.append=function(A,N,X){"number"!=typeof N&&"string"==typeof N||(X=N,N=void 0);var oe=void 0===X;if(oe&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,N));var H=A.limit-A.offset;if(H<=0)return this;var Ce=this.buffer.byteLength;return(X+=H)>Ce&&this.resize((Ce*=2)>X?Ce:X),X-=H,this.view.set(A.view.subarray(A.offset,A.limit),X),A.offset+=H,oe&&(this.offset+=H),this},P.appendTo=function(A,N){return A.append(this,N),this},P.assert=function(A){return this.noAssert=!A,this},P.capacity=function(){return this.buffer.byteLength},P.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},P.clone=function(A){var N=new M(0,this.littleEndian,this.noAssert);return A?(N.buffer=new ArrayBuffer(this.buffer.byteLength),N.view=new Uint8Array(N.buffer)):(N.buffer=this.buffer,N.view=this.view),N.offset=this.offset,N.markedOffset=this.markedOffset,N.limit=this.limit,N},P.compact=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}if(0===A&&N===this.buffer.byteLength)return this;var X=N-A;if(0===X)return this.buffer=de,this.view=null,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=0,this;var oe=new ArrayBuffer(X),H=new Uint8Array(oe);return H.set(this.view.subarray(A,N)),this.buffer=oe,this.view=H,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=X,this},P.copy=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}if(A===N)return new M(0,this.littleEndian,this.noAssert);var X=N-A,oe=new M(X,this.littleEndian,this.noAssert);return oe.offset=0,oe.limit=X,oe.markedOffset>=0&&(oe.markedOffset-=A),this.copyTo(oe,0,A,N),oe},P.copyTo=function(A,N,X,oe){var H,Ce;if(!this.noAssert&&!M.isByteBuffer(A))throw TypeError("Illegal target: Not a ByteBuffer");if(N=(Ce=void 0===N)?A.offset:0|N,X=(H=void 0===X)?this.offset:0|X,oe=void 0===oe?this.limit:0|oe,N<0||N>A.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+N+" <= "+A.buffer.byteLength);if(X<0||oe>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+X+" <= "+this.buffer.byteLength);var Q=oe-X;return 0===Q?A:(A.ensureCapacity(N+Q),A.view.set(this.view.subarray(X,oe),N),H&&(this.offset+=Q),Ce&&(A.offset+=Q),this)},P.ensureCapacity=function(A){var N=this.buffer.byteLength;return N<A?this.resize((N*=2)>A?N:A):this},P.fill=function(A,N,X){var oe=void 0===N;if(oe&&(N=this.offset),"string"==typeof A&&A.length>0&&(A=A.charCodeAt(0)),void 0===N&&(N=this.offset),void 0===X&&(X=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal begin: Not an integer");if(N>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal end: Not an integer");if(X>>>=0,N<0||N>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+N+" <= "+X+" <= "+this.buffer.byteLength)}if(N>=X)return this;for(;N<X;)this.view[N++]=A;return oe&&(this.offset=N),this},P.flip=function(){return this.limit=this.offset,this.offset=0,this},P.mark=function(A){if(A=void 0===A?this.offset:A,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=A,this},P.order=function(A){if(!this.noAssert&&"boolean"!=typeof A)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!A,this},P.LE=function(A){return this.littleEndian=void 0===A||!!A,this},P.BE=function(A){return this.littleEndian=void 0!==A&&!A,this},P.prepend=function(A,N,X){"number"!=typeof N&&"string"==typeof N||(X=N,N=void 0);var oe=void 0===X;if(oe&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,N));var H=A.limit-A.offset;if(H<=0)return this;var Ce=H-X;if(Ce>0){var Q=new ArrayBuffer(this.buffer.byteLength+Ce),xe=new Uint8Array(Q);xe.set(this.view.subarray(X,this.buffer.byteLength),H),this.buffer=Q,this.view=xe,this.offset+=Ce,this.markedOffset>=0&&(this.markedOffset+=Ce),this.limit+=Ce,X+=Ce}else new Uint8Array(this.buffer);return this.view.set(A.view.subarray(A.offset,A.limit),X-H),A.offset=A.limit,oe&&(this.offset-=H),this},P.prependTo=function(A,N){return A.prepend(this,N),this},P.printDebug=function(A){"function"!=typeof A&&(A=console.log.bind(console)),A(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},P.remaining=function(){return this.limit-this.offset},P.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},P.resize=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal capacity: "+A+" (not an integer)");if((A|=0)<0)throw RangeError("Illegal capacity: 0 <= "+A)}if(this.buffer.byteLength<A){var N=new ArrayBuffer(A),X=new Uint8Array(N);X.set(this.view),this.buffer=N,this.view=X}return this},P.reverse=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}return A===N||Array.prototype.reverse.call(this.view.subarray(A,N)),this},P.skip=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");A|=0}var N=this.offset+A;if(!this.noAssert&&(N<0||N>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+A+" <= "+this.buffer.byteLength);return this.offset=N,this},P.slice=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}var X=this.clone();return X.offset=A,X.limit=N,X},P.toBuffer=function(A){var N=this.offset,X=this.limit;if(!this.noAssert){if("number"!=typeof N||N%1!=0)throw TypeError("Illegal offset: Not an integer");if(N>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal limit: Not an integer");if(X>>>=0,N<0||N>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+N+" <= "+X+" <= "+this.buffer.byteLength)}if(!A&&0===N&&X===this.buffer.byteLength)return this.buffer;if(N===X)return de;var oe=new ArrayBuffer(X-N);return new Uint8Array(oe).set(new Uint8Array(this.buffer).subarray(N,X),0),oe},P.toArrayBuffer=P.toBuffer,P.toString=function(A,N,X){if(void 0===A)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof A&&(X=N=A="utf8"),A){case"utf8":return this.toUTF8(N,X);case"base64":return this.toBase64(N,X);case"hex":return this.toHex(N,X);case"binary":return this.toBinary(N,X);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+A)}};var q=function(){for(var A={},N=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],X=[],oe=0,H=N.length;oe<H;++oe)X[N[oe]]=oe;return A.encode=function(Ce,Q){for(var xe,Pe;null!==(xe=Ce());)Q(N[xe>>2&63]),Pe=(3&xe)<<4,null!==(xe=Ce())?(Q(N[63&((Pe|=xe>>4&15)|xe>>4&15)]),Pe=(15&xe)<<2,null!==(xe=Ce())?(Q(N[63&(Pe|xe>>6&3)]),Q(N[63&xe])):(Q(N[63&Pe]),Q(61))):(Q(N[63&Pe]),Q(61),Q(61))},A.decode=function(Ce,Q){var xe,Pe,Ge;function Ae(Xe){throw Error("Illegal character code: "+Xe)}for(;null!==(xe=Ce());)if(void 0===(Pe=X[xe])&&Ae(xe),null!==(xe=Ce())&&(void 0===(Ge=X[xe])&&Ae(xe),Q(Pe<<2>>>0|(48&Ge)>>4),null!==(xe=Ce()))){if(void 0===(Pe=X[xe])){if(61===xe)break;Ae(xe)}if(Q((15&Ge)<<4>>>0|(60&Pe)>>2),null!==(xe=Ce())){if(void 0===(Ge=X[xe])){if(61===xe)break;Ae(xe)}Q((3&Pe)<<6>>>0|Ge)}}},A.test=function(Ce){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Ce)},A}();P.toBase64=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),N|=0,(A|=0)<0||N>this.capacity||A>N)throw RangeError("begin, end");var X;return q.encode(function(){return A<N?this.view[A++]:null}.bind(this),X=ae()),X()},M.fromBase64=function(A,N){if("string"!=typeof A)throw TypeError("str");var X=new M(A.length/4*3,N),oe=0;return q.decode(he(A),function(H){X.view[oe++]=H}),X.limit=oe,X},M.btoa=function(A){return M.fromBinary(A).toBase64()},M.atob=function(A){return M.fromBase64(A).toBinary()},P.toBinary=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),N|=0,(A|=0)<0||N>this.capacity()||A>N)throw RangeError("begin, end");if(A===N)return"";for(var X=[],oe=[];A<N;)X.push(this.view[A++]),X.length>=1024&&(oe.push(String.fromCharCode.apply(String,X)),X=[]);return oe.join("")+String.fromCharCode.apply(String,X)},M.fromBinary=function(A,N){if("string"!=typeof A)throw TypeError("str");for(var X,oe=0,H=A.length,Ce=new M(H,N);oe<H;){if((X=A.charCodeAt(oe))>255)throw RangeError("illegal char code: "+X);Ce.view[oe++]=X}return Ce.limit=H,Ce},P.toDebug=function(A){for(var N,X=-1,oe=this.buffer.byteLength,H="",Ce="",Q="";X<oe;){if(-1!==X&&(H+=(N=this.view[X])<16?"0"+N.toString(16).toUpperCase():N.toString(16).toUpperCase(),A&&(Ce+=N>32&&N<127?String.fromCharCode(N):".")),++X,A&&X>0&&X%16==0&&X!==oe){for(;H.length<51;)H+=" ";Q+=H+Ce+"\n",H=Ce=""}H+=X===this.offset&&X===this.limit?X===this.markedOffset?"!":"|":X===this.offset?X===this.markedOffset?"[":"<":X===this.limit?X===this.markedOffset?"]":">":X===this.markedOffset?"'":A||0!==X&&X!==oe?" ":""}if(A&&" "!==H){for(;H.length<51;)H+=" ";Q+=H+Ce+"\n"}return A?Q:H},M.fromDebug=function(A,N,X){for(var oe,H,Ce=A.length,Q=new M((Ce+1)/3|0,N,X),xe=0,Pe=0,Ge=!1,Ae=!1,Xe=!1,Ke=!1,yt=!1;xe<Ce;){switch(oe=A.charAt(xe++)){case"!":if(!X){if(Ae||Xe||Ke){yt=!0;break}Ae=Xe=Ke=!0}Q.offset=Q.markedOffset=Q.limit=Pe,Ge=!1;break;case"|":if(!X){if(Ae||Ke){yt=!0;break}Ae=Ke=!0}Q.offset=Q.limit=Pe,Ge=!1;break;case"[":if(!X){if(Ae||Xe){yt=!0;break}Ae=Xe=!0}Q.offset=Q.markedOffset=Pe,Ge=!1;break;case"<":if(!X){if(Ae){yt=!0;break}Ae=!0}Q.offset=Pe,Ge=!1;break;case"]":if(!X){if(Ke||Xe){yt=!0;break}Ke=Xe=!0}Q.limit=Q.markedOffset=Pe,Ge=!1;break;case">":if(!X){if(Ke){yt=!0;break}Ke=!0}Q.limit=Pe,Ge=!1;break;case"'":if(!X){if(Xe){yt=!0;break}Xe=!0}Q.markedOffset=Pe,Ge=!1;break;case" ":Ge=!1;break;default:if(!X&&Ge){yt=!0;break}if(H=parseInt(oe+A.charAt(xe++),16),!X&&(isNaN(H)||H<0||H>255))throw TypeError("Illegal str: Not a debug encoded string");Q.view[Pe++]=H,Ge=!0}if(yt)throw TypeError("Illegal str: Invalid symbol at "+xe)}if(!X){if(!Ae||!Ke)throw TypeError("Illegal str: Missing offset or limit");if(Pe<Q.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+Pe+" < "+Ce)}return Q},P.toHex=function(A,N){if(A=void 0===A?this.offset:A,N=void 0===N?this.limit:N,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}for(var X,oe=new Array(N-A);A<N;)(X=this.view[A++])<16?oe.push("0",X.toString(16)):oe.push(X.toString(16));return oe.join("")},M.fromHex=function(A,N,X){if(!X){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if(A.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var oe,H=A.length,Ce=new M(H/2|0,N),Q=0,xe=0;Q<H;Q+=2){if(oe=parseInt(A.substring(Q,Q+2),16),!X&&(!isFinite(oe)||oe<0||oe>255))throw TypeError("Illegal str: Contains non-hex characters");Ce.view[xe++]=oe}return Ce.limit=xe,Ce};var A,Y=A={MAX_CODEPOINT:1114111,encodeUTF8:function(N,X){var oe=null;for("number"==typeof N&&(oe=N,N=function(){return null});null!==oe||null!==(oe=N());)oe<128?X(127&oe):oe<2048?(X(oe>>6&31|192),X(63&oe|128)):oe<65536?(X(oe>>12&15|224),X(oe>>6&63|128),X(63&oe|128)):(X(oe>>18&7|240),X(oe>>12&63|128),X(oe>>6&63|128),X(63&oe|128)),oe=null},decodeUTF8:function(N,X){for(var oe,H,Ce,Q,xe=function(Pe){Pe=Pe.slice(0,Pe.indexOf(null));var Ge=Error(Pe.toString());throw Ge.name="TruncatedError",Ge.bytes=Pe,Ge};null!==(oe=N());)if(128&oe)if(192==(224&oe))null===(H=N())&&xe([oe,H]),X((31&oe)<<6|63&H);else if(224==(240&oe))(null===(H=N())||null===(Ce=N()))&&xe([oe,H,Ce]),X((15&oe)<<12|(63&H)<<6|63&Ce);else{if(240!=(248&oe))throw RangeError("Illegal starting byte: "+oe);(null===(H=N())||null===(Ce=N())||null===(Q=N()))&&xe([oe,H,Ce,Q]),X((7&oe)<<18|(63&H)<<12|(63&Ce)<<6|63&Q)}else X(oe)},UTF16toUTF8:function(N,X){for(var oe,H=null;null!==(oe=null!==H?H:N());)oe>=55296&&oe<=57343&&null!==(H=N())&&H>=56320&&H<=57343?(X(1024*(oe-55296)+H-56320+65536),H=null):X(oe);null!==H&&X(H)},UTF8toUTF16:function(N,X){var oe=null;for("number"==typeof N&&(oe=N,N=function(){return null});null!==oe||null!==(oe=N());)oe<=65535?X(oe):(X(55296+((oe-=65536)>>10)),X(oe%1024+56320)),oe=null},encodeUTF16toUTF8:function(N,X){A.UTF16toUTF8(N,function(oe){A.encodeUTF8(oe,X)})},decodeUTF8toUTF16:function(N,X){A.decodeUTF8(N,function(oe){A.UTF8toUTF16(oe,X)})},calculateCodePoint:function(N){return N<128?1:N<2048?2:N<65536?3:4},calculateUTF8:function(N){for(var X,oe=0;null!==(X=N());)oe+=X<128?1:X<2048?2:X<65536?3:4;return oe},calculateUTF16asUTF8:function(N){var X=0,oe=0;return A.UTF16toUTF8(N,function(H){++X,oe+=H<128?1:H<2048?2:H<65536?3:4}),[X,oe]}};return P.toUTF8=function(A,N){if(void 0===A&&(A=this.offset),void 0===N&&(N=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof N||N%1!=0)throw TypeError("Illegal end: Not an integer");if(N>>>=0,A<0||A>N||N>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+N+" <= "+this.buffer.byteLength)}var X;try{Y.decodeUTF8toUTF16(function(){return A<N?this.view[A++]:null}.bind(this),X=ae())}catch{if(A!==N)throw RangeError("Illegal range: Truncated data, "+A+" != "+N)}return X()},M.fromUTF8=function(A,N,X){if(!X&&"string"!=typeof A)throw TypeError("Illegal str: Not a string");var oe=new M(Y.calculateUTF16asUTF8(he(A),!0)[1],N,X),H=0;return Y.encodeUTF16toUTF8(he(A),function(Ce){oe.view[H++]=Ce}),oe.limit=H,oe},M},void 0===(D=x.apply(o,L))||(n.exports=D)},690:n=>{n.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},87:n=>{n.exports="function"==typeof Object.create?function(o,l){l&&(o.super_=l,o.prototype=Object.create(l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,l){if(l){o.super_=l;var x=function(){};x.prototype=l.prototype,o.prototype=new x,o.prototype.constructor=o}}},809:n=>{function o(l){return!!l.constructor&&"function"==typeof l.constructor.isBuffer&&l.constructor.isBuffer(l)}n.exports=function(l){return null!=l&&(o(l)||"function"==typeof(x=l).readFloatLE&&"function"==typeof x.slice&&o(x.slice(0,0))||!!l._isBuffer);var x}},190:(n,o,l)=>{var x=l(408),L=l(720),D=l(355),z=["x","e","a","o","n","s","r","c","u","m","v","w","z"],M=["m","w"],P=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],de="\t".charCodeAt(0),ye=" ".charCodeAt(0);function he(Y){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(Y)}function ae(Y){return new Function(["return function "+Y+"() {","  return this._"+Y,"}"].join("\n"))()}function fe(Y,A){if(!Y.chars||0===Y.chars.length)return null;var N=q(Y.chars,A);return N>=0?Y.chars[N]:null}function le(Y,A,N){if(!Y.kernings||0===Y.kernings.length)return 0;for(var X=Y.kernings,oe=0;oe<X.length;oe++){var H=X[oe];if(H.first===A&&H.second===N)return H.amount}return 0}function q(Y,A,N){for(var X=N=N||0;X<Y.length;X++)if(Y[X].id===A)return X;return-1}n.exports=function(Y){return new he(Y)},he.prototype.update=function(Y){if(Y=L({measure:this._measure},Y),this._opt=Y,this._opt.tabSize=D(this._opt.tabSize,4),!Y.font)throw new Error("must provide a valid bitmap font");var A=this.glyphs,N=Y.text||"",X=Y.font;this._setupSpaceGlyphs(X);var oe=x.lines(N,Y),H=Y.width||0;A.length=0;var Pt,Ce=oe.reduce(function(Pt,wt){return Math.max(Pt,wt.width,H)},0),Q=0,xe=0,Pe=D(Y.lineHeight,X.common.lineHeight),Ge=X.common.base,Ae=Pe-Ge,Xe=Y.letterSpacing||0,Ke=Pe*oe.length-Ae,yt="center"===(Pt=this._opt.align)?1:"right"===Pt?2:0;xe-=Ke,this._width=Ce,this._height=Ke,this._descender=Pe-Ge,this._baseline=Ge,this._xHeight=function(Pt){for(var wt=0;wt<z.length;wt++){var Gt=z[wt].charCodeAt(0),Dt=q(Pt.chars,Gt);if(Dt>=0)return Pt.chars[Dt].height}return 0}(X),this._capHeight=function(Pt){for(var wt=0;wt<P.length;wt++){var Gt=P[wt].charCodeAt(0),Dt=q(Pt.chars,Gt);if(Dt>=0)return Pt.chars[Dt].height}return 0}(X),this._lineHeight=Pe,this._ascender=Pe-Ae-this._xHeight;var dt=this;oe.forEach(function(Pt,wt){for(var Gt,sn=Pt.end,gt=Pt.width,Mn=Pt.start;Mn<sn;Mn++){var Bn=N.charCodeAt(Mn),dn=dt.getGlyph(X,Bn);if(dn){Gt&&(Q+=le(X,Gt.id,dn.id));var On=Q;1===yt?On+=(Ce-gt)/2:2===yt&&(On+=Ce-gt),A.push({position:[On,xe],data:dn,index:Mn,line:wt}),Q+=dn.xadvance+Xe,Gt=dn}}xe+=Pe,Q=0}),this._linesTotal=oe.length},he.prototype._setupSpaceGlyphs=function(Y){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,Y.chars&&0!==Y.chars.length){var A=fe(Y,ye)||function(X){for(var oe=0;oe<M.length;oe++){var H=M[oe].charCodeAt(0),Ce=q(X.chars,H);if(Ce>=0)return X.chars[Ce]}return 0}(Y)||Y.chars[0],N=this._opt.tabSize*A.xadvance;this._fallbackSpaceGlyph=A,this._fallbackTabGlyph=L(A,{x:0,y:0,xadvance:N,id:de,xoffset:0,yoffset:0,width:0,height:0})}},he.prototype.getGlyph=function(Y,A){return fe(Y,A)||(A===de?this._fallbackTabGlyph:A===ye?this._fallbackSpaceGlyph:null)},he.prototype.computeMetrics=function(Y,A,N,X){var oe,H=this._opt.letterSpacing||0,Ce=this._opt.font,Q=0,xe=0,Pe=0;if(!Ce.chars||0===Ce.chars.length)return{start:A,end:A,width:0};N=Math.min(Y.length,N);for(var Ge=A;Ge<N;Ge++){var Ae,Xe=Y.charCodeAt(Ge);if(Ae=this.getGlyph(Ce,Xe)){var Ke=(Q+=oe?le(Ce,oe.id,Ae.id):0)+Ae.xadvance+H,yt=Q+Ae.width;if(yt>=X||Ke>=X)break;Q=Ke,xe=yt,oe=Ae}Pe++}return oe&&(xe+=oe.xoffset),{start:A,end:A+Pe,width:xe}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(Y){Object.defineProperty(he.prototype,Y,{get:ae(Y),configurable:!0})})},734:function(n,o){var l,x;void 0===(x="function"==typeof(l=function(){"use strict";function L(Ae,Xe,Ke){this.low=0|Ae,this.high=0|Xe,this.unsigned=!!Ke}function D(Ae){return!0===(Ae&&Ae.__isLong__)}Object.defineProperty(L.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),L.isLong=D;var z={},M={};function P(Ae,Xe){var Ke,yt,dt;return Xe?(dt=0<=(Ae>>>=0)&&Ae<256)&&(yt=M[Ae])?yt:(Ke=ye(Ae,(0|Ae)<0?-1:0,!0),dt&&(M[Ae]=Ke),Ke):(dt=-128<=(Ae|=0)&&Ae<128)&&(yt=z[Ae])?yt:(Ke=ye(Ae,Ae<0?-1:0,!1),dt&&(z[Ae]=Ke),Ke)}function de(Ae,Xe){if(isNaN(Ae)||!isFinite(Ae))return Xe?X:N;if(Xe){if(Ae<0)return X;if(Ae>=q)return xe}else{if(Ae<=-Y)return Pe;if(Ae+1>=Y)return Q}return Ae<0?de(-Ae,Xe).neg():ye(Ae%le|0,Ae/le|0,Xe)}function ye(Ae,Xe,Ke){return new L(Ae,Xe,Ke)}L.fromInt=P,L.fromNumber=de,L.fromBits=ye;var he=Math.pow;function ae(Ae,Xe,Ke){if(0===Ae.length)throw Error("empty string");if("NaN"===Ae||"Infinity"===Ae||"+Infinity"===Ae||"-Infinity"===Ae)return N;if("number"==typeof Xe?(Ke=Xe,Xe=!1):Xe=!!Xe,(Ke=Ke||10)<2||36<Ke)throw RangeError("radix");var yt;if((yt=Ae.indexOf("-"))>0)throw Error("interior hyphen");if(0===yt)return ae(Ae.substring(1),Xe,Ke).neg();for(var dt=de(he(Ke,8)),Pt=N,wt=0;wt<Ae.length;wt+=8){var Gt=Math.min(8,Ae.length-wt),Dt=parseInt(Ae.substring(wt,wt+Gt),Ke);if(Gt<8){var sn=de(he(Ke,Gt));Pt=Pt.mul(sn).add(de(Dt))}else Pt=(Pt=Pt.mul(dt)).add(de(Dt))}return Pt.unsigned=Xe,Pt}function fe(Ae){return Ae instanceof L?Ae:"number"==typeof Ae?de(Ae):"string"==typeof Ae?ae(Ae):ye(Ae.low,Ae.high,Ae.unsigned)}L.fromString=ae,L.fromValue=fe;var le=4294967296,q=le*le,Y=q/2,A=P(1<<24),N=P(0);L.ZERO=N;var X=P(0,!0);L.UZERO=X;var oe=P(1);L.ONE=oe;var H=P(1,!0);L.UONE=H;var Ce=P(-1);L.NEG_ONE=Ce;var Q=ye(-1,2147483647,!1);L.MAX_VALUE=Q;var xe=ye(-1,-1,!0);L.MAX_UNSIGNED_VALUE=xe;var Pe=ye(0,-2147483648,!1);L.MIN_VALUE=Pe;var Ge=L.prototype;return Ge.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ge.toNumber=function(){return this.unsigned?(this.high>>>0)*le+(this.low>>>0):this.high*le+(this.low>>>0)},Ge.toString=function(Ae){if((Ae=Ae||10)<2||36<Ae)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Pe)){var Xe=de(Ae),Ke=this.div(Xe),yt=Ke.mul(Xe).sub(this);return Ke.toString(Ae)+yt.toInt().toString(Ae)}return"-"+this.neg().toString(Ae)}for(var dt=de(he(Ae,6),this.unsigned),Pt=this,wt="";;){var Gt=Pt.div(dt),Dt=(Pt.sub(Gt.mul(dt)).toInt()>>>0).toString(Ae);if((Pt=Gt).isZero())return Dt+wt;for(;Dt.length<6;)Dt="0"+Dt;wt=""+Dt+wt}},Ge.getHighBits=function(){return this.high},Ge.getHighBitsUnsigned=function(){return this.high>>>0},Ge.getLowBits=function(){return this.low},Ge.getLowBitsUnsigned=function(){return this.low>>>0},Ge.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Pe)?64:this.neg().getNumBitsAbs();for(var Ae=0!=this.high?this.high:this.low,Xe=31;Xe>0&&!(Ae&1<<Xe);Xe--);return 0!=this.high?Xe+33:Xe+1},Ge.isZero=function(){return 0===this.high&&0===this.low},Ge.isNegative=function(){return!this.unsigned&&this.high<0},Ge.isPositive=function(){return this.unsigned||this.high>=0},Ge.isOdd=function(){return 1==(1&this.low)},Ge.isEven=function(){return 0==(1&this.low)},Ge.equals=function(Ae){return D(Ae)||(Ae=fe(Ae)),(this.unsigned===Ae.unsigned||this.high>>>31!=1||Ae.high>>>31!=1)&&this.high===Ae.high&&this.low===Ae.low},Ge.eq=Ge.equals,Ge.notEquals=function(Ae){return!this.eq(Ae)},Ge.neq=Ge.notEquals,Ge.lessThan=function(Ae){return this.comp(Ae)<0},Ge.lt=Ge.lessThan,Ge.lessThanOrEqual=function(Ae){return this.comp(Ae)<=0},Ge.lte=Ge.lessThanOrEqual,Ge.greaterThan=function(Ae){return this.comp(Ae)>0},Ge.gt=Ge.greaterThan,Ge.greaterThanOrEqual=function(Ae){return this.comp(Ae)>=0},Ge.gte=Ge.greaterThanOrEqual,Ge.compare=function(Ae){if(D(Ae)||(Ae=fe(Ae)),this.eq(Ae))return 0;var Xe=this.isNegative(),Ke=Ae.isNegative();return Xe&&!Ke?-1:!Xe&&Ke?1:this.unsigned?Ae.high>>>0>this.high>>>0||Ae.high===this.high&&Ae.low>>>0>this.low>>>0?-1:1:this.sub(Ae).isNegative()?-1:1},Ge.comp=Ge.compare,Ge.negate=function(){return!this.unsigned&&this.eq(Pe)?Pe:this.not().add(oe)},Ge.neg=Ge.negate,Ge.add=function(Ae){D(Ae)||(Ae=fe(Ae));var Dt=0,sn=0,gt=0,Mn=0;return gt+=(Mn+=(65535&this.low)+(65535&Ae.low))>>>16,sn+=(gt+=(this.low>>>16)+(Ae.low>>>16))>>>16,Dt+=(sn+=(65535&this.high)+(65535&Ae.high))>>>16,Dt+=(this.high>>>16)+(Ae.high>>>16),ye((gt&=65535)<<16|(Mn&=65535),(Dt&=65535)<<16|(sn&=65535),this.unsigned)},Ge.subtract=function(Ae){return D(Ae)||(Ae=fe(Ae)),this.add(Ae.neg())},Ge.sub=Ge.subtract,Ge.multiply=function(Ae){if(this.isZero()||(D(Ae)||(Ae=fe(Ae)),Ae.isZero()))return N;if(this.eq(Pe))return Ae.isOdd()?Pe:N;if(Ae.eq(Pe))return this.isOdd()?Pe:N;if(this.isNegative())return Ae.isNegative()?this.neg().mul(Ae.neg()):this.neg().mul(Ae).neg();if(Ae.isNegative())return this.mul(Ae.neg()).neg();if(this.lt(A)&&Ae.lt(A))return de(this.toNumber()*Ae.toNumber(),this.unsigned);var Ke=65535&this.high,yt=this.low>>>16,dt=65535&this.low,wt=65535&Ae.high,Gt=Ae.low>>>16,Dt=65535&Ae.low,sn=0,gt=0,Mn=0,Bn=0;return Mn+=(Bn+=dt*Dt)>>>16,gt+=(Mn+=yt*Dt)>>>16,Mn&=65535,gt+=(Mn+=dt*Gt)>>>16,sn+=(gt+=Ke*Dt)>>>16,gt&=65535,sn+=(gt+=yt*Gt)>>>16,gt&=65535,sn+=(gt+=dt*wt)>>>16,sn+=(this.high>>>16)*Dt+Ke*Gt+yt*wt+dt*(Ae.high>>>16),ye((Mn&=65535)<<16|(Bn&=65535),(sn&=65535)<<16|(gt&=65535),this.unsigned)},Ge.mul=Ge.multiply,Ge.divide=function(Ae){if(D(Ae)||(Ae=fe(Ae)),Ae.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?X:N;var Xe,Ke,yt;if(this.unsigned){if(Ae.unsigned||(Ae=Ae.toUnsigned()),Ae.gt(this))return X;if(Ae.gt(this.shru(1)))return H;yt=X}else{if(this.eq(Pe))return Ae.eq(oe)||Ae.eq(Ce)?Pe:Ae.eq(Pe)?oe:(Xe=this.shr(1).div(Ae).shl(1)).eq(N)?Ae.isNegative()?oe:Ce:(Ke=this.sub(Ae.mul(Xe)),yt=Xe.add(Ke.div(Ae)));if(Ae.eq(Pe))return this.unsigned?X:N;if(this.isNegative())return Ae.isNegative()?this.neg().div(Ae.neg()):this.neg().div(Ae).neg();if(Ae.isNegative())return this.div(Ae.neg()).neg();yt=N}for(Ke=this;Ke.gte(Ae);){Xe=Math.max(1,Math.floor(Ke.toNumber()/Ae.toNumber()));for(var dt=Math.ceil(Math.log(Xe)/Math.LN2),Pt=dt<=48?1:he(2,dt-48),wt=de(Xe),Gt=wt.mul(Ae);Gt.isNegative()||Gt.gt(Ke);)Gt=(wt=de(Xe-=Pt,this.unsigned)).mul(Ae);wt.isZero()&&(wt=oe),yt=yt.add(wt),Ke=Ke.sub(Gt)}return yt},Ge.div=Ge.divide,Ge.modulo=function(Ae){return D(Ae)||(Ae=fe(Ae)),this.sub(this.div(Ae).mul(Ae))},Ge.mod=Ge.modulo,Ge.not=function(){return ye(~this.low,~this.high,this.unsigned)},Ge.and=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low&Ae.low,this.high&Ae.high,this.unsigned)},Ge.or=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low|Ae.low,this.high|Ae.high,this.unsigned)},Ge.xor=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low^Ae.low,this.high^Ae.high,this.unsigned)},Ge.shiftLeft=function(Ae){return D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63)?this:Ae<32?ye(this.low<<Ae,this.high<<Ae|this.low>>>32-Ae,this.unsigned):ye(0,this.low<<Ae-32,this.unsigned)},Ge.shl=Ge.shiftLeft,Ge.shiftRight=function(Ae){return D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63)?this:Ae<32?ye(this.low>>>Ae|this.high<<32-Ae,this.high>>Ae,this.unsigned):ye(this.high>>Ae-32,this.high>=0?0:-1,this.unsigned)},Ge.shr=Ge.shiftRight,Ge.shiftRightUnsigned=function(Ae){if(D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63))return this;var Xe=this.high;return Ae<32?ye(this.low>>>Ae|Xe<<32-Ae,Xe>>>Ae,this.unsigned):ye(32===Ae?Xe:Xe>>>Ae-32,0,this.unsigned)},Ge.shru=Ge.shiftRightUnsigned,Ge.toSigned=function(){return this.unsigned?ye(this.low,this.high,!1):this},Ge.toUnsigned=function(){return this.unsigned?this:ye(this.low,this.high,!0)},Ge.toBytes=function(Ae){return Ae?this.toBytesLE():this.toBytesBE()},Ge.toBytesLE=function(){var Ae=this.high,Xe=this.low;return[255&Xe,Xe>>>8&255,Xe>>>16&255,Xe>>>24&255,255&Ae,Ae>>>8&255,Ae>>>16&255,Ae>>>24&255]},Ge.toBytesBE=function(){var Ae=this.high,Xe=this.low;return[Ae>>>24&255,Ae>>>16&255,Ae>>>8&255,255&Ae,Xe>>>24&255,Xe>>>16&255,Xe>>>8&255,255&Xe]},L})?l.apply(o,[]):l)||(n.exports=x)},166:(n,o,l)=>{var x=l(690),L=l(561),D=l(809),z=[0,2,3],M=[2,1,3];n.exports=function(P,de){P&&(L(P)||D(P))||(de=P||{},P=null);for(var ye="string"==typeof(de="number"==typeof de?{count:de}:de||{}).type?de.type:"uint16",ae=de.start||0,fe=!1!==de.clockwise?z:M,le=fe[0],q=fe[1],Y=fe[2],A=6*("number"==typeof de.count?de.count:1),N=P||new(x(ye))(A),X=0,oe=0;X<A;X+=6,oe+=4){var H=X+ae;N[H+0]=oe+0,N[H+1]=oe+1,N[H+2]=oe+2,N[H+3]=oe+le,N[H+4]=oe+q,N[H+5]=oe+Y}return N}},573:(n,o,l)=>{var x=l(412),L=l(190),D=l(87),z=l(166),M=l(991),P=l(47),de=x.BufferGeometry;function ye(he){de.call(this),"string"==typeof he&&(he={text:he}),this._opt=Object.assign({},he),he&&this.update(he)}n.exports=function(he){return new ye(he)},D(ye,de),ye.prototype.update=function(he){if("string"==typeof he&&(he={text:he}),!(he=Object.assign({},this._opt,he)).font)throw new TypeError("must specify a { font } in options");this.layout=L(he);var ae=!1!==he.flipY,fe=he.font,le=fe.common.scaleW,q=fe.common.scaleH,Y=this.layout.glyphs.filter(function(H){var Ce=H.data;return Ce.width*Ce.height>0});this.visibleGlyphs=Y;var A=M.positions(Y),N=M.uvs(Y,le,q,ae),X=z([],{clockwise:!0,type:"uint16",count:Y.length});if(this.setIndex(X),this.setAttribute("position",new x.BufferAttribute(A,2)),this.setAttribute("uv",new x.BufferAttribute(N,2)),!he.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(he.multipage){var oe=M.pages(Y);this.setAttribute("page",new x.BufferAttribute(oe,1))}},ye.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new x.Sphere);var he=this.attributes.position.array;if(!he||!this.attributes.position.itemSize||he.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);P.computeSphere(he,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},ye.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new x.Box3);var he=this.boundingBox,ae=this.attributes.position.array;!ae||!this.attributes.position.itemSize||ae.length<2?he.makeEmpty():P.computeBox(ae,he)}},47:n=>{var o=2,l={min:[0,0],max:[0,0]};function x(L){var D=L.length/o;l.min[0]=L[0],l.min[1]=L[1],l.max[0]=L[0],l.max[1]=L[1];for(var z=0;z<D;z++){var M=L[z*o+0],P=L[z*o+1];l.min[0]=Math.min(M,l.min[0]),l.min[1]=Math.min(P,l.min[1]),l.max[0]=Math.max(M,l.max[0]),l.max[1]=Math.max(P,l.max[1])}}n.exports.computeBox=function(L,D){x(L),D.min.set(l.min[0],l.min[1],0),D.max.set(l.max[0],l.max[1],0)},n.exports.computeSphere=function(L,D){x(L);var z=l.min[0],M=l.min[1],P=l.max[0]-z,de=l.max[1]-M,ye=Math.sqrt(P*P+de*de);D.center.set(z+P/2,M+de/2,0),D.radius=ye/2}},991:n=>{n.exports.pages=function(o){var l=new Float32Array(4*o.length*1),x=0;return o.forEach(function(L){var D=L.data.page||0;l[x++]=D,l[x++]=D,l[x++]=D,l[x++]=D}),l},n.exports.uvs=function(o,l,x,L){var D=new Float32Array(4*o.length*2),z=0;return o.forEach(function(M){var P=M.data,ye=P.y+P.height,he=P.x/l,ae=P.y/x,fe=(P.x+P.width)/l,le=ye/x;L&&(ae=(x-P.y)/x,le=(x-ye)/x),D[z++]=he,D[z++]=ae,D[z++]=he,D[z++]=le,D[z++]=fe,D[z++]=le,D[z++]=fe,D[z++]=ae}),D},n.exports.positions=function(o){var l=new Float32Array(4*o.length*2),x=0;return o.forEach(function(L){var D=L.data,z=L.position[0]+D.xoffset,M=L.position[1]+D.yoffset,P=D.width,de=D.height;l[x++]=z,l[x++]=M,l[x++]=z,l[x++]=M+de,l[x++]=z+P,l[x++]=M+de,l[x++]=z+P,l[x++]=M}),l}},412:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>ei,AddEquation:()=>Pe,AddOperation:()=>rr,AdditiveAnimationBlendMode:()=>th,AdditiveBlending:()=>H,AlphaFormat:()=>dp,AlwaysDepth:()=>Ln,AlwaysStencilFunc:()=>da,AmbientLight:()=>$t,AmbientLightProbe:()=>Up,AnimationClip:()=>ls,AnimationLoader:()=>ed,AnimationMixer:()=>um,AnimationObjectGroup:()=>cm,AnimationUtils:()=>ao,ArcCurve:()=>r,ArrayCamera:()=>md,ArrowHelper:()=>mh,Audio:()=>Jd,AudioAnalyser:()=>lm,AudioContext:()=>Hl,AudioListener:()=>If,AudioLoader:()=>ap,AxesHelper:()=>Sf,AxisHelper:()=>z_,BackSide:()=>q,BasicDepthPacking:()=>W,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>W_,Bone:()=>Cu,BooleanKeyframeTrack:()=>Kp,BoundingBoxHelper:()=>j_,Box2:()=>Xm,Box3:()=>fn,Box3Helper:()=>wf,BoxBufferGeometry:()=>lh,BoxGeometry:()=>Bs,BoxHelper:()=>$d,BufferAttribute:()=>Vr,BufferGeometry:()=>hn,BufferGeometryLoader:()=>Yn,ByteType:()=>Wl,Cache:()=>Ss,Camera:()=>Ai,CameraHelper:()=>Ad,CanvasRenderer:()=>Y_,CanvasTexture:()=>iu,CatmullRomCurve3:()=>O,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>Du,CircleGeometry:()=>Ph,ClampToEdgeWrapping:()=>Jr,Clock:()=>fh,ClosedSplineCurve3:()=>w_,Color:()=>ar,ColorKeyframeTrack:()=>wl,CompressedTexture:()=>uc,CompressedTextureLoader:()=>td,ConeBufferGeometry:()=>Qp,ConeGeometry:()=>Gi,CubeCamera:()=>Po,CubeGeometry:()=>Bs,CubeReflectionMapping:()=>Ei,CubeRefractionMapping:()=>So,CubeTexture:()=>ea,CubeTextureLoader:()=>sp,CubeUVReflectionMapping:()=>Ni,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>ie,CubicBezierCurve3:()=>ne,CubicInterpolant:()=>xl,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>z,Curve:()=>xr,CurvePath:()=>Fe,CustomBlending:()=>xe,CustomToneMapping:()=>Wr,CylinderBufferGeometry:()=>Do,CylinderGeometry:()=>Pn,Cylindrical:()=>Td,DataTexture:()=>gl,DataTexture2DArray:()=>vs,DataTexture3D:()=>ya,DataTextureLoader:()=>ja,DecrementStencilOp:()=>Bt,DecrementWrapStencilOp:()=>pn,DefaultLoadingManager:()=>Yd,DepthFormat:()=>To,DepthStencilFormat:()=>Zs,DepthTexture:()=>Bu,DirectionalLight:()=>ft,DirectionalLightHelper:()=>Qd,DirectionalLightShadow:()=>Nt,DiscreteInterpolant:()=>za,DodecahedronBufferGeometry:()=>zl,DodecahedronGeometry:()=>Ul,DoubleSide:()=>Y,DstAlphaFactor:()=>sn,DstColorFactor:()=>Mn,DynamicBufferAttribute:()=>x_,DynamicCopyUsage:()=>fa,DynamicDrawUsage:()=>Br,DynamicReadUsage:()=>qi,EdgesGeometry:()=>Rh,EdgesHelper:()=>G_,EllipseCurve:()=>a,EqualDepth:()=>ir,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Xs,EquirectangularRefractionMapping:()=>ua,Euler:()=>ht,EventDispatcher:()=>ma,ExtrudeBufferGeometry:()=>rl,ExtrudeGeometry:()=>su,Face3:()=>ga,Face4:()=>g_,FaceColors:()=>$_,FileLoader:()=>Es,FlatShading:()=>A,Float32Attribute:()=>D_,Float32BufferAttribute:()=>Un,Float64Attribute:()=>U_,Float64BufferAttribute:()=>Nl,FloatType:()=>Xo,Fog:()=>Xp,FogExp2:()=>hf,Font:()=>Ws,FontLoader:()=>ks,FrontSide:()=>le,Frustum:()=>eu,GammaEncoding:()=>Ql,Geometry:()=>Fr,GeometryUtils:()=>X_,GreaterDepth:()=>or,GreaterEqualDepth:()=>ur,GreaterEqualStencilFunc:()=>es,GreaterStencilFunc:()=>Ar,GridHelper:()=>Df,Group:()=>wa,HalfFloatType:()=>ps,HemisphereLight:()=>pt,HemisphereLightHelper:()=>xf,HemisphereLightProbe:()=>lp,IcosahedronBufferGeometry:()=>Sa,IcosahedronGeometry:()=>Dl,ImageBitmapLoader:()=>Uo,ImageLoader:()=>pu,ImageUtils:()=>Qi,ImmediateRenderObject:()=>pp,IncrementStencilOp:()=>At,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>pr,InstancedBufferGeometry:()=>jn,InstancedInterleavedBuffer:()=>hm,InstancedMesh:()=>Zo,Int16Attribute:()=>I_,Int16BufferAttribute:()=>Zh,Int32Attribute:()=>k_,Int32BufferAttribute:()=>er,Int8Attribute:()=>N_,Int8BufferAttribute:()=>dl,IntType:()=>Hp,InterleavedBuffer:()=>Oa,InterleavedBufferAttribute:()=>Lh,Interpolant:()=>Ta,InterpolateDiscrete:()=>Jl,InterpolateLinear:()=>Zl,InterpolateSmooth:()=>Ku,InvertStencilOp:()=>Fn,JSONLoader:()=>J_,KeepStencilOp:()=>qe,KeyframeTrack:()=>as,LOD:()=>Op,LatheBufferGeometry:()=>Fu,LatheGeometry:()=>Ua,Layers:()=>bu,LensFlare:()=>Q_,LessDepth:()=>mn,LessEqualDepth:()=>cr,LessEqualStencilFunc:()=>ti,LessStencilFunc:()=>xn,Light:()=>Je,LightProbe:()=>$n,LightShadow:()=>at,Line:()=>Gs,Line3:()=>Ff,LineBasicMaterial:()=>$o,LineCurve:()=>ve,LineCurve3:()=>be,LineDashedMaterial:()=>Ea,LineLoop:()=>Jp,LinePieces:()=>Mm,LineSegments:()=>Ii,LineStrip:()=>A_,LinearEncoding:()=>Zi,LinearFilter:()=>ai,LinearInterpolant:()=>uu,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>kh,LinearMipmapLinearFilter:()=>sl,LinearMipmapNearestFilter:()=>Gc,LinearToneMapping:()=>mi,Loader:()=>Ti,LoaderUtils:()=>lr,LoadingManager:()=>Xd,LogLuvEncoding:()=>Wh,LoopOnce:()=>gu,LoopPingPong:()=>bc,LoopRepeat:()=>qa,LuminanceAlphaFormat:()=>Wu,LuminanceFormat:()=>Vc,MOUSE:()=>L,Material:()=>zr,MaterialLoader:()=>Qn,Math:()=>tr,MathUtils:()=>tr,Matrix3:()=>Ho,Matrix4:()=>ri,MaxEquation:()=>Ke,Mesh:()=>Ci,MeshBasicMaterial:()=>eo,MeshDepthMaterial:()=>np,MeshDistanceMaterial:()=>ta,MeshFaceMaterial:()=>Am,MeshLambertMaterial:()=>qo,MeshMatcapMaterial:()=>rs,MeshNormalMaterial:()=>ho,MeshPhongMaterial:()=>Ko,MeshPhysicalMaterial:()=>so,MeshStandardMaterial:()=>yl,MeshToonMaterial:()=>ws,MinEquation:()=>Xe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>v_,MultiplyBlending:()=>Q,MultiplyOperation:()=>Kr,NearestFilter:()=>Ir,NearestMipMapLinearFilter:()=>Ys,NearestMipMapNearestFilter:()=>Hu,NearestMipmapLinearFilter:()=>hs,NearestMipmapNearestFilter:()=>Va,NeverDepth:()=>On,NeverStencilFunc:()=>on,NoBlending:()=>X,NoColors:()=>Aa,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>eh,NormalBlending:()=>oe,NotEqualDepth:()=>ni,NotEqualStencilFunc:()=>fs,NumberKeyframeTrack:()=>Gl,Object3D:()=>Kn,ObjectLoader:()=>Or,ObjectSpaceNormalMap:()=>Ne,OctahedronBufferGeometry:()=>Hs,OctahedronGeometry:()=>Bh,OneFactor:()=>dt,OneMinusDstAlphaFactor:()=>gt,OneMinusDstColorFactor:()=>Bn,OneMinusSrcAlphaFactor:()=>Dt,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>It,PCFShadowMap:()=>he,PCFSoftShadowMap:()=>ae,PMREMGenerator:()=>Em,ParametricBufferGeometry:()=>Fc,ParametricGeometry:()=>hh,Particle:()=>L_,ParticleBasicMaterial:()=>r_,ParticleSystem:()=>y_,ParticleSystemMaterial:()=>B_,Path:()=>je,PerspectiveCamera:()=>Rs,Plane:()=>Yo,PlaneBufferGeometry:()=>Il,PlaneGeometry:()=>Ka,PlaneHelper:()=>Kd,PointCloud:()=>C_,PointCloudMaterial:()=>$m,PointLight:()=>jt,PointLightHelper:()=>bf,Points:()=>kc,PointsMaterial:()=>kl,PolarGridHelper:()=>gm,PolyhedronBufferGeometry:()=>xs,PolyhedronGeometry:()=>Nu,PositionalAudio:()=>Zd,PropertyBinding:()=>Sl,PropertyMixer:()=>vf,QuadraticBezierCurve:()=>Te,QuadraticBezierCurve3:()=>Le,Quaternion:()=>yo,QuaternionKeyframeTrack:()=>po,QuaternionLinearInterpolant:()=>Uu,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>lo,RGBAIntegerFormat:()=>yh,RGBA_ASTC_10x10_Format:()=>ul,RGBA_ASTC_10x5_Format:()=>Ju,RGBA_ASTC_10x6_Format:()=>cl,RGBA_ASTC_10x8_Format:()=>zh,RGBA_ASTC_12x10_Format:()=>jh,RGBA_ASTC_12x12_Format:()=>Zu,RGBA_ASTC_4x4_Format:()=>Xu,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>Wc,RGBA_ASTC_6x6_Format:()=>_c,RGBA_ASTC_8x5_Format:()=>xh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Yu,RGBA_BPTC_Format:()=>vc,RGBA_ETC2_EAC_Format:()=>Xl,RGBA_PVRTC_2BPPV1_Format:()=>ql,RGBA_PVRTC_4BPPV1_Format:()=>Ml,RGBA_S3TC_DXT1_Format:()=>mc,RGBA_S3TC_DXT3_Format:()=>Dh,RGBA_S3TC_DXT5_Format:()=>bh,RGBDEncoding:()=>vu,RGBEEncoding:()=>Yc,RGBEFormat:()=>vh,RGBFormat:()=>Fs,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>nh,RGBM7Encoding:()=>xc,RGB_ETC1_Format:()=>qu,RGB_ETC2_Format:()=>ds,RGB_PVRTC_2BPPV1_Format:()=>Tl,RGB_PVRTC_4BPPV1_Format:()=>Uh,RGB_S3TC_DXT1_Format:()=>Fh,RGFormat:()=>mu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>oa,Ray:()=>co,Raycaster:()=>pm,RectAreaLight:()=>Zt,RedFormat:()=>Vp,RedIntegerFormat:()=>ll,ReinhardToneMapping:()=>go,RepeatWrapping:()=>vo,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Ae,RingBufferGeometry:()=>lu,RingGeometry:()=>ku,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Gh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Hh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>yc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>wh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>_u,SRGB8_ALPHA8_ASTC_6x5_Format:()=>qc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Xc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Qu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Yl,Scene:()=>Cl,SceneUtils:()=>Z_,ShaderChunk:()=>Dr,ShaderLib:()=>Nc,ShaderMaterial:()=>uo,ShadowMaterial:()=>Ki,Shape:()=>Ue,ShapeBufferGeometry:()=>Xn,ShapeGeometry:()=>cu,ShapePath:()=>cs,ShapeUtils:()=>Iu,ShortType:()=>Wa,Skeleton:()=>mf,SkeletonHelper:()=>od,SkinnedMesh:()=>ff,SmoothShading:()=>N,Sphere:()=>Gn,SphereBufferGeometry:()=>Ou,SphereGeometry:()=>Yr,Spherical:()=>p_,SphericalHarmonics3:()=>Tn,Spline:()=>i_,SplineCurve:()=>Ie,SplineCurve3:()=>S_,SpotLight:()=>Tt,SpotLightHelper:()=>yf,SpotLightShadow:()=>Mt,Sprite:()=>nl,SpriteMaterial:()=>_i,SrcAlphaFactor:()=>Gt,SrcAlphaSaturateFactor:()=>dn,SrcColorFactor:()=>Pt,StaticCopyUsage:()=>wc,StaticDrawUsage:()=>bi,StaticReadUsage:()=>Wi,StereoCamera:()=>up,StreamCopyUsage:()=>pl,StreamDrawUsage:()=>Xa,StreamReadUsage:()=>qh,StringKeyframeTrack:()=>dh,SubtractEquation:()=>Ge,SubtractiveBlending:()=>Ce,TOUCH:()=>D,TangentSpaceNormalMap:()=>Me,TetrahedronBufferGeometry:()=>ph,TetrahedronGeometry:()=>Ru,TextBufferGeometry:()=>Mr,TextGeometry:()=>to,Texture:()=>di,TextureLoader:()=>vi,TorusBufferGeometry:()=>ou,TorusGeometry:()=>rp,TorusKnotBufferGeometry:()=>Co,TorusKnotGeometry:()=>Nh,Triangle:()=>Pr,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Vh,TubeBufferGeometry:()=>Os,TubeGeometry:()=>jl,UVMapping:()=>yi,Uint16Attribute:()=>O_,Uint16BufferAttribute:()=>Bl,Uint32Attribute:()=>F_,Uint32BufferAttribute:()=>fl,Uint8Attribute:()=>R_,Uint8BufferAttribute:()=>Cc,Uint8ClampedAttribute:()=>P_,Uint8ClampedBufferAttribute:()=>ih,Uniform:()=>kf,UniformsLib:()=>hr,UniformsUtils:()=>Ro,UnsignedByteType:()=>ha,UnsignedInt248Type:()=>Ms,UnsignedIntType:()=>Js,UnsignedShort4444Type:()=>Vu,UnsignedShort5551Type:()=>du,UnsignedShort565Type:()=>fu,UnsignedShortType:()=>Hc,VSMShadowMap:()=>fe,Vector2:()=>wn,Vector3:()=>lt,Vector4:()=>xi,VectorKeyframeTrack:()=>hu,Vertex:()=>b_,VertexColors:()=>Ha,VideoTexture:()=>xd,WebGL1Renderer:()=>uf,WebGLCubeRenderTarget:()=>Pl,WebGLMultisampleRenderTarget:()=>Xh,WebGLRenderTarget:()=>Us,WebGLRenderTargetCube:()=>q_,WebGLRenderer:()=>_d,WebGLUtils:()=>zd,WireframeGeometry:()=>hc,WireframeHelper:()=>H_,WrapAroundEnding:()=>Al,XHRLoader:()=>V_,ZeroCurvatureEnding:()=>La,ZeroFactor:()=>yt,ZeroSlopeEnding:()=>pa,ZeroStencilOp:()=>Ve,sRGBEncoding:()=>hl}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const u=Object(t);for(let m=1;m<arguments.length;m++){const g=arguments[m];if(null!=g)for(const E in g)Object.prototype.hasOwnProperty.call(g,E)&&(u[E]=g[E])}return u});const x="119",L={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},z=0,M=1,P=2,de=3,ye=0,he=1,ae=2,fe=3,le=0,q=1,Y=2,A=1,N=2,X=0,oe=1,H=2,Ce=3,Q=4,xe=5,Pe=100,Ge=101,Ae=102,Xe=103,Ke=104,yt=200,dt=201,Pt=202,wt=203,Gt=204,Dt=205,sn=206,gt=207,Mn=208,Bn=209,dn=210,On=0,Ln=1,mn=2,cr=3,ir=4,ur=5,or=6,ni=7,Kr=0,pi=1,rr=2,vr=0,mi=1,go=2,Nr=3,ei=4,Wr=5,yi=300,Ei=301,So=302,Xs=303,ua=304,Ni=306,Eo=307,vo=1e3,Jr=1001,os=1002,Ir=1003,Va=1004,Hu=1004,hs=1005,Ys=1005,ai=1006,Gc=1007,kh=1007,sl=1008,Gp=1008,ha=1009,Wl=1010,Wa=1011,Hc=1012,Hp=1013,Js=1014,Xo=1015,ps=1016,Vu=1017,du=1018,fu=1019,Ms=1020,dp=1021,Fs=1022,lo=1023,Vc=1024,Wu=1025,vh=lo,To=1026,Zs=1027,Vp=1028,ll=1029,mu=1030,fp=1031,mp=1032,yh=1033,Fh=33776,mc=33777,Dh=33778,bh=33779,Uh=35840,Tl=35841,Ml=35842,ql=35843,qu=36196,ds=37492,Xl=37496,Xu=37808,_p=37809,gp=37810,Wc=37811,_c=37812,xh=37813,vp=37814,Yu=37815,Ju=37816,cl=37817,zh=37818,ul=37819,jh=37820,Zu=37821,vc=36492,yc=37840,wh=37841,_u=37842,qc=37843,yp=37844,Xc=37845,Qu=37846,Yl=37847,bp=37848,Gh=37849,xp=37850,wp=37851,Hh=37852,Wp=37853,gu=2200,qa=2201,bc=2202,Jl=2300,Zl=2301,Ku=2302,La=2400,pa=2401,Al=2402,eh=2500,th=2501,Vh=0,Sp=1,Ep=2,Zi=3e3,hl=3001,Ql=3007,Yc=3002,Wh=3003,xc=3004,nh=3005,vu=3006,W=3200,pe=3201,Me=0,Ne=1,Ve=0,qe=7680,et=7681,At=7682,Bt=7683,Xt=34055,pn=34056,Fn=5386,on=512,xn=513,Er=514,ti=515,Ar=516,fs=517,es=518,da=519,bi=35044,Br=35048,Xa=35040,Wi=35045,qi=35049,qh=35041,wc=35046,fa=35050,pl=35042;function ma(){}Object.assign(ma.prototype,{addEventListener:function(t,u){void 0===this._listeners&&(this._listeners={});const m=this._listeners;void 0===m[t]&&(m[t]=[]),-1===m[t].indexOf(u)&&m[t].push(u)},hasEventListener:function(t,u){if(void 0===this._listeners)return!1;const m=this._listeners;return void 0!==m[t]&&-1!==m[t].indexOf(u)},removeEventListener:function(t,u){if(void 0===this._listeners)return;const m=this._listeners[t];if(void 0!==m){const g=m.indexOf(u);-1!==g&&m.splice(g,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const u=this._listeners[t.type];if(void 0!==u){t.target=this;const m=u.slice(0);for(let g=0,E=m.length;g<E;g++)m[g].call(this,t)}}});const Ri=[];for(let t=0;t<256;t++)Ri[t]=(t<16?"0":"")+t.toString(16);let Ds=1234567;const tr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,u=4294967295*Math.random()|0,m=4294967295*Math.random()|0,g=4294967295*Math.random()|0;return(Ri[255&t]+Ri[t>>8&255]+Ri[t>>16&255]+Ri[t>>24&255]+"-"+Ri[255&u]+Ri[u>>8&255]+"-"+Ri[u>>16&15|64]+Ri[u>>24&255]+"-"+Ri[63&m|128]+Ri[m>>8&255]+"-"+Ri[m>>16&255]+Ri[m>>24&255]+Ri[255&g]+Ri[g>>8&255]+Ri[g>>16&255]+Ri[g>>24&255]).toUpperCase()},clamp:function(t,u,m){return Math.max(u,Math.min(m,t))},euclideanModulo:function(t,u){return(t%u+u)%u},mapLinear:function(t,u,m,g,E){return g+(t-u)*(E-g)/(m-u)},lerp:function(t,u,m){return(1-m)*t+m*u},smoothstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*(3-2*t)},smootherstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*t*(t*(6*t-15)+10)},randInt:function(t,u){return t+Math.floor(Math.random()*(u-t+1))},randFloat:function(t,u){return t+Math.random()*(u-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(Ds=t%2147483647),Ds=16807*Ds%2147483647,(Ds-1)/2147483646},degToRad:function(t){return t*tr.DEG2RAD},radToDeg:function(t){return t*tr.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,u,m,g,E){const I=Math.cos,G=Math.sin,Z=I(m/2),J=G(m/2),K=I((u+g)/2),me=G((u+g)/2),ge=I((u-g)/2),Se=G((u-g)/2),w=I((g-u)/2),e=G((g-u)/2);switch(E){case"XYX":t.set(Z*me,J*ge,J*Se,Z*K);break;case"YZY":t.set(J*Se,Z*me,J*ge,Z*K);break;case"ZXZ":t.set(J*ge,J*Se,Z*me,Z*K);break;case"XZX":t.set(Z*me,J*e,J*w,Z*K);break;case"YXY":t.set(J*w,Z*me,J*e,Z*K);break;case"ZYZ":t.set(J*e,J*w,Z*me,Z*K);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+E)}}};function wn(t=0,u=0){this.x=t,this.y=u}function Ho(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let ss;Object.defineProperties(wn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(wn.prototype,{isVector2:!0,set:function(t,u){return this.x=t,this.y=u,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){const u=this.x,m=this.y,g=t.elements;return this.x=g[0]*u+g[3]*m+g[6],this.y=g[1]*u+g[4]*m+g[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y;return u*u+m*m},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this},rotateAround:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=this.x-t.x,I=this.y-t.y;return this.x=E*m-I*g+t.x,this.y=E*g+I*m+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Ho.prototype,{isMatrix3:!0,set:function(t,u,m,g,E,I,G,Z,J){const K=this.elements;return K[0]=t,K[1]=g,K[2]=G,K[3]=u,K[4]=E,K[5]=Z,K[6]=m,K[7]=I,K[8]=J,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],this},extractBasis:function(t,u,m){return t.setFromMatrix3Column(this,0),u.setFromMatrix3Column(this,1),m.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){const u=t.elements;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],G=m[3],Z=m[6],J=m[1],K=m[4],me=m[7],ge=m[2],Se=m[5],w=m[8],e=g[0],c=g[3],d=g[6],_=g[1],S=g[4],B=g[7],k=g[2],F=g[5],V=g[8];return E[0]=I*e+G*_+Z*k,E[3]=I*c+G*S+Z*F,E[6]=I*d+G*B+Z*V,E[1]=J*e+K*_+me*k,E[4]=J*c+K*S+me*F,E[7]=J*d+K*B+me*V,E[2]=ge*e+Se*_+w*k,E[5]=ge*c+Se*S+w*F,E[8]=ge*d+Se*B+w*V,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[3]*=t,u[6]*=t,u[1]*=t,u[4]*=t,u[7]*=t,u[2]*=t,u[5]*=t,u[8]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[1],g=t[2],E=t[3],I=t[4],G=t[5],Z=t[6],J=t[7],K=t[8];return u*I*K-u*G*J-m*E*K+m*G*Z+g*E*J-g*I*Z},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const m=t.elements,g=this.elements,E=m[0],I=m[1],G=m[2],Z=m[3],J=m[4],K=m[5],me=m[6],ge=m[7],Se=m[8],w=Se*J-K*ge,e=K*me-Se*Z,c=ge*Z-J*me,d=E*w+I*e+G*c;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const _=1/d;return g[0]=w*_,g[1]=(G*ge-Se*I)*_,g[2]=(K*I-G*J)*_,g[3]=e*_,g[4]=(Se*E-G*me)*_,g[5]=(G*Z-K*E)*_,g[6]=c*_,g[7]=(I*me-ge*E)*_,g[8]=(J*E-I*Z)*_,this},transpose:function(){let t;const u=this.elements;return t=u[1],u[1]=u[3],u[3]=t,t=u[2],u[2]=u[6],u[6]=t,t=u[5],u[5]=u[7],u[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){const u=this.elements;return t[0]=u[0],t[1]=u[3],t[2]=u[6],t[3]=u[1],t[4]=u[4],t[5]=u[7],t[6]=u[2],t[7]=u[5],t[8]=u[8],this},setUvTransform:function(t,u,m,g,E,I,G){const Z=Math.cos(E),J=Math.sin(E);this.set(m*Z,m*J,-m*(Z*I+J*G)+I+t,-g*J,g*Z,-g*(-J*I+Z*G)+G+u,0,0,1)},scale:function(t,u){const m=this.elements;return m[0]*=t,m[3]*=t,m[6]*=t,m[1]*=u,m[4]*=u,m[7]*=u,this},rotate:function(t){const u=Math.cos(t),m=Math.sin(t),g=this.elements,E=g[0],I=g[3],G=g[6],Z=g[1],J=g[4],K=g[7];return g[0]=u*E+m*Z,g[3]=u*I+m*J,g[6]=u*G+m*K,g[1]=-m*E+u*Z,g[4]=-m*I+u*J,g[7]=-m*G+u*K,this},translate:function(t,u){const m=this.elements;return m[0]+=t*m[2],m[3]+=t*m[5],m[6]+=t*m[8],m[1]+=u*m[2],m[4]+=u*m[5],m[7]+=u*m[8],this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<9;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<9;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t}});const Qi={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let u;if(t instanceof HTMLCanvasElement)u=t;else{void 0===ss&&(ss=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ss.width=t.width,ss.height=t.height;const m=ss.getContext("2d");t instanceof ImageData?m.putImageData(t,0,0):m.drawImage(t,0,0,t.width,t.height),u=ss}return u.width>2048||u.height>2048?u.toDataURL("image/jpeg",.6):u.toDataURL("image/png")}};let Hr=0;function di(t,u,m,g,E,I,G,Z,J,K){Object.defineProperty(this,"id",{value:Hr++}),this.uuid=tr.generateUUID(),this.name="",this.image=void 0!==t?t:di.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==u?u:di.DEFAULT_MAPPING,this.wrapS=void 0!==m?m:Jr,this.wrapT=void 0!==g?g:Jr,this.magFilter=void 0!==E?E:ai,this.minFilter=void 0!==I?I:sl,this.anisotropy=void 0!==J?J:1,this.format=void 0!==G?G:lo,this.internalFormat=null,this.type=void 0!==Z?Z:ha,this.offset=new wn(0,0),this.repeat=new wn(1,1),this.center=new wn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ho,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==K?K:Zi,this.version=0,this.onUpdate=null}function xi(t=0,u=0,m=0,g=1){this.x=t,this.y=u,this.z=m,this.w=g}function Us(t,u,m){this.width=t,this.height=u,this.scissor=new xi(0,0,t,u),this.scissorTest=!1,this.viewport=new xi(0,0,t,u),this.texture=new di(void 0,(m=m||{}).mapping,m.wrapS,m.wrapT,m.magFilter,m.minFilter,m.format,m.type,m.anisotropy,m.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=u,this.texture.generateMipmaps=void 0!==m.generateMipmaps&&m.generateMipmaps,this.texture.minFilter=void 0!==m.minFilter?m.minFilter:ai,this.depthBuffer=void 0===m.depthBuffer||m.depthBuffer,this.stencilBuffer=void 0===m.stencilBuffer||m.stencilBuffer,this.depthTexture=void 0!==m.depthTexture?m.depthTexture:null}function Xh(t,u,m){Us.call(this,t,u,m),this.samples=4}function yo(t=0,u=0,m=0,g=1){this._x=t,this._y=u,this._z=m,this._w=g}di.DEFAULT_IMAGE=void 0,di.DEFAULT_MAPPING=yi,di.prototype=Object.assign(Object.create(ma.prototype),{constructor:di,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const u=void 0===t||"string"==typeof t;if(!u&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const m={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const g=this.image;if(void 0===g.uuid&&(g.uuid=tr.generateUUID()),!u&&void 0===t.images[g.uuid]){let E;if(Array.isArray(g)){E=[];for(let I=0,G=g.length;I<G;I++)E.push(Qi.getDataURL(g[I]))}else E=Qi.getDataURL(g);t.images[g.uuid]={uuid:g.uuid,url:E}}m.image=g.uuid}return u||(t.textures[this.uuid]=m),m},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==yi)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case vo:t.x=t.x-Math.floor(t.x);break;case Jr:t.x=t.x<0?0:1;break;case os:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case vo:t.y=t.y-Math.floor(t.y);break;case Jr:t.y=t.y<0?0:1;break;case os:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(di.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(xi.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(xi.prototype,{isVector4:!0,set:function(t,u,m,g){return this.x=t,this.y=u,this.z=m,this.w=g,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this.w=t.w+u.w,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this.w+=t.w*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this.w=t.w-u.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=this.w,I=t.elements;return this.x=I[0]*u+I[4]*m+I[8]*g+I[12]*E,this.y=I[1]*u+I[5]*m+I[9]*g+I[13]*E,this.z=I[2]*u+I[6]*m+I[10]*g+I[14]*E,this.w=I[3]*u+I[7]*m+I[11]*g+I[15]*E,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);const u=Math.sqrt(1-t.w*t.w);return u<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/u,this.y=t.y/u,this.z=t.z/u),this},setAxisAngleFromRotationMatrix:function(t){let u,m,g,E;const Z=t.elements,J=Z[0],K=Z[4],me=Z[8],ge=Z[1],Se=Z[5],w=Z[9],e=Z[2],c=Z[6],d=Z[10];if(Math.abs(K-ge)<.01&&Math.abs(me-e)<.01&&Math.abs(w-c)<.01){if(Math.abs(K+ge)<.1&&Math.abs(me+e)<.1&&Math.abs(w+c)<.1&&Math.abs(J+Se+d-3)<.1)return this.set(1,0,0,0),this;u=Math.PI;const S=(J+1)/2,B=(Se+1)/2,k=(d+1)/2,F=(K+ge)/4,V=(me+e)/4,te=(w+c)/4;return S>B&&S>k?S<.01?(m=0,g=.707106781,E=.707106781):(m=Math.sqrt(S),g=F/m,E=V/m):B>k?B<.01?(m=.707106781,g=0,E=.707106781):(g=Math.sqrt(B),m=F/g,E=te/g):k<.01?(m=.707106781,g=.707106781,E=0):(E=Math.sqrt(k),m=V/E,g=te/E),this.set(m,g,E,u),this}let _=Math.sqrt((c-w)*(c-w)+(me-e)*(me-e)+(ge-K)*(ge-K));return Math.abs(_)<.001&&(_=1),this.x=(c-w)/_,this.y=(me-e)/_,this.z=(ge-K)/_,this.w=Math.acos((J+Se+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this.w=Math.max(t.w,Math.min(u.w,this.w)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this.w=Math.max(t,Math.min(u,this.w)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this.w+=(t.w-this.w)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this.w=t.w+(u.w-t.w)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this.w=t[u+3],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t[u+3]=this.w,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this.w=t.getW(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Us.prototype=Object.assign(Object.create(ma.prototype),{constructor:Us,isWebGLRenderTarget:!0,setSize:function(t,u){this.width===t&&this.height===u||(this.width=t,this.height=u,this.texture.image.width=t,this.texture.image.height=u,this.dispose()),this.viewport.set(0,0,t,u),this.scissor.set(0,0,t,u)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Xh.prototype=Object.assign(Object.create(Us.prototype),{constructor:Xh,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Us.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(yo,{slerp:function(t,u,m,g){return m.copy(t).slerp(u,g)},slerpFlat:function(t,u,m,g,E,I,G){let Z=m[g+0],J=m[g+1],K=m[g+2],me=m[g+3];const ge=E[I+0],Se=E[I+1],w=E[I+2],e=E[I+3];if(me!==e||Z!==ge||J!==Se||K!==w){let c=1-G,d=Z*ge+J*Se+K*w+me*e,_=d>=0?1:-1,S=1-d*d;if(S>Number.EPSILON){const k=Math.sqrt(S),F=Math.atan2(k,d*_);c=Math.sin(c*F)/k,G=Math.sin(G*F)/k}const B=G*_;if(Z=Z*c+ge*B,J=J*c+Se*B,K=K*c+w*B,me=me*c+e*B,c===1-G){const k=1/Math.sqrt(Z*Z+J*J+K*K+me*me);Z*=k,J*=k,K*=k,me*=k}}t[u]=Z,t[u+1]=J,t[u+2]=K,t[u+3]=me},multiplyQuaternionsFlat:function(t,u,m,g,E,I){const G=m[g],Z=m[g+1],J=m[g+2],K=m[g+3],me=E[I],ge=E[I+1],Se=E[I+2],w=E[I+3];return t[u]=G*w+K*me+Z*Se-J*ge,t[u+1]=Z*w+K*ge+J*me-G*Se,t[u+2]=J*w+K*Se+G*ge-Z*me,t[u+3]=K*w-G*me-Z*ge-J*Se,t}}),Object.defineProperties(yo.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(yo.prototype,{isQuaternion:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._w=g,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,u){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const m=t._x,g=t._y,E=t._z,I=t.order,G=Math.cos,Z=Math.sin,J=G(m/2),K=G(g/2),me=G(E/2),ge=Z(m/2),Se=Z(g/2),w=Z(E/2);switch(I){case"XYZ":this._x=ge*K*me+J*Se*w,this._y=J*Se*me-ge*K*w,this._z=J*K*w+ge*Se*me,this._w=J*K*me-ge*Se*w;break;case"YXZ":this._x=ge*K*me+J*Se*w,this._y=J*Se*me-ge*K*w,this._z=J*K*w-ge*Se*me,this._w=J*K*me+ge*Se*w;break;case"ZXY":this._x=ge*K*me-J*Se*w,this._y=J*Se*me+ge*K*w,this._z=J*K*w+ge*Se*me,this._w=J*K*me-ge*Se*w;break;case"ZYX":this._x=ge*K*me-J*Se*w,this._y=J*Se*me+ge*K*w,this._z=J*K*w-ge*Se*me,this._w=J*K*me+ge*Se*w;break;case"YZX":this._x=ge*K*me+J*Se*w,this._y=J*Se*me+ge*K*w,this._z=J*K*w-ge*Se*me,this._w=J*K*me-ge*Se*w;break;case"XZY":this._x=ge*K*me-J*Se*w,this._y=J*Se*me-ge*K*w,this._z=J*K*w+ge*Se*me,this._w=J*K*me+ge*Se*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+I)}return!1!==u&&this._onChangeCallback(),this},setFromAxisAngle:function(t,u){const m=u/2,g=Math.sin(m);return this._x=t.x*g,this._y=t.y*g,this._z=t.z*g,this._w=Math.cos(m),this._onChangeCallback(),this},setFromRotationMatrix:function(t){const u=t.elements,m=u[0],g=u[4],E=u[8],I=u[1],G=u[5],Z=u[9],J=u[2],K=u[6],me=u[10],ge=m+G+me;if(ge>0){const Se=.5/Math.sqrt(ge+1);this._w=.25/Se,this._x=(K-Z)*Se,this._y=(E-J)*Se,this._z=(I-g)*Se}else if(m>G&&m>me){const Se=2*Math.sqrt(1+m-G-me);this._w=(K-Z)/Se,this._x=.25*Se,this._y=(g+I)/Se,this._z=(E+J)/Se}else if(G>me){const Se=2*Math.sqrt(1+G-m-me);this._w=(E-J)/Se,this._x=(g+I)/Se,this._y=.25*Se,this._z=(Z+K)/Se}else{const Se=2*Math.sqrt(1+me-m-G);this._w=(I-g)/Se,this._x=(E+J)/Se,this._y=(Z+K)/Se,this._z=.25*Se}return this._onChangeCallback(),this},setFromUnitVectors:function(t,u){let m=t.dot(u)+1;return m<1e-6?(m=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=m):(this._x=0,this._y=-t.z,this._z=t.y,this._w=m)):(this._x=t.y*u.z-t.z*u.y,this._y=t.z*u.x-t.x*u.z,this._z=t.x*u.y-t.y*u.x,this._w=m),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(tr.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,u){const m=this.angleTo(t);if(0===m)return this;const g=Math.min(1,u/m);return this.slerp(t,g),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,u)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,u){const m=t._x,g=t._y,E=t._z,I=t._w,G=u._x,Z=u._y,J=u._z,K=u._w;return this._x=m*K+I*G+g*J-E*Z,this._y=g*K+I*Z+E*G-m*J,this._z=E*K+I*J+m*Z-g*G,this._w=I*K-m*G-g*Z-E*J,this._onChangeCallback(),this},slerp:function(t,u){if(0===u)return this;if(1===u)return this.copy(t);const m=this._x,g=this._y,E=this._z,I=this._w;let G=I*t._w+m*t._x+g*t._y+E*t._z;if(G<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,G=-G):this.copy(t),G>=1)return this._w=I,this._x=m,this._y=g,this._z=E,this;const Z=1-G*G;if(Z<=Number.EPSILON){const Se=1-u;return this._w=Se*I+u*this._w,this._x=Se*m+u*this._x,this._y=Se*g+u*this._y,this._z=Se*E+u*this._z,this.normalize(),this._onChangeCallback(),this}const J=Math.sqrt(Z),K=Math.atan2(J,G),me=Math.sin((1-u)*K)/J,ge=Math.sin(u*K)/J;return this._w=I*me+this._w*ge,this._x=m*me+this._x*ge,this._y=g*me+this._y*ge,this._z=E*me+this._z*ge,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,u){return void 0===u&&(u=0),this._x=t[u],this._y=t[u+1],this._z=t[u+2],this._w=t[u+3],this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._w,t},fromBufferAttribute:function(t,u){return this._x=t.getX(u),this._y=t.getY(u),this._z=t.getZ(u),this._w=t.getW(u),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});const yu=new lt,zn=new yo;function lt(t=0,u=0,m=0){this.x=t,this.y=u,this.z=m}Object.assign(lt.prototype,{isVector3:!0,set:function(t,u,m){return void 0===m&&(m=this.z),this.x=t,this.y=u,this.z=m,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,u)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,u){return this.x=t.x*u.x,this.y=t.y*u.y,this.z=t.z*u.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(zn.setFromEuler(t))},applyAxisAngle:function(t,u){return this.applyQuaternion(zn.setFromAxisAngle(t,u))},applyMatrix3:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[3]*m+E[6]*g,this.y=E[1]*u+E[4]*m+E[7]*g,this.z=E[2]*u+E[5]*m+E[8]*g,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements,I=1/(E[3]*u+E[7]*m+E[11]*g+E[15]);return this.x=(E[0]*u+E[4]*m+E[8]*g+E[12])*I,this.y=(E[1]*u+E[5]*m+E[9]*g+E[13])*I,this.z=(E[2]*u+E[6]*m+E[10]*g+E[14])*I,this},applyQuaternion:function(t){const u=this.x,m=this.y,g=this.z,E=t.x,I=t.y,G=t.z,Z=t.w,J=Z*u+I*g-G*m,K=Z*m+G*u-E*g,me=Z*g+E*m-I*u,ge=-E*u-I*m-G*g;return this.x=J*Z+ge*-E+K*-G-me*-I,this.y=K*Z+ge*-I+me*-E-J*-G,this.z=me*Z+ge*-G+J*-I-K*-E,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[4]*m+E[8]*g,this.y=E[1]*u+E[5]*m+E[9]*g,this.z=E[2]*u+E[6]*m+E[10]*g,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this},cross:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,u)):this.crossVectors(this,t)},crossVectors:function(t,u){const m=t.x,g=t.y,E=t.z,I=u.x,G=u.y,Z=u.z;return this.x=g*Z-E*G,this.y=E*I-m*Z,this.z=m*G-g*I,this},projectOnVector:function(t){const u=t.lengthSq();if(0===u)return this.set(0,0,0);const m=t.dot(this)/u;return this.copy(t).multiplyScalar(m)},projectOnPlane:function(t){return yu.copy(this).projectOnVector(t),this.sub(yu)},reflect:function(t){return this.sub(yu.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){const u=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===u)return Math.PI/2;const m=this.dot(t)/u;return Math.acos(tr.clamp(m,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y,g=this.z-t.z;return u*u+m*m+g*g},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,u,m){const g=Math.sin(u)*t;return this.x=g*Math.sin(m),this.y=Math.cos(u)*t,this.z=g*Math.cos(m),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,u,m){return this.x=t*Math.sin(u),this.y=m,this.z=t*Math.cos(u),this},setFromMatrixPosition:function(t){const u=t.elements;return this.x=u[12],this.y=u[13],this.z=u[14],this},setFromMatrixScale:function(t){const u=this.setFromMatrixColumn(t,0).length(),m=this.setFromMatrixColumn(t,1).length(),g=this.setFromMatrixColumn(t,2).length();return this.x=u,this.y=m,this.z=g,this},setFromMatrixColumn:function(t,u){return this.fromArray(t.elements,4*u)},setFromMatrix3Column:function(t,u){return this.fromArray(t.elements,3*u)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const $l=new lt,As=new ri,Tp=new lt(0,0,0),$s=new lt(1,1,1),Sc=new lt,Di=new lt,io=new lt;function ri(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ri.prototype,{isMatrix4:!0,set:function(t,u,m,g,E,I,G,Z,J,K,me,ge,Se,w,e,c){const d=this.elements;return d[0]=t,d[4]=u,d[8]=m,d[12]=g,d[1]=E,d[5]=I,d[9]=G,d[13]=Z,d[2]=J,d[6]=K,d[10]=me,d[14]=ge,d[3]=Se,d[7]=w,d[11]=e,d[15]=c,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ri).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],u[9]=m[9],u[10]=m[10],u[11]=m[11],u[12]=m[12],u[13]=m[13],u[14]=m[14],u[15]=m[15],this},copyPosition:function(t){const u=this.elements,m=t.elements;return u[12]=m[12],u[13]=m[13],u[14]=m[14],this},extractBasis:function(t,u,m){return t.setFromMatrixColumn(this,0),u.setFromMatrixColumn(this,1),m.setFromMatrixColumn(this,2),this},makeBasis:function(t,u,m){return this.set(t.x,u.x,m.x,0,t.y,u.y,m.y,0,t.z,u.z,m.z,0,0,0,0,1),this},extractRotation:function(t){const u=this.elements,m=t.elements,g=1/$l.setFromMatrixColumn(t,0).length(),E=1/$l.setFromMatrixColumn(t,1).length(),I=1/$l.setFromMatrixColumn(t,2).length();return u[0]=m[0]*g,u[1]=m[1]*g,u[2]=m[2]*g,u[3]=0,u[4]=m[4]*E,u[5]=m[5]*E,u[6]=m[6]*E,u[7]=0,u[8]=m[8]*I,u[9]=m[9]*I,u[10]=m[10]*I,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const u=this.elements,m=t.x,g=t.y,E=t.z,I=Math.cos(m),G=Math.sin(m),Z=Math.cos(g),J=Math.sin(g),K=Math.cos(E),me=Math.sin(E);if("XYZ"===t.order){const ge=I*K,Se=I*me,w=G*K,e=G*me;u[0]=Z*K,u[4]=-Z*me,u[8]=J,u[1]=Se+w*J,u[5]=ge-e*J,u[9]=-G*Z,u[2]=e-ge*J,u[6]=w+Se*J,u[10]=I*Z}else if("YXZ"===t.order){const ge=Z*K,Se=Z*me,w=J*K,e=J*me;u[0]=ge+e*G,u[4]=w*G-Se,u[8]=I*J,u[1]=I*me,u[5]=I*K,u[9]=-G,u[2]=Se*G-w,u[6]=e+ge*G,u[10]=I*Z}else if("ZXY"===t.order){const ge=Z*K,Se=Z*me,w=J*K,e=J*me;u[0]=ge-e*G,u[4]=-I*me,u[8]=w+Se*G,u[1]=Se+w*G,u[5]=I*K,u[9]=e-ge*G,u[2]=-I*J,u[6]=G,u[10]=I*Z}else if("ZYX"===t.order){const ge=I*K,Se=I*me,w=G*K,e=G*me;u[0]=Z*K,u[4]=w*J-Se,u[8]=ge*J+e,u[1]=Z*me,u[5]=e*J+ge,u[9]=Se*J-w,u[2]=-J,u[6]=G*Z,u[10]=I*Z}else if("YZX"===t.order){const ge=I*Z,Se=I*J,w=G*Z,e=G*J;u[0]=Z*K,u[4]=e-ge*me,u[8]=w*me+Se,u[1]=me,u[5]=I*K,u[9]=-G*K,u[2]=-J*K,u[6]=Se*me+w,u[10]=ge-e*me}else if("XZY"===t.order){const ge=I*Z,Se=I*J,w=G*Z,e=G*J;u[0]=Z*K,u[4]=-me,u[8]=J*K,u[1]=ge*me+e,u[5]=I*K,u[9]=Se*me-w,u[2]=w*me-Se,u[6]=G*K,u[10]=e*me+ge}return u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Tp,t,$s)},lookAt:function(t,u,m){const g=this.elements;return io.subVectors(t,u),0===io.lengthSq()&&(io.z=1),io.normalize(),Sc.crossVectors(m,io),0===Sc.lengthSq()&&(1===Math.abs(m.z)?io.x+=1e-4:io.z+=1e-4,io.normalize(),Sc.crossVectors(m,io)),Sc.normalize(),Di.crossVectors(io,Sc),g[0]=Sc.x,g[4]=Di.x,g[8]=io.x,g[1]=Sc.y,g[5]=Di.y,g[9]=io.y,g[2]=Sc.z,g[6]=Di.z,g[10]=io.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,u)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],G=m[4],Z=m[8],J=m[12],K=m[1],me=m[5],ge=m[9],Se=m[13],w=m[2],e=m[6],c=m[10],d=m[14],_=m[3],S=m[7],B=m[11],k=m[15],F=g[0],V=g[4],te=g[8],ce=g[12],ue=g[1],_e=g[5],Ee=g[9],$e=g[13],Be=g[2],Re=g[6],We=g[10],tt=g[14],Ze=g[3],ot=g[7],st=g[11],Ct=g[15];return E[0]=I*F+G*ue+Z*Be+J*Ze,E[4]=I*V+G*_e+Z*Re+J*ot,E[8]=I*te+G*Ee+Z*We+J*st,E[12]=I*ce+G*$e+Z*tt+J*Ct,E[1]=K*F+me*ue+ge*Be+Se*Ze,E[5]=K*V+me*_e+ge*Re+Se*ot,E[9]=K*te+me*Ee+ge*We+Se*st,E[13]=K*ce+me*$e+ge*tt+Se*Ct,E[2]=w*F+e*ue+c*Be+d*Ze,E[6]=w*V+e*_e+c*Re+d*ot,E[10]=w*te+e*Ee+c*We+d*st,E[14]=w*ce+e*$e+c*tt+d*Ct,E[3]=_*F+S*ue+B*Be+k*Ze,E[7]=_*V+S*_e+B*Re+k*ot,E[11]=_*te+S*Ee+B*We+k*st,E[15]=_*ce+S*$e+B*tt+k*Ct,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[4]*=t,u[8]*=t,u[12]*=t,u[1]*=t,u[5]*=t,u[9]*=t,u[13]*=t,u[2]*=t,u[6]*=t,u[10]*=t,u[14]*=t,u[3]*=t,u[7]*=t,u[11]*=t,u[15]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[4],g=t[8],E=t[12],I=t[1],G=t[5],Z=t[9],J=t[13],K=t[2],me=t[6],ge=t[10],Se=t[14];return t[3]*(+E*Z*me-g*J*me-E*G*ge+m*J*ge+g*G*Se-m*Z*Se)+t[7]*(+u*Z*Se-u*J*ge+E*I*ge-g*I*Se+g*J*K-E*Z*K)+t[11]*(+u*J*me-u*G*Se-E*I*me+m*I*Se+E*G*K-m*J*K)+t[15]*(-g*G*K-u*Z*me+u*G*ge+g*I*me-m*I*ge+m*Z*K)},transpose:function(){const t=this.elements;let u;return u=t[1],t[1]=t[4],t[4]=u,u=t[2],t[2]=t[8],t[8]=u,u=t[6],t[6]=t[9],t[9]=u,u=t[3],t[3]=t[12],t[12]=u,u=t[7],t[7]=t[13],t[13]=u,u=t[11],t[11]=t[14],t[14]=u,this},setPosition:function(t,u,m){const g=this.elements;return t.isVector3?(g[12]=t.x,g[13]=t.y,g[14]=t.z):(g[12]=t,g[13]=u,g[14]=m),this},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const m=this.elements,g=t.elements,E=g[0],I=g[1],G=g[2],Z=g[3],J=g[4],K=g[5],me=g[6],ge=g[7],Se=g[8],w=g[9],e=g[10],c=g[11],d=g[12],_=g[13],S=g[14],B=g[15],k=w*S*ge-_*e*ge+_*me*c-K*S*c-w*me*B+K*e*B,F=d*e*ge-Se*S*ge-d*me*c+J*S*c+Se*me*B-J*e*B,V=Se*_*ge-d*w*ge+d*K*c-J*_*c-Se*K*B+J*w*B,te=d*w*me-Se*_*me-d*K*e+J*_*e+Se*K*S-J*w*S,ce=E*k+I*F+G*V+Z*te;if(0===ce)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ue=1/ce;return m[0]=k*ue,m[1]=(_*e*Z-w*S*Z-_*G*c+I*S*c+w*G*B-I*e*B)*ue,m[2]=(K*S*Z-_*me*Z+_*G*ge-I*S*ge-K*G*B+I*me*B)*ue,m[3]=(w*me*Z-K*e*Z-w*G*ge+I*e*ge+K*G*c-I*me*c)*ue,m[4]=F*ue,m[5]=(Se*S*Z-d*e*Z+d*G*c-E*S*c-Se*G*B+E*e*B)*ue,m[6]=(d*me*Z-J*S*Z-d*G*ge+E*S*ge+J*G*B-E*me*B)*ue,m[7]=(J*e*Z-Se*me*Z+Se*G*ge-E*e*ge-J*G*c+E*me*c)*ue,m[8]=V*ue,m[9]=(d*w*Z-Se*_*Z-d*I*c+E*_*c+Se*I*B-E*w*B)*ue,m[10]=(J*_*Z-d*K*Z+d*I*ge-E*_*ge-J*I*B+E*K*B)*ue,m[11]=(Se*K*Z-J*w*Z-Se*I*ge+E*w*ge+J*I*c-E*K*c)*ue,m[12]=te*ue,m[13]=(Se*_*G-d*w*G+d*I*e-E*_*e-Se*I*S+E*w*S)*ue,m[14]=(d*K*G-J*_*G-d*I*me+E*_*me+J*I*S-E*K*S)*ue,m[15]=(J*w*G-Se*K*G+Se*I*me-E*w*me-J*I*e+E*K*e)*ue,this},scale:function(t){const u=this.elements,m=t.x,g=t.y,E=t.z;return u[0]*=m,u[4]*=g,u[8]*=E,u[1]*=m,u[5]*=g,u[9]*=E,u[2]*=m,u[6]*=g,u[10]*=E,u[3]*=m,u[7]*=g,u[11]*=E,this},getMaxScaleOnAxis:function(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,u,m){return this.set(1,0,0,t,0,1,0,u,0,0,1,m,0,0,0,1),this},makeRotationX:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(1,0,0,0,0,u,-m,0,0,m,u,0,0,0,0,1),this},makeRotationY:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,0,m,0,0,1,0,0,-m,0,u,0,0,0,0,1),this},makeRotationZ:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,-m,0,0,m,u,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=1-m,I=t.x,G=t.y,Z=t.z,J=E*I,K=E*G;return this.set(J*I+m,J*G-g*Z,J*Z+g*G,0,J*G+g*Z,K*G+m,K*Z-g*I,0,J*Z-g*G,K*Z+g*I,E*Z*Z+m,0,0,0,0,1),this},makeScale:function(t,u,m){return this.set(t,0,0,0,0,u,0,0,0,0,m,0,0,0,0,1),this},makeShear:function(t,u,m){return this.set(1,u,m,0,t,1,m,0,t,u,1,0,0,0,0,1),this},compose:function(t,u,m){const g=this.elements,E=u._x,I=u._y,G=u._z,Z=u._w,J=E+E,K=I+I,me=G+G,ge=E*J,Se=E*K,w=E*me,e=I*K,c=I*me,d=G*me,_=Z*J,S=Z*K,B=Z*me,k=m.x,F=m.y,V=m.z;return g[0]=(1-(e+d))*k,g[1]=(Se+B)*k,g[2]=(w-S)*k,g[3]=0,g[4]=(Se-B)*F,g[5]=(1-(ge+d))*F,g[6]=(c+_)*F,g[7]=0,g[8]=(w+S)*V,g[9]=(c-_)*V,g[10]=(1-(ge+e))*V,g[11]=0,g[12]=t.x,g[13]=t.y,g[14]=t.z,g[15]=1,this},decompose:function(t,u,m){const g=this.elements;let E=$l.set(g[0],g[1],g[2]).length(),I=$l.set(g[4],g[5],g[6]).length(),G=$l.set(g[8],g[9],g[10]).length();this.determinant()<0&&(E=-E),t.x=g[12],t.y=g[13],t.z=g[14],As.copy(this);const Z=1/E,J=1/I,K=1/G;return As.elements[0]*=Z,As.elements[1]*=Z,As.elements[2]*=Z,As.elements[4]*=J,As.elements[5]*=J,As.elements[6]*=J,As.elements[8]*=K,As.elements[9]*=K,As.elements[10]*=K,u.setFromRotationMatrix(As),m.x=E,m.y=I,m.z=G,this},makePerspective:function(t,u,m,g,E,I){void 0===I&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const G=this.elements,J=2*E/(m-g),K=(u+t)/(u-t),me=(m+g)/(m-g),ge=-(I+E)/(I-E),Se=-2*I*E/(I-E);return G[0]=2*E/(u-t),G[4]=0,G[8]=K,G[12]=0,G[1]=0,G[5]=J,G[9]=me,G[13]=0,G[2]=0,G[6]=0,G[10]=ge,G[14]=Se,G[3]=0,G[7]=0,G[11]=-1,G[15]=0,this},makeOrthographic:function(t,u,m,g,E,I){const G=this.elements,Z=1/(u-t),J=1/(m-g),K=1/(I-E),me=(u+t)*Z,ge=(m+g)*J,Se=(I+E)*K;return G[0]=2*Z,G[4]=0,G[8]=0,G[12]=-me,G[1]=0,G[5]=2*J,G[9]=0,G[13]=-ge,G[2]=0,G[6]=0,G[10]=-2*K,G[14]=-Se,G[3]=0,G[7]=0,G[11]=0,G[15]=1,this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<16;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<16;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t[u+9]=m[9],t[u+10]=m[10],t[u+11]=m[11],t[u+12]=m[12],t[u+13]=m[13],t[u+14]=m[14],t[u+15]=m[15],t}});const Jc=new ri,$i=new yo;function ht(t=0,u=0,m=0,g=ht.DefaultOrder){this._x=t,this._y=u,this._z=m,this._order=g}function bu(){this.mask=1}ht.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ht.DefaultOrder="XYZ",Object.defineProperties(ht.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(ht.prototype,{isEuler:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._order=g||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,u,m){const g=tr.clamp,E=t.elements,I=E[0],G=E[4],Z=E[8],J=E[1],K=E[5],me=E[9],ge=E[2],Se=E[6],w=E[10];switch(u=u||this._order){case"XYZ":this._y=Math.asin(g(Z,-1,1)),Math.abs(Z)<.9999999?(this._x=Math.atan2(-me,w),this._z=Math.atan2(-G,I)):(this._x=Math.atan2(Se,K),this._z=0);break;case"YXZ":this._x=Math.asin(-g(me,-1,1)),Math.abs(me)<.9999999?(this._y=Math.atan2(Z,w),this._z=Math.atan2(J,K)):(this._y=Math.atan2(-ge,I),this._z=0);break;case"ZXY":this._x=Math.asin(g(Se,-1,1)),Math.abs(Se)<.9999999?(this._y=Math.atan2(-ge,w),this._z=Math.atan2(-G,K)):(this._y=0,this._z=Math.atan2(J,I));break;case"ZYX":this._y=Math.asin(-g(ge,-1,1)),Math.abs(ge)<.9999999?(this._x=Math.atan2(Se,w),this._z=Math.atan2(J,I)):(this._x=0,this._z=Math.atan2(-G,K));break;case"YZX":this._z=Math.asin(g(J,-1,1)),Math.abs(J)<.9999999?(this._x=Math.atan2(-me,K),this._y=Math.atan2(-ge,I)):(this._x=0,this._y=Math.atan2(Z,w));break;case"XZY":this._z=Math.asin(-g(G,-1,1)),Math.abs(G)<.9999999?(this._x=Math.atan2(Se,K),this._y=Math.atan2(Z,I)):(this._x=Math.atan2(-me,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+u)}return this._order=u,!1!==m&&this._onChangeCallback(),this},setFromQuaternion:function(t,u,m){return Jc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Jc,u,m)},setFromVector3:function(t,u){return this.set(t.x,t.y,t.z,u||this._order)},reorder:function(t){return $i.setFromEuler(this),this.setFromQuaternion($i,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new lt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(bu.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});let Mp=0;const Ui=new lt,kr=new yo,qr=new ri,Ya=new lt,bo=new lt,_a=new lt,xu=new yo,Ec=new lt(1,0,0),Zc=new lt(0,1,0),wu=new lt(0,0,1),Sh={type:"added"},Tc={type:"removed"};function Kn(){Object.defineProperty(this,"id",{value:Mp++}),this.uuid=tr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kn.DefaultUp.clone();const t=new lt,u=new ht,m=new yo,g=new lt(1,1,1);u._onChange(function(){m.setFromEuler(u,!1)}),m._onChange(function(){u.setFromQuaternion(m,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:u},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:g},modelViewMatrix:{value:new ri},normalMatrix:{value:new Ho}}),this.matrix=new ri,this.matrixWorld=new ri,this.matrixAutoUpdate=Kn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new bu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Cl(){Kn.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Kn.DefaultUp=new lt(0,1,0),Kn.DefaultMatrixAutoUpdate=!0,Kn.prototype=Object.assign(Object.create(ma.prototype),{constructor:Kn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,u){this.quaternion.setFromAxisAngle(t,u)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.multiply(kr),this},rotateOnWorldAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.premultiply(kr),this},rotateX:function(t){return this.rotateOnAxis(Ec,t)},rotateY:function(t){return this.rotateOnAxis(Zc,t)},rotateZ:function(t){return this.rotateOnAxis(wu,t)},translateOnAxis:function(t,u){return Ui.copy(t).applyQuaternion(this.quaternion),this.position.add(Ui.multiplyScalar(u)),this},translateX:function(t){return this.translateOnAxis(Ec,t)},translateY:function(t){return this.translateOnAxis(Zc,t)},translateZ:function(t){return this.translateOnAxis(wu,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(qr.getInverse(this.matrixWorld))},lookAt:function(t,u,m){t.isVector3?Ya.copy(t):Ya.set(t,u,m);const g=this.parent;this.updateWorldMatrix(!0,!1),bo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qr.lookAt(bo,Ya,this.up):qr.lookAt(Ya,bo,this.up),this.quaternion.setFromRotationMatrix(qr),g&&(qr.extractRotation(g.matrixWorld),kr.setFromRotationMatrix(qr),this.quaternion.premultiply(kr.inverse()))},add:function(t){if(arguments.length>1){for(let u=0;u<arguments.length;u++)this.add(arguments[u]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Sh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const u=this.children.indexOf(t);return-1!==u&&(t.parent=null,this.children.splice(u,1),t.dispatchEvent(Tc)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),qr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qr.multiply(t.parent.matrixWorld)),t.applyMatrix4(qr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,u){if(this[t]===u)return this;for(let m=0,g=this.children.length;m<g;m++){const E=this.children[m].getObjectByProperty(t,u);if(void 0!==E)return E}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new lt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new yo),this.updateMatrixWorld(!0),this.matrixWorld.decompose(bo,t,_a),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new lt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(bo,xu,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(u[8],u[9],u[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverseVisible(t)},traverseAncestors:function(t){const u=this.parent;null!==u&&(t(u),u.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].updateMatrixWorld(t)},updateWorldMatrix:function(t,u){const m=this.parent;if(!0===t&&null!==m&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===u){const g=this.children;for(let E=0,I=g.length;E<I;E++)g[E].updateWorldMatrix(!1,!0)}},toJSON:function(t){const u=void 0===t||"string"==typeof t,m={};u&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},m.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const g={};function E(G,Z){return void 0===G[Z.uuid]&&(G[Z.uuid]=Z.toJSON(t)),Z.uuid}if(g.uuid=this.uuid,g.type=this.type,""!==this.name&&(g.name=this.name),!0===this.castShadow&&(g.castShadow=!0),!0===this.receiveShadow&&(g.receiveShadow=!0),!1===this.visible&&(g.visible=!1),!1===this.frustumCulled&&(g.frustumCulled=!1),0!==this.renderOrder&&(g.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(g.userData=this.userData),g.layers=this.layers.mask,g.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(g.matrixAutoUpdate=!1),this.isInstancedMesh&&(g.type="InstancedMesh",g.count=this.count,g.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){g.geometry=E(t.geometries,this.geometry);const G=this.geometry.parameters;if(void 0!==G&&void 0!==G.shapes){const Z=G.shapes;if(Array.isArray(Z))for(let J=0,K=Z.length;J<K;J++)E(t.shapes,Z[J]);else E(t.shapes,Z)}}if(void 0!==this.material)if(Array.isArray(this.material)){const G=[];for(let Z=0,J=this.material.length;Z<J;Z++)G.push(E(t.materials,this.material[Z]));g.material=G}else g.material=E(t.materials,this.material);if(this.children.length>0){g.children=[];for(let G=0;G<this.children.length;G++)g.children.push(this.children[G].toJSON(t).object)}if(u){const G=I(t.geometries),Z=I(t.materials),J=I(t.textures),K=I(t.images),me=I(t.shapes);G.length>0&&(m.geometries=G),Z.length>0&&(m.materials=Z),J.length>0&&(m.textures=J),K.length>0&&(m.images=K),me.length>0&&(m.shapes=me)}return m.object=g,m;function I(G){const Z=[];for(const J in G){const K=G[J];delete K.metadata,Z.push(K)}return Z}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,u){if(void 0===u&&(u=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===u)for(let m=0;m<t.children.length;m++)this.add(t.children[m].clone());return this}}),Cl.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Cl,isScene:!0,copy:function(t,u){return Kn.prototype.copy.call(this,t,u),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){const u=Kn.prototype.toJSON.call(this,t);return null!==this.background&&(u.object.background=this.background.toJSON(t)),null!==this.environment&&(u.object.environment=this.environment.toJSON(t)),null!==this.fog&&(u.object.fog=this.fog.toJSON()),u},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Ja=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],Ba=new lt,Kl=new fn,Su=new lt,Na=new lt,xo=new lt,zs=new lt,Mc=new lt,it=new lt,xt=new lt,Ut=new lt,yn=new lt,qt=new lt;function fn(t,u){this.min=void 0!==t?t:new lt(1/0,1/0,1/0),this.max=void 0!==u?u:new lt(-1/0,-1/0,-1/0)}function tn(t,u,m,g,E){for(let I=0,G=t.length-3;I<=G;I+=3){qt.fromArray(t,I);const Z=E.x*Math.abs(qt.x)+E.y*Math.abs(qt.y)+E.z*Math.abs(qt.z),J=u.dot(qt),K=m.dot(qt),me=g.dot(qt);if(Math.max(-Math.max(J,K,me),Math.min(J,K,me))>Z)return!1}return!0}Object.assign(fn.prototype,{isBox3:!0,set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromArray:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,G=-1/0;for(let Z=0,J=t.length;Z<J;Z+=3){const K=t[Z],me=t[Z+1],ge=t[Z+2];K<u&&(u=K),me<m&&(m=me),ge<g&&(g=ge),K>E&&(E=K),me>I&&(I=me),ge>G&&(G=ge)}return this.min.set(u,m,g),this.max.set(E,I,G),this},setFromBufferAttribute:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,G=-1/0;for(let Z=0,J=t.count;Z<J;Z++){const K=t.getX(Z),me=t.getY(Z),ge=t.getZ(Z);K<u&&(u=K),me<m&&(m=me),ge<g&&(g=ge),K>E&&(E=K),me>I&&(I=me),ge>G&&(G=ge)}return this.min.set(u,m,g),this.max.set(E,I,G),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=Ba.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);const u=t.geometry;void 0!==u&&(null===u.boundingBox&&u.computeBoundingBox(),Kl.copy(u.boundingBox),Kl.applyMatrix4(t.matrixWorld),this.union(Kl));const m=t.children;for(let g=0,E=m.length;g<E;g++)this.expandByObject(m[g]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .getParameter() target is now required"),u=new lt),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Ba),Ba.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){let u,m;return t.normal.x>0?(u=t.normal.x*this.min.x,m=t.normal.x*this.max.x):(u=t.normal.x*this.max.x,m=t.normal.x*this.min.x),t.normal.y>0?(u+=t.normal.y*this.min.y,m+=t.normal.y*this.max.y):(u+=t.normal.y*this.max.y,m+=t.normal.y*this.min.y),t.normal.z>0?(u+=t.normal.z*this.min.z,m+=t.normal.z*this.max.z):(u+=t.normal.z*this.max.z,m+=t.normal.z*this.min.z),u<=-t.constant&&m>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(xt),Ut.subVectors(this.max,xt),Su.subVectors(t.a,xt),Na.subVectors(t.b,xt),xo.subVectors(t.c,xt),zs.subVectors(Na,Su),Mc.subVectors(xo,Na),it.subVectors(Su,xo);let u=[0,-zs.z,zs.y,0,-Mc.z,Mc.y,0,-it.z,it.y,zs.z,0,-zs.x,Mc.z,0,-Mc.x,it.z,0,-it.x,-zs.y,zs.x,0,-Mc.y,Mc.x,0,-it.y,it.x,0];return!!tn(u,Su,Na,xo,Ut)&&(u=[1,0,0,0,1,0,0,0,1],!!tn(u,Su,Na,xo,Ut)&&(yn.crossVectors(zs,Mc),u=[yn.x,yn.y,yn.z],tn(u,Su,Na,xo,Ut)))},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .clampPoint() target is now required"),u=new lt),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Ba.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Ba).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Ja[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ja[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ja[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ja[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ja[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ja[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ja[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ja[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ja)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const qn=new fn;function Gn(t,u){this.center=void 0!==t?t:new lt,this.radius=void 0!==u?u:-1}Object.assign(Gn.prototype,{set:function(t,u){return this.center.copy(t),this.radius=u,this},setFromPoints:function(t,u){const m=this.center;void 0!==u?m.copy(u):qn.setFromPoints(t).getCenter(m);let g=0;for(let E=0,I=t.length;E<I;E++)g=Math.max(g,m.distanceToSquared(t[E]));return this.radius=Math.sqrt(g),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){const u=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=u*u},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,u){const m=this.center.distanceToSquared(t);return void 0===u&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),u=new lt),u.copy(t),m>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new fn),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});const Sr=new lt,$r=new lt,yr=new lt,Xr=new lt,fi=new lt,Rr=new lt,ts=new lt;function co(t,u){this.origin=void 0!==t?t:new lt,this.direction=void 0!==u?u:new lt(0,0,-1)}Object.assign(co.prototype,{set:function(t,u){return this.origin.copy(t),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,u){return void 0===u&&(console.warn("THREE.Ray: .at() target is now required"),u=new lt),u.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Sr)),this},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),u=new lt),u.subVectors(t,this.origin);const m=u.dot(this.direction);return m<0?u.copy(this.origin):u.copy(this.direction).multiplyScalar(m).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){const u=Sr.subVectors(t,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(t):(Sr.copy(this.direction).multiplyScalar(u).add(this.origin),Sr.distanceToSquared(t))},distanceSqToSegment:function(t,u,m,g){$r.copy(t).add(u).multiplyScalar(.5),yr.copy(u).sub(t).normalize(),Xr.copy(this.origin).sub($r);const E=.5*t.distanceTo(u),I=-this.direction.dot(yr),G=Xr.dot(this.direction),Z=-Xr.dot(yr),J=Xr.lengthSq(),K=Math.abs(1-I*I);let me,ge,Se,w;if(K>0)if(me=I*Z-G,ge=I*G-Z,w=E*K,me>=0)if(ge>=-w)if(ge<=w){const e=1/K;me*=e,ge*=e,Se=me*(me+I*ge+2*G)+ge*(I*me+ge+2*Z)+J}else ge=E,me=Math.max(0,-(I*ge+G)),Se=-me*me+ge*(ge+2*Z)+J;else ge=-E,me=Math.max(0,-(I*ge+G)),Se=-me*me+ge*(ge+2*Z)+J;else ge<=-w?(me=Math.max(0,-(-I*E+G)),ge=me>0?-E:Math.min(Math.max(-E,-Z),E),Se=-me*me+ge*(ge+2*Z)+J):ge<=w?(me=0,ge=Math.min(Math.max(-E,-Z),E),Se=ge*(ge+2*Z)+J):(me=Math.max(0,-(I*E+G)),ge=me>0?E:Math.min(Math.max(-E,-Z),E),Se=-me*me+ge*(ge+2*Z)+J);else ge=I>0?-E:E,me=Math.max(0,-(I*ge+G)),Se=-me*me+ge*(ge+2*Z)+J;return m&&m.copy(this.direction).multiplyScalar(me).add(this.origin),g&&g.copy(yr).multiplyScalar(ge).add($r),Se},intersectSphere:function(t,u){Sr.subVectors(t.center,this.origin);const m=Sr.dot(this.direction),g=Sr.dot(Sr)-m*m,E=t.radius*t.radius;if(g>E)return null;const I=Math.sqrt(E-g),G=m-I,Z=m+I;return G<0&&Z<0?null:this.at(G<0?Z:G,u)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){const u=t.normal.dot(this.direction);if(0===u)return 0===t.distanceToPoint(this.origin)?0:null;const m=-(this.origin.dot(t.normal)+t.constant)/u;return m>=0?m:null},intersectPlane:function(t,u){const m=this.distanceToPlane(t);return null===m?null:this.at(m,u)},intersectsPlane:function(t){const u=t.distanceToPoint(this.origin);return 0===u||t.normal.dot(this.direction)*u<0},intersectBox:function(t,u){let m,g,E,I,G,Z;const J=1/this.direction.x,K=1/this.direction.y,me=1/this.direction.z,ge=this.origin;return J>=0?(m=(t.min.x-ge.x)*J,g=(t.max.x-ge.x)*J):(m=(t.max.x-ge.x)*J,g=(t.min.x-ge.x)*J),K>=0?(E=(t.min.y-ge.y)*K,I=(t.max.y-ge.y)*K):(E=(t.max.y-ge.y)*K,I=(t.min.y-ge.y)*K),m>I||E>g?null:((E>m||m!=m)&&(m=E),(I<g||g!=g)&&(g=I),me>=0?(G=(t.min.z-ge.z)*me,Z=(t.max.z-ge.z)*me):(G=(t.max.z-ge.z)*me,Z=(t.min.z-ge.z)*me),m>Z||G>g?null:((G>m||m!=m)&&(m=G),(Z<g||g!=g)&&(g=Z),g<0?null:this.at(m>=0?m:g,u)))},intersectsBox:function(t){return null!==this.intersectBox(t,Sr)},intersectTriangle:function(t,u,m,g,E){fi.subVectors(u,t),Rr.subVectors(m,t),ts.crossVectors(fi,Rr);let I,G=this.direction.dot(ts);if(G>0){if(g)return null;I=1}else{if(!(G<0))return null;I=-1,G=-G}Xr.subVectors(this.origin,t);const Z=I*this.direction.dot(Rr.crossVectors(Xr,Rr));if(Z<0)return null;const J=I*this.direction.dot(fi.cross(Xr));if(J<0||Z+J>G)return null;const K=-I*Xr.dot(ts);return K<0?null:this.at(K/G,E)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});const Qs=new lt,Bo=new lt,ec=new Ho;function Yo(t,u){this.normal=void 0!==t?t:new lt(1,0,0),this.constant=void 0!==u?u:0}Object.assign(Yo.prototype,{isPlane:!0,set:function(t,u){return this.normal.copy(t),this.constant=u,this},setComponents:function(t,u,m,g){return this.normal.set(t,u,m),this.constant=g,this},setFromNormalAndCoplanarPoint:function(t,u){return this.normal.copy(t),this.constant=-u.dot(this.normal),this},setFromCoplanarPoints:function(t,u,m){const g=Qs.subVectors(m,u).cross(Bo.subVectors(t,u)).normalize();return this.setFromNormalAndCoplanarPoint(g,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,u){return void 0===u&&(console.warn("THREE.Plane: .projectPoint() target is now required"),u=new lt),u.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,u){void 0===u&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new lt);const m=t.delta(Qs),g=this.normal.dot(m);if(0===g)return 0===this.distanceToPoint(t.start)?u.copy(t.start):void 0;const E=-(t.start.dot(this.normal)+this.constant)/g;return E<0||E>1?void 0:u.copy(m).multiplyScalar(E).add(t.start)},intersectsLine:function(t){const u=this.distanceToPoint(t.start),m=this.distanceToPoint(t.end);return u<0&&m>0||m<0&&u>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new lt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,u){const m=u||ec.getNormalMatrix(t),g=this.coplanarPoint(Qs).applyMatrix4(t),E=this.normal.applyMatrix3(m).normalize();return this.constant=-g.dot(E),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});const Xi=new lt,Ac=new lt,Yh=new lt,rh=new lt,Ap=new lt,Eh=new lt,cd=new lt,Th=new lt,Rd=new lt,ud=new lt;function Pr(t,u,m){this.a=void 0!==t?t:new lt,this.b=void 0!==u?u:new lt,this.c=void 0!==m?m:new lt}Object.assign(Pr,{getNormal:function(t,u,m,g){void 0===g&&(console.warn("THREE.Triangle: .getNormal() target is now required"),g=new lt),g.subVectors(m,u),Xi.subVectors(t,u),g.cross(Xi);const E=g.lengthSq();return E>0?g.multiplyScalar(1/Math.sqrt(E)):g.set(0,0,0)},getBarycoord:function(t,u,m,g,E){Xi.subVectors(g,u),Ac.subVectors(m,u),Yh.subVectors(t,u);const I=Xi.dot(Xi),G=Xi.dot(Ac),Z=Xi.dot(Yh),J=Ac.dot(Ac),K=Ac.dot(Yh),me=I*J-G*G;if(void 0===E&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),E=new lt),0===me)return E.set(-2,-1,-1);const ge=1/me,Se=(J*Z-G*K)*ge,w=(I*K-G*Z)*ge;return E.set(1-Se-w,w,Se)},containsPoint:function(t,u,m,g){return Pr.getBarycoord(t,u,m,g,rh),rh.x>=0&&rh.y>=0&&rh.x+rh.y<=1},getUV:function(t,u,m,g,E,I,G,Z){return this.getBarycoord(t,u,m,g,rh),Z.set(0,0),Z.addScaledVector(E,rh.x),Z.addScaledVector(I,rh.y),Z.addScaledVector(G,rh.z),Z},isFrontFacing:function(t,u,m,g){return Xi.subVectors(m,u),Ac.subVectors(t,u),Xi.cross(Ac).dot(g)<0}}),Object.assign(Pr.prototype,{set:function(t,u,m){return this.a.copy(t),this.b.copy(u),this.c.copy(m),this},setFromPointsAndIndices:function(t,u,m,g){return this.a.copy(t[u]),this.b.copy(t[m]),this.c.copy(t[g]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Xi.subVectors(this.c,this.b),Ac.subVectors(this.a,this.b),.5*Xi.cross(Ac).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new lt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)},getNormal:function(t){return Pr.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Yo),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,u){return Pr.getBarycoord(t,this.a,this.b,this.c,u)},getUV:function(t,u,m,g,E){return Pr.getUV(t,this.a,this.b,this.c,u,m,g,E)},containsPoint:function(t){return Pr.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Pr.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),u=new lt);const m=this.a,g=this.b,E=this.c;let I,G;Ap.subVectors(g,m),Eh.subVectors(E,m),Th.subVectors(t,m);const Z=Ap.dot(Th),J=Eh.dot(Th);if(Z<=0&&J<=0)return u.copy(m);Rd.subVectors(t,g);const K=Ap.dot(Rd),me=Eh.dot(Rd);if(K>=0&&me<=K)return u.copy(g);const ge=Z*me-K*J;if(ge<=0&&Z>=0&&K<=0)return I=Z/(Z-K),u.copy(m).addScaledVector(Ap,I);ud.subVectors(t,E);const Se=Ap.dot(ud),w=Eh.dot(ud);if(w>=0&&Se<=w)return u.copy(E);const e=Se*J-Z*w;if(e<=0&&J>=0&&w<=0)return G=J/(J-w),u.copy(m).addScaledVector(Eh,G);const c=K*w-Se*me;if(c<=0&&me-K>=0&&Se-w>=0)return cd.subVectors(E,g),G=(me-K)/(me-K+(Se-w)),u.copy(g).addScaledVector(cd,G);const d=1/(c+e+ge);return I=e*d,G=ge*d,u.copy(m).addScaledVector(Ap,I).addScaledVector(Eh,G)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});const $c={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ks={h:0,s:0,l:0},$p={h:0,s:0,l:0};function ar(t,u,m){return void 0===u&&void 0===m?this.set(t):this.setRGB(t,u,m)}function Ll(t,u,m){return m<0&&(m+=1),m>1&&(m-=1),m<.16666666666666666?t+6*(u-t)*m:m<.5?u:m<.6666666666666666?t+6*(u-t)*(.6666666666666666-m):t}function Mh(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Jh(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function ga(t,u,m,g,E,I){this.a=t,this.b=u,this.c=m,this.normal=g&&g.isVector3?g:new lt,this.vertexNormals=Array.isArray(g)?g:[],this.color=E&&E.isColor?E:new ar,this.vertexColors=Array.isArray(E)?E:[],this.materialIndex=void 0!==I?I:0}Object.assign(ar.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,u,m){return this.r=t,this.g=u,this.b=m,this},setHSL:function(t,u,m){if(t=tr.euclideanModulo(t,1),u=tr.clamp(u,0,1),m=tr.clamp(m,0,1),0===u)this.r=this.g=this.b=m;else{const g=m<=.5?m*(1+u):m+u-m*u,E=2*m-g;this.r=Ll(E,g,t+.3333333333333333),this.g=Ll(E,g,t),this.b=Ll(E,g,t-.3333333333333333)}return this},setStyle:function(t){function u(g){void 0!==g&&parseFloat(g)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let g;const I=m[2];switch(m[1]){case"rgb":case"rgba":if(g=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(255,parseInt(g[1],10))/255,this.g=Math.min(255,parseInt(g[2],10))/255,this.b=Math.min(255,parseInt(g[3],10))/255,u(g[5]),this;if(g=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(100,parseInt(g[1],10))/100,this.g=Math.min(100,parseInt(g[2],10))/100,this.b=Math.min(100,parseInt(g[3],10))/100,u(g[5]),this;break;case"hsl":case"hsla":if(g=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I)){const G=parseFloat(g[1])/360,Z=parseInt(g[2],10)/100,J=parseInt(g[3],10)/100;return u(g[5]),this.setHSL(G,Z,J)}}}else if(m=/^\#([A-Fa-f0-9]+)$/.exec(t)){const g=m[1],E=g.length;if(3===E)return this.r=parseInt(g.charAt(0)+g.charAt(0),16)/255,this.g=parseInt(g.charAt(1)+g.charAt(1),16)/255,this.b=parseInt(g.charAt(2)+g.charAt(2),16)/255,this;if(6===E)return this.r=parseInt(g.charAt(0)+g.charAt(1),16)/255,this.g=parseInt(g.charAt(2)+g.charAt(3),16)/255,this.b=parseInt(g.charAt(4)+g.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){const u=$c[t];return void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,u){return void 0===u&&(u=2),this.r=Math.pow(t.r,u),this.g=Math.pow(t.g,u),this.b=Math.pow(t.b,u),this},copyLinearToGamma:function(t,u){void 0===u&&(u=2);const m=u>0?1/u:1;return this.r=Math.pow(t.r,m),this.g=Math.pow(t.g,m),this.b=Math.pow(t.b,m),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Mh(t.r),this.g=Mh(t.g),this.b=Mh(t.b),this},copyLinearToSRGB:function(t){return this.r=Jh(t.r),this.g=Jh(t.g),this.b=Jh(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const u=this.r,m=this.g,g=this.b,E=Math.max(u,m,g),I=Math.min(u,m,g);let G,Z;const J=(I+E)/2;if(I===E)G=0,Z=0;else{const K=E-I;switch(Z=J<=.5?K/(E+I):K/(2-E-I),E){case u:G=(m-g)/K+(m<g?6:0);break;case m:G=(g-u)/K+2;break;case g:G=(u-m)/K+4}G/=6}return t.h=G,t.s=Z,t.l=J,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,u,m){return this.getHSL(Ks),Ks.h+=t,Ks.s+=u,Ks.l+=m,this.setHSL(Ks.h,Ks.s,Ks.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,u){return this.r=t.r+u.r,this.g=t.g+u.g,this.b=t.b+u.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,u){return this.r+=(t.r-this.r)*u,this.g+=(t.g-this.g)*u,this.b+=(t.b-this.b)*u,this},lerpHSL:function(t,u){this.getHSL(Ks),t.getHSL($p);const m=tr.lerp(Ks.h,$p.h,u),g=tr.lerp(Ks.s,$p.s,u),E=tr.lerp(Ks.l,$p.l,u);return this.setHSL(m,g,E),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,u){return void 0===u&&(u=0),this.r=t[u],this.g=t[u+1],this.b=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.r,t[u+1]=this.g,t[u+2]=this.b,t},fromBufferAttribute:function(t,u){return this.r=t.getX(u),this.g=t.getY(u),this.b=t.getZ(u),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),ar.NAMES=$c,Object.assign(ga.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let u=0,m=t.vertexNormals.length;u<m;u++)this.vertexNormals[u]=t.vertexNormals[u].clone();for(let u=0,m=t.vertexColors.length;u<m;u++)this.vertexColors[u]=t.vertexColors[u].clone();return this}});let hd=0;function zr(){Object.defineProperty(this,"id",{value:hd++}),this.uuid=tr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=oe,this.side=le,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Gt,this.blendDst=Dt,this.blendEquation=Pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=cr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=da,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qe,this.stencilZFail=qe,this.stencilZPass=qe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function eo(t){zr.call(this),this.type="MeshBasicMaterial",this.color=new ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}zr.prototype=Object.assign(Object.create(ma.prototype),{constructor:zr,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const u in t){const m=t[u];if(void 0===m){console.warn("THREE.Material: '"+u+"' parameter is undefined.");continue}if("shading"===u){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===A;continue}const g=this[u];void 0!==g?g&&g.isColor?g.set(m):g&&g.isVector3&&m&&m.isVector3?g.copy(m):this[u]=m:console.warn("THREE."+this.type+": '"+u+"' is not a property of this material.")}},toJSON:function(t){const u=void 0===t||"string"==typeof t;u&&(t={textures:{},images:{}});const m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function g(E){const I=[];for(const G in E){const Z=E[G];delete Z.metadata,I.push(Z)}return I}if(m.uuid=this.uuid,m.type=this.type,""!==this.name&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),void 0!==this.roughness&&(m.roughness=this.roughness),void 0!==this.metalness&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),void 0!==this.shininess&&(m.shininess=this.shininess),void 0!==this.clearcoat&&(m.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(t).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(t).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(t).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(t).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(t).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,void 0!==this.combine&&(m.combine=this.combine),void 0!==this.envMapIntensity&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(m.size=this.size),void 0!==this.sizeAttenuation&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==oe&&(m.blending=this.blending),!0===this.flatShading&&(m.flatShading=this.flatShading),this.side!==le&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),this.opacity<1&&(m.opacity=this.opacity),!0===this.transparent&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(m.rotation=this.rotation),!0===this.polygonOffset&&(m.polygonOffset=!0),0!==this.polygonOffsetFactor&&(m.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(m.linewidth=this.linewidth),void 0!==this.dashSize&&(m.dashSize=this.dashSize),void 0!==this.gapSize&&(m.gapSize=this.gapSize),void 0!==this.scale&&(m.scale=this.scale),!0===this.dithering&&(m.dithering=!0),this.alphaTest>0&&(m.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(m.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(m.wireframe=this.wireframe),this.wireframeLinewidth>1&&(m.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(m.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(m.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(m.morphTargets=!0),!0===this.morphNormals&&(m.morphNormals=!0),!0===this.skinning&&(m.skinning=!0),!1===this.visible&&(m.visible=!1),!1===this.toneMapped&&(m.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(m.userData=this.userData),u){const E=g(t.textures),I=g(t.images);E.length>0&&(m.textures=E),I.length>0&&(m.images=I)}return m},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const u=t.clippingPlanes;let m=null;if(null!==u){const g=u.length;m=new Array(g);for(let E=0;E!==g;++E)m[E]=u[E].clone()}return this.clippingPlanes=m,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(zr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(eo.prototype=Object.create(zr.prototype)).constructor=eo,eo.prototype.isMeshBasicMaterial=!0,eo.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const No=new lt,Cs=new wn;function Vr(t,u,m){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=u,this.count=void 0!==t?t.length/u:0,this.normalized=!0===m,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0}function dl(t,u,m){Vr.call(this,new Int8Array(t),u,m)}function Cc(t,u,m){Vr.call(this,new Uint8Array(t),u,m)}function ih(t,u,m){Vr.call(this,new Uint8ClampedArray(t),u,m)}function Zh(t,u,m){Vr.call(this,new Int16Array(t),u,m)}function Bl(t,u,m){Vr.call(this,new Uint16Array(t),u,m)}function er(t,u,m){Vr.call(this,new Int32Array(t),u,m)}function fl(t,u,m){Vr.call(this,new Uint32Array(t),u,m)}function Un(t,u,m){Vr.call(this,new Float32Array(t),u,m)}function Nl(t,u,m){Vr.call(this,new Float64Array(t),u,m)}function Pi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Pd(t){if(0===t.length)return-1/0;let u=t[0];for(let m=1,g=t.length;m<g;++m)t[m]>u&&(u=t[m]);return u}Object.defineProperty(Vr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Vr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.itemSize,m*=u.itemSize;for(let g=0,E=this.itemSize;g<E;g++)this.array[t+g]=u.array[m+g];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",g),I=new ar),u[m++]=I.r,u[m++]=I.g,u[m++]=I.b}return this},copyVector2sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",g),I=new wn),u[m++]=I.x,u[m++]=I.y}return this},copyVector3sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",g),I=new lt),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z}return this},copyVector4sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",g),I=new xi),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z,u[m++]=I.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let u=0,m=this.count;u<m;u++)Cs.fromBufferAttribute(this,u),Cs.applyMatrix3(t),this.setXY(u,Cs.x,Cs.y);else if(3===this.itemSize)for(let u=0,m=this.count;u<m;u++)No.fromBufferAttribute(this,u),No.applyMatrix3(t),this.setXYZ(u,No.x,No.y,No.z);return this},applyMatrix4:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.applyMatrix4(t),this.setXYZ(u,No.x,No.y,No.z);return this},applyNormalMatrix:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.applyNormalMatrix(t),this.setXYZ(u,No.x,No.y,No.z);return this},transformDirection:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.transformDirection(t),this.setXYZ(u,No.x,No.y,No.z);return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,u){return this.array[t*this.itemSize]=u,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,u){return this.array[t*this.itemSize+1]=u,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,u){return this.array[t*this.itemSize+2]=u,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,u){return this.array[t*this.itemSize+3]=u,this},setXY:function(t,u,m){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this.array[t+3]=E,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(dl.prototype=Object.create(Vr.prototype)).constructor=dl,(Cc.prototype=Object.create(Vr.prototype)).constructor=Cc,(ih.prototype=Object.create(Vr.prototype)).constructor=ih,(Zh.prototype=Object.create(Vr.prototype)).constructor=Zh,(Bl.prototype=Object.create(Vr.prototype)).constructor=Bl,(er.prototype=Object.create(Vr.prototype)).constructor=er,(fl.prototype=Object.create(Vr.prototype)).constructor=fl,(Un.prototype=Object.create(Vr.prototype)).constructor=Un,(Nl.prototype=Object.create(Vr.prototype)).constructor=Nl,Object.assign(Pi.prototype,{computeGroups:function(t){const u=[];let m,g,E;const I=t.faces;for(g=0;g<I.length;g++){const G=I[g];G.materialIndex!==E&&(E=G.materialIndex,void 0!==m&&(m.count=3*g-m.start,u.push(m)),m={start:3*g,materialIndex:E})}void 0!==m&&(m.count=3*g-m.start,u.push(m)),this.groups=u},fromGeometry:function(t){const u=t.faces,m=t.vertices,g=t.faceVertexUvs,E=g[0]&&g[0].length>0,I=g[1]&&g[1].length>0,G=t.morphTargets,Z=G.length;let J;if(Z>0){J=[];for(let d=0;d<Z;d++)J[d]={name:G[d].name,data:[]};this.morphTargets.position=J}const K=t.morphNormals,me=K.length;let ge;if(me>0){ge=[];for(let d=0;d<me;d++)ge[d]={name:K[d].name,data:[]};this.morphTargets.normal=ge}const Se=t.skinIndices,w=t.skinWeights,e=Se.length===m.length,c=w.length===m.length;m.length>0&&0===u.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let d=0;d<u.length;d++){const _=u[d];this.vertices.push(m[_.a],m[_.b],m[_.c]);const S=_.vertexNormals;if(3===S.length)this.normals.push(S[0],S[1],S[2]);else{const k=_.normal;this.normals.push(k,k,k)}const B=_.vertexColors;if(3===B.length)this.colors.push(B[0],B[1],B[2]);else{const k=_.color;this.colors.push(k,k,k)}if(!0===E){const k=g[0][d];void 0!==k?this.uvs.push(k[0],k[1],k[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",d),this.uvs.push(new wn,new wn,new wn))}if(!0===I){const k=g[1][d];void 0!==k?this.uvs2.push(k[0],k[1],k[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",d),this.uvs2.push(new wn,new wn,new wn))}for(let k=0;k<Z;k++){const F=G[k].vertices;J[k].data.push(F[_.a],F[_.b],F[_.c])}for(let k=0;k<me;k++){const F=K[k].vertexNormals[d];ge[k].data.push(F.a,F.b,F.c)}e&&this.skinIndices.push(Se[_.a],Se[_.b],Se[_.c]),c&&this.skinWeights.push(w[_.a],w[_.b],w[_.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});let Cp=1;const Ra=new ri,oh=new Kn,sh=new lt,Pa=new fn,li=new fn,Zr=new lt;function hn(){Object.defineProperty(this,"id",{value:Cp+=2}),this.uuid=tr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}hn.prototype=Object.assign(Object.create(ma.prototype),{constructor:hn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(Pd(t)>65535?fl:Bl)(t,1):t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,u){return this.attributes[t]=u,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,u,m){this.groups.push({start:t,count:u,materialIndex:void 0!==m?m:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,u){this.drawRange.start=t,this.drawRange.count=u},applyMatrix4:function(t){const u=this.attributes.position;void 0!==u&&(u.applyMatrix4(t),u.needsUpdate=!0);const m=this.attributes.normal;if(void 0!==m){const E=(new Ho).getNormalMatrix(t);m.applyNormalMatrix(E),m.needsUpdate=!0}const g=this.attributes.tangent;return void 0!==g&&(g.transformDirection(t),g.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Ra.makeRotationX(t),this.applyMatrix4(Ra),this},rotateY:function(t){return Ra.makeRotationY(t),this.applyMatrix4(Ra),this},rotateZ:function(t){return Ra.makeRotationZ(t),this.applyMatrix4(Ra),this},translate:function(t,u,m){return Ra.makeTranslation(t,u,m),this.applyMatrix4(Ra),this},scale:function(t,u,m){return Ra.makeScale(t,u,m),this.applyMatrix4(Ra),this},lookAt:function(t){return oh.lookAt(t),oh.updateMatrix(),this.applyMatrix4(oh.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(sh).negate(),this.translate(sh.x,sh.y,sh.z),this},setFromObject:function(t){const u=t.geometry;if(t.isPoints||t.isLine){const m=new Un(3*u.vertices.length,3),g=new Un(3*u.colors.length,3);if(this.setAttribute("position",m.copyVector3sArray(u.vertices)),this.setAttribute("color",g.copyColorsArray(u.colors)),u.lineDistances&&u.lineDistances.length===u.vertices.length){const E=new Un(u.lineDistances.length,1);this.setAttribute("lineDistance",E.copyArray(u.lineDistances))}null!==u.boundingSphere&&(this.boundingSphere=u.boundingSphere.clone()),null!==u.boundingBox&&(this.boundingBox=u.boundingBox.clone())}else t.isMesh&&u&&u.isGeometry&&this.fromGeometry(u);return this},setFromPoints:function(t){const u=[];for(let m=0,g=t.length;m<g;m++){const E=t[m];u.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new Un(u,3)),this},updateFromObject:function(t){let u=t.geometry;if(t.isMesh){let m=u.__directGeometry;if(!0===u.elementsNeedUpdate&&(m=void 0,u.elementsNeedUpdate=!1),void 0===m)return this.fromGeometry(u);m.verticesNeedUpdate=u.verticesNeedUpdate,m.normalsNeedUpdate=u.normalsNeedUpdate,m.colorsNeedUpdate=u.colorsNeedUpdate,m.uvsNeedUpdate=u.uvsNeedUpdate,m.groupsNeedUpdate=u.groupsNeedUpdate,u.verticesNeedUpdate=!1,u.normalsNeedUpdate=!1,u.colorsNeedUpdate=!1,u.uvsNeedUpdate=!1,u.groupsNeedUpdate=!1,u=m}if(!0===u.verticesNeedUpdate){const m=this.attributes.position;void 0!==m&&(m.copyVector3sArray(u.vertices),m.needsUpdate=!0),u.verticesNeedUpdate=!1}if(!0===u.normalsNeedUpdate){const m=this.attributes.normal;void 0!==m&&(m.copyVector3sArray(u.normals),m.needsUpdate=!0),u.normalsNeedUpdate=!1}if(!0===u.colorsNeedUpdate){const m=this.attributes.color;void 0!==m&&(m.copyColorsArray(u.colors),m.needsUpdate=!0),u.colorsNeedUpdate=!1}if(u.uvsNeedUpdate){const m=this.attributes.uv;void 0!==m&&(m.copyVector2sArray(u.uvs),m.needsUpdate=!0),u.uvsNeedUpdate=!1}if(u.lineDistancesNeedUpdate){const m=this.attributes.lineDistance;void 0!==m&&(m.copyArray(u.lineDistances),m.needsUpdate=!0),u.lineDistancesNeedUpdate=!1}return u.groupsNeedUpdate&&(u.computeGroups(t.geometry),this.groups=u.groups,u.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Pi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const u=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Vr(u,3).copyVector3sArray(t.vertices)),t.normals.length>0){const m=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Vr(m,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const m=new Float32Array(3*t.colors.length);this.setAttribute("color",new Vr(m,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const m=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Vr(m,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const m=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Vr(m,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const m in t.morphTargets){const g=[],E=t.morphTargets[m];for(let I=0,G=E.length;I<G;I++){const Z=E[I],J=new Un(3*Z.data.length,3);J.name=Z.name,g.push(J.copyVector3sArray(Z.data))}this.morphAttributes[m]=g}if(t.skinIndices.length>0){const m=new Un(4*t.skinIndices.length,4);this.setAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const m=new Un(4*t.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fn);const t=this.attributes.position,u=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),u)for(let m=0,g=u.length;m<g;m++)Pa.setFromBufferAttribute(u[m]),this.morphTargetsRelative?(Zr.addVectors(this.boundingBox.min,Pa.min),this.boundingBox.expandByPoint(Zr),Zr.addVectors(this.boundingBox.max,Pa.max),this.boundingBox.expandByPoint(Zr)):(this.boundingBox.expandByPoint(Pa.min),this.boundingBox.expandByPoint(Pa.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Gn);const t=this.attributes.position,u=this.morphAttributes.position;if(t){const m=this.boundingSphere.center;if(Pa.setFromBufferAttribute(t),u)for(let E=0,I=u.length;E<I;E++)li.setFromBufferAttribute(u[E]),this.morphTargetsRelative?(Zr.addVectors(Pa.min,li.min),Pa.expandByPoint(Zr),Zr.addVectors(Pa.max,li.max),Pa.expandByPoint(Zr)):(Pa.expandByPoint(li.min),Pa.expandByPoint(li.max));Pa.getCenter(m);let g=0;for(let E=0,I=t.count;E<I;E++)Zr.fromBufferAttribute(t,E),g=Math.max(g,m.distanceToSquared(Zr));if(u)for(let E=0,I=u.length;E<I;E++){const G=u[E],Z=this.morphTargetsRelative;for(let J=0,K=G.count;J<K;J++)Zr.fromBufferAttribute(G,J),Z&&(sh.fromBufferAttribute(t,J),Zr.add(sh)),g=Math.max(g,m.distanceToSquared(Zr))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,u=this.getAttribute("position");if(void 0!==u){let m=this.getAttribute("normal");if(void 0===m)m=new Vr(new Float32Array(3*u.count),3),this.setAttribute("normal",m);else for(let ge=0,Se=m.count;ge<Se;ge++)m.setXYZ(ge,0,0,0);const g=new lt,E=new lt,I=new lt,G=new lt,Z=new lt,J=new lt,K=new lt,me=new lt;if(t)for(let ge=0,Se=t.count;ge<Se;ge+=3){const w=t.getX(ge+0),e=t.getX(ge+1),c=t.getX(ge+2);g.fromBufferAttribute(u,w),E.fromBufferAttribute(u,e),I.fromBufferAttribute(u,c),K.subVectors(I,E),me.subVectors(g,E),K.cross(me),G.fromBufferAttribute(m,w),Z.fromBufferAttribute(m,e),J.fromBufferAttribute(m,c),G.add(K),Z.add(K),J.add(K),m.setXYZ(w,G.x,G.y,G.z),m.setXYZ(e,Z.x,Z.y,Z.z),m.setXYZ(c,J.x,J.y,J.z)}else for(let ge=0,Se=u.count;ge<Se;ge+=3)g.fromBufferAttribute(u,ge+0),E.fromBufferAttribute(u,ge+1),I.fromBufferAttribute(u,ge+2),K.subVectors(I,E),me.subVectors(g,E),K.cross(me),m.setXYZ(ge+0,K.x,K.y,K.z),m.setXYZ(ge+1,K.x,K.y,K.z),m.setXYZ(ge+2,K.x,K.y,K.z);this.normalizeNormals(),m.needsUpdate=!0}},merge:function(t,u){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===u&&(u=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const m=this.attributes;for(const g in m){if(void 0===t.attributes[g])continue;const E=m[g].array,I=t.attributes[g],G=I.array,Z=I.itemSize*u,J=Math.min(G.length,E.length-Z);for(let K=0,me=Z;K<J;K++,me++)E[me]=G[K]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let u=0,m=t.count;u<m;u++)Zr.fromBufferAttribute(t,u),Zr.normalize(),t.setXYZ(u,Zr.x,Zr.y,Zr.z)},toNonIndexed:function(){function t(G,Z){const J=G.array,K=G.itemSize,me=G.normalized,ge=new J.constructor(Z.length*K);let Se=0,w=0;for(let e=0,c=Z.length;e<c;e++){Se=Z[e]*K;for(let d=0;d<K;d++)ge[w++]=J[Se++]}return new Vr(ge,K,me)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const u=new hn,m=this.index.array,g=this.attributes;for(const G in g){const Z=t(g[G],m);u.setAttribute(G,Z)}const E=this.morphAttributes;for(const G in E){const Z=[],J=E[G];for(let K=0,me=J.length;K<me;K++){const ge=t(J[K],m);Z.push(ge)}u.morphAttributes[G]=Z}u.morphTargetsRelative=this.morphTargetsRelative;const I=this.groups;for(let G=0,Z=I.length;G<Z;G++){const J=I[G];u.addGroup(J.start,J.count,J.materialIndex)}return u},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const Z=this.parameters;for(const J in Z)void 0!==Z[J]&&(t[J]=Z[J]);return t}t.data={attributes:{}};const u=this.index;null!==u&&(t.data.index={type:u.array.constructor.name,array:Array.prototype.slice.call(u.array)});const m=this.attributes;for(const Z in m){const J=m[Z],K=J.toJSON(t.data);""!==J.name&&(K.name=J.name),t.data.attributes[Z]=K}const g={};let E=!1;for(const Z in this.morphAttributes){const J=this.morphAttributes[Z],K=[];for(let me=0,ge=J.length;me<ge;me++){const Se=J[me],w=Se.toJSON(t.data);""!==Se.name&&(w.name=Se.name),K.push(w)}K.length>0&&(g[Z]=K,E=!0)}E&&(t.data.morphAttributes=g,t.data.morphTargetsRelative=this.morphTargetsRelative);const I=this.groups;I.length>0&&(t.data.groups=JSON.parse(JSON.stringify(I)));const G=this.boundingSphere;return null!==G&&(t.data.boundingSphere={center:G.center.toArray(),radius:G.radius}),t},clone:function(){return(new hn).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const u={};this.name=t.name;const m=t.index;null!==m&&this.setIndex(m.clone(u));const g=t.attributes;for(const J in g)this.setAttribute(J,g[J].clone(u));const E=t.morphAttributes;for(const J in E){const K=[],me=E[J];for(let ge=0,Se=me.length;ge<Se;ge++)K.push(me[ge].clone(u));this.morphAttributes[J]=K}this.morphTargetsRelative=t.morphTargetsRelative;const I=t.groups;for(let J=0,K=I.length;J<K;J++){const me=I[J];this.addGroup(me.start,me.count,me.materialIndex)}const G=t.boundingBox;null!==G&&(this.boundingBox=G.clone());const Z=t.boundingSphere;return null!==Z&&(this.boundingSphere=Z.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Qc=new ri,ci=new co,va=new Gn,Za=new lt,Rn=new lt,wi=new lt,ms=new lt,gs=new lt,Ls=new lt,ii=new lt,Tr=new lt,br=new lt,ml=new wn,Lc=new wn,ah=new wn,Qa=new lt,ns=new lt;function Ci(t,u){Kn.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new eo,this.updateMorphTargets()}function Qh(t,u,m,g,E,I,G,Z){let J;if(J=u.side===q?g.intersectTriangle(G,I,E,!0,Z):g.intersectTriangle(E,I,G,u.side!==Y,Z),null===J)return null;ns.copy(Z),ns.applyMatrix4(t.matrixWorld);const K=m.ray.origin.distanceTo(ns);return K<m.near||K>m.far?null:{distance:K,point:ns.clone(),object:t}}function Ah(t,u,m,g,E,I,G,Z,J,K,me,ge){Za.fromBufferAttribute(E,K),Rn.fromBufferAttribute(E,me),wi.fromBufferAttribute(E,ge);const Se=t.morphTargetInfluences;if(u.morphTargets&&I&&Se){ii.set(0,0,0),Tr.set(0,0,0),br.set(0,0,0);for(let e=0,c=I.length;e<c;e++){const d=Se[e],_=I[e];0!==d&&(ms.fromBufferAttribute(_,K),gs.fromBufferAttribute(_,me),Ls.fromBufferAttribute(_,ge),G?(ii.addScaledVector(ms,d),Tr.addScaledVector(gs,d),br.addScaledVector(Ls,d)):(ii.addScaledVector(ms.sub(Za),d),Tr.addScaledVector(gs.sub(Rn),d),br.addScaledVector(Ls.sub(wi),d)))}Za.add(ii),Rn.add(Tr),wi.add(br)}t.isSkinnedMesh&&(t.boneTransform(K,Za),t.boneTransform(me,Rn),t.boneTransform(ge,wi));const w=Qh(t,u,m,g,Za,Rn,wi,Qa);if(w){Z&&(ml.fromBufferAttribute(Z,K),Lc.fromBufferAttribute(Z,me),ah.fromBufferAttribute(Z,ge),w.uv=Pr.getUV(Qa,Za,Rn,wi,ml,Lc,ah,new wn)),J&&(ml.fromBufferAttribute(J,K),Lc.fromBufferAttribute(J,me),ah.fromBufferAttribute(J,ge),w.uv2=Pr.getUV(Qa,Za,Rn,wi,ml,Lc,ah,new wn));const e=new ga(K,me,ge);Pr.getNormal(Za,Rn,wi,e.normal),w.face=e}return w}Ci.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Ci,isMesh:!0,copy:function(t){return Kn.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const G=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[G]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,u){const m=this.geometry,g=this.material,E=this.matrixWorld;if(void 0===g||(null===m.boundingSphere&&m.computeBoundingSphere(),va.copy(m.boundingSphere),va.applyMatrix4(E),!1===t.ray.intersectsSphere(va))||(Qc.getInverse(E),ci.copy(t.ray).applyMatrix4(Qc),null!==m.boundingBox&&!1===ci.intersectsBox(m.boundingBox)))return;let I;if(m.isBufferGeometry){const G=m.index,Z=m.attributes.position,J=m.morphAttributes.position,K=m.morphTargetsRelative,me=m.attributes.uv,ge=m.attributes.uv2,Se=m.groups,w=m.drawRange;if(null!==G)if(Array.isArray(g))for(let e=0,c=Se.length;e<c;e++){const d=Se[e],_=g[d.materialIndex];for(let S=Math.max(d.start,w.start),B=Math.min(d.start+d.count,w.start+w.count);S<B;S+=3){const k=G.getX(S),F=G.getX(S+1),V=G.getX(S+2);I=Ah(this,_,t,ci,Z,J,K,me,ge,k,F,V),I&&(I.faceIndex=Math.floor(S/3),I.face.materialIndex=d.materialIndex,u.push(I))}}else for(let e=Math.max(0,w.start),c=Math.min(G.count,w.start+w.count);e<c;e+=3){const d=G.getX(e),_=G.getX(e+1),S=G.getX(e+2);I=Ah(this,g,t,ci,Z,J,K,me,ge,d,_,S),I&&(I.faceIndex=Math.floor(e/3),u.push(I))}else if(void 0!==Z)if(Array.isArray(g))for(let e=0,c=Se.length;e<c;e++){const d=Se[e],_=g[d.materialIndex];for(let S=Math.max(d.start,w.start),B=Math.min(d.start+d.count,w.start+w.count);S<B;S+=3)I=Ah(this,_,t,ci,Z,J,K,me,ge,S,S+1,S+2),I&&(I.faceIndex=Math.floor(S/3),I.face.materialIndex=d.materialIndex,u.push(I))}else for(let e=Math.max(0,w.start),c=Math.min(Z.count,w.start+w.count);e<c;e+=3)I=Ah(this,g,t,ci,Z,J,K,me,ge,e,e+1,e+2),I&&(I.faceIndex=Math.floor(e/3),u.push(I))}else if(m.isGeometry){const G=Array.isArray(g),Z=m.vertices,J=m.faces;let K;const me=m.faceVertexUvs[0];me.length>0&&(K=me);for(let ge=0,Se=J.length;ge<Se;ge++){const w=J[ge],e=G?g[w.materialIndex]:g;if(void 0===e)continue;const c=Z[w.a],d=Z[w.b],_=Z[w.c];if(I=Qh(this,e,t,ci,c,d,_,Qa),I){if(K&&K[ge]){const S=K[ge];ml.copy(S[0]),Lc.copy(S[1]),ah.copy(S[2]),I.uv=Pr.getUV(Qa,c,d,_,ml,Lc,ah,new wn)}I.face=w,I.faceIndex=ge,u.push(I)}}}}});let Kh=0;const mr=new ri,Jo=new Kn,_l=new lt;function Fr(){Object.defineProperty(this,"id",{value:Kh+=2}),this.uuid=tr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Fr.prototype=Object.assign(Object.create(ma.prototype),{constructor:Fr,isGeometry:!0,applyMatrix4:function(t){const u=(new Ho).getNormalMatrix(t);for(let m=0,g=this.vertices.length;m<g;m++)this.vertices[m].applyMatrix4(t);for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];E.normal.applyMatrix3(u).normalize();for(let I=0,G=E.vertexNormals.length;I<G;I++)E.vertexNormals[I].applyMatrix3(u).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return mr.makeRotationX(t),this.applyMatrix4(mr),this},rotateY:function(t){return mr.makeRotationY(t),this.applyMatrix4(mr),this},rotateZ:function(t){return mr.makeRotationZ(t),this.applyMatrix4(mr),this},translate:function(t,u,m){return mr.makeTranslation(t,u,m),this.applyMatrix4(mr),this},scale:function(t,u,m){return mr.makeScale(t,u,m),this.applyMatrix4(mr),this},lookAt:function(t){return Jo.lookAt(t),Jo.updateMatrix(),this.applyMatrix4(Jo.matrix),this},fromBufferGeometry:function(t){const u=this,m=null!==t.index?t.index:void 0,g=t.attributes;if(void 0===g.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const E=g.position,I=g.normal,G=g.color,Z=g.uv,J=g.uv2;void 0!==J&&(this.faceVertexUvs[1]=[]);for(let ge=0;ge<E.count;ge++)u.vertices.push((new lt).fromBufferAttribute(E,ge)),void 0!==G&&u.colors.push((new ar).fromBufferAttribute(G,ge));function K(ge,Se,w,e){const c=void 0===G?[]:[u.colors[ge].clone(),u.colors[Se].clone(),u.colors[w].clone()],d=new ga(ge,Se,w,void 0===I?[]:[(new lt).fromBufferAttribute(I,ge),(new lt).fromBufferAttribute(I,Se),(new lt).fromBufferAttribute(I,w)],c,e);u.faces.push(d),void 0!==Z&&u.faceVertexUvs[0].push([(new wn).fromBufferAttribute(Z,ge),(new wn).fromBufferAttribute(Z,Se),(new wn).fromBufferAttribute(Z,w)]),void 0!==J&&u.faceVertexUvs[1].push([(new wn).fromBufferAttribute(J,ge),(new wn).fromBufferAttribute(J,Se),(new wn).fromBufferAttribute(J,w)])}const me=t.groups;if(me.length>0)for(let ge=0;ge<me.length;ge++){const Se=me[ge],w=Se.start;for(let e=w,c=w+Se.count;e<c;e+=3)void 0!==m?K(m.getX(e),m.getX(e+1),m.getX(e+2),Se.materialIndex):K(e,e+1,e+2,Se.materialIndex)}else if(void 0!==m)for(let ge=0;ge<m.count;ge+=3)K(m.getX(ge),m.getX(ge+1),m.getX(ge+2));else for(let ge=0;ge<E.count;ge+=3)K(ge,ge+1,ge+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_l).negate(),this.translate(_l.x,_l.y,_l.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,u=this.boundingSphere.radius,m=0===u?1:1/u,g=new ri;return g.set(m,0,0,-m*t.x,0,m,0,-m*t.y,0,0,m,-m*t.z,0,0,0,1),this.applyMatrix4(g),this},computeFaceNormals:function(){const t=new lt,u=new lt;for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=this.vertices[E.a],G=this.vertices[E.b];t.subVectors(this.vertices[E.c],G),u.subVectors(I,G),t.cross(u),t.normalize(),E.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);const u=new Array(this.vertices.length);for(let m=0,g=this.vertices.length;m<g;m++)u[m]=new lt;if(t){const m=new lt,g=new lt;for(let E=0,I=this.faces.length;E<I;E++){const G=this.faces[E],Z=this.vertices[G.a],J=this.vertices[G.b];m.subVectors(this.vertices[G.c],J),g.subVectors(Z,J),m.cross(g),u[G.a].add(m),u[G.b].add(m),u[G.c].add(m)}}else{this.computeFaceNormals();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];u[E.a].add(E.normal),u[E.b].add(E.normal),u[E.c].add(E.normal)}}for(let m=0,g=this.vertices.length;m<g;m++)u[m].normalize();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=E.vertexNormals;3===I.length?(I[0].copy(u[E.a]),I[1].copy(u[E.b]),I[2].copy(u[E.c])):(I[0]=u[E.a].clone(),I[1]=u[E.b].clone(),I[2]=u[E.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,u=this.faces.length;t<u;t++){const m=this.faces[t],g=m.vertexNormals;3===g.length?(g[0].copy(m.normal),g[1].copy(m.normal),g[2].copy(m.normal)):(g[0]=m.normal.clone(),g[1]=m.normal.clone(),g[2]=m.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]);for(let E=0,I=g.vertexNormals.length;E<I;E++)g.__originalVertexNormals[E]?g.__originalVertexNormals[E].copy(g.vertexNormals[E]):g.__originalVertexNormals[E]=g.vertexNormals[E].clone()}const t=new Fr;t.faces=this.faces;for(let u=0,m=this.morphTargets.length;u<m;u++){if(!this.morphNormals[u]){this.morphNormals[u]={},this.morphNormals[u].faceNormals=[],this.morphNormals[u].vertexNormals=[];const E=this.morphNormals[u].faceNormals,I=this.morphNormals[u].vertexNormals;for(let G=0,Z=this.faces.length;G<Z;G++){const J=new lt,K={a:new lt,b:new lt,c:new lt};E.push(J),I.push(K)}}const g=this.morphNormals[u];t.vertices=this.morphTargets[u].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let E=0,I=this.faces.length;E<I;E++){const G=this.faces[E],J=g.vertexNormals[E];g.faceNormals[E].copy(G.normal),J.a.copy(G.vertexNormals[0]),J.b.copy(G.vertexNormals[1]),J.c.copy(G.vertexNormals[2])}}for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Gn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,u,m){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let g,E=this.vertices.length,I=this.vertices,G=t.vertices,Z=this.faces,J=t.faces,K=this.colors,me=t.colors;void 0===m&&(m=0),void 0!==u&&(g=(new Ho).getNormalMatrix(u));for(let ge=0,Se=G.length;ge<Se;ge++){const w=G[ge].clone();void 0!==u&&w.applyMatrix4(u),I.push(w)}for(let ge=0,Se=me.length;ge<Se;ge++)K.push(me[ge].clone());for(let ge=0,Se=J.length;ge<Se;ge++){let w,e,c,d=J[ge],_=d.vertexNormals,S=d.vertexColors;w=new ga(d.a+E,d.b+E,d.c+E),w.normal.copy(d.normal),void 0!==g&&w.normal.applyMatrix3(g).normalize();for(let B=0,k=_.length;B<k;B++)e=_[B].clone(),void 0!==g&&e.applyMatrix3(g).normalize(),w.vertexNormals.push(e);w.color.copy(d.color);for(let B=0,k=S.length;B<k;B++)c=S[B],w.vertexColors.push(c.clone());w.materialIndex=d.materialIndex+m,Z.push(w)}for(let ge=0,Se=t.faceVertexUvs.length;ge<Se;ge++){const w=t.faceVertexUvs[ge];void 0===this.faceVertexUvs[ge]&&(this.faceVertexUvs[ge]=[]);for(let e=0,c=w.length;e<c;e++){const d=w[e],_=[];for(let S=0,B=d.length;S<B;S++)_.push(d[S].clone());this.faceVertexUvs[ge].push(_)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){const t={},u=[],m=[],g=Math.pow(10,4);for(let G=0,Z=this.vertices.length;G<Z;G++){const J=this.vertices[G],K=Math.round(J.x*g)+"_"+Math.round(J.y*g)+"_"+Math.round(J.z*g);void 0===t[K]?(t[K]=G,u.push(this.vertices[G]),m[G]=u.length-1):m[G]=m[t[K]]}const E=[];for(let G=0,Z=this.faces.length;G<Z;G++){const J=this.faces[G];J.a=m[J.a],J.b=m[J.b],J.c=m[J.c];const K=[J.a,J.b,J.c];for(let me=0;me<3;me++)if(K[me]===K[(me+1)%3]){E.push(G);break}}for(let G=E.length-1;G>=0;G--){const Z=E[G];this.faces.splice(Z,1);for(let J=0,K=this.faceVertexUvs.length;J<K;J++)this.faceVertexUvs[J].splice(Z,1)}const I=this.vertices.length-u.length;return this.vertices=u,I},setFromPoints:function(t){this.vertices=[];for(let u=0,m=t.length;u<m;u++){const g=t[u];this.vertices.push(new lt(g.x,g.y,g.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,u=t.length;for(let G=0;G<u;G++)t[G]._id=G;t.sort(function(G,Z){return G.materialIndex-Z.materialIndex});const m=this.faceVertexUvs[0],g=this.faceVertexUvs[1];let E,I;m&&m.length===u&&(E=[]),g&&g.length===u&&(I=[]);for(let G=0;G<u;G++){const Z=t[G]._id;E&&E.push(m[Z]),I&&I.push(g[Z])}E&&(this.faceVertexUvs[0]=E),I&&(this.faceVertexUvs[1]=I)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const w=this.parameters;for(const e in w)void 0!==w[e]&&(t[e]=w[e]);return t}const u=[];for(let w=0;w<this.vertices.length;w++){const e=this.vertices[w];u.push(e.x,e.y,e.z)}const m=[],g=[],E={},I=[],G={},Z=[],J={};for(let w=0;w<this.faces.length;w++){const e=this.faces[w],c=!0,d=!1,_=void 0!==this.faceVertexUvs[0][w],S=e.normal.length()>0,B=e.vertexNormals.length>0,k=1!==e.color.r||1!==e.color.g||1!==e.color.b,F=e.vertexColors.length>0;let V=0;if(V=K(V,0,0),V=K(V,1,c),V=K(V,2,d),V=K(V,3,_),V=K(V,4,S),V=K(V,5,B),V=K(V,6,k),V=K(V,7,F),m.push(V),m.push(e.a,e.b,e.c),m.push(e.materialIndex),_){const te=this.faceVertexUvs[0][w];m.push(Se(te[0]),Se(te[1]),Se(te[2]))}if(S&&m.push(me(e.normal)),B){const te=e.vertexNormals;m.push(me(te[0]),me(te[1]),me(te[2]))}if(k&&m.push(ge(e.color)),F){const te=e.vertexColors;m.push(ge(te[0]),ge(te[1]),ge(te[2]))}}function K(w,e,c){return c?w|1<<e:w&~(1<<e)}function me(w){const e=w.x.toString()+w.y.toString()+w.z.toString();return void 0!==E[e]||(E[e]=g.length/3,g.push(w.x,w.y,w.z)),E[e]}function ge(w){const e=w.r.toString()+w.g.toString()+w.b.toString();return void 0!==G[e]||(G[e]=I.length,I.push(w.getHex())),G[e]}function Se(w){const e=w.x.toString()+w.y.toString();return void 0!==J[e]||(J[e]=Z.length/2,Z.push(w.x,w.y)),J[e]}return t.data={},t.data.vertices=u,t.data.normals=g,I.length>0&&(t.data.colors=I),Z.length>0&&(t.data.uvs=[Z]),t.data.faces=m,t},clone:function(){return(new Fr).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const u=t.vertices;for(let ge=0,Se=u.length;ge<Se;ge++)this.vertices.push(u[ge].clone());const m=t.colors;for(let ge=0,Se=m.length;ge<Se;ge++)this.colors.push(m[ge].clone());const g=t.faces;for(let ge=0,Se=g.length;ge<Se;ge++)this.faces.push(g[ge].clone());for(let ge=0,Se=t.faceVertexUvs.length;ge<Se;ge++){const w=t.faceVertexUvs[ge];void 0===this.faceVertexUvs[ge]&&(this.faceVertexUvs[ge]=[]);for(let e=0,c=w.length;e<c;e++){const d=w[e],_=[];for(let S=0,B=d.length;S<B;S++)_.push(d[S].clone());this.faceVertexUvs[ge].push(_)}}const E=t.morphTargets;for(let ge=0,Se=E.length;ge<Se;ge++){const w={};if(w.name=E[ge].name,void 0!==E[ge].vertices){w.vertices=[];for(let e=0,c=E[ge].vertices.length;e<c;e++)w.vertices.push(E[ge].vertices[e].clone())}if(void 0!==E[ge].normals){w.normals=[];for(let e=0,c=E[ge].normals.length;e<c;e++)w.normals.push(E[ge].normals[e].clone())}this.morphTargets.push(w)}const I=t.morphNormals;for(let ge=0,Se=I.length;ge<Se;ge++){const w={};if(void 0!==I[ge].vertexNormals){w.vertexNormals=[];for(let e=0,c=I[ge].vertexNormals.length;e<c;e++){const d=I[ge].vertexNormals[e],_={};_.a=d.a.clone(),_.b=d.b.clone(),_.c=d.c.clone(),w.vertexNormals.push(_)}}if(void 0!==I[ge].faceNormals){w.faceNormals=[];for(let e=0,c=I[ge].faceNormals.length;e<c;e++)w.faceNormals.push(I[ge].faceNormals[e].clone())}this.morphNormals.push(w)}const G=t.skinWeights;for(let ge=0,Se=G.length;ge<Se;ge++)this.skinWeights.push(G[ge].clone());const Z=t.skinIndices;for(let ge=0,Se=Z.length;ge<Se;ge++)this.skinIndices.push(Z[ge].clone());const J=t.lineDistances;for(let ge=0,Se=J.length;ge<Se;ge++)this.lineDistances.push(J[ge]);const K=t.boundingBox;null!==K&&(this.boundingBox=K.clone());const me=t.boundingSphere;return null!==me&&(this.boundingSphere=me.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Bs extends Fr{constructor(u,m,g,E,I,G){super(),this.type="BoxGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:G},this.fromBufferGeometry(new lh(u,m,g,E,I,G)),this.mergeVertices()}}class lh extends hn{constructor(u=1,m=1,g=1,E=1,I=1,G=1){super(),this.type="BoxBufferGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:G};const Z=this;E=Math.floor(E),I=Math.floor(I),G=Math.floor(G);const J=[],K=[],me=[],ge=[];let Se=0,w=0;function e(c,d,_,S,B,k,F,V,te,ce,ue){const _e=k/te,Ee=F/ce,$e=k/2,Be=F/2,Re=V/2,We=te+1,tt=ce+1;let Ze=0,ot=0;const st=new lt;for(let Ct=0;Ct<tt;Ct++){const Ft=Ct*Ee-Be;for(let Qe=0;Qe<We;Qe++)st[c]=(Qe*_e-$e)*S,st[d]=Ft*B,st[_]=Re,K.push(st.x,st.y,st.z),st[c]=0,st[d]=0,st[_]=V>0?1:-1,me.push(st.x,st.y,st.z),ge.push(Qe/te),ge.push(1-Ct/ce),Ze+=1}for(let Ct=0;Ct<ce;Ct++)for(let Ft=0;Ft<te;Ft++){const nt=Se+Ft+We*(Ct+1),Et=Se+(Ft+1)+We*(Ct+1),Jt=Se+(Ft+1)+We*Ct;J.push(Se+Ft+We*Ct,nt,Jt),J.push(nt,Et,Jt),ot+=6}Z.addGroup(w,ot,ue),w+=ot,Se+=Ze}e("z","y","x",-1,-1,g,m,u,G,I,0),e("z","y","x",1,-1,g,m,-u,G,I,1),e("x","z","y",1,1,u,g,m,E,G,2),e("x","z","y",1,-1,u,g,-m,E,G,3),e("x","y","z",1,-1,u,m,g,E,I,4),e("x","y","z",-1,-1,u,m,-g,E,I,5),this.setIndex(J),this.setAttribute("position",new Un(K,3)),this.setAttribute("normal",new Un(me,3)),this.setAttribute("uv",new Un(ge,2))}}function Kc(t){const u={};for(const m in t){u[m]={};for(const g in t[m]){const E=t[m][g];u[m][g]=E&&(E.isColor||E.isMatrix3||E.isMatrix4||E.isVector2||E.isVector3||E.isVector4||E.isTexture)?E.clone():Array.isArray(E)?E.slice():E}}return u}function Ns(t){const u={};for(let m=0;m<t.length;m++){const g=Kc(t[m]);for(const E in g)u[E]=g[E]}return u}const Ro={clone:Kc,merge:Ns};var ep="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",tc="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function uo(t){zr.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=ep,this.fragmentShader=tc,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ai(){Kn.call(this),this.type="Camera",this.matrixWorldInverse=new ri,this.projectionMatrix=new ri,this.projectionMatrixInverse=new ri}function Rs(t,u,m,g){Ai.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==m?m:.1,this.far=void 0!==g?g:2e3,this.focus=10,this.aspect=void 0!==u?u:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(uo.prototype=Object.create(zr.prototype)).constructor=uo,uo.prototype.isShaderMaterial=!0,uo.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Kc(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this},uo.prototype.toJSON=function(t){const u=zr.prototype.toJSON.call(this,t);u.uniforms={};for(const g in this.uniforms){const E=this.uniforms[g].value;u.uniforms[g]=E&&E.isTexture?{type:"t",value:E.toJSON(t).uuid}:E&&E.isColor?{type:"c",value:E.getHex()}:E&&E.isVector2?{type:"v2",value:E.toArray()}:E&&E.isVector3?{type:"v3",value:E.toArray()}:E&&E.isVector4?{type:"v4",value:E.toArray()}:E&&E.isMatrix3?{type:"m3",value:E.toArray()}:E&&E.isMatrix4?{type:"m4",value:E.toArray()}:{value:E}}Object.keys(this.defines).length>0&&(u.defines=this.defines),u.vertexShader=this.vertexShader,u.fragmentShader=this.fragmentShader;const m={};for(const g in this.extensions)!0===this.extensions[g]&&(m[g]=!0);return Object.keys(m).length>0&&(u.extensions=m),u},Ai.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Ai,isCamera:!0,copy:function(t,u){return Kn.prototype.copy.call(this,t,u),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(-u[8],-u[9],-u[10]).normalize()},updateMatrixWorld:function(t){Kn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,u){Kn.prototype.updateWorldMatrix.call(this,t,u),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Rs.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Rs,isPerspectiveCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const u=.5*this.getFilmHeight()/t;this.fov=2*tr.RAD2DEG*Math.atan(u),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*tr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*tr.RAD2DEG*Math.atan(Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,u,m,g,E,I){this.aspect=t/u,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let t=this.near,u=t*Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom,m=2*u,g=this.aspect*m,E=-.5*g,I=this.view;if(null!==this.view&&this.view.enabled){const Z=I.fullWidth,J=I.fullHeight;E+=I.offsetX*g/Z,u-=I.offsetY*m/J,g*=I.width/Z,m*=I.height/J}const G=this.filmOffset;0!==G&&(E+=t*G/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+g,u,u-m,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Kn.prototype.toJSON.call(this,t);return u.object.fov=this.fov,u.object.zoom=this.zoom,u.object.near=this.near,u.object.far=this.far,u.object.focus=this.focus,u.object.aspect=this.aspect,null!==this.view&&(u.object.view=Object.assign({},this.view)),u.object.filmGauge=this.filmGauge,u.object.filmOffset=this.filmOffset,u}});const Ps=90,Rl=1;function Po(t,u,m){if(Kn.call(this),this.type="CubeCamera",!0!==m.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=m;const g=new Rs(Ps,Rl,t,u);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new lt(1,0,0)),this.add(g);const E=new Rs(Ps,Rl,t,u);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new lt(-1,0,0)),this.add(E);const I=new Rs(Ps,Rl,t,u);I.layers=this.layers,I.up.set(0,0,1),I.lookAt(new lt(0,1,0)),this.add(I);const G=new Rs(Ps,Rl,t,u);G.layers=this.layers,G.up.set(0,0,-1),G.lookAt(new lt(0,-1,0)),this.add(G);const Z=new Rs(Ps,Rl,t,u);Z.layers=this.layers,Z.up.set(0,-1,0),Z.lookAt(new lt(0,0,1)),this.add(Z);const J=new Rs(Ps,Rl,t,u);J.layers=this.layers,J.up.set(0,-1,0),J.lookAt(new lt(0,0,-1)),this.add(J),this.update=function(K,me){null===this.parent&&this.updateMatrixWorld();const ge=K.xr.enabled,Se=K.getRenderTarget();K.xr.enabled=!1;const w=m.texture.generateMipmaps;m.texture.generateMipmaps=!1,K.setRenderTarget(m,0),K.render(me,g),K.setRenderTarget(m,1),K.render(me,E),K.setRenderTarget(m,2),K.render(me,I),K.setRenderTarget(m,3),K.render(me,G),K.setRenderTarget(m,4),K.render(me,Z),m.texture.generateMipmaps=w,K.setRenderTarget(m,5),K.render(me,J),K.setRenderTarget(Se),K.xr.enabled=ge},this.clear=function(K,me,ge,Se){const w=K.getRenderTarget();for(let e=0;e<6;e++)K.setRenderTarget(m,e),K.clear(me,ge,Se);K.setRenderTarget(w)}}function Pl(t,u,m){Number.isInteger(u)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),u=m),Us.call(this,t,t,u)}function gl(t,u,m,g,E,I,G,Z,J,K,me,ge){di.call(this,null,I,G,Z,J,K,g,E,me,ge),this.image={data:t||null,width:u||1,height:m||1},this.magFilter=void 0!==J?J:Ir,this.minFilter=void 0!==K?K:Ir,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Po.prototype=Object.create(Kn.prototype)).constructor=Po,(Pl.prototype=Object.create(Us.prototype)).constructor=Pl,Pl.prototype.isWebGLCubeRenderTarget=!0,Pl.prototype.fromEquirectangularTexture=function(t,u){this.texture.type=u.type,this.texture.format=lo,this.texture.encoding=u.encoding,this.texture.generateMipmaps=u.generateMipmaps,this.texture.minFilter=u.minFilter,this.texture.magFilter=u.magFilter;const m=new Cl,I=new uo({name:"CubemapFromEquirect",uniforms:Kc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:q,blending:X});I.uniforms.tEquirect.value=u;const G=new Ci(new lh(5,5,5),I);return m.add(G),new Po(1,10,this).update(t,m),G.geometry.dispose(),G.material.dispose(),this},(gl.prototype=Object.create(di.prototype)).constructor=gl,gl.prototype.isDataTexture=!0;const nc=new Gn,Bc=new lt;function eu(t,u,m,g,E,I){this.planes=[void 0!==t?t:new Yo,void 0!==u?u:new Yo,void 0!==m?m:new Yo,void 0!==g?g:new Yo,void 0!==E?E:new Yo,void 0!==I?I:new Yo]}Object.assign(eu.prototype,{set:function(t,u,m,g,E,I){const G=this.planes;return G[0].copy(t),G[1].copy(u),G[2].copy(m),G[3].copy(g),G[4].copy(E),G[5].copy(I),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const u=this.planes;for(let m=0;m<6;m++)u[m].copy(t.planes[m]);return this},setFromProjectionMatrix:function(t){const u=this.planes,m=t.elements,g=m[0],E=m[1],I=m[2],G=m[3],Z=m[4],J=m[5],K=m[6],me=m[7],ge=m[8],Se=m[9],w=m[10],e=m[11],c=m[12],d=m[13],_=m[14],S=m[15];return u[0].setComponents(G-g,me-Z,e-ge,S-c).normalize(),u[1].setComponents(G+g,me+Z,e+ge,S+c).normalize(),u[2].setComponents(G+E,me+J,e+Se,S+d).normalize(),u[3].setComponents(G-E,me-J,e-Se,S-d).normalize(),u[4].setComponents(G-I,me-K,e-w,S-_).normalize(),u[5].setComponents(G+I,me+K,e+w,S+_).normalize(),this},intersectsObject:function(t){const u=t.geometry;return null===u.boundingSphere&&u.computeBoundingSphere(),nc.copy(u.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(nc)},intersectsSprite:function(t){return nc.center.set(0,0,0),nc.radius=.7071067811865476,nc.applyMatrix4(t.matrixWorld),this.intersectsSphere(nc)},intersectsSphere:function(t){const u=this.planes,m=t.center,g=-t.radius;for(let E=0;E<6;E++)if(u[E].distanceToPoint(m)<g)return!1;return!0},intersectsBox:function(t){const u=this.planes;for(let m=0;m<6;m++){const g=u[m];if(Bc.x=g.normal.x>0?t.max.x:t.min.x,Bc.y=g.normal.y>0?t.max.y:t.min.y,Bc.z=g.normal.z>0?t.max.z:t.min.z,g.distanceToPoint(Bc)<0)return!1}return!0},containsPoint:function(t){const u=this.planes;for(let m=0;m<6;m++)if(u[m].distanceToPoint(t)<0)return!1;return!0}});const hr={common:{diffuse:{value:new ar(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ho},uv2Transform:{value:new Ho},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new wn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ar(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ar(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ho}},sprite:{diffuse:{value:new ar(15658734)},opacity:{value:1},center:{value:new wn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ho}}};function Lp(){let t=null,u=!1,m=null,g=null;function E(I,G){m(I,G),g=t.requestAnimationFrame(E)}return{start:function(){!0!==u&&null!==m&&(g=t.requestAnimationFrame(E),u=!0)},stop:function(){t.cancelAnimationFrame(g),u=!1},setAnimationLoop:function(I){m=I},setContext:function(I){t=I}}}function Ia(t,u){const m=u.isWebGL2,g=new WeakMap;return{get:function(E){return E.isInterleavedBufferAttribute&&(E=E.data),g.get(E)},remove:function(E){E.isInterleavedBufferAttribute&&(E=E.data);const I=g.get(E);I&&(t.deleteBuffer(I.buffer),g.delete(E))},update:function(E,I){E.isInterleavedBufferAttribute&&(E=E.data);const G=g.get(E);void 0===G?g.set(E,function(Z,J){const K=Z.array,me=Z.usage,ge=t.createBuffer();t.bindBuffer(J,ge),t.bufferData(J,K,me),Z.onUploadCallback();let Se=5126;return K instanceof Float32Array?Se=5126:K instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):K instanceof Uint16Array?Se=5123:K instanceof Int16Array?Se=5122:K instanceof Uint32Array?Se=5125:K instanceof Int32Array?Se=5124:K instanceof Int8Array?Se=5120:K instanceof Uint8Array&&(Se=5121),{buffer:ge,type:Se,bytesPerElement:K.BYTES_PER_ELEMENT,version:Z.version}}(E,I)):G.version<E.version&&(function(Z,J,K){const me=J.array,ge=J.updateRange;t.bindBuffer(K,Z),-1===ge.count?t.bufferSubData(K,0,me):(m?t.bufferSubData(K,ge.offset*me.BYTES_PER_ELEMENT,me,ge.offset,ge.count):t.bufferSubData(K,ge.offset*me.BYTES_PER_ELEMENT,me.subarray(ge.offset,ge.offset+ge.count)),ge.count=-1)}(G.buffer,E,I),G.version=E.version)}}}function Ka(t,u,m,g){Fr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g},this.fromBufferGeometry(new Il(t,u,m,g)),this.mergeVertices()}function Il(t,u,m,g){hn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g};const E=(t=t||1)/2,I=(u=u||1)/2,G=Math.floor(m)||1,Z=Math.floor(g)||1,J=G+1,K=Z+1,me=t/G,ge=u/Z,Se=[],w=[],e=[],c=[];for(let d=0;d<K;d++){const _=d*ge-I;for(let S=0;S<J;S++)w.push(S*me-E,-_,0),e.push(0,0,1),c.push(S/G),c.push(1-d/Z)}for(let d=0;d<Z;d++)for(let _=0;_<G;_++){const B=_+J*(d+1),k=_+1+J*(d+1),F=_+1+J*d;Se.push(_+J*d,B,F),Se.push(B,k,F)}this.setIndex(Se),this.setAttribute("position",new Un(w,3)),this.setAttribute("normal",new Un(e,3)),this.setAttribute("uv",new Un(c,2))}(Ka.prototype=Object.create(Fr.prototype)).constructor=Ka,(Il.prototype=Object.create(hn.prototype)).constructor=Il;const Dr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Nc={basic:{uniforms:Ns([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.fog]),vertexShader:Dr.meshbasic_vert,fragmentShader:Dr.meshbasic_frag},lambert:{uniforms:Ns([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.fog,hr.lights,{emissive:{value:new ar(0)}}]),vertexShader:Dr.meshlambert_vert,fragmentShader:Dr.meshlambert_frag},phong:{uniforms:Ns([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new ar(0)},specular:{value:new ar(1118481)},shininess:{value:30}}]),vertexShader:Dr.meshphong_vert,fragmentShader:Dr.meshphong_frag},standard:{uniforms:Ns([hr.common,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.roughnessmap,hr.metalnessmap,hr.fog,hr.lights,{emissive:{value:new ar(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},toon:{uniforms:Ns([hr.common,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.gradientmap,hr.fog,hr.lights,{emissive:{value:new ar(0)}}]),vertexShader:Dr.meshtoon_vert,fragmentShader:Dr.meshtoon_frag},matcap:{uniforms:Ns([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,{matcap:{value:null}}]),vertexShader:Dr.meshmatcap_vert,fragmentShader:Dr.meshmatcap_frag},points:{uniforms:Ns([hr.points,hr.fog]),vertexShader:Dr.points_vert,fragmentShader:Dr.points_frag},dashed:{uniforms:Ns([hr.common,hr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Dr.linedashed_vert,fragmentShader:Dr.linedashed_frag},depth:{uniforms:Ns([hr.common,hr.displacementmap]),vertexShader:Dr.depth_vert,fragmentShader:Dr.depth_frag},normal:{uniforms:Ns([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,{opacity:{value:1}}]),vertexShader:Dr.normal_vert,fragmentShader:Dr.normal_frag},sprite:{uniforms:Ns([hr.sprite,hr.fog]),vertexShader:Dr.sprite_vert,fragmentShader:Dr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ho},t2D:{value:null}},vertexShader:Dr.background_vert,fragmentShader:Dr.background_frag},cube:{uniforms:Ns([hr.envmap,{opacity:{value:1}}]),vertexShader:Dr.cube_vert,fragmentShader:Dr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Dr.equirect_vert,fragmentShader:Dr.equirect_frag},distanceRGBA:{uniforms:Ns([hr.common,hr.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Dr.distanceRGBA_vert,fragmentShader:Dr.distanceRGBA_frag},shadow:{uniforms:Ns([hr.lights,hr.fog,{color:{value:new ar(0)},opacity:{value:1}}]),vertexShader:Dr.shadow_vert,fragmentShader:Dr.shadow_frag}};function qp(t,u,m,g){const E=new ar(0);let I,G,Z=0,J=null,K=0,me=null;function ge(Se,w){u.buffers.color.setClear(Se.r,Se.g,Se.b,w,g)}return{getClearColor:function(){return E},setClearColor:function(Se,w){E.set(Se),Z=void 0!==w?w:1,ge(E,Z)},getClearAlpha:function(){return Z},setClearAlpha:function(Se){Z=Se,ge(E,Z)},render:function(Se,w,e,c){let d=!0===w.isScene?w.background:null;const _=t.xr,S=_.getSession&&_.getSession();if(S&&"additive"===S.environmentBlendMode&&(d=null),null===d?ge(E,Z):d&&d.isColor&&(ge(d,1),c=!0),(t.autoClear||c)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||d.mapping===Ni)){void 0===G&&(G=new Ci(new lh(1,1,1),new uo({name:"BackgroundCubeMaterial",uniforms:Kc(Nc.cube.uniforms),vertexShader:Nc.cube.vertexShader,fragmentShader:Nc.cube.fragmentShader,side:q,depthTest:!1,depthWrite:!1,fog:!1})),G.geometry.deleteAttribute("normal"),G.geometry.deleteAttribute("uv"),G.onBeforeRender=function(k,F,V){this.matrixWorld.copyPosition(V.matrixWorld)},Object.defineProperty(G.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),m.update(G));const B=d.isWebGLCubeRenderTarget?d.texture:d;G.material.uniforms.envMap.value=B,G.material.uniforms.flipEnvMap.value=B.isCubeTexture?-1:1,J===d&&K===B.version&&me===t.toneMapping||(G.material.needsUpdate=!0,J=d,K=B.version,me=t.toneMapping),Se.unshift(G,G.geometry,G.material,0,0,null)}else d&&d.isTexture&&(void 0===I&&(I=new Ci(new Il(2,2),new uo({name:"BackgroundMaterial",uniforms:Kc(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:le,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),m.update(I)),I.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),I.material.uniforms.uvTransform.value.copy(d.matrix),J===d&&K===d.version&&me===t.toneMapping||(I.material.needsUpdate=!0,J=d,K=d.version,me=t.toneMapping),Se.unshift(I,I.geometry,I.material,0,0,null))}}}function Eu(t,u,m,g){const E=t.getParameter(34921),I=g.isWebGL2?null:u.get("OES_vertex_array_object"),G=g.isWebGL2||null!==I,Z={},J=Se(null);let K=J;function me(k){return g.isWebGL2?t.bindVertexArray(k):I.bindVertexArrayOES(k)}function ge(k){return g.isWebGL2?t.deleteVertexArray(k):I.deleteVertexArrayOES(k)}function Se(k){const F=[],V=[],te=[];for(let ce=0;ce<E;ce++)F[ce]=0,V[ce]=0,te[ce]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:V,attributeDivisors:te,object:k,attributes:{}}}function w(){const k=K.newAttributes;for(let F=0,V=k.length;F<V;F++)k[F]=0}function e(k){c(k,0)}function c(k,F){const te=K.enabledAttributes,ce=K.attributeDivisors;K.newAttributes[k]=1,0===te[k]&&(t.enableVertexAttribArray(k),te[k]=1),ce[k]!==F&&((g.isWebGL2?t:u.get("ANGLE_instanced_arrays"))[g.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,F),ce[k]=F)}function d(){const k=K.newAttributes,F=K.enabledAttributes;for(let V=0,te=F.length;V<te;V++)F[V]!==k[V]&&(t.disableVertexAttribArray(V),F[V]=0)}function _(k,F,V,te,ce,ue){!0!==g.isWebGL2||5124!==V&&5125!==V?t.vertexAttribPointer(k,F,V,te,ce,ue):t.vertexAttribIPointer(k,F,V,ce,ue)}function S(){B(),K!==J&&(K=J,me(K.object))}function B(){J.geometry=null,J.program=null,J.wireframe=!1}return{setup:function(k,F,V,te,ce){let ue=!1;if(G){const _e=function(Ee,$e,Be){const Re=!0===Be.wireframe;let We=Z[Ee.id];void 0===We&&(We={},Z[Ee.id]=We);let tt=We[$e.id];void 0===tt&&(tt={},We[$e.id]=tt);let Ze=tt[Re];return void 0===Ze&&(Ze=Se(g.isWebGL2?t.createVertexArray():I.createVertexArrayOES()),tt[Re]=Ze),Ze}(te,V,F);K!==_e&&(K=_e,me(K.object)),ue=function(Ee){const $e=K.attributes,Be=Ee.attributes;if(Object.keys($e).length!==Object.keys(Be).length)return!0;for(const Re in Be){const We=$e[Re],tt=Be[Re];if(We.attribute!==tt||We.data!==tt.data)return!0}return!1}(te),ue&&function(Ee){const $e={},Be=Ee.attributes;for(const Re in Be){const We=Be[Re],tt={};tt.attribute=We,We.data&&(tt.data=We.data),$e[Re]=tt}K.attributes=$e}(te)}else{const _e=!0===F.wireframe;K.geometry===te.id&&K.program===V.id&&K.wireframe===_e||(K.geometry=te.id,K.program=V.id,K.wireframe=_e,ue=!0)}!0===k.isInstancedMesh&&(ue=!0),null!==ce&&m.update(ce,34963),ue&&(function(_e,Ee,$e,Be){if(!1===g.isWebGL2&&(_e.isInstancedMesh||Be.isInstancedBufferGeometry)&&null===u.get("ANGLE_instanced_arrays"))return;w();const Re=Be.attributes,We=$e.getAttributes(),tt=Ee.defaultAttributeValues;for(const Ze in We){const ot=We[Ze];if(ot>=0){const st=Re[Ze];if(void 0!==st){const Ct=st.normalized,Ft=st.itemSize,Qe=m.get(st);if(void 0===Qe)continue;const nt=Qe.buffer,Et=Qe.type,Jt=Qe.bytesPerElement;if(st.isInterleavedBufferAttribute){const ct=st.data,Lt=ct.stride,_t=st.offset;ct&&ct.isInstancedInterleavedBuffer?(c(ot,ct.meshPerAttribute),void 0===Be._maxInstanceCount&&(Be._maxInstanceCount=ct.meshPerAttribute*ct.count)):e(ot),t.bindBuffer(34962,nt),_(ot,Ft,Et,Ct,Lt*Jt,_t*Jt)}else st.isInstancedBufferAttribute?(c(ot,st.meshPerAttribute),void 0===Be._maxInstanceCount&&(Be._maxInstanceCount=st.meshPerAttribute*st.count)):e(ot),t.bindBuffer(34962,nt),_(ot,Ft,Et,Ct,0,0)}else if("instanceMatrix"===Ze){const Ct=m.get(_e.instanceMatrix);if(void 0===Ct)continue;const Ft=Ct.buffer,Qe=Ct.type;c(ot+0,1),c(ot+1,1),c(ot+2,1),c(ot+3,1),t.bindBuffer(34962,Ft),t.vertexAttribPointer(ot+0,4,Qe,!1,64,0),t.vertexAttribPointer(ot+1,4,Qe,!1,64,16),t.vertexAttribPointer(ot+2,4,Qe,!1,64,32),t.vertexAttribPointer(ot+3,4,Qe,!1,64,48)}else if(void 0!==tt){const Ct=tt[Ze];if(void 0!==Ct)switch(Ct.length){case 2:t.vertexAttrib2fv(ot,Ct);break;case 3:t.vertexAttrib3fv(ot,Ct);break;case 4:t.vertexAttrib4fv(ot,Ct);break;default:t.vertexAttrib1fv(ot,Ct)}}}}d()}(k,F,V,te),null!==ce&&t.bindBuffer(34963,m.get(ce).buffer))},reset:S,resetDefaultState:B,dispose:function(){S();for(const k in Z){const F=Z[k];for(const V in F){const te=F[V];for(const ce in te)ge(te[ce].object),delete te[ce];delete F[V]}delete Z[k]}},releaseStatesOfGeometry:function(k){if(void 0===Z[k.id])return;const F=Z[k.id];for(const V in F){const te=F[V];for(const ce in te)ge(te[ce].object),delete te[ce];delete F[V]}delete Z[k.id]},releaseStatesOfProgram:function(k){for(const F in Z){const V=Z[F];if(void 0===V[k.id])continue;const te=V[k.id];for(const ce in te)ge(te[ce].object),delete te[ce];delete V[k.id]}},initAttributes:w,enableAttribute:e,disableUnusedAttributes:d}}function ui(t,u,m,g){const E=g.isWebGL2;let I;this.setMode=function(G){I=G},this.render=function(G,Z){t.drawArrays(I,G,Z),m.update(Z,I,1)},this.renderInstances=function(G,Z,J){if(0===J)return;let K,me;if(E)K=t,me="drawArraysInstanced";else if(K=u.get("ANGLE_instanced_arrays"),me="drawArraysInstancedANGLE",null===K)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");K[me](I,G,Z,J),m.update(Z,I,J)}}function sr(t,u,m){let g;function E(B){if("highp"===B){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";B="mediump"}return"mediump"===B&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const I=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext;let G=void 0!==m.precision?m.precision:"highp";const Z=E(G);Z!==G&&(console.warn("THREE.WebGLRenderer:",G,"not supported, using",Z,"instead."),G=Z);const J=!0===m.logarithmicDepthBuffer,K=t.getParameter(34930),me=t.getParameter(35660),ge=t.getParameter(3379),Se=t.getParameter(34076),w=t.getParameter(34921),e=t.getParameter(36347),c=t.getParameter(36348),d=t.getParameter(36349),_=me>0,S=I||!!u.get("OES_texture_float");return{isWebGL2:I,getMaxAnisotropy:function(){if(void 0!==g)return g;const B=u.get("EXT_texture_filter_anisotropic");return g=null!==B?t.getParameter(B.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,g},getMaxPrecision:E,precision:G,logarithmicDepthBuffer:J,maxTextures:K,maxVertexTextures:me,maxTextureSize:ge,maxCubemapSize:Se,maxAttributes:w,maxVertexUniforms:e,maxVaryings:c,maxFragmentUniforms:d,vertexTextures:_,floatFragmentTextures:S,floatVertexTextures:_&&S,maxSamples:I?t.getParameter(36183):0}}function Ol(){const t=this;let u=null,m=0,g=!1,E=!1;const I=new Yo,G=new Ho,Z={value:null,needsUpdate:!1};function J(){Z.value!==u&&(Z.value=u,Z.needsUpdate=m>0),t.numPlanes=m,t.numIntersection=0}function K(me,ge,Se,w){let e=null!==me?me.length:0,c=null;if(0!==e){if(c=Z.value,!0!==w||null===c){const d=Se+4*e,_=ge.matrixWorldInverse;G.getNormalMatrix(_),(null===c||c.length<d)&&(c=new Float32Array(d));for(let S=0,B=Se;S!==e;++S,B+=4)I.copy(me[S]).applyMatrix4(_,G),I.normal.toArray(c,B),c[B+3]=I.constant}Z.value=c,Z.needsUpdate=!0}return t.numPlanes=e,t.numIntersection=0,c}this.uniform=Z,this.numPlanes=0,this.numIntersection=0,this.init=function(me,ge,Se){const w=0!==me.length||ge||0!==m||g;return g=ge,u=K(me,Se,0),m=me.length,w},this.beginShadows=function(){E=!0,K(null)},this.endShadows=function(){E=!1,J()},this.setState=function(me,ge,Se,w,e,c){if(!g||null===me||0===me.length||E&&!Se)E?K(null):J();else{const d=E?0:m,_=4*d;let S=e.clippingState||null;Z.value=S,S=K(me,w,_,c);for(let B=0;B!==_;++B)S[B]=u[B];e.clippingState=S,this.numIntersection=ge?this.numPlanes:0,this.numPlanes+=d}}}function tu(t){const u={};return{has:function(m){if(void 0!==u[m])return u[m];let g;switch(m){case"WEBGL_depth_texture":g=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=t.getExtension(m)}return u[m]=g,!!g},get:function(m){return this.has(m)||console.warn("THREE.WebGLRenderer: "+m+" extension not supported."),u[m]}}}function Mo(t,u,m,g){const E=new WeakMap,I=new WeakMap;function G(J){const K=J.target,me=E.get(K);null!==me.index&&u.remove(me.index);for(const Se in me.attributes)u.remove(me.attributes[Se]);K.removeEventListener("dispose",G),E.delete(K);const ge=I.get(me);ge&&(u.remove(ge),I.delete(me)),g.releaseStatesOfGeometry(K),!0===K.isInstancedBufferGeometry&&delete K._maxInstanceCount,m.memory.geometries--}function Z(J){const K=[],me=J.index,ge=J.attributes.position;let Se=0;if(null!==me){const c=me.array;Se=me.version;for(let d=0,_=c.length;d<_;d+=3){const S=c[d+0],B=c[d+1],k=c[d+2];K.push(S,B,B,k,k,S)}}else{Se=ge.version;for(let d=0,_=ge.array.length/3-1;d<_;d+=3){const S=d+0,B=d+1,k=d+2;K.push(S,B,B,k,k,S)}}const w=new(Pd(K)>65535?fl:Bl)(K,1);w.version=Se;const e=I.get(J);e&&u.remove(e),I.set(J,w)}return{get:function(J,K){let me=E.get(K);return me||(K.addEventListener("dispose",G),K.isBufferGeometry?me=K:K.isGeometry&&(void 0===K._bufferGeometry&&(K._bufferGeometry=(new hn).setFromObject(J)),me=K._bufferGeometry),E.set(K,me),m.memory.geometries++,me)},update:function(J){const K=J.attributes;for(const ge in K)u.update(K[ge],34962);const me=J.morphAttributes;for(const ge in me){const Se=me[ge];for(let w=0,e=Se.length;w<e;w++)u.update(Se[w],34962)}},getWireframeAttribute:function(J){const K=I.get(J);if(K){const me=J.index;null!==me&&K.version<me.version&&Z(J)}else Z(J);return I.get(J)}}}function Vn(t,u,m,g){const E=g.isWebGL2;let I,G,Z;this.setMode=function(J){I=J},this.setIndex=function(J){G=J.type,Z=J.bytesPerElement},this.render=function(J,K){t.drawElements(I,K,G,J*Z),m.update(K,I,1)},this.renderInstances=function(J,K,me){if(0===me)return;let ge,Se;if(E)ge=t,Se="drawElementsInstanced";else if(ge=u.get("ANGLE_instanced_arrays"),Se="drawElementsInstancedANGLE",null===ge)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ge[Se](I,K,G,J*Z,me),m.update(K,I,me)}}function nu(t){const u={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:u,programs:null,autoReset:!0,reset:function(){u.frame++,u.calls=0,u.triangles=0,u.points=0,u.lines=0},update:function(m,g,E){switch(u.calls++,g){case 4:u.triangles+=E*(m/3);break;case 1:u.lines+=E*(m/2);break;case 3:u.lines+=E*(m-1);break;case 2:u.lines+=E*m;break;case 0:u.points+=E*m;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",g)}}}}function Tu(t,u){return t[0]-u[0]}function vl(t,u){return Math.abs(u[1])-Math.abs(t[1])}function rc(t){const u={},m=new Float32Array(8),g=[];for(let E=0;E<8;E++)g[E]=[E,0];return{update:function(E,I,G,Z){const J=E.morphTargetInfluences,K=void 0===J?0:J.length;let me=u[I.id];if(void 0===me){me=[];for(let c=0;c<K;c++)me[c]=[c,0];u[I.id]=me}for(let c=0;c<K;c++){const d=me[c];d[0]=c,d[1]=J[c]}me.sort(vl);for(let c=0;c<8;c++)c<K&&me[c][1]?(g[c][0]=me[c][0],g[c][1]=me[c][1]):(g[c][0]=Number.MAX_SAFE_INTEGER,g[c][1]=0);g.sort(Tu);const ge=G.morphTargets&&I.morphAttributes.position,Se=G.morphNormals&&I.morphAttributes.normal;let w=0;for(let c=0;c<8;c++){const d=g[c],_=d[0],S=d[1];_!==Number.MAX_SAFE_INTEGER&&S?(ge&&I.getAttribute("morphTarget"+c)!==ge[_]&&I.setAttribute("morphTarget"+c,ge[_]),Se&&I.getAttribute("morphNormal"+c)!==Se[_]&&I.setAttribute("morphNormal"+c,Se[_]),m[c]=S,w+=S):(ge&&void 0!==I.getAttribute("morphTarget"+c)&&I.deleteAttribute("morphTarget"+c),Se&&void 0!==I.getAttribute("morphNormal"+c)&&I.deleteAttribute("morphNormal"+c),m[c]=0)}const e=I.morphTargetsRelative?1:1-w;Z.getUniforms().setValue(t,"morphTargetBaseInfluence",e),Z.getUniforms().setValue(t,"morphTargetInfluences",m)}}}function Mu(t,u,m,g){let E=new WeakMap;return{update:function(I){const G=g.render.frame,Z=I.geometry,J=u.get(I,Z);return E.get(J)!==G&&(Z.isGeometry&&J.updateFromObject(I),u.update(J),E.set(J,G)),I.isInstancedMesh&&m.update(I.instanceMatrix,34962),J},dispose:function(){E=new WeakMap}}}function ea(t,u,m,g,E,I,G,Z,J,K){di.call(this,t=void 0!==t?t:[],u=void 0!==u?u:Ei,m,g,E,I,G=void 0!==G?G:Fs,Z,J,K),this.flipY=!1}function vs(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function ya(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Nc.physical={uniforms:Ns([Nc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new wn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ar(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},(ea.prototype=Object.create(di.prototype)).constructor=ea,ea.prototype.isCubeTexture=!0,Object.defineProperty(ea.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),(vs.prototype=Object.create(di.prototype)).constructor=vs,vs.prototype.isDataTexture2DArray=!0,(ya.prototype=Object.create(di.prototype)).constructor=ya,ya.prototype.isDataTexture3D=!0;const ch=new di,pd=new vs,ru=new ya,$h=new ea,Rc=[],uh=[],ba=new Float32Array(16),Io=new Float32Array(9),Is=new Float32Array(4);function ke(t,u,m){const g=t[0];if(g<=0||g>0)return t;let E=u*m,I=Rc[E];if(void 0===I&&(I=new Float32Array(E),Rc[E]=I),0!==u){g.toArray(I,0);for(let G=1,Z=0;G!==u;++G)Z+=m,t[G].toArray(I,Z)}return I}function De(t,u){if(t.length!==u.length)return!1;for(let m=0,g=t.length;m<g;m++)if(t[m]!==u[m])return!1;return!0}function He(t,u){for(let m=0,g=u.length;m<g;m++)t[m]=u[m]}function we(t,u){let m=uh[u];void 0===m&&(m=new Int32Array(u),uh[u]=m);for(let g=0;g!==u;++g)m[g]=t.allocateTextureUnit();return m}function ze(t,u){const m=this.cache;m[0]!==u&&(t.uniform1f(this.addr,u),m[0]=u)}function Ye(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y||(t.uniform2f(this.addr,u.x,u.y),m[0]=u.x,m[1]=u.y);else{if(De(m,u))return;t.uniform2fv(this.addr,u),He(m,u)}}function bt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z||(t.uniform3f(this.addr,u.x,u.y,u.z),m[0]=u.x,m[1]=u.y,m[2]=u.z);else if(void 0!==u.r)m[0]===u.r&&m[1]===u.g&&m[2]===u.b||(t.uniform3f(this.addr,u.r,u.g,u.b),m[0]=u.r,m[1]=u.g,m[2]=u.b);else{if(De(m,u))return;t.uniform3fv(this.addr,u),He(m,u)}}function Ot(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z&&m[3]===u.w||(t.uniform4f(this.addr,u.x,u.y,u.z,u.w),m[0]=u.x,m[1]=u.y,m[2]=u.z,m[3]=u.w);else{if(De(m,u))return;t.uniform4fv(this.addr,u),He(m,u)}}function Wt(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix2fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;Is.set(g),t.uniformMatrix2fv(this.addr,!1,Is),He(m,g)}}function In(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix3fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;Io.set(g),t.uniformMatrix3fv(this.addr,!1,Io),He(m,g)}}function Sn(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix4fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;ba.set(g),t.uniformMatrix4fv(this.addr,!1,ba),He(m,g)}}function Hn(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTexture2D(u||ch,E)}function Cr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture2DArray(u||pd,E)}function Ur(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture3D(u||ru,E)}function Lr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTextureCube(u||$h,E)}function Qt(t,u){const m=this.cache;m[0]!==u&&(t.uniform1i(this.addr,u),m[0]=u)}function Ao(t,u){const m=this.cache;De(m,u)||(t.uniform2iv(this.addr,u),He(m,u))}function ic(t,u){const m=this.cache;De(m,u)||(t.uniform3iv(this.addr,u),He(m,u))}function el(t,u){const m=this.cache;De(m,u)||(t.uniform4iv(this.addr,u),He(m,u))}function Qr(t,u){const m=this.cache;m[0]!==u&&(t.uniform1ui(this.addr,u),m[0]=u)}function Cn(t,u){t.uniform1fv(this.addr,u)}function Id(t,u){t.uniform1iv(this.addr,u)}function Cm(t,u){t.uniform2iv(this.addr,u)}function gr(t,u){t.uniform3iv(this.addr,u)}function rf(t,u){t.uniform4iv(this.addr,u)}function of(t,u){const m=ke(u,this.size,2);t.uniform2fv(this.addr,m)}function Af(t,u){const m=ke(u,this.size,3);t.uniform3fv(this.addr,m)}function Au(t,u){const m=ke(u,this.size,4);t.uniform4fv(this.addr,m)}function $f(t,u){const m=ke(u,this.size,4);t.uniformMatrix2fv(this.addr,!1,m)}function xa(t,u){const m=ke(u,this.size,9);t.uniformMatrix3fv(this.addr,!1,m)}function oc(t,u){const m=ke(u,this.size,16);t.uniformMatrix4fv(this.addr,!1,m)}function ys(t,u,m){const g=u.length,E=we(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTexture2D(u[I]||ch,E[I])}function tl(t,u,m){const g=u.length,E=we(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTextureCube(u[I]||$h,E[I])}function sf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.setValue=function(g){switch(g){case 5126:return ze;case 35664:return Ye;case 35665:return bt;case 35666:return Ot;case 35674:return Wt;case 35675:return In;case 35676:return Sn;case 5124:case 35670:return Qt;case 35667:case 35671:return Ao;case 35668:case 35672:return ic;case 35669:case 35673:return el;case 5125:return Qr;case 35678:case 36198:case 36298:case 36306:case 35682:return Hn;case 35679:case 36299:case 36307:return Ur;case 35680:case 36300:case 36308:case 36293:return Lr;case 36289:case 36303:case 36311:case 36292:return Cr}}(u.type)}function Vf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.size=u.size,this.setValue=function(g){switch(g){case 5126:return Cn;case 35664:return of;case 35665:return Af;case 35666:return Au;case 35674:return $f;case 35675:return xa;case 35676:return oc;case 5124:case 35670:return Id;case 35667:case 35671:return Cm;case 35668:case 35672:return gr;case 35669:case 35673:return rf;case 35678:case 36198:case 36298:case 36306:case 35682:return ys;case 35680:case 36300:case 36308:case 36293:return tl}}(u.type)}function Wf(t){this.id=t,this.seq=[],this.map={}}Vf.prototype.updateCache=function(t){let u=this.cache;t instanceof Float32Array&&u.length!==t.length&&(this.cache=new Float32Array(t.length)),He(u,t)},Wf.prototype.setValue=function(t,u,m){const g=this.seq;for(let E=0,I=g.length;E!==I;++E){const G=g[E];G.setValue(t,u[G.id],m)}};const Cf=/([\w\d_]+)(\])?(\[|\.)?/g;function qf(t,u){t.seq.push(u),t.map[u.id]=u}function Lm(t,u,m){const g=t.name,E=g.length;for(Cf.lastIndex=0;;){const I=Cf.exec(g);let Z=I[1],K=I[3];if("]"===I[2]&&(Z|=0),void 0===K||"["===K&&Cf.lastIndex+2===E){qf(m,void 0===K?new sf(Z,t,u):new Vf(Z,t,u));break}{let me=m.map[Z];void 0===me&&(me=new Wf(Z),qf(m,me)),m=me}}}function Bp(t,u){this.seq=[],this.map={};const m=t.getProgramParameter(u,35718);for(let g=0;g<m;++g){const E=t.getActiveUniform(u,g);Lm(E,t.getUniformLocation(u,E.name),this)}}function Xf(t,u,m){const g=t.createShader(u);return t.shaderSource(g,m),t.compileShader(g),g}Bp.prototype.setValue=function(t,u,m,g){const E=this.map[u];void 0!==E&&E.setValue(t,m,g)},Bp.prototype.setOptional=function(t,u,m){const g=u[m];void 0!==g&&this.setValue(t,m,g)},Bp.upload=function(t,u,m,g){for(let E=0,I=u.length;E!==I;++E){const G=u[E],Z=m[G.id];!1!==Z.needsUpdate&&G.setValue(t,Z.value,g)}},Bp.seqWithValue=function(t,u){const m=[];for(let g=0,E=t.length;g!==E;++g){const I=t[g];I.id in u&&m.push(I)}return m};let Bm=0;function Yf(t){switch(t){case Zi:return["Linear","( value )"];case hl:return["sRGB","( value )"];case Yc:return["RGBE","( value )"];case xc:return["RGBM","( value, 7.0 )"];case nh:return["RGBM","( value, 16.0 )"];case vu:return["RGBD","( value, 256.0 )"];case Ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Wh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Jf(t,u,m){const g=t.getShaderParameter(u,35713),E=t.getShaderInfoLog(u).trim();return g&&""===E?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+m+"\n"+E+function(I){const G=I.split("\n");for(let Z=0;Z<G.length;Z++)G[Z]=Z+1+": "+G[Z];return G.join("\n")}(t.getShaderSource(u))}function Od(t,u){const m=Yf(u);return"vec4 "+t+"( vec4 value ) { return "+m[0]+"ToLinear"+m[1]+"; }"}function Nm(t,u){const m=Yf(u);return"vec4 "+t+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"}function Rm(t,u){let m;switch(u){case mi:m="Linear";break;case go:m="Reinhard";break;case Nr:m="OptimizedCineon";break;case ei:m="ACESFilmic";break;case Wr:m="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",u),m="Linear"}return"vec3 "+t+"( vec3 color ) { return "+m+"ToneMapping( color ); }"}function kd(t){return""!==t}function dd(t,u){return t.replace(/NUM_DIR_LIGHTS/g,u.numDirLights).replace(/NUM_SPOT_LIGHTS/g,u.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,u.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,u.numPointLights).replace(/NUM_HEMI_LIGHTS/g,u.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,u.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,u.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,u.numPointLightShadows)}function Zf(t,u){return t.replace(/NUM_CLIPPING_PLANES/g,u.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,u.numClippingPlanes-u.numClipIntersection)}const Fd=/^[ \t]*#include +<([\w\d./]+)>/gm;function tp(t){return t.replace(Fd,Pm)}function Pm(t,u){const m=Dr[u];if(void 0===m)throw new Error("Can not resolve #include <"+u+">");return tp(m)}const Im=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Om=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Qf(t){return t.replace(Om,Dd).replace(Im,km)}function km(t,u,m,g){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Dd(0,u,m,g)}function Dd(t,u,m,g){let E="";for(let I=parseInt(u);I<parseInt(m);I++)E+=g.replace(/\[ i \]/g,"[ "+I+" ]").replace(/UNROLLED_LOOP_INDEX/g,I);return E}function Kf(t){let u="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?u+="\n#define HIGH_PRECISION":"mediump"===t.precision?u+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(u+="\n#define LOW_PRECISION"),u}function Fm(t,u,m,g){const E=t.getContext(),I=m.defines;let G=m.vertexShader,Z=m.fragmentShader;const J=function(te){let ce="SHADOWMAP_TYPE_BASIC";return te.shadowMapType===he?ce="SHADOWMAP_TYPE_PCF":te.shadowMapType===ae?ce="SHADOWMAP_TYPE_PCF_SOFT":te.shadowMapType===fe&&(ce="SHADOWMAP_TYPE_VSM"),ce}(m),K=function(te){let ce="ENVMAP_TYPE_CUBE";if(te.envMap)switch(te.envMapMode){case Ei:case So:ce="ENVMAP_TYPE_CUBE";break;case Ni:case Eo:ce="ENVMAP_TYPE_CUBE_UV";break;case Xs:case ua:ce="ENVMAP_TYPE_EQUIREC"}return ce}(m),me=function(te){let ce="ENVMAP_MODE_REFLECTION";if(te.envMap)switch(te.envMapMode){case So:case ua:case Eo:ce="ENVMAP_MODE_REFRACTION"}return ce}(m),ge=function(te){let ce="ENVMAP_BLENDING_NONE";if(te.envMap)switch(te.combine){case Kr:ce="ENVMAP_BLENDING_MULTIPLY";break;case pi:ce="ENVMAP_BLENDING_MIX";break;case rr:ce="ENVMAP_BLENDING_ADD"}return ce}(m),Se=t.gammaFactor>0?t.gammaFactor:1,w=m.isWebGL2?"":[(te=m).extensionDerivatives||te.envMapCubeUV||te.bumpMap||te.tangentSpaceNormalMap||te.clearcoatNormalMap||te.flatShading||"physical"===te.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(te.extensionFragDepth||te.logarithmicDepthBuffer)&&te.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",te.extensionDrawBuffers&&te.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(te.extensionShaderTextureLOD||te.envMap)&&te.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kd).join("\n"),e=function(te){const ce=[];for(const ue in te){const _e=te[ue];!1!==_e&&ce.push("#define "+ue+" "+_e)}return ce.join("\n")}(I),c=E.createProgram();var te;let d,_;m.isRawShaderMaterial?(d=[e].filter(kd).join("\n"),d.length>0&&(d+="\n"),_=[w,e].filter(kd).join("\n"),_.length>0&&(_+="\n")):(d=[Kf(m),"#define SHADER_NAME "+m.shaderName,e,m.instancing?"#define USE_INSTANCING":"",m.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Se,"#define MAX_BONES "+m.maxBones,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+me:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.displacementMap&&m.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.flatShading?"#define FLAT_SHADED":"",m.skinning?"#define USE_SKINNING":"",m.useVertexTexture?"#define BONE_TEXTURE":"",m.morphTargets?"#define USE_MORPHTARGETS":"",m.morphNormals&&!1===m.flatShading?"#define USE_MORPHNORMALS":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+J:"",m.sizeAttenuation?"#define USE_SIZEATTENUATION":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kd).join("\n"),_=[w,Kf(m),"#define SHADER_NAME "+m.shaderName,e,m.alphaTest?"#define ALPHATEST "+m.alphaTest+(m.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+Se,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.matcap?"#define USE_MATCAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+K:"",m.envMap?"#define "+me:"",m.envMap?"#define "+ge:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.sheen?"#define USE_SHEEN":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.gradientMap?"#define USE_GRADIENTMAP":"",m.flatShading?"#define FLAT_SHADED":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+J:"",m.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",m.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(m.extensionShaderTextureLOD||m.envMap)&&m.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",m.toneMapping!==vr?"#define TONE_MAPPING":"",m.toneMapping!==vr?Dr.tonemapping_pars_fragment:"",m.toneMapping!==vr?Rm("toneMapping",m.toneMapping):"",m.dithering?"#define DITHERING":"",Dr.encodings_pars_fragment,m.map?Od("mapTexelToLinear",m.mapEncoding):"",m.matcap?Od("matcapTexelToLinear",m.matcapEncoding):"",m.envMap?Od("envMapTexelToLinear",m.envMapEncoding):"",m.emissiveMap?Od("emissiveMapTexelToLinear",m.emissiveMapEncoding):"",m.lightMap?Od("lightMapTexelToLinear",m.lightMapEncoding):"",Nm("linearToOutputTexel",m.outputEncoding),m.depthPacking?"#define DEPTH_PACKING "+m.depthPacking:"","\n"].filter(kd).join("\n")),G=tp(G),G=dd(G,m),G=Zf(G,m),Z=tp(Z),Z=dd(Z,m),Z=Zf(Z,m),G=Qf(G),Z=Qf(Z),m.isWebGL2&&!m.isRawShaderMaterial&&(d=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+d,_=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const S=_+Z,B=Xf(E,35633,d+G),k=Xf(E,35632,S);if(E.attachShader(c,B),E.attachShader(c,k),void 0!==m.index0AttributeName?E.bindAttribLocation(c,0,m.index0AttributeName):!0===m.morphTargets&&E.bindAttribLocation(c,0,"position"),E.linkProgram(c),t.debug.checkShaderErrors){const te=E.getProgramInfoLog(c).trim(),ce=E.getShaderInfoLog(B).trim(),ue=E.getShaderInfoLog(k).trim();let _e=!0,Ee=!0;if(!1===E.getProgramParameter(c,35714)){_e=!1;const $e=Jf(E,B,"vertex"),Be=Jf(E,k,"fragment");console.error("THREE.WebGLProgram: shader error: ",E.getError(),"35715",E.getProgramParameter(c,35715),"gl.getProgramInfoLog",te,$e,Be)}else""!==te?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",te):""!==ce&&""!==ue||(Ee=!1);Ee&&(this.diagnostics={runnable:_e,programLog:te,vertexShader:{log:ce,prefix:d},fragmentShader:{log:ue,prefix:_}})}let F,V;return E.deleteShader(B),E.deleteShader(k),this.getUniforms=function(){return void 0===F&&(F=new Bp(E,c)),F},this.getAttributes=function(){return void 0===V&&(V=function(te,ce){const ue={},_e=te.getProgramParameter(ce,35721);for(let Ee=0;Ee<_e;Ee++){const $e=te.getActiveAttrib(ce,Ee).name;ue[$e]=te.getAttribLocation(ce,$e)}return ue}(E,c)),V},this.destroy=function(){g.releaseStatesOfProgram(this),E.deleteProgram(c),this.program=void 0},this.name=m.shaderName,this.id=Bm++,this.cacheKey=u,this.usedTimes=1,this.program=c,this.vertexShader=B,this.fragmentShader=k,this}function Pc(t,u,m,g){const E=[],I=m.isWebGL2,G=m.logarithmicDepthBuffer,Z=m.floatVertexTextures,J=m.maxVertexUniforms,K=m.vertexTextures;let me=m.precision;const ge={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Se=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function w(e){let c;return e?e.isTexture?c=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=e.texture.encoding):c=Zi,c}return{getParameters:function(e,c,d,_,S,B,k){const F=_.fog,te=e.envMap||(e.isMeshStandardMaterial?_.environment:null),ce=ge[e.type],ue=k.isSkinnedMesh?function(Be){const Re=Be.skeleton.bones;if(Z)return 1024;{const tt=Math.floor((J-20)/4),Ze=Math.min(tt,Re.length);return Ze<Re.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Re.length+" bones. This GPU supports "+Ze+"."),0):Ze}}(k):0;let _e,Ee;if(null!==e.precision&&(me=m.getMaxPrecision(e.precision),me!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",me,"instead.")),ce){const Be=Nc[ce];_e=Be.vertexShader,Ee=Be.fragmentShader}else _e=e.vertexShader,Ee=e.fragmentShader;const $e=t.getRenderTarget();return{isWebGL2:I,shaderID:ce,shaderName:e.type,vertexShader:_e,fragmentShader:Ee,defines:e.defines,isRawShaderMaterial:e.isRawShaderMaterial,isShaderMaterial:e.isShaderMaterial,precision:me,instancing:!0===k.isInstancedMesh,supportsVertexTextures:K,outputEncoding:null!==$e?w($e.texture):t.outputEncoding,map:!!e.map,mapEncoding:w(e.map),matcap:!!e.matcap,matcapEncoding:w(e.matcap),envMap:!!te,envMapMode:te&&te.mapping,envMapEncoding:w(te),envMapCubeUV:!!te&&(te.mapping===Ni||te.mapping===Eo),lightMap:!!e.lightMap,lightMapEncoding:w(e.lightMap),aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:w(e.emissiveMap),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Ne,tangentSpaceNormalMap:e.normalMapType===Me,clearcoatMap:!!e.clearcoatMap,clearcoatRoughnessMap:!!e.clearcoatRoughnessMap,clearcoatNormalMap:!!e.clearcoatNormalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,sheen:!!e.sheen,transmissionMap:!!e.transmissionMap,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,vertexUvs:!!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatMap||e.clearcoatRoughnessMap||e.clearcoatNormalMap||e.displacementMap||e.transmissionMap),uvsVertexOnly:!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatNormalMap||e.transmissionMap||!e.displacementMap),fog:!!F,useFog:e.fog,fogExp2:F&&F.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:G,skinning:e.skinning&&ue>0,maxBones:ue,useVertexTexture:Z,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numClippingPlanes:S,numClipIntersection:B,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&d.length>0,shadowMapType:t.shadowMap.type,toneMapping:e.toneMapped?t.toneMapping:vr,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===Y,flipSided:e.side===q,depthPacking:void 0!==e.depthPacking&&e.depthPacking,index0AttributeName:e.index0AttributeName,extensionDerivatives:e.extensions&&e.extensions.derivatives,extensionFragDepth:e.extensions&&e.extensions.fragDepth,extensionDrawBuffers:e.extensions&&e.extensions.drawBuffers,extensionShaderTextureLOD:e.extensions&&e.extensions.shaderTextureLOD,rendererExtensionFragDepth:I||null!==u.get("EXT_frag_depth"),rendererExtensionDrawBuffers:I||null!==u.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:I||null!==u.get("EXT_shader_texture_lod"),customProgramCacheKey:e.customProgramCacheKey()}},getProgramCacheKey:function(e){const c=[];if(e.shaderID?c.push(e.shaderID):(c.push(e.fragmentShader),c.push(e.vertexShader)),void 0!==e.defines)for(const d in e.defines)c.push(d),c.push(e.defines[d]);if(void 0===e.isRawShaderMaterial){for(let d=0;d<Se.length;d++)c.push(e[Se[d]]);c.push(t.outputEncoding),c.push(t.gammaFactor)}return c.push(e.customProgramCacheKey),c.join()},getUniforms:function(e){const c=ge[e.type];let d;return d=c?Ro.clone(Nc[c].uniforms):e.uniforms,d},acquireProgram:function(e,c){let d;for(let _=0,S=E.length;_<S;_++){const B=E[_];if(B.cacheKey===c){d=B,++d.usedTimes;break}}return void 0===d&&(d=new Fm(t,c,e,g),E.push(d)),d},releaseProgram:function(e){if(0==--e.usedTimes){const c=E.indexOf(e);E[c]=E[E.length-1],E.pop(),e.destroy()}},programs:E}}function Lf(){let t=new WeakMap;return{get:function(u){let m=t.get(u);return void 0===m&&(m={},t.set(u,m)),m},remove:function(u){t.delete(u)},update:function(u,m,g){t.get(u)[m]=g},dispose:function(){t=new WeakMap}}}function em(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.program!==u.program?t.program.id-u.program.id:t.material.id!==u.material.id?t.material.id-u.material.id:t.z!==u.z?t.z-u.z:t.id-u.id}function tm(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.z!==u.z?u.z-t.z:t.id-u.id}function af(t){const u=[];let m=0;const g=[],E=[],I={id:-1};function G(Z,J,K,me,ge,Se){let w=u[m];const e=t.get(K);return void 0===w?(w={id:Z.id,object:Z,geometry:J,material:K,program:e.program||I,groupOrder:me,renderOrder:Z.renderOrder,z:ge,group:Se},u[m]=w):(w.id=Z.id,w.object=Z,w.geometry=J,w.material=K,w.program=e.program||I,w.groupOrder=me,w.renderOrder=Z.renderOrder,w.z=ge,w.group=Se),m++,w}return{opaque:g,transparent:E,init:function(){m=0,g.length=0,E.length=0},push:function(Z,J,K,me,ge,Se){const w=G(Z,J,K,me,ge,Se);(!0===K.transparent?E:g).push(w)},unshift:function(Z,J,K,me,ge,Se){const w=G(Z,J,K,me,ge,Se);(!0===K.transparent?E:g).unshift(w)},finish:function(){for(let Z=m,J=u.length;Z<J;Z++){const K=u[Z];if(null===K.id)break;K.id=null,K.object=null,K.geometry=null,K.material=null,K.program=null,K.group=null}},sort:function(Z,J){g.length>1&&g.sort(Z||em),E.length>1&&E.sort(J||tm)}}}function Dm(t){let u=new WeakMap;function m(g){const E=g.target;E.removeEventListener("dispose",m),u.delete(E)}return{get:function(g,E){const I=u.get(g);let G;return void 0===I?(G=new af(t),u.set(g,new WeakMap),u.get(g).set(E,G),g.addEventListener("dispose",m)):(G=I.get(E),void 0===G&&(G=new af(t),I.set(E,G))),G},dispose:function(){u=new WeakMap}}}function nm(){const t={};return{get:function(u){if(void 0!==t[u.id])return t[u.id];let m;switch(u.type){case"DirectionalLight":m={direction:new lt,color:new ar};break;case"SpotLight":m={position:new lt,direction:new lt,color:new ar,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":m={position:new lt,color:new ar,distance:0,decay:0};break;case"HemisphereLight":m={direction:new lt,skyColor:new ar,groundColor:new ar};break;case"RectAreaLight":m={color:new ar,position:new lt,halfWidth:new lt,halfHeight:new lt}}return t[u.id]=m,m}}}let Um=0;function Bf(t,u){return(u.castShadow?1:0)-(t.castShadow?1:0)}function zm(){const t=new nm,u=function(){const G={};return{get:function(Z){if(void 0!==G[Z.id])return G[Z.id];let J;switch(Z.type){case"DirectionalLight":case"SpotLight":J={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn};break;case"PointLight":J={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn,shadowCameraNear:1,shadowCameraFar:1e3}}return G[Z.id]=J,J}}}(),m={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let G=0;G<9;G++)m.probe.push(new lt);const g=new lt,E=new ri,I=new ri;return{setup:function(G,Z,J){let K=0,me=0,ge=0;for(let V=0;V<9;V++)m.probe[V].set(0,0,0);let Se=0,w=0,e=0,c=0,d=0,_=0,S=0,B=0;const k=J.matrixWorldInverse;G.sort(Bf);for(let V=0,te=G.length;V<te;V++){const ce=G[V],ue=ce.color,_e=ce.intensity,Ee=ce.distance,$e=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)K+=ue.r*_e,me+=ue.g*_e,ge+=ue.b*_e;else if(ce.isLightProbe)for(let Be=0;Be<9;Be++)m.probe[Be].addScaledVector(ce.sh.coefficients[Be],_e);else if(ce.isDirectionalLight){const Be=t.get(ce);if(Be.color.copy(ce.color).multiplyScalar(ce.intensity),Be.direction.setFromMatrixPosition(ce.matrixWorld),g.setFromMatrixPosition(ce.target.matrixWorld),Be.direction.sub(g),Be.direction.transformDirection(k),ce.castShadow){const Re=ce.shadow,We=u.get(ce);We.shadowBias=Re.bias,We.shadowNormalBias=Re.normalBias,We.shadowRadius=Re.radius,We.shadowMapSize=Re.mapSize,m.directionalShadow[Se]=We,m.directionalShadowMap[Se]=$e,m.directionalShadowMatrix[Se]=ce.shadow.matrix,_++}m.directional[Se]=Be,Se++}else if(ce.isSpotLight){const Be=t.get(ce);if(Be.position.setFromMatrixPosition(ce.matrixWorld),Be.position.applyMatrix4(k),Be.color.copy(ue).multiplyScalar(_e),Be.distance=Ee,Be.direction.setFromMatrixPosition(ce.matrixWorld),g.setFromMatrixPosition(ce.target.matrixWorld),Be.direction.sub(g),Be.direction.transformDirection(k),Be.coneCos=Math.cos(ce.angle),Be.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),Be.decay=ce.decay,ce.castShadow){const Re=ce.shadow,We=u.get(ce);We.shadowBias=Re.bias,We.shadowNormalBias=Re.normalBias,We.shadowRadius=Re.radius,We.shadowMapSize=Re.mapSize,m.spotShadow[e]=We,m.spotShadowMap[e]=$e,m.spotShadowMatrix[e]=ce.shadow.matrix,B++}m.spot[e]=Be,e++}else if(ce.isRectAreaLight){const Be=t.get(ce);Be.color.copy(ue).multiplyScalar(_e),Be.position.setFromMatrixPosition(ce.matrixWorld),Be.position.applyMatrix4(k),I.identity(),E.copy(ce.matrixWorld),E.premultiply(k),I.extractRotation(E),Be.halfWidth.set(.5*ce.width,0,0),Be.halfHeight.set(0,.5*ce.height,0),Be.halfWidth.applyMatrix4(I),Be.halfHeight.applyMatrix4(I),m.rectArea[c]=Be,c++}else if(ce.isPointLight){const Be=t.get(ce);if(Be.position.setFromMatrixPosition(ce.matrixWorld),Be.position.applyMatrix4(k),Be.color.copy(ce.color).multiplyScalar(ce.intensity),Be.distance=ce.distance,Be.decay=ce.decay,ce.castShadow){const Re=ce.shadow,We=u.get(ce);We.shadowBias=Re.bias,We.shadowNormalBias=Re.normalBias,We.shadowRadius=Re.radius,We.shadowMapSize=Re.mapSize,We.shadowCameraNear=Re.camera.near,We.shadowCameraFar=Re.camera.far,m.pointShadow[w]=We,m.pointShadowMap[w]=$e,m.pointShadowMatrix[w]=ce.shadow.matrix,S++}m.point[w]=Be,w++}else if(ce.isHemisphereLight){const Be=t.get(ce);Be.direction.setFromMatrixPosition(ce.matrixWorld),Be.direction.transformDirection(k),Be.direction.normalize(),Be.skyColor.copy(ce.color).multiplyScalar(_e),Be.groundColor.copy(ce.groundColor).multiplyScalar(_e),m.hemi[d]=Be,d++}}m.ambient[0]=K,m.ambient[1]=me,m.ambient[2]=ge;const F=m.hash;F.directionalLength===Se&&F.pointLength===w&&F.spotLength===e&&F.rectAreaLength===c&&F.hemiLength===d&&F.numDirectionalShadows===_&&F.numPointShadows===S&&F.numSpotShadows===B||(m.directional.length=Se,m.spot.length=e,m.rectArea.length=c,m.point.length=w,m.hemi.length=d,m.directionalShadow.length=_,m.directionalShadowMap.length=_,m.pointShadow.length=S,m.pointShadowMap.length=S,m.spotShadow.length=B,m.spotShadowMap.length=B,m.directionalShadowMatrix.length=_,m.pointShadowMatrix.length=S,m.spotShadowMatrix.length=B,F.directionalLength=Se,F.pointLength=w,F.spotLength=e,F.rectAreaLength=c,F.hemiLength=d,F.numDirectionalShadows=_,F.numPointShadows=S,F.numSpotShadows=B,m.version=Um++)},state:m}}function lf(){const t=new zm,u=[],m=[];return{init:function(){u.length=0,m.length=0},state:{lightsArray:u,shadowsArray:m,lights:t},setupLights:function(g){t.setup(u,m,g)},pushLight:function(g){u.push(g)},pushShadow:function(g){m.push(g)}}}function Ud(){let t=new WeakMap;function u(m){const g=m.target;g.removeEventListener("dispose",u),t.delete(g)}return{get:function(m,g){let E;return!1===t.has(m)?(E=new lf,t.set(m,new WeakMap),t.get(m).set(g,E),m.addEventListener("dispose",u)):!1===t.get(m).has(g)?(E=new lf,t.get(m).set(g,E)):E=t.get(m).get(g),E},dispose:function(){t=new WeakMap}}}function np(t){zr.call(this),this.type="MeshDepthMaterial",this.depthPacking=W,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function ta(t){zr.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new lt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}(np.prototype=Object.create(zr.prototype)).constructor=np,np.prototype.isMeshDepthMaterial=!0,np.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(ta.prototype=Object.create(zr.prototype)).constructor=ta,ta.prototype.isMeshDistanceMaterial=!0,ta.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var Ch="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Ic="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function sc(t,u,m){let g=new eu;const E=new wn,I=new wn,G=new xi,Z=[],J=[],K={},me={0:q,1:le,2:Y},ge=new uo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new wn},radius:{value:4}},vertexShader:Ic,fragmentShader:Ch}),Se=ge.clone();Se.defines.HORIZONAL_PASS=1;const w=new hn;w.setAttribute("position",new Vr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const e=new Ci(w,ge),c=this;function d(F,V){const te=u.update(e);ge.uniforms.shadow_pass.value=F.map.texture,ge.uniforms.resolution.value=F.mapSize,ge.uniforms.radius.value=F.radius,t.setRenderTarget(F.mapPass),t.clear(),t.renderBufferDirect(V,null,te,ge,e,null),Se.uniforms.shadow_pass.value=F.mapPass.texture,Se.uniforms.resolution.value=F.mapSize,Se.uniforms.radius.value=F.radius,t.setRenderTarget(F.map),t.clear(),t.renderBufferDirect(V,null,te,Se,e,null)}function _(F,V,te){const ce=F<<0|V<<1|te<<2;let ue=Z[ce];return void 0===ue&&(ue=new np({depthPacking:pe,morphTargets:F,skinning:V}),Z[ce]=ue),ue}function S(F,V,te){const ce=F<<0|V<<1|te<<2;let ue=J[ce];return void 0===ue&&(ue=new ta({morphTargets:F,skinning:V}),J[ce]=ue),ue}function B(F,V,te,ce,ue,_e,Ee){let $e=null,Be=_,Re=F.customDepthMaterial;if(!0===ce.isPointLight&&(Be=S,Re=F.customDistanceMaterial),void 0===Re){let We=!1;!0===te.morphTargets&&(We=V.morphAttributes&&V.morphAttributes.position&&V.morphAttributes.position.length>0);let tt=!1;!0===F.isSkinnedMesh&&(!0===te.skinning?tt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",F)),$e=Be(We,tt,!0===F.isInstancedMesh)}else $e=Re;if(t.localClippingEnabled&&!0===te.clipShadows&&0!==te.clippingPlanes.length){const We=$e.uuid,tt=te.uuid;let Ze=K[We];void 0===Ze&&(Ze={},K[We]=Ze);let ot=Ze[tt];void 0===ot&&(ot=$e.clone(),Ze[tt]=ot),$e=ot}return $e.visible=te.visible,$e.wireframe=te.wireframe,$e.side=Ee===fe?null!==te.shadowSide?te.shadowSide:te.side:null!==te.shadowSide?te.shadowSide:me[te.side],$e.clipShadows=te.clipShadows,$e.clippingPlanes=te.clippingPlanes,$e.clipIntersection=te.clipIntersection,$e.wireframeLinewidth=te.wireframeLinewidth,$e.linewidth=te.linewidth,!0===ce.isPointLight&&!0===$e.isMeshDistanceMaterial&&($e.referencePosition.setFromMatrixPosition(ce.matrixWorld),$e.nearDistance=ue,$e.farDistance=_e),$e}function k(F,V,te,ce,ue){if(!1===F.visible)return;if(F.layers.test(V.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&ue===fe)&&(!F.frustumCulled||g.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,F.matrixWorld);const Ee=u.update(F),$e=F.material;if(Array.isArray($e)){const Be=Ee.groups;for(let Re=0,We=Be.length;Re<We;Re++){const tt=Be[Re],Ze=$e[tt.materialIndex];if(Ze&&Ze.visible){const ot=B(F,Ee,Ze,ce,te.near,te.far,ue);t.renderBufferDirect(te,null,Ee,ot,F,tt)}}}else if($e.visible){const Be=B(F,Ee,$e,ce,te.near,te.far,ue);t.renderBufferDirect(te,null,Ee,Be,F,null)}}const _e=F.children;for(let Ee=0,$e=_e.length;Ee<$e;Ee++)k(_e[Ee],V,te,ce,ue)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=he,this.render=function(F,V,te){if(!1===c.enabled||!1===c.autoUpdate&&!1===c.needsUpdate||0===F.length)return;const ce=t.getRenderTarget(),ue=t.getActiveCubeFace(),_e=t.getActiveMipmapLevel(),Ee=t.state;Ee.setBlending(X),Ee.buffers.color.setClear(1,1,1,1),Ee.buffers.depth.setTest(!0),Ee.setScissorTest(!1);for(let $e=0,Be=F.length;$e<Be;$e++){const Re=F[$e],We=Re.shadow;if(!1===We.autoUpdate&&!1===We.needsUpdate)continue;if(void 0===We){console.warn("THREE.WebGLShadowMap:",Re,"has no shadow.");continue}E.copy(We.mapSize);const tt=We.getFrameExtents();if(E.multiply(tt),I.copy(We.mapSize),(E.x>m||E.y>m)&&(E.x>m&&(I.x=Math.floor(m/tt.x),E.x=I.x*tt.x,We.mapSize.x=I.x),E.y>m&&(I.y=Math.floor(m/tt.y),E.y=I.y*tt.y,We.mapSize.y=I.y)),null===We.map&&!We.isPointLightShadow&&this.type===fe){const ot={minFilter:ai,magFilter:ai,format:lo,stencilBuffer:!1};We.map=new Us(E.x,E.y,ot),We.map.texture.name=Re.name+".shadowMap",We.mapPass=new Us(E.x,E.y,ot),We.camera.updateProjectionMatrix()}null===We.map&&(We.map=new Us(E.x,E.y,{minFilter:Ir,magFilter:Ir,format:lo,stencilBuffer:!1}),We.map.texture.name=Re.name+".shadowMap",We.camera.updateProjectionMatrix()),t.setRenderTarget(We.map),t.clear();const Ze=We.getViewportCount();for(let ot=0;ot<Ze;ot++){const st=We.getViewport(ot);G.set(I.x*st.x,I.y*st.y,I.x*st.z,I.y*st.w),Ee.viewport(G),We.updateMatrices(Re,ot),g=We.getFrustum(),k(V,te,We.camera,Re,this.type)}We.isPointLightShadow||this.type!==fe||d(We,te),We.needsUpdate=!1}c.needsUpdate=!1,t.setRenderTarget(ce,ue,_e)}}function ac(t,u,m){const g=m.isWebGL2,E=new function(){let ct=!1;const Lt=new xi;let _t=null;const zt=new xi(0,0,0,0);return{setMask:function(Rt){_t===Rt||ct||(t.colorMask(Rt,Rt,Rt,Rt),_t=Rt)},setLocked:function(Rt){ct=Rt},setClear:function(Rt,nn,en,En,rt){!0===rt&&(Rt*=En,nn*=En,en*=En),Lt.set(Rt,nn,en,En),!1===zt.equals(Lt)&&(t.clearColor(Rt,nn,en,En),zt.copy(Lt))},reset:function(){ct=!1,_t=null,zt.set(-1,0,0,0)}}},I=new function(){let ct=!1,Lt=null,_t=null,zt=null;return{setTest:function(Rt){Rt?Ze(2929):ot(2929)},setMask:function(Rt){Lt===Rt||ct||(t.depthMask(Rt),Lt=Rt)},setFunc:function(Rt){if(_t!==Rt){if(Rt)switch(Rt){case On:t.depthFunc(512);break;case Ln:t.depthFunc(519);break;case mn:t.depthFunc(513);break;case cr:t.depthFunc(515);break;case ir:t.depthFunc(514);break;case ur:t.depthFunc(518);break;case or:t.depthFunc(516);break;case ni:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);_t=Rt}},setLocked:function(Rt){ct=Rt},setClear:function(Rt){zt!==Rt&&(t.clearDepth(Rt),zt=Rt)},reset:function(){ct=!1,Lt=null,_t=null,zt=null}}},G=new function(){let ct=!1,Lt=null,_t=null,zt=null,Rt=null,nn=null,en=null,En=null,rt=null;return{setTest:function(ut){ct||(ut?Ze(2960):ot(2960))},setMask:function(ut){Lt===ut||ct||(t.stencilMask(ut),Lt=ut)},setFunc:function(ut,rn,un){_t===ut&&zt===rn&&Rt===un||(t.stencilFunc(ut,rn,un),_t=ut,zt=rn,Rt=un)},setOp:function(ut,rn,un){nn===ut&&en===rn&&En===un||(t.stencilOp(ut,rn,un),nn=ut,en=rn,En=un)},setLocked:function(ut){ct=ut},setClear:function(ut){rt!==ut&&(t.clearStencil(ut),rt=ut)},reset:function(){ct=!1,Lt=null,_t=null,zt=null,Rt=null,nn=null,en=null,En=null,rt=null}}};let Z={},J=null,K=null,me=null,ge=null,Se=null,w=null,e=null,c=null,d=null,_=!1,S=null,B=null,k=null,F=null,V=null;const te=t.getParameter(35661);let ce=!1,ue=0;const _e=t.getParameter(7938);-1!==_e.indexOf("WebGL")?(ue=parseFloat(/^WebGL\ ([0-9])/.exec(_e)[1]),ce=ue>=1):-1!==_e.indexOf("OpenGL ES")&&(ue=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(_e)[1]),ce=ue>=2);let Ee=null,$e={};const Be=new xi,Re=new xi;function We(ct,Lt,_t){const zt=new Uint8Array(4),Rt=t.createTexture();t.bindTexture(ct,Rt),t.texParameteri(ct,10241,9728),t.texParameteri(ct,10240,9728);for(let nn=0;nn<_t;nn++)t.texImage2D(Lt+nn,0,6408,1,1,0,6408,5121,zt);return Rt}const tt={};function Ze(ct){!0!==Z[ct]&&(t.enable(ct),Z[ct]=!0)}function ot(ct){!1!==Z[ct]&&(t.disable(ct),Z[ct]=!1)}tt[3553]=We(3553,3553,1),tt[34067]=We(34067,34069,6),E.setClear(0,0,0,1),I.setClear(1),G.setClear(0),Ze(2929),I.setFunc(cr),Qe(!1),nt(M),Ze(2884),Ft(X);const st={[Pe]:32774,[Ge]:32778,[Ae]:32779};if(g)st[Xe]=32775,st[Ke]=32776;else{const ct=u.get("EXT_blend_minmax");null!==ct&&(st[Xe]=ct.MIN_EXT,st[Ke]=ct.MAX_EXT)}const Ct={[yt]:0,[dt]:1,[Pt]:768,[Gt]:770,[dn]:776,[Mn]:774,[sn]:772,[wt]:769,[Dt]:771,[Bn]:775,[gt]:773};function Ft(ct,Lt,_t,zt,Rt,nn,en,En){if(ct!==X){if(K||(Ze(3042),K=!0),ct===xe)Rt=Rt||Lt,nn=nn||_t,en=en||zt,Lt===ge&&Rt===e||(t.blendEquationSeparate(st[Lt],st[Rt]),ge=Lt,e=Rt),_t===Se&&zt===w&&nn===c&&en===d||(t.blendFuncSeparate(Ct[_t],Ct[zt],Ct[nn],Ct[en]),Se=_t,w=zt,c=nn,d=en),me=ct,_=null;else if(ct!==me||En!==_){if(ge===Pe&&e===Pe||(t.blendEquation(32774),ge=Pe,e=Pe),En)switch(ct){case oe:t.blendFuncSeparate(1,771,1,771);break;case H:t.blendFunc(1,1);break;case Ce:t.blendFuncSeparate(0,0,769,771);break;case Q:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}else switch(ct){case oe:t.blendFuncSeparate(770,771,1,771);break;case H:t.blendFunc(770,1);break;case Ce:t.blendFunc(0,769);break;case Q:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}Se=null,w=null,c=null,d=null,me=ct,_=En}}else K&&(ot(3042),K=!1)}function Qe(ct){S!==ct&&(t.frontFace(ct?2304:2305),S=ct)}function nt(ct){ct!==z?(Ze(2884),ct!==B&&t.cullFace(ct===M?1029:ct===P?1028:1032)):ot(2884),B=ct}function Et(ct,Lt,_t){ct?(Ze(32823),F===Lt&&V===_t||(t.polygonOffset(Lt,_t),F=Lt,V=_t)):ot(32823)}function Jt(ct){void 0===ct&&(ct=33984+te-1),Ee!==ct&&(t.activeTexture(ct),Ee=ct)}return{buffers:{color:E,depth:I,stencil:G},enable:Ze,disable:ot,useProgram:function(ct){return J!==ct&&(t.useProgram(ct),J=ct,!0)},setBlending:Ft,setMaterial:function(ct,Lt){ct.side===Y?ot(2884):Ze(2884);let _t=ct.side===q;Lt&&(_t=!_t),Qe(_t),ct.blending===oe&&!1===ct.transparent?Ft(X):Ft(ct.blending,ct.blendEquation,ct.blendSrc,ct.blendDst,ct.blendEquationAlpha,ct.blendSrcAlpha,ct.blendDstAlpha,ct.premultipliedAlpha),I.setFunc(ct.depthFunc),I.setTest(ct.depthTest),I.setMask(ct.depthWrite),E.setMask(ct.colorWrite);const zt=ct.stencilWrite;G.setTest(zt),zt&&(G.setMask(ct.stencilWriteMask),G.setFunc(ct.stencilFunc,ct.stencilRef,ct.stencilFuncMask),G.setOp(ct.stencilFail,ct.stencilZFail,ct.stencilZPass)),Et(ct.polygonOffset,ct.polygonOffsetFactor,ct.polygonOffsetUnits)},setFlipSided:Qe,setCullFace:nt,setLineWidth:function(ct){ct!==k&&(ce&&t.lineWidth(ct),k=ct)},setPolygonOffset:Et,setScissorTest:function(ct){ct?Ze(3089):ot(3089)},activeTexture:Jt,bindTexture:function(ct,Lt){null===Ee&&Jt();let _t=$e[Ee];void 0===_t&&(_t={type:void 0,texture:void 0},$e[Ee]=_t),_t.type===ct&&_t.texture===Lt||(t.bindTexture(ct,Lt||tt[ct]),_t.type=ct,_t.texture=Lt)},unbindTexture:function(){const ct=$e[Ee];void 0!==ct&&void 0!==ct.type&&(t.bindTexture(ct.type,null),ct.type=void 0,ct.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},scissor:function(ct){!1===Be.equals(ct)&&(t.scissor(ct.x,ct.y,ct.z,ct.w),Be.copy(ct))},viewport:function(ct){!1===Re.equals(ct)&&(t.viewport(ct.x,ct.y,ct.z,ct.w),Re.copy(ct))},reset:function(){Z={},Ee=null,$e={},J=null,me=null,S=null,B=null,E.reset(),I.reset(),G.reset()}}}function fd(t,u,m,g,E,I,G){const Z=E.isWebGL2,J=E.maxTextures,K=E.maxCubemapSize,me=E.maxTextureSize,ge=E.maxSamples,Se=new WeakMap;let w,e=!1;try{e=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function c(Qe,nt){return e?new OffscreenCanvas(Qe,nt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function d(Qe,nt,Et,Jt){let ct=1;if((Qe.width>Jt||Qe.height>Jt)&&(ct=Jt/Math.max(Qe.width,Qe.height)),ct<1||!0===nt){if(typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Qe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Qe instanceof ImageBitmap){const Lt=nt?tr.floorPowerOfTwo:Math.floor,_t=Lt(ct*Qe.width),zt=Lt(ct*Qe.height);void 0===w&&(w=c(_t,zt));const Rt=Et?c(_t,zt):w;return Rt.width=_t,Rt.height=zt,Rt.getContext("2d").drawImage(Qe,0,0,_t,zt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Qe.width+"x"+Qe.height+") to ("+_t+"x"+zt+")."),Rt}return"data"in Qe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Qe.width+"x"+Qe.height+")."),Qe}return Qe}function _(Qe){return tr.isPowerOfTwo(Qe.width)&&tr.isPowerOfTwo(Qe.height)}function S(Qe,nt){return Qe.generateMipmaps&&nt&&Qe.minFilter!==Ir&&Qe.minFilter!==ai}function B(Qe,nt,Et,Jt){t.generateMipmap(Qe),g.get(nt).__maxMipLevel=Math.log(Math.max(Et,Jt))*Math.LOG2E}function k(Qe,nt,Et){if(!1===Z)return nt;if(null!==Qe){if(void 0!==t[Qe])return t[Qe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Qe+"'")}let Jt=nt;return 6403===nt&&(5126===Et&&(Jt=33326),5131===Et&&(Jt=33325),5121===Et&&(Jt=33321)),6407===nt&&(5126===Et&&(Jt=34837),5131===Et&&(Jt=34843),5121===Et&&(Jt=32849)),6408===nt&&(5126===Et&&(Jt=34836),5131===Et&&(Jt=34842),5121===Et&&(Jt=32856)),33325!==Jt&&33326!==Jt&&34842!==Jt&&34836!==Jt||u.get("EXT_color_buffer_float"),Jt}function F(Qe){return Qe===Ir||Qe===Va||Qe===hs?9728:9729}function V(Qe){const nt=Qe.target;nt.removeEventListener("dispose",V),function(Et){const Jt=g.get(Et);void 0!==Jt.__webglInit&&(t.deleteTexture(Jt.__webglTexture),g.remove(Et))}(nt),nt.isVideoTexture&&Se.delete(nt),G.memory.textures--}function te(Qe){const nt=Qe.target;nt.removeEventListener("dispose",te),function(Et){const Jt=g.get(Et),ct=g.get(Et.texture);if(Et){if(void 0!==ct.__webglTexture&&t.deleteTexture(ct.__webglTexture),Et.depthTexture&&Et.depthTexture.dispose(),Et.isWebGLCubeRenderTarget)for(let Lt=0;Lt<6;Lt++)t.deleteFramebuffer(Jt.__webglFramebuffer[Lt]),Jt.__webglDepthbuffer&&t.deleteRenderbuffer(Jt.__webglDepthbuffer[Lt]);else t.deleteFramebuffer(Jt.__webglFramebuffer),Jt.__webglDepthbuffer&&t.deleteRenderbuffer(Jt.__webglDepthbuffer),Jt.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Jt.__webglMultisampledFramebuffer),Jt.__webglColorRenderbuffer&&t.deleteRenderbuffer(Jt.__webglColorRenderbuffer),Jt.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Jt.__webglDepthRenderbuffer);g.remove(Et.texture),g.remove(Et)}}(nt),G.memory.textures--}let ce=0;function ue(Qe,nt){const Et=g.get(Qe);if(Qe.isVideoTexture&&function(Jt){const ct=G.render.frame;Se.get(Jt)!==ct&&(Se.set(Jt,ct),Jt.update())}(Qe),Qe.version>0&&Et.__version!==Qe.version){const Jt=Qe.image;if(void 0===Jt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Jt.complete)return void tt(Et,Qe,nt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}m.activeTexture(33984+nt),m.bindTexture(3553,Et.__webglTexture)}function _e(Qe,nt){if(6!==Qe.image.length)return;const Et=g.get(Qe);if(Qe.version>0&&Et.__version!==Qe.version){We(Et,Qe),m.activeTexture(33984+nt),m.bindTexture(34067,Et.__webglTexture),t.pixelStorei(37440,Qe.flipY);const Jt=Qe&&(Qe.isCompressedTexture||Qe.image[0].isCompressedTexture),ct=Qe.image[0]&&Qe.image[0].isDataTexture,Lt=[];for(let rt=0;rt<6;rt++)Lt[rt]=Jt||ct?ct?Qe.image[rt].image:Qe.image[rt]:d(Qe.image[rt],!1,!0,K);const _t=Lt[0],zt=_(_t)||Z,Rt=I.convert(Qe.format),nn=I.convert(Qe.type),en=k(Qe.internalFormat,Rt,nn);let En;if(Re(34067,Qe,zt),Jt){for(let rt=0;rt<6;rt++){En=Lt[rt].mipmaps;for(let ut=0;ut<En.length;ut++){const rn=En[ut];Qe.format!==lo&&Qe.format!==Fs?null!==Rt?m.compressedTexImage2D(34069+rt,ut,en,rn.width,rn.height,0,rn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(34069+rt,ut,en,rn.width,rn.height,0,Rt,nn,rn.data)}}Et.__maxMipLevel=En.length-1}else{En=Qe.mipmaps;for(let rt=0;rt<6;rt++)if(ct){m.texImage2D(34069+rt,0,en,Lt[rt].width,Lt[rt].height,0,Rt,nn,Lt[rt].data);for(let ut=0;ut<En.length;ut++){const rn=En[ut].image[rt].image;m.texImage2D(34069+rt,ut+1,en,rn.width,rn.height,0,Rt,nn,rn.data)}}else{m.texImage2D(34069+rt,0,en,Rt,nn,Lt[rt]);for(let ut=0;ut<En.length;ut++)m.texImage2D(34069+rt,ut+1,en,Rt,nn,En[ut].image[rt])}Et.__maxMipLevel=En.length}S(Qe,zt)&&B(34067,Qe,_t.width,_t.height),Et.__version=Qe.version,Qe.onUpdate&&Qe.onUpdate(Qe)}else m.activeTexture(33984+nt),m.bindTexture(34067,Et.__webglTexture)}function Ee(Qe,nt){m.activeTexture(33984+nt),m.bindTexture(34067,g.get(Qe).__webglTexture)}const $e={[vo]:10497,[Jr]:33071,[os]:33648},Be={[Ir]:9728,[Va]:9984,[hs]:9986,[ai]:9729,[Gc]:9985,[sl]:9987};function Re(Qe,nt,Et){Et?(t.texParameteri(Qe,10242,$e[nt.wrapS]),t.texParameteri(Qe,10243,$e[nt.wrapT]),32879!==Qe&&35866!==Qe||t.texParameteri(Qe,32882,$e[nt.wrapR]),t.texParameteri(Qe,10240,Be[nt.magFilter]),t.texParameteri(Qe,10241,Be[nt.minFilter])):(t.texParameteri(Qe,10242,33071),t.texParameteri(Qe,10243,33071),32879!==Qe&&35866!==Qe||t.texParameteri(Qe,32882,33071),nt.wrapS===Jr&&nt.wrapT===Jr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Qe,10240,F(nt.magFilter)),t.texParameteri(Qe,10241,F(nt.minFilter)),nt.minFilter!==Ir&&nt.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Jt=u.get("EXT_texture_filter_anisotropic");if(Jt){if(nt.type===Xo&&null===u.get("OES_texture_float_linear")||nt.type===ps&&null===(Z||u.get("OES_texture_half_float_linear")))return;(nt.anisotropy>1||g.get(nt).__currentAnisotropy)&&(t.texParameterf(Qe,Jt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(nt.anisotropy,E.getMaxAnisotropy())),g.get(nt).__currentAnisotropy=nt.anisotropy)}}function We(Qe,nt){void 0===Qe.__webglInit&&(Qe.__webglInit=!0,nt.addEventListener("dispose",V),Qe.__webglTexture=t.createTexture(),G.memory.textures++)}function tt(Qe,nt,Et){let Jt=3553;nt.isDataTexture2DArray&&(Jt=35866),nt.isDataTexture3D&&(Jt=32879),We(Qe,nt),m.activeTexture(33984+Et),m.bindTexture(Jt,Qe.__webglTexture),t.pixelStorei(37440,nt.flipY),t.pixelStorei(37441,nt.premultiplyAlpha),t.pixelStorei(3317,nt.unpackAlignment);const ct=(rt=nt,!Z&&(rt.wrapS!==Jr||rt.wrapT!==Jr||rt.minFilter!==Ir&&rt.minFilter!==ai)&&!1===_(nt.image)),Lt=d(nt.image,ct,!1,me),_t=_(Lt)||Z,zt=I.convert(nt.format);var rt;let Rt,nn=I.convert(nt.type),en=k(nt.internalFormat,zt,nn);Re(Jt,nt,_t);const En=nt.mipmaps;if(nt.isDepthTexture)en=6402,Z?en=nt.type===Xo?36012:nt.type===Js?33190:nt.type===Ms?35056:33189:nt.type===Xo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),nt.format===To&&6402===en&&nt.type!==Hc&&nt.type!==Js&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),nt.type=Hc,nn=I.convert(nt.type)),nt.format===Zs&&6402===en&&(en=34041,nt.type!==Ms&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),nt.type=Ms,nn=I.convert(nt.type))),m.texImage2D(3553,0,en,Lt.width,Lt.height,0,zt,nn,null);else if(nt.isDataTexture)if(En.length>0&&_t){for(let rt=0,ut=En.length;rt<ut;rt++)Rt=En[rt],m.texImage2D(3553,rt,en,Rt.width,Rt.height,0,zt,nn,Rt.data);nt.generateMipmaps=!1,Qe.__maxMipLevel=En.length-1}else m.texImage2D(3553,0,en,Lt.width,Lt.height,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(nt.isCompressedTexture){for(let rt=0,ut=En.length;rt<ut;rt++)Rt=En[rt],nt.format!==lo&&nt.format!==Fs?null!==zt?m.compressedTexImage2D(3553,rt,en,Rt.width,Rt.height,0,Rt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(3553,rt,en,Rt.width,Rt.height,0,zt,nn,Rt.data);Qe.__maxMipLevel=En.length-1}else if(nt.isDataTexture2DArray)m.texImage3D(35866,0,en,Lt.width,Lt.height,Lt.depth,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(nt.isDataTexture3D)m.texImage3D(32879,0,en,Lt.width,Lt.height,Lt.depth,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(En.length>0&&_t){for(let rt=0,ut=En.length;rt<ut;rt++)Rt=En[rt],m.texImage2D(3553,rt,en,zt,nn,Rt);nt.generateMipmaps=!1,Qe.__maxMipLevel=En.length-1}else m.texImage2D(3553,0,en,zt,nn,Lt),Qe.__maxMipLevel=0;S(nt,_t)&&B(Jt,nt,Lt.width,Lt.height),Qe.__version=nt.version,nt.onUpdate&&nt.onUpdate(nt)}function Ze(Qe,nt,Et,Jt){const ct=I.convert(nt.texture.format),Lt=I.convert(nt.texture.type),_t=k(nt.texture.internalFormat,ct,Lt);m.texImage2D(Jt,0,_t,nt.width,nt.height,0,ct,Lt,null),t.bindFramebuffer(36160,Qe),t.framebufferTexture2D(36160,Et,Jt,g.get(nt.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function ot(Qe,nt,Et){if(t.bindRenderbuffer(36161,Qe),nt.depthBuffer&&!nt.stencilBuffer){let Jt=33189;if(Et){const ct=nt.depthTexture;ct&&ct.isDepthTexture&&(ct.type===Xo?Jt=36012:ct.type===Js&&(Jt=33190));const Lt=st(nt);t.renderbufferStorageMultisample(36161,Lt,Jt,nt.width,nt.height)}else t.renderbufferStorage(36161,Jt,nt.width,nt.height);t.framebufferRenderbuffer(36160,36096,36161,Qe)}else if(nt.depthBuffer&&nt.stencilBuffer){if(Et){const Jt=st(nt);t.renderbufferStorageMultisample(36161,Jt,35056,nt.width,nt.height)}else t.renderbufferStorage(36161,34041,nt.width,nt.height);t.framebufferRenderbuffer(36160,33306,36161,Qe)}else{const Jt=I.convert(nt.texture.format),ct=I.convert(nt.texture.type),Lt=k(nt.texture.internalFormat,Jt,ct);if(Et){const _t=st(nt);t.renderbufferStorageMultisample(36161,_t,Lt,nt.width,nt.height)}else t.renderbufferStorage(36161,Lt,nt.width,nt.height)}t.bindRenderbuffer(36161,null)}function st(Qe){return Z&&Qe.isWebGLMultisampleRenderTarget?Math.min(ge,Qe.samples):0}let Ct=!1,Ft=!1;this.allocateTextureUnit=function(){const Qe=ce;return Qe>=J&&console.warn("THREE.WebGLTextures: Trying to use "+Qe+" texture units while this GPU supports only "+J),ce+=1,Qe},this.resetTextureUnits=function(){ce=0},this.setTexture2D=ue,this.setTexture2DArray=function(Qe,nt){const Et=g.get(Qe);Qe.version>0&&Et.__version!==Qe.version?tt(Et,Qe,nt):(m.activeTexture(33984+nt),m.bindTexture(35866,Et.__webglTexture))},this.setTexture3D=function(Qe,nt){const Et=g.get(Qe);Qe.version>0&&Et.__version!==Qe.version?tt(Et,Qe,nt):(m.activeTexture(33984+nt),m.bindTexture(32879,Et.__webglTexture))},this.setTextureCube=_e,this.setTextureCubeDynamic=Ee,this.setupRenderTarget=function(Qe){const nt=g.get(Qe),Et=g.get(Qe.texture);Qe.addEventListener("dispose",te),Et.__webglTexture=t.createTexture(),G.memory.textures++;const Jt=!0===Qe.isWebGLCubeRenderTarget,ct=!0===Qe.isWebGLMultisampleRenderTarget,Lt=_(Qe)||Z;if(!Z||Qe.texture.format!==Fs||Qe.texture.type!==Xo&&Qe.texture.type!==ps||(Qe.texture.format=lo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Jt){nt.__webglFramebuffer=[];for(let _t=0;_t<6;_t++)nt.__webglFramebuffer[_t]=t.createFramebuffer()}else if(nt.__webglFramebuffer=t.createFramebuffer(),ct)if(Z){nt.__webglMultisampledFramebuffer=t.createFramebuffer(),nt.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,nt.__webglColorRenderbuffer);const _t=I.convert(Qe.texture.format),zt=I.convert(Qe.texture.type),Rt=k(Qe.texture.internalFormat,_t,zt),nn=st(Qe);t.renderbufferStorageMultisample(36161,nn,Rt,Qe.width,Qe.height),t.bindFramebuffer(36160,nt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,nt.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),Qe.depthBuffer&&(nt.__webglDepthRenderbuffer=t.createRenderbuffer(),ot(nt.__webglDepthRenderbuffer,Qe,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Jt){m.bindTexture(34067,Et.__webglTexture),Re(34067,Qe.texture,Lt);for(let _t=0;_t<6;_t++)Ze(nt.__webglFramebuffer[_t],Qe,36064,34069+_t);S(Qe.texture,Lt)&&B(34067,Qe.texture,Qe.width,Qe.height),m.bindTexture(34067,null)}else m.bindTexture(3553,Et.__webglTexture),Re(3553,Qe.texture,Lt),Ze(nt.__webglFramebuffer,Qe,36064,3553),S(Qe.texture,Lt)&&B(3553,Qe.texture,Qe.width,Qe.height),m.bindTexture(3553,null);Qe.depthBuffer&&function(_t){const zt=g.get(_t),Rt=!0===_t.isWebGLCubeRenderTarget;if(_t.depthTexture){if(Rt)throw new Error("target.depthTexture not supported in Cube render targets");!function(nn,en){if(en&&en.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,nn),!en.depthTexture||!en.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(en.depthTexture).__webglTexture&&en.depthTexture.image.width===en.width&&en.depthTexture.image.height===en.height||(en.depthTexture.image.width=en.width,en.depthTexture.image.height=en.height,en.depthTexture.needsUpdate=!0),ue(en.depthTexture,0);const En=g.get(en.depthTexture).__webglTexture;if(en.depthTexture.format===To)t.framebufferTexture2D(36160,36096,3553,En,0);else{if(en.depthTexture.format!==Zs)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,En,0)}}(zt.__webglFramebuffer,_t)}else if(Rt){zt.__webglDepthbuffer=[];for(let nn=0;nn<6;nn++)t.bindFramebuffer(36160,zt.__webglFramebuffer[nn]),zt.__webglDepthbuffer[nn]=t.createRenderbuffer(),ot(zt.__webglDepthbuffer[nn],_t,!1)}else t.bindFramebuffer(36160,zt.__webglFramebuffer),zt.__webglDepthbuffer=t.createRenderbuffer(),ot(zt.__webglDepthbuffer,_t,!1);t.bindFramebuffer(36160,null)}(Qe)},this.updateRenderTargetMipmap=function(Qe){const nt=Qe.texture;if(S(nt,_(Qe)||Z)){const Et=Qe.isWebGLCubeRenderTarget?34067:3553,Jt=g.get(nt).__webglTexture;m.bindTexture(Et,Jt),B(Et,nt,Qe.width,Qe.height),m.bindTexture(Et,null)}},this.updateMultisampleRenderTarget=function(Qe){if(Qe.isWebGLMultisampleRenderTarget)if(Z){const nt=g.get(Qe);t.bindFramebuffer(36008,nt.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,nt.__webglFramebuffer);const Et=Qe.width,Jt=Qe.height;let ct=16384;Qe.depthBuffer&&(ct|=256),Qe.stencilBuffer&&(ct|=1024),t.blitFramebuffer(0,0,Et,Jt,0,0,Et,Jt,ct,9728),t.bindFramebuffer(36160,nt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Qe,nt){Qe&&Qe.isWebGLRenderTarget&&(!1===Ct&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ct=!0),Qe=Qe.texture),ue(Qe,nt)},this.safeSetTextureCube=function(Qe,nt){Qe&&Qe.isWebGLCubeRenderTarget&&(!1===Ft&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ft=!0),Qe=Qe.texture),Qe&&Qe.isCubeTexture||Array.isArray(Qe.image)&&6===Qe.image.length?_e(Qe,nt):Ee(Qe,nt)}}function zd(t,u,m){const g=m.isWebGL2;return{convert:function(E){let I;if(E===ha)return 5121;if(E===Vu)return 32819;if(E===du)return 32820;if(E===fu)return 33635;if(E===Wl)return 5120;if(E===Wa)return 5122;if(E===Hc)return 5123;if(E===Hp)return 5124;if(E===Js)return 5125;if(E===Xo)return 5126;if(E===ps)return g?5131:(I=u.get("OES_texture_half_float"),null!==I?I.HALF_FLOAT_OES:null);if(E===dp)return 6406;if(E===Fs)return 6407;if(E===lo)return 6408;if(E===Vc)return 6409;if(E===Wu)return 6410;if(E===To)return 6402;if(E===Zs)return 34041;if(E===Vp)return 6403;if(E===ll)return 36244;if(E===mu)return 33319;if(E===fp)return 33320;if(E===mp)return 36248;if(E===yh)return 36249;if(E===Fh||E===mc||E===Dh||E===bh){if(I=u.get("WEBGL_compressed_texture_s3tc"),null===I)return null;if(E===Fh)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(E===mc)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(E===Dh)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(E===bh)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(E===Uh||E===Tl||E===Ml||E===ql){if(I=u.get("WEBGL_compressed_texture_pvrtc"),null===I)return null;if(E===Uh)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(E===Tl)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(E===Ml)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(E===ql)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(E===qu)return I=u.get("WEBGL_compressed_texture_etc1"),null!==I?I.COMPRESSED_RGB_ETC1_WEBGL:null;if((E===ds||E===Xl)&&(I=u.get("WEBGL_compressed_texture_etc"),null!==I)){if(E===ds)return I.COMPRESSED_RGB8_ETC2;if(E===Xl)return I.COMPRESSED_RGBA8_ETC2_EAC}return E===Xu||E===_p||E===gp||E===Wc||E===_c||E===xh||E===vp||E===Yu||E===Ju||E===cl||E===zh||E===ul||E===jh||E===Zu||E===yc||E===wh||E===_u||E===qc||E===yp||E===Xc||E===Qu||E===Yl||E===bp||E===Gh||E===xp||E===wp||E===Hh||E===Wp?(I=u.get("WEBGL_compressed_texture_astc"),null!==I?E:null):E===vc?(I=u.get("EXT_texture_compression_bptc"),null!==I?E:null):E===Ms?g?34042:(I=u.get("WEBGL_depth_texture"),null!==I?I.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function md(t){Rs.call(this),this.cameras=t||[]}function wa(){Kn.call(this),this.type="Group"}function Np(){this._targetRay=null,this._grip=null,this._hand=null}function cf(t,u){const m=this;let g=null,E=1,I=null,G="local-floor",Z=null;const J=[],K=new Map,me=new Rs;me.layers.enable(1),me.viewport=new xi;const ge=new Rs;ge.layers.enable(2),ge.viewport=new xi;const Se=[me,ge],w=new md;w.layers.enable(1),w.layers.enable(2);let e=null,c=null;function d(ue){const _e=K.get(ue.inputSource);_e&&_e.dispatchEvent({type:ue.type})}function _(){K.forEach(function(ue,_e){ue.disconnect(_e)}),K.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),ce.stop(),m.isPresenting=!1,m.dispatchEvent({type:"sessionend"})}function S(ue){I=ue,ce.setContext(g),ce.start(),m.isPresenting=!0,m.dispatchEvent({type:"sessionstart"})}function B(ue){const _e=g.inputSources;for(let Ee=0;Ee<J.length;Ee++)K.set(_e[Ee],J[Ee]);for(let Ee=0;Ee<ue.removed.length;Ee++){const $e=ue.removed[Ee],Be=K.get($e);Be&&(Be.dispatchEvent({type:"disconnected",data:$e}),K.delete($e))}for(let Ee=0;Ee<ue.added.length;Ee++){const $e=ue.added[Ee],Be=K.get($e);Be&&Be.dispatchEvent({type:"connected",data:$e})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let _e=J[ue];return void 0===_e&&(_e=new Np,J[ue]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(ue){let _e=J[ue];return void 0===_e&&(_e=new Np,J[ue]=_e),_e.getGripSpace()},this.getHand=function(ue){let _e=J[ue];return void 0===_e&&(_e=new Np,J[ue]=_e),_e.getHandSpace()},this.setFramebufferScaleFactor=function(ue){E=ue,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){G=ue,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return I},this.getSession=function(){return g},this.setSession=function(ue){if(g=ue,null!==g){g.addEventListener("select",d),g.addEventListener("selectstart",d),g.addEventListener("selectend",d),g.addEventListener("squeeze",d),g.addEventListener("squeezestart",d),g.addEventListener("squeezeend",d),g.addEventListener("end",_);const _e=u.getContextAttributes();!0!==_e.xrCompatible&&u.makeXRCompatible();const $e=new XRWebGLLayer(g,u,{antialias:_e.antialias,alpha:_e.alpha,depth:_e.depth,stencil:_e.stencil,framebufferScaleFactor:E});g.updateRenderState({baseLayer:$e}),g.requestReferenceSpace(G).then(S),g.addEventListener("inputsourceschange",B)}};const k=new lt,F=new lt;function V(ue,_e){null===_e?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(_e.matrixWorld,ue.matrix),ue.matrixWorldInverse.getInverse(ue.matrixWorld)}this.getCamera=function(ue){w.near=ge.near=me.near=ue.near,w.far=ge.far=me.far=ue.far,e===w.near&&c===w.far||(g.updateRenderState({depthNear:w.near,depthFar:w.far}),e=w.near,c=w.far);const _e=ue.parent,Ee=w.cameras;V(w,_e);for(let Be=0;Be<Ee.length;Be++)V(Ee[Be],_e);ue.matrixWorld.copy(w.matrixWorld);const $e=ue.children;for(let Be=0,Re=$e.length;Be<Re;Be++)$e[Be].updateMatrixWorld(!0);return 2===Ee.length?function(Be,Re,We){k.setFromMatrixPosition(Re.matrixWorld),F.setFromMatrixPosition(We.matrixWorld);const tt=k.distanceTo(F),Ze=Re.projectionMatrix.elements,ot=We.projectionMatrix.elements,st=Ze[14]/(Ze[10]-1),Ct=Ze[14]/(Ze[10]+1),Ft=(Ze[9]+1)/Ze[5],Qe=(Ze[9]-1)/Ze[5],nt=(Ze[8]-1)/Ze[0],Et=(ot[8]+1)/ot[0],Jt=st*nt,ct=st*Et,Lt=tt/(-nt+Et),_t=Lt*-nt;Re.matrixWorld.decompose(Be.position,Be.quaternion,Be.scale),Be.translateX(_t),Be.translateZ(Lt),Be.matrixWorld.compose(Be.position,Be.quaternion,Be.scale),Be.matrixWorldInverse.getInverse(Be.matrixWorld);const zt=st+Lt,Rt=Ct+Lt;Be.projectionMatrix.makePerspective(Jt-_t,ct+(tt-_t),Ft*Ct/Rt*zt,Qe*Ct/Rt*zt,zt,Rt)}(w,me,ge):w.projectionMatrix.copy(me.projectionMatrix),w};let te=null;const ce=new Lp;ce.setAnimationLoop(function(ue,_e){if(Z=_e.getViewerPose(I),null!==Z){const $e=Z.views,Be=g.renderState.baseLayer;t.setFramebuffer(Be.framebuffer);let Re=!1;$e.length!==w.cameras.length&&(w.cameras.length=0,Re=!0);for(let We=0;We<$e.length;We++){const tt=$e[We],Ze=Be.getViewport(tt),ot=Se[We];ot.matrix.fromArray(tt.transform.matrix),ot.projectionMatrix.fromArray(tt.projectionMatrix),ot.viewport.set(Ze.x,Ze.y,Ze.width,Ze.height),0===We&&w.matrix.copy(ot.matrix),!0===Re&&w.cameras.push(ot)}}const Ee=g.inputSources;for(let $e=0;$e<J.length;$e++)J[$e].update(Ee[$e],_e,I);te&&te(ue,_e)}),this.setAnimationLoop=function(ue){te=ue},this.dispose=function(){}}function jd(t){function u(g,E,I){g.opacity.value=E.opacity,E.color&&g.diffuse.value.copy(E.color),E.emissive&&g.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(g.map.value=E.map),E.alphaMap&&(g.alphaMap.value=E.alphaMap),E.specularMap&&(g.specularMap.value=E.specularMap);const G=E.envMap||I;if(G){g.envMap.value=G,g.flipEnvMap.value=G.isCubeTexture?-1:1,g.reflectivity.value=E.reflectivity,g.refractionRatio.value=E.refractionRatio;var Z=t.get(G).__maxMipLevel;void 0!==Z&&(g.maxMipLevel.value=Z)}let J,K;E.lightMap&&(g.lightMap.value=E.lightMap,g.lightMapIntensity.value=E.lightMapIntensity),E.aoMap&&(g.aoMap.value=E.aoMap,g.aoMapIntensity.value=E.aoMapIntensity),E.map?J=E.map:E.specularMap?J=E.specularMap:E.displacementMap?J=E.displacementMap:E.normalMap?J=E.normalMap:E.bumpMap?J=E.bumpMap:E.roughnessMap?J=E.roughnessMap:E.metalnessMap?J=E.metalnessMap:E.alphaMap?J=E.alphaMap:E.emissiveMap&&(J=E.emissiveMap),void 0!==J&&(J.isWebGLRenderTarget&&(J=J.texture),!0===J.matrixAutoUpdate&&J.updateMatrix(),g.uvTransform.value.copy(J.matrix)),E.aoMap?K=E.aoMap:E.lightMap&&(K=E.lightMap),void 0!==K&&(K.isWebGLRenderTarget&&(K=K.texture),!0===K.matrixAutoUpdate&&K.updateMatrix(),g.uv2Transform.value.copy(K.matrix))}function m(g,E,I){g.roughness.value=E.roughness,g.metalness.value=E.metalness,E.roughnessMap&&(g.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(g.metalnessMap.value=E.metalnessMap),E.emissiveMap&&(g.emissiveMap.value=E.emissiveMap),E.bumpMap&&(g.bumpMap.value=E.bumpMap,g.bumpScale.value=E.bumpScale,E.side===q&&(g.bumpScale.value*=-1)),E.normalMap&&(g.normalMap.value=E.normalMap,g.normalScale.value.copy(E.normalScale),E.side===q&&g.normalScale.value.negate()),E.displacementMap&&(g.displacementMap.value=E.displacementMap,g.displacementScale.value=E.displacementScale,g.displacementBias.value=E.displacementBias),(E.envMap||I)&&(g.envMapIntensity.value=E.envMapIntensity)}return{refreshFogUniforms:function(g,E){g.fogColor.value.copy(E.color),E.isFog?(g.fogNear.value=E.near,g.fogFar.value=E.far):E.isFogExp2&&(g.fogDensity.value=E.density)},refreshMaterialUniforms:function(g,E,I,G,Z){var K;E.isMeshBasicMaterial?u(g,E):E.isMeshLambertMaterial?(u(g,E),(K=E).emissiveMap&&(g.emissiveMap.value=K.emissiveMap)):E.isMeshToonMaterial?(u(g,E),function(J,K){K.gradientMap&&(J.gradientMap.value=K.gradientMap),K.emissiveMap&&(J.emissiveMap.value=K.emissiveMap),K.bumpMap&&(J.bumpMap.value=K.bumpMap,J.bumpScale.value=K.bumpScale,K.side===q&&(J.bumpScale.value*=-1)),K.normalMap&&(J.normalMap.value=K.normalMap,J.normalScale.value.copy(K.normalScale),K.side===q&&J.normalScale.value.negate()),K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshPhongMaterial?(u(g,E),function(J,K){J.specular.value.copy(K.specular),J.shininess.value=Math.max(K.shininess,1e-4),K.emissiveMap&&(J.emissiveMap.value=K.emissiveMap),K.bumpMap&&(J.bumpMap.value=K.bumpMap,J.bumpScale.value=K.bumpScale,K.side===q&&(J.bumpScale.value*=-1)),K.normalMap&&(J.normalMap.value=K.normalMap,J.normalScale.value.copy(K.normalScale),K.side===q&&J.normalScale.value.negate()),K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshStandardMaterial?(u(g,E,I),E.isMeshPhysicalMaterial?function(J,K,me){m(J,K,me),J.reflectivity.value=K.reflectivity,J.clearcoat.value=K.clearcoat,J.clearcoatRoughness.value=K.clearcoatRoughness,K.sheen&&J.sheen.value.copy(K.sheen),K.clearcoatMap&&(J.clearcoatMap.value=K.clearcoatMap),K.clearcoatRoughnessMap&&(J.clearcoatRoughnessMap.value=K.clearcoatRoughnessMap),K.clearcoatNormalMap&&(J.clearcoatNormalScale.value.copy(K.clearcoatNormalScale),J.clearcoatNormalMap.value=K.clearcoatNormalMap,K.side===q&&J.clearcoatNormalScale.value.negate()),J.transmission.value=K.transmission,K.transmissionMap&&(J.transmissionMap.value=K.transmissionMap)}(g,E,I):m(g,E,I)):E.isMeshMatcapMaterial?(u(g,E),function(J,K){K.matcap&&(J.matcap.value=K.matcap),K.bumpMap&&(J.bumpMap.value=K.bumpMap,J.bumpScale.value=K.bumpScale,K.side===q&&(J.bumpScale.value*=-1)),K.normalMap&&(J.normalMap.value=K.normalMap,J.normalScale.value.copy(K.normalScale),K.side===q&&J.normalScale.value.negate()),K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshDepthMaterial?(u(g,E),function(J,K){K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshDistanceMaterial?(u(g,E),function(J,K){K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias),J.referencePosition.value.copy(K.referencePosition),J.nearDistance.value=K.nearDistance,J.farDistance.value=K.farDistance}(g,E)):E.isMeshNormalMaterial?(u(g,E),function(J,K){K.bumpMap&&(J.bumpMap.value=K.bumpMap,J.bumpScale.value=K.bumpScale,K.side===q&&(J.bumpScale.value*=-1)),K.normalMap&&(J.normalMap.value=K.normalMap,J.normalScale.value.copy(K.normalScale),K.side===q&&J.normalScale.value.negate()),K.displacementMap&&(J.displacementMap.value=K.displacementMap,J.displacementScale.value=K.displacementScale,J.displacementBias.value=K.displacementBias)}(g,E)):E.isLineBasicMaterial?(function(J,K){J.diffuse.value.copy(K.color),J.opacity.value=K.opacity}(g,E),E.isLineDashedMaterial&&function(J,K){J.dashSize.value=K.dashSize,J.totalSize.value=K.dashSize+K.gapSize,J.scale.value=K.scale}(g,E)):E.isPointsMaterial?function(J,K,me,ge){let Se;J.diffuse.value.copy(K.color),J.opacity.value=K.opacity,J.size.value=K.size*me,J.scale.value=.5*ge,K.map&&(J.map.value=K.map),K.alphaMap&&(J.alphaMap.value=K.alphaMap),K.map?Se=K.map:K.alphaMap&&(Se=K.alphaMap),void 0!==Se&&(!0===Se.matrixAutoUpdate&&Se.updateMatrix(),J.uvTransform.value.copy(Se.matrix))}(g,E,G,Z):E.isSpriteMaterial?function(J,K){let me;J.diffuse.value.copy(K.color),J.opacity.value=K.opacity,J.rotation.value=K.rotation,K.map&&(J.map.value=K.map),K.alphaMap&&(J.alphaMap.value=K.alphaMap),K.map?me=K.map:K.alphaMap&&(me=K.alphaMap),void 0!==me&&(!0===me.matrixAutoUpdate&&me.updateMatrix(),J.uvTransform.value.copy(me.matrix))}(g,E):E.isShadowMaterial?(g.color.value.copy(E.color),g.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}}}function _d(t){const u=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m=void 0!==t.context?t.context:null,g=void 0!==t.alpha&&t.alpha,E=void 0===t.depth||t.depth,I=void 0===t.stencil||t.stencil,G=void 0!==t.antialias&&t.antialias,Z=void 0===t.premultipliedAlpha||t.premultipliedAlpha,J=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,K=void 0!==t.powerPreference?t.powerPreference:"default",me=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let ge=null,Se=null;this.domElement=u,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Zi,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const w=this;let e=!1,c=null,d=0,_=0,S=null,B=null,k=-1,F=null,V=null;const te=new xi,ce=new xi;let ue=null,_e=u.width,Ee=u.height,$e=1,Be=null,Re=null;const We=new xi(0,0,_e,Ee),tt=new xi(0,0,_e,Ee);let Ze=!1;const ot=new eu,st=new Ol;let Ct=!1,Ft=!1;const Qe=new ri,nt=new lt,Et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Jt(){return null===S?$e:1}let ct,Lt,_t,zt,Rt,nn,en,En,rt,ut,rn,un,_n,kn,Jn,Zn,cn,mt,Kt,Vt=m;function vn(St,Ht){for(let gn=0;gn<St.length;gn++){const nr=u.getContext(St[gn],Ht);if(null!==nr)return nr}return null}try{const St={alpha:g,depth:E,stencil:I,antialias:G,premultipliedAlpha:Z,preserveDrawingBuffer:J,powerPreference:K,failIfMajorPerformanceCaveat:me};if(u.addEventListener("webglcontextlost",jr,!1),u.addEventListener("webglcontextrestored",ki,!1),null===Vt){const Ht=["webgl2","webgl","experimental-webgl"];if(!0===w.isWebGL1Renderer&&Ht.shift(),Vt=vn(Ht,St),null===Vt)throw vn(Ht)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Vt.getShaderPrecisionFormat&&(Vt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(St){throw console.error("THREE.WebGLRenderer: "+St.message),St}function Nn(){ct=new tu(Vt),Lt=new sr(Vt,ct,t),!1===Lt.isWebGL2&&(ct.get("WEBGL_depth_texture"),ct.get("OES_texture_float"),ct.get("OES_texture_half_float"),ct.get("OES_texture_half_float_linear"),ct.get("OES_standard_derivatives"),ct.get("OES_element_index_uint"),ct.get("OES_vertex_array_object"),ct.get("ANGLE_instanced_arrays")),ct.get("OES_texture_float_linear"),mt=new zd(Vt,ct,Lt),_t=new ac(Vt,ct,Lt),_t.scissor(ce.copy(tt).multiplyScalar($e).floor()),_t.viewport(te.copy(We).multiplyScalar($e).floor()),zt=new nu(Vt),Rt=new Lf,nn=new fd(Vt,ct,_t,Rt,Lt,mt,zt),en=new Ia(Vt,Lt),Kt=new Eu(Vt,ct,en,Lt),En=new Mo(Vt,en,zt,Kt),rt=new Mu(Vt,En,en,zt),Jn=new rc(Vt),ut=new Pc(w,ct,Lt,Kt),rn=new jd(Rt),un=new Dm(Rt),_n=new Ud,kn=new qp(w,_t,rt,Z),Zn=new ui(Vt,ct,zt,Lt),cn=new Vn(Vt,ct,zt,Lt),zt.programs=ut.programs,w.capabilities=Lt,w.extensions=ct,w.properties=Rt,w.renderLists=un,w.state=_t,w.info=zt}Nn();const dr=new cf(w,Vt);this.xr=dr;const _r=new sc(w,rt,Lt.maxTextureSize);function jr(St){St.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),e=!0}function ki(){console.log("THREE.WebGLRenderer: Context Restored."),e=!1,Nn()}function _o(St){const Ht=St.target;var gn;Ht.removeEventListener("dispose",_o),El(gn=Ht),Rt.remove(gn)}function El(St){const Ht=Rt.get(St).program;void 0!==Ht&&ut.releaseProgram(Ht)}this.shadowMap=_r,this.getContext=function(){return Vt},this.getContextAttributes=function(){return Vt.getContextAttributes()},this.forceContextLoss=function(){const St=ct.get("WEBGL_lose_context");St&&St.loseContext()},this.forceContextRestore=function(){const St=ct.get("WEBGL_lose_context");St&&St.restoreContext()},this.getPixelRatio=function(){return $e},this.setPixelRatio=function(St){void 0!==St&&($e=St,this.setSize(_e,Ee,!1))},this.getSize=function(St){return void 0===St&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),St=new wn),St.set(_e,Ee)},this.setSize=function(St,Ht,gn){dr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(_e=St,Ee=Ht,u.width=Math.floor(St*$e),u.height=Math.floor(Ht*$e),!1!==gn&&(u.style.width=St+"px",u.style.height=Ht+"px"),this.setViewport(0,0,St,Ht))},this.getDrawingBufferSize=function(St){return void 0===St&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),St=new wn),St.set(_e*$e,Ee*$e).floor()},this.setDrawingBufferSize=function(St,Ht,gn){_e=St,Ee=Ht,$e=gn,u.width=Math.floor(St*gn),u.height=Math.floor(Ht*gn),this.setViewport(0,0,St,Ht)},this.getCurrentViewport=function(St){return void 0===St&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),St=new xi),St.copy(te)},this.getViewport=function(St){return St.copy(We)},this.setViewport=function(St,Ht,gn,Dn){St.isVector4?We.set(St.x,St.y,St.z,St.w):We.set(St,Ht,gn,Dn),_t.viewport(te.copy(We).multiplyScalar($e).floor())},this.getScissor=function(St){return St.copy(tt)},this.setScissor=function(St,Ht,gn,Dn){St.isVector4?tt.set(St.x,St.y,St.z,St.w):tt.set(St,Ht,gn,Dn),_t.scissor(ce.copy(tt).multiplyScalar($e).floor())},this.getScissorTest=function(){return Ze},this.setScissorTest=function(St){_t.setScissorTest(Ze=St)},this.setOpaqueSort=function(St){Be=St},this.setTransparentSort=function(St){Re=St},this.getClearColor=function(){return kn.getClearColor()},this.setClearColor=function(){kn.setClearColor.apply(kn,arguments)},this.getClearAlpha=function(){return kn.getClearAlpha()},this.setClearAlpha=function(){kn.setClearAlpha.apply(kn,arguments)},this.clear=function(St,Ht,gn){let Dn=0;(void 0===St||St)&&(Dn|=16384),(void 0===Ht||Ht)&&(Dn|=256),(void 0===gn||gn)&&(Dn|=1024),Vt.clear(Dn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){u.removeEventListener("webglcontextlost",jr,!1),u.removeEventListener("webglcontextrestored",ki,!1),un.dispose(),_n.dispose(),Rt.dispose(),rt.dispose(),Kt.dispose(),dr.dispose(),$a.stop()},this.renderBufferImmediate=function(St,Ht){Kt.initAttributes();const gn=Rt.get(St);St.hasPositions&&!gn.position&&(gn.position=Vt.createBuffer()),St.hasNormals&&!gn.normal&&(gn.normal=Vt.createBuffer()),St.hasUvs&&!gn.uv&&(gn.uv=Vt.createBuffer()),St.hasColors&&!gn.color&&(gn.color=Vt.createBuffer());const Dn=Ht.getAttributes();St.hasPositions&&(Vt.bindBuffer(34962,gn.position),Vt.bufferData(34962,St.positionArray,35048),Kt.enableAttribute(Dn.position),Vt.vertexAttribPointer(Dn.position,3,5126,!1,0,0)),St.hasNormals&&(Vt.bindBuffer(34962,gn.normal),Vt.bufferData(34962,St.normalArray,35048),Kt.enableAttribute(Dn.normal),Vt.vertexAttribPointer(Dn.normal,3,5126,!1,0,0)),St.hasUvs&&(Vt.bindBuffer(34962,gn.uv),Vt.bufferData(34962,St.uvArray,35048),Kt.enableAttribute(Dn.uv),Vt.vertexAttribPointer(Dn.uv,2,5126,!1,0,0)),St.hasColors&&(Vt.bindBuffer(34962,gn.color),Vt.bufferData(34962,St.colorArray,35048),Kt.enableAttribute(Dn.color),Vt.vertexAttribPointer(Dn.color,3,5126,!1,0,0)),Kt.disableUnusedAttributes(),Vt.drawArrays(4,0,St.count),St.count=0},this.renderBufferDirect=function(St,Ht,gn,Dn,nr,Mi){null===Ht&&(Ht=Et);const Fi=nr.isMesh&&nr.matrixWorld.determinant()<0,oi=gh(St,Ht,Dn,nr);_t.setMaterial(Dn,Fi);let us=gn.index;const aa=gn.attributes.position;if(null===us){if(void 0===aa||0===aa.count)return}else if(0===us.count)return;let la,jo=1;!0===Dn.wireframe&&(us=En.getWireframeAttribute(gn),jo=2),(Dn.morphTargets||Dn.morphNormals)&&Jn.update(nr,gn,Dn,oi),Kt.setup(nr,Dn,oi,gn,us);let Vi=Zn;null!==us&&(la=en.get(us),Vi=cn,Vi.setIndex(la));const ca=null!==us?us.count:aa.count,Ca=gn.drawRange.start*jo,is=gn.drawRange.count*jo,zc=null!==Mi?Mi.start*jo:0,Vl=null!==Mi?Mi.count*jo:1/0,nf=Math.max(Ca,zc),vt=Math.min(ca,Ca+is,zc+Vl)-1,bn=Math.max(0,vt-nf+1);if(0!==bn){if(nr.isMesh)!0===Dn.wireframe?(_t.setLineWidth(Dn.wireframeLinewidth*Jt()),Vi.setMode(1)):Vi.setMode(4);else if(nr.isLine){let an=Dn.linewidth;void 0===an&&(an=1),_t.setLineWidth(an*Jt()),Vi.setMode(nr.isLineSegments?1:nr.isLineLoop?2:3)}else nr.isPoints?Vi.setMode(0):nr.isSprite&&Vi.setMode(4);if(nr.isInstancedMesh)Vi.renderInstances(nf,bn,nr.count);else if(gn.isInstancedBufferGeometry){const an=Math.min(gn.instanceCount,gn._maxInstanceCount);Vi.renderInstances(nf,bn,an)}else Vi.render(nf,bn)}},this.compile=function(St,Ht){Se=_n.get(St,Ht),Se.init(),St.traverse(function(Dn){Dn.isLight&&(Se.pushLight(Dn),Dn.castShadow&&Se.pushShadow(Dn))}),Se.setupLights(Ht);const gn=new WeakMap;St.traverse(function(Dn){let nr=Dn.material;if(nr)if(Array.isArray(nr))for(let Mi=0;Mi<nr.length;Mi++){let Fi=nr[Mi];!1===gn.has(Fi)&&(Oh(Fi,St,Dn),gn.set(Fi))}else!1===gn.has(nr)&&(Oh(nr,St,Dn),gn.set(nr))})};let zo=null;const $a=new Lp;function ju(St,Ht,gn,Dn){if(!1===St.visible)return;if(St.layers.test(Ht.layers))if(St.isGroup)gn=St.renderOrder;else if(St.isLOD)!0===St.autoUpdate&&St.update(Ht);else if(St.isLight)Se.pushLight(St),St.castShadow&&Se.pushShadow(St);else if(St.isSprite){if(!St.frustumCulled||ot.intersectsSprite(St)){Dn&&nt.setFromMatrixPosition(St.matrixWorld).applyMatrix4(Qe);const Mi=rt.update(St),Fi=St.material;Fi.visible&&ge.push(St,Mi,Fi,gn,nt.z,null)}}else if(St.isImmediateRenderObject)Dn&&nt.setFromMatrixPosition(St.matrixWorld).applyMatrix4(Qe),ge.push(St,null,St.material,gn,nt.z,null);else if((St.isMesh||St.isLine||St.isPoints)&&(St.isSkinnedMesh&&St.skeleton.frame!==zt.render.frame&&(St.skeleton.update(),St.skeleton.frame=zt.render.frame),!St.frustumCulled||ot.intersectsObject(St))){Dn&&nt.setFromMatrixPosition(St.matrixWorld).applyMatrix4(Qe);const Mi=rt.update(St),Fi=St.material;if(Array.isArray(Fi)){const oi=Mi.groups;for(let us=0,aa=oi.length;us<aa;us++){const la=oi[us],jo=Fi[la.materialIndex];jo&&jo.visible&&ge.push(St,Mi,jo,gn,nt.z,la)}}else Fi.visible&&ge.push(St,Mi,Fi,gn,nt.z,null)}const nr=St.children;for(let Mi=0,Fi=nr.length;Mi<Fi;Mi++)ju(nr[Mi],Ht,gn,Dn)}function Ld(St,Ht,gn){const Dn=!0===Ht.isScene?Ht.overrideMaterial:null;for(let nr=0,Mi=St.length;nr<Mi;nr++){const Fi=St[nr],oi=Fi.object,us=Fi.geometry,aa=null===Dn?Fi.material:Dn,la=Fi.group;if(gn.isArrayCamera){V=gn;const jo=gn.cameras;for(let Vi=0,ca=jo.length;Vi<ca;Vi++){const Ca=jo[Vi];oi.layers.test(Ca.layers)&&(_t.viewport(te.copy(Ca.viewport)),Se.setupLights(Ca),Bd(oi,Ht,Ca,us,aa,la))}}else V=null,Bd(oi,Ht,gn,us,aa,la)}}function Bd(St,Ht,gn,Dn,nr,Mi){if(St.onBeforeRender(w,Ht,gn,Dn,nr,Mi),Se=_n.get(Ht,V||gn),St.modelViewMatrix.multiplyMatrices(gn.matrixWorldInverse,St.matrixWorld),St.normalMatrix.getNormalMatrix(St.modelViewMatrix),St.isImmediateRenderObject){const Fi=gh(gn,Ht,nr,St);_t.setMaterial(nr),Kt.reset(),us=Fi,St.render(function(aa){w.renderBufferImmediate(aa,us)})}else w.renderBufferDirect(gn,Ht,Dn,nr,St,Mi);var us;St.onAfterRender(w,Ht,gn,Dn,nr,Mi),Se=_n.get(Ht,V||gn)}function Oh(St,Ht,gn){!0!==Ht.isScene&&(Ht=Et);const Dn=Rt.get(St),nr=Se.state.lights,Fi=nr.state.version,oi=ut.getParameters(St,nr.state,Se.state.shadowsArray,Ht,st.numPlanes,st.numIntersection,gn),us=ut.getProgramCacheKey(oi);let aa=Dn.program,la=!0;if(void 0===aa)St.addEventListener("dispose",_o);else if(aa.cacheKey!==us)El(St);else if(Dn.lightsStateVersion!==Fi)Dn.lightsStateVersion=Fi,la=!1;else{if(void 0!==oi.shaderID)return;la=!1}la&&(oi.uniforms=ut.getUniforms(St,oi),St.onBeforeCompile(oi,w),aa=ut.acquireProgram(oi,us),Dn.program=aa,Dn.uniforms=oi.uniforms,Dn.outputEncoding=oi.outputEncoding);const jo=aa.getAttributes();if(St.morphTargets){St.numSupportedMorphTargets=0;for(let is=0;is<w.maxMorphTargets;is++)jo["morphTarget"+is]>=0&&St.numSupportedMorphTargets++}if(St.morphNormals){St.numSupportedMorphNormals=0;for(let is=0;is<w.maxMorphNormals;is++)jo["morphNormal"+is]>=0&&St.numSupportedMorphNormals++}const Vi=Dn.uniforms;var is;(St.isShaderMaterial||St.isRawShaderMaterial)&&!0!==St.clipping||(Dn.numClippingPlanes=st.numPlanes,Dn.numIntersection=st.numIntersection,Vi.clippingPlanes=st.uniform),Dn.environment=St.isMeshStandardMaterial?Ht.environment:null,Dn.fog=Ht.fog,Dn.needsLights=(is=St).isMeshLambertMaterial||is.isMeshToonMaterial||is.isMeshPhongMaterial||is.isMeshStandardMaterial||is.isShadowMaterial||is.isShaderMaterial&&!0===is.lights,Dn.lightsStateVersion=Fi,Dn.needsLights&&(Vi.ambientLightColor.value=nr.state.ambient,Vi.lightProbe.value=nr.state.probe,Vi.directionalLights.value=nr.state.directional,Vi.directionalLightShadows.value=nr.state.directionalShadow,Vi.spotLights.value=nr.state.spot,Vi.spotLightShadows.value=nr.state.spotShadow,Vi.rectAreaLights.value=nr.state.rectArea,Vi.pointLights.value=nr.state.point,Vi.pointLightShadows.value=nr.state.pointShadow,Vi.hemisphereLights.value=nr.state.hemi,Vi.directionalShadowMap.value=nr.state.directionalShadowMap,Vi.directionalShadowMatrix.value=nr.state.directionalShadowMatrix,Vi.spotShadowMap.value=nr.state.spotShadowMap,Vi.spotShadowMatrix.value=nr.state.spotShadowMatrix,Vi.pointShadowMap.value=nr.state.pointShadowMap,Vi.pointShadowMatrix.value=nr.state.pointShadowMatrix);const ca=Dn.program.getUniforms(),Ca=Bp.seqWithValue(ca.seq,Vi);Dn.uniformsList=Ca}function gh(St,Ht,gn,Dn){!0!==Ht.isScene&&(Ht=Et),nn.resetTextureUnits();const nr=Ht.fog,Mi=gn.isMeshStandardMaterial?Ht.environment:null,Fi=null===S?w.outputEncoding:S.texture.encoding,oi=Rt.get(gn),us=Se.state.lights;!0!==Ct||!0!==Ft&&St===F||st.setState(gn.clippingPlanes,gn.clipIntersection,gn.clipShadows,St,oi,St===F&&gn.id===k),gn.version===oi.__version?void 0===oi.program||gn.fog&&oi.fog!==nr||oi.environment!==Mi||oi.needsLights&&oi.lightsStateVersion!==us.state.version?Oh(gn,Ht,Dn):void 0===oi.numClippingPlanes||oi.numClippingPlanes===st.numPlanes&&oi.numIntersection===st.numIntersection?oi.outputEncoding!==Fi&&Oh(gn,Ht,Dn):Oh(gn,Ht,Dn):(Oh(gn,Ht,Dn),oi.__version=gn.version);let aa=!1,la=!1,jo=!1;const Vi=oi.program,ca=Vi.getUniforms(),Ca=oi.uniforms;if(_t.useProgram(Vi.program)&&(aa=!0,la=!0,jo=!0),gn.id!==k&&(k=gn.id,la=!0),aa||F!==St){if(ca.setValue(Vt,"projectionMatrix",St.projectionMatrix),Lt.logarithmicDepthBuffer&&ca.setValue(Vt,"logDepthBufFC",2/(Math.log(St.far+1)/Math.LN2)),F!==St&&(F=St,la=!0,jo=!0),gn.isShaderMaterial||gn.isMeshPhongMaterial||gn.isMeshToonMaterial||gn.isMeshStandardMaterial||gn.envMap){const Vl=ca.map.cameraPosition;void 0!==Vl&&Vl.setValue(Vt,nt.setFromMatrixPosition(St.matrixWorld))}(gn.isMeshPhongMaterial||gn.isMeshToonMaterial||gn.isMeshLambertMaterial||gn.isMeshBasicMaterial||gn.isMeshStandardMaterial||gn.isShaderMaterial)&&ca.setValue(Vt,"isOrthographic",!0===St.isOrthographicCamera),(gn.isMeshPhongMaterial||gn.isMeshToonMaterial||gn.isMeshLambertMaterial||gn.isMeshBasicMaterial||gn.isMeshStandardMaterial||gn.isShaderMaterial||gn.isShadowMaterial||gn.skinning)&&ca.setValue(Vt,"viewMatrix",St.matrixWorldInverse)}if(gn.skinning){ca.setOptional(Vt,Dn,"bindMatrix"),ca.setOptional(Vt,Dn,"bindMatrixInverse");const Vl=Dn.skeleton;if(Vl)if(Lt.floatVertexTextures){if(void 0===Vl.boneTexture){let vt=Math.sqrt(4*Vl.bones.length);vt=tr.ceilPowerOfTwo(vt),vt=Math.max(vt,4);const bn=new Float32Array(vt*vt*4);bn.set(Vl.boneMatrices);const an=new gl(bn,vt,vt,lo,Xo);Vl.boneMatrices=bn,Vl.boneTexture=an,Vl.boneTextureSize=vt}ca.setValue(Vt,"boneTexture",Vl.boneTexture,nn),ca.setValue(Vt,"boneTextureSize",Vl.boneTextureSize)}else ca.setOptional(Vt,Vl,"boneMatrices")}var is,zc;return(la||oi.receiveShadow!==Dn.receiveShadow)&&(oi.receiveShadow=Dn.receiveShadow,ca.setValue(Vt,"receiveShadow",Dn.receiveShadow)),la&&(ca.setValue(Vt,"toneMappingExposure",w.toneMappingExposure),oi.needsLights&&((is=Ca).ambientLightColor.needsUpdate=zc=jo,is.lightProbe.needsUpdate=zc,is.directionalLights.needsUpdate=zc,is.directionalLightShadows.needsUpdate=zc,is.pointLights.needsUpdate=zc,is.pointLightShadows.needsUpdate=zc,is.spotLights.needsUpdate=zc,is.spotLightShadows.needsUpdate=zc,is.rectAreaLights.needsUpdate=zc,is.hemisphereLights.needsUpdate=zc),nr&&gn.fog&&rn.refreshFogUniforms(Ca,nr),rn.refreshMaterialUniforms(Ca,gn,Mi,$e,Ee),void 0!==Ca.ltc_1&&(Ca.ltc_1.value=hr.LTC_1),void 0!==Ca.ltc_2&&(Ca.ltc_2.value=hr.LTC_2),Bp.upload(Vt,oi.uniformsList,Ca,nn)),gn.isShaderMaterial&&!0===gn.uniformsNeedUpdate&&(Bp.upload(Vt,oi.uniformsList,Ca,nn),gn.uniformsNeedUpdate=!1),gn.isSpriteMaterial&&ca.setValue(Vt,"center",Dn.center),ca.setValue(Vt,"modelViewMatrix",Dn.modelViewMatrix),ca.setValue(Vt,"normalMatrix",Dn.normalMatrix),ca.setValue(Vt,"modelMatrix",Dn.matrixWorld),Vi}$a.setAnimationLoop(function(St){dr.isPresenting||zo&&zo(St)}),typeof window<"u"&&$a.setContext(window),this.setAnimationLoop=function(St){zo=St,dr.setAnimationLoop(St),null===St?$a.stop():$a.start()},this.render=function(St,Ht){let gn,Dn;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),gn=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Dn=arguments[3]),void 0!==Ht&&!0!==Ht.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===e)return;Kt.resetDefaultState(),k=-1,F=null,!0===St.autoUpdate&&St.updateMatrixWorld(),null===Ht.parent&&Ht.updateMatrixWorld(),!0===dr.enabled&&!0===dr.isPresenting&&(Ht=dr.getCamera(Ht)),!0===St.isScene&&St.onBeforeRender(w,St,Ht,gn||S),Se=_n.get(St,Ht),Se.init(),Qe.multiplyMatrices(Ht.projectionMatrix,Ht.matrixWorldInverse),ot.setFromProjectionMatrix(Qe),Ft=this.localClippingEnabled,Ct=st.init(this.clippingPlanes,Ft,Ht),ge=un.get(St,Ht),ge.init(),ju(St,Ht,0,w.sortObjects),ge.finish(),!0===w.sortObjects&&ge.sort(Be,Re),!0===Ct&&st.beginShadows(),_r.render(Se.state.shadowsArray,St,Ht),Se.setupLights(Ht),!0===Ct&&st.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==gn&&this.setRenderTarget(gn),kn.render(ge,St,Ht,Dn);const Mi=ge.opaque,Fi=ge.transparent;Mi.length>0&&Ld(Mi,St,Ht),Fi.length>0&&Ld(Fi,St,Ht),!0===St.isScene&&St.onAfterRender(w,St,Ht),null!==S&&(nn.updateRenderTargetMipmap(S),nn.updateMultisampleRenderTarget(S)),_t.buffers.depth.setTest(!0),_t.buffers.depth.setMask(!0),_t.buffers.color.setMask(!0),_t.setPolygonOffset(!1),ge=null,Se=null},this.setFramebuffer=function(St){c!==St&&null===S&&Vt.bindFramebuffer(36160,St),c=St},this.getActiveCubeFace=function(){return d},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return S},this.setRenderTarget=function(St,Ht,gn){S=St,d=Ht,_=gn,St&&void 0===Rt.get(St).__webglFramebuffer&&nn.setupRenderTarget(St);let Dn=c,nr=!1;if(St){const Mi=Rt.get(St).__webglFramebuffer;St.isWebGLCubeRenderTarget?(Dn=Mi[Ht||0],nr=!0):Dn=St.isWebGLMultisampleRenderTarget?Rt.get(St).__webglMultisampledFramebuffer:Mi,te.copy(St.viewport),ce.copy(St.scissor),ue=St.scissorTest}else te.copy(We).multiplyScalar($e).floor(),ce.copy(tt).multiplyScalar($e).floor(),ue=Ze;if(B!==Dn&&(Vt.bindFramebuffer(36160,Dn),B=Dn),_t.viewport(te),_t.scissor(ce),_t.setScissorTest(ue),nr){const Mi=Rt.get(St.texture);Vt.framebufferTexture2D(36160,36064,34069+(Ht||0),Mi.__webglTexture,gn||0)}},this.readRenderTargetPixels=function(St,Ht,gn,Dn,nr,Mi,Fi){if(!St||!St.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let oi=Rt.get(St).__webglFramebuffer;if(St.isWebGLCubeRenderTarget&&void 0!==Fi&&(oi=oi[Fi]),oi){let us=!1;oi!==B&&(Vt.bindFramebuffer(36160,oi),us=!0);try{const aa=St.texture,la=aa.format,jo=aa.type;if(la!==lo&&mt.convert(la)!==Vt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(jo===ha||mt.convert(jo)===Vt.getParameter(35738)||jo===Xo&&(Lt.isWebGL2||ct.get("OES_texture_float")||ct.get("WEBGL_color_buffer_float"))||jo===ps&&ct.get(Lt.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Vt.checkFramebufferStatus(36160)?Ht>=0&&Ht<=St.width-Dn&&gn>=0&&gn<=St.height-nr&&Vt.readPixels(Ht,gn,Dn,nr,mt.convert(la),mt.convert(jo),Mi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{us&&Vt.bindFramebuffer(36160,B)}}},this.copyFramebufferToTexture=function(St,Ht,gn){void 0===gn&&(gn=0);const Dn=Math.pow(2,-gn),nr=Math.floor(Ht.image.width*Dn),Mi=Math.floor(Ht.image.height*Dn),Fi=mt.convert(Ht.format);nn.setTexture2D(Ht,0),Vt.copyTexImage2D(3553,gn,Fi,St.x,St.y,nr,Mi,0),_t.unbindTexture()},this.copyTextureToTexture=function(St,Ht,gn,Dn){void 0===Dn&&(Dn=0);const nr=Ht.image.width,Mi=Ht.image.height,Fi=mt.convert(gn.format),oi=mt.convert(gn.type);nn.setTexture2D(gn,0),Vt.pixelStorei(37440,gn.flipY),Vt.pixelStorei(37441,gn.premultiplyAlpha),Vt.pixelStorei(3317,gn.unpackAlignment),Ht.isDataTexture?Vt.texSubImage2D(3553,Dn,St.x,St.y,nr,Mi,Fi,oi,Ht.image.data):Ht.isCompressedTexture?Vt.compressedTexSubImage2D(3553,Dn,St.x,St.y,Ht.mipmaps[0].width,Ht.mipmaps[0].height,Fi,Ht.mipmaps[0].data):Vt.texSubImage2D(3553,Dn,St.x,St.y,Fi,oi,Ht.image),0===Dn&&gn.generateMipmaps&&Vt.generateMipmap(3553),_t.unbindTexture()},this.initTexture=function(St){nn.setTexture2D(St,0),_t.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function uf(t){_d.call(this,t)}function hf(t,u){this.name="",this.color=new ar(t),this.density=void 0!==u?u:25e-5}function Xp(t,u,m){this.name="",this.color=new ar(t),this.near=void 0!==u?u:1,this.far=void 0!==m?m:1e3}function Oa(t,u){this.array=t,this.stride=u,this.count=void 0!==t?t.length/u:0,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=tr.generateUUID()}md.prototype=Object.assign(Object.create(Rs.prototype),{constructor:md,isArrayCamera:!0}),wa.prototype=Object.assign(Object.create(Kn.prototype),{constructor:wa,isGroup:!0}),Object.assign(Np.prototype,{constructor:Np,getHandSpace:function(){if(null===this._hand&&(this._hand=new wa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){let u=new wa;u.matrixAutoUpdate=!1,u.visible=!1,this._hand.joints.push(u),this._hand.add(u)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new wa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new wa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,u,m){let g=null,E=null,I=null;const G=this._targetRay,Z=this._grip,J=this._hand;if(t)if(t.hand){I=!0;for(let K=0;K<=window.XRHand.LITTLE_PHALANX_TIP;K++)if(t.hand[K]){let me=u.getJointPose(t.hand[K],m);const ge=J.joints[K];null!==me&&(ge.matrix.fromArray(me.transform.matrix),ge.matrix.decompose(ge.position,ge.rotation,ge.scale),ge.jointRadius=me.radius),ge.visible=null!==me;const Se=J.joints[window.XRHand.INDEX_PHALANX_TIP],w=J.joints[window.XRHand.THUMB_PHALANX_TIP],e=Se.position.distanceTo(w.position),c=.02,d=.005;J.inputState.pinching&&e>c+d?(J.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!J.inputState.pinching&&e<=c-d&&(J.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else null!==G&&(g=u.getPose(t.targetRaySpace,m),null!==g&&(G.matrix.fromArray(g.transform.matrix),G.matrix.decompose(G.position,G.rotation,G.scale))),null!==Z&&t.gripSpace&&(E=u.getPose(t.gripSpace,m),null!==E&&(Z.matrix.fromArray(E.transform.matrix),Z.matrix.decompose(Z.position,Z.rotation,Z.scale)));return null!==G&&(G.visible=null!==g),null!==Z&&(Z.visible=null!==E),null!==J&&(J.visible=null!==I),this}}),Object.assign(cf.prototype,ma.prototype),uf.prototype=Object.assign(Object.create(_d.prototype),{constructor:uf,isWebGL1Renderer:!0}),Object.assign(hf.prototype,{isFogExp2:!0,clone:function(){return new hf(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Xp.prototype,{isFog:!0,clone:function(){return new Xp(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Oa.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Oa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.stride,m*=u.stride;for(let g=0,E=this.stride;g<E;g++)this.array[t+g]=u.array[m+g];return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const u=new Oa(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return u.setUsage(this.usage),u},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const $u=new lt;function Lh(t,u,m,g){this.name="",this.data=t,this.itemSize=u,this.offset=m,this.normalized=!0===g}function _i(t){zr.call(this),this.type="SpriteMaterial",this.color=new ar(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let gd;Object.defineProperties(Lh.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(Lh.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let u=0,m=this.data.count;u<m;u++)$u.x=this.getX(u),$u.y=this.getY(u),$u.z=this.getZ(u),$u.applyMatrix4(t),this.setXYZ(u,$u.x,$u.y,$u.z);return this},setX:function(t,u){return this.data.array[t*this.data.stride+this.offset]=u,this},setY:function(t,u){return this.data.array[t*this.data.stride+this.offset+1]=u,this},setZ:function(t,u){return this.data.array[t*this.data.stride+this.offset+2]=u,this},setW:function(t,u){return this.data.array[t*this.data.stride+this.offset+3]=u,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,u,m){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this.data.array[t+3]=E,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return new Vr(new this.array.constructor(u),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Lh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:u,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(_i.prototype=Object.create(zr.prototype)).constructor=_i,_i.prototype.isSpriteMaterial=!0,_i.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const vd=new lt,Rp=new lt,yd=new lt,Pp=new wn,Gd=new wn,lc=new ri,Hd=new lt,bd=new lt,pf=new lt,Nf=new wn,Rf=new wn,rm=new wn;function nl(t){if(Kn.call(this),this.type="Sprite",void 0===gd){gd=new hn;const u=new Oa(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);gd.setIndex([0,1,2,0,2,3]),gd.setAttribute("position",new Lh(u,3,0,!1)),gd.setAttribute("uv",new Lh(u,2,3,!1))}this.geometry=gd,this.material=void 0!==t?t:new _i,this.center=new wn(.5,.5)}function Ip(t,u,m,g,E,I){Pp.subVectors(t,m).addScalar(.5).multiply(g),void 0!==E?(Gd.x=I*Pp.x-E*Pp.y,Gd.y=E*Pp.x+I*Pp.y):Gd.copy(Pp),t.copy(u),t.x+=Gd.x,t.y+=Gd.y,t.applyMatrix4(lc)}nl.prototype=Object.assign(Object.create(Kn.prototype),{constructor:nl,isSprite:!0,raycast:function(t,u){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Rp.setFromMatrixScale(this.matrixWorld),lc.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),yd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Rp.multiplyScalar(-yd.z);const m=this.material.rotation;let g,E;0!==m&&(E=Math.cos(m),g=Math.sin(m));const I=this.center;Ip(Hd.set(-.5,-.5,0),yd,I,Rp,g,E),Ip(bd.set(.5,-.5,0),yd,I,Rp,g,E),Ip(pf.set(.5,.5,0),yd,I,Rp,g,E),Nf.set(0,0),Rf.set(1,0),rm.set(1,1);let G=t.ray.intersectTriangle(Hd,bd,pf,!1,vd);if(null===G&&(Ip(bd.set(-.5,.5,0),yd,I,Rp,g,E),Rf.set(0,1),G=t.ray.intersectTriangle(Hd,pf,bd,!1,vd),null===G))return;const Z=t.ray.origin.distanceTo(vd);Z<t.near||Z>t.far||u.push({distance:Z,point:vd.clone(),uv:Pr.getUV(vd,Hd,bd,pf,Nf,Rf,rm,new wn),face:null,object:this})},copy:function(t){return Kn.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const df=new lt,Vd=new lt;function Op(){Kn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function ff(t,u){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ci.call(this,t,u),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ri,this.bindMatrixInverse=new ri}Op.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Op,isLOD:!0,copy:function(t){Kn.prototype.copy.call(this,t,!1);const u=t.levels;for(let m=0,g=u.length;m<g;m++){const E=u[m];this.addLevel(E.object.clone(),E.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,u){void 0===u&&(u=0),u=Math.abs(u);const m=this.levels;let g;for(g=0;g<m.length&&!(u<m[g].distance);g++);return m.splice(g,0,{distance:u,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const u=this.levels;if(u.length>0){let m,g;for(m=1,g=u.length;m<g&&!(t<u[m].distance);m++);return u[m-1].object}return null},raycast:function(t,u){if(this.levels.length>0){df.setFromMatrixPosition(this.matrixWorld);const m=t.ray.origin.distanceTo(df);this.getObjectForDistance(m).raycast(t,u)}},update:function(t){const u=this.levels;if(u.length>1){df.setFromMatrixPosition(t.matrixWorld),Vd.setFromMatrixPosition(this.matrixWorld);const m=df.distanceTo(Vd)/t.zoom;let g,E;for(u[0].object.visible=!0,g=1,E=u.length;g<E&&m>=u[g].distance;g++)u[g-1].object.visible=!1,u[g].object.visible=!0;for(this._currentLevel=g-1;g<E;g++)u[g].object.visible=!1}},toJSON:function(t){const u=Kn.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(u.object.autoUpdate=!1),u.object.levels=[];const m=this.levels;for(let g=0,E=m.length;g<E;g++){const I=m[g];u.object.levels.push({object:I.object.uuid,distance:I.distance})}return u}}),ff.prototype=Object.assign(Object.create(Ci.prototype),{constructor:ff,isSkinnedMesh:!0,copy:function(t){return Ci.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,u){this.skeleton=t,void 0===u&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),u=this.matrixWorld),this.bindMatrix.copy(u),this.bindMatrixInverse.getInverse(u)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new xi,u=this.geometry.attributes.skinWeight;for(let m=0,g=u.count;m<g;m++){t.x=u.getX(m),t.y=u.getY(m),t.z=u.getZ(m),t.w=u.getW(m);const E=1/t.manhattanLength();E!==1/0?t.multiplyScalar(E):t.set(1,0,0,0),u.setXYZW(m,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Ci.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const t=new lt,u=new xi,m=new xi,g=new lt,E=new ri;return function(I,G){const Z=this.skeleton,J=this.geometry;u.fromBufferAttribute(J.attributes.skinIndex,I),m.fromBufferAttribute(J.attributes.skinWeight,I),t.fromBufferAttribute(J.attributes.position,I).applyMatrix4(this.bindMatrix),G.set(0,0,0);for(let K=0;K<4;K++){const me=m.getComponent(K);if(0!==me){const ge=u.getComponent(K);E.multiplyMatrices(Z.bones[ge].matrixWorld,Z.boneInverses[ge]),G.addScaledVector(g.copy(t).applyMatrix4(E),me)}}return G.applyMatrix4(this.bindMatrixInverse)}}()});const im=new ri,om=new ri;function mf(t,u){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===u)this.calculateInverses();else if(this.bones.length===u.length)this.boneInverses=u.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let m=0,g=this.bones.length;m<g;m++)this.boneInverses.push(new ri)}}function Cu(){Kn.call(this),this.type="Bone"}Object.assign(mf.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,u=this.bones.length;t<u;t++){const m=new ri;this.bones[t]&&m.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(m)}},pose:function(){for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&m.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&(m.parent&&m.parent.isBone?(m.matrix.getInverse(m.parent.matrixWorld),m.matrix.multiply(m.matrixWorld)):m.matrix.copy(m.matrixWorld),m.matrix.decompose(m.position,m.quaternion,m.scale))}},update:function(){const t=this.bones,u=this.boneInverses,m=this.boneMatrices,g=this.boneTexture;for(let E=0,I=t.length;E<I;E++)im.multiplyMatrices(t[E]?t[E].matrixWorld:om,u[E]),im.toArray(m,16*E);void 0!==g&&(g.needsUpdate=!0)},clone:function(){return new mf(this.bones,this.boneInverses)},getBoneByName:function(t){for(let u=0,m=this.bones.length;u<m;u++){const g=this.bones[u];if(g.name===t)return g}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Cu.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Cu,isBone:!0});const Wd=new ri,zi=new ri,ln=[],Yp=new Ci;function Zo(t,u,m){Ci.call(this,t,u),this.instanceMatrix=new Vr(new Float32Array(16*m),16),this.count=m,this.frustumCulled=!1}function $o(t){zr.call(this),this.type="LineBasicMaterial",this.color=new ar(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}Zo.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Zo,isInstancedMesh:!0,copy:function(t){return Ci.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},getMatrixAt:function(t,u){u.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,u){const m=this.matrixWorld,g=this.count;if(Yp.geometry=this.geometry,Yp.material=this.material,void 0!==Yp.material)for(let E=0;E<g;E++){this.getMatrixAt(E,Wd),zi.multiplyMatrices(m,Wd),Yp.matrixWorld=zi,Yp.raycast(t,ln);for(let I=0,G=ln.length;I<G;I++){const Z=ln[I];Z.instanceId=E,Z.object=this,u.push(Z)}ln.length=0}},setMatrixAt:function(t,u){u.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),($o.prototype=Object.create(zr.prototype)).constructor=$o,$o.prototype.isLineBasicMaterial=!0,$o.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const sm=new lt,Yi=new lt,kp=new ri,Lu=new co,ka=new Gn;function Gs(t,u,m){1===m&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Kn.call(this),this.type="Line",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new $o,this.updateMorphTargets()}Gs.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Gs,isLine:!0,copy:function(t){return Kn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[0];for(let g=1,E=u.count;g<E;g++)sm.fromBufferAttribute(u,g-1),Yi.fromBufferAttribute(u,g),m[g]=m[g-1],m[g]+=sm.distanceTo(Yi);t.setAttribute("lineDistance",new Un(m,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;m[0]=0;for(let g=1,E=u.length;g<E;g++)m[g]=m[g-1],m[g]+=u[g-1].distanceTo(u[g])}return this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Line.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),ka.copy(m.boundingSphere),ka.applyMatrix4(g),ka.radius+=E,!1===t.ray.intersectsSphere(ka))return;kp.getInverse(g),Lu.copy(t.ray).applyMatrix4(kp);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),G=I*I,Z=new lt,J=new lt,K=new lt,me=new lt,ge=this&&this.isLineSegments?2:1;if(m.isBufferGeometry){const Se=m.index,w=m.attributes.position.array;if(null!==Se){const e=Se.array;for(let c=0,d=e.length-1;c<d;c+=ge){const S=e[c+1];if(Z.fromArray(w,3*e[c]),J.fromArray(w,3*S),Lu.distanceSqToSegment(Z,J,me,K)>G)continue;me.applyMatrix4(this.matrixWorld);const B=t.ray.origin.distanceTo(me);B<t.near||B>t.far||u.push({distance:B,point:K.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this})}}else for(let e=0,c=w.length/3-1;e<c;e+=ge){if(Z.fromArray(w,3*e),J.fromArray(w,3*e+3),Lu.distanceSqToSegment(Z,J,me,K)>G)continue;me.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(me);d<t.near||d>t.far||u.push({distance:d,point:K.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}else if(m.isGeometry){const Se=m.vertices,w=Se.length;for(let e=0;e<w-1;e+=ge){if(Lu.distanceSqToSegment(Se[e],Se[e+1],me,K)>G)continue;me.applyMatrix4(this.matrixWorld);const c=t.ray.origin.distanceTo(me);c<t.near||c>t.far||u.push({distance:c,point:K.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const G=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[G]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Oc=new lt,bs=new lt;function Ii(t,u){Gs.call(this,t,u),this.type="LineSegments"}function Jp(t,u){Gs.call(this,t,u),this.type="LineLoop"}function kl(t){zr.call(this),this.type="PointsMaterial",this.color=new ar(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Ii.prototype=Object.assign(Object.create(Gs.prototype),{constructor:Ii,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[];for(let g=0,E=u.count;g<E;g+=2)Oc.fromBufferAttribute(u,g),bs.fromBufferAttribute(u,g+1),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Oc.distanceTo(bs);t.setAttribute("lineDistance",new Un(m,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;for(let g=0,E=u.length;g<E;g+=2)Oc.copy(u[g]),bs.copy(u[g+1]),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Oc.distanceTo(bs)}return this}}),Jp.prototype=Object.assign(Object.create(Gs.prototype),{constructor:Jp,isLineLoop:!0}),(kl.prototype=Object.create(zr.prototype)).constructor=kl,kl.prototype.isPointsMaterial=!0,kl.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const Vo=new ri,Fl=new co,na=new Gn,Fa=new lt;function kc(t,u){Kn.call(this),this.type="Points",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new kl,this.updateMorphTargets()}function cc(t,u,m,g,E,I,G){const Z=Fl.distanceSqToPoint(t);if(Z<m){const J=new lt;Fl.closestPointToPoint(t,J),J.applyMatrix4(g);const K=E.ray.origin.distanceTo(J);if(K<E.near||K>E.far)return;I.push({distance:K,distanceToRay:Math.sqrt(Z),point:J,index:u,face:null,object:G})}}function xd(t,u,m,g,E,I,G,Z,J){di.call(this,t,u,m,g,E,I,G,Z,J),this.format=void 0!==G?G:Fs,this.minFilter=void 0!==I?I:ai,this.magFilter=void 0!==E?E:ai,this.generateMipmaps=!1;const K=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function me(){K.needsUpdate=!0,t.requestVideoFrameCallback(me)})}function uc(t,u,m,g,E,I,G,Z,J,K,me,ge){di.call(this,null,I,G,Z,J,K,g,E,me,ge),this.image={width:u,height:m},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function iu(t,u,m,g,E,I,G,Z,J){di.call(this,t,u,m,g,E,I,G,Z,J),this.needsUpdate=!0}function Bu(t,u,m,g,E,I,G,Z,J,K){if((K=void 0!==K?K:To)!==To&&K!==Zs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===m&&K===To&&(m=Hc),void 0===m&&K===Zs&&(m=Ms),di.call(this,null,g,E,I,G,Z,K,m,J),this.image={width:t,height:u},this.magFilter=void 0!==G?G:Ir,this.minFilter=void 0!==Z?Z:Ir,this.flipY=!1,this.generateMipmaps=!1}function hc(t){hn.call(this),this.type="WireframeGeometry";const u=[],m=[0,0],g={},E=["a","b","c"];if(t&&t.isGeometry){const I=t.faces;for(let G=0,Z=I.length;G<Z;G++){const J=I[G];for(let K=0;K<3;K++){const me=J[E[K]],ge=J[E[(K+1)%3]];m[0]=Math.min(me,ge),m[1]=Math.max(me,ge);const Se=m[0]+","+m[1];void 0===g[Se]&&(g[Se]={index1:m[0],index2:m[1]})}}for(const G in g){const Z=g[G];let J=t.vertices[Z.index1];u.push(J.x,J.y,J.z),J=t.vertices[Z.index2],u.push(J.x,J.y,J.z)}}else if(t&&t.isBufferGeometry){let I=new lt;if(null!==t.index){const G=t.attributes.position,Z=t.index;let J=t.groups;0===J.length&&(J=[{start:0,count:Z.count,materialIndex:0}]);for(let K=0,me=J.length;K<me;++K){const ge=J[K],Se=ge.start;for(let w=Se,e=Se+ge.count;w<e;w+=3)for(let c=0;c<3;c++){const d=Z.getX(w+c),_=Z.getX(w+(c+1)%3);m[0]=Math.min(d,_),m[1]=Math.max(d,_);const S=m[0]+","+m[1];void 0===g[S]&&(g[S]={index1:m[0],index2:m[1]})}}for(const K in g){const me=g[K];I.fromBufferAttribute(G,me.index1),u.push(I.x,I.y,I.z),I.fromBufferAttribute(G,me.index2),u.push(I.x,I.y,I.z)}}else{const G=t.attributes.position;for(let Z=0,J=G.count/3;Z<J;Z++)for(let K=0;K<3;K++)I.fromBufferAttribute(G,3*Z+K),u.push(I.x,I.y,I.z),I.fromBufferAttribute(G,3*Z+(K+1)%3),u.push(I.x,I.y,I.z)}}this.setAttribute("position",new Un(u,3))}function hh(t,u,m){Fr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:u,stacks:m},this.fromBufferGeometry(new Fc(t,u,m)),this.mergeVertices()}function Fc(t,u,m){hn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:u,stacks:m};const g=[],E=[],I=[],G=[],Z=1e-5,J=new lt,K=new lt,me=new lt,ge=new lt,Se=new lt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const w=u+1;for(let e=0;e<=m;e++){const c=e/m;for(let d=0;d<=u;d++){const _=d/u;t(_,c,K),E.push(K.x,K.y,K.z),_-Z>=0?(t(_-Z,c,me),ge.subVectors(K,me)):(t(_+Z,c,me),ge.subVectors(me,K)),c-Z>=0?(t(_,c-Z,me),Se.subVectors(K,me)):(t(_,c+Z,me),Se.subVectors(me,K)),J.crossVectors(ge,Se).normalize(),I.push(J.x,J.y,J.z),G.push(_,c)}}for(let e=0;e<m;e++)for(let c=0;c<u;c++){const _=e*w+c+1,S=(e+1)*w+c+1,B=(e+1)*w+c;g.push(e*w+c,_,B),g.push(_,S,B)}this.setIndex(g),this.setAttribute("position",new Un(E,3)),this.setAttribute("normal",new Un(I,3)),this.setAttribute("uv",new Un(G,2))}function Nu(t,u,m,g){Fr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},this.fromBufferGeometry(new xs(t,u,m,g)),this.mergeVertices()}function xs(t,u,m,g){hn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},m=m||1;const E=[],I=[];function G(ge,Se,w,e){const c=Math.pow(2,e),d=[];for(let _=0;_<=c;_++){d[_]=[];const S=ge.clone().lerp(w,_/c),B=Se.clone().lerp(w,_/c),k=c-_;for(let F=0;F<=k;F++)d[_][F]=0===F&&_===c?S:S.clone().lerp(B,F/k)}for(let _=0;_<c;_++)for(let S=0;S<2*(c-_)-1;S++){const B=Math.floor(S/2);S%2==0?(Z(d[_][B+1]),Z(d[_+1][B]),Z(d[_][B])):(Z(d[_][B+1]),Z(d[_+1][B+1]),Z(d[_+1][B]))}}function Z(ge){E.push(ge.x,ge.y,ge.z)}function J(ge,Se){const w=3*ge;Se.x=t[w+0],Se.y=t[w+1],Se.z=t[w+2]}function K(ge,Se,w,e){e<0&&1===ge.x&&(I[Se]=ge.x-1),0===w.x&&0===w.z&&(I[Se]=e/2/Math.PI+.5)}function me(ge){return Math.atan2(ge.z,-ge.x)}(function(ge){const Se=new lt,w=new lt,e=new lt;for(let c=0;c<u.length;c+=3)J(u[c+0],Se),J(u[c+1],w),J(u[c+2],e),G(Se,w,e,ge)})(g=g||0),function(ge){const Se=new lt;for(let w=0;w<E.length;w+=3)Se.x=E[w+0],Se.y=E[w+1],Se.z=E[w+2],Se.normalize().multiplyScalar(ge),E[w+0]=Se.x,E[w+1]=Se.y,E[w+2]=Se.z}(m),function(){const ge=new lt;for(let w=0;w<E.length;w+=3){ge.x=E[w+0],ge.y=E[w+1],ge.z=E[w+2];const e=me(ge)/2/Math.PI+.5,c=(Se=ge,Math.atan2(-Se.y,Math.sqrt(Se.x*Se.x+Se.z*Se.z))/Math.PI+.5);I.push(e,1-c)}var Se;(function(){const w=new lt,e=new lt,c=new lt,d=new lt,_=new wn,S=new wn,B=new wn;for(let k=0,F=0;k<E.length;k+=9,F+=6){w.set(E[k+0],E[k+1],E[k+2]),e.set(E[k+3],E[k+4],E[k+5]),c.set(E[k+6],E[k+7],E[k+8]),_.set(I[F+0],I[F+1]),S.set(I[F+2],I[F+3]),B.set(I[F+4],I[F+5]),d.copy(w).add(e).add(c).divideScalar(3);const V=me(d);K(_,F+0,w,V),K(S,F+2,e,V),K(B,F+4,c,V)}})(),function(){for(let w=0;w<I.length;w+=6){const e=I[w+0],c=I[w+2],d=I[w+4],_=Math.max(e,c,d),S=Math.min(e,c,d);_>.9&&S<.1&&(e<.2&&(I[w+0]+=1),c<.2&&(I[w+2]+=1),d<.2&&(I[w+4]+=1))}}()}(),this.setAttribute("position",new Un(E,3)),this.setAttribute("normal",new Un(E.slice(),3)),this.setAttribute("uv",new Un(I,2)),0===g?this.computeVertexNormals():this.normalizeNormals()}function Ru(t,u){Fr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new ph(t,u)),this.mergeVertices()}function ph(t,u){xs.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,u),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Bh(t,u){Fr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Hs(t,u)),this.mergeVertices()}function Hs(t,u){xs.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,u),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Dl(t,u){Fr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Sa(t,u)),this.mergeVertices()}function Sa(t,u){const m=(1+Math.sqrt(5))/2;xs.call(this,[-1,m,0,1,m,0,-1,-m,0,1,-m,0,0,-1,m,0,1,m,0,-1,-m,0,1,-m,m,0,-1,m,0,1,-m,0,-1,-m,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,u),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Ul(t,u){Fr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new zl(t,u)),this.mergeVertices()}function zl(t,u){const m=(1+Math.sqrt(5))/2,g=1/m;xs.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-g,-m,0,-g,m,0,g,-m,0,g,m,-g,-m,0,-g,m,0,g,-m,0,g,m,0,-m,0,-g,m,0,-g,-m,0,g,m,0,g],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,u),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:u}}function jl(t,u,m,g,E,I){Fr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},void 0!==I&&console.warn("THREE.TubeGeometry: taper has been removed.");const G=new Os(t,u,m,g,E);this.tangents=G.tangents,this.normals=G.normals,this.binormals=G.binormals,this.fromBufferGeometry(G),this.mergeVertices()}function Os(t,u,m,g,E){hn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},m=m||1,g=g||8;const I=t.computeFrenetFrames(u=u||64,E=E||!1);this.tangents=I.tangents,this.normals=I.normals,this.binormals=I.binormals;const G=new lt,Z=new lt,J=new wn;let K=new lt;const me=[],ge=[],Se=[],w=[];function e(c){K=t.getPointAt(c/u,K);const d=I.normals[c],_=I.binormals[c];for(let S=0;S<=g;S++){const B=S/g*Math.PI*2,k=Math.sin(B),F=-Math.cos(B);Z.x=F*d.x+k*_.x,Z.y=F*d.y+k*_.y,Z.z=F*d.z+k*_.z,Z.normalize(),ge.push(Z.x,Z.y,Z.z),G.x=K.x+m*Z.x,G.y=K.y+m*Z.y,G.z=K.z+m*Z.z,me.push(G.x,G.y,G.z)}}(function(){for(let c=0;c<u;c++)e(c);e(!1===E?u:0),function(){for(let c=0;c<=u;c++)for(let d=0;d<=g;d++)J.x=c/u,J.y=d/g,Se.push(J.x,J.y)}(),function(){for(let c=1;c<=u;c++)for(let d=1;d<=g;d++){const S=(g+1)*c+(d-1),B=(g+1)*c+d,k=(g+1)*(c-1)+d;w.push((g+1)*(c-1)+(d-1),S,k),w.push(S,B,k)}}()})(),this.setIndex(w),this.setAttribute("position",new Un(me,3)),this.setAttribute("normal",new Un(ge,3)),this.setAttribute("uv",new Un(Se,2))}function Nh(t,u,m,g,E,I,G){Fr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},void 0!==G&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Co(t,u,m,g,E,I)),this.mergeVertices()}function Co(t,u,m,g,E,I){hn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},t=t||1,u=u||.4,m=Math.floor(m)||64,g=Math.floor(g)||8,E=E||2,I=I||3;const G=[],Z=[],J=[],K=[],me=new lt,ge=new lt,Se=new lt,w=new lt,e=new lt,c=new lt,d=new lt;for(let S=0;S<=m;++S){const B=S/m*E*Math.PI*2;_(B,E,I,t,Se),_(B+.01,E,I,t,w),c.subVectors(w,Se),d.addVectors(w,Se),e.crossVectors(c,d),d.crossVectors(e,c),e.normalize(),d.normalize();for(let k=0;k<=g;++k){const F=k/g*Math.PI*2,V=-u*Math.cos(F),te=u*Math.sin(F);me.x=Se.x+(V*d.x+te*e.x),me.y=Se.y+(V*d.y+te*e.y),me.z=Se.z+(V*d.z+te*e.z),Z.push(me.x,me.y,me.z),ge.subVectors(me,Se).normalize(),J.push(ge.x,ge.y,ge.z),K.push(S/m),K.push(k/g)}}for(let S=1;S<=m;S++)for(let B=1;B<=g;B++){const F=(g+1)*S+(B-1),V=(g+1)*S+B,te=(g+1)*(S-1)+B;G.push((g+1)*(S-1)+(B-1),F,te),G.push(F,V,te)}function _(S,B,k,F,V){const te=Math.cos(S),ce=Math.sin(S),ue=k/B*S,_e=Math.cos(ue);V.x=F*(2+_e)*.5*te,V.y=F*(2+_e)*ce*.5,V.z=F*Math.sin(ue)*.5}this.setIndex(G),this.setAttribute("position",new Un(Z,3)),this.setAttribute("normal",new Un(J,3)),this.setAttribute("uv",new Un(K,2))}function rp(t,u,m,g,E){Fr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},this.fromBufferGeometry(new ou(t,u,m,g,E)),this.mergeVertices()}function ou(t,u,m,g,E){hn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},t=t||1,u=u||.4,m=Math.floor(m)||8,g=Math.floor(g)||6,E=E||2*Math.PI;const I=[],G=[],Z=[],J=[],K=new lt,me=new lt,ge=new lt;for(let Se=0;Se<=m;Se++)for(let w=0;w<=g;w++){const e=w/g*E,c=Se/m*Math.PI*2;me.x=(t+u*Math.cos(c))*Math.cos(e),me.y=(t+u*Math.cos(c))*Math.sin(e),me.z=u*Math.sin(c),G.push(me.x,me.y,me.z),K.x=t*Math.cos(e),K.y=t*Math.sin(e),ge.subVectors(me,K).normalize(),Z.push(ge.x,ge.y,ge.z),J.push(w/g),J.push(Se/m)}for(let Se=1;Se<=m;Se++)for(let w=1;w<=g;w++){const c=(g+1)*(Se-1)+w-1,d=(g+1)*(Se-1)+w,_=(g+1)*Se+w;I.push((g+1)*Se+w-1,c,_),I.push(c,d,_)}this.setIndex(I),this.setAttribute("position",new Un(G,3)),this.setAttribute("normal",new Un(Z,3)),this.setAttribute("uv",new Un(J,2))}function _f(t,u,m,g,E){let I,G;if(E===function(Z,J,K,me){let ge=0;for(let Se=J,w=K-me;Se<K;Se+=me)ge+=(Z[w]-Z[Se])*(Z[Se+1]+Z[w+1]),w=Se;return ge}(t,u,m,g)>0)for(I=u;I<m;I+=g)G=ra(I,t[I],t[I+1],G);else for(I=m-g;I>=u;I-=g)G=ra(I,t[I],t[I+1],G);return G&&Qo(G,G.next)&&(wd(G),G=G.next),G}function Pu(t,u){if(!t)return t;u||(u=t);let m,g=t;do{if(m=!1,g.steiner||!Qo(g,g.next)&&0!==fr(g.prev,g,g.next))g=g.next;else{if(wd(g),g=u=g.prev,g===g.next)break;m=!0}}while(m||g!==u);return u}function Oo(t,u,m,g,E,I,G){if(!t)return;!G&&I&&function(me,ge,Se,w){let e=me;do{null===e.z&&(e.z=oo(e.x,e.y,ge,Se,w)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==me);e.prevZ.nextZ=null,e.prevZ=null,function(c){let d,_,S,B,k,F,V,te,ce=1;do{for(_=c,c=null,k=null,F=0;_;){for(F++,S=_,V=0,d=0;d<ce&&(V++,S=S.nextZ,S);d++);for(te=ce;V>0||te>0&&S;)0!==V&&(0===te||!S||_.z<=S.z)?(B=_,_=_.nextZ,V--):(B=S,S=S.nextZ,te--),k?k.nextZ=B:c=B,B.prevZ=k,k=B;_=S}k.nextZ=null,ce*=2}while(F>1)}(e)}(t,g,E,I);let Z,J,K=t;for(;t.prev!==t.next;)if(Z=t.prev,J=t.next,I?Dc(t,g,E,I):Lo(t))u.push(Z.i/m),u.push(t.i/m),u.push(J.i/m),wd(t),t=J.next,K=J.next;else if((t=J)===K){G?1===G?Oo(t=kt(Pu(t),u,m),u,m,g,E,I,2):2===G&&Fp(t,u,m,g,E,I):Oo(Pu(t),u,m,g,E,I,1);break}}function Lo(t){let u=t.prev,m=t,g=t.next;if(fr(u,m,g)>=0)return!1;let E=t.next.next;for(;E!==t.prev;){if(ip(u.x,u.y,m.x,m.y,g.x,g.y,E.x,E.y)&&fr(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Dc(t,u,m,g){let E=t.prev,I=t,G=t.next;if(fr(E,I,G)>=0)return!1;let K=E.x>I.x?E.x>G.x?E.x:G.x:I.x>G.x?I.x:G.x,me=E.y>I.y?E.y>G.y?E.y:G.y:I.y>G.y?I.y:G.y,ge=oo(E.x<I.x?E.x<G.x?E.x:G.x:I.x<G.x?I.x:G.x,E.y<I.y?E.y<G.y?E.y:G.y:I.y<G.y?I.y:G.y,u,m,g),Se=oo(K,me,u,m,g),w=t.prevZ,e=t.nextZ;for(;w&&w.z>=ge&&e&&e.z<=Se;){if(w!==t.prev&&w!==t.next&&ip(E.x,E.y,I.x,I.y,G.x,G.y,w.x,w.y)&&fr(w.prev,w,w.next)>=0||(w=w.prevZ,e!==t.prev&&e!==t.next&&ip(E.x,E.y,I.x,I.y,G.x,G.y,e.x,e.y)&&fr(e.prev,e,e.next)>=0))return!1;e=e.nextZ}for(;w&&w.z>=ge;){if(w!==t.prev&&w!==t.next&&ip(E.x,E.y,I.x,I.y,G.x,G.y,w.x,w.y)&&fr(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;e&&e.z<=Se;){if(e!==t.prev&&e!==t.next&&ip(E.x,E.y,I.x,I.y,G.x,G.y,e.x,e.y)&&fr(e.prev,e,e.next)>=0)return!1;e=e.nextZ}return!0}function kt(t,u,m){let g=t;do{let E=g.prev,I=g.next.next;!Qo(E,I)&&gi(E,g,g.next,I)&&Fo(E,I)&&Fo(I,E)&&(u.push(E.i/m),u.push(g.i/m),u.push(I.i/m),wd(g),wd(g.next),g=t=I),g=g.next}while(g!==t);return Pu(g)}function Fp(t,u,m,g,E,I){let G=t;do{let Z=G.next.next;for(;Z!==G.prev;){if(G.i!==Z.i&&Pf(G,Z)){let J=pc(G,Z);return G=Pu(G,G.next),J=Pu(J,J.next),Oo(G,u,m,g,E,I),void Oo(J,u,m,g,E,I)}Z=Z.next}G=G.next}while(G!==t)}function ji(t,u){return t.x-u.x}function Vs(t,u){if(u=function(m,g){let E,I=g,G=m.x,Z=m.y,J=-1/0;do{if(Z<=I.y&&Z>=I.next.y&&I.next.y!==I.y){let e=I.x+(Z-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(e<=G&&e>J){if(J=e,e===G){if(Z===I.y)return I;if(Z===I.next.y)return I.next}E=I.x<I.next.x?I:I.next}}I=I.next}while(I!==g);if(!E)return null;if(G===J)return E;let K,me=E,ge=E.x,Se=E.y,w=1/0;I=E;do{G>=I.x&&I.x>=ge&&G!==I.x&&ip(Z<Se?G:J,Z,ge,Se,Z<Se?J:G,Z,I.x,I.y)&&(K=Math.abs(Z-I.y)/(G-I.x),Fo(I,m)&&(K<w||K===w&&(I.x>E.x||I.x===E.x&&ko(E,I)))&&(E=I,w=K)),I=I.next}while(I!==me);return E}(t,u)){const m=pc(u,t);Pu(u,u.next),Pu(m,m.next)}}function ko(t,u){return fr(t.prev,t,u.prev)<0&&fr(u.next,t,t.next)<0}function oo(t,u,m,g,E){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-m)*E)|t<<8))|t<<4))|t<<2))|t<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-g)*E)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function Da(t){let u=t,m=t;do{(u.x<m.x||u.x===m.x&&u.y<m.y)&&(m=u),u=u.next}while(u!==t);return m}function ip(t,u,m,g,E,I,G,Z){return(E-G)*(u-Z)-(t-G)*(I-Z)>=0&&(t-G)*(g-Z)-(m-G)*(u-Z)>=0&&(m-G)*(I-Z)-(E-G)*(g-Z)>=0}function Pf(t,u){return t.next.i!==u.i&&t.prev.i!==u.i&&!function(m,g){let E=m;do{if(E.i!==m.i&&E.next.i!==m.i&&E.i!==g.i&&E.next.i!==g.i&&gi(E,E.next,m,g))return!0;E=E.next}while(E!==m);return!1}(t,u)&&(Fo(t,u)&&Fo(u,t)&&function(m,g){let E=m,I=!1,G=(m.x+g.x)/2,Z=(m.y+g.y)/2;do{E.y>Z!=E.next.y>Z&&E.next.y!==E.y&&G<(E.next.x-E.x)*(Z-E.y)/(E.next.y-E.y)+E.x&&(I=!I),E=E.next}while(E!==m);return I}(t,u)&&(fr(t.prev,t,u.prev)||fr(t,u.prev,u))||Qo(t,u)&&fr(t.prev,t,t.next)>0&&fr(u.prev,u,u.next)>0)}function fr(t,u,m){return(u.y-t.y)*(m.x-u.x)-(u.x-t.x)*(m.y-u.y)}function Qo(t,u){return t.x===u.x&&t.y===u.y}function gi(t,u,m,g){const E=hi(fr(t,u,m)),I=hi(fr(t,u,g)),G=hi(fr(m,g,t)),Z=hi(fr(m,g,u));return E!==I&&G!==Z||!(0!==E||!Wo(t,m,u))||!(0!==I||!Wo(t,g,u))||!(0!==G||!Wo(m,t,g))||!(0!==Z||!Wo(m,u,g))}function Wo(t,u,m){return u.x<=Math.max(t.x,m.x)&&u.x>=Math.min(t.x,m.x)&&u.y<=Math.max(t.y,m.y)&&u.y>=Math.min(t.y,m.y)}function hi(t){return t>0?1:t<0?-1:0}function Fo(t,u){return fr(t.prev,t,t.next)<0?fr(t,u,t.next)>=0&&fr(t,t.prev,u)>=0:fr(t,u,t.prev)<0||fr(t,t.next,u)<0}function pc(t,u){let m=new Dp(t.i,t.x,t.y),g=new Dp(u.i,u.x,u.y),E=t.next,I=u.prev;return t.next=u,u.prev=t,m.next=E,E.prev=m,g.next=m,m.prev=g,I.next=g,g.prev=I,g}function ra(t,u,m,g){const E=new Dp(t,u,m);return g?(E.next=g.next,E.prev=g,g.next.prev=E,g.next=E):(E.prev=E,E.next=E),E}function wd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Dp(t,u,m){this.i=t,this.x=u,this.y=m,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}kc.prototype=Object.assign(Object.create(Kn.prototype),{constructor:kc,isPoints:!0,copy:function(t){return Kn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Points.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),na.copy(m.boundingSphere),na.applyMatrix4(g),na.radius+=E,!1===t.ray.intersectsSphere(na))return;Vo.getInverse(g),Fl.copy(t.ray).applyMatrix4(Vo);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),G=I*I;if(m.isBufferGeometry){const Z=m.index,J=m.attributes.position.array;if(null!==Z){const K=Z.array;for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Fa.fromArray(J,3*Se),cc(Fa,Se,G,g,t,u,this)}}else for(let K=0,me=J.length/3;K<me;K++)Fa.fromArray(J,3*K),cc(Fa,K,G,g,t,u,this)}else{const Z=m.vertices;for(let J=0,K=Z.length;J<K;J++)cc(Z[J],J,G,g,t,u,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const G=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[G]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),xd.prototype=Object.assign(Object.create(di.prototype),{constructor:xd,isVideoTexture:!0,update:function(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(uc.prototype=Object.create(di.prototype)).constructor=uc,uc.prototype.isCompressedTexture=!0,(iu.prototype=Object.create(di.prototype)).constructor=iu,iu.prototype.isCanvasTexture=!0,(Bu.prototype=Object.create(di.prototype)).constructor=Bu,Bu.prototype.isDepthTexture=!0,(hc.prototype=Object.create(hn.prototype)).constructor=hc,(hh.prototype=Object.create(Fr.prototype)).constructor=hh,(Fc.prototype=Object.create(hn.prototype)).constructor=Fc,(Nu.prototype=Object.create(Fr.prototype)).constructor=Nu,(xs.prototype=Object.create(hn.prototype)).constructor=xs,(Ru.prototype=Object.create(Fr.prototype)).constructor=Ru,(ph.prototype=Object.create(xs.prototype)).constructor=ph,(Bh.prototype=Object.create(Fr.prototype)).constructor=Bh,(Hs.prototype=Object.create(xs.prototype)).constructor=Hs,(Dl.prototype=Object.create(Fr.prototype)).constructor=Dl,(Sa.prototype=Object.create(xs.prototype)).constructor=Sa,(Ul.prototype=Object.create(Fr.prototype)).constructor=Ul,(zl.prototype=Object.create(xs.prototype)).constructor=zl,(jl.prototype=Object.create(Fr.prototype)).constructor=jl,(Os.prototype=Object.create(hn.prototype)).constructor=Os,Os.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Nh.prototype=Object.create(Fr.prototype)).constructor=Nh,(Co.prototype=Object.create(hn.prototype)).constructor=Co,(rp.prototype=Object.create(Fr.prototype)).constructor=rp,(ou.prototype=Object.create(hn.prototype)).constructor=ou;const Iu={area:function(t){const u=t.length;let m=0;for(let g=u-1,E=0;E<u;g=E++)m+=t[g].x*t[E].y-t[E].x*t[g].y;return.5*m},isClockWise:function(t){return Iu.area(t)<0},triangulateShape:function(t,u){const m=[],g=[],E=[];gf(t),qd(m,t);let I=t.length;u.forEach(gf);for(let Z=0;Z<u.length;Z++)g.push(I),I+=u[Z].length,qd(m,u[Z]);const G=function(Z,J,K){K=K||2;let me,ge,Se,w,e,c,d,_=J&&J.length,S=_?J[0]*K:Z.length,B=_f(Z,0,S,K,!0),k=[];if(!B||B.next===B.prev)return k;if(_&&(B=function(F,V,te,ce){let ue,_e,Ee,$e,Be,Re=[];for(ue=0,_e=V.length;ue<_e;ue++)Ee=V[ue]*ce,$e=ue<_e-1?V[ue+1]*ce:F.length,Be=_f(F,Ee,$e,ce,!1),Be===Be.next&&(Be.steiner=!0),Re.push(Da(Be));for(Re.sort(ji),ue=0;ue<Re.length;ue++)Vs(Re[ue],te),te=Pu(te,te.next);return te}(Z,J,B,K)),Z.length>80*K){me=Se=Z[0],ge=w=Z[1];for(let F=K;F<S;F+=K)e=Z[F],c=Z[F+1],e<me&&(me=e),c<ge&&(ge=c),e>Se&&(Se=e),c>w&&(w=c);d=Math.max(Se-me,w-ge),d=0!==d?1/d:0}return Oo(B,k,K,me,ge,d),k}(m,g);for(let Z=0;Z<G.length;Z+=3)E.push(G.slice(Z,Z+3));return E}};function gf(t){const u=t.length;u>2&&t[u-1].equals(t[0])&&t.pop()}function qd(t,u){for(let m=0;m<u.length;m++)t.push(u[m].x),t.push(u[m].y)}function su(t,u){Fr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:u},this.fromBufferGeometry(new rl(t,u)),this.mergeVertices()}function rl(t,u){hn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:u},t=Array.isArray(t)?t:[t];const m=this,g=[],E=[];for(let G=0,Z=t.length;G<Z;G++)I(t[G]);function I(G){const Z=[],J=void 0!==u.curveSegments?u.curveSegments:12,K=void 0!==u.steps?u.steps:1;let me=void 0!==u.depth?u.depth:100,ge=void 0===u.bevelEnabled||u.bevelEnabled,Se=void 0!==u.bevelThickness?u.bevelThickness:6,w=void 0!==u.bevelSize?u.bevelSize:Se-2,e=void 0!==u.bevelOffset?u.bevelOffset:0,c=void 0!==u.bevelSegments?u.bevelSegments:3;const d=u.extrudePath,_=void 0!==u.UVGenerator?u.UVGenerator:Zp;void 0!==u.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),me=u.amount);let S,B,k,F,V,te=!1;d&&(S=d.getSpacedPoints(K),te=!0,ge=!1,B=d.computeFrenetFrames(K,!1),k=new lt,F=new lt,V=new lt),ge||(c=0,Se=0,w=0,e=0);const ce=G.extractPoints(J);let ue=ce.shape;const _e=ce.holes;if(!Iu.isClockWise(ue)){ue=ue.reverse();for(let _t=0,zt=_e.length;_t<zt;_t++){const Rt=_e[_t];Iu.isClockWise(Rt)&&(_e[_t]=Rt.reverse())}}const Ee=Iu.triangulateShape(ue,_e),$e=ue;for(let _t=0,zt=_e.length;_t<zt;_t++)ue=ue.concat(_e[_t]);function Be(_t,zt,Rt){return zt||console.error("THREE.ExtrudeGeometry: vec does not exist"),zt.clone().multiplyScalar(Rt).add(_t)}const Re=ue.length,We=Ee.length;function tt(_t,zt,Rt){let nn,en,En;const rt=_t.x-zt.x,ut=_t.y-zt.y,rn=Rt.x-_t.x,un=Rt.y-_t.y,_n=rt*rt+ut*ut;if(Math.abs(rt*un-ut*rn)>Number.EPSILON){const Jn=Math.sqrt(_n),Zn=Math.sqrt(rn*rn+un*un),cn=zt.x-ut/Jn,mt=zt.y+rt/Jn,Kt=((Rt.x-un/Zn-cn)*un-(Rt.y+rn/Zn-mt)*rn)/(rt*un-ut*rn);nn=cn+rt*Kt-_t.x,en=mt+ut*Kt-_t.y;const Vt=nn*nn+en*en;if(Vt<=2)return new wn(nn,en);En=Math.sqrt(Vt/2)}else{let Jn=!1;rt>Number.EPSILON?rn>Number.EPSILON&&(Jn=!0):rt<-Number.EPSILON?rn<-Number.EPSILON&&(Jn=!0):Math.sign(ut)===Math.sign(un)&&(Jn=!0),Jn?(nn=-ut,en=rt,En=Math.sqrt(_n)):(nn=rt,en=ut,En=Math.sqrt(_n/2))}return new wn(nn/En,en/En)}const Ze=[];for(let _t=0,zt=$e.length,Rt=zt-1,nn=_t+1;_t<zt;_t++,Rt++,nn++)Rt===zt&&(Rt=0),nn===zt&&(nn=0),Ze[_t]=tt($e[_t],$e[Rt],$e[nn]);const ot=[];let st,Ct=Ze.concat();for(let _t=0,zt=_e.length;_t<zt;_t++){const Rt=_e[_t];st=[];for(let nn=0,en=Rt.length,En=en-1,rt=nn+1;nn<en;nn++,En++,rt++)En===en&&(En=0),rt===en&&(rt=0),st[nn]=tt(Rt[nn],Rt[En],Rt[rt]);ot.push(st),Ct=Ct.concat(st)}for(let _t=0;_t<c;_t++){const zt=_t/c,Rt=Se*Math.cos(zt*Math.PI/2),nn=w*Math.sin(zt*Math.PI/2)+e;for(let en=0,En=$e.length;en<En;en++){const rt=Be($e[en],Ze[en],nn);nt(rt.x,rt.y,-Rt)}for(let en=0,En=_e.length;en<En;en++){const rt=_e[en];st=ot[en];for(let ut=0,rn=rt.length;ut<rn;ut++){const un=Be(rt[ut],st[ut],nn);nt(un.x,un.y,-Rt)}}}const Ft=w+e;for(let _t=0;_t<Re;_t++){const zt=ge?Be(ue[_t],Ct[_t],Ft):ue[_t];te?(F.copy(B.normals[0]).multiplyScalar(zt.x),k.copy(B.binormals[0]).multiplyScalar(zt.y),V.copy(S[0]).add(F).add(k),nt(V.x,V.y,V.z)):nt(zt.x,zt.y,0)}for(let _t=1;_t<=K;_t++)for(let zt=0;zt<Re;zt++){const Rt=ge?Be(ue[zt],Ct[zt],Ft):ue[zt];te?(F.copy(B.normals[_t]).multiplyScalar(Rt.x),k.copy(B.binormals[_t]).multiplyScalar(Rt.y),V.copy(S[_t]).add(F).add(k),nt(V.x,V.y,V.z)):nt(Rt.x,Rt.y,me/K*_t)}for(let _t=c-1;_t>=0;_t--){const zt=_t/c,Rt=Se*Math.cos(zt*Math.PI/2),nn=w*Math.sin(zt*Math.PI/2)+e;for(let en=0,En=$e.length;en<En;en++){const rt=Be($e[en],Ze[en],nn);nt(rt.x,rt.y,me+Rt)}for(let en=0,En=_e.length;en<En;en++){const rt=_e[en];st=ot[en];for(let ut=0,rn=rt.length;ut<rn;ut++){const un=Be(rt[ut],st[ut],nn);te?nt(un.x,un.y+S[K-1].y,S[K-1].x+Rt):nt(un.x,un.y,me+Rt)}}}function Qe(_t,zt){let Rt=_t.length;for(;--Rt>=0;){const nn=Rt;let en=Rt-1;en<0&&(en=_t.length-1);for(let En=0,rt=K+2*c;En<rt;En++){const ut=Re*En,rn=Re*(En+1);Jt(zt+nn+ut,zt+en+ut,zt+en+rn,zt+nn+rn)}}}function nt(_t,zt,Rt){Z.push(_t),Z.push(zt),Z.push(Rt)}function Et(_t,zt,Rt){ct(_t),ct(zt),ct(Rt);const nn=g.length/3,en=_.generateTopUV(m,g,nn-3,nn-2,nn-1);Lt(en[0]),Lt(en[1]),Lt(en[2])}function Jt(_t,zt,Rt,nn){ct(_t),ct(zt),ct(nn),ct(zt),ct(Rt),ct(nn);const en=g.length/3,En=_.generateSideWallUV(m,g,en-6,en-3,en-2,en-1);Lt(En[0]),Lt(En[1]),Lt(En[3]),Lt(En[1]),Lt(En[2]),Lt(En[3])}function ct(_t){g.push(Z[3*_t+0]),g.push(Z[3*_t+1]),g.push(Z[3*_t+2])}function Lt(_t){E.push(_t.x),E.push(_t.y)}(function(){const _t=g.length/3;if(ge){let zt=0,Rt=Re*zt;for(let nn=0;nn<We;nn++){const en=Ee[nn];Et(en[2]+Rt,en[1]+Rt,en[0]+Rt)}zt=K+2*c,Rt=Re*zt;for(let nn=0;nn<We;nn++){const en=Ee[nn];Et(en[0]+Rt,en[1]+Rt,en[2]+Rt)}}else{for(let zt=0;zt<We;zt++){const Rt=Ee[zt];Et(Rt[2],Rt[1],Rt[0])}for(let zt=0;zt<We;zt++){const Rt=Ee[zt];Et(Rt[0]+Re*K,Rt[1]+Re*K,Rt[2]+Re*K)}}m.addGroup(_t,g.length/3-_t,0)})(),function(){const _t=g.length/3;let zt=0;Qe($e,zt),zt+=$e.length;for(let Rt=0,nn=_e.length;Rt<nn;Rt++){const en=_e[Rt];Qe(en,zt),zt+=en.length}m.addGroup(_t,g.length/3-_t,1)}()}this.setAttribute("position",new Un(g,3)),this.setAttribute("uv",new Un(E,2)),this.computeVertexNormals()}(su.prototype=Object.create(Fr.prototype)).constructor=su,su.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return au(this.parameters.shapes,this.parameters.options,t)},(rl.prototype=Object.create(hn.prototype)).constructor=rl,rl.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return au(this.parameters.shapes,this.parameters.options,t)};const Zp={generateTopUV:function(t,u,m,g,E){const Z=u[3*g],J=u[3*g+1],K=u[3*E],me=u[3*E+1];return[new wn(u[3*m],u[3*m+1]),new wn(Z,J),new wn(K,me)]},generateSideWallUV:function(t,u,m,g,E,I){const G=u[3*m],Z=u[3*m+1],J=u[3*m+2],K=u[3*g],me=u[3*g+1],ge=u[3*g+2],Se=u[3*E],w=u[3*E+1],e=u[3*E+2],c=u[3*I],d=u[3*I+1],_=u[3*I+2];return Math.abs(Z-me)<.01?[new wn(G,1-J),new wn(K,1-ge),new wn(Se,1-e),new wn(c,1-_)]:[new wn(Z,1-J),new wn(me,1-ge),new wn(w,1-e),new wn(d,1-_)]}};function au(t,u,m){if(m.shapes=[],Array.isArray(t))for(let g=0,E=t.length;g<E;g++)m.shapes.push(t[g].uuid);else m.shapes.push(t.uuid);return void 0!==u.extrudePath&&(m.options.extrudePath=u.extrudePath.toJSON()),m}function to(t,u){Fr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:u},this.fromBufferGeometry(new Mr(t,u)),this.mergeVertices()}function Mr(t,u){const m=(u=u||{}).font;if(!m||!m.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Fr;const g=m.generateShapes(t,u.size);u.depth=void 0!==u.height?u.height:50,void 0===u.bevelThickness&&(u.bevelThickness=10),void 0===u.bevelSize&&(u.bevelSize=8),void 0===u.bevelEnabled&&(u.bevelEnabled=!1),rl.call(this,g,u),this.type="TextBufferGeometry"}function Yr(t,u,m,g,E,I,G){Fr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:G},this.fromBufferGeometry(new Ou(t,u,m,g,E,I,G)),this.mergeVertices()}function Ou(t,u,m,g,E,I,G){hn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:G},t=t||1,u=Math.max(3,Math.floor(u)||8),m=Math.max(2,Math.floor(m)||6),g=void 0!==g?g:0,E=void 0!==E?E:2*Math.PI,I=void 0!==I?I:0,G=void 0!==G?G:Math.PI;const Z=Math.min(I+G,Math.PI);let J=0;const K=[],me=new lt,ge=new lt,Se=[],w=[],e=[],c=[];for(let d=0;d<=m;d++){const _=[],S=d/m;let B=0;0==d&&0==I?B=.5/u:d==m&&Z==Math.PI&&(B=-.5/u);for(let k=0;k<=u;k++){const F=k/u;me.x=-t*Math.cos(g+F*E)*Math.sin(I+S*G),me.y=t*Math.cos(I+S*G),me.z=t*Math.sin(g+F*E)*Math.sin(I+S*G),w.push(me.x,me.y,me.z),ge.copy(me).normalize(),e.push(ge.x,ge.y,ge.z),c.push(F+B,1-S),_.push(J++)}K.push(_)}for(let d=0;d<m;d++)for(let _=0;_<u;_++){const B=K[d][_],k=K[d+1][_],F=K[d+1][_+1];(0!==d||I>0)&&Se.push(K[d][_+1],B,F),(d!==m-1||Z<Math.PI)&&Se.push(B,k,F)}this.setIndex(Se),this.setAttribute("position",new Un(w,3)),this.setAttribute("normal",new Un(e,3)),this.setAttribute("uv",new Un(c,2))}function ku(t,u,m,g,E,I){Fr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},this.fromBufferGeometry(new lu(t,u,m,g,E,I)),this.mergeVertices()}function lu(t,u,m,g,E,I){hn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},t=t||.5,u=u||1,E=void 0!==E?E:0,I=void 0!==I?I:2*Math.PI,m=void 0!==m?Math.max(3,m):8;const G=[],Z=[],J=[],K=[];let me=t;const ge=(u-t)/(g=void 0!==g?Math.max(1,g):1),Se=new lt,w=new wn;for(let e=0;e<=g;e++){for(let c=0;c<=m;c++){const d=E+c/m*I;Se.x=me*Math.cos(d),Se.y=me*Math.sin(d),Z.push(Se.x,Se.y,Se.z),J.push(0,0,1),w.x=(Se.x/u+1)/2,w.y=(Se.y/u+1)/2,K.push(w.x,w.y)}me+=ge}for(let e=0;e<g;e++){const c=e*(m+1);for(let d=0;d<m;d++){const _=d+c,B=_+m+1,k=_+m+2,F=_+1;G.push(_,B,F),G.push(B,k,F)}}this.setIndex(G),this.setAttribute("position",new Un(Z,3)),this.setAttribute("normal",new Un(J,3)),this.setAttribute("uv",new Un(K,2))}function Ua(t,u,m,g){Fr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},this.fromBufferGeometry(new Fu(t,u,m,g)),this.mergeVertices()}function Fu(t,u,m,g){hn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},u=Math.floor(u)||12,m=m||0,g=g||2*Math.PI,g=tr.clamp(g,0,2*Math.PI);const E=[],I=[],G=[],Z=1/u,J=new lt,K=new wn;for(let me=0;me<=u;me++){const ge=m+me*Z*g,Se=Math.sin(ge),w=Math.cos(ge);for(let e=0;e<=t.length-1;e++)J.x=t[e].x*Se,J.y=t[e].y,J.z=t[e].x*w,I.push(J.x,J.y,J.z),K.x=me/u,K.y=e/(t.length-1),G.push(K.x,K.y)}for(let me=0;me<u;me++)for(let ge=0;ge<t.length-1;ge++){const Se=ge+me*t.length,e=Se+t.length,c=Se+t.length+1,d=Se+1;E.push(Se,e,d),E.push(e,c,d)}if(this.setIndex(E),this.setAttribute("position",new Un(I,3)),this.setAttribute("uv",new Un(G,2)),this.computeVertexNormals(),g===2*Math.PI){const me=this.attributes.normal.array,ge=new lt,Se=new lt,w=new lt,e=u*t.length*3;for(let c=0,d=0;c<t.length;c++,d+=3)ge.x=me[d+0],ge.y=me[d+1],ge.z=me[d+2],Se.x=me[e+d+0],Se.y=me[e+d+1],Se.z=me[e+d+2],w.addVectors(ge,Se).normalize(),me[d+0]=me[e+d+0]=w.x,me[d+1]=me[e+d+1]=w.y,me[d+2]=me[e+d+2]=w.z}}function cu(t,u){Fr.call(this),this.type="ShapeGeometry","object"==typeof u&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),u=u.curveSegments),this.parameters={shapes:t,curveSegments:u},this.fromBufferGeometry(new Xn(t,u)),this.mergeVertices()}function Xn(t,u){hn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:u},u=u||12;const m=[],g=[],E=[],I=[];let G=0,Z=0;if(!1===Array.isArray(t))J(t);else for(let K=0;K<t.length;K++)J(t[K]),this.addGroup(G,Z,K),G+=Z,Z=0;function J(K){const me=g.length/3,ge=K.extractPoints(u);let Se=ge.shape;const w=ge.holes;!1===Iu.isClockWise(Se)&&(Se=Se.reverse());for(let c=0,d=w.length;c<d;c++){const _=w[c];!0===Iu.isClockWise(_)&&(w[c]=_.reverse())}const e=Iu.triangulateShape(Se,w);for(let c=0,d=w.length;c<d;c++)Se=Se.concat(w[c]);for(let c=0,d=Se.length;c<d;c++){const _=Se[c];g.push(_.x,_.y,0),E.push(0,0,1),I.push(_.x,_.y)}for(let c=0,d=e.length;c<d;c++){const _=e[c];m.push(_[0]+me,_[1]+me,_[2]+me),Z+=3}}this.setIndex(m),this.setAttribute("position",new Un(g,3)),this.setAttribute("normal",new Un(E,3)),this.setAttribute("uv",new Un(I,2))}function Oi(t,u){if(u.shapes=[],Array.isArray(t))for(let m=0,g=t.length;m<g;m++)u.shapes.push(t[m].uuid);else u.shapes.push(t.uuid);return u}function Rh(t,u){hn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:u},u=void 0!==u?u:1;const m=[],g=Math.cos(tr.DEG2RAD*u),E=[0,0],I={};let G,Z,J;const K=["a","b","c"];let me;t.isBufferGeometry?(me=new Fr,me.fromBufferGeometry(t)):me=t.clone(),me.mergeVertices(),me.computeFaceNormals();const ge=me.vertices,Se=me.faces;for(let w=0,e=Se.length;w<e;w++){const c=Se[w];for(let d=0;d<3;d++)G=c[K[d]],Z=c[K[(d+1)%3]],E[0]=Math.min(G,Z),E[1]=Math.max(G,Z),J=E[0]+","+E[1],void 0===I[J]?I[J]={index1:E[0],index2:E[1],face1:w,face2:void 0}:I[J].face2=w}for(J in I){const w=I[J];if(void 0===w.face2||Se[w.face1].normal.dot(Se[w.face2].normal)<=g){let e=ge[w.index1];m.push(e.x,e.y,e.z),e=ge[w.index2],m.push(e.x,e.y,e.z)}}this.setAttribute("position",new Un(m,3))}function Pn(t,u,m,g,E,I,G,Z){Fr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:G,thetaLength:Z},this.fromBufferGeometry(new Do(t,u,m,g,E,I,G,Z)),this.mergeVertices()}function Do(t,u,m,g,E,I,G,Z){hn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:G,thetaLength:Z};const J=this;t=void 0!==t?t:1,u=void 0!==u?u:1,m=m||1,g=Math.floor(g)||8,E=Math.floor(E)||1,I=void 0!==I&&I,G=void 0!==G?G:0,Z=void 0!==Z?Z:2*Math.PI;const K=[],me=[],ge=[],Se=[];let w=0;const e=[],c=m/2;let d=0;function _(S){let B,k;const F=new wn,V=new lt;let te=0;const ce=!0===S?t:u,ue=!0===S?1:-1;B=w;for(let _e=1;_e<=g;_e++)me.push(0,c*ue,0),ge.push(0,ue,0),Se.push(.5,.5),w++;k=w;for(let _e=0;_e<=g;_e++){const Ee=_e/g*Z+G,$e=Math.cos(Ee),Be=Math.sin(Ee);V.x=ce*Be,V.y=c*ue,V.z=ce*$e,me.push(V.x,V.y,V.z),ge.push(0,ue,0),F.x=.5*$e+.5,F.y=.5*Be*ue+.5,Se.push(F.x,F.y),w++}for(let _e=0;_e<g;_e++){const Ee=B+_e,$e=k+_e;!0===S?K.push($e,$e+1,Ee):K.push($e+1,$e,Ee),te+=3}J.addGroup(d,te,!0===S?1:2),d+=te}(function(){const S=new lt,B=new lt;let k=0;const F=(u-t)/m;for(let V=0;V<=E;V++){const te=[],ce=V/E,ue=ce*(u-t)+t;for(let _e=0;_e<=g;_e++){const Ee=_e/g,$e=Ee*Z+G,Be=Math.sin($e),Re=Math.cos($e);B.x=ue*Be,B.y=-ce*m+c,B.z=ue*Re,me.push(B.x,B.y,B.z),S.set(Be,F,Re).normalize(),ge.push(S.x,S.y,S.z),Se.push(Ee,1-ce),te.push(w++)}e.push(te)}for(let V=0;V<g;V++)for(let te=0;te<E;te++){const ue=e[te+1][V],_e=e[te+1][V+1],Ee=e[te][V+1];K.push(e[te][V],ue,Ee),K.push(ue,_e,Ee),k+=6}J.addGroup(d,k,0),d+=k})(),!1===I&&(t>0&&_(!0),u>0&&_(!1)),this.setIndex(K),this.setAttribute("position",new Un(me,3)),this.setAttribute("normal",new Un(ge,3)),this.setAttribute("uv",new Un(Se,2))}function Gi(t,u,m,g,E,I,G){Pn.call(this,0,t,u,m,g,E,I,G),this.type="ConeGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:G}}function Qp(t,u,m,g,E,I,G){Do.call(this,0,t,u,m,g,E,I,G),this.type="ConeBufferGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:G}}function Ph(t,u,m,g){Fr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},this.fromBufferGeometry(new Du(t,u,m,g)),this.mergeVertices()}function Du(t,u,m,g){hn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},t=t||1,u=void 0!==u?Math.max(3,u):8,m=void 0!==m?m:0,g=void 0!==g?g:2*Math.PI;const E=[],I=[],G=[],Z=[],J=new lt,K=new wn;I.push(0,0,0),G.push(0,0,1),Z.push(.5,.5);for(let me=0,ge=3;me<=u;me++,ge+=3){const Se=m+me/u*g;J.x=t*Math.cos(Se),J.y=t*Math.sin(Se),I.push(J.x,J.y,J.z),G.push(0,0,1),K.x=(I[ge]/t+1)/2,K.y=(I[ge+1]/t+1)/2,Z.push(K.x,K.y)}for(let me=1;me<=u;me++)E.push(me,me+1,0);this.setIndex(E),this.setAttribute("position",new Un(I,3)),this.setAttribute("normal",new Un(G,3)),this.setAttribute("uv",new Un(Z,2))}(to.prototype=Object.create(Fr.prototype)).constructor=to,(Mr.prototype=Object.create(rl.prototype)).constructor=Mr,(Yr.prototype=Object.create(Fr.prototype)).constructor=Yr,(Ou.prototype=Object.create(hn.prototype)).constructor=Ou,(ku.prototype=Object.create(Fr.prototype)).constructor=ku,(lu.prototype=Object.create(hn.prototype)).constructor=lu,(Ua.prototype=Object.create(Fr.prototype)).constructor=Ua,(Fu.prototype=Object.create(hn.prototype)).constructor=Fu,(cu.prototype=Object.create(Fr.prototype)).constructor=cu,cu.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return Oi(this.parameters.shapes,t)},(Xn.prototype=Object.create(hn.prototype)).constructor=Xn,Xn.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return Oi(this.parameters.shapes,t)},(Rh.prototype=Object.create(hn.prototype)).constructor=Rh,(Pn.prototype=Object.create(Fr.prototype)).constructor=Pn,(Do.prototype=Object.create(hn.prototype)).constructor=Do,(Gi.prototype=Object.create(Pn.prototype)).constructor=Gi,(Qp.prototype=Object.create(Do.prototype)).constructor=Qp,(Ph.prototype=Object.create(Fr.prototype)).constructor=Ph,(Du.prototype=Object.create(hn.prototype)).constructor=Du;var ia=Object.freeze({__proto__:null,WireframeGeometry:hc,ParametricGeometry:hh,ParametricBufferGeometry:Fc,TetrahedronGeometry:Ru,TetrahedronBufferGeometry:ph,OctahedronGeometry:Bh,OctahedronBufferGeometry:Hs,IcosahedronGeometry:Dl,IcosahedronBufferGeometry:Sa,DodecahedronGeometry:Ul,DodecahedronBufferGeometry:zl,PolyhedronGeometry:Nu,PolyhedronBufferGeometry:xs,TubeGeometry:jl,TubeBufferGeometry:Os,TorusKnotGeometry:Nh,TorusKnotBufferGeometry:Co,TorusGeometry:rp,TorusBufferGeometry:ou,TextGeometry:to,TextBufferGeometry:Mr,SphereGeometry:Yr,SphereBufferGeometry:Ou,RingGeometry:ku,RingBufferGeometry:lu,PlaneGeometry:Ka,PlaneBufferGeometry:Il,LatheGeometry:Ua,LatheBufferGeometry:Fu,ShapeGeometry:cu,ShapeBufferGeometry:Xn,ExtrudeGeometry:su,ExtrudeBufferGeometry:rl,EdgesGeometry:Rh,ConeGeometry:Gi,ConeBufferGeometry:Qp,CylinderGeometry:Pn,CylinderBufferGeometry:Do,CircleGeometry:Ph,CircleBufferGeometry:Du,BoxGeometry:Bs,BoxBufferGeometry:lh});function Ki(t){zr.call(this),this.type="ShadowMaterial",this.color=new ar(0),this.transparent=!0,this.setValues(t)}function oa(t){uo.call(this,t),this.type="RawShaderMaterial"}function yl(t){zr.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ar(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function so(t){yl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new wn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function Ko(t){zr.call(this),this.type="MeshPhongMaterial",this.color=new ar(16777215),this.specular=new ar(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function ws(t){zr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ar(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function ho(t){zr.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function qo(t){zr.call(this),this.type="MeshLambertMaterial",this.color=new ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function rs(t){zr.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ar(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ea(t){$o.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(Ki.prototype=Object.create(zr.prototype)).constructor=Ki,Ki.prototype.isShadowMaterial=!0,Ki.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this},(oa.prototype=Object.create(uo.prototype)).constructor=oa,oa.prototype.isRawShaderMaterial=!0,(yl.prototype=Object.create(zr.prototype)).constructor=yl,yl.prototype.isMeshStandardMaterial=!0,yl.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},(so.prototype=Object.create(yl.prototype)).constructor=so,so.prototype.isMeshPhysicalMaterial=!0,so.prototype.copy=function(t){return yl.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new ar).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},(Ko.prototype=Object.create(zr.prototype)).constructor=Ko,Ko.prototype.isMeshPhongMaterial=!0,Ko.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(ws.prototype=Object.create(zr.prototype)).constructor=ws,ws.prototype.isMeshToonMaterial=!0,ws.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(ho.prototype=Object.create(zr.prototype)).constructor=ho,ho.prototype.isMeshNormalMaterial=!0,ho.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(qo.prototype=Object.create(zr.prototype)).constructor=qo,qo.prototype.isMeshLambertMaterial=!0,qo.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(rs.prototype=Object.create(zr.prototype)).constructor=rs,rs.prototype.isMeshMatcapMaterial=!0,rs.prototype.copy=function(t){return zr.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Ea.prototype=Object.create($o.prototype)).constructor=Ea,Ea.prototype.isLineDashedMaterial=!0,Ea.prototype.copy=function(t){return $o.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Ih=Object.freeze({__proto__:null,ShadowMaterial:Ki,SpriteMaterial:_i,RawShaderMaterial:oa,ShaderMaterial:uo,PointsMaterial:kl,MeshPhysicalMaterial:so,MeshStandardMaterial:yl,MeshPhongMaterial:Ko,MeshToonMaterial:ws,MeshNormalMaterial:ho,MeshLambertMaterial:qo,MeshDepthMaterial:np,MeshDistanceMaterial:ta,MeshBasicMaterial:eo,MeshMatcapMaterial:rs,LineDashedMaterial:Ea,LineBasicMaterial:$o,Material:zr});const ao={arraySlice:function(t,u,m){return ao.isTypedArray(t)?new t.constructor(t.subarray(u,void 0!==m?m:t.length)):t.slice(u,m)},convertArray:function(t,u,m){return!t||!m&&t.constructor===u?t:"number"==typeof u.BYTES_PER_ELEMENT?new u(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const u=t.length,m=new Array(u);for(let g=0;g!==u;++g)m[g]=g;return m.sort(function(g,E){return t[g]-t[E]}),m},sortedArray:function(t,u,m){const g=t.length,E=new t.constructor(g);for(let I=0,G=0;G!==g;++I){const Z=m[I]*u;for(let J=0;J!==u;++J)E[G++]=t[Z+J]}return E},flattenJSON:function(t,u,m,g){let E=1,I=t[0];for(;void 0!==I&&void 0===I[g];)I=t[E++];if(void 0===I)return;let G=I[g];if(void 0!==G)if(Array.isArray(G))do{G=I[g],void 0!==G&&(u.push(I.time),m.push.apply(m,G)),I=t[E++]}while(void 0!==I);else if(void 0!==G.toArray)do{G=I[g],void 0!==G&&(u.push(I.time),G.toArray(m,m.length)),I=t[E++]}while(void 0!==I);else do{G=I[g],void 0!==G&&(u.push(I.time),m.push(G)),I=t[E++]}while(void 0!==I)},subclip:function(t,u,m,g,E){E=E||30;const I=t.clone();I.name=u;const G=[];for(let J=0;J<I.tracks.length;++J){const K=I.tracks[J],me=K.getValueSize(),ge=[],Se=[];for(let w=0;w<K.times.length;++w){const e=K.times[w]*E;if(!(e<m||e>=g)){ge.push(K.times[w]);for(let c=0;c<me;++c)Se.push(K.values[w*me+c])}}0!==ge.length&&(K.times=ao.convertArray(ge,K.times.constructor),K.values=ao.convertArray(Se,K.values.constructor),G.push(K))}I.tracks=G;let Z=1/0;for(let J=0;J<I.tracks.length;++J)Z>I.tracks[J].times[0]&&(Z=I.tracks[J].times[0]);for(let J=0;J<I.tracks.length;++J)I.tracks[J].shift(-1*Z);return I.resetDuration(),I},makeClipAdditive:function(t,u,m,g){void 0===u&&(u=0),void 0===m&&(m=t),(void 0===g||g<=0)&&(g=30);const E=t.tracks.length,I=u/g;for(let G=0;G<E;++G){const Z=m.tracks[G],J=Z.ValueTypeName;if("bool"===J||"string"===J)continue;const K=t.tracks.find(function(e){return e.name===Z.name&&e.ValueTypeName===J});if(void 0===K)continue;const me=Z.getValueSize(),ge=Z.times.length-1;let Se;if(I<=Z.times[0])Se=ao.arraySlice(Z.values,0,Z.valueSize);else if(I>=Z.times[ge])Se=ao.arraySlice(Z.values,ge*me);else{const e=Z.createInterpolant();e.evaluate(I),Se=e.resultBuffer}"quaternion"===J&&new yo(Se[0],Se[1],Se[2],Se[3]).normalize().conjugate().toArray(Se);const w=K.times.length;for(let e=0;e<w;++e){const c=e*me;if("quaternion"===J)yo.multiplyQuaternionsFlat(K.values,c,Se,0,K.values,c);else for(let d=0;d<me;++d)K.values[c+d]-=Se[d]}}return t.blendMode=th,t}};function Ta(t,u,m,g){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==g?g:new u.constructor(m),this.sampleValues=u,this.valueSize=m}function xl(t,u,m,g){Ta.call(this,t,u,m,g),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function uu(t,u,m,g){Ta.call(this,t,u,m,g)}function za(t,u,m,g){Ta.call(this,t,u,m,g)}function as(t,u,m,g){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===u||0===u.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=ao.convertArray(u,this.TimeBufferType),this.values=ao.convertArray(m,this.ValueBufferType),this.setInterpolation(g||this.DefaultInterpolation)}function Kp(t,u,m){as.call(this,t,u,m)}function wl(t,u,m,g){as.call(this,t,u,m,g)}function Gl(t,u,m,g){as.call(this,t,u,m,g)}function Uu(t,u,m,g){Ta.call(this,t,u,m,g)}function po(t,u,m,g){as.call(this,t,u,m,g)}function dh(t,u,m,g){as.call(this,t,u,m,g)}function hu(t,u,m,g){as.call(this,t,u,m,g)}function ls(t,u,m,g){this.name=t,this.tracks=m,this.duration=void 0!==u?u:-1,this.blendMode=void 0!==g?g:eh,this.uuid=tr.generateUUID(),this.duration<0&&this.resetDuration()}function Hi(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const u=function(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gl;case"vector":case"vector2":case"vector3":case"vector4":return hu;case"color":return wl;case"quaternion":return po;case"bool":case"boolean":return Kp;case"string":return dh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}(t.type);if(void 0===t.times){const m=[],g=[];ao.flattenJSON(t.keys,m,g,"value"),t.times=m,t.values=g}return void 0!==u.parse?u.parse(t):new u(t.name,t.times,t.values,t.interpolation)}Object.assign(Ta.prototype,{evaluate:function(t){let u=this.parameterPositions,m=this._cachedIndex,g=u[m],E=u[m-1];e:{t:{let I;n:{r:if(!(t<g)){for(let G=m+2;;){if(void 0===g){if(t<E)break r;return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,t,E)}if(m===G)break;if(E=g,g=u[++m],t<g)break t}I=u.length;break n}if(t>=E)break e;{const G=u[1];t<G&&(m=2,E=G);for(let Z=m-2;;){if(void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(m===Z)break;if(g=E,E=u[--m-1],t>=E)break t}I=m,m=0}}for(;m<I;){const G=m+I>>>1;t<u[G]?I=G:m=G+1}if(g=u[m],E=u[m-1],void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(void 0===g)return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,E,t)}this._cachedIndex=m,this.intervalChanged_(m,E,g)}return this.interpolate_(m,E,t,g)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const u=this.resultBuffer,m=this.sampleValues,g=this.valueSize,E=t*g;for(let I=0;I!==g;++I)u[I]=m[E+I];return u},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ta.prototype,{beforeStart_:Ta.prototype.copySampleValue_,afterEnd_:Ta.prototype.copySampleValue_}),xl.prototype=Object.assign(Object.create(Ta.prototype),{constructor:xl,DefaultSettings_:{endingStart:La,endingEnd:La},intervalChanged_:function(t,u,m){let g=this.parameterPositions,E=t-2,I=t+1,G=g[E],Z=g[I];if(void 0===G)switch(this.getSettings_().endingStart){case pa:E=t,G=2*u-m;break;case Al:E=g.length-2,G=u+g[E]-g[E+1];break;default:E=t,G=m}if(void 0===Z)switch(this.getSettings_().endingEnd){case pa:I=t,Z=2*m-u;break;case Al:I=1,Z=m+g[1]-g[0];break;default:I=t-1,Z=u}const J=.5*(m-u),K=this.valueSize;this._weightPrev=J/(u-G),this._weightNext=J/(Z-m),this._offsetPrev=E*K,this._offsetNext=I*K},interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,G=this.valueSize,Z=t*G,J=Z-G,K=this._offsetPrev,me=this._offsetNext,ge=this._weightPrev,Se=this._weightNext,w=(m-u)/(g-u),e=w*w,c=e*w,d=-ge*c+2*ge*e-ge*w,_=(1+ge)*c+(-1.5-2*ge)*e+(-.5+ge)*w+1,S=(-1-Se)*c+(1.5+Se)*e+.5*w,B=Se*c-Se*e;for(let k=0;k!==G;++k)E[k]=d*I[K+k]+_*I[J+k]+S*I[Z+k]+B*I[me+k];return E}}),uu.prototype=Object.assign(Object.create(Ta.prototype),{constructor:uu,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,G=this.valueSize,Z=t*G,J=Z-G,K=(m-u)/(g-u),me=1-K;for(let ge=0;ge!==G;++ge)E[ge]=I[J+ge]*me+I[Z+ge]*K;return E}}),za.prototype=Object.assign(Object.create(Ta.prototype),{constructor:za,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(as,{toJSON:function(t){const u=t.constructor;let m;if(void 0!==u.toJSON)m=u.toJSON(t);else{m={name:t.name,times:ao.convertArray(t.times,Array),values:ao.convertArray(t.values,Array)};const g=t.getInterpolation();g!==t.DefaultInterpolation&&(m.interpolation=g)}return m.type=t.ValueTypeName,m}}),Object.assign(as.prototype,{constructor:as,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Zl,InterpolantFactoryMethodDiscrete:function(t){return new za(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new uu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new xl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let u;switch(t){case Jl:u=this.InterpolantFactoryMethodDiscrete;break;case Zl:u=this.InterpolantFactoryMethodLinear;break;case Ku:u=this.InterpolantFactoryMethodSmooth}if(void 0===u){const m="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(m);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",m),this}return this.createInterpolant=u,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jl;case this.InterpolantFactoryMethodLinear:return Zl;case this.InterpolantFactoryMethodSmooth:return Ku}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]+=t}return this},scale:function(t){if(1!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]*=t}return this},trim:function(t,u){const m=this.times,g=m.length;let E=0,I=g-1;for(;E!==g&&m[E]<t;)++E;for(;-1!==I&&m[I]>u;)--I;if(++I,0!==E||I!==g){E>=I&&(I=Math.max(I,1),E=I-1);const G=this.getValueSize();this.times=ao.arraySlice(m,E,I),this.values=ao.arraySlice(this.values,E*G,I*G)}return this},validate:function(){let t=!0;const u=this.getValueSize();u-Math.floor(u)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const m=this.times,g=this.values,E=m.length;0===E&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let I=null;for(let G=0;G!==E;G++){const Z=m[G];if("number"==typeof Z&&isNaN(Z)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,G,Z),t=!1;break}if(null!==I&&I>Z){console.error("THREE.KeyframeTrack: Out of order keys.",this,G,Z,I),t=!1;break}I=Z}if(void 0!==g&&ao.isTypedArray(g))for(let G=0,Z=g.length;G!==Z;++G){const J=g[G];if(isNaN(J)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,G,J),t=!1;break}}return t},optimize:function(){const t=ao.arraySlice(this.times),u=ao.arraySlice(this.values),m=this.getValueSize(),g=this.getInterpolation()===Ku,E=t.length-1;let I=1;for(let G=1;G<E;++G){let Z=!1;const J=t[G];if(J!==t[G+1]&&(1!==G||J!==J[0]))if(g)Z=!0;else{const K=G*m,me=K-m,ge=K+m;for(let Se=0;Se!==m;++Se){const w=u[K+Se];if(w!==u[me+Se]||w!==u[ge+Se]){Z=!0;break}}}if(Z){if(G!==I){t[I]=t[G];const K=G*m,me=I*m;for(let ge=0;ge!==m;++ge)u[me+ge]=u[K+ge]}++I}}if(E>0){t[I]=t[E];for(let G=E*m,Z=I*m,J=0;J!==m;++J)u[Z+J]=u[G+J];++I}return I!==t.length?(this.times=ao.arraySlice(t,0,I),this.values=ao.arraySlice(u,0,I*m)):(this.times=t,this.values=u),this},clone:function(){const t=ao.arraySlice(this.times,0),u=ao.arraySlice(this.values,0),m=new this.constructor(this.name,t,u);return m.createInterpolant=this.createInterpolant,m}}),Kp.prototype=Object.assign(Object.create(as.prototype),{constructor:Kp,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Jl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),wl.prototype=Object.assign(Object.create(as.prototype),{constructor:wl,ValueTypeName:"color"}),Gl.prototype=Object.assign(Object.create(as.prototype),{constructor:Gl,ValueTypeName:"number"}),Uu.prototype=Object.assign(Object.create(Ta.prototype),{constructor:Uu,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,G=this.valueSize,Z=(m-u)/(g-u);let J=t*G;for(let K=J+G;J!==K;J+=4)yo.slerpFlat(E,0,I,J-G,I,J,Z);return E}}),po.prototype=Object.assign(Object.create(as.prototype),{constructor:po,ValueTypeName:"quaternion",DefaultInterpolation:Zl,InterpolantFactoryMethodLinear:function(t){return new Uu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),dh.prototype=Object.assign(Object.create(as.prototype),{constructor:dh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Jl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),hu.prototype=Object.assign(Object.create(as.prototype),{constructor:hu,ValueTypeName:"vector"}),Object.assign(ls,{parse:function(t){const u=[],m=t.tracks,g=1/(t.fps||1);for(let E=0,I=m.length;E!==I;++E)u.push(Hi(m[E]).scale(g));return new ls(t.name,t.duration,u,t.blendMode)},toJSON:function(t){const u=[],m=t.tracks,g={name:t.name,duration:t.duration,tracks:u,uuid:t.uuid,blendMode:t.blendMode};for(let E=0,I=m.length;E!==I;++E)u.push(as.toJSON(m[E]));return g},CreateFromMorphTargetSequence:function(t,u,m,g){const E=u.length,I=[];for(let G=0;G<E;G++){let Z=[],J=[];Z.push((G+E-1)%E,G,(G+1)%E),J.push(0,1,0);const K=ao.getKeyframeOrder(Z);Z=ao.sortedArray(Z,1,K),J=ao.sortedArray(J,1,K),g||0!==Z[0]||(Z.push(E),J.push(J[0])),I.push(new Gl(".morphTargetInfluences["+u[G].name+"]",Z,J).scale(1/m))}return new ls(t,-1,I)},findByName:function(t,u){let m=t;Array.isArray(t)||(m=t.geometry&&t.geometry.animations||t.animations);for(let g=0;g<m.length;g++)if(m[g].name===u)return m[g];return null},CreateClipsFromMorphTargetSequences:function(t,u,m){const g={},E=/^([\w-]*?)([\d]+)$/;for(let G=0,Z=t.length;G<Z;G++){const J=t[G],K=J.name.match(E);if(K&&K.length>1){const me=K[1];let ge=g[me];ge||(g[me]=ge=[]),ge.push(J)}}const I=[];for(const G in g)I.push(ls.CreateFromMorphTargetSequence(G,g[G],u,m));return I},parseAnimation:function(t,u){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const m=function(K,me,ge,Se,w){if(0!==ge.length){const e=[],c=[];ao.flattenJSON(ge,e,c,Se),0!==e.length&&w.push(new K(me,e,c))}},g=[],E=t.name||"default",I=t.fps||30,G=t.blendMode;let Z=t.length||-1;const J=t.hierarchy||[];for(let K=0;K<J.length;K++){const me=J[K].keys;if(me&&0!==me.length)if(me[0].morphTargets){const ge={};let Se;for(Se=0;Se<me.length;Se++)if(me[Se].morphTargets)for(let w=0;w<me[Se].morphTargets.length;w++)ge[me[Se].morphTargets[w]]=-1;for(const w in ge){const e=[],c=[];for(let d=0;d!==me[Se].morphTargets.length;++d){const _=me[Se];e.push(_.time),c.push(_.morphTarget===w?1:0)}g.push(new Gl(".morphTargetInfluence["+w+"]",e,c))}Z=ge.length*(I||1)}else{const ge=".bones["+u[K].name+"]";m(hu,ge+".position",me,"pos",g),m(po,ge+".quaternion",me,"rot",g),m(hu,ge+".scale",me,"scl",g)}}return 0===g.length?null:new ls(E,Z,g,G)}}),Object.assign(ls.prototype,{resetDuration:function(){let t=0;for(let u=0,m=this.tracks.length;u!==m;++u){const g=this.tracks[u];t=Math.max(t,g.times[g.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let u=0;u<this.tracks.length;u++)t=t&&this.tracks[u].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let u=0;u<this.tracks.length;u++)t.push(this.tracks[u].clone());return new ls(this.name,this.duration,t,this.blendMode)}});const Ss={enabled:!1,files:{},add:function(t,u){!1!==this.enabled&&(this.files[t]=u)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Xd(t,u,m){const g=this;let E,I=!1,G=0,Z=0;const J=[];this.onStart=void 0,this.onLoad=t,this.onProgress=u,this.onError=m,this.itemStart=function(K){Z++,!1===I&&void 0!==g.onStart&&g.onStart(K,G,Z),I=!0},this.itemEnd=function(K){G++,void 0!==g.onProgress&&g.onProgress(K,G,Z),G===Z&&(I=!1,void 0!==g.onLoad&&g.onLoad())},this.itemError=function(K){void 0!==g.onError&&g.onError(K)},this.resolveURL=function(K){return E?E(K):K},this.setURLModifier=function(K){return E=K,this},this.addHandler=function(K,me){return J.push(K,me),this},this.removeHandler=function(K){const me=J.indexOf(K);return-1!==me&&J.splice(me,2),this},this.getHandler=function(K){for(let me=0,ge=J.length;me<ge;me+=2){const Se=J[me],w=J[me+1];if(Se.global&&(Se.lastIndex=0),Se.test(K))return w}return null}}const Yd=new Xd;function Ti(t){this.manager=void 0!==t?t:Yd,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ti.prototype,{load:function(){},loadAsync:function(t,u){const m=this;return new Promise(function(g,E){m.load(t,g,u,E)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const dc={};function Es(t){Ti.call(this,t)}function ed(t){Ti.call(this,t)}function td(t){Ti.call(this,t)}function ja(t){Ti.call(this,t)}function pu(t){Ti.call(this,t)}function sp(t){Ti.call(this,t)}function vi(t){Ti.call(this,t)}function xr(){this.type="Curve",this.arcLengthDivisions=200}function a(t,u,m,g,E,I,G,Z){xr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=u||0,this.xRadius=m||1,this.yRadius=g||1,this.aStartAngle=E||0,this.aEndAngle=I||2*Math.PI,this.aClockwise=G||!1,this.aRotation=Z||0}function r(t,u,m,g,E,I){a.call(this,t,u,m,m,g,E,I),this.type="ArcCurve"}function h(){let t=0,u=0,m=0,g=0;function E(I,G,Z,J){t=I,u=Z,m=-3*I+3*G-2*Z-J,g=2*I-2*G+Z+J}return{initCatmullRom:function(I,G,Z,J,K){E(G,Z,K*(Z-I),K*(J-G))},initNonuniformCatmullRom:function(I,G,Z,J,K,me,ge){let Se=(G-I)/K-(Z-I)/(K+me)+(Z-G)/me,w=(Z-G)/me-(J-G)/(me+ge)+(J-Z)/ge;Se*=me,w*=me,E(G,Z,Se,w)},calc:function(I){const G=I*I;return t+u*I+m*G+g*(G*I)}}}Es.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Es,load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ss.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;if(void 0!==dc[t])return void dc[t].push({onLoad:u,onProgress:m,onError:g});const G=t.match(/^data:(.*?)(;base64)?,(.*)$/);let Z;if(G){const J=G[1],K=!!G[2];let me=G[3];me=decodeURIComponent(me),K&&(me=atob(me));try{let ge;const Se=(this.responseType||"").toLowerCase();switch(Se){case"arraybuffer":case"blob":const w=new Uint8Array(me.length);for(let c=0;c<me.length;c++)w[c]=me.charCodeAt(c);ge="blob"===Se?new Blob([w.buffer],{type:J}):w.buffer;break;case"document":ge=(new DOMParser).parseFromString(me,J);break;case"json":ge=JSON.parse(me);break;default:ge=me}setTimeout(function(){u&&u(ge),E.manager.itemEnd(t)},0)}catch(ge){setTimeout(function(){g&&g(ge),E.manager.itemError(t),E.manager.itemEnd(t)},0)}}else{dc[t]=[],dc[t].push({onLoad:u,onProgress:m,onError:g}),Z=new XMLHttpRequest,Z.open("GET",t,!0),Z.addEventListener("load",function(J){const K=this.response,me=dc[t];if(delete dc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ss.add(t,K);for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge];w.onLoad&&w.onLoad(K)}E.manager.itemEnd(t)}else{for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge];w.onError&&w.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)}},!1),Z.addEventListener("progress",function(J){const K=dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onProgress&&Se.onProgress(J)}},!1),Z.addEventListener("error",function(J){const K=dc[t];delete dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onError&&Se.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),Z.addEventListener("abort",function(J){const K=dc[t];delete dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onError&&Se.onError(J)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),void 0!==this.responseType&&(Z.responseType=this.responseType),void 0!==this.withCredentials&&(Z.withCredentials=this.withCredentials),Z.overrideMimeType&&Z.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const J in this.requestHeader)Z.setRequestHeader(J,this.requestHeader[J]);Z.send(null)}return E.manager.itemStart(t),Z},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),ed.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ed,load:function(t,u,m,g){const E=this,I=new Es(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(G){try{u(E.parse(JSON.parse(G)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u=[];for(let m=0;m<t.length;m++){const g=ls.parse(t[m]);u.push(g)}return u}}),td.prototype=Object.assign(Object.create(Ti.prototype),{constructor:td,load:function(t,u,m,g){const E=this,I=[],G=new uc;G.image=I;const Z=new Es(this.manager);Z.setPath(this.path),Z.setResponseType("arraybuffer"),Z.setRequestHeader(this.requestHeader);let J=0;function K(me){Z.load(t[me],function(ge){const Se=E.parse(ge,!0);I[me]={width:Se.width,height:Se.height,format:Se.format,mipmaps:Se.mipmaps},J+=1,6===J&&(1===Se.mipmapCount&&(G.minFilter=ai),G.format=Se.format,G.needsUpdate=!0,u&&u(G))},m,g)}if(Array.isArray(t))for(let me=0,ge=t.length;me<ge;++me)K(me);else Z.load(t,function(me){const ge=E.parse(me,!0);if(ge.isCubemap){const Se=ge.mipmaps.length/ge.mipmapCount;for(let w=0;w<Se;w++){I[w]={mipmaps:[]};for(let e=0;e<ge.mipmapCount;e++)I[w].mipmaps.push(ge.mipmaps[w*ge.mipmapCount+e]),I[w].format=ge.format,I[w].width=ge.width,I[w].height=ge.height}}else G.image.width=ge.width,G.image.height=ge.height,G.mipmaps=ge.mipmaps;1===ge.mipmapCount&&(G.minFilter=ai),G.format=ge.format,G.needsUpdate=!0,u&&u(G)},m,g);return G}}),ja.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ja,load:function(t,u,m,g){const E=this,I=new gl,G=new Es(this.manager);return G.setResponseType("arraybuffer"),G.setRequestHeader(this.requestHeader),G.setPath(this.path),G.load(t,function(Z){const J=E.parse(Z);J&&(void 0!==J.image?I.image=J.image:void 0!==J.data&&(I.image.width=J.width,I.image.height=J.height,I.image.data=J.data),I.wrapS=void 0!==J.wrapS?J.wrapS:Jr,I.wrapT=void 0!==J.wrapT?J.wrapT:Jr,I.magFilter=void 0!==J.magFilter?J.magFilter:ai,I.minFilter=void 0!==J.minFilter?J.minFilter:ai,I.anisotropy=void 0!==J.anisotropy?J.anisotropy:1,void 0!==J.format&&(I.format=J.format),void 0!==J.type&&(I.type=J.type),void 0!==J.mipmaps&&(I.mipmaps=J.mipmaps,I.minFilter=sl),1===J.mipmapCount&&(I.minFilter=ai),I.needsUpdate=!0,u&&u(I,J))},m,g),I}}),pu.prototype=Object.assign(Object.create(Ti.prototype),{constructor:pu,load:function(t,u,m,g){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ss.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;const G=document.createElementNS("http://www.w3.org/1999/xhtml","img");function Z(){G.removeEventListener("load",Z,!1),G.removeEventListener("error",J,!1),Ss.add(t,this),u&&u(this),E.manager.itemEnd(t)}function J(K){G.removeEventListener("load",Z,!1),G.removeEventListener("error",J,!1),g&&g(K),E.manager.itemError(t),E.manager.itemEnd(t)}return G.addEventListener("load",Z,!1),G.addEventListener("error",J,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(G.crossOrigin=this.crossOrigin),E.manager.itemStart(t),G.src=t,G}}),sp.prototype=Object.assign(Object.create(Ti.prototype),{constructor:sp,load:function(t,u,m,g){const E=new ea,I=new pu(this.manager);I.setCrossOrigin(this.crossOrigin),I.setPath(this.path);let G=0;function Z(J){I.load(t[J],function(K){E.images[J]=K,G++,6===G&&(E.needsUpdate=!0,u&&u(E))},void 0,g)}for(let J=0;J<t.length;++J)Z(J);return E}}),vi.prototype=Object.assign(Object.create(Ti.prototype),{constructor:vi,load:function(t,u,m,g){const E=new di,I=new pu(this.manager);return I.setCrossOrigin(this.crossOrigin),I.setPath(this.path),I.load(t,function(G){E.image=G;const Z=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);E.format=Z?Fs:lo,E.needsUpdate=!0,void 0!==u&&u(E)},m,g),E}}),Object.assign(xr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,u){const m=this.getUtoTmapping(t);return this.getPoint(m,u)},getPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return u},getSpacedPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPointAt(m/t));return u},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const u=[];let m,g=this.getPoint(0),E=0;u.push(0);for(let I=1;I<=t;I++)m=this.getPoint(I/t),E+=m.distanceTo(g),u.push(E),g=m;return this.cacheArcLengths=u,u},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,u){const m=this.getLengths();let g,E=0,I=m.length;g=u||t*m[I-1];let G,Z=0,J=I-1;for(;Z<=J;)if(E=Math.floor(Z+(J-Z)/2),G=m[E]-g,G<0)Z=E+1;else{if(!(G>0)){J=E;break}J=E-1}if(E=J,m[E]===g)return E/(I-1);const K=m[E];return(E+(g-K)/(m[E+1]-K))/(I-1)},getTangent:function(t,u){let g=t-1e-4,E=t+1e-4;g<0&&(g=0),E>1&&(E=1);const I=this.getPoint(g),G=this.getPoint(E),Z=u||(I.isVector2?new wn:new lt);return Z.copy(G).sub(I).normalize(),Z},getTangentAt:function(t,u){const m=this.getUtoTmapping(t);return this.getTangent(m,u)},computeFrenetFrames:function(t,u){const m=new lt,g=[],E=[],I=[],G=new lt,Z=new ri;for(let Se=0;Se<=t;Se++)g[Se]=this.getTangentAt(Se/t,new lt),g[Se].normalize();E[0]=new lt,I[0]=new lt;let J=Number.MAX_VALUE;const K=Math.abs(g[0].x),me=Math.abs(g[0].y),ge=Math.abs(g[0].z);K<=J&&(J=K,m.set(1,0,0)),me<=J&&(J=me,m.set(0,1,0)),ge<=J&&m.set(0,0,1),G.crossVectors(g[0],m).normalize(),E[0].crossVectors(g[0],G),I[0].crossVectors(g[0],E[0]);for(let Se=1;Se<=t;Se++){if(E[Se]=E[Se-1].clone(),I[Se]=I[Se-1].clone(),G.crossVectors(g[Se-1],g[Se]),G.length()>Number.EPSILON){G.normalize();const w=Math.acos(tr.clamp(g[Se-1].dot(g[Se]),-1,1));E[Se].applyMatrix4(Z.makeRotationAxis(G,w))}I[Se].crossVectors(g[Se],E[Se])}if(!0===u){let Se=Math.acos(tr.clamp(E[0].dot(E[t]),-1,1));Se/=t,g[0].dot(G.crossVectors(E[0],E[t]))>0&&(Se=-Se);for(let w=1;w<=t;w++)E[w].applyMatrix4(Z.makeRotationAxis(g[w],Se*w)),I[w].crossVectors(g[w],E[w])}return{tangents:g,normals:E,binormals:I}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(a.prototype=Object.create(xr.prototype)).constructor=a,a.prototype.isEllipseCurve=!0,a.prototype.getPoint=function(t,u){const m=u||new wn,g=2*Math.PI;let E=this.aEndAngle-this.aStartAngle;const I=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=g;for(;E>g;)E-=g;E<Number.EPSILON&&(E=I?0:g),!0!==this.aClockwise||I||(E===g?E=-g:E-=g);const G=this.aStartAngle+t*E;let Z=this.aX+this.xRadius*Math.cos(G),J=this.aY+this.yRadius*Math.sin(G);if(0!==this.aRotation){const K=Math.cos(this.aRotation),me=Math.sin(this.aRotation),ge=Z-this.aX,Se=J-this.aY;Z=ge*K-Se*me+this.aX,J=ge*me+Se*K+this.aY}return m.set(Z,J)},a.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},a.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},a.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(r.prototype=Object.create(a.prototype)).constructor=r,r.prototype.isArcCurve=!0;const p=new lt,y=new h,b=new h,R=new h;function O(t,u,m,g){xr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=u||!1,this.curveType=m||"centripetal",this.tension=void 0!==g?g:.5}function T(t,u,m,g,E){const I=.5*(g-u),G=.5*(E-m),Z=t*t;return(2*m-2*g+I+G)*(t*Z)+(-3*m+3*g-2*I-G)*Z+I*t+m}function U(t,u,m,g){return function(E,I){const G=1-E;return G*G*I}(t,u)+2*(1-(E=t))*E*m+function(E,I){return E*E*I}(t,g);var E}function ee(t,u,m,g,E){return function(I,G){const Z=1-I;return Z*Z*Z*G}(t,u)+function(I,G){const Z=1-I;return 3*Z*Z*I*G}(t,m)+3*(1-(I=t))*I*I*g+function(I,G){return I*I*I*G}(t,E);var I}function ie(t,u,m,g){xr.call(this),this.type="CubicBezierCurve",this.v0=t||new wn,this.v1=u||new wn,this.v2=m||new wn,this.v3=g||new wn}function ne(t,u,m,g){xr.call(this),this.type="CubicBezierCurve3",this.v0=t||new lt,this.v1=u||new lt,this.v2=m||new lt,this.v3=g||new lt}function ve(t,u){xr.call(this),this.type="LineCurve",this.v1=t||new wn,this.v2=u||new wn}function be(t,u){xr.call(this),this.type="LineCurve3",this.v1=t||new lt,this.v2=u||new lt}function Te(t,u,m){xr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new wn,this.v1=u||new wn,this.v2=m||new wn}function Le(t,u,m){xr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new lt,this.v1=u||new lt,this.v2=m||new lt}function Ie(t){xr.call(this),this.type="SplineCurve",this.points=t||[]}(O.prototype=Object.create(xr.prototype)).constructor=O,O.prototype.isCatmullRomCurve3=!0,O.prototype.getPoint=function(t,u){const m=u||new lt,g=this.points,E=g.length,I=(E-(this.closed?0:1))*t;let G,Z,J,K,me=Math.floor(I),ge=I-me;if(this.closed?me+=me>0?0:(Math.floor(Math.abs(me)/E)+1)*E:0===ge&&me===E-1&&(me=E-2,ge=1),this.closed||me>0?G=g[(me-1)%E]:(p.subVectors(g[0],g[1]).add(g[0]),G=p),Z=g[me%E],J=g[(me+1)%E],this.closed||me+2<E?K=g[(me+2)%E]:(p.subVectors(g[E-1],g[E-2]).add(g[E-1]),K=p),"centripetal"===this.curveType||"chordal"===this.curveType){const Se="chordal"===this.curveType?.5:.25;let w=Math.pow(G.distanceToSquared(Z),Se),e=Math.pow(Z.distanceToSquared(J),Se),c=Math.pow(J.distanceToSquared(K),Se);e<1e-4&&(e=1),w<1e-4&&(w=e),c<1e-4&&(c=e),y.initNonuniformCatmullRom(G.x,Z.x,J.x,K.x,w,e,c),b.initNonuniformCatmullRom(G.y,Z.y,J.y,K.y,w,e,c),R.initNonuniformCatmullRom(G.z,Z.z,J.z,K.z,w,e,c)}else"catmullrom"===this.curveType&&(y.initCatmullRom(G.x,Z.x,J.x,K.x,this.tension),b.initCatmullRom(G.y,Z.y,J.y,K.y,this.tension),R.initCatmullRom(G.z,Z.z,J.z,K.z,this.tension));return m.set(y.calc(ge),b.calc(ge),R.calc(ge)),m},O.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},O.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},O.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new lt).fromArray(g))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(ie.prototype=Object.create(xr.prototype)).constructor=ie,ie.prototype.isCubicBezierCurve=!0,ie.prototype.getPoint=function(t,u){const m=u||new wn,g=this.v0,E=this.v1,I=this.v2,G=this.v3;return m.set(ee(t,g.x,E.x,I.x,G.x),ee(t,g.y,E.y,I.y,G.y)),m},ie.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ie.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ie.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ne.prototype=Object.create(xr.prototype)).constructor=ne,ne.prototype.isCubicBezierCurve3=!0,ne.prototype.getPoint=function(t,u){const m=u||new lt,g=this.v0,E=this.v1,I=this.v2,G=this.v3;return m.set(ee(t,g.x,E.x,I.x,G.x),ee(t,g.y,E.y,I.y,G.y),ee(t,g.z,E.z,I.z,G.z)),m},ne.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ne.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ne.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ve.prototype=Object.create(xr.prototype)).constructor=ve,ve.prototype.isLineCurve=!0,ve.prototype.getPoint=function(t,u){const m=u||new wn;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},ve.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},ve.prototype.getTangent=function(t,u){const m=u||new wn;return m.copy(this.v2).sub(this.v1).normalize(),m},ve.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ve.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ve.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(be.prototype=Object.create(xr.prototype)).constructor=be,be.prototype.isLineCurve3=!0,be.prototype.getPoint=function(t,u){const m=u||new lt;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},be.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},be.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},be.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},be.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Te.prototype=Object.create(xr.prototype)).constructor=Te,Te.prototype.isQuadraticBezierCurve=!0,Te.prototype.getPoint=function(t,u){const m=u||new wn,g=this.v0,E=this.v1,I=this.v2;return m.set(U(t,g.x,E.x,I.x),U(t,g.y,E.y,I.y)),m},Te.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Te.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Te.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Le.prototype=Object.create(xr.prototype)).constructor=Le,Le.prototype.isQuadraticBezierCurve3=!0,Le.prototype.getPoint=function(t,u){const m=u||new lt,g=this.v0,E=this.v1,I=this.v2;return m.set(U(t,g.x,E.x,I.x),U(t,g.y,E.y,I.y),U(t,g.z,E.z,I.z)),m},Le.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Le.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Le.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Ie.prototype=Object.create(xr.prototype)).constructor=Ie,Ie.prototype.isSplineCurve=!0,Ie.prototype.getPoint=function(t,u){const m=u||new wn,g=this.points,E=(g.length-1)*t,I=Math.floor(E),G=E-I,Z=g[0===I?I:I-1],J=g[I],K=g[I>g.length-2?g.length-1:I+1],me=g[I>g.length-3?g.length-1:I+2];return m.set(T(G,Z.x,J.x,K.x,me.x),T(G,Z.y,J.y,K.y,me.y)),m},Ie.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this},Ie.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t},Ie.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new wn).fromArray(g))}return this};var Oe=Object.freeze({__proto__:null,ArcCurve:r,CatmullRomCurve3:O,CubicBezierCurve:ie,CubicBezierCurve3:ne,EllipseCurve:a,LineCurve:ve,LineCurve3:be,QuadraticBezierCurve:Te,QuadraticBezierCurve3:Le,SplineCurve:Ie});function Fe(){xr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function je(t){Fe.call(this),this.type="Path",this.currentPoint=new wn,t&&this.setFromPoints(t)}function Ue(t){je.call(this,t),this.uuid=tr.generateUUID(),this.type="Shape",this.holes=[]}function Je(t,u){Kn.call(this),this.type="Light",this.color=new ar(t),this.intensity=void 0!==u?u:1,this.receiveShadow=void 0}function pt(t,u,m){Je.call(this,t,m),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.groundColor=new ar(u)}function at(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new wn(512,512),this.map=null,this.mapPass=null,this.matrix=new ri,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new eu,this._frameExtents=new wn(1,1),this._viewportCount=1,this._viewports=[new xi(0,0,1,1)]}function Mt(){at.call(this,new Rs(50,1,.5,500))}function Tt(t,u,m,g,E,I){Je.call(this,t,u),this.type="SpotLight",this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.target=new Kn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(G){this.intensity=G/Math.PI}}),this.distance=void 0!==m?m:0,this.angle=void 0!==g?g:Math.PI/3,this.penumbra=void 0!==E?E:0,this.decay=void 0!==I?I:1,this.shadow=new Mt}function Yt(){at.call(this,new Rs(90,1,.5,500)),this._frameExtents=new wn(4,2),this._viewportCount=6,this._viewports=[new xi(2,1,1,1),new xi(0,1,1,1),new xi(3,1,1,1),new xi(1,1,1,1),new xi(3,0,1,1),new xi(1,0,1,1)],this._cubeDirections=[new lt(1,0,0),new lt(-1,0,0),new lt(0,0,1),new lt(0,0,-1),new lt(0,1,0),new lt(0,-1,0)],this._cubeUps=[new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,0,1),new lt(0,0,-1)]}function jt(t,u,m,g){Je.call(this,t,u),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(E){this.intensity=E/(4*Math.PI)}}),this.distance=void 0!==m?m:0,this.decay=void 0!==g?g:1,this.shadow=new Yt}function It(t,u,m,g,E,I){Ai.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==u?u:1,this.top=void 0!==m?m:1,this.bottom=void 0!==g?g:-1,this.near=void 0!==E?E:.1,this.far=void 0!==I?I:2e3,this.updateProjectionMatrix()}function Nt(){at.call(this,new It(-5,5,5,-5,.5,500))}function ft(t,u){Je.call(this,t,u),this.type="DirectionalLight",this.position.copy(Kn.DefaultUp),this.updateMatrix(),this.target=new Kn,this.shadow=new Nt}function $t(t,u){Je.call(this,t,u),this.type="AmbientLight",this.castShadow=void 0}function Zt(t,u,m,g){Je.call(this,t,u),this.type="RectAreaLight",this.width=void 0!==m?m:10,this.height=void 0!==g?g:10}function Tn(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new lt)}function $n(t,u){Je.call(this,void 0,u),this.type="LightProbe",this.sh=void 0!==t?t:new Tn}function Qn(t){Ti.call(this,t),this.textures={}}Fe.prototype=Object.assign(Object.create(xr.prototype),{constructor:Fe,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);t.equals(u)||this.curves.push(new ve(u,t))},getPoint:function(t){const u=t*this.getLength(),m=this.getCurveLengths();let g=0;for(;g<m.length;){if(m[g]>=u){const E=m[g]-u,I=this.curves[g],G=I.getLength();return I.getPointAt(0===G?0:1-E/G)}g++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let u=0;for(let m=0,g=this.curves.length;m<g;m++)u+=this.curves[m].getLength(),t.push(u);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return this.autoClose&&u.push(u[0]),u},getPoints:function(t){t=t||12;const u=[];let m;for(let g=0,E=this.curves;g<E.length;g++){const I=E[g],Z=I.getPoints(I&&I.isEllipseCurve?2*t:I&&(I.isLineCurve||I.isLineCurve3)?1:I&&I.isSplineCurve?t*I.points.length:t);for(let J=0;J<Z.length;J++){const K=Z[J];m&&m.equals(K)||(u.push(K),m=K)}}return this.autoClose&&u.length>1&&!u[u.length-1].equals(u[0])&&u.push(u[0]),u},copy:function(t){xr.prototype.copy.call(this,t),this.curves=[];for(let u=0,m=t.curves.length;u<m;u++)this.curves.push(t.curves[u].clone());return this.autoClose=t.autoClose,this},toJSON:function(){const t=xr.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let u=0,m=this.curves.length;u<m;u++)t.curves.push(this.curves[u].toJSON());return t},fromJSON:function(t){xr.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let u=0,m=t.curves.length;u<m;u++){const g=t.curves[u];this.curves.push((new Oe[g.type]).fromJSON(g))}return this}}),je.prototype=Object.assign(Object.create(Fe.prototype),{constructor:je,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let u=1,m=t.length;u<m;u++)this.lineTo(t[u].x,t[u].y);return this},moveTo:function(t,u){return this.currentPoint.set(t,u),this},lineTo:function(t,u){const m=new ve(this.currentPoint.clone(),new wn(t,u));return this.curves.push(m),this.currentPoint.set(t,u),this},quadraticCurveTo:function(t,u,m,g){const E=new Te(this.currentPoint.clone(),new wn(t,u),new wn(m,g));return this.curves.push(E),this.currentPoint.set(m,g),this},bezierCurveTo:function(t,u,m,g,E,I){const G=new ie(this.currentPoint.clone(),new wn(t,u),new wn(m,g),new wn(E,I));return this.curves.push(G),this.currentPoint.set(E,I),this},splineThru:function(t){const u=new Ie([this.currentPoint.clone()].concat(t));return this.curves.push(u),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,u,m,g,E,I){return this.absarc(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I),this},absarc:function(t,u,m,g,E,I){return this.absellipse(t,u,m,m,g,E,I),this},ellipse:function(t,u,m,g,E,I,G,Z){return this.absellipse(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I,G,Z),this},absellipse:function(t,u,m,g,E,I,G,Z){const J=new a(t,u,m,g,E,I,G,Z);if(this.curves.length>0){const me=J.getPoint(0);me.equals(this.currentPoint)||this.lineTo(me.x,me.y)}this.curves.push(J);const K=J.getPoint(1);return this.currentPoint.copy(K),this},copy:function(t){return Fe.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Fe.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Fe.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Ue.prototype=Object.assign(Object.create(je.prototype),{constructor:Ue,getPointsHoles:function(t){const u=[];for(let m=0,g=this.holes.length;m<g;m++)u[m]=this.holes[m].getPoints(t);return u},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){je.prototype.copy.call(this,t),this.holes=[];for(let u=0,m=t.holes.length;u<m;u++)this.holes.push(t.holes[u].clone());return this},toJSON:function(){const t=je.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let u=0,m=this.holes.length;u<m;u++)t.holes.push(this.holes[u].toJSON());return t},fromJSON:function(t){je.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let u=0,m=t.holes.length;u<m;u++){const g=t.holes[u];this.holes.push((new je).fromJSON(g))}return this}}),Je.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Je,isLight:!0,copy:function(t){return Kn.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const u=Kn.prototype.toJSON.call(this,t);return u.object.color=this.color.getHex(),u.object.intensity=this.intensity,void 0!==this.groundColor&&(u.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(u.object.distance=this.distance),void 0!==this.angle&&(u.object.angle=this.angle),void 0!==this.decay&&(u.object.decay=this.decay),void 0!==this.penumbra&&(u.object.penumbra=this.penumbra),void 0!==this.shadow&&(u.object.shadow=this.shadow.toJSON()),u}}),pt.prototype=Object.assign(Object.create(Je.prototype),{constructor:pt,isHemisphereLight:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(at.prototype,{_projScreenMatrix:new ri,_lightPositionWorld:new lt,_lookTarget:new lt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const u=this.camera,m=this.matrix,g=this._projScreenMatrix,E=this._lookTarget,I=this._lightPositionWorld;I.setFromMatrixPosition(t.matrixWorld),u.position.copy(I),E.setFromMatrixPosition(t.target.matrixWorld),u.lookAt(E),u.updateMatrixWorld(),g.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(u.projectionMatrix),m.multiply(u.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Mt.prototype=Object.assign(Object.create(at.prototype),{constructor:Mt,isSpotLightShadow:!0,updateMatrices:function(t){const u=this.camera,m=2*tr.RAD2DEG*t.angle,g=this.mapSize.width/this.mapSize.height,E=t.distance||u.far;m===u.fov&&g===u.aspect&&E===u.far||(u.fov=m,u.aspect=g,u.far=E,u.updateProjectionMatrix()),at.prototype.updateMatrices.call(this,t)}}),Tt.prototype=Object.assign(Object.create(Je.prototype),{constructor:Tt,isSpotLight:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Yt.prototype=Object.assign(Object.create(at.prototype),{constructor:Yt,isPointLightShadow:!0,updateMatrices:function(t,u){void 0===u&&(u=0);const m=this.camera,g=this.matrix,E=this._lightPositionWorld,I=this._lookTarget,G=this._projScreenMatrix;E.setFromMatrixPosition(t.matrixWorld),m.position.copy(E),I.copy(m.position),I.add(this._cubeDirections[u]),m.up.copy(this._cubeUps[u]),m.lookAt(I),m.updateMatrixWorld(),g.makeTranslation(-E.x,-E.y,-E.z),G.multiplyMatrices(m.projectionMatrix,m.matrixWorldInverse),this._frustum.setFromProjectionMatrix(G)}}),jt.prototype=Object.assign(Object.create(Je.prototype),{constructor:jt,isPointLight:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),It.prototype=Object.assign(Object.create(Ai.prototype),{constructor:It,isOrthographicCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,u,m,g,E,I){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),m=(this.right+this.left)/2,g=(this.top+this.bottom)/2;let E=m-t,I=m+t,G=g+u,Z=g-u;if(null!==this.view&&this.view.enabled){const J=(this.right-this.left)/this.view.fullWidth/this.zoom,K=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=J*this.view.offsetX,I=E+J*this.view.width,G-=K*this.view.offsetY,Z=G-K*this.view.height}this.projectionMatrix.makeOrthographic(E,I,G,Z,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Kn.prototype.toJSON.call(this,t);return u.object.zoom=this.zoom,u.object.left=this.left,u.object.right=this.right,u.object.top=this.top,u.object.bottom=this.bottom,u.object.near=this.near,u.object.far=this.far,null!==this.view&&(u.object.view=Object.assign({},this.view)),u}}),Nt.prototype=Object.assign(Object.create(at.prototype),{constructor:Nt,isDirectionalLightShadow:!0,updateMatrices:function(t){at.prototype.updateMatrices.call(this,t)}}),ft.prototype=Object.assign(Object.create(Je.prototype),{constructor:ft,isDirectionalLight:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),$t.prototype=Object.assign(Object.create(Je.prototype),{constructor:$t,isAmbientLight:!0}),Zt.prototype=Object.assign(Object.create(Je.prototype),{constructor:Zt,isRectAreaLight:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const u=Je.prototype.toJSON.call(this,t);return u.object.width=this.width,u.object.height=this.height,u}}),Object.assign(Tn.prototype,{isSphericalHarmonics3:!0,set:function(t){for(let u=0;u<9;u++)this.coefficients[u].copy(t[u]);return this},zero:function(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.282095),u.addScaledVector(I[1],.488603*g),u.addScaledVector(I[2],.488603*E),u.addScaledVector(I[3],.488603*m),u.addScaledVector(I[4],m*g*1.092548),u.addScaledVector(I[5],g*E*1.092548),u.addScaledVector(I[6],.315392*(3*E*E-1)),u.addScaledVector(I[7],m*E*1.092548),u.addScaledVector(I[8],.546274*(m*m-g*g)),u},getIrradianceAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.886227),u.addScaledVector(I[1],1.023328*g),u.addScaledVector(I[2],1.023328*E),u.addScaledVector(I[3],1.023328*m),u.addScaledVector(I[4],.858086*m*g),u.addScaledVector(I[5],.858086*g*E),u.addScaledVector(I[6],.743125*E*E-.247708),u.addScaledVector(I[7],.858086*m*E),u.addScaledVector(I[8],.429043*(m*m-g*g)),u},add:function(t){for(let u=0;u<9;u++)this.coefficients[u].add(t.coefficients[u]);return this},addScaledSH:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].addScaledVector(t.coefficients[m],u);return this},scale:function(t){for(let u=0;u<9;u++)this.coefficients[u].multiplyScalar(t);return this},lerp:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].lerp(t.coefficients[m],u);return this},equals:function(t){for(let u=0;u<9;u++)if(!this.coefficients[u].equals(t.coefficients[u]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,u){void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].fromArray(t,u+3*g);return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].toArray(t,u+3*g);return t}}),Object.assign(Tn,{getBasisAt:function(t,u){const m=t.x,g=t.y,E=t.z;u[0]=.282095,u[1]=.488603*g,u[2]=.488603*E,u[3]=.488603*m,u[4]=1.092548*m*g,u[5]=1.092548*g*E,u[6]=.315392*(3*E*E-1),u[7]=1.092548*m*E,u[8]=.546274*(m*m-g*g)}}),$n.prototype=Object.assign(Object.create(Je.prototype),{constructor:$n,isLightProbe:!0,copy:function(t){return Je.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const u=Je.prototype.toJSON.call(this,t);return u.object.sh=this.sh.toArray(),u}}),Qn.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Qn,load:function(t,u,m,g){const E=this,I=new Es(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(G){try{u(E.parse(JSON.parse(G)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u=this.textures;function m(E){return void 0===u[E]&&console.warn("THREE.MaterialLoader: Undefined texture",E),u[E]}const g=new Ih[t.type];if(void 0!==t.uuid&&(g.uuid=t.uuid),void 0!==t.name&&(g.name=t.name),void 0!==t.color&&g.color.setHex(t.color),void 0!==t.roughness&&(g.roughness=t.roughness),void 0!==t.metalness&&(g.metalness=t.metalness),void 0!==t.sheen&&(g.sheen=(new ar).setHex(t.sheen)),void 0!==t.emissive&&g.emissive.setHex(t.emissive),void 0!==t.specular&&g.specular.setHex(t.specular),void 0!==t.shininess&&(g.shininess=t.shininess),void 0!==t.clearcoat&&(g.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(g.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(g.fog=t.fog),void 0!==t.flatShading&&(g.flatShading=t.flatShading),void 0!==t.blending&&(g.blending=t.blending),void 0!==t.combine&&(g.combine=t.combine),void 0!==t.side&&(g.side=t.side),void 0!==t.opacity&&(g.opacity=t.opacity),void 0!==t.transparent&&(g.transparent=t.transparent),void 0!==t.alphaTest&&(g.alphaTest=t.alphaTest),void 0!==t.depthTest&&(g.depthTest=t.depthTest),void 0!==t.depthWrite&&(g.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(g.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(g.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(g.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(g.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(g.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(g.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(g.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(g.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(g.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(g.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(g.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(g.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(g.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(g.rotation=t.rotation),1!==t.linewidth&&(g.linewidth=t.linewidth),void 0!==t.dashSize&&(g.dashSize=t.dashSize),void 0!==t.gapSize&&(g.gapSize=t.gapSize),void 0!==t.scale&&(g.scale=t.scale),void 0!==t.polygonOffset&&(g.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(g.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(g.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(g.skinning=t.skinning),void 0!==t.morphTargets&&(g.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(g.morphNormals=t.morphNormals),void 0!==t.dithering&&(g.dithering=t.dithering),void 0!==t.vertexTangents&&(g.vertexTangents=t.vertexTangents),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.toneMapped&&(g.toneMapped=t.toneMapped),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.vertexColors&&(g.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const E in t.uniforms){const I=t.uniforms[E];switch(g.uniforms[E]={},I.type){case"t":g.uniforms[E].value=m(I.value);break;case"c":g.uniforms[E].value=(new ar).setHex(I.value);break;case"v2":g.uniforms[E].value=(new wn).fromArray(I.value);break;case"v3":g.uniforms[E].value=(new lt).fromArray(I.value);break;case"v4":g.uniforms[E].value=(new xi).fromArray(I.value);break;case"m3":g.uniforms[E].value=(new Ho).fromArray(I.value);case"m4":g.uniforms[E].value=(new ri).fromArray(I.value);break;default:g.uniforms[E].value=I.value}}if(void 0!==t.defines&&(g.defines=t.defines),void 0!==t.vertexShader&&(g.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(g.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const E in t.extensions)g.extensions[E]=t.extensions[E];if(void 0!==t.shading&&(g.flatShading=1===t.shading),void 0!==t.size&&(g.size=t.size),void 0!==t.sizeAttenuation&&(g.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(g.map=m(t.map)),void 0!==t.matcap&&(g.matcap=m(t.matcap)),void 0!==t.alphaMap&&(g.alphaMap=m(t.alphaMap)),void 0!==t.bumpMap&&(g.bumpMap=m(t.bumpMap)),void 0!==t.bumpScale&&(g.bumpScale=t.bumpScale),void 0!==t.normalMap&&(g.normalMap=m(t.normalMap)),void 0!==t.normalMapType&&(g.normalMapType=t.normalMapType),void 0!==t.normalScale){let E=t.normalScale;!1===Array.isArray(E)&&(E=[E,E]),g.normalScale=(new wn).fromArray(E)}return void 0!==t.displacementMap&&(g.displacementMap=m(t.displacementMap)),void 0!==t.displacementScale&&(g.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(g.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(g.roughnessMap=m(t.roughnessMap)),void 0!==t.metalnessMap&&(g.metalnessMap=m(t.metalnessMap)),void 0!==t.emissiveMap&&(g.emissiveMap=m(t.emissiveMap)),void 0!==t.emissiveIntensity&&(g.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(g.specularMap=m(t.specularMap)),void 0!==t.envMap&&(g.envMap=m(t.envMap)),void 0!==t.envMapIntensity&&(g.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(g.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(g.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(g.lightMap=m(t.lightMap)),void 0!==t.lightMapIntensity&&(g.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(g.aoMap=m(t.aoMap)),void 0!==t.aoMapIntensity&&(g.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(g.gradientMap=m(t.gradientMap)),void 0!==t.clearcoatMap&&(g.clearcoatMap=m(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap=m(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(g.clearcoatNormalMap=m(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(g.clearcoatNormalScale=(new wn).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(g.transmission=t.transmission),void 0!==t.transmissionMap&&(g.transmissionMap=m(t.transmissionMap)),g},setTextures:function(t){return this.textures=t,this}});const lr={decodeText:function(t){if(typeof TextDecoder<"u")return(new TextDecoder).decode(t);let u="";for(let m=0,g=t.length;m<g;m++)u+=String.fromCharCode(t[m]);try{return decodeURIComponent(escape(u))}catch{return u}},extractUrlBase:function(t){const u=t.lastIndexOf("/");return-1===u?"./":t.substr(0,u+1)}};function jn(){hn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function pr(t,u,m,g){"number"==typeof m&&(g=m,m=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Vr.call(this,t,u,m),this.meshPerAttribute=g||1}function Yn(t){Ti.call(this,t)}jn.prototype=Object.assign(Object.create(hn.prototype),{constructor:jn,isInstancedBufferGeometry:!0,copy:function(t){return hn.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=hn.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),pr.prototype=Object.assign(Object.create(Vr.prototype),{constructor:pr,isInstancedBufferAttribute:!0,copy:function(t){return Vr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Vr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Yn.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Yn,load:function(t,u,m,g){const E=this,I=new Es(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(G){try{u(E.parse(JSON.parse(G)))}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)},parse:function(t){const u={},m={};function g(me,ge){if(void 0!==u[ge])return u[ge];const Se=me.interleavedBuffers[ge],w=function(c,d){if(void 0!==m[d])return m[d];const S=new Uint32Array(c.arrayBuffers[d]).buffer;return m[d]=S,S}(me,Se.buffer),e=new Oa(new wr[Se.type](w),Se.stride);return e.uuid=Se.uuid,u[ge]=e,e}const E=t.isInstancedBufferGeometry?new jn:new hn,I=t.data.index;if(void 0!==I){const me=new wr[I.type](I.array);E.setIndex(new Vr(me,1))}const G=t.data.attributes;for(const me in G){const ge=G[me];let Se;if(ge.isInterleavedBufferAttribute)Se=new Lh(g(t.data,ge.data),ge.itemSize,ge.offset,ge.normalized);else{const w=new wr[ge.type](ge.array);Se=new(ge.isInstancedBufferAttribute?pr:Vr)(w,ge.itemSize,ge.normalized)}void 0!==ge.name&&(Se.name=ge.name),E.setAttribute(me,Se)}const Z=t.data.morphAttributes;if(Z)for(const me in Z){const ge=Z[me],Se=[];for(let w=0,e=ge.length;w<e;w++){const c=ge[w];let d;d=c.isInterleavedBufferAttribute?new Lh(g(t.data,c.data),c.itemSize,c.offset,c.normalized):new Vr(new wr[c.type](c.array),c.itemSize,c.normalized),void 0!==c.name&&(d.name=c.name),Se.push(d)}E.morphAttributes[me]=Se}t.data.morphTargetsRelative&&(E.morphTargetsRelative=!0);const J=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==J)for(let me=0,ge=J.length;me!==ge;++me){const Se=J[me];E.addGroup(Se.start,Se.count,Se.materialIndex)}const K=t.data.boundingSphere;if(void 0!==K){const me=new lt;void 0!==K.center&&me.fromArray(K.center),E.boundingSphere=new Gn(me,K.radius)}return t.name&&(E.name=t.name),t.userData&&(E.userData=t.userData),E}});const wr={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Or(t){Ti.call(this,t)}Or.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Or,load:function(t,u,m,g){const E=this,I=""===this.path?lr.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||I;const G=new Es(E.manager);G.setPath(this.path),G.setRequestHeader(this.requestHeader),G.load(t,function(Z){let J=null;try{J=JSON.parse(Z)}catch(me){return void 0!==g&&g(me),void console.error("THREE:ObjectLoader: Can't parse "+t+".",me.message)}const K=J.metadata;void 0!==K&&void 0!==K.type&&"geometry"!==K.type.toLowerCase()?E.parse(J,u):console.error("THREE.ObjectLoader: Can't load "+t)},m,g)},parse:function(t,u){const m=this.parseShape(t.shapes),g=this.parseGeometries(t.geometries,m),E=this.parseImages(t.images,function(){void 0!==u&&u(Z)}),I=this.parseTextures(t.textures,E),G=this.parseMaterials(t.materials,I),Z=this.parseObject(t.object,g,G);return t.animations&&(Z.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==u&&u(Z),Z},parseShape:function(t){const u={};if(void 0!==t)for(let m=0,g=t.length;m<g;m++){const E=(new Ue).fromJSON(t[m]);u[E.uuid]=E}return u},parseGeometries:function(t,u){const m={};let g;if(void 0!==t){const E=new Yn;for(let I=0,G=t.length;I<G;I++){let Z;const J=t[I];switch(J.type){case"PlaneGeometry":case"PlaneBufferGeometry":Z=new ia[J.type](J.width,J.height,J.widthSegments,J.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":Z=new ia[J.type](J.width,J.height,J.depth,J.widthSegments,J.heightSegments,J.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":Z=new ia[J.type](J.radius,J.segments,J.thetaStart,J.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":Z=new ia[J.type](J.radiusTop,J.radiusBottom,J.height,J.radialSegments,J.heightSegments,J.openEnded,J.thetaStart,J.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":Z=new ia[J.type](J.radius,J.height,J.radialSegments,J.heightSegments,J.openEnded,J.thetaStart,J.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":Z=new ia[J.type](J.radius,J.widthSegments,J.heightSegments,J.phiStart,J.phiLength,J.thetaStart,J.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":Z=new ia[J.type](J.radius,J.detail);break;case"RingGeometry":case"RingBufferGeometry":Z=new ia[J.type](J.innerRadius,J.outerRadius,J.thetaSegments,J.phiSegments,J.thetaStart,J.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":Z=new ia[J.type](J.radius,J.tube,J.radialSegments,J.tubularSegments,J.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":Z=new ia[J.type](J.radius,J.tube,J.tubularSegments,J.radialSegments,J.p,J.q);break;case"TubeGeometry":case"TubeBufferGeometry":Z=new ia[J.type]((new Oe[J.path.type]).fromJSON(J.path),J.tubularSegments,J.radius,J.radialSegments,J.closed);break;case"LatheGeometry":case"LatheBufferGeometry":Z=new ia[J.type](J.points,J.segments,J.phiStart,J.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":Z=new ia[J.type](J.vertices,J.indices,J.radius,J.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":g=[];for(let me=0,ge=J.shapes.length;me<ge;me++)g.push(u[J.shapes[me]]);Z=new ia[J.type](g,J.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":g=[];for(let me=0,ge=J.shapes.length;me<ge;me++)g.push(u[J.shapes[me]]);const K=J.options.extrudePath;void 0!==K&&(J.options.extrudePath=(new Oe[K.type]).fromJSON(K)),Z=new ia[J.type](g,J.options);break;case"BufferGeometry":case"InstancedBufferGeometry":Z=E.parse(J);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+J.type+'"');continue}Z.uuid=J.uuid,void 0!==J.name&&(Z.name=J.name),!0===Z.isBufferGeometry&&void 0!==J.userData&&(Z.userData=J.userData),m[J.uuid]=Z}}return m},parseMaterials:function(t,u){const m={},g={};if(void 0!==t){const E=new Qn;E.setTextures(u);for(let I=0,G=t.length;I<G;I++){const Z=t[I];if("MultiMaterial"===Z.type){const J=[];for(let K=0;K<Z.materials.length;K++){const me=Z.materials[K];void 0===m[me.uuid]&&(m[me.uuid]=E.parse(me)),J.push(m[me.uuid])}g[Z.uuid]=J}else void 0===m[Z.uuid]&&(m[Z.uuid]=E.parse(Z)),g[Z.uuid]=m[Z.uuid]}}return g},parseAnimations:function(t){const u=[];for(let m=0;m<t.length;m++){const g=t[m],E=ls.parse(g);void 0!==g.uuid&&(E.uuid=g.uuid),u.push(E)}return u},parseImages:function(t,u){const m=this,g={};let E;function I(G){return m.manager.itemStart(G),E.load(G,function(){m.manager.itemEnd(G)},void 0,function(){m.manager.itemError(G),m.manager.itemEnd(G)})}if(void 0!==t&&t.length>0){const G=new Xd(u);E=new pu(G),E.setCrossOrigin(this.crossOrigin);for(let Z=0,J=t.length;Z<J;Z++){const K=t[Z],me=K.url;if(Array.isArray(me)){g[K.uuid]=[];for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge],e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:m.resourcePath+w;g[K.uuid].push(I(e))}}else{const ge=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(K.url)?K.url:m.resourcePath+K.url;g[K.uuid]=I(ge)}}}return g},parseTextures:function(t,u){function m(E,I){return"number"==typeof E?E:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",E),I[E])}const g={};if(void 0!==t)for(let E=0,I=t.length;E<I;E++){const G=t[E];let Z;void 0===G.image&&console.warn('THREE.ObjectLoader: No "image" specified for',G.uuid),void 0===u[G.image]&&console.warn("THREE.ObjectLoader: Undefined image",G.image),Z=Array.isArray(u[G.image])?new ea(u[G.image]):new di(u[G.image]),Z.needsUpdate=!0,Z.uuid=G.uuid,void 0!==G.name&&(Z.name=G.name),void 0!==G.mapping&&(Z.mapping=m(G.mapping,Ji)),void 0!==G.offset&&Z.offset.fromArray(G.offset),void 0!==G.repeat&&Z.repeat.fromArray(G.repeat),void 0!==G.center&&Z.center.fromArray(G.center),void 0!==G.rotation&&(Z.rotation=G.rotation),void 0!==G.wrap&&(Z.wrapS=m(G.wrap[0],fo),Z.wrapT=m(G.wrap[1],fo)),void 0!==G.format&&(Z.format=G.format),void 0!==G.type&&(Z.type=G.type),void 0!==G.encoding&&(Z.encoding=G.encoding),void 0!==G.minFilter&&(Z.minFilter=m(G.minFilter,wo)),void 0!==G.magFilter&&(Z.magFilter=m(G.magFilter,wo)),void 0!==G.anisotropy&&(Z.anisotropy=G.anisotropy),void 0!==G.flipY&&(Z.flipY=G.flipY),void 0!==G.premultiplyAlpha&&(Z.premultiplyAlpha=G.premultiplyAlpha),void 0!==G.unpackAlignment&&(Z.unpackAlignment=G.unpackAlignment),g[G.uuid]=Z}return g},parseObject:function(t,u,m){let g,E,I;function G(J){return void 0===u[J]&&console.warn("THREE.ObjectLoader: Undefined geometry",J),u[J]}function Z(J){if(void 0!==J){if(Array.isArray(J)){const K=[];for(let me=0,ge=J.length;me<ge;me++){const Se=J[me];void 0===m[Se]&&console.warn("THREE.ObjectLoader: Undefined material",Se),K.push(m[Se])}return K}return void 0===m[J]&&console.warn("THREE.ObjectLoader: Undefined material",J),m[J]}}switch(t.type){case"Scene":g=new Cl,void 0!==t.background&&Number.isInteger(t.background)&&(g.background=new ar(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?g.fog=new Xp(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(g.fog=new hf(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":g=new Rs(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(g.focus=t.focus),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.filmGauge&&(g.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(g.filmOffset=t.filmOffset),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"OrthographicCamera":g=new It(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"AmbientLight":g=new $t(t.color,t.intensity);break;case"DirectionalLight":g=new ft(t.color,t.intensity);break;case"PointLight":g=new jt(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":g=new Zt(t.color,t.intensity,t.width,t.height);break;case"SpotLight":g=new Tt(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":g=new pt(t.color,t.groundColor,t.intensity);break;case"LightProbe":g=(new $n).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":E=G(t.geometry),I=Z(t.material),g=new Ci(E,I);break;case"InstancedMesh":E=G(t.geometry),I=Z(t.material);const K=t.instanceMatrix;g=new Zo(E,I,t.count),g.instanceMatrix=new Vr(new Float32Array(K.array),16);break;case"LOD":g=new Op;break;case"Line":g=new Gs(G(t.geometry),Z(t.material),t.mode);break;case"LineLoop":g=new Jp(G(t.geometry),Z(t.material));break;case"LineSegments":g=new Ii(G(t.geometry),Z(t.material));break;case"PointCloud":case"Points":g=new kc(G(t.geometry),Z(t.material));break;case"Sprite":g=new nl(Z(t.material));break;case"Group":g=new wa;break;default:g=new Kn}if(g.uuid=t.uuid,void 0!==t.name&&(g.name=t.name),void 0!==t.matrix?(g.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(g.matrixAutoUpdate=t.matrixAutoUpdate),g.matrixAutoUpdate&&g.matrix.decompose(g.position,g.quaternion,g.scale)):(void 0!==t.position&&g.position.fromArray(t.position),void 0!==t.rotation&&g.rotation.fromArray(t.rotation),void 0!==t.quaternion&&g.quaternion.fromArray(t.quaternion),void 0!==t.scale&&g.scale.fromArray(t.scale)),void 0!==t.castShadow&&(g.castShadow=t.castShadow),void 0!==t.receiveShadow&&(g.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(g.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(g.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(g.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&g.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(g.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.frustumCulled&&(g.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(g.renderOrder=t.renderOrder),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.layers&&(g.layers.mask=t.layers),void 0!==t.children){const J=t.children;for(let K=0;K<J.length;K++)g.add(this.parseObject(J[K],u,m))}if("LOD"===t.type){void 0!==t.autoUpdate&&(g.autoUpdate=t.autoUpdate);const J=t.levels;for(let K=0;K<J.length;K++){const me=J[K],ge=g.getObjectByProperty("uuid",me.object);void 0!==ge&&g.addLevel(ge,me.distance)}}return g}});const Ji={UVMapping:yi,CubeReflectionMapping:Ei,CubeRefractionMapping:So,EquirectangularReflectionMapping:Xs,EquirectangularRefractionMapping:ua,CubeUVReflectionMapping:Ni,CubeUVRefractionMapping:Eo},fo={RepeatWrapping:vo,ClampToEdgeWrapping:Jr,MirroredRepeatWrapping:os},wo={NearestFilter:Ir,NearestMipmapNearestFilter:Va,NearestMipmapLinearFilter:hs,LinearFilter:ai,LinearMipmapNearestFilter:Gc,LinearMipmapLinearFilter:sl};function Uo(t){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ti.call(this,t),this.options={premultiplyAlpha:"none"}}function cs(){this.type="ShapePath",this.color=new ar,this.subPaths=[],this.currentPath=null}function Ws(t){this.type="Font",this.data=t}function Ga(t,u,m,g,E){const I=E.glyphs[t]||E.glyphs["?"];if(!I)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+E.familyName+".");const G=new cs;let Z,J,K,me,ge,Se,w,e;if(I.o){const c=I._cachedOutline||(I._cachedOutline=I.o.split(" "));for(let d=0,_=c.length;d<_;)switch(c[d++]){case"m":Z=c[d++]*u+m,J=c[d++]*u+g,G.moveTo(Z,J);break;case"l":Z=c[d++]*u+m,J=c[d++]*u+g,G.lineTo(Z,J);break;case"q":K=c[d++]*u+m,me=c[d++]*u+g,ge=c[d++]*u+m,Se=c[d++]*u+g,G.quadraticCurveTo(ge,Se,K,me);break;case"b":K=c[d++]*u+m,me=c[d++]*u+g,ge=c[d++]*u+m,Se=c[d++]*u+g,w=c[d++]*u+m,e=c[d++]*u+g,G.bezierCurveTo(ge,Se,w,e,K,me)}}return{offsetX:I.ha*u,path:G}}function ks(t){Ti.call(this,t)}let qs;Uo.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Uo,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ss.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;fetch(t).then(function(G){return G.blob()}).then(function(G){return createImageBitmap(G,E.options)}).then(function(G){Ss.add(t,G),u&&u(G),E.manager.itemEnd(t)}).catch(function(G){g&&g(G),E.manager.itemError(t),E.manager.itemEnd(t)}),E.manager.itemStart(t)}}),Object.assign(cs.prototype,{moveTo:function(t,u){return this.currentPath=new je,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,u),this},lineTo:function(t,u){return this.currentPath.lineTo(t,u),this},quadraticCurveTo:function(t,u,m,g){return this.currentPath.quadraticCurveTo(t,u,m,g),this},bezierCurveTo:function(t,u,m,g,E,I){return this.currentPath.bezierCurveTo(t,u,m,g,E,I),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,u){function m(_){const S=[];for(let B=0,k=_.length;B<k;B++){const F=_[B],V=new Ue;V.curves=F.curves,S.push(V)}return S}function g(_,S){const B=S.length;let k=!1;for(let F=B-1,V=0;V<B;F=V++){let te=S[F],ce=S[V],ue=ce.x-te.x,_e=ce.y-te.y;if(Math.abs(_e)>Number.EPSILON){if(_e<0&&(te=S[V],ue=-ue,ce=S[F],_e=-_e),_.y<te.y||_.y>ce.y)continue;if(_.y===te.y){if(_.x===te.x)return!0}else{const Ee=_e*(_.x-te.x)-ue*(_.y-te.y);if(0===Ee)return!0;if(Ee<0)continue;k=!k}}else{if(_.y!==te.y)continue;if(ce.x<=_.x&&_.x<=te.x||te.x<=_.x&&_.x<=ce.x)return!0}}return k}const E=Iu.isClockWise,I=this.subPaths;if(0===I.length)return[];if(!0===u)return m(I);let G,Z,J,K=[];if(1===I.length)return Z=I[0],J=new Ue,J.curves=Z.curves,K.push(J),K;let me=!E(I[0].getPoints());me=t?!me:me;const ge=[],Se=[];let w,e,c=[],d=0;Se[d]=void 0,c[d]=[];for(let _=0,S=I.length;_<S;_++)Z=I[_],w=Z.getPoints(),G=E(w),G=t?!G:G,G?(!me&&Se[d]&&d++,Se[d]={s:new Ue,p:w},Se[d].s.curves=Z.curves,me&&d++,c[d]=[]):c[d].push({h:Z,p:w[0]});if(!Se[0])return m(I);if(Se.length>1){let _=!1;const S=[];for(let B=0,k=Se.length;B<k;B++)ge[B]=[];for(let B=0,k=Se.length;B<k;B++){const F=c[B];for(let V=0;V<F.length;V++){const te=F[V];let ce=!0;for(let ue=0;ue<Se.length;ue++)g(te.p,Se[ue].p)&&(B!==ue&&S.push({froms:B,tos:ue,hole:V}),ce?(ce=!1,ge[ue].push(te)):_=!0);ce&&ge[B].push(te)}}S.length>0&&(_||(c=ge))}for(let _=0,S=Se.length;_<S;_++){J=Se[_].s,K.push(J),e=c[_];for(let B=0,k=e.length;B<k;B++)J.holes.push(e[B].h)}return K}}),Object.assign(Ws.prototype,{isFont:!0,generateShapes:function(t,u){void 0===u&&(u=100);const m=[],g=function(E,I,G){const Z=Array.from?Array.from(E):String(E).split(""),J=I/G.resolution,K=(G.boundingBox.yMax-G.boundingBox.yMin+G.underlineThickness)*J,me=[];let ge=0,Se=0;for(let w=0;w<Z.length;w++){const e=Z[w];if("\n"===e)ge=0,Se-=K;else{const c=Ga(e,J,ge,Se,G);ge+=c.offsetX,me.push(c.path)}}return me}(t,u,this.data);for(let E=0,I=g.length;E<I;E++)Array.prototype.push.apply(m,g[E].toShapes());return m}}),ks.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ks,load:function(t,u,m,g){const E=this,I=new Es(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.load(t,function(G){let Z;try{Z=JSON.parse(G)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),Z=JSON.parse(G.substring(65,G.length-2))}const J=E.parse(Z);u&&u(J)},m,g)},parse:function(t){return new Ws(t)}});const Hl={getContext:function(){return void 0===qs&&(qs=new(window.AudioContext||window.webkitAudioContext)),qs},setContext:function(t){qs=t}};function ap(t){Ti.call(this,t)}function lp(t,u,m){$n.call(this,void 0,m);const g=(new ar).set(t),E=(new ar).set(u),I=new lt(g.r,g.g,g.b),G=new lt(E.r,E.g,E.b),Z=Math.sqrt(Math.PI),J=Z*Math.sqrt(.75);this.sh.coefficients[0].copy(I).add(G).multiplyScalar(Z),this.sh.coefficients[1].copy(I).sub(G).multiplyScalar(J)}function Up(t,u){$n.call(this,void 0,u);const m=(new ar).set(t);this.sh.coefficients[0].set(m.r,m.g,m.b).multiplyScalar(2*Math.sqrt(Math.PI))}ap.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ap,load:function(t,u,m,g){const E=this,I=new Es(E.manager);I.setResponseType("arraybuffer"),I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(G){try{const Z=G.slice(0);Hl.getContext().decodeAudioData(Z,function(J){u(J)})}catch(Z){g?g(Z):console.error(Z),E.manager.itemError(t)}},m,g)}}),lp.prototype=Object.assign(Object.create($n.prototype),{constructor:lp,isHemisphereLightProbe:!0,copy:function(t){return $n.prototype.copy.call(this,t),this},toJSON:function(t){return $n.prototype.toJSON.call(this,t)}}),Up.prototype=Object.assign(Object.create($n.prototype),{constructor:Up,isAmbientLightProbe:!0,copy:function(t){return $n.prototype.copy.call(this,t),this},toJSON:function(t){return $n.prototype.toJSON.call(this,t)}});const Sd=new ri,Uc=new ri;function up(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Rs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Rs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function fh(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(up.prototype,{update:function(t){const u=this._cache;if(u.focus!==t.focus||u.fov!==t.fov||u.aspect!==t.aspect*this.aspect||u.near!==t.near||u.far!==t.far||u.zoom!==t.zoom||u.eyeSep!==this.eyeSep){u.focus=t.focus,u.fov=t.fov,u.aspect=t.aspect*this.aspect,u.near=t.near,u.far=t.far,u.zoom=t.zoom,u.eyeSep=this.eyeSep;const m=t.projectionMatrix.clone(),g=u.eyeSep/2,E=g*u.near/u.focus,I=u.near*Math.tan(tr.DEG2RAD*u.fov*.5)/u.zoom;let G,Z;Uc.elements[12]=-g,Sd.elements[12]=g,G=-I*u.aspect+E,Z=I*u.aspect+E,m.elements[0]=2*u.near/(Z-G),m.elements[8]=(Z+G)/(Z-G),this.cameraL.projectionMatrix.copy(m),G=-I*u.aspect-E,Z=I*u.aspect-E,m.elements[0]=2*u.near/(Z-G),m.elements[8]=(Z+G)/(Z-G),this.cameraR.projectionMatrix.copy(m)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Uc),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Sd)}}),Object.assign(fh.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const u=(typeof performance>"u"?Date:performance).now();t=(u-this.oldTime)/1e3,this.oldTime=u,this.elapsedTime+=t}return t}});const il=new lt,hp=new yo,jm=new lt,Ed=new lt;function If(){Kn.call(this),this.type="AudioListener",this.context=Hl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fh}function Jd(t){Kn.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}If.prototype=Object.assign(Object.create(Kn.prototype),{constructor:If,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Kn.prototype.updateMatrixWorld.call(this,t);const u=this.context.listener,m=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(il,hp,jm),Ed.set(0,0,-1).applyQuaternion(hp),u.positionX){const g=this.context.currentTime+this.timeDelta;u.positionX.linearRampToValueAtTime(il.x,g),u.positionY.linearRampToValueAtTime(il.y,g),u.positionZ.linearRampToValueAtTime(il.z,g),u.forwardX.linearRampToValueAtTime(Ed.x,g),u.forwardY.linearRampToValueAtTime(Ed.y,g),u.forwardZ.linearRampToValueAtTime(Ed.z,g),u.upX.linearRampToValueAtTime(m.x,g),u.upY.linearRampToValueAtTime(m.y,g),u.upZ.linearRampToValueAtTime(m.z,g)}else u.setPosition(il.x,il.y,il.z),u.setOrientation(Ed.x,Ed.y,Ed.z,m.x,m.y,m.z)}}),Jd.prototype=Object.assign(Object.create(Kn.prototype),{constructor:Jd,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const u=this.context.createBufferSource();return u.buffer=this.buffer,u.loop=this.loop,u.loopStart=this.loopStart,u.loopEnd=this.loopEnd,u.onended=this.onEnded.bind(this),u.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=u,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});const nd=new lt,am=new yo,Gm=new lt,rd=new lt;function Zd(t){Jd.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function lm(t,u){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==u?u:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function vf(t,u,m){let g,E,I;switch(this.binding=t,this.valueSize=m,u){case"quaternion":g=this._slerp,E=this._slerpAdditive,I=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*m),this._workIndex=5;break;case"string":case"bool":g=this._select,E=this._select,I=this._setAdditiveIdentityOther,this.buffer=new Array(5*m);break;default:g=this._lerp,E=this._lerpAdditive,I=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*m)}this._mixBufferRegion=g,this._mixBufferRegionAdditive=E,this._setIdentity=I,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Zd.prototype=Object.assign(Object.create(Jd.prototype),{constructor:Zd,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,u,m){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=u,this.panner.coneOuterGain=m,this},updateMatrixWorld:function(t){if(Kn.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(nd,am,Gm),rd.set(0,0,1).applyQuaternion(am);const u=this.panner;if(u.positionX){const m=this.context.currentTime+this.listener.timeDelta;u.positionX.linearRampToValueAtTime(nd.x,m),u.positionY.linearRampToValueAtTime(nd.y,m),u.positionZ.linearRampToValueAtTime(nd.z,m),u.orientationX.linearRampToValueAtTime(rd.x,m),u.orientationY.linearRampToValueAtTime(rd.y,m),u.orientationZ.linearRampToValueAtTime(rd.z,m)}else u.setPosition(nd.x,nd.y,nd.z),u.setOrientation(rd.x,rd.y,rd.z)}}),Object.assign(lm.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let t=0;const u=this.getFrequencyData();for(let m=0;m<u.length;m++)t+=u[m];return t/u.length}}),Object.assign(vf.prototype,{accumulate:function(t,u){const m=this.buffer,g=this.valueSize,E=t*g+g;let I=this.cumulativeWeight;if(0===I){for(let G=0;G!==g;++G)m[E+G]=m[G];I=u}else I+=u,this._mixBufferRegion(m,E,0,u/I,g);this.cumulativeWeight=I},accumulateAdditive:function(t){const u=this.buffer,m=this.valueSize,g=m*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(u,g,0,t,m),this.cumulativeWeightAdditive+=t},apply:function(t){const u=this.valueSize,m=this.buffer,g=t*u+u,E=this.cumulativeWeight,I=this.cumulativeWeightAdditive,G=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,E<1&&this._mixBufferRegion(m,g,u*this._origIndex,1-E,u),I>0&&this._mixBufferRegionAdditive(m,g,this._addIndex*u,1,u);for(let Z=u,J=u+u;Z!==J;++Z)if(m[Z]!==m[Z+u]){G.setValue(m,g);break}},saveOriginalState:function(){const u=this.buffer,m=this.valueSize,g=m*this._origIndex;this.binding.getValue(u,g);for(let E=m,I=g;E!==I;++E)u[E]=u[g+E%m];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,u=t+this.valueSize;for(let m=t;m<u;m++)this.buffer[m]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,u=this._addIndex*this.valueSize;for(let m=0;m<this.valueSize;m++)this.buffer[u+m]=this.buffer[t+m]},_select:function(t,u,m,g,E){if(g>=.5)for(let I=0;I!==E;++I)t[u+I]=t[m+I]},_slerp:function(t,u,m,g){yo.slerpFlat(t,u,t,u,t,m,g)},_slerpAdditive:function(t,u,m,g,E){const I=this._workIndex*E;yo.multiplyQuaternionsFlat(t,I,t,u,t,m),yo.slerpFlat(t,u,t,u,t,I,g)},_lerp:function(t,u,m,g,E){const I=1-g;for(let G=0;G!==E;++G){const Z=u+G;t[Z]=t[Z]*I+t[m+G]*g}},_lerpAdditive:function(t,u,m,g,E){for(let I=0;I!==E;++I){const G=u+I;t[G]=t[G]+t[m+I]*g}}});const Of="\\[\\]\\.:\\/",o_=new RegExp("["+Of+"]","g"),Hm="[^"+Of+"]",E_="[^"+Of.replace("\\.","")+"]",s_=/((?:WC+[\/:])*)/.source.replace("WC",Hm),a_=/(WCOD+)?/.source.replace("WCOD",E_),l_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hm),c_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hm),Vm=new RegExp("^"+s_+a_+l_+c_+"$"),T_=["material","materials","bones"];function u_(t,u,m){const g=m||Sl.parseTrackName(u);this._targetGroup=t,this._bindings=t.subscribe_(u,g)}function Sl(t,u,m){this.path=u,this.parsedPath=m||Sl.parseTrackName(u),this.node=Sl.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function cm(){this.uuid=tr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let m=0,g=arguments.length;m!==g;++m)t[arguments[m].uuid]=m;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const u=this;this.stats={objects:{get total(){return u._objects.length},get inUse(){return this.total-u.nCachedObjects_}},get bindingsPerObject(){return u._bindings.length}}}function Wm(t,u,m,g){this._mixer=t,this._clip=u,this._localRoot=m||null,this.blendMode=g||u.blendMode;const E=u.tracks,I=E.length,G=new Array(I),Z={endingStart:La,endingEnd:La};for(let J=0;J!==I;++J){const K=E[J].createInterpolant(null);G[J]=K,K.settings=Z}this._interpolantSettings=Z,this._interpolants=G,this._propertyBindings=new Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function um(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function kf(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function hm(t,u,m){Oa.call(this,t,u),this.meshPerAttribute=m||1}function pm(t,u,m,g){this.ray=new co(t,u),this.near=m||0,this.far=g||1/0,this.camera=null,this.layers=new bu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function h_(t,u){return t.distance-u.distance}function dm(t,u,m,g){if(t.layers.test(u.layers)&&t.raycast(u,m),!0===g){const E=t.children;for(let I=0,G=E.length;I<G;I++)dm(E[I],u,m,!0)}}Object.assign(u_.prototype,{getValue:function(t,u){this.bind();const g=this._bindings[this._targetGroup.nCachedObjects_];void 0!==g&&g.getValue(t,u)},setValue:function(t,u){const m=this._bindings;for(let g=this._targetGroup.nCachedObjects_,E=m.length;g!==E;++g)m[g].setValue(t,u)},bind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].bind()},unbind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].unbind()}}),Object.assign(Sl,{Composite:u_,create:function(t,u,m){return t&&t.isAnimationObjectGroup?new Sl.Composite(t,u,m):new Sl(t,u,m)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(o_,"")},parseTrackName:function(t){const u=Vm.exec(t);if(!u)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const m={nodeName:u[2],objectName:u[3],objectIndex:u[4],propertyName:u[5],propertyIndex:u[6]},g=m.nodeName&&m.nodeName.lastIndexOf(".");if(void 0!==g&&-1!==g){const E=m.nodeName.substring(g+1);-1!==T_.indexOf(E)&&(m.nodeName=m.nodeName.substring(0,g),m.objectName=E)}if(null===m.propertyName||0===m.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return m},findNode:function(t,u){if(!u||""===u||"."===u||-1===u||u===t.name||u===t.uuid)return t;if(t.skeleton){const m=t.skeleton.getBoneByName(u);if(void 0!==m)return m}if(t.children){const m=function(E){for(let I=0;I<E.length;I++){const G=E[I];if(G.name===u||G.uuid===u)return G;const Z=m(G.children);if(Z)return Z}return null},g=m(t.children);if(g)return g}return null}}),Object.assign(Sl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,u){t[u]=this.node[this.propertyName]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)t[u++]=m[g]},function(t,u){t[u]=this.resolvedProperty[this.propertyIndex]},function(t,u){this.resolvedProperty.toArray(t,u)}],SetterByBindingTypeAndVersioning:[[function(t,u){this.targetObject[this.propertyName]=t[u]},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.needsUpdate=!0},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty[this.propertyIndex]=t[u]},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty.fromArray(t,u)},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,u){this.bind(),this.getValue(t,u)},setValue:function(t,u){this.bind(),this.setValue(t,u)},bind:function(){let t=this.node,u=this.parsedPath,m=u.objectName,g=u.propertyName,E=u.propertyIndex;if(t||(t=Sl.findNode(this.rootNode,u.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(m){let J=u.objectIndex;switch(m){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let K=0;K<t.length;K++)if(t[K].name===J){J=K;break}break;default:if(void 0===t[m])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[m]}if(void 0!==J){if(void 0===t[J])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[J]}}const I=t[g];if(void 0===I)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u.nodeName+"."+g+" but it wasn't found.",t);let G=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?G=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(G=this.Versioning.MatrixWorldNeedsUpdate);let Z=this.BindingType.Direct;if(void 0!==E){if("morphTargetInfluences"===g){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[E]&&(E=t.morphTargetDictionary[E])}Z=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=E}else void 0!==I.fromArray&&void 0!==I.toArray?(Z=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(Z=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=g;this.getValue=this.GetterByBindingType[Z],this.setValue=this.SetterByBindingTypeAndVersioning[Z][G]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Sl.prototype,{_getValue_unbound:Sl.prototype.getValue,_setValue_unbound:Sl.prototype.setValue}),Object.assign(cm.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,u=this._indicesByUUID,m=this._paths,g=this._parsedPaths,E=this._bindings,I=E.length;let G,Z=t.length,J=this.nCachedObjects_;for(let K=0,me=arguments.length;K!==me;++K){const ge=arguments[K],Se=ge.uuid;let w=u[Se];if(void 0===w){w=Z++,u[Se]=w,t.push(ge);for(let e=0,c=I;e!==c;++e)E[e].push(new Sl(ge,m[e],g[e]))}else if(w<J){G=t[w];const e=--J,c=t[e];u[c.uuid]=w,t[w]=c,u[Se]=e,t[e]=ge;for(let d=0,_=I;d!==_;++d){const S=E[d];let k=S[w];S[w]=S[e],void 0===k&&(k=new Sl(ge,m[d],g[d])),S[e]=k}}else t[w]!==G&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=J},remove:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_;for(let I=0,G=arguments.length;I!==G;++I){const Z=arguments[I],J=Z.uuid,K=u[J];if(void 0!==K&&K>=E){const me=E++,ge=t[me];u[ge.uuid]=K,t[K]=ge,u[J]=me,t[me]=Z;for(let Se=0,w=g;Se!==w;++Se){const e=m[Se],d=e[K];e[K]=e[me],e[me]=d}}}this.nCachedObjects_=E},uncache:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_,I=t.length;for(let G=0,Z=arguments.length;G!==Z;++G){const J=arguments[G].uuid,K=u[J];if(void 0!==K)if(delete u[J],K<E){const me=--E,ge=t[me],Se=--I,w=t[Se];u[ge.uuid]=K,t[K]=ge,u[w.uuid]=me,t[me]=w,t.pop();for(let e=0,c=g;e!==c;++e){const d=m[e],S=d[Se];d[K]=d[me],d[me]=S,d.pop()}}else{const me=--I,ge=t[me];u[ge.uuid]=K,t[K]=ge,t.pop();for(let Se=0,w=g;Se!==w;++Se){const e=m[Se];e[K]=e[me],e.pop()}}}this.nCachedObjects_=E},subscribe_:function(t,u){let m=this._bindingsIndicesByPath,g=m[t],E=this._bindings;if(void 0!==g)return E[g];const I=this._paths,G=this._parsedPaths,Z=this._objects,K=this.nCachedObjects_,me=new Array(Z.length);g=E.length,m[t]=g,I.push(t),G.push(u),E.push(me);for(let ge=K,Se=Z.length;ge!==Se;++ge)me[ge]=new Sl(Z[ge],t,u);return me},unsubscribe_:function(t){const u=this._bindingsIndicesByPath,m=u[t];if(void 0!==m){const g=this._paths,E=this._parsedPaths,I=this._bindings,G=I.length-1,Z=I[G];u[t[G]]=m,I[m]=Z,I.pop(),E[m]=E[G],E.pop(),g[m]=g[G],g.pop()}}}),Object.assign(Wm.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,u){return this.loop=t,this.repetitions=u,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,u,m){if(t.fadeOut(u),this.fadeIn(u),m){const g=this._clip.duration,E=t._clip.duration,G=g/E;t.warp(1,E/g,u),this.warp(G,1,u)}return this},crossFadeTo:function(t,u,m){return t.crossFadeFrom(this,u,m)},stopFading:function(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,u,m){const g=this._mixer,E=g.time,I=this.timeScale;let G=this._timeScaleInterpolant;null===G&&(G=g._lendControlInterpolant(),this._timeScaleInterpolant=G);const Z=G.parameterPositions,J=G.sampleValues;return Z[0]=E,Z[1]=E+m,J[0]=t/I,J[1]=u/I,this},stopWarping:function(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,u,m,g){if(!this.enabled)return void this._updateWeight(t);const E=this._startTime;if(null!==E){const Z=(t-E)*m;if(Z<0||0===m)return;this._startTime=null,u=m*Z}u*=this._updateTimeScale(t);const I=this._updateTime(u),G=this._updateWeight(t);if(G>0){const Z=this._interpolants,J=this._propertyBindings;if(this.blendMode===th)for(let K=0,me=Z.length;K!==me;++K)Z[K].evaluate(I),J[K].accumulateAdditive(G);else for(let K=0,me=Z.length;K!==me;++K)Z[K].evaluate(I),J[K].accumulate(g,G)}},_updateWeight:function(t){let u=0;if(this.enabled){u=this.weight;const m=this._weightInterpolant;if(null!==m){const g=m.evaluate(t)[0];u*=g,t>m.parameterPositions[1]&&(this.stopFading(),0===g&&(this.enabled=!1))}}return this._effectiveWeight=u,u},_updateTimeScale:function(t){let u=0;if(!this.paused){u=this.timeScale;const m=this._timeScaleInterpolant;null!==m&&(u*=m.evaluate(t)[0],t>m.parameterPositions[1]&&(this.stopWarping(),0===u?this.paused=!0:this.timeScale=u))}return this._effectiveTimeScale=u,u},_updateTime:function(t){const u=this._clip.duration,m=this.loop;let g=this.time+t,E=this._loopCount;const I=m===bc;if(0===t)return-1===E?g:I&&1==(1&E)?u-g:g;if(m===gu){-1===E&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(g>=u)g=u;else{if(!(g<0)){this.time=g;break e}g=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===E&&(t>=0?(E=0,this._setEndings(!0,0===this.repetitions,I)):this._setEndings(0===this.repetitions,!0,I)),g>=u||g<0){const G=Math.floor(g/u);g-=u*G,E+=Math.abs(G);const Z=this.repetitions-E;if(Z<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=t>0?u:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===Z){const J=t<0;this._setEndings(J,!J,I)}else this._setEndings(!1,!1,I);this._loopCount=E,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:G})}}else this.time=g;if(I&&1==(1&E))return u-g}return g},_setEndings:function(t,u,m){const g=this._interpolantSettings;m?(g.endingStart=pa,g.endingEnd=pa):(g.endingStart=t?this.zeroSlopeAtStart?pa:La:Al,g.endingEnd=u?this.zeroSlopeAtEnd?pa:La:Al)},_scheduleFading:function(t,u,m){const g=this._mixer,E=g.time;let I=this._weightInterpolant;null===I&&(I=g._lendControlInterpolant(),this._weightInterpolant=I);const G=I.parameterPositions,Z=I.sampleValues;return G[0]=E,Z[0]=u,G[1]=E+t,Z[1]=m,this}}),um.prototype=Object.assign(Object.create(ma.prototype),{constructor:um,_bindAction:function(t,u){const m=t._localRoot||this._root,g=t._clip.tracks,E=g.length,I=t._propertyBindings,G=t._interpolants,Z=m.uuid,J=this._bindingsByRootAndName;let K=J[Z];void 0===K&&(K={},J[Z]=K);for(let me=0;me!==E;++me){const ge=g[me],Se=ge.name;let w=K[Se];if(void 0!==w)I[me]=w;else{if(w=I[me],void 0!==w){null===w._cacheIndex&&(++w.referenceCount,this._addInactiveBinding(w,Z,Se));continue}w=new vf(Sl.create(m,Se,u&&u._propertyBindings[me].binding.parsedPath),ge.ValueTypeName,ge.getValueSize()),++w.referenceCount,this._addInactiveBinding(w,Z,Se),I[me]=w}G[me].resultBuffer=w.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const m=(t._localRoot||this._root).uuid,g=t._clip.uuid,E=this._actionsByClip[g];this._bindAction(t,E&&E.knownActions[0]),this._addInactiveAction(t,g,m)}const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==E.useCount++&&(this._lendBinding(E),E.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.useCount&&(E.restoreOriginalState(),this._takeBackBinding(E))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const u=t._cacheIndex;return null!==u&&u<this._nActiveActions},_addInactiveAction:function(t,u,m){const g=this._actions,E=this._actionsByClip;let I=E[u];if(void 0===I)I={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,E[u]=I;else{const G=I.knownActions;t._byClipCacheIndex=G.length,G.push(t)}t._cacheIndex=g.length,g.push(t),I.actionByRoot[m]=t},_removeInactiveAction:function(t){const u=this._actions,m=u[u.length-1],g=t._cacheIndex;m._cacheIndex=g,u[g]=m,u.pop(),t._cacheIndex=null;const E=t._clip.uuid,I=this._actionsByClip,G=I[E],Z=G.knownActions,J=Z[Z.length-1],K=t._byClipCacheIndex;J._byClipCacheIndex=K,Z[K]=J,Z.pop(),t._byClipCacheIndex=null,delete G.actionByRoot[(t._localRoot||this._root).uuid],0===Z.length&&delete I[E],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.referenceCount&&this._removeInactiveBinding(E)}},_lendAction:function(t){const u=this._actions,m=t._cacheIndex,g=this._nActiveActions++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackAction:function(t){const u=this._actions,m=t._cacheIndex,g=--this._nActiveActions,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_addInactiveBinding:function(t,u,m){const g=this._bindingsByRootAndName,E=this._bindings;let I=g[u];void 0===I&&(I={},g[u]=I),I[m]=t,t._cacheIndex=E.length,E.push(t)},_removeInactiveBinding:function(t){const u=this._bindings,m=t.binding,g=m.rootNode.uuid,E=m.path,I=this._bindingsByRootAndName,G=I[g],Z=u[u.length-1],J=t._cacheIndex;Z._cacheIndex=J,u[J]=Z,u.pop(),delete G[E],0===Object.keys(G).length&&delete I[g]},_lendBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=this._nActiveBindings++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=--this._nActiveBindings,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_lendControlInterpolant:function(){const t=this._controlInterpolants,u=this._nActiveControlInterpolants++;let m=t[u];return void 0===m&&(m=new uu(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),m.__cacheIndex=u,t[u]=m),m},_takeBackControlInterpolant:function(t){const u=this._controlInterpolants,m=t.__cacheIndex,g=--this._nActiveControlInterpolants,E=u[g];t.__cacheIndex=g,u[g]=t,E.__cacheIndex=m,u[m]=E},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,u,m){const g=u||this._root,E=g.uuid;let I="string"==typeof t?ls.findByName(g,t):t;const G=null!==I?I.uuid:t;let Z=this._actionsByClip[G],J=null;if(void 0===m&&(m=null!==I?I.blendMode:eh),void 0!==Z){const me=Z.actionByRoot[E];if(void 0!==me&&me.blendMode===m)return me;J=Z.knownActions[0],null===I&&(I=J._clip)}if(null===I)return null;const K=new Wm(this,I,u,m);return this._bindAction(K,J),this._addInactiveAction(K,G,E),K},existingAction:function(t,u){const m=u||this._root,g=m.uuid,E="string"==typeof t?ls.findByName(m,t):t,G=this._actionsByClip[E?E.uuid:t];return void 0!==G&&G.actionByRoot[g]||null},stopAllAction:function(){const t=this._actions;for(let u=this._nActiveActions-1;u>=0;--u)t[u].stop();return this},update:function(t){const u=this._actions,m=this._nActiveActions,g=this.time+=t*=this.timeScale,E=Math.sign(t),I=this._accuIndex^=1;for(let J=0;J!==m;++J)u[J]._update(g,t,E,I);const G=this._bindings,Z=this._nActiveBindings;for(let J=0;J!==Z;++J)G[J].apply(I);return this},setTime:function(t){this.time=0;for(let u=0;u<this._actions.length;u++)this._actions[u].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const u=this._actions,m=t.uuid,g=this._actionsByClip,E=g[m];if(void 0!==E){const I=E.knownActions;for(let G=0,Z=I.length;G!==Z;++G){const J=I[G];this._deactivateAction(J);const K=J._cacheIndex,me=u[u.length-1];J._cacheIndex=null,J._byClipCacheIndex=null,me._cacheIndex=K,u[K]=me,u.pop(),this._removeInactiveBindingsForAction(J)}delete g[m]}},uncacheRoot:function(t){const u=t.uuid,m=this._actionsByClip;for(const E in m){const I=m[E].actionByRoot[u];void 0!==I&&(this._deactivateAction(I),this._removeInactiveAction(I))}const g=this._bindingsByRootAndName[u];if(void 0!==g)for(const E in g){const I=g[E];I.restoreOriginalState(),this._removeInactiveBinding(I)}},uncacheAction:function(t,u){const m=this.existingAction(t,u);null!==m&&(this._deactivateAction(m),this._removeInactiveAction(m))}}),kf.prototype.clone=function(){return new kf(void 0===this.value.clone?this.value:this.value.clone())},hm.prototype=Object.assign(Object.create(Oa.prototype),{constructor:hm,isInstancedInterleavedBuffer:!0,copy:function(t){return Oa.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const u=Oa.prototype.clone.call(this,t);return u.meshPerAttribute=this.meshPerAttribute,u},toJSON:function(t){const u=Oa.prototype.toJSON.call(this,t);return u.isInstancedInterleavedBuffer=!0,u.meshPerAttribute=this.meshPerAttribute,u}}),Object.assign(pm.prototype,{set:function(t,u){this.ray.set(t,u)},setFromCamera:function(t,u){u&&u.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(u.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(u).sub(this.ray.origin).normalize(),this.camera=u):u&&u.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(u.near+u.far)/(u.near-u.far)).unproject(u),this.ray.direction.set(0,0,-1).transformDirection(u.matrixWorld),this.camera=u):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,u,m){const g=m||[];return dm(t,this,g,u),g.sort(h_),g},intersectObjects:function(t,u,m){const g=m||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(let E=0,I=t.length;E<I;E++)dm(t[E],this,g,u);return g.sort(h_),g}});class p_{constructor(u=1,m=0,g=0){return this.radius=u,this.phi=m,this.theta=g,this}set(u,m,g){return this.radius=u,this.phi=m,this.theta=g,this}clone(){return(new this.constructor).copy(this)}copy(u){return this.radius=u.radius,this.phi=u.phi,this.theta=u.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(u){return this.setFromCartesianCoords(u.x,u.y,u.z)}setFromCartesianCoords(u,m,g){return this.radius=Math.sqrt(u*u+m*m+g*g),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(u,g),this.phi=Math.acos(tr.clamp(m/this.radius,-1,1))),this}}function Td(t,u,m){return this.radius=void 0!==t?t:1,this.theta=void 0!==u?u:0,this.y=void 0!==m?m:0,this}Object.assign(Td.prototype,{set:function(t,u,m){return this.radius=t,this.theta=u,this.y=m,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,u,m){return this.radius=Math.sqrt(t*t+m*m),this.theta=Math.atan2(t,m),this.y=u,this}});const qm=new wn;function Xm(t,u){this.min=void 0!==t?t:new wn(1/0,1/0),this.max=void 0!==u?u:new wn(-1/0,-1/0)}Object.assign(Xm.prototype,{set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=qm.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new wn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new wn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .getParameter() target is now required"),u=new wn),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .clampPoint() target is now required"),u=new wn),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return qm.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const Md=new lt,fm=new lt;function Ff(t,u){this.start=void 0!==t?t:new lt,this.end=void 0!==u?u:new lt}function pp(t){Kn.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(Ff.prototype,{set:function(t,u){return this.start.copy(t),this.end.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new lt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new lt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,u){return void 0===u&&(console.warn("THREE.Line3: .at() target is now required"),u=new lt),this.delta(u).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,u){Md.subVectors(t,this.start),fm.subVectors(this.end,this.start);const m=fm.dot(fm);let g=fm.dot(Md)/m;return u&&(g=tr.clamp(g,0,1)),g},closestPointToPoint:function(t,u,m){const g=this.closestPointToPointParameter(t,u);return void 0===m&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),m=new lt),this.delta(m).multiplyScalar(g).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(pp.prototype=Object.create(Kn.prototype)).constructor=pp,pp.prototype.isImmediateRenderObject=!0;const Ym=new lt;function yf(t,u){Kn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=u;const m=new hn,g=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let I=0,G=1,Z=32;I<Z;I++,G++){const J=I/Z*Math.PI*2,K=G/Z*Math.PI*2;g.push(Math.cos(J),Math.sin(J),1,Math.cos(K),Math.sin(K),1)}m.setAttribute("position",new Un(g,3));const E=new $o({fog:!1,toneMapped:!1});this.cone=new Ii(m,E),this.add(this.cone),this.update()}(yf.prototype=Object.create(Kn.prototype)).constructor=yf,yf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},yf.prototype.update=function(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,u=t*Math.tan(this.light.angle);this.cone.scale.set(u,u,t),Ym.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ym),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const zu=new lt,mm=new ri,_m=new ri;function Jm(t){const u=[];t&&t.isBone&&u.push(t);for(let m=0;m<t.children.length;m++)u.push.apply(u,Jm(t.children[m]));return u}function od(t){const u=Jm(t),m=new hn,g=[],E=[],I=new ar(0,0,1),G=new ar(0,1,0);for(let J=0;J<u.length;J++){const K=u[J];K.parent&&K.parent.isBone&&(g.push(0,0,0),g.push(0,0,0),E.push(I.r,I.g,I.b),E.push(G.r,G.g,G.b))}m.setAttribute("position",new Un(g,3)),m.setAttribute("color",new Un(E,3));const Z=new $o({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Ii.call(this,m,Z),this.type="SkeletonHelper",this.root=t,this.bones=u,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function bf(t,u,m){this.light=t,this.light.updateMatrixWorld(),this.color=m;const g=new Ou(u,4,2),E=new eo({wireframe:!0,fog:!1,toneMapped:!1});Ci.call(this,g,E),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}(od.prototype=Object.create(Ii.prototype)).constructor=od,od.prototype.isSkeletonHelper=!0,od.prototype.updateMatrixWorld=function(t){const u=this.bones,m=this.geometry,g=m.getAttribute("position");_m.getInverse(this.root.matrixWorld);for(let E=0,I=0;E<u.length;E++){const G=u[E];G.parent&&G.parent.isBone&&(mm.multiplyMatrices(_m,G.matrixWorld),zu.setFromMatrixPosition(mm),g.setXYZ(I,zu.x,zu.y,zu.z),mm.multiplyMatrices(_m,G.parent.matrixWorld),zu.setFromMatrixPosition(mm),g.setXYZ(I+1,zu.x,zu.y,zu.z),I+=2)}m.getAttribute("position").needsUpdate=!0,Kn.prototype.updateMatrixWorld.call(this,t)},(bf.prototype=Object.create(Ci.prototype)).constructor=bf,bf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},bf.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const Zm=new lt,d_=new ar,f_=new ar;function xf(t,u,m){Kn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m;const g=new Hs(u);g.rotateY(.5*Math.PI),this.material=new eo({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const E=g.getAttribute("position"),I=new Float32Array(3*E.count);g.setAttribute("color",new Vr(I,3)),this.add(new Ci(g,this.material)),this.update()}function Df(t,u,m,g){t=t||10,u=u||10,m=new ar(void 0!==m?m:4473924),g=new ar(void 0!==g?g:8947848);const E=u/2,I=t/u,G=t/2,Z=[],J=[];for(let ge=0,Se=0,w=-G;ge<=u;ge++,w+=I){Z.push(-G,0,w,G,0,w),Z.push(w,0,-G,w,0,G);const e=ge===E?m:g;e.toArray(J,Se),Se+=3,e.toArray(J,Se),Se+=3,e.toArray(J,Se),Se+=3,e.toArray(J,Se),Se+=3}const K=new hn;K.setAttribute("position",new Un(Z,3)),K.setAttribute("color",new Un(J,3));const me=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,K,me),this.type="GridHelper"}function gm(t,u,m,g,E,I){t=t||10,u=u||16,m=m||8,g=g||64,E=new ar(void 0!==E?E:4473924),I=new ar(void 0!==I?I:8947848);const G=[],Z=[];for(let me=0;me<=u;me++){const ge=me/u*(2*Math.PI),Se=Math.sin(ge)*t,w=Math.cos(ge)*t;G.push(0,0,0),G.push(Se,0,w);const e=1&me?E:I;Z.push(e.r,e.g,e.b),Z.push(e.r,e.g,e.b)}for(let me=0;me<=m;me++){const ge=1&me?E:I,Se=t-t/m*me;for(let w=0;w<g;w++){let e=w/g*(2*Math.PI),c=Math.sin(e)*Se,d=Math.cos(e)*Se;G.push(c,0,d),Z.push(ge.r,ge.g,ge.b),e=(w+1)/g*(2*Math.PI),c=Math.sin(e)*Se,d=Math.cos(e)*Se,G.push(c,0,d),Z.push(ge.r,ge.g,ge.b)}}const J=new hn;J.setAttribute("position",new Un(G,3)),J.setAttribute("color",new Un(Z,3));const K=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,J,K),this.type="PolarGridHelper"}(xf.prototype=Object.create(Kn.prototype)).constructor=xf,xf.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},xf.prototype.update=function(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const u=t.geometry.getAttribute("color");d_.copy(this.light.color),f_.copy(this.light.groundColor);for(let m=0,g=u.count;m<g;m++){const E=m<g/2?d_:f_;u.setXYZ(m,E.r,E.g,E.b)}u.needsUpdate=!0}t.lookAt(Zm.setFromMatrixPosition(this.light.matrixWorld).negate())},(Df.prototype=Object.create(Ii.prototype)).constructor=Df,(gm.prototype=Object.create(Ii.prototype)).constructor=gm;const m_=new lt,vm=new lt,mo=new lt;function Qd(t,u,m){Kn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,void 0===u&&(u=1);let g=new hn;g.setAttribute("position",new Un([-u,u,0,u,u,0,u,-u,0,-u,-u,0,-u,u,0],3));const E=new $o({fog:!1,toneMapped:!1});this.lightPlane=new Gs(g,E),this.add(this.lightPlane),g=new hn,g.setAttribute("position",new Un([0,0,0,0,0,1],3)),this.targetLine=new Gs(g,E),this.add(this.targetLine),this.update()}(Qd.prototype=Object.create(Kn.prototype)).constructor=Qd,Qd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Qd.prototype.update=function(){m_.setFromMatrixPosition(this.light.matrixWorld),vm.setFromMatrixPosition(this.light.target.matrixWorld),mo.subVectors(vm,m_),this.lightPlane.lookAt(vm),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vm),this.targetLine.scale.z=mo.length()};const ym=new lt,sa=new Ai;function Ad(t){const u=new hn,m=new $o({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],E=[],I={},G=new ar(16755200),Z=new ar(16711680),J=new ar(43775),K=new ar(16777215),me=new ar(3355443);function ge(w,e,c){Se(w,c),Se(e,c)}function Se(w,e){g.push(0,0,0),E.push(e.r,e.g,e.b),void 0===I[w]&&(I[w]=[]),I[w].push(g.length/3-1)}ge("n1","n2",G),ge("n2","n4",G),ge("n4","n3",G),ge("n3","n1",G),ge("f1","f2",G),ge("f2","f4",G),ge("f4","f3",G),ge("f3","f1",G),ge("n1","f1",G),ge("n2","f2",G),ge("n3","f3",G),ge("n4","f4",G),ge("p","n1",Z),ge("p","n2",Z),ge("p","n3",Z),ge("p","n4",Z),ge("u1","u2",J),ge("u2","u3",J),ge("u3","u1",J),ge("c","t",K),ge("p","c",me),ge("cn1","cn2",me),ge("cn3","cn4",me),ge("cf1","cf2",me),ge("cf3","cf4",me),u.setAttribute("position",new Un(g,3)),u.setAttribute("color",new Un(E,3)),Ii.call(this,u,m),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=I,this.update()}function Ma(t,u,m,g,E,I,G){ym.set(E,I,G).unproject(g);const Z=u[t];if(void 0!==Z){const J=m.getAttribute("position");for(let K=0,me=Z.length;K<me;K++)J.setXYZ(Z[K],ym.x,ym.y,ym.z)}}(Ad.prototype=Object.create(Ii.prototype)).constructor=Ad,Ad.prototype.update=function(){const t=this.geometry,u=this.pointMap;sa.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ma("c",u,t,sa,0,0,-1),Ma("t",u,t,sa,0,0,1),Ma("n1",u,t,sa,-1,-1,-1),Ma("n2",u,t,sa,1,-1,-1),Ma("n3",u,t,sa,-1,1,-1),Ma("n4",u,t,sa,1,1,-1),Ma("f1",u,t,sa,-1,-1,1),Ma("f2",u,t,sa,1,-1,1),Ma("f3",u,t,sa,-1,1,1),Ma("f4",u,t,sa,1,1,1),Ma("u1",u,t,sa,.7,1.1,-1),Ma("u2",u,t,sa,-.7,1.1,-1),Ma("u3",u,t,sa,0,2,-1),Ma("cf1",u,t,sa,-1,0,1),Ma("cf2",u,t,sa,1,0,1),Ma("cf3",u,t,sa,0,-1,1),Ma("cf4",u,t,sa,0,1,1),Ma("cn1",u,t,sa,-1,0,-1),Ma("cn2",u,t,sa,1,0,-1),Ma("cn3",u,t,sa,0,-1,-1),Ma("cn4",u,t,sa,0,1,-1),t.getAttribute("position").needsUpdate=!0};const Uf=new fn;function $d(t,u){this.object=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(24),E=new hn;E.setIndex(new Vr(m,1)),E.setAttribute("position",new Vr(g,3)),Ii.call(this,E,new $o({color:u,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function wf(t,u){this.type="Box3Helper",this.box=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new hn;g.setIndex(new Vr(m,1)),g.setAttribute("position",new Un([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ii.call(this,g,new $o({color:u,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Kd(t,u,m){this.plane=t,this.size=void 0===u?1:u;const g=void 0!==m?m:16776960,E=new hn;E.setAttribute("position",new Un([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),E.computeBoundingSphere(),Gs.call(this,E,new $o({color:g,toneMapped:!1})),this.type="PlaneHelper";const I=new hn;I.setAttribute("position",new Un([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),I.computeBoundingSphere(),this.add(new Ci(I,new eo({color:g,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}($d.prototype=Object.create(Ii.prototype)).constructor=$d,$d.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Uf.setFromObject(this.object),Uf.isEmpty())return;const u=Uf.min,m=Uf.max,g=this.geometry.attributes.position,E=g.array;E[0]=m.x,E[1]=m.y,E[2]=m.z,E[3]=u.x,E[4]=m.y,E[5]=m.z,E[6]=u.x,E[7]=u.y,E[8]=m.z,E[9]=m.x,E[10]=u.y,E[11]=m.z,E[12]=m.x,E[13]=m.y,E[14]=u.z,E[15]=u.x,E[16]=m.y,E[17]=u.z,E[18]=u.x,E[19]=u.y,E[20]=u.z,E[21]=m.x,E[22]=u.y,E[23]=u.z,g.needsUpdate=!0,this.geometry.computeBoundingSphere()},$d.prototype.setFromObject=function(t){return this.object=t,this.update(),this},$d.prototype.copy=function(t){return Ii.prototype.copy.call(this,t),this.object=t.object,this},(wf.prototype=Object.create(Ii.prototype)).constructor=wf,wf.prototype.updateMatrixWorld=function(t){const u=this.box;u.isEmpty()||(u.getCenter(this.position),u.getSize(this.scale),this.scale.multiplyScalar(.5),Kn.prototype.updateMatrixWorld.call(this,t))},(Kd.prototype=Object.create(Gs.prototype)).constructor=Kd,Kd.prototype.updateMatrixWorld=function(t){let u=-this.plane.constant;Math.abs(u)<1e-8&&(u=1e-8),this.scale.set(.5*this.size,.5*this.size,u),this.children[0].material.side=u<0?q:le,this.lookAt(this.plane.normal),Kn.prototype.updateMatrixWorld.call(this,t)};const __=new lt;let bm,xm;function mh(t,u,m,g,E,I){Kn.call(this),this.type="ArrowHelper",void 0===t&&(t=new lt(0,0,1)),void 0===u&&(u=new lt(0,0,0)),void 0===m&&(m=1),void 0===g&&(g=16776960),void 0===E&&(E=.2*m),void 0===I&&(I=.2*E),void 0===bm&&(bm=new hn,bm.setAttribute("position",new Un([0,0,0,0,1,0],3)),xm=new Do(0,.5,1,5,1),xm.translate(0,-.5,0)),this.position.copy(u),this.line=new Gs(bm,new $o({color:g,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ci(xm,new eo({color:g,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(m,E,I)}function Sf(t){const u=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],m=new hn;m.setAttribute("position",new Un(u,3)),m.setAttribute("color",new Un([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const g=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,m,g),this.type="AxesHelper"}(mh.prototype=Object.create(Kn.prototype)).constructor=mh,mh.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{__.set(t.z,0,-t.x).normalize();const u=Math.acos(t.y);this.quaternion.setFromAxisAngle(__,u)}},mh.prototype.setLength=function(t,u,m){void 0===u&&(u=.2*t),void 0===m&&(m=.2*u),this.line.scale.set(1,Math.max(1e-4,t-u),1),this.line.updateMatrix(),this.cone.scale.set(m,u,m),this.cone.position.y=t,this.cone.updateMatrix()},mh.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},mh.prototype.copy=function(t){return Kn.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},(Sf.prototype=Object.create(Ii.prototype)).constructor=Sf;const _h=Math.pow(2,8),Qm=[.125,.215,.35,.446,.526,.582],Km=5+Qm.length,ef=20,zp={[Zi]:0,[hl]:1,[Yc]:2,[xc]:3,[nh]:4,[vu]:5,[Ql]:6},jp=new It,{_lodPlanes:Cd,_sizeLods:wm,_sigmas:zf}=function(){const t=[],u=[],m=[];let g=8;for(let E=0;E<Km;E++){const I=Math.pow(2,g);u.push(I);let G=1/I;E>4?G=Qm[E-8+4-1]:0==E&&(G=0),m.push(G);const Z=1/(I-1),J=-Z/2,K=1+Z/2,me=[J,J,K,J,K,K,J,J,K,K,J,K],ge=6,Se=6,w=3,e=2,c=1,d=new Float32Array(w*Se*ge),_=new Float32Array(e*Se*ge),S=new Float32Array(c*Se*ge);for(let k=0;k<ge;k++){const F=k%3*2/3-1,V=k>2?0:-1;d.set([F,V,0,F+2/3,V,0,F+2/3,V+1,0,F,V,0,F+2/3,V+1,0,F,V+1,0],w*Se*k),_.set(me,e*Se*k),S.set([k,k,k,k,k,k],c*Se*k)}const B=new hn;B.setAttribute("position",new Vr(d,w)),B.setAttribute("uv",new Vr(_,e)),B.setAttribute("faceIndex",new Vr(S,c)),t.push(B),g>4&&g--}return{_lodPlanes:t,_sizeLods:u,_sigmas:m}}();let Sm=null;const tf=(1+Math.sqrt(5))/2,Ef=1/tf,e_=[new lt(1,1,1),new lt(-1,1,1),new lt(1,1,-1),new lt(-1,1,-1),new lt(0,tf,Ef),new lt(0,tf,-Ef),new lt(Ef,0,tf),new lt(-Ef,0,tf),new lt(tf,Ef,0),new lt(-tf,Ef,0)];function Em(t){var u;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new oa({name:"SphericalGaussianBlur",defines:{n:u=ef},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(u)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new lt(0,1,0)},inputEncoding:{value:zp[Zi]},outputEncoding:{value:zp[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function M_(t){return void 0!==t&&t.type===ha&&(t.encoding===Zi||t.encoding===hl||t.encoding===Ql)}function t_(t){const u=new Us(3*_h,3*_h,t);return u.texture.mapping=Ni,u.texture.name="PMREM.cubeUv",u.scissorTest=!0,u}function Tm(t,u,m,g,E){t.viewport.set(u,m,g,E),t.scissor.set(u,m,g,E)}function n_(){return new oa({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new wn(1,1)},inputEncoding:{value:zp[Zi]},outputEncoding:{value:zp[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function jf(){return new oa({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:zp[Zi]},outputEncoding:{value:zp[Zi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function g_(t,u,m,g,E,I,G){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ga(t,u,m,E,I,G)}Em.prototype={constructor:Em,fromScene:function(t,u=0,m=.1,g=100){Sm=this._renderer.getRenderTarget();const E=this._allocateTargets();return this._sceneToCubeUV(t,m,g,E),u>0&&this._blur(E,0,0,u),this._applyPMREM(E),this._cleanup(E),E},fromEquirectangular:function(t){return this._fromTexture(t)},fromCubemap:function(t){return this._fromTexture(t)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=jf(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=n_(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<Cd.length;t++)Cd[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Sm),t.scissorTest=!1,Tm(t,0,0,t.width,t.height)},_fromTexture:function(t){Sm=this._renderer.getRenderTarget();const u=this._allocateTargets(t);return this._textureToCubeUV(t,u),this._applyPMREM(u),this._cleanup(u),u},_allocateTargets:function(t){const u={magFilter:Ir,minFilter:Ir,generateMipmaps:!1,type:ha,format:vh,encoding:M_(t)?t.encoding:Yc,depthBuffer:!1,stencilBuffer:!1},m=t_(u);return m.depthBuffer=!t,this._pingPongRenderTarget=t_(u),m},_compileMaterial:function(t){const u=new Ci(Cd[0],t);this._renderer.compile(u,jp)},_sceneToCubeUV:function(t,u,m,g){const E=new Rs(90,1,u,m),I=[1,-1,1,1,1,1],G=[1,1,1,-1,-1,-1],Z=this._renderer,J=Z.outputEncoding,K=Z.toneMapping,me=Z.getClearColor(),ge=Z.getClearAlpha();Z.toneMapping=vr,Z.outputEncoding=Zi;let Se=t.background;if(Se&&Se.isColor){Se.convertSRGBToLinear();const w=Math.max(Se.r,Se.g,Se.b),e=Math.min(Math.max(Math.ceil(Math.log2(w)),-128),127);Se=Se.multiplyScalar(Math.pow(2,-e)),Z.setClearColor(Se,(e+128)/255),t.background=null}for(let w=0;w<6;w++){const e=w%3;0==e?(E.up.set(0,I[w],0),E.lookAt(G[w],0,0)):1==e?(E.up.set(0,0,I[w]),E.lookAt(0,G[w],0)):(E.up.set(0,I[w],0),E.lookAt(0,0,G[w])),Tm(g,e*_h,w>2?_h:0,_h,_h),Z.setRenderTarget(g),Z.render(t,E)}Z.toneMapping=K,Z.outputEncoding=J,Z.setClearColor(me,ge)},_textureToCubeUV:function(t,u){const m=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=jf()):null==this._equirectShader&&(this._equirectShader=n_());const g=t.isCubeTexture?this._cubemapShader:this._equirectShader,E=new Ci(Cd[0],g),I=g.uniforms;I.envMap.value=t,t.isCubeTexture||I.texelSize.value.set(1/t.image.width,1/t.image.height),I.inputEncoding.value=zp[t.encoding],I.outputEncoding.value=zp[u.texture.encoding],Tm(u,0,0,3*_h,2*_h),m.setRenderTarget(u),m.render(E,jp)},_applyPMREM:function(t){const u=this._renderer,m=u.autoClear;u.autoClear=!1;for(let g=1;g<Km;g++){const E=Math.sqrt(zf[g]*zf[g]-zf[g-1]*zf[g-1]);this._blur(t,g-1,g,E,e_[(g-1)%e_.length])}u.autoClear=m},_blur:function(t,u,m,g,E){const I=this._pingPongRenderTarget;this._halfBlur(t,I,u,m,g,"latitudinal",E),this._halfBlur(I,t,m,m,g,"longitudinal",E)},_halfBlur:function(t,u,m,g,E,I,G){const Z=this._renderer,J=this._blurMaterial;"latitudinal"!==I&&"longitudinal"!==I&&console.error("blur direction must be either latitudinal or longitudinal!");const K=new Ci(Cd[g],J),me=J.uniforms,ge=wm[m]-1,Se=isFinite(E)?Math.PI/(2*ge):2*Math.PI/(2*ef-1),w=E/Se,e=isFinite(E)?1+Math.floor(3*w):ef;e>ef&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${e} samples when the maximum is set to ${ef}`);const c=[];let d=0;for(let S=0;S<ef;++S){const B=S/w,k=Math.exp(-B*B/2);c.push(k),0==S?d+=k:S<e&&(d+=2*k)}for(let S=0;S<c.length;S++)c[S]=c[S]/d;me.envMap.value=t.texture,me.samples.value=e,me.weights.value=c,me.latitudinal.value="latitudinal"===I,G&&(me.poleAxis.value=G),me.dTheta.value=Se,me.mipInt.value=8-m,me.inputEncoding.value=zp[t.texture.encoding],me.outputEncoding.value=zp[t.texture.encoding];const _=wm[g];Tm(u,3*Math.max(0,_h-2*_),(0===g?0:2*_h)+2*_*(g>4?g-8+4:0),3*_,2*_),Z.setRenderTarget(u),Z.render(K,jp)}};const A_=0,Mm=1,Aa=0,$_=1,Ha=2;function Am(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function v_(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function C_(t,u){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new kc(t,u)}function L_(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new nl(t)}function y_(t,u){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new kc(t,u)}function $m(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function r_(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function B_(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function b_(t,u,m){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new lt(t,u,m)}function x_(t,u){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Vr(t,u).setUsage(Br)}function N_(t,u){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dl(t,u)}function R_(t,u){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Cc(t,u)}function P_(t,u){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ih(t,u)}function I_(t,u){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Zh(t,u)}function O_(t,u){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Bl(t,u)}function k_(t,u){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new er(t,u)}function F_(t,u){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new fl(t,u)}function D_(t,u){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Un(t,u)}function U_(t,u){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Nl(t,u)}function w_(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom",this.closed=!0}function S_(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom"}function i_(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom"}function z_(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Sf(t)}function j_(t,u){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new $d(t,u)}function G_(t,u){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ii(new Rh(t.geometry),new $o({color:void 0!==u?u:16777215}))}function H_(t,u){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ii(new hc(t.geometry),new $o({color:void 0!==u?u:16777215}))}function V_(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Es(t)}function W_(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ja(t)}function q_(t,u,m){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Pl(t,m)}xr.create=function(t,u){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(xr.prototype),t.prototype.constructor=t,t.prototype.getPoint=u,t},Object.assign(Fe.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getPoints(t);return this.createGeometry(u)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getSpacedPoints(t);return this.createGeometry(u)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=new Fr;for(let m=0,g=t.length;m<g;m++){const E=t[m];u.vertices.push(new lt(E.x,E.y,E.z||0))}return u}}),Object.assign(je.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),w_.prototype=Object.create(O.prototype),S_.prototype=Object.create(O.prototype),i_.prototype=Object.create(O.prototype),Object.assign(i_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Df.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},od.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ti.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),lr.extractUrlBase(t)}}),Ti.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Or.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Xm.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(fn.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Gn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),eu.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Ff.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(tr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),tr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),tr.ceilPowerOfTwo(t)}}),Object.assign(Ho.prototype,{flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ri.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new lt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,u,m,g,E,I){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,u,g,m,E,I)}}),Yo.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},yo.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(co.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Pr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,u)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Pr,{barycoordFromPoint:function(t,u,m,g,E){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Pr.getBarycoord(t,u,m,g,E)},normal:function(t,u,m,g){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Pr.getNormal(t,u,m,g)}}),Object.assign(Ue.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new su(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new cu(this,t)}}),Object.assign(wn.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(lt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,u){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(u,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,u,m){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xi.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Kn.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,u){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(u,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Kn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Ci.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Ci.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Vh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Op.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(mf.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),ff.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(xr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Rs.prototype.setLens=function(t,u){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==u&&(this.filmGauge=u),this.setFocalLength(t)},Object.defineProperties(Je.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Vr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Br},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Br)}}}),Object.assign(Vr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Br:bi),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(hn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,u){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),u&&u.isBufferAttribute||u&&u.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(u),this):this.setAttribute(t,u):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Vr(arguments[1],arguments[2])))},addDrawCall:function(t,u,m){void 0!==m&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,u)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(hn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(jn.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(pm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Oa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Br},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Oa.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Br:bi),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(rl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(kf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(zr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ar}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Ko.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(so.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(uo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(_d.prototype,{clearTarget:function(t,u,m,g){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(u,m,g)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(_d.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?hl:Zi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(sc.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Us.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Jd.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const u=this;return(new ap).load(t,function(m){u.setBuffer(m)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),lm.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Po.prototype.updateCubeMap=function(t,u){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,u)};const X_={merge:function(t,u,m){let g;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),u.isMesh&&(u.matrixAutoUpdate&&u.updateMatrix(),g=u.matrix,u=u.geometry),t.merge(u,g,m)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function Y_(){console.error("THREE.CanvasRenderer has been removed")}function J_(){console.error("THREE.JSONLoader has been removed.")}Qi.crossOrigin=void 0,Qi.loadTexture=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const E=new vi;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Qi.loadTextureCube=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const E=new sp;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Qi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Qi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Z_={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Q_(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}}))},759:(n,o,l)=>{"use strict";l.d(o,{U:()=>x}),n=l.hmd(n),function(L){"object"==typeof exports?n.exports=L():"function"==typeof define&&l.amdO?define([],L):(typeof window<"u"?window:void 0!==l.g?l.g:typeof self<"u"?self:this).opentype=L()}(function(){return function L(D,z,M){function P(he,ae){if(!z[he]){if(!D[he]){if(de)return de(he,!0);var fe=new Error("Cannot find module '"+he+"'");throw fe.code="MODULE_NOT_FOUND",fe}var le=z[he]={exports:{}};D[he][0].call(le.exports,function(q){return P(D[he][1][q]||q)},le,le.exports,L,D,z,M)}return z[he].exports}for(var de=void 0,ye=0;ye<M.length;ye++)P(M[ye]);return P}({1:[function(L,D,z){function M(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function P(Ke,yt){this.source=Ke,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=yt,this.destLen=0,this.ltree=new M,this.dtree=new M}function de(Ke,yt,dt,Pt){var wt,Gt;for(wt=0;dt>wt;++wt)Ke[wt]=0;for(wt=0;30-dt>wt;++wt)Ke[wt+dt]=wt/dt|0;for(Gt=Pt,wt=0;30>wt;++wt)yt[wt]=Gt,Gt+=1<<Ke[wt]}function ye(Ke,yt,dt,Pt){var wt,Gt;for(wt=0;16>wt;++wt)Ke.table[wt]=0;for(wt=0;Pt>wt;++wt)Ke.table[yt[dt+wt]]++;for(Ke.table[0]=0,Gt=0,wt=0;16>wt;++wt)Xe[wt]=Gt,Gt+=Ke.table[wt];for(wt=0;Pt>wt;++wt)yt[dt+wt]&&(Ke.trans[Xe[yt[dt+wt]]++]=wt)}function he(Ke){Ke.bitcount--||(Ke.tag=Ke.source[Ke.sourceIndex++],Ke.bitcount=7);var yt=1&Ke.tag;return Ke.tag>>>=1,yt}function ae(Ke,yt,dt){if(!yt)return dt;for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var Pt=Ke.tag&65535>>>16-yt;return Ke.tag>>>=yt,Ke.bitcount-=yt,Pt+dt}function fe(Ke,yt){for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var dt=0,Pt=0,wt=0,Gt=Ke.tag;do{Pt=2*Pt+(1&Gt),Gt>>>=1,++wt,dt+=yt.table[wt],Pt-=yt.table[wt]}while(Pt>=0);return Ke.tag=Gt,Ke.bitcount-=wt,yt.trans[dt+Pt]}function le(Ke,yt,dt){var Pt,wt,Gt,Dt,sn,gt;for(Pt=ae(Ke,5,257),wt=ae(Ke,5,1),Gt=ae(Ke,4,4),Dt=0;19>Dt;++Dt)Ae[Dt]=0;for(Dt=0;Gt>Dt;++Dt){var Mn=ae(Ke,3,0);Ae[Pe[Dt]]=Mn}for(ye(Ge,Ae,0,19),sn=0;Pt+wt>sn;){var Bn=fe(Ke,Ge);switch(Bn){case 16:var dn=Ae[sn-1];for(gt=ae(Ke,2,3);gt;--gt)Ae[sn++]=dn;break;case 17:for(gt=ae(Ke,3,3);gt;--gt)Ae[sn++]=0;break;case 18:for(gt=ae(Ke,7,11);gt;--gt)Ae[sn++]=0;break;default:Ae[sn++]=Bn}}ye(yt,Ae,0,Pt),ye(dt,Ae,Pt,wt)}function q(Ke,yt,dt){for(;;){var Pt,wt,Gt,Dt,sn=fe(Ke,yt);if(256===sn)return A;if(256>sn)Ke.dest[Ke.destLen++]=sn;else for(Pt=ae(Ke,H[sn-=257],Ce[sn]),wt=fe(Ke,dt),Dt=Gt=Ke.destLen-ae(Ke,Q[wt],xe[wt]);Gt+Pt>Dt;++Dt)Ke.dest[Ke.destLen++]=Ke.dest[Dt]}}function Y(Ke){for(var yt,dt;Ke.bitcount>8;)Ke.sourceIndex--,Ke.bitcount-=8;if((yt=256*(yt=Ke.source[Ke.sourceIndex+1])+Ke.source[Ke.sourceIndex])!==(65535&~(256*Ke.source[Ke.sourceIndex+3]+Ke.source[Ke.sourceIndex+2])))return N;for(Ke.sourceIndex+=4,dt=yt;dt;--dt)Ke.dest[Ke.destLen++]=Ke.source[Ke.sourceIndex++];return Ke.bitcount=0,A}var A=0,N=-3,X=new M,oe=new M,H=new Uint8Array(30),Ce=new Uint16Array(30),Q=new Uint8Array(30),xe=new Uint16Array(30),Pe=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ge=new M,Ae=new Uint8Array(320),Xe=new Uint16Array(16);(function(Ke,yt){var dt;for(dt=0;7>dt;++dt)Ke.table[dt]=0;for(Ke.table[7]=24,Ke.table[8]=152,Ke.table[9]=112,dt=0;24>dt;++dt)Ke.trans[dt]=256+dt;for(dt=0;144>dt;++dt)Ke.trans[24+dt]=dt;for(dt=0;8>dt;++dt)Ke.trans[168+dt]=280+dt;for(dt=0;112>dt;++dt)Ke.trans[176+dt]=144+dt;for(dt=0;5>dt;++dt)yt.table[dt]=0;for(yt.table[5]=32,dt=0;32>dt;++dt)yt.trans[dt]=dt})(X,oe),de(H,Ce,4,3),de(Q,xe,2,1),H[28]=0,Ce[28]=258,D.exports=function(Ke,yt){var dt,Pt,wt=new P(Ke,yt);do{switch(dt=he(wt),ae(wt,2,0)){case 0:Pt=Y(wt);break;case 1:Pt=q(wt,X,oe);break;case 2:le(wt,wt.ltree,wt.dtree),Pt=q(wt,wt.ltree,wt.dtree);break;default:Pt=N}if(Pt!==A)throw new Error("Data error")}while(!dt);return wt.destLen<wt.dest.length?"function"==typeof wt.dest.slice?wt.dest.slice(0,wt.destLen):wt.dest.subarray(0,wt.destLen):wt.dest}},{}],2:[function(L,D,z){z.fail=function(M){throw new Error(M)},z.argument=function(M,P){M||z.fail(P)},z.assert=z.argument},{}],3:[function(L,D,z){z.line=function(M,P,de,ye,he){M.beginPath(),M.moveTo(P,de),M.lineTo(ye,he),M.stroke()}},{}],4:[function(L,D,z){function M(he){this.font=he}function P(he){this.cmap=he}function de(he,ae){this.encoding=he,this.charset=ae}function ye(he){var ae;switch(he.version){case 1:this.names=z.standardNames.slice();break;case 2:for(this.names=new Array(he.numberOfGlyphs),ae=0;ae<he.numberOfGlyphs;ae++)this.names[ae]=he.glyphNameIndex[ae]<z.standardNames.length?z.standardNames[he.glyphNameIndex[ae]]:he.names[he.glyphNameIndex[ae]-z.standardNames.length];break;case 2.5:for(this.names=new Array(he.numberOfGlyphs),ae=0;ae<he.numberOfGlyphs;ae++)this.names[ae]=z.standardNames[ae+he.glyphNameIndex[ae]];break;case 3:this.names=[]}}M.prototype.charToGlyphIndex=function(he){var ae=he.charCodeAt(0),fe=this.font.glyphs;if(!fe)return null;for(var le=0;le<fe.length;le+=1)for(var q=fe.get(le),Y=0;Y<q.unicodes.length;Y+=1)if(q.unicodes[Y]===ae)return le},P.prototype.charToGlyphIndex=function(he){return this.cmap.glyphIndexMap[he.charCodeAt(0)]||0},de.prototype.charToGlyphIndex=function(he){var ae=he.charCodeAt(0);return this.charset.indexOf(this.encoding[ae])},ye.prototype.nameToGlyphIndex=function(he){return this.names.indexOf(he)},ye.prototype.glyphIndexToName=function(he){return this.names[he]},z.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],z.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],z.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],z.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],z.DefaultEncoding=M,z.CmapEncoding=P,z.CffEncoding=de,z.GlyphNames=ye,z.addGlyphNames=function(he){for(var ae,fe=he.tables.cmap.glyphIndexMap,le=Object.keys(fe),q=0;q<le.length;q+=1){var Y=le[q];(ae=he.glyphs.get(fe[Y])).addUnicode(parseInt(Y))}for(q=0;q<he.glyphs.length;q+=1)ae=he.glyphs.get(q),he.cffEncoding?ae.name=he.cffEncoding.charset[q]:he.glyphNames.names&&(ae.name=he.glyphNames.glyphIndexToName(q))}},{}],5:[function(L,D,z){function M(le){(le=le||{}).empty||(fe.checkArgument(le.familyName,"When creating a new Font object, familyName is required."),fe.checkArgument(le.styleName,"When creating a new Font object, styleName is required."),fe.checkArgument(le.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),fe.checkArgument(le.ascender,"When creating a new Font object, ascender is required."),fe.checkArgument(le.descender,"When creating a new Font object, descender is required."),fe.checkArgument(le.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:le.familyName||" "},fontSubfamily:{en:le.styleName||" "},fullName:{en:le.fullName||le.familyName+" "+le.styleName},postScriptName:{en:le.postScriptName||le.familyName+le.styleName},designer:{en:le.designer||" "},designerURL:{en:le.designerURL||" "},manufacturer:{en:le.manufacturer||" "},manufacturerURL:{en:le.manufacturerURL||" "},license:{en:le.license||" "},licenseURL:{en:le.licenseURL||" "},version:{en:le.version||"Version 0.1"},description:{en:le.description||" "},copyright:{en:le.copyright||" "},trademark:{en:le.trademark||" "}},this.unitsPerEm=le.unitsPerEm||1e3,this.ascender=le.ascender,this.descender=le.descender,this.createdTimestamp=le.createdTimestamp,this.tables={os2:{usWeightClass:le.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:le.widthClass||this.usWidthClasses.MEDIUM,fsSelection:le.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new he.GlyphSet(this,le.glyphs||[]),this.encoding=new ye.DefaultEncoding(this),this.substitution=new ae(this),this.tables=this.tables||{}}var P=L("./path"),de=L("./tables/sfnt"),ye=L("./encoding"),he=L("./glyphset"),ae=L("./substitution"),fe=L("./util");M.prototype.hasChar=function(le){return null!==this.encoding.charToGlyphIndex(le)},M.prototype.charToGlyphIndex=function(le){return this.encoding.charToGlyphIndex(le)},M.prototype.charToGlyph=function(le){var q=this.charToGlyphIndex(le),Y=this.glyphs.get(q);return Y||(Y=this.glyphs.get(0)),Y},M.prototype.stringToGlyphs=function(le){for(var q=[],Y=0;Y<le.length;Y+=1)q.push(this.charToGlyph(le[Y]));return q},M.prototype.nameToGlyphIndex=function(le){return this.glyphNames.nameToGlyphIndex(le)},M.prototype.nameToGlyph=function(le){var q=this.nametoGlyphIndex(le),Y=this.glyphs.get(q);return Y||(Y=this.glyphs.get(0)),Y},M.prototype.glyphIndexToName=function(le){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(le):""},M.prototype.getKerningValue=function(le,q){le=le.index||le,q=q.index||q;var Y=this.getGposKerningValue;return Y?Y(le,q):this.kerningPairs[le+","+q]||0},M.prototype.forEachGlyph=function(le,q,Y,A,N,X){q=void 0!==q?q:0,Y=void 0!==Y?Y:0;for(var oe=void 0===(N=N||{}).kerning||N.kerning,H=1/this.unitsPerEm*(A=void 0!==A?A:72),Ce=this.stringToGlyphs(le),Q=0;Q<Ce.length;Q+=1){var xe=Ce[Q];X(xe,q,Y,A,N),xe.advanceWidth&&(q+=xe.advanceWidth*H),oe&&Q<Ce.length-1&&(q+=this.getKerningValue(xe,Ce[Q+1])*H)}},M.prototype.getPath=function(le,q,Y,A,N){var X=new P.Path;return this.forEachGlyph(le,q,Y,A,N,function(oe,H,Ce,Q){var xe=oe.getPath(H,Ce,Q);X.extend(xe)}),X},M.prototype.getPaths=function(le,q,Y,A,N){var X=[];return this.forEachGlyph(le,q,Y,A,N,function(oe,H,Ce,Q){var xe=oe.getPath(H,Ce,Q);X.push(xe)}),X},M.prototype.draw=function(le,q,Y,A,N,X){this.getPath(q,Y,A,N,X).draw(le)},M.prototype.drawPoints=function(le,q,Y,A,N,X){this.forEachGlyph(q,Y,A,N,X,function(oe,H,Ce,Q){oe.drawPoints(le,H,Ce,Q)})},M.prototype.drawMetrics=function(le,q,Y,A,N,X){this.forEachGlyph(q,Y,A,N,X,function(oe,H,Ce,Q){oe.drawMetrics(le,H,Ce,Q)})},M.prototype.getEnglishName=function(le){var q=this.names[le];return q?q.en:void 0},M.prototype.validate=function(){function le(N,X){N||Y.push(X)}function q(N){var X=A.getEnglishName(N);le(X&&X.trim().length>0,"No English "+N+" specified.")}var Y=[],A=this;q("fontFamily"),q("weightName"),q("manufacturer"),q("copyright"),q("version"),le(this.unitsPerEm>0,"No unitsPerEm specified.")},M.prototype.toTables=function(){return de.fontToTable(this)},M.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},M.prototype.toArrayBuffer=function(){for(var le=this.toTables().encode(),q=new ArrayBuffer(le.length),Y=new Uint8Array(q),A=0;A<le.length;A++)Y[A]=le[A];return q},M.prototype.download=function(){var le=this.getEnglishName("fontFamily"),q=this.getEnglishName("fontSubfamily"),Y=le.replace(/\s/g,"")+"-"+q+".otf",A=this.toArrayBuffer();if(fe.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,A.byteLength,function(oe){oe.root.getFile(Y,{create:!0},function(H){H.createWriter(function(Ce){var Q=new DataView(A),xe=new Blob([Q],{type:"font/opentype"});Ce.write(xe),Ce.addEventListener("writeend",function(){location.href=H.toURL()},!1)})})},function(oe){throw new Error(oe.name+": "+oe.message)});else{var N=L("fs"),X=fe.arrayBufferToNodeBuffer(A);N.writeFileSync(Y,X)}},M.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},M.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},M.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},z.Font=M},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(L,D,z){function M(he){this.bindConstructorValues(he)}var P=L("./check"),de=L("./draw"),ye=L("./path");M.prototype.bindConstructorValues=function(he){var fe;this.index=he.index||0,this.name=he.name||null,this.unicode=he.unicode||void 0,this.unicodes=he.unicodes||void 0!==he.unicode?[he.unicode]:[],he.xMin&&(this.xMin=he.xMin),he.yMin&&(this.yMin=he.yMin),he.xMax&&(this.xMax=he.xMax),he.yMax&&(this.yMax=he.yMax),he.advanceWidth&&(this.advanceWidth=he.advanceWidth),Object.defineProperty(this,"path",(fe=he.path||{commands:[]},{configurable:!0,get:function(){return"function"==typeof fe&&(fe=fe()),fe},set:function(le){fe=le}}))},M.prototype.addUnicode=function(he){0===this.unicodes.length&&(this.unicode=he),this.unicodes.push(he)},M.prototype.getPath=function(he,ae,fe,le){he=void 0!==he?he:0,ae=void 0!==ae?ae:0;for(var q=1/this.path.unitsPerEm*(fe=void 0!==fe?fe:72),Y=(le=void 0!==le?le:{xScale:1,yScale:1}).xScale*q,A=le.yScale*q,N=new ye.Path,X=this.path.commands,oe=0;oe<X.length;oe+=1){var H=X[oe];"M"===H.type?N.moveTo(he+H.x*Y,ae+-H.y*A):"L"===H.type?N.lineTo(he+H.x*Y,ae+-H.y*A):"Q"===H.type?N.quadraticCurveTo(he+H.x1*Y,ae+-H.y1*A,he+H.x*Y,ae+-H.y*A):"C"===H.type?N.curveTo(he+H.x1*Y,ae+-H.y1*A,he+H.x2*Y,ae+-H.y2*A,he+H.x*Y,ae+-H.y*A):"Z"===H.type&&N.closePath()}return N},M.prototype.getContours=function(){if(void 0===this.points)return[];for(var he=[],ae=[],fe=0;fe<this.points.length;fe+=1){var le=this.points[fe];ae.push(le),le.lastPointOfContour&&(he.push(ae),ae=[])}return P.argument(0===ae.length,"There are still points left in the current contour."),he},M.prototype.getMetrics=function(){for(var he=this.path.commands,ae=[],fe=[],le=0;le<he.length;le+=1){var q=he[le];"Z"!==q.type&&(ae.push(q.x),fe.push(q.y)),("Q"===q.type||"C"===q.type)&&(ae.push(q.x1),fe.push(q.y1)),"C"===q.type&&(ae.push(q.x2),fe.push(q.y2))}var Y={xMin:Math.min.apply(null,ae),yMin:Math.min.apply(null,fe),xMax:Math.max.apply(null,ae),yMax:Math.max.apply(null,fe),leftSideBearing:this.leftSideBearing};return isFinite(Y.xMin)||(Y.xMin=0),isFinite(Y.xMax)||(Y.xMax=this.advanceWidth),isFinite(Y.yMin)||(Y.yMin=0),isFinite(Y.yMax)||(Y.yMax=0),Y.rightSideBearing=this.advanceWidth-Y.leftSideBearing-(Y.xMax-Y.xMin),Y},M.prototype.draw=function(he,ae,fe,le,q){this.getPath(ae,fe,le,q).draw(he)},M.prototype.drawPoints=function(he,ae,fe,le){function q(Ce,Q,xe,Pe){var Ge=2*Math.PI;he.beginPath();for(var Ae=0;Ae<Ce.length;Ae+=1)he.moveTo(Q+Ce[Ae].x*Pe,xe+Ce[Ae].y*Pe),he.arc(Q+Ce[Ae].x*Pe,xe+Ce[Ae].y*Pe,2,0,Ge,!1);he.closePath(),he.fill()}ae=void 0!==ae?ae:0,fe=void 0!==fe?fe:0;for(var Y=1/this.path.unitsPerEm*(le=void 0!==le?le:24),A=[],N=[],X=this.path,oe=0;oe<X.commands.length;oe+=1){var H=X.commands[oe];void 0!==H.x&&A.push({x:H.x,y:-H.y}),void 0!==H.x1&&N.push({x:H.x1,y:-H.y1}),void 0!==H.x2&&N.push({x:H.x2,y:-H.y2})}he.fillStyle="blue",q(A,ae,fe,Y),he.fillStyle="red",q(N,ae,fe,Y)},M.prototype.drawMetrics=function(he,ae,fe,le){var q;ae=void 0!==ae?ae:0,fe=void 0!==fe?fe:0,q=1/this.path.unitsPerEm*(le=void 0!==le?le:24),he.lineWidth=1,he.strokeStyle="black",de.line(he,ae,-1e4,ae,1e4),de.line(he,-1e4,fe,1e4,fe);var Y=this.xMin||0,A=this.yMin||0,N=this.xMax||0,X=this.yMax||0,oe=this.advanceWidth||0;he.strokeStyle="blue",de.line(he,ae+Y*q,-1e4,ae+Y*q,1e4),de.line(he,ae+N*q,-1e4,ae+N*q,1e4),de.line(he,-1e4,fe+-A*q,1e4,fe+-A*q),de.line(he,-1e4,fe+-X*q,1e4,fe+-X*q),he.strokeStyle="green",de.line(he,ae+oe*q,-1e4,ae+oe*q,1e4)},z.Glyph=M},{"./check":2,"./draw":3,"./path":11}],7:[function(L,D,z){function M(ye,he,ae){Object.defineProperty(ye,he,{get:function(){return ye[ae]},set:function(fe){ye[ae]=fe},enumerable:!0,configurable:!0})}function P(ye,he){if(this.font=ye,this.glyphs={},Array.isArray(he))for(var ae=0;ae<he.length;ae++)this.glyphs[ae]=he[ae];this.length=he&&he.length||0}var de=L("./glyph");P.prototype.get=function(ye){return"function"==typeof this.glyphs[ye]&&(this.glyphs[ye]=this.glyphs[ye]()),this.glyphs[ye]},P.prototype.push=function(ye,he){this.glyphs[ye]=he,this.length++},z.GlyphSet=P,z.glyphLoader=function(ye,he){return new de.Glyph({index:he,font:ye})},z.ttfGlyphLoader=function(ye,he,ae,fe,le,q){return function(){var Y=new de.Glyph({index:he,font:ye});return Y.path=function(){ae(Y,fe,le);var A=q(ye.glyphs,Y);return A.unitsPerEm=ye.unitsPerEm,A},M(Y,"xMin","_xMin"),M(Y,"xMax","_xMax"),M(Y,"yMin","_yMin"),M(Y,"yMax","_yMax"),Y}},z.cffGlyphLoader=function(ye,he,ae,fe){return function(){var le=new de.Glyph({index:he,font:ye});return le.path=function(){var q=ae(ye,le,fe);return q.unitsPerEm=ye.unitsPerEm,q},le}}},{"./glyph":6}],8:[function(L,D,z){function M(ye,he){for(var ae=0,fe=ye.length-1;fe>=ae;){var le=ae+fe>>>1,q=ye[le].tag;if(q===he)return le;he>q?ae=le+1:fe=le-1}return-ae-1}var P=L("./check");D.exports={searchTag:M,binSearch:function(ye,he){for(var ae=0,fe=ye.length-1;fe>=ae;){var le=ae+fe>>>1,q=ye[le];if(q===he)return le;he>q?ae=le+1:fe=le-1}return-ae-1},getScriptNames:function(){var ye=this.getGsubTable();return ye?ye.scripts.map(function(he){return he.tag}):[]},getScriptTable:function(ye,he){var ae=this.getGsubTable(he);if(ae){var fe=ae.scripts,le=M(ae.scripts,ye);if(le>=0)return fe[le].script;var q={tag:ye,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return fe.splice(-1-le,0,q.script),q}},getLangSysTable:function(ye,he,ae){var fe=this.getScriptTable(ye,ae);if(fe){if("DFLT"===he)return fe.defaultLangSys;var le=M(fe.langSysRecords,he);if(le>=0)return fe.langSysRecords[le].langSys;if(ae){var q={tag:he,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return fe.langSysRecords.splice(-1-le,0,q),q.langSys}}},getFeatureTable:function(ye,he,ae,fe){var le=this.getLangSysTable(ye,he,fe);if(le){for(var q,Y=le.featureIndexes,A=this.font.tables.gsub.features,N=0;N<Y.length;N++)if((q=A[Y[N]]).tag===ae)return q.feature;if(fe){var X=A.length;return P.assert(0===X||ae>=A[X-1].tag,"Features must be added in alphabetical order."),A.push(q={tag:ae,feature:{params:0,lookupListIndexes:[]}}),Y.push(X),q.feature}}},getLookupTable:function(ye,he,ae,fe,le){var q=this.getFeatureTable(ye,he,ae,le);if(q){for(var Y,A=q.lookupListIndexes,N=this.font.tables.gsub.lookups,X=0;X<A.length;X++)if((Y=N[A[X]]).lookupType===fe)return Y;if(le){var oe=N.length;return N.push(Y={lookupType:fe,lookupFlag:0,subtables:[],markFilteringSet:void 0}),A.push(oe),Y}}},expandCoverage:function(ye){if(1===ye.format)return ye.glyphs;for(var he=[],ae=ye.ranges,fe=0;ae>fe;fe++)for(var le=ae[fe],Y=le.end,A=le.start;Y>=A;A++)he.push(A);return he}}},{"./check":2}],9:[function(L,D,z){function M(sn,gt){L("fs").readFile(sn,function(Mn,Bn){return Mn?gt(Mn.message):void gt(null,N.nodeBufferToArrayBuffer(Bn))})}function P(sn,gt){var Mn=new XMLHttpRequest;Mn.open("get",sn,!0),Mn.responseType="arraybuffer",Mn.onload=function(){return 200!==Mn.status?gt("Font could not be loaded: "+Mn.statusText):gt(null,Mn.response)},Mn.send()}function de(sn,gt){for(var Mn=[],Bn=12,dn=0;gt>dn;dn+=1){var On=Y.getTag(sn,Bn),Ln=Y.getULong(sn,Bn+4),mn=Y.getULong(sn,Bn+8),cr=Y.getULong(sn,Bn+12);Mn.push({tag:On,checksum:Ln,offset:mn,length:cr,compression:!1}),Bn+=16}return Mn}function ye(sn,gt){if("WOFF"===gt.compression){var Mn=new Uint8Array(sn.buffer,gt.offset+2,gt.compressedLength-2),Bn=new Uint8Array(gt.originalLength);if(ae(Mn,Bn),Bn.byteLength!==gt.originalLength)throw new Error("Decompression error: "+gt.tag+" decompressed length doesn't match recorded length");return{data:new DataView(Bn.buffer,0),offset:0}}return{data:sn,offset:gt.offset}}function he(sn){var gt,Mn,Bn,dn=new le.Font({empty:!0}),On=new DataView(sn,0),Ln=[],mn=Y.getTag(On,0);if(mn===String.fromCharCode(0,1,0,0))dn.outlinesFormat="truetype",Ln=de(On,Bn=Y.getUShort(On,4));else if("OTTO"===mn)dn.outlinesFormat="cff",Ln=de(On,Bn=Y.getUShort(On,4));else{if("wOFF"!==mn)throw new Error("Unsupported OpenType signature "+mn);var cr=Y.getTag(On,4);if(cr===String.fromCharCode(0,1,0,0))dn.outlinesFormat="truetype";else{if("OTTO"!==cr)throw new Error("Unsupported OpenType flavor "+mn);dn.outlinesFormat="cff"}Ln=function(Hu,hs){for(var Ys=[],ai=44,Gc=0;hs>Gc;Gc+=1){var sl=Y.getTag(Hu,ai),Gp=Y.getULong(Hu,ai+4),ha=Y.getULong(Hu,ai+8),Wl=Y.getULong(Hu,ai+12);Ys.push({tag:sl,offset:Gp,compression:Wl>ha&&"WOFF",compressedLength:ha,originalLength:Wl}),ai+=20}return Ys}(On,Bn=Y.getUShort(On,12))}for(var ir,ur,or,ni,Kr,pi,rr,vr,mi,go,Nr=0;Bn>Nr;Nr+=1){var ei,Wr=Ln[Nr];switch(Wr.tag){case"cmap":ei=ye(On,Wr),dn.tables.cmap=X.parse(ei.data,ei.offset),dn.encoding=new fe.CmapEncoding(dn.tables.cmap);break;case"fvar":ur=Wr;break;case"head":ei=ye(On,Wr),dn.tables.head=Pe.parse(ei.data,ei.offset),dn.unitsPerEm=dn.tables.head.unitsPerEm,gt=dn.tables.head.indexToLocFormat;break;case"hhea":ei=ye(On,Wr),dn.tables.hhea=Ge.parse(ei.data,ei.offset),dn.ascender=dn.tables.hhea.ascender,dn.descender=dn.tables.hhea.descender,dn.numberOfHMetrics=dn.tables.hhea.numberOfHMetrics;break;case"hmtx":pi=Wr;break;case"ltag":ei=ye(On,Wr),Mn=Ke.parse(ei.data,ei.offset);break;case"maxp":ei=ye(On,Wr),dn.tables.maxp=dt.parse(ei.data,ei.offset),dn.numGlyphs=dn.tables.maxp.numGlyphs;break;case"name":mi=Wr;break;case"OS/2":ei=ye(On,Wr),dn.tables.os2=wt.parse(ei.data,ei.offset);break;case"post":ei=ye(On,Wr),dn.tables.post=Gt.parse(ei.data,ei.offset),dn.glyphNames=new fe.GlyphNames(dn.tables.post);break;case"glyf":or=Wr;break;case"loca":vr=Wr;break;case"CFF ":ir=Wr;break;case"kern":rr=Wr;break;case"GPOS":ni=Wr;break;case"GSUB":Kr=Wr;break;case"meta":go=Wr}}var yi=ye(On,mi);if(dn.tables.name=Pt.parse(yi.data,yi.offset,Mn),dn.names=dn.tables.name,or&&vr){var Ei=0===gt,So=ye(On,vr),Xs=yt.parse(So.data,So.offset,dn.numGlyphs,Ei),ua=ye(On,or);dn.glyphs=Ce.parse(ua.data,ua.offset,Xs,dn)}else{if(!ir)throw new Error("Font doesn't contain TrueType or CFF outlines.");var Ni=ye(On,ir);oe.parse(Ni.data,Ni.offset,dn)}var Eo=ye(On,pi);if(Ae.parse(Eo.data,Eo.offset,dn.numberOfHMetrics,dn.numGlyphs,dn.glyphs),fe.addGlyphNames(dn),rr){var vo=ye(On,rr);dn.kerningPairs=Xe.parse(vo.data,vo.offset)}else dn.kerningPairs={};if(ni){var Jr=ye(On,ni);Q.parse(Jr.data,Jr.offset,dn)}if(Kr){var os=ye(On,Kr);dn.tables.gsub=xe.parse(os.data,os.offset)}if(ur){var Ir=ye(On,ur);dn.tables.fvar=H.parse(Ir.data,Ir.offset,dn.names)}if(go){var Va=ye(On,go);dn.tables.meta=Dt.parse(Va.data,Va.offset),dn.metas=dn.tables.meta}return dn}var ae=L("tiny-inflate"),fe=L("./encoding"),le=L("./font"),q=L("./glyph"),Y=L("./parse"),A=L("./path"),N=L("./util"),X=L("./tables/cmap"),oe=L("./tables/cff"),H=L("./tables/fvar"),Ce=L("./tables/glyf"),Q=L("./tables/gpos"),xe=L("./tables/gsub"),Pe=L("./tables/head"),Ge=L("./tables/hhea"),Ae=L("./tables/hmtx"),Xe=L("./tables/kern"),Ke=L("./tables/ltag"),yt=L("./tables/loca"),dt=L("./tables/maxp"),Pt=L("./tables/name"),wt=L("./tables/os2"),Gt=L("./tables/post"),Dt=L("./tables/meta");z._parse=Y,z.Font=le.Font,z.Glyph=q.Glyph,z.Path=A.Path,z.parse=he,z.load=function(sn,gt){(typeof window>"u"?M:P)(sn,function(Mn,Bn){if(Mn)return gt(Mn);var dn;try{dn=he(Bn)}catch(On){return gt(On,null)}return gt(null,dn)})},z.loadSync=function(sn){var gt=L("fs").readFileSync(sn);return he(N.nodeBufferToArrayBuffer(gt))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(L,D,z){function M(ae,fe){return ae.getUint16(fe,!1)}function P(ae,fe){this.data=ae,this.offset=fe,this.relativeOffset=0}var de=L("./check");z.getByte=function(ae,fe){return ae.getUint8(fe)},z.getCard8=z.getByte,z.getUShort=z.getCard16=M,z.getShort=function(ae,fe){return ae.getInt16(fe,!1)},z.getULong=function(ae,fe){return ae.getUint32(fe,!1)},z.getFixed=function(ae,fe){return ae.getInt16(fe,!1)+ae.getUint16(fe+2,!1)/65535},z.getTag=function(ae,fe){for(var le="",q=fe;fe+4>q;q+=1)le+=String.fromCharCode(ae.getInt8(q));return le},z.getOffset=function(ae,fe,le){for(var q=0,Y=0;le>Y;Y+=1)q<<=8,q+=ae.getUint8(fe+Y);return q},z.getBytes=function(ae,fe,le){for(var q=[],Y=fe;le>Y;Y+=1)q.push(ae.getUint8(Y));return q},z.bytesToString=function(ae){for(var fe="",le=0;le<ae.length;le+=1)fe+=String.fromCharCode(ae[le]);return fe};var ye={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};P.prototype.parseByte=function(){var ae=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ae},P.prototype.parseChar=function(){var ae=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ae},P.prototype.parseCard8=P.prototype.parseByte,P.prototype.parseCard16=P.prototype.parseUShort=function(){var ae=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ae},P.prototype.parseSID=P.prototype.parseUShort,P.prototype.parseOffset16=P.prototype.parseUShort,P.prototype.parseShort=function(){var ae=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ae},P.prototype.parseF2Dot14=function(){var ae=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,ae},P.prototype.parseULong=function(){var ae=z.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ae},P.prototype.parseFixed=function(){var ae=z.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ae},P.prototype.parseString=function(ae){var fe=this.data,le=this.offset+this.relativeOffset,q="";this.relativeOffset+=ae;for(var Y=0;ae>Y;Y++)q+=String.fromCharCode(fe.getUint8(le+Y));return q},P.prototype.parseTag=function(){return this.parseString(4)},P.prototype.parseLongDateTime=function(){var ae=z.getULong(this.data,this.offset+this.relativeOffset+4);return ae-=2082844800,this.relativeOffset+=8,ae},P.prototype.parseVersion=function(){var ae=M(this.data,this.offset+this.relativeOffset),fe=M(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,ae+fe/4096/10},P.prototype.skip=function(ae,fe){void 0===fe&&(fe=1),this.relativeOffset+=ye[ae]*fe},P.prototype.parseOffset16List=P.prototype.parseUShortList=function(ae){void 0===ae&&(ae=this.parseUShort());for(var fe=new Array(ae),le=this.data,q=this.offset+this.relativeOffset,Y=0;ae>Y;Y++)fe[Y]=le.getUint16(q),q+=2;return this.relativeOffset+=2*ae,fe},P.prototype.parseList=function(ae,fe){fe||(fe=ae,ae=this.parseUShort());for(var le=new Array(ae),q=0;ae>q;q++)le[q]=fe.call(this);return le},P.prototype.parseRecordList=function(ae,fe){fe||(fe=ae,ae=this.parseUShort());for(var le=new Array(ae),q=Object.keys(fe),Y=0;ae>Y;Y++){for(var A={},N=0;N<q.length;N++){var X=q[N];A[X]=fe[X].call(this)}le[Y]=A}return le},P.prototype.parseStruct=function(ae){if("function"==typeof ae)return ae.call(this);for(var fe=Object.keys(ae),le={},q=0;q<fe.length;q++){var Y=fe[q];le[Y]=ae[Y].call(this)}return le},P.prototype.parsePointer=function(ae){var fe=this.parseOffset16();return fe>0?new P(this.data,this.offset+fe).parseStruct(ae):void 0},P.prototype.parseListOfLists=function(ae){for(var fe=this.parseOffset16List(),le=fe.length,q=this.relativeOffset,Y=new Array(le),A=0;le>A;A++){var N=fe[A];if(0!==N)if(this.relativeOffset=N,ae){for(var X=this.parseOffset16List(),oe=new Array(X.length),H=0;H<X.length;H++)this.relativeOffset=N+X[H],oe[H]=ae.call(this);Y[A]=oe}else Y[A]=this.parseUShortList();else Y[A]=void 0}return this.relativeOffset=q,Y},P.prototype.parseCoverage=function(){var ae=this.offset+this.relativeOffset,fe=this.parseUShort(),le=this.parseUShort();if(1===fe)return{format:1,glyphs:this.parseUShortList(le)};if(2===fe){for(var q=new Array(le),Y=0;le>Y;Y++)q[Y]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:q}}de.assert(!1,"0x"+ae.toString(16)+": Coverage format must be 1 or 2.")},P.prototype.parseClassDef=function(){var ae=this.offset+this.relativeOffset,fe=this.parseUShort();return 1===fe?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===fe?{format:2,ranges:this.parseRecordList({start:P.uShort,end:P.uShort,classId:P.uShort})}:void de.assert(!1,"0x"+ae.toString(16)+": ClassDef format must be 1 or 2.")},P.list=function(ae,fe){return function(){return this.parseList(ae,fe)}},P.recordList=function(ae,fe){return function(){return this.parseRecordList(ae,fe)}},P.pointer=function(ae){return function(){return this.parsePointer(ae)}},P.tag=P.prototype.parseTag,P.byte=P.prototype.parseByte,P.uShort=P.offset16=P.prototype.parseUShort,P.uShortList=P.prototype.parseUShortList,P.struct=P.prototype.parseStruct,P.coverage=P.prototype.parseCoverage,P.classDef=P.prototype.parseClassDef;var he={reserved:P.uShort,reqFeatureIndex:P.uShort,featureIndexes:P.uShortList};P.prototype.parseScriptList=function(){return this.parsePointer(P.recordList({tag:P.tag,script:P.pointer({defaultLangSys:P.pointer(he),langSysRecords:P.recordList({tag:P.tag,langSys:P.pointer(he)})})}))},P.prototype.parseFeatureList=function(){return this.parsePointer(P.recordList({tag:P.tag,feature:P.pointer({featureParams:P.offset16,lookupListIndexes:P.uShortList})}))},P.prototype.parseLookupList=function(ae){return this.parsePointer(P.list(P.pointer(function(){var fe=this.parseUShort();de.argument(fe>=1&&8>=fe,"GSUB lookup type "+fe+" unknown.");var le=this.parseUShort(),q=16&le;return{lookupType:fe,lookupFlag:le,subtables:this.parseList(P.pointer(ae[fe])),markFilteringSet:q?this.parseUShort():void 0}})))},z.Parser=P},{"./check":2}],11:[function(L,D,z){function M(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}M.prototype.moveTo=function(P,de){this.commands.push({type:"M",x:P,y:de})},M.prototype.lineTo=function(P,de){this.commands.push({type:"L",x:P,y:de})},M.prototype.curveTo=M.prototype.bezierCurveTo=function(P,de,ye,he,ae,fe){this.commands.push({type:"C",x1:P,y1:de,x2:ye,y2:he,x:ae,y:fe})},M.prototype.quadTo=M.prototype.quadraticCurveTo=function(P,de,ye,he){this.commands.push({type:"Q",x1:P,y1:de,x:ye,y:he})},M.prototype.close=M.prototype.closePath=function(){this.commands.push({type:"Z"})},M.prototype.extend=function(P){P.commands&&(P=P.commands),Array.prototype.push.apply(this.commands,P)},M.prototype.draw=function(P){P.beginPath();for(var de=0;de<this.commands.length;de+=1){var ye=this.commands[de];"M"===ye.type?P.moveTo(ye.x,ye.y):"L"===ye.type?P.lineTo(ye.x,ye.y):"C"===ye.type?P.bezierCurveTo(ye.x1,ye.y1,ye.x2,ye.y2,ye.x,ye.y):"Q"===ye.type?P.quadraticCurveTo(ye.x1,ye.y1,ye.x,ye.y):"Z"===ye.type&&P.closePath()}this.fill&&(P.fillStyle=this.fill,P.fill()),this.stroke&&(P.strokeStyle=this.stroke,P.lineWidth=this.strokeWidth,P.stroke())},M.prototype.toPathData=function(P){function de(le){return Math.round(le)===le?""+Math.round(le):le.toFixed(P)}function ye(){for(var le="",q=0;q<arguments.length;q+=1){var Y=arguments[q];Y>=0&&q>0&&(le+=" "),le+=de(Y)}return le}P=void 0!==P?P:2;for(var he="",ae=0;ae<this.commands.length;ae+=1){var fe=this.commands[ae];"M"===fe.type?he+="M"+ye(fe.x,fe.y):"L"===fe.type?he+="L"+ye(fe.x,fe.y):"C"===fe.type?he+="C"+ye(fe.x1,fe.y1,fe.x2,fe.y2,fe.x,fe.y):"Q"===fe.type?he+="Q"+ye(fe.x1,fe.y1,fe.x,fe.y):"Z"===fe.type&&(he+="Z")}return he},M.prototype.toSVG=function(P){var de='<path d="';return de+=this.toPathData(P),de+='"',this.fill&&"black"!==this.fill&&(de+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(de+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),de+"/>"},z.Path=M},{}],12:[function(L,D,z){function M(ae,fe){var le=ae.length;if(le!==fe.length)return!1;for(var q=0;le>q;q++)if(ae[q]!==fe[q])return!1;return!0}function P(ae,fe,le){for(var q=ae.subtables,Y=0;Y<q.length;Y++){var A=q[Y];if(A.substFormat===fe)return A}return le?(q.push(le),le):void 0}var de=L("./check"),ye=L("./layout"),he=function(ae){this.font=ae};(he.prototype=ye).getGsubTable=function(ae){var fe=this.font.tables.gsub;return!fe&&ae&&(this.font.tables.gsub=fe={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),fe},he.prototype.getSingle=function(ae,fe,le){var q=[],Y=this.getLookupTable(fe,le,ae,1);if(!Y)return q;for(var A=Y.subtables,N=0;N<A.length;N++){var X,oe=A[N],H=this.expandCoverage(oe.coverage);if(1===oe.substFormat){var Ce=oe.deltaGlyphId;for(X=0;X<H.length;X++){var Q=H[X];q.push({sub:Q,by:Q+Ce})}}else{var xe=oe.substitute;for(X=0;X<H.length;X++)q.push({sub:H[X],by:xe[X]})}}return q},he.prototype.getAlternates=function(ae,fe,le){var q=[],Y=this.getLookupTable(fe,le,ae,3);if(!Y)return q;for(var A=Y.subtables,N=0;N<A.length;N++)for(var X=A[N],oe=this.expandCoverage(X.coverage),H=X.alternateSets,Ce=0;Ce<oe.length;Ce++)q.push({sub:oe[Ce],by:H[Ce]});return q},he.prototype.getLigatures=function(ae,fe,le){var q=[],Y=this.getLookupTable(fe,le,ae,4);if(!Y)return[];for(var A=Y.subtables,N=0;N<A.length;N++)for(var X=A[N],oe=this.expandCoverage(X.coverage),H=X.ligatureSets,Ce=0;Ce<oe.length;Ce++)for(var Q=oe[Ce],xe=H[Ce],Pe=0;Pe<xe.length;Pe++){var Ge=xe[Pe];q.push({sub:[Q].concat(Ge.components),by:Ge.ligGlyph})}return q},he.prototype.addSingle=function(ae,fe,le,q){var Y=P(this.getLookupTable(le,q,ae,1,!0),2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});de.assert(1===Y.coverage.format,"Ligature: unable to modify coverage table format "+Y.coverage.format);var A=fe.sub,N=this.binSearch(Y.coverage.glyphs,A);0>N&&(Y.coverage.glyphs.splice(N=-1-N,0,A),Y.substitute.splice(N,0,0)),Y.substitute[N]=fe.by},he.prototype.addAlternate=function(ae,fe,le,q){var Y=P(this.getLookupTable(le,q,ae,3,!0),1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});de.assert(1===Y.coverage.format,"Ligature: unable to modify coverage table format "+Y.coverage.format);var A=fe.sub,N=this.binSearch(Y.coverage.glyphs,A);0>N&&(Y.coverage.glyphs.splice(N=-1-N,0,A),Y.alternateSets.splice(N,0,0)),Y.alternateSets[N]=fe.by},he.prototype.addLigature=function(ae,fe,le,q){var Y=this.getLookupTable(le=le||"DFLT",q=q||"DFLT",ae,4,!0),A=Y.subtables[0];A||(Y.subtables[0]=A={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),de.assert(1===A.coverage.format,"Ligature: unable to modify coverage table format "+A.coverage.format);var N=fe.sub[0],X=fe.sub.slice(1),oe={ligGlyph:fe.by,components:X},H=this.binSearch(A.coverage.glyphs,N);if(H>=0){for(var Ce=A.ligatureSets[H],Q=0;Q<Ce.length;Q++)if(M(Ce[Q].components,X))return;Ce.push(oe)}else A.coverage.glyphs.splice(H=-1-H,0,N),A.ligatureSets.splice(H,0,[oe])},he.prototype.getFeature=function(ae,fe,le){if(fe=fe||"DFLT",le=le||"DFLT",/ss\d\d/.test(ae))return this.getSingle(ae,fe,le);switch(ae){case"aalt":case"salt":return this.getSingle(ae,fe,le).concat(this.getAlternates(ae,fe,le));case"dlig":case"liga":case"rlig":return this.getLigatures(ae,fe,le)}},he.prototype.add=function(ae,fe,le,q){if(le=le||"DFLT",q=q||"DFLT",/ss\d\d/.test(ae))return this.addSingle(ae,fe,le,q);switch(ae){case"aalt":case"salt":return"number"==typeof fe.by?this.addSingle(ae,fe,le,q):this.addAlternate(ae,fe,le,q);case"dlig":case"liga":case"rlig":return this.addLigature(ae,fe,le,q)}},D.exports=he},{"./check":2,"./layout":8}],13:[function(L,D,z){function M(N,X,oe){var H;for(H=0;H<X.length;H+=1){var Ce=X[H];this[Ce.name]=Ce.value}if(this.tableName=N,this.fields=X,oe){var Q=Object.keys(oe);for(H=0;H<Q.length;H+=1){var xe=Q[H];void 0!==this[xe]&&(this[xe]=oe[xe])}}}function P(N,X,oe){void 0===oe&&(oe=X.length);var H=new Array(X.length+1);H[0]={name:N+"Count",type:"USHORT",value:oe};for(var Ce=0;Ce<X.length;Ce++)H[Ce+1]={name:N+Ce,type:"USHORT",value:X[Ce]};return H}function de(N,X,oe){var H=X.length,Ce=new Array(H+1);Ce[0]={name:N+"Count",type:"USHORT",value:H};for(var Q=0;H>Q;Q++)Ce[Q+1]={name:N+Q,type:"TABLE",value:oe(X[Q],Q)};return Ce}function ye(N,X,oe){var H=X.length,Ce=[];Ce[0]={name:N+"Count",type:"USHORT",value:H};for(var Q=0;H>Q;Q++)Ce=Ce.concat(oe(X[Q],Q));return Ce}function he(N){1===N.format?M.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(P("glyph",N.glyphs))):q.assert(!1,"Can't create coverage table format 2 yet.")}function ae(N){M.call(this,"scriptListTable",ye("scriptRecord",N,function(X,oe){var H=X.script,Ce=H.defaultLangSys;return q.assert(!!Ce,"Unable to write GSUB: script "+X.tag+" has no default language system."),[{name:"scriptTag"+oe,type:"TAG",value:X.tag},{name:"script"+oe,type:"TABLE",value:new M("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new M("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Ce.reqFeatureIndex}].concat(P("featureIndex",Ce.featureIndexes)))}].concat(ye("langSys",H.langSysRecords,function(Q,xe){var Pe=Q.langSys;return[{name:"langSysTag"+xe,type:"TAG",value:Q.tag},{name:"langSys"+xe,type:"TABLE",value:new M("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Pe.reqFeatureIndex}].concat(P("featureIndex",Pe.featureIndexes)))}]})))}]}))}function fe(N){M.call(this,"featureListTable",ye("featureRecord",N,function(X,oe){var H=X.feature;return[{name:"featureTag"+oe,type:"TAG",value:X.tag},{name:"feature"+oe,type:"TABLE",value:new M("featureTable",[{name:"featureParams",type:"USHORT",value:H.featureParams}].concat(P("lookupListIndex",H.lookupListIndexes)))}]}))}function le(N,X){M.call(this,"lookupListTable",de("lookup",N,function(oe){var H=X[oe.lookupType];return q.assert(!!H,"Unable to write GSUB lookup type "+oe.lookupType+" tables."),new M("lookupTable",[{name:"lookupType",type:"USHORT",value:oe.lookupType},{name:"lookupFlag",type:"USHORT",value:oe.lookupFlag}].concat(de("subtable",oe.subtables,H)))}))}var q=L("./check"),Y=L("./types").encode,A=L("./types").sizeOf;M.prototype.encode=function(){return Y.TABLE(this)},M.prototype.sizeOf=function(){return A.TABLE(this)},(he.prototype=Object.create(M.prototype)).constructor=he,(ae.prototype=Object.create(M.prototype)).constructor=ae,(fe.prototype=Object.create(M.prototype)).constructor=fe,(le.prototype=Object.create(M.prototype)).constructor=le,z.Record=z.Table=M,z.Coverage=he,z.ScriptList=ae,z.FeatureList=fe,z.LookupList=le,z.ushortList=P,z.tableList=de,z.recordList=ye},{"./check":2,"./types":32}],14:[function(L,D,z){function M(Ae,Xe){if(Ae===Xe)return!0;if(Array.isArray(Ae)&&Array.isArray(Xe)){if(Ae.length!==Xe.length)return!1;for(var Ke=0;Ke<Ae.length;Ke+=1)if(!M(Ae[Ke],Xe[Ke]))return!1;return!0}return!1}function P(Ae,Xe,Ke){var yt,dt,Pt,wt=[],Gt=[],Dt=Ce.getCard16(Ae,Xe);if(0!==Dt){var sn=Ce.getByte(Ae,Xe+2);dt=Xe+(Dt+1)*sn+2;var gt=Xe+3;for(yt=0;Dt+1>yt;yt+=1)wt.push(Ce.getOffset(Ae,gt,sn)),gt+=sn;Pt=dt+wt[Dt]}else Pt=Xe+2;for(yt=0;yt<wt.length-1;yt+=1){var Mn=Ce.getBytes(Ae,dt+wt[yt],dt+wt[yt+1]);Ke&&(Mn=Ke(Mn)),Gt.push(Mn)}return{objects:Gt,startOffset:Xe,endOffset:Pt}}function de(Ae,Xe){if(28===Xe)return Ae.parseByte()<<8|Ae.parseByte();if(29===Xe)return Ae.parseByte()<<24|Ae.parseByte()<<16|Ae.parseByte()<<8|Ae.parseByte();if(30===Xe)return function(Ke){for(var yt="",dt=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Pt=Ke.parseByte(),wt=Pt>>4,Gt=15&Pt;if(15===wt||(yt+=dt[wt],15===Gt))break;yt+=dt[Gt]}return parseFloat(yt)}(Ae);if(Xe>=32&&246>=Xe)return Xe-139;if(Xe>=247&&250>=Xe)return 256*(Xe-247)+Ae.parseByte()+108;if(Xe>=251&&254>=Xe)return 256*-(Xe-251)-Ae.parseByte()-108;throw new Error("Invalid b0 "+Xe)}function ye(Ae,Xe,Ke){var yt=new Ce.Parser(Ae,Xe=void 0!==Xe?Xe:0),dt=[],Pt=[];for(Ke=void 0!==Ke?Ke:Ae.length;yt.relativeOffset<Ke;){var wt=yt.parseByte();21>=wt?(12===wt&&(wt=1200+yt.parseByte()),dt.push([wt,Pt]),Pt=[]):Pt.push(de(yt,wt))}return function(Gt){for(var Dt={},sn=0;sn<Gt.length;sn+=1){var gt,Mn=Gt[sn][0],Bn=Gt[sn][1];if(gt=1===Bn.length?Bn[0]:Bn,Dt.hasOwnProperty(Mn))throw new Error("Object "+Dt+" already has key "+Mn);Dt[Mn]=gt}return Dt}(dt)}function he(Ae,Xe){return 390>=Xe?oe.cffStandardStrings[Xe]:Ae[Xe-391]}function ae(Ae,Xe,Ke){for(var yt={},dt=0;dt<Xe.length;dt+=1){var Pt=Xe[dt],wt=Ae[Pt.op];void 0===wt&&(wt=void 0!==Pt.value?Pt.value:null),"SID"===Pt.type&&(wt=he(Ke,wt)),yt[Pt.name]=wt}return yt}function fe(Ae,Xe,Ke){function yt(cr,ir){On&&sn.closePath(),sn.moveTo(cr,ir),On=!0}function dt(){gt.length%2!=0&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX),Mn+=gt.length>>1,gt.length=0,Bn=!0}var Pt,wt,Gt,Dt,sn=new Q.Path,gt=[],Mn=0,Bn=!1,dn=Ae.defaultWidthX,On=!1,Ln=0,mn=0;return function cr(ir){for(var ur,or,ni,Kr,pi,rr,vr,mi,go,Nr,ei,Wr,yi=0;yi<ir.length;){var Ei=ir[yi];switch(yi+=1,Ei){case 1:case 3:case 18:case 23:dt();break;case 4:gt.length>1&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),mn+=gt.pop(),yt(Ln,mn);break;case 5:for(;gt.length>0;)Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 6:for(;gt.length>0&&(Ln+=gt.shift(),sn.lineTo(Ln,mn),0!==gt.length);)mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 7:for(;gt.length>0&&(mn+=gt.shift(),sn.lineTo(Ln,mn),0!==gt.length);)Ln+=gt.shift(),sn.lineTo(Ln,mn);break;case 8:for(;gt.length>0;)Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);break;case 10:pi=gt.pop()+Ae.subrsBias,(rr=Ae.subrs[pi])&&cr(rr);break;case 11:return;case 12:switch(Ei=ir[yi],yi+=1,Ei){case 35:Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt+gt.shift(),go=vr+gt.shift(),Nr=mi+gt.shift(),ei=go+gt.shift(),Wr=Nr+gt.shift(),Ln=ei+gt.shift(),mn=Wr+gt.shift(),gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,vr,mi),sn.curveTo(go,Nr,ei,Wr,Ln,mn);break;case 34:Pt=Ln+gt.shift(),wt=mn,Gt=Pt+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt,go=vr+gt.shift(),Nr=Dt,ei=go+gt.shift(),Wr=mn,Ln=ei+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,vr,mi),sn.curveTo(go,Nr,ei,Wr,Ln,mn);break;case 36:Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt,go=vr+gt.shift(),Nr=Dt,ei=go+gt.shift(),Wr=Nr+gt.shift(),Ln=ei+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,vr,mi),sn.curveTo(go,Nr,ei,Wr,Ln,mn);break;case 37:Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt+gt.shift(),go=vr+gt.shift(),Nr=mi+gt.shift(),ei=go+gt.shift(),Wr=Nr+gt.shift(),Math.abs(ei-Ln)>Math.abs(Wr-mn)?Ln=ei+gt.shift():mn=Wr+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,vr,mi),sn.curveTo(go,Nr,ei,Wr,Ln,mn);break;default:console.log("Glyph "+Xe.index+": unknown operator 1200"+Ei),gt.length=0}break;case 14:gt.length>0&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),On&&(sn.closePath(),On=!1);break;case 19:case 20:dt(),yi+=Mn+7>>3;break;case 21:gt.length>2&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),mn+=gt.pop(),yt(Ln+=gt.pop(),mn);break;case 22:gt.length>1&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),yt(Ln+=gt.pop(),mn);break;case 24:for(;gt.length>2;)Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 25:for(;gt.length>6;)Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);Pt=Ln+gt.shift(),wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);break;case 26:for(gt.length%2&&(Ln+=gt.shift());gt.length>0;)Pt=Ln,wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt,mn=Dt+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);break;case 27:for(gt.length%2&&(mn+=gt.shift());gt.length>0;)Pt=Ln+gt.shift(),wt=mn,Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn=Dt);break;case 28:gt.push(((ur=ir[yi])<<24|(or=ir[yi+1])<<16)>>16),yi+=2;break;case 29:pi=gt.pop()+Ae.gsubrsBias,(rr=Ae.gsubrs[pi])&&cr(rr);break;case 30:for(;gt.length>0&&(Pt=Ln,wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+(1===gt.length?gt.shift():0),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn),0!==gt.length);)Pt=Ln+gt.shift(),wt=mn,Gt=Pt+gt.shift(),Dt=wt+gt.shift(),mn=Dt+gt.shift(),Ln=Gt+(1===gt.length?gt.shift():0),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);break;case 31:for(;gt.length>0&&(Pt=Ln+gt.shift(),wt=mn,Gt=Pt+gt.shift(),Dt=wt+gt.shift(),mn=Dt+gt.shift(),Ln=Gt+(1===gt.length?gt.shift():0),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn),0!==gt.length);)Pt=Ln,wt=mn+gt.shift(),Gt=Pt+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+(1===gt.length?gt.shift():0),sn.curveTo(Pt,wt,Gt,Dt,Ln,mn);break;default:32>Ei?console.log("Glyph "+Xe.index+": unknown operator "+Ei):247>Ei?gt.push(Ei-139):251>Ei?(ur=ir[yi],yi+=1,gt.push(256*(Ei-247)+ur+108)):255>Ei?(ur=ir[yi],yi+=1,gt.push(256*-(Ei-251)-ur-108)):(ur=ir[yi],or=ir[yi+1],ni=ir[yi+2],Kr=ir[yi+3],yi+=4,gt.push((ur<<24|or<<16|ni<<8|Kr)/65536))}}}(Ke),Xe.advanceWidth=dn,sn}function le(Ae){return Ae.length<1240?107:Ae.length<33900?1131:32768}function q(Ae,Xe){var Ke,yt=oe.cffStandardStrings.indexOf(Ae);return yt>=0&&(Ke=yt),(yt=Xe.indexOf(Ae))>=0?Ke=yt+oe.cffStandardStrings.length:(Ke=oe.cffStandardStrings.length+Xe.length,Xe.push(Ae)),Ke}function Y(Ae,Xe,Ke){for(var yt={},dt=0;dt<Ae.length;dt+=1){var Pt=Ae[dt],wt=Xe[Pt.name];void 0===wt||M(wt,Pt.value)||("SID"===Pt.type&&(wt=q(wt,Ke)),yt[Pt.op]={name:Pt.name,type:Pt.type,value:wt})}return yt}function A(Ae,Xe){var Ke=new xe.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Ke.dict=Y(Pe,Ae,Xe),Ke}function N(Ae){var Xe=new xe.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return Xe.topDicts=[{name:"topDict_0",type:"TABLE",value:Ae}],Xe}function X(Ae){var Xe=[],Ke=Ae.path;Xe.push({name:"width",type:"NUMBER",value:Ae.advanceWidth});for(var yt=0,dt=0,Pt=0;Pt<Ke.commands.length;Pt+=1){var wt,Gt,Dt=Ke.commands[Pt];if("Q"===Dt.type){var sn=.3333333333333333,gt=2/3;Dt={type:"C",x:Dt.x,y:Dt.y,x1:sn*yt+gt*Dt.x1,y1:sn*dt+gt*Dt.y1,x2:sn*Dt.x+gt*Dt.x1,y2:sn*Dt.y+gt*Dt.y1}}if("M"===Dt.type)wt=Math.round(Dt.x-yt),Gt=Math.round(Dt.y-dt),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rmoveto",type:"OP",value:21}),yt=Math.round(Dt.x),dt=Math.round(Dt.y);else if("L"===Dt.type)wt=Math.round(Dt.x-yt),Gt=Math.round(Dt.y-dt),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rlineto",type:"OP",value:5}),yt=Math.round(Dt.x),dt=Math.round(Dt.y);else if("C"===Dt.type){var Mn=Math.round(Dt.x1-yt),Bn=Math.round(Dt.y1-dt),dn=Math.round(Dt.x2-Dt.x1),On=Math.round(Dt.y2-Dt.y1);wt=Math.round(Dt.x-Dt.x2),Gt=Math.round(Dt.y-Dt.y2),Xe.push({name:"dx1",type:"NUMBER",value:Mn}),Xe.push({name:"dy1",type:"NUMBER",value:Bn}),Xe.push({name:"dx2",type:"NUMBER",value:dn}),Xe.push({name:"dy2",type:"NUMBER",value:On}),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rrcurveto",type:"OP",value:8}),yt=Math.round(Dt.x),dt=Math.round(Dt.y)}}return Xe.push({name:"endchar",type:"OP",value:14}),Xe}var oe=L("../encoding"),H=L("../glyphset"),Ce=L("../parse"),Q=L("../path"),xe=L("../table"),Pe=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],Ge=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];z.parse=function(Ae,Xe,Ke){Ke.tables.cff={};var mn,cr,ir,dt=P(Ae,((ir={}).formatMajor=Ce.getCard8(mn=Ae,cr=Xe),ir.formatMinor=Ce.getCard8(mn,cr+1),ir.size=Ce.getCard8(mn,cr+2),ir.offsetSize=Ce.getCard8(mn,cr+3),ir.startOffset=cr,ir.endOffset=cr+4,ir).endOffset,Ce.bytesToString),Pt=P(Ae,dt.endOffset),wt=P(Ae,Pt.endOffset,Ce.bytesToString),Gt=P(Ae,wt.endOffset);Ke.gsubrs=Gt.objects,Ke.gsubrsBias=le(Ke.gsubrs);var Dt=function(mn,cr){return ae(ye(mn,0,mn.byteLength),Pe,cr)}(new DataView(new Uint8Array(Pt.objects[0]).buffer),wt.objects);Ke.tables.cff.topDict=Dt;var sn=Xe+Dt.private[1],gt=function(mn,cr,ir,ur){return ae(ye(mn,cr,ir),Ge,ur)}(Ae,sn,Dt.private[0],wt.objects);if(Ke.defaultWidthX=gt.defaultWidthX,Ke.nominalWidthX=gt.nominalWidthX,0!==gt.subrs){var Mn=P(Ae,sn+gt.subrs);Ke.subrs=Mn.objects,Ke.subrsBias=le(Ke.subrs)}else Ke.subrs=[],Ke.subrsBias=0;var Bn=P(Ae,Xe+Dt.charStrings);Ke.nGlyphs=Bn.objects.length;var dn=function(mn,cr,ir,ur){var or,ni,Kr,pi=new Ce.Parser(mn,cr);ir-=1;var rr=[".notdef"],vr=pi.parseCard8();if(0===vr)for(or=0;ir>or;or+=1)ni=pi.parseSID(),rr.push(he(ur,ni));else if(1===vr)for(;rr.length<=ir;)for(ni=pi.parseSID(),Kr=pi.parseCard8(),or=0;Kr>=or;or+=1)rr.push(he(ur,ni)),ni+=1;else{if(2!==vr)throw new Error("Unknown charset format "+vr);for(;rr.length<=ir;)for(ni=pi.parseSID(),Kr=pi.parseCard16(),or=0;Kr>=or;or+=1)rr.push(he(ur,ni)),ni+=1}return rr}(Ae,Xe+Dt.charset,Ke.nGlyphs,wt.objects);Ke.cffEncoding=0===Dt.encoding?new oe.CffEncoding(oe.cffStandardEncoding,dn):1===Dt.encoding?new oe.CffEncoding(oe.cffExpertEncoding,dn):function(mn,cr,ir){var ur,or,ni={},Kr=new Ce.Parser(mn,cr),pi=Kr.parseCard8();if(0===pi){var rr=Kr.parseCard8();for(ur=0;rr>ur;ur+=1)ni[or=Kr.parseCard8()]=ur}else{if(1!==pi)throw new Error("Unknown encoding format "+pi);var vr=Kr.parseCard8();for(or=1,ur=0;vr>ur;ur+=1)for(var mi=Kr.parseCard8(),go=Kr.parseCard8(),Nr=mi;mi+go>=Nr;Nr+=1)ni[Nr]=or,or+=1}return new oe.CffEncoding(ni,ir)}(Ae,Xe+Dt.encoding,dn),Ke.encoding=Ke.encoding||Ke.cffEncoding,Ke.glyphs=new H.GlyphSet(Ke);for(var On=0;On<Ke.nGlyphs;On+=1)Ke.glyphs.push(On,H.cffGlyphLoader(Ke,On,fe,Bn.objects[On]))},z.make=function(Ae,Xe){for(var Ke,yt=new xe.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),dt=1/Xe.unitsPerEm,Pt={version:Xe.version,fullName:Xe.fullName,familyName:Xe.familyName,weight:Xe.weightName,fontBBox:Xe.fontBBox||[0,0,0,0],fontMatrix:[dt,0,0,dt,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},wt=[],Gt=1;Gt<Ae.length;Gt+=1)Ke=Ae.get(Gt),wt.push(Ke.name);var Dt=[];yt.header=new xe.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),yt.nameIndex=function(Mn){var Bn=new xe.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Bn.names=[];for(var dn=0;dn<Mn.length;dn+=1)Bn.names.push({name:"name_"+dn,type:"NAME",value:Mn[dn]});return Bn}([Xe.postScriptName]);var Bn,dn,sn=A(Pt,Dt);yt.topDictIndex=N(sn),yt.globalSubrIndex=new xe.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),yt.charsets=function(Mn,Bn){for(var dn=new xe.Record("Charsets",[{name:"format",type:"Card8",value:0}]),On=0;On<Mn.length;On+=1){var Ln=q(Mn[On],Bn);dn.fields.push({name:"glyph_"+On,type:"SID",value:Ln})}return dn}(wt,Dt),yt.charStringsIndex=function(Mn){for(var Bn=new xe.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),dn=0;dn<Mn.length;dn+=1){var On=Mn.get(dn),Ln=X(On);Bn.charStrings.push({name:On.name,type:"CHARSTRING",value:Ln})}return Bn}(Ae),yt.privateDict=(Bn=Dt,(dn=new xe.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=Y(Ge,{},Bn),dn),yt.stringIndex=function(Mn){var Bn=new xe.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Bn.strings=[];for(var dn=0;dn<Mn.length;dn+=1)Bn.strings.push({name:"string_"+dn,type:"STRING",value:Mn[dn]});return Bn}(Dt);var gt=yt.header.sizeOf()+yt.nameIndex.sizeOf()+yt.topDictIndex.sizeOf()+yt.stringIndex.sizeOf()+yt.globalSubrIndex.sizeOf();return Pt.charset=gt,Pt.encoding=0,Pt.charStrings=Pt.charset+yt.charsets.sizeOf(),Pt.private[1]=Pt.charStrings+yt.charStringsIndex.sizeOf(),sn=A(Pt,Dt),yt.topDictIndex=N(sn),yt}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(L,D,z){function M(he,ae,fe){he.segments.push({end:ae,start:ae,delta:-(ae-fe),offset:0})}var P=L("../check"),de=L("../parse"),ye=L("../table");z.parse=function(he,ae){var fe,le={};le.version=de.getUShort(he,ae),P.argument(0===le.version,"cmap table version should be 0."),le.numTables=de.getUShort(he,ae+2);var q=-1;for(fe=le.numTables-1;fe>=0;fe-=1){var Y=de.getUShort(he,ae+4+8*fe),A=de.getUShort(he,ae+4+8*fe+2);if(3===Y&&(0===A||1===A||10===A)){q=de.getULong(he,ae+4+8*fe+4);break}}if(-1===q)return null;var N=new de.Parser(he,ae+q);if(le.format=N.parseUShort(),12===le.format)!function(X,oe){var H,Ce;for(oe.parseUShort(),X.length=oe.parseULong(),X.language=oe.parseULong(),X.groupCount=Ce=oe.parseULong(),X.glyphIndexMap={},H=0;Ce>H;H+=1)for(var Q=oe.parseULong(),xe=oe.parseULong(),Pe=oe.parseULong(),Ge=Q;xe>=Ge;Ge+=1)X.glyphIndexMap[Ge]=Pe,Pe++}(le,N);else{if(4!==le.format)throw new Error("Only format 4 and 12 cmap tables are supported.");!function(X,oe,H,Ce,Q){var xe,Pe;X.length=oe.parseUShort(),X.language=oe.parseUShort(),X.segCount=Pe=oe.parseUShort()>>1,oe.skip("uShort",3),X.glyphIndexMap={};var Ge=new de.Parser(H,Ce+Q+14),Ae=new de.Parser(H,Ce+Q+16+2*Pe),Xe=new de.Parser(H,Ce+Q+16+4*Pe),Ke=new de.Parser(H,Ce+Q+16+6*Pe),yt=Ce+Q+16+8*Pe;for(xe=0;Pe-1>xe;xe+=1)for(var dt,Pt=Ge.parseUShort(),wt=Ae.parseUShort(),Gt=Xe.parseShort(),Dt=Ke.parseUShort(),sn=wt;Pt>=sn;sn+=1)0!==Dt?(yt=Ke.offset+Ke.relativeOffset-2,yt+=Dt,0!==(dt=de.getUShort(H,yt+=2*(sn-wt)))&&(dt=dt+Gt&65535)):dt=sn+Gt&65535,X.glyphIndexMap[sn]=dt}(le,N,he,ae,q)}return le},z.make=function(he){var ae,fe,le=new ye.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(le.segments=[],ae=0;ae<he.length;ae+=1){for(var q=he.get(ae),Y=0;Y<q.unicodes.length;Y+=1)M(le,q.unicodes[Y],ae);le.segments=le.segments.sort(function(Q,xe){return Q.start-xe.start})}le.segments.push({end:65535,start:65535,delta:1,offset:0}),le.segCountX2=2*(fe=le.segments.length),le.searchRange=2*Math.pow(2,Math.floor(Math.log(fe)/Math.log(2))),le.entrySelector=Math.log(le.searchRange/2)/Math.log(2),le.rangeShift=le.segCountX2-le.searchRange;var A=[],N=[],X=[],oe=[],H=[];for(ae=0;fe>ae;ae+=1){var Ce=le.segments[ae];A=A.concat({name:"end_"+ae,type:"USHORT",value:Ce.end}),N=N.concat({name:"start_"+ae,type:"USHORT",value:Ce.start}),X=X.concat({name:"idDelta_"+ae,type:"SHORT",value:Ce.delta}),oe=oe.concat({name:"idRangeOffset_"+ae,type:"USHORT",value:Ce.offset}),void 0!==Ce.glyphId&&(H=H.concat({name:"glyph_"+ae,type:"USHORT",value:Ce.glyphId}))}return le.fields=le.fields.concat(A),le.fields.push({name:"reservedPad",type:"USHORT",value:0}),le.fields=le.fields.concat(N),le.fields=le.fields.concat(X),le.fields=le.fields.concat(oe),le.fields=le.fields.concat(H),le.length=14+2*A.length+2+2*N.length+2*X.length+2*oe.length+2*H.length,le}},{"../check":2,"../parse":10,"../table":13}],16:[function(L,D,z){function M(q,Y){var A=JSON.stringify(q),N=256;for(var X in Y){var oe=parseInt(X);if(oe&&!(256>oe)){if(JSON.stringify(Y[X])===A)return oe;oe>=N&&(N=oe+1)}}return Y[N]=q,N}function P(q,Y,A){var N=M(Y.name,A);return[{name:"tag_"+q,type:"TAG",value:Y.tag},{name:"minValue_"+q,type:"FIXED",value:Y.minValue<<16},{name:"defaultValue_"+q,type:"FIXED",value:Y.defaultValue<<16},{name:"maxValue_"+q,type:"FIXED",value:Y.maxValue<<16},{name:"flags_"+q,type:"USHORT",value:0},{name:"nameID_"+q,type:"USHORT",value:N}]}function de(q,Y,A){var N={},X=new fe.Parser(q,Y);return N.tag=X.parseTag(),N.minValue=X.parseFixed(),N.defaultValue=X.parseFixed(),N.maxValue=X.parseFixed(),X.skip("uShort",1),N.name=A[X.parseUShort()]||{},N}function ye(q,Y,A,N){for(var X=[{name:"nameID_"+q,type:"USHORT",value:M(Y.name,N)},{name:"flags_"+q,type:"USHORT",value:0}],oe=0;oe<A.length;++oe){var H=A[oe].tag;X.push({name:"axis_"+q+" "+H,type:"FIXED",value:Y.coordinates[H]<<16})}return X}function he(q,Y,A,N){var X={},oe=new fe.Parser(q,Y);X.name=N[oe.parseUShort()]||{},oe.skip("uShort",1),X.coordinates={};for(var H=0;H<A.length;++H)X.coordinates[A[H].tag]=oe.parseFixed();return X}var ae=L("../check"),fe=L("../parse"),le=L("../table");z.make=function(q,Y){var A=new le.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:q.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:q.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*q.axes.length}]);A.offsetToData=A.sizeOf();for(var N=0;N<q.axes.length;N++)A.fields=A.fields.concat(P(N,q.axes[N],Y));for(var X=0;X<q.instances.length;X++)A.fields=A.fields.concat(ye(X,q.instances[X],q.axes,Y));return A},z.parse=function(q,Y,A){var N=new fe.Parser(q,Y),X=N.parseULong();ae.argument(65536===X,"Unsupported fvar table version.");var oe=N.parseOffset16();N.skip("uShort",1);for(var H=N.parseUShort(),Ce=N.parseUShort(),Q=N.parseUShort(),xe=N.parseUShort(),Pe=[],Ge=0;H>Ge;Ge++)Pe.push(de(q,Y+oe+Ge*Ce,A));for(var Ae=[],Xe=Y+oe+H*Ce,Ke=0;Q>Ke;Ke++)Ae.push(he(q,Xe+Ke*xe,Pe,A));return{axes:Pe,instances:Ae}}},{"../check":2,"../parse":10,"../table":13}],17:[function(L,D,z){function M(q,Y,A,N,X){var oe;return(Y&N)>0?(oe=q.parseByte(),!(Y&X)&&(oe=-oe),oe=A+oe):oe=(Y&X)>0?A:A+q.parseShort(),oe}function P(q,Y,A){var N,X,oe=new fe.Parser(Y,A);if(q.numberOfContours=oe.parseShort(),q._xMin=oe.parseShort(),q._yMin=oe.parseShort(),q._xMax=oe.parseShort(),q._yMax=oe.parseShort(),q.numberOfContours>0){var H,Ce=q.endPointIndices=[];for(H=0;H<q.numberOfContours;H+=1)Ce.push(oe.parseUShort());for(q.instructionLength=oe.parseUShort(),q.instructions=[],H=0;H<q.instructionLength;H+=1)q.instructions.push(oe.parseByte());var Q=Ce[Ce.length-1]+1;for(N=[],H=0;Q>H;H+=1)if(X=oe.parseByte(),N.push(X),(8&X)>0)for(var xe=oe.parseByte(),Pe=0;xe>Pe;Pe+=1)N.push(X),H+=1;if(he.argument(N.length===Q,"Bad flags."),Ce.length>0){var Ge,Ae=[];if(Q>0){for(H=0;Q>H;H+=1)(Ge={}).onCurve=!!(1&(X=N[H])),Ge.lastPointOfContour=Ce.indexOf(H)>=0,Ae.push(Ge);var Xe=0;for(H=0;Q>H;H+=1)(Ge=Ae[H]).x=M(oe,X=N[H],Xe,2,16),Xe=Ge.x;var Ke=0;for(H=0;Q>H;H+=1)(Ge=Ae[H]).y=M(oe,X=N[H],Ke,4,32),Ke=Ge.y}q.points=Ae}else q.points=[]}else if(0===q.numberOfContours)q.points=[];else{q.isComposite=!0,q.points=[],q.components=[];for(var yt=!0;yt;){N=oe.parseUShort();var dt={glyphIndex:oe.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&N)>0?(2&N)>0?(dt.dx=oe.parseShort(),dt.dy=oe.parseShort()):dt.matchedPoints=[oe.parseUShort(),oe.parseUShort()]:(2&N)>0?(dt.dx=oe.parseChar(),dt.dy=oe.parseChar()):dt.matchedPoints=[oe.parseByte(),oe.parseByte()],(8&N)>0?dt.xScale=dt.yScale=oe.parseF2Dot14():(64&N)>0?(dt.xScale=oe.parseF2Dot14(),dt.yScale=oe.parseF2Dot14()):(128&N)>0&&(dt.xScale=oe.parseF2Dot14(),dt.scale01=oe.parseF2Dot14(),dt.scale10=oe.parseF2Dot14(),dt.yScale=oe.parseF2Dot14()),q.components.push(dt),yt=!!(32&N)}}}function de(q,Y){for(var A=[],N=0;N<q.length;N+=1){var X=q[N];A.push({x:Y.xScale*X.x+Y.scale01*X.y+Y.dx,y:Y.scale10*X.x+Y.yScale*X.y+Y.dy,onCurve:X.onCurve,lastPointOfContour:X.lastPointOfContour})}return A}function ye(q,Y){if(Y.isComposite)for(var A=0;A<Y.components.length;A+=1){var N=Y.components[A],X=q.get(N.glyphIndex);if(X.getPath(),X.points){var oe;if(void 0===N.matchedPoints)oe=de(X.points,N);else{if(N.matchedPoints[0]>Y.points.length-1||N.matchedPoints[1]>X.points.length-1)throw Error("Matched points out of range in "+Y.name);var H=Y.points[N.matchedPoints[0]],Ce=X.points[N.matchedPoints[1]],Q={xScale:N.xScale,scale01:N.scale01,scale10:N.scale10,yScale:N.yScale,dx:0,dy:0};Ce=de([Ce],Q)[0],Q.dx=H.x-Ce.x,Q.dy=H.y-Ce.y,oe=de(X.points,Q)}Y.points=Y.points.concat(oe)}}return function(xe){var Pe=new le.Path;if(!xe)return Pe;for(var Ge=function(gt){for(var Mn=[],Bn=[],dn=0;dn<gt.length;dn+=1){var On=gt[dn];Bn.push(On),On.lastPointOfContour&&(Mn.push(Bn),Bn=[])}return he.argument(0===Bn.length,"There are still points left in the current contour."),Mn}(xe),Ae=0;Ae<Ge.length;Ae+=1){var Xe,Ke,yt=Ge[Ae],dt=yt[0],Pt=yt[yt.length-1];dt.onCurve?(Xe=null,Ke=!0):(Xe=dt=Pt.onCurve?Pt:{x:(dt.x+Pt.x)/2,y:(dt.y+Pt.y)/2},Ke=!1),Pe.moveTo(dt.x,dt.y);for(var wt=Ke?1:0;wt<yt.length;wt+=1){var Gt=yt[wt],Dt=0===wt?dt:yt[wt-1];if(Dt.onCurve&&Gt.onCurve)Pe.lineTo(Gt.x,Gt.y);else if(Dt.onCurve&&!Gt.onCurve)Xe=Gt;else if(Dt.onCurve||Gt.onCurve){if(Dt.onCurve||!Gt.onCurve)throw new Error("Invalid state.");Pe.quadraticCurveTo(Xe.x,Xe.y,Gt.x,Gt.y),Xe=null}else{var sn={x:(Dt.x+Gt.x)/2,y:(Dt.y+Gt.y)/2};Pe.quadraticCurveTo(Dt.x,Dt.y,sn.x,sn.y),Xe=Gt}}dt!==Pt&&(Xe?Pe.quadraticCurveTo(Xe.x,Xe.y,dt.x,dt.y):Pe.lineTo(dt.x,dt.y))}return Pe.closePath(),Pe}(Y.points)}var he=L("../check"),ae=L("../glyphset"),fe=L("../parse"),le=L("../path");z.parse=function(q,Y,A,N){var X,oe=new ae.GlyphSet(N);for(X=0;X<A.length-1;X+=1){var H=A[X];oe.push(X,H!==A[X+1]?ae.ttfGlyphLoader(N,X,P,q,Y+H,ye):ae.glyphLoader(N,X))}return oe}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(L,D,z){function M(fe,le){for(var q=new ae.Parser(fe,le),Y=q.parseUShort(),A=[],N=0;Y>N;N++)A[q.parseTag()]={offset:q.parseUShort()};return A}function P(fe,le){var q=new ae.Parser(fe,le),Y=q.parseUShort();if(1===Y){var A=q.parseUShort(),N=q.parseUShort(),X=q.parseUShortList(N);return function(Pe){return X[Pe-A]||0}}if(2===Y){for(var oe=q.parseUShort(),H=[],Ce=[],Q=[],xe=0;oe>xe;xe++)H[xe]=q.parseUShort(),Ce[xe]=q.parseUShort(),Q[xe]=q.parseUShort();return function(Pe){for(var Ge=0,Ae=H.length-1;Ae>Ge;){var Xe=Ge+Ae+1>>1;Pe<H[Xe]?Ae=Xe-1:Ge=Xe}return H[Ge]<=Pe&&Pe<=Ce[Ge]&&Q[Ge]||0}}}function de(fe,le){var q,Y=new ae.Parser(fe,le),A=Y.parseUShort(),N=function(On,Ln){var mn=new ae.Parser(On,Ln),cr=mn.parseUShort(),ir=mn.parseUShort();if(1===cr)return mn.parseUShortList(ir);if(2===cr){for(var ur=[];ir--;)for(var or=mn.parseUShort(),ni=mn.parseUShort(),Kr=mn.parseUShort(),pi=or;ni>=pi;pi++)ur[Kr++]=pi;return ur}}(fe,le+Y.parseUShort()),X=Y.parseUShort(),oe=Y.parseUShort();if(4===X&&0===oe){var H={};if(1===A){for(var Ce=Y.parseUShort(),Q=[],xe=Y.parseOffset16List(Ce),Pe=0;Ce>Pe;Pe++){var Ge=xe[Pe],Ae=H[Ge];if(!Ae){Ae={},Y.relativeOffset=Ge;for(var Xe=Y.parseUShort();Xe--;){var Ke=Y.parseUShort();X&&(q=Y.parseShort()),oe&&Y.parseShort(),Ae[Ke]=q}}Q[N[Pe]]=Ae}return function(On,Ln){var mn=Q[On];return mn?mn[Ln]:void 0}}if(2===A){for(var yt=Y.parseUShort(),dt=Y.parseUShort(),Pt=Y.parseUShort(),wt=Y.parseUShort(),Gt=P(fe,le+yt),Dt=P(fe,le+dt),sn=[],gt=0;Pt>gt;gt++)for(var Mn=sn[gt]=[],Bn=0;wt>Bn;Bn++)X&&(q=Y.parseShort()),oe&&Y.parseShort(),Mn[Bn]=q;var dn={};for(gt=0;gt<N.length;gt++)dn[N[gt]]=1;return function(On,Ln){if(dn[On]){var mn=Gt(On),cr=Dt(Ln),ir=sn[mn];return ir?ir[cr]:void 0}}}}}function ye(fe,le){var q=new ae.Parser(fe,le),Y=q.parseUShort(),A=q.parseUShort(),N=16&A,X=q.parseUShort(),oe=q.parseOffset16List(X),H={lookupType:Y,lookupFlag:A,markFilteringSet:N?q.parseUShort():-1};if(2===Y){for(var Ce=[],Q=0;X>Q;Q++)Ce.push(de(fe,le+oe[Q]));H.getKerningValue=function(xe,Pe){for(var Ge=Ce.length;Ge--;){var Ae=Ce[Ge](xe,Pe);if(void 0!==Ae)return Ae}return 0}}return H}var he=L("../check"),ae=L("../parse");z.parse=function(fe,le,q){var Y=new ae.Parser(fe,le),A=Y.parseFixed();he.argument(1===A,"Unsupported GPOS table version."),M(fe,le+Y.parseUShort()),M(fe,le+Y.parseUShort());var N=Y.parseUShort();Y.relativeOffset=N;for(var X=Y.parseUShort(),oe=Y.parseOffset16List(X),H=le+N,Ce=0;X>Ce;Ce++){var Q=ye(fe,H+oe[Ce]);2!==Q.lookupType||q.getGposKerningValue||(q.getGposKerningValue=Q.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(L,D,z){var M=L("../check"),P=L("../parse").Parser,de=new Array(9),ye=L("../table");de[1]=function(){var fe=this.offset+this.relativeOffset,le=this.parseUShort();return 1===le?{substFormat:1,coverage:this.parsePointer(P.coverage),deltaGlyphId:this.parseUShort()}:2===le?{substFormat:2,coverage:this.parsePointer(P.coverage),substitute:this.parseOffset16List()}:void M.assert(!1,"0x"+fe.toString(16)+": lookup type 1 format must be 1 or 2.")},de[2]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),sequences:this.parseListOfLists()}},de[3]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),alternateSets:this.parseListOfLists()}},de[4]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB ligature table identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var he={sequenceIndex:P.uShort,lookupListIndex:P.uShort};de[5]=function(){var fe=this.offset+this.relativeOffset,le=this.parseUShort();if(1===le)return{substFormat:le,coverage:this.parsePointer(P.coverage),ruleSets:this.parseListOfLists(function(){var A=this.parseUShort(),N=this.parseUShort();return{input:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(N,he)}})};if(2===le)return{substFormat:le,coverage:this.parsePointer(P.coverage),classDef:this.parsePointer(P.classDef),classSets:this.parseListOfLists(function(){var A=this.parseUShort(),N=this.parseUShort();return{classes:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(N,he)}})};if(3===le){var q=this.parseUShort(),Y=this.parseUShort();return{substFormat:le,coverages:this.parseList(q,P.pointer(P.coverage)),lookupRecords:this.parseRecordList(Y,he)}}M.assert(!1,"0x"+fe.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},de[6]=function(){var fe=this.offset+this.relativeOffset,le=this.parseUShort();return 1===le?{substFormat:1,coverage:this.parsePointer(P.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(he)}})}:2===le?{substFormat:2,coverage:this.parsePointer(P.coverage),backtrackClassDef:this.parsePointer(P.classDef),inputClassDef:this.parsePointer(P.classDef),lookaheadClassDef:this.parsePointer(P.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(he)}})}:3===le?{substFormat:3,backtrackCoverage:this.parseList(P.pointer(P.coverage)),inputCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),lookupRecords:this.parseRecordList(he)}:void M.assert(!1,"0x"+fe.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},de[7]=function(){var fe=this.parseUShort();M.argument(1===fe,"GSUB Extension Substitution subtable identifier-format must be 1");var le=this.parseUShort(),q=new P(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:le,extension:de[le].call(q)}},de[8]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),backtrackCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),substitutes:this.parseUShortList()}};var ae=new Array(9);ae[1]=function(fe){return new ye.Table("substitutionTable",1===fe.substFormat?[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)},{name:"deltaGlyphID",type:"USHORT",value:fe.deltaGlyphId}]:[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.ushortList("substitute",fe.substitute)))},ae[3]=function(fe){return M.assert(1===fe.substFormat,"Lookup type 3 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.tableList("altSet",fe.alternateSets,function(le){return new ye.Table("alternateSetTable",ye.ushortList("alternate",le))})))},ae[4]=function(fe){return M.assert(1===fe.substFormat,"Lookup type 4 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.tableList("ligSet",fe.ligatureSets,function(le){return new ye.Table("ligatureSetTable",ye.tableList("ligature",le,function(q){return new ye.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:q.ligGlyph}].concat(ye.ushortList("component",q.components,q.components.length+1)))}))})))},z.parse=function(fe,le){var q=new P(fe,le=le||0),Y=q.parseVersion();return M.argument(1===Y,"Unsupported GSUB table version."),{version:Y,scripts:q.parseScriptList(),features:q.parseFeatureList(),lookups:q.parseLookupList(de)}},z.make=function(fe){return new ye.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new ye.ScriptList(fe.scripts)},{name:"features",type:"TABLE",value:new ye.FeatureList(fe.features)},{name:"lookups",type:"TABLE",value:new ye.LookupList(fe.lookups,ae)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(L,D,z){var M=L("../check"),P=L("../parse"),de=L("../table");z.parse=function(ye,he){var ae={},fe=new P.Parser(ye,he);return ae.version=fe.parseVersion(),ae.fontRevision=Math.round(1e3*fe.parseFixed())/1e3,ae.checkSumAdjustment=fe.parseULong(),ae.magicNumber=fe.parseULong(),M.argument(1594834165===ae.magicNumber,"Font header has wrong magic number."),ae.flags=fe.parseUShort(),ae.unitsPerEm=fe.parseUShort(),ae.created=fe.parseLongDateTime(),ae.modified=fe.parseLongDateTime(),ae.xMin=fe.parseShort(),ae.yMin=fe.parseShort(),ae.xMax=fe.parseShort(),ae.yMax=fe.parseShort(),ae.macStyle=fe.parseUShort(),ae.lowestRecPPEM=fe.parseUShort(),ae.fontDirectionHint=fe.parseShort(),ae.indexToLocFormat=fe.parseShort(),ae.glyphDataFormat=fe.parseShort(),ae},z.make=function(ye){var he=Math.round((new Date).getTime()/1e3)+2082844800,ae=he;return ye.createdTimestamp&&(ae=ye.createdTimestamp+2082844800),new de.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:ae},{name:"modified",type:"LONGDATETIME",value:he},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],ye)}},{"../check":2,"../parse":10,"../table":13}],21:[function(L,D,z){var M=L("../parse"),P=L("../table");z.parse=function(de,ye){var he={},ae=new M.Parser(de,ye);return he.version=ae.parseVersion(),he.ascender=ae.parseShort(),he.descender=ae.parseShort(),he.lineGap=ae.parseShort(),he.advanceWidthMax=ae.parseUShort(),he.minLeftSideBearing=ae.parseShort(),he.minRightSideBearing=ae.parseShort(),he.xMaxExtent=ae.parseShort(),he.caretSlopeRise=ae.parseShort(),he.caretSlopeRun=ae.parseShort(),he.caretOffset=ae.parseShort(),ae.relativeOffset+=8,he.metricDataFormat=ae.parseShort(),he.numberOfHMetrics=ae.parseUShort(),he},z.make=function(de){return new P.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],de)}},{"../parse":10,"../table":13}],22:[function(L,D,z){var M=L("../parse"),P=L("../table");z.parse=function(de,ye,he,ae,fe){for(var le,q,Y=new M.Parser(de,ye),A=0;ae>A;A+=1){he>A&&(le=Y.parseUShort(),q=Y.parseShort());var N=fe.get(A);N.advanceWidth=le,N.leftSideBearing=q}},z.make=function(de){for(var ye=new P.Table("hmtx",[]),he=0;he<de.length;he+=1){var ae=de.get(he),le=ae.leftSideBearing||0;ye.fields.push({name:"advanceWidth_"+he,type:"USHORT",value:ae.advanceWidth||0}),ye.fields.push({name:"leftSideBearing_"+he,type:"SHORT",value:le})}return ye}},{"../parse":10,"../table":13}],23:[function(L,D,z){var M=L("../check"),P=L("../parse");z.parse=function(de,ye){var he={},ae=new P.Parser(de,ye),fe=ae.parseUShort();M.argument(0===fe,"Unsupported kern table version."),ae.skip("uShort",1);var le=ae.parseUShort();M.argument(0===le,"Unsupported kern sub-table version."),ae.skip("uShort",2);var q=ae.parseUShort();ae.skip("uShort",3);for(var Y=0;q>Y;Y+=1){var A=ae.parseUShort(),N=ae.parseUShort(),X=ae.parseShort();he[A+","+N]=X}return he}},{"../check":2,"../parse":10}],24:[function(L,D,z){var M=L("../parse");z.parse=function(P,de,ye,he){for(var ae=new M.Parser(P,de),fe=he?ae.parseUShort:ae.parseULong,le=[],q=0;ye+1>q;q+=1){var Y=fe.call(ae);he&&(Y*=2),le.push(Y)}return le}},{"../parse":10}],25:[function(L,D,z){var M=L("../check"),P=L("../parse"),de=L("../table");z.make=function(ye){for(var he=new de.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:ye.length}]),ae="",fe=12+4*ye.length,le=0;le<ye.length;++le){var q=ae.indexOf(ye[le]);0>q&&(q=ae.length,ae+=ye[le]),he.fields.push({name:"offset "+le,type:"USHORT",value:fe+q}),he.fields.push({name:"length "+le,type:"USHORT",value:ye[le].length})}return he.fields.push({name:"stringPool",type:"CHARARRAY",value:ae}),he},z.parse=function(ye,he){var ae=new P.Parser(ye,he),fe=ae.parseULong();M.argument(1===fe,"Unsupported ltag table version."),ae.skip("uLong",1);for(var le=ae.parseULong(),q=[],Y=0;le>Y;Y++){for(var A="",N=he+ae.parseUShort(),X=ae.parseUShort(),oe=N;N+X>oe;++oe)A+=String.fromCharCode(ye.getInt8(oe));q.push(A)}return q}},{"../check":2,"../parse":10,"../table":13}],26:[function(L,D,z){var M=L("../parse"),P=L("../table");z.parse=function(de,ye){var he={},ae=new M.Parser(de,ye);return he.version=ae.parseVersion(),he.numGlyphs=ae.parseUShort(),1===he.version&&(he.maxPoints=ae.parseUShort(),he.maxContours=ae.parseUShort(),he.maxCompositePoints=ae.parseUShort(),he.maxCompositeContours=ae.parseUShort(),he.maxZones=ae.parseUShort(),he.maxTwilightPoints=ae.parseUShort(),he.maxStorage=ae.parseUShort(),he.maxFunctionDefs=ae.parseUShort(),he.maxInstructionDefs=ae.parseUShort(),he.maxStackElements=ae.parseUShort(),he.maxSizeOfInstructions=ae.parseUShort(),he.maxComponentElements=ae.parseUShort(),he.maxComponentDepth=ae.parseUShort()),he},z.make=function(de){return new P.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:de}])}},{"../parse":10,"../table":13}],27:[function(L,D,z){var M=L("../types").decode,P=L("../check"),de=L("../parse"),ye=L("../table");z.parse=function(he,ae){var fe=new de.Parser(he,ae),le=fe.parseULong();P.argument(1===le,"Unsupported META table version."),fe.parseULong(),fe.parseULong();for(var q=fe.parseULong(),Y={},A=0;q>A;A++){var N=fe.parseTag(),X=fe.parseULong(),oe=fe.parseULong(),H=M.UTF8(he,ae+X,oe);Y[N]=H}return Y},z.make=function(he){var ae=Object.keys(he).length,fe="",le=16+12*ae,q=new ye.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:le},{name:"numTags",type:"ULONG",value:ae}]);for(var Y in he){var A=fe.length;fe+=he[Y],q.fields.push({name:"tag "+Y,type:"TAG",value:Y}),q.fields.push({name:"offset "+Y,type:"ULONG",value:le+A}),q.fields.push({name:"length "+Y,type:"ULONG",value:he[Y].length})}return q.fields.push({name:"stringPool",type:"CHARARRAY",value:fe}),q}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(L,D,z){function M(xe,Pe,Ge){switch(xe){case 0:if(65535===Pe)return"und";if(Ge)return Ge[Pe];break;case 1:return N[Pe];case 3:return oe[Pe]}}function P(xe,Pe,Ge){switch(xe){case 0:return H;case 1:return Q[Ge]||Ce[Pe];case 3:if(1===Pe||10===Pe)return H}}function de(xe){var Pe={};for(var Ge in xe)Pe[xe[Ge]]=parseInt(Ge);return Pe}function ye(xe,Pe,Ge,Ae,Xe,Ke){return new Y.Record("NameRecord",[{name:"platformID",type:"USHORT",value:xe},{name:"encodingID",type:"USHORT",value:Pe},{name:"languageID",type:"USHORT",value:Ge},{name:"nameID",type:"USHORT",value:Ae},{name:"length",type:"USHORT",value:Xe},{name:"offset",type:"USHORT",value:Ke}])}function he(xe,Pe){var Ge=function(Ke,yt){var dt=Ke.length,Pt=yt.length-dt+1;e:for(var wt=0;Pt>wt;wt++)for(;Pt>wt;wt++){for(var Gt=0;dt>Gt;Gt++)if(yt[wt+Gt]!==Ke[Gt])continue e;return wt}return-1}(xe,Pe);if(0>Ge){Ge=Pe.length;for(var Ae=0,Xe=xe.length;Xe>Ae;++Ae)Pe.push(xe[Ae])}return Ge}var ae=L("../types"),fe=ae.decode,le=ae.encode,q=L("../parse"),Y=L("../table"),A=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],N={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},X={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},oe={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},H="utf-16",Ce={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Q={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};z.parse=function(xe,Pe,Ge){for(var Ae={},Xe=new q.Parser(xe,Pe),Ke=Xe.parseUShort(),yt=Xe.parseUShort(),dt=Xe.offset+Xe.parseUShort(),Pt=0;yt>Pt;Pt++){var wt,Gt=Xe.parseUShort(),Dt=Xe.parseUShort(),sn=Xe.parseUShort(),gt=Xe.parseUShort(),Mn=A[gt]||gt,Bn=Xe.parseUShort(),dn=Xe.parseUShort(),On=M(Gt,sn,Ge),Ln=P(Gt,Dt,sn);if(void 0!==Ln&&void 0!==On&&(wt=Ln===H?fe.UTF16(xe,dt+dn,Bn):fe.MACSTRING(xe,dt+dn,Bn,Ln))){var mn=Ae[Mn];void 0===mn&&(mn=Ae[Mn]={}),mn[On]=wt}}return 1===Ke&&Xe.parseUShort(),Ae},z.make=function(xe,Pe){var Ge,Ae=[],Xe={},Ke=de(A);for(var yt in xe){var dt=Ke[yt];if(void 0===dt&&(dt=yt),Ge=parseInt(dt),isNaN(Ge))throw new Error('Name table entry "'+yt+'" does not exist, see nameTableNames for complete list.');Xe[Ge]=xe[yt],Ae.push(Ge)}for(var Pt=de(N),wt=de(oe),Gt=[],Dt=[],sn=0;sn<Ae.length;sn++){var gt=Xe[Ge=Ae[sn]];for(var Mn in gt){var Bn=gt[Mn],dn=1,On=Pt[Mn],Ln=X[On],mn=P(dn,Ln,On),cr=le.MACSTRING(Bn,mn);void 0===cr&&(dn=0,0>(On=Pe.indexOf(Mn))&&(On=Pe.length,Pe.push(Mn)),Ln=4,cr=le.UTF16(Bn));var ir=he(cr,Dt);Gt.push(ye(dn,Ln,On,Ge,cr.length,ir));var ur=wt[Mn];if(void 0!==ur){var or=le.UTF16(Bn),ni=he(or,Dt);Gt.push(ye(3,1,ur,Ge,or.length,ni))}}}Gt.sort(function(rr,vr){return rr.platformID-vr.platformID||rr.encodingID-vr.encodingID||rr.languageID-vr.languageID||rr.nameID-vr.nameID});for(var Kr=new Y.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:Gt.length},{name:"stringOffset",type:"USHORT",value:6+12*Gt.length}]),pi=0;pi<Gt.length;pi++)Kr.fields.push({name:"record_"+pi,type:"RECORD",value:Gt[pi]});return Kr.fields.push({name:"strings",type:"LITERAL",value:Dt}),Kr}},{"../parse":10,"../table":13,"../types":32}],29:[function(L,D,z){var M=L("../parse"),P=L("../table"),de=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];z.unicodeRanges=de,z.getUnicodeRange=function(ye){for(var he=0;he<de.length;he+=1){var ae=de[he];if(ye>=ae.begin&&ye<ae.end)return he}return-1},z.parse=function(ye,he){var ae={},fe=new M.Parser(ye,he);ae.version=fe.parseUShort(),ae.xAvgCharWidth=fe.parseShort(),ae.usWeightClass=fe.parseUShort(),ae.usWidthClass=fe.parseUShort(),ae.fsType=fe.parseUShort(),ae.ySubscriptXSize=fe.parseShort(),ae.ySubscriptYSize=fe.parseShort(),ae.ySubscriptXOffset=fe.parseShort(),ae.ySubscriptYOffset=fe.parseShort(),ae.ySuperscriptXSize=fe.parseShort(),ae.ySuperscriptYSize=fe.parseShort(),ae.ySuperscriptXOffset=fe.parseShort(),ae.ySuperscriptYOffset=fe.parseShort(),ae.yStrikeoutSize=fe.parseShort(),ae.yStrikeoutPosition=fe.parseShort(),ae.sFamilyClass=fe.parseShort(),ae.panose=[];for(var le=0;10>le;le++)ae.panose[le]=fe.parseByte();return ae.ulUnicodeRange1=fe.parseULong(),ae.ulUnicodeRange2=fe.parseULong(),ae.ulUnicodeRange3=fe.parseULong(),ae.ulUnicodeRange4=fe.parseULong(),ae.achVendID=String.fromCharCode(fe.parseByte(),fe.parseByte(),fe.parseByte(),fe.parseByte()),ae.fsSelection=fe.parseUShort(),ae.usFirstCharIndex=fe.parseUShort(),ae.usLastCharIndex=fe.parseUShort(),ae.sTypoAscender=fe.parseShort(),ae.sTypoDescender=fe.parseShort(),ae.sTypoLineGap=fe.parseShort(),ae.usWinAscent=fe.parseUShort(),ae.usWinDescent=fe.parseUShort(),ae.version>=1&&(ae.ulCodePageRange1=fe.parseULong(),ae.ulCodePageRange2=fe.parseULong()),ae.version>=2&&(ae.sxHeight=fe.parseShort(),ae.sCapHeight=fe.parseShort(),ae.usDefaultChar=fe.parseUShort(),ae.usBreakChar=fe.parseUShort(),ae.usMaxContent=fe.parseUShort()),ae},z.make=function(ye){return new P.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],ye)}},{"../parse":10,"../table":13}],30:[function(L,D,z){var M=L("../encoding"),P=L("../parse"),de=L("../table");z.parse=function(ye,he){var ae,fe={},le=new P.Parser(ye,he);switch(fe.version=le.parseVersion(),fe.italicAngle=le.parseFixed(),fe.underlinePosition=le.parseShort(),fe.underlineThickness=le.parseShort(),fe.isFixedPitch=le.parseULong(),fe.minMemType42=le.parseULong(),fe.maxMemType42=le.parseULong(),fe.minMemType1=le.parseULong(),fe.maxMemType1=le.parseULong(),fe.version){case 1:fe.names=M.standardNames.slice();break;case 2:for(fe.numberOfGlyphs=le.parseUShort(),fe.glyphNameIndex=new Array(fe.numberOfGlyphs),ae=0;ae<fe.numberOfGlyphs;ae++)fe.glyphNameIndex[ae]=le.parseUShort();for(fe.names=[],ae=0;ae<fe.numberOfGlyphs;ae++)if(fe.glyphNameIndex[ae]>=M.standardNames.length){var q=le.parseChar();fe.names.push(le.parseString(q))}break;case 2.5:for(fe.numberOfGlyphs=le.parseUShort(),fe.offset=new Array(fe.numberOfGlyphs),ae=0;ae<fe.numberOfGlyphs;ae++)fe.offset[ae]=le.parseChar()}return fe},z.make=function(){return new de.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(L,D,z){function M(Ae){return Math.log(Ae)/Math.log(2)|0}function P(Ae){for(;Ae.length%4!=0;)Ae.push(0);for(var Xe=0,Ke=0;Ke<Ae.length;Ke+=4)Xe+=(Ae[Ke]<<24)+(Ae[Ke+1]<<16)+(Ae[Ke+2]<<8)+Ae[Ke+3];return Xe%Math.pow(2,32)}function de(Ae,Xe,Ke,yt){return new le.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==Ae?Ae:""},{name:"checkSum",type:"ULONG",value:void 0!==Xe?Xe:0},{name:"offset",type:"ULONG",value:void 0!==Ke?Ke:0},{name:"length",type:"ULONG",value:void 0!==yt?yt:0}])}function ye(Ae){var Xe=new le.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);Xe.tables=Ae,Xe.numTables=Ae.length;var Ke=Math.pow(2,M(Xe.numTables));Xe.searchRange=16*Ke,Xe.entrySelector=M(Ke),Xe.rangeShift=16*Xe.numTables-Xe.searchRange;for(var yt=[],dt=[],Pt=Xe.sizeOf()+de().sizeOf()*Xe.numTables;Pt%4!=0;)Pt+=1,dt.push({name:"padding",type:"BYTE",value:0});for(var wt=0;wt<Ae.length;wt+=1){var Gt=Ae[wt];fe.argument(4===Gt.tableName.length,"Table name"+Gt.tableName+" is invalid.");var Dt=Gt.sizeOf(),sn=de(Gt.tableName,P(Gt.encode()),Pt,Dt);for(yt.push({name:sn.tag+" Table Record",type:"RECORD",value:sn}),dt.push({name:Gt.tableName+" table",type:"RECORD",value:Gt}),Pt+=Dt,fe.argument(!isNaN(Pt),"Something went wrong calculating the offset.");Pt%4!=0;)Pt+=1,dt.push({name:"padding",type:"BYTE",value:0})}return yt.sort(function(gt,Mn){return gt.value.tag>Mn.value.tag?1:-1}),Xe.fields=Xe.fields.concat(yt),Xe.fields=Xe.fields.concat(dt),Xe}function he(Ae,Xe,Ke){for(var yt=0;yt<Xe.length;yt+=1){var dt=Ae.charToGlyphIndex(Xe[yt]);if(dt>0)return Ae.glyphs.get(dt).getMetrics()}return Ke}function ae(Ae){for(var Xe=0,Ke=0;Ke<Ae.length;Ke+=1)Xe+=Ae[Ke];return Xe/Ae.length}var fe=L("../check"),le=L("../table"),q=L("./cmap"),Y=L("./cff"),A=L("./head"),N=L("./hhea"),X=L("./hmtx"),oe=L("./ltag"),H=L("./maxp"),Ce=L("./name"),Q=L("./os2"),xe=L("./post"),Pe=L("./gsub"),Ge=L("./meta");z.computeCheckSum=P,z.make=ye,z.fontToTable=function(Ae){for(var Xe,Ke=[],yt=[],dt=[],Pt=[],wt=[],Gt=[],Dt=[],sn=0,gt=0,Mn=0,Bn=0,dn=0,On=0;On<Ae.glyphs.length;On+=1){var Ln=Ae.glyphs.get(On),mn=0|Ln.unicode;if(isNaN(Ln.advanceWidth))throw new Error("Glyph "+Ln.name+" ("+On+"): advanceWidth is not a number.");(Xe>mn||void 0===Xe)&&mn>0&&(Xe=mn),mn>sn&&(sn=mn);var cr=Q.getUnicodeRange(mn);if(32>cr)gt|=1<<cr;else if(64>cr)Mn|=1<<cr-32;else if(96>cr)Bn|=1<<cr-64;else{if(!(123>cr))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");dn|=1<<cr-96}if(".notdef"!==Ln.name){var ir=Ln.getMetrics();Ke.push(ir.xMin),yt.push(ir.yMin),dt.push(ir.xMax),Pt.push(ir.yMax),Gt.push(ir.leftSideBearing),Dt.push(ir.rightSideBearing),wt.push(Ln.advanceWidth)}}var ur={xMin:Math.min.apply(null,Ke),yMin:Math.min.apply(null,yt),xMax:Math.max.apply(null,dt),yMax:Math.max.apply(null,Pt),advanceWidthMax:Math.max.apply(null,wt),advanceWidthAvg:ae(wt),minLeftSideBearing:Math.min.apply(null,Gt),maxLeftSideBearing:Math.max.apply(null,Gt),minRightSideBearing:Math.min.apply(null,Dt)};ur.ascender=Ae.ascender,ur.descender=Ae.descender;var or=A.make({flags:3,unitsPerEm:Ae.unitsPerEm,xMin:ur.xMin,yMin:ur.yMin,xMax:ur.xMax,yMax:ur.yMax,lowestRecPPEM:3,createdTimestamp:Ae.createdTimestamp}),ni=N.make({ascender:ur.ascender,descender:ur.descender,advanceWidthMax:ur.advanceWidthMax,minLeftSideBearing:ur.minLeftSideBearing,minRightSideBearing:ur.minRightSideBearing,xMaxExtent:ur.maxLeftSideBearing+(ur.xMax-ur.xMin),numberOfHMetrics:Ae.glyphs.length}),Kr=H.make(Ae.glyphs.length),pi=Q.make({xAvgCharWidth:Math.round(ur.advanceWidthAvg),usWeightClass:Ae.tables.os2.usWeightClass,usWidthClass:Ae.tables.os2.usWidthClass,usFirstCharIndex:Xe,usLastCharIndex:sn,ulUnicodeRange1:gt,ulUnicodeRange2:Mn,ulUnicodeRange3:Bn,ulUnicodeRange4:dn,fsSelection:Ae.tables.os2.fsSelection,sTypoAscender:ur.ascender,sTypoDescender:ur.descender,sTypoLineGap:0,usWinAscent:ur.yMax,usWinDescent:Math.abs(ur.yMin),ulCodePageRange1:1,sxHeight:he(Ae,"xyvw",{yMax:Math.round(ur.ascender/2)}).yMax,sCapHeight:he(Ae,"HIKLEFJMNTZBDPRAGOQSUVWXY",ur).yMax,usDefaultChar:Ae.hasChar(" ")?32:0,usBreakChar:Ae.hasChar(" ")?32:0}),rr=X.make(Ae.glyphs),vr=q.make(Ae.glyphs),mi=Ae.getEnglishName("fontFamily"),go=Ae.getEnglishName("fontSubfamily"),Nr=mi+" "+go,ei=Ae.getEnglishName("postScriptName");ei||(ei=mi.replace(/\s/g,"")+"-"+go);var Wr={};for(var yi in Ae.names)Wr[yi]=Ae.names[yi];Wr.uniqueID||(Wr.uniqueID={en:Ae.getEnglishName("manufacturer")+":"+Nr}),Wr.postScriptName||(Wr.postScriptName={en:ei}),Wr.preferredFamily||(Wr.preferredFamily=Ae.names.fontFamily),Wr.preferredSubfamily||(Wr.preferredSubfamily=Ae.names.fontSubfamily);var Ei=[],So=Ce.make(Wr,Ei),Xs=Ei.length>0?oe.make(Ei):void 0,ua=xe.make(),Ni=Y.make(Ae.glyphs,{version:Ae.getEnglishName("version"),fullName:Nr,familyName:mi,weightName:go,postScriptName:ei,unitsPerEm:Ae.unitsPerEm,fontBBox:[0,ur.yMin,ur.ascender,ur.advanceWidthMax]}),Eo=Ae.metas&&Object.keys(Ae.metas).length>0?Ge.make(Ae.metas):void 0,vo=[or,ni,Kr,pi,So,vr,ua,Ni,rr];Xs&&vo.push(Xs),Ae.tables.gsub&&vo.push(Pe.make(Ae.tables.gsub)),Eo&&vo.push(Eo);var Jr=ye(vo),os=P(Jr.encode()),Ir=Jr.fields,Va=!1;for(On=0;On<Ir.length;On+=1)if("head table"===Ir[On].name){Ir[On].value.checkSumAdjustment=2981146554-os,Va=!0;break}if(!Va)throw new Error("Could not find head table with checkSum to adjust.");return Jr}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(L,D,z){function M(A){return function(){return A}}var P=L("./check"),de=2147483648,ye={},he={},ae={};he.BYTE=function(A){return P.argument(A>=0&&255>=A,"Byte value should be between 0 and 255."),[A]},ae.BYTE=M(1),he.CHAR=function(A){return[A.charCodeAt(0)]},ae.CHAR=M(1),he.CHARARRAY=function(A){for(var N=[],X=0;X<A.length;X+=1)N[X]=A.charCodeAt(X);return N},ae.CHARARRAY=function(A){return A.length},he.USHORT=function(A){return[A>>8&255,255&A]},ae.USHORT=M(2),he.SHORT=function(A){return A>=32768&&(A=-(65536-A)),[A>>8&255,255&A]},ae.SHORT=M(2),he.UINT24=function(A){return[A>>16&255,A>>8&255,255&A]},ae.UINT24=M(3),he.ULONG=function(A){return[A>>24&255,A>>16&255,A>>8&255,255&A]},ae.ULONG=M(4),he.LONG=function(A){return A>=de&&(A=-(2*de-A)),[A>>24&255,A>>16&255,A>>8&255,255&A]},ae.LONG=M(4),he.FIXED=he.ULONG,ae.FIXED=ae.ULONG,he.FWORD=he.SHORT,ae.FWORD=ae.SHORT,he.UFWORD=he.USHORT,ae.UFWORD=ae.USHORT,he.LONGDATETIME=function(A){return[0,0,0,0,A>>24&255,A>>16&255,A>>8&255,255&A]},ae.LONGDATETIME=M(8),he.TAG=function(A){return P.argument(4===A.length,"Tag should be exactly 4 ASCII characters."),[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]},ae.TAG=M(4),he.Card8=he.BYTE,ae.Card8=ae.BYTE,he.Card16=he.USHORT,ae.Card16=ae.USHORT,he.OffSize=he.BYTE,ae.OffSize=ae.BYTE,he.SID=he.USHORT,ae.SID=ae.USHORT,he.NUMBER=function(A){return A>=-107&&107>=A?[A+139]:A>=108&&1131>=A?[247+((A-=108)>>8),255&A]:A>=-1131&&-108>=A?[251+((A=-A-108)>>8),255&A]:A>=-32768&&32767>=A?he.NUMBER16(A):he.NUMBER32(A)},ae.NUMBER=function(A){return he.NUMBER(A).length},he.NUMBER16=function(A){return[28,A>>8&255,255&A]},ae.NUMBER16=M(3),he.NUMBER32=function(A){return[29,A>>24&255,A>>16&255,A>>8&255,255&A]},ae.NUMBER32=M(5),he.REAL=function(A){var N=A.toString(),X=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(N);if(X){var oe=parseFloat("1e"+((X[2]?+X[2]:0)+X[1].length));N=(Math.round(A*oe)/oe).toString()}var H,Ce,Q="";for(H=0,Ce=N.length;Ce>H;H+=1){var xe=N[H];Q+="e"===xe?"-"===N[++H]?"c":"b":"."===xe?"a":"-"===xe?"e":xe}var Pe=[30];for(H=0,Ce=(Q+=1&Q.length?"f":"ff").length;Ce>H;H+=2)Pe.push(parseInt(Q.substr(H,2),16));return Pe},ae.REAL=function(A){return he.REAL(A).length},he.NAME=he.CHARARRAY,ae.NAME=ae.CHARARRAY,he.STRING=he.CHARARRAY,ae.STRING=ae.CHARARRAY,ye.UTF8=function(A,N,X){for(var oe=[],H=X,Ce=0;H>Ce;Ce++,N+=1)oe[Ce]=A.getUint8(N);return String.fromCharCode.apply(null,oe)},ye.UTF16=function(A,N,X){for(var oe=[],H=X/2,Ce=0;H>Ce;Ce++,N+=2)oe[Ce]=A.getUint16(N);return String.fromCharCode.apply(null,oe)},he.UTF16=function(A){for(var N=[],X=0;X<A.length;X+=1){var oe=A.charCodeAt(X);N[N.length]=oe>>8&255,N[N.length]=255&oe}return N},ae.UTF16=function(A){return 2*A.length};var fe={"x-mac-croatian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\u0160\u2122\xb4\xa8\u2260\u017d\xd8\u221e\xb1\u2264\u2265\u2206\xb5\u2202\u2211\u220f\u0161\u222b\xaa\xba\u03a9\u017e\xf8\xbf\xa1\xac\u221a\u0192\u2248\u0106\xab\u010c\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u0110\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\uf8ff\xa9\u2044\u20ac\u2039\u203a\xc6\xbb\u2013\xb7\u201a\u201e\u2030\xc2\u0107\xc1\u010d\xc8\xcd\xce\xcf\xcc\xd3\xd4\u0111\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u03c0\xcb\u02da\xb8\xca\xe6\u02c7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u2020\xb0\u0490\xa3\xa7\u2022\xb6\u0406\xae\xa9\u2122\u0402\u0452\u2260\u0403\u0453\u221e\xb1\u2264\u2265\u0456\xb5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040a\u045a\u0458\u0405\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\u040b\u045b\u040c\u045c\u0455\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u201e\u040e\u045e\u040f\u045f\u2116\u0401\u0451\u044f\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e","x-mac-gaelic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u1e02\xb1\u2264\u2265\u1e03\u010a\u010b\u1e0a\u1e0b\u1e1e\u1e1f\u0120\u0121\u1e40\xe6\xf8\u1e41\u1e56\u1e57\u027c\u0192\u017f\u1e60\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\u1e61\u1e9b\xff\u0178\u1e6a\u20ac\u2039\u203a\u0176\u0177\u1e6b\xb7\u1ef2\u1ef3\u204a\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\u2663\xd2\xda\xdb\xd9\u0131\xdd\xfd\u0174\u0175\u1e84\u1e85\u1e80\u1e81\u1e82\u1e83","x-mac-greek":"\xc4\xb9\xb2\xc9\xb3\xd6\xdc\u0385\xe0\xe2\xe4\u0384\xa8\xe7\xe9\xe8\xea\xeb\xa3\u2122\xee\xef\u2022\xbd\u2030\xf4\xf6\xa6\u20ac\xf9\xfb\xfc\u2020\u0393\u0394\u0398\u039b\u039e\u03a0\xdf\xae\xa9\u03a3\u03aa\xa7\u2260\xb0\xb7\u0391\xb1\u2264\u2265\xa5\u0392\u0395\u0396\u0397\u0399\u039a\u039c\u03a6\u03ab\u03a8\u03a9\u03ac\u039d\xac\u039f\u03a1\u2248\u03a4\xab\xbb\u2026\xa0\u03a5\u03a7\u0386\u0388\u0153\u2013\u2015\u201c\u201d\u2018\u2019\xf7\u0389\u038a\u038c\u038e\u03ad\u03ae\u03af\u03cc\u038f\u03cd\u03b1\u03b2\u03c8\u03b4\u03b5\u03c6\u03b3\u03b7\u03b9\u03be\u03ba\u03bb\u03bc\u03bd\u03bf\u03c0\u03ce\u03c1\u03c3\u03c4\u03b8\u03c9\u03c2\u03c7\u03c5\u03b6\u03ca\u03cb\u0390\u03b0\xad","x-mac-icelandic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\xdd\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\xd0\xf0\xde\xfe\xfd\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140a\u140b\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144e\u144f\u1450\u1451\u1455\u1456\u1466\u146d\u146e\u146f\u1470\u1472\u1473\u1483\u148b\u148c\u148d\u148e\u1490\u1491\xb0\u14a1\u14a5\u14a6\u2022\xb6\u14a7\xae\xa9\u2122\u14a8\u14aa\u14ab\u14bb\u14c2\u14c3\u14c4\u14c5\u14c7\u14c8\u14d0\u14ef\u14f0\u14f1\u14f2\u14f4\u14f5\u1505\u14d5\u14d6\u14d7\u14d8\u14da\u14db\u14ea\u1528\u1529\u152a\u152b\u152d\u2026\xa0\u152e\u153e\u1555\u1556\u1557\u2013\u2014\u201c\u201d\u2018\u2019\u1558\u1559\u155a\u155d\u1546\u1547\u1548\u1549\u154b\u154c\u1550\u157f\u1580\u1581\u1582\u1583\u1584\u1585\u158f\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15a0\u15a1\u15a2\u15a3\u15a4\u15a5\u15a6\u157c\u0141\u0142","x-mac-ce":"\xc4\u0100\u0101\xc9\u0104\xd6\xdc\xe1\u0105\u010c\xe4\u010d\u0106\u0107\xe9\u0179\u017a\u010e\xed\u010f\u0112\u0113\u0116\xf3\u0117\xf4\xf6\xf5\xfa\u011a\u011b\xfc\u2020\xb0\u0118\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\u0119\xa8\u2260\u0123\u012e\u012f\u012a\u2264\u2265\u012b\u0136\u2202\u2211\u0142\u013b\u013c\u013d\u013e\u0139\u013a\u0145\u0146\u0143\xac\u221a\u0144\u0147\u2206\xab\xbb\u2026\xa0\u0148\u0150\xd5\u0151\u014c\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\u014d\u0154\u0155\u0158\u2039\u203a\u0159\u0156\u0157\u0160\u201a\u201e\u0161\u015a\u015b\xc1\u0164\u0165\xcd\u017d\u017e\u016a\xd3\xd4\u016b\u016e\xda\u016f\u0170\u0171\u0172\u0173\xdd\xfd\u0137\u017b\u0141\u017c\u0122\u02c7",macintosh:"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\ufb01\ufb02\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-romanian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\u0102\u0218\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\u0103\u0219\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\u021a\u021b\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-turkish":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u011e\u011f\u0130\u0131\u015e\u015f\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\uf8a0\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7"};ye.MACSTRING=function(A,N,X,oe){var H=fe[oe];if(void 0!==H){for(var Ce="",Q=0;X>Q;Q++){var xe=A.getUint8(N+Q);Ce+=127>=xe?String.fromCharCode(xe):H[127&xe]}return Ce}};var le,q="function"==typeof WeakMap&&new WeakMap;he.MACSTRING=function(A,N){var X=function(Q){if(!le)for(var xe in le={},fe)le[xe]=new String(xe);var Pe=le[Q];if(void 0!==Pe){if(q){var Ge=q.get(Pe);if(void 0!==Ge)return Ge}var Ae=fe[Q];if(void 0!==Ae){for(var Xe={},Ke=0;Ke<Ae.length;Ke++)Xe[Ae.charCodeAt(Ke)]=Ke+128;return q&&q.set(Pe,Xe),Xe}}}(N);if(void 0!==X){for(var oe=[],H=0;H<A.length;H++){var Ce=A.charCodeAt(H);if(Ce>=128&&void 0===(Ce=X[Ce]))return;oe[H]=Ce}return oe}},ae.MACSTRING=function(A,N){var X=he.MACSTRING(A,N);return void 0!==X?X.length:0},he.INDEX=function(A){var N,X=1,oe=[X],H=[];for(N=0;N<A.length;N+=1){var Ce=he.OBJECT(A[N]);Array.prototype.push.apply(H,Ce),oe.push(X+=Ce.length)}if(0===H.length)return[0,0];var Q=[],xe=1+Math.floor(Math.log(X)/Math.log(2))/8|0,Pe=[void 0,he.BYTE,he.USHORT,he.UINT24,he.ULONG][xe];for(N=0;N<oe.length;N+=1){var Ge=Pe(oe[N]);Array.prototype.push.apply(Q,Ge)}return Array.prototype.concat(he.Card16(A.length),he.OffSize(xe),Q,H)},ae.INDEX=function(A){return he.INDEX(A).length},he.DICT=function(A){for(var N=[],X=Object.keys(A),oe=X.length,H=0;oe>H;H+=1){var Ce=parseInt(X[H],0),Q=A[Ce];N=(N=N.concat(he.OPERAND(Q.value,Q.type))).concat(he.OPERATOR(Ce))}return N},ae.DICT=function(A){return he.DICT(A).length},he.OPERATOR=function(A){return 1200>A?[A]:[12,A-1200]},he.OPERAND=function(A,N){var X=[];if(Array.isArray(N))for(var oe=0;oe<N.length;oe+=1)P.argument(A.length===N.length,"Not enough arguments given for type"+N),X=X.concat(he.OPERAND(A[oe],N[oe]));else if("SID"===N)X=X.concat(he.NUMBER(A));else if("offset"===N)X=X.concat(he.NUMBER32(A));else if("number"===N)X=X.concat(he.NUMBER(A));else{if("real"!==N)throw new Error("Unknown operand type "+N);X=X.concat(he.REAL(A))}return X},he.OP=he.BYTE,ae.OP=ae.BYTE;var Y="function"==typeof WeakMap&&new WeakMap;he.CHARSTRING=function(A){if(Y){var N=Y.get(A);if(void 0!==N)return N}for(var X=[],oe=A.length,H=0;oe>H;H+=1){var Ce=A[H];X=X.concat(he[Ce.type](Ce.value))}return Y&&Y.set(A,X),X},ae.CHARSTRING=function(A){return he.CHARSTRING(A).length},he.OBJECT=function(A){var N=he[A.type];return P.argument(void 0!==N,"No encoding function for type "+A.type),N(A.value)},ae.OBJECT=function(A){var N=ae[A.type];return P.argument(void 0!==N,"No sizeOf function for type "+A.type),N(A.value)},he.TABLE=function(A){var N,X=[],oe=A.fields.length,H=[],Ce=[];for(N=0;oe>N;N+=1){var Q=A.fields[N],xe=he[Q.type];P.argument(void 0!==xe,"No encoding function for field type "+Q.type+" ("+Q.name+")");var Pe=A[Q.name];void 0===Pe&&(Pe=Q.value);var Ge=xe(Pe);"TABLE"===Q.type?(Ce.push(X.length),X=X.concat([0,0]),H.push(Ge)):X=X.concat(Ge)}for(N=0;N<H.length;N+=1){var Ae=Ce[N],Xe=X.length;P.argument(65536>Xe,"Table "+A.tableName+" too big."),X[Ae]=Xe>>8,X[Ae+1]=255&Xe,X=X.concat(H[N])}return X},ae.TABLE=function(A){for(var N=0,X=A.fields.length,oe=0;X>oe;oe+=1){var H=A.fields[oe],Ce=ae[H.type];P.argument(void 0!==Ce,"No sizeOf function for field type "+H.type+" ("+H.name+")");var Q=A[H.name];void 0===Q&&(Q=H.value),N+=Ce(Q),"TABLE"===H.type&&(N+=2)}return N},he.RECORD=he.TABLE,ae.RECORD=ae.TABLE,he.LITERAL=function(A){return A},ae.LITERAL=function(A){return A.length},z.decode=ye,z.encode=he,z.sizeOf=ae},{"./check":2}],33:[function(L,D,z){z.isBrowser=function(){return typeof window<"u"},z.isNode=function(){return typeof window>"u"},z.nodeBufferToArrayBuffer=function(M){for(var P=new ArrayBuffer(M.length),de=new Uint8Array(P),ye=0;ye<M.length;++ye)de[ye]=M[ye];return P},z.arrayBufferToNodeBuffer=function(M){for(var P=new Buffer(M.byteLength),de=new Uint8Array(M),ye=0;ye<P.length;++ye)P[ye]=de[ye];return P},z.checkArgument=function(M,P){if(!M)throw P}},{}]},{},[9])(9)});var x=window.opentype},408:n=>{var o=/\n/,l="\n",x=/\s/;function L(M,P,de,ye){var he=M.indexOf(P,de);return-1===he||he>ye?ye:he}function D(M){return x.test(M)}function z(M,P,de,ye){return{start:P,end:P+Math.min(ye,de-P)}}n.exports=function(M,P){return n.exports.lines(M,P).map(function(de){return M.substring(de.start,de.end)}).join("\n")},n.exports.lines=function(M,P){if(0===(P=P||{}).width&&"nowrap"!==P.mode)return[];M=M||"";var de="number"==typeof P.width?P.width:Number.MAX_VALUE,ye=Math.max(0,P.start||0),he="number"==typeof P.end?P.end:M.length,ae=P.mode,fe=P.measure||z;return"pre"===ae?function(le,q,Y,A,N){for(var X=[],oe=Y,H=Y;H<A&&H<q.length;H++){var Ce=q.charAt(H),Q=o.test(Ce);if(Q||H===A-1){var xe=le(q,oe,Q?H:H+1,N);X.push(xe),oe=H+1}}return X}(fe,M,ye,he,de):function(le,q,Y,A,N,X){var oe=[],H=N;for("nowrap"===X&&(H=Number.MAX_VALUE);Y<A&&Y<q.length;){for(var Ce=L(q,l,Y,A);Y<Ce&&D(q.charAt(Y));)Y++;var Q=le(q,Y,Ce,H),xe=Y+(Q.end-Q.start),Pe=xe+l.length;if(xe<Ce){for(;xe>Y&&!D(q.charAt(xe));)xe--;if(xe===Y)Pe>Y+l.length&&Pe--,xe=Pe;else for(Pe=xe;xe>Y&&D(q.charAt(xe-l.length));)xe--}if(xe>=Y){var Ge=le(q,Y,xe,H);oe.push(Ge)}Y=Pe}return oe}(fe,M,ye,he,de,ae)}},720:n=>{n.exports=function(){for(var l={},x=0;x<arguments.length;x++){var L=arguments[x];for(var D in L)o.call(L,D)&&(l[D]=L[D])}return l};var o=Object.prototype.hasOwnProperty},500:(n,o,l)=>{var x=l(412);x.KeyframeTrack.prototype.color="#FF0000",x.KeyframeTrack.prototype.setColor=function(L){this.color=L},x.KeyframeTrack.prototype.sort=function(){for(var L=0;L<this.times.length;L++)for(var D=L+1;D<this.times.length;D++)if(this.times[L]>this.times[D]){var z=this.times[D];this.times[D]=this.times[L],this.times[L]=z;for(var M=this.getValueSize(),P=D*M,de=L*M,ye=0;ye<M;ye++)z=this.values[P+ye],this.values[P+ye]=this.values[de+ye],this.values[de+ye]=z}},x.KeyframeTrack._toJSON=x.KeyframeTrack.toJSON,x.KeyframeTrack.toJSON=function(L){var D=x.KeyframeTrack._toJSON.call(this,L);return D.color=L.color,D},x.KeyframeTrack._parse=x.KeyframeTrack.parse,x.KeyframeTrack.parse=function(L){var D=x.KeyframeTrack._parse.call(this,L);return void 0!==L.color&&(D.color=L.color),D}},10:(n,o,l)=>{l(412).Camera.prototype.render=function(x,L){x.render(L,this)}},939:(n,o,l)=>{l(412).BufferAttribute.prototype.toJSON=function(){return{type:"BufferAttribute",typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},itemSize:this.itemSize,normalized:this.normalized}}},12:(n,o,l)=>{l(412).InterleavedBuffer.prototype.toJSON=function(){return{typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},stride:this.stride,count:this.count,usage:this.usage}}},443:(n,o,l)=>{l(412).InterleavedBufferAttribute.prototype.toJSON=function(){return{type:"InterleavedBufferAttribute",data:this.data.toJSON(),itemSize:this.itemSize,offset:this.offset,normalized:this.normalized}}},870:(n,o,l)=>{var x=l(412);x.LightShadow.prototype.toJSON=function(){var L={};return L.bias=this.bias,L.radius=this.radius,L.mapSize={x:this.mapSize.x,y:this.mapSize.y},L.camera={top:this.camera.top,bottom:this.camera.bottom,far:this.camera.far,near:this.camera.near,left:this.camera.left,right:this.camera.right},L},x.LightShadow.prototype.fromJSON=function(L){if(void 0!==L.bias&&(this.bias=L.bias),void 0!==L.radius&&(this.radius=L.radius),void 0!==L.mapSize){var D=L.mapSize;this.mapSize.set(D.x,D.y)}if(void 0!==L.camera){var z=L.camera;this.camera.top=z.top,this.camera.bottom=z.bottom,this.camera.left=z.left,this.camera.right=z.right,this.camera.near=z.near,this.camera.far=z.far}}},819:(n,o,l)=>{var x=l(412);x.Fog.NONE=0,x.Fog.LINEAR=1,x.Fog.EXPONENTIAL=2}},__webpack_module_cache__={};function __webpack_require__(n){var o=__webpack_module_cache__[n];if(void 0!==o)return o.exports;var l=__webpack_module_cache__[n]={id:n,loaded:!1,exports:{}};return __webpack_modules__[n].call(l.exports,l,l.exports,__webpack_require__),l.loaded=!0,l.exports}__webpack_require__.amdO={},__webpack_require__.n=n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return __webpack_require__.d(o,{a:o}),o},__webpack_require__.d=(n,o)=>{for(var l in o)__webpack_require__.o(o,l)&&!__webpack_require__.o(n,l)&&Object.defineProperty(n,l,{enumerable:!0,get:o[l]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),__webpack_require__.hmd=n=>((n=Object.create(n)).children||(n.children=[]),Object.defineProperty(n,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+n.id)}}),n),__webpack_require__.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ARHandler:()=>Wo,AdaptiveToneMappingPass:()=>tu,AfterimagePass:()=>ui,AmbientLight:()=>Ls,AnimationMixer:()=>pc,AnimationTimer:()=>td,App:()=>Qo,ArraybufferUtils:()=>va,Audio:()=>Ot,AudioEmitter:()=>ii,AudioLoader:()=>Bh,Base64Utils:()=>ci,BloomPass:()=>Dr,BokehPass:()=>Ka,BufferUtils:()=>Za,CSS3DObject:()=>vl,CSS3DRenderer:()=>ku,CSS3DSprite:()=>lu,CanvasSprite:()=>kc,CanvasTexture:()=>Fa,CapsuleBufferGeometry:()=>Fc,ColorifyPass:()=>Lp,CompressedTexture:()=>jl,CopyPass:()=>eu,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>zl,DirectionalLight:()=>ml,DotScreenPass:()=>Bc,EffectComposer:()=>Mo,EventManager:()=>hn,FXAAPass:()=>qp,FileSystem:()=>Rn,FilmPass:()=>gl,FirstPersonControls:()=>nu,Font:()=>Ye,FontLoader:()=>ph,Gamepad:()=>Yr,GeometryLoader:()=>Ru,Group:()=>Tu,Gyroscope:()=>Ou,HTMLView:()=>rc,HemisphereLight:()=>Mu,HueSaturationPass:()=>Po,Image:()=>ms,ImageLoader:()=>Bu,InstancedMesh:()=>ea,Key:()=>li,Keyboard:()=>Vn,LegacyGeometryLoader:()=>xs,LensFlare:()=>ch,LightProbe:()=>Rc,LocalStorage:()=>ja,MaterialLoader:()=>iu,MathUtils:()=>Qc,Mesh:()=>uh,Model:()=>bt,Mouse:()=>Zr,NodeScript:()=>Ti,Nunu:()=>to,ObjectLoader:()=>Co,ObjectUtils:()=>pu,OrbitControls:()=>ba,OrthographicCamera:()=>Is,ParametricBufferGeometry:()=>Nu,ParticleEmitter:()=>ko,ParticleEmitterControl:()=>ji,ParticleGroup:()=>Vs,ParticleShaders:()=>Pu,Pass:()=>mr,PerspectiveCamera:()=>ke,PhysicsGenerator:()=>vi,PhysicsObject:()=>De,PointLight:()=>He,PositionalAudio:()=>Wt,Program:()=>hi,RectAreaLight:()=>In,RenderPass:()=>_l,RendererConfiguration:()=>Da,RendererState:()=>Kh,Resource:()=>wi,ResourceContainer:()=>L,ResourceManager:()=>oo,RoundedBoxBufferGeometry:()=>hh,SSAONOHPass:()=>Ai,SSAOPass:()=>Ro,SSAOShader:()=>Ns,Scene:()=>Fo,Script:()=>Sn,ShaderAttribute:()=>Lo,ShaderPass:()=>Jo,ShaderUtils:()=>kt,SkinnedMesh:()=>Hn,Sky:()=>Lr,SobelPass:()=>Ps,SpineAnimation:()=>ka,SpineTexture:()=>Lu,SpotLight:()=>Gs,Sprite:()=>Oc,SpriteSheetTexture:()=>Ul,TargetConfig:()=>ip,TechnicolorPass:()=>Kc,TerrainBufferGeometry:()=>hc,TextBitmap:()=>Vo,TextFile:()=>Fl,TextMesh:()=>na,TextSprite:()=>cc,Texture:()=>gs,TextureLoader:()=>Os,Timer:()=>ed,TizenKeyboard:()=>Mr,TwistModifier:()=>Fu,TypedArrayHelper:()=>Oo,UnitConverter:()=>xr,UnrealBloomPass:()=>Bs,VRHandler:()=>gi,Video:()=>Dl,VideoLoader:()=>Nh,VideoStream:()=>Ua,VideoTexture:()=>Sa,Viewport:()=>Io,WebcamTexture:()=>Hs,WorkerPool:()=>Es,WorkerTask:()=>dc});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{AABB:()=>he,ArrayCollisionMatrix:()=>le,BODY_SLEEP_STATES:()=>yt,BODY_TYPES:()=>Ke,Body:()=>dt,Box:()=>Ge,Broadphase:()=>ir,COLLISION_TYPES:()=>Ui,ConeTwistConstraint:()=>qu,Constraint:()=>du,ContactEquation:()=>To,ContactMaterial:()=>Yu,ConvexPolyhedron:()=>Q,Cylinder:()=>Xt,DistanceConstraint:()=>ds,Equation:()=>Ms,EventTarget:()=>q,FrictionEquation:()=>_c,GSSolver:()=>yu,GridBroadphase:()=>pi,Heightfield:()=>xn,HingeConstraint:()=>_p,JacobianElement:()=>fu,LockConstraint:()=>Xl,Mat3:()=>z,Material:()=>Ju,NaiveBroadphase:()=>vr,Narrowphase:()=>kr,ObjectCollisionMatrix:()=>D,Particle:()=>pn,Plane:()=>Fn,PointToPointConstraint:()=>mc,Pool:()=>bu,Quaternion:()=>Y,RAY_MODES:()=>go,Ray:()=>Nr,RaycastResult:()=>mi,RaycastVehicle:()=>Gh,RigidVehicle:()=>nh,RotationalEquation:()=>Tl,RotationalMotorEquation:()=>Xu,SAPBroadphase:()=>ps,SHAPE_TYPES:()=>X,SPHSystem:()=>pe,Shape:()=>oe,Solver:()=>yo,Sphere:()=>xc,SplitSolver:()=>As,Spring:()=>cl,Transform:()=>H,Trimesh:()=>pl,Vec3:()=>M,Vec3Pool:()=>Mp,World:()=>Un});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{ARHandler:()=>Wo,AdaptiveToneMappingPass:()=>tu,AfterimagePass:()=>ui,AmbientLight:()=>Ls,AnimationMixer:()=>pc,AnimationTimer:()=>td,App:()=>Qo,ArraybufferUtils:()=>va,Audio:()=>Ot,AudioEmitter:()=>ii,AudioLoader:()=>Bh,Base64Utils:()=>ci,BloomPass:()=>Dr,BokehPass:()=>Ka,BufferUtils:()=>Za,CSS3DObject:()=>vl,CSS3DRenderer:()=>ku,CSS3DSprite:()=>lu,CanvasSprite:()=>kc,CanvasTexture:()=>Fa,CapsuleBufferGeometry:()=>Fc,ColorifyPass:()=>Lp,CompressedTexture:()=>jl,CopyPass:()=>eu,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>zl,DirectionalLight:()=>ml,DotScreenPass:()=>Bc,EffectComposer:()=>Mo,EventManager:()=>hn,FXAAPass:()=>qp,FileSystem:()=>Rn,FilmPass:()=>gl,FirstPersonControls:()=>nu,Font:()=>Ye,FontLoader:()=>ph,Gamepad:()=>Yr,GeometryLoader:()=>Ru,Group:()=>Tu,Gyroscope:()=>Ou,HTMLView:()=>rc,HemisphereLight:()=>Mu,HueSaturationPass:()=>Po,Image:()=>ms,ImageLoader:()=>Bu,InstancedMesh:()=>ea,Key:()=>li,Keyboard:()=>Vn,LegacyGeometryLoader:()=>xs,LensFlare:()=>ch,LightProbe:()=>Rc,LocalStorage:()=>ja,MaterialLoader:()=>iu,MathUtils:()=>Qc,Mesh:()=>uh,Model:()=>bt,Mouse:()=>Zr,NodeScript:()=>Ti,Nunu:()=>to,ObjectLoader:()=>Co,ObjectUtils:()=>pu,OrbitControls:()=>ba,OrthographicCamera:()=>Is,ParametricBufferGeometry:()=>Nu,ParticleEmitter:()=>ko,ParticleEmitterControl:()=>ji,ParticleGroup:()=>Vs,ParticleShaders:()=>Pu,Pass:()=>mr,PerspectiveCamera:()=>ke,PhysicsGenerator:()=>vi,PhysicsObject:()=>De,PointLight:()=>He,PositionalAudio:()=>Wt,Program:()=>hi,RectAreaLight:()=>In,RenderPass:()=>_l,RendererConfiguration:()=>Da,RendererState:()=>Kh,Resource:()=>wi,ResourceContainer:()=>L,ResourceManager:()=>oo,RoundedBoxBufferGeometry:()=>hh,SSAONOHPass:()=>Ai,SSAOPass:()=>Ro,SSAOShader:()=>Ns,Scene:()=>Fo,Script:()=>Sn,ShaderAttribute:()=>Lo,ShaderPass:()=>Jo,ShaderUtils:()=>kt,SkinnedMesh:()=>Hn,Sky:()=>Lr,SobelPass:()=>Ps,SpineAnimation:()=>ka,SpineTexture:()=>Lu,SpotLight:()=>Gs,Sprite:()=>Oc,SpriteSheetTexture:()=>Ul,TargetConfig:()=>ip,TechnicolorPass:()=>Kc,TerrainBufferGeometry:()=>hc,TextBitmap:()=>Vo,TextFile:()=>Fl,TextMesh:()=>na,TextSprite:()=>cc,Texture:()=>gs,TextureLoader:()=>Os,Timer:()=>ed,TizenKeyboard:()=>Mr,TwistModifier:()=>Fu,TypedArrayHelper:()=>Oo,UnitConverter:()=>xr,UnrealBloomPass:()=>Bs,VRHandler:()=>gi,Video:()=>Dl,VideoLoader:()=>Nh,VideoStream:()=>Ua,VideoTexture:()=>Sa,Viewport:()=>Io,WebcamTexture:()=>Hs,WorkerPool:()=>Es,WorkerTask:()=>dc});var l=__webpack_require__(412),x=__webpack_require__(412);function L(){this.images=[],this.videos=[],this.audio=[],this.fonts=[],this.materials=[],this.textures=[],this.geometries=[],this.resources=[],this.shapes=[],this.skeletons=[]}x.AnimationClip.prototype.enabled=!0,x.AnimationClip.prototype.loop=l.LoopRepeat,x.AnimationClip.prototype.timeScale=1,x.AnimationClip.prototype.weight=1,x.AnimationClip._toJSON=x.AnimationClip.toJSON,x.AnimationClip.toJSON=function(a){var r=x.AnimationClip._toJSON.call(this,a);return r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight,r},x.AnimationClip._parse=x.AnimationClip.parse,x.AnimationClip.parse=function(a){var r=x.AnimationClip._parse.call(this,a);return void 0!==a.enabled&&(r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight),r},__webpack_require__(500),__webpack_require__(10),__webpack_require__(939),__webpack_require__(412).InstancedBufferAttribute.prototype.toJSON=function(){var a=l.BufferAttribute.prototype.toJSON.call(this);return a.type="InstancedBufferAttribute",a.meshPerAttribute=this.meshPerAttribute,a},__webpack_require__(12),__webpack_require__(443),L.libraries=["images","videos","audio","fonts","materials","textures","geometries","resources","shapes","skeletons"],L.prototype.copyResources=function(a){this.materials=a.materials,this.textures=a.textures,this.resources=a.resources,this.fonts=a.fonts,this.audio=a.audio,this.geometries=a.geometries,this.images=a.images,this.videos=a.videos,this.shapes=a.shapes,this.skeletons=a.skeletons},L.prototype.getTexture=function(a){return void 0===this.textures[a]&&console.warn("nunuStudio: ResourceContainer, Undefined texture",a),this.textures[a]},L.prototype.getGeometry=function(a){return void 0===this.geometries[a]&&console.warn("nunuStudio: ResourceContainer, Undefined geometry",a),this.geometries[a]},L.prototype.getMaterial=function(a){if(a instanceof Array){for(var r=[],h=0;h<a.length;h++)void 0===this.materials[a[h]]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),r.push(this.materials[a[h]]);return r}return void 0===this.materials[a]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),this.materials[a]},L.prototype.getFont=function(a){return void 0===this.fonts[a]&&console.warn("nunuStudio: ResourceContainer, Undefined font",a),this.fonts[a]},L.prototype.getAudio=function(a){return void 0===this.audio[a]&&console.warn("nunuStudio: ResourceContainer, Undefined audio",a),this.audio[a]};class D{constructor(){this.matrix={}}get(r,h){let{id:p}=r,{id:y}=h;if(y>p){const b=y;y=p,p=b}return p+"-"+y in this.matrix}set(r,h,p){let{id:y}=r,{id:b}=h;if(b>y){const R=b;b=y,y=R}p?this.matrix[y+"-"+b]=!0:delete this.matrix[y+"-"+b]}reset(){this.matrix={}}setNumObjects(r){}}class z{constructor(r=[0,0,0,0,0,0,0,0,0]){this.elements=r}identity(){const r=this.elements;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1}setZero(){const r=this.elements;r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0}setTrace(r){const h=this.elements;h[0]=r.x,h[4]=r.y,h[8]=r.z}getTrace(r=new M){const h=this.elements;r.x=h[0],r.y=h[4],r.z=h[8]}vmult(r,h=new M){const p=this.elements,y=r.x,b=r.y,R=r.z;return h.x=p[0]*y+p[1]*b+p[2]*R,h.y=p[3]*y+p[4]*b+p[5]*R,h.z=p[6]*y+p[7]*b+p[8]*R,h}smult(r){for(let h=0;h<this.elements.length;h++)this.elements[h]*=r}mmult(r,h=new z){const{elements:p}=r;for(let y=0;y<3;y++)for(let b=0;b<3;b++){let R=0;for(let O=0;O<3;O++)R+=p[y+3*O]*this.elements[O+3*b];h.elements[y+3*b]=R}return h}scale(r,h=new z){const p=this.elements,y=h.elements;for(let b=0;3!==b;b++)y[3*b+0]=r.x*p[3*b+0],y[3*b+1]=r.y*p[3*b+1],y[3*b+2]=r.z*p[3*b+2];return h}solve(r,h=new M){const p=[];let y,b;for(y=0;y<12;y++)p.push(0);for(y=0;y<3;y++)for(b=0;b<3;b++)p[y+4*b]=this.elements[y+3*b];p[3]=r.x,p[7]=r.y,p[11]=r.z;let R=3;const O=R;let T,U;do{if(y=O-R,0===p[y+4*y])for(b=y+1;b<O;b++)if(0!==p[y+4*b]){T=4;do{U=4-T,p[U+4*y]+=p[U+4*b]}while(--T);break}if(0!==p[y+4*y])for(b=y+1;b<O;b++){const ee=p[y+4*b]/p[y+4*y];T=4;do{U=4-T,p[U+4*b]=U<=y?0:p[U+4*b]-p[U+4*y]*ee}while(--T)}}while(--R);if(h.z=p[11]/p[10],h.y=(p[7]-p[6]*h.z)/p[5],h.x=(p[3]-p[2]*h.z-p[1]*h.y)/p[0],isNaN(h.x)||isNaN(h.y)||isNaN(h.z)||h.x===1/0||h.y===1/0||h.z===1/0)throw"Could not solve equation! Got x=["+h.toString()+"], b=["+r.toString()+"], A=["+this.toString()+"]";return h}e(r,h,p){if(void 0===p)return this.elements[h+3*r];this.elements[h+3*r]=p}copy(r){for(let h=0;h<r.elements.length;h++)this.elements[h]=r.elements[h];return this}toString(){let r="";for(let h=0;h<9;h++)r+=this.elements[h]+",";return r}reverse(r=new z){const h=[];let p,y;for(p=0;p<18;p++)h.push(0);for(p=0;p<3;p++)for(y=0;y<3;y++)h[p+6*y]=this.elements[p+3*y];h[3]=1,h[9]=0,h[15]=0,h[4]=0,h[10]=1,h[16]=0,h[5]=0,h[11]=0,h[17]=1;let b=3;const R=b;let O,T;do{if(p=R-b,0===h[p+6*p])for(y=p+1;y<R;y++)if(0!==h[p+6*y]){O=6;do{T=6-O,h[T+6*p]+=h[T+6*y]}while(--O);break}if(0!==h[p+6*p])for(y=p+1;y<R;y++){const U=h[p+6*y]/h[p+6*p];O=6;do{T=6-O,h[T+6*y]=T<=p?0:h[T+6*y]-h[T+6*p]*U}while(--O)}}while(--b);p=2;do{y=p-1;do{const U=h[p+6*y]/h[p+6*p];O=6;do{T=6-O,h[T+6*y]=h[T+6*y]-h[T+6*p]*U}while(--O)}while(y--)}while(--p);p=2;do{const U=1/h[p+6*p];O=6;do{T=6-O,h[T+6*p]=h[T+6*p]*U}while(--O)}while(p--);p=2;do{y=2;do{if(T=h[3+y+6*p],isNaN(T)||T===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(p,y,T)}while(y--)}while(p--);return r}setRotationFromQuaternion(r){const h=r.x,p=r.y,y=r.z,b=r.w,R=h+h,O=p+p,T=y+y,U=h*R,ee=h*O,ie=h*T,ne=p*O,ve=p*T,be=y*T,Te=b*R,Le=b*O,Ie=b*T,Oe=this.elements;return Oe[0]=1-(ne+be),Oe[1]=ee-Ie,Oe[2]=ie+Le,Oe[3]=ee+Ie,Oe[4]=1-(U+be),Oe[5]=ve-Te,Oe[6]=ie-Le,Oe[7]=ve+Te,Oe[8]=1-(U+ne),this}transpose(r=new z){const h=r.elements,p=this.elements;for(let y=0;3!==y;y++)for(let b=0;3!==b;b++)h[3*y+b]=p[3*b+y];return r}}class M{constructor(r=0,h=0,p=0){this.x=r,this.y=h,this.z=p}cross(r,h=new M){const p=r.x,y=r.y,b=r.z,R=this.x,O=this.y,T=this.z;return h.x=O*b-T*y,h.y=T*p-R*b,h.z=R*y-O*p,h}set(r,h,p){return this.x=r,this.y=h,this.z=p,this}setZero(){this.x=this.y=this.z=0}vadd(r,h){if(!h)return new M(this.x+r.x,this.y+r.y,this.z+r.z);h.x=r.x+this.x,h.y=r.y+this.y,h.z=r.z+this.z}vsub(r,h){if(!h)return new M(this.x-r.x,this.y-r.y,this.z-r.z);h.x=this.x-r.x,h.y=this.y-r.y,h.z=this.z-r.z}crossmat(){return new z([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const r=this.x,h=this.y,p=this.z,y=Math.sqrt(r*r+h*h+p*p);if(y>0){const b=1/y;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return y}unit(r=new M){const h=this.x,p=this.y,y=this.z;let b=Math.sqrt(h*h+p*p+y*y);return b>0?(b=1/b,r.x=h*b,r.y=p*b,r.z=y*b):(r.x=1,r.y=0,r.z=0),r}length(){const r=this.x,h=this.y,p=this.z;return Math.sqrt(r*r+h*h+p*p)}lengthSquared(){return this.dot(this)}distanceTo(r){const h=this.x,p=this.y,y=this.z,b=r.x,R=r.y,O=r.z;return Math.sqrt((b-h)*(b-h)+(R-p)*(R-p)+(O-y)*(O-y))}distanceSquared(r){const h=this.x,p=this.y,y=this.z,b=r.x,R=r.y,O=r.z;return(b-h)*(b-h)+(R-p)*(R-p)+(O-y)*(O-y)}scale(r,h=new M){const y=this.y,b=this.z;return h.x=r*this.x,h.y=r*y,h.z=r*b,h}vmul(r,h=new M){return h.x=r.x*this.x,h.y=r.y*this.y,h.z=r.z*this.z,h}addScaledVector(r,h,p=new M){return p.x=this.x+r*h.x,p.y=this.y+r*h.y,p.z=this.z+r*h.z,p}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(r=new M){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r}tangents(r,h){const p=this.length();if(p>0){const y=P,b=1/p;y.set(this.x*b,this.y*b,this.z*b);const R=de;Math.abs(y.x)<.9?(R.set(1,0,0),y.cross(R,r)):(R.set(0,1,0),y.cross(R,r)),y.cross(r,h)}else r.set(1,0,0),h.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}lerp(r,h,p){const y=this.x,b=this.y,R=this.z;p.x=y+(r.x-y)*h,p.y=b+(r.y-b)*h,p.z=R+(r.z-R)*h}almostEquals(r,h=1e-6){return!(Math.abs(this.x-r.x)>h||Math.abs(this.y-r.y)>h||Math.abs(this.z-r.z)>h)}almostZero(r=1e-6){return!(Math.abs(this.x)>r||Math.abs(this.y)>r||Math.abs(this.z)>r)}isAntiparallelTo(r,h){return this.negate(ye),ye.almostEquals(r,h)}clone(){return new M(this.x,this.y,this.z)}}M.ZERO=new M(0,0,0),M.UNIT_X=new M(1,0,0),M.UNIT_Y=new M(0,1,0),M.UNIT_Z=new M(0,0,1);const P=new M,de=new M,ye=new M;class he{constructor(r={}){this.lowerBound=new M,this.upperBound=new M,r.lowerBound&&this.lowerBound.copy(r.lowerBound),r.upperBound&&this.upperBound.copy(r.upperBound)}setFromPoints(r,h,p,y){const b=this.lowerBound,R=this.upperBound,O=p;b.copy(r[0]),O&&O.vmult(b,b),R.copy(b);for(let T=1;T<r.length;T++){let U=r[T];O&&(O.vmult(U,ae),U=ae),U.x>R.x&&(R.x=U.x),U.x<b.x&&(b.x=U.x),U.y>R.y&&(R.y=U.y),U.y<b.y&&(b.y=U.y),U.z>R.z&&(R.z=U.z),U.z<b.z&&(b.z=U.z)}return h&&(h.vadd(b,b),h.vadd(R,R)),y&&(b.x-=y,b.y-=y,b.z-=y,R.x+=y,R.y+=y,R.z+=y),this}copy(r){return this.lowerBound.copy(r.lowerBound),this.upperBound.copy(r.upperBound),this}clone(){return(new he).copy(this)}extend(r){this.lowerBound.x=Math.min(this.lowerBound.x,r.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,r.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,r.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,r.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,r.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,r.upperBound.z)}overlaps(r){const h=this.lowerBound,p=this.upperBound,y=r.lowerBound,b=r.upperBound;return(y.x<=p.x&&p.x<=b.x||h.x<=b.x&&b.x<=p.x)&&(y.y<=p.y&&p.y<=b.y||h.y<=b.y&&b.y<=p.y)&&(y.z<=p.z&&p.z<=b.z||h.z<=b.z&&b.z<=p.z)}volume(){const r=this.lowerBound,h=this.upperBound;return(h.x-r.x)*(h.y-r.y)*(h.z-r.z)}contains(r){const h=this.lowerBound,p=this.upperBound,y=r.lowerBound,b=r.upperBound;return h.x<=y.x&&p.x>=b.x&&h.y<=y.y&&p.y>=b.y&&h.z<=y.z&&p.z>=b.z}getCorners(r,h,p,y,b,R,O,T){const U=this.lowerBound,ee=this.upperBound;r.copy(U),h.set(ee.x,U.y,U.z),p.set(ee.x,ee.y,U.z),y.set(U.x,ee.y,ee.z),b.set(ee.x,U.y,ee.z),R.set(U.x,ee.y,U.z),O.set(U.x,U.y,ee.z),T.copy(ee)}toLocalFrame(r,h){const p=fe;this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(let ne=0;8!==ne;ne++){const ve=p[ne];r.pointToLocal(ve,ve)}return h.setFromPoints(p)}toWorldFrame(r,h){const p=fe;this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(let ne=0;8!==ne;ne++){const ve=p[ne];r.pointToWorld(ve,ve)}return h.setFromPoints(p)}overlapsRay(r){const{direction:h,from:p}=r,y=1/h.x,b=1/h.y,R=1/h.z,O=(this.lowerBound.x-p.x)*y,T=(this.upperBound.x-p.x)*y,U=(this.lowerBound.y-p.y)*b,ee=(this.upperBound.y-p.y)*b,ie=(this.lowerBound.z-p.z)*R,ne=(this.upperBound.z-p.z)*R,ve=Math.max(Math.max(Math.min(O,T),Math.min(U,ee)),Math.min(ie,ne)),be=Math.min(Math.min(Math.max(O,T),Math.max(U,ee)),Math.max(ie,ne));return!(be<0||ve>be)}}const ae=new M,fe=[new M,new M,new M,new M,new M,new M,new M,new M];class le{constructor(){this.matrix=[]}get(r,h){let{index:p}=r,{index:y}=h;if(y>p){const b=y;y=p,p=b}return this.matrix[(p*(p+1)>>1)+y-1]}set(r,h,p){let{index:y}=r,{index:b}=h;if(b>y){const R=b;b=y,y=R}this.matrix[(y*(y+1)>>1)+b-1]=p?1:0}reset(){for(let r=0,h=this.matrix.length;r!==h;r++)this.matrix[r]=0}setNumObjects(r){this.matrix.length=r*(r-1)>>1}}class q{constructor(){}addEventListener(r,h){void 0===this._listeners&&(this._listeners={});const p=this._listeners;return void 0===p[r]&&(p[r]=[]),p[r].includes(h)||p[r].push(h),this}hasEventListener(r,h){if(void 0===this._listeners)return!1;const p=this._listeners;return!(void 0===p[r]||!p[r].includes(h))}hasAnyEventListener(r){return void 0!==this._listeners&&void 0!==this._listeners[r]}removeEventListener(r,h){if(void 0===this._listeners)return this;const p=this._listeners;if(void 0===p[r])return this;const y=p[r].indexOf(h);return-1!==y&&p[r].splice(y,1),this}dispatchEvent(r){if(void 0===this._listeners)return this;const h=this._listeners[r.type];if(void 0!==h){r.target=this;for(let p=0,y=h.length;p<y;p++)h[p].call(this,r)}return this}}class Y{constructor(r=0,h=0,p=0,y=1){this.x=r,this.y=h,this.z=p,this.w=y}set(r,h,p,y){return this.x=r,this.y=h,this.z=p,this.w=y,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(r,h){const p=Math.sin(.5*h);return this.x=r.x*p,this.y=r.y*p,this.z=r.z*p,this.w=Math.cos(.5*h),this}toAxisAngle(r=new M){this.normalize();const h=2*Math.acos(this.w),p=Math.sqrt(1-this.w*this.w);return p<.001?(r.x=this.x,r.y=this.y,r.z=this.z):(r.x=this.x/p,r.y=this.y/p,r.z=this.z/p),[r,h]}setFromVectors(r,h){if(r.isAntiparallelTo(h)){const p=A;r.tangents(p,N),this.setFromAxisAngle(p,Math.PI)}else{const p=r.cross(h);this.x=p.x,this.y=p.y,this.z=p.z,this.w=Math.sqrt(r.length()**2*h.length()**2)+r.dot(h),this.normalize()}return this}mult(r,h=new Y){const p=this.x,y=this.y,b=this.z,R=this.w,O=r.x,T=r.y,U=r.z,ee=r.w;return h.x=p*ee+R*O+y*U-b*T,h.y=y*ee+R*T+b*O-p*U,h.z=b*ee+R*U+p*T-y*O,h.w=R*ee-p*O-y*T-b*U,h}inverse(r=new Y){const h=this.x,p=this.y,y=this.z,b=this.w;this.conjugate(r);const R=1/(h*h+p*p+y*y+b*b);return r.x*=R,r.y*=R,r.z*=R,r.w*=R,r}conjugate(r=new Y){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r.w=this.w,r}normalize(){let r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(r=1/r,this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}normalizeFast(){const r=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}vmult(r,h=new M){const p=r.x,y=r.y,b=r.z,R=this.x,O=this.y,T=this.z,U=this.w,ee=U*p+O*b-T*y,ie=U*y+T*p-R*b,ne=U*b+R*y-O*p,ve=-R*p-O*y-T*b;return h.x=ee*U+ve*-R+ie*-T-ne*-O,h.y=ie*U+ve*-O+ne*-R-ee*-T,h.z=ne*U+ve*-T+ee*-O-ie*-R,h}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w,this}toEuler(r,h="YZX"){let p,y,b;const R=this.x,O=this.y,T=this.z,U=this.w;if("YZX"!==h)throw new Error("Euler order "+h+" not supported yet.");{const ee=R*O+T*U;if(ee>.499&&(p=2*Math.atan2(R,U),y=Math.PI/2,b=0),ee<-.499&&(p=-2*Math.atan2(R,U),y=-Math.PI/2,b=0),void 0===p){const ie=R*R,ve=T*T;p=Math.atan2(2*O*U-2*R*T,1-O*O*2-2*ve),y=Math.asin(2*ee),b=Math.atan2(2*R*U-2*O*T,1-2*ie-2*ve)}}r.y=p,r.z=y,r.x=b}setFromEuler(r,h,p,y="XYZ"){const b=Math.cos(r/2),R=Math.cos(h/2),O=Math.cos(p/2),T=Math.sin(r/2),U=Math.sin(h/2),ee=Math.sin(p/2);return"XYZ"===y?(this.x=T*R*O+b*U*ee,this.y=b*U*O-T*R*ee,this.z=b*R*ee+T*U*O,this.w=b*R*O-T*U*ee):"YXZ"===y?(this.x=T*R*O+b*U*ee,this.y=b*U*O-T*R*ee,this.z=b*R*ee-T*U*O,this.w=b*R*O+T*U*ee):"ZXY"===y?(this.x=T*R*O-b*U*ee,this.y=b*U*O+T*R*ee,this.z=b*R*ee+T*U*O,this.w=b*R*O-T*U*ee):"ZYX"===y?(this.x=T*R*O-b*U*ee,this.y=b*U*O+T*R*ee,this.z=b*R*ee-T*U*O,this.w=b*R*O+T*U*ee):"YZX"===y?(this.x=T*R*O+b*U*ee,this.y=b*U*O+T*R*ee,this.z=b*R*ee-T*U*O,this.w=b*R*O-T*U*ee):"XZY"===y&&(this.x=T*R*O-b*U*ee,this.y=b*U*O-T*R*ee,this.z=b*R*ee+T*U*O,this.w=b*R*O+T*U*ee),this}clone(){return new Y(this.x,this.y,this.z,this.w)}slerp(r,h,p=new Y){const y=this.x,b=this.y,R=this.z,O=this.w;let T,U,ee,ie,ne,ve=r.x,be=r.y,Te=r.z,Le=r.w;return U=y*ve+b*be+R*Te+O*Le,U<0&&(U=-U,ve=-ve,be=-be,Te=-Te,Le=-Le),1-U>1e-6?(T=Math.acos(U),ee=Math.sin(T),ie=Math.sin((1-h)*T)/ee,ne=Math.sin(h*T)/ee):(ie=1-h,ne=h),p.x=ie*y+ne*ve,p.y=ie*b+ne*be,p.z=ie*R+ne*Te,p.w=ie*O+ne*Le,p}integrate(r,h,p,y=new Y){const b=r.x*p.x,R=r.y*p.y,O=r.z*p.z,T=this.x,U=this.y,ee=this.z,ie=this.w,ne=.5*h;return y.x+=ne*(b*ie+R*ee-O*U),y.y+=ne*(R*ie+O*T-b*ee),y.z+=ne*(O*ie+b*U-R*T),y.w+=ne*(-b*T-R*U-O*ee),y}}const A=new M,N=new M,X={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class oe{constructor(r={}){this.id=oe.idCounter++,this.type=r.type||0,this.boundingSphereRadius=0,this.collisionResponse=!r.collisionResponse||r.collisionResponse,this.collisionFilterGroup=void 0!==r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask=void 0!==r.collisionFilterMask?r.collisionFilterMask:-1,this.material=r.material?r.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(r,h){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(r,h,p,y){throw"calculateWorldAABB() not implemented for shape type "+this.type}}oe.idCounter=0,oe.types=X;class H{constructor(r={}){this.position=new M,this.quaternion=new Y,r.position&&this.position.copy(r.position),r.quaternion&&this.quaternion.copy(r.quaternion)}pointToLocal(r,h){return H.pointToLocalFrame(this.position,this.quaternion,r,h)}pointToWorld(r,h){return H.pointToWorldFrame(this.position,this.quaternion,r,h)}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}static pointToLocalFrame(r,h,p,y=new M){return p.vsub(r,y),h.conjugate(Ce),Ce.vmult(y,y),y}static pointToWorldFrame(r,h,p,y=new M){return h.vmult(p,y),y.vadd(r,y),y}static vectorToWorldFrame(r,h,p=new M){return r.vmult(h,p),p}static vectorToLocalFrame(r,h,p,y=new M){return h.w*=-1,h.vmult(p,y),h.w*=-1,y}}const Ce=new Y;class Q extends oe{constructor(r={}){const{vertices:h=[],faces:p=[],normals:y=[],axes:b,boundingSphereRadius:R}=r;super({type:oe.types.CONVEXPOLYHEDRON}),this.vertices=h,this.faces=p,this.faceNormals=y,0===this.faceNormals.length&&this.computeNormals(),R?this.boundingSphereRadius=R:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=b?b.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const r=this.faces,h=this.vertices,p=this.uniqueEdges;p.length=0;const y=new M;for(let b=0;b!==r.length;b++){const R=r[b],O=R.length;for(let T=0;T!==O;T++){h[R[T]].vsub(h[R[(T+1)%O]],y),y.normalize();let ee=!1;for(let ie=0;ie!==p.length;ie++)if(p[ie].almostEquals(y)||p[ie].almostEquals(y)){ee=!0;break}ee||p.push(y.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let r=0;r<this.faces.length;r++){for(let y=0;y<this.faces[r].length;y++)if(!this.vertices[this.faces[r][y]])throw new Error("Vertex "+this.faces[r][y]+" not found!");const h=this.faceNormals[r]||new M;if(this.getFaceNormal(r,h),h.negate(h),this.faceNormals[r]=h,h.dot(this.vertices[this.faces[r][0]])<0){console.error(".faceNormals["+r+"] = Vec3("+h.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let y=0;y<this.faces[r].length;y++)console.warn(".vertices["+this.faces[r][y]+"] = Vec3("+this.vertices[this.faces[r][y]].toString()+")")}}}getFaceNormal(r,h){const p=this.faces[r];Q.computeNormal(this.vertices[p[0]],this.vertices[p[1]],this.vertices[p[2]],h)}clipAgainstHull(r,h,p,y,b,R,O,T,U){const ee=new M;let ie=-1,ne=-Number.MAX_VALUE;for(let be=0;be<p.faces.length;be++){ee.copy(p.faceNormals[be]),b.vmult(ee,ee);const Te=ee.dot(R);Te>ne&&(ne=Te,ie=be)}const ve=[];for(let be=0;be<p.faces[ie].length;be++){const Te=p.vertices[p.faces[ie][be]],Le=new M;Le.copy(Te),b.vmult(Le,Le),y.vadd(Le,Le),ve.push(Le)}ie>=0&&this.clipFaceAgainstHull(R,r,h,ve,O,T,U)}findSeparatingAxis(r,h,p,y,b,R,O,T){const U=new M,ee=new M,ie=new M,ne=new M,ve=new M,be=new M;let Te=Number.MAX_VALUE;const Le=this;if(Le.uniqueAxes)for(let Ie=0;Ie!==Le.uniqueAxes.length;Ie++){p.vmult(Le.uniqueAxes[Ie],U);const Oe=Le.testSepAxis(U,r,h,p,y,b);if(!1===Oe)return!1;Oe<Te&&(Te=Oe,R.copy(U))}else{const Ie=O?O.length:Le.faces.length;for(let Oe=0;Oe<Ie;Oe++){U.copy(Le.faceNormals[O?O[Oe]:Oe]),p.vmult(U,U);const je=Le.testSepAxis(U,r,h,p,y,b);if(!1===je)return!1;je<Te&&(Te=je,R.copy(U))}}if(r.uniqueAxes)for(let Ie=0;Ie!==r.uniqueAxes.length;Ie++){b.vmult(r.uniqueAxes[Ie],ee);const Oe=Le.testSepAxis(ee,r,h,p,y,b);if(!1===Oe)return!1;Oe<Te&&(Te=Oe,R.copy(ee))}else{const Ie=T?T.length:r.faces.length;for(let Oe=0;Oe<Ie;Oe++){ee.copy(r.faceNormals[T?T[Oe]:Oe]),b.vmult(ee,ee);const je=Le.testSepAxis(ee,r,h,p,y,b);if(!1===je)return!1;je<Te&&(Te=je,R.copy(ee))}}for(let Ie=0;Ie!==Le.uniqueEdges.length;Ie++){p.vmult(Le.uniqueEdges[Ie],ne);for(let Oe=0;Oe!==r.uniqueEdges.length;Oe++)if(b.vmult(r.uniqueEdges[Oe],ve),ne.cross(ve,be),!be.almostZero()){be.normalize();const Fe=Le.testSepAxis(be,r,h,p,y,b);if(!1===Fe)return!1;Fe<Te&&(Te=Fe,R.copy(be))}}return y.vsub(h,ie),ie.dot(R)>0&&R.negate(R),!0}testSepAxis(r,h,p,y,b,R){Q.project(this,r,p,y,xe),Q.project(h,r,b,R,Pe);const O=xe[0],T=xe[1],U=Pe[0],ee=Pe[1];if(O<ee||U<T)return!1;const ie=O-ee,ne=U-T;return ie<ne?ie:ne}calculateLocalInertia(r,h){const p=new M,y=new M;this.computeLocalAABB(y,p);const b=p.x-y.x,R=p.y-y.y,O=p.z-y.z;h.x=1/12*r*(2*R*2*R+2*O*2*O),h.y=1/12*r*(2*b*2*b+2*O*2*O),h.z=1/12*r*(2*R*2*R+2*b*2*b)}getPlaneConstantOfFace(r){return-this.faceNormals[r].dot(this.vertices[this.faces[r][0]])}clipFaceAgainstHull(r,h,p,y,b,R,O){const T=new M,U=new M,ee=new M,ie=new M,ne=new M,ve=new M,be=new M,Te=new M,Le=this,Ie=y,Oe=[];let Fe=-1,je=Number.MAX_VALUE;for(let Mt=0;Mt<Le.faces.length;Mt++){T.copy(Le.faceNormals[Mt]),p.vmult(T,T);const Tt=T.dot(r);Tt<je&&(je=Tt,Fe=Mt)}if(Fe<0)return;const Ue=Le.faces[Fe];Ue.connectedFaces=[];for(let Mt=0;Mt<Le.faces.length;Mt++)for(let Tt=0;Tt<Le.faces[Mt].length;Tt++)-1!==Ue.indexOf(Le.faces[Mt][Tt])&&Mt!==Fe&&-1===Ue.connectedFaces.indexOf(Mt)&&Ue.connectedFaces.push(Mt);const Je=Ue.length;for(let Mt=0;Mt<Je;Mt++){const Tt=Le.vertices[Ue[Mt]];Tt.vsub(Le.vertices[Ue[(Mt+1)%Je]],U),ee.copy(U),p.vmult(ee,ee),h.vadd(ee,ee),ie.copy(this.faceNormals[Fe]),p.vmult(ie,ie),h.vadd(ie,ie),ee.cross(ie,ne),ne.negate(ne),ve.copy(Tt),p.vmult(ve,ve),h.vadd(ve,ve);const jt=Ue.connectedFaces[Mt];be.copy(this.faceNormals[jt]);const It=this.getPlaneConstantOfFace(jt);Te.copy(be),p.vmult(Te,Te);const Nt=It-Te.dot(h);for(this.clipFaceAgainstPlane(Ie,Oe,Te,Nt);Ie.length;)Ie.shift();for(;Oe.length;)Ie.push(Oe.shift())}be.copy(this.faceNormals[Fe]);const pt=this.getPlaneConstantOfFace(Fe);Te.copy(be),p.vmult(Te,Te);const at=pt-Te.dot(h);for(let Mt=0;Mt<Ie.length;Mt++){let Tt=Te.dot(Ie[Mt])+at;Tt<=b&&(console.log("clamped: depth="+Tt+" to minDist="+b),Tt=b),Tt<=R&&Tt<=1e-6&&O.push({point:Ie[Mt],normal:Te,depth:Tt})}}clipFaceAgainstPlane(r,h,p,y){let b,R;const O=r.length;if(O<2)return h;let T=r[r.length-1],U=r[0];b=p.dot(T)+y;for(let ee=0;ee<O;ee++){if(U=r[ee],R=p.dot(U)+y,b<0)if(R<0){const ie=new M;ie.copy(U),h.push(ie)}else{const ie=new M;T.lerp(U,b/(b-R),ie),h.push(ie)}else if(R<0){const ie=new M;T.lerp(U,b/(b-R),ie),h.push(ie),h.push(U)}T=U,b=R}return h}computeWorldVertices(r,h){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new M);const p=this.vertices,y=this.worldVertices;for(let b=0;b!==this.vertices.length;b++)h.vmult(p[b],y[b]),r.vadd(y[b],y[b]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(r,h){const p=this.vertices;r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),h.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let y=0;y<this.vertices.length;y++){const b=p[y];b.x<r.x?r.x=b.x:b.x>h.x&&(h.x=b.x),b.y<r.y?r.y=b.y:b.y>h.y&&(h.y=b.y),b.z<r.z?r.z=b.z:b.z>h.z&&(h.z=b.z)}}computeWorldFaceNormals(r){const h=this.faceNormals.length;for(;this.worldFaceNormals.length<h;)this.worldFaceNormals.push(new M);const p=this.faceNormals,y=this.worldFaceNormals;for(let b=0;b!==h;b++)r.vmult(p[b],y[b]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let r=0;const h=this.vertices;for(let p=0;p!==h.length;p++){const y=h[p].lengthSquared();y>r&&(r=y)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,p,y){const b=this.vertices;let R,O,T,U,ee,ie,ne=new M;for(let ve=0;ve<b.length;ve++)ne.copy(b[ve]),h.vmult(ne,ne),r.vadd(ne,ne),(void 0===R||ne.x<R)&&(R=ne.x),(void 0===U||ne.x>U)&&(U=ne.x),(void 0===O||ne.y<O)&&(O=ne.y),(void 0===ee||ne.y>ee)&&(ee=ne.y),(void 0===T||ne.z<T)&&(T=ne.z),(void 0===ie||ne.z>ie)&&(ie=ne.z);p.set(R,O,T),y.set(U,ee,ie)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(r=new M){const h=this.vertices;for(let p=0;p<h.length;p++)r.vadd(h[p],r);return r.scale(1/h.length,r),r}transformAllPoints(r,h){const p=this.vertices.length,y=this.vertices;if(h){for(let b=0;b<p;b++){const R=y[b];h.vmult(R,R)}for(let b=0;b<this.faceNormals.length;b++){const R=this.faceNormals[b];h.vmult(R,R)}}if(r)for(let b=0;b<p;b++){const R=y[b];R.vadd(r,R)}}pointIsInside(r){const h=this.vertices,p=this.faces,y=this.faceNormals,b=new M;this.getAveragePointLocal(b);for(let R=0;R<this.faces.length;R++){let O=y[R];const T=h[p[R][0]],U=new M;r.vsub(T,U);const ee=O.dot(U),ie=new M;b.vsub(T,ie);const ne=O.dot(ie);if(ee<0&&ne>0||ee>0&&ne<0)return!1}return-1}}Q.computeNormal=(a,r,h,p)=>{const y=new M,b=new M;r.vsub(a,b),h.vsub(r,y),y.cross(b,p),p.isZero()||p.normalize()};const xe=[],Pe=[];Q.project=(a,r,h,p,y)=>{const b=a.vertices.length,R=new M;let O=0,T=0;const U=new M,ee=a.vertices;U.setZero(),H.vectorToLocalFrame(h,p,r,R),H.pointToLocalFrame(h,p,U,U);const ie=U.dot(R);T=O=ee[0].dot(R);for(let ne=1;ne<b;ne++){const ve=ee[ne].dot(R);ve>O&&(O=ve),ve<T&&(T=ve)}if(T-=ie,O-=ie,T>O){const ne=T;T=O,O=ne}y[0]=O,y[1]=T};class Ge extends oe{constructor(r){super({type:oe.types.BOX}),this.halfExtents=r,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const r=this.halfExtents.x,h=this.halfExtents.y,p=this.halfExtents.z,y=M,b=[new y(-r,-h,-p),new y(r,-h,-p),new y(r,h,-p),new y(-r,h,-p),new y(-r,-h,p),new y(r,-h,p),new y(r,h,p),new y(-r,h,p)],R=[new y(0,0,1),new y(0,1,0),new y(1,0,0)],O=new Q({vertices:b,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:R});this.convexPolyhedronRepresentation=O,O.material=this.material}calculateLocalInertia(r,h=new M){return Ge.calculateInertia(this.halfExtents,r,h),h}getSideNormals(r,h){const p=r,y=this.halfExtents;if(p[0].set(y.x,0,0),p[1].set(0,y.y,0),p[2].set(0,0,y.z),p[3].set(-y.x,0,0),p[4].set(0,-y.y,0),p[5].set(0,0,-y.z),void 0!==h)for(let b=0;b!==p.length;b++)h.vmult(p[b],p[b]);return p}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(r,h,p){const y=this.halfExtents,b=[[y.x,y.y,y.z],[-y.x,y.y,y.z],[-y.x,-y.y,y.z],[-y.x,-y.y,-y.z],[y.x,-y.y,-y.z],[y.x,y.y,-y.z],[-y.x,y.y,-y.z],[y.x,-y.y,y.z]];for(let R=0;R<b.length;R++)Ae.set(b[R][0],b[R][1],b[R][2]),h.vmult(Ae,Ae),r.vadd(Ae,Ae),p(Ae.x,Ae.y,Ae.z)}calculateWorldAABB(r,h,p,y){const b=this.halfExtents;Xe[0].set(b.x,b.y,b.z),Xe[1].set(-b.x,b.y,b.z),Xe[2].set(-b.x,-b.y,b.z),Xe[3].set(-b.x,-b.y,-b.z),Xe[4].set(b.x,-b.y,-b.z),Xe[5].set(b.x,b.y,-b.z),Xe[6].set(-b.x,b.y,-b.z),Xe[7].set(b.x,-b.y,b.z);const R=Xe[0];h.vmult(R,R),r.vadd(R,R),y.copy(R),p.copy(R);for(let O=1;O<8;O++){const T=Xe[O];h.vmult(T,T),r.vadd(T,T);const U=T.x,ee=T.y,ie=T.z;U>y.x&&(y.x=U),ee>y.y&&(y.y=ee),ie>y.z&&(y.z=ie),U<p.x&&(p.x=U),ee<p.y&&(p.y=ee),ie<p.z&&(p.z=ie)}}}Ge.calculateInertia=(a,r,h)=>{const p=a;h.x=1/12*r*(2*p.y*2*p.y+2*p.z*2*p.z),h.y=1/12*r*(2*p.x*2*p.x+2*p.z*2*p.z),h.z=1/12*r*(2*p.y*2*p.y+2*p.x*2*p.x)};const Ae=new M,Xe=[new M,new M,new M,new M,new M,new M,new M,new M],Ke={DYNAMIC:1,STATIC:2,KINEMATIC:4},yt={AWAKE:0,SLEEPY:1,SLEEPING:2};class dt extends q{constructor(r={}){super(),this.id=dt.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new M,this.collisionFilterGroup="number"==typeof r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof r.collisionFilterMask?r.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof r.collisionResponse||r.collisionResponse,this.position=new M,this.previousPosition=new M,this.interpolatedPosition=new M,this.initPosition=new M,r.position&&(this.position.copy(r.position),this.previousPosition.copy(r.position),this.interpolatedPosition.copy(r.position),this.initPosition.copy(r.position)),this.velocity=new M,r.velocity&&this.velocity.copy(r.velocity),this.initVelocity=new M,this.force=new M;const h="number"==typeof r.mass?r.mass:0;this.mass=h,this.invMass=h>0?1/h:0,this.material=r.material||null,this.linearDamping="number"==typeof r.linearDamping?r.linearDamping:.01,this.type=h<=0?dt.STATIC:dt.DYNAMIC,typeof r.type==typeof dt.STATIC&&(this.type=r.type),this.allowSleep=void 0===r.allowSleep||r.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==r.sleepSpeedLimit?r.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==r.sleepTimeLimit?r.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new M,this.quaternion=new Y,this.initQuaternion=new Y,this.previousQuaternion=new Y,this.interpolatedQuaternion=new Y,r.quaternion&&(this.quaternion.copy(r.quaternion),this.initQuaternion.copy(r.quaternion),this.previousQuaternion.copy(r.quaternion),this.interpolatedQuaternion.copy(r.quaternion)),this.angularVelocity=new M,r.angularVelocity&&this.angularVelocity.copy(r.angularVelocity),this.initAngularVelocity=new M,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new M,this.invInertia=new M,this.invInertiaWorld=new z,this.invMassSolve=0,this.invInertiaSolve=new M,this.invInertiaWorldSolve=new z,this.fixedRotation=void 0!==r.fixedRotation&&r.fixedRotation,this.angularDamping=void 0!==r.angularDamping?r.angularDamping:.01,this.linearFactor=new M(1,1,1),r.linearFactor&&this.linearFactor.copy(r.linearFactor),this.angularFactor=new M(1,1,1),r.angularFactor&&this.angularFactor.copy(r.angularFactor),this.aabb=new he,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new M,r.shape&&this.addShape(r.shape),this.updateMassProperties()}wakeUp(){const r=this.sleepState;this.sleepState=0,this.wakeUpAfterNarrowphase=!1,r===dt.SLEEPING&&this.dispatchEvent(dt.wakeupEvent)}sleep(){this.sleepState=dt.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(r){if(this.allowSleep){const h=this.sleepState,p=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),y=this.sleepSpeedLimit**2;h===dt.AWAKE&&p<y?(this.sleepState=dt.SLEEPY,this.timeLastSleepy=r,this.dispatchEvent(dt.sleepyEvent)):h===dt.SLEEPY&&p>y?this.wakeUp():h===dt.SLEEPY&&r-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(dt.sleepEvent))}}updateSolveMassProperties(){this.sleepState===dt.SLEEPING||this.type===dt.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(r,h=new M){return r.vsub(this.position,h),this.quaternion.conjugate().vmult(h,h),h}vectorToLocalFrame(r,h=new M){return this.quaternion.conjugate().vmult(r,h),h}pointToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h.vadd(this.position,h),h}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}addShape(r,h,p){const y=new M,b=new Y;return h&&y.copy(h),p&&b.copy(p),this.shapes.push(r),this.shapeOffsets.push(y),this.shapeOrientations.push(b),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,r.body=this,this}updateBoundingRadius(){const r=this.shapes,h=this.shapeOffsets,p=r.length;let y=0;for(let b=0;b!==p;b++){const R=r[b];R.updateBoundingSphereRadius();const O=h[b].length(),T=R.boundingSphereRadius;O+T>y&&(y=O+T)}this.boundingRadius=y}computeAABB(){const r=this.shapes,h=this.shapeOffsets,p=this.shapeOrientations,y=r.length,b=Pt,R=wt,O=this.quaternion,T=this.aabb,U=Gt;for(let ee=0;ee!==y;ee++){const ie=r[ee];O.vmult(h[ee],b),b.vadd(this.position,b),O.mult(p[ee],R),ie.calculateWorldAABB(b,R,U.lowerBound,U.upperBound),0===ee?T.copy(U):T.extend(U)}this.aabbNeedsUpdate=!1}updateInertiaWorld(r){const h=this.invInertia;if(h.x!==h.y||h.y!==h.z||r){const p=Dt,y=sn;p.setRotationFromQuaternion(this.quaternion),p.transpose(y),p.scale(h,p),p.mmult(y,this.invInertiaWorld)}}applyForce(r,h){if(this.type!==dt.DYNAMIC)return;const p=gt;h.cross(r,p),this.force.vadd(r,this.force),this.torque.vadd(p,this.torque)}applyLocalForce(r,h){if(this.type!==dt.DYNAMIC)return;const p=Mn,y=Bn;this.vectorToWorldFrame(r,p),this.vectorToWorldFrame(h,y),this.applyForce(p,y)}applyImpulse(r,h){if(this.type!==dt.DYNAMIC)return;const p=h,y=dn;y.copy(r),y.scale(this.invMass,y),this.velocity.vadd(y,this.velocity);const b=On;p.cross(r,b),this.invInertiaWorld.vmult(b,b),this.angularVelocity.vadd(b,this.angularVelocity)}applyLocalImpulse(r,h){if(this.type!==dt.DYNAMIC)return;const p=Ln,y=mn;this.vectorToWorldFrame(r,p),this.vectorToWorldFrame(h,y),this.applyImpulse(p,y)}updateMassProperties(){const r=cr;this.invMass=this.mass>0?1/this.mass:0;const h=this.inertia,p=this.fixedRotation;this.computeAABB(),r.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Ge.calculateInertia(r,this.mass,h),this.invInertia.set(h.x>0&&!p?1/h.x:0,h.y>0&&!p?1/h.y:0,h.z>0&&!p?1/h.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(r,h){const p=new M;return r.vsub(this.position,p),this.angularVelocity.cross(p,h),this.velocity.vadd(h,h),h}integrate(r,h,p){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==dt.DYNAMIC&&this.type!==dt.KINEMATIC||this.sleepState===dt.SLEEPING)return;const y=this.velocity,b=this.angularVelocity,R=this.position,O=this.force,T=this.torque,U=this.quaternion,ie=this.invInertiaWorld,ne=this.linearFactor,ve=this.invMass*r;y.x+=O.x*ve*ne.x,y.y+=O.y*ve*ne.y,y.z+=O.z*ve*ne.z;const be=ie.elements,Te=this.angularFactor,Le=T.x*Te.x,Ie=T.y*Te.y,Oe=T.z*Te.z;b.x+=r*(be[0]*Le+be[1]*Ie+be[2]*Oe),b.y+=r*(be[3]*Le+be[4]*Ie+be[5]*Oe),b.z+=r*(be[6]*Le+be[7]*Ie+be[8]*Oe),R.x+=y.x*r,R.y+=y.y*r,R.z+=y.z*r,U.integrate(this.angularVelocity,r,this.angularFactor,U),h&&(p?U.normalizeFast():U.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}dt.COLLIDE_EVENT_NAME="collide",dt.DYNAMIC=1,dt.STATIC=2,dt.KINEMATIC=4,dt.AWAKE=yt.AWAKE,dt.SLEEPY=yt.SLEEPY,dt.SLEEPING=yt.SLEEPING,dt.idCounter=0,dt.wakeupEvent={type:"wakeup"},dt.sleepyEvent={type:"sleepy"},dt.sleepEvent={type:"sleep"};const Pt=new M,wt=new Y,Gt=new he,Dt=new z,sn=new z,gt=new M,Mn=new M,Bn=new M,dn=new M,On=new M,Ln=new M,mn=new M,cr=new M;class ir{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(r,h,p){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(r,h){return 0!=(r.collisionFilterGroup&h.collisionFilterMask)&&0!=(h.collisionFilterGroup&r.collisionFilterMask)&&(0==(r.type&dt.STATIC)&&r.sleepState!==dt.SLEEPING||0==(h.type&dt.STATIC)&&h.sleepState!==dt.SLEEPING)}intersectionTest(r,h,p,y){this.useBoundingBoxes?this.doBoundingBoxBroadphase(r,h,p,y):this.doBoundingSphereBroadphase(r,h,p,y)}doBoundingSphereBroadphase(r,h,p,y){const b=ur;h.position.vsub(r.position,b);const R=(r.boundingRadius+h.boundingRadius)**2;b.lengthSquared()<R&&(p.push(r),y.push(h))}doBoundingBoxBroadphase(r,h,p,y){r.aabbNeedsUpdate&&r.computeAABB(),h.aabbNeedsUpdate&&h.computeAABB(),r.aabb.overlaps(h.aabb)&&(p.push(r),y.push(h))}makePairsUnique(r,h){const p=or,y=ni,b=Kr,R=r.length;for(let O=0;O!==R;O++)y[O]=r[O],b[O]=h[O];r.length=0,h.length=0;for(let O=0;O!==R;O++){const T=y[O].id,U=b[O].id,ee=T<U?T+","+U:U+","+T;p[ee]=O,p.keys.push(ee)}for(let O=0;O!==p.keys.length;O++){const T=p.keys.pop(),U=p[T];r.push(y[U]),h.push(b[U]),delete p[T]}}setWorld(r){}aabbQuery(r,h,p){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const ur=new M,or={keys:[]},ni=[],Kr=[];ir.boundingSphereCheck=(a,r)=>{const h=new M;return a.position.vsub(r.position,h),Math.pow(a.shapes[0].boundingSphereRadius+r.shapes[0].boundingSphereRadius,2)>h.lengthSquared()};class pi extends ir{constructor(r=new M(100,100,100),h=new M(-100,-100,-100),p=10,y=10,b=10){super(),this.nx=p,this.ny=y,this.nz=b,this.aabbMin=r,this.aabbMax=h;const R=this.nx*this.ny*this.nz;if(R<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=R,this.binLengths.length=R;for(let O=0;O<R;O++)this.bins[O]=[],this.binLengths[O]=0}collisionPairs(r,h,p){const y=r.numObjects(),b=r.bodies,R=this.aabbMax,O=this.aabbMin,T=this.nx,U=this.ny,ee=this.nz,ie=U*ee,ne=ee,ve=1,be=R.x,Te=R.y,Le=R.z,Ie=O.x,Oe=O.y,Fe=O.z,je=T/(be-Ie),Ue=U/(Te-Oe),Je=ee/(Le-Fe),pt=(be-Ie)/T,at=(Te-Oe)/U,Mt=(Le-Fe)/ee,Tt=.5*Math.sqrt(pt*pt+at*at+Mt*Mt),Yt=oe.types,jt=Yt.SPHERE,It=Yt.PLANE,Nt=this.bins,ft=this.binLengths,$t=this.bins.length;for(let $n=0;$n!==$t;$n++)ft[$n]=0;const Zt=Math.ceil;function Tn($n,Qn,lr,jn,pr,Yn,wr){let Or=($n-Ie)*je|0,Ji=(Qn-Oe)*Ue|0,fo=(lr-Fe)*Je|0,wo=Zt((jn-Ie)*je),Uo=Zt((pr-Oe)*Ue),cs=Zt((Yn-Fe)*Je);Or<0?Or=0:Or>=T&&(Or=T-1),Ji<0?Ji=0:Ji>=U&&(Ji=U-1),fo<0?fo=0:fo>=ee&&(fo=ee-1),wo<0?wo=0:wo>=T&&(wo=T-1),Uo<0?Uo=0:Uo>=U&&(Uo=U-1),cs<0?cs=0:cs>=ee&&(cs=ee-1),Or*=ie,Ji*=ne,fo*=ve,wo*=ie,Uo*=ne,cs*=ve;for(let Ws=Or;Ws<=wo;Ws+=ie)for(let Ga=Ji;Ga<=Uo;Ga+=ne)for(let ks=fo;ks<=cs;ks+=ve){const qs=Ws+Ga+ks;Nt[qs][ft[qs]++]=wr}}for(let $n=0;$n!==y;$n++){const Qn=b[$n],lr=Qn.shapes[0];switch(lr.type){case jt:{const pr=Qn.position.x,Yn=Qn.position.y,wr=Qn.position.z,Or=lr.radius;Tn(pr-Or,Yn-Or,wr-Or,pr+Or,Yn+Or,wr+Or,Qn);break}case It:{const jn=lr;jn.worldNormalNeedsUpdate&&jn.computeWorldNormal(Qn.quaternion);const pr=jn.worldNormal,wr=Oe+.5*at-Qn.position.y,Or=Fe+.5*Mt-Qn.position.z,Ji=rr;Ji.set(Ie+.5*pt-Qn.position.x,wr,Or);for(let fo=0,wo=0;fo!==T;fo++,wo+=ie,Ji.y=wr,Ji.x+=pt)for(let Uo=0,cs=0;Uo!==U;Uo++,cs+=ne,Ji.z=Or,Ji.y+=at)for(let Ws=0,Ga=0;Ws!==ee;Ws++,Ga+=ve,Ji.z+=Mt)if(Ji.dot(pr)<Tt){const ks=wo+cs+Ga;Nt[ks][ft[ks]++]=Qn}break}default:Qn.aabbNeedsUpdate&&Qn.computeAABB(),Tn(Qn.aabb.lowerBound.x,Qn.aabb.lowerBound.y,Qn.aabb.lowerBound.z,Qn.aabb.upperBound.x,Qn.aabb.upperBound.y,Qn.aabb.upperBound.z,Qn)}}for(let $n=0;$n!==$t;$n++){const Qn=ft[$n];if(Qn>1){const lr=Nt[$n];for(let jn=0;jn!==Qn;jn++){const pr=lr[jn];for(let Yn=0;Yn!==jn;Yn++){const wr=lr[Yn];this.needBroadphaseCollision(pr,wr)&&this.intersectionTest(pr,wr,h,p)}}}}this.makePairsUnique(h,p)}}const rr=new M;class vr extends ir{constructor(){super()}collisionPairs(r,h,p){const y=r.bodies,b=y.length;let R,O;for(let T=0;T!==b;T++)for(let U=0;U!==T;U++)R=y[T],O=y[U],this.needBroadphaseCollision(R,O)&&this.intersectionTest(R,O,h,p)}aabbQuery(r,h,p=[]){for(let y=0;y<r.bodies.length;y++){const b=r.bodies[y];b.aabbNeedsUpdate&&b.computeAABB(),b.aabb.overlaps(h)&&p.push(b)}return p}}class mi{constructor(){this.rayFromWorld=new M,this.rayToWorld=new M,this.hitNormalWorld=new M,this.hitPointWorld=new M,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(r,h,p,y,b,R,O){this.rayFromWorld.copy(r),this.rayToWorld.copy(h),this.hitNormalWorld.copy(p),this.hitPointWorld.copy(y),this.shape=b,this.body=R,this.distance=O}}const go={CLOSEST:1,ANY:2,ALL:4};class Nr{constructor(r=new M,h=new M){this.from=r.clone(),this.to=h.clone(),this.direction=new M,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Nr.ANY,this.result=new mi,this.hasHit=!1,this.callback=p=>{}}intersectWorld(r,h){return this.mode=h.mode||Nr.ANY,this.result=h.result||new mi,this.skipBackfaces=!!h.skipBackfaces,this.collisionFilterMask=void 0!==h.collisionFilterMask?h.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==h.collisionFilterGroup?h.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===h.checkCollisionResponse||h.checkCollisionResponse,h.from&&this.from.copy(h.from),h.to&&this.to.copy(h.to),this.callback=h.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(ei),Wr.length=0,r.broadphase.aabbQuery(r,ei,Wr),this.intersectBodies(Wr),this.hasHit}intersectBody(r,h){h&&(this.result=h,this.updateDirection());const p=this.checkCollisionResponse;if(p&&!r.collisionResponse||!(this.collisionFilterGroup&r.collisionFilterMask)||!(r.collisionFilterGroup&this.collisionFilterMask))return;const y=Xs,b=ua;for(let R=0,O=r.shapes.length;R<O;R++){const T=r.shapes[R];if((!p||T.collisionResponse)&&(r.quaternion.mult(r.shapeOrientations[R],b),r.quaternion.vmult(r.shapeOffsets[R],y),y.vadd(r.position,y),this.intersectShape(T,b,y,r),this.result.shouldStop))break}}intersectBodies(r,h){h&&(this.result=h,this.updateDirection());for(let p=0,y=r.length;!this.result.shouldStop&&p<y;p++)this.intersectBody(r[p])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(r,h,p,y){if(function(O,T,U){U.vsub(O,Js);const ee=Js.dot(T);return T.scale(ee,Xo),Xo.vadd(O,Xo),U.distanceTo(Xo)}(this.from,this.direction,p)>r.boundingSphereRadius)return;const R=this[r.type];R&&R.call(this,r,h,p,y,r)}_intersectBox(r,h,p,y,b){return this._intersectConvex(r.convexPolyhedronRepresentation,h,p,y,b)}_intersectPlane(r,h,p,y,b){const R=this.from,O=this.to,T=this.direction,U=new M(0,0,1);h.vmult(U,U);const ee=new M;R.vsub(p,ee);const ie=ee.dot(U);if(O.vsub(p,ee),ie*ee.dot(U)>0||R.distanceTo(O)<ie)return;const ne=U.dot(T);if(Math.abs(ne)<this.precision)return;const ve=new M,be=new M,Te=new M;R.vsub(p,ve);const Le=-U.dot(ve)/ne;T.scale(Le,be),R.vadd(be,Te),this.reportIntersection(U,Te,b,y,-1)}getAABB(r){const{lowerBound:h,upperBound:p}=r,y=this.to,b=this.from;h.x=Math.min(y.x,b.x),h.y=Math.min(y.y,b.y),h.z=Math.min(y.z,b.z),p.x=Math.max(y.x,b.x),p.y=Math.max(y.y,b.y),p.z=Math.max(y.z,b.z)}_intersectHeightfield(r,h,p,y,b){const R=Va;R.from.copy(this.from),R.to.copy(this.to),H.pointToLocalFrame(p,h,R.from,R.from),H.pointToLocalFrame(p,h,R.to,R.to),R.updateDirection();const O=Hu;let T,U,ee,ie;T=U=0,ee=ie=r.data.length-1;const ne=new he;R.getAABB(ne),r.getIndexOfPosition(ne.lowerBound.x,ne.lowerBound.y,O,!0),T=Math.max(T,O[0]),U=Math.max(U,O[1]),r.getIndexOfPosition(ne.upperBound.x,ne.upperBound.y,O,!0),ee=Math.min(ee,O[0]+1),ie=Math.min(ie,O[1]+1);for(let ve=T;ve<ee;ve++)for(let be=U;be<ie;be++){if(this.result.shouldStop)return;if(r.getAabbAtIndex(ve,be,ne),ne.overlapsRay(R)){if(r.getConvexTrianglePillar(ve,be,!1),H.pointToWorldFrame(p,h,r.pillarOffset,Ir),this._intersectConvex(r.pillarConvex,h,Ir,y,b,os),this.result.shouldStop)return;r.getConvexTrianglePillar(ve,be,!0),H.pointToWorldFrame(p,h,r.pillarOffset,Ir),this._intersectConvex(r.pillarConvex,h,Ir,y,b,os)}}}_intersectSphere(r,h,p,y,b){const R=this.from,O=this.to,U=(O.x-R.x)**2+(O.y-R.y)**2+(O.z-R.z)**2,ee=2*((O.x-R.x)*(R.x-p.x)+(O.y-R.y)*(R.y-p.y)+(O.z-R.z)*(R.z-p.z)),ie=ee**2-4*U*((R.x-p.x)**2+(R.y-p.y)**2+(R.z-p.z)**2-r.radius**2),ne=hs,ve=Ys;if(!(ie<0))if(0===ie)R.lerp(O,ie,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1);else{const be=(-ee-Math.sqrt(ie))/(2*U),Te=(-ee+Math.sqrt(ie))/(2*U);if(be>=0&&be<=1&&(R.lerp(O,be,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1)),this.result.shouldStop)return;Te>=0&&Te<=1&&(R.lerp(O,Te,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1))}}_intersectConvex(r,h,p,y,b,R){const O=ai,T=Gc,U=R&&R.faceList||null,ee=r.faces,ie=r.vertices,ne=r.faceNormals,ve=this.direction,be=this.from,Le=be.distanceTo(this.to),Ie=U?U.length:ee.length,Oe=this.result;for(let Fe=0;!Oe.shouldStop&&Fe<Ie;Fe++){const je=U?U[Fe]:Fe,Ue=ee[je],Je=ne[je],pt=h,at=p;T.copy(ie[Ue[0]]),pt.vmult(T,T),T.vadd(at,T),T.vsub(be,T),pt.vmult(Je,O);const Mt=ve.dot(O);if(Math.abs(Mt)<this.precision)continue;const Tt=O.dot(T)/Mt;if(!(Tt<0)){ve.scale(Tt,Ni),Ni.vadd(be,Ni),Eo.copy(ie[Ue[0]]),pt.vmult(Eo,Eo),at.vadd(Eo,Eo);for(let Yt=1;!Oe.shouldStop&&Yt<Ue.length-1;Yt++){vo.copy(ie[Ue[Yt]]),Jr.copy(ie[Ue[Yt+1]]),pt.vmult(vo,vo),pt.vmult(Jr,Jr),at.vadd(vo,vo),at.vadd(Jr,Jr);const jt=Ni.distanceTo(be);!So(Ni,Eo,vo,Jr)&&!So(Ni,vo,Eo,Jr)||jt>Le||this.reportIntersection(O,Ni,b,y,je)}}}}_intersectTrimesh(r,h,p,y,b,R){const O=kh,T=Hc,U=Hp,ee=Gc,ie=sl,ne=Gp,ve=ha,be=Wa,Te=Wl,Le=r.indices,Ie=this.from,Oe=this.to,Fe=this.direction;U.position.copy(p),U.quaternion.copy(h),H.vectorToLocalFrame(p,h,Fe,ie),H.pointToLocalFrame(p,h,Ie,ne),H.pointToLocalFrame(p,h,Oe,ve),ve.x*=r.scale.x,ve.y*=r.scale.y,ve.z*=r.scale.z,ne.x*=r.scale.x,ne.y*=r.scale.y,ne.z*=r.scale.z,ve.vsub(ne,ie),ie.normalize();const je=ne.distanceSquared(ve);r.tree.rayQuery(this,U,T);for(let Ue=0,Je=T.length;!this.result.shouldStop&&Ue!==Je;Ue++){const pt=T[Ue];r.getNormal(pt,O),r.getVertex(Le[3*pt],Eo),Eo.vsub(ne,ee);const at=ie.dot(O),Mt=O.dot(ee)/at;if(Mt<0)continue;ie.scale(Mt,Ni),Ni.vadd(ne,Ni),r.getVertex(Le[3*pt+1],vo),r.getVertex(Le[3*pt+2],Jr);const Tt=Ni.distanceSquared(ne);!So(Ni,vo,Eo,Jr)&&!So(Ni,Eo,vo,Jr)||Tt>je||(H.vectorToWorldFrame(h,O,Te),H.pointToWorldFrame(p,h,Ni,be),this.reportIntersection(Te,be,b,y,pt))}T.length=0}reportIntersection(r,h,p,y,b){const R=this.from,O=this.to,T=R.distanceTo(h),U=this.result;if(!(this.skipBackfaces&&r.dot(this.direction)>0))switch(U.hitFaceIndex=void 0!==b?b:-1,this.mode){case Nr.ALL:this.hasHit=!0,U.set(R,O,r,h,p,y,T),U.hasHit=!0,this.callback(U);break;case Nr.CLOSEST:(T<U.distance||!U.hasHit)&&(this.hasHit=!0,U.hasHit=!0,U.set(R,O,r,h,p,y,T));break;case Nr.ANY:this.hasHit=!0,U.hasHit=!0,U.set(R,O,r,h,p,y,T),U.shouldStop=!0}}}Nr.CLOSEST=1,Nr.ANY=2,Nr.ALL=4;const ei=new he,Wr=[],yi=new M,Ei=new M;function So(a,r,h,p){p.vsub(r,Js),h.vsub(r,yi),a.vsub(r,Ei);const y=Js.dot(Js),b=Js.dot(yi),R=Js.dot(Ei),O=yi.dot(yi),T=yi.dot(Ei);let U,ee;return(U=O*R-b*T)>=0&&(ee=y*T-b*R)>=0&&U+ee<y*O-b*b}Nr.pointInTriangle=So;const Xs=new M,ua=new Y,Ni=new M,Eo=new M,vo=new M,Jr=new M;Nr.prototype[oe.types.BOX]=Nr.prototype._intersectBox,Nr.prototype[oe.types.PLANE]=Nr.prototype._intersectPlane;const os={faceList:[0]},Ir=new M,Va=new Nr,Hu=[];Nr.prototype[oe.types.HEIGHTFIELD]=Nr.prototype._intersectHeightfield;const hs=new M,Ys=new M;Nr.prototype[oe.types.SPHERE]=Nr.prototype._intersectSphere;const ai=new M,Gc=new M;Nr.prototype[oe.types.CONVEXPOLYHEDRON]=Nr.prototype._intersectConvex;const kh=new M,sl=new M,Gp=new M,ha=new M,Wl=new M,Wa=new M,Hc=(new he,[]),Hp=new H;Nr.prototype[oe.types.TRIMESH]=Nr.prototype._intersectTrimesh;const Js=new M,Xo=new M;class ps extends ir{constructor(r){super(),this.axisList=[],this.world=null,this.axisIndex=0;const h=this.axisList;this._addBodyHandler=p=>{h.push(p.body)},this._removeBodyHandler=p=>{const y=h.indexOf(p.body);-1!==y&&h.splice(y,1)},r&&this.setWorld(r)}setWorld(r){this.axisList.length=0;for(let h=0;h<r.bodies.length;h++)this.axisList.push(r.bodies[h]);r.removeEventListener("addBody",this._addBodyHandler),r.removeEventListener("removeBody",this._removeBodyHandler),r.addEventListener("addBody",this._addBodyHandler),r.addEventListener("removeBody",this._removeBodyHandler),this.world=r,this.dirty=!0}collisionPairs(r,h,p){const y=this.axisList,b=y.length,R=this.axisIndex;let O,T;for(this.dirty&&(this.sortList(),this.dirty=!1),O=0;O!==b;O++){const U=y[O];for(T=O+1;T<b;T++){const ee=y[T];if(this.needBroadphaseCollision(U,ee)){if(!ps.checkBounds(U,ee,R))break;this.intersectionTest(U,ee,h,p)}}}}sortList(){const r=this.axisList,h=this.axisIndex,p=r.length;for(let y=0;y!==p;y++){const b=r[y];b.aabbNeedsUpdate&&b.computeAABB()}0===h?ps.insertionSortX(r):1===h?ps.insertionSortY(r):2===h&&ps.insertionSortZ(r)}autoDetectAxis(){let r=0,h=0,p=0,y=0,b=0,R=0;const O=this.axisList,T=O.length,U=1/T;for(let ve=0;ve!==T;ve++){const be=O[ve],Te=be.position.x;r+=Te,h+=Te*Te;const Le=be.position.y;p+=Le,y+=Le*Le;const Ie=be.position.z;b+=Ie,R+=Ie*Ie}const ee=h-r*r*U,ie=y-p*p*U,ne=R-b*b*U;this.axisIndex=ee>ie?ee>ne?0:2:ie>ne?1:2}aabbQuery(r,h,p=[]){this.dirty&&(this.sortList(),this.dirty=!1);const y=this.axisIndex;let b="x";1===y&&(b="y"),2===y&&(b="z");const R=this.axisList;for(let O=0;O<R.length;O++){const T=R[O];T.aabbNeedsUpdate&&T.computeAABB(),T.aabb.overlaps(h)&&p.push(T)}return p}}function Vu(){}ps.insertionSortX=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.x<=p.aabb.lowerBound.x);y--)a[y+1]=a[y];a[y+1]=p}return a},ps.insertionSortY=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.y<=p.aabb.lowerBound.y);y--)a[y+1]=a[y];a[y+1]=p}return a},ps.insertionSortZ=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.z<=p.aabb.lowerBound.z);y--)a[y+1]=a[y];a[y+1]=p}return a},ps.checkBounds=(a,r,h)=>{let p,y;return 0===h?(p=a.position.x,y=r.position.x):1===h?(p=a.position.y,y=r.position.y):2===h&&(p=a.position.z,y=r.position.z),y-r.boundingRadius<p+a.boundingRadius},Vu.defaults=(a={},r)=>{for(let h in r)h in a||(a[h]=r[h]);return a};class du{constructor(r,h,p={}){p=Vu.defaults(p,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=r,this.bodyB=h,this.id=du.idCounter++,this.collideConnected=p.collideConnected,p.wakeUpBodies&&(r&&r.wakeUp(),h&&h.wakeUp())}update(){throw new Error("method update() not implmemented in this Constraint subclass!")}enable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!0}disable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!1}}du.idCounter=0;class fu{constructor(){this.spatial=new M,this.rotational=new M}multiplyElement(r){return r.spatial.dot(this.spatial)+r.rotational.dot(this.rotational)}multiplyVectors(r,h){return r.dot(this.spatial)+h.dot(this.rotational)}}class Ms{constructor(r,h,p=-1e6,y=1e6){this.id=Ms.id++,this.minForce=p,this.maxForce=y,this.bi=r,this.bj=h,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new fu,this.jacobianElementB=new fu,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(r,h,p){const y=h,b=r,R=p;this.a=4/(R*(1+4*y)),this.b=4*y/(1+4*y),this.eps=4/(R*R*b*(1+4*y))}computeB(r,h,p){const y=this.computeGW();return-this.computeGq()*r-y*h-this.computeGiMf()*p}computeGq(){const h=this.jacobianElementB,R=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+h.spatial.dot(R)}computeGW(){const h=this.jacobianElementB,p=this.bi,y=this.bj,R=y.velocity,T=y.angularVelocity;return this.jacobianElementA.multiplyVectors(p.velocity,p.angularVelocity)+h.multiplyVectors(R,T)}computeGWlambda(){const h=this.jacobianElementB,p=this.bi,y=this.bj,R=y.vlambda,T=y.wlambda;return this.jacobianElementA.multiplyVectors(p.vlambda,p.wlambda)+h.multiplyVectors(R,T)}computeGiMf(){const r=this.jacobianElementA,h=this.jacobianElementB,p=this.bi,y=this.bj,R=p.torque,O=y.force,T=y.torque,ee=y.invMassSolve;return p.force.scale(p.invMassSolve,dp),O.scale(ee,Fs),p.invInertiaWorldSolve.vmult(R,lo),y.invInertiaWorldSolve.vmult(T,Vc),r.multiplyVectors(dp,lo)+h.multiplyVectors(Fs,Vc)}computeGiMGt(){const r=this.jacobianElementA,h=this.jacobianElementB,p=this.bi,y=this.bj,T=y.invInertiaWorldSolve;let U=p.invMassSolve+y.invMassSolve;return p.invInertiaWorldSolve.vmult(r.rotational,Wu),U+=Wu.dot(r.rotational),T.vmult(h.rotational,Wu),U+=Wu.dot(h.rotational),U}addToWlambda(r){const h=this.jacobianElementA,p=this.jacobianElementB,y=this.bi,b=this.bj,R=vh;y.vlambda.addScaledVector(y.invMassSolve*r,h.spatial,y.vlambda),b.vlambda.addScaledVector(b.invMassSolve*r,p.spatial,b.vlambda),y.invInertiaWorldSolve.vmult(h.rotational,R),y.wlambda.addScaledVector(r,R,y.wlambda),b.invInertiaWorldSolve.vmult(p.rotational,R),b.wlambda.addScaledVector(r,R,b.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Ms.id=0;const dp=new M,Fs=new M,lo=new M,Vc=new M,Wu=new M,vh=new M;class To extends Ms{constructor(r,h,p=1e6){super(r,h,0,p),this.restitution=0,this.ri=new M,this.rj=new M,this.ni=new M}computeB(r){const h=this.a,p=this.b,y=this.bi,b=this.bj,R=this.ri,O=this.rj,T=Zs,U=Vp,ee=y.velocity,ie=y.angularVelocity,ne=b.velocity,ve=b.angularVelocity,be=ll,Te=this.jacobianElementA,Le=this.jacobianElementB,Ie=this.ni;R.cross(Ie,T),O.cross(Ie,U),Ie.negate(Te.spatial),T.negate(Te.rotational),Le.spatial.copy(Ie),Le.rotational.copy(U),be.copy(b.position),be.vadd(O,be),be.vsub(y.position,be),be.vsub(R,be);const Oe=Ie.dot(be),Fe=this.restitution+1;return-Oe*h-(Fe*ne.dot(Ie)-Fe*ee.dot(Ie)+ve.dot(U)-ie.dot(T))*p-r*this.computeGiMf()}getImpactVelocityAlongNormal(){const r=mu,h=fp,p=mp,y=yh,b=Fh;return this.bi.position.vadd(this.ri,p),this.bj.position.vadd(this.rj,y),this.bi.getVelocityAtWorldPoint(p,r),this.bj.getVelocityAtWorldPoint(y,h),r.vsub(h,b),this.ni.dot(b)}}const Zs=new M,Vp=new M,ll=new M,mu=new M,fp=new M,mp=new M,yh=new M,Fh=new M;class mc extends du{constructor(r,h=new M,p,y=new M,b=1e6){super(r,p),this.pivotA=h.clone(),this.pivotB=y.clone();const R=this.equationX=new To(r,p),O=this.equationY=new To(r,p),T=this.equationZ=new To(r,p);this.equations.push(R,O,T),R.minForce=O.minForce=T.minForce=-b,R.maxForce=O.maxForce=T.maxForce=b,R.ni.set(1,0,0),O.ni.set(0,1,0),T.ni.set(0,0,1)}update(){const h=this.bodyB,p=this.equationX,y=this.equationY,b=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,p.ri),h.quaternion.vmult(this.pivotB,p.rj),y.ri.copy(p.ri),y.rj.copy(p.rj),b.ri.copy(p.ri),b.rj.copy(p.rj)}}class Dh extends Ms{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,h,-y,y),this.axisA=p.axisA?p.axisA.clone():new M(1,0,0),this.axisB=p.axisB?p.axisB.clone():new M(0,1,0),this.angle=void 0!==p.angle?p.angle:0}computeB(r){const h=this.a,p=this.b,y=this.axisA,b=this.axisB,R=bh,O=Uh,T=this.jacobianElementA,U=this.jacobianElementB;return y.cross(b,R),b.cross(y,O),T.rotational.copy(O),U.rotational.copy(R),-(Math.cos(this.angle)-y.dot(b))*h-this.computeGW()*p-r*this.computeGiMf()}}const bh=new M,Uh=new M;class Tl extends Ms{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,h,-y,y),this.axisA=p.axisA?p.axisA.clone():new M(1,0,0),this.axisB=p.axisB?p.axisB.clone():new M(0,1,0),this.maxAngle=Math.PI/2}computeB(r){const h=this.a,p=this.b,y=this.axisA,b=this.axisB,R=Ml,O=ql,T=this.jacobianElementA,U=this.jacobianElementB;return y.cross(b,R),b.cross(y,O),T.rotational.copy(O),U.rotational.copy(R),-(Math.cos(this.maxAngle)-y.dot(b))*h-this.computeGW()*p-r*this.computeGiMf()}}const Ml=new M,ql=new M;class qu extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,p.pivotA?p.pivotA.clone():new M,h,p.pivotB?p.pivotB.clone():new M,y),this.axisA=p.axisA?p.axisA.clone():new M,this.axisB=p.axisB?p.axisB.clone():new M,this.collideConnected=!!p.collideConnected,this.angle=void 0!==p.angle?p.angle:0;const b=this.coneEquation=new Dh(r,h,p),R=this.twistEquation=new Tl(r,h,p);this.twistAngle=void 0!==p.twistAngle?p.twistAngle:0,b.maxForce=0,b.minForce=-y,R.maxForce=0,R.minForce=-y,this.equations.push(b,R)}update(){const r=this.bodyA,h=this.bodyB,p=this.coneEquation,y=this.twistEquation;super.update(),r.vectorToWorldFrame(this.axisA,p.axisA),h.vectorToWorldFrame(this.axisB,p.axisB),this.axisA.tangents(y.axisA,y.axisA),r.vectorToWorldFrame(y.axisA,y.axisA),this.axisB.tangents(y.axisB,y.axisB),h.vectorToWorldFrame(y.axisB,y.axisB),p.angle=this.angle,y.maxAngle=this.twistAngle}}class ds extends du{constructor(r,h,p,y=1e6){super(r,h),void 0===p&&(p=r.position.distanceTo(h.position)),this.distance=p;const b=this.distanceEquation=new To(r,h);this.equations.push(b),b.minForce=-y,b.maxForce=y}update(){const p=this.distanceEquation,y=.5*this.distance,b=p.ni;this.bodyB.position.vsub(this.bodyA.position,b),b.normalize(),b.scale(y,p.ri),b.scale(-y,p.rj)}}class Xl extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6,b=new M,R=new M,O=new M;r.position.vadd(h.position,O),O.scale(.5,O),h.pointToLocalFrame(O,R),r.pointToLocalFrame(O,b),super(r,b,h,R,y),this.xA=r.vectorToLocalFrame(M.UNIT_X),this.xB=h.vectorToLocalFrame(M.UNIT_X),this.yA=r.vectorToLocalFrame(M.UNIT_Y),this.yB=h.vectorToLocalFrame(M.UNIT_Y),this.zA=r.vectorToLocalFrame(M.UNIT_Z),this.zB=h.vectorToLocalFrame(M.UNIT_Z);const T=this.rotationalEquation1=new Tl(r,h,p),U=this.rotationalEquation2=new Tl(r,h,p),ee=this.rotationalEquation3=new Tl(r,h,p);this.equations.push(T,U,ee)}update(){const r=this.bodyA,h=this.bodyB,p=this.rotationalEquation1,y=this.rotationalEquation2,b=this.rotationalEquation3;super.update(),r.vectorToWorldFrame(this.xA,p.axisA),h.vectorToWorldFrame(this.yB,p.axisB),r.vectorToWorldFrame(this.yA,y.axisA),h.vectorToWorldFrame(this.zB,y.axisB),r.vectorToWorldFrame(this.zA,b.axisA),h.vectorToWorldFrame(this.xB,b.axisB)}}class Xu extends Ms{constructor(r,h,p=1e6){super(r,h,-p,p),this.axisA=new M,this.axisB=new M,this.targetVelocity=0}computeB(r){const h=this.b,y=this.axisB,R=this.jacobianElementB;return this.jacobianElementA.rotational.copy(this.axisA),y.negate(R.rotational),-(this.computeGW()-this.targetVelocity)*h-r*this.computeGiMf()}}class _p extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,p.pivotA?p.pivotA.clone():new M,h,p.pivotB?p.pivotB.clone():new M,y),(this.axisA=p.axisA?p.axisA.clone():new M(1,0,0)).normalize(),(this.axisB=p.axisB?p.axisB.clone():new M(1,0,0)).normalize(),this.collideConnected=!!p.collideConnected;const b=this.rotationalEquation1=new Tl(r,h,p),R=this.rotationalEquation2=new Tl(r,h,p),O=this.motorEquation=new Xu(r,h,y);O.enabled=!1,this.equations.push(b,R,O)}enableMotor(){this.motorEquation.enabled=!0}disableMotor(){this.motorEquation.enabled=!1}setMotorSpeed(r){this.motorEquation.targetVelocity=r}setMotorMaxForce(r){this.motorEquation.maxForce=r,this.motorEquation.minForce=-r}update(){const r=this.bodyA,h=this.bodyB,p=this.motorEquation,y=this.rotationalEquation1,b=this.rotationalEquation2,R=gp,O=Wc,T=this.axisA,U=this.axisB;super.update(),r.quaternion.vmult(T,R),h.quaternion.vmult(U,O),R.tangents(y.axisA,b.axisA),y.axisB.copy(O),b.axisB.copy(O),this.motorEquation.enabled&&(r.quaternion.vmult(this.axisA,p.axisA),h.quaternion.vmult(this.axisB,p.axisB))}}const gp=new M,Wc=new M;class _c extends Ms{constructor(r,h,p){super(r,h,-p,p),this.ri=new M,this.rj=new M,this.t=new M}computeB(r){const h=this.b,y=this.rj,b=xh,R=vp,O=this.t;this.ri.cross(O,b),y.cross(O,R);const T=this.jacobianElementA,U=this.jacobianElementB;return O.negate(T.spatial),b.negate(T.rotational),U.spatial.copy(O),U.rotational.copy(R),-this.computeGW()*h-r*this.computeGiMf()}}const xh=new M,vp=new M;class Yu{constructor(r,h,p){p=Vu.defaults(p,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=Yu.idCounter++,this.materials=[r,h],this.friction=p.friction,this.restitution=p.restitution,this.contactEquationStiffness=p.contactEquationStiffness,this.contactEquationRelaxation=p.contactEquationRelaxation,this.frictionEquationStiffness=p.frictionEquationStiffness,this.frictionEquationRelaxation=p.frictionEquationRelaxation}}Yu.idCounter=0;class Ju{constructor(r={}){let h="";"string"==typeof r&&(h=r,r={}),this.name=h,this.id=Ju.idCounter++,this.friction=void 0!==r.friction?r.friction:-1,this.restitution=void 0!==r.restitution?r.restitution:-1}}Ju.idCounter=0;class cl{constructor(r,h,p={}){this.restLength="number"==typeof p.restLength?p.restLength:1,this.stiffness=p.stiffness||100,this.damping=p.damping||1,this.bodyA=r,this.bodyB=h,this.localAnchorA=new M,this.localAnchorB=new M,p.localAnchorA&&this.localAnchorA.copy(p.localAnchorA),p.localAnchorB&&this.localAnchorB.copy(p.localAnchorB),p.worldAnchorA&&this.setWorldAnchorA(p.worldAnchorA),p.worldAnchorB&&this.setWorldAnchorB(p.worldAnchorB)}setWorldAnchorA(r){this.bodyA.pointToLocalFrame(r,this.localAnchorA)}setWorldAnchorB(r){this.bodyB.pointToLocalFrame(r,this.localAnchorB)}getWorldAnchorA(r){this.bodyA.pointToWorldFrame(this.localAnchorA,r)}getWorldAnchorB(r){this.bodyB.pointToWorldFrame(this.localAnchorB,r)}applyForce(){const r=this.stiffness,h=this.damping,p=this.restLength,y=this.bodyA,b=this.bodyB,R=zh,O=ul,T=jh,U=Zu,ee=Xc,ie=vc,ne=yc,ve=wh,be=_u,Te=qc,Le=yp;this.getWorldAnchorA(ie),this.getWorldAnchorB(ne),ie.vsub(y.position,ve),ne.vsub(b.position,be),ne.vsub(ie,R);const Ie=R.length();O.copy(R),O.normalize(),b.velocity.vsub(y.velocity,T),b.angularVelocity.cross(be,ee),T.vadd(ee,T),y.angularVelocity.cross(ve,ee),T.vsub(ee,T),O.scale(-r*(Ie-p)-h*T.dot(O),U),y.force.vsub(U,y.force),b.force.vadd(U,b.force),ve.cross(U,Te),be.cross(U,Le),y.torque.vsub(Te,y.torque),b.torque.vadd(Le,b.torque)}}const zh=new M,ul=new M,jh=new M,Zu=new M,vc=new M,yc=new M,wh=new M,_u=new M,qc=new M,yp=new M,Xc=new M;class Qu{constructor(r={}){r=Vu.defaults(r,{chassisConnectionPointLocal:new M,chassisConnectionPointWorld:new M,directionLocal:new M,directionWorld:new M,axleLocal:new M,axleWorld:new M,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,slipInfo:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=r.maxSuspensionTravel,this.customSlidingRotationalSpeed=r.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=r.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=r.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=r.chassisConnectionPointWorld.clone(),this.directionLocal=r.directionLocal.clone(),this.directionWorld=r.directionWorld.clone(),this.axleLocal=r.axleLocal.clone(),this.axleWorld=r.axleWorld.clone(),this.suspensionRestLength=r.suspensionRestLength,this.suspensionMaxLength=r.suspensionMaxLength,this.radius=r.radius,this.suspensionStiffness=r.suspensionStiffness,this.dampingCompression=r.dampingCompression,this.dampingRelaxation=r.dampingRelaxation,this.frictionSlip=r.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=r.rollInfluence,this.maxSuspensionForce=r.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=r.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.slipInfo=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new mi,this.worldTransform=new H,this.isInContact=!1}updateWheel(r){const h=this.raycastResult;if(this.isInContact){const p=h.hitNormalWorld.dot(h.directionWorld);h.hitPointWorld.vsub(r.position,bp),r.getVelocityAtWorldPoint(bp,Yl);const y=h.hitNormalWorld.dot(Yl);if(p>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{const b=-1/p;this.suspensionRelativeVelocity=y*b,this.clippedInvContactDotSuspension=b}}else h.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,h.directionWorld.scale(-1,h.hitNormalWorld),this.clippedInvContactDotSuspension=1}}const Yl=new M,bp=new M;class Gh{constructor(r){this.chassisBody=r.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==r.indexRightAxis?r.indexRightAxis:1,this.indexForwardAxis=void 0!==r.indexForwardAxis?r.indexForwardAxis:0,this.indexUpAxis=void 0!==r.indexUpAxis?r.indexUpAxis:2,this.constraints=[],this.preStepCallback=()=>{},this.currentVehicleSpeedKmHour=0}addWheel(r={}){const h=new Qu(r),p=this.wheelInfos.length;return this.wheelInfos.push(h),p}setSteeringValue(r,h){this.wheelInfos[h].steering=r}applyEngineForce(r,h){this.wheelInfos[h].engineForce=r}setBrake(r,h){this.wheelInfos[h].brake=r}addToWorld(r){r.addBody(this.chassisBody);const h=this;this.preStepCallback=()=>{h.updateVehicle(r.dt)},r.addEventListener("preStep",this.preStepCallback),this.world=r}getVehicleAxisWorld(r,h){h.set(0===r?1:0,1===r?1:0,2===r?1:0),this.chassisBody.vectorToWorldFrame(h,h)}updateVehicle(r){const h=this.wheelInfos,p=h.length,y=this.chassisBody;for(let ie=0;ie<p;ie++)this.updateWheelTransform(ie);this.currentVehicleSpeedKmHour=3.6*y.velocity.length();const b=new M;this.getVehicleAxisWorld(this.indexForwardAxis,b),b.dot(y.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(let ie=0;ie<p;ie++)this.castRay(h[ie]);this.updateSuspension(r);const R=new M,O=new M;for(let ie=0;ie<p;ie++){const ne=h[ie];let ve=ne.suspensionForce;ve>ne.maxSuspensionForce&&(ve=ne.maxSuspensionForce),ne.raycastResult.hitNormalWorld.scale(ve*r,R),ne.raycastResult.hitPointWorld.vsub(y.position,O),y.applyImpulse(R,O)}this.updateFriction(r);const T=new M,U=new M,ee=new M;for(let ie=0;ie<p;ie++){const ne=h[ie];y.getVelocityAtWorldPoint(ne.chassisConnectionPointWorld,ee);let ve=1;if(1===this.indexUpAxis&&(ve=-1),ne.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,U);const be=U.dot(ne.raycastResult.hitNormalWorld);ne.raycastResult.hitNormalWorld.scale(be,T),U.vsub(T,U);const Te=U.dot(ee);ne.deltaRotation=ve*Te*r/ne.radius}!ne.sliding&&ne.isInContact||0===ne.engineForce||!ne.useCustomSlidingRotationalSpeed||(ne.deltaRotation=(ne.engineForce>0?1:-1)*ne.customSlidingRotationalSpeed*r),Math.abs(ne.brake)>Math.abs(ne.engineForce)&&(ne.deltaRotation=0),ne.rotation+=ne.deltaRotation,ne.deltaRotation*=.99}}updateSuspension(r){const h=this.chassisBody.mass,p=this.wheelInfos,y=p.length;for(let b=0;b<y;b++){const R=p[b];if(R.isInContact){let O;O=R.suspensionStiffness*(R.suspensionRestLength-R.suspensionLength)*R.clippedInvContactDotSuspension;const U=R.suspensionRelativeVelocity;let ee;ee=U<0?R.dampingCompression:R.dampingRelaxation,O-=ee*U,R.suspensionForce=O*h,R.suspensionForce<0&&(R.suspensionForce=0)}else R.suspensionForce=0}}removeFromWorld(r){r.removeBody(this.chassisBody),r.removeEventListener("preStep",this.preStepCallback),this.world=null}castRay(r){const h=Wp,p=gu;this.updateWheelTransformWorld(r);const y=this.chassisBody;let b=-1;r.directionWorld.scale(r.suspensionRestLength+r.radius,h);const O=r.chassisConnectionPointWorld;O.vadd(h,p);const T=r.raycastResult;T.reset();const U=y.collisionResponse;y.collisionResponse=!1,this.world.rayTest(O,p,T),y.collisionResponse=U;const ee=T.body;if(r.raycastResult.groundObject=0,ee){b=T.distance,r.raycastResult.hitNormalWorld=T.hitNormalWorld,r.isInContact=!0,r.suspensionLength=T.distance-r.radius;const ne=r.suspensionRestLength-r.maxSuspensionTravel,ve=r.suspensionRestLength+r.maxSuspensionTravel;r.suspensionLength<ne&&(r.suspensionLength=ne),r.suspensionLength>ve&&(r.suspensionLength=ve,r.raycastResult.reset());const be=r.raycastResult.hitNormalWorld.dot(r.directionWorld),Te=new M;y.getVelocityAtWorldPoint(r.raycastResult.hitPointWorld,Te);const Le=r.raycastResult.hitNormalWorld.dot(Te);if(be>=-.1)r.suspensionRelativeVelocity=0,r.clippedInvContactDotSuspension=10;else{const Ie=-1/be;r.suspensionRelativeVelocity=Le*Ie,r.clippedInvContactDotSuspension=Ie}}else r.suspensionLength=r.suspensionRestLength+0*r.maxSuspensionTravel,r.suspensionRelativeVelocity=0,r.directionWorld.scale(-1,r.raycastResult.hitNormalWorld),r.clippedInvContactDotSuspension=1;return b}updateWheelTransformWorld(r){r.isInContact=!1;const h=this.chassisBody;h.pointToWorldFrame(r.chassisConnectionPointLocal,r.chassisConnectionPointWorld),h.vectorToWorldFrame(r.directionLocal,r.directionWorld),h.vectorToWorldFrame(r.axleLocal,r.axleWorld)}updateWheelTransform(r){const h=xp,p=wp,y=Hh,b=this.wheelInfos[r];this.updateWheelTransformWorld(b),b.directionLocal.scale(-1,h),p.copy(b.axleLocal),h.cross(p,y),y.normalize(),p.normalize();const R=b.steering,O=new Y;O.setFromAxisAngle(h,R);const T=new Y;T.setFromAxisAngle(p,b.rotation);const U=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(O,U),U.mult(T,U),U.normalize();const ee=b.worldTransform.position;ee.copy(b.directionWorld),ee.scale(b.suspensionLength,ee),ee.vadd(b.chassisConnectionPointWorld,ee)}getWheelTransformWorld(r){return this.wheelInfos[r].worldTransform}updateFriction(r){const h=bc,p=this.wheelInfos,y=p.length,b=this.chassisBody,R=Zl,O=Jl;for(let T=0;T<y;T++){const U=p[T];U.sideImpulse=0,U.forwardImpulse=0,R[T]||(R[T]=new M),O[T]||(O[T]=new M)}for(let T=0;T<y;T++){const U=p[T],ee=U.raycastResult.body;if(ee){const ie=O[T];this.getWheelTransformWorld(T).vectorToWorldFrame(qa[this.indexRightAxis],ie);const ne=U.raycastResult.hitNormalWorld,ve=ie.dot(ne);ne.scale(ve,h),ie.vsub(h,ie),ie.normalize(),ne.cross(ie,R[T]),R[T].normalize(),U.sideImpulse=Wh(b,U.raycastResult.hitPointWorld,ee,U.raycastResult.hitPointWorld,ie),U.sideImpulse*=Ku}}this.sliding=!1;for(let T=0;T<y;T++){const U=p[T],ee=U.raycastResult.body;let ie=0;if(U.slipInfo=1,ee){const ve=U.brake?U.brake:0;ie=eh(b,ee,U.raycastResult.hitPointWorld,R[T],ve),ie+=U.engineForce*r,U.slipInfo*=ve/ie}if(U.forwardImpulse=0,U.skidInfo=1,ee){U.skidInfo=1;const ne=U.suspensionForce*r*U.frictionSlip,ve=ne*ne;U.forwardImpulse=ie;const be=.5*U.forwardImpulse,Te=1*U.sideImpulse,Le=be*be+Te*Te;if(U.sliding=!1,Le>ve){this.sliding=!0,U.sliding=!0;const Ie=ne/Math.sqrt(Le);U.skidInfo*=Ie}}}if(this.sliding)for(let T=0;T<y;T++){const U=p[T];0!==U.sideImpulse&&U.skidInfo<1&&(U.forwardImpulse*=U.skidInfo,U.sideImpulse*=U.skidInfo)}for(let T=0;T<y;T++){const U=p[T],ee=new M;if(U.raycastResult.hitPointWorld.vsub(b.position,ee),0!==U.forwardImpulse){const ie=new M;R[T].scale(U.forwardImpulse,ie),b.applyImpulse(ie,ee)}if(0!==U.sideImpulse){const ie=U.raycastResult.body,ne=new M;U.raycastResult.hitPointWorld.vsub(ie.position,ne);const ve=new M;O[T].scale(U.sideImpulse,ve),b.vectorToLocalFrame(ee,ee),ee["xyz"[this.indexUpAxis]]*=U.rollInfluence,b.vectorToWorldFrame(ee,ee),b.applyImpulse(ve,ee),ve.scale(-1,ve),ie.applyImpulse(ve,ne)}}}}const xp=new M,wp=new M,Hh=new M,Wp=(new Nr,new M),gu=new M,qa=[new M(1,0,0),new M(0,1,0),new M(0,0,1)],bc=new M,Jl=[],Zl=[],Ku=1,La=new M,pa=new M,Al=new M;function eh(a,r,h,p,y){let b=0;const R=h,O=La,T=pa,U=Al;return a.getVelocityAtWorldPoint(R,O),r.getVelocityAtWorldPoint(R,T),O.vsub(T,U),b=-p.dot(U)*(1/(Zi(a,h,p)+Zi(r,h,p))),y<b&&(b=y),b<-y&&(b=-y),b}const th=new M,Vh=new M,Sp=new M,Ep=new M;function Zi(a,r,h){const p=th,y=Vh,b=Sp,R=Ep;return r.vsub(a.position,p),p.cross(h,y),a.invInertiaWorld.vmult(y,R),R.cross(p,b),a.invMass+h.dot(b)}const hl=new M,Ql=new M,Yc=new M;function Wh(a,r,h,p,y){if(y.lengthSquared()>1.1)return 0;const b=hl,R=Ql,O=Yc;return a.getVelocityAtWorldPoint(r,b),h.getVelocityAtWorldPoint(p,R),b.vsub(R,O),-.2*y.dot(O)*(1/(a.invMass+h.invMass))}class xc extends oe{constructor(r){if(super({type:oe.types.SPHERE}),this.radius=void 0!==r?r:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(r,h=new M){const p=2*r*this.radius*this.radius/5;return h.x=p,h.y=p,h.z=p,h}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(r,h,p,y){const b=this.radius,R=["x","y","z"];for(let O=0;O<R.length;O++){const T=R[O];p[T]=r[T]-b,y[T]=r[T]+b}}}class nh{constructor(r={}){this.wheelBodies=[],this.coordinateSystem=void 0!==r.coordinateSystem?r.coordinateSystem.clone():new M(1,2,3),this.chassisBody=r.chassisBody?r.chassisBody:new dt({mass:1,shape:new Ge(new M(5,2,.5))}),this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}addWheel(r={}){let h;h=r.body?r.body:new dt({mass:1,shape:new xc(1.2)}),this.wheelBodies.push(h),this.wheelForces.push(0);const p=void 0!==r.position?r.position.clone():new M,y=new M;this.chassisBody.pointToWorldFrame(p,y),h.position.set(y.x,y.y,y.z);const b=void 0!==r.axis?r.axis.clone():new M(0,1,0);this.wheelAxes.push(b);const R=new _p(this.chassisBody,h,{pivotA:p,axisA:b,pivotB:M.ZERO,axisB:b,collideConnected:!1});return this.constraints.push(R),this.wheelBodies.length-1}setSteeringValue(r,h){const p=this.wheelAxes[h],y=Math.cos(r),b=Math.sin(r),R=p.x,O=p.y;this.constraints[h].axisA.set(y*R-b*O,b*R+y*O,0)}setMotorSpeed(r,h){const p=this.constraints[h];p.enableMotor(),p.motorTargetVelocity=r}disableMotor(r){this.constraints[r].disableMotor()}setWheelForce(r,h){this.wheelForces[h]=r}applyWheelForce(r,h){const y=this.wheelBodies[h],b=y.torque;this.wheelAxes[h].scale(r,vu),y.vectorToWorldFrame(vu,vu),b.vadd(vu,b)}addToWorld(r){const h=this.constraints,p=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<p.length;y++)r.addBody(p[y]);for(let y=0;y<h.length;y++)r.addConstraint(h[y]);r.addEventListener("preStep",this._update.bind(this))}_update(){const r=this.wheelForces;for(let h=0;h<r.length;h++)this.applyWheelForce(r[h],h)}removeFromWorld(r){const h=this.constraints,p=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<p.length;y++)r.removeBody(p[y]);for(let y=0;y<h.length;y++)r.removeConstraint(h[y])}getWheelSpeed(r){const p=this.wheelBodies[r].angularVelocity;return this.chassisBody.vectorToWorldFrame(this.wheelAxes[r],W),p.dot(W)}}const vu=new M,W=new M;class pe{constructor(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}add(r){this.particles.push(r),this.neighbors.length<this.particles.length&&this.neighbors.push([])}remove(r){const h=this.particles.indexOf(r);-1!==h&&(this.particles.splice(h,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())}getNeighbors(r,h){const p=this.particles.length,y=r.id,b=this.smoothingRadius*this.smoothingRadius,R=Me;for(let O=0;O!==p;O++){const T=this.particles[O];T.position.vsub(r.position,R),y!==T.id&&R.lengthSquared()<b&&h.push(T)}}update(){const r=this.particles.length,h=Ne,p=this.speedOfSound,y=this.eps;for(let ee=0;ee!==r;ee++){const ie=this.particles[ee],ne=this.neighbors[ee];ne.length=0,this.getNeighbors(ie,ne),ne.push(this.particles[ee]);const ve=ne.length;let be=0;for(let Te=0;Te!==ve;Te++){ie.position.vsub(ne[Te].position,h);const Le=h.length(),Ie=this.w(Le);be+=ne[Te].mass*Ie}this.densities[ee]=be,this.pressures[ee]=p*p*(this.densities[ee]-this.density)}const b=Ve,R=qe,O=et,T=At,U=Bt;for(let ee=0;ee!==r;ee++){const ie=this.particles[ee];let ne,ve;b.set(0,0,0),R.set(0,0,0);const be=this.neighbors[ee],Te=be.length;for(let Le=0;Le!==Te;Le++){const Ie=be[Le];ie.position.vsub(Ie.position,T);const Oe=T.length();ne=-Ie.mass*(this.pressures[ee]/(this.densities[ee]*this.densities[ee]+y)+this.pressures[Le]/(this.densities[Le]*this.densities[Le]+y)),this.gradw(T,O),O.scale(ne,O),b.vadd(O,b),Ie.velocity.vsub(ie.velocity,U),U.scale(1/(1e-4+this.densities[ee]*this.densities[Le])*this.viscosity*Ie.mass,U),ve=this.nablaw(Oe),U.scale(ve,U),R.vadd(U,R)}R.scale(ie.mass,R),b.scale(ie.mass,b),ie.force.vadd(R,ie.force),ie.force.vadd(b,ie.force)}}w(r){const h=this.smoothingRadius;return 315/(64*Math.PI*h**9)*(h*h-r*r)**3}gradw(r,h){const p=r.length(),y=this.smoothingRadius;r.scale(945/(32*Math.PI*y**9)*(y*y-p*p)**2,h)}nablaw(r){const h=this.smoothingRadius;return 945/(32*Math.PI*h**9)*(h*h-r*r)*(7*r*r-3*h*h)}}const Me=new M,Ne=new M,Ve=new M,qe=new M,et=new M,At=new M,Bt=new M;class Xt extends Q{constructor(r,h,p,y){const b=y,R=[],O=[],T=[],U=[],ee=[],ie=Math.cos,ne=Math.sin;R.push(new M(h*ie(0),h*ne(0),.5*-p)),U.push(0),R.push(new M(r*ie(0),r*ne(0),.5*p)),ee.push(1);for(let be=0;be<b;be++){const Te=2*Math.PI/b*(be+1),Le=2*Math.PI/b*(be+.5);be<b-1?(R.push(new M(h*ie(Te),h*ne(Te),.5*-p)),U.push(2*be+2),R.push(new M(r*ie(Te),r*ne(Te),.5*p)),ee.push(2*be+3),T.push([2*be+2,2*be+3,2*be+1,2*be])):T.push([0,1,2*be+1,2*be]),(b%2==1||be<b/2)&&O.push(new M(ie(Le),ne(Le),0))}T.push(ee),O.push(new M(0,0,1));const ve=[];for(let be=0;be<U.length;be++)ve.push(U[U.length-be-1]);T.push(ve),super({vertices:R,faces:T,axes:O})}}class pn extends oe{constructor(){super({type:oe.types.PARTICLE})}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return 0}updateBoundingSphereRadius(){this.boundingSphereRadius=0}calculateWorldAABB(r,h,p,y){p.copy(r),y.copy(r)}}class Fn extends oe{constructor(){super({type:oe.types.PLANE}),this.worldNormal=new M,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(r){const h=this.worldNormal;h.set(0,0,1),r.vmult(h,h),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(r,h=new M){return h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,p,y){on.set(0,0,1),h.vmult(on,on);const b=Number.MAX_VALUE;p.set(-b,-b,-b),y.set(b,b,b),1===on.x?y.x=r.x:-1===on.x&&(p.x=r.x),1===on.y?y.y=r.y:-1===on.y&&(p.y=r.y),1===on.z?y.z=r.z:-1===on.z&&(p.z=r.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const on=new M;class xn extends oe{constructor(r,h={}){h=Vu.defaults(h,{maxValue:null,minValue:null,elementSize:1}),super({type:oe.types.HEIGHTFIELD}),this.data=r,this.maxValue=h.maxValue,this.minValue=h.minValue,this.elementSize=h.elementSize,null===h.minValue&&this.updateMinValue(),null===h.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,this.pillarConvex=new Q,this.pillarOffset=new M,this.updateBoundingSphereRadius(),this._cachedPillars={}}update(){this._cachedPillars={}}updateMinValue(){const r=this.data;let h=r[0][0];for(let p=0;p!==r.length;p++)for(let y=0;y!==r[p].length;y++){const b=r[p][y];b<h&&(h=b)}this.minValue=h}updateMaxValue(){const r=this.data;let h=r[0][0];for(let p=0;p!==r.length;p++)for(let y=0;y!==r[p].length;y++){const b=r[p][y];b>h&&(h=b)}this.maxValue=h}setHeightValueAtIndex(r,h,p){this.data[r][h]=p,this.clearCachedConvexTrianglePillar(r,h,!1),r>0&&(this.clearCachedConvexTrianglePillar(r-1,h,!0),this.clearCachedConvexTrianglePillar(r-1,h,!1)),h>0&&(this.clearCachedConvexTrianglePillar(r,h-1,!0),this.clearCachedConvexTrianglePillar(r,h-1,!1)),h>0&&r>0&&this.clearCachedConvexTrianglePillar(r-1,h-1,!0)}getRectMinMax(r,h,p,y,b=[]){const R=this.data;let O=this.minValue;for(let T=r;T<=p;T++)for(let U=h;U<=y;U++){const ee=R[T][U];ee>O&&(O=ee)}b[0]=this.minValue,b[1]=O}getIndexOfPosition(r,h,p,y){const b=this.elementSize,R=this.data;let O=Math.floor(r/b),T=Math.floor(h/b);return p[0]=O,p[1]=T,y&&(O<0&&(O=0),T<0&&(T=0),O>=R.length-1&&(O=R.length-1),T>=R[0].length-1&&(T=R[0].length-1)),!(O<0||T<0||O>=R.length-1||T>=R[0].length-1)}getTriangleAt(r,h,p,y,b,R){const O=Er;this.getIndexOfPosition(r,h,O,p);let T=O[0],U=O[1];const ee=this.data;p&&(T=Math.min(ee.length-2,Math.max(0,T)),U=Math.min(ee[0].length-2,Math.max(0,U)));const ie=this.elementSize,ne=(r/ie-T)**2+(h/ie-U)**2>(r/ie-(T+1))**2+(h/ie-(U+1))**2;return this.getTriangle(T,U,ne,y,b,R),ne}getNormalAt(r,h,p,y){const b=da,R=bi,O=Br,T=Xa,U=Wi;this.getTriangleAt(r,h,p,b,R,O),R.vsub(b,T),O.vsub(b,U),T.cross(U,y),y.normalize()}getAabbAtIndex(r,h,{lowerBound:p,upperBound:y}){const b=this.data,R=this.elementSize;p.set(r*R,h*R,b[r][h]),y.set((r+1)*R,(h+1)*R,b[r+1][h+1])}getHeightAt(r,h,p){const y=this.data,b=Ar,R=fs,O=es,T=Er;this.getIndexOfPosition(r,h,T,p);let U=T[0],ee=T[1];p&&(U=Math.min(y.length-2,Math.max(0,U)),ee=Math.min(y[0].length-2,Math.max(0,ee)));const ie=this.getTriangleAt(r,h,p,b,R,O);var ve,be,Te,Le,Ie,Oe,Fe,je,Ue;return(Ue=ti).x=(((Oe=R.y)-(je=O.y))*((ve=r)-(Fe=O.x))+(Fe-(Ie=R.x))*((be=h)-je))/((Oe-je)*((Te=b.x)-Fe)+(Fe-Ie)*((Le=b.y)-je)),Ue.y=((je-Le)*(ve-Fe)+(Te-Fe)*(be-je))/((Oe-je)*(Te-Fe)+(Fe-Ie)*(Le-je)),Ue.z=1-Ue.x-Ue.y,ie?y[U+1][ee+1]*ti.x+y[U][ee+1]*ti.y+y[U+1][ee]*ti.z:y[U][ee]*ti.x+y[U+1][ee]*ti.y+y[U][ee+1]*ti.z}getCacheConvexTrianglePillarKey(r,h,p){return r+"_"+h+"_"+(p?1:0)}getCachedConvexTrianglePillar(r,h,p){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]}setCachedConvexTrianglePillar(r,h,p,y,b){this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]={convex:y,offset:b}}clearCachedConvexTrianglePillar(r,h,p){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]}getTriangle(r,h,p,y,b,R){const O=this.data,T=this.elementSize;p?(y.set((r+1)*T,(h+1)*T,O[r+1][h+1]),b.set(r*T,(h+1)*T,O[r][h+1]),R.set((r+1)*T,h*T,O[r+1][h])):(y.set(r*T,h*T,O[r][h]),b.set((r+1)*T,h*T,O[r+1][h]),R.set(r*T,(h+1)*T,O[r][h+1]))}getConvexTrianglePillar(r,h,p){let y=this.pillarConvex,b=this.pillarOffset;if(this.cacheEnabled){const ie=this.getCachedConvexTrianglePillar(r,h,p);if(ie)return this.pillarConvex=ie.convex,void(this.pillarOffset=ie.offset);y=new Q,b=new M,this.pillarConvex=y,this.pillarOffset=b}const R=this.data,O=this.elementSize,T=y.faces;y.vertices.length=6;for(let ie=0;ie<6;ie++)y.vertices[ie]||(y.vertices[ie]=new M);T.length=5;for(let ie=0;ie<5;ie++)T[ie]||(T[ie]=[]);const U=y.vertices,ee=(Math.min(R[r][h],R[r+1][h],R[r][h+1],R[r+1][h+1])-this.minValue)/2+this.minValue;p?(b.set((r+.75)*O,(h+.75)*O,ee),U[0].set(.25*O,.25*O,R[r+1][h+1]-ee),U[1].set(-.75*O,.25*O,R[r][h+1]-ee),U[2].set(.25*O,-.75*O,R[r+1][h]-ee),U[3].set(.25*O,.25*O,-ee-1),U[4].set(-.75*O,.25*O,-ee-1),U[5].set(.25*O,-.75*O,-ee-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=2,T[2][1]=5,T[2][2]=3,T[2][3]=0,T[3][0]=3,T[3][1]=4,T[3][2]=1,T[3][3]=0,T[4][0]=1,T[4][1]=4,T[4][2]=5,T[4][3]=2):(b.set((r+.25)*O,(h+.25)*O,ee),U[0].set(-.25*O,-.25*O,R[r][h]-ee),U[1].set(.75*O,-.25*O,R[r+1][h]-ee),U[2].set(-.25*O,.75*O,R[r][h+1]-ee),U[3].set(-.25*O,-.25*O,-ee-1),U[4].set(.75*O,-.25*O,-ee-1),U[5].set(-.25*O,.75*O,-ee-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=0,T[2][1]=2,T[2][2]=5,T[2][3]=3,T[3][0]=1,T[3][1]=0,T[3][2]=3,T[3][3]=4,T[4][0]=4,T[4][1]=5,T[4][2]=2,T[4][3]=1),y.computeNormals(),y.computeEdges(),y.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(r,h,p,y,b)}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,p,y){p.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),y.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}updateBoundingSphereRadius(){const r=this.data,h=this.elementSize;this.boundingSphereRadius=new M(r.length*h,r[0].length*h,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).length()}setHeightsFromImage(r,h){const{x:p,z:y,y:b}=h,R=document.createElement("canvas");R.width=r.width,R.height=r.height;const O=R.getContext("2d");O.drawImage(r,0,0);const T=O.getImageData(0,0,r.width,r.height),U=this.data;U.length=0,this.elementSize=Math.abs(p)/T.width;for(let ee=0;ee<T.height;ee++){const ie=[];for(let ne=0;ne<T.width;ne++){const ve=(T.data[4*(ee*T.height+ne)]+T.data[4*(ee*T.height+ne)+1]+T.data[4*(ee*T.height+ne)+2])/4/255*y;p<0?ie.push(ve):ie.unshift(ve)}b<0?U.unshift(ie):U.push(ie)}this.updateMaxValue(),this.updateMinValue(),this.update()}}const Er=[],ti=new M,Ar=new M,fs=new M,es=new M,da=new M,bi=new M,Br=new M,Xa=new M,Wi=new M;class qi{constructor(r={}){this.root=r.root||null,this.aabb=r.aabb?r.aabb.clone():new he,this.data=[],this.children=[]}reset(){this.children.length=this.data.length=0}insert(r,h,p=0){const y=this.data;if(!this.aabb.contains(r))return!1;const b=this.children;if(p<(this.maxDepth||this.root.maxDepth)){let R=!1;b.length||(this.subdivide(),R=!0);for(let O=0;8!==O;O++)if(b[O].insert(r,h,p+1))return!0;R&&(b.length=0)}return y.push(h),!0}subdivide(){const r=this.aabb,h=r.lowerBound,p=r.upperBound,y=this.children;y.push(new qi({aabb:new he({lowerBound:new M(0,0,0)})}),new qi({aabb:new he({lowerBound:new M(1,0,0)})}),new qi({aabb:new he({lowerBound:new M(1,1,0)})}),new qi({aabb:new he({lowerBound:new M(1,1,1)})}),new qi({aabb:new he({lowerBound:new M(0,1,1)})}),new qi({aabb:new he({lowerBound:new M(0,0,1)})}),new qi({aabb:new he({lowerBound:new M(1,0,1)})}),new qi({aabb:new he({lowerBound:new M(0,1,0)})})),p.vsub(h,wc),wc.scale(.5,wc);const b=this.root||this;for(let R=0;8!==R;R++){const O=y[R];O.root=b;const T=O.aabb.lowerBound;T.x*=wc.x,T.y*=wc.y,T.z*=wc.z,T.vadd(h,T),T.vadd(wc,O.aabb.upperBound)}}aabbQuery(r,h){const p=[this];for(;p.length;){const y=p.pop();y.aabb.overlaps(r)&&Array.prototype.push.apply(h,y.data),Array.prototype.push.apply(p,y.children)}return h}rayQuery(r,h,p){return r.getAABB(fa),fa.toLocalFrame(h,fa),this.aabbQuery(fa,p),p}removeEmptyNodes(){for(let r=this.children.length-1;r>=0;r--)this.children[r].removeEmptyNodes(),this.children[r].children.length||this.children[r].data.length||this.children.splice(r,1)}}class qh extends qi{constructor(r,h={}){super({root:null,aabb:r}),this.maxDepth=void 0!==h.maxDepth?h.maxDepth:8}}const wc=new M,fa=new he;class pl extends oe{constructor(r,h){super({type:oe.types.TRIMESH}),this.vertices=new Float32Array(r),this.indices=new Int16Array(h),this.normals=new Float32Array(h.length),this.aabb=new he,this.edges=null,this.scale=new M(1,1,1),this.tree=new qh,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}updateTree(){const r=this.tree;r.reset(),r.aabb.copy(this.aabb);const h=this.scale;r.aabb.lowerBound.x*=1/h.x,r.aabb.lowerBound.y*=1/h.y,r.aabb.lowerBound.z*=1/h.z,r.aabb.upperBound.x*=1/h.x,r.aabb.upperBound.y*=1/h.y,r.aabb.upperBound.z*=1/h.z;const p=new he,y=new M,b=new M,R=new M,O=[y,b,R];for(let T=0;T<this.indices.length/3;T++){const U=3*T;this._getUnscaledVertex(this.indices[U],y),this._getUnscaledVertex(this.indices[U+1],b),this._getUnscaledVertex(this.indices[U+2],R),p.setFromPoints(O),r.insert(p,T)}r.removeEmptyNodes()}getTrianglesInAABB(r,h){Ri.copy(r);const p=this.scale,y=p.x,b=p.y,R=p.z,O=Ri.lowerBound,T=Ri.upperBound;return O.x/=y,O.y/=b,O.z/=R,T.x/=y,T.y/=b,T.z/=R,this.tree.aabbQuery(Ri,h)}setScale(r){this.scale.x===this.scale.y&&this.scale.y===this.scale.z&&r.x===r.y&&r.y===r.z||this.updateNormals(),this.scale.copy(r),this.updateAABB(),this.updateBoundingSphereRadius()}updateNormals(){const r=ma,h=this.normals;for(let p=0;p<this.indices.length/3;p++){const y=3*p,R=this.indices[y+1],O=this.indices[y+2];this.getVertex(this.indices[y],ss),this.getVertex(R,Qi),this.getVertex(O,Hr),pl.computeNormal(Qi,ss,Hr,r),h[y]=r.x,h[y+1]=r.y,h[y+2]=r.z}}updateEdges(){const r={},h=(y,b)=>{r[y<b?y+"_"+b:b+"_"+y]=!0};for(let y=0;y<this.indices.length/3;y++){const b=3*y,R=this.indices[b],O=this.indices[b+1],T=this.indices[b+2];h(R,O),h(O,T),h(T,R)}const p=Object.keys(r);this.edges=new Int16Array(2*p.length);for(let y=0;y<p.length;y++){const b=p[y].split("_");this.edges[2*y]=parseInt(b[0],10),this.edges[2*y+1]=parseInt(b[1],10)}}getEdgeVertex(r,h,p){this.getVertex(this.edges[2*r+(h?1:0)],p)}getEdgeVector(r,h){const p=Ds,y=tr;this.getEdgeVertex(r,0,p),this.getEdgeVertex(r,1,y),y.vsub(p,h)}getVertex(r,h){const p=this.scale;return this._getUnscaledVertex(r,h),h.x*=p.x,h.y*=p.y,h.z*=p.z,h}_getUnscaledVertex(r,h){const p=3*r,y=this.vertices;return h.set(y[p],y[p+1],y[p+2])}getWorldVertex(r,h,p,y){return this.getVertex(r,y),H.pointToWorldFrame(h,p,y,y),y}getTriangleVertices(r,h,p,y){const b=3*r;this.getVertex(this.indices[b],h),this.getVertex(this.indices[b+1],p),this.getVertex(this.indices[b+2],y)}getNormal(r,h){const p=3*r;return h.set(this.normals[p],this.normals[p+1],this.normals[p+2])}calculateLocalInertia(r,h){this.computeLocalAABB(di);const p=di.upperBound.x-di.lowerBound.x,y=di.upperBound.y-di.lowerBound.y,b=di.upperBound.z-di.lowerBound.z;return h.set(1/12*r*(2*y*2*y+2*b*2*b),1/12*r*(2*p*2*p+2*b*2*b),1/12*r*(2*y*2*y+2*p*2*p))}computeLocalAABB(r){const h=r.lowerBound,p=r.upperBound,y=this.vertices.length,b=xi;this.getVertex(0,b),h.copy(b),p.copy(b);for(let R=0;R!==y;R++)this.getVertex(R,b),b.x<h.x?h.x=b.x:b.x>p.x&&(p.x=b.x),b.y<h.y?h.y=b.y:b.y>p.y&&(p.y=b.y),b.z<h.z?h.z=b.z:b.z>p.z&&(p.z=b.z)}updateAABB(){this.computeLocalAABB(this.aabb)}updateBoundingSphereRadius(){let r=0;const h=this.vertices,p=new M;for(let y=0,b=h.length/3;y!==b;y++){this.getVertex(y,p);const R=p.lengthSquared();R>r&&(r=R)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,p,y){const b=Us,R=Xh;b.position=r,b.quaternion=h,this.aabb.toWorldFrame(b,R),p.copy(R.lowerBound),y.copy(R.upperBound)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}}const ma=new M,Ri=new he,Ds=new M,tr=new M,wn=new M,Ho=new M;pl.computeNormal=(a,r,h,p)=>{r.vsub(a,Ho),h.vsub(r,wn),wn.cross(Ho,p),p.isZero()||p.normalize()};const ss=new M,Qi=new M,Hr=new M,di=new he,xi=new M,Us=new H,Xh=new he;pl.createTorus=(a=1,r=.5,h=8,p=6,y=2*Math.PI)=>{const b=[],R=[];for(let O=0;O<=h;O++)for(let T=0;T<=p;T++){const U=T/p*y,ee=O/h*Math.PI*2,ie=(a+r*Math.cos(ee))*Math.cos(U),ne=(a+r*Math.cos(ee))*Math.sin(U),ve=r*Math.sin(ee);b.push(ie,ne,ve)}for(let O=1;O<=h;O++)for(let T=1;T<=p;T++){const ee=(p+1)*(O-1)+T-1,ie=(p+1)*(O-1)+T,ne=(p+1)*O+T;R.push((p+1)*O+T-1,ee,ne),R.push(ee,ie,ne)}return new pl(b,R)};class yo{constructor(){this.equations=[]}solve(r,h){return 0}addEquation(r){r.enabled&&this.equations.push(r)}removeEquation(r){const h=this.equations,p=h.indexOf(r);-1!==p&&h.splice(p,1)}removeAllEquations(){this.equations.length=0}}class yu extends yo{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(r,h){let p=0;const y=this.iterations,b=this.tolerance*this.tolerance,R=this.equations,O=R.length,T=h.bodies,U=T.length,ee=r;let ie,ne,ve,be,Te,Le;if(0!==O)for(let je=0;je!==U;je++)T[je].updateSolveMassProperties();const Ie=lt,Oe=$l,Fe=zn;Ie.length=O,Oe.length=O,Fe.length=O;for(let je=0;je!==O;je++){const Ue=R[je];Fe[je]=0,Oe[je]=Ue.computeB(ee),Ie[je]=1/Ue.computeC()}if(0!==O){for(let Je=0;Je!==U;Je++){const pt=T[Je],Mt=pt.wlambda;pt.vlambda.set(0,0,0),Mt.set(0,0,0)}for(p=0;p!==y;p++){be=0;for(let Je=0;Je!==O;Je++){const pt=R[Je];ie=Oe[Je],ne=Ie[Je],Le=Fe[Je],Te=pt.computeGWlambda(),ve=ne*(ie-Te-pt.eps*Le),Le+ve<pt.minForce?ve=pt.minForce-Le:Le+ve>pt.maxForce&&(ve=pt.maxForce-Le),Fe[Je]+=ve,be+=ve>0?ve:-ve,pt.addToWlambda(ve)}if(be*be<b)break}for(let Je=0;Je!==U;Je++){const pt=T[Je],at=pt.velocity,Mt=pt.angularVelocity;pt.vlambda.vmul(pt.linearFactor,pt.vlambda),at.vadd(pt.vlambda,at),pt.wlambda.vmul(pt.angularFactor,pt.wlambda),Mt.vadd(pt.wlambda,Mt)}let je=R.length;const Ue=1/ee;for(;je--;)R[je].multiplier=Fe[je]*Ue}return p}}const zn=[],lt=[],$l=[];class As extends yo{constructor(r){for(super(),this.iterations=10,this.tolerance=1e-7,this.subsolver=r,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}createNode(){return{body:null,children:[],eqs:[],visited:!1}}solve(r,h){const p=Tp,y=this.nodePool,b=h.bodies,R=this.equations,O=R.length,T=b.length,U=this.subsolver;for(;y.length<T;)y.push(this.createNode());p.length=T;for(let be=0;be<T;be++)p[be]=y[be];for(let be=0;be!==T;be++){const Te=p[be];Te.body=b[be],Te.children.length=0,Te.eqs.length=0,Te.visited=!1}for(let be=0;be!==O;be++){const Te=R[be],Le=b.indexOf(Te.bi),Ie=b.indexOf(Te.bj),Oe=p[Le],Fe=p[Ie];Oe.children.push(Fe),Oe.eqs.push(Te),Fe.children.push(Oe),Fe.eqs.push(Te)}let ee,ie=0,ne=$s;U.tolerance=this.tolerance,U.iterations=this.iterations;const ve=Sc;for(;ee=io(p);){ne.length=0,ve.bodies.length=0,Jc(ee,$i,ve.bodies,ne);const be=ne.length;ne=ne.sort(ht);for(let Te=0;Te!==be;Te++)U.addEquation(ne[Te]);U.solve(r,ve),U.removeAllEquations(),ie++}return ie}}const Tp=[],$s=[],Sc={bodies:[]},Di=dt.STATIC;function io(a){const r=a.length;for(let h=0;h!==r;h++){const p=a[h];if(!(p.visited||p.body.type&Di))return p}return!1}const ri=[];function Jc(a,r,h,p){for(ri.push(a),a.visited=!0,r(a,h,p);ri.length;){const y=ri.pop();let b;for(;b=io(y.children);)b.visited=!0,r(b,h,p),ri.push(b)}}function $i(a,r,h){r.push(a.body);const p=a.eqs.length;for(let y=0;y!==p;y++){const b=a.eqs[y];h.includes(b)||h.push(b)}}function ht(a,r){return r.id-a.id}class bu{constructor(){this.objects=[],this.type=Object}release(...r){const h=r.length;for(let p=0;p!==h;p++)this.objects.push(r[p]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(r){const h=this.objects;for(;h.length>r;)h.pop();for(;h.length<r;)h.push(this.constructObject());return this}}class Mp extends bu{constructor(){super(),this.type=M}constructObject(){return new M}}const Ui={sphereSphere:oe.types.SPHERE,spherePlane:oe.types.SPHERE|oe.types.PLANE,boxBox:oe.types.BOX|oe.types.BOX,sphereBox:oe.types.SPHERE|oe.types.BOX,planeBox:oe.types.PLANE|oe.types.BOX,convexConvex:oe.types.CONVEXPOLYHEDRON,sphereConvex:oe.types.SPHERE|oe.types.CONVEXPOLYHEDRON,planeConvex:oe.types.PLANE|oe.types.CONVEXPOLYHEDRON,boxConvex:oe.types.BOX|oe.types.CONVEXPOLYHEDRON,sphereHeightfield:oe.types.SPHERE|oe.types.HEIGHTFIELD,boxHeightfield:oe.types.BOX|oe.types.HEIGHTFIELD,convexHeightfield:oe.types.CONVEXPOLYHEDRON|oe.types.HEIGHTFIELD,sphereParticle:oe.types.PARTICLE|oe.types.SPHERE,planeParticle:oe.types.PLANE|oe.types.PARTICLE,boxParticle:oe.types.BOX|oe.types.PARTICLE,convexParticle:oe.types.PARTICLE|oe.types.CONVEXPOLYHEDRON,sphereTrimesh:oe.types.SPHERE|oe.types.TRIMESH,planeTrimesh:oe.types.PLANE|oe.types.TRIMESH};class kr{constructor(r){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new Mp,this.world=r,this.currentContactMaterial=r.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(r,h,p,y,b,R){let O;this.contactPointPool.length?(O=this.contactPointPool.pop(),O.bi=r,O.bj=h):O=new To(r,h),O.enabled=r.collisionResponse&&h.collisionResponse&&p.collisionResponse&&y.collisionResponse;const T=this.currentContactMaterial;O.restitution=T.restitution,O.setSpookParams(T.contactEquationStiffness,T.contactEquationRelaxation,this.world.dt);const U=p.material||r.material,ee=y.material||h.material;return U&&ee&&U.restitution>=0&&ee.restitution>=0&&(O.restitution=U.restitution*ee.restitution),O.si=b||p,O.sj=R||y,O}createFrictionEquationsFromContact(r,h){const p=r.bi,y=r.bj,O=this.world,T=this.currentContactMaterial;let U=T.friction;const ee=r.si.material||p.material,ie=r.sj.material||y.material;if(ee&&ie&&ee.friction>=0&&ie.friction>=0&&(U=ee.friction*ie.friction),U>0){const ne=U*O.gravity.length();let ve=p.invMass+y.invMass;ve>0&&(ve=1/ve);const be=this.frictionEquationPool,Te=be.length?be.pop():new _c(p,y,ne*ve),Le=be.length?be.pop():new _c(p,y,ne*ve);return Te.bi=Le.bi=p,Te.bj=Le.bj=y,Te.minForce=Le.minForce=-ne*ve,Te.maxForce=Le.maxForce=ne*ve,Te.ri.copy(r.ri),Te.rj.copy(r.rj),Le.ri.copy(r.ri),Le.rj.copy(r.rj),r.ni.tangents(Te.t,Le.t),Te.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,O.dt),Le.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,O.dt),Te.enabled=Le.enabled=r.enabled,h.push(Te,Le),!0}return!1}createFrictionFromAverage(r){let h=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(h,this.frictionResult)||1===r)return;const p=this.frictionResult[this.frictionResult.length-2],y=this.frictionResult[this.frictionResult.length-1];qr.setZero(),Ya.setZero(),bo.setZero();const b=h.bi;for(let O=0;O!==r;O++)h=this.result[this.result.length-1-O],h.bi!==b?(qr.vadd(h.ni,qr),Ya.vadd(h.ri,Ya),bo.vadd(h.rj,bo)):(qr.vsub(h.ni,qr),Ya.vadd(h.rj,Ya),bo.vadd(h.ri,bo));const R=1/r;Ya.scale(R,p.ri),bo.scale(R,p.rj),y.ri.copy(p.ri),y.rj.copy(p.rj),qr.normalize(),qr.tangents(p.t,y.t)}getContacts(r,h,p,y,b,R,O){this.contactPointPool=b,this.frictionEquationPool=O,this.result=y,this.frictionResult=R;const T=Ec,U=Zc,ee=_a,ie=xu;for(let ne=0,ve=r.length;ne!==ve;ne++){const be=r[ne],Te=h[ne];let Le=null;be.material&&Te.material&&(Le=p.getContactMaterial(be.material,Te.material)||null);const Ie=be.type&dt.KINEMATIC&&Te.type&dt.STATIC||be.type&dt.STATIC&&Te.type&dt.KINEMATIC||be.type&dt.KINEMATIC&&Te.type&dt.KINEMATIC;for(let Oe=0;Oe<be.shapes.length;Oe++){be.quaternion.mult(be.shapeOrientations[Oe],T),be.quaternion.vmult(be.shapeOffsets[Oe],ee),ee.vadd(be.position,ee);const Fe=be.shapes[Oe];for(let je=0;je<Te.shapes.length;je++){Te.quaternion.mult(Te.shapeOrientations[je],U),Te.quaternion.vmult(Te.shapeOffsets[je],ie),ie.vadd(Te.position,ie);const Ue=Te.shapes[je];if(!(Fe.collisionFilterMask&Ue.collisionFilterGroup&&Ue.collisionFilterMask&Fe.collisionFilterGroup)||ee.distanceTo(ie)>Fe.boundingSphereRadius+Ue.boundingSphereRadius)continue;let Je=null;Fe.material&&Ue.material&&(Je=p.getContactMaterial(Fe.material,Ue.material)||null),this.currentContactMaterial=Je||Le||p.defaultContactMaterial;const pt=this[Fe.type|Ue.type];if(pt){let at=!1;at=Fe.type<Ue.type?pt.call(this,Fe,Ue,ee,ie,T,U,be,Te,Fe,Ue,Ie):pt.call(this,Ue,Fe,ie,ee,U,T,Te,be,Fe,Ue,Ie),at&&Ie&&(p.shapeOverlapKeeper.set(Fe.id,Ue.id),p.bodyOverlapKeeper.set(be.id,Te.id))}}}}}sphereSphere(r,h,p,y,b,R,O,T,U,ee,ie){if(ie)return p.distanceSquared(y)<(r.radius+h.radius)**2;const ne=this.createContactEquation(O,T,r,h,U,ee);y.vsub(p,ne.ni),ne.ni.normalize(),ne.ri.copy(ne.ni),ne.rj.copy(ne.ni),ne.ri.scale(r.radius,ne.ri),ne.rj.scale(-h.radius,ne.rj),ne.ri.vadd(p,ne.ri),ne.ri.vsub(O.position,ne.ri),ne.rj.vadd(y,ne.rj),ne.rj.vsub(T.position,ne.rj),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}spherePlane(r,h,p,y,b,R,O,T,U,ee,ie){const ne=this.createContactEquation(O,T,r,h,U,ee);if(ne.ni.set(0,0,1),R.vmult(ne.ni,ne.ni),ne.ni.negate(ne.ni),ne.ni.normalize(),ne.ni.scale(r.radius,ne.ri),p.vsub(y,fn),ne.ni.scale(ne.ni.dot(fn),tn),fn.vsub(tn,ne.rj),-fn.dot(ne.ni)<=r.radius){if(ie)return!0;const ve=ne.ri,be=ne.rj;ve.vadd(p,ve),ve.vsub(O.position,ve),be.vadd(y,be),be.vsub(T.position,be),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}}boxBox(r,h,p,y,b,R,O,T,U,ee,ie){return r.convexPolyhedronRepresentation.material=r.material,h.convexPolyhedronRepresentation.material=h.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h.convexPolyhedronRepresentation,p,y,b,R,O,T,r,h,ie)}sphereBox(r,h,p,y,b,R,O,T,U,ee,ie){const ne=this.v3pool,ve=ts;p.vsub(y,yr),h.getSideNormals(ve,R);const be=r.radius;let Te=!1;const Le=Qs,Ie=Bo,Oe=ec;let Fe=null,je=0,Ue=0,Je=0,pt=null;for(let $t=0,Zt=ve.length;$t!==Zt&&!1===Te;$t++){const Tn=Xr;Tn.copy(ve[$t]);const $n=Tn.length();Tn.normalize();const Qn=yr.dot(Tn);if(Qn<$n+be&&Qn>0){const lr=fi,jn=Rr;lr.copy(ve[($t+1)%3]),jn.copy(ve[($t+2)%3]);const pr=lr.length(),Yn=jn.length();lr.normalize(),jn.normalize();const wr=yr.dot(lr),Or=yr.dot(jn);if(wr<pr&&wr>-pr&&Or<Yn&&Or>-Yn){const Ji=Math.abs(Qn-$n-be);if((null===pt||Ji<pt)&&(pt=Ji,Ue=wr,Je=Or,Fe=$n,Le.copy(Tn),Ie.copy(lr),Oe.copy(jn),je++,ie))return!0}}}if(je){Te=!0;const $t=this.createContactEquation(O,T,r,h,U,ee);Le.scale(-be,$t.ri),$t.ni.copy(Le),$t.ni.negate($t.ni),Le.scale(Fe,Le),Ie.scale(Ue,Ie),Le.vadd(Ie,Le),Oe.scale(Je,Oe),Le.vadd(Oe,$t.rj),$t.ri.vadd(p,$t.ri),$t.ri.vsub(O.position,$t.ri),$t.rj.vadd(y,$t.rj),$t.rj.vsub(T.position,$t.rj),this.result.push($t),this.createFrictionEquationsFromContact($t,this.frictionResult)}let at=ne.get();const Mt=co;for(let $t=0;2!==$t&&!Te;$t++)for(let Zt=0;2!==Zt&&!Te;Zt++)for(let Tn=0;2!==Tn&&!Te;Tn++)if(at.set(0,0,0),$t?at.vadd(ve[0],at):at.vsub(ve[0],at),Zt?at.vadd(ve[1],at):at.vsub(ve[1],at),Tn?at.vadd(ve[2],at):at.vsub(ve[2],at),y.vadd(at,Mt),Mt.vsub(p,Mt),Mt.lengthSquared()<be*be){if(ie)return!0;Te=!0;const $n=this.createContactEquation(O,T,r,h,U,ee);$n.ri.copy(Mt),$n.ri.normalize(),$n.ni.copy($n.ri),$n.ri.scale(be,$n.ri),$n.rj.copy(at),$n.ri.vadd(p,$n.ri),$n.ri.vsub(O.position,$n.ri),$n.rj.vadd(y,$n.rj),$n.rj.vsub(T.position,$n.rj),this.result.push($n),this.createFrictionEquationsFromContact($n,this.frictionResult)}ne.release(at),at=null;const Tt=ne.get(),Yt=ne.get(),jt=ne.get(),It=ne.get(),Nt=ne.get(),ft=ve.length;for(let $t=0;$t!==ft&&!Te;$t++)for(let Zt=0;Zt!==ft&&!Te;Zt++)if($t%3!=Zt%3){ve[Zt].cross(ve[$t],Tt),Tt.normalize(),ve[$t].vadd(ve[Zt],Yt),jt.copy(p),jt.vsub(Yt,jt),jt.vsub(y,jt);const Tn=jt.dot(Tt);Tt.scale(Tn,It);let $n=0;for(;$n===$t%3||$n===Zt%3;)$n++;Nt.copy(p),Nt.vsub(It,Nt),Nt.vsub(Yt,Nt),Nt.vsub(y,Nt);const Qn=Math.abs(Tn),lr=Nt.length();if(Qn<ve[$n].length()&&lr<be){if(ie)return!0;Te=!0;const jn=this.createContactEquation(O,T,r,h,U,ee);Yt.vadd(It,jn.rj),jn.rj.copy(jn.rj),Nt.negate(jn.ni),jn.ni.normalize(),jn.ri.copy(jn.rj),jn.ri.vadd(y,jn.ri),jn.ri.vsub(p,jn.ri),jn.ri.normalize(),jn.ri.scale(be,jn.ri),jn.ri.vadd(p,jn.ri),jn.ri.vsub(O.position,jn.ri),jn.rj.vadd(y,jn.rj),jn.rj.vsub(T.position,jn.rj),this.result.push(jn),this.createFrictionEquationsFromContact(jn,this.frictionResult)}}ne.release(Tt,Yt,jt,It,Nt)}planeBox(r,h,p,y,b,R,O,T,U,ee,ie){return h.convexPolyhedronRepresentation.material=h.material,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,h.convexPolyhedronRepresentation.id=h.id,this.planeConvex(r,h.convexPolyhedronRepresentation,p,y,b,R,O,T,r,h,ie)}convexConvex(r,h,p,y,b,R,O,T,U,ee,ie,ne,ve){const be=$p;if(!(p.distanceTo(y)>r.boundingSphereRadius+h.boundingSphereRadius)&&r.findSeparatingAxis(h,p,b,y,R,be,ne,ve)){const Te=[],Le=ar;r.clipAgainstHull(p,b,h,y,R,be,-100,100,Te);let Ie=0;for(let Oe=0;Oe!==Te.length;Oe++){if(ie)return!0;const Fe=this.createContactEquation(O,T,r,h,U,ee),je=Fe.ri,Ue=Fe.rj;be.negate(Fe.ni),Te[Oe].normal.negate(Le),Le.scale(Te[Oe].depth,Le),Te[Oe].point.vadd(Le,je),Ue.copy(Te[Oe].point),je.vsub(p,je),Ue.vsub(y,Ue),je.vadd(p,je),je.vsub(O.position,je),Ue.vadd(y,Ue),Ue.vsub(T.position,Ue),this.result.push(Fe),Ie++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Fe,this.frictionResult)}this.enableFrictionReduction&&Ie&&this.createFrictionFromAverage(Ie)}}sphereConvex(r,h,p,y,b,R,O,T,U,ee,ie){const ne=this.v3pool;p.vsub(y,Yo);const ve=h.faceNormals,be=h.faces,Te=h.vertices,Le=r.radius;let Ie=!1;for(let Oe=0;Oe!==Te.length;Oe++){const je=rh;R.vmult(Te[Oe],je),y.vadd(je,je);const Ue=Yh;if(je.vsub(p,Ue),Ue.lengthSquared()<Le*Le){if(ie)return!0;Ie=!0;const Je=this.createContactEquation(O,T,r,h,U,ee);return Je.ri.copy(Ue),Je.ri.normalize(),Je.ni.copy(Je.ri),Je.ri.scale(Le,Je.ri),je.vsub(y,Je.rj),Je.ri.vadd(p,Je.ri),Je.ri.vsub(O.position,Je.ri),Je.rj.vadd(y,Je.rj),Je.rj.vsub(T.position,Je.rj),this.result.push(Je),void this.createFrictionEquationsFromContact(Je,this.frictionResult)}}for(let Oe=0,Fe=be.length;Oe!==Fe&&!1===Ie;Oe++){const Ue=be[Oe],Je=Ap;R.vmult(ve[Oe],Je);const pt=Eh;R.vmult(Te[Ue[0]],pt),pt.vadd(y,pt);const at=cd;Je.scale(-Le,at),p.vadd(at,at);const Mt=Th;at.vsub(pt,Mt);const Tt=Mt.dot(Je),Yt=Rd;if(p.vsub(pt,Yt),Tt<0&&Yt.dot(Je)>0){const jt=[];for(let It=0,Nt=Ue.length;It!==Nt;It++){const ft=ne.get();R.vmult(Te[Ue[It]],ft),y.vadd(ft,ft),jt.push(ft)}if($r(jt,Je,p)){if(ie)return!0;Ie=!0;const It=this.createContactEquation(O,T,r,h,U,ee);Je.scale(-Le,It.ri),Je.negate(It.ni);const Nt=ne.get();Je.scale(-Tt,Nt);const ft=ne.get();Je.scale(-Le,ft),p.vsub(y,It.rj),It.rj.vadd(ft,It.rj),It.rj.vadd(Nt,It.rj),It.rj.vadd(y,It.rj),It.rj.vsub(T.position,It.rj),It.ri.vadd(p,It.ri),It.ri.vsub(O.position,It.ri),ne.release(Nt),ne.release(ft),this.result.push(It),this.createFrictionEquationsFromContact(It,this.frictionResult);for(let $t=0,Zt=jt.length;$t!==Zt;$t++)ne.release(jt[$t]);return}for(let It=0;It!==Ue.length;It++){const Nt=ne.get(),ft=ne.get();R.vmult(Te[Ue[(It+1)%Ue.length]],Nt),R.vmult(Te[Ue[(It+2)%Ue.length]],ft),y.vadd(Nt,Nt),y.vadd(ft,ft);const $t=Xi;ft.vsub(Nt,$t);const Zt=Ac;$t.unit(Zt);const Tn=ne.get(),$n=ne.get();p.vsub(Nt,$n);const Qn=$n.dot(Zt);Zt.scale(Qn,Tn),Tn.vadd(Nt,Tn);const lr=ne.get();if(Tn.vsub(p,lr),Qn>0&&Qn*Qn<$t.lengthSquared()&&lr.lengthSquared()<Le*Le){if(ie)return!0;const jn=this.createContactEquation(O,T,r,h,U,ee);Tn.vsub(y,jn.rj),Tn.vsub(p,jn.ni),jn.ni.normalize(),jn.ni.scale(Le,jn.ri),jn.rj.vadd(y,jn.rj),jn.rj.vsub(T.position,jn.rj),jn.ri.vadd(p,jn.ri),jn.ri.vsub(O.position,jn.ri),this.result.push(jn),this.createFrictionEquationsFromContact(jn,this.frictionResult);for(let pr=0,Yn=jt.length;pr!==Yn;pr++)ne.release(jt[pr]);return ne.release(Nt),ne.release(ft),ne.release(Tn),ne.release(lr),void ne.release($n)}ne.release(Nt),ne.release(ft),ne.release(Tn),ne.release(lr),ne.release($n)}for(let It=0,Nt=jt.length;It!==Nt;It++)ne.release(jt[It])}}}planeConvex(r,h,p,y,b,R,O,T,U,ee,ie){const ne=ud,ve=Pr;ve.set(0,0,1),b.vmult(ve,ve);let be=0;const Te=$c;for(let Le=0;Le!==h.vertices.length;Le++)if(ne.copy(h.vertices[Le]),R.vmult(ne,ne),y.vadd(ne,ne),ne.vsub(p,Te),ve.dot(Te)<=0){if(ie)return!0;const Ie=this.createContactEquation(O,T,r,h,U,ee),Oe=Ks;ve.scale(ve.dot(Te),Oe),ne.vsub(Oe,Oe),Oe.vsub(p,Ie.ri),Ie.ni.copy(ve),ne.vsub(y,Ie.rj),Ie.ri.vadd(p,Ie.ri),Ie.ri.vsub(O.position,Ie.ri),Ie.rj.vadd(y,Ie.rj),Ie.rj.vsub(T.position,Ie.rj),this.result.push(Ie),be++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Ie,this.frictionResult)}this.enableFrictionReduction&&be&&this.createFrictionFromAverage(be)}boxConvex(r,h,p,y,b,R,O,T,U,ee,ie){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h,p,y,b,R,O,T,r,h,ie)}sphereHeightfield(r,h,p,y,b,R,O,T,U,ee,ie){const ne=h.data,ve=r.radius,be=h.elementSize,Te=Zh,Le=ih;H.pointToLocalFrame(y,R,p,Le);let Ie=Math.floor((Le.x-ve)/be)-1,Oe=Math.ceil((Le.x+ve)/be)+1,Fe=Math.floor((Le.y-ve)/be)-1,je=Math.ceil((Le.y+ve)/be)+1;if(Oe<0||je<0||Ie>ne.length||Fe>ne[0].length)return;Ie<0&&(Ie=0),Oe<0&&(Oe=0),Fe<0&&(Fe=0),je<0&&(je=0),Ie>=ne.length&&(Ie=ne.length-1),Oe>=ne.length&&(Oe=ne.length-1),je>=ne[0].length&&(je=ne[0].length-1),Fe>=ne[0].length&&(Fe=ne[0].length-1);const Ue=[];if(h.getRectMinMax(Ie,Fe,Oe,je,Ue),Le.z-ve>Ue[1]||Le.z+ve<Ue[0])return;const at=this.result;for(let Mt=Ie;Mt<Oe;Mt++)for(let Tt=Fe;Tt<je;Tt++){const Yt=at.length;let jt=!1;if(h.getConvexTrianglePillar(Mt,Tt,!1),H.pointToWorldFrame(y,R,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(jt=this.sphereConvex(r,h.pillarConvex,p,Te,b,R,O,T,r,h,ie)),ie&&jt||(h.getConvexTrianglePillar(Mt,Tt,!0),H.pointToWorldFrame(y,R,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(jt=this.sphereConvex(r,h.pillarConvex,p,Te,b,R,O,T,r,h,ie)),ie&&jt))return!0;if(at.length-Yt>2)return}}boxHeightfield(r,h,p,y,b,R,O,T,U,ee,ie){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexHeightfield(r.convexPolyhedronRepresentation,h,p,y,b,R,O,T,r,h,ie)}convexHeightfield(r,h,p,y,b,R,O,T,U,ee,ie){const ne=h.data,ve=h.elementSize,be=r.boundingSphereRadius,Te=dl,Le=Cc,Ie=Vr;H.pointToLocalFrame(y,R,p,Ie);let Oe=Math.floor((Ie.x-be)/ve)-1,Fe=Math.ceil((Ie.x+be)/ve)+1,je=Math.floor((Ie.y-be)/ve)-1,Ue=Math.ceil((Ie.y+be)/ve)+1;if(Fe<0||Ue<0||Oe>ne.length||je>ne[0].length)return;Oe<0&&(Oe=0),Fe<0&&(Fe=0),je<0&&(je=0),Ue<0&&(Ue=0),Oe>=ne.length&&(Oe=ne.length-1),Fe>=ne.length&&(Fe=ne.length-1),Ue>=ne[0].length&&(Ue=ne[0].length-1),je>=ne[0].length&&(je=ne[0].length-1);const Je=[];if(h.getRectMinMax(Oe,je,Fe,Ue,Je),!(Ie.z-be>Je[1]||Ie.z+be<Je[0]))for(let Mt=Oe;Mt<Fe;Mt++)for(let Tt=je;Tt<Ue;Tt++){let Yt=!1;if(h.getConvexTrianglePillar(Mt,Tt,!1),H.pointToWorldFrame(y,R,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Yt=this.convexConvex(r,h.pillarConvex,p,Te,b,R,O,T,null,null,ie,Le,null)),ie&&Yt||(h.getConvexTrianglePillar(Mt,Tt,!0),H.pointToWorldFrame(y,R,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Yt=this.convexConvex(r,h.pillarConvex,p,Te,b,R,O,T,null,null,ie,Le,null)),ie&&Yt))return!0}}sphereParticle(r,h,p,y,b,R,O,T,U,ee,ie){const ne=ga;if(ne.set(0,0,1),y.vsub(p,ne),ne.lengthSquared()<=r.radius*r.radius){if(ie)return!0;const ve=this.createContactEquation(T,O,h,r,U,ee);ne.normalize(),ve.rj.copy(ne),ve.rj.scale(r.radius,ve.rj),ve.ni.copy(ne),ve.ni.negate(ve.ni),ve.ri.set(0,0,0),this.result.push(ve),this.createFrictionEquationsFromContact(ve,this.frictionResult)}}planeParticle(r,h,p,y,b,R,O,T,U,ee,ie){const ne=Ll;ne.set(0,0,1),O.quaternion.vmult(ne,ne);const ve=Mh;if(y.vsub(O.position,ve),ne.dot(ve)<=0){if(ie)return!0;const be=this.createContactEquation(T,O,h,r,U,ee);be.ni.copy(ne),be.ni.negate(be.ni),be.ri.set(0,0,0);const Te=Jh;ne.scale(ne.dot(y),Te),y.vsub(Te,Te),be.rj.copy(Te),this.result.push(be),this.createFrictionEquationsFromContact(be,this.frictionResult)}}boxParticle(r,h,p,y,b,R,O,T,U,ee,ie){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexParticle(r.convexPolyhedronRepresentation,h,p,y,b,R,O,T,r,h,ie)}convexParticle(r,h,p,y,b,R,O,T,U,ee,ie){let ne=-1;const ve=eo,be=Cs;let Te=null;const Le=zr;if(Le.copy(y),Le.vsub(p,Le),b.conjugate(hd),hd.vmult(Le,Le),r.pointIsInside(Le)){r.worldVerticesNeedsUpdate&&r.computeWorldVertices(p,b),r.worldFaceNormalsNeedsUpdate&&r.computeWorldFaceNormals(b);for(let Ie=0,Oe=r.faces.length;Ie!==Oe;Ie++){const je=r.worldFaceNormals[Ie];y.vsub(r.worldVertices[r.faces[Ie][0]],No);const Ue=-je.dot(No);if(null===Te||Math.abs(Ue)<Math.abs(Te)){if(ie)return!0;Te=Ue,ne=Ie,ve.copy(je)}}if(-1!==ne){const Ie=this.createContactEquation(T,O,h,r,U,ee);ve.scale(Te,be),be.vadd(y,be),be.vsub(p,be),Ie.rj.copy(be),ve.negate(Ie.ni),Ie.ri.set(0,0,0);const Oe=Ie.ri,Fe=Ie.rj;Oe.vadd(y,Oe),Oe.vsub(T.position,Oe),Fe.vadd(p,Fe),Fe.vsub(O.position,Fe),this.result.push(Ie),this.createFrictionEquationsFromContact(Ie,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}sphereTrimesh(r,h,p,y,b,R,O,T,U,ee,ie){const ne=Kl,ve=Su,be=Na,Te=xo,Le=zs,Ie=Mc,Oe=yn,Fe=Ba,je=Cl,Ue=qt;H.pointToLocalFrame(y,R,p,Le);const Je=r.radius;Oe.lowerBound.set(Le.x-Je,Le.y-Je,Le.z-Je),Oe.upperBound.set(Le.x+Je,Le.y+Je,Le.z+Je),h.getTrianglesInAABB(Oe,Ue);const pt=Ja,at=r.radius*r.radius;for(let It=0;It<Ue.length;It++)for(let Nt=0;Nt<3;Nt++)if(h.getVertex(h.indices[3*Ue[It]+Nt],pt),pt.vsub(Le,je),je.lengthSquared()<=at){if(Fe.copy(pt),H.pointToWorldFrame(y,R,Fe,pt),pt.vsub(p,je),ie)return!0;let ft=this.createContactEquation(O,T,r,h,U,ee);ft.ni.copy(je),ft.ni.normalize(),ft.ri.copy(ft.ni),ft.ri.scale(r.radius,ft.ri),ft.ri.vadd(p,ft.ri),ft.ri.vsub(O.position,ft.ri),ft.rj.copy(pt),ft.rj.vsub(T.position,ft.rj),this.result.push(ft),this.createFrictionEquationsFromContact(ft,this.frictionResult)}for(let It=0;It<Ue.length;It++)for(let Nt=0;Nt<3;Nt++){h.getVertex(h.indices[3*Ue[It]+Nt],ne),h.getVertex(h.indices[3*Ue[It]+(Nt+1)%3],ve),ve.vsub(ne,be),Le.vsub(ve,Ie);const ft=Ie.dot(be);Le.vsub(ne,Ie);let $t=Ie.dot(be);if($t>0&&ft<0&&(Le.vsub(ne,Ie),Te.copy(be),Te.normalize(),$t=Ie.dot(Te),Te.scale($t,Ie),Ie.vadd(ne,Ie),Ie.distanceTo(Le)<r.radius)){if(ie)return!0;const Zt=this.createContactEquation(O,T,r,h,U,ee);Ie.vsub(Le,Zt.ni),Zt.ni.normalize(),Zt.ni.scale(r.radius,Zt.ri),Zt.ri.vadd(p,Zt.ri),Zt.ri.vsub(O.position,Zt.ri),H.pointToWorldFrame(y,R,Ie,Ie),Ie.vsub(T.position,Zt.rj),H.vectorToWorldFrame(R,Zt.ni,Zt.ni),H.vectorToWorldFrame(R,Zt.ri,Zt.ri),this.result.push(Zt),this.createFrictionEquationsFromContact(Zt,this.frictionResult)}}const Mt=it,Tt=xt,Yt=Ut,jt=Kn;for(let It=0,Nt=Ue.length;It!==Nt;It++){h.getTriangleVertices(Ue[It],Mt,Tt,Yt),h.getNormal(Ue[It],jt),Le.vsub(Mt,Ie);let ft=Ie.dot(jt);if(jt.scale(ft,Ie),Le.vsub(Ie,Ie),ft=Ie.distanceTo(Le),Nr.pointInTriangle(Ie,Mt,Tt,Yt)&&ft<r.radius){if(ie)return!0;let $t=this.createContactEquation(O,T,r,h,U,ee);Ie.vsub(Le,$t.ni),$t.ni.normalize(),$t.ni.scale(r.radius,$t.ri),$t.ri.vadd(p,$t.ri),$t.ri.vsub(O.position,$t.ri),H.pointToWorldFrame(y,R,Ie,Ie),Ie.vsub(T.position,$t.rj),H.vectorToWorldFrame(R,$t.ni,$t.ni),H.vectorToWorldFrame(R,$t.ri,$t.ri),this.result.push($t),this.createFrictionEquationsFromContact($t,this.frictionResult)}}Ue.length=0}planeTrimesh(r,h,p,y,b,R,O,T,U,ee,ie){const ne=new M,ve=wu;ve.set(0,0,1),b.vmult(ve,ve);for(let be=0;be<h.vertices.length/3;be++){h.getVertex(be,ne);const Te=new M;Te.copy(ne),H.pointToWorldFrame(y,R,Te,ne);const Le=Sh;if(ne.vsub(p,Le),ve.dot(Le)<=0){if(ie)return!0;const Ie=this.createContactEquation(O,T,r,h,U,ee);Ie.ni.copy(ve);const Oe=Tc;ve.scale(Le.dot(ve),Oe),ne.vsub(Oe,Oe),Ie.ri.copy(Oe),Ie.ri.vsub(O.position,Ie.ri),Ie.rj.copy(ne),Ie.rj.vsub(T.position,Ie.rj),this.result.push(Ie),this.createFrictionEquationsFromContact(Ie,this.frictionResult)}}}}const qr=new M,Ya=new M,bo=new M,_a=new M,xu=new M,Ec=new Y,Zc=new Y;kr.prototype[Ui.boxBox]=kr.prototype.boxBox,kr.prototype[Ui.boxConvex]=kr.prototype.boxConvex,kr.prototype[Ui.boxParticle]=kr.prototype.boxParticle,kr.prototype[Ui.sphereSphere]=kr.prototype.sphereSphere;const wu=new M,Sh=new M,Tc=new M;kr.prototype[Ui.planeTrimesh]=kr.prototype.planeTrimesh;const Kn=new M,Cl=new M,Ja=new M,Ba=new M,Kl=new M,Su=new M,Na=new M,xo=new M,zs=new M,Mc=new M,it=new M,xt=new M,Ut=new M,yn=new he,qt=[];kr.prototype[Ui.sphereTrimesh]=kr.prototype.sphereTrimesh;const fn=new M,tn=new M;kr.prototype[Ui.spherePlane]=kr.prototype.spherePlane;const qn=new M,Gn=new M,Sr=new M;function $r(a,r,h){let p=null;const y=a.length;for(let b=0;b!==y;b++){const R=a[b],O=qn;a[(b+1)%y].vsub(R,O);const T=Gn;O.cross(r,T);const U=Sr;h.vsub(R,U);const ee=T.dot(U);if(!(null===p||ee>0&&!0===p||ee<=0&&!1===p))return!1;null===p&&(p=ee>0)}return!0}const yr=new M,Xr=new M,fi=new M,Rr=new M,ts=[new M,new M,new M,new M,new M,new M],co=new M,Qs=new M,Bo=new M,ec=new M;kr.prototype[Ui.sphereBox]=kr.prototype.sphereBox;const Yo=new M,Xi=new M,Ac=new M,Yh=new M,rh=new M,Ap=new M,Eh=new M,cd=new M,Th=new M,Rd=new M;kr.prototype[Ui.sphereConvex]=kr.prototype.sphereConvex,kr.prototype[Ui.planeBox]=kr.prototype.planeBox;const ud=new M,Pr=new M,$c=new M,Ks=new M;kr.prototype[Ui.planeConvex]=kr.prototype.planeConvex;const $p=new M,ar=new M;kr.prototype[Ui.convexConvex]=kr.prototype.convexConvex;const Ll=new M,Mh=new M,Jh=new M;kr.prototype[Ui.planeParticle]=kr.prototype.planeParticle;const ga=new M;kr.prototype[Ui.sphereParticle]=kr.prototype.sphereParticle;const hd=new Y,zr=new M,eo=new M,No=new M,Cs=new M;kr.prototype[Ui.convexParticle]=kr.prototype.convexParticle,kr.prototype[Ui.boxHeightfield]=kr.prototype.boxHeightfield;const Vr=new M,dl=new M,Cc=[0];kr.prototype[Ui.convexHeightfield]=kr.prototype.convexHeightfield;const ih=new M,Zh=new M;kr.prototype[Ui.sphereHeightfield]=kr.prototype.sphereHeightfield;class Bl{constructor(){this.current=[],this.previous=[]}getKey(r,h){if(h<r){const p=h;h=r,r=p}return r<<16|h}set(r,h){const p=this.getKey(r,h),y=this.current;let b=0;for(;p>y[b];)b++;if(p!==y[b]){for(let R=y.length-1;R>=b;R--)y[R+1]=y[R];y[b]=p}}tick(){const r=this.current;this.current=this.previous,this.previous=r,this.current.length=0}getDiff(r,h){const p=this.current,y=this.previous,b=p.length,R=y.length;let O=0;for(let T=0;T<b;T++){let U=!1;const ee=p[T];for(;ee>y[O];)O++;U=ee===y[O],U||er(r,ee)}O=0;for(let T=0;T<R;T++){let U=!1;const ee=y[T];for(;ee>p[O];)O++;U=p[O]===ee,U||er(h,ee)}}}function er(a,r){a.push((4294901760&r)>>16,65535&r)}class fl{constructor(){this.data={keys:[]}}get(r,h){if(r>h){const p=h;h=r,r=p}return this.data[r+"-"+h]}set(r,h,p){if(r>h){const b=h;h=r,r=b}const y=r+"-"+h;this.get(r,h)||this.data.keys.push(y),this.data[y]=p}reset(){const r=this.data,h=r.keys;for(;h.length>0;)delete r[h.pop()]}}class Un extends q{constructor(r={}){super(),this.dt=-1,this.allowSleep=!!r.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==r.quatNormalizeSkip?r.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==r.quatNormalizeFast&&r.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new M,r.gravity&&this.gravity.copy(r.gravity),this.broadphase=void 0!==r.broadphase?r.broadphase:new vr,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==r.solver?r.solver:new yu,this.constraints=[],this.narrowphase=new kr(this),this.collisionMatrix=new le,this.collisionMatrixPrevious=new le,this.bodyOverlapKeeper=new Bl,this.shapeOverlapKeeper=new Bl,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new fl,this.defaultMaterial=new Ju("default"),this.defaultContactMaterial=new Yu(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(r,h){return this.contactMaterialTable.get(r.id,h.id)}numObjects(){return this.bodies.length}collisionMatrixTick(){const r=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=r,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(r){this.constraints.push(r)}removeConstraint(r){const h=this.constraints.indexOf(r);-1!==h&&this.constraints.splice(h,1)}rayTest(r,h,p){p instanceof mi?this.raycastClosest(r,h,{skipBackfaces:!0},p):this.raycastAll(r,h,{skipBackfaces:!0},p)}raycastAll(r,h,p={},y){return p.mode=Nr.ALL,p.from=r,p.to=h,p.callback=y,Nl.intersectWorld(this,p)}raycastAny(r,h,p={},y){return p.mode=Nr.ANY,p.from=r,p.to=h,p.result=y,Nl.intersectWorld(this,p)}raycastClosest(r,h,p={},y){return p.mode=Nr.CLOSEST,p.from=r,p.to=h,p.result=y,Nl.intersectWorld(this,p)}addBody(r){this.bodies.includes(r)||(r.index=this.bodies.length,this.bodies.push(r),r.world=this,r.initPosition.copy(r.position),r.initVelocity.copy(r.velocity),r.timeLastSleepy=this.time,r instanceof dt&&(r.initAngularVelocity.copy(r.angularVelocity),r.initQuaternion.copy(r.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=r,this.idToBodyMap[r.id]=r,this.dispatchEvent(this.addBodyEvent))}removeBody(r){r.world=null;const h=this.bodies.length-1,p=this.bodies,y=p.indexOf(r);if(-1!==y){p.splice(y,1);for(let b=0;b!==p.length;b++)p[b].index=b;this.collisionMatrix.setNumObjects(h),this.removeBodyEvent.body=r,delete this.idToBodyMap[r.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(r){return this.idToBodyMap[r]}getShapeById(r){const h=this.bodies;for(let p=0,y=h.length;p<y;p++){const b=h[p].shapes;for(let R=0,O=b.length;R<O;R++){const T=b[R];if(T.id===r)return T}}}addMaterial(r){this.materials.push(r)}addContactMaterial(r){this.contactmaterials.push(r),this.contactMaterialTable.set(r.materials[0].id,r.materials[1].id,r)}step(r,h=0,p=10){if(0===h)this.internalStep(r),this.time+=r;else{this.accumulator+=h;let y=0;for(;this.accumulator>=r&&y<p;)this.internalStep(r),this.accumulator-=r,y++;const b=this.accumulator%r/r;for(let R=0;R!==this.bodies.length;R++){const O=this.bodies[R];O.previousPosition.lerp(O.position,b,O.interpolatedPosition),O.previousQuaternion.slerp(O.quaternion,b,O.interpolatedQuaternion),O.previousQuaternion.normalize()}this.time+=h}}internalStep(r){this.dt=r;const h=this.contacts,p=sh,y=Pa,b=this.numObjects(),R=this.bodies,O=this.solver,T=this.gravity,U=this.doProfiling,ee=this.profile,ie=dt.DYNAMIC;let ne=-1/0;const ve=this.constraints,be=oh,Te=(T.length(),T.x),Le=T.y,Ie=T.z;let Oe=0;for(U&&(ne=performance.now()),Oe=0;Oe!==b;Oe++){const jt=R[Oe];if(jt.type===ie){const It=jt.force,Nt=jt.mass;It.x+=Nt*Te,It.y+=Nt*Le,It.z+=Nt*Ie}}for(let jt=0,It=this.subsystems.length;jt!==It;jt++)this.subsystems[jt].update();U&&(ne=performance.now()),p.length=0,y.length=0,this.broadphase.collisionPairs(this,p,y),U&&(ee.broadphase=performance.now()-ne);let Fe=ve.length;for(Oe=0;Oe!==Fe;Oe++){const jt=ve[Oe];if(!jt.collideConnected)for(let It=p.length-1;It>=0;It-=1)(jt.bodyA===p[It]&&jt.bodyB===y[It]||jt.bodyB===p[It]&&jt.bodyA===y[It])&&(p.splice(It,1),y.splice(It,1))}this.collisionMatrixTick(),U&&(ne=performance.now());const je=Ra,Ue=h.length;for(Oe=0;Oe!==Ue;Oe++)je.push(h[Oe]);h.length=0;const Je=this.frictionEquations.length;for(Oe=0;Oe!==Je;Oe++)be.push(this.frictionEquations[Oe]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(p,y,this,h,je,this.frictionEquations,be),U&&(ee.narrowphase=performance.now()-ne),U&&(ne=performance.now()),Oe=0;Oe<this.frictionEquations.length;Oe++)O.addEquation(this.frictionEquations[Oe]);const pt=h.length;for(let jt=0;jt!==pt;jt++){const It=h[jt],Nt=It.bi,ft=It.bj,$t=It.si,Zt=It.sj;let Tn;Tn=Nt.material&&ft.material&&this.getContactMaterial(Nt.material,ft.material)||this.defaultContactMaterial;let $n=Tn.friction;Nt.material&&ft.material&&(Nt.material.friction>=0&&ft.material.friction>=0&&($n=Nt.material.friction*ft.material.friction),Nt.material.restitution>=0&&ft.material.restitution>=0&&(It.restitution=Nt.material.restitution*ft.material.restitution)),O.addEquation(It),Nt.allowSleep&&Nt.type===dt.DYNAMIC&&Nt.sleepState===dt.SLEEPING&&ft.sleepState===dt.AWAKE&&ft.type!==dt.STATIC&&ft.velocity.lengthSquared()+ft.angularVelocity.lengthSquared()>=2*ft.sleepSpeedLimit**2&&(Nt.wakeUpAfterNarrowphase=!0),ft.allowSleep&&ft.type===dt.DYNAMIC&&ft.sleepState===dt.SLEEPING&&Nt.sleepState===dt.AWAKE&&Nt.type!==dt.STATIC&&Nt.velocity.lengthSquared()+Nt.angularVelocity.lengthSquared()>=2*Nt.sleepSpeedLimit**2&&(ft.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Nt,ft,!0),this.collisionMatrixPrevious.get(Nt,ft)||(Cp.body=ft,Cp.contact=It,Nt.dispatchEvent(Cp),Cp.body=Nt,ft.dispatchEvent(Cp)),this.bodyOverlapKeeper.set(Nt.id,ft.id),this.shapeOverlapKeeper.set($t.id,Zt.id)}for(this.emitContactEvents(),U&&(ee.makeContactConstraints=performance.now()-ne,ne=performance.now()),Oe=0;Oe!==b;Oe++){const jt=R[Oe];jt.wakeUpAfterNarrowphase&&(jt.wakeUp(),jt.wakeUpAfterNarrowphase=!1)}for(Fe=ve.length,Oe=0;Oe!==Fe;Oe++){const jt=ve[Oe];jt.update();for(let It=0,Nt=jt.equations.length;It!==Nt;It++)O.addEquation(jt.equations[It])}O.solve(r,this),U&&(ee.solve=performance.now()-ne),O.removeAllEquations();const at=Math.pow;for(Oe=0;Oe!==b;Oe++){const jt=R[Oe];if(jt.type&ie){const It=at(1-jt.linearDamping,r),Nt=jt.velocity;Nt.scale(It,Nt);const ft=jt.angularVelocity;if(ft){const $t=at(1-jt.angularDamping,r);ft.scale($t,ft)}}}for(this.dispatchEvent(Pd),Oe=0;Oe!==b;Oe++){const jt=R[Oe];jt.preStep&&jt.preStep.call(jt)}U&&(ne=performance.now());const Mt=this.stepnumber%(this.quatNormalizeSkip+1)==0,Tt=this.quatNormalizeFast;for(Oe=0;Oe!==b;Oe++)R[Oe].integrate(r,Mt,Tt);for(this.clearForces(),this.broadphase.dirty=!0,U&&(ee.integrate=performance.now()-ne),this.time+=r,this.stepnumber+=1,this.dispatchEvent(Pi),Oe=0;Oe!==b;Oe++){const jt=R[Oe],It=jt.postStep;It&&It.call(jt)}let Yt=!0;if(this.allowSleep)for(Yt=!1,Oe=0;Oe!==b;Oe++){const jt=R[Oe];jt.sleepTick(this.time),jt.sleepState!==dt.SLEEPING&&(Yt=!0)}this.hasActiveBodies=Yt}clearForces(){const r=this.bodies,h=r.length;for(let p=0;p!==h;p++){const y=r[p];y.force.set(0,0,0),y.torque.set(0,0,0)}}}new he;const Nl=new Nr;if(typeof performance>"u"&&(performance={}),!performance.now){let a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),performance.now=()=>Date.now()-a}const Pi={type:"postStep"},Pd={type:"preStep"},Cp={type:dt.COLLIDE_EVENT_NAME,body:null,contact:null},Ra=[],oh=[],sh=[],Pa=[];function li(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Zr(a,r){this._keys=new Array(5),this._position=new l.Vector2(0,0),this._positionUpdated=!1,this._delta=new l.Vector2(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new l.Vector2(0,0),this.delta=new l.Vector2(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,this.events=new hn;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new li,this.keys[h]=new li;var p=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){p._wheel=30*b.detail,p._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}),"ontouchstart"in window||navigator.msMaxTouchPoints>0){var y=new l.Vector2(0,0);this.events.add(this.domElement,"touchstart",function(b){var R=b.touches[0];p.updatePosition(R.screenX,R.screenY,0,0),p.updateKey(Zr.LEFT,li.DOWN),y.set(R.screenX,R.screenY)}),this.events.add(this.domElement,"touchend",function(b){p.updateKey(Zr.LEFT,li.UP)}),this.events.add(this.domElement,"touchcancel",function(b){p.updateKey(Zr.LEFT,li.UP)}),this.events.add(document.body,"touchmove",function(b){var R=b.touches[0];p.updatePosition(R.screenX,R.screenY,R.screenX-y.x,R.screenY-y.y),y.set(R.screenX,R.screenY)})}this.events.add(this.domElement,"mousemove",function(b){p.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){p.updateKey(b.which-1,li.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){p.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dragstart",function(b){p.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dblclick",function(b){p._doubleClicked[b.which-1]=!0}),!0!==r&&this.create()}function hn(){this.events=[]}function Qc(){}function ci(){}function va(){}function Za(){}function Rn(){}Un.prototype.emitContactEvents=(()=>{const a=[],r=[],h={type:"beginContact",bodyA:null,bodyB:null},p={type:"endContact",bodyA:null,bodyB:null},y={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},b={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};return function(){const R=this.hasAnyEventListener("beginContact"),O=this.hasAnyEventListener("endContact");if((R||O)&&this.bodyOverlapKeeper.getDiff(a,r),R){for(let ee=0,ie=a.length;ee<ie;ee+=2)h.bodyA=this.getBodyById(a[ee]),h.bodyB=this.getBodyById(a[ee+1]),this.dispatchEvent(h);h.bodyA=h.bodyB=null}if(O){for(let ee=0,ie=r.length;ee<ie;ee+=2)p.bodyA=this.getBodyById(r[ee]),p.bodyB=this.getBodyById(r[ee+1]),this.dispatchEvent(p);p.bodyA=p.bodyB=null}a.length=r.length=0;const T=this.hasAnyEventListener("beginShapeContact"),U=this.hasAnyEventListener("endShapeContact");if((T||U)&&this.shapeOverlapKeeper.getDiff(a,r),T){for(let ee=0,ie=a.length;ee<ie;ee+=2){const ne=this.getShapeById(a[ee]),ve=this.getShapeById(a[ee+1]);y.shapeA=ne,y.shapeB=ve,y.bodyA=ne.body,y.bodyB=ve.body,this.dispatchEvent(y)}y.bodyA=y.bodyB=y.shapeA=y.shapeB=null}if(U){for(let ee=0,ie=r.length;ee<ie;ee+=2){const ne=this.getShapeById(r[ee]),ve=this.getShapeById(r[ee+1]);b.shapeA=ne,b.shapeB=ve,b.bodyA=ne.body,b.bodyB=ve.body,this.dispatchEvent(b)}b.bodyA=b.bodyB=b.shapeA=b.shapeB=null}}})(),li.DOWN=-1,li.UP=1,li.RESET=0,li.prototype.constructor=li,li.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===li.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===li.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===li.RESET&&(this.justReleased=!1,this.justPressed=!1)},li.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},li.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Zr.prototype=Zr).constructor=Zr,Zr.LEFT=0,Zr.MIDDLE=1,Zr.RIGHT=2,Zr.BACK=3,Zr.FORWARD=4,Zr.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Zr.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Zr.setLock=function(a){null!==this.canvas&&(a?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},Zr.buttonPressed=function(a){return this.keys[a].pressed},Zr.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Zr.buttonJustPressed=function(a){return this.keys[a].justPressed},Zr.buttonJustReleased=function(a){return this.keys[a].justReleased},Zr.updatePosition=function(a,r,h,p){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=p,this._positionUpdated=!0},Zr.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Zr.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Zr.create=function(){this.events.create()},Zr.dispose=function(){this.events.destroy()},hn.prototype.addAndCreate=function(a,r,h){var p=[a,r,h,!0];p[0].addEventListener(p[1],p[2]),p[3]=!0,this.events.push(p)},hn.prototype.remove=function(a,r){for(var h=this.events.length-1;h>=0;h--)this.events[h][0]===a&&this.events[h][1]===r&&(this.events[h][3]&&(this.events[h][0].removeEventListener(this.events[h][1],this.events[h][2]),this.events[h][3]=!1),this.events.splice(h,1))},hn.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},hn.prototype.clear=function(){this.destroy(),this.events=[]},hn.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},hn.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},hn.prototype.addScrollEvent=function(a,r){void 0!==window.onmousewheel?this.add(a,"mousewheel",r):void 0!==window.addEventListener?this.add(a,"DOMMouseScroll",function(h){h.deltaY=30*h.detail,r(h)}):this.add(a,"wheel",r)},Qc.PI2=2*Math.PI,Qc.PID3=Math.PI/3,Qc.PID2=Math.PI/2,Qc.randomColor=function(){for(var a="#",r=0;r<6;r++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a},ci.encoding="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ci.isBase64=function(a){if("string"!=typeof a)return!1;if(a.startsWith("data:"))return!0;for(var r=0;r<a.length;r++)if(!ci.encoding.includes(a.charAt(r)))return!1;return!0},ci.removeHeader=function(a){return a.slice(a.search(";base64,")+8)},ci.getFileFormat=function(a){var r=a.indexOf("/")+1,h=a.indexOf(";");return a.substr(r,h-r)},ci.fromArraybuffer=function(a){for(var r,b,R="",O=new Uint8Array(a),T=O.byteLength%3,U=O.byteLength-T,ee=0;ee<U;ee+=3)r=(16515072&(b=O[ee]<<16|O[ee+1]<<8|O[ee+2]))>>18,R+=ci.encoding[r]+ci.encoding[(258048&b)>>12]+ci.encoding[(4032&b)>>6]+ci.encoding[63&b];return 1===T?(r=(252&(b=O[U]))>>2,R+=ci.encoding[r]+ci.encoding[(3&b)<<4]+"=="):2===T&&(r=(64512&(b=O[U]<<8|O[U+1]))>>10,R+=ci.encoding[r]+ci.encoding[(1008&b)>>4]+ci.encoding[(15&b)<<2]+"="),R},ci.fromBinaryString=function(a){for(var r,h,p,y="",b=a.length%3,R=a.length-b,O=0;O<R;O+=3)r=255&a.charCodeAt(O),h=a.charCodeAt(O+1),p=a.charCodeAt(O+2),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2|(192&p)>>6),y+=ci.encoding.charAt(63&p);return 1===b?(r=255&a.charCodeAt(O),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4),y+="=="):2===b&&(r=255&a.charCodeAt(O),h=a.charCodeAt(O+1),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2),y+="="),y},va.fromBinaryString=function(a){for(var r=a.length,h=new ArrayBuffer(r),p=new Uint8Array(h),y=0;y<r;y++)p[y]=a.charCodeAt(y);return h},va.fromBase64=function(a){for(var r,h,p,y,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=a.length/4*3,O=new ArrayBuffer(R),T=new Uint8Array(O),U=0,ee=0;U<R;U+=3)r=b.indexOf(a.charAt(ee++)),h=b.indexOf(a.charAt(ee++)),p=b.indexOf(a.charAt(ee++)),y=b.indexOf(a.charAt(ee++)),T[U]=r<<2|h>>4,64!==p&&(T[U+1]=(15&h)<<4|p>>2),64!==y&&(T[U+2]=(3&p)<<6|y);return O},va.fromBuffer=function(a){for(var r=new ArrayBuffer(a.length),h=new Uint8Array(r),p=0;p<a.length;p++)h[p]=a[p];return r},Za.fromArrayBuffer=function(a){for(var r=new Buffer(a.byteLength),h=new Uint8Array(a),p=0;p<r.length;p++)r[p]=h[p];return r};try{Rn.fs=window.require("fs")}catch{}function wi(a,r){this.name=a,this.uuid=l.Math.generateUUID(),this.type=r,this.format="",this.encoding="",this.data=null}function ms(a,r){if(wi.call(this,"image","Image"),this.width=-1,this.height=-1,void 0!==a)if(a instanceof ArrayBuffer)this.loadArrayBufferData(a,r);else if(ci.isBase64(a))this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a;else if(a.startsWith("blob")){var h=Rn.readFileArrayBuffer(a,!0);this.loadArrayBufferData(h)}else this.encoding=Rn.getFileExtension(a),this.format="url",this.data=a;else this.createSolidColor()}function gs(a,r,h,p,y,b,R,O,T,U){this.source="string"==typeof a?new ms(a):void 0===a?new ms:a,l.Texture.call(this,document.createElement("img"),r,h,p,y,b,R,O,T,U);var ee=this;if(this.name="texture",this.category="Image",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.updateSource(),"gif"===this.source.encoding){let ie=function(){ee.disposed||(ee.needsUpdate=!0,requestAnimationFrame(ie))};this.generateMipmaps=!1,this.magFilter=l.LinearFilter,this.minFilter=l.LinearFilter,ie()}}function Ls(a){l.AmbientLight.call(this,a),this.name="ambient",this.matrixAutoUpdate=!1}function ii(a){l.Object3D.call(this),this.name="audio",this.type="Audio",this.listener=new l.AudioListener,this.context=this.listener.context,this.matrixAutoUpdate=!1,this.gain=this.context.createGain(),this.gain.connect(this.listener.getInput()),this.buffer=null,this.filters=[],this.sourceType="empty",this.audio=void 0!==a?a:null,this.autoplay=!0,this.volume=1,this.playbackRate=1,this.startTime=0,this.loop=!0,this.detune=0,this.isPlaying=!1,this.hasPlaybackControl=!0,this.filters=[]}function Tr(a,r,h,p,y,b,R,O,T,U){void 0===r&&(r=l.CubeReflectionMapping);for(var ee=[],ie=0;ie<6;ie++)ee.push(document.createElement("canvas"));l.Texture.call(this,ee,r,h,p,y,b,R,O,T,U),this.images=void 0!==a?a:[],this.size=512,this.flipY=!1,this.mode=6===this.images.length?Tr.CUBE:Tr.CROSS,this.images.length>0&&this.updateImages(),this.name="cubetexture",this.category="Cube"}function br(a,r,h,p){l.Object3D.call(this),this.name="cubecamera",this.type="CubeCamera",this.near=void 0!==a?a:.01,this.far=void 0!==r?r:1e4,this.resolution=void 0!==h?h:256,this.autoUpdate=void 0!==p&&p,this.cameras=[];for(var y=0;y<6;y++){var b=new l.PerspectiveCamera(90,1,this.near,this.far);b.parent=this,this.cameras.push(b)}this.cameras[0].up.set(0,-1,0),this.cameras[0].lookAt(new l.Vector3(1,0,0)),this.cameras[1].up.set(0,-1,0),this.cameras[1].lookAt(new l.Vector3(-1,0,0)),this.cameras[2].up.set(0,0,1),this.cameras[2].lookAt(new l.Vector3(0,1,0)),this.cameras[3].up.set(0,0,-1),this.cameras[3].lookAt(new l.Vector3(0,-1,0)),this.cameras[4].up.set(0,-1,0),this.cameras[4].lookAt(new l.Vector3(0,0,1)),this.cameras[5].up.set(0,-1,0),this.cameras[5].lookAt(new l.Vector3(0,0,-1)),this.renderTarget=new l.WebGLCubeRenderTarget(this.resolution,{format:l.RGBFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter,generateMipmaps:!1});var R=this;Object.defineProperties(this,{cube:{get:function(){return R.renderTarget.texture},set:function(){}}}),this.scene=null,this.renderer=null}function ml(a,r){l.DirectionalLight.call(this,a,r),this.name="directional",this.castShadow=!0,this.shadow.camera.near=.5,this.shadow.camera.far=1e4}Rn.isLocalFile=function(a){return!(a.startsWith("http")||a.startsWith("blob")||a.startsWith("data"))},Rn.readFile=function(a,r,h,p,y){if(void 0===r&&(r=!0),void 0!==Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a,"utf8");return void 0!==h&&h(b),b}return Rn.fs.readFile(a,"utf8",function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(T)}),null}var R=new XMLHttpRequest;return R.overrideMimeType("text/plain"),R.open("GET",a,!r),void 0!==h&&(R.onload=function(){h(R.response)}),void 0!==p&&(R.onprogress=p),void 0!==y&&(R.onerror=y),R.send(null),!0===r?R.response:null},Rn.readFileArrayBuffer=function(a,r,h,p,y){if(void 0===r&&(r=!0),void 0!==Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a);return va.fromBuffer(b)}return Rn.fs.readFile(a,function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(va.fromBuffer(T))}),null}var R=new XMLHttpRequest;return R.open("GET",a,!r),R.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(R.onload=function(){h(va.fromBinaryString(R.response))}),void 0!==p&&(R.onprogress=p),void 0!==y&&(R.onerror=y),R.send(null),!0===r?va.fromBinaryString(R.response):null},Rn.readFileBase64=function(a,r,h,p,y){if(void 0===r&&(r=!0),void 0!==Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a);return new Buffer(b).toString("base64")}return Rn.fs.readFile(a,function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(new Buffer(T).toString("base64"))}),null}var R=new XMLHttpRequest;return R.open("GET",a,!r),R.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(R.onload=function(){h(ci.fromBinaryString(R.response))}),void 0!==p&&(R.onprogress=p),void 0!==y&&(R.onerror=y),R.send(null),!0===r?ci.fromBinaryString(R.response):null},Rn.writeFile=function(a,r,h,p){if(void 0!==Rn.fs)if(void 0!==Rn.fs.writeFileSync)!1!==h?(Rn.fs.writeFileSync(a,r,"utf8"),void 0!==p&&p()):Rn.fs.writeFile(a,r,"utf8",p);else{var y=Rn.fs.createWriteStream(a,"utf8");y.write(r),y.end()}else{var b=new Blob([r],{type:"octet/stream"}),R=document.createElement("a");R.download=a,R.href=window.URL.createObjectURL(b),R.style.display="none",R.onclick=function(){document.body.removeChild(this)},document.body.appendChild(R),R.click(),void 0!==p&&p()}},Rn.writeFileBase64=function(a,r,h,p){if(void 0!==Rn.fs){var y=Buffer.from(ci.removeHeader(r),"base64");if(void 0!==Rn.fs.writeFile)!1!==h?(Rn.fs.writeFileSync(a,y),void 0!==p&&p()):Rn.fs.writeFile(a,y,p);else{var b=Rn.fs.createWriteStream(a);b.write(y),b.end()}}else{var R=va.fromBase64(ci.removeHeader(r)),O=new Blob([R]),T=document.createElement("a");T.download=a,T.href=window.URL.createObjectURL(O),T.onclick=function(){document.body.removeChild(this)},T.style.display="none",document.body.appendChild(T),T.click(),void 0!==p&&p()}},Rn.writeFileArrayBuffer=function(a,r,h,p){if(void 0!==Rn.fs){var y=Za.fromArrayBuffer(r);if(void 0!==Rn.fs.writeFileSync)!1!==h?(Rn.fs.writeFileSync(a,y),void 0!==p&&p()):Rn.fs.writeFile(a,y,p);else{var b=Rn.fs.createWriteStream(a);b.write(y),b.end()}}else{var R=new Blob([r]),O=document.createElement("a");O.download=a,O.href=window.URL.createObjectURL(R),O.onclick=function(){document.body.removeChild(this)},O.style.display="none",document.body.appendChild(O),O.click(),void 0!==p&&p()}},Rn.chooseFileWrite=function(a,r){to.runningOnDesktop()?Rn.chooseFile(function(h){h.length>0&&a(h[0].path)},r,!0):Rn.chooseFileName(function(h){a(h)},r)},Rn.chooseDirectory=function(){return new Promise(function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",h.nwdirectory=!0,document.body.appendChild(h),h.onchange=function(){a(h.value),document.body.removeChild(h)},h.onerror=r,h.onabort=r,h.click()})},Rn.chooseFile=function(a,r,h,p){var y=document.createElement("input");y.type="file",y.style.display="none",document.body.appendChild(y),void 0!==r&&(y.accept=r),!0===p&&(y.multiple=!0),y.onchange=function(){void 0!==a&&a(y.files),document.body.removeChild(y)},void 0!==h&&(y.nwsaveas=!0!==h?h:"file"),y.click()},Rn.chooseFileName=function(a,r,h){var p=prompt("Save As",void 0!==h?h:"file");null!==p&&(void 0===r||p.endsWith(r)||(p+=r),void 0!==a&&a(p))},Rn.copyFile=function(a,r){void 0!==Rn.fs&&(void 0!==Rn.fs.copyFileSync?Rn.fs.copyFileSync(a,r):(a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Rn.fs.createReadStream(a).pipe(Rn.fs.createWriteStream(r))))},Rn.makeDirectory=function(a){void 0!==Rn.fs&&(a.replace(new RegExp("/","g"),"\\"),Rn.fs.mkdirSync(a,{recursive:!0}))},Rn.getFilesDirectory=function(a){if(void 0!==Rn.fs)try{return a.replace(new RegExp("/","g"),"\\"),Rn.fs.readdirSync(a)}catch{return[]}return[]},Rn.deleteFolder=function(a){void 0!==Rn.fs&&Rn.fs.existsSync(a)&&(Rn.fs.readdirSync(a).forEach(function(r){var h=a+"/"+r;Rn.fs.lstatSync(h).isDirectory()?Rn.deleteFolder(h):Rn.fs.unlinkSync(h)}),Rn.fs.rmdirSync(a))},Rn.copyFolder=function(a,r){if(void 0!==Rn.fs){a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Rn.makeDirectory(r);for(var h=Rn.fs.readdirSync(a),p=0;p<h.length;p++){var y=a+"\\"+h[p],b=r+"\\"+h[p],R=Rn.fs.statSync(y);R.isDirectory()?Rn.copyFolder(y,b):R.isSymbolicLink()?Rn.fs.symlinkSync(Rn.fs.readlinkSync(y),b):Rn.copyFile(y,b)}}},Rn.fileExists=function(a){return void 0!==Rn.fs&&(a.replace(new RegExp("/","g"),"\\"),Rn.fs.existsSync(a))},Rn.getFileName=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.lastIndexOf("."))}return""},Rn.getFileNameWithExtension=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.length)}return""},Rn.getNameWithoutExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(0,a.lastIndexOf("."))):""},Rn.getFilePath=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(0,r>h?r+1:h+1)}return""},Rn.getFileExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(a.lastIndexOf(".")+1,a.length).toLowerCase()):""},wi.prototype.export=function(a){"base64"===this.format?Rn.writeFileBase64(a,this.data):"arraybuffer"===this.format?Rn.writeFileArrayBuffer(a,void 0!==this.arraybuffer?this.arraybuffer:this.data):"string"===this.format?Rn.writeFile(a,this.data):"json"===this.format?Rn.writeFile(a,JSON.stringify(this.data)):"url"===this.format&&Rn.writeFileArrayBuffer(a,Rn.readFileArrayBuffer(this.data))},wi.prototype.dispose=function(){},wi.prototype.toJSON=function(a){var r={};return r.name=this.name,r.uuid=this.uuid,r.type=this.type,r},ms.prototype=Object.create(wi.prototype),ms.fileIsImage=function(a){return void 0!==a&&(!!a.type.startsWith("image")||(a=a.name.toLocaleLowerCase()).endsWith("tga")||a.endsWith("dds")||a.endsWith("pvr")||a.endsWith("ktx")||a.endsWith("basis"))},ms.prototype.getImageSize=function(a){if(this.width>-1&&this.height>-1)a(this.width,this.height);else{var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight,a(r.width,r.height)}}},ms.prototype.getImageData=function(a){var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight;var p=document.createElement("canvas");p.width=h.naturalWidth,p.height=h.naturalWidth;var y=p.getContext("2d");y.drawImage(h,0,0,h.width,h.height),a(y.getImageData(0,0,h.width,h.height),r.width,r.height)}},ms.prototype.createSolidColor=function(a){var r=document.createElement("canvas");r.width=1,r.height=1;var h=r.getContext("2d");h.fillStyle=void 0!==a?a:Qc.randomColor(),h.fillRect(0,0,1,1),this.data=r.toDataURL("image/png"),this.format="base64",this.encoding="png"},ms.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),p=new Blob([h],{type:"image/"+r});this.data=URL.createObjectURL(p),this.arraybuffer=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"},ms.prototype.hasTransparency=function(a){if(!0===a&&this.width>-1&&this.height>-1){var r=document.createElement("img"),h=document.createElement("canvas");h.width=r.width,h.height=r.height;var p=h.getContext("2d");p.drawImage(r,0,0,r.width,r.height);for(var y=p.getImageData(0,0,r.width,r.height).data,b=3;b<y.length;b+=4)if(255!==y[b])return!0;return!1}return"png"===this.encoding||"gif"===this.encoding},ms.prototype.compressJPEG=function(a){var r=document.createElement("img");r.src=this.data;var h=document.createElement("canvas");h.width=r.width,h.height=r.height,h.getContext("2d").drawImage(r,0,0,r.width,r.height);var p=this;h.toBlob(function(y){var b=new FileReader;b.onload=function(){p.encoding="jpeg",p.format="arraybuffer",p.data=b.result},b.readAsArrayBuffer(y)},"image/jpeg",void 0!==a?a:.7)},ms.prototype.dispose=function(){"arraybuffer"===this.format&&URL.revokeObjectURL(this.data)},ms.prototype.toJSON=function(a){if(void 0!==a.images[this.uuid])return a.images[this.uuid];var r=wi.prototype.toJSON.call(this,a);return"url"===this.format&&this.loadArrayBufferData(Rn.readFileArrayBuffer(this.data),this.encoding),r.width=this.width,r.height=this.height,r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=va.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.images[this.uuid]=r,r},gs.prototype=Object.create(l.Texture.prototype),gs.isTexture=!0,gs.prototype.updateSource=function(){if(null!==this.source){var a=this;this.image.crossOrigin="anonymous",this.image.src=this.source.data,this.image.onload=function(){a.needsUpdate=!0},this.image.onerror=function(){console.log("nunuStudio: Failed to load image "+a.source.uuid+" data."),a.source.createSolidColor(),a.image.src=a.source.data,a.needsUpdate=!0}}else console.warn("nunuStudio: Texture source is null."),this.source.createSolidColor(),this.image.src=a.source.data,this.needsUpdate=!0},gs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0},gs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r},Ls.prototype=Object.create(l.AmbientLight.prototype),ii.prototype=Object.create(l.Object3D.prototype),ii.SOURCE={EMPTY:"empty",BUFFER:"buffer",NODE:"audioNode"},ii.prototype.onEnded=function(){this.isPlaying=!1},ii.prototype.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},ii.prototype.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},ii.prototype.initialize=function(){if(null!==this.audio){var a=this;this.audio.getAudioBuffer(this.context,function(r){a.setBuffer(r)})}else console.warn("nunuStudio: AudioEmitter audio is null.");this.setVolume(this.volume),this.setPlaybackRate(this.playbackRate),l.Object3D.prototype.initialize.call(this)},ii.prototype.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",!0===this.autoplay&&this.play(),this},ii.prototype.play=function(){if(null!==this.buffer){this.isPlaying&&console.warn("nunuStudio: Audio is already playing, its only possible to control the last playing instance.");var a=this.context.createBufferSource();return a.buffer=this.buffer,a.detune.value=this.detune,a.loop=this.loop,a.onended=this.onEnded.bind(this),a.playbackRate.setValueAtTime(this.playbackRate,this.startTime),a.start(0,this.startTime),this.isPlaying=!0,this.source=a,this.connect()}console.warn("nunuStudio: Audio buffer not ready, audio will not play.")},ii.prototype.pause=function(){return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this},ii.prototype.stop=function(){return this.source.stop(),this.startTime=0,this.isPlaying=!1,this},ii.prototype.setAudio=function(a){this.audio=a,null!==this.buffer&&(this.isPlaying&&this.stop(),this.disconnect());var r=this;this.audio.getAudioBuffer(this.context,function(h){r.setBuffer(h)})},ii.prototype.getVolume=function(){return this.gain.gain.value},ii.prototype.setVolume=function(a){return this.volume=a,this.gain.gain.value=a,this},ii.prototype.setLoop=function(a){return this.loop=a,this.isPlaying&&(this.source.loop=this.loop),this},ii.prototype.setDetune=function(a){return this.detune=a,!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},ii.prototype.getLoop=function(){return this.loop},ii.prototype.setPlaybackRate=function(a){return this.playbackRate=a,this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},ii.prototype.getPlaybackRate=function(){return this.playbackRate},ii.prototype.getFilters=function(){return this.filters},ii.prototype.setFilters=function(a){return a||(a=[]),this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},ii.prototype.getFilter=function(a){return this.getFilters()[void 0!==a?a:0]},ii.prototype.setFilter=function(a){return this.setFilters(a?[a]:[])},ii.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},ii.prototype.getOutput=function(){return this.gain},ii.prototype.dispose=function(){this.isPlaying&&(this.stop(),this.disconnect()),l.Object3D.prototype.dispose.call(this)},ii.prototype.toJSON=function(a){var r=this.audio,h=l.Object3D.prototype.toJSON.call(this,a,function(p,y){r=r.toJSON(p)});return h.object.audio=r.uuid,h.object.volume=this.volume,h.object.autoplay=this.autoplay,h.object.startTime=this.startTime,h.object.playbackRate=this.playbackRate,h.object.loop=this.loop,h},(Tr.prototype=Object.create(l.Texture.prototype)).constructor=Tr,Tr.prototype.isCubeTexture=!0,Tr.RIGHT=0,Tr.LEFT=1,Tr.TOP=2,Tr.BOTTOM=3,Tr.FRONT=4,Tr.BACK=5,Tr.CUBE=20,Tr.CROSS=21,Tr.EQUIRECTANGULAR=22,Tr.prototype.setSize=function(a){a&a-1?console.warn("nunuStudio: CubeTexture new size is not a power of two."):this.size=a},Tr.prototype.setImages=function(a,r){this.mode=void 0!==r?r:Tr.CUBE,this.images=a},Tr.prototype.updateImages=function(){var a=this;if(this.mode===Tr.CUBE)for(var r=0;r<this.images.length;r++)"string"==typeof this.images[r]&&(this.images[r]=new ms(this.images[r])),(h=document.createElement("img")).crossOrigin="anonymous",h.index=r,h.src=this.images[r].data,h.onload=function(){a.image[this.index].width=a.size,a.image[this.index].height=a.size,a.image[this.index].getContext("2d").drawImage(this,0,0,a.size,a.size),a.needsUpdate=!0};else if(this.mode===Tr.CROSS){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var p=this.naturalWidth/4,y=this.naturalHeight/3;a.image[Tr.LEFT].getContext("2d").drawImage(this,0,y,p,y,0,0,a.size,a.size),a.image[Tr.FRONT].getContext("2d").drawImage(this,p,y,p,y,0,0,a.size,a.size),a.image[Tr.RIGHT].getContext("2d").drawImage(this,2*p,y,p,y,0,0,a.size,a.size),a.image[Tr.BACK].getContext("2d").drawImage(this,3*p,y,p,y,0,0,a.size,a.size),a.image[Tr.TOP].getContext("2d").drawImage(this,p,0,p,y,0,0,a.size,a.size),a.image[Tr.BOTTOM].getContext("2d").drawImage(this,p,2*y,p,y,0,0,a.size,a.size),a.needsUpdate=!0}}else if(this.mode===Tr.EQUIRECTANGULAR){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;var h;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var p=document.createElement("canvas");p.width=h.naturalWidth,p.height=h.naturalHeight;var y=p.getContext("2d");y.drawImage(h,0,0);for(var b=y.getImageData(0,0,p.width,p.height),R=0;R<6;R++){var O=Tr.renderEquirectFace(b,R,Math.PI,a.size);a.image[R].getContext("2d").putImageData(O,0,0)}a.needsUpdate=!0}}},Tr.resampleBilinear=function(a,r,h,p,y){for(var b=a.width,R=a.height,O=a.data,T=l.Math.clamp(Math.floor(h),0,b-1),U=l.Math.clamp(Math.ceil(h),0,b-1),ee=h-T,ie=l.Math.clamp(Math.floor(p),0,R-1),ne=l.Math.clamp(Math.ceil(p),0,R-1),ve=p-ie,be=4*(ie*b+T),Te=4*(ie*b+U),Le=4*(ne*b+T),Ie=4*(ne*b+U),Oe=0;Oe<3;Oe++)r.data[y+Oe]=Math.ceil((O[be+Oe]*(1-ee)+O[Te+Oe]*ee)*(1-ve)+(O[Le+Oe]*(1-ee)+O[Ie+Oe]*ee)*ve)},Tr.renderEquirectFace=function(a,r,h,p){for(var y=new ImageData(p,p),b=Tr.faces[r],R=0;R<p;R++)for(var O=0;O<p;O++){var T=4*(O*p+R);y.data[T+3]=255;var U=b(2*(R+.5)/p-1,2*(O+.5)/p-1),ee=Math.sqrt(U.x*U.x+U.y*U.y+U.z*U.z),ie=l.Math.euclideanModulo(Math.atan2(U.y,U.x)+h,2*Math.PI),ne=Math.acos(U.z/ee),ve=a.width*ie/Math.PI/2-.5,be=a.height*ne/Math.PI-.5;Tr.resampleBilinear(a,y,ve,be,T)}return y},Tr.faces=[function(a,r){return new l.Vector3(a,-1,-r)},function(a,r){return new l.Vector3(-a,1,-r)},function(a,r){return new l.Vector3(-r,-a,1)},function(a,r){return new l.Vector3(r,-a,-1)},function(a,r){return new l.Vector3(-1,-a,-r)},function(a,r){return new l.Vector3(1,a,-r)}],Tr.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.size=this.size,r.mode=this.mode,r.images=[],this.mode===Tr.EQUIRECTANGULAR||this.mode===Tr.CROSS){var h=this.images[0].toJSON(a);r.images.push(h.uuid)}else for(var p=0;p<this.images.length;p++)h=this.images[p].toJSON(a),r.images.push(h.uuid);return r},(br.prototype=Object.create(l.Object3D.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.renderer=a.renderer);l.Object3D.prototype.initialize.call(this)},br.prototype.update=function(a){this.autoUpdate&&this.updateCubeMap(this.renderer,this.scene),l.Object3D.prototype.update.call(this,a)},br.prototype.setResolution=function(a){this.resolution=a,this.renderTarget.setSize(a,a)},br.prototype.clear=function(a,r,h,p){for(var y=a.getRenderTarget(),b=0;b<6;b++)a.setRenderTarget(this.renderTarget,b),a.clear(r,h,p);a.setRenderTarget(y)},br.prototype.updateCubeMap=function(a,r){var h=a.autoClear;a.autoClear=!1;var p=a.getRenderTarget(),y=this.renderTarget.texture.generateMipmaps;this.renderTarget.texture.generateMipmaps=!1;for(var b=0;b<6;b++)5===b&&(this.renderTarget.texture.generateMipmaps=y),this.cameras[b].updateMatrixWorld(),a.setRenderTarget(this.renderTarget,b),a.clear(!0,!0,!0),a.render(r,this.cameras[b]);a.autoClear=h,a.setRenderTarget(p)},br.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.near=this.near,r.object.far=this.far,r.object.resolution=this.resolution,r.object.autoUpdate=this.autoUpdate,r},(ml.prototype=Object.create(l.DirectionalLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var Lc,ah,Qa,ns={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function Ci(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Ci.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Ci.FullScreenQuad=(Lc=new l.OrthographicCamera(-1,1,1,-1,0,1),ah=new l.PlaneBufferGeometry(2,2),Qa=function(a){this._mesh=new l.Mesh(ah,a)},Object.defineProperty(Qa.prototype,"material",{get:function(){return this._mesh.material},set:function(a){this._mesh.material=a}}),Object.assign(Qa.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(a){a.render(this._mesh,Lc)}}),Qa);var Qh=function(a,r){Ci.call(this),this.scene=a,this.camera=r,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Qh.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Qh,render:function(a,r,h){var p,y,b=a.getContext(),R=a.state;R.buffers.color.setMask(!1),R.buffers.depth.setMask(!1),R.buffers.color.setLocked(!0),R.buffers.depth.setLocked(!0),this.inverse?(p=0,y=1):(p=1,y=0),R.buffers.stencil.setTest(!0),R.buffers.stencil.setOp(b.REPLACE,b.REPLACE,b.REPLACE),R.buffers.stencil.setFunc(b.ALWAYS,p,4294967295),R.buffers.stencil.setClear(y),R.buffers.stencil.setLocked(!0),a.setRenderTarget(h),this.clear&&a.clear(),a.render(this.scene,this.camera),a.setRenderTarget(r),this.clear&&a.clear(),a.render(this.scene,this.camera),R.buffers.color.setLocked(!1),R.buffers.depth.setLocked(!1),R.buffers.stencil.setLocked(!1),R.buffers.stencil.setFunc(b.EQUAL,1,4294967295),R.buffers.stencil.setOp(b.KEEP,b.KEEP,b.KEEP),R.buffers.stencil.setLocked(!0)}});var Ah=function(){Ci.call(this),this.needsSwap=!1};function Kh(){this.autoClear=!1,this.autoClearColor=!1,this.autoClearStencil=!1,this.autoClearDepth=!1,this.sortObjects=!0,this.clearColor=new l.Color,this.clearAlpha=1}function mr(){this.uuid=l.Math.generateUUID(),this.type="Pass",this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1,this.copyToScreen=!1}function Jo(a,r){mr.call(this),this.type="Shader",this.textureID=void 0!==r?r:"tDiffuse",a instanceof l.ShaderMaterial?(this.uniforms=a.uniforms,this.material=a):a&&(this.uniforms=l.UniformsUtils.clone(a.uniforms),this.material=new l.ShaderMaterial({defines:Object.assign({},a.defines),uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader})),this.createQuadScene()}function _l(){mr.call(this),this.type="Render",this.clear=!0}Ah.prototype=Object.create(Ci.prototype),Object.assign(Ah.prototype,{render:function(a){a.state.buffers.stencil.setLocked(!1),a.state.buffers.stencil.setTest(!1)}}),Kh.prototype.backup=function(a){this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearStencil=a.autoClearStencil,this.autoClearDepth=a.autoClearDepth,this.sortObjects=a.sortObjects,this.clearColor.copy(a.getClearColor()),this.clearAlpha=a.getClearAlpha()},Kh.prototype.restore=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearStencil=this.autoClearStencil,a.autoClearDepth=this.autoClearDepth,a.sortObjects=this.sortObjects,a.setClearColor(this.clearColor),a.setClearAlpha(this.clearAlpha)},mr.RGBALinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat},mr.RGBLinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBFormat},mr.RGBANearest={minFilter:l.NearestFilter,magFilter:l.NearestFilter,format:l.RGBAFormat},mr.prototype.createQuadScene=function(){this.camera=new l.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new l.Scene,this.quad=new l.Mesh(new l.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},mr.prototype.setSize=function(a,r){},mr.prototype.render=function(a,r,h,p,y,b,R){},mr.prototype.dispose=function(){},mr.prototype.toJSON=function(a){var r={};return r.uuid=this.uuid,r.type=this.type,r.clear=this.clear,r.enabled=this.enabled,r.needsSwap=this.needsSwap,r.renderToScreen=this.renderToScreen,r.copyToScreen=this.copyToScreen,r},(Jo.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=h.texture),this.quad.material=this.material,a.setRenderTarget(this.renderToScreen?null:r),this.clear&&a.clear(),a.render(this.scene,this.camera)},(_l.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(b,R)};var Fr={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new l.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")};function Bs(a,r,h){mr.call(this),this.type="UnrealBloom",this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;for(var p=0;p<this.nMips;p++){var y;(y=new l.WebGLRenderTarget(0,0,mr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(y),(y=new l.WebGLRenderTarget(0,0,mr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsVertical.push(y)}this.renderTargetBright=new l.WebGLRenderTarget(0,0,mr.RGBALinear),this.renderTargetBright.texture.generateMipmaps=!1;var b=Fr;this.highPassUniforms=l.UniformsUtils.clone(b.uniforms),this.materialHighPassFilter=new l.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var R=[3,5,7,9,11];for(p=0;p<this.nMips;p++)this.separableBlurMaterials.push(Bs.getSeperableBlurMaterial(R[p])),this.separableBlurMaterials[p].uniforms.texSize.value=new l.Vector2(0,0);this.compositeMaterial=Bs.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.highPassUniforms.luminosityThreshold.value=void 0!==h?h:.7,this.highPassUniforms.smoothWidth.value=.01,this.compositeMaterial.uniforms.bloomStrength.value=void 0!==a?a:.8,this.compositeMaterial.uniforms.bloomRadius.value=void 0!==r?r:.3,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.compositeMaterial.uniforms.bloomTintColors.value=[new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1)],this.compositeMaterial.needsUpdate=!0,this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.createQuadScene(),this.basic=new l.MeshBasicMaterial,Object.defineProperties(this,{strength:{get:function(){return this.compositeMaterial.uniforms.bloomStrength.value},set:function(O){this.compositeMaterial.uniforms.bloomStrength.value=O}},radius:{get:function(){return this.compositeMaterial.uniforms.bloomRadius.value},set:function(O){this.compositeMaterial.uniforms.bloomRadius.value=O}},threshold:{get:function(){return this.highPassUniforms.luminosityThreshold.value},set:function(O){}},smooth:{get:function(){return this.highPassUniforms.smoothWidth.value},set:function(O){}},bloomFactors:{get:function(){return this.compositeMaterial.uniforms.bloomFactors.value},set:function(O){}},bloomTintColors:{get:function(){return this.compositeMaterial.uniforms.bloomTintColors.value},set:function(O){this.compositeMaterial.uniforms.bloomTintColors.value=O}}})}Bs.prototype=Object.create(mr.prototype),Bs.BlurDirectionX=new l.Vector2(1,0),Bs.BlurDirectionY=new l.Vector2(0,1),Bs.prototype.dispose=function(){for(var a=0;a<this.renderTargetsHorizontal.length;a++)this.renderTargetsHorizontal[a].dispose();for(a=0;a<this.renderTargetsVertical.length;a++)this.renderTargetsVertical[a].dispose();this.renderTargetBright.dispose()},Bs.prototype.setSize=function(a,r){var h=Math.round(a/2),p=Math.round(r/2);this.renderTargetBright.setSize(h,p);for(var y=0;y<this.nMips;y++)this.renderTargetsHorizontal[y].setSize(h,p),this.renderTargetsVertical[y].setSize(h,p),this.separableBlurMaterials[y].uniforms.texSize.value.set(h,p),h=Math.round(h/2),p=Math.round(p/2)},Bs.prototype.render=function(a,r,h,p,y,b,R){a.autoClear=!1,a.setClearColor(new l.Color(0,0,0),0),y&&a.context.disable(a.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=h.texture,a.setRenderTarget(null),a.clear(),a.render(this.scene,this.camera)),this.highPassUniforms.tDiffuse.value=h.texture,this.quad.material=this.materialHighPassFilter,a.setRenderTarget(this.renderTargetBright),a.clear(),a.render(this.scene,this.camera);for(var O=this.renderTargetBright,T=0;T<this.nMips;T++)this.quad.material=this.separableBlurMaterials[T],this.separableBlurMaterials[T].uniforms.colorTexture.value=O.texture,this.separableBlurMaterials[T].uniforms.direction.value=Bs.BlurDirectionX,a.setRenderTarget(this.renderTargetsHorizontal[T]),a.clear(),a.render(this.scene,this.camera),this.separableBlurMaterials[T].uniforms.colorTexture.value=this.renderTargetsHorizontal[T].texture,this.separableBlurMaterials[T].uniforms.direction.value=Bs.BlurDirectionY,a.setRenderTarget(this.renderTargetsVertical[T]),a.clear(),a.render(this.scene,this.camera),O=this.renderTargetsVertical[T];this.quad.material=this.compositeMaterial,a.setRenderTarget(this.renderTargetsHorizontal[0]),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(this.renderToScreen?null:h),a.render(this.scene,this.camera)},Bs.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);r.strength=this.strength,r.radius=this.radius,r.threshold=this.threshold,r.bloomFactors=this.bloomFactors,r.bloomTintColors=[];for(var h=0;h<this.bloomTintColors.length;h++)r.bloomTintColors.push(this.bloomTintColors[h].toArray());return r},Bs.getSeperableBlurMaterial=function(a){return new l.ShaderMaterial({defines:{KERNEL_RADIUS:a,SIGMA:a},uniforms:{colorTexture:{value:null},texSize:{value:new l.Vector2(.5,.5)},direction:{value:new l.Vector2(.5,.5)}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\t#include <common>\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D colorTexture;\n\t\t\tuniform vec2 texSize;\n\t\t\tuniform vec2 direction;\n\t\t\t\n\t\t\tfloat gaussianPdf(in float x, in float sigma)\n\t\t\t{\n\t\t\t\treturn 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\tvec3 diffuseSum = texture2D(colorTexture, vUv).rgb * weightSum;\n\t\t\t\tfor(int i = 1; i < KERNEL_RADIUS; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\tvec3 sample1 = texture2D(colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\tvec3 sample2 = texture2D(colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t}\n\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t}"})},Bs.getCompositeMaterial=function(a){return new l.ShaderMaterial({defines:{NUM_MIPS:a},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D blurTexture1;\n\t\t\tuniform sampler2D blurTexture2;\n\t\t\tuniform sampler2D blurTexture3;\n\t\t\tuniform sampler2D blurTexture4;\n\t\t\tuniform sampler2D blurTexture5;\n\t\t\tuniform sampler2D dirtTexture;\n\t\t\tuniform float bloomStrength;\n\t\t\tuniform float bloomRadius;\n\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\t\t\t\n\t\t\tfloat lerpBloomFactor(const in float factor)\n\t\t\t{\n\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = bloomStrength * (lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv));\n\t\t\t}"})};var lh={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")};function Kc(){Jo.call(this,lh),this.type="Technicolor"}Kc.prototype=Object.create(Jo.prototype);var Ns={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new l.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:"varying vec2 vUv;\n\nvoid main()\n{\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"uniform float cameraNear;\nuniform float cameraFar;\n\n#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n#endif\n\nuniform float radius; // ao radius \nuniform bool onlyAO; // use only ambient occlusion pass?\n\nuniform vec2 size; // texture width, height\nuniform float aoClamp; // depth clamp - reduces haloing at screen edges\n\nuniform float lumInfluence; // how much luminance affects occlusion\n\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\n\nvarying vec2 vUv;\n\n#define DL 2.399963229728653 // PI *(3.0 - sqrt(5.0))\n#define EULER 2.718281828459045\n\n// user variables\nconst int samples = 64; // ao sample count\nconst bool useNoise = true; // use noise instead of pattern for sample dithering\nconst float noiseAmount = 0.0004; // dithering amount\nconst float diffArea = 0.4; // self-shadowing reduction\nconst float gDisplace = 0.4; // gauss bell center\n\n// RGBA depth\n#include <packing>\n\n// generating noise / pattern texture for dithering\nvec2 rand(const vec2 coord)\n{\n\tvec2 noise;\n\n\tif(useNoise)\n\t{\n\t\tfloat nx = dot(coord, vec2(12.9898, 78.233));\n\t\tfloat ny = dot(coord, vec2(12.9898, 78.233) * 2.0);\n\t\tnoise = clamp(fract(43758.5453 * sin(vec2(nx, ny))), 0.0, 1.0);\n\t}\n\telse\n\t{\n\t\tfloat ff = fract(1.0 - coord.s *(size.x / 2.0));\n\t\tfloat gg = fract(coord.t *(size.y / 2.0));\n\t\tnoise = vec2(0.25, 0.75) * vec2(ff) + vec2(0.75, 0.25) * gg;\n\t}\n\n\treturn(noise * 2.0  - 1.0) * noiseAmount;\n}\n\nfloat readDepth(const in vec2 coord) {\n\n\tfloat cameraFarPlusNear = cameraFar + cameraNear;\n\tfloat cameraFarMinusNear = cameraFar - cameraNear;\n\tfloat cameraCoef = 2.0 * cameraNear;\n\n\t#ifdef USE_LOGDEPTHBUF\n\t\tfloat logz = unpackRGBAToDepth(texture2D(tDepth, coord));\n\t\tfloat w = pow(2.0, (logz / logDepthBufFC)) - 1.0;\n\t\tfloat z = (logz / w) + 1.0;\n\t#else\n\t\tfloat z = unpackRGBAToDepth(texture2D(tDepth, coord));\n\t#endif\n\n\treturn cameraCoef /(cameraFarPlusNear - z * cameraFarMinusNear);\n}\n\nfloat compareDepths(const in float depth1, const in float depth2, inout int far)\n{\n\tfloat garea = 8.0; // gauss bell width\n\tfloat diff =(depth1 - depth2) * 100.0; // depth difference (0-100)\n\n\t// reduce left bell width to avoid self-shadowing\n\tif(diff < gDisplace)\n\t{\n\t\tgarea = diffArea;\n\n\t}\n\telse\n\t{\n\t\tfar = 1;\n\t}\n\n\tfloat dd = diff - gDisplace;\n\tfloat gauss = pow(EULER, -2.0 *(dd * dd) /(garea * garea));\n\treturn gauss;\n}\n\nfloat calcAO(float depth, float dw, float dh)\n{\n\tvec2 vv = vec2(dw, dh);\n\tvec2 coord1 = vUv + radius * vv;\n\tvec2 coord2 = vUv - radius * vv;\n\n\tfloat temp1 = 0.0;\n\tfloat temp2 = 0.0;\n\n\tint far = 0;\n\ttemp1 = compareDepths(depth, readDepth(coord1), far);\n\n\t// DEPTH EXTRAPOLATION\n\tif(far > 0)\n\t{\n\t\ttemp2 = compareDepths(readDepth(coord2), depth, far);\n\t\ttemp1 +=(1.0 - temp1) * temp2;\n\t}\n\n\treturn temp1;\n}\n\nvoid main()\n{\n\tvec2 noise = rand(vUv);\n\tfloat depth = readDepth(vUv);\n\n\tfloat tt = clamp(depth, aoClamp, 1.0);\n\n\tfloat w =(1.0 / size.x) / tt +(noise.x *(1.0 - noise.x));\n\tfloat h =(1.0 / size.y) / tt +(noise.y *(1.0 - noise.y));\n\n\tfloat ao = 0.0;\n\n\tfloat dz = 1.0 / float(samples);\n\tfloat l = 0.0;\n\tfloat z = 1.0 - dz / 2.0;\n\n\tfor(int i = 0; i <= samples; i ++)\n\t{\n\t\tfloat r = sqrt(1.0 - z);\n\n\t\tfloat pw = cos(l) * r;\n\t\tfloat ph = sin(l) * r;\n\t\tao += calcAO(depth, pw * w, ph * h);\n\t\tz = z - dz;\n\t\tl = l + DL;\n\t}\n\n\tao /= float(samples);\n\tao = 1.0 - ao;\n\n\tvec3 color = texture2D(tDiffuse, vUv).rgb;\n\n\tvec3 lumcoeff = vec3(0.299, 0.587, 0.114);\n\tfloat lum = dot(color.rgb, lumcoeff);\n\tvec3 luminance = vec3(lum);\n\n\tvec3 final = vec3(color * mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // mix(color * ao, white, luminance)\n\n\tif(onlyAO)\n\t{\n\t\tfinal = vec3(mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // ambient occlusion only\n\t}\n\n\tgl_FragColor = vec4(final, 1.0);\n}"};function Ro(){Jo.call(this,Ns),this.type="SSAO",this.depthMaterial=new l.MeshDepthMaterial,this.depthMaterial.depthPacking=l.RGBADepthPacking,this.depthMaterial.blending=l.NoBlending,this.depthRenderTarget=new l.WebGLRenderTarget(2,2,{minFilter:l.LinearFilter,magFilter:l.LinearFilter}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(2,2),Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(a){this.uniforms.onlyAO.value=a}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(a){this.uniforms.aoClamp.value=a}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(a){this.uniforms.lumInfluence.value=a}}}),this.radius=4,this.onlyAO=!1,this.aoClamp=.25,this.lumInfluence=.7}(Ro.prototype=Object.create(Jo.prototype)).render=function(a,r,h,p,y,b,R){this.uniforms.cameraNear.value=R.near,this.uniforms.cameraFar.value=R.far,b.overrideMaterial=this.depthMaterial,a.setRenderTarget(this.depthRenderTarget),a.clear(!0,!0,!0),a.render(b,R),b.overrideMaterial=null,Jo.prototype.render.call(this,a,r,h,p,y)},Ro.prototype.setSize=function(a,r){this.uniforms.size.value.set(a,r),this.depthRenderTarget.setSize(a,r)},Ro.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.onlyAO=this.onlyAO,r.radius=this.radius,r.aoClamp=this.aoClamp,r.lumInfluence=this.lumInfluence,r};var ep={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new l.Vector2},cameraProjectionMatrix:{value:new l.Matrix4},cameraInverseProjectionMatrix:{value:new l.Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},tc=(["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n"),{uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")});function uo(a){void 0===a&&(a=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var r=0;r<256;r++)this.p[r]=Math.floor(256*a.random());for(this.perm=[],r=0;r<512;r++)this.perm[r]=this.p[255&r];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}function Ai(){mr.call(this),this.type="SSAONOH",this.kernel=[],this.noiseTexture=null,this.createQuadScene(),this.depthTexture=new l.DepthTexture,this.depthTexture.type=l.UnsignedShortType,this.depthTexture.minFilter=l.NearestFilter,this.depthTexture.maxFilter=l.NearestFilter,this.normalMaterial=new l.MeshNormalMaterial,this.normalMaterial.blending=l.NoBlending,this.normalRenderTarget=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,depthTexture:this.depthTexture,depthBuffer:!0}),this.ssaoRenderTarget=new l.WebGLRenderTarget(1,1,mr.RGBALinear),this.blurRenderTarget=new l.WebGLRenderTarget(1,1,mr.RGBALinear),this.blurMaterial=new l.ShaderMaterial({defines:Object.assign({},tc.defines),uniforms:l.UniformsUtils.clone(tc.uniforms),vertexShader:tc.vertexShader,fragmentShader:tc.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.ssaoMaterial=new l.ShaderMaterial({defines:Object.assign({},ep.defines),uniforms:l.UniformsUtils.clone(ep.uniforms),vertexShader:ep.vertexShader,fragmentShader:ep.fragmentShader,blending:l.NoBlending}),this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.copyMaterial=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(ns.uniforms),vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:l.DstColorFactor,blendDst:l.ZeroFactor,blendEquation:l.AddEquation,blendSrcAlpha:l.DstAlphaFactor,blendDstAlpha:l.ZeroFactor,blendEquationAlpha:l.AddEquation}),this._kernelSize=0;var a=this;Object.defineProperties(this,{kernelRadius:{get:function(){return a.ssaoMaterial.uniforms.kernelRadius.value},set:function(r){a.ssaoMaterial.uniforms.kernelRadius.value=r}},minDistance:{get:function(){return a.ssaoMaterial.uniforms.minDistance.value},set:function(r){a.ssaoMaterial.uniforms.minDistance.value=r}},maxDistance:{get:function(){return a.ssaoMaterial.uniforms.maxDistance.value},set:function(r){a.ssaoMaterial.uniforms.maxDistance.value=r}},kernelSize:{get:function(){return a._kernelSize},set:function(r){a._kernelSize=r,a.generateSampleKernel(),a.generateRandomKernelRotations(),a.ssaoMaterial.uniforms.tNoise.value=a.noiseTexture,a.ssaoMaterial.uniforms.kernel.value=a.kernel}}}),this.kernelSize=64,this.kernelRadius=8,this.minDistance=.1,this.maxDistance=1e3}uo.prototype.dot=function(a,r,h){return a[0]*r+a[1]*h},uo.prototype.dot3=function(a,r,h,p){return a[0]*r+a[1]*h+a[2]*p},uo.prototype.dot4=function(a,r,h,p,y){return a[0]*r+a[1]*h+a[2]*p+a[3]*y},uo.prototype.noise=function(a,r){var h,p,y=(a+r)*(.5*(Math.sqrt(3)-1)),b=Math.floor(a+y),R=Math.floor(r+y),O=(3-Math.sqrt(3))/6,T=(b+R)*O,U=a-(b-T),ee=r-(R-T);U>ee?(h=1,p=0):(h=0,p=1);var ie=U-h+O,ne=ee-p+O,ve=U-1+2*O,be=ee-1+2*O,Te=255&b,Le=255&R,Oe=this.perm[Te+h+this.perm[Le+p]]%12,Fe=this.perm[Te+1+this.perm[Le+1]]%12,je=.5-U*U-ee*ee,Ue=.5-ie*ie-ne*ne,Je=.5-ve*ve-be*be;return 70*((je<0?0:(je*=je)*je*this.dot(this.grad3[this.perm[Te+this.perm[Le]]%12],U,ee))+(Ue<0?0:(Ue*=Ue)*Ue*this.dot(this.grad3[Oe],ie,ne))+(Je<0?0:(Je*=Je)*Je*this.dot(this.grad3[Fe],ve,be)))},uo.prototype.noise3d=function(a,r,h){var p,y,b,R,O,T,U=.3333333333333333*(a+r+h),ee=Math.floor(a+U),ie=Math.floor(r+U),ne=Math.floor(h+U),ve=1/6,be=(ee+ie+ne)*ve,Te=a-(ee-be),Le=r-(ie-be),Ie=h-(ne-be);Te>=Le?Le>=Ie?(p=1,y=0,b=0,R=1,O=1,T=0):Te>=Ie?(p=1,y=0,b=0,R=1,O=0,T=1):(p=0,y=0,b=1,R=1,O=0,T=1):Le<Ie?(p=0,y=0,b=1,R=0,O=1,T=1):Te<Ie?(p=0,y=1,b=0,R=0,O=1,T=1):(p=0,y=1,b=0,R=1,O=1,T=0);var Oe=Te-p+ve,Fe=Le-y+ve,je=Ie-b+ve,Ue=Te-R+2*ve,Je=Le-O+2*ve,pt=Ie-T+2*ve,at=Te-1+.5,Mt=Le-1+.5,Tt=Ie-1+.5,Yt=255&ee,jt=255&ie,It=255&ne,ft=this.perm[Yt+p+this.perm[jt+y+this.perm[It+b]]]%12,$t=this.perm[Yt+R+this.perm[jt+O+this.perm[It+T]]]%12,Zt=this.perm[Yt+1+this.perm[jt+1+this.perm[It+1]]]%12,Tn=.6-Te*Te-Le*Le-Ie*Ie,$n=.6-Oe*Oe-Fe*Fe-je*je,Qn=.6-Ue*Ue-Je*Je-pt*pt,lr=.6-at*at-Mt*Mt-Tt*Tt;return 32*((Tn<0?0:(Tn*=Tn)*Tn*this.dot3(this.grad3[this.perm[Yt+this.perm[jt+this.perm[It]]]%12],Te,Le,Ie))+($n<0?0:($n*=$n)*$n*this.dot3(this.grad3[ft],Oe,Fe,je))+(Qn<0?0:(Qn*=Qn)*Qn*this.dot3(this.grad3[$t],Ue,Je,pt))+(lr<0?0:(lr*=lr)*lr*this.dot3(this.grad3[Zt],at,Mt,Tt)))},uo.prototype.noise4d=function(a,r,h,p){var y,b,R,O,T,U,ee,ie,ne,ve,be,Te,Le=this.grad4,Ie=this.simplex,Oe=this.perm,Fe=(Math.sqrt(5)-1)/4,je=(5-Math.sqrt(5))/20,Ue=(a+r+h+p)*Fe,Je=Math.floor(a+Ue),pt=Math.floor(r+Ue),at=Math.floor(h+Ue),Mt=Math.floor(p+Ue),Tt=(Je+pt+at+Mt)*je,Yt=a-(Je-Tt),jt=r-(pt-Tt),It=h-(at-Tt),Nt=p-(Mt-Tt),ft=(Yt>jt?32:0)+(Yt>It?16:0)+(jt>It?8:0)+(Yt>Nt?4:0)+(jt>Nt?2:0)+(It>Nt?1:0),$t=Yt-(y=Ie[ft][0]>=3?1:0)+je,Zt=jt-(b=Ie[ft][1]>=3?1:0)+je,Tn=It-(R=Ie[ft][2]>=3?1:0)+je,$n=Nt-(O=Ie[ft][3]>=3?1:0)+je,Qn=Yt-(T=Ie[ft][0]>=2?1:0)+2*je,lr=jt-(U=Ie[ft][1]>=2?1:0)+2*je,jn=It-(ee=Ie[ft][2]>=2?1:0)+2*je,pr=Nt-(ie=Ie[ft][3]>=2?1:0)+2*je,Yn=Yt-(ne=Ie[ft][0]>=1?1:0)+3*je,wr=jt-(ve=Ie[ft][1]>=1?1:0)+3*je,Or=It-(be=Ie[ft][2]>=1?1:0)+3*je,Ji=Nt-(Te=Ie[ft][3]>=1?1:0)+3*je,fo=Yt-1+4*je,wo=jt-1+4*je,Uo=It-1+4*je,cs=Nt-1+4*je,Ws=255&Je,Ga=255&pt,ks=255&at,qs=255&Mt,ap=Oe[Ws+y+Oe[Ga+b+Oe[ks+R+Oe[qs+O]]]]%32,lp=Oe[Ws+T+Oe[Ga+U+Oe[ks+ee+Oe[qs+ie]]]]%32,Up=Oe[Ws+ne+Oe[Ga+ve+Oe[ks+be+Oe[qs+Te]]]]%32,Sd=Oe[Ws+1+Oe[Ga+1+Oe[ks+1+Oe[qs+1]]]]%32,Uc=.6-Yt*Yt-jt*jt-It*It-Nt*Nt,up=.6-$t*$t-Zt*Zt-Tn*Tn-$n*$n,fh=.6-Qn*Qn-lr*lr-jn*jn-pr*pr,il=.6-Yn*Yn-wr*wr-Or*Or-Ji*Ji,hp=.6-fo*fo-wo*wo-Uo*Uo-cs*cs;return 27*((Uc<0?0:(Uc*=Uc)*Uc*this.dot4(Le[Oe[Ws+Oe[Ga+Oe[ks+Oe[qs]]]]%32],Yt,jt,It,Nt))+(up<0?0:(up*=up)*up*this.dot4(Le[ap],$t,Zt,Tn,$n))+(fh<0?0:(fh*=fh)*fh*this.dot4(Le[lp],Qn,lr,jn,pr))+(il<0?0:(il*=il)*il*this.dot4(Le[Up],Yn,wr,Or,Ji))+(hp<0?0:(hp*=hp)*hp*this.dot4(Le[Sd],fo,wo,Uo,cs)))},(Ai.prototype=Object.create(mr.prototype)).generateSampleKernel=function(){for(var a=0;a<this._kernelSize;a++){var r=new l.Vector3;r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random(),r.normalize();var h=a/this._kernelSize;h=l.Math.lerp(.1,1,h*h),r.multiplyScalar(h),this.kernel.push(r)}},Ai.prototype.generateRandomKernelRotations=function(){for(var a=new uo,r=new Float32Array(16),h=0;h<16;h++){var p=2*Math.random()-1,y=2*Math.random()-1;r[h]=a.noise3d(p,y,0)}this.noiseTexture=new l.DataTexture(r,4,4,l.LuminanceFormat,l.FloatType),this.noiseTexture.wrapS=l.RepeatWrapping,this.noiseTexture.wrapT=l.RepeatWrapping,this.noiseTexture.needsUpdate=!0},Ai.prototype.render=function(a,r,h,p,y,b,R){a.autoClear=!1,a.setClearColor(7829503),a.setClearAlpha(1),b.overrideMaterial=this.normalMaterial,a.setRenderTarget(this.normalRenderTarget),a.clear(!0,!0,!0),a.render(b,R),b.overrideMaterial=null,this.ssaoMaterial.uniforms.tDepth.value=this.depthTexture,this.ssaoMaterial.uniforms.tDiffuse.value=h.texture,this.ssaoMaterial.uniforms.cameraNear.value=R.near,this.ssaoMaterial.uniforms.cameraFar.value=R.far,this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(R.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(R.projectionMatrix),this.renderPass(a,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(a,this.blurMaterial,this.blurRenderTarget),this.renderToScreen?(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,null,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,null,!1)):(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,r,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,r,!1))},Ai.prototype.renderPass=function(a,r,h,p){this.quad.material=r,a.autoClear=!1,a.setRenderTarget(h),p&&a.clear(!0,!0,!0),a.render(this.scene,this.camera)},Ai.prototype.dispose=function(){this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.quad.geometry.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose()},Ai.prototype.setSize=function(a,r){this.ssaoMaterial.uniforms.resolution.value.set(a,r),this.blurMaterial.uniforms.resolution.value.set(a,r),this.normalRenderTarget.setSize(a,r),this.ssaoRenderTarget.setSize(a,r),this.blurRenderTarget.setSize(a,r)},Ai.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.kernelSize=this.kernelSize,r.kernelRadius=this.kernelRadius,r.minDistance=this.minDistance,r.maxDistance=this.maxDistance,r};var Rs={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")};function Ps(){Jo.call(this,Rs),this.type="Sobel"}(Ps.prototype=Object.create(Jo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(a,r)};var Rl={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")};function Po(a,r){Jo.call(this,Rl),this.type="HueSaturation",Object.defineProperties(this,{hue:{get:function(){return this.uniforms.hue.value},set:function(h){this.uniforms.hue.value=h}},saturation:{get:function(){return this.uniforms.saturation.value},set:function(h){this.uniforms.saturation.value=h}}}),this.hue=void 0!==a?a:0,this.saturation=void 0!==r?r:0}(Po.prototype=Object.create(Jo.prototype)).toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.hue=this.hue,r.saturation=this.saturation,r};var Pl={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};function gl(a,r,h,p){mr.call(this),this.type="Film",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(Pl.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Pl.vertexShader,fragmentShader:Pl.fragmentShader});var y=this;Object.defineProperties(this,{grayscale:{get:function(){return y.uniforms.grayscale.value},set:function(b){y.uniforms.grayscale.value=b}},noiseIntensity:{get:function(){return y.uniforms.nIntensity.value},set:function(b){y.uniforms.nIntensity.value=b}},scanlinesIntensity:{get:function(){return y.uniforms.sIntensity.value},set:function(b){y.uniforms.sIntensity.value=b}},scanlinesCount:{get:function(){return y.uniforms.sCount.value},set:function(b){y.uniforms.sCount.value=b}}}),this.grayscale=void 0!==p&&p,this.noiseIntensity=void 0!==a?a:.35,this.scanlinesIntensity=void 0!==r?r:.5,this.scanlinesCount=void 0!==h?h:512}(gl.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){this.uniforms.time.value+=p,this.uniforms.tDiffuse.value=h.texture,this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},gl.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.grayscale=this.grayscale,r.noiseIntensity=this.noiseIntensity,r.scanlinesIntensity=this.scanlinesIntensity,r.scanlinesCount=this.scanlinesCount,r};var nc={uniforms:{tDiffuse:{value:null},tSize:{value:new l.Vector2(256,256)},center:{value:new l.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};function Bc(a,r,h){mr.call(this),this.type="DotScreen",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(nc.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:nc.vertexShader,fragmentShader:nc.fragmentShader}),Object.defineProperties(this,{center:{get:function(){return this.uniforms.center.value},set:function(p){this.uniforms.center.value=p}},angle:{get:function(){return this.uniforms.angle.value},set:function(p){this.uniforms.angle.value=p}},scale:{get:function(){return this.uniforms.scale.value},set:function(p){this.uniforms.scale.value=p}}}),void 0!==a&&this.center.copy(a),this.angle=void 0!==r?r:.5,this.scale=void 0!==h?h:.8}function eu(){Jo.call(this,ns),this.type="Copy"}(Bc.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){this.uniforms.tDiffuse.value=h.texture,this.uniforms.tSize.value.set(h.width,h.height),this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},Bc.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.center=this.center.toArray(),r.angle=this.angle,r.scale=this.scale,r},eu.prototype=Object.create(Jo.prototype);var hr={uniforms:{tDiffuse:{value:null},color:{value:new l.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")};function Lp(){Jo.call(this,hr),this.type="Colorify",Object.defineProperties(this,{color:{get:function(){return this.uniforms.color.value},set:function(a){this.uniforms.color.value=a}}})}(Lp.prototype=Object.create(Jo.prototype)).toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.color=this.color.getHex(),r};var Ia={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")};function Ka(a,r,h){mr.call(this),this.type="Bokeh",this.renderTargetColor=new l.WebGLRenderTarget(0,0,mr.RGBLinear),this.renderTargetDepth=this.renderTargetColor.clone(),this.materialDepth=new l.MeshDepthMaterial,this.materialDepth.depthPacking=l.RGBADepthPacking,this.materialDepth.blending=l.NoBlending,this.uniforms=l.UniformsUtils.clone(Ia.uniforms),this.uniforms.tDepth.value=this.renderTargetDepth.texture,this.materialBokeh=new l.ShaderMaterial({defines:Ia.defines,uniforms:this.uniforms,vertexShader:Ia.vertexShader,fragmentShader:Ia.fragmentShader}),this.createQuadScene(),this.quad.material=this.materialBokeh;var p=this;Object.defineProperties(this,{aperture:{get:function(){return p.uniforms.aperture.value},set:function(y){p.uniforms.aperture.value=y}},focus:{get:function(){return p.uniforms.focus.value},set:function(y){p.uniforms.focus.value=y}},maxblur:{get:function(){return p.uniforms.maxblur.value},set:function(y){p.uniforms.maxblur.value=y}}}),this.focus=void 0!==a?a:1,this.aperture=void 0!==r?r:1,this.maxblur=void 0!==h?h:.2}(Ka.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){b.overrideMaterial=this.materialDepth,a.autoClear=!1,a.setClearColor(16777215),a.setClearAlpha(1),a.setRenderTarget(this.renderTargetDepth),a.clear(!0,!0,!0),a.render(b,R),this.uniforms.tColor.value=h.texture,this.uniforms.nearClip.value=R.near,this.uniforms.farClip.value=R.far,this.uniforms.aspect.value=R.aspect,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera),b.overrideMaterial=null},Ka.prototype.setSize=function(a,r){this.renderTargetColor.setSize(a,r),this.renderTargetDepth.setSize(a,r)},Ka.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.aperture=this.aperture,r.focus=this.focus,r.maxblur=this.maxblur,r};var Il={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new l.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){var h,p,y,b,O,T,R=2*Math.ceil(3*a)+1;for(R>25&&(R=25),b=.5*(R-1),p=new Array(R),y=0,h=0;h<R;++h)p[h]=(O=h-b,T=a,Math.exp(-O*O/(2*T*T))),y+=p[h];for(h=0;h<R;++h)p[h]/=y;return p}};function Dr(a,r,h,p){mr.call(this),this.type="Bloom",this.copyToScreen=!0,this.createQuadScene(),a=void 0!==a?a:1,r=void 0!==r?r:25,h=void 0!==h?h:4,this.renderTargetX=new l.WebGLRenderTarget(p=void 0!==p?p:256,p,mr.RGBALinear),this.renderTargetY=new l.WebGLRenderTarget(p,p,mr.RGBALinear),this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.AdditiveBlending,transparent:!0}),this.convolutionUniforms=l.UniformsUtils.clone(Il.uniforms),this.convolutionUniforms.uImageIncrement.value=Dr.blurX,this.convolutionUniforms.cKernel.value=Il.buildKernel(h),this.materialConvolution=new l.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:Il.vertexShader,fragmentShader:Il.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}})}Dr.blurX=new l.Vector2(.001953125,0),Dr.blurY=new l.Vector2(0,.001953125),(Dr.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){y&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=h.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurX,a.setRenderTarget(this.renderTargetX),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurY,a.setRenderTarget(this.renderTargetY),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(r),a.render(this.scene,this.camera)},Dr.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.strength=this.strength,r.kernelSize=this.kernelSize,r.sigma=this.sigma,r.resolution=this.resolution,r};var Nc={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function qp(){Jo.call(this,Nc),this.type="FXAA"}(qp.prototype=Object.create(Jo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(1/a,1/r)};var Eu={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")};function ui(a){mr.call(this),this.type="Afterimage",this.uniforms=l.UniformsUtils.clone(Eu.uniforms),this.textureComp=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.textureOld=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.shaderMaterial=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Eu.vertexShader,fragmentShader:Eu.fragmentShader}),this.basicMaterial=new l.MeshBasicMaterial,this.createQuadScene(),Object.defineProperties(this,{damp:{get:function(){return this.uniforms.damp.value},set:function(r){this.uniforms.damp.value=r}}}),this.damp=void 0!==a?a:.96}(ui.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,R){var O=this.textureOld;this.textureOld=this.textureComp,this.textureComp=O,this.uniforms.tNew.value=h.texture,this.uniforms.tOld.value=this.textureOld.texture,this.quad.material=this.shaderMaterial,a.autoClear=!1,a.setRenderTarget(this.textureComp),a.render(this.scene,this.camera),this.basicMaterial.map=this.textureComp.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,this.quad.material=this.basicMaterial,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},ui.prototype.setSize=function(a,r){this.textureComp.setSize(a,r),this.textureOld.setSize(a,r)},ui.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.damp=this.damp,r};var sr={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},Ol={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")};function tu(a,r){mr.call(this);var h=this;this.type="AdaptiveToneMapping",this.needsInit=!0,this.resolution=void 0!==r?r:256,this._adaptive=void 0===a||a,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.NoBlending,depthTest:!1}),this.materialLuminance=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(sr.uniforms),vertexShader:sr.vertexShader,fragmentShader:sr.fragmentShader,blending:l.NoBlending}),this.createShader(),void 0===Ol&&console.error("nunuStudio: AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(Ol.uniforms),vertexShader:Ol.vertexShader,fragmentShader:Ol.fragmentShader,blending:l.NoBlending}),this.createQuadScene(),Object.defineProperties(this,{minLuminance:{get:function(){return h.adaptLuminanceShader.uniforms.minLuminance.value},set:function(p){h.adaptLuminanceShader.uniforms.minLuminance.value=p}},tau:{get:function(){return h.adaptLuminanceShader.uniforms.tau.value},set:function(p){h.adaptLuminanceShader.uniforms.tau.value=p}},adaptive:{get:function(){return h._adaptive},set:function(p){p?(this._adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this._adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}}})}function Mo(){this.uuid=l.Math.generateUUID(),this.width=1,this.height=1,this.passes=[],this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.copyPass=new Jo(ns),this.rendererState=new Kh}function Vn(a){this.keys=[],this.actions=[];var r=this,h=this.actions;this.events=new hn,this.events.add(window,"keydown",function(p){h.push(p.keyCode),h.push(li.DOWN)}),this.events.add(window,"keyup",function(p){h.push(p.keyCode),h.push(li.UP)}),this.events.add(window,"focus",function(p){r.reset()}),!0!==a&&this.create()}function nu(){l.Group.call(this),this.name="controls",this.type="FirstPersonControls",this.sensitivity=.005,this.needsButtonPressed=!0,this.movementEnabled=!0,this.moveSpeed=.05,this.moveOnPlane=!1,this.moveKeys=[Vn.W,Vn.S,Vn.A,Vn.D],this.vector=new l.Vector2(0,0),this.mouse=null,this.keyboard=null,this.tempVector=new l.Vector3}function Tu(){l.Group.call(this),this.name="group",this.type="Group"}function vl(a){l.Object3D.call(this),this.element=a,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)});var r=this,h=!0;Object.defineProperties(this,{visible:{get:function(){return h},set:function(p){h=p,r.element.style.display=p?"block":"none"}}})}function rc(a){var r=document.createElement("iframe");r.style.border="none",vl.call(this,r),this.type="HTMLView",this.name="webview";var h,p,y=this;Object.defineProperties(this,{url:{get:function(){return a},set:function(b){a=void 0!==b?rc.processURL(b):"",y.element.src=a}},width:{get:function(){return h},set:function(b){y.element.style.width=(h=b)+"px"}},height:{get:function(){return p},set:function(b){y.element.style.height=(p=b)+"px"}}}),this.width=512,this.height=512,this.url=void 0!==a?a:""}function Mu(a,r,h){l.HemisphereLight.call(this,a,r,h),this.name="hemisphere"}function ea(a,r,h){l.InstancedMesh.call(this,a,r,h),this.name="instanced",this.type="InstancedMesh",this.receiveShadow=!0,this.castShadow=!0,Object.defineProperties(this,{count:{get:function(){return h},set:function(p){p>h&&(this.instanceMatrix=new l.BufferAttribute(new Float32Array(16*p),16)),h=p}}})}(tu.prototype=Object.create(mr.prototype)).constructor=tu,tu.prototype.render=function(a,r,h,p,y){this.needsInit&&(this.reset(),this.luminanceRT.texture.type=h.texture.type,this.previousLuminanceRT.texture.type=h.texture.type,this.currentLuminanceRT.texture.type=h.texture.type,this.needsInit=!1),this._adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=h.texture,a.setRenderTarget(this.currentLuminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=p,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,a.setRenderTarget(this.luminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,a.setRenderTarget(this.previousLuminanceRT),a.render(this.scene,this.camera)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=h.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},tu.prototype.createShader=function(){this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\t\tvoid main(){\n\t\t\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\n\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\n\t\tuniform sampler2D lastLum;\n\t\tuniform sampler2D currentLum;\n\t\tuniform float minLuminance;\n\t\tuniform float delta;\n\t\tuniform float tau;\n\t\t\n\t\tvoid main()\n\t\t{\n\t\t\tvec4 lastLum = texture2D(lastLum, vUv, MIP_LEVEL_1X1);\n\t\t\tvec4 currentLum = texture2D(currentLum, vUv, MIP_LEVEL_1X1);\n\t\t\t\n\t\t\tfloat fLastLum = max(minLuminance, lastLum.r);\n\t\t\tfloat fCurrentLum = max(minLuminance, currentLum.r);\n\t\t\t\n\t\t\t// The adaption seems to work better in extreme lighting differences if the input luminance is squared.\t\t\tfCurrentLum *= fCurrentLum;\n\t\t\t\n\t\t\t// Adapt the luminance using Pattanaik's technique\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t}"},this.materialAdaptiveLum=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:this.adaptLuminanceShader.defines,blending:l.NoBlending})},tu.prototype.reset=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,mr.RGBALinear),this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,mr.RGBALinear),this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,{minFilter:l.LinearMipMapLinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat}),this._adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new l.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},tu.prototype.dispose=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()},tu.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.minLuminance=this.minLuminance,r.tau=this.tau,r.adaptive=this._adaptive,r},Mo.bufferParameters={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,stencilBuffer:!1},Mo.prototype.swapBuffers=function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},Mo.prototype.addPass=function(a){this.passes.push(a)},Mo.prototype.moveBack=function(a){var r=this.passes.indexOf(a);if(r>0){for(var h=r;h!==r-1;h-=1)this.passes[h]=this.passes[h-1];return this.passes[r-1]=a,!0}return!1},Mo.prototype.moveForward=function(a){var r=this.passes.indexOf(a);if(-1!==r&&r<this.passes.length-1){for(var h=r;h!==r+1;h+=1)this.passes[h]=this.passes[h+1];return this.passes[r+1]=a,!0}return!1},Mo.prototype.removePass=function(a){var r=this.passes.indexOf(a);-1!==r&&this.passes.splice(r,1)},Mo.prototype.insertPass=function(a,r){this.passes.splice(r,0,a)},Mo.prototype.render=function(a,r,h,p){var y=!1;this.rendererState.backup(a);for(var b=0;b<this.passes.length;b++){var R=this.passes[b];if(R.enabled){if(R.render(a,this.writeBuffer,this.readBuffer,p,y,r,h),R.renderToScreen){R.copyToScreen&&(this.copyPass.renderToScreen=!0,this.copyPass.render(a,this.readBuffer,this.writeBuffer,p));break}R.needsSwap&&(y&&(a.context.stencilFunc(a.context.NOTEQUAL,1,4294967295),this.copyPass.renderToScreen=!1,this.copyPass.render(a,this.writeBuffer,this.readBuffer,p),a.context.stencilFunc(a.context.EQUAL,1,4294967295)),this.swapBuffers()),void 0!==Qh&&(R instanceof Qh?y=!0:R instanceof Ah&&(y=!1))}}this.rendererState.restore(a)},Mo.prototype.setSize=function(a,r){a=Math.floor(a),r=Math.floor(r),this.width=a,this.height=r,this.writeBuffer.setSize(a,r),this.readBuffer.setSize(a,r);for(var h=0;h<this.passes.length;h++)this.passes[h].setSize(a,r)},Mo.prototype.reset=function(){this.dispose(),this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters)},Mo.prototype.dispose=function(){this.writeBuffer.dispose(),this.readBuffer.dispose(),this.writeBuffer=null,this.readBuffer=null},Mo.prototype.toJSON=function(){var a={};a.uuid=this.uuid,a.passes=[];for(var r=0;r<this.passes.length;r++)a.passes.push(this.passes[r].toJSON());return a},Mo.fromJSON=function(a){var r=new Mo;r.uuid=a.uuid;for(var h=0;h<a.passes.length;h++){var p=a.passes[h],y=null;if("Render"===p.type)y=new _l;else if("UnrealBloom"===p.type)for((y=new Bs).strength=p.strength,y.radius=p.radius,y.threshold=p.threshold,y.bloomFactors=p.bloomFactors,h=0;h<y.bloomTintColors.length;h++)y.bloomTintColors[h].fromArray(p.bloomTintColors[h]);else"Bloom"===p.type?y=new Dr(p.strength,p.kernelSize,p.sigma,p.resolution):"SSAONOH"===p.type?((y=new Ai).kernelRadius=p.kernelRadius,y.minDistance=p.minDistance,y.maxDistance=p.maxDistance,y.kernelSize=p.kernelSize):"SSAO"===p.type?((y=new Ro).onlyAO=p.onlyAO,y.radius=p.radius,y.aoClamp=p.aoClamp,y.lumInfluence=p.lumInfluence):"Bokeh"===p.type?y=new Ka(p.focus,p.aperture,p.maxblur):"FXAA"===p.type?y=new qp:"Copy"===p.type?y=new eu:"Film"===p.type?((y=new gl).grayscale=p.grayscale,y.noiseIntensity=p.noiseIntensity,y.scanlinesIntensity=p.scanlinesIntensity,y.scanlinesCount=p.scanlinesCount):"DotScreen"===p.type?((y=new Bc).center.fromArray(p.center),y.angle=p.angle,y.scale=p.scale):"Colorify"===p.type?(y=new Lp).color.setHex(p.color):"Sobel"===p.type?y=new Ps:"Technicolor"===p.type?y=new Kc:"HueSaturation"===p.type?((y=new Po).hue=p.hue,y.saturation=p.saturation):"AdaptiveToneMapping"===p.type?((y=new tu(p.adaptive)).tau=p.tau,y.minLuminance=p.minLuminance):"Afterimage"===p.type?(y=new ui).damp=p.damp:y=new _l;y.uuid=p.uuid,y.enabled=p.enabled,y.needsSwap=p.needsSwap,y.renderToScreen=p.renderToScreen,y.clear=p.clear,y.copyToScreen=!0===p.copyToScreen,r.addPass(y)}return r},(Vn.prototype=Vn).constructor=Vn,Vn.update=function(){for(var a=0;this.actions.length>a;){var r=this.actions.shift(),h=this.actions.shift();void 0===this.keys[r]&&(this.keys[r]=new li),this.keys[r].update(h),(this.keys[r].justReleased||this.keys[r].justPressed)&&(this.actions.push(r),this.actions.push(li.RESET),a+=2)}},Vn.reset=function(){for(var a=0;a<this.keys.length;a++)void 0!==this.keys[a]&&this.keys[a].reset()},Vn.keyPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].pressed},Vn.keyJustPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].justPressed},Vn.keyJustReleased=function(a){return void 0!==this.keys[a]&&this.keys[a].justReleased},Vn.create=function(){this.events.create()},Vn.dispose=function(){this.events.destroy()},Vn.TAB=9,Vn.ENTER=13,Vn.SHIFT=16,Vn.CTRL=17,Vn.ALT=18,Vn.CAPS_LOCK=20,Vn.ESC=27,Vn.SPACEBAR=32,Vn.PAGE_UP=33,Vn.PAGE_DOWN=34,Vn.END=35,Vn.HOME=36,Vn.INSERT=45,Vn.DEL=46,Vn.LEFT=37,Vn.RIGHT=39,Vn.UP=38,Vn.DOWN=40,Vn.NUM0=48,Vn.NUM1=49,Vn.NUM2=50,Vn.NUM3=51,Vn.NUM4=52,Vn.NUM5=53,Vn.NUM6=54,Vn.NUM7=55,Vn.NUM8=56,Vn.NUM9=57,Vn.A=65,Vn.B=66,Vn.C=67,Vn.D=68,Vn.E=69,Vn.F=70,Vn.G=71,Vn.H=72,Vn.I=73,Vn.J=74,Vn.K=75,Vn.L=76,Vn.M=77,Vn.N=78,Vn.O=79,Vn.P=80,Vn.Q=81,Vn.R=82,Vn.S=83,Vn.T=84,Vn.U=85,Vn.V=86,Vn.W=87,Vn.X=88,Vn.Y=89,Vn.Z=90,Vn.F1=112,Vn.F2=113,Vn.F3=114,Vn.F4=115,Vn.F5=116,Vn.F6=117,Vn.F7=118,Vn.F8=119,Vn.F9=120,Vn.F10=121,Vn.F11=122,Vn.F12=123,nu.UP=new l.Vector3(0,1,0),(nu.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof hi&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.updateControls(),l.Group.prototype.initialize.call(this)},nu.prototype.update=function(a){if(this.needsButtonPressed&&!this.mouse.buttonPressed(Zr.LEFT)||(this.vector.y-=this.sensitivity*this.mouse.delta.y,this.vector.x-=this.sensitivity*this.mouse.delta.x,this.vector.y<-1.57?this.vector.y=-1.57:this.vector.y>1.57&&(this.vector.y=1.57),this.updateControls()),this.movementEnabled){if(this.keyboard.keyPressed(this.moveKeys[0])){var r=this.getWorldDirection(this.tempVector);this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)}this.keyboard.keyPressed(this.moveKeys[1])&&(r=this.getWorldDirection(this.tempVector),this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.add(r)),this.keyboard.keyPressed(this.moveKeys[2])&&((r=new l.Vector3(Math.sin(this.vector.x-1.57),0,Math.cos(this.vector.x-1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)),this.keyboard.keyPressed(this.moveKeys[3])&&((r=new l.Vector3(Math.sin(this.vector.x+1.57),0,Math.cos(this.vector.x+1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r))}l.Object3D.prototype.update.call(this,a)},nu.prototype.updateControls=function(){var a=Math.cos(this.vector.y),r=new l.Vector3(Math.sin(this.vector.x)*a,Math.sin(this.vector.y),Math.cos(this.vector.x)*a);r.add(this.position);var h=new l.Matrix4;h.lookAt(this.position,r,nu.UP),this.quaternion.setFromRotationMatrix(h)},nu.prototype.getDirection=function(){var a=this.getWorldDirection(this.tempVector);return a.normalize(),a},nu.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.moveSpeed=this.moveSpeed,r.object.sensitivity=this.sensitivity,r.object.needsButtonPressed=this.needsButtonPressed,r.object.movementEnabled=this.movementEnabled,r.object.moveOnPlane=this.moveOnPlane,r.object.moveKeys=this.moveKeys,r},(Tu.prototype=Object.create(l.Group.prototype)).constructor=Tu,(vl.prototype=Object.create(l.Object3D.prototype)).constructor=vl,vl.prototype.isCSS3DObject=!0,(rc.prototype=Object.create(vl.prototype)).constructor=rc,rc.processURL=function(a){return a.replace("watch?v=","embed/")},rc.prototype.toJSON=function(a){var r=vl.prototype.toJSON.call(this,a);return r.object.height=this.height,r.object.width=this.width,r.object.url=this.url,r},Mu.prototype=Object.create(l.HemisphereLight.prototype),(ea.prototype=Object.create(l.InstancedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},ea.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.instanceMatrix=this.instanceMatrix.toJSON(),r.object.count=this.count,r};var vs=function(){l.Mesh.call(this,vs.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var a=new l.Vector3,r=new l.Vector3,h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping;var p=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);p.minFilter=l.NearestFilter,p.magFilter=l.NearestFilter,p.wrapS=l.ClampToEdgeWrapping,p.wrapT=l.ClampToEdgeWrapping;var y=vs.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),R=new l.RawShaderMaterial({uniforms:{map:{value:h},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),O=new l.Mesh(y,b),T=[],U=ya.Shader,ee=new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:p},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:U.vertexShader,fragmentShader:U.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1}),ie=new l.Mesh(y,ee);this.addElement=function(Le){T.push(Le)};var ne=new l.Vector2,ve=new l.Vector2,be=new l.Box2,Te=new l.Vector4;this.onBeforeRender=function(Le,Ie,Oe){Le.getCurrentViewport(Te);var Fe=Te.w/Te.z,je=Te.z/2,Ue=Te.w/2,Je=16/Te.w;if(ne.set(Je*Fe,Je),be.min.set(Te.x,Te.y),be.max.set(Te.x+(Te.z-16),Te.y+(Te.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(Oe.matrixWorldInverse),!(r.z>0)&&(a.copy(r).applyMatrix4(Oe.projectionMatrix),ve.x=Te.x+a.x*je+je-8,ve.y=Te.y+a.y*Ue+Ue-8,be.containsPoint(ve))){Le.copyFramebufferToTexture(ve,h),(Yt=b.uniforms).scale.value=ne,Yt.screenPosition.value=a,Le.renderBufferDirect(Oe,null,y,b,O,null),Le.copyFramebufferToTexture(ve,p),(Yt=R.uniforms).scale.value=ne,Yt.screenPosition.value=a,Le.renderBufferDirect(Oe,null,y,R,O,null);for(var pt=2*-a.x,at=2*-a.y,Mt=0,Tt=T.length;Mt<Tt;Mt++){var Yt,jt=T[Mt];(Yt=ee.uniforms).color.value.copy(jt.color),Yt.map.value=jt.texture,Yt.screenPosition.value.x=a.x+pt*jt.distance,Yt.screenPosition.value.y=a.y+at*jt.distance,Yt.scale.value.set((Je=jt.size/Te.w)*(Fe=Te.w/Te.z),Je),ee.uniformsNeedUpdate=!0,Le.renderBufferDirect(Oe,null,y,ee,ie,null)}}},this.dispose=function(){b.dispose(),R.dispose(),ee.dispose(),h.dispose(),p.dispose();for(var Le=0,Ie=T.length;Le<Ie;Le++)T[Le].texture.dispose()}};vs.prototype=Object.create(l.Mesh.prototype),vs.prototype.constructor=vs,vs.prototype.isLensflare=!0;var a,r,h,ya=function(a,r,h,p){this.texture=a,this.size=r||1,this.distance=h||0,this.color=p||new l.Color(16777215)};function ch(){l.Mesh.call(this,vs.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.name="lensflare",this.type="LensFlare",this.renderOrder=1/0,this.frustumCulled=!1,this.receiveShadow=!1,this.castShadow=!1,this.elements=[];var a=new l.Vector3,r=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);r.minFilter=l.NearestFilter,r.magFilter=l.NearestFilter,r.wrapS=l.ClampToEdgeWrapping,r.wrapT=l.ClampToEdgeWrapping,r.needsUpdate=!0;var h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping,h.needsUpdate=!0;var y,p=vs.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),R=new l.RawShaderMaterial({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUV = uv;\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tuniform sampler2D map;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = texture2D(map, vUV);\n\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),O=new l.Mesh(p,b),T=(y=ya.Shader,new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:h},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1})),U=new l.Mesh(p,T),ee=new l.Vector2,ie=new l.Vector2,ne=new l.Box2,ve=new l.Vector4;this.onBeforeRender=function(be,Te,Le){be.getCurrentViewport(ve);var Ie=ve.w/ve.z,Oe=ve.z/2,Fe=ve.w/2,je=16/ve.w;if(ee.set(je*Ie,je),ne.min.set(ve.x,ve.y),ne.max.set(ve.x+(ve.z-16),ve.y+(ve.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4(Le.matrixWorldInverse),a.applyMatrix4(Le.projectionMatrix),ie.x=ve.x+a.x*Oe+Oe-8,ie.y=ve.y+a.y*Fe+Fe-8,ne.containsPoint(ie)){be.copyFramebufferToTexture(ie,r),(Mt=b.uniforms).scale.value=ee,Mt.screenPosition.value=a,be.renderBufferDirect(Le,null,p,b,O,null),be.copyFramebufferToTexture(ie,h),(Mt=R.uniforms).scale.value=ee,Mt.screenPosition.value=a,be.renderBufferDirect(Le,null,p,R,O,null);for(var Ue=2*-a.x,Je=2*-a.y,pt=0,at=this.elements.length;pt<at;pt++){var Mt,Tt=this.elements[pt];(Mt=T.uniforms).color.value.copy(Tt.color),Mt.map.value=Tt.texture,Mt.screenPosition.value.x=a.x+Ue*Tt.distance,Mt.screenPosition.value.y=a.y+Je*Tt.distance,Mt.scale.value.set((je=Tt.size/ve.w)*(Ie=ve.w/ve.z),je),T.uniformsNeedUpdate=!0,be.renderBufferDirect(Le,null,p,T,U,null)}}},this.dispose=function(){b.dispose(),R.dispose(),T.dispose(),r.dispose(),h.dispose();for(var be=0;be<this.elements.length;be++)this.elements[be].texture.dispose()}}ya.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},vs.Geometry=(a=new l.BufferGeometry,r=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),h=new l.InterleavedBuffer(r,5),a.setIndex([0,1,2,0,2,3]),a.setAttribute("position",new l.InterleavedBufferAttribute(h,3,0,!1)),a.setAttribute("uv",new l.InterleavedBufferAttribute(h,2,3,!1)),a),(ch.prototype=Object.create(l.Mesh.prototype)).addFlare=function(a,r,h,p){void 0===r&&(r=-1),void 0===h&&(h=0),void 0===p&&(p=new l.Color(16777215)),h=Math.min(h,Math.max(0,h)),this.addElement(new ya(a,r,h,p))},ch.prototype.addElement=function(a){this.elements.push(a)},ch.prototype.toJSON=function(a){var r=this,h=[],p=l.Object3D.prototype.toJSON.call(this,a,function(y,b){for(var R=0;R<r.elements.length;R++){var O={};O.texture=r.elements[R].texture.toJSON(y).uuid,O.size=r.elements[R].size,O.distance=r.elements[R].distance,O.color=r.elements[R].color.getHex(),h.push(O)}});return p.object.elements=h,p};var pd,ru=function(a,r){switch(r){case l.sRGBEncoding:a.convertSRGBToLinear();break;case l.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return a},$h=__webpack_require__(412);function Rc(a,r){l.LightProbe.call(this,a,r),this.type="LightProbe",this.name="probe"}function uh(a,r){l.Mesh.call(this,a,r),this.name="model",this.receiveShadow=!0,this.castShadow=!0}function ba(){l.Group.call(this),this.name="orbit",this.type="OrbitControls",this.distance=4,this.maxDistance=20,this.minDistance=2,this.sensitivity=.002,this.zoomSensitivity=.001,this.limitUp=1.57,this.limitDown=-1.57,this.needsButtonPressed=!0,this.zoomEnabled=!0,this.movementEnabled=!0,this.center=new l.Vector3(0,0,0),this.vector=new l.Vector2(Math.PI/2,0),this.smooth=!0,this.friction=.8,this.speed=.3,this.invertNavigation=!1,this.mouse=null,this.keyboard=null,this.speedDistance=0,this.speedCenter=new l.Vector3(0,0,0),this.speedOrientation=new l.Vector2(0,0),this.tempVector=new l.Vector3}function Io(a){this.offset=new l.Vector2(0,0),this.size=new l.Vector2(1,1),this.mode=void 0!==a?a:Io.RELATIVE,this.anchor=Io.TOP_LEFT,this.width=1,this.height=1,this.viewport=new l.Vector4(0,0,1,1)}function Is(a,r,h,p,y){l.OrthographicCamera.call(this,-1,1,1,-1,p,y),this.name="camera",this.size=void 0!==a?a:10,this.aspect=void 0!==r?r:1,this.mode=void 0!==h?h:Is.RESIZE_HORIZONTAL,this.viewport=new Io,this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.updateProjectionMatrix(),this.composer=new Mo;var b=new _l;b.renderToScreen=!0,this.composer.addPass(b)}function ke(a,r,h,p){this.viewport=new Io,l.PerspectiveCamera.call(this,a,r,h,p),this.name="camera",this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.composer=new Mo;var y=new _l;y.renderToScreen=!0,this.composer.addPass(y)}function De(){l.Group.call(this),this.name="physics",this.type="Physics",this.body=new dt,this.body.type=dt.DYNAMIC,this.body.mass=1,this.mode=De.LOCAL,this.world=null}function He(a,r,h,p){l.PointLight.call(this,a,r,h,p),this.name="point",this.castShadow=!0,this.shadow.camera.near=.1,this.shadow.camera.far=1e3,this.shadow.bias=0}(Rc.prototype=Object.create(l.LightProbe.prototype)).generate=function(){var a=this.getScene();if(null!==a){var r=new OffscreenCanvas(256,256),h=new l.WebGLRenderer({canvas:r,alpha:!0}),p=new TCubeCamera(1,1e3,256,{format:l.RGBAFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter});p.matrixAutoUpdate=!1,p.matrix.copy(this.matrix),p.matrixWorld.copy(this.matrixWorld),p.renderTarget.texture.encoding=$h.sRGBEncoding,p.update(h,a);var y=function(b,R){for(var O,T,U,ee=0,ie=new l.Vector3,ne=new l.Vector3,ve=new l.Color,be=[0,0,0,0,0,0,0,0,0],Te=new l.SphericalHarmonics3,Le=Te.coefficients,Ie=0;Ie<6;Ie++){var Oe=R.width,Fe=new Uint8Array(Oe*Oe*4);b.readRenderTargetPixels(R,0,0,Oe,Oe,Fe,Ie);for(var je=2/Oe,Ue=0,Je=Fe.length;Ue<Je;Ue+=4){ve.setRGB(Fe[Ue]/255,Fe[Ue+1]/255,Fe[Ue+2]/255),ru(ve,R.texture.encoding);var pt=Ue/4,at=(pt%Oe+.5)*je-1,Mt=1-(Math.floor(pt/Oe)+.5)*je;switch(Ie){case 0:ie.set(1,Mt,-at);break;case 1:ie.set(-1,Mt,at);break;case 2:ie.set(at,1,-Mt);break;case 3:ie.set(at,-1,Mt);break;case 4:ie.set(at,Mt,1);break;case 5:ie.set(-at,Mt,-1)}T=ie.lengthSq(),ee+=U=4/(Math.sqrt(T)*T),ne.copy(ie).normalize(),l.SphericalHarmonics3.getBasisAt(ne,be);for(var Tt=0;Tt<9;Tt++)Le[Tt].x+=be[Tt]*ve.r*U,Le[Tt].y+=be[Tt]*ve.g*U,Le[Tt].z+=be[Tt]*ve.b*U}}for(O=4*Math.PI/ee,Tt=0;Tt<9;Tt++)Le[Tt].x*=O,Le[Tt].y*=O,Le[Tt].z*=O;return new l.LightProbe(Te)}(h,p.renderTarget);this.sh=y.sh}else console.warn("nunuStudio: LightProbe cannot generate, no scene.",this)},Rc.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.sh=this.sh.toArray(),r},(uh.prototype=Object.create(l.Mesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},ba.UP=new l.Vector3(0,1,0),ba.ZERO=new l.Vector3(0,0,0),(ba.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof hi&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.center.copy(this.position),this.updateControls(),l.Group.prototype.initialize.call(this)},ba.prototype.update=function(a){var r=!1;if(this.needsButtonPressed&&!this.mouse.buttonPressed(Zr.LEFT)||(!0===this.smooth?(this.speedOrientation.y+=this.speed*this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.speedOrientation.x-=this.speed*this.sensitivity*this.mouse.delta.x):(this.vector.y-=this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.vector.x-=this.sensitivity*this.mouse.delta.x),r=!0),this.zoomEnabled&&(this.mouse.buttonPressed(Zr.MIDDLE)&&(!0===this.smooth?this.speedCenter.y+=this.speed*this.sensitivity*this.mouse.delta.y*this.distance:this.center.y+=this.sensitivity*this.mouse.delta.y*this.distance,r=!0),0!==this.mouse.wheel&&(!0===this.smooth?this.speedDistance+=this.speed*this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity:this.distance+=this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity,r=!0)),this.movementEnabled&&this.mouse.buttonPressed(Zr.RIGHT)){var h=this.getWorldDirection(this.tempVector);if(h.y=0,h.normalize(),!0===this.smooth){var p=this.speed*this.mouse.delta.y*this.sensitivity*this.distance;this.speedCenter.x+=-h.x*p,this.speedCenter.z+=-h.z*p,h.applyAxisAngle(ba.UP,Math.PI/2);var y=this.speed*this.mouse.delta.x*this.sensitivity*this.distance;this.speedCenter.x-=h.x*y,this.speedCenter.z-=h.z*y}else this.center.x+=-h.x*(p=this.mouse.delta.y*this.sensitivity*this.distance),this.center.z+=-h.z*p,h.applyAxisAngle(ba.UP,Math.PI/2),this.center.x-=h.x*(y=this.mouse.delta.x*this.sensitivity*this.distance),this.center.z-=h.z*y;r=!0}if(!0===this.smooth)return this.distance+=this.speedDistance,this.center.add(this.speedCenter),this.vector.add(this.speedOrientation),this.speedDistance*=this.friction,this.speedOrientation.multiplyScalar(this.friction),this.speedCenter.multiplyScalar(this.friction),void this.updateControls();!0===r&&this.updateControls(),l.Object3D.prototype.update.call(this,a)},ba.prototype.updateControls=function(){this.vector.y<this.limitDown?this.vector.y=this.limitDown:this.vector.y>this.limitUp&&(this.vector.y=this.limitUp),this.distance<this.minDistance?this.distance=this.minDistance:this.distance>this.maxDistance&&(this.distance=this.maxDistance);var a=this.distance*Math.cos(this.vector.y);this.position.set(Math.cos(this.vector.x)*a,this.distance*Math.sin(this.vector.y),Math.sin(this.vector.x)*a),this.position.add(this.center);var r=new l.Matrix4;r.lookAt(this.position,this.center,ba.UP),this.quaternion.setFromRotationMatrix(r)},ba.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.distance=this.distance,r.object.maxDistance=this.maxDistance,r.object.minDistance=this.minDistance,r.object.sensitivity=this.sensitivity,r.object.limitUp=this.limitUp,r.object.limitDown=this.limitDown,r.object.needsButtonPressed=this.needsButtonPressed,r.object.zoomEnabled=this.zoomEnabled,r.object.movementEnabled=this.movementEnabled,r.object.smooth=this.smooth,r.object.friction=this.friction,r.object.speed=this.speed,r.object.invertNavigation=this.invertNavigation,r.object.center=this.center.toArray(),r.object.vector=this.vector.toArray(),r},Io.RELATIVE=200,Io.ABSOLUTE=201,Io.TOP_LEFT=301,Io.TOP_RIGHT=302,Io.BOTTOM_LEFT=303,Io.BOTTOM_RIGHT=304,Io.prototype.update=function(a){var r,h,p,y,b,R;void 0===a?(p=0,y=0,r=this.width,h=this.height):(p=a.viewport.x,y=a.viewport.y,r=a.viewport.z,h=a.viewport.w),this.mode===Io.RELATIVE?(b=new l.Vector2(this.offset.x*r,this.offset.y*h),R=new l.Vector2(this.size.x*r,this.size.y*h)):this.mode===Io.ABSOLUTE&&(b=this.offset,R=this.size),this.anchor===Io.BOTTOM_LEFT?this.viewport.set(b.x+p,b.y+y,R.x,R.y):this.anchor===Io.BOTTOM_RIGHT?this.viewport.set(r-R.x-b.x+p,b.y+y,R.x,R.y):this.anchor===Io.TOP_LEFT?this.viewport.set(b.x+p,h-R.y-b.y+y,R.x,R.y):this.anchor===Io.TOP_RIGHT&&this.viewport.set(r-R.x-b.x+p,h-R.y-b.y+y,R.x,R.y)},Io.prototype.getAspectRatio=function(){return this.viewport.z/this.viewport.w},Io.prototype.isInside=function(a,r){return r.position.x>this.viewport.x&&r.position.x<this.viewport.x+this.viewport.z&&r.position.y<this.height-this.viewport.y&&r.position.y>this.height-this.viewport.y-this.viewport.w},Io.prototype.getNormalized=(pd=new l.Vector2,function(a,r){return pd.set((r.position.x-this.viewport.z-this.viewport.x)/this.viewport.z*2+1,-(r.position.y-(this.height-(this.viewport.y+this.viewport.w)))/this.viewport.w*2+1),pd}),Io.prototype.enable=function(a){a.setViewport(this.viewport),a.setScissor(this.viewport)},Io.prototype.toJSON=function(){return{offset:this.offset.toArray(),size:this.size.toArray(),mode:this.mode,anchor:this.anchor}},Io.prototype.fromJSON=function(a){this.offset.fromArray(a.offset),this.size.fromArray(a.size),this.mode=a.mode,this.anchor=a.anchor},Is.prototype=Object.create(l.OrthographicCamera.prototype),Is.RESIZE_HORIZONTAL=0,Is.RESIZE_VERTICAL=1,Is.prototype.resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},Is.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},Is.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},Is.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},Is.prototype.updateProjectionMatrix=function(){this.mode===Is.RESIZE_HORIZONTAL?(this.top=this.size/2,this.bottom=-this.top,this.right=this.top*this.aspect,this.left=-this.right):this.mode===Is.RESIZE_VERTICAL&&(this.right=this.size/2,this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top),l.OrthographicCamera.prototype.updateProjectionMatrix.call(this)},Is.prototype.toJSON=function(a){var r=l.OrthographicCamera.prototype.toJSON.call(this,a);return r.object.size=this.size,r.object.aspect=this.aspect,r.object.mode=this.mode,r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},(ke.prototype=Object.create(l.PerspectiveCamera.prototype)).resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},ke.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},ke.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},ke.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},ke.prototype.updateProjectionMatrix=function(){var a=this.near*Math.tan(.5*l.Math.DEG2RAD*this.fov)/this.zoom,r=2*a,h=this.aspect*r,p=-.5*h;0!==this.filmOffset&&(p+=this.near*this.filmOffset/this.getFilmWidth()),this.projectionMatrix.makePerspective(p,p+h,a,a-r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},ke.prototype.toJSON=function(a){var r=l.PerspectiveCamera.prototype.toJSON.call(this,a);return r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},De.prototype=Object.create(l.Group.prototype),De.LOCAL=100,De.WORLD=101,De.prototype.initialize=function(){if(this.mode===De.LOCAL)this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion);else if(this.mode===De.WORLD){var a=new l.Vector3;this.getWorldPosition(a),this.body.position.copy(a);var r=new l.Quaternion;this.getWorldQuaternion(r),this.body.quaternion.copy(r)}for(var h=this;null!==h.parent;)(h=h.parent)instanceof Fo&&(this.world=h.world,this.world.addBody(this.body));l.Object3D.prototype.initialize.call(this)},De.prototype.update=function(a){if(this.mode===De.LOCAL)this.position.copy(this.body.position),this.body.fixedRotation||this.quaternion.copy(this.body.quaternion);else if(this.mode===De.WORLD){var r=new l.Matrix4;if(this.body.fixedRotation)r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z);else{var h=new l.Quaternion;h.copy(this.body.quaternion),r.makeRotationFromQuaternion(h),r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z)}var p=new l.Matrix4;p.getInverse(this.parent.matrixWorld);var y=new l.Vector3;p.multiply(r),p.decompose(this.position,this.quaternion,y)}l.Object3D.prototype.update.call(this,a)},De.prototype.addShape=function(a){a instanceof oe&&this.body.addShape(a)},De.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.mode=this.mode,r.object.body={},r.object.body.type=this.body.type,r.object.body.mass=this.body.mass,r.object.body.linearDamping=this.body.linearDamping,r.object.body.angularDamping=this.body.angularDamping,r.object.body.allowSleep=this.body.allowSleep,r.object.body.sleepSpeedLimit=this.body.sleepSpeedLimit,r.object.body.sleepTimeLimit=this.body.sleepTimeLimit,r.object.body.collisionFilterGroup=this.body.collisionFilterGroup,r.object.body.collisionFilterMask=this.body.collisionFilterMask,r.object.body.fixedRotation=this.body.fixedRotation,r.object.body.shapes=[];for(var h=this.body.shapes,p=0;p<h.length;p++){var y=h[p],b={};b.type=y.type,y.type===oe.types.SPHERE?b.radius=y.radius:y.type===oe.types.BOX?(b.halfExtents={},b.halfExtents.x=y.halfExtents.x,b.halfExtents.y=y.halfExtents.y,b.halfExtents.z=y.halfExtents.z):y.type===oe.types.CONVEXPOLYHEDRON?(b.vertices=y.vertices,b.faces=y.faces):y.type===oe.types.HEIGHTFIELD?(b.data=y.data,b.maxValue=y.maxValue,b.minValue=y.minValue,b.elementSize=y.elementSize):y.type===oe.types.TRIMESH&&(b.vertices=y.vertices,b.normals=y.normals,b.edges=y.edges,b.indices=y.indices),r.object.body.shapes[p]=b}return r},De.fromJSON=function(a){var r=new De;void 0!==a.mode&&(r.mode=a.mode),r.body.type=a.body.type,r.body.mass=a.body.mass,r.body.linearDamping=a.body.linearDamping,r.body.angularDamping=a.body.angularDamping,r.body.allowSleep=a.body.allowSleep,r.body.sleepSpeedLimit=a.body.sleepSpeedLimit,r.body.sleepTimeLimit=a.body.sleepTimeLimit,r.body.collisionFilterGroup=a.body.collisionFilterGroup,r.body.collisionFilterMask=a.body.collisionFilterMask,r.body.fixedRotation=a.body.fixedRotation;for(var h=a.body.shapes,p=0;p<h.length;p++){var y=h[p];if(y.type===oe.types.SPHERE)r.body.addShape(new xc(y.radius));else if(y.type===oe.types.BOX)r.body.addShape(new Ge(new M(y.halfExtents.x,y.halfExtents.y,y.halfExtents.z)));else if(y.type===oe.types.PARTICLE)r.body.addShape(new pn);else if(y.type===oe.types.PLANE)r.body.addShape(new Fn);else if(y.type===oe.types.HEIGHTFIELD)r.body.addShape(new xn(y.data,{maxValue:y.maxValue,minValue:y.minValue,elementSize:y.elementSize}));else if(y.type===oe.types.CONVEXPOLYHEDRON){for(var b=0;b<y.vertices.length;b++)y.vertices[b]=new M(y.vertices[b].x,y.vertices[b].y,y.vertices[b].z);r.body.addShape(new Q(y.vertices,y.faces))}}return r},(He.prototype=Object.create(l.PointLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var we=__webpack_require__(759),ze=function(a){l.Loader.call(this,a),this.reversed=!1};function Ye(a){wi.call(this,"font","Font"),this.reversed=!1,this.font=null,void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.format="arraybuffer",this.loadTTF()):"object"==typeof a?(this.data=a,this.font=a,this.format="json",this.encoding="json"):(this.encoding=Rn.getFileExtension(a),this.name=Rn.getFileName(a),"json"===this.encoding?(this.data=JSON.parse(Rn.readFile(a)),this.format="json",this.font=this.data):"ttf"!==this.encoding&&"otf"!==this.encoding&&"ttc"!==this.encoding&&"otc"!==this.encoding||(this.data=Rn.readFileArrayBuffer(a),this.format="arraybuffer",this.loadTTF())))}function bt(){wi.call(this,"model","Model")}function Ot(a,r){wi.call(this,"audio","Audio"),void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"):ci.isBase64(a)?(this.encoding=void 0!==r?r:"",this.data=va.fromBase64(a),this.format="arraybuffer"):(this.data=Rn.readFileArrayBuffer(a),this.encoding=Rn.getFileExtension(a),this.format="arraybuffer"))}function Wt(a){ii.call(this,a),this.type="PositionalAudio",this.matrixAutoUpdate=!0,this.distanceModel="inverse",this.panningModel="HRTF",this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.panner.panningModel=this.panningModel,this.panner.distanceModel=this.distanceModel,this.panner.refDistance=1,this.panner.maxDistance=1e4,this.panner.rolloffFactor=1,this.panner.coneInnerAngle=360,this.panner.coneOuterAngle=0,this.panner.coneOuterGain=0,this.scene=null,this.tempPosition=new l.Vector3,this.tempPositionCamera=new l.Vector3,this.tempQuaternionCamera=new l.Quaternion}function In(a,r,h,p){l.RectAreaLight.call(this,a,r,h,p),this.name="rectarea"}function Sn(a,r){l.Group.call(this),this.type="Script",this.name="script",this.code=void 0!==a?a:Sn.DEFAULT,this.mode=void 0!==r?r:Sn.APPEND,this.script={},this.program=null,this.scene=null}function Hn(a,r){l.SkinnedMesh.call(this,a,r),this.name="skinned",this.receiveShadow=!0,this.castShadow=!0,this.skeleton=null}ze.prototype=Object.assign(Object.create(l.Loader.prototype),{constructor:ze,load:function(a,r,h,p){var y=this,b=new l.FileLoader(this.manager);b.setPath(this.path),b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.load(a,function(R){try{r(y.parse(R))}catch(O){p?p(O):console.error(O),y.manager.itemError(a)}},h,p)},parse:function(a){function r(h){var p,y=[];h.forEach(function(R){"m"===R.type.toLowerCase()?y.push(p=[R]):"z"!==R.type.toLowerCase()&&p.push(R)});var b=[];return y.forEach(function(R){var O={type:"m",x:R[R.length-1].x,y:R[R.length-1].y};b.push(O);for(var T=R.length-1;T>0;T--){var U=R[T];O={type:U.type},void 0!==U.x2&&void 0!==U.y2?(O.x1=U.x2,O.y1=U.y2,O.x2=U.x1,O.y2=U.y1):void 0!==U.x1&&void 0!==U.y1&&(O.x1=U.x1,O.y1=U.y1),O.x=R[T-1].x,O.y=R[T-1].y,b.push(O)}}),b}return void 0===we.U?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(h,p){for(var y=Math.round,b={},R=1e5/(72*(h.unitsPerEm||2048)),O=h.encoding.cmap.glyphIndexMap,T=Object.keys(O),U=0;U<T.length;U++){var ee=T[U],ie=h.glyphs.glyphs[O[ee]];if(void 0!==ee){var ne={ha:y(ie.advanceWidth*R),x_min:y(ie.xMin*R),x_max:y(ie.xMax*R),o:""};p&&(ie.path.commands=r(ie.path.commands)),ie.path.commands.forEach(function(ve){"c"===ve.type.toLowerCase()&&(ve.type="b"),ne.o+=ve.type.toLowerCase()+" ",void 0!==ve.x&&void 0!==ve.y&&(ne.o+=y(ve.x*R)+" "+y(ve.y*R)+" "),void 0!==ve.x1&&void 0!==ve.y1&&(ne.o+=y(ve.x1*R)+" "+y(ve.y1*R)+" "),void 0!==ve.x2&&void 0!==ve.y2&&(ne.o+=y(ve.x2*R)+" "+y(ve.y2*R)+" ")}),b[String.fromCodePoint(ie.unicode)]=ne}}return{glyphs:b,familyName:h.getEnglishName("fullName"),ascender:y(h.ascender*R),descender:y(h.descender*R),underlinePosition:h.tables.post.underlinePosition,underlineThickness:h.tables.post.underlineThickness,boundingBox:{xMin:h.tables.head.xMin,xMax:h.tables.head.xMax,yMin:h.tables.head.yMin,yMax:h.tables.head.yMax},resolution:1e3,original_font_information:h.tables.name}}(we.U.parse(a),this.reversed)}}),Ye.prototype=Object.create(wi.prototype),Ye.fileIsFont=function(a){return void 0!==a&&((a=a.name.toLocaleLowerCase()).endsWith("ttf")||a.endsWith("otf")||a.endsWith("ttc")||a.endsWith("otc")||a.endsWith("json"))},Ye.prototype.isFont=!0,Ye.prototype.reverseGlyphs=function(){this.reversed=!this.reversed,this.loadTTF()},Ye.prototype.loadTTF=function(){var a=new ze;a.reversed=this.reversed,this.font=a.parse(this.data)},Ye.prototype.toJSON=function(a){if(void 0!==a.fonts[this.uuid])return a.fonts[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.reversed=this.reversed,"arraybuffer"===this.format?(r.data=this.data,r.format=this.format):"base64"===this.format?(r.data=va.fromBase64(this.data),r.format="arraybuffer"):(r.data=this.data,r.format=this.format),a.fonts[this.uuid]=r,r},Ye.prototype.generateShapes=function(a,r,h){void 0===r&&(r=100),void 0===h&&(h=10);for(var p=this.font,y=function(T){for(var U=String(T).split(""),ee=r/p.resolution,ie=(p.boundingBox.yMax-p.boundingBox.yMin)*ee,ne=0,ve=0,be=[],Te=0;Te<U.length;Te++){var Le=U[Te];if("\n"===Le)ve-=ie,ne=0;else{var Ie=O(Le,ee,ne,ve);ne+=Ie.width,be.push(Ie.path)}}return be}(a),b=[],R=0;R<y.length;R++)Array.prototype.push.apply(b,y[R].toShapes());return b;function O(T,U,ee,ie){var ne=p.glyphs[T]||p.glyphs["?"];if(ne){var ve,be,Te,Le,Ie,Oe,Fe,je,Ue,Je,pt,at=new l.ShapePath,Mt=[],Tt=l.ShapeUtils.b2,Yt=l.ShapeUtils.b3;if(ne.o)for(var jt=ne._cachedOutline||(ne._cachedOutline=ne.o.split(" ")),It=0,Nt=jt.length;It<Nt;){var ft=jt[It++];if("m"===ft&&(ve=jt[It++]*U+ee,be=jt[It++]*U+ie,at.moveTo(ve,be)),"l"===ft)ve=jt[It++]*U+ee,be=jt[It++]*U+ie,at.lineTo(ve,be);else if("q"===ft){if(Te=jt[It++]*U+ee,Le=jt[It++]*U+ie,Fe=jt[It++]*U+ee,je=jt[It++]*U+ie,at.quadraticCurveTo(Fe,je,Te,Le),pt=Mt[Mt.length-1]){Ie=pt.x,Oe=pt.y;for(var $t=1;$t<=h;$t++)Tt(Zt=$t/h,Ie,Fe,Te),Tt(Zt,Oe,je,Le)}}else if("b"===ft&&(Te=jt[It++]*U+ee,Le=jt[It++]*U+ie,Fe=jt[It++]*U+ee,je=jt[It++]*U+ie,Ue=jt[It++]*U+ee,Je=jt[It++]*U+ie,at.bezierCurveTo(Fe,je,Ue,Je,Te,Le),pt=Mt[Mt.length-1]))for(Ie=pt.x,Oe=pt.y,$t=1;$t<=h;$t++){var Zt;Yt(Zt=$t/h,Ie,Fe,Ue,Te),Yt(Zt,Oe,je,Je,Le)}}return{width:ne.ha*U,path:at}}}},bt.prototype=Object.create(wi.prototype),bt.extensions=["gcode","drc","assimp","assimp.json","blend","amf","babylon","prwm","svg","obj","3ds","dae","gltf","glb","3mf","awd","ply","vtk","vtp","wrl","vrml","fbx","pcd","stl","json","x"],bt.fileIsModel=function(a){if(void 0!==a){a=a.name.toLocaleLowerCase();for(var r=0;r<bt.extensions.length;r++)if(a.endsWith(bt.extensions[r]))return!0}return!1},Ot.prototype=Object.create(wi.prototype),Ot.fileIsAudio=function(a){return!(void 0===a||!a.type.startsWith("audio"))},Ot.prototype.getAudioBuffer=function(a,r){a.decodeAudioData(this.data.slice(0),r,function(h){console.error("nunuStudio: Cannot decode audio buffer ("+h+")")})},Ot.prototype.toJSON=function(a){if(void 0!==a.audio[this.uuid])return a.audio[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.audio[this.uuid]=r,r},(Wt.prototype=Object.create(ii.prototype)).initialize=function(){ii.prototype.initialize.call(this);for(var a=this.parent;null!==a;){if(a instanceof Fo){this.scene=a;break}a=a.parent}},Wt.prototype.update=function(a){if(this.scene.cameras.length>0){var r=this.scene.cameras[0];this.getWorldPosition(this.tempPosition),r.getWorldPosition(this.tempPositionCamera),r.getWorldQuaternion(this.tempQuaternionCamera),this.tempPosition.sub(this.tempPositionCamera),this.tempPosition.z=-this.tempPosition.z,this.tempPosition.applyQuaternion(this.tempQuaternionCamera),this.panner.setPosition(this.tempPosition.x,this.tempPosition.z,this.tempPosition.y)}else this.panner.setPosition(0,0,0),this.panner.setOrientation(0,0,0);l.Object3D.prototype.update.call(this,a)},Wt.prototype.getOutput=function(){return this.panner},Wt.prototype.getRefDistance=function(){return this.panner.refDistance},Wt.prototype.setRefDistance=function(a){this.panner.refDistance=a},Wt.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},Wt.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a},Wt.prototype.getDistanceModel=function(){return this.panner.distanceModel},Wt.prototype.setDistanceModel=function(a){this.panner.distanceModel=a},Wt.prototype.getMaxDistance=function(){return this.panner.maxDistance},Wt.prototype.setMaxDistance=function(a){this.panner.maxDistance=a},Wt.prototype.toJSON=function(a){var r=ii.prototype.toJSON.call(this,a);return r.object.distanceModel=this.distanceModel,r.object.panningModel=this.panningModel,r},(In.prototype=Object.create(l.RectAreaLight.prototype)).toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.width=this.width,r.object.height=this.height,r},Sn.prototype=Object.create(l.Group.prototype),Sn.includeRegex=/include[ ]*\([ \n]*["'].+?["'][ \n]*\);*/gi,Sn.includeRegexStart=/include[ ]*\([ \n]*["']/gi,Sn.includeRegexEnd=/["'][ \n]*\);*/gi,Sn.DEFAULT="function initialize() {\n\t// TODO ADD CODE\n}\n\nfunction update(delta) {\n\t// TODO ADD CODE\n}",Sn.METHODS=["initialize","update","dispose","onMouseOver","onResize","onAppData"],Sn.APPEND=100,Sn.EVALUATE=101,Sn.INCLUDE=102,Sn.getIncludes=function(a){for(var r=[],h=new RegExp(Sn.includeRegex,"gi");;){var p=h.exec(a);if(null===p)break;var y=p[0];y=(y=y.replace(Sn.includeRegexStart,"")).replace(Sn.includeRegexEnd,""),r.push(y)}return r},Sn.removeComments=function(a){return a.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")},Sn.removeIncludes=function(a){return a.replace(Sn.includeRegex,"")},Sn.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.program=a);l.Object3D.prototype.initialize.call(this);var r=this;this.compileCode(this.code,function(){void 0!==r.script.initialize&&r.script.initialize.call(r)})},Sn.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a),l.Object3D.prototype.update.call(this,a)},Sn.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this),l.Object3D.prototype.dispose.call(this)},Sn.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r)},Sn.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a)},Sn.prototype.compileCode=function(a,r){try{a=this.code;for(var h=0;h<Sn.METHODS.length;h++){var p=Sn.METHODS[h];a+="\nif(this."+p+" == undefined && typeof "+p+" !== 'undefined'){this."+p+" = "+p+";}"}if(this.mode===Sn.APPEND){a=Sn.removeComments(a);var y=Sn.getIncludes(a);for(a=Sn.removeIncludes(a),h=0;h<y.length;h++){var b=this.program.getResourceByName(y[h]);if(null===b){if(null===(b=Rn.readFile(y[h],!0)))throw new Error("Script include() library "+y[h]+" not found.");a=b+"\n"+a}else a=b.data+"\n"+a}a+='\nfunction include(name)\t\t\t{\t\t\t\tconsole.warn("nunuStudio: Script running in append mode, " + name + " cannot be included in runtime.");\t\t\t}'}else if(this.mode===Sn.EVALUATE)a+='\nfunction include(name)\t\t\t{\t\t\t\tvar text = program.getResourceByName(name);\t\t\t\tif(text === null)\t\t\t\t{\t\t\t\t\ttext = FileSystem.readFile(name, true);\t\t\t\t\tif(text !== null)\t\t\t\t\t{\t\t\t\t\t\tnew Function(text).call(this);\t\t\t\t\t}\t\t\t\t\telse\t\t\t\t\t{\t\t\t\t\t\tconsole.warn("nunuStudio: Javascript file " + name + " not found.");\t\t\t\t\t}\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\tnew Function(text.data).call(this);\t\t\t\t}\t\t\t}';else if(this.mode===Sn.INCLUDE){y=Sn.getIncludes(a),a=Sn.removeIncludes(a);var R=0,O=[];for(h=0;h<y.length;h++){var T=this.program.getResourceByName(y[h]);if(null!==T){var U=new Blob([T.data],{type:"text/plain"});O.push(URL.createObjectURL(U))}else{var ee=Rn.readFile(y[h],!0);if(null===ee)throw new Error("Script include() library "+y[h]+" not found.");U=new Blob([ee],{type:"text/plain"}),O.push(URL.createObjectURL(U))}}if(O.length>0)for(h=0;h<O.length;h++){var ie=document.createElement("script");ie.type="text/javascript",ie.async=!0,ie.src=url,ie.onload=function(){++R===O.length&&void 0!==r&&r()},ie.onerror=ie.onload,document.body.appendChild(ie)}else void 0!==r&&r()}var ne=new Function("__context__","for(var p in __context__){eval('var ' + p + ' = __context__[p];');}"+a);try{var ve=this.createContextObject();this.script=new ne(ve)}catch(be){throw this.script={},console.warn("nunuStudio: Error initializing script code",be),new Error("Error initializing script code")}this.mode!==Sn.INCLUDE&&r()}catch(be){throw this.script={},console.warn("nunuStudio: Error compiling script code",be),new Error("Error compiling script code")}},Sn.prototype.createContextObject=function(){var a={};Object.assign(a,n),Object.assign(a,l),Object.assign(a,o);var r={};for(var h of["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"])r[h]=window.Math[h];return Object.assign(r,l.Math),Object.assign(a,{self:this,program:this.program,scene:this.scene,THREE:l,CANNON:n,Math:r,Keyboard:this.program.keyboard,Mouse:this.program.mouse}),a},Sn.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r.object.mode=this.mode,r},(Hn.prototype=Object.create(l.SkinnedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Hn.prototype.toJSON=function(a){var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(p,y){null!==r.skeleton&&(void 0===p.skeletons[r.skeleton.uuid]&&(p.skeletons[r.skeleton.uuid]=r.skeleton.toJSON(p)),y.skeleton=r.skeleton.uuid)});return void 0!==this.bindMode&&(h.object.bindMode=this.bindMode),void 0!==this.bindMatrix&&(h.object.bindMatrix=this.bindMatrix.toArray()),h};const Cr="uniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float offset;\nuniform float exponent;\nvarying vec3 vWorldPosition;\n\nvoid main()\n{\n\tfloat h = normalize(vWorldPosition + offset).y;\n\tgl_FragColor = vec4(mix(bottomColor, topColor, max(pow(max(h , 0.0), exponent), 0.0)), 1.0);\n}\n",Ur="varying vec3 vWorldPosition;\n\nvoid main()\n{\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\tvWorldPosition = worldPosition.xyz;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}";function Lr(a,r,h,p){l.Group.call(this),this.name="sky",this.type="Sky",this.colorTop=[new l.Color(7844859),new l.Color(30463),new l.Color(220086),new l.Color(9273)],this.colorBottom=[new l.Color(15461606),new l.Color(16777215),new l.Color(16705495),new l.Color(26023)],this.sunColor=16777130,this.intensity=.3,this.moonColor=5592507,this.hemisphere=new l.HemisphereLight(3310847,16764031,.5),this.hemisphere.locked=!0,this.hemisphere.matrixAutoUpdate=!1,this.add(this.hemisphere),this.sun=new ml(this.sunColor,this.intensity),this.sun.castShadow=!0,this.sun.locked=!0,this.add(this.sun);var y={topColor:{type:"c",value:new l.Color(0,.46,1)},bottomColor:{type:"c",value:new l.Color(1,1,1)},offset:{type:"f",value:20},exponent:{type:"f",value:.2}};y.topColor.value.copy(this.hemisphere.color);var b=new l.SphereBufferGeometry(1500,16,16),R=new l.ShaderMaterial({vertexShader:Ur,fragmentShader:Cr,uniforms:y,side:l.BackSide});this.sky=new l.Mesh(b,R),this.sky.locked=!0,this.sky.matrixAutoUpdate=!1,this.add(this.sky),this.sky.raycast=function(){return null},this.autoUpdate=void 0===a||a,this.sunDistance=void 0!==h?h:100,this.dayTime=void 0!==r?r:120,this.time=void 0!==p?p:75,this.updateSky()}(Lr.prototype=Object.create(l.Group.prototype)).initialize=function(){this.updateSky(),l.Object3D.prototype.initialize.call(this)},Lr.prototype.update=function(a){this.autoUpdate&&(this.time+=a,this.time>this.dayTime&&(this.time-=this.dayTime),this.updateSky()),l.Object3D.prototype.update.call(this,a)},Lr.prototype.updateSky=function(){var a=this.time/this.dayTime;if(a<.25)this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b);else if(a<.292){var r=1-(h=23.81*(a-.25));this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[3].r+h*this.colorTop[0].r,r*this.colorTop[3].g+h*this.colorTop[0].g,r*this.colorTop[3].b+h*this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[3].r+h*this.colorBottom[0].r,r*this.colorBottom[3].g+h*this.colorBottom[0].g,r*this.colorBottom[3].b+h*this.colorBottom[0].b)}else a<.4167?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[0].r,this.colorTop[0].g,this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[0].r,this.colorBottom[0].g,this.colorBottom[0].b)):a<.5?(r=1-(h=12*(a-.4167)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[0].r+h*this.colorTop[1].r,r*this.colorTop[0].g+h*this.colorTop[1].g,r*this.colorTop[0].b+h*this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[0].r+h*this.colorBottom[1].r,r*this.colorBottom[0].g+h*this.colorBottom[1].g,r*this.colorBottom[0].b+h*this.colorBottom[1].b)):a<.708?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[1].r,this.colorTop[1].g,this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[1].r,this.colorBottom[1].g,this.colorBottom[1].b)):a<.75?(r=1-(h=23.81*(a-.708)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[1].r+h*this.colorTop[2].r,r*this.colorTop[1].g+h*this.colorTop[2].g,r*this.colorTop[1].b+h*this.colorTop[2].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[1].r+h*this.colorBottom[2].r,r*this.colorBottom[1].g+h*this.colorBottom[2].g,r*this.colorBottom[1].b+h*this.colorBottom[2].b)):a<.8333?(r=1-(h=12.048*(a-.75)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[2].r+h*this.colorTop[3].r,r*this.colorTop[2].g+h*this.colorTop[3].g,r*this.colorTop[2].b+h*this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[2].r+h*this.colorBottom[3].r,r*this.colorBottom[2].g+h*this.colorBottom[3].g,r*this.colorBottom[2].b+h*this.colorBottom[3].b)):(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b));if(a<.2)this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);else if(a<.3)r=1-(h=10*(a-.2)),h<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.moonColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.sunColor));else if(a<.7)this.sun.intensity=this.intensity,this.sun.color.setHex(this.sunColor);else if(a<.8){var h;(h=10*(a-.7))<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.sunColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.moonColor))}else this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);var p=Qc.PI2*a-Qc.PID2;a>.25&&a<.75?(this.sun.position.x=this.sunDistance*Math.cos(p),this.sun.position.y=this.sunDistance*Math.sin(p)):(this.sun.position.x=this.sunDistance*Math.cos(p+Math.PI),this.sun.position.y=this.sunDistance*Math.sin(p+Math.PI))},Lr.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.colorTop=[];for(var h=0;h<this.colorTop.length;h++)r.object.colorTop.push(this.colorTop[h].toJSON());for(r.object.colorBottom=[],h=0;h<this.colorBottom.length;h++)r.object.colorBottom.push(this.colorBottom[h].toJSON());return r.object.sunColor=this.sunColor,r.object.moonColor=this.moonColor,r.object.intensity=this.intensity,r.object.autoUpdate=this.autoUpdate,r.object.sunDistance=this.sunDistance,r.object.dayTime=this.dayTime,r.object.time=this.time,r.object.sun={},r.object.sun.castShadow=this.sun.castShadow,r.object.sun.shadow=this.sun.shadow.toJSON(),r};var Qt,Ao,Pc,ic=__webpack_require__(175);if(ic){let a=window.require;window.require=r=>a?a(r):"three"===r?ic:void 0}class el{constructor(){this.entries={},this.size=0}add(r){let h=this.entries[r];return this.entries[r]=!0,!h&&(this.size++,!0)}addAll(r){let h=this.size;for(var p=0,y=r.length;p<y;p++)this.add(r[p]);return h!=this.size}contains(r){return this.entries[r]}clear(){this.entries={},this.size=0}}class Qr{constructor(r=0,h=0,p=0,y=0){this.r=r,this.g=h,this.b=p,this.a=y}set(r,h,p,y){return this.r=r,this.g=h,this.b=p,this.a=y,this.clamp()}setFromColor(r){return this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this}setFromString(r){return r="#"==r.charAt(0)?r.substr(1):r,this.r=parseInt(r.substr(0,2),16)/255,this.g=parseInt(r.substr(2,2),16)/255,this.b=parseInt(r.substr(4,2),16)/255,this.a=8!=r.length?1:parseInt(r.substr(6,2),16)/255,this}add(r,h,p,y){return this.r+=r,this.g+=h,this.b+=p,this.a+=y,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(r,h){r.r=((4278190080&h)>>>24)/255,r.g=((16711680&h)>>>16)/255,r.b=((65280&h)>>>8)/255,r.a=(255&h)/255}static rgb888ToColor(r,h){r.r=((16711680&h)>>>16)/255,r.g=((65280&h)>>>8)/255,r.b=(255&h)/255}static fromString(r){return(new Qr).setFromString(r)}}Qr.WHITE=new Qr(1,1,1,1),Qr.RED=new Qr(1,0,0,1),Qr.GREEN=new Qr(0,1,0,1),Qr.BLUE=new Qr(0,0,1,1),Qr.MAGENTA=new Qr(1,0,1,1);class Cn{static clamp(r,h,p){return r<h?h:r>p?p:r}static cosDeg(r){return Math.cos(r*Cn.degRad)}static sinDeg(r){return Math.sin(r*Cn.degRad)}static signum(r){return r>0?1:r<0?-1:0}static toInt(r){return r>0?Math.floor(r):Math.ceil(r)}static cbrt(r){let h=Math.pow(Math.abs(r),.3333333333333333);return r<0?-h:h}static randomTriangular(r,h){return Cn.randomTriangularWith(r,h,.5*(r+h))}static randomTriangularWith(r,h,p){let y=Math.random(),b=h-r;return y<=(p-r)/b?r+Math.sqrt(y*b*(p-r)):h-Math.sqrt((1-y)*b*(h-p))}static isPowerOfTwo(r){return r&&0==(r&r-1)}}Cn.PI=3.1415927,Cn.PI2=2*Cn.PI,Cn.radiansToDegrees=180/Cn.PI,Cn.radDeg=Cn.radiansToDegrees,Cn.degreesToRadians=Cn.PI/180,Cn.degRad=Cn.degreesToRadians;class Id{apply(r,h,p){return r+(h-r)*this.applyInternal(p)}}class Cm extends Id{constructor(r){super(),this.power=2,this.power=r}applyInternal(r){return r<=.5?Math.pow(2*r,this.power)/2:Math.pow(2*(r-1),this.power)/(this.power%2==0?-2:2)+1}}class gr{static arrayCopy(r,h,p,y,b){for(let R=h,O=y;R<h+b;R++,O++)p[O]=r[R]}static arrayFill(r,h,p,y){for(let b=h;b<p;b++)r[b]=y}static setArraySize(r,h,p=0){let y=r.length;if(y==h)return r;if(r.length=h,y<h)for(let b=y;b<h;b++)r[b]=p;return r}static ensureArrayCapacity(r,h,p=0){return r.length>=h?r:gr.setArraySize(r,h,p)}static newArray(r,h){let p=new Array(r);for(let y=0;y<r;y++)p[y]=h;return p}static newFloatArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Float32Array(r);{let h=new Array(r);for(let p=0;p<h.length;p++)h[p]=0;return h}}static newShortArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Int16Array(r);{let h=new Array(r);for(let p=0;p<h.length;p++)h[p]=0;return h}}static toFloatArray(r){return gr.SUPPORTS_TYPED_ARRAYS?new Float32Array(r):r}static toSinglePrecision(r){return gr.SUPPORTS_TYPED_ARRAYS?Math.fround(r):r}static webkit602BugfixHelper(r,h){}static contains(r,h,p=!0){for(var y=0;y<r.length;y++)if(r[y]==h)return!0;return!1}static enumValue(r,h){return r[h[0].toUpperCase()+h.slice(1)]}}gr.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class rf{constructor(r){this.items=new Array,this.instantiator=r}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(r){r.reset&&r.reset(),this.items.push(r)}freeAll(r){for(let h=0;h<r.length;h++)this.free(r[h])}clear(){this.items.length=0}}class of{constructor(r=0,h=0){this.x=r,this.y=h}set(r,h){return this.x=r,this.y=h,this}length(){let r=this.x,h=this.y;return Math.sqrt(r*r+h*h)}normalize(){let r=this.length();return 0!=r&&(this.x/=r,this.y/=r),this}}class Af{constructor(r){if(!r)throw new Error("name cannot be null.");this.name=r}}class Au extends Af{constructor(r){super(r),this.id=Au.nextID++,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVertices(r,h,p,y,b,R){p=b+(p>>1)*R;let O=r.bone.skeleton,T=r.deform,U=this.vertices,ee=this.bones;if(!ee){T.length>0&&(U=T);let be=r.bone,Te=be.worldX,Le=be.worldY,Ie=be.a,Oe=be.b,Fe=be.c,je=be.d;for(let Ue=h,Je=b;Je<p;Ue+=2,Je+=R){let pt=U[Ue],at=U[Ue+1];y[Je]=pt*Ie+at*Oe+Te,y[Je+1]=pt*Fe+at*je+Le}return}let ie=0,ne=0;for(let be=0;be<h;be+=2){let Te=ee[ie];ie+=Te+1,ne+=Te}let ve=O.bones;if(0==T.length)for(let be=b,Te=3*ne;be<p;be+=R){let Le=0,Ie=0,Oe=ee[ie++];for(Oe+=ie;ie<Oe;ie++,Te+=3){let Fe=ve[ee[ie]],je=U[Te],Ue=U[Te+1],Je=U[Te+2];Le+=(je*Fe.a+Ue*Fe.b+Fe.worldX)*Je,Ie+=(je*Fe.c+Ue*Fe.d+Fe.worldY)*Je}y[be]=Le,y[be+1]=Ie}else{let be=T;for(let Te=b,Le=3*ne,Ie=ne<<1;Te<p;Te+=R){let Oe=0,Fe=0,je=ee[ie++];for(je+=ie;ie<je;ie++,Le+=3,Ie+=2){let Ue=ve[ee[ie]],Je=U[Le]+be[Ie],pt=U[Le+1]+be[Ie+1],at=U[Le+2];Oe+=(Je*Ue.a+pt*Ue.b+Ue.worldX)*at,Fe+=(Je*Ue.c+pt*Ue.d+Ue.worldY)*at}y[Te]=Oe,y[Te+1]=Fe}}}copyTo(r){this.bones?(r.bones=new Array(this.bones.length),gr.arrayCopy(this.bones,0,r.bones,0,this.bones.length)):r.bones=null,this.vertices?(r.vertices=gr.newFloatArray(this.vertices.length),gr.arrayCopy(this.vertices,0,r.vertices,0,this.vertices.length)):r.vertices=null,r.worldVerticesLength=this.worldVerticesLength,r.deformAttachment=this.deformAttachment}}Au.nextID=0;class $f{constructor(r,h,p){if(!r)throw new Error("name cannot be null.");this.name=r,this.setTimelines(h),this.duration=p}setTimelines(r){if(!r)throw new Error("timelines cannot be null.");this.timelines=r,this.timelineIds=new el;for(var h=0;h<r.length;h++)this.timelineIds.addAll(r[h].getPropertyIds())}hasTimeline(r){for(let h=0;h<r.length;h++)if(this.timelineIds.contains(r[h]))return!0;return!1}apply(r,h,p,y,b,R,O,T){if(!r)throw new Error("skeleton cannot be null.");y&&0!=this.duration&&(p%=this.duration,h>0&&(h%=this.duration));let U=this.timelines;for(let ee=0,ie=U.length;ee<ie;ee++)U[ee].apply(r,h,p,b,R,O,T)}}(function(a){a[a.setup=0]="setup",a[a.first=1]="first",a[a.replace=2]="replace",a[a.add=3]="add"})(Qt||(Qt={})),function(a){a[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut"}(Ao||(Ao={}));class xa{constructor(r,h){this.propertyIds=h,this.frames=gr.newFloatArray(r*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(r,h){let p=r.length;for(let y=1;y<p;y++)if(r[y]>h)return y-1;return p-1}static search(r,h,p){let y=r.length;for(let b=p;b<y;b+=p)if(r[b]>h)return b-p;return y-p}}class oc extends xa{constructor(r,h,p){super(r,p),this.curves=gr.newFloatArray(r+18*h),this.curves[r-1]=1}setLinear(r){this.curves[r]=0}setStepped(r){this.curves[r]=1}shrink(r){let h=this.getFrameCount()+18*r;if(this.curves.length>h){let p=gr.newFloatArray(h);gr.arrayCopy(this.curves,0,p,0,h),this.curves=p}}setBezier(r,h,p,y,b,R,O,T,U,ee,ie){let ne=this.curves,ve=this.getFrameCount()+18*r;0==p&&(ne[h]=2+ve);let be=.03*(y-2*R+T),Te=.03*(b-2*O+U),Le=.006*(3*(R-T)-y+ee),Ie=.006*(3*(O-U)-b+ie),Oe=2*be+Le,Fe=2*Te+Ie,je=.3*(R-y)+be+.16666667*Le,Ue=.3*(O-b)+Te+.16666667*Ie,Je=y+je,pt=b+Ue;for(let at=ve+18;ve<at;ve+=2)ne[ve]=Je,ne[ve+1]=pt,je+=Oe,Ue+=Fe,Oe+=Le,Fe+=Ie,Je+=je,pt+=Ue}getBezierValue(r,h,p,y){let b=this.curves;if(b[y]>r){let U=this.frames[h],ee=this.frames[h+p];return ee+(r-U)/(b[y]-U)*(b[y+1]-ee)}let R=y+18;for(y+=2;y<R;y+=2)if(b[y]>=r){let U=b[y-2],ee=b[y-1];return ee+(r-U)/(b[y]-U)*(b[y+1]-ee)}h+=this.getFrameEntries();let O=b[R-2],T=b[R-1];return T+(r-O)/(this.frames[h]-O)*(this.frames[h+p]-T)}}class ys extends oc{constructor(r,h,p){super(r,h,[p])}getFrameEntries(){return 2}setFrame(r,h,p){this.frames[r<<=1]=h,this.frames[r+1]=p}getCurveValue(r){let h=this.frames,p=h.length-2;for(let b=2;b<=p;b+=2)if(h[b]>r){p=b-2;break}let y=this.curves[p>>1];switch(y){case 0:let b=h[p],R=h[p+1];return R+(r-b)/(h[p+2]-b)*(h[p+2+1]-R);case 1:return h[p+1]}return this.getBezierValue(r,p,1,y-2)}}class tl extends oc{constructor(r,h,p,y){super(r,h,[p,y])}getFrameEntries(){return 3}setFrame(r,h,p,y){this.frames[r*=3]=h,this.frames[r+1]=p,this.frames[r+2]=y}}class sf extends ys{constructor(r,h,p){super(r,h,"0|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.rotation=T.data.rotation);case Qt.first:T.rotation+=(T.data.rotation-T.rotation)*b}return}let U=this.getCurveValue(p);switch(R){case Qt.setup:T.rotation=T.data.rotation+U*b;break;case Qt.first:case Qt.replace:U+=T.data.rotation-T.rotation;case Qt.add:T.rotation+=U*b}}}class Vf extends tl{constructor(r,h,p){super(r,h,"1|"+p,"2|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;let U=this.frames;if(p<U[0]){switch(R){case Qt.setup:return T.x=T.data.x,void(T.y=T.data.y);case Qt.first:T.x+=(T.data.x-T.x)*b,T.y+=(T.data.y-T.y)*b}return}let ee=0,ie=0,ne=xa.search(U,p,3),ve=this.curves[ne/3];switch(ve){case 0:let be=U[ne];ee=U[ne+1],ie=U[ne+2];let Te=(p-be)/(U[ne+3]-be);ee+=(U[ne+3+1]-ee)*Te,ie+=(U[ne+3+2]-ie)*Te;break;case 1:ee=U[ne+1],ie=U[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),ie=this.getBezierValue(p,ne,2,ve+18-2)}switch(R){case Qt.setup:T.x=T.data.x+ee*b,T.y=T.data.y+ie*b;break;case Qt.first:case Qt.replace:T.x+=(T.data.x+ee-T.x)*b,T.y+=(T.data.y+ie-T.y)*b;break;case Qt.add:T.x+=ee*b,T.y+=ie*b}}}class Wf extends ys{constructor(r,h,p){super(r,h,"1|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.x=T.data.x);case Qt.first:T.x+=(T.data.x-T.x)*b}return}let U=this.getCurveValue(p);switch(R){case Qt.setup:T.x=T.data.x+U*b;break;case Qt.first:case Qt.replace:T.x+=(T.data.x+U-T.x)*b;break;case Qt.add:T.x+=U*b}}}class Cf extends ys{constructor(r,h,p){super(r,h,"2|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.y=T.data.y);case Qt.first:T.y+=(T.data.y-T.y)*b}return}let U=this.getCurveValue(p);switch(R){case Qt.setup:T.y=T.data.y+U*b;break;case Qt.first:case Qt.replace:T.y+=(T.data.y+U-T.y)*b;break;case Qt.add:T.y+=U*b}}}class qf extends tl{constructor(r,h,p){super(r,h,"3|"+p,"4|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;let U,ee,ie=this.frames;if(p<ie[0]){switch(R){case Qt.setup:return T.scaleX=T.data.scaleX,void(T.scaleY=T.data.scaleY);case Qt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b,T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let ne=xa.search(ie,p,3),ve=this.curves[ne/3];switch(ve){case 0:let be=ie[ne];U=ie[ne+1],ee=ie[ne+2];let Te=(p-be)/(ie[ne+3]-be);U+=(ie[ne+3+1]-U)*Te,ee+=(ie[ne+3+2]-ee)*Te;break;case 1:U=ie[ne+1],ee=ie[ne+2];break;default:U=this.getBezierValue(p,ne,1,ve-2),ee=this.getBezierValue(p,ne,2,ve+18-2)}if(U*=T.data.scaleX,ee*=T.data.scaleY,1==b)R==Qt.add?(T.scaleX+=U-T.data.scaleX,T.scaleY+=ee-T.data.scaleY):(T.scaleX=U,T.scaleY=ee);else{let be=0,Te=0;if(O==Ao.mixOut)switch(R){case Qt.setup:be=T.data.scaleX,Te=T.data.scaleY,T.scaleX=be+(Math.abs(U)*Cn.signum(be)-be)*b,T.scaleY=Te+(Math.abs(ee)*Cn.signum(Te)-Te)*b;break;case Qt.first:case Qt.replace:be=T.scaleX,Te=T.scaleY,T.scaleX=be+(Math.abs(U)*Cn.signum(be)-be)*b,T.scaleY=Te+(Math.abs(ee)*Cn.signum(Te)-Te)*b;break;case Qt.add:T.scaleX=(U-T.data.scaleX)*b,T.scaleY=(ee-T.data.scaleY)*b}else switch(R){case Qt.setup:be=Math.abs(T.data.scaleX)*Cn.signum(U),Te=Math.abs(T.data.scaleY)*Cn.signum(ee),T.scaleX=be+(U-be)*b,T.scaleY=Te+(ee-Te)*b;break;case Qt.first:case Qt.replace:be=Math.abs(T.scaleX)*Cn.signum(U),Te=Math.abs(T.scaleY)*Cn.signum(ee),T.scaleX=be+(U-be)*b,T.scaleY=Te+(ee-Te)*b;break;case Qt.add:T.scaleX+=(U-T.data.scaleX)*b,T.scaleY+=(ee-T.data.scaleY)*b}}}}class Lm extends ys{constructor(r,h,p){super(r,h,"3|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.scaleX=T.data.scaleX);case Qt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b}return}let U=this.getCurveValue(p)*T.data.scaleX;if(1==b)R==Qt.add?T.scaleX+=U-T.data.scaleX:T.scaleX=U;else{let ee=0;if(O==Ao.mixOut)switch(R){case Qt.setup:ee=T.data.scaleX,T.scaleX=ee+(Math.abs(U)*Cn.signum(ee)-ee)*b;break;case Qt.first:case Qt.replace:ee=T.scaleX,T.scaleX=ee+(Math.abs(U)*Cn.signum(ee)-ee)*b;break;case Qt.add:T.scaleX=(U-T.data.scaleX)*b}else switch(R){case Qt.setup:ee=Math.abs(T.data.scaleX)*Cn.signum(U),T.scaleX=ee+(U-ee)*b;break;case Qt.first:case Qt.replace:ee=Math.abs(T.scaleX)*Cn.signum(U),T.scaleX=ee+(U-ee)*b;break;case Qt.add:T.scaleX+=(U-T.data.scaleX)*b}}}}class Bp extends ys{constructor(r,h,p){super(r,h,"4|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.scaleY=T.data.scaleY);case Qt.first:T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let U=this.getCurveValue(p)*T.data.scaleY;if(1==b)R==Qt.add?T.scaleY+=U-T.data.scaleY:T.scaleY=U;else{let ee=0;if(O==Ao.mixOut)switch(R){case Qt.setup:ee=T.data.scaleY,T.scaleY=ee+(Math.abs(U)*Cn.signum(ee)-ee)*b;break;case Qt.first:case Qt.replace:ee=T.scaleY,T.scaleY=ee+(Math.abs(U)*Cn.signum(ee)-ee)*b;break;case Qt.add:T.scaleY=(U-T.data.scaleY)*b}else switch(R){case Qt.setup:ee=Math.abs(T.data.scaleY)*Cn.signum(U),T.scaleY=ee+(U-ee)*b;break;case Qt.first:case Qt.replace:ee=Math.abs(T.scaleY)*Cn.signum(U),T.scaleY=ee+(U-ee)*b;break;case Qt.add:T.scaleY+=(U-T.data.scaleY)*b}}}}class Xf extends tl{constructor(r,h,p){super(r,h,"5|"+p,"6|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;let U=this.frames;if(p<U[0]){switch(R){case Qt.setup:return T.shearX=T.data.shearX,void(T.shearY=T.data.shearY);case Qt.first:T.shearX+=(T.data.shearX-T.shearX)*b,T.shearY+=(T.data.shearY-T.shearY)*b}return}let ee=0,ie=0,ne=xa.search(U,p,3),ve=this.curves[ne/3];switch(ve){case 0:let be=U[ne];ee=U[ne+1],ie=U[ne+2];let Te=(p-be)/(U[ne+3]-be);ee+=(U[ne+3+1]-ee)*Te,ie+=(U[ne+3+2]-ie)*Te;break;case 1:ee=U[ne+1],ie=U[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),ie=this.getBezierValue(p,ne,2,ve+18-2)}switch(R){case Qt.setup:T.shearX=T.data.shearX+ee*b,T.shearY=T.data.shearY+ie*b;break;case Qt.first:case Qt.replace:T.shearX+=(T.data.shearX+ee-T.shearX)*b,T.shearY+=(T.data.shearY+ie-T.shearY)*b;break;case Qt.add:T.shearX+=ee*b,T.shearY+=ie*b}}}class Bm extends ys{constructor(r,h,p){super(r,h,"5|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.shearX=T.data.shearX);case Qt.first:T.shearX+=(T.data.shearX-T.shearX)*b}return}let U=this.getCurveValue(p);switch(R){case Qt.setup:T.shearX=T.data.shearX+U*b;break;case Qt.first:case Qt.replace:T.shearX+=(T.data.shearX+U-T.shearX)*b;break;case Qt.add:T.shearX+=U*b}}}class Yf extends ys{constructor(r,h,p){super(r,h,"6|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,R,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.shearY=T.data.shearY);case Qt.first:T.shearY+=(T.data.shearY-T.shearY)*b}return}let U=this.getCurveValue(p);switch(R){case Qt.setup:T.shearY=T.data.shearY+U*b;break;case Qt.first:case Qt.replace:T.shearY+=(T.data.shearY+U-T.shearY)*b;break;case Qt.add:T.shearY+=U*b}}}class Jf extends oc{constructor(r,h,p){super(r,h,["7|"+p,"8|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 5}setFrame(r,h,p,y,b,R){this.frames[r*=5]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=this.frames,ee=T.color;if(p<U[0]){let Ie=T.data.color;switch(R){case Qt.setup:return void ee.setFromColor(Ie);case Qt.first:ee.add((Ie.r-ee.r)*b,(Ie.g-ee.g)*b,(Ie.b-ee.b)*b,(Ie.a-ee.a)*b)}return}let ie=0,ne=0,ve=0,be=0,Te=xa.search(U,p,5),Le=this.curves[Te/5];switch(Le){case 0:let Ie=U[Te];ie=U[Te+1],ne=U[Te+2],ve=U[Te+3],be=U[Te+4];let Oe=(p-Ie)/(U[Te+5]-Ie);ie+=(U[Te+5+1]-ie)*Oe,ne+=(U[Te+5+2]-ne)*Oe,ve+=(U[Te+5+3]-ve)*Oe,be+=(U[Te+5+4]-be)*Oe;break;case 1:ie=U[Te+1],ne=U[Te+2],ve=U[Te+3],be=U[Te+4];break;default:ie=this.getBezierValue(p,Te,1,Le-2),ne=this.getBezierValue(p,Te,2,Le+18-2),ve=this.getBezierValue(p,Te,3,Le+36-2),be=this.getBezierValue(p,Te,4,Le+54-2)}1==b?ee.set(ie,ne,ve,be):(R==Qt.setup&&ee.setFromColor(T.data.color),ee.add((ie-ee.r)*b,(ne-ee.g)*b,(ve-ee.b)*b,(be-ee.a)*b))}}class Od extends oc{constructor(r,h,p){super(r,h,["7|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 4}setFrame(r,h,p,y,b){this.frames[r<<=2]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=this.frames,ee=T.color;if(p<U[0]){let Le=T.data.color;switch(R){case Qt.setup:return ee.r=Le.r,ee.g=Le.g,void(ee.b=Le.b);case Qt.first:ee.r+=(Le.r-ee.r)*b,ee.g+=(Le.g-ee.g)*b,ee.b+=(Le.b-ee.b)*b}return}let ie=0,ne=0,ve=0,be=xa.search(U,p,4),Te=this.curves[be>>2];switch(Te){case 0:let Le=U[be];ie=U[be+1],ne=U[be+2],ve=U[be+3];let Ie=(p-Le)/(U[be+4]-Le);ie+=(U[be+4+1]-ie)*Ie,ne+=(U[be+4+2]-ne)*Ie,ve+=(U[be+4+3]-ve)*Ie;break;case 1:ie=U[be+1],ne=U[be+2],ve=U[be+3];break;default:ie=this.getBezierValue(p,be,1,Te-2),ne=this.getBezierValue(p,be,2,Te+18-2),ve=this.getBezierValue(p,be,3,Te+36-2)}if(1==b)ee.r=ie,ee.g=ne,ee.b=ve;else{if(R==Qt.setup){let Le=T.data.color;ee.r=Le.r,ee.g=Le.g,ee.b=Le.b}ee.r+=(ie-ee.r)*b,ee.g+=(ne-ee.g)*b,ee.b+=(ve-ee.b)*b}}}class Nm extends ys{constructor(r,h,p){super(r,h,"8|"+p),this.slotIndex=0,this.slotIndex=p}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=T.color;if(p<this.frames[0]){let ie=T.data.color;switch(R){case Qt.setup:return void(U.a=ie.a);case Qt.first:U.a+=(ie.a-U.a)*b}return}let ee=this.getCurveValue(p);1==b?U.a=ee:(R==Qt.setup&&(U.a=T.data.color.a),U.a+=(ee-U.a)*b)}}class Rm extends oc{constructor(r,h,p){super(r,h,["7|"+p,"8|"+p,"9|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 8}setFrame(r,h,p,y,b,R,O,T,U){this.frames[r<<=3]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R,this.frames[r+5]=O,this.frames[r+6]=T,this.frames[r+7]=U}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=this.frames,ee=T.color,ie=T.darkColor;if(p<U[0]){let Ue=T.data.color,Je=T.data.darkColor;switch(R){case Qt.setup:return ee.setFromColor(Ue),ie.r=Je.r,ie.g=Je.g,void(ie.b=Je.b);case Qt.first:ee.add((Ue.r-ee.r)*b,(Ue.g-ee.g)*b,(Ue.b-ee.b)*b,(Ue.a-ee.a)*b),ie.r+=(Je.r-ie.r)*b,ie.g+=(Je.g-ie.g)*b,ie.b+=(Je.b-ie.b)*b}return}let ne=0,ve=0,be=0,Te=0,Le=0,Ie=0,Oe=0,Fe=xa.search(U,p,8),je=this.curves[Fe>>3];switch(je){case 0:let Ue=U[Fe];ne=U[Fe+1],ve=U[Fe+2],be=U[Fe+3],Te=U[Fe+4],Le=U[Fe+5],Ie=U[Fe+6],Oe=U[Fe+7];let Je=(p-Ue)/(U[Fe+8]-Ue);ne+=(U[Fe+8+1]-ne)*Je,ve+=(U[Fe+8+2]-ve)*Je,be+=(U[Fe+8+3]-be)*Je,Te+=(U[Fe+8+4]-Te)*Je,Le+=(U[Fe+8+5]-Le)*Je,Ie+=(U[Fe+8+6]-Ie)*Je,Oe+=(U[Fe+8+7]-Oe)*Je;break;case 1:ne=U[Fe+1],ve=U[Fe+2],be=U[Fe+3],Te=U[Fe+4],Le=U[Fe+5],Ie=U[Fe+6],Oe=U[Fe+7];break;default:ne=this.getBezierValue(p,Fe,1,je-2),ve=this.getBezierValue(p,Fe,2,je+18-2),be=this.getBezierValue(p,Fe,3,je+36-2),Te=this.getBezierValue(p,Fe,4,je+54-2),Le=this.getBezierValue(p,Fe,5,je+72-2),Ie=this.getBezierValue(p,Fe,6,je+90-2),Oe=this.getBezierValue(p,Fe,7,je+108-2)}if(1==b)ee.set(ne,ve,be,Te),ie.r=Le,ie.g=Ie,ie.b=Oe;else{if(R==Qt.setup){ee.setFromColor(T.data.color);let Ue=T.data.darkColor;ie.r=Ue.r,ie.g=Ue.g,ie.b=Ue.b}ee.add((ne-ee.r)*b,(ve-ee.g)*b,(be-ee.b)*b,(Te-ee.a)*b),ie.r+=(Le-ie.r)*b,ie.g+=(Ie-ie.g)*b,ie.b+=(Oe-ie.b)*b}}}class kd extends oc{constructor(r,h,p){super(r,h,["7|"+p,"9|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 7}setFrame(r,h,p,y,b,R,O,T){this.frames[r*=7]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R,this.frames[r+5]=O,this.frames[r+6]=T}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=this.frames,ee=T.color,ie=T.darkColor;if(p<U[0]){let je=T.data.color,Ue=T.data.darkColor;switch(R){case Qt.setup:return ee.r=je.r,ee.g=je.g,ee.b=je.b,ie.r=Ue.r,ie.g=Ue.g,void(ie.b=Ue.b);case Qt.first:ee.r+=(je.r-ee.r)*b,ee.g+=(je.g-ee.g)*b,ee.b+=(je.b-ee.b)*b,ie.r+=(Ue.r-ie.r)*b,ie.g+=(Ue.g-ie.g)*b,ie.b+=(Ue.b-ie.b)*b}return}let ne=0,ve=0,be=0,Te=0,Le=0,Ie=0,Oe=xa.search(U,p,7),Fe=this.curves[Oe/7];switch(Fe){case 0:let je=U[Oe];ne=U[Oe+1],ve=U[Oe+2],be=U[Oe+3],Te=U[Oe+4],Le=U[Oe+5],Ie=U[Oe+6];let Ue=(p-je)/(U[Oe+7]-je);ne+=(U[Oe+7+1]-ne)*Ue,ve+=(U[Oe+7+2]-ve)*Ue,be+=(U[Oe+7+3]-be)*Ue,Te+=(U[Oe+7+4]-Te)*Ue,Le+=(U[Oe+7+5]-Le)*Ue,Ie+=(U[Oe+7+6]-Ie)*Ue;break;case 1:ne=U[Oe+1],ve=U[Oe+2],be=U[Oe+3],Te=U[Oe+4],Le=U[Oe+5],Ie=U[Oe+6];break;default:ne=this.getBezierValue(p,Oe,1,Fe-2),ve=this.getBezierValue(p,Oe,2,Fe+18-2),be=this.getBezierValue(p,Oe,3,Fe+36-2),Te=this.getBezierValue(p,Oe,4,Fe+54-2),Le=this.getBezierValue(p,Oe,5,Fe+72-2),Ie=this.getBezierValue(p,Oe,6,Fe+90-2)}if(1==b)ee.r=ne,ee.g=ve,ee.b=be,ie.r=Te,ie.g=Le,ie.b=Ie;else{if(R==Qt.setup){let je=T.data.color,Ue=T.data.darkColor;ee.r=je.r,ee.g=je.g,ee.b=je.b,ie.r=Ue.r,ie.g=Ue.g,ie.b=Ue.b}ee.r+=(ne-ee.r)*b,ee.g+=(ve-ee.g)*b,ee.b+=(be-ee.b)*b,ie.r+=(Te-ie.r)*b,ie.g+=(Le-ie.g)*b,ie.b+=(Ie-ie.b)*b}}}class dd extends xa{constructor(r,h){super(r,["10|"+h]),this.slotIndex=0,this.slotIndex=h,this.attachmentNames=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.attachmentNames[r]=p}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];T.bone.active&&(O!=Ao.mixOut?p<this.frames[0]?R!=Qt.setup&&R!=Qt.first||this.setAttachment(r,T,T.data.attachmentName):this.setAttachment(r,T,this.attachmentNames[xa.search1(this.frames,p)]):R==Qt.setup&&this.setAttachment(r,T,T.data.attachmentName))}setAttachment(r,h,p){h.setAttachment(p?r.getAttachment(this.slotIndex,p):null)}}class Zf extends oc{constructor(r,h,p,y){super(r,h,["11|"+p+"|"+y.id]),this.slotIndex=0,this.slotIndex=p,this.attachment=y,this.vertices=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.vertices[r]=p}setBezier(r,h,p,y,b,R,O,T,U,ee,ie){let ne=this.curves,ve=this.getFrameCount()+18*r;0==p&&(ne[h]=2+ve);let be=.03*(y-2*R+T),Te=.03*U-.06*O,Le=.006*(3*(R-T)-y+ee),Ie=.018*(O-U+.33333333),Oe=2*be+Le,Fe=2*Te+Ie,je=.3*(R-y)+be+.16666667*Le,Ue=.3*O+Te+.16666667*Ie,Je=y+je,pt=Ue;for(let at=ve+18;ve<at;ve+=2)ne[ve]=Je,ne[ve+1]=pt,je+=Oe,Ue+=Fe,Oe+=Le,Fe+=Ie,Je+=je,pt+=Ue}getCurvePercent(r,h){let p=this.curves,y=p[h];switch(y){case 0:let T=this.frames[h];return(r-T)/(this.frames[h+this.getFrameEntries()]-T);case 1:return 0}if(y-=2,p[y]>r){let T=this.frames[h];return p[y+1]*(r-T)/(p[y]-T)}let b=y+18;for(y+=2;y<b;y+=2)if(p[y]>=r){let T=p[y-2],U=p[y-1];return U+(r-T)/(p[y]-T)*(p[y+1]-U)}let R=p[b-2],O=p[b-1];return O+(1-O)*(r-R)/(this.frames[h+this.getFrameEntries()]-R)}apply(r,h,p,y,b,R,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let U=T.getAttachment();if(!(U instanceof Au)||U.deformAttachment!=this.attachment)return;let ee=T.deform;0==ee.length&&(R=Qt.setup);let ie=this.vertices,ne=ie[0].length,ve=this.frames;if(p<ve[0]){let Fe=U;switch(R){case Qt.setup:return void(ee.length=0);case Qt.first:if(1==b)return void(ee.length=0);if(ee.length=ne,Fe.bones)for(b=1-b,be=0;be<ne;be++)ee[be]*=b;else{let je=Fe.vertices;for(var be=0;be<ne;be++)ee[be]+=(je[be]-ee[be])*b}}return}if(ee.length=ne,p>=ve[ve.length-1]){let Fe=ie[ve.length-1];if(1==b)if(R==Qt.add){let je=U;if(je.bones)for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=Fe[Ue];else{let Ue=je.vertices;for(let Je=0;Je<ne;Je++)ee[Je]+=Fe[Je]-Ue[Je]}}else gr.arrayCopy(Fe,0,ee,0,ne);else switch(R){case Qt.setup:{let Ue=U;if(Ue.bones)for(let Je=0;Je<ne;Je++)ee[Je]=Fe[Je]*b;else{let Je=Ue.vertices;for(let pt=0;pt<ne;pt++){let at=Je[pt];ee[pt]=at+(Fe[pt]-at)*b}}break}case Qt.first:case Qt.replace:for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=(Fe[Ue]-ee[Ue])*b;break;case Qt.add:let je=U;if(je.bones)for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=Fe[Ue]*b;else{let Ue=je.vertices;for(let Je=0;Je<ne;Je++)ee[Je]+=(Fe[Je]-Ue[Je])*b}}return}let Te=xa.search1(ve,p),Le=this.getCurvePercent(p,Te),Ie=ie[Te],Oe=ie[Te+1];if(1==b)if(R==Qt.add){let Fe=U;if(Fe.bones)for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=Ue+(Oe[je]-Ue)*Le}else{let je=Fe.vertices;for(let Ue=0;Ue<ne;Ue++){let Je=Ie[Ue];ee[Ue]+=Je+(Oe[Ue]-Je)*Le-je[Ue]}}}else for(let Fe=0;Fe<ne;Fe++){let je=Ie[Fe];ee[Fe]=je+(Oe[Fe]-je)*Le}else switch(R){case Qt.setup:{let je=U;if(je.bones)for(let Ue=0;Ue<ne;Ue++){let Je=Ie[Ue];ee[Ue]=(Je+(Oe[Ue]-Je)*Le)*b}else{let Ue=je.vertices;for(let Je=0;Je<ne;Je++){let pt=Ie[Je],at=Ue[Je];ee[Je]=at+(pt+(Oe[Je]-pt)*Le-at)*b}}break}case Qt.first:case Qt.replace:for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=(Ue+(Oe[je]-Ue)*Le-ee[je])*b}break;case Qt.add:let Fe=U;if(Fe.bones)for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=(Ue+(Oe[je]-Ue)*Le)*b}else{let je=Fe.vertices;for(let Ue=0;Ue<ne;Ue++){let Je=Ie[Ue];ee[Ue]+=(Je+(Oe[Ue]-Je)*Le-je[Ue])*b}}}}}class Fd extends xa{constructor(r){super(r,Fd.propertyIds),this.events=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h){this.frames[r]=h.time,this.events[r]=h}apply(r,h,p,y,b,R,O){if(!y)return;let T=this.frames,U=this.frames.length;if(h>p)this.apply(r,h,Number.MAX_VALUE,y,b,R,O),h=-1;else if(h>=T[U-1])return;if(p<T[0])return;let ee=0;if(h<T[0])ee=0;else{ee=xa.search1(T,h)+1;let ie=T[ee];for(;ee>0&&T[ee-1]==ie;)ee--}for(;ee<U&&p>=T[ee];ee++)y.push(this.events[ee])}}Fd.propertyIds=["12"];class tp extends xa{constructor(r){super(r,tp.propertyIds),this.drawOrders=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.drawOrders[r]=p}apply(r,h,p,y,b,R,O){if(O==Ao.mixOut)return void(R==Qt.setup&&gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));if(p<this.frames[0])return void(R!=Qt.setup&&R!=Qt.first||gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));let T=this.drawOrders[xa.search1(this.frames,p)];if(T){let U=r.drawOrder,ee=r.slots;for(let ie=0,ne=T.length;ie<ne;ie++)U[ie]=ee[T[ie]]}else gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length)}}tp.propertyIds=["13"];class Pm extends oc{constructor(r,h,p){super(r,h,["14|"+p]),this.ikConstraintIndex=p}getFrameEntries(){return 6}setFrame(r,h,p,y,b,R,O){this.frames[r*=6]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R?1:0,this.frames[r+5]=O?1:0}apply(r,h,p,y,b,R,O){let T=r.ikConstraints[this.ikConstraintIndex];if(!T.active)return;let U=this.frames;if(p<U[0]){switch(R){case Qt.setup:return T.mix=T.data.mix,T.softness=T.data.softness,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,void(T.stretch=T.data.stretch);case Qt.first:T.mix+=(T.data.mix-T.mix)*b,T.softness+=(T.data.softness-T.softness)*b,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch}return}let ee=0,ie=0,ne=xa.search(U,p,6),ve=this.curves[ne/6];switch(ve){case 0:let be=U[ne];ee=U[ne+1],ie=U[ne+2];let Te=(p-be)/(U[ne+6]-be);ee+=(U[ne+6+1]-ee)*Te,ie+=(U[ne+6+2]-ie)*Te;break;case 1:ee=U[ne+1],ie=U[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),ie=this.getBezierValue(p,ne,2,ve+18-2)}R==Qt.setup?(T.mix=T.data.mix+(ee-T.data.mix)*b,T.softness=T.data.softness+(ie-T.data.softness)*b,O==Ao.mixOut?(T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch):(T.bendDirection=U[ne+3],T.compress=0!=U[ne+4],T.stretch=0!=U[ne+5])):(T.mix+=(ee-T.mix)*b,T.softness+=(ie-T.softness)*b,O==Ao.mixIn&&(T.bendDirection=U[ne+3],T.compress=0!=U[ne+4],T.stretch=0!=U[ne+5]))}}class Im extends oc{constructor(r,h,p){super(r,h,["15|"+p]),this.transformConstraintIndex=p}getFrameEntries(){return 7}setFrame(r,h,p,y,b,R,O,T){let U=this.frames;U[r*=7]=h,U[r+1]=p,U[r+2]=y,U[r+3]=b,U[r+4]=R,U[r+5]=O,U[r+6]=T}apply(r,h,p,y,b,R,O){let T=r.transformConstraints[this.transformConstraintIndex];if(!T.active)return;let U,ee,ie,ne,ve,be,Te=this.frames;if(p<Te[0]){let Oe=T.data;switch(R){case Qt.setup:return T.mixRotate=Oe.mixRotate,T.mixX=Oe.mixX,T.mixY=Oe.mixY,T.mixScaleX=Oe.mixScaleX,T.mixScaleY=Oe.mixScaleY,void(T.mixShearY=Oe.mixShearY);case Qt.first:T.mixRotate+=(Oe.mixRotate-T.mixRotate)*b,T.mixX+=(Oe.mixX-T.mixX)*b,T.mixY+=(Oe.mixY-T.mixY)*b,T.mixScaleX+=(Oe.mixScaleX-T.mixScaleX)*b,T.mixScaleY+=(Oe.mixScaleY-T.mixScaleY)*b,T.mixShearY+=(Oe.mixShearY-T.mixShearY)*b}return}let Le=xa.search(Te,p,7),Ie=this.curves[Le/7];switch(Ie){case 0:let Oe=Te[Le];U=Te[Le+1],ee=Te[Le+2],ie=Te[Le+3],ne=Te[Le+4],ve=Te[Le+5],be=Te[Le+6];let Fe=(p-Oe)/(Te[Le+7]-Oe);U+=(Te[Le+7+1]-U)*Fe,ee+=(Te[Le+7+2]-ee)*Fe,ie+=(Te[Le+7+3]-ie)*Fe,ne+=(Te[Le+7+4]-ne)*Fe,ve+=(Te[Le+7+5]-ve)*Fe,be+=(Te[Le+7+6]-be)*Fe;break;case 1:U=Te[Le+1],ee=Te[Le+2],ie=Te[Le+3],ne=Te[Le+4],ve=Te[Le+5],be=Te[Le+6];break;default:U=this.getBezierValue(p,Le,1,Ie-2),ee=this.getBezierValue(p,Le,2,Ie+18-2),ie=this.getBezierValue(p,Le,3,Ie+36-2),ne=this.getBezierValue(p,Le,4,Ie+54-2),ve=this.getBezierValue(p,Le,5,Ie+72-2),be=this.getBezierValue(p,Le,6,Ie+90-2)}if(R==Qt.setup){let Oe=T.data;T.mixRotate=Oe.mixRotate+(U-Oe.mixRotate)*b,T.mixX=Oe.mixX+(ee-Oe.mixX)*b,T.mixY=Oe.mixY+(ie-Oe.mixY)*b,T.mixScaleX=Oe.mixScaleX+(ne-Oe.mixScaleX)*b,T.mixScaleY=Oe.mixScaleY+(ve-Oe.mixScaleY)*b,T.mixShearY=Oe.mixShearY+(be-Oe.mixShearY)*b}else T.mixRotate+=(U-T.mixRotate)*b,T.mixX+=(ee-T.mixX)*b,T.mixY+=(ie-T.mixY)*b,T.mixScaleX+=(ne-T.mixScaleX)*b,T.mixScaleY+=(ve-T.mixScaleY)*b,T.mixShearY+=(be-T.mixShearY)*b}}class Om extends ys{constructor(r,h,p){super(r,h,"16|"+p),this.pathConstraintIndex=p}apply(r,h,p,y,b,R,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.position=T.data.position);case Qt.first:T.position+=(T.data.position-T.position)*b}return}let U=this.getCurveValue(p);R==Qt.setup?T.position=T.data.position+(U-T.data.position)*b:T.position+=(U-T.position)*b}}class Qf extends ys{constructor(r,h,p){super(r,h,"17|"+p),this.pathConstraintIndex=0,this.pathConstraintIndex=p}apply(r,h,p,y,b,R,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(p<this.frames[0]){switch(R){case Qt.setup:return void(T.spacing=T.data.spacing);case Qt.first:T.spacing+=(T.data.spacing-T.spacing)*b}return}let U=this.getCurveValue(p);R==Qt.setup?T.spacing=T.data.spacing+(U-T.data.spacing)*b:T.spacing+=(U-T.spacing)*b}}class km extends oc{constructor(r,h,p){super(r,h,["18|"+p]),this.pathConstraintIndex=0,this.pathConstraintIndex=p}getFrameEntries(){return 4}setFrame(r,h,p,y,b){let R=this.frames;R[r<<=2]=h,R[r+1]=p,R[r+2]=y,R[r+3]=b}apply(r,h,p,y,b,R,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;let U,ee,ie,ne=this.frames;if(p<ne[0]){switch(R){case Qt.setup:return T.mixRotate=T.data.mixRotate,T.mixX=T.data.mixX,void(T.mixY=T.data.mixY);case Qt.first:T.mixRotate+=(T.data.mixRotate-T.mixRotate)*b,T.mixX+=(T.data.mixX-T.mixX)*b,T.mixY+=(T.data.mixY-T.mixY)*b}return}let ve=xa.search(ne,p,4),be=this.curves[ve>>2];switch(be){case 0:let Te=ne[ve];U=ne[ve+1],ee=ne[ve+2],ie=ne[ve+3];let Le=(p-Te)/(ne[ve+4]-Te);U+=(ne[ve+4+1]-U)*Le,ee+=(ne[ve+4+2]-ee)*Le,ie+=(ne[ve+4+3]-ie)*Le;break;case 1:U=ne[ve+1],ee=ne[ve+2],ie=ne[ve+3];break;default:U=this.getBezierValue(p,ve,1,be-2),ee=this.getBezierValue(p,ve,2,be+18-2),ie=this.getBezierValue(p,ve,3,be+36-2)}if(R==Qt.setup){let Te=T.data;T.mixRotate=Te.mixRotate+(U-Te.mixRotate)*b,T.mixX=Te.mixX+(ee-Te.mixX)*b,T.mixY=Te.mixY+(ie-Te.mixY)*b}else T.mixRotate+=(U-T.mixRotate)*b,T.mixX+=(ee-T.mixX)*b,T.mixY+=(ie-T.mixY)*b}}class Dd{constructor(r){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Fm(this),this.propertyIDs=new el,this.animationsChanged=!1,this.trackEntryPool=new rf(()=>new Kf),this.data=r}static emptyAnimation(){return Bf||(Bf=new $f("<empty>",[],0)),Bf}update(r){r*=this.timeScale;let h=this.tracks;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(!b)continue;b.animationLast=b.nextAnimationLast,b.trackLast=b.nextTrackLast;let R=r*b.timeScale;if(b.delay>0){if(b.delay-=R,b.delay>0)continue;R=-b.delay,b.delay=0}let O=b.next;if(O){let T=b.trackLast-O.delay;if(T>=0){for(O.delay=0,O.trackTime+=0==b.timeScale?0:(T/b.timeScale+r)*O.timeScale,b.trackTime+=R,this.setCurrent(p,O,!0);O.mixingFrom;)O.mixTime+=r,O=O.mixingFrom;continue}}else if(b.trackLast>=b.trackEnd&&!b.mixingFrom){h[p]=null,this.queue.end(b),this.clearNext(b);continue}if(b.mixingFrom&&this.updateMixingFrom(b,r)){let T=b.mixingFrom;for(b.mixingFrom=null,T&&(T.mixingTo=null);T;)this.queue.end(T),T=T.mixingFrom}b.trackTime+=R}this.queue.drain()}updateMixingFrom(r,h){let p=r.mixingFrom;if(!p)return!0;let y=this.updateMixingFrom(p,h);return p.animationLast=p.nextAnimationLast,p.trackLast=p.nextTrackLast,r.mixTime>0&&r.mixTime>=r.mixDuration?(0!=p.totalAlpha&&0!=r.mixDuration||(r.mixingFrom=p.mixingFrom,p.mixingFrom&&(p.mixingFrom.mixingTo=r),r.interruptAlpha=p.interruptAlpha,this.queue.end(p)),y):(p.trackTime+=h*p.timeScale,r.mixTime+=h,!1)}apply(r){if(!r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let h=this.events,p=this.tracks,y=!1;for(let ne=0,ve=p.length;ne<ve;ne++){let be=p[ne];if(!be||be.delay>0)continue;y=!0;let Te=0==ne?Qt.first:be.mixBlend,Le=be.alpha;be.mixingFrom?Le*=this.applyMixingFrom(be,r,Te):be.trackTime>=be.trackEnd&&!be.next&&(Le=0);let Ie=be.animationLast,Oe=be.getAnimationTime(),Fe=Oe,je=h;be.reverse&&(Fe=be.animation.duration-Fe,je=null);let Ue=be.animation.timelines,Je=Ue.length;if(0==ne&&1==Le||Te==Qt.add)for(let pt=0;pt<Je;pt++){gr.webkit602BugfixHelper(Le,Te);var b=Ue[pt];b instanceof dd?this.applyAttachmentTimeline(b,r,Fe,Te,!0):b.apply(r,Ie,Fe,je,Le,Te,Ao.mixIn)}else{let pt=be.timelineMode,at=be.timelinesRotation.length!=Je<<1;at&&(be.timelinesRotation.length=Je<<1);for(let Mt=0;Mt<Je;Mt++){let Tt=Ue[Mt],Yt=pt[Mt]==Lf?Te:Qt.setup;Tt instanceof sf?this.applyRotateTimeline(Tt,r,Fe,Le,Yt,be.timelinesRotation,Mt<<1,at):Tt instanceof dd?this.applyAttachmentTimeline(Tt,r,Fe,Te,!0):(gr.webkit602BugfixHelper(Le,Te),Tt.apply(r,Ie,Fe,je,Le,Yt,Ao.mixIn))}}this.queueEvents(be,Oe),h.length=0,be.nextAnimationLast=Oe,be.nextTrackLast=be.trackTime}for(var R=this.unkeyedState+nm,O=r.slots,T=0,U=r.slots.length;T<U;T++){var ee=O[T];if(ee.attachmentState==R){var ie=ee.data.attachmentName;ee.setAttachment(ie?r.getAttachment(ee.data.index,ie):null)}}return this.unkeyedState+=2,this.queue.drain(),y}applyMixingFrom(r,h,p){let y=r.mixingFrom;y.mixingFrom&&this.applyMixingFrom(y,h,p);let b=0;0==r.mixDuration?(b=1,p==Qt.first&&(p=Qt.setup)):(b=r.mixTime/r.mixDuration,b>1&&(b=1),p!=Qt.first&&(p=y.mixBlend));let R=b<y.attachmentThreshold,O=b<y.drawOrderThreshold,T=y.animation.timelines,U=T.length,ee=y.alpha*r.interruptAlpha,ie=ee*(1-b),ne=y.animationLast,ve=y.getAnimationTime(),be=ve,Te=null;if(y.reverse?be=y.animation.duration-be:b<y.eventThreshold&&(Te=this.events),p==Qt.add)for(let Le=0;Le<U;Le++)T[Le].apply(h,ne,be,Te,ie,p,Ao.mixOut);else{let Le=y.timelineMode,Ie=y.timelineHoldMix,Oe=y.timelinesRotation.length!=U<<1;Oe&&(y.timelinesRotation.length=U<<1),y.totalAlpha=0;for(let Fe=0;Fe<U;Fe++){let je,Ue=T[Fe],Je=Ao.mixOut,pt=0;switch(Le[Fe]){case Lf:if(!O&&Ue instanceof tp)continue;je=p,pt=ie;break;case em:je=Qt.setup,pt=ie;break;case tm:je=p,pt=ee;break;case af:je=Qt.setup,pt=ee;break;default:je=Qt.setup;let at=Ie[Fe];pt=ee*Math.max(0,1-at.mixTime/at.mixDuration)}y.totalAlpha+=pt,Ue instanceof sf?this.applyRotateTimeline(Ue,h,be,pt,je,y.timelinesRotation,Fe<<1,Oe):Ue instanceof dd?this.applyAttachmentTimeline(Ue,h,be,je,R):(gr.webkit602BugfixHelper(pt,p),O&&Ue instanceof tp&&je==Qt.setup&&(Je=Ao.mixIn),Ue.apply(h,ne,be,Te,pt,je,Je))}}return r.mixDuration>0&&this.queueEvents(y,ve),this.events.length=0,y.nextAnimationLast=ve,y.nextTrackLast=y.trackTime,b}applyAttachmentTimeline(r,h,p,y,b){var R=h.slots[r.slotIndex];R.bone.active&&(p<r.frames[0]?y!=Qt.setup&&y!=Qt.first||this.setAttachment(h,R,R.data.attachmentName,b):this.setAttachment(h,R,r.attachmentNames[xa.search1(r.frames,p)],b),R.attachmentState<=this.unkeyedState&&(R.attachmentState=this.unkeyedState+nm))}setAttachment(r,h,p,y){h.setAttachment(p?r.getAttachment(h.data.index,p):null),y&&(h.attachmentState=this.unkeyedState+Um)}applyRotateTimeline(r,h,p,y,b,R,O,T){if(T&&(R[O]=0),1==y)return void r.apply(h,0,p,null,1,b,Ao.mixIn);let U=h.bones[r.boneIndex];if(!U.active)return;let ee=0,ie=0;if(p<r.frames[0])switch(b){case Qt.setup:U.rotation=U.data.rotation;default:return;case Qt.first:ee=U.rotation,ie=U.data.rotation}else ee=b==Qt.setup?U.data.rotation:U.rotation,ie=U.data.rotation+r.getCurveValue(p);let ne=0,ve=ie-ee;if(ve-=360*(16384-(16384.499999999996-ve/360|0)),0==ve)ne=R[O];else{let be=0,Te=0;T?(be=0,Te=ve):(be=R[O],Te=R[O+1]);let Le=ve>0,Ie=be>=0;Cn.signum(Te)!=Cn.signum(ve)&&Math.abs(Te)<=90&&(Math.abs(be)>180&&(be+=360*Cn.signum(be)),Ie=Le),ne=ve+be-be%360,Ie!=Le&&(ne+=360*Cn.signum(be)),R[O]=ne}R[O+1]=ve,U.rotation=ee+ne*y}queueEvents(r,h){let p=r.animationStart,y=r.animationEnd,b=y-p,R=r.trackLast%b,O=this.events,T=0,U=O.length;for(;T<U;T++){let ie=O[T];if(ie.time<R)break;ie.time>y||this.queue.event(r,ie)}let ee=!1;for(ee=r.loop?0==b||R>r.trackTime%b:h>=y&&r.animationLast<y,ee&&this.queue.complete(r);T<U;T++){let ie=O[T];ie.time<p||this.queue.event(r,ie)}}clearTracks(){let r=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let h=0,p=this.tracks.length;h<p;h++)this.clearTrack(h);this.tracks.length=0,this.queue.drainDisabled=r,this.queue.drain()}clearTrack(r){if(r>=this.tracks.length)return;let h=this.tracks[r];if(!h)return;this.queue.end(h),this.clearNext(h);let p=h;for(;;){let y=p.mixingFrom;if(!y)break;this.queue.end(y),p.mixingFrom=null,p.mixingTo=null,p=y}this.tracks[h.trackIndex]=null,this.queue.drain()}setCurrent(r,h,p){let y=this.expandToIndex(r);this.tracks[r]=h,h.previous=null,y&&(p&&this.queue.interrupt(y),h.mixingFrom=y,y.mixingTo=h,h.mixTime=0,y.mixingFrom&&y.mixDuration>0&&(h.interruptAlpha*=Math.min(1,y.mixTime/y.mixDuration)),y.timelinesRotation.length=0),this.queue.start(h)}setAnimation(r,h,p=!1){let y=this.data.skeletonData.findAnimation(h);if(!y)throw new Error("Animation not found: "+h);return this.setAnimationWith(r,y,p)}setAnimationWith(r,h,p=!1){if(!h)throw new Error("animation cannot be null.");let y=!0,b=this.expandToIndex(r);b&&(-1==b.nextTrackLast?(this.tracks[r]=b.mixingFrom,this.queue.interrupt(b),this.queue.end(b),this.clearNext(b),b=b.mixingFrom,y=!1):this.clearNext(b));let R=this.trackEntry(r,h,p,b);return this.setCurrent(r,R,y),this.queue.drain(),R}addAnimation(r,h,p=!1,y=0){let b=this.data.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);return this.addAnimationWith(r,b,p,y)}addAnimationWith(r,h,p=!1,y=0){if(!h)throw new Error("animation cannot be null.");let b=this.expandToIndex(r);if(b)for(;b.next;)b=b.next;let R=this.trackEntry(r,h,p,b);return b?(b.next=R,R.previous=b,y<=0&&(y+=b.getTrackComplete()-R.mixDuration)):(this.setCurrent(r,R,!0),this.queue.drain()),R.delay=y,R}setEmptyAnimation(r,h=0){let p=this.setAnimationWith(r,Dd.emptyAnimation(),!1);return p.mixDuration=h,p.trackEnd=h,p}addEmptyAnimation(r,h=0,p=0){let y=this.addAnimationWith(r,Dd.emptyAnimation(),!1,p);return p<=0&&(y.delay+=y.mixDuration-h),y.mixDuration=h,y.trackEnd=h,y}setEmptyAnimations(r=0){let h=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let p=0,y=this.tracks.length;p<y;p++){let b=this.tracks[p];b&&this.setEmptyAnimation(b.trackIndex,r)}this.queue.drainDisabled=h,this.queue.drain()}expandToIndex(r){return r<this.tracks.length?this.tracks[r]:(gr.ensureArrayCapacity(this.tracks,r+1,null),this.tracks.length=r+1,null)}trackEntry(r,h,p,y){let b=this.trackEntryPool.obtain();return b.trackIndex=r,b.animation=h,b.loop=p,b.holdPrevious=!1,b.eventThreshold=0,b.attachmentThreshold=0,b.drawOrderThreshold=0,b.animationStart=0,b.animationEnd=h.duration,b.animationLast=-1,b.nextAnimationLast=-1,b.delay=0,b.trackTime=0,b.trackLast=-1,b.nextTrackLast=-1,b.trackEnd=Number.MAX_VALUE,b.timeScale=1,b.alpha=1,b.interruptAlpha=1,b.mixTime=0,b.mixDuration=y?this.data.getMix(y.animation,h):0,b.mixBlend=Qt.replace,b}clearNext(r){let h=r.next;for(;h;)this.queue.dispose(h),h=h.next;r.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let r=this.tracks;for(let h=0,p=r.length;h<p;h++){let y=r[h];if(y){for(;y.mixingFrom;)y=y.mixingFrom;do{y.mixingTo&&y.mixBlend==Qt.add||this.computeHold(y),y=y.mixingTo}while(y)}}}computeHold(r){let h=r.mixingTo,p=r.animation.timelines,y=r.animation.timelines.length,b=r.timelineMode;b.length=y;let R=r.timelineHoldMix;R.length=0;let O=this.propertyIDs;if(h&&h.holdPrevious)for(let T=0;T<y;T++)b[T]=O.addAll(p[T].getPropertyIds())?af:tm;else e:for(let T=0;T<y;T++){let U=p[T],ee=U.getPropertyIds();if(O.addAll(ee))if(!h||U instanceof dd||U instanceof tp||U instanceof Fd||!h.animation.hasTimeline(ee))b[T]=em;else{for(let ie=h.mixingTo;ie;ie=ie.mixingTo)if(!ie.animation.hasTimeline(ee)){if(r.mixDuration>0){b[T]=Dm,R[T]=ie;continue e}break}b[T]=af}else b[T]=Lf}}getCurrent(r){return r>=this.tracks.length?null:this.tracks[r]}addListener(r){if(!r)throw new Error("listener cannot be null.");this.listeners.push(r)}removeListener(r){let h=this.listeners.indexOf(r);h>=0&&this.listeners.splice(h,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class Kf{constructor(){this.mixBlend=Qt.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let r=this.animationEnd-this.animationStart;return 0==r?this.animationStart:this.trackTime%r+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(r){this.animationLast=r,this.nextAnimationLast=r}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let r=this.animationEnd-this.animationStart;if(0!=r){if(this.loop)return r*(1+(this.trackTime/r|0));if(this.trackTime<r)return r}return this.trackTime}}class Fm{constructor(r){this.objects=[],this.drainDisabled=!1,this.animState=r}start(r){this.objects.push(Pc.start),this.objects.push(r),this.animState.animationsChanged=!0}interrupt(r){this.objects.push(Pc.interrupt),this.objects.push(r)}end(r){this.objects.push(Pc.end),this.objects.push(r),this.animState.animationsChanged=!0}dispose(r){this.objects.push(Pc.dispose),this.objects.push(r)}complete(r){this.objects.push(Pc.complete),this.objects.push(r)}event(r,h){this.objects.push(Pc.event),this.objects.push(r),this.objects.push(h)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let r=this.objects,h=this.animState.listeners;for(let p=0;p<r.length;p+=2){let b=r[p+1];switch(r[p]){case Pc.start:b.listener&&b.listener.start&&b.listener.start(b);for(let O=0;O<h.length;O++)h[O].start&&h[O].start(b);break;case Pc.interrupt:b.listener&&b.listener.interrupt&&b.listener.interrupt(b);for(let O=0;O<h.length;O++)h[O].interrupt&&h[O].interrupt(b);break;case Pc.end:b.listener&&b.listener.end&&b.listener.end(b);for(let O=0;O<h.length;O++)h[O].end&&h[O].end(b);case Pc.dispose:b.listener&&b.listener.dispose&&b.listener.dispose(b);for(let O=0;O<h.length;O++)h[O].dispose&&h[O].dispose(b);this.animState.trackEntryPool.free(b);break;case Pc.complete:b.listener&&b.listener.complete&&b.listener.complete(b);for(let O=0;O<h.length;O++)h[O].complete&&h[O].complete(b);break;case Pc.event:let R=r[2+p++];b.listener&&b.listener.event&&b.listener.event(b,R);for(let O=0;O<h.length;O++)h[O].event&&h[O].event(b,R)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}!function(a){a[a.start=0]="start",a[a.interrupt=1]="interrupt",a[a.end=2]="end",a[a.dispose=3]="dispose",a[a.complete=4]="complete",a[a.event=5]="event"}(Pc||(Pc={}));const Lf=0,em=1,tm=2,af=3,Dm=4,nm=1,Um=2;let Bf=null;class zm{constructor(r){if(this.animationToMixTime={},this.defaultMix=0,!r)throw new Error("skeletonData cannot be null.");this.skeletonData=r}setMix(r,h,p){let y=this.skeletonData.findAnimation(r);if(!y)throw new Error("Animation not found: "+r);let b=this.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);this.setMixWith(y,b,p)}setMixWith(r,h,p){if(!r)throw new Error("from cannot be null.");if(!h)throw new Error("to cannot be null.");this.animationToMixTime[r.name+"."+h.name]=p}getMix(r,h){let y=this.animationToMixTime[r.name+"."+h.name];return void 0===y?this.defaultMix:y}}class lf extends Au{constructor(r){super(r),this.color=new Qr(1,1,1,1)}copy(){let r=new lf(this.name);return this.copyTo(r),r.color.setFromColor(this.color),r}}class Ud extends Au{constructor(r){super(r),this.color=new Qr(.2275,.2275,.8078,1)}copy(){let r=new Ud(this.name);return this.copyTo(r),r.endSlot=this.endSlot,r.color.setFromColor(this.color),r}}class np{constructor(r){this._image=r}getImage(){return this._image}}var ta,Ch,Ic,sc,ac,fd,zd,md,wa,Np,cf;(function(a){a[a.Nearest=9728]="Nearest",a[a.Linear=9729]="Linear",a[a.MipMap=9987]="MipMap",a[a.MipMapNearestNearest=9984]="MipMapNearestNearest",a[a.MipMapLinearNearest=9985]="MipMapLinearNearest",a[a.MipMapNearestLinear=9986]="MipMapNearestLinear",a[a.MipMapLinearLinear=9987]="MipMapLinearLinear"})(ta||(ta={})),function(a){a[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat"}(Ch||(Ch={}));class jd{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}class _d{constructor(r){this.pages=new Array,this.regions=new Array;let h=new uf(r),p=new Array(4),y=null,b=null,R={size:()=>{y.width=parseInt(p[1]),y.height=parseInt(p[2])},format:()=>{},filter:()=>{y.minFilter=gr.enumValue(ta,p[1]),y.magFilter=gr.enumValue(ta,p[2])},repeat:()=>{-1!=p[1].indexOf("x")&&(y.uWrap=Ch.Repeat),-1!=p[1].indexOf("y")&&(y.vWrap=Ch.Repeat)},pma:()=>{y.pma="true"==p[1]}};var O={xy:()=>{b.x=parseInt(p[1]),b.y=parseInt(p[2])},size:()=>{b.width=parseInt(p[1]),b.height=parseInt(p[2])},bounds:()=>{b.x=parseInt(p[1]),b.y=parseInt(p[2]),b.width=parseInt(p[3]),b.height=parseInt(p[4])},offset:()=>{b.offsetX=parseInt(p[1]),b.offsetY=parseInt(p[2])},orig:()=>{b.originalWidth=parseInt(p[1]),b.originalHeight=parseInt(p[2])},offsets:()=>{b.offsetX=parseInt(p[1]),b.offsetY=parseInt(p[2]),b.originalWidth=parseInt(p[3]),b.originalHeight=parseInt(p[4])},rotate:()=>{let ie=p[1];"true"==ie?b.degrees=90:"false"!=ie&&(b.degrees=parseInt(ie))},index:()=>{b.index=parseInt(p[1])}};let T=h.readLine();for(;T&&0==T.trim().length;)T=h.readLine();for(;T&&0!=T.trim().length&&0!=h.readEntry(p,T);)T=h.readLine();let U=null,ee=null;for(;null!==T;)if(0==T.trim().length)y=null,T=h.readLine();else if(y){for(b=new Xp,b.page=y,b.name=T;;){let ie=h.readEntry(p,T=h.readLine());if(0==ie)break;let ne=O[p[0]];if(ne)ne();else{U||(U=[],ee=[]),U.push(p[0]);let ve=[];for(let be=0;be<ie;be++)ve.push(parseInt(p[be+1]));ee.push(ve)}}0==b.originalWidth&&0==b.originalHeight&&(b.originalWidth=b.width,b.originalHeight=b.height),U&&U.length>0&&(b.names=U,b.values=ee,U=null,ee=null),b.u=b.x/y.width,b.v=b.y/y.height,90==b.degrees?(b.u2=(b.x+b.height)/y.width,b.v2=(b.y+b.width)/y.height):(b.u2=(b.x+b.width)/y.width,b.v2=(b.y+b.height)/y.height),this.regions.push(b)}else{for(y=new hf,y.name=T.trim();0!=h.readEntry(p,T=h.readLine());){let ie=R[p[0]];ie&&ie()}this.pages.push(y)}}findRegion(r){for(let h=0;h<this.regions.length;h++)if(this.regions[h].name==r)return this.regions[h];return null}setTextures(r,h=""){for(let p of this.pages)p.setTexture(r.get(h+p.name))}dispose(){for(let r=0;r<this.pages.length;r++)this.pages[r].texture.dispose()}}class uf{constructor(r){this.index=0,this.lines=r.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(r,h){if(!h||0==(h=h.trim()).length)return 0;let p=h.indexOf(":");if(-1==p)return 0;r[0]=h.substr(0,p).trim();for(let y=1,b=p+1;;y++){let R=h.indexOf(",",b);if(-1==R)return r[y]=h.substr(b).trim(),y;if(r[y]=h.substr(b,R-b).trim(),b=R+1,4==y)return 4}}}class hf{constructor(){this.minFilter=ta.Nearest,this.magFilter=ta.Nearest,this.uWrap=Ch.ClampToEdge,this.vWrap=Ch.ClampToEdge}setTexture(r){this.texture=r,r.setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap)}}class Xp extends jd{}class Oa extends Au{constructor(r){super(r),this.color=new Qr(1,1,1,1),this.tempColor=new Qr(0,0,0,0)}updateUVs(){let r=this.regionUVs;this.uvs&&this.uvs.length==r.length||(this.uvs=gr.newFloatArray(r.length));let h=this.uvs,p=this.uvs.length,y=this.region.u,b=this.region.v,R=0,O=0;if(this.region instanceof Xp){let T=this.region,U=T.page.texture.getImage(),ee=U.width,ie=U.height;switch(T.degrees){case 90:y-=(T.originalHeight-T.offsetY-T.height)/ee,b-=(T.originalWidth-T.offsetX-T.width)/ie,R=T.originalHeight/ee,O=T.originalWidth/ie;for(let ne=0;ne<p;ne+=2)h[ne]=y+r[ne+1]*R,h[ne+1]=b+(1-r[ne])*O;return;case 180:y-=(T.originalWidth-T.offsetX-T.width)/ee,b-=T.offsetY/ie,R=T.originalWidth/ee,O=T.originalHeight/ie;for(let ne=0;ne<p;ne+=2)h[ne]=y+(1-r[ne])*R,h[ne+1]=b+(1-r[ne+1])*O;return;case 270:y-=T.offsetY/ee,b-=T.offsetX/ie,R=T.originalHeight/ee,O=T.originalWidth/ie;for(let ne=0;ne<p;ne+=2)h[ne]=y+(1-r[ne+1])*R,h[ne+1]=b+r[ne]*O;return}y-=T.offsetX/ee,b-=(T.originalHeight-T.offsetY-T.height)/ie,R=T.originalWidth/ee,O=T.originalHeight/ie}else this.region?(R=this.region.u2-y,O=this.region.v2-b):(y=b=0,R=O=1);for(let T=0;T<p;T+=2)h[T]=y+r[T]*R,h[T+1]=b+r[T+1]*O}getParentMesh(){return this.parentMesh}setParentMesh(r){this.parentMesh=r,r&&(this.bones=r.bones,this.vertices=r.vertices,this.worldVerticesLength=r.worldVerticesLength,this.regionUVs=r.regionUVs,this.triangles=r.triangles,this.hullLength=r.hullLength,this.worldVerticesLength=r.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let r=new Oa(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),this.copyTo(r),r.regionUVs=new Array(this.regionUVs.length),gr.arrayCopy(this.regionUVs,0,r.regionUVs,0,this.regionUVs.length),r.uvs=new Array(this.uvs.length),gr.arrayCopy(this.uvs,0,r.uvs,0,this.uvs.length),r.triangles=new Array(this.triangles.length),gr.arrayCopy(this.triangles,0,r.triangles,0,this.triangles.length),r.hullLength=this.hullLength,this.edges&&(r.edges=new Array(this.edges.length),gr.arrayCopy(this.edges,0,r.edges,0,this.edges.length)),r.width=this.width,r.height=this.height,r}newLinkedMesh(){let r=new Oa(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),r.deformAttachment=this.deformAttachment,r.setParentMesh(this.parentMesh?this.parentMesh:this),r.updateUVs(),r}}class $u extends Au{constructor(r){super(r),this.closed=!1,this.constantSpeed=!1,this.color=new Qr(1,1,1,1)}copy(){let r=new $u(this.name);return this.copyTo(r),r.lengths=new Array(this.lengths.length),gr.arrayCopy(this.lengths,0,r.lengths,0,this.lengths.length),r.closed=closed,r.constantSpeed=this.constantSpeed,r.color.setFromColor(this.color),r}}class Lh extends Au{constructor(r){super(r),this.color=new Qr(.38,.94,0,1)}computeWorldPosition(r,h){return h.x=this.x*r.a+this.y*r.b+r.worldX,h.y=this.x*r.c+this.y*r.d+r.worldY,h}computeWorldRotation(r){let h=Cn.cosDeg(this.rotation),p=Cn.sinDeg(this.rotation);return Math.atan2(h*r.c+p*r.d,h*r.a+p*r.b)*Cn.radDeg}copy(){let r=new Lh(this.name);return r.x=this.x,r.y=this.y,r.rotation=this.rotation,r.color.setFromColor(this.color),r}}class _i extends Af{constructor(r){super(r),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Qr(1,1,1,1),this.offset=gr.newFloatArray(8),this.uvs=gr.newFloatArray(8),this.tempColor=new Qr(1,1,1,1)}updateOffset(){let r=this.width/this.region.originalWidth*this.scaleX,h=this.height/this.region.originalHeight*this.scaleY,p=-this.width/2*this.scaleX+this.region.offsetX*r,y=-this.height/2*this.scaleY+this.region.offsetY*h,b=p+this.region.width*r,R=y+this.region.height*h,O=this.rotation*Math.PI/180,T=Math.cos(O),U=Math.sin(O),ee=this.x,ie=this.y,ne=p*T+ee,ve=p*U,be=y*T+ie,Te=y*U,Le=b*T+ee,Ie=b*U,Oe=R*T+ie,Fe=R*U,je=this.offset;je[0]=ne-Te,je[1]=be+ve,je[2]=ne-Fe,je[3]=Oe+ve,je[4]=Le-Fe,je[5]=Oe+Ie,je[6]=Le-Te,je[7]=be+Ie}setRegion(r){this.region=r;let h=this.uvs;90==r.degrees?(h[2]=r.u,h[3]=r.v2,h[4]=r.u,h[5]=r.v,h[6]=r.u2,h[7]=r.v,h[0]=r.u2,h[1]=r.v2):(h[0]=r.u,h[1]=r.v2,h[2]=r.u,h[3]=r.v,h[4]=r.u2,h[5]=r.v,h[6]=r.u2,h[7]=r.v2)}computeWorldVertices(r,h,p,y){let b=this.offset,R=r.worldX,O=r.worldY,T=r.a,U=r.b,ee=r.c,ie=r.d,ne=0,ve=0;ne=b[0],ve=b[1],h[p]=ne*T+ve*U+R,h[p+1]=ne*ee+ve*ie+O,ne=b[2],ve=b[3],h[p+=y]=ne*T+ve*U+R,h[p+1]=ne*ee+ve*ie+O,ne=b[4],ve=b[5],h[p+=y]=ne*T+ve*U+R,h[p+1]=ne*ee+ve*ie+O,ne=b[6],ve=b[7],h[p+=y]=ne*T+ve*U+R,h[p+1]=ne*ee+ve*ie+O}copy(){let r=new _i(this.name);return r.region=this.region,r.rendererObject=this.rendererObject,r.path=this.path,r.x=this.x,r.y=this.y,r.scaleX=this.scaleX,r.scaleY=this.scaleY,r.rotation=this.rotation,r.width=this.width,r.height=this.height,gr.arrayCopy(this.uvs,0,r.uvs,0,8),gr.arrayCopy(this.offset,0,r.offset,0,8),r.color.setFromColor(this.color),r}}_i.X1=0,_i.Y1=1,_i.C1R=2,_i.C1G=3,_i.C1B=4,_i.C1A=5,_i.U1=6,_i.V1=7,_i.X2=8,_i.Y2=9,_i.C2R=10,_i.C2G=11,_i.C2B=12,_i.C2A=13,_i.U2=14,_i.V2=15,_i.X3=16,_i.Y3=17,_i.C3R=18,_i.C3G=19,_i.C3B=20,_i.C3A=21,_i.U3=22,_i.V3=23,_i.X4=24,_i.Y4=25,_i.C4R=26,_i.C4G=27,_i.C4B=28,_i.C4A=29,_i.U4=30,_i.V4=31;class gd{constructor(r){this.atlas=r}newRegionAttachment(r,h,p){let y=this.atlas.findRegion(p);if(!y)throw new Error("Region not found in atlas: "+p+" (region attachment: "+h+")");y.renderObject=y;let b=new _i(h);return b.setRegion(y),b}newMeshAttachment(r,h,p){let y=this.atlas.findRegion(p);if(!y)throw new Error("Region not found in atlas: "+p+" (mesh attachment: "+h+")");y.renderObject=y;let b=new Oa(h);return b.region=y,b}newBoundingBoxAttachment(r,h){return new lf(h)}newPathAttachment(r,h){return new $u(h)}newPointAttachment(r,h){return new Lh(h)}newClippingAttachment(r,h){return new Ud(h)}}class vd{constructor(r,h,p){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Ic.Normal,this.skinRequired=!1,this.color=new Qr,r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");this.index=r,this.name=h,this.parent=p}}!function(a){a[a.Normal=0]="Normal",a[a.OnlyTranslation=1]="OnlyTranslation",a[a.NoRotationOrReflection=2]="NoRotationOrReflection",a[a.NoScale=3]="NoScale",a[a.NoScaleOrReflection=4]="NoScaleOrReflection"}(Ic||(Ic={}));class Rp{constructor(r,h,p){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.skeleton=h,this.parent=p,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(r,h,p,y,b,R,O){this.ax=r,this.ay=h,this.arotation=p,this.ascaleX=y,this.ascaleY=b,this.ashearX=R,this.ashearY=O;let T=this.parent;if(!T){let ve=this.skeleton,be=p+90+O,Te=ve.scaleX,Le=ve.scaleY;return this.a=Cn.cosDeg(p+R)*y*Te,this.b=Cn.cosDeg(be)*b*Te,this.c=Cn.sinDeg(p+R)*y*Le,this.d=Cn.sinDeg(be)*b*Le,this.worldX=r*Te+ve.x,void(this.worldY=h*Le+ve.y)}let U=T.a,ee=T.b,ie=T.c,ne=T.d;switch(this.worldX=U*r+ee*h+T.worldX,this.worldY=ie*r+ne*h+T.worldY,this.data.transformMode){case Ic.Normal:{let ve=p+90+O,be=Cn.cosDeg(p+R)*y,Te=Cn.cosDeg(ve)*b,Le=Cn.sinDeg(p+R)*y,Ie=Cn.sinDeg(ve)*b;return this.a=U*be+ee*Le,this.b=U*Te+ee*Ie,this.c=ie*be+ne*Le,void(this.d=ie*Te+ne*Ie)}case Ic.OnlyTranslation:{let ve=p+90+O;this.a=Cn.cosDeg(p+R)*y,this.b=Cn.cosDeg(ve)*b,this.c=Cn.sinDeg(p+R)*y,this.d=Cn.sinDeg(ve)*b;break}case Ic.NoRotationOrReflection:{let ve=U*U+ie*ie,be=0;ve>1e-4?(ve=Math.abs(U*ne-ee*ie)/ve,U/=this.skeleton.scaleX,ie/=this.skeleton.scaleY,ee=ie*ve,ne=U*ve,be=Math.atan2(ie,U)*Cn.radDeg):(U=0,ie=0,be=90-Math.atan2(ne,ee)*Cn.radDeg);let Te=p+R-be,Le=p+O-be+90,Ie=Cn.cosDeg(Te)*y,Oe=Cn.cosDeg(Le)*b,Fe=Cn.sinDeg(Te)*y,je=Cn.sinDeg(Le)*b;this.a=U*Ie-ee*Fe,this.b=U*Oe-ee*je,this.c=ie*Ie+ne*Fe,this.d=ie*Oe+ne*je;break}case Ic.NoScale:case Ic.NoScaleOrReflection:{let ve=Cn.cosDeg(p),be=Cn.sinDeg(p),Te=(U*ve+ee*be)/this.skeleton.scaleX,Le=(ie*ve+ne*be)/this.skeleton.scaleY,Ie=Math.sqrt(Te*Te+Le*Le);Ie>1e-5&&(Ie=1/Ie),Te*=Ie,Le*=Ie,Ie=Math.sqrt(Te*Te+Le*Le),this.data.transformMode==Ic.NoScale&&U*ne-ee*ie<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(Ie=-Ie);let Oe=Math.PI/2+Math.atan2(Le,Te),Fe=Math.cos(Oe)*Ie,je=Math.sin(Oe)*Ie,Ue=Cn.cosDeg(R)*y,Je=Cn.cosDeg(90+O)*b,pt=Cn.sinDeg(R)*y,at=Cn.sinDeg(90+O)*b;this.a=Te*Ue+Fe*pt,this.b=Te*Je+Fe*at,this.c=Le*Ue+je*pt,this.d=Le*Je+je*at;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let r=this.data;this.x=r.x,this.y=r.y,this.rotation=r.rotation,this.scaleX=r.scaleX,this.scaleY=r.scaleY,this.shearX=r.shearX,this.shearY=r.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*Cn.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*Cn.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){let r=this.parent;if(!r)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*Cn.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*Cn.radDeg);let h=r.a,p=r.b,y=r.c,b=r.d,R=1/(h*b-p*y),O=this.worldX-r.worldX,T=this.worldY-r.worldY;this.ax=O*b*R-T*p*R,this.ay=T*h*R-O*y*R;let U=R*b,ee=R*h,ie=R*p,ne=R*y,ve=U*this.a-ie*this.c,be=U*this.b-ie*this.d,Te=ee*this.c-ne*this.a,Le=ee*this.d-ne*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(ve*ve+Te*Te),this.ascaleX>1e-4){let Ie=ve*Le-be*Te;this.ascaleY=Ie/this.ascaleX,this.ashearY=Math.atan2(ve*be+Te*Le,Ie)*Cn.radDeg,this.arotation=Math.atan2(Te,ve)*Cn.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(be*be+Le*Le),this.ashearY=0,this.arotation=90-Math.atan2(Le,be)*Cn.radDeg}worldToLocal(r){let h=1/(this.a*this.d-this.b*this.c),p=r.x-this.worldX,y=r.y-this.worldY;return r.x=p*this.d*h-y*this.b*h,r.y=y*this.a*h-p*this.c*h,r}localToWorld(r){let h=r.x,p=r.y;return r.x=h*this.a+p*this.b+this.worldX,r.y=h*this.c+p*this.d+this.worldY,r}worldToLocalRotation(r){let h=Cn.sinDeg(r),p=Cn.cosDeg(r);return Math.atan2(this.a*h-this.c*p,this.d*p-this.b*h)*Cn.radDeg+this.rotation-this.shearX}localToWorldRotation(r){let h=Cn.sinDeg(r-=this.rotation-this.shearX),p=Cn.cosDeg(r);return Math.atan2(p*this.c+h*this.d,p*this.a+h*this.b)*Cn.radDeg}rotateWorld(r){let h=this.a,p=this.b,y=this.c,b=this.d,R=Cn.cosDeg(r),O=Cn.sinDeg(r);this.a=R*h-O*y,this.b=R*p-O*b,this.c=O*h+R*y,this.d=O*p+R*b}}class yd{constructor(r,h){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mix=r.mix,this.softness=r.softness,this.bendDirection=r.bendDirection,this.compress=r.compress,this.stretch=r.stretch,this.bones=new Array;for(let p=0;p<r.bones.length;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){if(0==this.mix)return;let r=this.target,h=this.bones;switch(h.length){case 1:this.apply1(h[0],r.worldX,r.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(h[0],h[1],r.worldX,r.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(r,h,p,y,b,R,O){let T=r.parent,U=T.a,ee=T.b,ie=T.c,ne=T.d,ve=-r.ashearX-r.arotation,be=0,Te=0;switch(r.data.transformMode){case Ic.OnlyTranslation:be=h-r.worldX,Te=p-r.worldY;break;case Ic.NoRotationOrReflection:let Oe=Math.abs(U*ne-ee*ie)/(U*U+ie*ie),Fe=U/r.skeleton.scaleX,je=ie/r.skeleton.scaleY;ee=-je*Oe*r.skeleton.scaleX,ne=Fe*Oe*r.skeleton.scaleY,ve+=Math.atan2(je,Fe)*Cn.radDeg;default:let Ue=h-T.worldX,Je=p-T.worldY,pt=U*ne-ee*ie;be=(Ue*ne-Je*ee)/pt-r.ax,Te=(Je*U-Ue*ie)/pt-r.ay}ve+=Math.atan2(Te,be)*Cn.radDeg,r.ascaleX<0&&(ve+=180),ve>180?ve-=360:ve<-180&&(ve+=360);let Le=r.ascaleX,Ie=r.ascaleY;if(y||b){switch(r.data.transformMode){case Ic.NoScale:case Ic.NoScaleOrReflection:be=h-r.worldX,Te=p-r.worldY}let Oe=r.data.length*Le,Fe=Math.sqrt(be*be+Te*Te);if(y&&Fe<Oe||b&&Fe>Oe&&Oe>1e-4){let je=(Fe/Oe-1)*O+1;Le*=je,R&&(Ie*=je)}}r.updateWorldTransformWith(r.ax,r.ay,r.arotation+ve*O,Le,Ie,r.ashearX,r.ashearY)}apply2(r,h,p,y,b,R,O,T,U){let ee=r.ax,ie=r.ay,ne=r.ascaleX,ve=r.ascaleY,be=ne,Te=ve,Le=h.ascaleX,Ie=0,Oe=0,Fe=0;ne<0?(ne=-ne,Ie=180,Fe=-1):(Ie=0,Fe=1),ve<0&&(ve=-ve,Fe=-Fe),Le<0?(Le=-Le,Oe=180):Oe=0;let je=h.ax,Ue=0,Je=0,pt=0,at=r.a,Mt=r.b,Tt=r.c,Yt=r.d,jt=Math.abs(ne-ve)<=1e-4;!jt||R?(Ue=0,Je=at*je+r.worldX,pt=Tt*je+r.worldY):(Ue=h.ay,Je=at*je+Mt*Ue+r.worldX,pt=Tt*je+Yt*Ue+r.worldY);let It=r.parent;at=It.a,Mt=It.b,Tt=It.c,Yt=It.d;let Nt,ft,$t=1/(at*Yt-Mt*Tt),Zt=Je-It.worldX,Tn=pt-It.worldY,$n=(Zt*Yt-Tn*Mt)*$t-ee,Qn=(Tn*at-Zt*Tt)*$t-ie,lr=Math.sqrt($n*$n+Qn*Qn),jn=h.data.length*Le;if(lr<1e-4)return this.apply1(r,p,y,!1,R,!1,U),void h.updateWorldTransformWith(je,Ue,0,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY);Zt=p-It.worldX,Tn=y-It.worldY;let pr=(Zt*Yt-Tn*Mt)*$t-ee,Yn=(Tn*at-Zt*Tt)*$t-ie,wr=pr*pr+Yn*Yn;if(0!=T){T*=ne*(Le+1)*.5;let fo=Math.sqrt(wr),wo=fo-lr-jn*ne+T;if(wo>0){let Uo=Math.min(1,wo/(2*T))-1;Uo=(wo-T*(1-Uo*Uo))/fo,pr-=Uo*pr,Yn-=Uo*Yn,wr=pr*pr+Yn*Yn}}e:if(jt){jn*=ne;let fo=(wr-lr*lr-jn*jn)/(2*lr*jn);fo<-1?(fo=-1,ft=Math.PI*b):fo>1?(fo=1,ft=0,R&&(at=(Math.sqrt(wr)/(lr+jn)-1)*U+1,be*=at,O&&(Te*=at))):ft=Math.acos(fo)*b,at=lr+jn*fo,Mt=jn*Math.sin(ft),Nt=Math.atan2(Yn*at-pr*Mt,pr*at+Yn*Mt)}else{at=ne*jn,Mt=ve*jn;let fo=at*at,wo=Mt*Mt,Uo=Math.atan2(Yn,pr);Tt=wo*lr*lr+fo*wr-fo*wo;let cs=-2*wo*lr,Ws=wo-fo;if(Yt=cs*cs-4*Ws*Tt,Yt>=0){let Uc=Math.sqrt(Yt);cs<0&&(Uc=-Uc),Uc=.5*-(cs+Uc);let up=Uc/Ws,fh=Tt/Uc,il=Math.abs(up)<Math.abs(fh)?up:fh;if(il*il<=wr){Tn=Math.sqrt(wr-il*il)*b,Nt=Uo-Math.atan2(Tn,il),ft=Math.atan2(Tn/ve,(il-lr)/ne);break e}}let Ga=Cn.PI,ks=lr-at,qs=ks*ks,Hl=0,ap=0,lp=lr+at,Up=lp*lp,Sd=0;Tt=-at*lr/(fo-wo),Tt>=-1&&Tt<=1&&(Tt=Math.acos(Tt),Zt=at*Math.cos(Tt)+lr,Tn=Mt*Math.sin(Tt),Yt=Zt*Zt+Tn*Tn,Yt<qs&&(Ga=Tt,qs=Yt,ks=Zt,Hl=Tn),Yt>Up&&(ap=Tt,Up=Yt,lp=Zt,Sd=Tn)),wr<=.5*(qs+Up)?(Nt=Uo-Math.atan2(Hl*b,ks),ft=Ga*b):(Nt=Uo-Math.atan2(Sd*b,lp),ft=ap*b)}let Or=Math.atan2(Ue,je)*Fe,Ji=r.arotation;Nt=(Nt-Or)*Cn.radDeg+Ie-Ji,Nt>180?Nt-=360:Nt<-180&&(Nt+=360),r.updateWorldTransformWith(ee,ie,Ji+Nt*U,be,Te,0,0),Ji=h.arotation,ft=((ft+Or)*Cn.radDeg-h.ashearX)*Fe+Oe-Ji,ft>180?ft-=360:ft<-180&&(ft+=360),h.updateWorldTransformWith(je,Ue,Ji+ft*U,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY)}}class Pp{constructor(r,h,p){this.name=r,this.order=h,this.skinRequired=p}}class Gd extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0}}(Np=sc||(sc={}))[Np.Fixed=0]="Fixed",Np[Np.Percent=1]="Percent",(wa=ac||(ac={}))[wa.Length=0]="Length",wa[wa.Fixed=1]="Fixed",wa[wa.Percent=2]="Percent",wa[wa.Proportional=3]="Proportional",function(a){a[a.Tangent=0]="Tangent",a[a.Chain=1]="Chain",a[a.ChainScale=2]="ChainScale"}(fd||(fd={}));class lc{constructor(r,h){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.bones=new Array;for(let p=0,y=r.bones.length;p<y;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findSlot(r.target.name),this.position=r.position,this.spacing=r.spacing,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY}isActive(){return this.active}update(){let r=this.target.getAttachment();if(!(r instanceof $u))return;let h=this.mixRotate,p=this.mixX,y=this.mixY;if(0==h&&0==p&&0==y)return;let b=this.data,R=b.rotateMode==fd.Tangent,O=b.rotateMode==fd.ChainScale,T=this.bones,U=T.length,ee=R?U:U+1,ie=gr.setArraySize(this.spaces,ee),ne=O?this.lengths=gr.setArraySize(this.lengths,U):null,ve=this.spacing;switch(b.spacingMode){case ac.Percent:if(O)for(let Ue=0,Je=ee-1;Ue<Je;Ue++){let pt=T[Ue],at=pt.data.length;if(at<lc.epsilon)ne[Ue]=0;else{let Mt=at*pt.a,Tt=at*pt.c;ne[Ue]=Math.sqrt(Mt*Mt+Tt*Tt)}}gr.arrayFill(ie,1,ee,ve);break;case ac.Proportional:let Fe=0;for(let Ue=0,Je=ee-1;Ue<Je;){let pt=T[Ue],at=pt.data.length;if(at<lc.epsilon)O&&(ne[Ue]=0),ie[++Ue]=ve;else{let Mt=at*pt.a,Tt=at*pt.c,Yt=Math.sqrt(Mt*Mt+Tt*Tt);O&&(ne[Ue]=Yt),ie[++Ue]=Yt,Fe+=Yt}}if(Fe>0){Fe=ee/Fe*ve;for(let Ue=1;Ue<ee;Ue++)ie[Ue]*=Fe}break;default:let je=b.spacingMode==ac.Length;for(let Ue=0,Je=ee-1;Ue<Je;){let pt=T[Ue],at=pt.data.length;if(at<lc.epsilon)O&&(ne[Ue]=0),ie[++Ue]=ve;else{let Mt=at*pt.a,Tt=at*pt.c,Yt=Math.sqrt(Mt*Mt+Tt*Tt);O&&(ne[Ue]=Yt),ie[++Ue]=(je?at+ve:ve)*Yt/at}}}let be=this.computeWorldPositions(r,ee,R),Te=be[0],Le=be[1],Ie=b.offsetRotation,Oe=!1;if(0==Ie)Oe=b.rotateMode==fd.Chain;else{Oe=!1;let Fe=this.target.bone;Ie*=Fe.a*Fe.d-Fe.b*Fe.c>0?Cn.degRad:-Cn.degRad}for(let Fe=0,je=3;Fe<U;Fe++,je+=3){let Ue=T[Fe];Ue.worldX+=(Te-Ue.worldX)*p,Ue.worldY+=(Le-Ue.worldY)*y;let Je=be[je],pt=be[je+1],at=Je-Te,Mt=pt-Le;if(O){let Tt=ne[Fe];if(0!=Tt){let Yt=(Math.sqrt(at*at+Mt*Mt)/Tt-1)*h+1;Ue.a*=Yt,Ue.c*=Yt}}if(Te=Je,Le=pt,h>0){let Tt=Ue.a,Yt=Ue.b,jt=Ue.c,It=Ue.d,Nt=0,ft=0,$t=0;if(Nt=R?be[je-1]:0==ie[Fe+1]?be[je+2]:Math.atan2(Mt,at),Nt-=Math.atan2(jt,Tt),Oe){ft=Math.cos(Nt),$t=Math.sin(Nt);let Zt=Ue.data.length;Te+=(Zt*(ft*Tt-$t*jt)-at)*h,Le+=(Zt*($t*Tt+ft*jt)-Mt)*h}else Nt+=Ie;Nt>Cn.PI?Nt-=Cn.PI2:Nt<-Cn.PI&&(Nt+=Cn.PI2),Nt*=h,ft=Math.cos(Nt),$t=Math.sin(Nt),Ue.a=ft*Tt-$t*jt,Ue.b=ft*Yt-$t*It,Ue.c=$t*Tt+ft*jt,Ue.d=$t*Yt+ft*It}Ue.updateAppliedTransform()}}computeWorldPositions(r,h,p){let y=this.target,b=this.position,R=this.spaces,O=gr.setArraySize(this.positions,3*h+2),T=null,U=r.closed,ee=r.worldVerticesLength,ie=ee/6,ne=lc.NONE;if(!r.constantSpeed){let Tn=r.lengths;ie-=U?1:2;let $n,Qn=Tn[ie];switch(this.data.positionMode==sc.Percent&&(b*=Qn),this.data.spacingMode){case ac.Percent:$n=Qn;break;case ac.Proportional:$n=Qn/h;break;default:$n=1}T=gr.setArraySize(this.world,8);for(let lr=0,jn=0,pr=0;lr<h;lr++,jn+=3){let Yn=R[lr]*$n;b+=Yn;let wr=b;if(U)wr%=Qn,wr<0&&(wr+=Qn),pr=0;else{if(wr<0){ne!=lc.BEFORE&&(ne=lc.BEFORE,r.computeWorldVertices(y,2,4,T,0,2)),this.addBeforePosition(wr,T,0,O,jn);continue}if(wr>Qn){ne!=lc.AFTER&&(ne=lc.AFTER,r.computeWorldVertices(y,ee-6,4,T,0,2)),this.addAfterPosition(wr-Qn,T,0,O,jn);continue}}for(;;pr++){let Or=Tn[pr];if(!(wr>Or)){if(0==pr)wr/=Or;else{let Ji=Tn[pr-1];wr=(wr-Ji)/(Or-Ji)}break}}pr!=ne&&(ne=pr,U&&pr==ie?(r.computeWorldVertices(y,ee-4,4,T,0,2),r.computeWorldVertices(y,0,4,T,4,2)):r.computeWorldVertices(y,6*pr+2,8,T,0,2)),this.addCurvePosition(wr,T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],O,jn,p||lr>0&&0==Yn)}return O}U?(ee+=2,T=gr.setArraySize(this.world,ee),r.computeWorldVertices(y,2,ee-4,T,0,2),r.computeWorldVertices(y,0,2,T,ee-4,2),T[ee-2]=T[0],T[ee-1]=T[1]):(ie--,ee-=4,T=gr.setArraySize(this.world,ee),r.computeWorldVertices(y,2,ee,T,0,2));let ve,be=gr.setArraySize(this.curves,ie),Te=0,Le=T[0],Ie=T[1],Oe=0,Fe=0,je=0,Ue=0,Je=0,pt=0,at=0,Mt=0,Tt=0,Yt=0,jt=0,It=0,Nt=0,ft=0;for(let Tn=0,$n=2;Tn<ie;Tn++,$n+=6)Oe=T[$n],Fe=T[$n+1],je=T[$n+2],Ue=T[$n+3],Je=T[$n+4],pt=T[$n+5],at=.1875*(Le-2*Oe+je),Mt=.1875*(Ie-2*Fe+Ue),Tt=.09375*(3*(Oe-je)-Le+Je),Yt=.09375*(3*(Fe-Ue)-Ie+pt),jt=2*at+Tt,It=2*Mt+Yt,Nt=.75*(Oe-Le)+at+.16666667*Tt,ft=.75*(Fe-Ie)+Mt+.16666667*Yt,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt,ft+=It,jt+=Tt,It+=Yt,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt,ft+=It,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt+Tt,ft+=It+Yt,Te+=Math.sqrt(Nt*Nt+ft*ft),be[Tn]=Te,Le=Je,Ie=pt;switch(this.data.positionMode==sc.Percent&&(b*=Te),this.data.spacingMode){case ac.Percent:ve=Te;break;case ac.Proportional:ve=Te/h;break;default:ve=1}let $t=this.segments,Zt=0;for(let Tn=0,$n=0,Qn=0,lr=0;Tn<h;Tn++,$n+=3){let jn=R[Tn]*ve;b+=jn;let pr=b;if(U)pr%=Te,pr<0&&(pr+=Te),Qn=0;else{if(pr<0){this.addBeforePosition(pr,T,0,O,$n);continue}if(pr>Te){this.addAfterPosition(pr-Te,T,ee-4,O,$n);continue}}for(;;Qn++){let Yn=be[Qn];if(!(pr>Yn)){if(0==Qn)pr/=Yn;else{let wr=be[Qn-1];pr=(pr-wr)/(Yn-wr)}break}}if(Qn!=ne){ne=Qn;let Yn=6*Qn;for(Le=T[Yn],Ie=T[Yn+1],Oe=T[Yn+2],Fe=T[Yn+3],je=T[Yn+4],Ue=T[Yn+5],Je=T[Yn+6],pt=T[Yn+7],at=.03*(Le-2*Oe+je),Mt=.03*(Ie-2*Fe+Ue),Tt=.006*(3*(Oe-je)-Le+Je),Yt=.006*(3*(Fe-Ue)-Ie+pt),jt=2*at+Tt,It=2*Mt+Yt,Nt=.3*(Oe-Le)+at+.16666667*Tt,ft=.3*(Fe-Ie)+Mt+.16666667*Yt,Zt=Math.sqrt(Nt*Nt+ft*ft),$t[0]=Zt,Yn=1;Yn<8;Yn++)Nt+=jt,ft+=It,jt+=Tt,It+=Yt,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[Yn]=Zt;Nt+=jt,ft+=It,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[8]=Zt,Nt+=jt+Tt,ft+=It+Yt,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[9]=Zt,lr=0}for(pr*=Zt;;lr++){let Yn=$t[lr];if(!(pr>Yn)){if(0==lr)pr/=Yn;else{let wr=$t[lr-1];pr=lr+(pr-wr)/(Yn-wr)}break}}this.addCurvePosition(.1*pr,Le,Ie,Oe,Fe,je,Ue,Je,pt,O,$n,p||Tn>0&&0==jn)}return O}addBeforePosition(r,h,p,y,b){let R=h[p],O=h[p+1],ee=Math.atan2(h[p+3]-O,h[p+2]-R);y[b]=R+r*Math.cos(ee),y[b+1]=O+r*Math.sin(ee),y[b+2]=ee}addAfterPosition(r,h,p,y,b){let R=h[p+2],O=h[p+3],ee=Math.atan2(O-h[p+1],R-h[p]);y[b]=R+r*Math.cos(ee),y[b+1]=O+r*Math.sin(ee),y[b+2]=ee}addCurvePosition(r,h,p,y,b,R,O,T,U,ee,ie,ne){if(0==r||isNaN(r))return ee[ie]=h,ee[ie+1]=p,void(ee[ie+2]=Math.atan2(b-p,y-h));let ve=r*r,be=ve*r,Te=1-r,Le=Te*Te,Ie=Le*Te,Oe=Te*r,Fe=3*Oe,je=Te*Fe,Ue=Fe*r,Je=h*Ie+y*je+R*Ue+T*be,pt=p*Ie+b*je+O*Ue+U*be;ee[ie]=Je,ee[ie+1]=pt,ne&&(ee[ie+2]=r<.001?Math.atan2(b-p,y-h):Math.atan2(pt-(p*Le+b*Oe*2+O*ve),Je-(h*Le+y*Oe*2+R*ve)))}}lc.NONE=-1,lc.BEFORE=-2,lc.AFTER=-3,lc.epsilon=1e-5;class Hd{constructor(r,h){if(this.deform=new Array,!r)throw new Error("data cannot be null.");if(!h)throw new Error("bone cannot be null.");this.data=r,this.bone=h,this.color=new Qr,this.darkColor=r.darkColor?new Qr:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(r){this.attachment!=r&&(r instanceof Au&&this.attachment instanceof Au&&r.deformAttachment==this.attachment.deformAttachment||(this.deform.length=0),this.attachment=r,this.attachmentTime=this.bone.skeleton.time)}setAttachmentTime(r){this.attachmentTime=this.bone.skeleton.time-r}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class bd{constructor(r,h){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new of,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY,this.mixScaleX=r.mixScaleX,this.mixScaleY=r.mixScaleY,this.mixShearY=r.mixShearY,this.bones=new Array;for(let p=0;p<r.bones.length;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,O=0!=h||0!=p,T=this.target,U=T.a,ee=T.b,ie=T.c,ne=T.d,ve=U*ne-ee*ie>0?Cn.degRad:-Cn.degRad,be=this.data.offsetRotation*ve,Te=this.data.offsetShearY*ve,Le=this.bones;for(let Ie=0,Oe=Le.length;Ie<Oe;Ie++){let Fe=Le[Ie];if(0!=r){let je=Fe.a,Ue=Fe.b,Je=Fe.c,pt=Fe.d,at=Math.atan2(ie,U)-Math.atan2(Je,je)+be;at>Cn.PI?at-=Cn.PI2:at<-Cn.PI&&(at+=Cn.PI2),at*=r;let Mt=Math.cos(at),Tt=Math.sin(at);Fe.a=Mt*je-Tt*Je,Fe.b=Mt*Ue-Tt*pt,Fe.c=Tt*je+Mt*Je,Fe.d=Tt*Ue+Mt*pt}if(O){let je=this.temp;T.localToWorld(je.set(this.data.offsetX,this.data.offsetY)),Fe.worldX+=(je.x-Fe.worldX)*h,Fe.worldY+=(je.y-Fe.worldY)*p}if(0!=y){let je=Math.sqrt(Fe.a*Fe.a+Fe.c*Fe.c);0!=je&&(je=(je+(Math.sqrt(U*U+ie*ie)-je+this.data.offsetScaleX)*y)/je),Fe.a*=je,Fe.c*=je}if(0!=b){let je=Math.sqrt(Fe.b*Fe.b+Fe.d*Fe.d);0!=je&&(je=(je+(Math.sqrt(ee*ee+ne*ne)-je+this.data.offsetScaleY)*b)/je),Fe.b*=je,Fe.d*=je}if(R>0){let je=Fe.b,Ue=Fe.d,Je=Math.atan2(Ue,je),pt=Math.atan2(ne,ee)-Math.atan2(ie,U)-(Je-Math.atan2(Fe.c,Fe.a));pt>Cn.PI?pt-=Cn.PI2:pt<-Cn.PI&&(pt+=Cn.PI2),pt=Je+(pt+Te)*R;let at=Math.sqrt(je*je+Ue*Ue);Fe.b=Math.cos(pt)*at,Fe.d=Math.sin(pt)*at}Fe.updateAppliedTransform()}}applyRelativeWorld(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,O=0!=h||0!=p,T=this.target,U=T.a,ee=T.b,ie=T.c,ne=T.d,ve=U*ne-ee*ie>0?Cn.degRad:-Cn.degRad,be=this.data.offsetRotation*ve,Te=this.data.offsetShearY*ve,Le=this.bones;for(let Ie=0,Oe=Le.length;Ie<Oe;Ie++){let Fe=Le[Ie];if(0!=r){let je=Fe.a,Ue=Fe.b,Je=Fe.c,pt=Fe.d,at=Math.atan2(ie,U)+be;at>Cn.PI?at-=Cn.PI2:at<-Cn.PI&&(at+=Cn.PI2),at*=r;let Mt=Math.cos(at),Tt=Math.sin(at);Fe.a=Mt*je-Tt*Je,Fe.b=Mt*Ue-Tt*pt,Fe.c=Tt*je+Mt*Je,Fe.d=Tt*Ue+Mt*pt}if(O){let je=this.temp;T.localToWorld(je.set(this.data.offsetX,this.data.offsetY)),Fe.worldX+=je.x*h,Fe.worldY+=je.y*p}if(0!=y){let je=(Math.sqrt(U*U+ie*ie)-1+this.data.offsetScaleX)*y+1;Fe.a*=je,Fe.c*=je}if(0!=b){let je=(Math.sqrt(ee*ee+ne*ne)-1+this.data.offsetScaleY)*b+1;Fe.b*=je,Fe.d*=je}if(R>0){let je=Math.atan2(ne,ee)-Math.atan2(ie,U);je>Cn.PI?je-=Cn.PI2:je<-Cn.PI&&(je+=Cn.PI2);let Ue=Fe.b,Je=Fe.d;je=Math.atan2(Je,Ue)+(je-Cn.PI/2+Te)*R;let pt=Math.sqrt(Ue*Ue+Je*Je);Fe.b=Math.cos(je)*pt,Fe.d=Math.sin(je)*pt}Fe.updateAppliedTransform()}}applyAbsoluteLocal(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,O=this.target,T=this.bones;for(let U=0,ee=T.length;U<ee;U++){let ie=T[U],ne=ie.arotation;if(0!=r){let Oe=O.arotation-ne+this.data.offsetRotation;Oe-=360*(16384-(16384.499999999996-Oe/360|0)),ne+=Oe*r}let ve=ie.ax,be=ie.ay;ve+=(O.ax-ve+this.data.offsetX)*h,be+=(O.ay-be+this.data.offsetY)*p;let Te=ie.ascaleX,Le=ie.ascaleY;0!=y&&0!=Te&&(Te=(Te+(O.ascaleX-Te+this.data.offsetScaleX)*y)/Te),0!=b&&0!=Le&&(Le=(Le+(O.ascaleY-Le+this.data.offsetScaleY)*b)/Le);let Ie=ie.ashearY;if(0!=R){let Oe=O.ashearY-Ie+this.data.offsetShearY;Oe-=360*(16384-(16384.499999999996-Oe/360|0)),Ie+=Oe*R}ie.updateWorldTransformWith(ve,be,ne,Te,Le,ie.ashearX,Ie)}}applyRelativeLocal(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,O=this.target,T=this.bones;for(let U=0,ee=T.length;U<ee;U++){let ie=T[U];ie.updateWorldTransformWith(ie.ax+(O.ax+this.data.offsetX)*h,ie.ay+(O.ay+this.data.offsetY)*p,ie.arotation+(O.arotation+this.data.offsetRotation)*r,ie.ascaleX*((O.ascaleX-1+this.data.offsetScaleX)*y+1),ie.ascaleY*((O.ascaleY-1+this.data.offsetScaleY)*b+1),ie.ashearX,ie.ashearY+(O.ashearY+this.data.offsetShearY)*R)}}}class pf{constructor(r){if(this._updateCache=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!r)throw new Error("data cannot be null.");this.data=r,this.bones=new Array;for(let h=0;h<r.bones.length;h++){let p,y=r.bones[h];if(y.parent){let b=this.bones[y.parent.index];p=new Rp(y,this,b),b.children.push(p)}else p=new Rp(y,this,null);this.bones.push(p)}this.slots=new Array,this.drawOrder=new Array;for(let h=0;h<r.slots.length;h++){let p=r.slots[h],b=new Hd(p,this.bones[p.boneData.index]);this.slots.push(b),this.drawOrder.push(b)}this.ikConstraints=new Array;for(let h=0;h<r.ikConstraints.length;h++)this.ikConstraints.push(new yd(r.ikConstraints[h],this));this.transformConstraints=new Array;for(let h=0;h<r.transformConstraints.length;h++)this.transformConstraints.push(new bd(r.transformConstraints[h],this));this.pathConstraints=new Array;for(let h=0;h<r.pathConstraints.length;h++)this.pathConstraints.push(new lc(r.pathConstraints[h],this));this.color=new Qr(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let r=this.bones;for(let U=0,ee=r.length;U<ee;U++){let ie=r[U];ie.sorted=ie.data.skinRequired,ie.active=!ie.sorted}if(this.skin){let U=this.skin.bones;for(let ee=0,ie=this.skin.bones.length;ee<ie;ee++){let ne=this.bones[U[ee].index];do{ne.sorted=!1,ne.active=!0,ne=ne.parent}while(ne)}}let h=this.ikConstraints,p=this.transformConstraints,y=this.pathConstraints,b=h.length,R=p.length,O=y.length,T=b+R+O;e:for(let U=0;U<T;U++){for(let ee=0;ee<b;ee++){let ie=h[ee];if(ie.data.order==U){this.sortIkConstraint(ie);continue e}}for(let ee=0;ee<R;ee++){let ie=p[ee];if(ie.data.order==U){this.sortTransformConstraint(ie);continue e}}for(let ee=0;ee<O;ee++){let ie=y[ee];if(ie.data.order==U){this.sortPathConstraint(ie);continue e}}}for(let U=0,ee=r.length;U<ee;U++)this.sortBone(r[U])}sortIkConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let p=r.bones,y=p[0];if(this.sortBone(y),1==p.length)this._updateCache.push(r),this.sortReset(y.children);else{let b=p[p.length-1];this.sortBone(b),this._updateCache.push(r),this.sortReset(y.children),b.sorted=!0}}sortPathConstraint(r){if(r.active=r.target.bone.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;let h=r.target,p=h.data.index,y=h.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,p,y),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,p,y);for(let T=0,U=this.data.skins.length;T<U;T++)this.sortPathConstraintAttachment(this.data.skins[T],p,y);let b=h.getAttachment();b instanceof $u&&this.sortPathConstraintAttachmentWith(b,y);let R=r.bones,O=R.length;for(let T=0;T<O;T++)this.sortBone(R[T]);this._updateCache.push(r);for(let T=0;T<O;T++)this.sortReset(R[T].children);for(let T=0;T<O;T++)R[T].sorted=!0}sortTransformConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let h=r.bones,p=h.length;if(r.data.local)for(let y=0;y<p;y++){let b=h[y];this.sortBone(b.parent),this.sortBone(b)}else for(let y=0;y<p;y++)this.sortBone(h[y]);this._updateCache.push(r);for(let y=0;y<p;y++)this.sortReset(h[y].children);for(let y=0;y<p;y++)h[y].sorted=!0}sortPathConstraintAttachment(r,h,p){let y=r.attachments[h];if(y)for(let b in y)this.sortPathConstraintAttachmentWith(y[b],p)}sortPathConstraintAttachmentWith(r,h){if(!(r instanceof $u))return;let p=r.bones;if(p){let y=this.bones;for(let b=0,R=p.length;b<R;){let O=p[b++];for(O+=b;b<O;)this.sortBone(y[p[b++]])}}else this.sortBone(h)}sortBone(r){if(r.sorted)return;let h=r.parent;h&&this.sortBone(h),r.sorted=!0,this._updateCache.push(r)}sortReset(r){for(let h=0,p=r.length;h<p;h++){let y=r[h];y.active&&(y.sorted&&this.sortReset(y.children),y.sorted=!1)}}updateWorldTransform(){let r=this.bones;for(let p=0,y=r.length;p<y;p++){let b=r[p];b.ax=b.x,b.ay=b.y,b.arotation=b.rotation,b.ascaleX=b.scaleX,b.ascaleY=b.scaleY,b.ashearX=b.shearX,b.ashearY=b.shearY}let h=this._updateCache;for(let p=0,y=h.length;p<y;p++)h[p].update()}updateWorldTransformWith(r){let h=this.getRootBone(),p=r.a,y=r.b,b=r.c,R=r.d;h.worldX=p*this.x+y*this.y+r.worldX,h.worldY=b*this.x+R*this.y+r.worldY;let O=h.rotation+90+h.shearY,T=Cn.cosDeg(h.rotation+h.shearX)*h.scaleX,U=Cn.cosDeg(O)*h.scaleY,ee=Cn.sinDeg(h.rotation+h.shearX)*h.scaleX,ie=Cn.sinDeg(O)*h.scaleY;h.a=(p*T+y*ee)*this.scaleX,h.b=(p*U+y*ie)*this.scaleX,h.c=(b*T+R*ee)*this.scaleY,h.d=(b*U+R*ie)*this.scaleY;let ne=this._updateCache;for(let ve=0,be=ne.length;ve<be;ve++){let Te=ne[ve];Te!=h&&Te.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let r=this.bones;for(let b=0,R=r.length;b<R;b++)r[b].setToSetupPose();let h=this.ikConstraints;for(let b=0,R=h.length;b<R;b++){let O=h[b];O.mix=O.data.mix,O.softness=O.data.softness,O.bendDirection=O.data.bendDirection,O.compress=O.data.compress,O.stretch=O.data.stretch}let p=this.transformConstraints;for(let b=0,R=p.length;b<R;b++){let O=p[b],T=O.data;O.mixRotate=T.mixRotate,O.mixX=T.mixX,O.mixY=T.mixY,O.mixScaleX=T.mixScaleX,O.mixScaleY=T.mixScaleY,O.mixShearY=T.mixShearY}let y=this.pathConstraints;for(let b=0,R=y.length;b<R;b++){let O=y[b],T=O.data;O.position=T.position,O.spacing=T.spacing,O.mixRotate=T.mixRotate,O.mixX=T.mixX,O.mixY=T.mixY}}setSlotsToSetupPose(){let r=this.slots;gr.arrayCopy(r,0,this.drawOrder,0,r.length);for(let h=0,p=r.length;h<p;h++)r[h].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}setSkinByName(r){let h=this.data.findSkin(r);if(!h)throw new Error("Skin not found: "+r);this.setSkin(h)}setSkin(r){if(r!=this.skin){if(r)if(this.skin)r.attachAll(this,this.skin);else{let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p],R=b.data.attachmentName;if(R){let O=r.getAttachment(p,R);O&&b.setAttachment(O)}}}this.skin=r,this.updateCache()}}getAttachmentByName(r,h){return this.getAttachment(this.data.findSlot(r).index,h)}getAttachment(r,h){if(!h)throw new Error("attachmentName cannot be null.");if(this.skin){let p=this.skin.getAttachment(r,h);if(p)return p}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(r,h):null}setAttachment(r,h){if(!r)throw new Error("slotName cannot be null.");let p=this.slots;for(let y=0,b=p.length;y<b;y++){let R=p[y];if(R.data.name==r){let O=null;if(h&&(O=this.getAttachment(y,h),!O))throw new Error("Attachment not found: "+h+", for slot: "+r);return void R.setAttachment(O)}}throw new Error("Slot not found: "+r)}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}getBounds(r,h,p=new Array(2)){if(!r)throw new Error("offset cannot be null.");if(!h)throw new Error("size cannot be null.");let y=this.drawOrder,b=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(let U=0,ee=y.length;U<ee;U++){let ie=y[U];if(!ie.bone.active)continue;let ne=0,ve=null,be=ie.getAttachment();if(be instanceof _i)ne=8,ve=gr.setArraySize(p,ne,0),be.computeWorldVertices(ie.bone,ve,0,2);else if(be instanceof Oa){let Te=be;ne=Te.worldVerticesLength,ve=gr.setArraySize(p,ne,0),Te.computeWorldVertices(ie,0,ne,ve,0,2)}if(ve)for(let Te=0,Le=ve.length;Te<Le;Te+=2){let Ie=ve[Te],Oe=ve[Te+1];b=Math.min(b,Ie),R=Math.min(R,Oe),O=Math.max(O,Ie),T=Math.max(T,Oe)}}r.set(b,R),h.set(O-b,T-R)}update(r){this.time+=r}}class Nf{constructor(r,h,p){this.slotIndex=r,this.name=h,this.attachment=p}}class Rf{constructor(r){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!r)throw new Error("name cannot be null.");this.name=r}setAttachment(r,h,p){if(!p)throw new Error("attachment cannot be null.");let y=this.attachments;r>=y.length&&(y.length=r+1),y[r]||(y[r]={}),y[r][h]=p}addSkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],R=!1;for(let O=0;O<this.bones.length;O++)if(this.bones[O]==b){R=!0;break}R||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],R=!1;for(let O=0;O<this.constraints.length;O++)if(this.constraints[O]==b){R=!0;break}R||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var p=h[y];this.setAttachment(p.slotIndex,p.name,p.attachment)}}copySkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],R=!1;for(let O=0;O<this.bones.length;O++)if(this.bones[O]==b){R=!0;break}R||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],R=!1;for(let O=0;O<this.constraints.length;O++)if(this.constraints[O]==b){R=!0;break}R||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var p=h[y];p.attachment&&(p.attachment instanceof Oa?(p.attachment=p.attachment.newLinkedMesh(),this.setAttachment(p.slotIndex,p.name,p.attachment)):(p.attachment=p.attachment.copy(),this.setAttachment(p.slotIndex,p.name,p.attachment)))}}getAttachment(r,h){let p=this.attachments[r];return p?p[h]:null}removeAttachment(r,h){let p=this.attachments[r];p&&(p[h]=null)}getAttachments(){let r=new Array;for(var h=0;h<this.attachments.length;h++){let p=this.attachments[h];if(p)for(let y in p){let b=p[y];b&&r.push(new Nf(h,y,b))}}return r}getAttachmentsForSlot(r,h){let p=this.attachments[r];if(p)for(let y in p){let b=p[y];b&&h.push(new Nf(r,y,b))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(r,h){let p=0;for(let y=0;y<r.slots.length;y++){let b=r.slots[y],R=b.getAttachment();if(R&&p<h.attachments.length){let O=h.attachments[p];for(let T in O)if(R==O[T]){let U=this.getAttachment(p,T);U&&b.setAttachment(U);break}}p++}}}class rm{constructor(r,h,p){if(this.color=new Qr(1,1,1,1),r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");if(!p)throw new Error("boneData cannot be null.");this.index=r,this.name=h,this.boneData=p}}(function(a){a[a.Normal=0]="Normal",a[a.Additive=1]="Additive",a[a.Multiply=2]="Multiply",a[a.Screen=3]="Screen"})(zd||(zd={})),function(a){a[a.Region=0]="Region",a[a.BoundingBox=1]="BoundingBox",a[a.Mesh=2]="Mesh",a[a.LinkedMesh=3]="LinkedMesh",a[a.Path=4]="Path",a[a.Point=5]="Point",a[a.Clipping=6]="Clipping"}(md||(md={}));class nl{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new rf(()=>new Array),this.polygonIndicesPool=new rf(()=>new Array)}triangulate(r){let h=r,p=r.length>>1,y=this.indicesArray;y.length=0;for(let O=0;O<p;O++)y[O]=O;let b=this.isConcaveArray;b.length=0;for(let O=0,T=p;O<T;++O)b[O]=nl.isConcave(O,p,h,y);let R=this.triangles;for(R.length=0;p>3;){let O=p-1,T=0,U=1;for(;;){e:if(!b[T]){let ne=y[O]<<1,ve=y[T]<<1,be=y[U]<<1,Te=h[ne],Le=h[ne+1],Ie=h[ve],Oe=h[ve+1],Fe=h[be],je=h[be+1];for(let Ue=(U+1)%p;Ue!=O;Ue=(Ue+1)%p){if(!b[Ue])continue;let Je=y[Ue]<<1,pt=h[Je],at=h[Je+1];if(nl.positiveArea(Fe,je,Te,Le,pt,at)&&nl.positiveArea(Te,Le,Ie,Oe,pt,at)&&nl.positiveArea(Ie,Oe,Fe,je,pt,at))break e}break}if(0==U){do{if(!b[T])break;T--}while(T>0);break}O=T,T=U,U=(U+1)%p}R.push(y[(p+T-1)%p]),R.push(y[T]),R.push(y[(T+1)%p]),y.splice(T,1),b.splice(T,1),p--;let ee=(p+T-1)%p,ie=T==p?0:T;b[ee]=nl.isConcave(ee,p,h,y),b[ie]=nl.isConcave(ie,p,h,y)}return 3==p&&(R.push(y[2]),R.push(y[0]),R.push(y[1])),R}decompose(r,h){let p=r,y=this.convexPolygons;this.polygonPool.freeAll(y),y.length=0;let b=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(b),b.length=0;let R=this.polygonIndicesPool.obtain();R.length=0;let O=this.polygonPool.obtain();O.length=0;let T=-1,U=0;for(let ee=0,ie=h.length;ee<ie;ee+=3){let ne=h[ee]<<1,ve=h[ee+1]<<1,be=h[ee+2]<<1,Te=p[ne],Le=p[ne+1],Ie=p[ve],Oe=p[ve+1],Fe=p[be],je=p[be+1],Ue=!1;if(T==ne){let Je=O.length-4,pt=nl.winding(O[Je],O[Je+1],O[Je+2],O[Je+3],Fe,je),at=nl.winding(Fe,je,O[0],O[1],O[2],O[3]);pt==U&&at==U&&(O.push(Fe),O.push(je),R.push(be),Ue=!0)}Ue||(O.length>0?(y.push(O),b.push(R)):(this.polygonPool.free(O),this.polygonIndicesPool.free(R)),O=this.polygonPool.obtain(),O.length=0,O.push(Te),O.push(Le),O.push(Ie),O.push(Oe),O.push(Fe),O.push(je),R=this.polygonIndicesPool.obtain(),R.length=0,R.push(ne),R.push(ve),R.push(be),U=nl.winding(Te,Le,Ie,Oe,Fe,je),T=ne)}O.length>0&&(y.push(O),b.push(R));for(let ee=0,ie=y.length;ee<ie;ee++){if(R=b[ee],0==R.length)continue;let ne=R[0],ve=R[R.length-1];O=y[ee];let be=O.length-4,Te=O[be],Le=O[be+1],Ie=O[be+2],Oe=O[be+3],Fe=O[0],je=O[1],Ue=O[2],Je=O[3],pt=nl.winding(Te,Le,Ie,Oe,Fe,je);for(let at=0;at<ie;at++){if(at==ee)continue;let Mt=b[at];if(3!=Mt.length)continue;let jt=Mt[2],It=y[at],Nt=It[It.length-2],ft=It[It.length-1];if(Mt[0]!=ne||Mt[1]!=ve)continue;let $t=nl.winding(Te,Le,Ie,Oe,Nt,ft),Zt=nl.winding(Nt,ft,Fe,je,Ue,Je);$t==pt&&Zt==pt&&(It.length=0,Mt.length=0,O.push(Nt),O.push(ft),R.push(jt),Te=Ie,Le=Oe,Ie=Nt,Oe=ft,at=0)}}for(let ee=y.length-1;ee>=0;ee--)O=y[ee],0==O.length&&(y.splice(ee,1),this.polygonPool.free(O),R=b[ee],b.splice(ee,1),this.polygonIndicesPool.free(R));return y}static isConcave(r,h,p,y){let b=y[(h+r-1)%h]<<1,R=y[r]<<1,O=y[(r+1)%h]<<1;return!this.positiveArea(p[b],p[b+1],p[R],p[R+1],p[O],p[O+1])}static positiveArea(r,h,p,y,b,R){return r*(R-y)+p*(h-R)+b*(y-h)>=0}static winding(r,h,p,y,b,R){let O=p-r,T=y-h;return b*T-R*O+O*h-r*T>=0?1:-1}}class Ip{constructor(){this.triangulator=new nl,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}clipStart(r,h){if(this.clipAttachment)return 0;this.clipAttachment=h;let p=h.worldVerticesLength,y=gr.setArraySize(this.clippingPolygon,p);h.computeWorldVertices(r,0,p,y,0,2);let b=this.clippingPolygon;Ip.makeClockwise(b);let R=this.clippingPolygons=this.triangulator.decompose(b,this.triangulator.triangulate(b));for(let O=0,T=R.length;O<T;O++){let U=R[O];Ip.makeClockwise(U),U.push(U[0]),U.push(U[1])}return R.length}clipEndWithSlot(r){this.clipAttachment&&this.clipAttachment.endSlot==r.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(r,h,p,y,b,R,O,T){let U=this.clipOutput,ee=this.clippedVertices,ie=this.clippedTriangles,ne=this.clippingPolygons,ve=this.clippingPolygons.length,be=T?12:8,Te=0;ee.length=0,ie.length=0;e:for(let Le=0;Le<y;Le+=3){let Ie=p[Le]<<1,Oe=r[Ie],Fe=r[Ie+1],je=b[Ie],Ue=b[Ie+1];Ie=p[Le+1]<<1;let Je=r[Ie],pt=r[Ie+1],at=b[Ie],Mt=b[Ie+1];Ie=p[Le+2]<<1;let Tt=r[Ie],Yt=r[Ie+1],jt=b[Ie],It=b[Ie+1];for(let Nt=0;Nt<ve;Nt++){let ft=ee.length;if(!this.clip(Oe,Fe,Je,pt,Tt,Yt,ne[Nt],U)){let $t=gr.setArraySize(ee,ft+3*be);$t[ft]=Oe,$t[ft+1]=Fe,$t[ft+2]=R.r,$t[ft+3]=R.g,$t[ft+4]=R.b,$t[ft+5]=R.a,T?($t[ft+6]=je,$t[ft+7]=Ue,$t[ft+8]=O.r,$t[ft+9]=O.g,$t[ft+10]=O.b,$t[ft+11]=O.a,$t[ft+12]=Je,$t[ft+13]=pt,$t[ft+14]=R.r,$t[ft+15]=R.g,$t[ft+16]=R.b,$t[ft+17]=R.a,$t[ft+18]=at,$t[ft+19]=Mt,$t[ft+20]=O.r,$t[ft+21]=O.g,$t[ft+22]=O.b,$t[ft+23]=O.a,$t[ft+24]=Tt,$t[ft+25]=Yt,$t[ft+26]=R.r,$t[ft+27]=R.g,$t[ft+28]=R.b,$t[ft+29]=R.a,$t[ft+30]=jt,$t[ft+31]=It,$t[ft+32]=O.r,$t[ft+33]=O.g,$t[ft+34]=O.b,$t[ft+35]=O.a):($t[ft+6]=je,$t[ft+7]=Ue,$t[ft+8]=Je,$t[ft+9]=pt,$t[ft+10]=R.r,$t[ft+11]=R.g,$t[ft+12]=R.b,$t[ft+13]=R.a,$t[ft+14]=at,$t[ft+15]=Mt,$t[ft+16]=Tt,$t[ft+17]=Yt,$t[ft+18]=R.r,$t[ft+19]=R.g,$t[ft+20]=R.b,$t[ft+21]=R.a,$t[ft+22]=jt,$t[ft+23]=It),ft=ie.length;let Zt=gr.setArraySize(ie,ft+3);Zt[ft]=Te,Zt[ft+1]=Te+1,Zt[ft+2]=Te+2,Te+=3;continue e}{let $t=U.length;if(0==$t)continue;let Zt=pt-Yt,Tn=Tt-Je,$n=Oe-Tt,Qn=Yt-Fe,lr=1/(Zt*$n+Tn*(Fe-Yt)),jn=$t>>1,pr=this.clipOutput,Yn=gr.setArraySize(ee,ft+jn*be);for(let Or=0;Or<$t;Or+=2){let Ji=pr[Or],fo=pr[Or+1];Yn[ft]=Ji,Yn[ft+1]=fo,Yn[ft+2]=R.r,Yn[ft+3]=R.g,Yn[ft+4]=R.b,Yn[ft+5]=R.a;let wo=Ji-Tt,Uo=fo-Yt,cs=(Zt*wo+Tn*Uo)*lr,Ws=(Qn*wo+$n*Uo)*lr,Ga=1-cs-Ws;Yn[ft+6]=je*cs+at*Ws+jt*Ga,Yn[ft+7]=Ue*cs+Mt*Ws+It*Ga,T&&(Yn[ft+8]=O.r,Yn[ft+9]=O.g,Yn[ft+10]=O.b,Yn[ft+11]=O.a),ft+=be}ft=ie.length;let wr=gr.setArraySize(ie,ft+3*(jn-2));jn--;for(let Or=1;Or<jn;Or++)wr[ft]=Te,wr[ft+1]=Te+Or,wr[ft+2]=Te+Or+1,ft+=3;Te+=jn+1}}}}clip(r,h,p,y,b,R,O,T){let U=T,ee=!1,ie=null;O.length%4>=2?(ie=T,T=this.scratch):ie=this.scratch,ie.length=0,ie.push(r),ie.push(h),ie.push(p),ie.push(y),ie.push(b),ie.push(R),ie.push(r),ie.push(h),T.length=0;let ne=O,ve=O.length-4;for(let be=0;;be+=2){let Te=ne[be],Le=ne[be+1],Ie=ne[be+2],Oe=ne[be+3],Fe=Te-Ie,je=Le-Oe,Ue=ie,Je=ie.length-2,pt=T.length;for(let Mt=0;Mt<Je;Mt+=2){let Tt=Ue[Mt],Yt=Ue[Mt+1],jt=Ue[Mt+2],It=Ue[Mt+3],Nt=Fe*(It-Oe)-je*(jt-Ie)>0;if(Fe*(Yt-Oe)-je*(Tt-Ie)>0){if(Nt){T.push(jt),T.push(It);continue}let ft=It-Yt,$t=jt-Tt,Zt=ft*(Ie-Te)-$t*(Oe-Le);if(Math.abs(Zt)>1e-6){let Tn=($t*(Le-Yt)-ft*(Te-Tt))/Zt;T.push(Te+(Ie-Te)*Tn),T.push(Le+(Oe-Le)*Tn)}else T.push(Te),T.push(Le)}else if(Nt){let ft=It-Yt,$t=jt-Tt,Zt=ft*(Ie-Te)-$t*(Oe-Le);if(Math.abs(Zt)>1e-6){let Tn=($t*(Le-Yt)-ft*(Te-Tt))/Zt;T.push(Te+(Ie-Te)*Tn),T.push(Le+(Oe-Le)*Tn)}else T.push(Te),T.push(Le);T.push(jt),T.push(It)}ee=!0}if(pt==T.length)return U.length=0,!0;if(T.push(T[0]),T.push(T[1]),be==ve)break;let at=T;(T=ie).length=0,ie=at}if(U!=T){U.length=0;for(let be=0,Te=T.length-2;be<Te;be++)U[be]=T[be]}else U.length=U.length-2;return ee}static makeClockwise(r){let h=r,p=r.length,y=h[p-2]*h[1]-h[0]*h[p-1],b=0,R=0,O=0,T=0;for(let U=0,ee=p-3;U<ee;U+=2)b=h[U],R=h[U+1],O=h[U+2],T=h[U+3],y+=b*T-O*R;if(!(y<0))for(let U=0,ee=p-2,ie=p>>1;U<ie;U+=2){let ne=h[U],ve=h[U+1],be=ee-U;h[U]=h[be],h[U+1]=h[be+1],h[be]=ne,h[be+1]=ve}}}class df{constructor(r){this.name=r}}class Vd{constructor(r,h){if(!h)throw new Error("data cannot be null.");this.time=r,this.data=h}}class Op extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}}class ff{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findSkin(r){if(!r)throw new Error("skinName cannot be null.");let h=this.skins;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findEvent(r){if(!r)throw new Error("eventDataName cannot be null.");let h=this.events;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findAnimation(r){if(!r)throw new Error("animationName cannot be null.");let h=this.animations;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}}class im extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}}class om{constructor(r){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=r}readSkeletonData(r){let h=this.scale,p=new ff,y="string"==typeof r?JSON.parse(r):r,b=y.skeleton;if(b&&(p.hash=b.hash,p.version=b.spine,p.x=b.x,p.y=b.y,p.width=b.width,p.height=b.height,p.fps=b.fps,p.imagesPath=b.images),y.bones)for(let R=0;R<y.bones.length;R++){let O=y.bones[R],T=null,U=ln(O,"parent",null);U&&(T=p.findBone(U));let ee=new vd(p.bones.length,O.name,T);ee.length=ln(O,"length",0)*h,ee.x=ln(O,"x",0)*h,ee.y=ln(O,"y",0)*h,ee.rotation=ln(O,"rotation",0),ee.scaleX=ln(O,"scaleX",1),ee.scaleY=ln(O,"scaleY",1),ee.shearX=ln(O,"shearX",0),ee.shearY=ln(O,"shearY",0),ee.transformMode=gr.enumValue(Ic,ln(O,"transform","Normal")),ee.skinRequired=ln(O,"skin",!1);let ie=ln(O,"color",null);ie&&ee.color.setFromString(ie),p.bones.push(ee)}if(y.slots)for(let R=0;R<y.slots.length;R++){let O=y.slots[R],T=p.findBone(O.bone),U=new rm(p.slots.length,O.name,T),ee=ln(O,"color",null);ee&&U.color.setFromString(ee);let ie=ln(O,"dark",null);ie&&(U.darkColor=Qr.fromString(ie)),U.attachmentName=ln(O,"attachment",null),U.blendMode=gr.enumValue(zd,ln(O,"blend","normal")),p.slots.push(U)}if(y.ik)for(let R=0;R<y.ik.length;R++){let O=y.ik[R],T=new Op(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let U=0;U<O.bones.length;U++)T.bones.push(p.findBone(O.bones[U]));T.target=p.findBone(O.target),T.mix=ln(O,"mix",1),T.softness=ln(O,"softness",0)*h,T.bendDirection=ln(O,"bendPositive",!0)?1:-1,T.compress=ln(O,"compress",!1),T.stretch=ln(O,"stretch",!1),T.uniform=ln(O,"uniform",!1),p.ikConstraints.push(T)}if(y.transform)for(let R=0;R<y.transform.length;R++){let O=y.transform[R],T=new im(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let ee=0;ee<O.bones.length;ee++)T.bones.push(p.findBone(O.bones[ee]));T.target=p.findBone(O.target),T.local=ln(O,"local",!1),T.relative=ln(O,"relative",!1),T.offsetRotation=ln(O,"rotation",0),T.offsetX=ln(O,"x",0)*h,T.offsetY=ln(O,"y",0)*h,T.offsetScaleX=ln(O,"scaleX",0),T.offsetScaleY=ln(O,"scaleY",0),T.offsetShearY=ln(O,"shearY",0),T.mixRotate=ln(O,"mixRotate",1),T.mixX=ln(O,"mixX",1),T.mixY=ln(O,"mixY",T.mixX),T.mixScaleX=ln(O,"mixScaleX",1),T.mixScaleY=ln(O,"mixScaleY",T.mixScaleX),T.mixShearY=ln(O,"mixShearY",1),p.transformConstraints.push(T)}if(y.path)for(let R=0;R<y.path.length;R++){let O=y.path[R],T=new Gd(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let ee=0;ee<O.bones.length;ee++)T.bones.push(p.findBone(O.bones[ee]));T.target=p.findSlot(O.target),T.positionMode=gr.enumValue(sc,ln(O,"positionMode","Percent")),T.spacingMode=gr.enumValue(ac,ln(O,"spacingMode","Length")),T.rotateMode=gr.enumValue(fd,ln(O,"rotateMode","Tangent")),T.offsetRotation=ln(O,"rotation",0),T.position=ln(O,"position",0),T.positionMode==sc.Fixed&&(T.position*=h),T.spacing=ln(O,"spacing",0),T.spacingMode!=ac.Length&&T.spacingMode!=ac.Fixed||(T.spacing*=h),T.mixRotate=ln(O,"mixRotate",1),T.mixX=ln(O,"mixX",1),T.mixY=ln(O,"mixY",T.mixX),p.pathConstraints.push(T)}if(y.skins)for(let R=0;R<y.skins.length;R++){let O=y.skins[R],T=new Rf(O.name);if(O.bones)for(let U=0;U<O.bones.length;U++)T.bones.push(p.findBone(O.bones[U]));if(O.ik)for(let U=0;U<O.ik.length;U++)T.constraints.push(p.findIkConstraint(O.ik[U]));if(O.transform)for(let U=0;U<O.transform.length;U++)T.constraints.push(p.findTransformConstraint(O.transform[U]));if(O.path)for(let U=0;U<O.path.length;U++)T.constraints.push(p.findPathConstraint(O.path[U]));for(let U in O.attachments){let ee=p.findSlot(U),ie=O.attachments[U];for(let ne in ie){let ve=this.readAttachment(ie[ne],T,ee.index,ne,p);ve&&T.setAttachment(ee.index,ne,ve)}}p.skins.push(T),"default"==T.name&&(p.defaultSkin=T)}for(let R=0,O=this.linkedMeshes.length;R<O;R++){let T=this.linkedMeshes[R],U=(T.skin?p.findSkin(T.skin):p.defaultSkin).getAttachment(T.slotIndex,T.parent);T.mesh.deformAttachment=T.inheritDeform?U:T.mesh,T.mesh.setParentMesh(U),T.mesh.updateUVs()}if(this.linkedMeshes.length=0,y.events)for(let R in y.events){let O=y.events[R],T=new df(R);T.intValue=ln(O,"int",0),T.floatValue=ln(O,"float",0),T.stringValue=ln(O,"string",""),T.audioPath=ln(O,"audio",null),T.audioPath&&(T.volume=ln(O,"volume",1),T.balance=ln(O,"balance",0)),p.events.push(T)}if(y.animations)for(let R in y.animations)this.readAnimation(y.animations[R],R,p);return p}readAttachment(r,h,p,y,b){let R=this.scale;switch(y=ln(r,"name",y),ln(r,"type","region")){case"region":{let O=ln(r,"path",y),T=this.attachmentLoader.newRegionAttachment(h,y,O);if(!T)return null;T.path=O,T.x=ln(r,"x",0)*R,T.y=ln(r,"y",0)*R,T.scaleX=ln(r,"scaleX",1),T.scaleY=ln(r,"scaleY",1),T.rotation=ln(r,"rotation",0),T.width=r.width*R,T.height=r.height*R;let U=ln(r,"color",null);return U&&T.color.setFromString(U),T.updateOffset(),T}case"boundingbox":{let O=this.attachmentLoader.newBoundingBoxAttachment(h,y);if(!O)return null;this.readVertices(r,O,r.vertexCount<<1);let T=ln(r,"color",null);return T&&O.color.setFromString(T),O}case"mesh":case"linkedmesh":{let O=ln(r,"path",y),T=this.attachmentLoader.newMeshAttachment(h,y,O);if(!T)return null;T.path=O;let U=ln(r,"color",null);U&&T.color.setFromString(U),T.width=ln(r,"width",0)*R,T.height=ln(r,"height",0)*R;let ee=ln(r,"parent",null);if(ee)return this.linkedMeshes.push(new mf(T,ln(r,"skin",null),p,ee,ln(r,"deform",!0))),T;let ie=r.uvs;return this.readVertices(r,T,ie.length),T.triangles=r.triangles,T.regionUVs=ie,T.updateUVs(),T.edges=ln(r,"edges",null),T.hullLength=2*ln(r,"hull",0),T}case"path":{let O=this.attachmentLoader.newPathAttachment(h,y);if(!O)return null;O.closed=ln(r,"closed",!1),O.constantSpeed=ln(r,"constantSpeed",!0);let T=r.vertexCount;this.readVertices(r,O,T<<1);let U=gr.newArray(T/3,0);for(let ie=0;ie<r.lengths.length;ie++)U[ie]=r.lengths[ie]*R;O.lengths=U;let ee=ln(r,"color",null);return ee&&O.color.setFromString(ee),O}case"point":{let O=this.attachmentLoader.newPointAttachment(h,y);if(!O)return null;O.x=ln(r,"x",0)*R,O.y=ln(r,"y",0)*R,O.rotation=ln(r,"rotation",0);let T=ln(r,"color",null);return T&&O.color.setFromString(T),O}case"clipping":{let O=this.attachmentLoader.newClippingAttachment(h,y);if(!O)return null;let T=ln(r,"end",null);T&&(O.endSlot=b.findSlot(T)),this.readVertices(r,O,r.vertexCount<<1);let ee=ln(r,"color",null);return ee&&O.color.setFromString(ee),O}}return null}readVertices(r,h,p){let y=this.scale;h.worldVerticesLength=p;let b=r.vertices;if(p==b.length){let T=gr.toFloatArray(b);if(1!=y)for(let U=0,ee=b.length;U<ee;U++)T[U]*=y;return void(h.vertices=T)}let R=new Array,O=new Array;for(let T=0,U=b.length;T<U;){let ee=b[T++];O.push(ee);for(let ie=T+4*ee;T<ie;T+=4)O.push(b[T]),R.push(b[T+1]*y),R.push(b[T+2]*y),R.push(b[T+3])}h.bones=O,h.vertices=gr.toFloatArray(R)}readAnimation(r,h,p){let y=this.scale,b=new Array;if(r.slots)for(let O in r.slots){let T=r.slots[O],U=p.findSlot(O).index;for(let ee in T){let ie=T[ee];if(!ie)continue;let ne=ie.length;if("attachment"==ee){let ve=new dd(ne,U);for(let be=0;be<ne;be++){let Te=ie[be];ve.setFrame(be,ln(Te,"time",0),Te.name)}b.push(ve)}else if("rgba"==ee){let ve=new Jf(ne,ne<<2,U),be=ie[0],Te=ln(be,"time",0),Le=Qr.fromString(be.color);for(let Ie=0,Oe=0;;Ie++){ve.setFrame(Ie,Te,Le.r,Le.g,Le.b,Le.a);let Fe=ie[Ie+1];if(!Fe){ve.shrink(Oe);break}let je=ln(Fe,"time",0),Ue=Qr.fromString(Fe.color),Je=be.curve;Je&&(Oe=zi(Je,ve,Oe,Ie,0,Te,je,Le.r,Ue.r,1),Oe=zi(Je,ve,Oe,Ie,1,Te,je,Le.g,Ue.g,1),Oe=zi(Je,ve,Oe,Ie,2,Te,je,Le.b,Ue.b,1),Oe=zi(Je,ve,Oe,Ie,3,Te,je,Le.a,Ue.a,1)),Te=je,Le=Ue,be=Fe}b.push(ve)}else if("rgb"==ee){let ve=new Od(ne,3*ne,U),be=ie[0],Te=ln(be,"time",0),Le=Qr.fromString(be.color);for(let Ie=0,Oe=0;;Ie++){ve.setFrame(Ie,Te,Le.r,Le.g,Le.b);let Fe=ie[Ie+1];if(!Fe){ve.shrink(Oe);break}let je=ln(Fe,"time",0),Ue=Qr.fromString(Fe.color),Je=be.curve;Je&&(Oe=zi(Je,ve,Oe,Ie,0,Te,je,Le.r,Ue.r,1),Oe=zi(Je,ve,Oe,Ie,1,Te,je,Le.g,Ue.g,1),Oe=zi(Je,ve,Oe,Ie,2,Te,je,Le.b,Ue.b,1)),Te=je,Le=Ue,be=Fe}b.push(ve)}else if("alpha"==ee)b.push(Cu(ie,new Nm(ne,ne,U),0,1));else if("rgba2"==ee){let ve=new Rm(ne,7*ne,U),be=ie[0],Te=ln(be,"time",0),Le=Qr.fromString(be.light),Ie=Qr.fromString(be.dark);for(let Oe=0,Fe=0;;Oe++){ve.setFrame(Oe,Te,Le.r,Le.g,Le.b,Le.a,Ie.r,Ie.g,Ie.b);let je=ie[Oe+1];if(!je){ve.shrink(Fe);break}let Ue=ln(je,"time",0),Je=Qr.fromString(je.light),pt=Qr.fromString(je.dark),at=be.curve;at&&(Fe=zi(at,ve,Fe,Oe,0,Te,Ue,Le.r,Je.r,1),Fe=zi(at,ve,Fe,Oe,1,Te,Ue,Le.g,Je.g,1),Fe=zi(at,ve,Fe,Oe,2,Te,Ue,Le.b,Je.b,1),Fe=zi(at,ve,Fe,Oe,3,Te,Ue,Le.a,Je.a,1),Fe=zi(at,ve,Fe,Oe,4,Te,Ue,Ie.r,pt.r,1),Fe=zi(at,ve,Fe,Oe,5,Te,Ue,Ie.g,pt.g,1),Fe=zi(at,ve,Fe,Oe,6,Te,Ue,Ie.b,pt.b,1)),Te=Ue,Le=Je,Ie=pt,be=je}b.push(ve)}else if("rgb2"==ee){let ve=new kd(ne,6*ne,U),be=ie[0],Te=ln(be,"time",0),Le=Qr.fromString(be.light),Ie=Qr.fromString(be.dark);for(let Oe=0,Fe=0;;Oe++){ve.setFrame(Oe,Te,Le.r,Le.g,Le.b,Ie.r,Ie.g,Ie.b);let je=ie[Oe+1];if(!je){ve.shrink(Fe);break}let Ue=ln(je,"time",0),Je=Qr.fromString(je.light),pt=Qr.fromString(je.dark),at=be.curve;at&&(Fe=zi(at,ve,Fe,Oe,0,Te,Ue,Le.r,Je.r,1),Fe=zi(at,ve,Fe,Oe,1,Te,Ue,Le.g,Je.g,1),Fe=zi(at,ve,Fe,Oe,2,Te,Ue,Le.b,Je.b,1),Fe=zi(at,ve,Fe,Oe,3,Te,Ue,Ie.r,pt.r,1),Fe=zi(at,ve,Fe,Oe,4,Te,Ue,Ie.g,pt.g,1),Fe=zi(at,ve,Fe,Oe,5,Te,Ue,Ie.b,pt.b,1)),Te=Ue,Le=Je,Ie=pt,be=je}b.push(ve)}}}if(r.bones)for(let O in r.bones){let T=r.bones[O],U=p.findBone(O).index;for(let ee in T){let ie=T[ee],ne=ie.length;if(0!=ne)if("rotate"===ee)b.push(Cu(ie,new sf(ne,ne,U),0,1));else if("translate"===ee){let ve=new Vf(ne,ne<<1,U);b.push(Wd(ie,ve,"x","y",0,y))}else if("translatex"===ee){let ve=new Wf(ne,ne,U);b.push(Cu(ie,ve,0,y))}else if("translatey"===ee){let ve=new Cf(ne,ne,U);b.push(Cu(ie,ve,0,y))}else if("scale"===ee){let ve=new qf(ne,ne<<1,U);b.push(Wd(ie,ve,"x","y",1,1))}else if("scalex"===ee){let ve=new Lm(ne,ne,U);b.push(Cu(ie,ve,1,1))}else if("scaley"===ee){let ve=new Bp(ne,ne,U);b.push(Cu(ie,ve,1,1))}else if("shear"===ee){let ve=new Xf(ne,ne<<1,U);b.push(Wd(ie,ve,"x","y",0,1))}else if("shearx"===ee){let ve=new Bm(ne,ne,U);b.push(Cu(ie,ve,0,1))}else if("sheary"===ee){let ve=new Yf(ne,ne,U);b.push(Cu(ie,ve,0,1))}}}if(r.ik)for(let O in r.ik){let T=r.ik[O],U=T[0];if(!U)continue;let ee=p.findIkConstraint(O),ie=p.ikConstraints.indexOf(ee),ne=new Pm(T.length,T.length<<1,ie),ve=ln(U,"time",0),be=ln(U,"mix",1),Te=ln(U,"softness",0)*y;for(let Le=0,Ie=0;;Le++){ne.setFrame(Le,ve,be,Te,ln(U,"bendPositive",!0)?1:-1,ln(U,"compress",!1),ln(U,"stretch",!1));let Oe=T[Le+1];if(!Oe){ne.shrink(Ie);break}let Fe=ln(Oe,"time",0),je=ln(Oe,"mix",1),Ue=ln(Oe,"softness",0)*y,Je=U.curve;Je&&(Ie=zi(Je,ne,Ie,Le,0,ve,Fe,be,je,1),Ie=zi(Je,ne,Ie,Le,1,ve,Fe,Te,Ue,y)),ve=Fe,be=je,Te=Ue,U=Oe}b.push(ne)}if(r.transform)for(let O in r.transform){let T=r.transform[O],U=T[0];if(!U)continue;let ee=p.findTransformConstraint(O),ie=p.transformConstraints.indexOf(ee),ne=new Im(T.length,6*T.length,ie),ve=ln(U,"time",0),be=ln(U,"mixRotate",1),Te=ln(U,"mixX",1),Le=ln(U,"mixY",Te),Ie=ln(U,"mixScaleX",1),Oe=ln(U,"mixScaleY",Ie),Fe=ln(U,"mixShearY",1);for(let je=0,Ue=0;;je++){ne.setFrame(je,ve,be,Te,Le,Ie,Oe,Fe);let Je=T[je+1];if(!Je){ne.shrink(Ue);break}let pt=ln(Je,"time",0),at=ln(Je,"mixRotate",1),Mt=ln(Je,"mixX",1),Tt=ln(Je,"mixY",Mt),Yt=ln(Je,"mixScaleX",1),jt=ln(Je,"mixScaleY",Yt),It=ln(Je,"mixShearY",1),Nt=U.curve;Nt&&(Ue=zi(Nt,ne,Ue,je,0,ve,pt,be,at,1),Ue=zi(Nt,ne,Ue,je,1,ve,pt,Te,Mt,1),Ue=zi(Nt,ne,Ue,je,2,ve,pt,Le,Tt,1),Ue=zi(Nt,ne,Ue,je,3,ve,pt,Ie,Yt,1),Ue=zi(Nt,ne,Ue,je,4,ve,pt,Oe,jt,1),Ue=zi(Nt,ne,Ue,je,5,ve,pt,Fe,It,1)),ve=pt,be=at,Te=Mt,Le=Tt,Ie=Yt,Oe=jt,Ie=Yt,U=Je}b.push(ne)}if(r.path)for(let O in r.path){let T=r.path[O],U=p.findPathConstraint(O),ee=p.pathConstraints.indexOf(U);for(let ie in T){let ne=T[ie],ve=ne[0];if(!ve)continue;let be=ne.length;if("position"===ie){let Te=new Om(be,be,ee);b.push(Cu(ne,Te,0,U.positionMode==sc.Fixed?y:1))}else if("spacing"===ie){let Te=new Qf(be,be,ee);b.push(Cu(ne,Te,0,U.spacingMode==ac.Length||U.spacingMode==ac.Fixed?y:1))}else if("mix"===ie){let Te=new km(be,3*be,ee),Le=ln(ve,"time",0),Ie=ln(ve,"mixRotate",1),Oe=ln(ve,"mixX",1),Fe=ln(ve,"mixY",Oe);for(let je=0,Ue=0;;je++){Te.setFrame(je,Le,Ie,Oe,Fe);let Je=ne[je+1];if(!Je){Te.shrink(Ue);break}let pt=ln(Je,"time",0),at=ln(Je,"mixRotate",1),Mt=ln(Je,"mixX",1),Tt=ln(Je,"mixY",Mt),Yt=ve.curve;Yt&&(Ue=zi(Yt,Te,Ue,je,0,Le,pt,Ie,at,1),Ue=zi(Yt,Te,Ue,je,1,Le,pt,Oe,Mt,1),Ue=zi(Yt,Te,Ue,je,2,Le,pt,Fe,Tt,1)),Le=pt,Ie=at,Oe=Mt,Fe=Tt,ve=Je}b.push(Te)}}}if(r.deform)for(let O in r.deform){let T=r.deform[O],U=p.findSkin(O);for(let ee in T){let ie=T[ee],ne=p.findSlot(ee).index;for(let ve in ie){let be=ie[ve],Te=be[0];if(!Te)continue;let Le=U.getAttachment(ne,ve),Ie=Le.bones,Oe=Le.vertices,Fe=Ie?Oe.length/3*2:Oe.length,je=new Zf(be.length,be.length,ne,Le),Ue=ln(Te,"time",0);for(let Je=0,pt=0;;Je++){let at,Mt=ln(Te,"vertices",null);if(Mt){at=gr.newFloatArray(Fe);let It=ln(Te,"offset",0);if(gr.arrayCopy(Mt,0,at,It,Mt.length),1!=y)for(let Nt=It,ft=Nt+Mt.length;Nt<ft;Nt++)at[Nt]*=y;if(!Ie)for(let Nt=0;Nt<Fe;Nt++)at[Nt]+=Oe[Nt]}else at=Ie?gr.newFloatArray(Fe):Oe;je.setFrame(Je,Ue,at);let Tt=be[Je+1];if(!Tt){je.shrink(pt);break}let Yt=ln(Tt,"time",0),jt=Te.curve;jt&&(pt=zi(jt,je,pt,Je,0,Ue,Yt,0,1,1)),Ue=Yt,Te=Tt}b.push(je)}}}if(r.drawOrder){let O=new tp(r.drawOrder.length),T=p.slots.length,U=0;for(let ee=0;ee<r.drawOrder.length;ee++,U++){let ie=r.drawOrder[ee],ne=null,ve=ln(ie,"offsets",null);if(ve){ne=gr.newArray(T,-1);let be=gr.newArray(T-ve.length,0),Te=0,Le=0;for(let Ie=0;Ie<ve.length;Ie++){let Oe=ve[Ie],Fe=p.findSlot(Oe.slot).index;for(;Te!=Fe;)be[Le++]=Te++;ne[Te+Oe.offset]=Te++}for(;Te<T;)be[Le++]=Te++;for(let Ie=T-1;Ie>=0;Ie--)-1==ne[Ie]&&(ne[Ie]=be[--Le])}O.setFrame(U,ln(ie,"time",0),ne)}b.push(O)}if(r.events){let O=new Fd(r.events.length),T=0;for(let U=0;U<r.events.length;U++,T++){let ee=r.events[U],ie=p.findEvent(ee.name),ne=new Vd(gr.toSinglePrecision(ln(ee,"time",0)),ie);ne.intValue=ln(ee,"int",ie.intValue),ne.floatValue=ln(ee,"float",ie.floatValue),ne.stringValue=ln(ee,"string",ie.stringValue),ne.data.audioPath&&(ne.volume=ln(ee,"volume",1),ne.balance=ln(ee,"balance",0)),O.setFrame(T,ne)}b.push(O)}let R=0;for(let O=0,T=b.length;O<T;O++)R=Math.max(R,b[O].getDuration());p.animations.push(new $f(h,b,R))}}class mf{constructor(r,h,p,y,b){this.mesh=r,this.skin=h,this.slotIndex=p,this.parent=y,this.inheritDeform=b}}function Cu(a,r,h,p){let y=a[0],b=ln(y,"time",0),R=ln(y,"value",h)*p,O=0;for(let T=0;;T++){r.setFrame(T,b,R);let U=a[T+1];if(!U)return r.shrink(O),r;let ee=ln(U,"time",0),ie=ln(U,"value",h)*p;y.curve&&(O=zi(y.curve,r,O,T,0,b,ee,R,ie,p)),b=ee,R=ie,y=U}}function Wd(a,r,h,p,y,b){let R=a[0],O=ln(R,"time",0),T=ln(R,h,y)*b,U=ln(R,p,y)*b,ee=0;for(let ie=0;;ie++){r.setFrame(ie,O,T,U);let ne=a[ie+1];if(!ne)return r.shrink(ee),r;let ve=ln(ne,"time",0),be=ln(ne,h,y)*b,Te=ln(ne,p,y)*b,Le=R.curve;Le&&(ee=zi(Le,r,ee,ie,0,O,ve,T,be,b),ee=zi(Le,r,ee,ie,1,O,ve,U,Te,b)),O=ve,T=be,U=Te,R=ne}}function zi(a,r,h,p,y,b,R,O,T,U){if("stepped"==a)return r.setStepped(p),h;let ee=y<<2;return r.setBezier(h,p,y,b,O,a[ee],a[ee+1]*U,a[ee+2],a[ee+3]*U,R,T),h+1}function ln(a,r,h){return void 0!==a[r]?a[r]:h}void 0===Math.fround&&(Math.fround=(cf=new Float32Array(1),function(a){return cf[0]=a,cf[0]}));class Yp{constructor(r){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=r}begin(r){this.worldX=r.x+this.centerX,this.worldY=r.y+this.centerY}transform(r,h,p,y){let b=this.angle*Cn.degreesToRadians,R=r.x-this.worldX,O=r.y-this.worldY,T=Math.sqrt(R*R+O*O);if(T<this.radius){let U=Yp.interpolation.apply(0,b,(this.radius-T)/this.radius),ee=Math.cos(U),ie=Math.sin(U);r.x=ee*R-ie*O+this.worldX,r.y=ie*R+ee*O+this.worldY}}end(){}}Yp.interpolation=new class extends Cm{constructor(a){super(a)}applyInternal(a){return Math.pow(a-1,this.power)*(this.power%2==0?-1:1)+1}}(2);var Zo=__webpack_require__(175);class $o extends np{constructor(r){super(r),this.texture=new Zo.Texture(r),this.texture.flipY=!1,this.texture.needsUpdate=!0}setFilters(r,h){this.texture.minFilter=$o.toThreeJsTextureFilter(r),this.texture.magFilter=$o.toThreeJsTextureFilter(h)}setWraps(r,h){this.texture.wrapS=$o.toThreeJsTextureWrap(r),this.texture.wrapT=$o.toThreeJsTextureWrap(h)}dispose(){this.texture.dispose()}static toThreeJsTextureFilter(r){if(r===ta.Linear)return Zo.LinearFilter;if(r===ta.MipMap)return Zo.LinearMipMapLinearFilter;if(r===ta.MipMapLinearNearest)return Zo.LinearMipMapNearestFilter;if(r===ta.MipMapNearestLinear)return Zo.NearestMipMapLinearFilter;if(r===ta.MipMapNearestNearest)return Zo.NearestMipMapNearestFilter;if(r===ta.Nearest)return Zo.NearestFilter;throw new Error("Unknown texture filter: "+r)}static toThreeJsTextureWrap(r){if(r===Ch.ClampToEdge)return Zo.ClampToEdgeWrapping;if(r===Ch.MirroredRepeat)return Zo.MirroredRepeatWrapping;if(r===Ch.Repeat)return Zo.RepeatWrapping;throw new Error("Unknown texture wrap: "+r)}}class sm extends Zo.ShaderMaterial{constructor(r){let h={uniforms:{map:{type:"t",value:null}},vertexShader:"\n\t\t\t\tattribute vec4 color;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tvColor = color;\n\t\t\t\t\tgl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tuniform sampler2D map;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main(void) {\n\t\t\t\t\tgl_FragColor = texture2D(map, vUv)*vColor;\n\t\t\t\t}\n\t\t\t",side:Zo.DoubleSide,transparent:!0,alphaTest:.5};r(h),super(h)}}class Yi extends Zo.Object3D{constructor(r,h=(p=>{})){super(),this.tempPos=new of,this.tempUv=new of,this.tempLight=new Qr,this.tempDark=new Qr,this.zOffset=.1,this.batches=new Array,this.nextBatchIndex=0,this.clipper=new Ip,this.vertices=gr.newFloatArray(1024),this.tempColor=new Qr,this.materialCustomizer=h,this.skeleton=new pf(r);let p=new zm(r);this.state=new Dd(p)}update(r){let h=this.state,p=this.skeleton;h.update(r),h.apply(p),p.updateWorldTransform(),this.updateGeometry()}dispose(){for(var r=0;r<this.batches.length;r++)this.batches[r].dispose()}clearBatches(){for(var r=0;r<this.batches.length;r++)this.batches[r].clear(),this.batches[r].visible=!1;this.nextBatchIndex=0}nextBatch(){if(this.batches.length==this.nextBatchIndex){let h=new kp(10920,this.materialCustomizer);this.add(h),this.batches.push(h)}let r=this.batches[this.nextBatchIndex++];return r.visible=!0,r}updateGeometry(){this.clearBatches();let r=this.tempPos,h=this.tempUv,p=this.tempLight,y=this.tempDark,b=this.clipper,R=this.vertices,O=null,T=null,U=this.skeleton.drawOrder,ee=this.nextBatch();ee.begin();let ie=0,ne=this.zOffset;for(let ve=0,be=U.length;ve<be;ve++){let Te=b.isClipping()?2:Yi.VERTEX_SIZE,Le=U[ve];if(!Le.bone.active){b.clipEndWithSlot(Le);continue}let Ie=Le.getAttachment(),Oe=null,Fe=null,je=0;if(Ie instanceof _i){let Ue=Ie;Oe=Ue.color,R=this.vertices,je=4*Te,Ue.computeWorldVertices(Le.bone,R,0,Te),O=Yi.QUAD_TRIANGLES,T=Ue.uvs,Fe=Ue.region.renderObject.page.texture}else{if(!(Ie instanceof Oa)){if(Ie instanceof Ud){b.clipStart(Le,Ie);continue}b.clipEndWithSlot(Le);continue}{let Ue=Ie;Oe=Ue.color,R=this.vertices,je=(Ue.worldVerticesLength>>1)*Te,je>R.length&&(R=this.vertices=gr.newFloatArray(je)),Ue.computeWorldVertices(Le,0,Ue.worldVerticesLength,R,0,Te),O=Ue.triangles,T=Ue.uvs,Fe=Ue.region.renderObject.page.texture}}if(Fe){let Ue,Je,pt,at,Mt=Le.bone.skeleton.color,Tt=Le.color,jt=this.tempColor;if(jt.set(Mt.r*Tt.r*Oe.r,Mt.g*Tt.g*Oe.g,Mt.b*Tt.b*Oe.b,Mt.a*Tt.a*Oe.a),b.isClipping()){b.clipTriangles(R,je,O,O.length,T,jt,null,!1);let Nt=b.clippedVertices,ft=b.clippedTriangles;if(this.vertexEffect){let $t=this.vertexEffect,Zt=Nt;for(let Tn=0,$n=Nt.length;Tn<$n;Tn+=Te)r.x=Zt[Tn],r.y=Zt[Tn+1],p.setFromColor(jt),y.set(0,0,0,0),h.x=Zt[Tn+6],h.y=Zt[Tn+7],$t.transform(r,h,p,y),Zt[Tn]=r.x,Zt[Tn+1]=r.y,Zt[Tn+2]=p.r,Zt[Tn+3]=p.g,Zt[Tn+4]=p.b,Zt[Tn+5]=p.a,Zt[Tn+6]=h.x,Zt[Tn+7]=h.y}Ue=Nt,Je=Nt.length,pt=ft,at=ft.length}else{let Nt=R;if(this.vertexEffect){let ft=this.vertexEffect;for(let $t=0,Zt=0,Tn=je;$t<Tn;$t+=Te,Zt+=2)r.x=Nt[$t],r.y=Nt[$t+1],p.setFromColor(jt),y.set(0,0,0,0),h.x=T[Zt],h.y=T[Zt+1],ft.transform(r,h,p,y),Nt[$t]=r.x,Nt[$t+1]=r.y,Nt[$t+2]=p.r,Nt[$t+3]=p.g,Nt[$t+4]=p.b,Nt[$t+5]=p.a,Nt[$t+6]=h.x,Nt[$t+7]=h.y}else for(let ft=2,$t=0,Zt=je;ft<Zt;ft+=Te,$t+=2)Nt[ft]=jt.r,Nt[ft+1]=jt.g,Nt[ft+2]=jt.b,Nt[ft+3]=jt.a,Nt[ft+4]=T[$t],Nt[ft+5]=T[$t+1];Ue=R,Je=je,pt=O,at=O.length}if(0==Je||0==at){b.clipEndWithSlot(Le);continue}ee.canBatch(Je,at)||(ee.end(),ee=this.nextBatch(),ee.begin());let It=ee.material;It.uniforms.map.value||(It.uniforms.map.value=Fe.texture),It.uniforms.map.value!=Fe.texture&&(ee.end(),ee=this.nextBatch(),ee.begin(),It=ee.material,It.uniforms.map.value=Fe.texture),It.needsUpdate=!0,ee.batch(Ue,Je,pt,at,ie),ie+=ne}b.clipEndWithSlot(Le)}b.clipEnd(),ee.end()}}Yi.QUAD_TRIANGLES=[0,1,2,2,3,0],Yi.VERTEX_SIZE=8;class kp extends Zo.Mesh{constructor(r=10920,h=(p=>{})){if(super(),this.verticesLength=0,this.indicesLength=0,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);let p=this.vertices=new Float32Array(r*kp.VERTEX_SIZE),y=this.indices=new Uint16Array(3*r),b=new Zo.BufferGeometry,R=this.vertexBuffer=new Zo.InterleavedBuffer(p,kp.VERTEX_SIZE);R.usage=WebGLRenderingContext.DYNAMIC_DRAW,b.setAttribute("position",new Zo.InterleavedBufferAttribute(R,3,0,!1)),b.setAttribute("color",new Zo.InterleavedBufferAttribute(R,4,3,!1)),b.setAttribute("uv",new Zo.InterleavedBufferAttribute(R,2,7,!1)),b.setIndex(new Zo.BufferAttribute(y,1)),b.getIndex().usage=WebGLRenderingContext.DYNAMIC_DRAW,b.drawRange.start=0,b.drawRange.count=0,this.geometry=b,this.material=new sm(h)}dispose(){if(this.geometry.dispose(),this.material instanceof Zo.Material)this.material.dispose();else if(this.material)for(let r=0;r<this.material.length;r++){let h=this.material[r];h instanceof Zo.Material&&h.dispose()}}clear(){let r=this.geometry;return r.drawRange.start=0,r.drawRange.count=0,this.material.uniforms.map.value=null,this}begin(){this.verticesLength=0,this.indicesLength=0}canBatch(r,h){return!(this.indicesLength+h>=this.indices.byteLength/2||this.verticesLength+r>=this.vertices.byteLength/2)}batch(r,h,p,y,b=0){let R=this.verticesLength/kp.VERTEX_SIZE,O=this.vertices,T=this.verticesLength,U=0;for(;U<h;)O[T++]=r[U++],O[T++]=r[U++],O[T++]=b,O[T++]=r[U++],O[T++]=r[U++],O[T++]=r[U++],O[T++]=r[U++],O[T++]=r[U++],O[T++]=r[U++];this.verticesLength=T;let ee=this.indices;for(T=this.indicesLength,U=0;U<y;T++,U++)ee[T]=p[U]+R;this.indicesLength+=y}end(){this.vertexBuffer.needsUpdate=this.verticesLength>0,this.vertexBuffer.updateRange.offset=0,this.vertexBuffer.updateRange.count=this.verticesLength;let r=this.geometry;r.getIndex().needsUpdate=this.indicesLength>0,r.getIndex().updateRange.offset=0,r.getIndex().updateRange.count=this.indicesLength,r.drawRange.start=0,r.drawRange.count=this.indicesLength}}function Lu(a){$o.call(this,a.image),this.texture=a,this.texture.flipY=!1}function ka(a,r,h,p){void 0===p&&(p=[]);var y=new _d(r,function(O){for(var T=0;T<p.length;T++)if(p[T].name===O){var U=new Lu(p[T].texture);break}T===p.length&&(U=new Lu(new gs(new ms(h+"/"+O))),p.push({name:O,texture:U.texture}));var ee=U.texture.image,ie=U.texture.source;if(ie.width>0&&ie.height>0)ee.width=ie.width,ee.height=ie.height;else if(0!==ee.naturalWidth&&0!==ee.naturalHeight)ee.width=ee.naturalWidth,ee.height=ee.naturalHeight,ie.width=ee.width,ie.height=ee.height;else{var ne=r.search("size: "),ve=r.search("\nformat"),be=r.substring(ne+6,ve);be=be.split(","),ee.width=parseInt(be[0]),ee.height=parseInt(be[1])}return U}),b=new gd(y),R=new om(b).readSkeletonData(a);Yi.call(this,R),this.name="spine",this.type="SpineAnimation",this.scale.set(.01,.01,.01),this.json=a,this.atlas=r,this.textures=p,this.skin=this.getSkins().length>0?this.getSkins()[0].name:null,this.animation=this.getAnimations().length>0?this.getAnimations()[0].name:null,this.track=0,this.loop=!0,this.clock=new l.Clock,this.play()}function Gs(a,r,h,p,y,b){l.SpotLight.call(this,a,r,h,p,y,b),this.name="spotlight",this.castShadow=!0,this.shadow.camera.near=.05,this.shadow.camera.far=5e3,this.shadow.mapSize.width=512,this.shadow.mapSize.height=512}function Oc(a){l.Sprite.call(this,a),this.name="sprite"}kp.VERTEX_SIZE=9,Lu.prototype=Object.create($o.prototype),(ka.prototype=Object.create(Yi.prototype)).update=function(a){Yi.prototype.update.call(this,a),l.Object3D.prototype.update.call(this)},ka.prototype.onBeforeRender=function(){this.state.update(this.clock.getDelta()),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform(),this.updateGeometry()},ka.prototype.play=function(){null!==this.animation&&this.setAnimation(this.track,this.animation,this.loop),null!==this.skin&&this.setSkin(this.skin)},ka.prototype.getAnimations=function(){return this.state.data.skeletonData.animations},ka.prototype.setAnimation=function(a,r,h){try{void 0!==a&&(this.track=a),void 0!==r&&(this.animation=r),void 0!==h&&(this.loop=h),this.state.setAnimation(this.track,this.animation,this.loop)}catch{this.animation=null,console.warn("nunuStudio: Error setting spine animation "+name+" on track "+a)}},ka.prototype.getSkins=function(){return this.state.data.skeletonData.skins},ka.prototype.setSkin=function(a){try{this.skeleton.setSkinByName(a),this.skin=a}catch{this.skin=null,console.warn("nunuStudio: Error setting spine skin "+a)}},ka.prototype.toJSON=function(a){var r=[],h=this,p=l.Object3D.prototype.toJSON.call(this,a,function(y){for(var b=0;b<h.textures.length;b++){var R=h.textures[b].texture.toJSON(y);r.push({name:h.textures[b].name,texture:R.uuid})}});return p.object.json=this.json,p.object.atlas=this.atlas,p.object.textures=r,null!==this.animation&&(p.object.animation=this.animation,p.object.track=this.track,p.object.loop=this.loop),null!==this.skin&&(p.object.skin=this.skin),p},(Gs.prototype=Object.create(l.SpotLight.prototype)).setTarget=function(a){this.target=a},Gs.prototype.updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()},Gs.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.target=this.target.uuid,r},(Oc.prototype=Object.create(l.Sprite.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),l.Object3D.prototype.dispose.call(this)};var bs=__webpack_require__(980);function Ii(a){l.Group.call(this),this.type="PythonScript",this.name="script",this.code=void 0!==a?a:Ii.DEFAULT,this.script={},this.program=null,this.scene=null}Ii.prototype=Object.create(l.Group.prototype),Ii.DEFAULT="def initialize(obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass\n\ndef update(delta, obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass",Ii.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.program=a);l.Object3D.prototype.initialize.call(this),this.compileCode(this.code),void 0!==this.script.initialize&&this.script.initialize.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.update.call(this,a)},Ii.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.dispose.call(this)},Ii.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.compileCode=function(a){var r;try{r=(r=bs.python_to_js(a)).substring(r.indexOf("\n")+1,r.lastIndexOf("\n"))}catch(b){throw new Error("Failed to transpile python into javascript code.",b)}for(var h=0;h<Sn.METHODS.length;h++){var p=Sn.METHODS[h];r+="\nif(this."+p+' == undefined && typeof $locals___main__["'+p+"\"] !== 'undefined'){this."+p+' = $locals___main__["'+p+'"];}'}var y=new Function(r);try{this.script=new y}catch(b){throw this.script={},console.warn("nunuStudio: Error initializing script code",b),new Error("Error initializing script code")}},Ii.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r};var Jp=__webpack_require__(573),kl=__webpack_require__.n(Jp);function Vo(a,r,h,p){if(void 0===a.font)throw new Error("TextBitmap configuration font is required.");void 0===a.width&&(a.width=500),void 0===a.align&&(a.align=Vo.CENTER),void 0===a.lineHeight&&(a.lineHeight=a.font.common.lineHeight),void 0===a.letterSpacing&&(a.letterSpacing=5),void 0===a.text&&(a.text=""),this.config=a,this.uniforms={map:{type:"t",value:r},color:{type:"v3",value:new l.Color(void 0!==p?p:16777215)},smoothing:{type:"f",value:0},threshold:{type:"f",value:.4}},l.Mesh.call(this,kl()(this.config),null),this.name="text",this.type="TextBitmap",h=void 0!==h?h:Vo.BITMAP;var y=.01;Object.defineProperties(this,{fontScale:{get:function(){return y},set:function(b){y=b,this.updateGeometry()}},shader:{get:function(){return h},set:function(b){h=b,this.updateShader()}},texture:{get:function(){return this.uniforms.map.value},set:function(b){this.uniforms.map.value=b,this.material.needsUpdate=!0}},font:{get:function(){return this.config.font},set:function(b){this.config.font=b,this.updateGeometry()}},text:{get:function(){return this.config.text},set:function(b){this.config.text!==b&&(this.config.text=b,this.updateGeometry())}},lineHeight:{get:function(){return this.config.lineHeight},set:function(b){this.config.lineHeight=b,this.updateGeometry()}},letterSpacing:{get:function(){return this.config.letterSpacing},set:function(b){this.config.letterSpacing=b,this.updateGeometry()}},align:{get:function(){return this.config.align},set:function(b){this.config.align=b,this.updateGeometry()}},width:{get:function(){return this.config.width},set:function(b){this.config.width=b,this.updateGeometry()}},color:{get:function(){return this.uniforms.color.value},set:function(b){this.uniforms.color.value=b}},threshold:{get:function(){return this.uniforms.threshold.value},set:function(b){this.uniforms.threshold.value=b}},smoothing:{get:function(){return this.uniforms.smoothing.value},set:function(b){this.uniforms.smoothing.value=b}}}),this.updateGeometry(),this.updateShader(r)}function Fl(a,r){wi.call(this,"text","TextFile"),this.format="string",this.encoding=void 0!==r?r:"txt",this.data=void 0!==a?a:""}function na(a,r,h,p,y,b,R,O,T,U){uh.call(this,na.EMPTY_GEOMETRY,r),this.name="text",this.type="TextMesh",this.font=void 0!==h?h:null,this.extruded=void 0===U||U,this.size=void 0!==O?O:1,this.height=void 0!==p?p:.5,this.curveSegments=void 0!==T?T:15,this.bevel=void 0!==y&&y,this.bevelThickness=void 0!==b?b:.1,this.bevelSize=void 0!==R?R:.05,void 0!==a&&(a="text"),Object.defineProperties(this,{text:{get:function(){return a},set:function(ee){a!==ee&&(a=ee,this.updateGeometry())}}}),this.updateGeometry()}function Fa(a,r,h,p,y,b,R,O,T,U,ee){l.Texture.call(this,document.createElement("canvas"),h,p,y,b,R,O,T,U,ee),this.name="canvas",this.category="Canvas",this.format=l.RGBAFormat,Object.defineProperties(this,{width:{get:function(){return this.image.width},set:function(ie){this.image.width=ie}},height:{get:function(){return this.image.height},set:function(ie){this.image.height=ie}}}),this.width=void 0!==a?a:1,this.height=void 0!==r?r:1,this.context=this.image.getContext("2d")}function kc(){this.texture=new Fa,this.canvas=this.texture.image;var a=new l.SpriteMaterial({map:this.texture,color:16777215,transparent:!0,alphaTest:.4,depthTest:!0,depthWrite:!0,sizeAttenuation:!0});l.Sprite.call(this,a),this.name="sprite",this.type="CanvasSprite",Object.defineProperties(this,{sizeAttenuation:{get:function(){return this.material.sizeAttenuation},set:function(r){this.material.sizeAttenuation=r,this.material.needsUpdate=!0}}})}function cc(){kc.call(this),this.name="text",this.type="TextSprite";var a="",r="#FFFFFF",h=!0,p="#000000",y=1,b=32,R=cc.CENTER,O="arial";Object.defineProperties(this,{font:{get:function(){return O},set:function(T){O=T,this.drawText()}},align:{get:function(){return R},set:function(T){R=T,this.drawText()}},color:{get:function(){return r},set:function(T){r=T,this.drawText()}},text:{get:function(){return a},set:function(T){T!==a&&(a=T,this.drawText())}},outline:{get:function(){return h},set:function(T){h=T,this.drawText()}},outlineColor:{get:function(){return p},set:function(T){p=T,this.drawText()}},outlineWidth:{get:function(){return y},set:function(T){y=T,this.drawText()}},resolution:{get:function(){return b},set:function(T){b=T,this.drawText()}}}),this.text="text"}(Vo.prototype=Object.create(l.Mesh.prototype)).constructor=Vo,Vo.BITMAP=100,Vo.SDF=101,Vo.MSDF=102,Vo.LEFT="left",Vo.CENTER="center",Vo.RIGHT="right",Vo.prototype.setText=function(a){this.text=a},Vo.prototype.updateShader=function(){this.material=new l.ShaderMaterial({uniforms:this.uniforms,fragmentShader:this.shader===Vo.SDF?"/**\n * Shader object used to render single channel SDF data.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n * \n * Details about signed distance fields for vetorial shapes rendering.\n *    - https:// steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n */\nvarying vec2 vUv;\nuniform sampler2D map;\nuniform vec3 color;\nuniform float smoothing;\nuniform float threshold;\n\nvoid main()\n{\n\tfloat distance = texture2D(map, vUv).a;\n\tfloat alpha = smoothstep(threshold - smoothing, threshold + smoothing, distance);\n\tgl_FragColor = vec4(color, alpha);\n}":this.shader===Vo.MSDF?"/*\n * Shader object used to render single channel MSDF data.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n * \n * Details about Multi\u2010Channel Signed Distance Fields for vetorial shapes rendering.\n *    - https:// onlinelibrary.wiley.com/doi/full/10.1111/cgf.13265\n */\n\nvarying vec2 vUv;\nuniform sampler2D map;\nuniform vec3 color;\nuniform float smoothing;\nuniform float threshold;\n\nfloat median(float r, float g, float b)\n{\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nvoid main()\n{\n\tvec3 smpl = texture2D(map, vUv).rgb;\n\tfloat sigDist = median(smpl.r, smpl.g, smpl.b) - 0.5;\n\tfloat alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n\tgl_FragColor = vec4(color, 1.0 - alpha);\n}\n":"/**\n * Shader object used to render the bitmap directly without any processing.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n */\nvarying vec2 vUv;\nuniform sampler2D map;\n\nvoid main()\n{\n\tgl_FragColor = texture2D(map, vUv);\n}\n",vertexShader:"/**\n * Vertex shader used to draw the text, is responsible for applying the billboard effect by removing the rotation from the transformation matrix.\n */\n#define BILLBOARD 0 \n\nvarying vec2 vUv;\n\nvoid main()\n{\n\tvUv = uv;\n\t\n\t#if BILLBOARD\n\t\tmat4 model = modelViewMatrix; \n\t\tmodel[0][0] = 1.0;\n\t\tmodel[0][1] = 0.0;\n\t\tmodel[0][2] = 0.0;\n\t\t\n\t\tmodel[1][0] = 0.0;\n\t\tmodel[1][1] = 1.0;\n\t\tmodel[1][2] = 0.0;\n\t\t\n\t\tmodel[2][0] = 0.0;\n\t\tmodel[2][1] = 0.0;\n\t\tmodel[2][2] = 1.0;\n\t\t\n\t\tgl_Position = projectionMatrix * model * vec4(position, 1.0);\n\t#else\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t#endif\n\t\n}",side:l.DoubleSide,transparent:!0,depthTest:!0}),this.material.extensions.derivatives=this.shader===Vo.MSDF},Vo.prototype.updateGeometry=function(){if(this.geometry.update(this.config),1!==this.fontScale)for(var a=this.geometry.attributes.position.array,r=0;r<a.length;r++)a[r]*=this.fontScale},Vo.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.texture=this.texture.toJSON(a).uuid,r.object.fontScale=this.fontScale,r.object.shader=this.shader,r.object.text=this.text,r.object.font=this.font,r.object.lineHeight=this.lineHeight,r.object.letterSpacing=this.letterSpacing,r.object.align=this.align,r.object.width=this.width,r.object.color=this.color,r.object.threshold=this.threshold,r.object.smoothing=this.smoothing,r},Vo.fromJSON=function(a,r){var h=new Vo(a,r,a.shader);return h.color=a.color,h.threshold=a.threshold,h.smoothing=a.smoothing,h.fontScale=a.fontScale,h},Fl.prototype=Object.create(wi.prototype),Fl.extensions=[".js",".txt",".glsl",".json",".xml",".yaml",".csv",".css",".html"],Fl.fileIsText=function(a){a=a.name.toLocaleLowerCase();for(var r=0;r<Fl.extensions.length;r++)if(a.endsWith(Fl.extensions[r]))return!0;return!1},Fl.prototype.toJSON=function(a){if(void 0!==a.resources[this.uuid])return a.resources[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.resources[this.uuid]=r,r},na.prototype=Object.create(uh.prototype),na.EMPTY_GEOMETRY=new l.Geometry,na.prototype.setFont=function(a){this.font!==a&&(this.font=a,this.updateGeometry())},na.prototype.setText=function(a){this.text=a},na.prototype.updateGeometry=function(){if(null!==this.font){if(void 0!==this.geometry&&this.geometry.dispose(),!0!==this.font.isFont)return console.warn("nunuStudio: Font parameter is not an instance of Font."),void(this.geometry=na.EMPTY_GEOMETRY);var a=this.font.generateShapes(this.text,this.size);this.extruded?(this.geometry=new l.ExtrudeBufferGeometry(a,{curveSegments:this.curveSegments,depth:this.height,bevelEnabled:this.bevel,bevelSize:this.bevelSize,bevelThickness:this.bevelThickness}),this.geometry.computeVertexNormals()):this.geometry=new l.ShapeBufferGeometry(a,this.curveSegments)}},na.prototype.clone=function(){return new na(this.text,this.material,this.font,this.height,this.bevel,this.bevelThickness,this.bevelSize,this.size,this.curveSegments)},na.prototype.toJSON=function(a){var r=this.geometry;this.geometry=void 0;var h=this.font,p=l.Object3D.prototype.toJSON.call(this,a,function(y,b){h=h.toJSON(y)});return p.object.text=this.text,p.object.font=h.uuid,p.object.size=this.size,p.object.curveSegments=this.curveSegments,p.object.height=this.height,p.object.bevel=this.bevel,p.object.bevelThickness=this.bevelThickness,p.object.bevelSize=this.bevelSize,p.object.extruded=this.extruded,this.geometry=r,p},(Fa.prototype=Object.create(l.Texture.prototype)).constructor=Fa,Fa.prototype.isCanvasTexture=!0,Fa.prototype.placeholder=function(){this.context.fillStyle="#000000",this.context.fillRect(0,0,this.width,this.height),this.context.font="Normal "+Math.round(this.width/12)+"px Arial",this.context.textAlign="center",this.context.fillStyle="#FF0000",this.context.fillText("Canvas Texture",this.width/2,this.height/2),this.needsUpdate=!0},Fa.prototype.clear=function(a){void 0===a?this.context.clearRect(0,0,width,height):(this.context.fillStyle=a,this.context.fillRect(0,0,this.width,this.height))},Fa.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.width=this.width,r.height=this.height,r},kc.prototype=Object.create(l.Sprite.prototype),cc.prototype=Object.create(kc.prototype),cc.LEFT="left",cc.CENTER="center",cc.RIGHT="right",cc.prototype.drawText=function(){var a=this.resolution,r=.8*a,h=this.texture.context;h.font=r+"px "+this.font;var p=h.measureText(this.text).width,y=l.Math.ceilPowerOfTwo(p),b=y/a;this.texture.width=y,this.texture.height=a,h.clearRect(0,0,y,a),0!==this.text.length&&(h.font=r+"px "+this.font,h.textAlign=this.align,h.textBaseline="middle",h.fillStyle=this.color,h.fillText(this.text,y/2,a/2),!0===this.outline&&(h.lineWidth=this.outlineWidth,h.strokeStyle=this.outlineColor,h.strokeText(this.text,y/2,a/2)),this.scale.x=b*this.scale.y,this.texture.needsUpdate=!0)},cc.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.text=this.text,r.object.color=this.color,r.object.outline=this.outline,r.object.outlineColor=this.outlineColor,r.object.outlineWidth=this.outlineWidth,r.object.resolution=this.resolution,r.object.align=this.align,r.object.font=this.font,r},cc.fromJSON=function(a){var r=new cc;return r.text=a.text,r.color=a.color,r.outline=a.outline,r.outlineColor=a.outlineColor,r.outlineWidth=a.outlineWidth,r.resolution=a.resolution,r.align=a.align,r.font=a.font,r};var xd=__webpack_require__(412);function uc(){l.Mesh.call(this,new l.BufferGeometry,new l.MeshBasicMaterial({depthWrite:!1,colorWrite:!1})),this.name="billboard",this.type="BillboardGroup"}function iu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.textures={}}function Bu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="Anonymous"}function hc(a,r,h,p,y,b){l.BufferGeometry.call(this),this.type="TerrainBufferGeometry",this.parameters={width:a||1,height:r||1,widthSegments:h||10,heightSegments:p||10,scale:y||1},this.image=b,this.generate()}function hh(a,r,h,p,y){l.BufferGeometry.call(this),this.type="RoundedBoxBufferGeometry",y=isNaN(y)?1:Math.max(1,Math.floor(y)),a=isNaN(a)?1:a,r=isNaN(r)?1:r,h=isNaN(h)?1:h,p=isNaN(p)?.15:p;var b=a/2-(p=Math.min(p,Math.min(a,Math.min(r,Math.min(h)))/2)),R=r/2-p,O=h/2-p;this.parameters={width:a,height:r,depth:h,radius:p,radiusSegments:y};var Je,pt,at,T=y+1,U=T*y+1<<3,ee=new l.BufferAttribute(new Float32Array(3*U),3),ie=new l.BufferAttribute(new Float32Array(3*U),3),ne=[],ve=[],be=(new l.Vector3,new l.Vector3),Te=[],Le=[],Ie=[],Oe=T*y,Fe=Oe+1;(function(){for(var Je=[new l.Vector3(1,1,1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,1,1),new l.Vector3(1,-1,1),new l.Vector3(1,-1,-1),new l.Vector3(-1,-1,-1),new l.Vector3(-1,-1,1)],pt=0;pt<8;pt++)ne.push([]),ve.push([]);for(var at=Math.PI/2,Mt=new l.Vector3(b,R,O),Tt=0;Tt<=y;Tt++){var Yt=Tt/y*at,jt=Math.cos(Yt),It=Math.sin(Yt);if(Tt!==y)for(var Nt=0;Nt<=y;Nt++){var ft=Nt/y*at;be.x=jt*Math.cos(ft),be.y=It,be.z=jt*Math.sin(ft),$t=be.clone().multiplyScalar(p).add(Mt),ne[0].push($t),Te.push($t),Zt=be.clone().normalize(),ve[0].push(Zt),Le.push(Zt)}else{be.set(0,1,0);var $t=be.clone().multiplyScalar(p).add(Mt);ne[0].push($t),Te.push($t);var Zt=be.clone();ve[0].push(Zt),Le.push(Zt)}}for(var Tn=1;Tn<8;Tn++)for(pt=0;pt<ne[0].length;pt++)$t=ne[0][pt].clone().multiply(Je[Tn]),ne[Tn].push($t),Te.push($t),Zt=ve[0][pt].clone().multiply(Je[Tn]),ve[Tn].push(Zt),Le.push(Zt)})(),Ie.push(Je=Oe,pt=Oe+Fe,at=Oe+2*Fe,Je,at,Oe+3*Fe),Ie.push(Je=Oe+4*Fe,at=Oe+6*Fe,pt=Oe+5*Fe,Je,Oe+7*Fe,at),Ie.push(Je=0,at=4*Fe,pt=Fe,pt,at,5*Fe),Ie.push(Je=2*Fe,at=6*Fe,pt=3*Fe,pt,at,7*Fe),Ie.push(Je=y,pt=y+3*Fe,at=y+4*Fe,pt,y+7*Fe,at),Ie.push(Je=y+Fe,at=y+5*Fe,pt=y+2*Fe,pt,at,y+6*Fe),function(){for(var Je=[!0,!1,!0,!1,!1,!0,!1,!0],pt=T*(y-1),at=0;at<8;at++){for(var Mt=Fe*at,Tt=0;Tt<y-1;Tt++)for(var Yt=Tt*T,jt=(Tt+1)*T,It=0;It<y;It++){var Nt=It+1,ft=Mt+Yt+It,$t=Mt+Yt+Nt,Zt=Mt+jt+It,Tn=Mt+jt+Nt;Je[at]?Ie.push(ft,Zt,$t,$t,Zt,Tn):Ie.push(ft,$t,Zt,$t,Tn,Zt)}for(It=0;It<y;It++)ft=Mt+pt+It,$t=Mt+pt+It+1,Zt=Mt+Oe,Je[at]?Ie.push(ft,Zt,$t):Ie.push(ft,$t,Zt)}}(),function(){for(var Je=0;Je<4;Je++)for(var pt=Je*Fe,at=4*Fe+pt,Mt=!0&Je,Tt=0;Tt<y;Tt++){var Yt=Tt+1,jt=pt+Tt,It=pt+Yt,Nt=at+Tt,ft=at+Yt;Mt?Ie.push(jt,Nt,It,It,Nt,ft):Ie.push(jt,It,Nt,It,ft,Nt)}}(),function(){for(var Je=y-1,pt=[0,1,4,5],at=[3,2,7,6],Mt=[0,1,1,0],Tt=0;Tt<4;Tt++)for(var Yt=pt[Tt]*Fe,jt=at[Tt]*Fe,It=0;It<=Je;It++){var Nt=Yt+y+It*T,ft=Yt+(It!==Je?y+(It+1)*T:Fe-1),$t=jt+y+It*T,Zt=jt+(It!==Je?y+(It+1)*T:Fe-1);Mt[Tt]?Ie.push(Nt,$t,ft,ft,$t,Zt):Ie.push(Nt,ft,$t,ft,Zt,$t)}}(),function(){for(var Je=[0,2,4,6],pt=[1,3,5,7],at=0;at<4;at++)for(var Mt=Fe*Je[at],Tt=Fe*pt[at],Yt=1>=at,jt=0;jt<y;jt++){var It=jt*T,Nt=(jt+1)*T,ft=Mt+It,$t=Mt+Nt,Zt=Tt+It,Tn=Tt+Nt;Yt?Ie.push(ft,Zt,$t,$t,Zt,Tn):Ie.push(ft,$t,Zt,$t,Tn,Zt)}}();for(var je=0,Ue=0;Ue<Te.length;Ue++)ee.setXYZ(je,Te[Ue].x,Te[Ue].y,Te[Ue].z),ie.setXYZ(je,Le[Ue].x,Le[Ue].y,Le[Ue].z),je++;this.setIndex(new l.BufferAttribute(new Uint16Array(Ie),1)),this.addAttribute("position",ee),this.addAttribute("normal",ie)}function Fc(a,r,h,p,y,b,R,O,T){l.BufferGeometry.call(this),this.type="CapsuleBufferGeometry",this.parameters={radiusTop:a,radiusBottom:r,height:h,radialSegments:p,heightSegments:y,capsTopSegments:b,capsBottomSegments:R,thetaStart:O,thetaLength:T},a=void 0!==a?a:1,r=void 0!==r?r:1,h=void 0!==h?h:2,p=Math.floor(p)||8,y=Math.floor(y)||1,b=Math.floor(b)||2,R=Math.floor(R)||2,O=void 0!==O?O:0,T=void 0!==T?T:2*Math.PI;var U=Math.acos((r-a)/h),ee=(p+1)*(y+1+R+b),ie=p*(y+R+b)*2*3,ne=new l.BufferAttribute(new(ie>65535?Uint32Array:Uint16Array)(ie),1),ve=new l.BufferAttribute(new Float32Array(3*ee),3),be=new l.BufferAttribute(new Float32Array(3*ee),3),Te=new l.BufferAttribute(new Float32Array(2*ee),2),Le=0,Ie=0,Oe=[],Fe=h/2;(function(){var je,Ue,Je=new l.Vector3,pt=new l.Vector3,at=Math.cos(U),Mt=Math.sin(U),Tt=new l.Vector2(a*Mt,Fe+a*at).sub(new l.Vector2(r*Mt,r*at-Fe)).length(),Yt=a*U+Tt+r*(Math.PI/2-U),jt=0;for(Ue=0;Ue<=b;Ue++){var It=[],Nt=Math.PI/2-U*(Ue/b);jt+=a*U/b;var ft=Math.cos(Nt),$t=Math.sin(Nt),Zt=ft*a;for(je=0;je<=p;je++){var Tn=(pr=je/p)*T+O,$n=Math.sin(Tn),Qn=Math.cos(Tn);pt.x=Zt*$n,pt.y=Fe+$t*a,pt.z=Zt*Qn,ve.setXYZ(Le,pt.x,pt.y,pt.z),Je.set(ft*$n,$t,ft*Qn),be.setXYZ(Le,Je.x,Je.y,Je.z),Te.setXY(Le,pr,1-jt/Yt),It.push(Le),Le++}Oe.push(It)}var lr=h+at*a-at*r,jn=Mt*(r-a)/lr;for(Ue=1;Ue<=y;Ue++){for(It=[],jt+=Tt/y,Zt=Mt*(Ue*(r-a)/y+a),je=0;je<=p;je++)Tn=(pr=je/p)*T+O,$n=Math.sin(Tn),Qn=Math.cos(Tn),pt.x=Zt*$n,pt.y=Fe+at*a-Ue*lr/y,pt.z=Zt*Qn,ve.setXYZ(Le,pt.x,pt.y,pt.z),Je.set($n,jn,Qn).normalize(),be.setXYZ(Le,Je.x,Je.y,Je.z),Te.setXY(Le,pr,1-jt/Yt),It.push(Le),Le++;Oe.push(It)}for(Ue=1;Ue<=R;Ue++){for(It=[],Nt=Math.PI/2-U-(Math.PI-U)*(Ue/R),jt+=r*U/R,ft=Math.cos(Nt),$t=Math.sin(Nt),Zt=ft*r,je=0;je<=p;je++){var pr;Tn=(pr=je/p)*T+O,$n=Math.sin(Tn),Qn=Math.cos(Tn),pt.x=Zt*$n,pt.y=$t*r-Fe,pt.z=Zt*Qn,ve.setXYZ(Le,pt.x,pt.y,pt.z),Je.set(ft*$n,$t,ft*Qn),be.setXYZ(Le,Je.x,Je.y,Je.z),Te.setXY(Le,pr,1-jt/Yt),It.push(Le),Le++}Oe.push(It)}for(je=0;je<p;je++)for(Ue=0;Ue<b+y+R;Ue++){var wr=Oe[Ue+1][je],Or=Oe[Ue+1][je+1],Ji=Oe[Ue][je+1];ne.setX(Ie,Oe[Ue][je]),Ie++,ne.setX(Ie,wr),Ie++,ne.setX(Ie,Ji),Ie++,ne.setX(Ie,wr),Ie++,ne.setX(Ie,Or),Ie++,ne.setX(Ie,Ji),Ie++}})(),this.setIndex(ne),this.setAttribute("position",ve),this.setAttribute("normal",be),this.setAttribute("uv",Te)}function Nu(a,r,h){var p=this.compile(a);l.ParametricBufferGeometry.call(this,p,r,h),this.type="ParametricBufferGeometry",this.parameters={code:a,slices:r,stacks:h}}function xs(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.withCredentials=!1}function Ru(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.shapes={},this.images={}}function ph(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Bh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Hs(a,r,h,p,y){var b=document.createElement("video");b.autoplay=!0,b.loop=!0,l.Texture.call(this,b,a,r,h,l.LinearFilter,l.LinearFilter,l.RGBFormat,p,y);var R=this;this.generateMipmaps=!1,this.disposed=!1,this.name="webcam",this.category="Webcam",this.mode=Hs.USER,this.stream=null,this.connect(),requestAnimationFrame(function O(){b.readyState>=b.HAVE_CURRENT_DATA&&(R.needsUpdate=!0),R.disposed||requestAnimationFrame(O)})}function Dl(a,r){wi.call(this,"video","Video"),void 0!==a&&(a instanceof ArrayBuffer?this.loadArrayBufferData(a,r):ci.isBase64(a)?(this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a):this.loadArrayBufferData(Rn.readFileArrayBuffer(a),Rn.getFileExtension(a)))}function Sa(a,r,h,p,y,b){l.Texture.call(this,document.createElement("video"),r,h,p,l.LinearFilter,l.LinearFilter,l.RGBFormat,y,b),this.disposed=!1,this.generateMipmaps=!1,this.name="video",this.category="Video",this.autoplay=!0,this.loop=!0,this.playbackRate=1,this.volume=1,this.image.crossOrigin="anonymous",this.image.autoplay=this.autoplay,this.image.playbackRate=this.playbackRate,this.image.loop=this.loop,this.image.volume=this.volume,this.video=null,this.setVideo(a);var R=this;!function O(){R.disposed||(R.image.readyState>=R.image.HAVE_CURRENT_DATA&&(R.needsUpdate=!0),requestAnimationFrame(O))}()}function Ul(a,r,h,p,y,b,R){gs.call(this,a,y,l.RepeatWrapping,l.RepeatWrapping,l.LinearFilter,l.LinearFilter,l.RGBFormat,b,R),this.name="animation",this.category="SpriteSheet",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.repeat.set(1/r,1/h),this.loop=!0,this.animationSpeed=.1,this._totalFrames=p,this._beginFrame=0,this._endFrame=0,this._framesHorizontal=r,this._framesVertical=h;var O=this;Object.defineProperties(this,{framesHorizontal:{get:function(){return this._framesHorizontal},set:function(T){this._framesHorizontal=T,this.repeat.x=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},framesVertical:{get:function(){return this._framesVertical},set:function(T){this._framesVertical=T,this.repeat.y=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},endFrame:{get:function(){return this._endFrame},set:function(T){T>this._totalFrames&&(T=this._totalFrames),this._endFrame=T}},beginFrame:{get:function(){return this._beginFrame},set:function(T){T<0&&(T=0),this.currentFrame=T,this._beginFrame=T}},totalFrames:{get:function(){return this._totalFrames},set:function(T){this._beginFrame=0,this._endFrame=T,this._totalFrames=T}}}),this.currentFrame=0,function T(){O.disposed||(O.step(),setTimeout(T,1e3*O.animationSpeed))}()}function zl(a,r,h,p,y,b,R,O,T,U,ee,ie){l.Texture.call(this,null,b,R,O,T,U,p,y,ee,ie),this.category="DataTexture",this.image={data:a||null,width:r||1,height:h||1},this.magFilter=void 0!==T?T:NearestFilter,this.minFilter=void 0!==U?U:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}function jl(a,r,h,p,y,b,R,O,T,U,ee,ie){l.Texture.call(this,null,b,R,O,T,U,p,y,ee,ie),this.category="Compressed",this.image={width:r,height:h},this.mipmaps=a,this.isCubeTexture=!1,this.flipY=!1,this.generateMipmaps=!1}function Os(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="anonymous",this.images=[],this.videos=[],this.fonts=[]}function Nh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Co(a){L.call(this),this.manager=void 0!==a?a:l.DefaultLoadingManager,this.texturePath=""}(uc.prototype=Object.create(l.Mesh.prototype)).constructor=uc,uc.prototype.isScene=!0,uc.prototype.onBeforeRender=function(a,r,h,p,y,b){var R=new xd.Quaternion;h.getWorldQuaternion(R),this.quaternion.copy(R)},iu.prototype.load=function(a,r,h,p){var y=this;new FileLoader(y.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},iu.prototype.setTextures=function(a){this.textures=a},iu.prototype.parse=function(a){var r=l.MaterialLoader.prototype.parse.call(this,a);if(void 0!==a.materials)for(var h=0,p=a.materials.length;h<p;h++)r.materials.push(this.parse(a.materials[h]));return r},Bu.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Bu.prototype.setPath=function(a){return this.path=a,this},Bu.prototype.loadJSON=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},Bu.prototype.parse=function(a){var r=new ms(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,void 0!==a.width&&(r.width=a.width,r.height=a.height),r},hc.prototype=Object.create(l.BufferGeometry.prototype),hc.constructor=hc,hc.prototype.generate=function(){var a=this.parameters.width,r=this.parameters.height,h=this.parameters.widthSegments,p=this.parameters.heightSegments,y=this.parameters.scale,b=this;this.image.getImageData(function(R,O,T){for(var Tn,$n,Qn,ee=a/2,ie=r/2,ne=Math.floor(h)||1,ve=ne+1,be=Math.floor(p)||1,Te=a/ne,Le=r/be,Ie=[],Oe=[],Fe=[],je=[],Ue=O/(a+1),Je=T/(r+1),at=0;at<=be;at++)for(var Mt=at*Le-ie,Tt=0;Tt<=ne;Tt++){var Yt=Tt*Te-ee,jt=(Tn=Mt,void 0,void 0,$n=Math.round((Yt+ee)*Ue),Qn=Math.round((Tn+ie)*Je)*(4*O)+4*$n,R.data[Qn]/255*y);Oe.push(Yt,jt,Mt),Fe.push(0,1,0),je.push(Tt/ne),je.push(1-at/be)}for(at=0;at<be;at++)for(Tt=0;Tt<ne;Tt++){var Nt=Tt+ve*(at+1),ft=Tt+1+ve*(at+1),$t=Tt+1+ve*at;Ie.push(Tt+ve*at,Nt,$t),Ie.push(Nt,ft,$t)}b.setIndex(Ie),b.setAttribute("position",new l.Float32BufferAttribute(Oe,3)),b.setAttribute("normal",new l.Float32BufferAttribute(Fe,3)),b.setAttribute("uv",new l.Float32BufferAttribute(je,2)),b.computeVertexNormals(),b.boundingBox=null,b.boundingSphere=null})},hc.prototype.toJSON=function(){var a=l.BufferGeometry.prototype.toJSON.call(this);return a.image=this.image.uuid,a},hh.prototype=Object.create(l.BufferGeometry.prototype),hh.constructor=hh,(Fc.prototype=Object.create(l.BufferGeometry.prototype)).constructor=Fc,(Nu.prototype=Object.create(l.ParametricBufferGeometry.prototype)).compile=function(a){try{return new Function("u, v, target","target = target || new Vector3();\n"+a)}catch(r){console.error("nunuStudio: Error occured while compiling ParametricBufferGeometry code.",r)}return function(r,h,p){return p||new l.Vector3}},xs.prototype.load=function(a,r,h,p){var y=this,b=void 0===this.path?LoaderUtils.extractUrlBase(a):this.path,R=new l.FileLoader(this.manager);R.setPath(this.path),R.setWithCredentials(this.withCredentials),R.load(a,function(O){var T=JSON.parse(O),U=T.metadata;if(void 0!==U){var ee=U.type;if(void 0!==ee&&"object"===ee.toLowerCase())return void console.error("nunuStudio: LegacyGeometryLoader: "+a+" should be loaded with ObjectLoader instead.")}var ie=y.parse(T,b);r(ie.geometry,ie.materials)},h,p)},xs.prototype.setPath=function(a){return this.path=a,this},xs.prototype.setResourcePath=function(a){return this.resourcePath=a,this},xs.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},xs.prototype.parse=function(a,r){void 0!==a.data&&(a=a.data),a.scale=void 0!==a.scale?1/a.scale:1;var h=new l.Geometry;return function(p,y){function b(pr,Yn){return pr&1<<Yn}var R,O,T,U,ee,ie,ne,ve,be,Te,Le,Ie,Oe,Fe,je,Ue,Je,pt,at,Mt,Tt,Yt,jt,It,Nt,ft,Zt=p.faces,Tn=p.vertices,$n=p.normals,Qn=p.colors,lr=p.scale,jn=0;if(void 0!==p.uvs){for(R=0;R<p.uvs.length;R++)p.uvs[R].length&&jn++;for(R=0;R<jn;R++)y.faceVertexUvs[R]=[]}for(U=0,ee=Tn.length;U<ee;)(pt=new l.Vector3).x=Tn[U++]*lr,pt.y=Tn[U++]*lr,pt.z=Tn[U++]*lr,y.vertices.push(pt);for(U=0,ee=Zt.length;U<ee;)if(Le=b(Te=Zt[U++],0),Ie=b(Te,1),Oe=b(Te,3),Fe=b(Te,4),je=b(Te,5),Ue=b(Te,6),Je=b(Te,7),Le){if((Mt=new l.Face3).a=Zt[U],Mt.b=Zt[U+1],Mt.c=Zt[U+3],(Tt=new l.Face3).a=Zt[U+1],Tt.b=Zt[U+2],Tt.c=Zt[U+3],U+=4,Ie&&(be=Zt[U++],Mt.materialIndex=be,Tt.materialIndex=be),T=y.faces.length,Oe)for(R=0;R<jn;R++)for(It=p.uvs[R],y.faceVertexUvs[R][T]=[],y.faceVertexUvs[R][T+1]=[],O=0;O<4;O++)ft=It[2*(ve=Zt[U++])],Nt=new l.Vector2(ft,It[2*ve+1]),2!==O&&y.faceVertexUvs[R][T].push(Nt),0!==O&&y.faceVertexUvs[R][T+1].push(Nt);if(Fe&&(ne=3*Zt[U++],Mt.normal.set($n[ne++],$n[ne++],$n[ne]),Tt.normal.copy(Mt.normal)),je)for(R=0;R<4;R++)ne=3*Zt[U++],jt=new l.Vector3($n[ne++],$n[ne++],$n[ne]),2!==R&&Mt.vertexNormals.push(jt),0!==R&&Tt.vertexNormals.push(jt);if(Ue&&(Yt=Qn[ie=Zt[U++]],Mt.color.setHex(Yt),Tt.color.setHex(Yt)),Je)for(R=0;R<4;R++)Yt=Qn[ie=Zt[U++]],2!==R&&Mt.vertexColors.push(new Color(Yt)),0!==R&&Tt.vertexColors.push(new Color(Yt));y.faces.push(Mt),y.faces.push(Tt)}else{if((at=new l.Face3).a=Zt[U++],at.b=Zt[U++],at.c=Zt[U++],Ie&&(be=Zt[U++],at.materialIndex=be),T=y.faces.length,Oe)for(R=0;R<jn;R++)for(It=p.uvs[R],y.faceVertexUvs[R][T]=[],O=0;O<3;O++)ft=It[2*(ve=Zt[U++])],Nt=new l.Vector2(ft,It[2*ve+1]),y.faceVertexUvs[R][T].push(Nt);if(Fe&&(ne=3*Zt[U++],at.normal.set($n[ne++],$n[ne++],$n[ne])),je)for(R=0;R<3;R++)ne=3*Zt[U++],jt=new l.Vector3($n[ne++],$n[ne++],$n[ne]),at.vertexNormals.push(jt);if(Ue&&(ie=Zt[U++],at.color.setHex(Qn[ie])),Je)for(R=0;R<3;R++)ie=Zt[U++],at.vertexColors.push(new Color(Qn[ie]));y.faces.push(at)}}(a,h),function(p,y){var b=void 0!==p.influencesPerVertex?p.influencesPerVertex:2;if(p.skinWeights)for(var R=0,O=p.skinWeights.length;R<O;R+=b)y.skinWeights.push(new Vector4(p.skinWeights[R],b>1?p.skinWeights[R+1]:0,b>2?p.skinWeights[R+2]:0,b>3?p.skinWeights[R+3]:0));if(p.skinIndices)for(R=0,O=p.skinIndices.length;R<O;R+=b)y.skinIndices.push(new Vector4(p.skinIndices[R],b>1?p.skinIndices[R+1]:0,b>2?p.skinIndices[R+2]:0,b>3?p.skinIndices[R+3]:0));y.bones=p.bones,y.bones&&y.bones.length>0&&(y.skinWeights.length!==y.skinIndices.length||y.skinIndices.length!==y.vertices.length)&&console.warn("nunuStudio: When skinning, number of vertices ("+y.vertices.length+"), skinIndices ("+y.skinIndices.length+"), and skinWeights ("+y.skinWeights.length+") should match.")}(a,h),function(p,y){var b=p.scale;if(void 0!==p.morphTargets)for(var R=0,O=p.morphTargets.length;R<O;R++){y.morphTargets[R]={},y.morphTargets[R].name=p.morphTargets[R].name,y.morphTargets[R].vertices=[];for(var T=y.morphTargets[R].vertices,U=p.morphTargets[R].vertices,ee=0,ie=U.length;ee<ie;ee+=3){var ne=new l.Vector3;ne.x=U[ee]*b,ne.y=U[ee+1]*b,ne.z=U[ee+2]*b,T.push(ne)}}if(void 0!==p.morphColors&&p.morphColors.length>0){var ve=y.faces,be=p.morphColors[0].colors;for(R=0,O=ve.length;R<O;R++)ve[R].color.fromArray(be,3*R)}}(a,h),function(p,y){var b=[],R=[];void 0!==p.animation&&R.push(p.animation),void 0!==p.animations&&(p.animations.length?R=R.concat(p.animations):R.push(p.animations));for(var O=0;O<R.length;O++){var T=l.AnimationClip.parseAnimation(R[O],y.bones);T&&b.push(T)}if(y.morphTargets){var U=l.AnimationClip.CreateClipsFromMorphTargetSequences(y.morphTargets,10);b=b.concat(U)}b.length>0&&(y.animations=b)}(a,h),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===a.materials||0===a.materials.length?{geometry:h}:{geometry:h,materials:Loader.prototype.initMaterials(a.materials,this.resourcePath||r,this.crossOrigin)}},Ru.prototype.setImages=function(a){return this.images=a,this},Ru.prototype.setShapes=function(a){return this.shapes=a,this},Ru.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,p)},Ru.prototype.parse=function(a){var r=null;if("CapsuleBufferGeometry"===a.type)r=new Fc(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.capsTopSegments,a.capsBottomSegments,a.thetaStart,a.thetaLength);else if("RoundedBoxBufferGeometry"===a.type)r=new hh(a.width,a.height,a.depth,a.radius,a.radiusSegments);else if("TerrainBufferGeometry"===a.type)r=new hc(a.width,a.height,a.widthSegments,a.heightSegments,a.scale,this.images[a.image]);else if("ParametricBufferGeometry"===a.type)r=new Nu(a.code,a.slices,a.stacks);else if("Geometry"===a.type)r=(new xs).parse(a.data).geometry;else{var h=l.ObjectLoader.prototype.parseGeometries([a],this.shapes);for(var p in h){r=h[p];break}}return r.uuid=a.uuid,r.name=void 0!==a.name?a.name:"geometry",r},ph.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(new Ye(JSON.parse(y)))},h,p)},ph.prototype.parse=function(a){if(void 0!==a.data){var r=new Ye;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,void 0!==a.reversed&&(r.reversed=a.reversed),"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,r.loadTTF()):"base64"===a.format?(r.format="arraybuffer",r.data=va.fromBase64(a.data),r.loadTTF()):(r.format=a.format,r.data=a.data,r.font=a.data),r}return new Ye(a)},Bh.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,p)},Bh.prototype.parse=function(a){var r=new Ot;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,"base64"===a.format?(r.format="arraybuffer",r.data=va.fromBase64(a.data)):"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data):(r.format=a.format,r.data=a.data),r},Hs.USER=21,Hs.ENVIRONMENT=22,(Hs.prototype=Object.create(l.Texture.prototype)).constructor=Hs,Hs.isTexture=!0,Hs.prototype.connect=function(){var a={facingMode:this.mode===Hs.USER?"user":{exact:"environment"}},r=this;void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:a}).then(function(h){r.stream=h,r.image.srcObject=h,r.image.play()}).catch(function(h){console.warn("nunuStudio: No webcam available")}):navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(h){r.stream=h,r.image.src=URL.createObjectURL(h)},function(h){console.warn("nunuStudio: No webcam available")})},Hs.prototype.disconnect=function(){if(null!==this.stream)for(var a=this.stream.getTracks(),r=0;r<a.length;r++)a[r].stop()},Hs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disconnect(),this.disposed=!0,this.image.paused||this.image.pause()},Hs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.mode=this.mode,r},Dl.prototype=Object.create(wi.prototype),Dl.fileIsVideo=function(a){return!(void 0===a||!a.type.startsWith("video"))},Dl.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),p=new Blob([h],{type:"video/"+r});this.data=URL.createObjectURL(p),this.arraybuffer=a,this.encoding=r,this.format="arraybuffer"},Dl.prototype.toJSON=function(a){if(void 0!==a.videos[this.uuid])return a.videos[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=va.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.videos[this.uuid]=r,r},Sa.prototype=Object.create(l.Texture.prototype),Sa.isVideoTexture=!0,Sa.prototype.setVideo=function(a){if(null==a)return this.video=null,void(this.image.src=null);this.video="string"==typeof a?new Dl(a):a,this.image.src=this.video.data},Sa.prototype.setTime=function(a){this.image.currentTime=a},Sa.prototype.setLoop=function(a){this.loop=a,this.image.loop=a},Sa.prototype.setVolume=function(a){this.volume=a>=0&&a<=1?a:a>=0?1:0,this.image.volume=this.volume},Sa.prototype.setAutoPlay=function(a){this.autoplay=a,this.image.autoplay=this.autoplay},Sa.prototype.setPlaybackRate=function(a){this.playbackRate=a,this.image.playbackRate=a},Sa.prototype.pause=function(){this.image.paused||this.image.pause()},Sa.prototype.play=function(){this.image.paused&&this.image.play()},Sa.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0,this.image.pause(),this.image.src="",this.image.load()},Sa.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.video.toJSON(a);return r.video=h.uuid,r.loop=this.loop,r.autoplay=this.autoplay,r.playbackRate=this.playbackRate,r.volume=this.volume,r},Ul.prototype=Object.create(gs.prototype),Ul.isTexture=!0,Ul.prototype.step=function(){this.currentFrame++,this.currentFrame>=this._endFrame&&(this.currentFrame=this._beginFrame),this.offset.x=this.currentFrame%this.framesHorizontal/this.framesHorizontal,this.offset.y=1-this.repeat.y-Math.floor(this.currentFrame/this.framesHorizontal)/this.framesVertical},Ul.prototype.setAnimationSpeed=function(a){this.animationSpeed=a},Ul.prototype.setFrameGrid=function(a,r){this._framesHorizontal=a,this._framesVertical=r,this._totalFrames=a*r,this.repeat.set(1/a,1/r)},Ul.prototype.setAnimationFrames=function(a,r){this.beginFrame=a,this.endFrame=r},Ul.prototype.dispose=function(){gs.prototype.dispose.call(this),this.disposed=!0},Ul.prototype.toJSON=function(a){var r=gs.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r.loop=this.loop,r.animationSpeed=this.animationSpeed,r.framesHorizontal=this._framesHorizontal,r.framesVertical=this._framesVertical,r.totalFrames=this._totalFrames,r.beginFrame=this._beginFrame,r.endFrame=this._endFrame,r},(zl.prototype=Object.create(l.Texture.prototype)).constructor=zl,zl.prototype.isDataTexture=!0,zl.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.image={height:this.image.height,width:this.image.width,data:Array.from(this.image.data)},r},(jl.prototype=Object.create(l.Texture.prototype)).constructor=jl,jl.prototype.isCompressedTexture=!0,jl.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.isCubeTexture=this.isCubeTexture,this.isCubeTexture){r.image=[];for(var h=0;h<this.image.length;h++){for(var p={mipmaps:[],format:this.image[h].format,width:this.image[h].width,height:this.image[h].height},y=0;y<this.image[h].mipmaps.length;y++)p.mipmaps.push({width:this.image[h].mipmaps[y].width,height:this.image[h].mipmaps[y].height,data:this.image[h].mipmaps[y].data});r.image.push(p)}}else for(r.mipmaps=[],r.width=this.image.width,r.height=this.image.height,y=0;y<this.mipmaps.length;y++)r.mipmaps.push({width:this.mipmaps[y].width,height:this.mipmaps[y].height,data:this.mipmaps[y].data});return r},Os.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Os.prototype.setPath=function(a){return this.path=a,this},Os.prototype.setImages=function(a){return this.images=a,this},Os.prototype.setVideos=function(a){return this.videos=a,this},Os.prototype.setFonts=function(a){return this.fonts=a,this},Os.prototype.load=function(a,r,h,p){try{var y=new gs(this.path+a);return void 0!==r&&r(y),y}catch(b){return void 0!==p&&p(b),console.warn("nunuStudio: Texture not found",b),new gs}},Os.prototype.loadJSON=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,p)},Os.prototype.parse=function(a,r){var h=null,p=a.category;if("Video"===p)void 0===a.video&&console.warn("nunuStudio: TextureLoader, No video specified for",a.uuid),void 0===this.videos[a.video]&&console.warn("nunuStudio: TextureLoader, Undefined video",a.video),(h=new Sa(this.videos[a.video])).setLoop(a.loop),h.setAutoPlay(a.autoplay),h.setPlaybackRate(a.playbackRate),h.setVolume(a.volume);else if("Webcam"===p)h=new Hs,void 0!==a.mode&&(h.mode=a.mode);else if("Compressed"===p)if(a.isCubeTexture){(h=new jl).image=[],h.isCubeTexture=!0;for(var y=0;y<a.image.length;y++){for(var b=0;b<a.image[y].mipmaps.length;b++)void 0!==a.image[y].mipmaps[b].data.toArrayBuffer&&(a.image[y].mipmaps[b].data=new Uint8Array(a.image[y].mipmaps[b].data.toArrayBuffer()));h.image.push(a.image[y])}}else{for(b=0;b<a.mipmaps.length;b++)void 0!==a.mipmaps[b].data.toArrayBuffer&&(a.mipmaps[b].data=new Uint8Array(a.mipmaps[b].data.toArrayBuffer()));h=new jl(a.mipmaps,a.width,a.height)}else if("Cube"===p){var R=[];for(b=0;b<a.images.length;b++)void 0===this.images[a.images[b]]&&console.warn("nunuStudio: TextureLoader, undefined image",a.images[b]),R.push(this.images[a.images[b]]);(h=new Tr).setImages(R,a.mode),h.setSize(a.size),h.updateImages()}else"Canvas"===p?h=new Fa(a.width,a.height):"DataTexture"===p?h=new zl(new Float32Array(a.image.data),a.image.width,a.image.height):(void 0===a.image&&console.warn("nunuStudio: TextureLoader, no image specified for",a.uuid),void 0===this.images[a.image]&&console.warn("nunuStudio: TextureLoader, undefined image",a.image),"SpriteSheet"===p?(console.log(this.images[a.image],a.framesHorizontal,a.framesVertical,a.totalFrames),(h=new Ul(this.images[a.image],a.framesHorizontal,a.framesVertical,a.totalFrames)).loop=a.loop,h.animationSpeed=a.animationSpeed,h.beginFrame=a.beginFrame,h.endFrame=a.endFrame):h=new gs(this.images[a.image]));return h.needsUpdate=!0,h.uuid=a.uuid,h.name=a.name,h.mapping=a.mapping,h.repeat.set(a.repeat[0],a.repeat[1]),h.offset.set(a.offset[0],a.offset[1]),void 0!==a.center&&h.center.set(a.center[0],a.center[1]),void 0!==a.rotation&&(h.rotation=a.rotation),h.wrapS=a.wrap[0],h.wrapT=a.wrap[1],void 0!==a.format&&(h.format=a.format),void 0!==a.type&&(h.type=a.type),void 0!==a.encoding&&(h.encoding=a.encoding),h.minFilter=a.minFilter,h.magFilter=a.magFilter,h.anisotropy=a.anisotropy,h.flipY=a.flipY,void 0!==a.premultiplyAlpha&&(h.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(h.unpackAlignment=a.unpackAlignment),void 0!==r&&r(h),h},Nh.prototype.load=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},Nh.prototype.parse=function(a){var r=new Dl(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,r},(Co.prototype=Object.create(L.prototype)).load=function(a,r,h,p){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,p)},Co.prototype.parse=function(a,r){this.parseResources(a.resources),this.parseShape(a.shapes),this.parseImages(a.images),this.parseGeometries(a.geometries),this.parseVideos(a.videos),this.parseAudio(a.audio),this.parseFonts(a.fonts),this.parseTextures(a.textures),this.parseMaterials(a.materials);var h=this.parseObject(a.object);return void 0!==a.skeletons&&(this.parseSkeletons(a.skeletons,h),this.bindSkeletons(h)),void 0!==a.images&&0!==a.images.length||void 0!==r&&r(h),h},Co.prototype.setTexturePath=function(a){this.texturePath=a},Co.prototype.setCrossOrigin=function(a){this.crossOrigin=a},Co.prototype.parseResources=function(a){if(void 0!==a)for(var r in a){var h=new Fl(a[r].data,a[r].encoding);h.format=a[r].format,h.name=a[r].name,h.uuid=a[r].uuid,this.resources[h.uuid]=h}return this.resources},Co.prototype.parseShape=function(a){if(void 0!==a)for(var r=0,h=a.length;r<h;r++){var p=(new Shape).fromJSON(a[r]);this.shapes[p.uuid]=p}return this.shapes},Co.prototype.parseGeometries=function(a){if(void 0!==a){var r=new Ru;r.setShapes(this.shapes),r.setImages(this.images);for(var h=0;h<a.length;h++)this.geometries[a[h].uuid]=r.parse(a[h])}return this.geometries},Co.prototype.parseMaterials=function(a){if(void 0!==a){var r=new iu;for(var h in r.setTextures(this.textures),a)this.materials[a[h].uuid]=r.parse(a[h])}return this.materials},Co.prototype.parseImages=function(a){if(void 0!==a){var r=new Bu;for(var h in a)this.images[a[h].uuid]=r.parse(a[h])}return this.images},Co.prototype.parseVideos=function(a){if(void 0!==a){var r=new Nh;for(var h in a)this.videos[a[h].uuid]=r.parse(a[h])}return this.videos},Co.prototype.parseAudio=function(a){if(void 0!==a){var r=new Bh;for(var h in a)this.audio[a[h].uuid]=r.parse(a[h])}return this.audio},Co.prototype.parseFonts=function(a){if(void 0!==a){var r=new ph;for(var h in a)this.fonts[a[h].uuid]=r.parse(a[h])}return this.fonts},Co.prototype.parseTextures=function(a){if(void 0!==a){var r=new Os;for(var h in r.setImages(this.images),r.setVideos(this.videos),a)this.textures[a[h].uuid]=r.parse(a[h])}return this.textures},Co.prototype.parseSkeletons=function(a,r){if(void 0!==a)for(var h=0;h<a.length;h++)this.skeletons[a[h].uuid]=l.Skeleton.fromJSON(a[h],r,this);return this.skeletons},Co.prototype.bindSkeletons=function(a){var r=this;a.traverse(function(h){if(h.isSkinnedMesh&&void 0!==h.skeletonUUID){var p=r.skeletons[h.skeletonUUID];if(void 0===p)return void console.warn("nunuStudio: ObjectLoader Skeleton not found.",h.skeletonUUID);delete h.skeletonUUID,h.bind(p,h.bindMatrix)}})},Co.prototype.parseObject=function(a){var r;try{switch(a.type){case"SpineAnimation":for(var h=0;h<a.textures.length;h++)a.textures[h].texture=this.getTexture(a.textures[h].texture);r=new ka(a.json,a.atlas,"",a.textures),void 0!==a.animation&&(r.animation=a.animation,r.track=a.track,r.loop=a.loop),void 0!==a.skin&&(r.skin=a.skin);break;case"Audio":(r=new ii(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume);break;case"PositionalAudio":(r=new Wt(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume),r.distanceModel=a.distanceModel,r.panningModel=a.panningModel;break;case"Physics":r=De.fromJSON(a);break;case"ParticleEmiter":r=ko.fromJSON(a,this);break;case"LensFlare":for(r=new ch,void 0!==a.lensFlares&&(a.elements=a.lensFlares),h=0;h<a.elements.length;h++)r.addFlare(this.getTexture(a.elements[h].texture),a.elements[h].size,a.elements[h].distance,new l.Color(a.elements[h].color));break;case"TextMesh":case"Text3D":r=new na(a.text,this.getMaterial(a.material),this.getFont(a.font),a.height,a.bevel,a.bevelThickness,a.bevelSize,a.size,a.curveSegments,a.extruded);break;case"Program":(r=new hi(a.name)).description=a.description,r.author=a.author,r.version=a.version,r.ar=!0===a.ar,r.vr=a.vr,r.vrScale=a.vrScale,void 0!==a.rendererConfig?r.rendererConfig.fromJSON(a.rendererConfig):(r.rendererConfig.antialiasing=a.antialiasing,r.rendererConfig.shadows=a.shadows,r.rendererConfig.shadowsType=a.shadowsType,r.rendererConfig.toneMapping=a.toneMapping,r.rendererConfig.toneMappingExposure=a.toneMappingExposure),void 0!==a.lockPointer&&(r.lockPointer=a.lockPointer),void 0!==a.defaultScene&&(r.defaultScene=a.defaultScene),void 0!==a.handlePixelRatio&&(r.handlePixelRatio=a.handlePixelRatio);break;case"Sky":if(r=new Lr(a.autoUpdate,a.dayTime,a.sunDistance,a.time),void 0!==a.sun&&(r.sun.shadow.fromJSON(a.sun.shadow),void 0!==a.sun.castShadow&&(r.sun.castShadow=a.sun.castShadow)),void 0!==a.colorTop)for(r.colorTop=[],h=0;h<a.colorTop.length;h++)r.colorTop.push(new l.Color(a.colorTop[h]));if(void 0!==a.colorBottom)for(r.colorBottom=[],h=0;h<a.colorBottom.length;h++)r.colorBottom.push(new l.Color(a.colorBottom[h]));void 0!==a.sunColor&&(r.sunColor=a.sunColor),void 0!==a.moonColor&&(r.moonColor=a.moonColor),void 0!==a.intensity&&(r.intensity=a.intensity);break;case"CubeCamera":r=new br(a.near,a.far,a.resolution,a.autoUpdate);break;case"FirstPersonControls":(r=new nu).sensitivity=a.sensitivity,r.needsButtonPressed=a.needsButtonPressed,r.movementEnabled=a.movementEnabled,r.moveSpeed=a.moveSpeed,r.moveOnPlane=a.moveOnPlane,r.moveKeys=a.moveKeys;break;case"OrbitControls":(r=new ba).distance=a.distance,r.maxDistance=a.maxDistance,r.minDistance=a.minDistance,r.sensitivity=a.sensitivity,r.limitUp=a.limitUp,r.limitDown=a.limitDown,r.needsButtonPressed=a.needsButtonPressed,r.zoomEnabled=a.zoomEnabled,r.movementEnabled=a.movementEnabled,void 0!==a.smooth&&(r.smooth=a.smooth,r.friction=a.friction,r.speed=a.speed,r.invertNavigation=a.invertNavigation),void 0!==a.center&&(r.center.fromArray(a.center),r.vector.fromArray(a.vector));break;case"Scene":r=new Fo,void 0!==a.background&&(r.background=Number.isInteger(a.background)?new l.Color(a.background):this.getTexture(a.background)),void 0!==a.environment&&(r.environment=this.getTexture(a.environment)),void 0!==a.fog&&("Fog"===a.fog.type?r.fog=new l.Fog(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(r.fog=new l.FogExp2(a.fog.color,a.fog.density))),void 0!==a.defaultCamera&&(r.defaultCamera=this.parse(a.defaultCamera)),void 0!==a.cameras&&(r.cameras=a.cameras),void 0!==a.usePhysics&&(r.usePhysics=a.usePhysics),void 0!==a.world&&(r.world.gravity.set(a.world.gravity.x,a.world.gravity.y,a.world.gravity.z),r.world.quatNormalizeSkip=a.world.quatNormalizeSkip,r.world.quatNormalizeFast=a.world.quatNormalizeFast,r.world.solver.tolerance=a.world.solver.tolerance,r.world.solver.iterations=a.world.solver.iterations);break;case"PerspectiveCamera":r=new ke(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(r.focus=a.focus),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.filmGauge&&(r.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(r.filmOffset=a.filmOffset),void 0!==a.view&&(r.view=Object.assign({},a.view)),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer));break;case"OrthographicCamera":r=new Is(a.size,a.aspect,a.mode,a.near,a.far),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer)),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.view&&(r.view=Object.assign({},a.view));break;case"Script":r=new Sn(a.code,a.mode);break;case"PythonScript":r=new Ii(a.code);break;case"NodeScript":(r=new NodeScript).graph=Object2D.parse(a.graph);break;case"RectAreaLight":r=new In(a.color,a.intensity,a.width,a.height);break;case"AmbientLight":r=new Ls(a.color,a.intensity);break;case"DirectionalLight":r=new ml(a.color,a.intensity);break;case"PointLight":r=new He(a.color,a.intensity,a.distance,a.decay);break;case"SpotLight":r=new Gs(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":r=new Mu(a.color,a.groundColor,a.intensity);break;case"HTMLView":(r=new rc).height=a.height,r.width=a.width,r.url=a.url;break;case"LightProbe":(r=new Rc).sh.fromArray(a.sh);break;case"InstancedMesh":(r=new ea(this.getGeometry(a.geometry),this.getMaterial(a.material),a.count)).instanceMatrix=new l.BufferAttribute(new Float32Array(a.instanceMatrix.array),16);break;case"SkinnedMesh":r=new Hn(this.getGeometry(a.geometry),this.getMaterial(a.material)),void 0!==a.skeleton&&(r.skeletonUUID=a.skeleton),void 0!==a.bindMode&&(r.bindMode=a.bindMode),void 0!==a.bindMatrix&&r.bindMatrix.fromArray(a.bindMatrix);break;case"Mesh":r=new uh(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"TextBitmap":r=Vo.fromJSON(a,this.getTexture(a.texture));break;case"TextSprite":r=cc.fromJSON(a);break;case"LOD":r=new l.LOD;break;case"Line":r=new l.Line(this.getGeometry(a.geometry),this.getMaterial(a.material),a.mode);break;case"LineLoop":r=new l.LineLoop(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"LineSegments":r=new l.LineSegments(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"PointCloud":case"Points":r=new l.Points(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"Sprite":r=new Oc(this.getMaterial(a.material));break;case"Group":default:r=new Tu;break;case"BillboardGroup":r=new uc;break;case"Bone":r=new l.Bone}}catch(U){console.error("nunuStudio: Error parsing and creating object "+a.uuid+", object skiped.",U,a),r=new Tu}if(r.uuid=a.uuid,r.name=a.name,r.locked=!0===a.locked||!0===a.hidden,r.folded=!0===a.folded,void 0!==a.frustumCulled&&(r.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(r.renderOrder=a.renderOrder),void 0!==a.animations)for(r.animations=[],h=0;h<a.animations.length;h++){var p=l.AnimationClip.parse(a.animations[h]);void 0!==a.animations[h].uuid&&(p.uuid=a.animations[h].uuid),r.animations.push(p)}if(void 0!==a.matrix&&(r.matrix.fromArray(a.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),void 0!==a.position&&r.position.fromArray(a.position),void 0!==a.rotation&&r.rotation.fromArray(a.rotation),void 0!==a.quaternion&&r.quaternion.fromArray(a.quaternion),void 0!==a.scale&&r.scale.fromArray(a.scale),r.castShadow=!0===a.castShadow,r.receiveShadow=!0===a.receiveShadow,void 0!==a.shadow&&r.shadow.fromJSON(a.shadow),r.visible=!0===a.visible,void 0!==a.userData&&(r.userData=a.userData),void 0!==a.layers&&(r.layers.mask=a.layers),void 0!==a.children)for(var y in a.children)r.add(this.parseObject(a.children[y]));if(void 0!==a.matrixAutoUpdate&&(r.matrixAutoUpdate=a.matrixAutoUpdate,r.matrixAutoUpdate||(r.updateMatrix(),r.updateMatrixWorld(!0))),"Program"===a.type)r.copyResources(this);else if("Scene"===a.type)for(h=0;h<r.cameras.length;h++){var b=r.getCamera(r.cameras[h]);null!==b?r.cameras[h]=b:r.cameras.splice(h,1)}else if("LOD"===a.type)for(var R=a.levels,O=0;O<R.length;O++){var T=R[O];void 0!==(y=r.getObjectByProperty("uuid",T.object))&&r.addLevel(y,T.distance)}return r};const rp="// All uniforms used by vertex / fragment shaders\nuniform float deltaTime;\nuniform float runTime;\nuniform sampler2D textureSampler;\nuniform vec4 textureAnimation;\nuniform float scale;\n",ou="varying vec4 vColor;\n\n#ifdef SHOULD_ROTATE_TEXTURE\n    varying float vAngle;\n#endif\n\n#ifdef SHOULD_CALCULATE_SPRITE\n    varying vec4 vSpriteSheet;\n#endif",_f="// Branch-avoiding comparison fns\n//- http:// theorangeduck.com/page/avoiding-shader-conditionals\nfloat when_gt(float x, float y) {\n    return max(sign(x - y), 0.0);\n}\n\nfloat when_lt(float x, float y) {\n    return min(max(1.0 - sign(x - y), 0.0), 1.0);\n}\n\nfloat when_eq(float x, float y) {\n    return 1.0 - abs(sign(x - y));\n}\n\nfloat when_ge(float x, float y) {\n  return 1.0 - when_lt(x, y);\n}\n\nfloat when_le(float x, float y) {\n  return 1.0 - when_gt(x, y);\n}\n\n// Branch-avoiding logical operators (to be used with above comparison fns)\nfloat and(float a, float b) {\n    return a * b;\n}\n\nfloat or(float a, float b) {\n    return min(a + b, 1.0);\n}";var Pu={vertex:["// Register color-packing define statements.\n#define PACKED_COLOR_SIZE 256.0\n#define PACKED_COLOR_DIVISOR 255.0",rp,"// All attributes used by the vertex shader.\n//\n// Note that some attributes are squashed into other ones\n//\n// Drag is stored in acceleration.w\nattribute vec4 acceleration;\nattribute vec3 velocity;\nattribute vec4 rotation;\nattribute vec3 rotationCenter;\nattribute vec4 params;\nattribute vec4 size;\nattribute vec4 angle;\nattribute vec4 color;\nattribute vec4 opacity;",ou,l.ShaderChunk.common,l.ShaderChunk.logdepthbuf_pars_vertex,l.ShaderChunk.fog_pars_vertex,_f,"// From:\n//- http:// stackoverflow.com/a/12553149\n//- https:// stackoverflow.com/questions/22895237/hexadecimal-to-rgb-values-in-webgl-shader\n// unpackColor\nvec3 unpackColor(in float hex) {\n    vec3 c = vec3(0.0);\n\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float b = mod(hex, PACKED_COLOR_SIZE);\n\n    c.r = r / PACKED_COLOR_DIVISOR;\n    c.g = g / PACKED_COLOR_DIVISOR;\n    c.b = b / PACKED_COLOR_DIVISOR;\n\n    return c;\n}\n\n// unpackRotationAxis\nvec3 unpackRotationAxis(in float hex) {\n    vec3 c = vec3(0.0);\n\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float b = mod(hex, PACKED_COLOR_SIZE);\n\n    c.r = r / PACKED_COLOR_DIVISOR;\n    c.g = g / PACKED_COLOR_DIVISOR;\n    c.b = b / PACKED_COLOR_DIVISOR;\n\n    c *= vec3(2.0);\n    c -= vec3(1.0);\n\n    return c;\n}\n\n// floatOverLifetime:\nfloat getFloatOverLifetime(in float positionInTime, in vec4 attr) {\n    highp float value = 0.0;\n    float deltaAge = positionInTime * float(VALUE_OVER_LIFETIME_LENGTH - 1);\n    float fIndex = 0.0;\n    float shouldApplyValue = 0.0;\n\n    // This might look a little odd, but it's faster in the testing I\"ve done than using branches. Uses basic maths to avoid branching.\n    //\n    // Take a look at the branch-avoidance functions defined above, and be sure to check out The Orange Duck site where I got this from (link above).\n    //\n    // Fix for static emitters (age is always zero).\n    value += attr[0] * when_eq(deltaAge, 0.0);\n\n    for(int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i) {\n        fIndex = float(i);\n        shouldApplyValue = and(when_gt(deltaAge, fIndex), when_le(deltaAge, fIndex + 1.0));\n        value += shouldApplyValue * mix(attr[i], attr[i + 1], deltaAge - fIndex);\n    }\n\n    return value;\n}\n\n// colorOverLifetime\nvec3 getColorOverLifetime(in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4) {\n    vec3 value = vec3(0.0);\n    value.x = getFloatOverLifetime(positionInTime, vec4(color1.x, color2.x, color3.x, color4.x));\n    value.y = getFloatOverLifetime(positionInTime, vec4(color1.y, color2.y, color3.y, color4.y));\n    value.z = getFloatOverLifetime(positionInTime, vec4(color1.z, color2.z, color3.z, color4.z));\n    return value;\n}\n\n// paramFetchingFunctions\nfloat getAlive() {\n    return params.x;\n}\n\nfloat getAge() {\n    return params.y;\n}\n\nfloat getMaxAge() {\n    return params.z;\n}\n\nfloat getWiggle() {\n    return params.w;\n}\n\n// forceFetchingFunctions\nvec4 getPosition(in float age) {\n    return modelViewMatrix * vec4(position, 1.0);\n}\n\nvec3 getVelocity(in float age) {\n    return velocity * age;\n}\n\nvec3 getAcceleration(in float age) {\n    return acceleration.xyz * age;\n}\n\n\n// rotationFunctions\n// Huge thanks to:\n//- http:// www.neilmendoza.com/glsl-rotation-about-an-arbitrary-axis/\n#ifdef SHOULD_ROTATE_PARTICLES\nmat4 getRotationMatrix(in vec3 axis, in float angle) {\n   axis = normalize(axis);\n   float s = sin(angle);\n   float c = cos(angle);\n   float oc = 1.0 - c;\n\n   return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n               oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n               oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n               0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 getRotation(in vec3 pos, in float positionInTime) {\n  if(rotation.y == 0.0) {\n       return pos;\n  }\n\n  vec3 axis = unpackRotationAxis(rotation.x);\n  vec3 center = rotationCenter;\n  vec3 translated;\n  mat4 rotationMatrix;\n\n  float angle = 0.0;\n  angle += when_eq(rotation.z, 0.0) * rotation.y;\n  angle += when_gt(rotation.z, 0.0) * mix(0.0, rotation.y, positionInTime);\n  translated = rotationCenter - pos;\n  rotationMatrix = getRotationMatrix(axis, angle);\n  return center - vec3(rotationMatrix * vec4(translated, 0.0));\n}\n#endif\n","void main() {","// Setup\nhighp float age = getAge();\nhighp float alive = getAlive();\nhighp float maxAge = getMaxAge();\nhighp float positionInTime = (age / maxAge);\nhighp float isAlive = when_gt(alive, 0.0);\n#ifdef SHOULD_WIGGLE_PARTICLES\n\tfloat wiggleAmount = positionInTime * getWiggle();\n\tfloat wiggleSin = isAlive * sin(wiggleAmount);\n\tfloat wiggleCos = isAlive * cos(wiggleAmount);\n#endif\n\n// Forces\n// Get forces & position\nvec3 vel = getVelocity(age);\nvec3 accel = getAcceleration(age);\nvec3 force = vec3(0.0);\nvec3 pos = vec3(position);\n\n// Calculate the required drag to apply to the forces.\nfloat drag = 1.0 - (positionInTime * 0.5) * acceleration.w;\n\n// Integrate forces\nforce += vel;\nforce *= drag;\nforce += accel * age;\npos += force;\n\n// Wiggly wiggly wiggle!\n#ifdef SHOULD_WIGGLE_PARTICLES\n\tpos.x += wiggleSin;\n\tpos.y += wiggleCos;\n\tpos.z += wiggleSin;\n#endif\n\n// Rotate the emitter around it's central point\n#ifdef SHOULD_ROTATE_PARTICLES\n\tpos = getRotation(pos, positionInTime);\n#endif\n\n// Convert pos to a world-space value\nvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n// Determine point size.\nhighp float pointSize = getFloatOverLifetime(positionInTime, size) * isAlive;\n\n// Determine perspective\n#ifdef HAS_PERSPECTIVE\n\tfloat perspective = scale / length(mvPosition.xyz);\n#else\n\tfloat perspective = 1.0;\n#endif\n\n// Apply perpective to pointSize value\nfloat pointSizePerspective = pointSize * perspective;\n\n// Determine color and opacity for this particle\n#ifdef COLORIZE\n\tvec3 c = isAlive * getColorOverLifetime(\n\t\tpositionInTime,\n\t\tunpackColor(color.x),\n\t\tunpackColor(color.y),\n\t\tunpackColor(color.z),\n\t\tunpackColor(color.w)\n\t);\n#else\n\tvec3 c = vec3(1.0);\n#endif\n\nfloat o = isAlive * getFloatOverLifetime(positionInTime, opacity);\n\n// Assign color to vColor varying.\nvColor = vec4(c, o);\n\n// Determine angle\n#ifdef SHOULD_ROTATE_TEXTURE\n\tvAngle = isAlive * getFloatOverLifetime(positionInTime, angle);\n#endif\n\n// If this particle is using a sprite-sheet as a texture, we\"ll have to figure out what frame of the texture the particle is using at it's current position in time.\n#ifdef SHOULD_CALCULATE_SPRITE\n\tfloat framesX = textureAnimation.x;\n\tfloat framesY = textureAnimation.y;\n\tfloat loopCount = textureAnimation.w;\n\tfloat totalFrames = textureAnimation.z;\n\tfloat frameNumber = mod((positionInTime * loopCount) * totalFrames, totalFrames);\n\n\tfloat column = floor(mod(frameNumber, framesX));\n\tfloat row = floor((frameNumber - column) / framesX);\n\n\tfloat columnNorm = column / framesX;\n\tfloat rowNorm = row / framesY;\n\n\tvSpriteSheet.x = 1.0 / framesX;\n\tvSpriteSheet.y = 1.0 / framesY;\n\tvSpriteSheet.z = columnNorm;\n\tvSpriteSheet.w = rowNorm;\n#endif\n\n// Write values\n// Set PointSize according to size at current point in time.\ngl_PointSize = pointSizePerspective;\ngl_Position = projectionMatrix * mvPosition;",l.ShaderChunk.logdepthbuf_vertex,l.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[rp,l.ShaderChunk.common,l.ShaderChunk.fog_pars_fragment,l.ShaderChunk.logdepthbuf_pars_fragment,ou,_f,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if(vColor.w < float(ALPHATEST)) discard;","    #endif","// Rotate Texture\nvec2 vUv = vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y);\n\n#ifdef SHOULD_ROTATE_TEXTURE\n   float x = gl_PointCoord.x - 0.5;\n   float y = 1.0 - gl_PointCoord.y - 0.5;\n   float c = cos(-vAngle);\n   float s = sin(-vAngle);\n\n   vUv = vec2(c * x + s * y + 0.5, c * y - s * x + 0.5);\n#endif\n\n// Spritesheets overwrite angle calculations.\n#ifdef SHOULD_CALCULATE_SPRITE\n    float framesX = vSpriteSheet.x;\n    float framesY = vSpriteSheet.y;\n    float columnNorm = vSpriteSheet.z;\n    float rowNorm = vSpriteSheet.w;\n\n    vUv.x = gl_PointCoord.x * framesX + columnNorm;\n    vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);\n#endif\n\nvec4 rotatedTexture = texture2D(textureSampler, vUv);\n",l.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4(outgoingLight.xyz, rotatedTexture.w * vColor.w);",l.ShaderChunk.fog_fragment,"}"].join("\n")};function Oo(a,r,h,p){this.componentSize=h||1,this.size=r||1,this.TypedArrayConstructor=a||Float32Array,this.array=new a(r*this.componentSize),this.indexOffset=p||0}function Lo(a,r,h){this.type="string"==typeof a&&Lo.typeSizeMap.hasOwnProperty(a)?a:"f",this.componentSize=Lo.typeSizeMap[this.type],this.arrayType=h||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=Boolean(r),this.updateMin=0,this.updateMax=0}Oo.constructor=Oo,Oo.prototype.setSize=function(a,r){var h=this.array.length;return r||(a*=this.componentSize),a<h?this.shrink(a):a>h?this.grow(a):void 0},Oo.prototype.shrink=function(a){return this.array=this.array.subarray(0,a),this.size=a,this},Oo.prototype.grow=function(a){var r=this.array,h=new this.TypedArrayConstructor(a);return h.set(r),this.array=h,this.size=a,this},Oo.prototype.splice=function(a,r){a*=this.componentSize,r*=this.componentSize;for(var h=[],p=this.array,y=p.length,b=0;b<y;++b)(b<a||b>=r)&&h.push(p[b]);return this.setFromArray(0,h),this},Oo.prototype.setFromArray=function(a,r){var h=a+r.length;return h>this.array.length?this.grow(h):h<this.array.length&&this.shrink(h),this.array.set(r,this.indexOffset+a),this},Oo.prototype.setVec2=function(a,r){return this.setVec2Components(a,r.x,r.y)},Oo.prototype.setVec2Components=function(a,r,h){var p=this.array,y=this.indexOffset+a*this.componentSize;return p[y]=r,p[y+1]=h,this},Oo.prototype.setVec3=function(a,r){return this.setVec3Components(a,r.x,r.y,r.z)},Oo.prototype.setVec3Components=function(a,r,h,p){var y=this.array,b=this.indexOffset+a*this.componentSize;return y[b]=r,y[b+1]=h,y[b+2]=p,this},Oo.prototype.setVec4=function(a,r){return this.setVec4Components(a,r.x,r.y,r.z,r.w)},Oo.prototype.setVec4Components=function(a,r,h,p,y){var b=this.array,R=this.indexOffset+a*this.componentSize;return b[R]=r,b[R+1]=h,b[R+2]=p,b[R+3]=y,this},Oo.prototype.setMat3=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Oo.prototype.setMat4=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Oo.prototype.setColor=function(a,r){return this.setVec3Components(a,r.r,r.g,r.b)},Oo.prototype.setNumber=function(a,r){return this.array[this.indexOffset+a*this.componentSize]=r,this},Oo.prototype.getValueAtIndex=function(a){return this.array[this.indexOffset+a]},Oo.prototype.getComponentValueAtIndex=function(a){return this.array.subarray(this.indexOffset+a*this.componentSize)},Lo.constructor=Lo,Lo.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},Lo.prototype.setUpdateRange=function(a,r){this.updateMin=Math.min(a*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(r*this.componentSize,this.updateMax*this.componentSize)},Lo.prototype.flagUpdate=function(){var a=this.bufferAttribute.updateRange;a.offset=this.updateMin,a.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),this.bufferAttribute.needsUpdate=!0},Lo.prototype.resetUpdateRange=function(){this.updateMin=0,this.updateMax=0},Lo.prototype.resetDynamic=function(){this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Lo.prototype.splice=function(a,r){this.typedArray.splice(a,r),this.forceUpdateAll()},Lo.prototype.forceUpdateAll=function(){this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.usage=l.StaticDrawUsage,this.bufferAttribute.needsUpdate=!0},Lo.prototype._ensureTypedArray=function(a){null!==this.typedArray&&this.typedArray.size===a*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==a?this.typedArray.setSize(a):null===this.typedArray&&(this.typedArray=new Oo(this.arrayType,a,this.componentSize)))},Lo.prototype._createBufferAttribute=function(a){if(this._ensureTypedArray(a),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize,void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new l.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Lo.prototype.getLength=function(){return null===this.typedArray?0:this.typedArray.array.length};var Dc,kt={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(a,r,h){return typeof a===r?a:h},ensureArrayTypedArg:function(a,r,h){if(Array.isArray(a)){for(var p=a.length-1;p>=0;--p)if(typeof a[p]!==r)return h;return a}return this.ensureTypedArg(a,r,h)},ensureInstanceOf:function(a,r,h){return void 0!==r&&a instanceof r?a:h},ensureArrayInstanceOf:function(a,r,h){if(Array.isArray(a)){for(var p=a.length-1;p>=0;--p)if(void 0!==r&&a[p]instanceof r==0)return h;return a}return this.ensureInstanceOf(a,r,h)},ensureValueOverLifetimeCompliance:function(a,r,h){r=r||3,h=h||3,!1===Array.isArray(a._value)&&(a._value=[a._value]),!1===Array.isArray(a._spread)&&(a._spread=[a._spread]);var p=this.clamp(a._value.length,r,h),y=this.clamp(a._spread.length,r,h),b=Math.max(p,y);a._value.length!==b&&(a._value=this.interpolateArray(a._value,b)),a._spread.length!==b&&(a._spread=this.interpolateArray(a._spread,b))},interpolateArray:function(a,r){for(var h=a.length,p=["function"==typeof a[0].clone?a[0].clone():a[0]],y=(h-1)/(r-1),b=1;b<r-1;++b){var R=b*y,O=Math.floor(R),T=Math.ceil(R);p[b]=this.lerpTypeAgnostic(a[O],a[T],R-O)}return p.push("function"==typeof a[h-1].clone?a[h-1].clone():a[h-1]),p},clamp:function(a,r,h){return Math.max(r,Math.min(a,h))},zeroToEpsilon:function(a,r){var h=1e-5,p=a;return p=r?Math.random()*h*10:h,a<0&&a>-1e-5&&(p=-p),p},lerpTypeAgnostic:function(a,r,h){var p,y=this.types;return typeof a===y.NUMBER&&typeof r===y.NUMBER?a+(r-a)*h:a instanceof l.Vector2&&r instanceof l.Vector2?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p):a instanceof l.Vector3&&r instanceof l.Vector3?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p.z=this.lerp(a.z,r.z,h),p):a instanceof l.Vector4&&r instanceof l.Vector4?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p.z=this.lerp(a.z,r.z,h),p.w=this.lerp(a.w,r.w,h),p):a instanceof l.Color&&r instanceof l.Color?((p=a.clone()).r=this.lerp(a.r,r.r,h),p.g=this.lerp(a.g,r.g,h),p.b=this.lerp(a.b,r.b,h),p):void console.warn("nunuStudio: Invalid argument types, or argument types do not match.",a,r)},lerp:function(a,r,h){return a+(r-a)*h},roundToNearestMultiple:function(a,r){var h;return 0===r||0==(h=Math.abs(a)%r)?a:a<0?-(Math.abs(a)-h):a+r-h},arrayValuesAreEqual:function(a){for(var r=0;r<a.length-1;++r)if(a[r]!==a[r+1])return!1;return!0},randomFloat:function(a,r){return a+r*(Math.random()-.5)},randomVector3:function(a,r,h,p,y){var b=h.x+(Math.random()*p.x-.5*p.x),R=h.y+(Math.random()*p.y-.5*p.y),O=h.z+(Math.random()*p.z-.5*p.z);y&&(b=.5*-y.x+this.roundToNearestMultiple(b,y.x),R=.5*-y.y+this.roundToNearestMultiple(R,y.y),O=.5*-y.z+this.roundToNearestMultiple(O,y.z)),a.typedArray.setVec3Components(r,b,R,O)},randomColor:function(a,r,h,p){var y=h.r+Math.random()*p.x,b=h.g+Math.random()*p.y,R=h.b+Math.random()*p.z;y=this.clamp(y,0,1),b=this.clamp(b,0,1),R=this.clamp(R,0,1),a.typedArray.setVec3Components(r,y,b,R)},randomColorAsHex:(Dc=new l.Color,function(a,r,h,p){for(var y=h.length,b=[],R=0;R<y;++R){var O=p[R];Dc.copy(h[R]),Dc.r+=Math.random()*O.x-.5*O.x,Dc.g+=Math.random()*O.y-.5*O.y,Dc.b+=Math.random()*O.z-.5*O.z,Dc.r=this.clamp(Dc.r,0,1),Dc.g=this.clamp(Dc.g,0,1),Dc.b=this.clamp(Dc.b,0,1),b.push(Dc.getHex())}a.typedArray.setVec4Components(r,b[0],b[1],b[2],b[3])}),randomVector3OnSphere:function(a,r,h,p,y,b,R,O){var T=2*Math.random()-1,U=6.2832*Math.random(),ee=Math.sqrt(1-T*T),ie=this.randomFloat(p,y),ne=0,ve=0,be=0;R&&(ie=Math.round(ie/R)*R),ne=ee*Math.cos(U)*ie,ve=ee*Math.sin(U)*ie,be=T*ie,ne*=b.x,ve*=b.y,be*=b.z,a.typedArray.setVec3Components(r,ne+=h.x,ve+=h.y,be+=h.z)},seededRandom:function(a){var r=1e4*Math.sin(a);return r-(0|r)},randomVector3OnDisc:function(a,r,h,p,y,b,R){var O=6.2832*Math.random(),T=Math.abs(this.randomFloat(p,y)),U=0,ee=0,ie=0;R&&(T=Math.round(T/R)*R),U=Math.cos(O)*T,ee=Math.sin(O)*T,U*=b.x,ee*=b.y,a.typedArray.setVec3Components(r,U+=h.x,ee+=h.y,ie+=h.z)},randomDirectionVector3OnSphere:function(){var a=new l.Vector3;return function(r,h,p,y,b,R,O,T){a.copy(R),a.x-=p,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(O,T)),r.typedArray.setVec3Components(h,a.x,a.y,a.z)}}(),randomDirectionVector3OnDisc:function(){var a=new l.Vector3;return function(r,h,p,y,b,R,O,T){a.copy(R),a.x-=p,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(O,T)),r.typedArray.setVec3Components(h,a.x,a.y,0)}}(),getPackedRotationAxis:function(){var a=new l.Vector3,r=new l.Vector3,h=new l.Color,p=new l.Vector3(1,1,1);return function(y,b){return a.copy(y).normalize(),r.copy(b).normalize(),a.x+=.5*-b.x+Math.random()*b.x,a.y+=.5*-b.y+Math.random()*b.y,a.z+=.5*-b.z+Math.random()*b.z,a.normalize().add(p).multiplyScalar(.5),h.setRGB(a.x,a.y,a.z),h.getHex()}}()},Fp={BOX:1,SPHERE:2,DISC:3};function ji(a){for(var r in(a=kt.ensureTypedArg(a,kt.types.OBJECT,{})).position=kt.ensureTypedArg(a.position,kt.types.OBJECT,{}),a.velocity=kt.ensureTypedArg(a.velocity,kt.types.OBJECT,{}),a.acceleration=kt.ensureTypedArg(a.acceleration,kt.types.OBJECT,{}),a.radius=kt.ensureTypedArg(a.radius,kt.types.OBJECT,{}),a.drag=kt.ensureTypedArg(a.drag,kt.types.OBJECT,{}),a.rotation=kt.ensureTypedArg(a.rotation,kt.types.OBJECT,{}),a.color=kt.ensureTypedArg(a.color,kt.types.OBJECT,{}),a.opacity=kt.ensureTypedArg(a.opacity,kt.types.OBJECT,{}),a.size=kt.ensureTypedArg(a.size,kt.types.OBJECT,{}),a.angle=kt.ensureTypedArg(a.angle,kt.types.OBJECT,{}),a.wiggle=kt.ensureTypedArg(a.wiggle,kt.types.OBJECT,{}),a.maxAge=kt.ensureTypedArg(a.maxAge,kt.types.OBJECT,{}),a.onParticleSpawn&&console.warn("nunuStudio: onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=l.Math.generateUUID(),this.type=kt.ensureTypedArg(a.type,kt.types.NUMBER,Fp.BOX),this.position={_value:kt.ensureInstanceOf(a.position.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.position.spread,l.Vector3,new l.Vector3),_spreadClamp:kt.ensureInstanceOf(a.position.spreadClamp,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.position.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1),_radius:kt.ensureTypedArg(a.position.radius,kt.types.NUMBER,10),_radiusScale:kt.ensureInstanceOf(a.position.radiusScale,l.Vector3,new l.Vector3(1,1,1)),_distributionClamp:kt.ensureTypedArg(a.position.distributionClamp,kt.types.NUMBER,0)},this.velocity={_value:kt.ensureInstanceOf(a.velocity.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.velocity.spread,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.velocity.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.acceleration={_value:kt.ensureInstanceOf(a.acceleration.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.acceleration.spread,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.acceleration.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.drag={_value:kt.ensureTypedArg(a.drag.value,kt.types.NUMBER,0),_spread:kt.ensureTypedArg(a.drag.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.wiggle={_value:kt.ensureTypedArg(a.wiggle.value,kt.types.NUMBER,0),_spread:kt.ensureTypedArg(a.wiggle.spread,kt.types.NUMBER,0)},this.rotation={_axis:kt.ensureInstanceOf(a.rotation.axis,l.Vector3,new l.Vector3(0,1,0)),_axisSpread:kt.ensureInstanceOf(a.rotation.axisSpread,l.Vector3,new l.Vector3),_angle:kt.ensureTypedArg(a.rotation.angle,kt.types.NUMBER,0),_angleSpread:kt.ensureTypedArg(a.rotation.angleSpread,kt.types.NUMBER,0),_static:kt.ensureTypedArg(a.rotation.static,kt.types.BOOLEAN,!1),_center:kt.ensureInstanceOf(a.rotation.center,l.Vector3,this.position._value.clone()),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.maxAge={_value:kt.ensureTypedArg(a.maxAge.value,kt.types.NUMBER,2),_spread:kt.ensureTypedArg(a.maxAge.spread,kt.types.NUMBER,0)},this.color={_value:kt.ensureArrayInstanceOf(a.color.value,l.Color,new l.Color),_spread:kt.ensureArrayInstanceOf(a.color.spread,l.Vector3,new l.Vector3),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.opacity={_value:kt.ensureArrayTypedArg(a.opacity.value,kt.types.NUMBER,1),_spread:kt.ensureArrayTypedArg(a.opacity.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.size={_value:kt.ensureArrayTypedArg(a.size.value,kt.types.NUMBER,1),_spread:kt.ensureArrayTypedArg(a.size.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.angle={_value:kt.ensureArrayTypedArg(a.angle.value,kt.types.NUMBER,0),_spread:kt.ensureArrayTypedArg(a.angle.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.particleCount=kt.ensureTypedArg(a.particleCount,kt.types.NUMBER,100),this.duration=kt.ensureTypedArg(a.duration,kt.types.NUMBER,null),this.isStatic=kt.ensureTypedArg(a.isStatic,kt.types.BOOLEAN,!1),this.activeMultiplier=kt.ensureTypedArg(a.activeMultiplier,kt.types.NUMBER,1),this.direction=kt.ensureTypedArg(a.direction,kt.types.NUMBER,1),this.alive=kt.ensureTypedArg(a.alive,kt.types.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)||kt.ensureTypedArg(a.radius.randomise,kt.types.BOOLEAN,!1),velocity:kt.ensureTypedArg(a.velocity.randomise,kt.types.BOOLEAN,!1),acceleration:kt.ensureTypedArg(a.acceleration.randomise,kt.types.BOOLEAN,!1)||kt.ensureTypedArg(a.drag.randomise,kt.types.BOOLEAN,!1),rotation:kt.ensureTypedArg(a.rotation.randomise,kt.types.BOOLEAN,!1),rotationCenter:kt.ensureTypedArg(a.rotation.randomise,kt.types.BOOLEAN,!1),size:kt.ensureTypedArg(a.size.randomise,kt.types.BOOLEAN,!1),color:kt.ensureTypedArg(a.color.randomise,kt.types.BOOLEAN,!1),opacity:kt.ensureTypedArg(a.opacity.randomise,kt.types.BOOLEAN,!1),angle:kt.ensureTypedArg(a.angle.randomise,kt.types.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(r)&&(this.updateCounts[this.updateMap[r]]=0,this.updateFlags[this.updateMap[r]]=!1,this._createGetterSetters(this[r],r));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,kt.ensureValueOverLifetimeCompliance(this.color,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.opacity,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.size,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.angle,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength)}function Vs(a){(a=kt.ensureTypedArg(a,kt.types.OBJECT,{})).texture=kt.ensureTypedArg(a.texture,kt.types.OBJECT,{}),this.uuid=l.Math.generateUUID(),this.fixedTimeStep=kt.ensureTypedArg(a.fixedTimeStep,kt.types.NUMBER,.016),this.texture=kt.ensureInstanceOf(a.texture.value,l.Texture,null),this.textureFrames=kt.ensureInstanceOf(a.texture.frames,l.Vector2,new l.Vector2(1,1)),this.textureFrameCount=kt.ensureTypedArg(a.texture.frameCount,kt.types.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=kt.ensureTypedArg(a.texture.loop,kt.types.NUMBER,1),this.textureFrames.max(new l.Vector2(1,1)),this.hasPerspective=kt.ensureTypedArg(a.hasPerspective,kt.types.BOOLEAN,!0),this.colorize=kt.ensureTypedArg(a.colorize,kt.types.BOOLEAN,!0),this.maxParticleCount=kt.ensureTypedArg(a.maxParticleCount,kt.types.NUMBER,null),this.blending=kt.ensureTypedArg(a.blending,kt.types.NUMBER,l.AdditiveBlending),this.transparent=kt.ensureTypedArg(a.transparent,kt.types.BOOLEAN,!0),this.alphaTest=parseFloat(kt.ensureTypedArg(a.alphaTest,kt.types.NUMBER,0)),this.depthWrite=kt.ensureTypedArg(a.depthWrite,kt.types.BOOLEAN,!1),this.depthTest=kt.ensureTypedArg(a.depthTest,kt.types.BOOLEAN,!0),this.fog=kt.ensureTypedArg(a.fog,kt.types.BOOLEAN,!0),this.scale=kt.ensureTypedArg(a.scale,kt.types.NUMBER,300),this.emitters=[],this.emitterIDs=[],this.pool=[],this.poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={textureSampler:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new l.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:ko.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1},this.attributes={position:new Lo("v3",!0),acceleration:new Lo("v4",!0),velocity:new Lo("v3",!0),rotation:new Lo("v4",!0),rotationCenter:new Lo("v3",!0),params:new Lo("v4",!0),size:new Lo("v4",!0),angle:new Lo("v4",!0),color:new Lo("v4",!0),opacity:new Lo("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Pu.vertex,fragmentShader:Pu.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new l.BufferGeometry,this.mesh=new l.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("nunuStudio: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")}function ko(a,r){this.group=new Vs(void 0!==a?a:ko.defaultGroup),this.emitter=new ji(void 0!==r?r:ko.defaultEmitter),this.group.addEmitter(this.emitter),l.Points.call(this,this.group.geometry,this.group.material),this.type="ParticleEmiter",this.name="particle",this.frustumCulled=!1,this.dynamicEmitter=!1,this.clock=new l.Clock,this.temp=new l.Vector4;var h=this;Object.defineProperties(this,{texture:{get:function(){return h.group.texture},set:function(p){h.group.texture=p}}})}function oo(){l.Object3D.call(this),L.call(this)}function Da(a){if(this.backgroundColor=null,this.backend=Da.WEBGL2,this.autoClear=!1,this.autoClearColor=!1,this.autoClearDepth=!1,this.autoClearStencil=!1,this.antialiasing=!0,this.shadows=!0,this.stencil=!0,this.shadowsType=l.PCFSoftShadowMap,this.shadowsAutoUpdate=!0,this.toneMapping=l.NoToneMapping,this.toneMappingExposure=1,this.sortObjects=!0,this.gammaFactor=2,this.precision="highp",this.alpha=!0,this.premultipliedAlpha=!0,this.preserveDrawingBuffer=!1,this.powerPreference="high-performance",this.logarithmicDepthBuffer=!1,this.physicallyCorrectLights=!1,this.checkShaderErrors=!0,this.maxMorphTargets=8,this.maxMorphNormals=4,void 0!==a)for(var r in this)void 0!==a[r]&&(this[r]=a[r])}function ip(){this.desktop={fullscreen:!1,frame:!0,resizable:!0}}ji.constructor=ji,ji.prototype._createGetterSetters=function(a,r){var h=this;for(var p in a)if(a.hasOwnProperty(p)){var y=p.replace("_","");Object.defineProperty(a,y,{get:function(b){return function(){return this[b]}}(p),set:function(b){return function(R){var O=h.updateMap[r],T=this[b],U=ko.valueOverLifetimeLength;"_rotationCenter"===b?(h.updateFlags.rotationCenter=!0,h.updateCounts.rotationCenter=0):"_randomise"===b?h.resetFlags[O]=R:(h.updateFlags[O]=!0,h.updateCounts[O]=0),h.group._updateDefines(),this[b]=R,Array.isArray(T)&&kt.ensureValueOverLifetimeCompliance(h[r],U,U)}}(p)})}},ji.prototype._setBufferUpdateRanges=function(a){this.attributeKeys=a,this.attributeCount=a.length;for(var r=this.attributeCount-1;r>=0;--r)this.bufferUpdateRanges[a[r]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},ji.prototype._calculatePPSValue=function(a){var r=this.particleCount;this.particlesPerSecond=this.duration?r/(a<this.duration?a:this.duration):r/a},ji.prototype._setAttributeOffset=function(a){this.attributeOffset=a,this.activationIndex=a,this.activationEnd=a+this.particleCount},ji.prototype._assignValue=function(a,r){switch(a){case"position":this._assignPositionValue(r);break;case"velocity":case"acceleration":this._assignForceValue(r,a);break;case"size":case"opacity":this._assignAbsLifetimeValue(r,a);break;case"angle":this._assignAngleValue(r);break;case"params":this._assignParamsValue(r);break;case"rotation":this._assignRotationValue(r);break;case"color":this._assignColorValue(r)}},ji.prototype._assignPositionValue=function(a){var r=this.position,h=this.attributes.position,p=r._value,y=r._spread;switch(r._distribution){case Fp.BOX:kt.randomVector3(h,a,p,y,r._spreadClamp);break;case Fp.SPHERE:kt.randomVector3OnSphere(h,a,p,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x,r._distributionClamp||this.particleCount);break;case Fp.DISC:kt.randomVector3OnDisc(h,a,p,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x)}},ji.prototype._assignForceValue=function(a,r){var h,p,R,O=this[r],T=O._value,U=O._spread;switch(O._distribution){case Fp.BOX:kt.randomVector3(this.attributes[r],a,T,U);break;case Fp.SPHERE:p=(h=this.attributes.position.typedArray.array)[R=3*a],kt.randomDirectionVector3OnSphere(this.attributes[r],a,p,h[R+1],h[R+2],this.position._value,O._value.x,O._spread.x);break;case Fp.DISC:p=(h=this.attributes.position.typedArray.array)[R=3*a],kt.randomDirectionVector3OnDisc(this.attributes[r],a,p,h[R+1],h[R+2],this.position._value,O._value.x,O._spread.x)}if("acceleration"===r){var ee=kt.clamp(kt.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*a+3]=ee}},ji.prototype._assignAbsLifetimeValue=function(a,r){var h,p=this.attributes[r].typedArray,y=this[r];kt.arrayValuesAreEqual(y._value)&&kt.arrayValuesAreEqual(y._spread)?(h=Math.abs(kt.randomFloat(y._value[0],y._spread[0])),p.setVec4Components(a,h,h,h,h)):p.setVec4Components(a,Math.abs(kt.randomFloat(y._value[0],y._spread[0])),Math.abs(kt.randomFloat(y._value[1],y._spread[1])),Math.abs(kt.randomFloat(y._value[2],y._spread[2])),Math.abs(kt.randomFloat(y._value[3],y._spread[3])))},ji.prototype._assignAngleValue=function(a){var r,h=this.attributes.angle.typedArray,p=this.angle;kt.arrayValuesAreEqual(p._value)&&kt.arrayValuesAreEqual(p._spread)?(r=kt.randomFloat(p._value[0],p._spread[0]),h.setVec4Components(a,r,r,r,r)):h.setVec4Components(a,kt.randomFloat(p._value[0],p._spread[0]),kt.randomFloat(p._value[1],p._spread[1]),kt.randomFloat(p._value[2],p._spread[2]),kt.randomFloat(p._value[3],p._spread[3]))},ji.prototype._assignParamsValue=function(a){this.attributes.params.typedArray.setVec4Components(a,this.isStatic?1:0,0,Math.abs(kt.randomFloat(this.maxAge._value,this.maxAge._spread)),kt.randomFloat(this.wiggle._value,this.wiggle._spread))},ji.prototype._assignRotationValue=function(a){this.attributes.rotation.typedArray.setVec3Components(a,kt.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),kt.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(a,this.rotation._center)},ji.prototype._assignColorValue=function(a){kt.randomColorAsHex(this.attributes.color,a,this.color._value,this.color._spread)},ji.prototype._resetParticle=function(a){for(var r,h,p=this.resetFlags,y=this.updateFlags,b=this.updateCounts,R=this.attributeKeys,O=this.attributeCount-1;O>=0;--O)h=y[r=R[O]],!0!==p[r]&&!0!==h||(this._assignValue(r,a),this._updateAttributeUpdateRange(r,a),!0===h&&b[r]===this.particleCount?(y[r]=!1,b[r]=0):!0===h&&++b[r])},ji.prototype._updateAttributeUpdateRange=function(a,r){var h=this.bufferUpdateRanges[a];h.min=Math.min(r,h.min),h.max=Math.max(r,h.max)},ji.prototype._resetBufferRanges=function(){for(var a=this.bufferUpdateRanges,r=this.bufferUpdateKeys,h=this.bufferUpdateCount-1;h>=0;--h){var p=r[h];a[p].min=Number.POSITIVE_INFINITY,a[p].max=Number.NEGATIVE_INFINITY}},ji.prototype._onRemove=function(){this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},ji.prototype._decrementParticleCount=function(){--this.activeParticleCount},ji.prototype._incrementParticleCount=function(){++this.activeParticleCount},ji.prototype._checkParticleAges=function(a,r,h,p){for(var y,b,R,O,T=r-1;T>=a;--T)0!==(O=h[y=4*T])&&(R=h[y+1],b=h[y+2],1===this.direction?(R+=p)>=b&&(R=0,O=0,this._decrementParticleCount()):(R-=p)<=0&&(R=b,O=0,this._decrementParticleCount()),h[y]=O,h[y+1]=R,this._updateAttributeUpdateRange("params",T))},ji.prototype._activateParticles=function(a,r,h,p){for(var y,b,R=this.direction,O=a;O<r;++O)0!==h[y=4*O]&&1!==this.particleCount||(this._incrementParticleCount(),h[y]=1,this._resetParticle(O),b=p*(O-a),h[y+1]=-1===R?h[y+2]-b:b,this._updateAttributeUpdateRange("params",O))},ji.prototype.tick=function(a){if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var r=this.attributeOffset,h=r+this.particleCount,p=this.paramsArray,y=this.particlesPerSecond*this.activeMultiplier*a,b=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(r,h,p,a),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var R=1===this.particleCount?b:0|b,O=Math.min(R+y,this.activationEnd),T=O-this.activationIndex|0;this._activateParticles(R,O,p,T>0?a/T:0),this.activationIndex+=y,this.activationIndex>h&&(this.activationIndex=r),this.age+=a}else this.age=0}},ji.prototype.reset=function(a){if(this.age=0,this.alive=!1,!0===a){for(var r,h=this.attributeOffset,y=this.paramsArray,b=this.attributes.params.bufferAttribute,R=h+this.particleCount-1;R>=h;--R)y[r=4*R]=0,y[r+1]=0;b.updateRange.offset=0,b.updateRange.count=-1,b.needsUpdate=!0}return this},ji.prototype.enable=function(){return this.alive=!0,this},ji.prototype.disable=function(){return this.alive=!1,this},ji.prototype.remove=function(){return null!==this.group?this.group.removeEmitter(this):console.error("nunuStudio: ParticleEmitterControl does not belong to a group, cannot remove."),this},ji.prototype.toJSON=function(a){var r={};r.uuid=this.uuid,r.type=this.type,r.direction=this.direction,r.particleCount=this.particleCount,r.duration=this.duration,r.isStatic=this.isStatic,r.maxAge={},r.maxAge.value=this.maxAge.value,r.maxAge.spread=this.maxAge.spread,r.position={},r.position.value=this.position.value.toArray(),r.position.spread=this.position.spread.toArray(),r.position.radius=this.position.radius,r.position.radiusScale=this.position.radiusScale.toArray(),r.velocity={},r.velocity.value=this.velocity.value.toArray(),r.velocity.spread=this.velocity.spread.toArray(),r.acceleration={},r.acceleration.value=this.acceleration.value.toArray(),r.acceleration.spread=this.acceleration.spread.toArray(),r.wiggle={},r.wiggle.value=this.wiggle.value,r.wiggle.spread=this.wiggle.spread,r.opacity={},r.opacity.value=this.opacity.value.slice(0),r.opacity.spread=this.opacity.spread,r.size={},r.size.value=this.size.value.slice(0),r.size.spread=this.size.spread,r.angle={},r.angle.value=this.angle.value.slice(0),r.angle.spread=this.angle.spread,r.color={},r.color.value=[];for(var h=0;h<this.color.value.length;h++)r.color.value.push(this.color.value[h].getHex());for(r.color.spread=[],h=0;h<this.color.spread.length;h++)r.color.spread.push(this.color.spread[h].toArray());return r},Vs.constructor=Vs,Vs.prototype._updateDefines=function(){for(var a,r=this.emitters,h=this.defines,p=r.length-1;p>=0;--p)a=r[p],h.SHOULD_CALCULATE_SPRITE||(h.SHOULD_ROTATE_TEXTURE=h.SHOULD_ROTATE_TEXTURE||Boolean(Math.max(Math.max.apply(null,a.angle.value),Math.max.apply(null,a.angle.spread)))),h.SHOULD_ROTATE_PARTICLES=h.SHOULD_ROTATE_PARTICLES||Boolean(Math.max(a.rotation.angle,a.rotation.angleSpread)),h.SHOULD_WIGGLE_PARTICLES=h.SHOULD_WIGGLE_PARTICLES||Boolean(Math.max(a.wiggle.value,a.wiggle.spread));this.material.needsUpdate=!0},Vs.prototype._applyAttributesToGeometry=function(){var a,r,h=this.attributes,p=this.geometry,y=p.attributes;for(var b in h)h.hasOwnProperty(b)&&(a=h[b],(r=y[b])?r.array=a.typedArray.array:p.setAttribute(b,a.bufferAttribute),a.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},Vs.prototype.addEmitter=function(a){if(a instanceof ji!=0)if(this.emitterIDs.indexOf(a.uuid)>-1)console.error("nunuStudio: ParticleEmitterControl already exists in this group.");else{if(null===a.group){var r=this.attributes,h=this.particleCount,p=h+a.particleCount;for(var y in this.particleCount=p,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("nunuStudio: ParticleGroup maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),a._calculatePPSValue(a.maxAge._value+a.maxAge._spread),a._setBufferUpdateRanges(this.attributeKeys),a._setAttributeOffset(h),a.group=this,a.attributes=this.attributes,r)r.hasOwnProperty(y)&&r[y]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var b=h;b<p;++b)a._assignPositionValue(b),a._assignForceValue(b,"velocity"),a._assignForceValue(b,"acceleration"),a._assignAbsLifetimeValue(b,"opacity"),a._assignAbsLifetimeValue(b,"size"),a._assignAngleValue(b),a._assignRotationValue(b),a._assignParamsValue(b),a._assignColorValue(b);return this._applyAttributesToGeometry(),this.emitters.push(a),this.emitterIDs.push(a.uuid),this._updateDefines(a),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("nunuStudio: ParticleEmitterControl already belongs to another group.")}else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl.",a)},Vs.prototype.removeEmitter=function(a){var r=this.emitterIDs.indexOf(a.uuid);if(a instanceof ji!=0)if(-1!==r){for(var h=a.attributeOffset,p=h+a.particleCount,y=this.attributes.params.typedArray,b=h;b<p;++b)y.array[4*b]=0,y.array[4*b+1]=0;for(var R in this.emitters.splice(r,1),this.emitterIDs.splice(r,1),this.attributes)this.attributes.hasOwnProperty(R)&&this.attributes[R].splice(h,p);this.particleCount-=a.particleCount,a._onRemove(),this._attributesNeedRefresh=!0}else console.error("nunuStudio: ParticleEmitterControl does not exist in this group. Will not remove.");else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl. Was provided with:",a)},Vs.prototype.getFromPool=function(){var a=this.pool,r=this._createNewWhenPoolEmpty;if(a.length)return a.pop();if(r){var h=new ji(this.poolCreationSettings);return this.addEmitter(h),h}return null},Vs.prototype.releaseIntoPool=function(a){if(a instanceof ji!=0)return a.reset(),this.pool.unshift(a),this;console.error("nunuStudio: Argument is not instanceof ParticleEmitterControl:",a)},Vs.prototype.getPool=function(){return this.pool},Vs.prototype.addPool=function(a,r,h){var p;this.poolCreationSettings=r,this._createNewWhenPoolEmpty=Boolean(h);for(var y=0;y<a;++y)p=Array.isArray(r)?new ji(r[y]):new ji(r),this.addEmitter(p),this.releaseIntoPool(p);return this},Vs.prototype._triggerSingleEmitter=function(a){var r=this.getFromPool(),h=this;if(null!==r)return a instanceof l.Vector3&&(r.position.value.copy(a),r.position.value=r.position.value),r.enable(),setTimeout(function(){r.disable(),h.releaseIntoPool(r)},1e3*Math.max(r.duration,r.maxAge.value+r.maxAge.spread)),this;console.log("nunuStudio: ParticleGroup pool ran out.")},Vs.prototype.triggerEmitter=function(a,r){if("number"==typeof a&&a>1)for(var h=0;h<a;++h)this._triggerSingleEmitter(r);else this._triggerSingleEmitter(r);return this},Vs.prototype._updateUniforms=function(a){this.uniforms.runTime.value+=a,this.uniforms.deltaTime.value=a},Vs.prototype._resetBufferRanges=function(){for(var a=this.attributeKeys,r=this.attributeCount-1;r>=0;--r)this.attributes[a[r]].resetUpdateRange()},Vs.prototype._updateBuffers=function(a){for(var r,h,p,y=this.attributeKeys,b=this.attributes,R=a.bufferUpdateRanges,O=this.attributeCount-1;O>=0;--O)h=R[r=y[O]],(p=b[r]).setUpdateRange(h.min,h.max),p.flagUpdate()},Vs.prototype.tick=function(a){var r=this.emitters,h=r.length,p=a||this.fixedTimeStep,y=this.attributeKeys,b=this.attributes;if(this._updateUniforms(p),this._resetBufferRanges(),0!==h||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var R,O=0;O<h;++O)(R=r[O]).tick(p),this._updateBuffers(R);if(!0===this._attributesNeedDynamicReset){for(O=this.attributeCount-1;O>=0;--O)b[y[O]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(O=this.attributeCount-1;O>=0;--O)b[y[O]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},Vs.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this},Vs.prototype.toJSON=function(a){var r={texture:{}};return r.texture.value=this.texture.uuid,r.texture.frames=this.textureFrames.toArray(),r.texture.frameCount=this.textureFrameCount,r.texture.loop=this.textureLoop,r.fixedTimeStep=this.fixedTimeStep,r.hasPerspective=this.hasPerspective,r.colorize=this.colorize,r.maxParticleCount=this.maxParticleCount,r.transparent=this.transparent,r.blending=this.blending,r.alphaTest=this.alphaTest,r.depthWrite=this.depthWrite,r.depthTest=this.depthTest,r.fog=this.fog,r.scale=this.scale,r},ko.valueOverLifetimeLength=4,ko.prototype=Object.create(l.Points.prototype),ko.defaultEmitter={particleCount:200,velocity:{value:new l.Vector3(0,0,0),spread:new l.Vector3(3,3,3)},acceleration:{value:new l.Vector3(0,0,0),spread:new l.Vector3(0,0,0)}},ko.defaultGroup={texture:{value:null},maxParticleCount:200,blending:l.AdditiveBlending,fog:!1,depthWrite:!1,depthTest:!0,transparent:!0,hasPerspective:!0},ko.prototype.reload=function(){this.dispose();var a=this.children;this.children=[];var r=(new Co).parse(this.toJSON());this.children=a,this.group=r.group,this.emitter=r.emitter,this.geometry=this.group.geometry,this.material=this.group.material},ko.prototype.updateMatrix=function(){this.dynamicEmitter?(this.matrix.makeRotationFromQuaternion(this.quaternion),this.matrix.scale(this.scale)):this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},ko.prototype.onBeforeRender=function(a,r,h,p){this.group.uniforms.scale.value=a.getCurrentViewport(this.temp).w,this.group.tick(this.clock.getDelta()),!0===this.dynamicEmitter&&(this.emitter.position.value=this.position)},ko.prototype.dispose=function(){this.group.dispose(),l.Object3D.prototype.dispose.call(this)},ko.prototype.toJSON=function(a){var r=this.material,h=this.geometry;this.material=void 0,this.geometry=void 0;var p=this.group.texture,y=l.Object3D.prototype.toJSON.call(this,a,function(b,R){p=p.toJSON(b)});return this.material=r,this.geometry=h,y.object.group=this.group.toJSON(a),y.object.emitter=this.emitter.toJSON(a),y},ko.fromJSON=function(a,r){function h(R){return Array.isArray(R)?(new l.Vector3).fromArray(R):new l.Vector3(R.x,R.y,R.z)}if(void 0!==a.group){var p=a.group;p.texture.value=r.getTexture(p.texture.value),p.texture.frames=(new l.Vector2).fromArray(p.texture.frames||[1,1])}if(void 0!==a.emitter){var y=a.emitter;y.position.value=h(y.position.value),y.position.spread=h(y.position.spread),y.velocity.value=h(y.velocity.value),y.velocity.spread=h(y.velocity.spread),y.acceleration.value=h(y.acceleration.value),y.acceleration.spread=h(y.acceleration.spread);for(var b=0;b<y.color.value.length;b++)y.color.value[b]=new l.Color(y.color.value[b]),y.color.spread[b]=h(y.color.spread[b])}return new ko(a.group,a.emitter)},oo.prototype=Object.create(l.Object3D.prototype),Object.assign(oo.prototype,L.prototype),oo.prototype.dispose=function(){for(var a=0;a<L.libraries.length;a++){var r=L.libraries[a];for(var h in this[r])this[r][h].dispose instanceof Function&&this[r][h].dispose()}},oo.prototype.removeGeometry=function(a,r){this.traverse(function(h){void 0!==h.geometry&&h.geometry.uuid===a.uuid&&(h.geometry=r)}),delete this.geometries[a.uuid]},oo.prototype.getResourceByName=function(a){for(var r in this.resources)if(this.resources[r].name===a)return this.resources[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.addResource=function(a){a instanceof wi&&(this.resources[a.uuid]=a)},oo.prototype.removeResource=function(a){delete this.resources[a.uuid]},oo.prototype.getImageByName=function(a){for(var r in this.images)if(this.images[r].name===a)return this.images[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.removeImage=function(a){a instanceof ms&&delete this.images[a.uuid]},oo.prototype.getVideoByName=function(a){for(var r in this.videos)if(this.videos[r].name===a)return this.videos[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.removeVideo=function(a){a instanceof Dl&&delete this.videos[a.uuid]},oo.prototype.getMaterialByName=function(a){for(var r in this.materials)if(this.materials[r].name===a)return this.materials[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.addMaterial=function(a){a instanceof l.Material&&(this.materials[a.uuid]=a)},oo.prototype.removeMaterial=function(a,r,h){void 0===r&&(r=new l.MeshBasicMaterial),void 0===h&&(h=new l.SpriteMaterial),a instanceof l.Material&&(delete this.materials[a.uuid],this.traverse(function(p){void 0!==p.material&&p.material.uuid===a.uuid&&(p.material=p instanceof l.Sprite?h:r)}))},oo.prototype.getTextureByName=function(a){for(var r in this.textures)if(this.textures[r].name===a)return this.textures[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.addTexture=function(a){material instanceof l.Texture&&(this.textures[a.uuid]=a)},oo.prototype.removeTexture=function(a,r){void 0===r&&(r=new l.Texture),a instanceof l.Texture&&(delete this.textures[a.uuid],this.traverse(function(h){if(void 0!==h.material){var p=h.material;p.map&&p.map.uuid===a.uuid&&(p.map=r,p.needsUpdate=!0),p.bumpMap&&p.bumpMap.uuid===a.uuid&&(p.bumpMap=r,p.needsUpdate=!0),p.normalMap&&p.normalMap.uuid===a.uuid&&(p.normalMap=r,p.needsUpdate=!0),p.displacementMap&&p.displacementMap.uuid===a.uuid&&(p.displacementMap=r,p.needsUpdate=!0),p.specularMap&&p.specularMap.uuid===a.uuid&&(p.specularMap=r,p.needsUpdate=!0),p.emissiveMap&&p.emissiveMap.uuid===a.uuid&&(p.emissiveMap=r,p.needsUpdate=!0),p.alphaMap&&p.alphaMap.uuid===a.uuid&&(p.alphaMap=r,p.needsUpdate=!0),p.roughnessMap&&p.roughnessMap.uuid===a.uuid&&(p.roughnessMap=r,p.needsUpdate=!0),p.metalnessMap&&p.metalnessMap.uuid===a.uuid&&(p.metalnessMap=r,p.needsUpdate=!0),p.envMap&&p.envMap.uuid===a.uuid&&(p.envMap=null,p.needsUpdate=!0)}else h instanceof ko&&h.group.texture.uuid===a.uuid&&(h.group.texture=r)}))},oo.prototype.getFontByName=function(a){for(var r in this.fonts)if(this.fonts[r].name===a)return this.fonts[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.addFont=function(a){a instanceof Ye&&(this.fonts[a.uuid]=a)},oo.prototype.removeFont=function(a,r){void 0===r&&(r=new Ye),a instanceof Ye&&(delete this.fonts[a.uuid],this.traverse(function(h){void 0!==h.font&&h.font.uuid===a.uuid&&h.setFont(r)}))},oo.prototype.getAudioByName=function(a){for(var r in this.audio)if(this.audio[r].name===a)return this.audio[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},oo.prototype.addAudio=function(a){a instanceof Ot&&(this.audio[a.uuid]=a)},oo.prototype.removeAudio=function(a,r){void 0===r&&(r=new Ot),a instanceof Ot&&(delete this.audio[a.uuid],this.traverse(function(h){void 0!==h.audio&&h.audio.uuid===a.uuid&&h.setAudio(r)}))},Da.WEBGL=1,Da.WEBGL2=2,Da.prototype.createRenderer=function(a){var r=null;if(this.backend===Da.WEBGL2)try{r=a.getContext("webgl2",{xrCompatible:!0})}catch(y){console.warn("nunuStudio: Failed to create WebGL2 context",y)}var p=new l.WebGLRenderer({canvas:a,context:r,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialiasing,stencil:this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer});return this.apply(p),null!==this.backgroundColor&&(a.style.backgroundColor=this.backgroundColor),p},Da.prototype.apply=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearDepth=this.autoClearDepth,a.autoClearStencil=this.autoClearStencil,a.shadowMap.enabled=this.shadows,a.shadowMap.type=this.shadowsType,a.shadowMap.autoUpdate=this.shadowsAutoUpdate,a.shadowMap.needsUpdate=!0,a.toneMapping=this.toneMapping,a.toneMappingExposure=this.toneMappingExposure,a.debug.checkShaderErrors=this.checkShaderErrors,a.sortObjects=this.sortObjects,a.gammaFactor=this.gammaFactor,a.physicallyCorrectLights=this.physicallyCorrectLights,a.maxMorphTargets=this.maxMorphTargets,a.maxMorphNormals=this.maxMorphNormals},Da.prototype.toJSON=function(){return{backgroundColor:this.backgroundColor,backend:this.backend,autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,antialiasing:this.antialiasing,shadows:this.shadows,stencil:this.stencil,shadowsType:this.shadowsType,shadowsAutoUpdate:this.shadowsAutoUpdate,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure,sortObjects:this.sortObjects,checkShaderErrors:this.checkShaderErrors,gammaFactor:this.gammaFactor,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer,physicallyCorrectLights:this.physicallyCorrectLights,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals}},Da.prototype.fromJSON=function(a){this.backgroundColor=a.backgroundColor,this.backend=a.backend,this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearDepth=a.autoClearDepth,this.autoClearStencil=a.autoClearStencil,this.antialiasing=a.antialiasing,this.shadows=a.shadows,this.stencil=a.stencil,this.shadowsType=a.shadowsType,this.shadowsAutoUpdate=a.shadowsAutoUpdate,this.toneMapping=a.toneMapping,this.toneMappingExposure=a.toneMappingExposure,this.sortObjects=a.sortObjects,this.checkShaderErrors=a.checkShaderErrors,this.gammaFactor=a.gammaFactor,this.precision=a.precision,this.alpha=a.alpha,this.premultipliedAlpha=a.premultipliedAlpha,this.preserveDrawingBuffer=a.preserveDrawingBuffer,this.powerPreference=a.powerPreference,this.logarithmicDepthBuffer=a.logarithmicDepthBuffer,this.physicallyCorrectLights=a.physicallyCorrectLights,this.maxMorphTargets=a.maxMorphTargets,this.maxMorphNormals=a.maxMorphNormals};var Pf=__webpack_require__(872);function fr(a,r){this.element=document.createElement(void 0!==r?r:"div"),this.element.style.position="absolute",this.element.style.overflow="hidden",this.event=new hn,this.parent=null,void 0!==a&&this.attachTo(a),this.visible=!0,this.size=new l.Vector2(0,0),this.position=new l.Vector2(0,0),this._mode=fr.TOP_LEFT}function Qo(a){this.program=null,this.renderer=null,this.running=!1,this.canvasFitWindow=!1,this.canvas=a,this.events=new hn,void 0===a&&(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvasFitWindow=!0,document.body.appendChild(this.canvas))}function gi(){}function Wo(){}function hi(){oo.call(this),this.type="Program",this.matrixAutoUpdate=!1,this.app=null,this.name="program",this.description="",this.author="",this.version="0.0.0",this.lockPointer=!1,this.handlePixelRatio=!0,this.ar=!0,this.vr=!0,this.vrScale=1,this.rendererConfig=new Da,this.targetConfig=new ip,this.defaultScene=null,this.defaultCamera=null,this.scene=null,this.keyboard=null,this.mouse=null,this.renderer=null,this.canvas=null,this.division=null,this.manager=new hn,this.clock=new l.Clock,this.xrEnabled=!1,this.xrMode=hi.XR_NONE}function Fo(){l.Scene.call(this),this.name="scene",this.matrixAutoUpdate=!1,this.usePhysics=!0,this.world=new Un,this.world.defaultContactMaterial.contactEquationStiffness=1e9,this.world.defaultContactMaterial.contactEquationRelaxation=4,this.world.quatNormalizeSkip=0,this.world.quatNormalizeFast=!1,this.world.gravity.set(0,-9.8,0),this.world.broadphase=new vr,this.world.solver=new As(new yu),this.world.solver.tolerance=.05,this.world.solver.iterations=7,this.background=null,this.alpha=1,this.cameras=[],this.defaultCamera=null,this.delta=0,this.raycaster=new l.Raycaster,this.useOctree=!1,this.octree=null,this.octreeUpdateScheduled=!1,this.octreeMatches=[],this.program=null,this.canvas=null,this.mouse=new l.Vector2(0,0)}function pc(a){l.AnimationMixer.call(this,a),this.playing=!1}fr.prototype.constructor=fr,fr.prototype.isComponent=!0,fr.TOP_LEFT=0,fr.TOP_RIGHT=1,fr.BOTTOM_LEFT=2,fr.BOTTOM_RIGHT=3,fr.preventDefault=function(a){a.preventDefault()},fr.prototype.addEvent=function(a,r){this.event.addAndCreate(this.element,a,r)},fr.prototype.removeEvent=function(a){this.event.remove(this.element,a)},fr.prototype.replaceEvent=function(a,r){this.event.remove(this.element,a),this.event.addAndCreate(this.element,a,r)},fr.prototype.addClass=function(a){this.element.classList.add(a)},fr.prototype.removeClass=function(a){this.element.classList.contains(a)&&this.element.classList.remove(a)},fr.prototype.setStyle=function(a,r){this.element.style[a]=r},fr.prototype.setStyles=function(a){for(var r in a)this.element.style[r]=a[r]},fr.prototype.preventDragEvents=function(){this.element.ondrop=fr.preventDefault,this.element.ondragover=fr.preventDefault},fr.prototype.setAltText=function(a){var r=document.createElement("div");r.style.position="absolute",r.style.display="none",r.style.alignItems="center",r.style.zIndex="10000",r.style.border="3px solid",r.style.borderRadius="5px",r.style.color="var(--color-light)",r.style.backgroundColor="var(--bar-color)",r.style.borderColor="var(--bar-color)",r.style.height="fit-content",document.body.appendChild(r);var h=document.createTextNode(a);r.appendChild(h);var p=this.destroy;return this.destroy=function(){p.call(this),document.body.contains(r)&&document.body.removeChild(r)},this.element.style.pointerEvents="auto",this.addEvent("mousemove",function(y){r.style.display="flex",r.style.left=y.clientX+8+"px",r.style.top=y.clientY-20+"px"}),this.addEvent("mouseout",function(){r.style.display="none"}),r},fr.prototype.setOnClick=function(a){this.addEvent("click",a)},fr.prototype.removeAllChildren=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)},fr.prototype.attachTo=function(a){this.parent!==a&&void 0!==a&&(null!==this.parent&&fr.prototype.destroy.call(this),this.parent=a,!0===a.isComponent?a.element.appendChild(this.element):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.appendChild(this.element)))},fr.prototype.watchPointer=function(){var a=this;this.pointerInside=!1,this.element.addEventListener("mouseenter",function(){a.pointerInside=!0}),this.element.addEventListener("mouseleave",function(){a.pointerInside=!1})},fr.prototype.destroy=function(){null!==this.parent&&(!0===this.parent.isComponent?this.parent.element.contains(this.element)&&(this.parent.element.removeChild(this.element),this.parent=null):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.contains(this.element)&&(this.parent.removeChild(this.element),this.parent=null)))},fr.prototype.setMode=function(a){this._mode=a,this.element.style.bottom=null,this.element.style.top=null,this.element.style.right=null,this.element.style.left=null},fr.prototype.center=function(){this.position.set((this.parent.size.x-this.size.x)/2,(this.parent.size.y-this.size.y)/2)},fr.prototype.setVisibility=function(a){this.visible=a,this.updateVisibility()},fr.prototype.updateVisibility=function(){this.element.style.display=this.visible?"block":"none"},fr.prototype.updatePosition=function(a){void 0!==a&&(this._mode=a),this._mode===fr.TOP_LEFT||this._mode===fr.TOP_RIGHT?this.element.style.top=this.position.y+"px":this.element.style.bottom=this.position.y+"px",this._mode===fr.TOP_LEFT||this._mode===fr.BOTTOM_LEFT?this.element.style.left=this.position.x+"px":this.element.style.right=this.position.x+"px"},fr.prototype.updateSize=function(){this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px"},fr.prototype.updateInterface=function(){this.updateVisibility(),this.visible&&(this.updateSize(),this.updatePosition())},Qo.loadApp=function(a,r){"string"==typeof r&&(r=document.getElementById(r));var h=new Qo(r);h.loadRunProgram(a),window.addEventListener("resize",function(){to.isFullscreen()?(h.canvas.width=window.innerWidth,h.canvas.height=window.innerHeight):h.canvas.parentElement&&(h.canvas.width=h.canvas.parentElement.offsetWidth,h.canvas.height=h.canvas.parentElement.offsetHeight),h.resize()})},Qo.prototype.run=function(){if(null!==this.program){if(this.renderer=this.program.rendererConfig.createRenderer(this.canvas),this.program.app=this,this.program.defaultCamera=new ke(60,1,.1,1e5),this.program.defaultCamera.position.set(0,5,-5),this.program.setRenderer(this.renderer),this.program.initialize(),this.program.lockPointer){var r=this.mouse;this.events.add(this.canvas,"click",function(){r.setLock(!0)})}var h=this;this.events.add(window,"beforeunload",function(){h.exit()}),this.events.create(),this.resize(),this.resume()}else console.warn("nunuStudio: no program is loaded [app.loadPogram(fname)]")},Qo.prototype.loadRunProgram=function(a,r,h){this.loadProgramAsync(a,function(p){p.run(),void 0!==r&&r(p)},h)},Qo.prototype.loadProgram=function(a){if(a.endsWith(".isp")){var r=new Co,h=Rn.readFile(a);this.program=r.parse(JSON.parse(h))}else if(a.endsWith(".nsp")){r=new Co,h=Rn.readFileArrayBuffer(a);var p=new Pf.fG}this.program=r.parse(p.decode(h))},Qo.prototype.loadProgramAsync=function(a,r,h){var p=this;a.endsWith(".isp")?Rn.readFile(a,!1,function(y){var b=new Co;p.program=b.parse(JSON.parse(y)),void 0!==r&&r(p)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)}):a.endsWith(".nsp")&&Rn.readFileArrayBuffer(a,!1,function(y){var b=new Co,R=new Pf.fG;p.program=b.parse(R.decode(y)),void 0!==r&&r(p)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)})},Qo.prototype.update=function(){this.program.update(),this.program.render(this.renderer)},Qo.prototype.exit=function(){this.events.destroy(),null!==this.program&&(this.program.dispose(),this.program=null),null!==this.renderer&&(this.renderer.dispose(),this.renderer=null),void 0!==this.onExit&&this.onExit()},Qo.prototype.resume=function(){if(null!==this.program&&!this.running){var a=this;this.renderer.setAnimationLoop(function(){a.update()}),this.running=!0}},Qo.prototype.pause=function(){this.running=!1,this.renderer.setAnimationLoop(null)},Qo.prototype.setCanvas=function(a){this.canvas=a,this.canvasFitWindow=!1},Qo.prototype.resize=function(){if(null!==this.canvas&&null!==this.program&&null!==this.renderer){var a=1,r=1;this.canvasFitWindow?(this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px",a=window.innerWidth,r=window.innerHeight):(a=this.canvas.offsetWidth,r=this.canvas.offsetHeight),this.program.handlePixelRatio&&(a*=window.devicePixelRatio,r*=window.devicePixelRatio),this.renderer.setSize(a,r,!1),this.program.resize(a,r)}},Qo.prototype.sendData=function(a){null!==this.program&&this.program.receiveDataApp(a)},Qo.prototype.setOnDataReceived=function(a){this.onDataReceived=a},Qo.prototype.setOnExit=function(a){this.onExit=a},Qo.prototype.vrAvailable=function(){return null!==this.program&&this.program.vrAvailable()},Qo.prototype.toggleVR=function(){this.vrAvailable()?this.program.xrEnabled?this.program.exitVR():this.program.enterVR():console.warn("nunuStudio: Loaded program is not VR enabled.")},Qo.prototype.arAvailable=function(){return null!==this.program&&this.program.arAvailable()},Qo.prototype.toggleAR=function(){this.arAvailable()?this.program.xrEnabled?this.program.exitAR():this.program.enterAR():console.warn("nunuStudio: Loaded program is not AR enabled.")},Qo.prototype.toggleFullscreen=function(a){var r=to.isFullscreen();void 0===a&&(a=this.canvas),to.setFullscreen(!r,a)},gi.webXRAvailable=!1,gi.webXRSession=null,gi.webVRAvailable=!1,gi.webVRDisplay=null,gi.vrAvailable=function(){return gi.webXRAvailable||gi.webVRAvailable},gi.enterVR=function(a,r){gi.webXRAvailable?gi.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setSession(h),gi.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebXR session.",h)}):gi.webVRAvailable?gi.getWebVRDisplay().then(function(h){displays.length>0&&((gi.webVRDisplay=displays[0]).isPresenting||(a.xr.enabled=!0,a.xr.setDevice(gi.webVRDisplay),gi.webVRDisplay.requestPresent([{source:a.domElement}]),void 0!==r&&r()))}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebVR session.",h)}):console.warn("nunuStudio: VR support is not available.")},gi.exitVR=function(a){gi.webXRAvailable&&null!==gi.webXRSession?(a.xr.enabled=!1,a.xr.setSession(null),gi.webXRSession.end(),gi.webXRSession=null):gi.webVRAvailable&&null!==gi.webVRDisplay&&gi.webVRDisplay.isPresenting&&(a.xr.enabled=!1,a.xr.setDevice(null),gi.webVRDisplay.exitPresent(),gi.webVRDisplay=null)},gi.getWebXRSession=function(){return gi.webXRAvailable?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}):Promise.reject("WebXR support is not available.")},gi.getWebVRDisplay=function(a){return gi.webVRAvailable?navigator.getVRDisplays():Promise.reject("WebVR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported?navigator.xr.isSessionSupported("immersive-vr").then(function(a){gi.webXRAvailable=a}):void 0!==navigator.getVRDisplays&&navigator.getVRDisplays().then(function(a){gi.webVRAvailable=a.length>0}),Wo.OPAQUE="opaque",Wo.ADDITIVE="additive",Wo.ALPHA_BLEND="alpha-blend",Wo.webXRAvailable=!1,Wo.webXRSession=null,Wo.arAvailable=function(){return Wo.webXRAvailable},Wo.enterAR=function(a,r){Wo.webXRAvailable?Wo.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setReferenceSpaceType("local"),a.xr.setSession(h),console.log("nunuStudio: New AR WebXR session created",h),Wo.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start AR WebXR session.",h)}):console.warn("nunuStudio: AR support is not available.")},Wo.exitAR=function(a){Wo.webXRAvailable&&null!==Wo.webXRSession&&(a.xr.enabled=!1,a.xr.setSession(null),Wo.webXRSession.end(),Wo.webXRSession=null)},Wo.getWebXRSession=function(){return Wo.webXRAvailable?navigator.xr.requestSession("immersive-ar",{}):Promise.reject("WebXR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported&&navigator.xr.isSessionSupported("immersive-ar").then(function(a){Wo.webXRAvailable=a}),hi.XR_NONE=0,hi.XR_VR=1,hi.XR_AR=2,(hi.prototype=Object.create(oo.prototype)).initialize=function(){if(null===this.mouse&&(this.mouse=new Zr,this.mouse.setCanvas(this.canvas),this.mouse.create()),null===this.keyboard&&(this.keyboard=new Vn,this.keyboard.create()),this.manager.create(),null!==this.defaultScene){for(var a=0;a<this.children.length;a++)if(this.children[a].uuid===this.defaultScene){this.setScene(this.children[a]);break}}else this.children.length>0&&this.setScene(this.children[0]);this.lockPointer&&null!==this.mouse&&this.mouse.setLock(!0),this.clock.start()},hi.prototype.setMouseKeyboard=function(a,r){this.mouse!==a&&(null!==this.mouse&&this.mouse.dispose(),this.mouse=a),this.keyboard!==r&&(null!==this.keyboard&&this.keyboard.dispose(),this.keyboard=r)},hi.prototype.setRenderer=function(a,r){this.renderer=a,this.renderer.autoClear=!1,this.canvas=a.domElement,this.division=this.canvas.parentElement,r&&this.updateRenderer()},hi.prototype.update=function(){var a=this.clock.getDelta();this.mouse.update(),this.keyboard.update(),this.scene.update(a)},hi.prototype.render=function(a){this.scene.render(a)},hi.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r),this.scene.resize(a,r)},hi.prototype.updateRenderer=function(){null!==this.renderer&&this.rendererConfig.apply(this.renderer)},hi.prototype.arAvailable=function(){return this.ar&&Wo.arAvailable()},hi.prototype.enterAR=function(){if(this.arAvailable()&&!this.xrEnabled){var a=this;Wo.enterAR(this.renderer,function(){a.xrMode=hi.XR_AR,a.xrEnabled=!0})}},hi.prototype.exitAR=function(){this.xrEnabled&&(Wo.exitAR(this.renderer),this.xrMode=hi.XR_NONE,this.xrEnabled=!1)},hi.prototype.vrAvailable=function(){return this.vr&&gi.vrAvailable()},hi.prototype.enterVR=function(){if(this.vrAvailable()&&!this.xrEnabled){var a=this;gi.enterVR(this.renderer,function(){a.xrMode=hi.XR_VR,a.xrEnabled=!0})}},hi.prototype.exitVR=function(){this.vr&&(gi.exitVR(this.renderer),this.xrMode=hi.XR_NONE,this.xrEnabled=!1)},hi.prototype.setScene=function(a){"string"==typeof a&&(a=this.getObjectByName(a)),null!==this.scene&&this.scene.dispose(),this.scene=a,null!==this.scene?(null===this.scene.defaultCamera&&(this.scene.defaultCamera=this.defaultCamera),this.scene.initialize(),null!==this.canvas&&this.scene.resize(this.canvas.width,this.canvas.height)):console.warn("nunuStudio: Program setScene scene is null.")},hi.prototype.remove=function(a){if(a instanceof l.Scene){var r=this.children.indexOf(a);r>-1&&(this.children.splice(r,1),a.parent=null),a===this.scene&&(this.scene.dispose(),this.scene=null),0===this.children.length&&(this.scene=null)}else console.warn("nunuStudio: Trying to remove Object3D from program, only Scene objects allowed.")},hi.prototype.add=function(a){a instanceof l.Scene?(a.parent=this,this.children.push(a)):console.warn("nunuStudio: Trying to add Object3D to program, only Scene objects allowed.")},hi.prototype.clone=function(){return(new Co).parse(this.toJSON())},hi.prototype.setInitialScene=function(a){this.defaultScene=a.uuid},hi.prototype.dispose=function(){null!==this.mouse&&(this.lockPointer&&this.mouse.setLock(!1),this.mouse.dispose()),null!==this.keyboard&&this.keyboard.dispose(),this.manager.destroy(),null!==this.scene?this.scene.dispose():console.warn("nunuStudio: Program dispose() scene is null.",this),oo.prototype.dispose.call(this),l.Object3D.prototype.dispose.call(this)},hi.prototype.receiveDataApp=function(a){var r=!1;this.traverse(function(h){h instanceof Sn&&(h.appData(a),r=!0)}),r||console.warn("nunuStudio: No script with onAppData found",a)},hi.prototype.sendDataApp=function(a){null!==this.app?void 0!==this.app.onDataReceived?this.app.onDataReceived(a):console.warn("nunuStudio: Send app data communication",a):console.warn("nunuStudio: Data sent to app",a)},hi.prototype.toJSON=function(a,r){var h=this,p=l.Object3D.prototype.toJSON.call(this,a,function(y){if(!1!==r)for(var b=0;b<L.libraries.length;b++){var R=h[L.libraries[b]];for(var O in R){var T=R[O];void 0===y[L.libraries[b]][T.uuid]&&(y[L.libraries[b]][T.uuid]=T.toJSON(y))}}});return null!==this.defaultScene&&(p.object.defaultScene=this.defaultScene),p.object.author=this.author,p.object.description=this.description,p.object.version=this.version,p.object.lockPointer=this.lockPointer,p.object.handlePixelRatio=this.handlePixelRatio,p.object.ar=this.ar,p.object.vr=this.vr,p.object.vrScale=this.vrScale,p.object.rendererConfig=this.rendererConfig.toJSON(),p},(Fo.prototype=Object.create(l.Scene.prototype)).initialize=function(){this.program=this.parent,this.canvas=this.parent.canvas,l.Object3D.prototype.initialize.call(this);for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.initialize()})},Fo.prototype.update=function(a){this.mouse.set(this.program.mouse.position.x/this.canvas.width*2-1,-2*this.program.mouse.position.y/this.canvas.height+1),this.cameras.length>0?this.raycaster.setFromCamera(this.mouse,this.cameras[0]):null!==this.defaultCamera&&this.raycaster.setFromCamera(this.mouse,this.defaultCamera),this.usePhysics&&this.world.step(a<.05?a:.05);for(var r=0;r<this.children.length;r++)this.children[r].traverse(function(h){h.update(a)})},Fo.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r);for(var h=0;h<this.cameras.length;h++)this.cameras[h].resize(a,r);for(h=0;h<this.children.length;h++)this.children[h].traverse(function(p){p.resize(a,r)})},Fo.prototype.dispose=function(){for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.dispose()})},Fo.prototype.render=function(a){if(a.setClearColor(this.background,this.alpha),this.cameras.length>0)if(this.program.xrEnabled){if(this.program.xrMode===hi.XR_VR)for(var r=0;r<this.cameras.length;r++)this.cameras[r].render(a,this);else if(this.program.xrMode===hi.XR_AR)for(a.setClearColor(null),r=0;r<this.cameras.length;r++)a.render(this,this.cameras[r])}else{for(a.setScissorTest(!0),r=0;r<this.cameras.length;r++)this.cameras[r].setupRenderer(a),this.cameras[r].render(a,this);a.setScissorTest(!1)}else null!==this.defaultCamera&&(this.program.xrMode===hi.XR_AR?(a.setClearColor(null),a.render(this,this.defaultCamera)):this.defaultCamera.render(a,this))},Fo.prototype.getCamera=function(a,r){if(void 0===r&&(r=this),a===r.uuid)return r;for(var h=r.children,p=0;p<h.length;p++){var y=this.getCamera(a,h[p]);if(null!==y)return y}return null},Fo.prototype.addCamera=function(a){-1===this.cameras.indexOf(a)&&(this.cameras.push(a),this.updateCameraOrder())},Fo.prototype.updateCameraOrder=function(){this.cameras.sort(function(a,r){return a.order>r.order})},Fo.prototype.removeCamera=function(a){var r=this.cameras.indexOf(a);r>-1&&this.cameras.splice(r,1)},Fo.prototype.isCameraActive=function(a){return this.cameras.indexOf(a)>-1},Fo.prototype.setFogMode=function(a){var r=null!==this.fog?this.fog.color.getHex():"#FFFFFF";a===l.Fog.LINEAR?this.fog=new l.Fog(r,5,20):a===l.Fog.EXPONENTIAL?this.fog=new l.FogExp2(r,.01):a===l.Fog.NONE&&(this.fog=null)},Fo.prototype.toJSON=function(a){if(!this.parent||"Program"!==this.parent.type)return console.warn("nunuStudio: Scene is not on top level serializing as Group."),this.type="Group",l.Object3D.prototype.toJSON.call(this,a);var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(T,U){r.background instanceof l.Color?U.background=r.background.toJSON(T):r.background instanceof l.Texture&&(U.background=r.background.toJSON(T).uuid),r.environment instanceof l.Texture&&(U.environment=r.environment.toJSON(T).uuid)});if(null!==this.defaultCamera){var p=new l.Vector3,y=new l.Quaternion,b=new l.Vector3;this.defaultCamera.matrixWorld.decompose(p,y,b);var R=this.defaultCamera.toJSON(a);R.object.position=p.toArray(),R.object.quaternion=y.toArray(),R.object.scale=b.toArray(),h.object.defaultCamera=R}null!==this.fog&&(h.object.fog=this.fog.toJSON()),h.object.usePhysics=this.usePhysics,h.object.cameras=[];for(var O=0;O<this.cameras.length;O++)h.object.cameras.push(this.cameras[O].uuid);return h.object.world={},h.object.world.gravity=this.world.gravity,h.object.world.quatNormalizeSkip=this.world.quatNormalizeSkip,h.object.world.quatNormalizeFast=this.world.quatNormalizeFast,h.object.world.solver={},h.object.world.solver.tolerance=this.world.solver.tolerance,h.object.world.solver.iterations=this.world.solver.iterations,h},(pc.prototype=Object.create(l.AnimationMixer.prototype)).createActions=function(a){for(var r=0;r<a.length;r++){var h=this.clipAction(a[r]);h.setLoop(a[r].loop),h.weight=a[r].weight,h.timeScale=a[r].timeScale,h.enabled=a[r].enabled,h.play()}return this._actions},pc.prototype.setTime=function(a){this.time=a;for(var r=0;r<this._actions.length;r++)this._actions[r].time=a;this.update(0,!0)},pc.prototype.play=function(){this.playing=!0},pc.prototype.stop=function(){this.setTime(0),this.playing=!1},pc.prototype.pause=function(){this.playing=!1},pc.prototype.dispose=function(){this.stopAllAction(),this.uncacheRoot(this._root)},pc.prototype.update=function(a,r){if(this.playing||r){this.time+=a;for(var h=Math.sign(a),p=0;p<this._actions.length;p++)this._actions[p]._update(this.time,a,h,this._accuIndex);for(p=0;p<this._bindings.length;p++)this._bindings[p].apply(this._accuIndex)}return this};var ra=__webpack_require__(412);ra.Object3D.prototype.folded=!1,ra.Object3D.prototype.locked=!1,ra.Object3D.prototype.contains=function(a){for(var r=0;r<this.children.length;r++)if(this.children[r].uuid===a.uuid||this.children[r].contains(a))return!0;return!1},ra.Object3D.prototype.playAnimation=function(){void 0!==this.mixer&&this.mixer.play()},ra.Object3D.prototype.stopAnimation=function(){void 0!==this.mixer&&this.mixer.stop()},ra.Object3D.prototype.initialize=function(){void 0!==this.animations&&(this.mixer=new pc(this),this.mixer.createActions(this.animations),this.mixer.play())},ra.Object3D.prototype.update=function(a){void 0!==this.mixer&&this.mixer.update(a)},ra.Object3D.prototype.resize=function(a,r){},ra.Object3D.prototype.dispose=function(){void 0!==this.mixer&&this.mixer.dispose()},ra.Object3D.prototype.addAbove=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r);this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},ra.Object3D.prototype.addBellow=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r)+1;this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},ra.Object3D.prototype.getScene=function(){for(var a=this;null!==a.parent;)if((a=a.parent)instanceof Fo)return a;return null},ra.Object3D.prototype.removeAll=function(){for(;this.children.length>0;)this.remove(this.children[0])},ra.Object3D.prototype.isEmpty=function(){return 0===this.children.length},ra.Object3D.prototype.destroy=function(){for(;this.children.length>0;)this.children[0].destroy();null!==this.parent&&(this.dispose&&this.dispose(),this.parent.remove(this),this.parent=null)},ra.Object3D.prototype.toJSON=function(a,r,h){var p=void 0===a,y={};p&&(a=new L,y.metadata={version:VERSION,type:"Object3D"});var b={};if(b.uuid=this.uuid,b.type=this.type,b.name=this.name,b.folded=this.folded,b.locked=this.locked,b.castShadow=this.castShadow,b.receiveShadow=this.receiveShadow,b.visible=this.visible,b.matrixAutoUpdate=this.matrixAutoUpdate,b.frustumCulled=this.frustumCulled,b.renderOrder=this.renderOrder,b.position=this.position.toArray(),b.quaternion=this.quaternion.toArray(),b.scale=this.scale.toArray(),b.layers=this.layers.mask,b.userData=this.userData,void 0!==this.geometry){b.geometry=ne(a.geometries,this.geometry);var R=this.geometry.parameters;if(void 0!==R&&void 0!==R.shapes){var O=R.shapes;if(Array.isArray(O))for(var T=0,U=O.length;T<U;T++)ne(a.shapes,O[T]);else ne(a.shapes,O)}}if(void 0!==this.material)if(this.material instanceof l.Material)b.material=ne(a.materials,this.material);else if(this.material instanceof Array){var ie=[];for(T=0;T<this.material.length;T++)ie.push(ne(a.materials,this.material[T]));b.material=ie}if(void 0!==this.animations&&this.animations.length>0)for(b.animations=[],T=0;T<this.animations.length;T++)b.animations.push(l.AnimationClip.toJSON(this.animations[T]));if(y.object=b,void 0!==r&&r(a,b,y),!1!==h&&this.children.length>0)for(b.children=[],T=0;T<this.children.length;T++)this.children[T].locked||b.children.push(this.children[T].toJSON(a).object);return p&&(y.geometries=ve(a.geometries),y.materials=ve(a.materials),y.textures=ve(a.textures),y.images=ve(a.images),y.videos=ve(a.videos),y.audio=ve(a.audio),y.fonts=ve(a.fonts),y.skeletons=ve(a.skeletons),y.resources=ve(a.resources),y.shapes=ve(a.shapes)),y;function ne(be,Te){return void 0===be[Te.uuid]&&(be[Te.uuid]=Te.toJSON(a)),Te.uuid}function ve(be){var Te=[];for(var Le in be){var Ie=be[Le];delete Ie.metadata,Te.push(Ie)}return Te}},__webpack_require__(870);var wd=__webpack_require__(412),Dp={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Iu=function(a){if(void 0!==a.array){var r=new Dp[a.type](a.array),h=new(a.isInstancedBufferAttribute?l.InstancedBufferAttribute:l.BufferAttribute)(r,a.itemSize,a.normalized);return void 0!==a.name&&(h.name=a.name),h}if("BufferAttribute"===a.type)r=new Dp[a.typedArray.type](a.typedArray.array),h=new l.BufferAttribute(r,a.itemSize,a.normalized);else if("InstancedBufferAttribute"===a.type)r=new Dp[a.typedArray.type](a.typedArray.array),h=new l.InstancedBufferAttribute(r,a.itemSize,a.normalized,a.meshPerAttribute);else if("InterleavedBufferAttribute"===a.type){r=new Dp[a.data.typedArray.type](a.data.typedArray.array);var p=new l.InterleavedBuffer(r,a.data.stride);p.setUsage(a.data.usage),p.count=a.data.count,h=new l.InterleavedBufferAttribute(p,a.itemSize,a.offset,a.normalized)}return void 0!==a.name&&(h.name=a.name),h};wd.BufferGeometryLoader.prototype.parse=function(a){var r=a.isInstancedBufferGeometry?new l.InstancedBufferGeometry:new l.BufferGeometry,h=a.data.index;if(void 0!==h){var p=new Dp[h.type](h.array);r.setIndex(new l.BufferAttribute(p,1))}var y=a.data.attributes;for(var b in y)r.setAttribute(b,Iu(y[b]));var R=a.data.morphAttributes;if(R)for(var b in R){for(var O=R[b],T=[],U=0,ee=O.length;U<ee;U++)T.push(Iu(O[U]));r.morphAttributes[b]=T}a.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);var ie=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==ie){U=0;for(var ne=ie.length;U!==ne;++U){var ve=ie[U];r.addGroup(ve.start,ve.count,ve.materialIndex)}}var be=a.data.boundingSphere;if(void 0!==be){var Te=new l.Vector3;void 0!==be.center&&Te.fromArray(be.center),r.boundingSphere=new l.Sphere(Te,be.radius)}return a.name&&(r.name=a.name),a.userData&&(r.userData=a.userData),r};var gf=__webpack_require__(412);gf.Material.prototype.dispose=function(){function a(r){r?.dispose()}this.dispatchEvent({type:"dispose"}),a(this.map),a(this.bumpMap),a(this.normalMap),a(this.displacementMap),a(this.specularMap),a(this.emissiveMap),a(this.alphaMap),a(this.roughnessMap),a(this.metalnessMap),a(this.envMap)},gf.Material.prototype.toJSON=function(a){void 0===a&&(a={textures:{},images:{},videos:{}});var r={};function h(R){var O=[];for(var T in R){var U=R[T];delete U.metadata,O.push(U)}return O}if(r.uuid=this.uuid,r.type=this.type,r.name=this.name,r.toneMapped=this.toneMapped,r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),void 0!==this.transmission&&(r.transmission=this.transmission),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(a).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(a).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(a).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(a).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(a).uuid),this.aoMapIntensity&&(r.aoMapIntensity=this.aoMapIntensity),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(a).uuid,r.reflectivity=this.reflectivity,this.combine&&(r.combine=this.combine),this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),this.refractionRatio&&(r.refractionRatio=this.refractionRatio)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.rotation&&(r.rotation=this.rotation),void 0!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),this.blending!==l.NormalBlending&&(r.blending=this.blending),this.side!==l.FrontSide&&(r.side=this.side),this.vertexColors!==l.NoColors&&(r.vertexColors=this.vertexColors),r.flatShading=this.flatShading,this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,void 0!==this.morphNormals&&(r.morphNormals=this.morphNormals),void 0===a){var p=h(a.textures),y=h(a.images),b=h(a.videos);p.length>0&&(r.textures=p),y.length>0&&(r.images=y),b.length>0&&(r.videos=b)}return r},__webpack_require__(412).Points.prototype.raycast=function(a,r){null===this.geometry.boundingBox&&this.geometry.computeBoundingBox();var h=new l.Box3;h.copy(this.geometry.boundingBox),h.applyMatrix4(this.matrixWorld),null!==a.ray.intersectBox(h,new l.Vector3)&&r.push({object:this})};var qd,su,rl,Zp,au=__webpack_require__(412);function to(){}function Mr(){}function Yr(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var a=navigator.getGamepads(),r=0;r<a.length;r++)if(null!==a[r]){this.setGamepad(a[r]);break}null===this.gamepad&&console.warn("nunuStudio: No gamepad found")}function Ou(){this.alpha=0,this.beta=0,this.gamma=0,this.orientation=0,this.events=new hn;var a=this;this.events.add(window,"orientationchange",function(r){a.orientation=l.Math.degToRad(window.orientation)}),this.events.add(window,"deviceorientation",function(r){a.alpha=l.Math.degToRad(r.alpha),a.beta=l.Math.degToRad(r.beta),a.gamma=l.Math.degToRad(r.gamma)}),this.events.create()}function ku(a){this.size=new l.Vector2(2,2),this.halfSize=new l.Vector2(1,1),this.matrix=new l.Matrix4,this.cache={camera:{fov:0,style:""},objects:new WeakMap},this.domElement=void 0!==a?a:document.createElement("div"),this.domElement.style.overflow="hidden",this.domElement.style.pointerEvents="none",this.cameraElement=document.createElement("div"),this.cameraElement.style.WebkitTransformStyle="preserve-3d",this.cameraElement.style.transformStyle="preserve-3d",this.domElement.appendChild(this.cameraElement)}function lu(a){vl.call(this,a)}function Ua(a){Dl.call(this),this.format="url",this.encoding=Rn.getFileExtension(a),this.data=a}function Fu(a,r,h){this.bufferGeometry=!1,this.direction=new l.Vector3(0,1,0),this.angle=void 0!==a?a:Math.PI,this.start=void 0!==r?r:0,this.end=void 0!==h?h:1}function cu(){this.events=[]}function Xn(a,r){this.x=a||0,this.y=r||0}function Oi(a){void 0!==a?this.m=a:this.identity()}function Rh(){}function Pn(){this.uuid=Rh.generate(),this.children=[],this.parent=null,this.level=0,this.position=new Xn(0,0),this.origin=new Xn(0,0),this.scale=new Xn(1,1),this.rotation=0,this.visible=!0,this.layer=0,this.matrix=new Oi,this.globalMatrix=new Oi,this.inverseGlobalMatrix=new Oi,this.masks=[],this.matrixAutoUpdate=!0,this.matrixNeedsUpdate=!0,this.draggable=!1,this.pointerEvents=!0,this.ignoreViewport=!1,this.saveContextState=!0,this.restoreContextState=!0,this.pointerInside=!1,this.beingDragged=!1,this.serializable=!0}function Do(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Gi(a,r){this._keys=new Array(5),this._position=new Xn(0,0),this._positionUpdated=!1,this._delta=new Xn(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new Xn(0,0),this.delta=new Xn(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,void 0!==r&&this.setCanvas(r),this.events=new cu;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new Do,this.keys[h]=new Do;var p=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){p._wheel=30*b.detail,p._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}),void 0!==window.ontouchstart||navigator.msMaxTouchPoints>0){var y=new Xn(0,0);this.events.add(this.domElement,"touchstart",function(b){var R=b.touches[0];p.updatePosition(R.clientX,R.clientY,0,0),p.updateKey(Gi.LEFT,Do.DOWN),y.set(R.clientX,R.clientY)}),this.events.add(this.domElement,"touchend",function(b){p.updateKey(Gi.LEFT,Do.UP)}),this.events.add(this.domElement,"touchcancel",function(b){p.updateKey(Gi.LEFT,Do.UP)}),this.events.add(document.body,"touchmove",function(b){var R=b.touches[0];p.updatePosition(R.clientX,R.clientY,R.clientX-y.x,R.clientY-y.y),y.set(R.clientX,R.clientY)})}this.events.add(this.domElement,"mousemove",function(b){p.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){p.updateKey(b.which-1,Do.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){p.updateKey(b.which-1,Do.UP)}),this.events.add(this.domElement,"dragstart",function(b){p.updateKey(b.which-1,Do.UP)}),this.events.add(this.domElement,"dblclick",function(b){p._doubleClicked[b.which-1]=!0}),this.create()}function Qp(a){this.uuid=Rh.generate(),this.canvas=a,this.position=new Xn(0,0),this.scale=1,this.rotation=0,this.matrix=new Oi,this.inverseMatrix=new Oi,this.matrixNeedsUpdate=!0,this.moveOnScale=!1,this.rotationPoint=null}function Ph(a){this.viewport=a,this.dragButton=Gi.RIGHT,this.allowScale=!0,this.moveOnScale=!1,this.allowRotation=!0,this.rotationPoint=null,this.rotationInitial=0}function Du(a){this.callback=a,this.running=!1,this.id=-1}function ia(a,r){void 0===r&&(r={alpha:!0,imageSmoothingEnabled:!0,imageSmoothingQuality:"low",globalCompositeOperation:"source-over"}),this.canvas=a,this.container=null,this.context=this.canvas.getContext("2d",{alpha:r.alpha}),this.context.imageSmoothingEnabled=r.imageSmoothingEnabled,this.context.imageSmoothingQuality=r.imageSmoothingQuality,this.context.globalCompositeOperation=r.globalCompositeOperation,this.pointer=new Gi(window,this.canvas),this.autoClear=!0}function Ki(a,r){this.min=void 0!==a?a:new Xn,this.max=void 0!==r?r:new Xn}function oa(){Pn.call(this)}function yl(){oa.call(this),this.box=new Ki(new Xn(-50,-35),new Xn(50,35)),this.invert=!1}function so(){this.cache=null,this.needsUpdate=!0}function Ko(a){so.call(this),this.color=a||"#000000"}function ws(){Pn.call(this),this.box=new Ki(new Xn(-50,-50),new Xn(50,50)),this.strokeStyle=new Ko("#000000"),this.lineWidth=1,this.fillStyle=new Ko("#FFFFFF")}function ho(){Pn.call(this),this.radius=10,this.strokeStyle=new Ko("#000000"),this.lineWidth=1,this.fillStyle=new Ko("#FFFFFF")}function qo(){Pn.call(this),this.from=new Xn,this.to=new Xn,this.dashPattern=[5,5],this.strokeStyle=new Ko("#000000"),this.lineWidth=1}function rs(){Pn.call(this),this.text="",this.font="16px Arial",this.strokeStyle=null,this.lineWidth=1,this.fillStyle=new Ko("#000000"),this.textAlign="center",this.textBaseline="middle"}function Ea(a){Pn.call(this),this.box=new Ki,this.image=document.createElement("img"),void 0!==a&&this.setImage(a)}function Ih(a){Pn.call(this),this.parentElement=null,this.element=document.createElement(a||"div"),this.element.style.transformStyle="preserve-3d",this.element.style.position="absolute",this.element.style.top="0px",this.element.style.bottom="0px",this.element.style.transformOrigin="0px 0px",this.element.style.overflow="auto",this.element.style.pointerEvents="none",this.size=new Xn(100,100)}function ao(a){Pn.call(this),this.box=new Ki,this.image=document.createElement("img"),this.repetition="repeat",void 0!==a&&this.setImage(a)}function Ta(){rs.call(this),this.maxWidth=null,this.lineHeight=null}function xl(){qo.call(this),this.fromCp=new Xn,this.toCp=new Xn}function uu(){qo.call(this),this.controlPoint=new Xn}function za(){ws.call(this),this.radius=5}function as(){Pn.call(this),this.box=new Ki(new Xn(-50,-35),new Xn(50,35)),this.strokeStyle=new Ko("rgb(0, 153, 255)"),this.lineWidth=1,this.fillStyle=new Ko("rgba(0, 153, 255, 0.3)"),this.min=0,this.max=10,this.data=[]}function Kp(a,r){this.offset=a,this.color=r}function wl(){so.call(this),this.colors=[]}function Gl(){wl.call(this),this.start=new Xn(-100,0),this.end=new Xn(100,0)}function Uu(){Pn.call(this),this.value=50,this.min=0,this.max=100,this.radius=80,this.lineWidth=10,this.startAngle=Math.PI,this.endAngle=2*Math.PI,this.dial=!1,this.baseStyle=new Ko("#e9ecf1"),this.barStyle=new Gl,this.barStyle.start.set(-100,0),this.barStyle.end.set(100,0),this.barStyle.addColorStop(0,"#e5ff50"),this.barStyle.addColorStop(.5,"#50ff67"),this.barStyle.addColorStop(1,"#32adff")}function po(a){so.call(this),this.source=a||document.createElement("img"),this.repetition="repeat",this.matrix=new Oi}function dh(){wl.call(this),this.start=new Xn(0,0),this.startRadius=10,this.end=new Xn(0,0),this.endRadius=50}function hu(){Pn.call(this)}function ls(){xl.call(this),this.lineWidth=2,this.outputSocket=null,this.inputSocket=null}function Hi(a,r,h,p){ho.call(this),this.draggable=!0,this.radius=6,this.layer=1,this.name=void 0!==p?p:"",this.category=void 0!==h?h:"",this.multiple=!0,this.direction=r,this.node=a,this.connectors=[],this.creatingConnection=!1,this.text=new rs,this.text.text=this.name,this.direction===Hi.INPUT?(this.text.position.x-=10,this.text.textAlign="right"):this.direction===Hi.OUTPUT&&(this.text.position.x+=10,this.text.textAlign="left"),this.add(this.text)}function Ss(){za.call(this),this.draggable=!0,this.inputs=[],this.outputs=[]}function Xd(){}function Yd(){}function Ti(){l.Group.call(this),this.type="NodeScript",this.name="script",this.graph=new hu}function dc(a,r){this.uuid=l.Math.generateUUID(),this.data=a,this.callback=r}function Es(a,r){this.size=r,this.file=a,this.workers=[],this.next=0,this.createWorkers(),this.tasks={}}function ed(a,r){this.callback=a,this.time=r,this.running=!1,this.id=-1}function td(a){this.callback=a,this.running=!1,this.id=-1}function ja(){}function pu(){}au.Skeleton.prototype.toJSON=function(){var a={};void 0===this.uuid&&(this.uuid=l.Math.generateUUID()),a.uuid=this.uuid,a.bones=[];for(var r=0;r<this.bones.length;r++)a.bones.push(this.bones[r].uuid);for(a.boneInverses=[],r=0;r<this.boneInverses.length;r++)a.boneInverses.push(this.boneInverses[r].toArray());return a},au.Skeleton.fromJSON=function(a,r){for(var h=[],p=[],y=0;y<a.bones.length;y++){var b=r.getObjectByProperty("uuid",a.bones[y]);void 0===b&&(console.warn("Skeleton.fromJSON: Not found Bone with uuid "+a.bones[y]),b=new l.Bone),h.push(b),p.push((new l.Matrix4).fromArray(a.boneInverses[y]))}var R=new au.Skeleton(h,p);return R.uuid=a.uuid,R},__webpack_require__(819),__webpack_require__(412).Texture.prototype.toJSON=function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var r={metadata:{version:VERSION,type:"Texture"},uuid:this.uuid,name:this.name,category:this.category,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return a.textures[this.uuid]=r,r},to.NAME="nunuStudio",to.NWJS=200,to.BROWSER=201,to.CORDOVA=202,to.copyNamespace=function(a,r){for(var h in void 0===r&&(r=window),a)h in r||(r[h]=a[h])},to.getQueryParameters=function(){for(var a=location.search.substring(1).split("&"),r={},h=0;h<a.length;h++){var p=a[h].split("=");if(p.length>1){var y=unescape(p[0]).replace(new RegExp('"',"g"),""),b=unescape(p[1]).replace(new RegExp('"',"g"),"");r[y]=b}}return r},to.createWorker=function(a,r){var h=new Blob([a],{type:"application/javascript"}),p=new Worker(URL.createObjectURL(h));return void 0!==r&&(p.onmessage=r),p},to.webAudioAvailable=function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext},to.webGLAvailable=function(){try{var a=document.createElement("canvas");return(a.getContext("webgl")||a.getContext("experimental-webgl")).getSupportedExtensions(),!0}catch{}return!1},to.getPlatform=function(){return void 0!==window.nw?to.NWJS:void 0!==window.cordova?to.CORDOVA:to.BROWSER},to.runningOnDesktop=function(){return void 0!==window.nw},to.openWebpage=function(a){to.runningOnDesktop()?window.require("nw.gui").Shell.openExternal(a):window.open(a)},to.isFullscreen=function(){return!0===document.webkitIsFullScreen||!0===document.mozFullScreen||!0===document.webkitIsFullScreen||!0===document.webkitIsFullScreen||!0===document.fullscreen||!1},to.setFullscreen=function(a,r){var h=to.isFullscreen();void 0===a&&(a=!h),!0===a?(void 0===r&&(r=document.body),!1===h&&(r.requestFullscreen=r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullscreen||r.msRequestFullscreen,void 0!==r.requestFullscreen&&r.requestFullscreen())):!0===h&&(document.exitFullscreen=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen,void 0!==document.exitFullscreen&&document.exitFullscreen())},Mr.ARROW_LEFT=37,Mr.ARROW_UP=38,Mr.ARROW_RIGHT=39,Mr.ARROW_DOWN=40,Mr.ENTER=13,Mr.BACK=10009,Mr.VOLUME_UP=447,Mr.VOLUME_DOWN=448,Mr.VOLUME_MUTE=449,Mr.CHANNEL_UP=427,Mr.CHANNEL_DOWN=428,Mr.F0_RED=403,Mr.F1_GREEN=404,Mr.F2_YELLOW=405,Mr.F3_BLUE=406,Mr.NUM_0=48,Mr.NUM_1=49,Mr.NUM_2=50,Mr.NUM_3=51,Mr.NUM_4=52,Mr.NUM_5=53,Mr.NUM_6=54,Mr.NUM_7=55,Mr.NUM_8=56,Mr.NUM_9=57,Mr.MINUS=189,Mr.E_MANUAL=10146,Mr.PREVIOUS_CHANNEL=10190,Mr.PICTURE_SIZE=10140,Mr.SOCCER=10228,Mr.TELETEXT=10200,Mr.SEARCH=10225,Mr.GUIDE=458,Mr.SOURCE=10072,Mr.EXTRA=10253,Mr.MTS=10195,Mr.MEDIA_PLAY_PAUSE=10252,Mr.MENU=18,Mr.MEDIA_REWIND=412,Mr.TOOLS=10135,Mr.MEDIA_FAST_FORWARD=417,Mr.INFO=457,Mr.MEDIA_PLAY=415,Mr.EXIT=10182,Mr.MEDIA_PAUSE=19,Mr.MEDIA_STOP=413,Mr.CAPTION=10221,Mr.MEDIA_RECORD=416,Mr.CHANNEL_LIST=10073,Mr.MEDIA_TRACK_PREVIOUS=10232,Mr.MEDIA_TRACK_NEXT=10233,Mr.MEDIA_3D=10199,(Yr.prototype=Yr).constructor=Yr,Yr.prototype.setGamepad=function(a){if(null!=a){this.index=a.index,this.gamepad=a,this.buttons=[];for(var r=0;r<a.buttons.length;r++)this.buttons.push(new li);this.setProductVendor(a),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},Yr.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},Yr.prototype.setProductVendor=function(a){try{var r=a.id.split(":");return this.vendor=r[1].split(" ")[1],void(this.product=r[2].replace(" ","").replace(")",""))}catch{}try{return r=a.id.split("-"),this.vendor=r[0],void(this.product=r[1])}catch{}},Yr.prototype.update=function(a){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var r=0;r<this.buttons.length;r++)this.buttons[r].update(this.gamepad.buttons[r].pressed?li.DOWN:li.UP)},Yr.prototype.getAnalogueButton=function(a){return a>this.buttons.length||a<0?0:this.gamepad.buttons[a].value},Yr.prototype.getAxis=function(a){return a>this.gamepad.axes.length||a<0?0:this.gamepad.axes[a]},Yr.prototype.buttonExists=function(a){return a>=0&&a<this.buttons.length},Yr.prototype.buttonPressed=function(a){return!!this.buttons[a]&&this.buttons[a].pressed},Yr.prototype.buttonJustPressed=function(a){return!!this.buttons[a]&&this.buttons[a].justPressed},Yr.prototype.buttonJustReleased=function(a){return!!this.buttons[a]&&this.buttons[a].justReleased},Yr.LEFT=14,Yr.RIGHT=15,Yr.DOWN=13,Yr.UP=12,Yr.SELECT=8,Yr.START=9,Yr.HOME=16,Yr.LEFT_TRIGGER_A=4,Yr.LEFT_TRIGGER_B=6,Yr.RIGHT_TRIGGER_A=5,Yr.RIGHT_TRIGGER_B=7,Yr.L1=4,Yr.L2=6,Yr.L3=6,Yr.R1=5,Yr.R2=7,Yr.R3=11,Yr.A=0,Yr.B=1,Yr.C=2,Yr.D=3,Yr.X=2,Yr.Y=3,Yr.LEFT_ANALOGUE_BUT=10,Yr.LEFT_ANALOGUE_HOR=0,Yr.LEFT_ANALOGUE_VERT=1,Yr.RIGHT_ANALOGUE_BUT=11,Yr.RIGHT_ANALOGUE_HOR=2,Yr.RIGHT_ANALOGUE_VERT=3,Ou.prototype.setObjectQuaternion=(qd=new l.Euler,su=new l.Quaternion,rl=new l.Vector3(0,0,1),Zp=new l.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(a){qd.set(this.beta,this.alpha,-this.gamma,"YXZ"),a.quaternion.setFromEuler(qd),a.quaternion.multiply(Zp),a.quaternion.multiply(su.setFromAxisAngle(rl,-this.orientation))}),Ou.prototype.dispose=function(){this.events.destroy()},ku.prototype.getSize=function(){return{width:this.size.x,height:this.size.y}},ku.prototype.setSize=function(a,r){this.size.set(a,r),this.halfSize.set(a/2,r/2),this.domElement.style.width=a+"px",this.domElement.style.height=r+"px",this.cameraElement.style.width=a+"px",this.cameraElement.style.height=r+"px"},ku.prototype.render=function(a,r){function h(T){var U=T.elements;return"matrix3d("+U[0]+","+-U[1]+","+U[2]+","+U[3]+","+U[4]+","+-U[5]+","+U[6]+","+U[7]+","+U[8]+","+-U[9]+","+U[10]+","+U[11]+","+U[12]+","+-U[13]+","+U[14]+","+U[15]+")"}function p(T,U){var ee=T.elements;return"translate(-50%,-50%)matrix3d("+ee[0]+","+ee[1]+","+ee[2]+","+ee[3]+","+-ee[4]+","+-ee[5]+","+-ee[6]+","+-ee[7]+","+ee[8]+","+ee[9]+","+ee[10]+","+ee[11]+","+ee[12]+","+ee[13]+","+ee[14]+","+ee[15]+")"}var y,b=this,R=r.projectionMatrix.elements[5]*this.halfSize.y;this.cache.camera.fov!==R&&(r.isPerspectiveCamera&&(this.domElement.style.WebkitPerspective=R+"px",this.domElement.style.perspective=R+"px"),this.cache.camera.fov=R),a.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld();var O=(y=r.isOrthographicCamera?"scale("+R+")translate("+-(r.right+r.left)/2+"px,"+(r.top+r.bottom)/2+"px)"+h(r.matrixWorldInverse):"translateZ("+R+"px)"+h(r.matrixWorldInverse))+"translate("+this.halfSize.x+"px,"+this.halfSize.y+"px)";this.cache.camera.style!==O&&(this.cameraElement.style.WebkitTransform=O,this.cameraElement.style.transform=O,this.cache.camera.style=O),function T(U,ee,ie){if(!0===U.isCSS3DObject){var ne;!0===U.isCSS3DSprite?(matrix.copy(ee.matrixWorldInverse),matrix.transpose(),matrix.copyPosition(U.matrixWorld),matrix.scale(U.scale),matrix.elements[3]=0,matrix.elements[7]=0,matrix.elements[11]=0,matrix.elements[15]=1,ne=p(matrix)):ne=p(U.matrixWorld);var ve=U.element,be=b.cache.objects.get(U);void 0!==be&&be.style===ne||(ve.style.WebkitTransform=ne,ve.style.transform=ne,b.cache.objects.set(U,{style:ne})),ve.parentNode!==b.cameraElement&&b.cameraElement.appendChild(ve)}for(var Te=0,Le=U.children.length;Te<Le;Te++)T(U.children[Te],ee,ie)}(a,r,y)},(lu.prototype=Object.create(vl.prototype)).constructor=lu,lu.prototype.isCSS3DSprite=!0,Ua.prototype=Object.create(Dl.prototype),Fu.prototype.modify=function(a){a instanceof l.BufferGeometry?((a=new l.Geometry).fromBufferGeometry(Editor.selection[0].geometry),a.mergeVertices()):a=a.clone();for(var r=new l.Quaternion,h=0;h<a.vertices.length;h++){var p=a.vertices[h].y;p>=this.start&&p<=this.end?(r.setFromAxisAngle(this.direction,this.angle*((p-this.start)/(this.end-this.start))),a.vertices[h].applyQuaternion(r)):p>this.end&&(r.setFromAxisAngle(this.direction,this.angle),a.vertices[h].applyQuaternion(r))}if(a.computeVertexNormals(),a.verticesNeedUpdate=!0,this.bufferGeometry){var b=new l.BufferGeometry;return b.fromGeometry(a),b}return a},cu.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},cu.prototype.clear=function(){this.destroy(),this.events=[]},cu.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},cu.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},Xn.prototype.set=function(a,r){this.x=a,this.y=r},Xn.prototype.setScalar=function(a){this.x=a,this.y=a},Xn.prototype.clone=function(){return new Xn(this.x,this.y)},Xn.prototype.copy=function(a){this.x=a.x,this.y=a.y},Xn.prototype.add=function(a){this.x+=a.x,this.y+=a.y},Xn.prototype.addScalar=function(a){this.x+=a,this.y+=a},Xn.prototype.addVectors=function(a,r){this.x=a.x+r.x,this.y=a.y+r.y},Xn.prototype.addScaledVector=function(a,r){this.x+=a.x*r,this.y+=a.y*r},Xn.prototype.sub=function(a){this.x-=a.x,this.y-=a.y},Xn.prototype.subScalar=function(a){this.x-=a,this.y-=a},Xn.prototype.subVectors=function(a,r){this.x=a.x-r.x,this.y=a.y-r.y},Xn.prototype.multiply=function(a){this.x*=a.x,this.y*=a.y},Xn.prototype.multiplyScalar=function(a){this.x*=a,this.y*=a},Xn.prototype.divide=function(a){this.x/=a.x,this.y/=a.y},Xn.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},Xn.prototype.min=function(a){this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y)},Xn.prototype.max=function(a){this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y)},Xn.prototype.clamp=function(a,r){this.x=Math.max(a.x,Math.min(r.x,this.x)),this.y=Math.max(a.y,Math.min(r.y,this.y))},Xn.prototype.clampScalar=function(a,r){this.x=Math.max(a,Math.min(r,this.x)),this.y=Math.max(a,Math.min(r,this.y))},Xn.prototype.clampLength=function(a,r){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(r,h)))},Xn.prototype.floor=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},Xn.prototype.ceil=function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},Xn.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},Xn.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Xn.prototype.dot=function(a){return this.x*a.x+this.y*a.y},Xn.prototype.cross=function(a){return this.x*a.y-this.y*a.x},Xn.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Xn.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Xn.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},Xn.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Xn.prototype.angle=function(){var a=Math.atan2(this.y,this.x);return a<0&&(a+=2*Math.PI),a},Xn.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},Xn.prototype.distanceToSquared=function(a){var r=this.x-a.x,h=this.y-a.y;return r*r+h*h},Xn.prototype.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},Xn.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)},Xn.prototype.lerp=function(a,r){this.x+=(a.x-this.x)*r,this.y+=(a.y-this.y)*r},Xn.prototype.lerpVectors=function(a,r,h){return this.subVectors(r,a).multiplyScalar(h).add(a)},Xn.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},Xn.prototype.fromArray=function(a){this.set(a[0],a[1])},Xn.prototype.toArray=function(){return[this.x,this.y]},Xn.prototype.rotateAround=function(a,r){var h=Math.cos(r),p=Math.sin(r),y=this.x-a.x,b=this.y-a.y;this.x=y*h-b*p+a.x,this.y=y*p+b*h+a.y},Oi.prototype.copy=function(a){this.m=a.m.slice(0)},Oi.prototype.clone=function(){return new Oi(this.m.slice(0))},Oi.prototype.identity=function(){this.m=[1,0,0,1,0,0]},Oi.prototype.multiply=function(a){this.m=[this.m[0]*a.m[0]+this.m[2]*a.m[1],this.m[1]*a.m[0]+this.m[3]*a.m[1],this.m[0]*a.m[2]+this.m[2]*a.m[3],this.m[1]*a.m[2]+this.m[3]*a.m[3],this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5]]},Oi.prototype.premultiply=function(a){this.m=[a.m[0]*this.m[0]+a.m[2]*this.m[1],a.m[1]*this.m[0]+a.m[3]*this.m[1],a.m[0]*this.m[2]+a.m[2]*this.m[3],a.m[1]*this.m[2]+a.m[3]*this.m[3],a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5]]},Oi.prototype.compose=function(a,r,h,p,y,b,R){if(this.m=[1,0,0,1,a,r],0!==R){var O=Math.cos(R),T=Math.sin(R);this.multiply(new Oi([O,T,-T,O,0,0]))}1===h&&1===p||this.scale(h,p),0===y&&0===b||this.multiply(new Oi([1,0,0,1,-y,-b]))},Oi.prototype.translate=function(a,r){this.m[4]+=this.m[0]*a+this.m[2]*r,this.m[5]+=this.m[1]*a+this.m[3]*r},Oi.prototype.rotate=function(a){var r=Math.cos(a),h=Math.sin(a),y=this.m[1]*r+this.m[3]*h,b=this.m[0]*-h+this.m[2]*r,R=this.m[1]*-h+this.m[3]*r;this.m[0]=this.m[0]*r+this.m[2]*h,this.m[1]=y,this.m[2]=b,this.m[3]=R},Oi.prototype.scale=function(a,r){this.m[0]*=a,this.m[1]*=a,this.m[2]*=r,this.m[3]*=r},Oi.prototype.setPosition=function(a,r){this.m[4]=a,this.m[5]=r},Oi.prototype.getScale=function(){return new Xn(this.m[0],this.m[3])},Oi.prototype.getPosition=function(){return new Xn(this.m[4],this.m[5])},Oi.prototype.skew=function(a,r){this.multiply(new Oi([1,Math.tan(r),Math.tan(a),1,0,0]))},Oi.prototype.determinant=function(){return 1/(this.m[0]*this.m[3]-this.m[1]*this.m[2])},Oi.prototype.getInverse=function(){var a=this.determinant();return new Oi([this.m[3]*a,-this.m[1]*a,-this.m[2]*a,this.m[0]*a,a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a*(this.m[1]*this.m[4]-this.m[0]*this.m[5])])},Oi.prototype.transformPoint=function(a){return new Xn(a.x*this.m[0]+a.y*this.m[2]+this.m[4],a.x*this.m[1]+a.y*this.m[3]+this.m[5])},Oi.prototype.setContextTransform=function(a){a.setTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Oi.prototype.tranformContext=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Oi.prototype.cssTransform=function(){return"matrix("+this.m[0]+","+this.m[1]+","+this.m[2]+","+this.m[3]+","+this.m[4]+","+this.m[5]+")"},Rh.generate=function(){for(var a=[],r=0;r<256;r++)a[r]=(r<16?"0":"")+r.toString(16);return function(){var h=4294967295*Math.random()|0,p=4294967295*Math.random()|0,y=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return(a[255&h]+a[h>>8&255]+a[h>>16&255]+a[h>>24&255]+"-"+a[255&p]+a[p>>8&255]+"-"+a[p>>16&15|64]+a[p>>24&255]+"-"+a[63&y|128]+a[y>>8&255]+"-"+a[y>>16&255]+a[y>>24&255]+a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]).toUpperCase()}}(),Pn.prototype.constructor=Pn,Pn.prototype.type="Object2D",Pn.types=new Map([[Pn.prototype.type,Pn]]),Pn.register=function(a,r){Pn.types.set(r,a)},Pn.prototype.getWorldPointIntersections=function(a,r){void 0===r&&(r=[]);var h=this.inverseGlobalMatrix.transformPoint(a);this.isInside(h)&&r.push(this);for(var p=0;p<this.children.length;p++)this.children[p].getWorldPointIntersections(a,r);return r},Pn.prototype.isWorldPointInside=function(a,r){var h=this.inverseGlobalMatrix.transformPoint(a);if(this.isInside(h))return!0;if(r)for(var p=0;p<this.children.length;p++)if(this.children[p].isWorldPointInside(a,!0))return!0;return!1},Pn.prototype.destroy=function(){null!==this.parent&&this.parent.remove(this)},Pn.prototype.traverse=function(a){a(this);for(var r=0;r<this.children.length;r++)this.children[r].traverse(a)},Pn.prototype.getChildByUUID=function(a){var r=null;return this.traverse(function(h){h.uuid===a&&(r=h)}),r},Pn.prototype.add=function(a){a.parent=this,a.level=this.level+1,a.traverse(function(r){null!==r.onAdd&&r.onAdd(this)}),this.children.push(a)},Pn.prototype.remove=function(a){var r=this.children.indexOf(a);if(-1!==r){var h=this.children[r];h.parent=null,h.level=0,h.traverse(function(p){null!==p.onRemove&&p.onRemove(this)}),this.children.splice(r,1)}},Pn.prototype.isInside=function(a){return!1},Pn.prototype.updateMatrix=function(a){(this.matrixAutoUpdate||this.matrixNeedsUpdate)&&(this.matrix.compose(this.position.x,this.position.y,this.scale.x,this.scale.y,this.origin.x,this.origin.y,this.rotation),this.globalMatrix.copy(this.matrix),null!==this.parent&&this.globalMatrix.premultiply(this.parent.globalMatrix),this.inverseGlobalMatrix=this.globalMatrix.getInverse(),this.matrixNeedsUpdate=!1)},Pn.prototype.transform=function(a,r,h,p){this.globalMatrix.tranformContext(a)},Pn.prototype.style=null,Pn.prototype.draw=null,Pn.prototype.onPointerDrag=function(a,r,h,p){this.position.add(h)},Pn.prototype.onPointerDragStart=null,Pn.prototype.onPointerDragEnd=null,Pn.prototype.onAdd=null,Pn.prototype.onRemove=null,Pn.prototype.onUpdate=null,Pn.prototype.onPointerEnter=null,Pn.prototype.onPointerLeave=null,Pn.prototype.onPointerOver=null,Pn.prototype.onButtonPressed=null,Pn.prototype.onDoubleClick=null,Pn.prototype.onButtonDown=null,Pn.prototype.onButtonUp=null,Pn.prototype.serialize=function(a){var r={uuid:this.uuid,type:this.type,position:this.position.toArray(),origin:this.origin.toArray(),scale:this.scale.toArray(),rotation:this.rotation,visible:this.visible,layer:this.layer,matrix:this.matrix.m,globalMatrix:this.globalMatrix.m,inverseGlobalMatrix:this.inverseGlobalMatrix.m,matrixAutoUpdate:this.matrixAutoUpdate,draggable:this.draggable,pointerEvents:this.pointerEvents,ignoreViewport:this.ignoreViewport,saveContextState:this.saveContextState,restoreContextState:this.restoreContextState,children:[],masks:[]};if(!1!==a)for(var h=0;h<this.children.length;h++)this.children[h].serializable&&r.children.push(this.children[h].serialize());for(h=0;h<this.masks.length;h++)r.masks.push(this.masks[h].uuid);return r},Pn.prototype.parse=function(a,r){this.uuid=a.uuid,this.position.fromArray(a.position),this.origin.fromArray(a.origin),this.scale.fromArray(a.scale),this.rotation=a.rotation,this.visible=a.visible,this.layer=a.layer,this.matrix=new Oi(a.matrix),this.globalMatrix=new Oi(a.globalMatrix),this.inverseGlobalMatrix=new Oi(a.inverseGlobalMatrix),this.matrixAutoUpdate=a.matrixAutoUpdate,this.draggable=a.draggable,this.pointerEvents=a.pointerEvents,this.ignoreViewport=a.ignoreViewport,this.saveContextState=a.saveContextState,this.restoreContextState=a.restoreContextState;for(var h=0;h<this.masks.length;h++)a.masks.push(r.getChildByUUID(a.masks[h]))},Pn.parse=function(a){for(var r=[],h=function y(b){if(!Pn.types.has(b.type))throw new Error("Object type "+b.type+" unknown. Cannot parse data.");var R=new(Pn.types.get(b.type));R.uuid=b.uuid,r.push({object:R,data:b});for(var O=0;O<b.children.length;O++)R.add(y(b.children[O]));return R}(a),p=0;p<r.length;p++)r[p].object.parse(r[p].data,h);return h},Do.DOWN=-1,Do.UP=1,Do.RESET=0,Do.prototype.constructor=Do,Do.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===Do.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===Do.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===Do.RESET&&(this.justReleased=!1,this.justPressed=!1)},Do.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},Do.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Gi.prototype=Gi).constructor=Gi,Gi.LEFT=0,Gi.MIDDLE=1,Gi.RIGHT=2,Gi.BACK=3,Gi.FORWARD=4,Gi.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Gi.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Gi.buttonPressed=function(a){return this.keys[a].pressed},Gi.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Gi.buttonJustPressed=function(a){return this.keys[a].justPressed},Gi.buttonJustReleased=function(a){return this.keys[a].justReleased},Gi.updatePosition=function(a,r,h,p){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=p,this._positionUpdated=!0},Gi.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Gi.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Gi.create=function(){this.events.create()},Gi.dispose=function(){this.events.destroy()},Qp.prototype.updateMatrix=function(){if(this.matrixNeedsUpdate){if(this.matrix.m=[1,0,0,1,this.position.x,this.position.y],0!==this.rotation){var a=Math.cos(this.rotation),r=Math.sin(this.rotation);this.matrix.multiply(new Oi([a,r,-r,a,0,0]))}1!==this.scale&&this.matrix.scale(this.scale,this.scale),this.inverseMatrix=this.matrix.getInverse(),this.matrixNeedsUpdate=!1}},Qp.prototype.centerObject=function(a,r){var h=a.globalMatrix.transformPoint(new Xn);h.multiplyScalar(-this.scale),h.x+=r.width/2,h.y+=r.height/2,this.position.copy(h),this.matrixNeedsUpdate=!0},Ph.prototype.update=function(a){if(this.allowScale&&0!==a.wheel&&(this.viewport.scale-=.001*a.wheel*this.viewport.scale,this.viewport.matrixNeedsUpdate=!0,this.moveOnScale&&null!==a.canvas)){this.viewport.updateMatrix();var h=this.viewport.inverseMatrix.transformPoint(a.position),p=new Xn(a.canvas.width/2,a.canvas.height/2);p=this.viewport.inverseMatrix.transformPoint(p);var y=h.clone();y.sub(p),y.multiplyScalar(.1),this.viewport.position.sub(y),this.viewport.matrixNeedsUpdate=!0}if(this.allowRotation&&a.buttonPressed(Gi.RIGHT)&&a.buttonPressed(Gi.LEFT))if(null===this.rotationPoint)this.rotationPoint=a.position.clone(),this.rotationInitial=this.viewport.rotation;else{var b=a.position.clone();b.sub(this.rotationPoint),this.viewport.rotation=this.rotationInitial+b.angle(),this.viewport.matrixNeedsUpdate=!0}else this.rotationPoint=null,a.buttonPressed(this.dragButton)&&(this.viewport.position.x+=a.delta.x,this.viewport.position.y+=a.delta.y,this.viewport.matrixNeedsUpdate=!0)},Du.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Du.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},ia.prototype.getDomContainer=function(){return null!==this.container?this.container:this.canvas.parentElement},ia.prototype.createRenderLoop=function(a,r,h){var p=this,y=new Ph(r),b=new Du(function(){void 0!==h&&h(),y.update(p.pointer),p.update(a,r)});return b.start(),b},ia.prototype.dispose=function(a,r,h){this.pointer.dispose()},ia.prototype.update=function(a,r){var h=[];a.traverse(function(Te){Te.visible&&h.push(Te)}),h.sort(function(Te,Le){return Le.layer===Te.layer?Le.level-Te.level:Le.layer-Te.layer});var p=this.pointer;p.update(),r.updateMatrix();for(var y=p.position.clone(),b=r.inverseMatrix.transformPoint(y),R=0;R<h.length;R++)if((T=h[R]).pointerEvents){var O=T.inverseGlobalMatrix.transformPoint(T.ignoreViewport?y:b);if(T.isInside(O)){if(T.pointerInside||null===T.onPointerEnter||T.onPointerEnter(p,r),null!==T.onPointerOver&&T.onPointerOver(p,r),p.buttonDoubleClicked(Gi.LEFT)&&null!==T.onDoubleClick&&T.onDoubleClick(p,r),p.buttonPressed(Gi.LEFT)&&null!==T.onButtonPressed&&T.onButtonPressed(p,r),p.buttonJustReleased(Gi.LEFT)&&null!==T.onButtonUp&&T.onButtonUp(p,r),p.buttonJustPressed(Gi.LEFT)&&(null!==T.onButtonDown&&T.onButtonDown(p,r),T.draggable)){T.beingDragged=!0,null!==T.onPointerDragStart&&T.onPointerDragStart(p,r);break}T.pointerInside=!0}else T.pointerInside&&(null!==T.onPointerLeave&&T.onPointerLeave(p,r),T.pointerInside=!1);p.buttonJustReleased(Gi.LEFT)&&T.draggable&&(!0===T.beingDragged&&null!==T.onPointerDragEnd&&T.onPointerDragEnd(p,r),T.beingDragged=!1)}for(R=0;R<h.length;R++){var T;if((T=h[R]).beingDragged&&null!==T.onPointerDrag){var U=p.position.clone();U.sub(p.delta);var ee=r.inverseMatrix.transformPoint(p.position),ie=r.inverseMatrix.transformPoint(U),ne=ee.clone();ne.sub(ie),T.onPointerDrag(p,r,ne,ee)}null!==T.onUpdate&&T.onUpdate()}for(a.traverse(function(Te){Te.updateMatrix()}),this.context.setTransform(1,0,0,1,0,0),this.autoClear&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),R=h.length-1;R>=0;R--)if(!h[R].isMask){h[R].saveContextState&&this.context.save();for(var ve=h[R].masks,be=0;be<ve.length;be++)ve[be].ignoreViewport||r.matrix.setContextTransform(this.context),ve[be].transform(this.context,r,this.canvas,this),ve[be].clip(this.context,r,this.canvas);h[R].ignoreViewport?ve.length>0&&this.context.setTransform(1,0,0,1,0,0):r.matrix.setContextTransform(this.context),h[R].transform(this.context,r,this.canvas,this),null!==h[R].style&&h[R].style(this.context,r,this.canvas),null!==h[R].draw&&h[R].draw(this.context,r,this.canvas),h[R].restoreContextState&&this.context.restore()}},Ki.prototype.set=function(a,r){return this.min.copy(a),this.max.copy(r),this},Ki.prototype.setFromPoints=function(a){this.min=new Xn(1/0,1/0),this.max=new Xn(-1/0,-1/0);for(var r=0,h=a.length;r<h;r++)this.expandByPoint(a[r]);return this},Ki.prototype.setFromCenterAndSize=function(a,r){var h=(new Xn).copy(r).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this},Ki.prototype.clone=function(){var a=new Ki;return a.copy(this),a},Ki.prototype.copy=function(a){this.min.copy(a.min),this.max.copy(a.max)},Ki.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},Ki.prototype.getCenter=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5),a},Ki.prototype.getSize=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min),a},Ki.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},Ki.prototype.expandByVector=function(a){this.min.sub(a),this.max.add(a)},Ki.prototype.expandByScalar=function(a){this.min.addScalar(-a),this.max.addScalar(a)},Ki.prototype.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},Ki.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},Ki.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},Ki.prototype.distanceToPoint=function(a){return(new Xn).copy(a).clamp(this.min,this.max).sub(a).length()},Ki.prototype.intersect=function(a){this.min.max(a.min),this.max.min(a.max)},Ki.prototype.union=function(a){this.min.min(a.min),this.max.max(a.max)},Ki.prototype.translate=function(a){this.min.add(a),this.max.add(a)},Ki.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},Ki.prototype.toArray=function(){return[this.min.x,this.min.y,this.max.x,this.max.y]},Ki.prototype.fromArray=function(a){this.min.set(a[0],a[1]),this.max.set(a[2],a[3])},(oa.prototype=Object.create(Pn.prototype)).constructor=oa,oa.prototype.type="Mask",Pn.register(oa,"Mask"),oa.prototype.isMask=!0,oa.prototype.clip=function(a,r,h){},(yl.prototype=Object.create(oa.prototype)).constructor=yl,yl.prototype.type="BoxMask",Pn.register(yl,"BoxMask"),yl.prototype.isInside=function(a){return this.box.containsPoint(a)},yl.prototype.clip=function(a,r,h){a.beginPath();var p=this.box.max.x-this.box.min.x;this.invert?(a.rect(this.box.min.x-1e4,-5e3,1e4,1e4),a.rect(this.box.max.x,-5e3,1e4,1e4),a.rect(this.box.min.x,this.box.min.y-1e4,p,1e4),a.rect(this.box.min.x,this.box.max.y,p,1e4)):a.fillRect(this.box.min.x,this.box.min.y,p,this.box.max.y-this.box.min.y),a.clip()},so.prototype.get=function(a){},so.prototype.serialize=function(){},so.prototype.parse=function(a){},so.types=new Map([]),so.register=function(a,r){so.types.set(r,a)},so.parse=function(a){var r=new(so.types.get(a.type));return r.parse(a),r},Ko.prototype=Object.create(so.prototype),so.register(Ko,"Color"),Ko.prototype.get=function(a){return this.color},Ko.prototype.serialize=function(){return{type:"Color",color:this.color}},Ko.prototype.parse=function(a){this.color=a.color},(ws.prototype=Object.create(Pn.prototype)).constructor=ws,ws.prototype.type="Box",Pn.register(ws,"Box"),ws.prototype.onPointerEnter=function(a,r){this.fillStyle=new Ko("#CCCCCC")},ws.prototype.onPointerLeave=function(a,r){this.fillStyle=new Ko("#FFFFFF")},ws.prototype.isInside=function(a){return this.box.containsPoint(a)},ws.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillRect(this.box.min.x,this.box.min.y,p,y)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeRect(this.box.min.x,this.box.min.y,p,y))},ws.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},ws.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?so.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?so.parse(a.fillStyle):null},(ho.prototype=Object.create(Pn.prototype)).constructor=ho,ho.prototype.type="Circle",Pn.register(ho,"Circle"),ho.prototype.isInside=function(a){return a.length()<=this.radius},ho.prototype.onPointerEnter=function(a,r){this.fillStyle=new Ko("#CCCCCC")},ho.prototype.onPointerLeave=function(a,r){this.fillStyle=new Ko("#FFFFFF")},ho.prototype.draw=function(a,r,h){a.beginPath(),a.arc(0,0,this.radius,0,2*Math.PI),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.stroke())},ho.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.radius=this.radius,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},ho.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.radius=a.radius,this.strokeStyle=null!==a.strokeStyle?so.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?so.parse(a.fillStyle):null},(qo.prototype=Object.create(Pn.prototype)).constructor=qo,qo.prototype.type="Line",Pn.register(qo,"Line"),qo.prototype.style=function(a,r,h){a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.setLineDash(this.dashPattern)},qo.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.lineTo(this.to.x,this.to.y),a.stroke()},qo.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.from=this.from.toArray(),r.to=this.to.toArray(),r.dashPattern=this.dashPattern,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r},qo.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.to.fromArray(a.to),this.from.fromArray(a.from),this.dashPattern=a.dashPattern,this.strokeStyle=null!==a.strokeStyle?so.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth},(rs.prototype=Object.create(Pn.prototype)).constructor=rs,rs.prototype.type="Text",Pn.register(rs,"Text"),rs.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(this.text,0,0)),null!==this.strokeStyle&&(a.strokeStyle=this.strokeStyle.get(a),a.strokeText(this.text,0,0))},rs.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.text=this.text,r.font=this.font,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.textAlign=this.textAlign,r.textBaseline=this.textBaseline,r},rs.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.text=a.text,this.font=a.font,this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.textAlign=a.textAlign,this.textBaseline=a.textBaseline},(Ea.prototype=Object.create(Pn.prototype)).constructor=Ea,Ea.prototype.type="Image",Pn.register(Ea,"Image"),Ea.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},Ea.prototype.isInside=function(a){return this.box.containsPoint(a)},Ea.prototype.draw=function(a,r,h){this.image.src.length>0&&a.drawImage(this.image,0,0,this.image.naturalWidth,this.image.naturalHeight,this.box.min.x,this.box.min.y,this.box.max.x-this.box.min.x,this.box.max.y-this.box.min.y)},Ea.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r},Ea.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image},(Ih.prototype=Object.create(Pn.prototype)).constructor=Ih,Ih.prototype.type="DOM",Pn.register(Ih,"DOM"),Ih.prototype.onAdd=function(){null!==this.parentElement&&this.parentElement.appendChild(this.element)},Ih.prototype.onRemove=function(){null!==this.parentElement&&this.parentElement.removeChild(this.element)},Ih.prototype.transform=function(a,r,h,p){if(null===this.parentElement&&(this.parentElement=p.getDomContainer(),this.parentElement.appendChild(this.element)),this.ignoreViewport)this.element.style.transform=this.globalMatrix.cssTransform();else{var y=r.matrix.clone();y.multiply(this.globalMatrix),this.element.style.transform=y.cssTransform()}this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px",this.element.style.display=this.visible?"block":"none"},Ih.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.size=this.size.toArray(),r.element=this.element.outerHTML,r},Ih.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.size.fromArray(a.size);var h=(new DOMParser).parseFromString(this.element.outerHTML,"text/html");this.element=h.body.children[0]},(ao.prototype=Object.create(Pn.prototype)).constructor=ao,ao.prototype.type="Pattern",Pn.register(ao,"Pattern"),ao.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},ao.prototype.isInside=function(a){return this.box.containsPoint(a)},ao.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;if(this.image.src.length>0){var b=a.createPattern(this.image,this.repetition);a.fillStyle=b,a.fillRect(this.box.min.x,this.box.min.y,p,y)}},ao.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r.repetition=this.repetition,r},ao.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image,this.repetition=a.repetition},(Ta.prototype=Object.create(rs.prototype)).constructor=Ta,Ta.prototype.type="MultiLineText",Pn.register(Ta,"MultiLineText"),Ta.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline;for(var p=this.lineHeight||Number.parseFloat(this.font),y=this.text.split("\n"),b=0,R=0;R<y.length;R++){var O=y[R],T=a.measureText(O),U=[];if(null!==this.maxWidth&&T.width>this.maxWidth)for(;O.length>0;){for(var ee="",ie=a.measureText(ee+O[0]);ie.width<this.maxWidth&&O.length>0;)ee+=O[0],O=O.substr(1),ie=a.measureText(ee+O[0]);U.push(ee)}else U=[O];for(var ne=0;ne<U.length;ne++)null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(U[ne],this.position.x,this.position.y+b)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeText(U[ne],this.position.x,this.position.y+b)),b+=p}},Ta.prototype.serialize=function(a){var r=rs.prototype.serialize.call(this,a);return r.maxWidth=this.maxWidth,r.lineHeight=this.lineHeight,r},Ta.prototype.parse=function(a,r){rs.prototype.parse.call(this,a,r),this.maxWidth=a.maxWidth,this.lineHeight=a.lineHeight},(xl.prototype=Object.create(qo.prototype)).constructor=xl,xl.prototype.type="BezierCurve",Pn.register(xl,"BezierCurve"),xl.curveHelper=function(a){var r=new ho;r.radius=3,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(b,R,O){Pn.prototype.onPointerDrag.call(this,b,R,O),a.fromCp.copy(r.position)},a.parent.add(r);var h=new qo;h.from=a.from,h.to=a.fromCp,a.parent.add(h);var p=new ho;p.radius=3,p.layer=a.layer+1,p.draggable=!0,p.onPointerDrag=function(b,R,O){Pn.prototype.onPointerDrag.call(this,b,R,O),a.toCp.copy(p.position)},a.parent.add(p);var y=new qo;y.from=a.to,y.to=a.toCp,a.parent.add(y)},xl.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.bezierCurveTo(this.fromCp.x,this.fromCp.y,this.toCp.x,this.toCp.y,this.to.x,this.to.y),a.stroke()},xl.prototype.serialize=function(a){var r=qo.prototype.serialize.call(this,a);return r.fromCp=this.fromCp.toArray(),r.toCp=this.toCp.toArray(),r},xl.prototype.parse=function(a,r){qo.prototype.parse.call(this,a,r),this.fromCp.fromArray(a.fromCp),this.toCp.fromArray(a.toCp)},(uu.prototype=Object.create(qo.prototype)).constructor=uu,uu.prototype.type="QuadraticCurve",Pn.register(uu,"QuadraticCurve"),uu.curveHelper=function(a){var r=new qo;r.from=a.from,r.to=a.controlPoint,a.parent.add(r);var h=new ho;h.radius=3,h.layer=a.layer+1,h.draggable=!0,h.position=a.controlPoint,h.onPointerDrag=function(y,b,R){Pn.prototype.onPointerDrag.call(this,y,b,R),a.controlPoint.copy(h.position)},a.parent.add(h);var p=new qo;p.from=a.to,p.to=a.controlPoint,a.parent.add(p)},uu.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.to.x,this.to.y),a.stroke()},uu.prototype.serialize=function(a){var r=qo.prototype.serialize.call(this,a);return r.controlPoint=this.controlPoint.toArray(),r},uu.prototype.parse=function(a,r){qo.prototype.parse.call(this,a,r),this.controlPoint.fromArray(a.controlPoint)},(za.prototype=Object.create(ws.prototype)).constructor=za,za.prototype.type="RoundedBox",Pn.register(za,"RoundedBox"),za.roundRect=function(a,r,h,p,y,b){a.beginPath(),a.moveTo(r+b,h),a.lineTo(r+p-b,h),a.quadraticCurveTo(r+p,h,r+p,h+b),a.lineTo(r+p,h+y-b),a.quadraticCurveTo(r+p,h+y,r+p-b,h+y),a.lineTo(r+b,h+y),a.quadraticCurveTo(r,h+y,r,h+y-b),a.lineTo(r,h+b),a.quadraticCurveTo(r,h,r+b,h),a.closePath()},za.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),za.roundRect(a,this.box.min.x,this.box.min.y,p,y,this.radius),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),za.roundRect(a,this.box.min.x,this.box.min.y,p,y,this.radius),a.stroke())},za.prototype.serialize=function(a){var r=ws.prototype.serialize.call(this,a);return r.radius=this.radius,r},za.prototype.parse=function(a,r){ws.prototype.parse.call(this,a,r),this.radius=a.radius},(as.prototype=Object.create(Pn.prototype)).constructor=as,as.prototype.type="Graph",Pn.register(as,"Graph"),as.prototype.isInside=function(a){return this.box.containsPoint(a)},as.prototype.draw=function(a,r,h){if(0!==this.data.length){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.beginPath();var b=p/(this.data.length-1),R=this.max-this.min;a.moveTo(this.box.min.x,this.box.max.y-(this.data[0]-this.min)/R*y);for(var O=1,T=b;O<this.data.length;T+=b,O++)a.lineTo(this.box.min.x+T,this.box.max.y-(this.data[O]-this.min)/R*y);a.stroke(),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.lineTo(this.box.max.x,this.box.max.y),a.lineTo(this.box.min.x,this.box.max.y),a.fill())}},as.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.min=this.min,r.max=this.max,r.data=this.data,r},as.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.min=a.min,this.max=a.max,this.data=a.data},(wl.prototype=Object.create(so.prototype)).addColorStop=function(a,r){this.colors.push(new Kp(a,r))},wl.prototype.serialize=function(){return{colors:this.colors}},wl.prototype.parse=function(a){for(var r=[],h=0;h<a.colors.length;h++)r.push(new Kp(a.colors[h].offset,a.colors[h].color));this.colors=r},Gl.prototype=Object.create(wl.prototype),so.register(Gl,"LinearGradient"),Gl.prototype.get=function(a){for(var r=a.createLinearGradient(this.start.x,this.start.y,this.end.x,this.end.y),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},Gl.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"LinearGradient",start:this.start.toArray(),end:this.end.toArray()}),a},Gl.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end)},(Uu.prototype=Object.create(Pn.prototype)).constructor=Uu,Uu.prototype.type="Gauge",Pn.register(Uu,"Gauge"),Uu.prototype.isInside=function(a){return a.length()<=this.radius},Uu.prototype.draw=function(a,r,h){var p=this.value/(this.max-this.min),y=[this.startAngle,this.endAngle],b=y[0]+(y[1]-y[0])*p,R=[0,0];a.lineWidth=this.lineWidth,a.lineCap="round",a.strokeStyle=this.baseStyle.get(a),a.beginPath(),a.arc(R[0],R[1],this.radius,y[0],y[1]),a.stroke();var O=a.createLinearGradient(-this.radius,0,this.radius,0);if(a.strokeStyle=this.barStyle.get(a),a.lineWidth=this.lineWidth,a.beginPath(),a.arc(R[0],R[1],this.radius,y[0],b),a.stroke(),this.dial){var T=(this.startAngle-this.endAngle)*p,U=[Math.cos(T)*this.radius,Math.sin(T)*this.radius];U[0]=U[0]-R[0],U[1]=U[1]-R[1],a.fillStyle="#FFFFFF",a.beginPath(),a.arc(U[0],U[1],this.lineWidth/2,0,2*Math.PI),a.fill(),a.fillStyle=O,a.beginPath(),a.arc(U[0],U[1],this.lineWidth/3,0,2*Math.PI),a.fill()}},Uu.prototype.serialize=function(a){return Pn.prototype.serialize.call(this,a)},Uu.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r)},po.prototype=Object.create(so.prototype),so.register(po,"Pattern"),po.prototype.setTransform=function(a){this.matrix.m=a,this.needsUpdate=!0},po.prototype.get=function(a){return(this.needsUpdate||null===this.cache)&&(this.cache=a.createPattern(this.source,this.repetition),this.cache.setTransform(this.matrix.cssTransform()),this.needsUpdate=!1),this.cache},po.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"Pattern",matrix:this.matrix.m,repetition:this.repetition,source:this.source}),a},po.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.matrix=new Oi(a.matrix),this.repetition=a.repetition,this.source=a.source},dh.prototype=Object.create(wl.prototype),so.register(dh,"RadialGradient"),dh.prototype.get=function(a){for(var r=a.createRadialGradient(this.start.x,this.start.y,this.startRadius,this.end.x,this.end.y,this.endRadius),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},dh.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"RadialGradient",start:this.start.toArray(),end:this.end.toArray(),startRadius:this.startRadius,endRadius:this.endRadius}),a},dh.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end),this.startRadius=a.startRadius,this.endRadius=a.endRadius},(hu.prototype=Object.create(Pn.prototype)).constructor=hu,hu.prototype.type="NodeGraph",Pn.register(hu,"NodeGraph"),hu.prototype.addNode=function(a){for(var r=0,h=0,p=0;p<this.children.length;p++)this.children[p].position.x>r&&(r=this.children[p].position.x),this.children[p].position.y>h&&(h=this.children[p].position.y);return a.position.set(r+200,h/2),this.add(a),null!==a.registerSockets&&a.registerSockets(),a},(ls.prototype=Object.create(xl.prototype)).constructor=ls,ls.prototype.type="NodeConnector",Pn.register(ls,"NodeConnector"),ls.prototype.destroy=function(){xl.prototype.destroy.call(this),null!==this.outputSocket&&(this.outputSocket.removeConnector(this),this.outputSocket=null),null!==this.inputSocket&&(this.inputSocket.removeConnector(this),this.inputSocket=null)},ls.prototype.onUpdate=function(){null!==this.outputSocket&&this.from.copy(this.outputSocket.position),null!==this.inputSocket&&this.to.copy(this.inputSocket.position),this.fromCp.copy(this.from),this.fromCp.add(this.to),this.fromCp.multiplyScalar(.5),this.toCp.copy(this.fromCp);var a=.5,r=this.to.y-this.from.y,h=this.to.x-this.from.x;Math.abs(h)>Math.abs(r)?(this.toCp.x+=h*a,this.fromCp.x-=h*a):(this.toCp.y+=r*a,this.fromCp.y-=r*a)},ls.prototype.serialize=function(a){var r=xl.prototype.serialize.call(this,a);return r.outputSocket=null!==this.outputSocket?this.outputSocket.uuid:null,r.inputSocket=null!==this.inputSocket?this.inputSocket.uuid:null,r},ls.prototype.parse=function(a,r){xl.prototype.parse.call(this,a,r),null!==a.outputSocket&&(this.outputSocket=r.getChildByUUID(a.outputSocket)),null!==a.inputSocket&&(this.inputSocket=r.getChildByUUID(a.inputSocket))},(Hi.prototype=Object.create(ho.prototype)).constructor=Hi,Hi.prototype.type="NodeSocket",Pn.register(Hi,"NodeSocket"),Hi.INPUT=1,Hi.OUTPUT=2,Hi.prototype.getValue=function(){return this.direction===Hi.INPUT&&this.connectors.length>0&&null!==this.connectors[0].outputSocket?this.connectors[0].outputSocket.getValue():null},Hi.prototype.connectTo=function(a){if(!this.isCompatible(a))throw new Error("Sockets are not compatible they cannot be connected.");var r=new ls;return this.attachConnector(r),a.attachConnector(r),r},Hi.prototype.attachConnector=function(a){this.canAddConnector()||this.destroyConnectors(),this.direction===Hi.INPUT?a.inputSocket=this:this.direction===Hi.OUTPUT&&(a.outputSocket=this),this.connectors.push(a),null===a.parent&&this.parent.add(a)},Hi.prototype.isCompatible=function(a){return this.direction!==a.direction&&this.category===a.category},Hi.prototype.canAddConnector=function(){return!(this.connectors.length>0&&(this.direction===Hi.INPUT||this.direction===Hi.OUTPUT&&!this.multiple))},Hi.prototype.canConnect=function(a){return this.isCompatible(a)&&this.canAddConnector()},Hi.prototype.removeConnector=function(a){var r=this.connectors.indexOf(a);-1!==r&&(this.connectors.splice(r,1),a.destroy())},Hi.prototype.destroyConnectors=function(){for(var a=0;a<this.connectors.length;a++)this.connectors[a].destroy()},Hi.prototype.destroy=function(){ho.prototype.destroy.call(this),this.destroyConnectors()},Hi.prototype.onPointerDragStart=function(a,r){this.creatingConnection=!0,this.attachConnector(new ls)},Hi.prototype.onPointerDrag=function(a,r,h,p){this.creatingConnection&&(this.direction===Hi.INPUT?this.connectors[this.connectors.length-1].from.copy(p):this.direction===Hi.OUTPUT&&this.connectors[this.connectors.length-1].to.copy(p))},Hi.prototype.onPointerDragEnd=function(a,r){if(this.creatingConnection){for(var h=r.inverseMatrix.transformPoint(a.position),p=this.parent.getWorldPointIntersections(h),y=!1,b=0;b<p.length;b++)if(p[b]instanceof Hi&&this.isCompatible(p[b])){p[b].attachConnector(this.connectors[this.connectors.length-1]),y=!0;break}y||this.connectors[this.connectors.length-1].destroy()}this.creatingConnection=!1},Hi.prototype.serialize=function(a){var r=ho.prototype.serialize.call(this,a);r.name=this.name,r.category=this.category,r.multiple=this.multiple,r.direction=this.direction,r.node=this.node.uuid,r.connectors=[];for(var h=0;h<this.connectors.length;h++)r.connectors.push(this.connectors[h].uuid);return r},Hi.prototype.parse=function(a,r){ho.prototype.parse.call(this,a,r),this.name=a.name,this.category=a.category,this.multiple=a.multiple,this.direction=a.direction,this.node=r.getChildByUUID(a.node);for(var h=0;h<a.connectors.length;h++)this.connectors.push(r.getChildByUUID(a.connectors[h]))},(Ss.prototype=Object.create(za.prototype)).constructor=Ss,Ss.prototype.type="Node",Pn.register(Ss,"Node"),Ss.prototype.registerSockets=null,Ss.prototype.addInput=function(a,r){var h=new Hi(this,Hi.INPUT,a,r);return this.inputs.push(h),this.parent.add(h),h},Ss.prototype.addOutput=function(a,r){var h=new Hi(this,Hi.OUTPUT,a,r);return this.outputs.push(h),this.parent.add(h),h},Ss.prototype.getOutput=function(a){for(var r=0;r<this.outputs.length;r++)if(this.outputs[r].name===a)return this.outputs[r];return null},Ss.prototype.getInput=function(a){for(var r=0;r<this.inputs.length;r++)if(this.inputs[r].name===a)return this.inputs[r];return null},Ss.prototype.destroy=function(){za.prototype.destroy.call(this);for(var a=0;a<this.inputs.length;a++)this.inputs[a].destroy();for(a=0;a<this.outputs.length;a++)this.outputs[a].destroy()},Ss.prototype.onUpdate=function(){for(var a=this.box.max.y-this.box.min.y,r=a/(this.inputs.length+1),h=this.box.min.y+r,p=0;p<this.inputs.length;p++)this.inputs[p].position.set(this.position.x+this.box.min.x,this.position.y+(h+r*p));for(h=this.box.min.y+(r=a/(this.outputs.length+1)),p=0;p<this.outputs.length;p++)this.outputs[p].position.set(this.position.x+this.box.max.x,this.position.y+(h+r*p))},Ss.prototype.serialize=function(a){var r=za.prototype.serialize.call(this,a);r.inputs=[];for(var h=0;h<this.inputs.length;h++)r.inputs.push(this.inputs[h].uuid);for(r.outputs=[],h=0;h<this.outputs.length;h++)r.outputs.push(this.outputs[h].uuid);return r},Ss.prototype.parse=function(a,r){za.prototype.parse.call(this,a,r);for(var h=0;h<a.inputs.length;h++)this.inputs.push(r.getChildByUUID(a.inputs[h]));for(h=0;h<a.outputs.length;h++)this.outputs.push(r.getChildByUUID(a.outputs[h]))},Xd.rotateTool=function(a){var r=new ho;r.radius=4,r.layer=a.layer+1,r.onPointerDrag=function(h,p,y){a.rotation+=.001*y.x},a.add(r)},Xd.boxResizeTool=function(a){if(void 0!==a.box){var r=new ho;r.radius=4,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(R,O,T){Pn.prototype.onPointerDrag.call(this,R,O,T),a.box.min.copy(r.position),b()},a.add(r);var h=new ho;h.radius=4,h.layer=a.layer+1,h.draggable=!0,h.onPointerDrag=function(R,O,T){Pn.prototype.onPointerDrag.call(this,R,O,T),a.box.max.x=h.position.x,a.box.min.y=h.position.y,b()},a.add(h);var p=new ho;p.radius=4,p.layer=a.layer+1,p.draggable=!0,p.onPointerDrag=function(R,O,T){Pn.prototype.onPointerDrag.call(this,R,O,T),a.box.max.copy(p.position),b()},a.add(p);var y=new ho;y.radius=4,y.layer=a.layer+1,y.draggable=!0,y.onPointerDrag=function(R,O,T){Pn.prototype.onPointerDrag.call(this,R,O,T),a.box.min.x=y.position.x,a.box.max.y=y.position.y,b()},a.add(y),b()}else console.warn("escher.js: Helpers.boxResizeTool(), object box property missing.");function b(){r.position.copy(a.box.min),p.position.copy(a.box.max),h.position.set(a.box.max.x,a.box.min.y),y.position.set(a.box.min.x,a.box.max.y)}},Yd.read=function(a,r,h){var p=new XMLHttpRequest;p.overrideMimeType("text/plain"),p.open("GET",a,!0),void 0!==r&&(p.onload=function(){r(p.response)}),void 0!==h&&(p.onerror=h),p.send(null)},Yd.write=function(a,r){var h=new Blob([r],{type:"octet/stream"}),p=document.createElement("a");p.download=a,p.href=window.URL.createObjectURL(h),p.style.display="none",p.onclick=function(){document.body.removeChild(this)},document.body.appendChild(p),p.click()},Yd.select=function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",document.body.appendChild(h),void 0!==r&&(h.accept=r),h.onchange=function(p){void 0!==a&&a(h.files),document.body.removeChild(h)},h.click()},(Ti.prototype=Object.create(l.Group.prototype)).addNode=function(a){this.graph.addNode(a)},Ti.prototype.initialize=function(){l.Object3D.prototype.initialize.call(this)},Ti.prototype.update=function(a){l.Object3D.prototype.update.call(this,a)},Ti.prototype.dispose=function(){l.Object3D.prototype.dispose.call(this)},Ti.prototype.resize=function(a,r){},Ti.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.graph=this.graph.serialize(),r},Es.prototype.createWorkers=function(){for(var a=0;a<this.workers.length;a++)this.workers[a].terminate();var r=this;function h(y){var b=y.data.uuid;if(void 0===r.tasks[b])throw new Error("Unknown worker task "+b);r.tasks[b].callback(y.data.data),delete r.tasks[b]}for(this.workers=[],this.next=0,a=0;a<this.size;a++){var p=new Worker(this.file);p.onmessage=h,this.workers.push(p)}},Es.prototype.runTask=function(a,r){var h=new dc(a,r);this.tasks[h.uuid]=h,this.workers[this.next].postMessage({data:h.data,uuid:h.uuid}),this.next++,this.next>=this.workers.length&&(this.next=0)},ed.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=setTimeout(r,a.time))}()}},ed.prototype.stop=function(){this.running=!1,clearTimeout(self.id)},td.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},td.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},ja.set=function(a,r){"object"==typeof r?window.localStorage.setItem(a,JSON.stringify(r)):window.localStorage.setItem(a,r)},ja.get=function(a){var r=window.localStorage.getItem(a);try{return JSON.parse(r)}catch{return r}},ja.exists=function(a){return null!==window.localStorage.getItem(a)},ja.delete=function(a){return window.localStorage.removeItem(a)},pu.getRoot=function(a){for(var r=a;null!==r.parent;)r=r.parent;return r},pu.centerUnitary=function(a){var r=pu.calculateBoundingBox(a);if(null!==r){var h=new l.Vector3;r.getSize(h);var p=1/(h.x>h.y?h.x>h.z?h.x:h.z:h.y>h.z?h.y:h.z),y=new l.Vector3;r.getCenter(y),y.multiplyScalar(p),a.scale.set(p,p,p),a.position.set(-y.x,-p*r.min.y,-y.z)}},pu.calculateBoundingBox=function(a){var r=null;return a.traverse(function(h){var p=null;if(!0===h.isSprite){var y=new l.Vector3;h.getWorldPosition(y),p=new l.Box3(y.clone().subScalar(.5),y.clone().addScalar(.5))}else void 0!==h.geometry&&(h.geometry.computeBoundingBox(),(p=h.geometry.boundingBox.clone()).applyMatrix4(h.matrixWorld),h.geometry.computeBoundingBox(),p=h.geometry.boundingBox);null!==p&&(null===r?r=p:(p.min.x<r.min.x&&(r.min.x=p.min.x),p.max.x>r.max.x&&(r.max.x=p.max.x),p.min.y<r.min.y&&(r.min.y=p.min.y),p.max.y>r.max.y&&(r.max.y=p.max.y),p.min.z<r.min.z&&(r.min.z=p.min.z),p.max.z>r.max.z&&(r.max.z=p.max.z)))}),r},pu.centerGeometryOrigin=function(a){a.traverse(function(r){if(void 0!==r.geometry){r.geometry.computeBoundingBox();var h=r.geometry.boundingBox.clone().getCenter(new l.Vector3);r.position.add(h);var p=new l.Matrix4;p.makeTranslation(-h.x,-h.y,-h.z),r.geometry.applyMatrix4(p)}})},pu.convertToBufferGeometry=function(a){a.traverse(function(r){void 0!==r.geometry&&!0===r.geometry.isGeometry&&(r.geometry=(new l.BufferGeometry).fromGeometry(r.geometry))})};var sp=function(){var a,r,h,p,y=0,b=new l.Vector3;function R(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new ee,this.unassigned=new ee,this.vertices=[]}function O(){this.normal=new l.Vector3,this.midpoint=new l.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=y,this.edge=null}function T(ie,ne){this.vertex=ie,this.prev=null,this.next=null,this.twin=null,this.face=ne}function U(ie){this.point=ie,this.prev=null,this.next=null,this.face=null}function ee(){this.head=null,this.tail=null}return Object.assign(R.prototype,{setFromPoints:function(ie){!0!==Array.isArray(ie)&&console.error("THREE.ConvexHull: Points parameter is not an array."),ie.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var ne=0,ve=ie.length;ne<ve;ne++)this.vertices.push(new U(ie[ne]));return this.compute(),this},setFromObject:function(ie){var ne=[];return ie.updateMatrixWorld(!0),ie.traverse(function(ve){var be,Te,Le,Ie=ve.geometry;if(void 0!==Ie)if(Ie.isGeometry){var Oe=Ie.vertices;for(be=0,Te=Oe.length;be<Te;be++)(Le=Oe[be].clone()).applyMatrix4(ve.matrixWorld),ne.push(Le)}else if(Ie.isBufferGeometry){var Fe=Ie.attributes.position;if(void 0!==Fe)for(be=0,Te=Fe.count;be<Te;be++)(Le=new l.Vector3).fromBufferAttribute(Fe,be).applyMatrix4(ve.matrixWorld),ne.push(Le)}}),this.setFromPoints(ne)},containsPoint:function(ie){for(var ne=this.faces,ve=0,be=ne.length;ve<be;ve++)if(ne[ve].distanceToPoint(ie)>this.tolerance)return!1;return!0},intersectRay:function(ie,ne){for(var ve=this.faces,be=-1/0,Te=1/0,Le=0,Ie=ve.length;Le<Ie;Le++){var Oe=ve[Le],Fe=Oe.distanceToPoint(ie.origin),je=Oe.normal.dot(ie.direction);if(Fe>0&&je>=0)return null;var Ue=0!==je?-Fe/je:0;if(!(Ue<=0)&&(je>0?Te=Math.min(Ue,Te):be=Math.max(Ue,be),be>Te))return null}return ie.at(be!==-1/0?be:Te,ne),ne},intersectsRay:function(ie){return null!==this.intersectRay(ie,b)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(ie,ne){return ie.face=ne,null===ne.outside?this.assigned.append(ie):this.assigned.insertBefore(ne.outside,ie),ne.outside=ie,this},removeVertexFromFace:function(ie,ne){return ie===ne.outside&&(ne.outside=null!==ie.next&&ie.next.face===ne?ie.next:null),this.assigned.remove(ie),this},removeAllVerticesFromFace:function(ie){if(null!==ie.outside){for(var ne=ie.outside,ve=ie.outside;null!==ve.next&&ve.next.face===ie;)ve=ve.next;return this.assigned.removeSubList(ne,ve),ne.prev=ve.next=null,ie.outside=null,ne}},deleteFaceVertices:function(ie,ne){var ve=this.removeAllVerticesFromFace(ie);if(void 0!==ve)if(void 0===ne)this.unassigned.appendChain(ve);else{var be=ve;do{var Te=be.next;ne.distanceToPoint(be.point)>this.tolerance?this.addVertexToFace(be,ne):this.unassigned.append(be),be=Te}while(null!==be)}return this},resolveUnassignedPoints:function(ie){if(!1===this.unassigned.isEmpty()){var ne=this.unassigned.first();do{for(var ve=ne.next,be=this.tolerance,Te=null,Le=0;Le<ie.length;Le++){var Ie=ie[Le];if(Ie.mark===y){var Oe=Ie.distanceToPoint(ne.point);if(Oe>be&&(be=Oe,Te=Ie),be>1e3*this.tolerance)break}}null!==Te&&this.addVertexToFace(ne,Te),ne=ve}while(null!==ne)}return this},computeExtremes:function(){var ie,ne,ve,be=new l.Vector3,Te=new l.Vector3,Le=[],Ie=[];for(ie=0;ie<3;ie++)Le[ie]=Ie[ie]=this.vertices[0];for(be.copy(this.vertices[0].point),Te.copy(this.vertices[0].point),ie=0,ne=this.vertices.length;ie<ne;ie++){var Oe=this.vertices[ie],Fe=Oe.point;for(ve=0;ve<3;ve++)Fe.getComponent(ve)<be.getComponent(ve)&&(be.setComponent(ve,Fe.getComponent(ve)),Le[ve]=Oe);for(ve=0;ve<3;ve++)Fe.getComponent(ve)>Te.getComponent(ve)&&(Te.setComponent(ve,Fe.getComponent(ve)),Ie[ve]=Oe)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(be.x),Math.abs(Te.x))+Math.max(Math.abs(be.y),Math.abs(Te.y))+Math.max(Math.abs(be.z),Math.abs(Te.z))),{min:Le,max:Ie}},computeInitialHull:function(){void 0===a&&(a=new l.Line3,r=new l.Plane,h=new l.Vector3);var ie,ne,ve,be,Te,Le,Ie,Oe,Fe,je=this.vertices,Ue=this.computeExtremes(),Je=Ue.min,pt=Ue.max,at=0,Mt=0;for(Le=0;Le<3;Le++)(Fe=pt[Le].point.getComponent(Le)-Je[Le].point.getComponent(Le))>at&&(at=Fe,Mt=Le);for(at=0,a.set((ne=Je[Mt]).point,(ve=pt[Mt]).point),Le=0,Ie=this.vertices.length;Le<Ie;Le++)(ie=je[Le])!==ne&&ie!==ve&&(a.closestPointToPoint(ie.point,!0,h),(Fe=h.distanceToSquared(ie.point))>at&&(at=Fe,be=ie));for(at=-1,r.setFromCoplanarPoints(ne.point,ve.point,be.point),Le=0,Ie=this.vertices.length;Le<Ie;Le++)(ie=je[Le])!==ne&&ie!==ve&&ie!==be&&(Fe=Math.abs(r.distanceToPoint(ie.point)))>at&&(at=Fe,Te=ie);var Tt=[];if(r.distanceToPoint(Te.point)<0)for(Tt.push(O.create(ne,ve,be),O.create(Te,ve,ne),O.create(Te,be,ve),O.create(Te,ne,be)),Le=0;Le<3;Le++)Oe=(Le+1)%3,Tt[Le+1].getEdge(2).setTwin(Tt[0].getEdge(Oe)),Tt[Le+1].getEdge(1).setTwin(Tt[Oe+1].getEdge(0));else for(Tt.push(O.create(ne,be,ve),O.create(Te,ne,ve),O.create(Te,ve,be),O.create(Te,be,ne)),Le=0;Le<3;Le++)Oe=(Le+1)%3,Tt[Le+1].getEdge(2).setTwin(Tt[0].getEdge((3-Le)%3)),Tt[Le+1].getEdge(0).setTwin(Tt[Oe+1].getEdge(1));for(Le=0;Le<4;Le++)this.faces.push(Tt[Le]);for(Le=0,Ie=je.length;Le<Ie;Le++)if((ie=je[Le])!==ne&&ie!==ve&&ie!==be&&ie!==Te){at=this.tolerance;var Yt=null;for(Oe=0;Oe<4;Oe++)(Fe=this.faces[Oe].distanceToPoint(ie.point))>at&&(at=Fe,Yt=this.faces[Oe]);null!==Yt&&this.addVertexToFace(ie,Yt)}return this},reindexFaces:function(){for(var ie=[],ne=0;ne<this.faces.length;ne++){var ve=this.faces[ne];ve.mark===y&&ie.push(ve)}return this.faces=ie,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var ie,ne=0,ve=this.assigned.first().face,be=ve.outside;do{var Te=ve.distanceToPoint(be.point);Te>ne&&(ne=Te,ie=be),be=be.next}while(null!==be&&be.face===ve);return ie}},computeHorizon:function(ie,ne,ve,be){var Te;this.deleteFaceVertices(ve),ve.mark=1,Te=null===ne?ne=ve.getEdge(0):ne.next;do{var Le=Te.twin,Ie=Le.face;Ie.mark===y&&(Ie.distanceToPoint(ie)>this.tolerance?this.computeHorizon(ie,Le,Ie,be):be.push(Te)),Te=Te.next}while(Te!==ne);return this},addAdjoiningFace:function(ie,ne){var ve=O.create(ie,ne.tail(),ne.head());return this.faces.push(ve),ve.getEdge(-1).setTwin(ne.twin),ve.getEdge(0)},addNewFaces:function(ie,ne){this.newFaces=[];for(var ve=null,be=null,Te=0;Te<ne.length;Te++){var Ie=this.addAdjoiningFace(ie,ne[Te]);null===ve?ve=Ie:Ie.next.setTwin(be),this.newFaces.push(Ie.face),be=Ie}return ve.next.setTwin(be),this},addVertexToHull:function(ie){var ne=[];return this.unassigned.clear(),this.removeVertexFromFace(ie,ie.face),this.computeHorizon(ie.point,null,ie.face,ne),this.addNewFaces(ie,ne),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var ie;for(this.computeInitialHull();void 0!==(ie=this.nextVertexToAdd());)this.addVertexToHull(ie);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(O,{create:function(ie,ne,ve){var be=new O,Te=new T(ie,be),Le=new T(ne,be),Ie=new T(ve,be);return Te.next=Ie.prev=Le,Le.next=Te.prev=Ie,Ie.next=Le.prev=Te,be.edge=Te,be.compute()}}),Object.assign(O.prototype,{getEdge:function(ie){for(var ne=this.edge;ie>0;)ne=ne.next,ie--;for(;ie<0;)ne=ne.prev,ie++;return ne},compute:function(){void 0===p&&(p=new l.Triangle);var ie=this.edge.tail(),ne=this.edge.head(),ve=this.edge.next.head();return p.set(ie.point,ne.point,ve.point),p.getNormal(this.normal),p.getMidpoint(this.midpoint),this.area=p.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(ie){return this.normal.dot(ie)-this.constant}}),Object.assign(T.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var ie=this.head(),ne=this.tail();return null!==ne?ne.point.distanceTo(ie.point):-1},lengthSquared:function(){var ie=this.head(),ne=this.tail();return null!==ne?ne.point.distanceToSquared(ie.point):-1},setTwin:function(ie){return this.twin=ie,ie.twin=this,this}}),Object.assign(ee.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(ie,ne){return ne.prev=ie.prev,ne.next=ie,null===ne.prev?this.head=ne:ne.prev.next=ne,ie.prev=ne,this},insertAfter:function(ie,ne){return ne.prev=ie,ne.next=ie.next,null===ne.next?this.tail=ne:ne.next.prev=ne,ie.next=ne,this},append:function(ie){return null===this.head?this.head=ie:this.tail.next=ie,ie.prev=this.tail,ie.next=null,this.tail=ie,this},appendChain:function(ie){for(null===this.head?this.head=ie:this.tail.next=ie,ie.prev=this.tail;null!==ie.next;)ie=ie.next;return this.tail=ie,this},remove:function(ie){return null===ie.prev?this.head=ie.next:ie.prev.next=ie.next,null===ie.next?this.tail=ie.prev:ie.next.prev=ie.prev,this},removeSubList:function(ie,ne){return null===ie.prev?this.head=ne.next:ie.prev.next=ne.next,null===ne.next?this.tail=ie.prev:ne.next.prev=ie.prev,this},isEmpty:function(){return null===this.head}}),R}();function vi(){}function xr(){}vi.Type={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron"},vi.createShape=function(a,r){if(void 0!==r)return r===vi.Type.BOX?vi.createBoundingBoxShape(a):r===vi.Type.CYLINDER?vi.createBoundingCylinderShape(a):r===vi.Type.SPHERE?vi.createBoundingSphereShape(a):r===vi.Type.HULL?vi.createConvexPolyhedron(a):null;var h=vi.getGeometry(a);if(!h)return null;switch(h.type){case"BoxGeometry":case"BoxBufferGeometry":default:return vi.createBoxShape(h);case"CylinderGeometry":case"CylinderBufferGeometry":return vi.createCylinderShape(h);case"PlaneGeometry":case"PlaneBufferGeometry":return vi.createPlaneShape(h);case"SphereGeometry":case"SphereBufferGeometry":return vi.createSphereShape(h);case"TubeGeometry":return vi.createTubeShape(h);case"Geometry":case"BufferGeometry":return vi.createConvexPolyhedron(a)}},vi.createBoxShape=function(a){if(!vi.getVertices(a).length)return null;a.computeBoundingBox();var r=a.boundingBox;return new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},vi.createBoundingBoxShape=function(a){var r=new Box3;if(r.setFromObject(a),!isFinite(r.min.lengthSq()))return null;var h=new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2));return a.updateMatrixWorld(),(new l.Vector3).setFromMatrixPosition(a.matrixWorld),h},vi.createConvexPolyhedron=function(a){var r=new sp;r.setFromObject(a);for(var h=[],p=[],y=[],b=0;b<r.faces.length;b++){var R=r.faces[b],O=R.edge;do{var T=O.head().point;h.push(new M(T.x,T.y,T.z)),O=O.next}while(O!==R.edge);p.push([h.length-3,h.length-2,h.length-1]),y.push(new M(R.normal.x,R.normal.y,R.normal.z))}return new Q(h,p,y)},vi.createCylinderShape=function(a){var r=a.parameters,h=new Xt(r.radiusTop,r.radiusBottom,r.height,r.radialSegments);return h.orientation=new Y,h.orientation.setFromEuler(0,0,0,"XYZ").normalize(),h},vi.createBoundingCylinderShape=function(a){var r=["x","y","z"],h=r.splice(r.indexOf("y"),1)&&r,p=vi.getGeometry(a);p.computeBoundingBox(),p.computeBoundingSphere();var y=p.boundingBox.max.y-p.boundingBox.min.y,b=.5*Math.max(p.boundingBox.max[h[0]]-p.boundingBox.min[h[0]],p.boundingBox.max[h[1]]-p.boundingBox.min[h[1]]),R=new Xt(b,b,y,12);return R.orientation=new Y,R.orientation.setFromEuler(Math.PI/2,0,0,"XYZ").normalize(),R},vi.createPlaneShape=function(a){a.computeBoundingBox();var r=a.boundingBox;return new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},vi.createSphereShape=function(a){return new xc(a.parameters.radius)},vi.createBoundingSphereShape=function(a){var r=vi.getGeometry(a);return r.computeBoundingSphere(),new xc(r.boundingSphere.radius)},vi.createTubeShape=function(a){var r=new l.BufferGeometry;return r.fromGeometry(a),createTrimeshShape(r)},vi.createTrimeshShape=function(a){var r=vi.getVertices(a);if(!r||0===r.length)return null;var h=Object.keys(r).map(Number);return new pl(r,h)},vi.getGeometry=function(a){var r=vi.getMeshes(a);if(0===r.length)return null;var h=new l.Geometry;if(1===r.length){var p=new l.Vector3,y=new l.Quaternion,b=new l.Vector3(1,1,1);return h=r[0].geometry.clone(),r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(p,y,b),h.scale(b.x,b.y,b.z)}for(var R=new l.Geometry,O=r.pop();void 0!==O;)O.updateMatrixWorld(),O.geometry instanceof l.BufferGeometry?(h.fromBufferGeometry(O.geometry),R.merge(h,O.matrixWorld)):R.merge(O.geometry,O.matrixWorld),O=r.pop();var T=new l.Matrix4;return T.scale(a.scale),R.applyMatrix4(T),R},vi.getVertices=function(a){return a instanceof l.Geometry&&(a=(new l.BufferGeometry).fromGeometry(a)),a.attributes.position.array},vi.getMeshes=function(a){var r=[];return a.traverse(function(h){h instanceof l.Mesh&&r.push(h)}),r},xr.scales=new Map([["Y",1e24],["Z",1e21],["E",1e18],["P",1e15],["T",1e12],["G",1e9],["M",1e6],["k",1e3],["m",.001],["u",1e-6],["n",1e-9],["p",1e-12],["f",1e-15],["a",1e-18],["z",1e-21],["y",1e-24]]),xr.units=new Map([["m",new Map([["i",function(a){return a/39.3701}]])],["i",new Map([["m",function(a){return 39.3701*a}]])],["g",null],["s",null],["c",new Map([["k",function(a){return a-273.15}],["f",function(a){return(a-32)/1.8}]])],["k",new Map([["c",function(a){return a+273.15}],["f",function(a){return(a-32)/1.8+273.15}]])],["f",new Map([["c",function(a){return 1.8*a+32}],["k",function(a){return 1.8*a-459.67}]])],["d",new Map([["r",function(a){return a*(180/Math.PI)}]])],["r",new Map([["d",function(a){return a/(180/Math.PI)}]])]]),xr.convert=function(a,r,h){r.length>1&&(a*=xr.scales.get(r.charAt(0)),r=r.slice(1));var p=1;return h.length>1&&(p=xr.scales.get(h.charAt(0)),h=h.slice(1)),r===h?a/p:xr.units.get(h).get(r)(a)/p}})(),__webpack_exports__})()),function(n,o){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?o(n,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return o(l)}:o(n)}(typeof window<"u"?window:this,function(n,o){"use strict";var l=[],x=Object.getPrototypeOf,L=l.slice,D=l.flat?function(W){return l.flat.call(W)}:function(W){return l.concat.apply([],W)},z=l.push,M=l.indexOf,P={},de=P.toString,ye=P.hasOwnProperty,he=ye.toString,ae=he.call(Object),fe={},le=function(pe){return"function"==typeof pe&&"number"!=typeof pe.nodeType},q=function(pe){return null!=pe&&pe===pe.window},Y=n.document,A={type:!0,src:!0,nonce:!0,noModule:!0};function N(W,pe,Me){var Ne,Ve,qe=(Me=Me||Y).createElement("script");if(qe.text=W,pe)for(Ne in A)(Ve=pe[Ne]||pe.getAttribute&&pe.getAttribute(Ne))&&qe.setAttribute(Ne,Ve);Me.head.appendChild(qe).parentNode.removeChild(qe)}function X(W){return null==W?W+"":"object"==typeof W||"function"==typeof W?P[de.call(W)]||"object":typeof W}var H=function(W,pe){return new H.fn.init(W,pe)};function Ce(W){var pe=!!W&&"length"in W&&W.length,Me=X(W);return!le(W)&&!q(W)&&("array"===Me||0===pe||"number"==typeof pe&&pe>0&&pe-1 in W)}H.fn=H.prototype={jquery:"3.5.1",constructor:H,length:0,toArray:function(){return L.call(this)},get:function(W){return null==W?L.call(this):W<0?this[W+this.length]:this[W]},pushStack:function(W){var pe=H.merge(this.constructor(),W);return pe.prevObject=this,pe},each:function(W){return H.each(this,W)},map:function(W){return this.pushStack(H.map(this,function(pe,Me){return W.call(pe,Me,pe)}))},slice:function(){return this.pushStack(L.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(H.grep(this,function(W,pe){return(pe+1)%2}))},odd:function(){return this.pushStack(H.grep(this,function(W,pe){return pe%2}))},eq:function(W){var pe=this.length,Me=+W+(W<0?pe:0);return this.pushStack(Me>=0&&Me<pe?[this[Me]]:[])},end:function(){return this.prevObject||this.constructor()},push:z,sort:l.sort,splice:l.splice},H.extend=H.fn.extend=function(){var W,pe,Me,Ne,Ve,qe,et=arguments[0]||{},At=1,Bt=arguments.length,Xt=!1;for("boolean"==typeof et&&(Xt=et,et=arguments[At]||{},At++),"object"!=typeof et&&!le(et)&&(et={}),At===Bt&&(et=this,At--);At<Bt;At++)if(null!=(W=arguments[At]))for(pe in W)Ne=W[pe],"__proto__"!==pe&&et!==Ne&&(Xt&&Ne&&(H.isPlainObject(Ne)||(Ve=Array.isArray(Ne)))?(Me=et[pe],qe=Ve&&!Array.isArray(Me)?[]:Ve||H.isPlainObject(Me)?Me:{},Ve=!1,et[pe]=H.extend(Xt,qe,Ne)):void 0!==Ne&&(et[pe]=Ne));return et},H.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(W){throw new Error(W)},noop:function(){},isPlainObject:function(W){var pe,Me;return!(!W||"[object Object]"!==de.call(W)||(pe=x(W))&&("function"!=typeof(Me=ye.call(pe,"constructor")&&pe.constructor)||he.call(Me)!==ae))},isEmptyObject:function(W){var pe;for(pe in W)return!1;return!0},globalEval:function(W,pe,Me){N(W,{nonce:pe&&pe.nonce},Me)},each:function(W,pe){var Me,Ne=0;if(Ce(W))for(Me=W.length;Ne<Me&&!1!==pe.call(W[Ne],Ne,W[Ne]);Ne++);else for(Ne in W)if(!1===pe.call(W[Ne],Ne,W[Ne]))break;return W},makeArray:function(W,pe){var Me=pe||[];return null!=W&&(Ce(Object(W))?H.merge(Me,"string"==typeof W?[W]:W):z.call(Me,W)),Me},inArray:function(W,pe,Me){return null==pe?-1:M.call(pe,W,Me)},merge:function(W,pe){for(var Me=+pe.length,Ne=0,Ve=W.length;Ne<Me;Ne++)W[Ve++]=pe[Ne];return W.length=Ve,W},grep:function(W,pe,Me){for(var Ve=[],qe=0,et=W.length,At=!Me;qe<et;qe++)!pe(W[qe],qe)!==At&&Ve.push(W[qe]);return Ve},map:function(W,pe,Me){var Ne,Ve,qe=0,et=[];if(Ce(W))for(Ne=W.length;qe<Ne;qe++)null!=(Ve=pe(W[qe],qe,Me))&&et.push(Ve);else for(qe in W)null!=(Ve=pe(W[qe],qe,Me))&&et.push(Ve);return D(et)},guid:1,support:fe}),"function"==typeof Symbol&&(H.fn[Symbol.iterator]=l[Symbol.iterator]),H.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(W,pe){P["[object "+pe+"]"]=pe.toLowerCase()});var Q=
/*!
     * Sizzle CSS Selector Engine v2.3.5
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2020-03-14
     */function(W){var pe,Me,Ne,Ve,qe,et,At,Bt,Xt,pn,Fn,on,xn,Er,ti,Ar,fs,es,da,bi="sizzle"+1*new Date,Br=W.document,Xa=0,Wi=0,qi=Ya(),qh=Ya(),wc=Ya(),fa=Ya(),pl=function(it,xt){return it===xt&&(Fn=!0),0},ma={}.hasOwnProperty,Ri=[],Ds=Ri.pop,tr=Ri.push,wn=Ri.push,Ho=Ri.slice,ss=function(it,xt){for(var Ut=0,yn=it.length;Ut<yn;Ut++)if(it[Ut]===xt)return Ut;return-1},Qi="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Hr="[\\x20\\t\\r\\n\\f]",di="(?:\\\\[\\da-fA-F]{1,6}"+Hr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",xi="\\["+Hr+"*("+di+")(?:"+Hr+"*([*^$|!~]?=)"+Hr+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+di+"))|)"+Hr+"*\\]",Us=":("+di+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+xi+")*)|.*)\\)|)",Xh=new RegExp(Hr+"+","g"),yo=new RegExp("^"+Hr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Hr+"+$","g"),yu=new RegExp("^"+Hr+"*,"+Hr+"*"),zn=new RegExp("^"+Hr+"*([>+~]|"+Hr+")"+Hr+"*"),lt=new RegExp(Hr+"|>"),$l=new RegExp(Us),As=new RegExp("^"+di+"$"),Tp={ID:new RegExp("^#("+di+")"),CLASS:new RegExp("^\\.("+di+")"),TAG:new RegExp("^("+di+"|[*])"),ATTR:new RegExp("^"+xi),PSEUDO:new RegExp("^"+Us),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Hr+"*(even|odd|(([+-]|)(\\d*)n|)"+Hr+"*(?:([+-]|)"+Hr+"*(\\d+)|))"+Hr+"*\\)|)","i"),bool:new RegExp("^(?:"+Qi+")$","i"),needsContext:new RegExp("^"+Hr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Hr+"*((?:-\\d)?\\d*)"+Hr+"*\\)|)(?=[^-]|$)","i")},$s=/HTML$/i,Sc=/^(?:input|select|textarea|button)$/i,Di=/^h\d$/i,io=/^[^{]+\{\s*\[native \w/,ri=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Jc=/[+~]/,$i=new RegExp("\\\\[\\da-fA-F]{1,6}"+Hr+"?|\\\\([^\\r\\n\\f])","g"),ht=function(it,xt){var Ut="0x"+it.slice(1)-65536;return xt||(Ut<0?String.fromCharCode(Ut+65536):String.fromCharCode(Ut>>10|55296,1023&Ut|56320))},bu=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Mp=function(it,xt){return xt?"\0"===it?"\ufffd":it.slice(0,-1)+"\\"+it.charCodeAt(it.length-1).toString(16)+" ":"\\"+it},Ui=function(){on()},kr=Ba(function(it){return!0===it.disabled&&"fieldset"===it.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{wn.apply(Ri=Ho.call(Br.childNodes),Br.childNodes)}catch{wn={apply:Ri.length?function(xt,Ut){tr.apply(xt,Ho.call(Ut))}:function(xt,Ut){for(var yn=xt.length,qt=0;xt[yn++]=Ut[qt++];);xt.length=yn-1}}}function qr(it,xt,Ut,yn){var qt,fn,tn,qn,Gn,Sr,$r,yr=xt&&xt.ownerDocument,Xr=xt?xt.nodeType:9;if(Ut=Ut||[],"string"!=typeof it||!it||1!==Xr&&9!==Xr&&11!==Xr)return Ut;if(!yn&&(on(xt),xt=xt||xn,ti)){if(11!==Xr&&(Gn=ri.exec(it)))if(qt=Gn[1]){if(9===Xr){if(!(tn=xt.getElementById(qt)))return Ut;if(tn.id===qt)return Ut.push(tn),Ut}else if(yr&&(tn=yr.getElementById(qt))&&da(xt,tn)&&tn.id===qt)return Ut.push(tn),Ut}else{if(Gn[2])return wn.apply(Ut,xt.getElementsByTagName(it)),Ut;if((qt=Gn[3])&&Me.getElementsByClassName&&xt.getElementsByClassName)return wn.apply(Ut,xt.getElementsByClassName(qt)),Ut}if(Me.qsa&&!fa[it+" "]&&(!Ar||!Ar.test(it))&&(1!==Xr||"object"!==xt.nodeName.toLowerCase())){if($r=it,yr=xt,1===Xr&&(lt.test(it)||zn.test(it))){for(((yr=Jc.test(it)&&Kn(xt.parentNode)||xt)!==xt||!Me.scope)&&((qn=xt.getAttribute("id"))?qn=qn.replace(bu,Mp):xt.setAttribute("id",qn=bi)),fn=(Sr=et(it)).length;fn--;)Sr[fn]=(qn?"#"+qn:":scope")+" "+Ja(Sr[fn]);$r=Sr.join(",")}try{return wn.apply(Ut,yr.querySelectorAll($r)),Ut}catch{fa(it,!0)}finally{qn===bi&&xt.removeAttribute("id")}}}return Bt(it.replace(yo,"$1"),xt,Ut,yn)}function Ya(){var it=[];return function xt(Ut,yn){return it.push(Ut+" ")>Ne.cacheLength&&delete xt[it.shift()],xt[Ut+" "]=yn}}function bo(it){return it[bi]=!0,it}function _a(it){var xt=xn.createElement("fieldset");try{return!!it(xt)}catch{return!1}finally{xt.parentNode&&xt.parentNode.removeChild(xt),xt=null}}function xu(it,xt){for(var Ut=it.split("|"),yn=Ut.length;yn--;)Ne.attrHandle[Ut[yn]]=xt}function Ec(it,xt){var Ut=xt&&it,yn=Ut&&1===it.nodeType&&1===xt.nodeType&&it.sourceIndex-xt.sourceIndex;if(yn)return yn;if(Ut)for(;Ut=Ut.nextSibling;)if(Ut===xt)return-1;return it?1:-1}function Zc(it){return function(xt){return"input"===xt.nodeName.toLowerCase()&&xt.type===it}}function wu(it){return function(xt){var Ut=xt.nodeName.toLowerCase();return("input"===Ut||"button"===Ut)&&xt.type===it}}function Sh(it){return function(xt){return"form"in xt?xt.parentNode&&!1===xt.disabled?"label"in xt?"label"in xt.parentNode?xt.parentNode.disabled===it:xt.disabled===it:xt.isDisabled===it||xt.isDisabled!==!it&&kr(xt)===it:xt.disabled===it:"label"in xt&&xt.disabled===it}}function Tc(it){return bo(function(xt){return xt=+xt,bo(function(Ut,yn){for(var qt,fn=it([],Ut.length,xt),tn=fn.length;tn--;)Ut[qt=fn[tn]]&&(Ut[qt]=!(yn[qt]=Ut[qt]))})})}function Kn(it){return it&&typeof it.getElementsByTagName<"u"&&it}for(pe in Me=qr.support={},qe=qr.isXML=function(it){var Ut=(it.ownerDocument||it).documentElement;return!$s.test(it.namespaceURI||Ut&&Ut.nodeName||"HTML")},on=qr.setDocument=function(it){var xt,Ut,yn=it?it.ownerDocument||it:Br;return yn==xn||9!==yn.nodeType||!yn.documentElement||(Er=(xn=yn).documentElement,ti=!qe(xn),Br!=xn&&(Ut=xn.defaultView)&&Ut.top!==Ut&&(Ut.addEventListener?Ut.addEventListener("unload",Ui,!1):Ut.attachEvent&&Ut.attachEvent("onunload",Ui)),Me.scope=_a(function(qt){return Er.appendChild(qt).appendChild(xn.createElement("div")),typeof qt.querySelectorAll<"u"&&!qt.querySelectorAll(":scope fieldset div").length}),Me.attributes=_a(function(qt){return qt.className="i",!qt.getAttribute("className")}),Me.getElementsByTagName=_a(function(qt){return qt.appendChild(xn.createComment("")),!qt.getElementsByTagName("*").length}),Me.getElementsByClassName=io.test(xn.getElementsByClassName),Me.getById=_a(function(qt){return Er.appendChild(qt).id=bi,!xn.getElementsByName||!xn.getElementsByName(bi).length}),Me.getById?(Ne.filter.ID=function(qt){var fn=qt.replace($i,ht);return function(tn){return tn.getAttribute("id")===fn}},Ne.find.ID=function(qt,fn){if(typeof fn.getElementById<"u"&&ti){var tn=fn.getElementById(qt);return tn?[tn]:[]}}):(Ne.filter.ID=function(qt){var fn=qt.replace($i,ht);return function(tn){var qn=typeof tn.getAttributeNode<"u"&&tn.getAttributeNode("id");return qn&&qn.value===fn}},Ne.find.ID=function(qt,fn){if(typeof fn.getElementById<"u"&&ti){var tn,qn,Gn,Sr=fn.getElementById(qt);if(Sr){if((tn=Sr.getAttributeNode("id"))&&tn.value===qt)return[Sr];for(Gn=fn.getElementsByName(qt),qn=0;Sr=Gn[qn++];)if((tn=Sr.getAttributeNode("id"))&&tn.value===qt)return[Sr]}return[]}}),Ne.find.TAG=Me.getElementsByTagName?function(qt,fn){return typeof fn.getElementsByTagName<"u"?fn.getElementsByTagName(qt):Me.qsa?fn.querySelectorAll(qt):void 0}:function(qt,fn){var tn,qn=[],Gn=0,Sr=fn.getElementsByTagName(qt);if("*"===qt){for(;tn=Sr[Gn++];)1===tn.nodeType&&qn.push(tn);return qn}return Sr},Ne.find.CLASS=Me.getElementsByClassName&&function(qt,fn){if(typeof fn.getElementsByClassName<"u"&&ti)return fn.getElementsByClassName(qt)},fs=[],Ar=[],(Me.qsa=io.test(xn.querySelectorAll))&&(_a(function(qt){var fn;Er.appendChild(qt).innerHTML="<a id='"+bi+"'></a><select id='"+bi+"-\r\\' msallowcapture=''><option selected=''></option></select>",qt.querySelectorAll("[msallowcapture^='']").length&&Ar.push("[*^$]="+Hr+"*(?:''|\"\")"),qt.querySelectorAll("[selected]").length||Ar.push("\\["+Hr+"*(?:value|"+Qi+")"),qt.querySelectorAll("[id~="+bi+"-]").length||Ar.push("~="),(fn=xn.createElement("input")).setAttribute("name",""),qt.appendChild(fn),qt.querySelectorAll("[name='']").length||Ar.push("\\["+Hr+"*name"+Hr+"*="+Hr+"*(?:''|\"\")"),qt.querySelectorAll(":checked").length||Ar.push(":checked"),qt.querySelectorAll("a#"+bi+"+*").length||Ar.push(".#.+[+~]"),qt.querySelectorAll("\\\f"),Ar.push("[\\r\\n\\f]")}),_a(function(qt){qt.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var fn=xn.createElement("input");fn.setAttribute("type","hidden"),qt.appendChild(fn).setAttribute("name","D"),qt.querySelectorAll("[name=d]").length&&Ar.push("name"+Hr+"*[*^$|!~]?="),2!==qt.querySelectorAll(":enabled").length&&Ar.push(":enabled",":disabled"),Er.appendChild(qt).disabled=!0,2!==qt.querySelectorAll(":disabled").length&&Ar.push(":enabled",":disabled"),qt.querySelectorAll("*,:x"),Ar.push(",.*:")})),(Me.matchesSelector=io.test(es=Er.matches||Er.webkitMatchesSelector||Er.mozMatchesSelector||Er.oMatchesSelector||Er.msMatchesSelector))&&_a(function(qt){Me.disconnectedMatch=es.call(qt,"*"),es.call(qt,"[s!='']:x"),fs.push("!=",Us)}),Ar=Ar.length&&new RegExp(Ar.join("|")),fs=fs.length&&new RegExp(fs.join("|")),xt=io.test(Er.compareDocumentPosition),da=xt||io.test(Er.contains)?function(qt,fn){var tn=9===qt.nodeType?qt.documentElement:qt,qn=fn&&fn.parentNode;return qt===qn||!(!qn||1!==qn.nodeType||!(tn.contains?tn.contains(qn):qt.compareDocumentPosition&&16&qt.compareDocumentPosition(qn)))}:function(qt,fn){if(fn)for(;fn=fn.parentNode;)if(fn===qt)return!0;return!1},pl=xt?function(qt,fn){if(qt===fn)return Fn=!0,0;var tn=!qt.compareDocumentPosition-!fn.compareDocumentPosition;return tn||(1&(tn=(qt.ownerDocument||qt)==(fn.ownerDocument||fn)?qt.compareDocumentPosition(fn):1)||!Me.sortDetached&&fn.compareDocumentPosition(qt)===tn?qt==xn||qt.ownerDocument==Br&&da(Br,qt)?-1:fn==xn||fn.ownerDocument==Br&&da(Br,fn)?1:pn?ss(pn,qt)-ss(pn,fn):0:4&tn?-1:1)}:function(qt,fn){if(qt===fn)return Fn=!0,0;var tn,qn=0,Gn=qt.parentNode,Sr=fn.parentNode,$r=[qt],yr=[fn];if(!Gn||!Sr)return qt==xn?-1:fn==xn?1:Gn?-1:Sr?1:pn?ss(pn,qt)-ss(pn,fn):0;if(Gn===Sr)return Ec(qt,fn);for(tn=qt;tn=tn.parentNode;)$r.unshift(tn);for(tn=fn;tn=tn.parentNode;)yr.unshift(tn);for(;$r[qn]===yr[qn];)qn++;return qn?Ec($r[qn],yr[qn]):$r[qn]==Br?-1:yr[qn]==Br?1:0}),xn},qr.matches=function(it,xt){return qr(it,null,null,xt)},qr.matchesSelector=function(it,xt){if(on(it),Me.matchesSelector&&ti&&!fa[xt+" "]&&(!fs||!fs.test(xt))&&(!Ar||!Ar.test(xt)))try{var Ut=es.call(it,xt);if(Ut||Me.disconnectedMatch||it.document&&11!==it.document.nodeType)return Ut}catch{fa(xt,!0)}return qr(xt,xn,null,[it]).length>0},qr.contains=function(it,xt){return(it.ownerDocument||it)!=xn&&on(it),da(it,xt)},qr.attr=function(it,xt){(it.ownerDocument||it)!=xn&&on(it);var Ut=Ne.attrHandle[xt.toLowerCase()],yn=Ut&&ma.call(Ne.attrHandle,xt.toLowerCase())?Ut(it,xt,!ti):void 0;return void 0!==yn?yn:Me.attributes||!ti?it.getAttribute(xt):(yn=it.getAttributeNode(xt))&&yn.specified?yn.value:null},qr.escape=function(it){return(it+"").replace(bu,Mp)},qr.error=function(it){throw new Error("Syntax error, unrecognized expression: "+it)},qr.uniqueSort=function(it){var xt,Ut=[],yn=0,qt=0;if(Fn=!Me.detectDuplicates,pn=!Me.sortStable&&it.slice(0),it.sort(pl),Fn){for(;xt=it[qt++];)xt===it[qt]&&(yn=Ut.push(qt));for(;yn--;)it.splice(Ut[yn],1)}return pn=null,it},Ve=qr.getText=function(it){var xt,Ut="",yn=0,qt=it.nodeType;if(qt){if(1===qt||9===qt||11===qt){if("string"==typeof it.textContent)return it.textContent;for(it=it.firstChild;it;it=it.nextSibling)Ut+=Ve(it)}else if(3===qt||4===qt)return it.nodeValue}else for(;xt=it[yn++];)Ut+=Ve(xt);return Ut},(Ne=qr.selectors={cacheLength:50,createPseudo:bo,match:Tp,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(it){return it[1]=it[1].replace($i,ht),it[3]=(it[3]||it[4]||it[5]||"").replace($i,ht),"~="===it[2]&&(it[3]=" "+it[3]+" "),it.slice(0,4)},CHILD:function(it){return it[1]=it[1].toLowerCase(),"nth"===it[1].slice(0,3)?(it[3]||qr.error(it[0]),it[4]=+(it[4]?it[5]+(it[6]||1):2*("even"===it[3]||"odd"===it[3])),it[5]=+(it[7]+it[8]||"odd"===it[3])):it[3]&&qr.error(it[0]),it},PSEUDO:function(it){var xt,Ut=!it[6]&&it[2];return Tp.CHILD.test(it[0])?null:(it[3]?it[2]=it[4]||it[5]||"":Ut&&$l.test(Ut)&&(xt=et(Ut,!0))&&(xt=Ut.indexOf(")",Ut.length-xt)-Ut.length)&&(it[0]=it[0].slice(0,xt),it[2]=Ut.slice(0,xt)),it.slice(0,3))}},filter:{TAG:function(it){var xt=it.replace($i,ht).toLowerCase();return"*"===it?function(){return!0}:function(Ut){return Ut.nodeName&&Ut.nodeName.toLowerCase()===xt}},CLASS:function(it){var xt=qi[it+" "];return xt||(xt=new RegExp("(^|"+Hr+")"+it+"("+Hr+"|$)"))&&qi(it,function(Ut){return xt.test("string"==typeof Ut.className&&Ut.className||typeof Ut.getAttribute<"u"&&Ut.getAttribute("class")||"")})},ATTR:function(it,xt,Ut){return function(yn){var qt=qr.attr(yn,it);return null==qt?"!="===xt:!xt||(qt+="","="===xt?qt===Ut:"!="===xt?qt!==Ut:"^="===xt?Ut&&0===qt.indexOf(Ut):"*="===xt?Ut&&qt.indexOf(Ut)>-1:"$="===xt?Ut&&qt.slice(-Ut.length)===Ut:"~="===xt?(" "+qt.replace(Xh," ")+" ").indexOf(Ut)>-1:"|="===xt&&(qt===Ut||qt.slice(0,Ut.length+1)===Ut+"-"))}},CHILD:function(it,xt,Ut,yn,qt){var fn="nth"!==it.slice(0,3),tn="last"!==it.slice(-4),qn="of-type"===xt;return 1===yn&&0===qt?function(Gn){return!!Gn.parentNode}:function(Gn,Sr,$r){var yr,Xr,fi,Rr,ts,co,Qs=fn!==tn?"nextSibling":"previousSibling",Bo=Gn.parentNode,ec=qn&&Gn.nodeName.toLowerCase(),Yo=!$r&&!qn,Xi=!1;if(Bo){if(fn){for(;Qs;){for(Rr=Gn;Rr=Rr[Qs];)if(qn?Rr.nodeName.toLowerCase()===ec:1===Rr.nodeType)return!1;co=Qs="only"===it&&!co&&"nextSibling"}return!0}if(co=[tn?Bo.firstChild:Bo.lastChild],tn&&Yo){for(Xi=(ts=(yr=(Xr=(fi=(Rr=Bo)[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]||[])[0]===Xa&&yr[1])&&yr[2],Rr=ts&&Bo.childNodes[ts];Rr=++ts&&Rr&&Rr[Qs]||(Xi=ts=0)||co.pop();)if(1===Rr.nodeType&&++Xi&&Rr===Gn){Xr[it]=[Xa,ts,Xi];break}}else if(Yo&&(Xi=ts=(yr=(Xr=(fi=(Rr=Gn)[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]||[])[0]===Xa&&yr[1]),!1===Xi)for(;(Rr=++ts&&Rr&&Rr[Qs]||(Xi=ts=0)||co.pop())&&((qn?Rr.nodeName.toLowerCase()!==ec:1!==Rr.nodeType)||!++Xi||(Yo&&((Xr=(fi=Rr[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]=[Xa,Xi]),Rr!==Gn)););return(Xi-=qt)===yn||Xi%yn==0&&Xi/yn>=0}}},PSEUDO:function(it,xt){var Ut,yn=Ne.pseudos[it]||Ne.setFilters[it.toLowerCase()]||qr.error("unsupported pseudo: "+it);return yn[bi]?yn(xt):yn.length>1?(Ut=[it,it,"",xt],Ne.setFilters.hasOwnProperty(it.toLowerCase())?bo(function(qt,fn){for(var tn,qn=yn(qt,xt),Gn=qn.length;Gn--;)qt[tn=ss(qt,qn[Gn])]=!(fn[tn]=qn[Gn])}):function(qt){return yn(qt,0,Ut)}):yn}},pseudos:{not:bo(function(it){var xt=[],Ut=[],yn=At(it.replace(yo,"$1"));return yn[bi]?bo(function(qt,fn,tn,qn){for(var Gn,Sr=yn(qt,null,qn,[]),$r=qt.length;$r--;)(Gn=Sr[$r])&&(qt[$r]=!(fn[$r]=Gn))}):function(qt,fn,tn){return xt[0]=qt,yn(xt,null,tn,Ut),xt[0]=null,!Ut.pop()}}),has:bo(function(it){return function(xt){return qr(it,xt).length>0}}),contains:bo(function(it){return it=it.replace($i,ht),function(xt){return(xt.textContent||Ve(xt)).indexOf(it)>-1}}),lang:bo(function(it){return As.test(it||"")||qr.error("unsupported lang: "+it),it=it.replace($i,ht).toLowerCase(),function(xt){var Ut;do{if(Ut=ti?xt.lang:xt.getAttribute("xml:lang")||xt.getAttribute("lang"))return(Ut=Ut.toLowerCase())===it||0===Ut.indexOf(it+"-")}while((xt=xt.parentNode)&&1===xt.nodeType);return!1}}),target:function(it){var xt=W.location&&W.location.hash;return xt&&xt.slice(1)===it.id},root:function(it){return it===Er},focus:function(it){return it===xn.activeElement&&(!xn.hasFocus||xn.hasFocus())&&!!(it.type||it.href||~it.tabIndex)},enabled:Sh(!1),disabled:Sh(!0),checked:function(it){var xt=it.nodeName.toLowerCase();return"input"===xt&&!!it.checked||"option"===xt&&!!it.selected},selected:function(it){return!0===it.selected},empty:function(it){for(it=it.firstChild;it;it=it.nextSibling)if(it.nodeType<6)return!1;return!0},parent:function(it){return!Ne.pseudos.empty(it)},header:function(it){return Di.test(it.nodeName)},input:function(it){return Sc.test(it.nodeName)},button:function(it){var xt=it.nodeName.toLowerCase();return"input"===xt&&"button"===it.type||"button"===xt},text:function(it){var xt;return"input"===it.nodeName.toLowerCase()&&"text"===it.type&&(null==(xt=it.getAttribute("type"))||"text"===xt.toLowerCase())},first:Tc(function(){return[0]}),last:Tc(function(it,xt){return[xt-1]}),eq:Tc(function(it,xt,Ut){return[Ut<0?Ut+xt:Ut]}),even:Tc(function(it,xt){for(var Ut=0;Ut<xt;Ut+=2)it.push(Ut);return it}),odd:Tc(function(it,xt){for(var Ut=1;Ut<xt;Ut+=2)it.push(Ut);return it}),lt:Tc(function(it,xt,Ut){for(var yn=Ut<0?Ut+xt:Ut>xt?xt:Ut;--yn>=0;)it.push(yn);return it}),gt:Tc(function(it,xt,Ut){for(var yn=Ut<0?Ut+xt:Ut;++yn<xt;)it.push(yn);return it})}}).pseudos.nth=Ne.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Ne.pseudos[pe]=Zc(pe);for(pe in{submit:!0,reset:!0})Ne.pseudos[pe]=wu(pe);function Cl(){}function Ja(it){for(var xt=0,Ut=it.length,yn="";xt<Ut;xt++)yn+=it[xt].value;return yn}function Ba(it,xt,Ut){var yn=xt.dir,qt=xt.next,fn=qt||yn,tn=Ut&&"parentNode"===fn,qn=Wi++;return xt.first?function(Gn,Sr,$r){for(;Gn=Gn[yn];)if(1===Gn.nodeType||tn)return it(Gn,Sr,$r);return!1}:function(Gn,Sr,$r){var yr,Xr,fi,Rr=[Xa,qn];if($r){for(;Gn=Gn[yn];)if((1===Gn.nodeType||tn)&&it(Gn,Sr,$r))return!0}else for(;Gn=Gn[yn];)if(1===Gn.nodeType||tn)if(Xr=(fi=Gn[bi]||(Gn[bi]={}))[Gn.uniqueID]||(fi[Gn.uniqueID]={}),qt&&qt===Gn.nodeName.toLowerCase())Gn=Gn[yn]||Gn;else{if((yr=Xr[fn])&&yr[0]===Xa&&yr[1]===qn)return Rr[2]=yr[2];if(Xr[fn]=Rr,Rr[2]=it(Gn,Sr,$r))return!0}return!1}}function Kl(it){return it.length>1?function(xt,Ut,yn){for(var qt=it.length;qt--;)if(!it[qt](xt,Ut,yn))return!1;return!0}:it[0]}function Na(it,xt,Ut,yn,qt){for(var fn,tn=[],qn=0,Gn=it.length,Sr=null!=xt;qn<Gn;qn++)(fn=it[qn])&&(!Ut||Ut(fn,yn,qt))&&(tn.push(fn),Sr&&xt.push(qn));return tn}function xo(it,xt,Ut,yn,qt,fn){return yn&&!yn[bi]&&(yn=xo(yn)),qt&&!qt[bi]&&(qt=xo(qt,fn)),bo(function(tn,qn,Gn,Sr){var $r,yr,Xr,fi=[],Rr=[],ts=qn.length,co=tn||function Su(it,xt,Ut){for(var yn=0,qt=xt.length;yn<qt;yn++)qr(it,xt[yn],Ut);return Ut}(xt||"*",Gn.nodeType?[Gn]:Gn,[]),Qs=!it||!tn&&xt?co:Na(co,fi,it,Gn,Sr),Bo=Ut?qt||(tn?it:ts||yn)?[]:qn:Qs;if(Ut&&Ut(Qs,Bo,Gn,Sr),yn)for($r=Na(Bo,Rr),yn($r,[],Gn,Sr),yr=$r.length;yr--;)(Xr=$r[yr])&&(Bo[Rr[yr]]=!(Qs[Rr[yr]]=Xr));if(tn){if(qt||it){if(qt){for($r=[],yr=Bo.length;yr--;)(Xr=Bo[yr])&&$r.push(Qs[yr]=Xr);qt(null,Bo=[],$r,Sr)}for(yr=Bo.length;yr--;)(Xr=Bo[yr])&&($r=qt?ss(tn,Xr):fi[yr])>-1&&(tn[$r]=!(qn[$r]=Xr))}}else Bo=Na(Bo===qn?Bo.splice(ts,Bo.length):Bo),qt?qt(null,qn,Bo,Sr):wn.apply(qn,Bo)})}function zs(it){for(var xt,Ut,yn,qt=it.length,fn=Ne.relative[it[0].type],tn=fn||Ne.relative[" "],qn=fn?1:0,Gn=Ba(function(yr){return yr===xt},tn,!0),Sr=Ba(function(yr){return ss(xt,yr)>-1},tn,!0),$r=[function(yr,Xr,fi){var Rr=!fn&&(fi||Xr!==Xt)||((xt=Xr).nodeType?Gn(yr,Xr,fi):Sr(yr,Xr,fi));return xt=null,Rr}];qn<qt;qn++)if(Ut=Ne.relative[it[qn].type])$r=[Ba(Kl($r),Ut)];else{if((Ut=Ne.filter[it[qn].type].apply(null,it[qn].matches))[bi]){for(yn=++qn;yn<qt&&!Ne.relative[it[yn].type];yn++);return xo(qn>1&&Kl($r),qn>1&&Ja(it.slice(0,qn-1).concat({value:" "===it[qn-2].type?"*":""})).replace(yo,"$1"),Ut,qn<yn&&zs(it.slice(qn,yn)),yn<qt&&zs(it=it.slice(yn)),yn<qt&&Ja(it))}$r.push(Ut)}return Kl($r)}return Cl.prototype=Ne.filters=Ne.pseudos,Ne.setFilters=new Cl,et=qr.tokenize=function(it,xt){var Ut,yn,qt,fn,tn,qn,Gn,Sr=qh[it+" "];if(Sr)return xt?0:Sr.slice(0);for(tn=it,qn=[],Gn=Ne.preFilter;tn;){for(fn in(!Ut||(yn=yu.exec(tn)))&&(yn&&(tn=tn.slice(yn[0].length)||tn),qn.push(qt=[])),Ut=!1,(yn=zn.exec(tn))&&(Ut=yn.shift(),qt.push({value:Ut,type:yn[0].replace(yo," ")}),tn=tn.slice(Ut.length)),Ne.filter)(yn=Tp[fn].exec(tn))&&(!Gn[fn]||(yn=Gn[fn](yn)))&&(Ut=yn.shift(),qt.push({value:Ut,type:fn,matches:yn}),tn=tn.slice(Ut.length));if(!Ut)break}return xt?tn.length:tn?qr.error(it):qh(it,qn).slice(0)},At=qr.compile=function(it,xt){var Ut,yn=[],qt=[],fn=wc[it+" "];if(!fn){for(xt||(xt=et(it)),Ut=xt.length;Ut--;)(fn=zs(xt[Ut]))[bi]?yn.push(fn):qt.push(fn);fn=wc(it,function Mc(it,xt){var Ut=xt.length>0,yn=it.length>0,qt=function(fn,tn,qn,Gn,Sr){var $r,yr,Xr,fi=0,Rr="0",ts=fn&&[],co=[],Qs=Xt,Bo=fn||yn&&Ne.find.TAG("*",Sr),ec=Xa+=null==Qs?1:Math.random()||.1,Yo=Bo.length;for(Sr&&(Xt=tn==xn||tn||Sr);Rr!==Yo&&null!=($r=Bo[Rr]);Rr++){if(yn&&$r){for(yr=0,!tn&&$r.ownerDocument!=xn&&(on($r),qn=!ti);Xr=it[yr++];)if(Xr($r,tn||xn,qn)){Gn.push($r);break}Sr&&(Xa=ec)}Ut&&(($r=!Xr&&$r)&&fi--,fn&&ts.push($r))}if(fi+=Rr,Ut&&Rr!==fi){for(yr=0;Xr=xt[yr++];)Xr(ts,co,tn,qn);if(fn){if(fi>0)for(;Rr--;)ts[Rr]||co[Rr]||(co[Rr]=Ds.call(Gn));co=Na(co)}wn.apply(Gn,co),Sr&&!fn&&co.length>0&&fi+xt.length>1&&qr.uniqueSort(Gn)}return Sr&&(Xa=ec,Xt=Qs),ts};return Ut?bo(qt):qt}(qt,yn)),fn.selector=it}return fn},Bt=qr.select=function(it,xt,Ut,yn){var qt,fn,tn,qn,Gn,Sr="function"==typeof it&&it,$r=!yn&&et(it=Sr.selector||it);if(Ut=Ut||[],1===$r.length){if((fn=$r[0]=$r[0].slice(0)).length>2&&"ID"===(tn=fn[0]).type&&9===xt.nodeType&&ti&&Ne.relative[fn[1].type]){if(!(xt=(Ne.find.ID(tn.matches[0].replace($i,ht),xt)||[])[0]))return Ut;Sr&&(xt=xt.parentNode),it=it.slice(fn.shift().value.length)}for(qt=Tp.needsContext.test(it)?0:fn.length;qt--&&!Ne.relative[qn=(tn=fn[qt]).type];)if((Gn=Ne.find[qn])&&(yn=Gn(tn.matches[0].replace($i,ht),Jc.test(fn[0].type)&&Kn(xt.parentNode)||xt))){if(fn.splice(qt,1),!(it=yn.length&&Ja(fn)))return wn.apply(Ut,yn),Ut;break}}return(Sr||At(it,$r))(yn,xt,!ti,Ut,!xt||Jc.test(it)&&Kn(xt.parentNode)||xt),Ut},Me.sortStable=bi.split("").sort(pl).join("")===bi,Me.detectDuplicates=!!Fn,on(),Me.sortDetached=_a(function(it){return 1&it.compareDocumentPosition(xn.createElement("fieldset"))}),_a(function(it){return it.innerHTML="<a href='#'></a>","#"===it.firstChild.getAttribute("href")})||xu("type|href|height|width",function(it,xt,Ut){if(!Ut)return it.getAttribute(xt,"type"===xt.toLowerCase()?1:2)}),(!Me.attributes||!_a(function(it){return it.innerHTML="<input/>",it.firstChild.setAttribute("value",""),""===it.firstChild.getAttribute("value")}))&&xu("value",function(it,xt,Ut){if(!Ut&&"input"===it.nodeName.toLowerCase())return it.defaultValue}),_a(function(it){return null==it.getAttribute("disabled")})||xu(Qi,function(it,xt,Ut){var yn;if(!Ut)return!0===it[xt]?xt.toLowerCase():(yn=it.getAttributeNode(xt))&&yn.specified?yn.value:null}),qr}(n);H.find=Q,H.expr=Q.selectors,H.expr[":"]=H.expr.pseudos,H.uniqueSort=H.unique=Q.uniqueSort,H.text=Q.getText,H.isXMLDoc=Q.isXML,H.contains=Q.contains,H.escapeSelector=Q.escape;var xe=function(W,pe,Me){for(var Ne=[],Ve=void 0!==Me;(W=W[pe])&&9!==W.nodeType;)if(1===W.nodeType){if(Ve&&H(W).is(Me))break;Ne.push(W)}return Ne},Pe=function(W,pe){for(var Me=[];W;W=W.nextSibling)1===W.nodeType&&W!==pe&&Me.push(W);return Me},Ge=H.expr.match.needsContext;function Ae(W,pe){return W.nodeName&&W.nodeName.toLowerCase()===pe.toLowerCase()}var Xe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ke(W,pe,Me){return le(pe)?H.grep(W,function(Ne,Ve){return!!pe.call(Ne,Ve,Ne)!==Me}):pe.nodeType?H.grep(W,function(Ne){return Ne===pe!==Me}):"string"!=typeof pe?H.grep(W,function(Ne){return M.call(pe,Ne)>-1!==Me}):H.filter(pe,W,Me)}H.filter=function(W,pe,Me){var Ne=pe[0];return Me&&(W=":not("+W+")"),1===pe.length&&1===Ne.nodeType?H.find.matchesSelector(Ne,W)?[Ne]:[]:H.find.matches(W,H.grep(pe,function(Ve){return 1===Ve.nodeType}))},H.fn.extend({find:function(W){var pe,Me,Ne=this.length,Ve=this;if("string"!=typeof W)return this.pushStack(H(W).filter(function(){for(pe=0;pe<Ne;pe++)if(H.contains(Ve[pe],this))return!0}));for(Me=this.pushStack([]),pe=0;pe<Ne;pe++)H.find(W,Ve[pe],Me);return Ne>1?H.uniqueSort(Me):Me},filter:function(W){return this.pushStack(Ke(this,W||[],!1))},not:function(W){return this.pushStack(Ke(this,W||[],!0))},is:function(W){return!!Ke(this,"string"==typeof W&&Ge.test(W)?H(W):W||[],!1).length}});var yt,dt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Pt=H.fn.init=function(W,pe,Me){var Ne,Ve;if(!W)return this;if(Me=Me||yt,"string"==typeof W){if(!(Ne="<"===W[0]&&">"===W[W.length-1]&&W.length>=3?[null,W,null]:dt.exec(W))||!Ne[1]&&pe)return!pe||pe.jquery?(pe||Me).find(W):this.constructor(pe).find(W);if(Ne[1]){if(H.merge(this,H.parseHTML(Ne[1],(pe=pe instanceof H?pe[0]:pe)&&pe.nodeType?pe.ownerDocument||pe:Y,!0)),Xe.test(Ne[1])&&H.isPlainObject(pe))for(Ne in pe)le(this[Ne])?this[Ne](pe[Ne]):this.attr(Ne,pe[Ne]);return this}return(Ve=Y.getElementById(Ne[2]))&&(this[0]=Ve,this.length=1),this}return W.nodeType?(this[0]=W,this.length=1,this):le(W)?void 0!==Me.ready?Me.ready(W):W(H):H.makeArray(W,this)};Pt.prototype=H.fn,yt=H(Y);var wt=/^(?:parents|prev(?:Until|All))/,Gt={children:!0,contents:!0,next:!0,prev:!0};function Dt(W,pe){for(;(W=W[pe])&&1!==W.nodeType;);return W}H.fn.extend({has:function(W){var pe=H(W,this),Me=pe.length;return this.filter(function(){for(var Ne=0;Ne<Me;Ne++)if(H.contains(this,pe[Ne]))return!0})},closest:function(W,pe){var Me,Ne=0,Ve=this.length,qe=[],et="string"!=typeof W&&H(W);if(!Ge.test(W))for(;Ne<Ve;Ne++)for(Me=this[Ne];Me&&Me!==pe;Me=Me.parentNode)if(Me.nodeType<11&&(et?et.index(Me)>-1:1===Me.nodeType&&H.find.matchesSelector(Me,W))){qe.push(Me);break}return this.pushStack(qe.length>1?H.uniqueSort(qe):qe)},index:function(W){return W?"string"==typeof W?M.call(H(W),this[0]):M.call(this,W.jquery?W[0]:W):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(W,pe){return this.pushStack(H.uniqueSort(H.merge(this.get(),H(W,pe))))},addBack:function(W){return this.add(null==W?this.prevObject:this.prevObject.filter(W))}}),H.each({parent:function(W){var pe=W.parentNode;return pe&&11!==pe.nodeType?pe:null},parents:function(W){return xe(W,"parentNode")},parentsUntil:function(W,pe,Me){return xe(W,"parentNode",Me)},next:function(W){return Dt(W,"nextSibling")},prev:function(W){return Dt(W,"previousSibling")},nextAll:function(W){return xe(W,"nextSibling")},prevAll:function(W){return xe(W,"previousSibling")},nextUntil:function(W,pe,Me){return xe(W,"nextSibling",Me)},prevUntil:function(W,pe,Me){return xe(W,"previousSibling",Me)},siblings:function(W){return Pe((W.parentNode||{}).firstChild,W)},children:function(W){return Pe(W.firstChild)},contents:function(W){return null!=W.contentDocument&&x(W.contentDocument)?W.contentDocument:(Ae(W,"template")&&(W=W.content||W),H.merge([],W.childNodes))}},function(W,pe){H.fn[W]=function(Me,Ne){var Ve=H.map(this,pe,Me);return"Until"!==W.slice(-5)&&(Ne=Me),Ne&&"string"==typeof Ne&&(Ve=H.filter(Ne,Ve)),this.length>1&&(Gt[W]||H.uniqueSort(Ve),wt.test(W)&&Ve.reverse()),this.pushStack(Ve)}});var sn=/[^\x20\t\r\n\f]+/g;function Mn(W){return W}function Bn(W){throw W}function dn(W,pe,Me,Ne){var Ve;try{W&&le(Ve=W.promise)?Ve.call(W).done(pe).fail(Me):W&&le(Ve=W.then)?Ve.call(W,pe,Me):pe.apply(void 0,[W].slice(Ne))}catch(qe){Me.apply(void 0,[qe])}}H.Callbacks=function(W){W="string"==typeof W?function gt(W){var pe={};return H.each(W.match(sn)||[],function(Me,Ne){pe[Ne]=!0}),pe}(W):H.extend({},W);var pe,Me,Ne,Ve,qe=[],et=[],At=-1,Bt=function(){for(Ve=Ve||W.once,Ne=pe=!0;et.length;At=-1)for(Me=et.shift();++At<qe.length;)!1===qe[At].apply(Me[0],Me[1])&&W.stopOnFalse&&(At=qe.length,Me=!1);W.memory||(Me=!1),pe=!1,Ve&&(qe=Me?[]:"")},Xt={add:function(){return qe&&(Me&&!pe&&(At=qe.length-1,et.push(Me)),function pn(Fn){H.each(Fn,function(on,xn){le(xn)?(!W.unique||!Xt.has(xn))&&qe.push(xn):xn&&xn.length&&"string"!==X(xn)&&pn(xn)})}(arguments),Me&&!pe&&Bt()),this},remove:function(){return H.each(arguments,function(pn,Fn){for(var on;(on=H.inArray(Fn,qe,on))>-1;)qe.splice(on,1),on<=At&&At--}),this},has:function(pn){return pn?H.inArray(pn,qe)>-1:qe.length>0},empty:function(){return qe&&(qe=[]),this},disable:function(){return Ve=et=[],qe=Me="",this},disabled:function(){return!qe},lock:function(){return Ve=et=[],!Me&&!pe&&(qe=Me=""),this},locked:function(){return!!Ve},fireWith:function(pn,Fn){return Ve||(Fn=[pn,(Fn=Fn||[]).slice?Fn.slice():Fn],et.push(Fn),pe||Bt()),this},fire:function(){return Xt.fireWith(this,arguments),this},fired:function(){return!!Ne}};return Xt},H.extend({Deferred:function(W){var pe=[["notify","progress",H.Callbacks("memory"),H.Callbacks("memory"),2],["resolve","done",H.Callbacks("once memory"),H.Callbacks("once memory"),0,"resolved"],["reject","fail",H.Callbacks("once memory"),H.Callbacks("once memory"),1,"rejected"]],Me="pending",Ne={state:function(){return Me},always:function(){return Ve.done(arguments).fail(arguments),this},catch:function(qe){return Ne.then(null,qe)},pipe:function(){var qe=arguments;return H.Deferred(function(et){H.each(pe,function(At,Bt){var Xt=le(qe[Bt[4]])&&qe[Bt[4]];Ve[Bt[1]](function(){var pn=Xt&&Xt.apply(this,arguments);pn&&le(pn.promise)?pn.promise().progress(et.notify).done(et.resolve).fail(et.reject):et[Bt[0]+"With"](this,Xt?[pn]:arguments)})}),qe=null}).promise()},then:function(qe,et,At){var Bt=0;function Xt(pn,Fn,on,xn){return function(){var Er=this,ti=arguments,Ar=function(){var es,da;if(!(pn<Bt)){if((es=on.apply(Er,ti))===Fn.promise())throw new TypeError("Thenable self-resolution");le(da=es&&("object"==typeof es||"function"==typeof es)&&es.then)?xn?da.call(es,Xt(Bt,Fn,Mn,xn),Xt(Bt,Fn,Bn,xn)):(Bt++,da.call(es,Xt(Bt,Fn,Mn,xn),Xt(Bt,Fn,Bn,xn),Xt(Bt,Fn,Mn,Fn.notifyWith))):(on!==Mn&&(Er=void 0,ti=[es]),(xn||Fn.resolveWith)(Er,ti))}},fs=xn?Ar:function(){try{Ar()}catch(es){H.Deferred.exceptionHook&&H.Deferred.exceptionHook(es,fs.stackTrace),pn+1>=Bt&&(on!==Bn&&(Er=void 0,ti=[es]),Fn.rejectWith(Er,ti))}};pn?fs():(H.Deferred.getStackHook&&(fs.stackTrace=H.Deferred.getStackHook()),n.setTimeout(fs))}}return H.Deferred(function(pn){pe[0][3].add(Xt(0,pn,le(At)?At:Mn,pn.notifyWith)),pe[1][3].add(Xt(0,pn,le(qe)?qe:Mn)),pe[2][3].add(Xt(0,pn,le(et)?et:Bn))}).promise()},promise:function(qe){return null!=qe?H.extend(qe,Ne):Ne}},Ve={};return H.each(pe,function(qe,et){var At=et[2],Bt=et[5];Ne[et[1]]=At.add,Bt&&At.add(function(){Me=Bt},pe[3-qe][2].disable,pe[3-qe][3].disable,pe[0][2].lock,pe[0][3].lock),At.add(et[3].fire),Ve[et[0]]=function(){return Ve[et[0]+"With"](this===Ve?void 0:this,arguments),this},Ve[et[0]+"With"]=At.fireWith}),Ne.promise(Ve),W&&W.call(Ve,Ve),Ve},when:function(W){var pe=arguments.length,Me=pe,Ne=Array(Me),Ve=L.call(arguments),qe=H.Deferred(),et=function(At){return function(Bt){Ne[At]=this,Ve[At]=arguments.length>1?L.call(arguments):Bt,--pe||qe.resolveWith(Ne,Ve)}};if(pe<=1&&(dn(W,qe.done(et(Me)).resolve,qe.reject,!pe),"pending"===qe.state()||le(Ve[Me]&&Ve[Me].then)))return qe.then();for(;Me--;)dn(Ve[Me],et(Me),qe.reject);return qe.promise()}});var On=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;H.Deferred.exceptionHook=function(W,pe){n.console&&n.console.warn&&W&&On.test(W.name)&&n.console.warn("jQuery.Deferred exception: "+W.message,W.stack,pe)},H.readyException=function(W){n.setTimeout(function(){throw W})};var Ln=H.Deferred();function mn(){Y.removeEventListener("DOMContentLoaded",mn),n.removeEventListener("load",mn),H.ready()}H.fn.ready=function(W){return Ln.then(W).catch(function(pe){H.readyException(pe)}),this},H.extend({isReady:!1,readyWait:1,ready:function(W){(!0===W?--H.readyWait:H.isReady)||(H.isReady=!0,!(!0!==W&&--H.readyWait>0)&&Ln.resolveWith(Y,[H]))}}),H.ready.then=Ln.then,"complete"===Y.readyState||"loading"!==Y.readyState&&!Y.documentElement.doScroll?n.setTimeout(H.ready):(Y.addEventListener("DOMContentLoaded",mn),n.addEventListener("load",mn));var cr=function(W,pe,Me,Ne,Ve,qe,et){var At=0,Bt=W.length,Xt=null==Me;if("object"===X(Me))for(At in Ve=!0,Me)cr(W,pe,At,Me[At],!0,qe,et);else if(void 0!==Ne&&(Ve=!0,le(Ne)||(et=!0),Xt&&(et?(pe.call(W,Ne),pe=null):(Xt=pe,pe=function(pn,Fn,on){return Xt.call(H(pn),on)})),pe))for(;At<Bt;At++)pe(W[At],Me,et?Ne:Ne.call(W[At],At,pe(W[At],Me)));return Ve?W:Xt?pe.call(W):Bt?pe(W[0],Me):qe},ir=/^-ms-/,ur=/-([a-z])/g;function or(W,pe){return pe.toUpperCase()}function ni(W){return W.replace(ir,"ms-").replace(ur,or)}var Kr=function(W){return 1===W.nodeType||9===W.nodeType||!+W.nodeType};function pi(){this.expando=H.expando+pi.uid++}pi.uid=1,pi.prototype={cache:function(W){var pe=W[this.expando];return pe||(pe={},Kr(W)&&(W.nodeType?W[this.expando]=pe:Object.defineProperty(W,this.expando,{value:pe,configurable:!0}))),pe},set:function(W,pe,Me){var Ne,Ve=this.cache(W);if("string"==typeof pe)Ve[ni(pe)]=Me;else for(Ne in pe)Ve[ni(Ne)]=pe[Ne];return Ve},get:function(W,pe){return void 0===pe?this.cache(W):W[this.expando]&&W[this.expando][ni(pe)]},access:function(W,pe,Me){return void 0===pe||pe&&"string"==typeof pe&&void 0===Me?this.get(W,pe):(this.set(W,pe,Me),void 0!==Me?Me:pe)},remove:function(W,pe){var Me,Ne=W[this.expando];if(void 0!==Ne){if(void 0!==pe)for((Me=(pe=Array.isArray(pe)?pe.map(ni):(pe=ni(pe))in Ne?[pe]:pe.match(sn)||[]).length);Me--;)delete Ne[pe[Me]];(void 0===pe||H.isEmptyObject(Ne))&&(W.nodeType?W[this.expando]=void 0:delete W[this.expando])}},hasData:function(W){var pe=W[this.expando];return void 0!==pe&&!H.isEmptyObject(pe)}};var rr=new pi,vr=new pi,mi=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,go=/[A-Z]/g;function ei(W,pe,Me){var Ne;if(void 0===Me&&1===W.nodeType)if(Ne="data-"+pe.replace(go,"-$&").toLowerCase(),"string"==typeof(Me=W.getAttribute(Ne))){try{Me=function Nr(W){return"true"===W||"false"!==W&&("null"===W?null:W===+W+""?+W:mi.test(W)?JSON.parse(W):W)}(Me)}catch{}vr.set(W,pe,Me)}else Me=void 0;return Me}H.extend({hasData:function(W){return vr.hasData(W)||rr.hasData(W)},data:function(W,pe,Me){return vr.access(W,pe,Me)},removeData:function(W,pe){vr.remove(W,pe)},_data:function(W,pe,Me){return rr.access(W,pe,Me)},_removeData:function(W,pe){rr.remove(W,pe)}}),H.fn.extend({data:function(W,pe){var Me,Ne,Ve,qe=this[0],et=qe&&qe.attributes;if(void 0===W){if(this.length&&(Ve=vr.get(qe),1===qe.nodeType&&!rr.get(qe,"hasDataAttrs"))){for(Me=et.length;Me--;)et[Me]&&0===(Ne=et[Me].name).indexOf("data-")&&(Ne=ni(Ne.slice(5)),ei(qe,Ne,Ve[Ne]));rr.set(qe,"hasDataAttrs",!0)}return Ve}return"object"==typeof W?this.each(function(){vr.set(this,W)}):cr(this,function(At){var Bt;if(qe&&void 0===At)return void 0!==(Bt=vr.get(qe,W))||void 0!==(Bt=ei(qe,W))?Bt:void 0;this.each(function(){vr.set(this,W,At)})},null,pe,arguments.length>1,null,!0)},removeData:function(W){return this.each(function(){vr.remove(this,W)})}}),H.extend({queue:function(W,pe,Me){var Ne;if(W)return Ne=rr.get(W,pe=(pe||"fx")+"queue"),Me&&(!Ne||Array.isArray(Me)?Ne=rr.access(W,pe,H.makeArray(Me)):Ne.push(Me)),Ne||[]},dequeue:function(W,pe){var Me=H.queue(W,pe=pe||"fx"),Ne=Me.length,Ve=Me.shift(),qe=H._queueHooks(W,pe);"inprogress"===Ve&&(Ve=Me.shift(),Ne--),Ve&&("fx"===pe&&Me.unshift("inprogress"),delete qe.stop,Ve.call(W,function(){H.dequeue(W,pe)},qe)),!Ne&&qe&&qe.empty.fire()},_queueHooks:function(W,pe){var Me=pe+"queueHooks";return rr.get(W,Me)||rr.access(W,Me,{empty:H.Callbacks("once memory").add(function(){rr.remove(W,[pe+"queue",Me])})})}}),H.fn.extend({queue:function(W,pe){var Me=2;return"string"!=typeof W&&(pe=W,W="fx",Me--),arguments.length<Me?H.queue(this[0],W):void 0===pe?this:this.each(function(){var Ne=H.queue(this,W,pe);H._queueHooks(this,W),"fx"===W&&"inprogress"!==Ne[0]&&H.dequeue(this,W)})},dequeue:function(W){return this.each(function(){H.dequeue(this,W)})},clearQueue:function(W){return this.queue(W||"fx",[])},promise:function(W,pe){var Me,Ne=1,Ve=H.Deferred(),qe=this,et=this.length,At=function(){--Ne||Ve.resolveWith(qe,[qe])};for("string"!=typeof W&&(pe=W,W=void 0),W=W||"fx";et--;)(Me=rr.get(qe[et],W+"queueHooks"))&&Me.empty&&(Ne++,Me.empty.add(At));return At(),Ve.promise(pe)}});var Wr=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,yi=new RegExp("^(?:([+-])=|)("+Wr+")([a-z%]*)$","i"),Ei=["Top","Right","Bottom","Left"],So=Y.documentElement,Xs=function(W){return H.contains(W.ownerDocument,W)},ua={composed:!0};So.getRootNode&&(Xs=function(W){return H.contains(W.ownerDocument,W)||W.getRootNode(ua)===W.ownerDocument});var Ni=function(W,pe){return"none"===(W=pe||W).style.display||""===W.style.display&&Xs(W)&&"none"===H.css(W,"display")};function Eo(W,pe,Me,Ne){var Ve,qe,et=20,At=Ne?function(){return Ne.cur()}:function(){return H.css(W,pe,"")},Bt=At(),Xt=Me&&Me[3]||(H.cssNumber[pe]?"":"px"),pn=W.nodeType&&(H.cssNumber[pe]||"px"!==Xt&&+Bt)&&yi.exec(H.css(W,pe));if(pn&&pn[3]!==Xt){for(Xt=Xt||pn[3],pn=+(Bt/=2)||1;et--;)H.style(W,pe,pn+Xt),(1-qe)*(1-(qe=At()/Bt||.5))<=0&&(et=0),pn/=qe;H.style(W,pe,(pn*=2)+Xt),Me=Me||[]}return Me&&(pn=+pn||+Bt||0,Ve=Me[1]?pn+(Me[1]+1)*Me[2]:+Me[2],Ne&&(Ne.unit=Xt,Ne.start=pn,Ne.end=Ve)),Ve}var vo={};function Jr(W){var pe,Me=W.ownerDocument,Ne=W.nodeName,Ve=vo[Ne];return Ve||(pe=Me.body.appendChild(Me.createElement(Ne)),Ve=H.css(pe,"display"),pe.parentNode.removeChild(pe),"none"===Ve&&(Ve="block"),vo[Ne]=Ve,Ve)}function os(W,pe){for(var Me,Ne,Ve=[],qe=0,et=W.length;qe<et;qe++)(Ne=W[qe]).style&&(Me=Ne.style.display,pe?("none"===Me&&(Ve[qe]=rr.get(Ne,"display")||null,Ve[qe]||(Ne.style.display="")),""===Ne.style.display&&Ni(Ne)&&(Ve[qe]=Jr(Ne))):"none"!==Me&&(Ve[qe]="none",rr.set(Ne,"display",Me)));for(qe=0;qe<et;qe++)null!=Ve[qe]&&(W[qe].style.display=Ve[qe]);return W}H.fn.extend({show:function(){return os(this,!0)},hide:function(){return os(this)},toggle:function(W){return"boolean"==typeof W?W?this.show():this.hide():this.each(function(){Ni(this)?H(this).show():H(this).hide()})}});var pe,Me,Ir=/^(?:checkbox|radio)$/i,Va=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Hu=/^$|^module$|\/(?:java|ecma)script/i;pe=Y.createDocumentFragment().appendChild(Y.createElement("div")),(Me=Y.createElement("input")).setAttribute("type","radio"),Me.setAttribute("checked","checked"),Me.setAttribute("name","t"),pe.appendChild(Me),fe.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",fe.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue,pe.innerHTML="<option></option>",fe.option=!!pe.lastChild;var hs={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Ys(W,pe){var Me;return Me=typeof W.getElementsByTagName<"u"?W.getElementsByTagName(pe||"*"):typeof W.querySelectorAll<"u"?W.querySelectorAll(pe||"*"):[],void 0===pe||pe&&Ae(W,pe)?H.merge([W],Me):Me}function ai(W,pe){for(var Me=0,Ne=W.length;Me<Ne;Me++)rr.set(W[Me],"globalEval",!pe||rr.get(pe[Me],"globalEval"))}hs.tbody=hs.tfoot=hs.colgroup=hs.caption=hs.thead,hs.th=hs.td,fe.option||(hs.optgroup=hs.option=[1,"<select multiple='multiple'>","</select>"]);var Gc=/<|&#?\w+;/;function kh(W,pe,Me,Ne,Ve){for(var qe,et,At,Bt,Xt,pn,Fn=pe.createDocumentFragment(),on=[],xn=0,Er=W.length;xn<Er;xn++)if((qe=W[xn])||0===qe)if("object"===X(qe))H.merge(on,qe.nodeType?[qe]:qe);else if(Gc.test(qe)){for(et=et||Fn.appendChild(pe.createElement("div")),At=(Va.exec(qe)||["",""])[1].toLowerCase(),et.innerHTML=(Bt=hs[At]||hs._default)[1]+H.htmlPrefilter(qe)+Bt[2],pn=Bt[0];pn--;)et=et.lastChild;H.merge(on,et.childNodes),(et=Fn.firstChild).textContent=""}else on.push(pe.createTextNode(qe));for(Fn.textContent="",xn=0;qe=on[xn++];)if(Ne&&H.inArray(qe,Ne)>-1)Ve&&Ve.push(qe);else if(Xt=Xs(qe),et=Ys(Fn.appendChild(qe),"script"),Xt&&ai(et),Me)for(pn=0;qe=et[pn++];)Hu.test(qe.type||"")&&Me.push(qe);return Fn}var sl=/^key/,Gp=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ha=/^([^.]*)(?:\.(.+)|)/;function Wl(){return!0}function Wa(){return!1}function Hc(W,pe){return W===function Hp(){try{return Y.activeElement}catch{}}()==("focus"===pe)}function Js(W,pe,Me,Ne,Ve,qe){var et,At;if("object"==typeof pe){for(At in"string"!=typeof Me&&(Ne=Ne||Me,Me=void 0),pe)Js(W,At,Me,Ne,pe[At],qe);return W}if(null==Ne&&null==Ve?(Ve=Me,Ne=Me=void 0):null==Ve&&("string"==typeof Me?(Ve=Ne,Ne=void 0):(Ve=Ne,Ne=Me,Me=void 0)),!1===Ve)Ve=Wa;else if(!Ve)return W;return 1===qe&&(et=Ve,Ve=function(Bt){return H().off(Bt),et.apply(this,arguments)},Ve.guid=et.guid||(et.guid=H.guid++)),W.each(function(){H.event.add(this,pe,Ve,Ne,Me)})}function Xo(W,pe,Me){Me?(rr.set(W,pe,!1),H.event.add(W,pe,{namespace:!1,handler:function(Ne){var Ve,qe,et=rr.get(this,pe);if(1&Ne.isTrigger&&this[pe]){if(et.length)(H.event.special[pe]||{}).delegateType&&Ne.stopPropagation();else if(et=L.call(arguments),rr.set(this,pe,et),Ve=Me(this,pe),this[pe](),et!==(qe=rr.get(this,pe))||Ve?rr.set(this,pe,!1):qe={},et!==qe)return Ne.stopImmediatePropagation(),Ne.preventDefault(),qe.value}else et.length&&(rr.set(this,pe,{value:H.event.trigger(H.extend(et[0],H.Event.prototype),et.slice(1),this)}),Ne.stopImmediatePropagation())}})):void 0===rr.get(W,pe)&&H.event.add(W,pe,Wl)}H.event={global:{},add:function(W,pe,Me,Ne,Ve){var qe,et,At,Bt,Xt,pn,Fn,on,xn,Er,ti,Ar=rr.get(W);if(Kr(W))for(Me.handler&&(Me=(qe=Me).handler,Ve=qe.selector),Ve&&H.find.matchesSelector(So,Ve),Me.guid||(Me.guid=H.guid++),(Bt=Ar.events)||(Bt=Ar.events=Object.create(null)),(et=Ar.handle)||(et=Ar.handle=function(fs){return typeof H<"u"&&H.event.triggered!==fs.type?H.event.dispatch.apply(W,arguments):void 0}),Xt=(pe=(pe||"").match(sn)||[""]).length;Xt--;)xn=ti=(At=ha.exec(pe[Xt])||[])[1],Er=(At[2]||"").split(".").sort(),xn&&(Fn=H.event.special[xn]||{},Fn=H.event.special[xn=(Ve?Fn.delegateType:Fn.bindType)||xn]||{},pn=H.extend({type:xn,origType:ti,data:Ne,handler:Me,guid:Me.guid,selector:Ve,needsContext:Ve&&H.expr.match.needsContext.test(Ve),namespace:Er.join(".")},qe),(on=Bt[xn])||((on=Bt[xn]=[]).delegateCount=0,(!Fn.setup||!1===Fn.setup.call(W,Ne,Er,et))&&W.addEventListener&&W.addEventListener(xn,et)),Fn.add&&(Fn.add.call(W,pn),pn.handler.guid||(pn.handler.guid=Me.guid)),Ve?on.splice(on.delegateCount++,0,pn):on.push(pn),H.event.global[xn]=!0)},remove:function(W,pe,Me,Ne,Ve){var qe,et,At,Bt,Xt,pn,Fn,on,xn,Er,ti,Ar=rr.hasData(W)&&rr.get(W);if(Ar&&(Bt=Ar.events)){for(Xt=(pe=(pe||"").match(sn)||[""]).length;Xt--;)if(xn=ti=(At=ha.exec(pe[Xt])||[])[1],Er=(At[2]||"").split(".").sort(),xn){for(Fn=H.event.special[xn]||{},on=Bt[xn=(Ne?Fn.delegateType:Fn.bindType)||xn]||[],At=At[2]&&new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"),et=qe=on.length;qe--;)pn=on[qe],(Ve||ti===pn.origType)&&(!Me||Me.guid===pn.guid)&&(!At||At.test(pn.namespace))&&(!Ne||Ne===pn.selector||"**"===Ne&&pn.selector)&&(on.splice(qe,1),pn.selector&&on.delegateCount--,Fn.remove&&Fn.remove.call(W,pn));et&&!on.length&&((!Fn.teardown||!1===Fn.teardown.call(W,Er,Ar.handle))&&H.removeEvent(W,xn,Ar.handle),delete Bt[xn])}else for(xn in Bt)H.event.remove(W,xn+pe[Xt],Me,Ne,!0);H.isEmptyObject(Bt)&&rr.remove(W,"handle events")}},dispatch:function(W){var pe,Me,Ne,Ve,qe,et,At=new Array(arguments.length),Bt=H.event.fix(W),Xt=(rr.get(this,"events")||Object.create(null))[Bt.type]||[],pn=H.event.special[Bt.type]||{};for(At[0]=Bt,pe=1;pe<arguments.length;pe++)At[pe]=arguments[pe];if(Bt.delegateTarget=this,!pn.preDispatch||!1!==pn.preDispatch.call(this,Bt)){for(et=H.event.handlers.call(this,Bt,Xt),pe=0;(Ve=et[pe++])&&!Bt.isPropagationStopped();)for(Bt.currentTarget=Ve.elem,Me=0;(qe=Ve.handlers[Me++])&&!Bt.isImmediatePropagationStopped();)(!Bt.rnamespace||!1===qe.namespace||Bt.rnamespace.test(qe.namespace))&&(Bt.handleObj=qe,Bt.data=qe.data,void 0!==(Ne=((H.event.special[qe.origType]||{}).handle||qe.handler).apply(Ve.elem,At))&&!1===(Bt.result=Ne)&&(Bt.preventDefault(),Bt.stopPropagation()));return pn.postDispatch&&pn.postDispatch.call(this,Bt),Bt.result}},handlers:function(W,pe){var Me,Ne,Ve,qe,et,At=[],Bt=pe.delegateCount,Xt=W.target;if(Bt&&Xt.nodeType&&!("click"===W.type&&W.button>=1))for(;Xt!==this;Xt=Xt.parentNode||this)if(1===Xt.nodeType&&("click"!==W.type||!0!==Xt.disabled)){for(qe=[],et={},Me=0;Me<Bt;Me++)void 0===et[Ve=(Ne=pe[Me]).selector+" "]&&(et[Ve]=Ne.needsContext?H(Ve,this).index(Xt)>-1:H.find(Ve,this,null,[Xt]).length),et[Ve]&&qe.push(Ne);qe.length&&At.push({elem:Xt,handlers:qe})}return Xt=this,Bt<pe.length&&At.push({elem:Xt,handlers:pe.slice(Bt)}),At},addProp:function(W,pe){Object.defineProperty(H.Event.prototype,W,{enumerable:!0,configurable:!0,get:le(pe)?function(){if(this.originalEvent)return pe(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[W]},set:function(Me){Object.defineProperty(this,W,{enumerable:!0,configurable:!0,writable:!0,value:Me})}})},fix:function(W){return W[H.expando]?W:new H.Event(W)},special:{load:{noBubble:!0},click:{setup:function(W){var pe=this||W;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&Xo(pe,"click",Wl),!1},trigger:function(W){var pe=this||W;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&Xo(pe,"click"),!0},_default:function(W){var pe=W.target;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&rr.get(pe,"click")||Ae(pe,"a")}},beforeunload:{postDispatch:function(W){void 0!==W.result&&W.originalEvent&&(W.originalEvent.returnValue=W.result)}}}},H.removeEvent=function(W,pe,Me){W.removeEventListener&&W.removeEventListener(pe,Me)},H.Event=function(W,pe){if(!(this instanceof H.Event))return new H.Event(W,pe);W&&W.type?(this.originalEvent=W,this.type=W.type,this.isDefaultPrevented=W.defaultPrevented||void 0===W.defaultPrevented&&!1===W.returnValue?Wl:Wa,this.target=W.target&&3===W.target.nodeType?W.target.parentNode:W.target,this.currentTarget=W.currentTarget,this.relatedTarget=W.relatedTarget):this.type=W,pe&&H.extend(this,pe),this.timeStamp=W&&W.timeStamp||Date.now(),this[H.expando]=!0},H.Event.prototype={constructor:H.Event,isDefaultPrevented:Wa,isPropagationStopped:Wa,isImmediatePropagationStopped:Wa,isSimulated:!1,preventDefault:function(){var W=this.originalEvent;this.isDefaultPrevented=Wl,W&&!this.isSimulated&&W.preventDefault()},stopPropagation:function(){var W=this.originalEvent;this.isPropagationStopped=Wl,W&&!this.isSimulated&&W.stopPropagation()},stopImmediatePropagation:function(){var W=this.originalEvent;this.isImmediatePropagationStopped=Wl,W&&!this.isSimulated&&W.stopImmediatePropagation(),this.stopPropagation()}},H.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(W){var pe=W.button;return null==W.which&&sl.test(W.type)?null!=W.charCode?W.charCode:W.keyCode:!W.which&&void 0!==pe&&Gp.test(W.type)?1&pe?1:2&pe?3:4&pe?2:0:W.which}},H.event.addProp),H.each({focus:"focusin",blur:"focusout"},function(W,pe){H.event.special[W]={setup:function(){return Xo(this,W,Hc),!1},trigger:function(){return Xo(this,W),!0},delegateType:pe}}),H.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(W,pe){H.event.special[W]={delegateType:pe,bindType:pe,handle:function(Me){var Ne,qe=Me.relatedTarget,et=Me.handleObj;return(!qe||qe!==this&&!H.contains(this,qe))&&(Me.type=et.origType,Ne=et.handler.apply(this,arguments),Me.type=pe),Ne}}}),H.fn.extend({on:function(W,pe,Me,Ne){return Js(this,W,pe,Me,Ne)},one:function(W,pe,Me,Ne){return Js(this,W,pe,Me,Ne,1)},off:function(W,pe,Me){var Ne,Ve;if(W&&W.preventDefault&&W.handleObj)return Ne=W.handleObj,H(W.delegateTarget).off(Ne.namespace?Ne.origType+"."+Ne.namespace:Ne.origType,Ne.selector,Ne.handler),this;if("object"==typeof W){for(Ve in W)this.off(Ve,pe,W[Ve]);return this}return(!1===pe||"function"==typeof pe)&&(Me=pe,pe=void 0),!1===Me&&(Me=Wa),this.each(function(){H.event.remove(this,W,Me,pe)})}});var ps=/<script|<style|<link/i,Vu=/checked\s*(?:[^=]|=\s*.checked.)/i,du=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function fu(W,pe){return Ae(W,"table")&&Ae(11!==pe.nodeType?pe:pe.firstChild,"tr")&&H(W).children("tbody")[0]||W}function Ms(W){return W.type=(null!==W.getAttribute("type"))+"/"+W.type,W}function dp(W){return"true/"===(W.type||"").slice(0,5)?W.type=W.type.slice(5):W.removeAttribute("type"),W}function Fs(W,pe){var Me,Ne,Ve,et,At,Bt;if(1===pe.nodeType){if(rr.hasData(W)&&(Bt=rr.get(W).events))for(Ve in rr.remove(pe,"handle events"),Bt)for(Me=0,Ne=Bt[Ve].length;Me<Ne;Me++)H.event.add(pe,Ve,Bt[Ve][Me]);vr.hasData(W)&&(et=vr.access(W),At=H.extend({},et),vr.set(pe,At))}}function lo(W,pe){var Me=pe.nodeName.toLowerCase();"input"===Me&&Ir.test(W.type)?pe.checked=W.checked:("input"===Me||"textarea"===Me)&&(pe.defaultValue=W.defaultValue)}function Vc(W,pe,Me,Ne){pe=D(pe);var Ve,qe,et,At,Bt,Xt,pn=0,Fn=W.length,on=Fn-1,xn=pe[0],Er=le(xn);if(Er||Fn>1&&"string"==typeof xn&&!fe.checkClone&&Vu.test(xn))return W.each(function(ti){var Ar=W.eq(ti);Er&&(pe[0]=xn.call(this,ti,Ar.html())),Vc(Ar,pe,Me,Ne)});if(Fn&&(qe=(Ve=kh(pe,W[0].ownerDocument,!1,W,Ne)).firstChild,1===Ve.childNodes.length&&(Ve=qe),qe||Ne)){for(At=(et=H.map(Ys(Ve,"script"),Ms)).length;pn<Fn;pn++)Bt=Ve,pn!==on&&(Bt=H.clone(Bt,!0,!0),At&&H.merge(et,Ys(Bt,"script"))),Me.call(W[pn],Bt,pn);if(At)for(Xt=et[et.length-1].ownerDocument,H.map(et,dp),pn=0;pn<At;pn++)Hu.test((Bt=et[pn]).type||"")&&!rr.access(Bt,"globalEval")&&H.contains(Xt,Bt)&&(Bt.src&&"module"!==(Bt.type||"").toLowerCase()?H._evalUrl&&!Bt.noModule&&H._evalUrl(Bt.src,{nonce:Bt.nonce||Bt.getAttribute("nonce")},Xt):N(Bt.textContent.replace(du,""),Bt,Xt))}return W}function Wu(W,pe,Me){for(var Ne,Ve=pe?H.filter(pe,W):W,qe=0;null!=(Ne=Ve[qe]);qe++)!Me&&1===Ne.nodeType&&H.cleanData(Ys(Ne)),Ne.parentNode&&(Me&&Xs(Ne)&&ai(Ys(Ne,"script")),Ne.parentNode.removeChild(Ne));return W}H.extend({htmlPrefilter:function(W){return W},clone:function(W,pe,Me){var Ne,Ve,qe,et,At=W.cloneNode(!0),Bt=Xs(W);if(!(fe.noCloneChecked||1!==W.nodeType&&11!==W.nodeType||H.isXMLDoc(W)))for(et=Ys(At),Ne=0,Ve=(qe=Ys(W)).length;Ne<Ve;Ne++)lo(qe[Ne],et[Ne]);if(pe)if(Me)for(qe=qe||Ys(W),et=et||Ys(At),Ne=0,Ve=qe.length;Ne<Ve;Ne++)Fs(qe[Ne],et[Ne]);else Fs(W,At);return(et=Ys(At,"script")).length>0&&ai(et,!Bt&&Ys(W,"script")),At},cleanData:function(W){for(var pe,Me,Ne,Ve=H.event.special,qe=0;void 0!==(Me=W[qe]);qe++)if(Kr(Me)){if(pe=Me[rr.expando]){if(pe.events)for(Ne in pe.events)Ve[Ne]?H.event.remove(Me,Ne):H.removeEvent(Me,Ne,pe.handle);Me[rr.expando]=void 0}Me[vr.expando]&&(Me[vr.expando]=void 0)}}}),H.fn.extend({detach:function(W){return Wu(this,W,!0)},remove:function(W){return Wu(this,W)},text:function(W){return cr(this,function(pe){return void 0===pe?H.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=pe)})},null,W,arguments.length)},append:function(){return Vc(this,arguments,function(W){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||fu(this,W).appendChild(W)})},prepend:function(){return Vc(this,arguments,function(W){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var pe=fu(this,W);pe.insertBefore(W,pe.firstChild)}})},before:function(){return Vc(this,arguments,function(W){this.parentNode&&this.parentNode.insertBefore(W,this)})},after:function(){return Vc(this,arguments,function(W){this.parentNode&&this.parentNode.insertBefore(W,this.nextSibling)})},empty:function(){for(var W,pe=0;null!=(W=this[pe]);pe++)1===W.nodeType&&(H.cleanData(Ys(W,!1)),W.textContent="");return this},clone:function(W,pe){return W=W??!1,pe=pe??W,this.map(function(){return H.clone(this,W,pe)})},html:function(W){return cr(this,function(pe){var Me=this[0]||{},Ne=0,Ve=this.length;if(void 0===pe&&1===Me.nodeType)return Me.innerHTML;if("string"==typeof pe&&!ps.test(pe)&&!hs[(Va.exec(pe)||["",""])[1].toLowerCase()]){pe=H.htmlPrefilter(pe);try{for(;Ne<Ve;Ne++)1===(Me=this[Ne]||{}).nodeType&&(H.cleanData(Ys(Me,!1)),Me.innerHTML=pe);Me=0}catch{}}Me&&this.empty().append(pe)},null,W,arguments.length)},replaceWith:function(){var W=[];return Vc(this,arguments,function(pe){var Me=this.parentNode;H.inArray(this,W)<0&&(H.cleanData(Ys(this)),Me&&Me.replaceChild(pe,this))},W)}}),H.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(W,pe){H.fn[W]=function(Me){for(var Ne,Ve=[],qe=H(Me),et=qe.length-1,At=0;At<=et;At++)Ne=At===et?this:this.clone(!0),H(qe[At])[pe](Ne),z.apply(Ve,Ne.get());return this.pushStack(Ve)}});var vh=new RegExp("^("+Wr+")(?!px)[a-z%]+$","i"),To=function(W){var pe=W.ownerDocument.defaultView;return(!pe||!pe.opener)&&(pe=n),pe.getComputedStyle(W)},Zs=function(W,pe,Me){var Ne,Ve,qe={};for(Ve in pe)qe[Ve]=W.style[Ve],W.style[Ve]=pe[Ve];for(Ve in Ne=Me.call(W),pe)W.style[Ve]=qe[Ve];return Ne},Vp=new RegExp(Ei.join("|"),"i");function ll(W,pe,Me){var Ne,Ve,qe,et,At=W.style;return(Me=Me||To(W))&&(""===(et=Me.getPropertyValue(pe)||Me[pe])&&!Xs(W)&&(et=H.style(W,pe)),!fe.pixelBoxStyles()&&vh.test(et)&&Vp.test(pe)&&(Ne=At.width,Ve=At.minWidth,qe=At.maxWidth,At.minWidth=At.maxWidth=At.width=et,et=Me.width,At.width=Ne,At.minWidth=Ve,At.maxWidth=qe)),void 0!==et?et+"":et}function mu(W,pe){return{get:function(){if(!W())return(this.get=pe).apply(this,arguments);delete this.get}}}!function(){function W(){if(Xt){Bt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Xt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",So.appendChild(Bt).appendChild(Xt);var pn=n.getComputedStyle(Xt);Me="1%"!==pn.top,At=12===pe(pn.marginLeft),Xt.style.right="60%",qe=36===pe(pn.right),Ne=36===pe(pn.width),Xt.style.position="absolute",Ve=12===pe(Xt.offsetWidth/3),So.removeChild(Bt),Xt=null}}function pe(pn){return Math.round(parseFloat(pn))}var Me,Ne,Ve,qe,et,At,Bt=Y.createElement("div"),Xt=Y.createElement("div");Xt.style&&(Xt.style.backgroundClip="content-box",Xt.cloneNode(!0).style.backgroundClip="",fe.clearCloneStyle="content-box"===Xt.style.backgroundClip,H.extend(fe,{boxSizingReliable:function(){return W(),Ne},pixelBoxStyles:function(){return W(),qe},pixelPosition:function(){return W(),Me},reliableMarginLeft:function(){return W(),At},scrollboxSize:function(){return W(),Ve},reliableTrDimensions:function(){var pn,Fn,on,xn;return null==et&&(pn=Y.createElement("table"),Fn=Y.createElement("tr"),on=Y.createElement("div"),pn.style.cssText="position:absolute;left:-11111px",Fn.style.height="1px",on.style.height="9px",So.appendChild(pn).appendChild(Fn).appendChild(on),xn=n.getComputedStyle(Fn),et=parseInt(xn.height)>3,So.removeChild(pn)),et}}))}();var fp=["Webkit","Moz","ms"],mp=Y.createElement("div").style,yh={};function mc(W){return H.cssProps[W]||yh[W]||(W in mp?W:yh[W]=function Fh(W){for(var pe=W[0].toUpperCase()+W.slice(1),Me=fp.length;Me--;)if((W=fp[Me]+pe)in mp)return W}(W)||W)}var Dh=/^(none|table(?!-c[ea]).+)/,bh=/^--/,Uh={position:"absolute",visibility:"hidden",display:"block"},Tl={letterSpacing:"0",fontWeight:"400"};function Ml(W,pe,Me){var Ne=yi.exec(pe);return Ne?Math.max(0,Ne[2]-(Me||0))+(Ne[3]||"px"):pe}function ql(W,pe,Me,Ne,Ve,qe){var et="width"===pe?1:0,At=0,Bt=0;if(Me===(Ne?"border":"content"))return 0;for(;et<4;et+=2)"margin"===Me&&(Bt+=H.css(W,Me+Ei[et],!0,Ve)),Ne?("content"===Me&&(Bt-=H.css(W,"padding"+Ei[et],!0,Ve)),"margin"!==Me&&(Bt-=H.css(W,"border"+Ei[et]+"Width",!0,Ve))):(Bt+=H.css(W,"padding"+Ei[et],!0,Ve),"padding"!==Me?Bt+=H.css(W,"border"+Ei[et]+"Width",!0,Ve):At+=H.css(W,"border"+Ei[et]+"Width",!0,Ve));return!Ne&&qe>=0&&(Bt+=Math.max(0,Math.ceil(W["offset"+pe[0].toUpperCase()+pe.slice(1)]-qe-Bt-At-.5))||0),Bt}function qu(W,pe,Me){var Ne=To(W),qe=(!fe.boxSizingReliable()||Me)&&"border-box"===H.css(W,"boxSizing",!1,Ne),et=qe,At=ll(W,pe,Ne),Bt="offset"+pe[0].toUpperCase()+pe.slice(1);if(vh.test(At)){if(!Me)return At;At="auto"}return(!fe.boxSizingReliable()&&qe||!fe.reliableTrDimensions()&&Ae(W,"tr")||"auto"===At||!parseFloat(At)&&"inline"===H.css(W,"display",!1,Ne))&&W.getClientRects().length&&(qe="border-box"===H.css(W,"boxSizing",!1,Ne),(et=Bt in W)&&(At=W[Bt])),(At=parseFloat(At)||0)+ql(W,pe,Me||(qe?"border":"content"),et,Ne,At)+"px"}function ds(W,pe,Me,Ne,Ve){return new ds.prototype.init(W,pe,Me,Ne,Ve)}H.extend({cssHooks:{opacity:{get:function(W,pe){if(pe){var Me=ll(W,"opacity");return""===Me?"1":Me}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(W,pe,Me,Ne){if(W&&3!==W.nodeType&&8!==W.nodeType&&W.style){var Ve,qe,et,At=ni(pe),Bt=bh.test(pe),Xt=W.style;if(Bt||(pe=mc(At)),et=H.cssHooks[pe]||H.cssHooks[At],void 0===Me)return et&&"get"in et&&void 0!==(Ve=et.get(W,!1,Ne))?Ve:Xt[pe];if("string"==(qe=typeof Me)&&(Ve=yi.exec(Me))&&Ve[1]&&(Me=Eo(W,pe,Ve),qe="number"),null==Me||Me!=Me)return;"number"===qe&&!Bt&&(Me+=Ve&&Ve[3]||(H.cssNumber[At]?"":"px")),!fe.clearCloneStyle&&""===Me&&0===pe.indexOf("background")&&(Xt[pe]="inherit"),(!et||!("set"in et)||void 0!==(Me=et.set(W,Me,Ne)))&&(Bt?Xt.setProperty(pe,Me):Xt[pe]=Me)}},css:function(W,pe,Me,Ne){var Ve,qe,et,At=ni(pe);return bh.test(pe)||(pe=mc(At)),(et=H.cssHooks[pe]||H.cssHooks[At])&&"get"in et&&(Ve=et.get(W,!0,Me)),void 0===Ve&&(Ve=ll(W,pe,Ne)),"normal"===Ve&&pe in Tl&&(Ve=Tl[pe]),""===Me||Me?(qe=parseFloat(Ve),!0===Me||isFinite(qe)?qe||0:Ve):Ve}}),H.each(["height","width"],function(W,pe){H.cssHooks[pe]={get:function(Me,Ne,Ve){if(Ne)return!Dh.test(H.css(Me,"display"))||Me.getClientRects().length&&Me.getBoundingClientRect().width?qu(Me,pe,Ve):Zs(Me,Uh,function(){return qu(Me,pe,Ve)})},set:function(Me,Ne,Ve){var qe,et=To(Me),At=!fe.scrollboxSize()&&"absolute"===et.position,Xt=(At||Ve)&&"border-box"===H.css(Me,"boxSizing",!1,et),pn=Ve?ql(Me,pe,Ve,Xt,et):0;return Xt&&At&&(pn-=Math.ceil(Me["offset"+pe[0].toUpperCase()+pe.slice(1)]-parseFloat(et[pe])-ql(Me,pe,"border",!1,et)-.5)),pn&&(qe=yi.exec(Ne))&&"px"!==(qe[3]||"px")&&(Me.style[pe]=Ne,Ne=H.css(Me,pe)),Ml(0,Ne,pn)}}}),H.cssHooks.marginLeft=mu(fe.reliableMarginLeft,function(W,pe){if(pe)return(parseFloat(ll(W,"marginLeft"))||W.getBoundingClientRect().left-Zs(W,{marginLeft:0},function(){return W.getBoundingClientRect().left}))+"px"}),H.each({margin:"",padding:"",border:"Width"},function(W,pe){H.cssHooks[W+pe]={expand:function(Me){for(var Ne=0,Ve={},qe="string"==typeof Me?Me.split(" "):[Me];Ne<4;Ne++)Ve[W+Ei[Ne]+pe]=qe[Ne]||qe[Ne-2]||qe[0];return Ve}},"margin"!==W&&(H.cssHooks[W+pe].set=Ml)}),H.fn.extend({css:function(W,pe){return cr(this,function(Me,Ne,Ve){var qe,et,At={},Bt=0;if(Array.isArray(Ne)){for(qe=To(Me),et=Ne.length;Bt<et;Bt++)At[Ne[Bt]]=H.css(Me,Ne[Bt],!1,qe);return At}return void 0!==Ve?H.style(Me,Ne,Ve):H.css(Me,Ne)},W,pe,arguments.length>1)}}),H.Tween=ds,ds.prototype={constructor:ds,init:function(W,pe,Me,Ne,Ve,qe){this.elem=W,this.prop=Me,this.easing=Ve||H.easing._default,this.options=pe,this.start=this.now=this.cur(),this.end=Ne,this.unit=qe||(H.cssNumber[Me]?"":"px")},cur:function(){var W=ds.propHooks[this.prop];return W&&W.get?W.get(this):ds.propHooks._default.get(this)},run:function(W){var pe,Me=ds.propHooks[this.prop];return this.pos=pe=this.options.duration?H.easing[this.easing](W,this.options.duration*W,0,1,this.options.duration):W,this.now=(this.end-this.start)*pe+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Me&&Me.set?Me.set(this):ds.propHooks._default.set(this),this}},ds.prototype.init.prototype=ds.prototype,ds.propHooks={_default:{get:function(W){var pe;return 1!==W.elem.nodeType||null!=W.elem[W.prop]&&null==W.elem.style[W.prop]?W.elem[W.prop]:(pe=H.css(W.elem,W.prop,""))&&"auto"!==pe?pe:0},set:function(W){H.fx.step[W.prop]?H.fx.step[W.prop](W):1!==W.elem.nodeType||!H.cssHooks[W.prop]&&null==W.elem.style[mc(W.prop)]?W.elem[W.prop]=W.now:H.style(W.elem,W.prop,W.now+W.unit)}}},ds.propHooks.scrollTop=ds.propHooks.scrollLeft={set:function(W){W.elem.nodeType&&W.elem.parentNode&&(W.elem[W.prop]=W.now)}},H.easing={linear:function(W){return W},swing:function(W){return.5-Math.cos(W*Math.PI)/2},_default:"swing"},H.fx=ds.prototype.init,H.fx.step={};var Xl,Xu,_p=/^(?:toggle|show|hide)$/,gp=/queueHooks$/;function Wc(){Xu&&(!1===Y.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(Wc):n.setTimeout(Wc,H.fx.interval),H.fx.tick())}function _c(){return n.setTimeout(function(){Xl=void 0}),Xl=Date.now()}function xh(W,pe){var Me,Ne=0,Ve={height:W};for(pe=pe?1:0;Ne<4;Ne+=2-pe)Ve["margin"+(Me=Ei[Ne])]=Ve["padding"+Me]=W;return pe&&(Ve.opacity=Ve.width=W),Ve}function vp(W,pe,Me){for(var Ne,Ve=(cl.tweeners[pe]||[]).concat(cl.tweeners["*"]),qe=0,et=Ve.length;qe<et;qe++)if(Ne=Ve[qe].call(Me,pe,W))return Ne}function cl(W,pe,Me){var Ne,Ve,qe=0,et=cl.prefilters.length,At=H.Deferred().always(function(){delete Bt.elem}),Bt=function(){if(Ve)return!1;for(var Fn=Xl||_c(),on=Math.max(0,Xt.startTime+Xt.duration-Fn),Er=1-(on/Xt.duration||0),ti=0,Ar=Xt.tweens.length;ti<Ar;ti++)Xt.tweens[ti].run(Er);return At.notifyWith(W,[Xt,Er,on]),Er<1&&Ar?on:(Ar||At.notifyWith(W,[Xt,1,0]),At.resolveWith(W,[Xt]),!1)},Xt=At.promise({elem:W,props:H.extend({},pe),opts:H.extend(!0,{specialEasing:{},easing:H.easing._default},Me),originalProperties:pe,originalOptions:Me,startTime:Xl||_c(),duration:Me.duration,tweens:[],createTween:function(Fn,on){var xn=H.Tween(W,Xt.opts,Fn,on,Xt.opts.specialEasing[Fn]||Xt.opts.easing);return Xt.tweens.push(xn),xn},stop:function(Fn){var on=0,xn=Fn?Xt.tweens.length:0;if(Ve)return this;for(Ve=!0;on<xn;on++)Xt.tweens[on].run(1);return Fn?(At.notifyWith(W,[Xt,1,0]),At.resolveWith(W,[Xt,Fn])):At.rejectWith(W,[Xt,Fn]),this}}),pn=Xt.props;for(function Ju(W,pe){var Me,Ne,Ve,qe,et;for(Me in W)if(Ve=pe[Ne=ni(Me)],qe=W[Me],Array.isArray(qe)&&(Ve=qe[1],qe=W[Me]=qe[0]),Me!==Ne&&(W[Ne]=qe,delete W[Me]),(et=H.cssHooks[Ne])&&"expand"in et)for(Me in qe=et.expand(qe),delete W[Ne],qe)Me in W||(W[Me]=qe[Me],pe[Me]=Ve);else pe[Ne]=Ve}(pn,Xt.opts.specialEasing);qe<et;qe++)if(Ne=cl.prefilters[qe].call(Xt,W,pn,Xt.opts))return le(Ne.stop)&&(H._queueHooks(Xt.elem,Xt.opts.queue).stop=Ne.stop.bind(Ne)),Ne;return H.map(pn,vp,Xt),le(Xt.opts.start)&&Xt.opts.start.call(W,Xt),Xt.progress(Xt.opts.progress).done(Xt.opts.done,Xt.opts.complete).fail(Xt.opts.fail).always(Xt.opts.always),H.fx.timer(H.extend(Bt,{elem:W,anim:Xt,queue:Xt.opts.queue})),Xt}H.Animation=H.extend(cl,{tweeners:{"*":[function(W,pe){var Me=this.createTween(W,pe);return Eo(Me.elem,W,yi.exec(pe),Me),Me}]},tweener:function(W,pe){le(W)?(pe=W,W=["*"]):W=W.match(sn);for(var Me,Ne=0,Ve=W.length;Ne<Ve;Ne++)(cl.tweeners[Me=W[Ne]]=cl.tweeners[Me]||[]).unshift(pe)},prefilters:[function Yu(W,pe,Me){var Ne,Ve,qe,et,At,Bt,Xt,pn,Fn="width"in pe||"height"in pe,on=this,xn={},Er=W.style,ti=W.nodeType&&Ni(W),Ar=rr.get(W,"fxshow");for(Ne in Me.queue||(null==(et=H._queueHooks(W,"fx")).unqueued&&(et.unqueued=0,At=et.empty.fire,et.empty.fire=function(){et.unqueued||At()}),et.unqueued++,on.always(function(){on.always(function(){et.unqueued--,H.queue(W,"fx").length||et.empty.fire()})})),pe)if(_p.test(Ve=pe[Ne])){if(delete pe[Ne],qe=qe||"toggle"===Ve,Ve===(ti?"hide":"show")){if("show"!==Ve||!Ar||void 0===Ar[Ne])continue;ti=!0}xn[Ne]=Ar&&Ar[Ne]||H.style(W,Ne)}if((Bt=!H.isEmptyObject(pe))||!H.isEmptyObject(xn))for(Ne in Fn&&1===W.nodeType&&(Me.overflow=[Er.overflow,Er.overflowX,Er.overflowY],null==(Xt=Ar&&Ar.display)&&(Xt=rr.get(W,"display")),"none"===(pn=H.css(W,"display"))&&(Xt?pn=Xt:(os([W],!0),Xt=W.style.display||Xt,pn=H.css(W,"display"),os([W]))),("inline"===pn||"inline-block"===pn&&null!=Xt)&&"none"===H.css(W,"float")&&(Bt||(on.done(function(){Er.display=Xt}),null==Xt&&(Xt="none"===(pn=Er.display)?"":pn)),Er.display="inline-block")),Me.overflow&&(Er.overflow="hidden",on.always(function(){Er.overflow=Me.overflow[0],Er.overflowX=Me.overflow[1],Er.overflowY=Me.overflow[2]})),Bt=!1,xn)Bt||(Ar?"hidden"in Ar&&(ti=Ar.hidden):Ar=rr.access(W,"fxshow",{display:Xt}),qe&&(Ar.hidden=!ti),ti&&os([W],!0),on.done(function(){for(Ne in ti||os([W]),rr.remove(W,"fxshow"),xn)H.style(W,Ne,xn[Ne])})),Bt=vp(ti?Ar[Ne]:0,Ne,on),Ne in Ar||(Ar[Ne]=Bt.start,ti&&(Bt.end=Bt.start,Bt.start=0))}],prefilter:function(W,pe){pe?cl.prefilters.unshift(W):cl.prefilters.push(W)}}),H.speed=function(W,pe,Me){var Ne=W&&"object"==typeof W?H.extend({},W):{complete:Me||!Me&&pe||le(W)&&W,duration:W,easing:Me&&pe||pe&&!le(pe)&&pe};return H.fx.off?Ne.duration=0:"number"!=typeof Ne.duration&&(Ne.duration=Ne.duration in H.fx.speeds?H.fx.speeds[Ne.duration]:H.fx.speeds._default),(null==Ne.queue||!0===Ne.queue)&&(Ne.queue="fx"),Ne.old=Ne.complete,Ne.complete=function(){le(Ne.old)&&Ne.old.call(this),Ne.queue&&H.dequeue(this,Ne.queue)},Ne},H.fn.extend({fadeTo:function(W,pe,Me,Ne){return this.filter(Ni).css("opacity",0).show().end().animate({opacity:pe},W,Me,Ne)},animate:function(W,pe,Me,Ne){var Ve=H.isEmptyObject(W),qe=H.speed(pe,Me,Ne),et=function(){var At=cl(this,H.extend({},W),qe);(Ve||rr.get(this,"finish"))&&At.stop(!0)};return et.finish=et,Ve||!1===qe.queue?this.each(et):this.queue(qe.queue,et)},stop:function(W,pe,Me){var Ne=function(Ve){var qe=Ve.stop;delete Ve.stop,qe(Me)};return"string"!=typeof W&&(Me=pe,pe=W,W=void 0),pe&&this.queue(W||"fx",[]),this.each(function(){var Ve=!0,qe=null!=W&&W+"queueHooks",et=H.timers,At=rr.get(this);if(qe)At[qe]&&At[qe].stop&&Ne(At[qe]);else for(qe in At)At[qe]&&At[qe].stop&&gp.test(qe)&&Ne(At[qe]);for(qe=et.length;qe--;)et[qe].elem===this&&(null==W||et[qe].queue===W)&&(et[qe].anim.stop(Me),Ve=!1,et.splice(qe,1));(Ve||!Me)&&H.dequeue(this,W)})},finish:function(W){return!1!==W&&(W=W||"fx"),this.each(function(){var pe,Me=rr.get(this),Ne=Me[W+"queue"],Ve=Me[W+"queueHooks"],qe=H.timers,et=Ne?Ne.length:0;for(Me.finish=!0,H.queue(this,W,[]),Ve&&Ve.stop&&Ve.stop.call(this,!0),pe=qe.length;pe--;)qe[pe].elem===this&&qe[pe].queue===W&&(qe[pe].anim.stop(!0),qe.splice(pe,1));for(pe=0;pe<et;pe++)Ne[pe]&&Ne[pe].finish&&Ne[pe].finish.call(this);delete Me.finish})}}),H.each(["toggle","show","hide"],function(W,pe){var Me=H.fn[pe];H.fn[pe]=function(Ne,Ve,qe){return null==Ne||"boolean"==typeof Ne?Me.apply(this,arguments):this.animate(xh(pe,!0),Ne,Ve,qe)}}),H.each({slideDown:xh("show"),slideUp:xh("hide"),slideToggle:xh("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(W,pe){H.fn[W]=function(Me,Ne,Ve){return this.animate(pe,Me,Ne,Ve)}}),H.timers=[],H.fx.tick=function(){var W,pe=0,Me=H.timers;for(Xl=Date.now();pe<Me.length;pe++)!(W=Me[pe])()&&Me[pe]===W&&Me.splice(pe--,1);Me.length||H.fx.stop(),Xl=void 0},H.fx.timer=function(W){H.timers.push(W),H.fx.start()},H.fx.interval=13,H.fx.start=function(){Xu||(Xu=!0,Wc())},H.fx.stop=function(){Xu=null},H.fx.speeds={slow:600,fast:200,_default:400},H.fn.delay=function(W,pe){return W=H.fx&&H.fx.speeds[W]||W,this.queue(pe=pe||"fx",function(Me,Ne){var Ve=n.setTimeout(Me,W);Ne.stop=function(){n.clearTimeout(Ve)}})},function(){var W=Y.createElement("input"),Me=Y.createElement("select").appendChild(Y.createElement("option"));W.type="checkbox",fe.checkOn=""!==W.value,fe.optSelected=Me.selected,(W=Y.createElement("input")).value="t",W.type="radio",fe.radioValue="t"===W.value}();var zh,ul=H.expr.attrHandle;H.fn.extend({attr:function(W,pe){return cr(this,H.attr,W,pe,arguments.length>1)},removeAttr:function(W){return this.each(function(){H.removeAttr(this,W)})}}),H.extend({attr:function(W,pe,Me){var Ne,Ve,qe=W.nodeType;if(3!==qe&&8!==qe&&2!==qe)return typeof W.getAttribute>"u"?H.prop(W,pe,Me):((1!==qe||!H.isXMLDoc(W))&&(Ve=H.attrHooks[pe.toLowerCase()]||(H.expr.match.bool.test(pe)?zh:void 0)),void 0!==Me?null===Me?void H.removeAttr(W,pe):Ve&&"set"in Ve&&void 0!==(Ne=Ve.set(W,Me,pe))?Ne:(W.setAttribute(pe,Me+""),Me):Ve&&"get"in Ve&&null!==(Ne=Ve.get(W,pe))?Ne:(Ne=H.find.attr(W,pe))??void 0)},attrHooks:{type:{set:function(W,pe){if(!fe.radioValue&&"radio"===pe&&Ae(W,"input")){var Me=W.value;return W.setAttribute("type",pe),Me&&(W.value=Me),pe}}}},removeAttr:function(W,pe){var Me,Ne=0,Ve=pe&&pe.match(sn);if(Ve&&1===W.nodeType)for(;Me=Ve[Ne++];)W.removeAttribute(Me)}}),zh={set:function(W,pe,Me){return!1===pe?H.removeAttr(W,Me):W.setAttribute(Me,Me),Me}},H.each(H.expr.match.bool.source.match(/\w+/g),function(W,pe){var Me=ul[pe]||H.find.attr;ul[pe]=function(Ne,Ve,qe){var et,At,Bt=Ve.toLowerCase();return qe||(At=ul[Bt],ul[Bt]=et,et=null!=Me(Ne,Ve,qe)?Bt:null,ul[Bt]=At),et}});var jh=/^(?:input|select|textarea|button)$/i,Zu=/^(?:a|area)$/i;function vc(W){return(W.match(sn)||[]).join(" ")}function yc(W){return W.getAttribute&&W.getAttribute("class")||""}function wh(W){return Array.isArray(W)?W:"string"==typeof W&&W.match(sn)||[]}H.fn.extend({prop:function(W,pe){return cr(this,H.prop,W,pe,arguments.length>1)},removeProp:function(W){return this.each(function(){delete this[H.propFix[W]||W]})}}),H.extend({prop:function(W,pe,Me){var Ne,Ve,qe=W.nodeType;if(3!==qe&&8!==qe&&2!==qe)return(1!==qe||!H.isXMLDoc(W))&&(Ve=H.propHooks[pe=H.propFix[pe]||pe]),void 0!==Me?Ve&&"set"in Ve&&void 0!==(Ne=Ve.set(W,Me,pe))?Ne:W[pe]=Me:Ve&&"get"in Ve&&null!==(Ne=Ve.get(W,pe))?Ne:W[pe]},propHooks:{tabIndex:{get:function(W){var pe=H.find.attr(W,"tabindex");return pe?parseInt(pe,10):jh.test(W.nodeName)||Zu.test(W.nodeName)&&W.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),fe.optSelected||(H.propHooks.selected={get:function(W){return null},set:function(W){}}),H.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){H.propFix[this.toLowerCase()]=this}),H.fn.extend({addClass:function(W){var pe,Me,Ne,Ve,qe,et,At,Bt=0;if(le(W))return this.each(function(Xt){H(this).addClass(W.call(this,Xt,yc(this)))});if((pe=wh(W)).length)for(;Me=this[Bt++];)if(Ve=yc(Me),Ne=1===Me.nodeType&&" "+vc(Ve)+" "){for(et=0;qe=pe[et++];)Ne.indexOf(" "+qe+" ")<0&&(Ne+=qe+" ");Ve!==(At=vc(Ne))&&Me.setAttribute("class",At)}return this},removeClass:function(W){var pe,Me,Ne,Ve,qe,et,At,Bt=0;if(le(W))return this.each(function(Xt){H(this).removeClass(W.call(this,Xt,yc(this)))});if(!arguments.length)return this.attr("class","");if((pe=wh(W)).length)for(;Me=this[Bt++];)if(Ve=yc(Me),Ne=1===Me.nodeType&&" "+vc(Ve)+" "){for(et=0;qe=pe[et++];)for(;Ne.indexOf(" "+qe+" ")>-1;)Ne=Ne.replace(" "+qe+" "," ");Ve!==(At=vc(Ne))&&Me.setAttribute("class",At)}return this},toggleClass:function(W,pe){var Me=typeof W,Ne="string"===Me||Array.isArray(W);return"boolean"==typeof pe&&Ne?pe?this.addClass(W):this.removeClass(W):le(W)?this.each(function(Ve){H(this).toggleClass(W.call(this,Ve,yc(this),pe),pe)}):this.each(function(){var Ve,qe,et,At;if(Ne)for(qe=0,et=H(this),At=wh(W);Ve=At[qe++];)et.hasClass(Ve)?et.removeClass(Ve):et.addClass(Ve);else(void 0===W||"boolean"===Me)&&((Ve=yc(this))&&rr.set(this,"__className__",Ve),this.setAttribute&&this.setAttribute("class",Ve||!1===W?"":rr.get(this,"__className__")||""))})},hasClass:function(W){var pe,Me,Ne=0;for(pe=" "+W+" ";Me=this[Ne++];)if(1===Me.nodeType&&(" "+vc(yc(Me))+" ").indexOf(pe)>-1)return!0;return!1}});var _u=/\r/g;H.fn.extend({val:function(W){var pe,Me,Ne,Ve=this[0];return arguments.length?(Ne=le(W),this.each(function(qe){var et;1===this.nodeType&&(null==(et=Ne?W.call(this,qe,H(this).val()):W)?et="":"number"==typeof et?et+="":Array.isArray(et)&&(et=H.map(et,function(At){return null==At?"":At+""})),(!(pe=H.valHooks[this.type]||H.valHooks[this.nodeName.toLowerCase()])||!("set"in pe)||void 0===pe.set(this,et,"value"))&&(this.value=et))})):Ve?(pe=H.valHooks[Ve.type]||H.valHooks[Ve.nodeName.toLowerCase()])&&"get"in pe&&void 0!==(Me=pe.get(Ve,"value"))?Me:"string"==typeof(Me=Ve.value)?Me.replace(_u,""):Me??"":void 0}}),H.extend({valHooks:{option:{get:function(W){return H.find.attr(W,"value")??vc(H.text(W))}},select:{get:function(W){var pe,Me,Ne,Ve=W.options,qe=W.selectedIndex,et="select-one"===W.type,At=et?null:[],Bt=et?qe+1:Ve.length;for(Ne=qe<0?Bt:et?qe:0;Ne<Bt;Ne++)if(((Me=Ve[Ne]).selected||Ne===qe)&&!Me.disabled&&(!Me.parentNode.disabled||!Ae(Me.parentNode,"optgroup"))){if(pe=H(Me).val(),et)return pe;At.push(pe)}return At},set:function(W,pe){for(var Me,Ne,Ve=W.options,qe=H.makeArray(pe),et=Ve.length;et--;)((Ne=Ve[et]).selected=H.inArray(H.valHooks.option.get(Ne),qe)>-1)&&(Me=!0);return Me||(W.selectedIndex=-1),qe}}}}),H.each(["radio","checkbox"],function(){H.valHooks[this]={set:function(W,pe){if(Array.isArray(pe))return W.checked=H.inArray(H(W).val(),pe)>-1}},fe.checkOn||(H.valHooks[this].get=function(W){return null===W.getAttribute("value")?"on":W.value})}),fe.focusin="onfocusin"in n;var qc=/^(?:focusinfocus|focusoutblur)$/,yp=function(W){W.stopPropagation()};H.extend(H.event,{trigger:function(W,pe,Me,Ne){var Ve,qe,et,At,Bt,Xt,pn,Fn,on=[Me||Y],xn=ye.call(W,"type")?W.type:W,Er=ye.call(W,"namespace")?W.namespace.split("."):[];if(qe=Fn=et=Me=Me||Y,3!==Me.nodeType&&8!==Me.nodeType&&!qc.test(xn+H.event.triggered)&&(xn.indexOf(".")>-1&&(Er=xn.split("."),xn=Er.shift(),Er.sort()),Bt=xn.indexOf(":")<0&&"on"+xn,(W=W[H.expando]?W:new H.Event(xn,"object"==typeof W&&W)).isTrigger=Ne?2:3,W.namespace=Er.join("."),W.rnamespace=W.namespace?new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,W.result=void 0,W.target||(W.target=Me),pe=null==pe?[W]:H.makeArray(pe,[W]),pn=H.event.special[xn]||{},Ne||!pn.trigger||!1!==pn.trigger.apply(Me,pe))){if(!Ne&&!pn.noBubble&&!q(Me)){for(qc.test((At=pn.delegateType||xn)+xn)||(qe=qe.parentNode);qe;qe=qe.parentNode)on.push(qe),et=qe;et===(Me.ownerDocument||Y)&&on.push(et.defaultView||et.parentWindow||n)}for(Ve=0;(qe=on[Ve++])&&!W.isPropagationStopped();)Fn=qe,W.type=Ve>1?At:pn.bindType||xn,(Xt=(rr.get(qe,"events")||Object.create(null))[W.type]&&rr.get(qe,"handle"))&&Xt.apply(qe,pe),(Xt=Bt&&qe[Bt])&&Xt.apply&&Kr(qe)&&(W.result=Xt.apply(qe,pe),!1===W.result&&W.preventDefault());return W.type=xn,!Ne&&!W.isDefaultPrevented()&&(!pn._default||!1===pn._default.apply(on.pop(),pe))&&Kr(Me)&&Bt&&le(Me[xn])&&!q(Me)&&((et=Me[Bt])&&(Me[Bt]=null),H.event.triggered=xn,W.isPropagationStopped()&&Fn.addEventListener(xn,yp),Me[xn](),W.isPropagationStopped()&&Fn.removeEventListener(xn,yp),H.event.triggered=void 0,et&&(Me[Bt]=et)),W.result}},simulate:function(W,pe,Me){var Ne=H.extend(new H.Event,Me,{type:W,isSimulated:!0});H.event.trigger(Ne,null,pe)}}),H.fn.extend({trigger:function(W,pe){return this.each(function(){H.event.trigger(W,pe,this)})},triggerHandler:function(W,pe){var Me=this[0];if(Me)return H.event.trigger(W,pe,Me,!0)}}),fe.focusin||H.each({focus:"focusin",blur:"focusout"},function(W,pe){var Me=function(Ne){H.event.simulate(pe,Ne.target,H.event.fix(Ne))};H.event.special[pe]={setup:function(){var Ne=this.ownerDocument||this.document||this,Ve=rr.access(Ne,pe);Ve||Ne.addEventListener(W,Me,!0),rr.access(Ne,pe,(Ve||0)+1)},teardown:function(){var Ne=this.ownerDocument||this.document||this,Ve=rr.access(Ne,pe)-1;Ve?rr.access(Ne,pe,Ve):(Ne.removeEventListener(W,Me,!0),rr.remove(Ne,pe))}}});var Xc=n.location,Qu={guid:Date.now()},Yl=/\?/;H.parseXML=function(W){var pe;if(!W||"string"!=typeof W)return null;try{pe=(new n.DOMParser).parseFromString(W,"text/xml")}catch{pe=void 0}return(!pe||pe.getElementsByTagName("parsererror").length)&&H.error("Invalid XML: "+W),pe};var bp=/\[\]$/,Gh=/\r?\n/g,xp=/^(?:submit|button|image|reset|file)$/i,wp=/^(?:input|select|textarea|keygen)/i;function Hh(W,pe,Me,Ne){var Ve;if(Array.isArray(pe))H.each(pe,function(qe,et){Me||bp.test(W)?Ne(W,et):Hh(W+"["+("object"==typeof et&&null!=et?qe:"")+"]",et,Me,Ne)});else if(Me||"object"!==X(pe))Ne(W,pe);else for(Ve in pe)Hh(W+"["+Ve+"]",pe[Ve],Me,Ne)}H.param=function(W,pe){var Me,Ne=[],Ve=function(qe,et){var At=le(et)?et():et;Ne[Ne.length]=encodeURIComponent(qe)+"="+encodeURIComponent(At??"")};if(null==W)return"";if(Array.isArray(W)||W.jquery&&!H.isPlainObject(W))H.each(W,function(){Ve(this.name,this.value)});else for(Me in W)Hh(Me,W[Me],pe,Ve);return Ne.join("&")},H.fn.extend({serialize:function(){return H.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var W=H.prop(this,"elements");return W?H.makeArray(W):this}).filter(function(){var W=this.type;return this.name&&!H(this).is(":disabled")&&wp.test(this.nodeName)&&!xp.test(W)&&(this.checked||!Ir.test(W))}).map(function(W,pe){var Me=H(this).val();return null==Me?null:Array.isArray(Me)?H.map(Me,function(Ne){return{name:pe.name,value:Ne.replace(Gh,"\r\n")}}):{name:pe.name,value:Me.replace(Gh,"\r\n")}}).get()}});var Wp=/%20/g,gu=/#.*$/,qa=/([?&])_=[^&]*/,bc=/^(.*?):[ \t]*([^\r\n]*)$/gm,Zl=/^(?:GET|HEAD)$/,Ku=/^\/\//,La={},pa={},Al="*/".concat("*"),eh=Y.createElement("a");function th(W){return function(pe,Me){"string"!=typeof pe&&(Me=pe,pe="*");var Ne,Ve=0,qe=pe.toLowerCase().match(sn)||[];if(le(Me))for(;Ne=qe[Ve++];)"+"===Ne[0]?(Ne=Ne.slice(1)||"*",(W[Ne]=W[Ne]||[]).unshift(Me)):(W[Ne]=W[Ne]||[]).push(Me)}}function Vh(W,pe,Me,Ne){var Ve={},qe=W===pa;function et(At){var Bt;return Ve[At]=!0,H.each(W[At]||[],function(Xt,pn){var Fn=pn(pe,Me,Ne);return"string"!=typeof Fn||qe||Ve[Fn]?qe?!(Bt=Fn):void 0:(pe.dataTypes.unshift(Fn),et(Fn),!1)}),Bt}return et(pe.dataTypes[0])||!Ve["*"]&&et("*")}function Sp(W,pe){var Me,Ne,Ve=H.ajaxSettings.flatOptions||{};for(Me in pe)void 0!==pe[Me]&&((Ve[Me]?W:Ne||(Ne={}))[Me]=pe[Me]);return Ne&&H.extend(!0,W,Ne),W}eh.href=Xc.href,H.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Xc.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Xc.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Al,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":H.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(W,pe){return pe?Sp(Sp(W,H.ajaxSettings),pe):Sp(H.ajaxSettings,W)},ajaxPrefilter:th(La),ajaxTransport:th(pa),ajax:function(W,pe){"object"==typeof W&&(pe=W,W=void 0);var Me,Ne,Ve,qe,et,At,Bt,Xt,pn,Fn,on=H.ajaxSetup({},pe=pe||{}),xn=on.context||on,Er=on.context&&(xn.nodeType||xn.jquery)?H(xn):H.event,ti=H.Deferred(),Ar=H.Callbacks("once memory"),fs=on.statusCode||{},es={},da={},bi="canceled",Br={readyState:0,getResponseHeader:function(Wi){var qi;if(Bt){if(!qe)for(qe={};qi=bc.exec(Ve);)qe[qi[1].toLowerCase()+" "]=(qe[qi[1].toLowerCase()+" "]||[]).concat(qi[2]);qi=qe[Wi.toLowerCase()+" "]}return null==qi?null:qi.join(", ")},getAllResponseHeaders:function(){return Bt?Ve:null},setRequestHeader:function(Wi,qi){return null==Bt&&(Wi=da[Wi.toLowerCase()]=da[Wi.toLowerCase()]||Wi,es[Wi]=qi),this},overrideMimeType:function(Wi){return null==Bt&&(on.mimeType=Wi),this},statusCode:function(Wi){var qi;if(Wi)if(Bt)Br.always(Wi[Br.status]);else for(qi in Wi)fs[qi]=[fs[qi],Wi[qi]];return this},abort:function(Wi){var qi=Wi||bi;return Me&&Me.abort(qi),Xa(0,qi),this}};if(ti.promise(Br),on.url=((W||on.url||Xc.href)+"").replace(Ku,Xc.protocol+"//"),on.type=pe.method||pe.type||on.method||on.type,on.dataTypes=(on.dataType||"*").toLowerCase().match(sn)||[""],null==on.crossDomain){At=Y.createElement("a");try{At.href=on.url,At.href=At.href,on.crossDomain=eh.protocol+"//"+eh.host!=At.protocol+"//"+At.host}catch{on.crossDomain=!0}}if(on.data&&on.processData&&"string"!=typeof on.data&&(on.data=H.param(on.data,on.traditional)),Vh(La,on,pe,Br),Bt)return Br;for(pn in(Xt=H.event&&on.global)&&0==H.active++&&H.event.trigger("ajaxStart"),on.type=on.type.toUpperCase(),on.hasContent=!Zl.test(on.type),Ne=on.url.replace(gu,""),on.hasContent?on.data&&on.processData&&0===(on.contentType||"").indexOf("application/x-www-form-urlencoded")&&(on.data=on.data.replace(Wp,"+")):(Fn=on.url.slice(Ne.length),on.data&&(on.processData||"string"==typeof on.data)&&(Ne+=(Yl.test(Ne)?"&":"?")+on.data,delete on.data),!1===on.cache&&(Ne=Ne.replace(qa,"$1"),Fn=(Yl.test(Ne)?"&":"?")+"_="+Qu.guid+++Fn),on.url=Ne+Fn),on.ifModified&&(H.lastModified[Ne]&&Br.setRequestHeader("If-Modified-Since",H.lastModified[Ne]),H.etag[Ne]&&Br.setRequestHeader("If-None-Match",H.etag[Ne])),(on.data&&on.hasContent&&!1!==on.contentType||pe.contentType)&&Br.setRequestHeader("Content-Type",on.contentType),Br.setRequestHeader("Accept",on.dataTypes[0]&&on.accepts[on.dataTypes[0]]?on.accepts[on.dataTypes[0]]+("*"!==on.dataTypes[0]?", "+Al+"; q=0.01":""):on.accepts["*"]),on.headers)Br.setRequestHeader(pn,on.headers[pn]);if(on.beforeSend&&(!1===on.beforeSend.call(xn,Br,on)||Bt))return Br.abort();if(bi="abort",Ar.add(on.complete),Br.done(on.success),Br.fail(on.error),Me=Vh(pa,on,pe,Br)){if(Br.readyState=1,Xt&&Er.trigger("ajaxSend",[Br,on]),Bt)return Br;on.async&&on.timeout>0&&(et=n.setTimeout(function(){Br.abort("timeout")},on.timeout));try{Bt=!1,Me.send(es,Xa)}catch(Wi){if(Bt)throw Wi;Xa(-1,Wi)}}else Xa(-1,"No Transport");function Xa(Wi,qi,qh,wc){var fa,pl,ma,Ri,Ds,tr=qi;Bt||(Bt=!0,et&&n.clearTimeout(et),Me=void 0,Ve=wc||"",Br.readyState=Wi>0?4:0,fa=Wi>=200&&Wi<300||304===Wi,qh&&(Ri=function Ep(W,pe,Me){for(var Ne,Ve,qe,et,At=W.contents,Bt=W.dataTypes;"*"===Bt[0];)Bt.shift(),void 0===Ne&&(Ne=W.mimeType||pe.getResponseHeader("Content-Type"));if(Ne)for(Ve in At)if(At[Ve]&&At[Ve].test(Ne)){Bt.unshift(Ve);break}if(Bt[0]in Me)qe=Bt[0];else{for(Ve in Me){if(!Bt[0]||W.converters[Ve+" "+Bt[0]]){qe=Ve;break}et||(et=Ve)}qe=qe||et}if(qe)return qe!==Bt[0]&&Bt.unshift(qe),Me[qe]}(on,Br,qh)),!fa&&H.inArray("script",on.dataTypes)>-1&&(on.converters["text script"]=function(){}),Ri=function Zi(W,pe,Me,Ne){var Ve,qe,et,At,Bt,Xt={},pn=W.dataTypes.slice();if(pn[1])for(et in W.converters)Xt[et.toLowerCase()]=W.converters[et];for(qe=pn.shift();qe;)if(W.responseFields[qe]&&(Me[W.responseFields[qe]]=pe),!Bt&&Ne&&W.dataFilter&&(pe=W.dataFilter(pe,W.dataType)),Bt=qe,qe=pn.shift())if("*"===qe)qe=Bt;else if("*"!==Bt&&Bt!==qe){if(!(et=Xt[Bt+" "+qe]||Xt["* "+qe]))for(Ve in Xt)if((At=Ve.split(" "))[1]===qe&&(et=Xt[Bt+" "+At[0]]||Xt["* "+At[0]])){!0===et?et=Xt[Ve]:!0!==Xt[Ve]&&(qe=At[0],pn.unshift(At[1]));break}if(!0!==et)if(et&&W.throws)pe=et(pe);else try{pe=et(pe)}catch(Fn){return{state:"parsererror",error:et?Fn:"No conversion from "+Bt+" to "+qe}}}return{state:"success",data:pe}}(on,Ri,Br,fa),fa?(on.ifModified&&((Ds=Br.getResponseHeader("Last-Modified"))&&(H.lastModified[Ne]=Ds),(Ds=Br.getResponseHeader("etag"))&&(H.etag[Ne]=Ds)),204===Wi||"HEAD"===on.type?tr="nocontent":304===Wi?tr="notmodified":(tr=Ri.state,pl=Ri.data,fa=!(ma=Ri.error))):(ma=tr,(Wi||!tr)&&(tr="error",Wi<0&&(Wi=0))),Br.status=Wi,Br.statusText=(qi||tr)+"",fa?ti.resolveWith(xn,[pl,tr,Br]):ti.rejectWith(xn,[Br,tr,ma]),Br.statusCode(fs),fs=void 0,Xt&&Er.trigger(fa?"ajaxSuccess":"ajaxError",[Br,on,fa?pl:ma]),Ar.fireWith(xn,[Br,tr]),Xt&&(Er.trigger("ajaxComplete",[Br,on]),--H.active||H.event.trigger("ajaxStop")))}return Br},getJSON:function(W,pe,Me){return H.get(W,pe,Me,"json")},getScript:function(W,pe){return H.get(W,void 0,pe,"script")}}),H.each(["get","post"],function(W,pe){H[pe]=function(Me,Ne,Ve,qe){return le(Ne)&&(qe=qe||Ve,Ve=Ne,Ne=void 0),H.ajax(H.extend({url:Me,type:pe,dataType:qe,data:Ne,success:Ve},H.isPlainObject(Me)&&Me))}}),H.ajaxPrefilter(function(W){var pe;for(pe in W.headers)"content-type"===pe.toLowerCase()&&(W.contentType=W.headers[pe]||"")}),H._evalUrl=function(W,pe,Me){return H.ajax({url:W,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(Ne){H.globalEval(Ne,pe,Me)}})},H.fn.extend({wrapAll:function(W){var pe;return this[0]&&(le(W)&&(W=W.call(this[0])),pe=H(W,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&pe.insertBefore(this[0]),pe.map(function(){for(var Me=this;Me.firstElementChild;)Me=Me.firstElementChild;return Me}).append(this)),this},wrapInner:function(W){return le(W)?this.each(function(pe){H(this).wrapInner(W.call(this,pe))}):this.each(function(){var pe=H(this),Me=pe.contents();Me.length?Me.wrapAll(W):pe.append(W)})},wrap:function(W){var pe=le(W);return this.each(function(Me){H(this).wrapAll(pe?W.call(this,Me):W)})},unwrap:function(W){return this.parent(W).not("body").each(function(){H(this).replaceWith(this.childNodes)}),this}}),H.expr.pseudos.hidden=function(W){return!H.expr.pseudos.visible(W)},H.expr.pseudos.visible=function(W){return!!(W.offsetWidth||W.offsetHeight||W.getClientRects().length)},H.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var hl={0:200,1223:204},Ql=H.ajaxSettings.xhr();fe.cors=!!Ql&&"withCredentials"in Ql,fe.ajax=Ql=!!Ql,H.ajaxTransport(function(W){var pe,Me;if(fe.cors||Ql&&!W.crossDomain)return{send:function(Ne,Ve){var qe,et=W.xhr();if(et.open(W.type,W.url,W.async,W.username,W.password),W.xhrFields)for(qe in W.xhrFields)et[qe]=W.xhrFields[qe];for(qe in W.mimeType&&et.overrideMimeType&&et.overrideMimeType(W.mimeType),!W.crossDomain&&!Ne["X-Requested-With"]&&(Ne["X-Requested-With"]="XMLHttpRequest"),Ne)et.setRequestHeader(qe,Ne[qe]);pe=function(At){return function(){pe&&(pe=Me=et.onload=et.onerror=et.onabort=et.ontimeout=et.onreadystatechange=null,"abort"===At?et.abort():"error"===At?"number"!=typeof et.status?Ve(0,"error"):Ve(et.status,et.statusText):Ve(hl[et.status]||et.status,et.statusText,"text"!==(et.responseType||"text")||"string"!=typeof et.responseText?{binary:et.response}:{text:et.responseText},et.getAllResponseHeaders()))}},et.onload=pe(),Me=et.onerror=et.ontimeout=pe("error"),void 0!==et.onabort?et.onabort=Me:et.onreadystatechange=function(){4===et.readyState&&n.setTimeout(function(){pe&&Me()})},pe=pe("abort");try{et.send(W.hasContent&&W.data||null)}catch(At){if(pe)throw At}},abort:function(){pe&&pe()}}}),H.ajaxPrefilter(function(W){W.crossDomain&&(W.contents.script=!1)}),H.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(W){return H.globalEval(W),W}}}),H.ajaxPrefilter("script",function(W){void 0===W.cache&&(W.cache=!1),W.crossDomain&&(W.type="GET")}),H.ajaxTransport("script",function(W){var pe,Me;if(W.crossDomain||W.scriptAttrs)return{send:function(Ne,Ve){pe=H("<script>").attr(W.scriptAttrs||{}).prop({charset:W.scriptCharset,src:W.url}).on("load error",Me=function(qe){pe.remove(),Me=null,qe&&Ve("error"===qe.type?404:200,qe.type)}),Y.head.appendChild(pe[0])},abort:function(){Me&&Me()}}});var W,Yc=[],Wh=/(=)\?(?=&|$)|\?\?/;H.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var W=Yc.pop()||H.expando+"_"+Qu.guid++;return this[W]=!0,W}}),H.ajaxPrefilter("json jsonp",function(W,pe,Me){var Ne,Ve,qe,et=!1!==W.jsonp&&(Wh.test(W.url)?"url":"string"==typeof W.data&&0===(W.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wh.test(W.data)&&"data");if(et||"jsonp"===W.dataTypes[0])return Ne=W.jsonpCallback=le(W.jsonpCallback)?W.jsonpCallback():W.jsonpCallback,et?W[et]=W[et].replace(Wh,"$1"+Ne):!1!==W.jsonp&&(W.url+=(Yl.test(W.url)?"&":"?")+W.jsonp+"="+Ne),W.converters["script json"]=function(){return qe||H.error(Ne+" was not called"),qe[0]},W.dataTypes[0]="json",Ve=n[Ne],n[Ne]=function(){qe=arguments},Me.always(function(){void 0===Ve?H(n).removeProp(Ne):n[Ne]=Ve,W[Ne]&&(W.jsonpCallback=pe.jsonpCallback,Yc.push(Ne)),qe&&le(Ve)&&Ve(qe[0]),qe=Ve=void 0}),"script"}),fe.createHTMLDocument=((W=Y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===W.childNodes.length),H.parseHTML=function(W,pe,Me){return"string"!=typeof W?[]:("boolean"==typeof pe&&(Me=pe,pe=!1),pe||(fe.createHTMLDocument?((Ne=(pe=Y.implementation.createHTMLDocument("")).createElement("base")).href=Y.location.href,pe.head.appendChild(Ne)):pe=Y),qe=!Me&&[],(Ve=Xe.exec(W))?[pe.createElement(Ve[1])]:(Ve=kh([W],pe,qe),qe&&qe.length&&H(qe).remove(),H.merge([],Ve.childNodes)));var Ne,Ve,qe},H.fn.load=function(W,pe,Me){var Ne,Ve,qe,et=this,At=W.indexOf(" ");return At>-1&&(Ne=vc(W.slice(At)),W=W.slice(0,At)),le(pe)?(Me=pe,pe=void 0):pe&&"object"==typeof pe&&(Ve="POST"),et.length>0&&H.ajax({url:W,type:Ve||"GET",dataType:"html",data:pe}).done(function(Bt){qe=arguments,et.html(Ne?H("<div>").append(H.parseHTML(Bt)).find(Ne):Bt)}).always(Me&&function(Bt,Xt){et.each(function(){Me.apply(this,qe||[Bt.responseText,Xt,Bt])})}),this},H.expr.pseudos.animated=function(W){return H.grep(H.timers,function(pe){return W===pe.elem}).length},H.offset={setOffset:function(W,pe,Me){var Ne,Ve,qe,et,At,Bt,pn=H.css(W,"position"),Fn=H(W),on={};"static"===pn&&(W.style.position="relative"),At=Fn.offset(),qe=H.css(W,"top"),Bt=H.css(W,"left"),("absolute"===pn||"fixed"===pn)&&(qe+Bt).indexOf("auto")>-1?(et=(Ne=Fn.position()).top,Ve=Ne.left):(et=parseFloat(qe)||0,Ve=parseFloat(Bt)||0),le(pe)&&(pe=pe.call(W,Me,H.extend({},At))),null!=pe.top&&(on.top=pe.top-At.top+et),null!=pe.left&&(on.left=pe.left-At.left+Ve),"using"in pe?pe.using.call(W,on):("number"==typeof on.top&&(on.top+="px"),"number"==typeof on.left&&(on.left+="px"),Fn.css(on))}},H.fn.extend({offset:function(W){if(arguments.length)return void 0===W?this:this.each(function(Ve){H.offset.setOffset(this,W,Ve)});var pe,Me,Ne=this[0];return Ne?Ne.getClientRects().length?{top:(pe=Ne.getBoundingClientRect()).top+(Me=Ne.ownerDocument.defaultView).pageYOffset,left:pe.left+Me.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var W,pe,Me,Ne=this[0],Ve={top:0,left:0};if("fixed"===H.css(Ne,"position"))pe=Ne.getBoundingClientRect();else{for(pe=this.offset(),Me=Ne.ownerDocument,W=Ne.offsetParent||Me.documentElement;W&&(W===Me.body||W===Me.documentElement)&&"static"===H.css(W,"position");)W=W.parentNode;W&&W!==Ne&&1===W.nodeType&&((Ve=H(W).offset()).top+=H.css(W,"borderTopWidth",!0),Ve.left+=H.css(W,"borderLeftWidth",!0))}return{top:pe.top-Ve.top-H.css(Ne,"marginTop",!0),left:pe.left-Ve.left-H.css(Ne,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var W=this.offsetParent;W&&"static"===H.css(W,"position");)W=W.offsetParent;return W||So})}}),H.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(W,pe){var Me="pageYOffset"===pe;H.fn[W]=function(Ne){return cr(this,function(Ve,qe,et){var At;if(q(Ve)?At=Ve:9===Ve.nodeType&&(At=Ve.defaultView),void 0===et)return At?At[pe]:Ve[qe];At?At.scrollTo(Me?At.pageXOffset:et,Me?et:At.pageYOffset):Ve[qe]=et},W,Ne,arguments.length)}}),H.each(["top","left"],function(W,pe){H.cssHooks[pe]=mu(fe.pixelPosition,function(Me,Ne){if(Ne)return Ne=ll(Me,pe),vh.test(Ne)?H(Me).position()[pe]+"px":Ne})}),H.each({Height:"height",Width:"width"},function(W,pe){H.each({padding:"inner"+W,content:pe,"":"outer"+W},function(Me,Ne){H.fn[Ne]=function(Ve,qe){var et=arguments.length&&(Me||"boolean"!=typeof Ve),At=Me||(!0===Ve||!0===qe?"margin":"border");return cr(this,function(Bt,Xt,pn){var Fn;return q(Bt)?0===Ne.indexOf("outer")?Bt["inner"+W]:Bt.document.documentElement["client"+W]:9===Bt.nodeType?(Fn=Bt.documentElement,Math.max(Bt.body["scroll"+W],Fn["scroll"+W],Bt.body["offset"+W],Fn["offset"+W],Fn["client"+W])):void 0===pn?H.css(Bt,Xt,At):H.style(Bt,Xt,pn,At)},pe,et?Ve:void 0,et)}})}),H.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(W,pe){H.fn[pe]=function(Me){return this.on(pe,Me)}}),H.fn.extend({bind:function(W,pe,Me){return this.on(W,null,pe,Me)},unbind:function(W,pe){return this.off(W,null,pe)},delegate:function(W,pe,Me,Ne){return this.on(pe,W,Me,Ne)},undelegate:function(W,pe,Me){return 1===arguments.length?this.off(W,"**"):this.off(pe,W||"**",Me)},hover:function(W,pe){return this.mouseenter(W).mouseleave(pe||W)}}),H.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(W,pe){H.fn[pe]=function(Me,Ne){return arguments.length>0?this.on(pe,null,Me,Ne):this.trigger(pe)}});var xc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;H.proxy=function(W,pe){var Me,Ne,Ve;if("string"==typeof pe&&(Me=W[pe],pe=W,W=Me),le(W))return Ne=L.call(arguments,2),Ve=function(){return W.apply(pe||this,Ne.concat(L.call(arguments)))},Ve.guid=W.guid=W.guid||H.guid++,Ve},H.holdReady=function(W){W?H.readyWait++:H.ready(!0)},H.isArray=Array.isArray,H.parseJSON=JSON.parse,H.nodeName=Ae,H.isFunction=le,H.isWindow=q,H.camelCase=ni,H.type=X,H.now=Date.now,H.isNumeric=function(W){var pe=H.type(W);return("number"===pe||"string"===pe)&&!isNaN(W-parseFloat(W))},H.trim=function(W){return null==W?"":(W+"").replace(xc,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return H});var nh=n.jQuery,vu=n.$;return H.noConflict=function(W){return n.$===H&&(n.$=vu),W&&n.jQuery===H&&(n.jQuery=nh),H},typeof o>"u"&&(n.jQuery=n.$=H),H}),function(n,o){"object"==typeof exports&&typeof module<"u"?o(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],o):o((n=typeof globalThis<"u"?globalThis:n||self).bootstrap={},n.jQuery)}(this,function(n,o){"use strict";function l(ke){return ke&&"object"==typeof ke&&"default"in ke?ke:{default:ke}}var x=l(o);function L(ke,De){for(var He=0;He<De.length;He++){var we=De[He];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(ke,we.key,we)}}function D(ke,De,He){return De&&L(ke.prototype,De),He&&L(ke,He),ke}function z(){return z=Object.assign||function(ke){for(var De=1;De<arguments.length;De++){var He=arguments[De];for(var we in He)Object.prototype.hasOwnProperty.call(He,we)&&(ke[we]=He[we])}return ke},z.apply(this,arguments)}var P="transitionend";function fe(ke){var De=this,He=!1;return x.default(this).one(q.TRANSITION_END,function(){He=!0}),setTimeout(function(){He||q.triggerTransitionEnd(De)},ke),this}var q={TRANSITION_END:"bsTransitionEnd",getUID:function(De){do{De+=~~(1e6*Math.random())}while(document.getElementById(De));return De},getSelectorFromElement:function(De){var He=De.getAttribute("data-target");if(!He||"#"===He){var we=De.getAttribute("href");He=we&&"#"!==we?we.trim():""}try{return document.querySelector(He)?He:null}catch{return null}},getTransitionDurationFromElement:function(De){if(!De)return 0;var He=x.default(De).css("transition-duration"),we=x.default(De).css("transition-delay"),ze=parseFloat(He),Ye=parseFloat(we);return ze||Ye?(He=He.split(",")[0],we=we.split(",")[0],1e3*(parseFloat(He)+parseFloat(we))):0},reflow:function(De){return De.offsetHeight},triggerTransitionEnd:function(De){x.default(De).trigger(P)},supportsTransitionEnd:function(){return Boolean(P)},isElement:function(De){return(De[0]||De).nodeType},typeCheckConfig:function(De,He,we){for(var ze in we)if(Object.prototype.hasOwnProperty.call(we,ze)){var Ye=we[ze],bt=He[ze],Ot=bt&&q.isElement(bt)?"element":null===(ke=bt)||typeof ke>"u"?""+ke:{}.toString.call(ke).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Ye).test(Ot))throw new Error(De.toUpperCase()+': Option "'+ze+'" provided type "'+Ot+'" but expected type "'+Ye+'".')}var ke},findShadowRoot:function(De){if(!document.documentElement.attachShadow)return null;if("function"==typeof De.getRootNode){var He=De.getRootNode();return He instanceof ShadowRoot?He:null}return De instanceof ShadowRoot?De:De.parentNode?q.findShadowRoot(De.parentNode):null},jQueryDetection:function(){if(typeof x.default>"u")throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var De=x.default.fn.jquery.split(" ")[0].split(".");if(De[0]<2&&De[1]<9||1===De[0]&&9===De[1]&&De[2]<1||De[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};q.jQueryDetection(),function le(){x.default.fn.emulateTransitionEnd=fe,x.default.event.special[q.TRANSITION_END]=function ae(){return{bindType:P,delegateType:P,handle:function(De){if(x.default(De.target).is(this))return De.handleObj.handler.apply(this,arguments)}}}()}();var Y="alert",N="bs.alert",X="."+N,H=x.default.fn[Y],Q="close"+X,xe="closed"+X,Pe="click"+X+".data-api",Ke=function(){function ke(He){this._element=He}var De=ke.prototype;return De.close=function(we){var ze=this._element;we&&(ze=this._getRootElement(we)),this._triggerCloseEvent(ze).isDefaultPrevented()||this._removeElement(ze)},De.dispose=function(){x.default.removeData(this._element,N),this._element=null},De._getRootElement=function(we){var ze=q.getSelectorFromElement(we),Ye=!1;return ze&&(Ye=document.querySelector(ze)),Ye||(Ye=x.default(we).closest(".alert")[0]),Ye},De._triggerCloseEvent=function(we){var ze=x.default.Event(Q);return x.default(we).trigger(ze),ze},De._removeElement=function(we){var ze=this;if(x.default(we).removeClass("show"),x.default(we).hasClass("fade")){var Ye=q.getTransitionDurationFromElement(we);x.default(we).one(q.TRANSITION_END,function(bt){return ze._destroyElement(we,bt)}).emulateTransitionEnd(Ye)}else this._destroyElement(we)},De._destroyElement=function(we){x.default(we).detach().trigger(xe).remove()},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Ye=ze.data(N);Ye||(Ye=new ke(this),ze.data(N,Ye)),"close"===we&&Ye[we](this)})},ke._handleDismiss=function(we){return function(ze){ze&&ze.preventDefault(),we.close(this)}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(Pe,'[data-dismiss="alert"]',Ke._handleDismiss(new Ke)),x.default.fn[Y]=Ke._jQueryInterface,x.default.fn[Y].Constructor=Ke,x.default.fn[Y].noConflict=function(){return x.default.fn[Y]=H,Ke._jQueryInterface};var yt="button",Pt="bs.button",wt="."+Pt,Gt=".data-api",Dt=x.default.fn[yt],sn="active",Bn='[data-toggle^="button"]',mn='input:not([type="hidden"])',ur="click"+wt+Gt,or="focus"+wt+Gt+" blur"+wt+Gt,ni="load"+wt+Gt,Kr=function(){function ke(He){this._element=He,this.shouldAvoidTriggerChange=!1}var De=ke.prototype;return De.toggle=function(){var we=!0,ze=!0,Ye=x.default(this._element).closest('[data-toggle="buttons"]')[0];if(Ye){var bt=this._element.querySelector(mn);if(bt){if("radio"===bt.type)if(bt.checked&&this._element.classList.contains(sn))we=!1;else{var Ot=Ye.querySelector(".active");Ot&&x.default(Ot).removeClass(sn)}we&&(("checkbox"===bt.type||"radio"===bt.type)&&(bt.checked=!this._element.classList.contains(sn)),this.shouldAvoidTriggerChange||x.default(bt).trigger("change")),bt.focus(),ze=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(ze&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(sn)),we&&x.default(this._element).toggleClass(sn))},De.dispose=function(){x.default.removeData(this._element,Pt),this._element=null},ke._jQueryInterface=function(we,ze){return this.each(function(){var Ye=x.default(this),bt=Ye.data(Pt);bt||(bt=new ke(this),Ye.data(Pt,bt)),bt.shouldAvoidTriggerChange=ze,"toggle"===we&&bt[we]()})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(ur,Bn,function(ke){var De=ke.target,He=De;if(x.default(De).hasClass("btn")||(De=x.default(De).closest(".btn")[0]),!De||De.hasAttribute("disabled")||De.classList.contains("disabled"))ke.preventDefault();else{var we=De.querySelector(mn);if(we&&(we.hasAttribute("disabled")||we.classList.contains("disabled")))return void ke.preventDefault();("INPUT"===He.tagName||"LABEL"!==De.tagName)&&Kr._jQueryInterface.call(x.default(De),"toggle","INPUT"===He.tagName)}}).on(or,Bn,function(ke){var De=x.default(ke.target).closest(".btn")[0];x.default(De).toggleClass("focus",/^focus(in)?$/.test(ke.type))}),x.default(window).on(ni,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),De=0,He=ke.length;De<He;De++){var we=ke[De],ze=we.querySelector(mn);ze.checked||ze.hasAttribute("checked")?we.classList.add(sn):we.classList.remove(sn)}for(var Ye=0,bt=(ke=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;Ye<bt;Ye++){var Ot=ke[Ye];"true"===Ot.getAttribute("aria-pressed")?Ot.classList.add(sn):Ot.classList.remove(sn)}}),x.default.fn[yt]=Kr._jQueryInterface,x.default.fn[yt].Constructor=Kr,x.default.fn[yt].noConflict=function(){return x.default.fn[yt]=Dt,Kr._jQueryInterface};var pi="carousel",vr="bs.carousel",mi="."+vr,go=".data-api",Nr=x.default.fn[pi],So={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Xs={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},ua="next",Ni="prev",Jr="slide"+mi,os="slid"+mi,Ir="keydown"+mi,Va="mouseenter"+mi,Hu="mouseleave"+mi,hs="touchstart"+mi,Ys="touchmove"+mi,ai="touchend"+mi,Gc="pointerdown"+mi,kh="pointerup"+mi,sl="dragstart"+mi,Gp="load"+mi+go,ha="click"+mi+go,Wa="active",fu=".active.carousel-item",lo=".carousel-indicators",vh={TOUCH:"touch",PEN:"pen"},To=function(){function ke(He,we){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(we),this._element=He,this._indicatorsElement=this._element.querySelector(lo),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var De=ke.prototype;return De.next=function(){this._isSliding||this._slide(ua)},De.nextWhenVisible=function(){var we=x.default(this._element);!document.hidden&&we.is(":visible")&&"hidden"!==we.css("visibility")&&this.next()},De.prev=function(){this._isSliding||this._slide(Ni)},De.pause=function(we){we||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(q.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},De.cycle=function(we){we||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},De.to=function(we){var ze=this;this._activeElement=this._element.querySelector(fu);var Ye=this._getItemIndex(this._activeElement);if(!(we>this._items.length-1||we<0)){if(this._isSliding)return void x.default(this._element).one(os,function(){return ze.to(we)});if(Ye===we)return this.pause(),void this.cycle();this._slide(we>Ye?ua:Ni,this._items[we])}},De.dispose=function(){x.default(this._element).off(mi),x.default.removeData(this._element,vr),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},De._getConfig=function(we){return we=z({},So,we),q.typeCheckConfig(pi,we,Xs),we},De._handleSwipe=function(){var we=Math.abs(this.touchDeltaX);if(!(we<=40)){var ze=we/this.touchDeltaX;this.touchDeltaX=0,ze>0&&this.prev(),ze<0&&this.next()}},De._addEventListeners=function(){var we=this;this._config.keyboard&&x.default(this._element).on(Ir,function(ze){return we._keydown(ze)}),"hover"===this._config.pause&&x.default(this._element).on(Va,function(ze){return we.pause(ze)}).on(Hu,function(ze){return we.cycle(ze)}),this._config.touch&&this._addTouchEventListeners()},De._addTouchEventListeners=function(){var we=this;if(this._touchSupported){var ze=function(Wt){we._pointerEvent&&vh[Wt.originalEvent.pointerType.toUpperCase()]?we.touchStartX=Wt.originalEvent.clientX:we._pointerEvent||(we.touchStartX=Wt.originalEvent.touches[0].clientX)},bt=function(Wt){we._pointerEvent&&vh[Wt.originalEvent.pointerType.toUpperCase()]&&(we.touchDeltaX=Wt.originalEvent.clientX-we.touchStartX),we._handleSwipe(),"hover"===we._config.pause&&(we.pause(),we.touchTimeout&&clearTimeout(we.touchTimeout),we.touchTimeout=setTimeout(function(In){return we.cycle(In)},500+we._config.interval))};x.default(this._element.querySelectorAll(".carousel-item img")).on(sl,function(Ot){return Ot.preventDefault()}),this._pointerEvent?(x.default(this._element).on(Gc,function(Ot){return ze(Ot)}),x.default(this._element).on(kh,function(Ot){return bt(Ot)}),this._element.classList.add("pointer-event")):(x.default(this._element).on(hs,function(Ot){return ze(Ot)}),x.default(this._element).on(Ys,function(Ot){var Wt;we.touchDeltaX=(Wt=Ot).originalEvent.touches&&Wt.originalEvent.touches.length>1?0:Wt.originalEvent.touches[0].clientX-we.touchStartX}),x.default(this._element).on(ai,function(Ot){return bt(Ot)}))}},De._keydown=function(we){if(!/input|textarea/i.test(we.target.tagName))switch(we.which){case 37:we.preventDefault(),this.prev();break;case 39:we.preventDefault(),this.next()}},De._getItemIndex=function(we){return this._items=we&&we.parentNode?[].slice.call(we.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(we)},De._getItemByDirection=function(we,ze){var Ye=we===ua,bt=we===Ni,Ot=this._getItemIndex(ze);if((bt&&0===Ot||Ye&&Ot===this._items.length-1)&&!this._config.wrap)return ze;var Hn=(Ot+(we===Ni?-1:1))%this._items.length;return-1===Hn?this._items[this._items.length-1]:this._items[Hn]},De._triggerSlideEvent=function(we,ze){var Ye=this._getItemIndex(we),bt=this._getItemIndex(this._element.querySelector(fu)),Ot=x.default.Event(Jr,{relatedTarget:we,direction:ze,from:bt,to:Ye});return x.default(this._element).trigger(Ot),Ot},De._setActiveIndicatorElement=function(we){if(this._indicatorsElement){var ze=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));x.default(ze).removeClass(Wa);var Ye=this._indicatorsElement.children[this._getItemIndex(we)];Ye&&x.default(Ye).addClass(Wa)}},De._slide=function(we,ze){var Hn,Cr,Ur,Ye=this,bt=this._element.querySelector(fu),Ot=this._getItemIndex(bt),Wt=ze||bt&&this._getItemByDirection(we,bt),In=this._getItemIndex(Wt),Sn=Boolean(this._interval);if(we===ua?(Hn="carousel-item-left",Cr="carousel-item-next",Ur="left"):(Hn="carousel-item-right",Cr="carousel-item-prev",Ur="right"),Wt&&x.default(Wt).hasClass(Wa))this._isSliding=!1;else if(!this._triggerSlideEvent(Wt,Ur).isDefaultPrevented()&&bt&&Wt){this._isSliding=!0,Sn&&this.pause(),this._setActiveIndicatorElement(Wt);var Qt=x.default.Event(os,{relatedTarget:Wt,direction:Ur,from:Ot,to:In});if(x.default(this._element).hasClass("slide")){x.default(Wt).addClass(Cr),q.reflow(Wt),x.default(bt).addClass(Hn),x.default(Wt).addClass(Hn);var Ao=parseInt(Wt.getAttribute("data-interval"),10);Ao?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=Ao):this._config.interval=this._config.defaultInterval||this._config.interval;var ic=q.getTransitionDurationFromElement(bt);x.default(bt).one(q.TRANSITION_END,function(){x.default(Wt).removeClass(Hn+" "+Cr).addClass(Wa),x.default(bt).removeClass(Wa+" "+Cr+" "+Hn),Ye._isSliding=!1,setTimeout(function(){return x.default(Ye._element).trigger(Qt)},0)}).emulateTransitionEnd(ic)}else x.default(bt).removeClass(Wa),x.default(Wt).addClass(Wa),this._isSliding=!1,x.default(this._element).trigger(Qt);Sn&&this.cycle()}},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(vr),Ye=z({},So,x.default(this).data());"object"==typeof we&&(Ye=z({},Ye,we));var bt="string"==typeof we?we:Ye.slide;if(ze||(ze=new ke(this,Ye),x.default(this).data(vr,ze)),"number"==typeof we)ze.to(we);else if("string"==typeof bt){if(typeof ze[bt]>"u")throw new TypeError('No method named "'+bt+'"');ze[bt]()}else Ye.interval&&Ye.ride&&(ze.pause(),ze.cycle())})},ke._dataApiClickHandler=function(we){var ze=q.getSelectorFromElement(this);if(ze){var Ye=x.default(ze)[0];if(Ye&&x.default(Ye).hasClass("carousel")){var bt=z({},x.default(Ye).data(),x.default(this).data()),Ot=this.getAttribute("data-slide-to");Ot&&(bt.interval=!1),ke._jQueryInterface.call(x.default(Ye),bt),Ot&&x.default(Ye).data(vr).to(Ot),we.preventDefault()}}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return So}}]),ke}();x.default(document).on(ha,"[data-slide], [data-slide-to]",To._dataApiClickHandler),x.default(window).on(Gp,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),De=0,He=ke.length;De<He;De++){var we=x.default(ke[De]);To._jQueryInterface.call(we,we.data())}}),x.default.fn[pi]=To._jQueryInterface,x.default.fn[pi].Constructor=To,x.default.fn[pi].noConflict=function(){return x.default.fn[pi]=Nr,To._jQueryInterface};var Zs="collapse",ll="bs.collapse",mu="."+ll,mp=x.default.fn[Zs],yh={toggle:!0,parent:""},Fh={toggle:"boolean",parent:"(string|element)"},mc="show"+mu,Dh="shown"+mu,bh="hide"+mu,Uh="hidden"+mu,Tl="click"+mu+".data-api",Ml="show",ql="collapse",qu="collapsing",ds="collapsed",gp='[data-toggle="collapse"]',Wc=function(){function ke(He,we){this._isTransitioning=!1,this._element=He,this._config=this._getConfig(we),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+He.id+'"],[data-toggle="collapse"][data-target="#'+He.id+'"]'));for(var ze=[].slice.call(document.querySelectorAll(gp)),Ye=0,bt=ze.length;Ye<bt;Ye++){var Ot=ze[Ye],Wt=q.getSelectorFromElement(Ot),In=[].slice.call(document.querySelectorAll(Wt)).filter(function(Sn){return Sn===He});null!==Wt&&In.length>0&&(this._selector=Wt,this._triggerArray.push(Ot))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var De=ke.prototype;return De.toggle=function(){x.default(this._element).hasClass(Ml)?this.hide():this.show()},De.show=function(){var ze,Ye,we=this;if(!(this._isTransitioning||x.default(this._element).hasClass(Ml)||(this._parent&&0===(ze=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(Cr){return"string"==typeof we._config.parent?Cr.getAttribute("data-parent")===we._config.parent:Cr.classList.contains(ql)})).length&&(ze=null),ze&&(Ye=x.default(ze).not(this._selector).data(ll),Ye&&Ye._isTransitioning)))){var bt=x.default.Event(mc);if(x.default(this._element).trigger(bt),!bt.isDefaultPrevented()){ze&&(ke._jQueryInterface.call(x.default(ze).not(this._selector),"hide"),Ye||x.default(ze).data(ll,null));var Ot=this._getDimension();x.default(this._element).removeClass(ql).addClass(qu),this._element.style[Ot]=0,this._triggerArray.length&&x.default(this._triggerArray).removeClass(ds).attr("aria-expanded",!0),this.setTransitioning(!0);var Sn="scroll"+(Ot[0].toUpperCase()+Ot.slice(1)),Hn=q.getTransitionDurationFromElement(this._element);x.default(this._element).one(q.TRANSITION_END,function(){x.default(we._element).removeClass(qu).addClass(ql+" "+Ml),we._element.style[Ot]="",we.setTransitioning(!1),x.default(we._element).trigger(Dh)}).emulateTransitionEnd(Hn),this._element.style[Ot]=this._element[Sn]+"px"}}},De.hide=function(){var we=this;if(!this._isTransitioning&&x.default(this._element).hasClass(Ml)){var ze=x.default.Event(bh);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){var Ye=this._getDimension();this._element.style[Ye]=this._element.getBoundingClientRect()[Ye]+"px",q.reflow(this._element),x.default(this._element).addClass(qu).removeClass(ql+" "+Ml);var bt=this._triggerArray.length;if(bt>0)for(var Ot=0;Ot<bt;Ot++){var Wt=this._triggerArray[Ot],In=q.getSelectorFromElement(Wt);null!==In&&(x.default([].slice.call(document.querySelectorAll(In))).hasClass(Ml)||x.default(Wt).addClass(ds).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[Ye]="";var Cr=q.getTransitionDurationFromElement(this._element);x.default(this._element).one(q.TRANSITION_END,function(){we.setTransitioning(!1),x.default(we._element).removeClass(qu).addClass(ql).trigger(Uh)}).emulateTransitionEnd(Cr)}}},De.setTransitioning=function(we){this._isTransitioning=we},De.dispose=function(){x.default.removeData(this._element,ll),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},De._getConfig=function(we){return(we=z({},yh,we)).toggle=Boolean(we.toggle),q.typeCheckConfig(Zs,we,Fh),we},De._getDimension=function(){return x.default(this._element).hasClass("width")?"width":"height"},De._getParent=function(){var ze,we=this;q.isElement(this._config.parent)?(ze=this._config.parent,typeof this._config.parent.jquery<"u"&&(ze=this._config.parent[0])):ze=document.querySelector(this._config.parent);var bt=[].slice.call(ze.querySelectorAll('[data-toggle="collapse"][data-parent="'+this._config.parent+'"]'));return x.default(bt).each(function(Ot,Wt){we._addAriaAndCollapsedClass(ke._getTargetFromElement(Wt),[Wt])}),ze},De._addAriaAndCollapsedClass=function(we,ze){var Ye=x.default(we).hasClass(Ml);ze.length&&x.default(ze).toggleClass(ds,!Ye).attr("aria-expanded",Ye)},ke._getTargetFromElement=function(we){var ze=q.getSelectorFromElement(we);return ze?document.querySelector(ze):null},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Ye=ze.data(ll),bt=z({},yh,ze.data(),"object"==typeof we&&we?we:{});if(!Ye&&bt.toggle&&"string"==typeof we&&/show|hide/.test(we)&&(bt.toggle=!1),Ye||(Ye=new ke(this,bt),ze.data(ll,Ye)),"string"==typeof we){if(typeof Ye[we]>"u")throw new TypeError('No method named "'+we+'"');Ye[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return yh}}]),ke}();x.default(document).on(Tl,gp,function(ke){"A"===ke.currentTarget.tagName&&ke.preventDefault();var De=x.default(this),He=q.getSelectorFromElement(this),we=[].slice.call(document.querySelectorAll(He));x.default(we).each(function(){var ze=x.default(this),bt=ze.data(ll)?"toggle":De.data();Wc._jQueryInterface.call(ze,bt)})}),x.default.fn[Zs]=Wc._jQueryInterface,x.default.fn[Zs].Constructor=Wc,x.default.fn[Zs].noConflict=function(){return x.default.fn[Zs]=mp,Wc._jQueryInterface};var _c=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",xh=function(){for(var ke=["Edge","Trident","Firefox"],De=0;De<ke.length;De+=1)if(_c&&navigator.userAgent.indexOf(ke[De])>=0)return 1;return 0}(),cl=_c&&window.Promise?function vp(ke){var De=!1;return function(){De||(De=!0,window.Promise.resolve().then(function(){De=!1,ke()}))}}:function Yu(ke){var De=!1;return function(){De||(De=!0,setTimeout(function(){De=!1,ke()},xh))}};function zh(ke){return ke&&"[object Function]"==={}.toString.call(ke)}function ul(ke,De){if(1!==ke.nodeType)return[];var we=ke.ownerDocument.defaultView.getComputedStyle(ke,null);return De?we[De]:we}function jh(ke){return"HTML"===ke.nodeName?ke:ke.parentNode||ke.host}function Zu(ke){if(!ke)return document.body;switch(ke.nodeName){case"HTML":case"BODY":return ke.ownerDocument.body;case"#document":return ke.body}var De=ul(ke);return/(auto|scroll|overlay)/.test(De.overflow+De.overflowY+De.overflowX)?ke:Zu(jh(ke))}function vc(ke){return ke&&ke.referenceNode?ke.referenceNode:ke}var yc=_c&&!(!window.MSInputMethodContext||!document.documentMode),wh=_c&&/MSIE 10/.test(navigator.userAgent);function _u(ke){return 11===ke?yc:10===ke?wh:yc||wh}function qc(ke){if(!ke)return document.documentElement;for(var De=_u(10)?document.body:null,He=ke.offsetParent||null;He===De&&ke.nextElementSibling;)He=(ke=ke.nextElementSibling).offsetParent;var we=He&&He.nodeName;return we&&"BODY"!==we&&"HTML"!==we?-1!==["TH","TD","TABLE"].indexOf(He.nodeName)&&"static"===ul(He,"position")?qc(He):He:ke?ke.ownerDocument.documentElement:document.documentElement}function Xc(ke){return null!==ke.parentNode?Xc(ke.parentNode):ke}function Qu(ke,De){if(!(ke&&ke.nodeType&&De&&De.nodeType))return document.documentElement;var He=ke.compareDocumentPosition(De)&Node.DOCUMENT_POSITION_FOLLOWING,we=He?ke:De,ze=He?De:ke,Ye=document.createRange();Ye.setStart(we,0),Ye.setEnd(ze,0);var bt=Ye.commonAncestorContainer;if(ke!==bt&&De!==bt||we.contains(ze))return function yp(ke){var De=ke.nodeName;return"BODY"!==De&&("HTML"===De||qc(ke.firstElementChild)===ke)}(bt)?bt:qc(bt);var Ot=Xc(ke);return Ot.host?Qu(Ot.host,De):Qu(ke,Xc(De).host)}function Yl(ke){var He="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",we=ke.nodeName;return"BODY"===we||"HTML"===we?(ke.ownerDocument.scrollingElement||ke.ownerDocument.documentElement)[He]:ke[He]}function Gh(ke,De){var He="x"===De?"Left":"Top",we="Left"===He?"Right":"Bottom";return parseFloat(ke["border"+He+"Width"])+parseFloat(ke["border"+we+"Width"])}function xp(ke,De,He,we){return Math.max(De["offset"+ke],De["scroll"+ke],He["client"+ke],He["offset"+ke],He["scroll"+ke],_u(10)?parseInt(He["offset"+ke])+parseInt(we["margin"+("Height"===ke?"Top":"Left")])+parseInt(we["margin"+("Height"===ke?"Bottom":"Right")]):0)}function wp(ke){var De=ke.body,He=ke.documentElement,we=_u(10)&&getComputedStyle(He);return{height:xp("Height",De,He,we),width:xp("Width",De,He,we)}}var Hh=function(ke,De){if(!(ke instanceof De))throw new TypeError("Cannot call a class as a function")},Wp=function(){function ke(De,He){for(var we=0;we<He.length;we++){var ze=He[we];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(De,ze.key,ze)}}return function(De,He,we){return He&&ke(De.prototype,He),we&&ke(De,we),De}}(),gu=function(ke,De,He){return De in ke?Object.defineProperty(ke,De,{value:He,enumerable:!0,configurable:!0,writable:!0}):ke[De]=He,ke},qa=Object.assign||function(ke){for(var De=1;De<arguments.length;De++){var He=arguments[De];for(var we in He)Object.prototype.hasOwnProperty.call(He,we)&&(ke[we]=He[we])}return ke};function bc(ke){return qa({},ke,{right:ke.left+ke.width,bottom:ke.top+ke.height})}function Jl(ke){var De={};try{if(_u(10)){De=ke.getBoundingClientRect();var He=Yl(ke,"top"),we=Yl(ke,"left");De.top+=He,De.left+=we,De.bottom+=He,De.right+=we}else De=ke.getBoundingClientRect()}catch{}var ze={left:De.left,top:De.top,width:De.right-De.left,height:De.bottom-De.top},Ye="HTML"===ke.nodeName?wp(ke.ownerDocument):{},Wt=ke.offsetWidth-(Ye.width||ke.clientWidth||ze.width),In=ke.offsetHeight-(Ye.height||ke.clientHeight||ze.height);if(Wt||In){var Sn=ul(ke);Wt-=Gh(Sn,"x"),In-=Gh(Sn,"y"),ze.width-=Wt,ze.height-=In}return bc(ze)}function Zl(ke,De){var He=arguments.length>2&&void 0!==arguments[2]&&arguments[2],we=_u(10),ze="HTML"===De.nodeName,Ye=Jl(ke),bt=Jl(De),Ot=Zu(ke),Wt=ul(De),In=parseFloat(Wt.borderTopWidth),Sn=parseFloat(Wt.borderLeftWidth);He&&ze&&(bt.top=Math.max(bt.top,0),bt.left=Math.max(bt.left,0));var Hn=bc({top:Ye.top-bt.top-In,left:Ye.left-bt.left-Sn,width:Ye.width,height:Ye.height});if(Hn.marginTop=0,Hn.marginLeft=0,!we&&ze){var Cr=parseFloat(Wt.marginTop),Ur=parseFloat(Wt.marginLeft);Hn.top-=In-Cr,Hn.bottom-=In-Cr,Hn.left-=Sn-Ur,Hn.right-=Sn-Ur,Hn.marginTop=Cr,Hn.marginLeft=Ur}return(we&&!He?De.contains(Ot):De===Ot&&"BODY"!==Ot.nodeName)&&(Hn=function bp(ke,De){var He=arguments.length>2&&void 0!==arguments[2]&&arguments[2],we=Yl(De,"top"),ze=Yl(De,"left"),Ye=He?-1:1;return ke.top+=we*Ye,ke.bottom+=we*Ye,ke.left+=ze*Ye,ke.right+=ze*Ye,ke}(Hn,De)),Hn}function La(ke){var De=ke.nodeName;if("BODY"===De||"HTML"===De)return!1;if("fixed"===ul(ke,"position"))return!0;var He=jh(ke);return!!He&&La(He)}function pa(ke){if(!ke||!ke.parentElement||_u())return document.documentElement;for(var De=ke.parentElement;De&&"none"===ul(De,"transform");)De=De.parentElement;return De||document.documentElement}function Al(ke,De,He,we){var ze=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Ye={top:0,left:0},bt=ze?pa(ke):Qu(ke,vc(De));if("viewport"===we)Ye=function Ku(ke){var De=arguments.length>1&&void 0!==arguments[1]&&arguments[1],He=ke.ownerDocument.documentElement,we=Zl(ke,He),ze=Math.max(He.clientWidth,window.innerWidth||0),Ye=Math.max(He.clientHeight,window.innerHeight||0),bt=De?0:Yl(He),Ot=De?0:Yl(He,"left");return bc({top:bt-we.top+we.marginTop,left:Ot-we.left+we.marginLeft,width:ze,height:Ye})}(bt,ze);else{var Ot=void 0;"scrollParent"===we?"BODY"===(Ot=Zu(jh(De))).nodeName&&(Ot=ke.ownerDocument.documentElement):Ot="window"===we?ke.ownerDocument.documentElement:we;var Wt=Zl(Ot,bt,ze);if("HTML"!==Ot.nodeName||La(bt))Ye=Wt;else{var In=wp(ke.ownerDocument),Sn=In.height,Hn=In.width;Ye.top+=Wt.top-Wt.marginTop,Ye.bottom=Sn+Wt.top,Ye.left+=Wt.left-Wt.marginLeft,Ye.right=Hn+Wt.left}}var Cr="number"==typeof(He=He||0);return Ye.left+=Cr?He:He.left||0,Ye.top+=Cr?He:He.top||0,Ye.right-=Cr?He:He.right||0,Ye.bottom-=Cr?He:He.bottom||0,Ye}function eh(ke){return ke.width*ke.height}function th(ke,De,He,we,ze){var Ye=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===ke.indexOf("auto"))return ke;var bt=Al(He,we,Ye,ze),Ot={top:{width:bt.width,height:De.top-bt.top},right:{width:bt.right-De.right,height:bt.height},bottom:{width:bt.width,height:bt.bottom-De.bottom},left:{width:De.left-bt.left,height:bt.height}},Wt=Object.keys(Ot).map(function(Cr){return qa({key:Cr},Ot[Cr],{area:eh(Ot[Cr])})}).sort(function(Cr,Ur){return Ur.area-Cr.area}),In=Wt.filter(function(Cr){return Cr.width>=He.clientWidth&&Cr.height>=He.clientHeight}),Sn=In.length>0?In[0].key:Wt[0].key,Hn=ke.split("-")[1];return Sn+(Hn?"-"+Hn:"")}function Vh(ke,De,He){var we=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zl(He,we?pa(De):Qu(De,vc(He)),we)}function Sp(ke){var He=ke.ownerDocument.defaultView.getComputedStyle(ke),we=parseFloat(He.marginTop||0)+parseFloat(He.marginBottom||0),ze=parseFloat(He.marginLeft||0)+parseFloat(He.marginRight||0);return{width:ke.offsetWidth+ze,height:ke.offsetHeight+we}}function Ep(ke){var De={left:"right",right:"left",bottom:"top",top:"bottom"};return ke.replace(/left|right|bottom|top/g,function(He){return De[He]})}function Zi(ke,De,He){He=He.split("-")[0];var we=Sp(ke),ze={width:we.width,height:we.height},Ye=-1!==["right","left"].indexOf(He),bt=Ye?"top":"left",Ot=Ye?"left":"top",Wt=Ye?"height":"width",In=Ye?"width":"height";return ze[bt]=De[bt]+De[Wt]/2-we[Wt]/2,ze[Ot]=He===Ot?De[Ot]-we[In]:De[Ep(Ot)],ze}function hl(ke,De){return Array.prototype.find?ke.find(De):ke.filter(De)[0]}function Yc(ke,De,He){var we=void 0===He?ke:ke.slice(0,function Ql(ke,De,He){if(Array.prototype.findIndex)return ke.findIndex(function(ze){return ze[De]===He});var we=hl(ke,function(ze){return ze[De]===He});return ke.indexOf(we)}(ke,"name",He));return we.forEach(function(ze){ze.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Ye=ze.function||ze.fn;ze.enabled&&zh(Ye)&&(De.offsets.popper=bc(De.offsets.popper),De.offsets.reference=bc(De.offsets.reference),De=Ye(De,ze))}),De}function Wh(){if(!this.state.isDestroyed){var ke={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};ke.offsets.reference=Vh(this.state,this.popper,this.reference,this.options.positionFixed),ke.placement=th(this.options.placement,ke.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),ke.originalPlacement=ke.placement,ke.positionFixed=this.options.positionFixed,ke.offsets.popper=Zi(this.popper,ke.offsets.reference,ke.placement),ke.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",ke=Yc(this.modifiers,ke),this.state.isCreated?this.options.onUpdate(ke):(this.state.isCreated=!0,this.options.onCreate(ke))}}function xc(ke,De){return ke.some(function(He){return He.enabled&&He.name===De})}function nh(ke){for(var De=[!1,"ms","Webkit","Moz","O"],He=ke.charAt(0).toUpperCase()+ke.slice(1),we=0;we<De.length;we++){var ze=De[we],Ye=ze?""+ze+He:ke;if(typeof document.body.style[Ye]<"u")return Ye}return null}function vu(){return this.state.isDestroyed=!0,xc(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[nh("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function W(ke){var De=ke.ownerDocument;return De?De.defaultView:window}function pe(ke,De,He,we){var ze="BODY"===ke.nodeName,Ye=ze?ke.ownerDocument.defaultView:ke;Ye.addEventListener(De,He,{passive:!0}),ze||pe(Zu(Ye.parentNode),De,He,we),we.push(Ye)}function Me(ke,De,He,we){He.updateBound=we,W(ke).addEventListener("resize",He.updateBound,{passive:!0});var ze=Zu(ke);return pe(ze,"scroll",He.updateBound,He.scrollParents),He.scrollElement=ze,He.eventsEnabled=!0,He}function Ne(){this.state.eventsEnabled||(this.state=Me(this.reference,0,this.state,this.scheduleUpdate))}function qe(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function Ve(ke,De){return W(ke).removeEventListener("resize",De.updateBound),De.scrollParents.forEach(function(He){He.removeEventListener("scroll",De.updateBound)}),De.updateBound=null,De.scrollParents=[],De.scrollElement=null,De.eventsEnabled=!1,De}(this.reference,this.state))}function et(ke){return""!==ke&&!isNaN(parseFloat(ke))&&isFinite(ke)}function At(ke,De){Object.keys(De).forEach(function(He){var we="";-1!==["width","height","top","right","bottom","left"].indexOf(He)&&et(De[He])&&(we="px"),ke.style[He]=De[He]+we})}var on=_c&&/Firefox/i.test(navigator.userAgent);function Er(ke,De,He){var we=hl(ke,function(Ot){return Ot.name===De}),ze=!!we&&ke.some(function(Ot){return Ot.name===He&&Ot.enabled&&Ot.order<we.order});if(!ze){var Ye="`"+De+"`";console.warn("`"+He+"` modifier is required by "+Ye+" modifier in order to work, be sure to include it before "+Ye+"!")}return ze}var fs=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],es=fs.slice(3);function da(ke){var De=arguments.length>1&&void 0!==arguments[1]&&arguments[1],He=es.indexOf(ke),we=es.slice(He+1).concat(es.slice(0,He));return De?we.reverse():we}var bi_FLIP="flip",bi_CLOCKWISE="clockwise",bi_COUNTERCLOCKWISE="counterclockwise";var Ds={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function fa(ke){var De=ke.placement,He=De.split("-")[0],we=De.split("-")[1];if(we){var ze=ke.offsets,Ye=ze.reference,bt=ze.popper,Ot=-1!==["bottom","top"].indexOf(He),Wt=Ot?"left":"top",In=Ot?"width":"height",Sn={start:gu({},Wt,Ye[Wt]),end:gu({},Wt,Ye[Wt]+Ye[In]-bt[In])};ke.offsets.popper=qa({},bt,Sn[we])}return ke}},offset:{order:200,enabled:!0,fn:function qh(ke,De){var Wt,He=De.offset,ze=ke.offsets,Ye=ze.popper,bt=ze.reference,Ot=ke.placement.split("-")[0];return Wt=et(+He)?[+He,0]:function qi(ke,De,He,we){var ze=[0,0],Ye=-1!==["right","left"].indexOf(we),bt=ke.split(/(\+|\-)/).map(function(Sn){return Sn.trim()}),Ot=bt.indexOf(hl(bt,function(Sn){return-1!==Sn.search(/,|\s/)}));bt[Ot]&&-1===bt[Ot].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var Wt=/\s*,\s*|\s+/,In=-1!==Ot?[bt.slice(0,Ot).concat([bt[Ot].split(Wt)[0]]),[bt[Ot].split(Wt)[1]].concat(bt.slice(Ot+1))]:[bt];return In=In.map(function(Sn,Hn){var Cr=(1===Hn?!Ye:Ye)?"height":"width",Ur=!1;return Sn.reduce(function(Lr,Qt){return""===Lr[Lr.length-1]&&-1!==["+","-"].indexOf(Qt)?(Lr[Lr.length-1]=Qt,Ur=!0,Lr):Ur?(Lr[Lr.length-1]+=Qt,Ur=!1,Lr):Lr.concat(Qt)},[]).map(function(Lr){return function Wi(ke,De,He,we){var ze=ke.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Ye=+ze[1],bt=ze[2];return Ye?0===bt.indexOf("%")?bc("%p"===bt?He:we)[De]/100*Ye:"vh"===bt||"vw"===bt?("vh"===bt?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*Ye:Ye:ke}(Lr,Cr,De,He)})}),In.forEach(function(Sn,Hn){Sn.forEach(function(Cr,Ur){et(Cr)&&(ze[Hn]+=Cr*("-"===Sn[Ur-1]?-1:1))})}),ze}(He,Ye,bt,Ot),"left"===Ot?(Ye.top+=Wt[0],Ye.left-=Wt[1]):"right"===Ot?(Ye.top+=Wt[0],Ye.left+=Wt[1]):"top"===Ot?(Ye.left+=Wt[0],Ye.top-=Wt[1]):"bottom"===Ot&&(Ye.left+=Wt[0],Ye.top+=Wt[1]),ke.popper=Ye,ke},offset:0},preventOverflow:{order:300,enabled:!0,fn:function wc(ke,De){var He=De.boundariesElement||qc(ke.instance.popper);ke.instance.reference===He&&(He=qc(He));var we=nh("transform"),ze=ke.instance.popper.style,Ye=ze.top,bt=ze.left,Ot=ze[we];ze.top="",ze.left="",ze[we]="";var Wt=Al(ke.instance.popper,ke.instance.reference,De.padding,He,ke.positionFixed);ze.top=Ye,ze.left=bt,ze[we]=Ot,De.boundaries=Wt;var Sn=ke.offsets.popper,Hn={primary:function(Ur){var Lr=Sn[Ur];return Sn[Ur]<Wt[Ur]&&!De.escapeWithReference&&(Lr=Math.max(Sn[Ur],Wt[Ur])),gu({},Ur,Lr)},secondary:function(Ur){var Lr="right"===Ur?"left":"top",Qt=Sn[Lr];return Sn[Ur]>Wt[Ur]&&!De.escapeWithReference&&(Qt=Math.min(Sn[Lr],Wt[Ur]-("right"===Ur?Sn.width:Sn.height))),gu({},Lr,Qt)}};return De.priority.forEach(function(Cr){var Ur=-1!==["left","top"].indexOf(Cr)?"primary":"secondary";Sn=qa({},Sn,Hn[Ur](Cr))}),ke.offsets.popper=Sn,ke},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function Xa(ke){var De=ke.offsets,He=De.popper,we=De.reference,ze=ke.placement.split("-")[0],Ye=Math.floor,bt=-1!==["top","bottom"].indexOf(ze),Ot=bt?"right":"bottom",Wt=bt?"left":"top",In=bt?"width":"height";return He[Ot]<Ye(we[Wt])&&(ke.offsets.popper[Wt]=Ye(we[Wt])-He[In]),He[Wt]>Ye(we[Ot])&&(ke.offsets.popper[Wt]=Ye(we[Ot])),ke}},arrow:{order:500,enabled:!0,fn:function ti(ke,De){var He;if(!Er(ke.instance.modifiers,"arrow","keepTogether"))return ke;var we=De.element;if("string"==typeof we){if(!(we=ke.instance.popper.querySelector(we)))return ke}else if(!ke.instance.popper.contains(we))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),ke;var ze=ke.placement.split("-")[0],Ye=ke.offsets,bt=Ye.popper,Ot=Ye.reference,Wt=-1!==["left","right"].indexOf(ze),In=Wt?"height":"width",Sn=Wt?"Top":"Left",Hn=Sn.toLowerCase(),Cr=Wt?"left":"top",Ur=Wt?"bottom":"right",Lr=Sp(we)[In];Ot[Ur]-Lr<bt[Hn]&&(ke.offsets.popper[Hn]-=bt[Hn]-(Ot[Ur]-Lr)),Ot[Hn]+Lr>bt[Ur]&&(ke.offsets.popper[Hn]+=Ot[Hn]+Lr-bt[Ur]),ke.offsets.popper=bc(ke.offsets.popper);var Qt=Ot[Hn]+Ot[In]/2-Lr/2,Ao=ul(ke.instance.popper),ic=parseFloat(Ao["margin"+Sn]),el=parseFloat(Ao["border"+Sn+"Width"]),Qr=Qt-ke.offsets.popper[Hn]-ic-el;return Qr=Math.max(Math.min(bt[In]-Lr,Qr),0),ke.arrowElement=we,ke.offsets.arrow=(gu(He={},Hn,Math.round(Qr)),gu(He,Cr,""),He),ke},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function Br(ke,De){if(xc(ke.instance.modifiers,"inner")||ke.flipped&&ke.placement===ke.originalPlacement)return ke;var He=Al(ke.instance.popper,ke.instance.reference,De.padding,De.boundariesElement,ke.positionFixed),we=ke.placement.split("-")[0],ze=Ep(we),Ye=ke.placement.split("-")[1]||"",bt=[];switch(De.behavior){case bi_FLIP:bt=[we,ze];break;case bi_CLOCKWISE:bt=da(we);break;case bi_COUNTERCLOCKWISE:bt=da(we,!0);break;default:bt=De.behavior}return bt.forEach(function(Ot,Wt){if(we!==Ot||bt.length===Wt+1)return ke;we=ke.placement.split("-")[0],ze=Ep(we);var In=ke.offsets.popper,Sn=ke.offsets.reference,Hn=Math.floor,Cr="left"===we&&Hn(In.right)>Hn(Sn.left)||"right"===we&&Hn(In.left)<Hn(Sn.right)||"top"===we&&Hn(In.bottom)>Hn(Sn.top)||"bottom"===we&&Hn(In.top)<Hn(Sn.bottom),Ur=Hn(In.left)<Hn(He.left),Lr=Hn(In.right)>Hn(He.right),Qt=Hn(In.top)<Hn(He.top),Ao=Hn(In.bottom)>Hn(He.bottom),ic="left"===we&&Ur||"right"===we&&Lr||"top"===we&&Qt||"bottom"===we&&Ao,el=-1!==["top","bottom"].indexOf(we),Id=!!De.flipVariations&&(el&&"start"===Ye&&Ur||el&&"end"===Ye&&Lr||!el&&"start"===Ye&&Qt||!el&&"end"===Ye&&Ao)||!!De.flipVariationsByContent&&(el&&"start"===Ye&&Lr||el&&"end"===Ye&&Ur||!el&&"start"===Ye&&Ao||!el&&"end"===Ye&&Qt);(Cr||ic||Id)&&(ke.flipped=!0,(Cr||ic)&&(we=bt[Wt+1]),Id&&(Ye=function Ar(ke){return"end"===ke?"start":"start"===ke?"end":ke}(Ye)),ke.placement=we+(Ye?"-"+Ye:""),ke.offsets.popper=qa({},ke.offsets.popper,Zi(ke.instance.popper,ke.offsets.reference,ke.placement)),ke=Yc(ke.instance.modifiers,ke,"flip"))}),ke},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function ma(ke){var De=ke.placement,He=De.split("-")[0],we=ke.offsets,ze=we.popper,Ye=we.reference,bt=-1!==["left","right"].indexOf(He),Ot=-1===["top","left"].indexOf(He);return ze[bt?"left":"top"]=Ye[He]-(Ot?ze[bt?"width":"height"]:0),ke.placement=Ep(De),ke.offsets.popper=bc(ze),ke}},hide:{order:800,enabled:!0,fn:function pl(ke){if(!Er(ke.instance.modifiers,"hide","preventOverflow"))return ke;var De=ke.offsets.reference,He=hl(ke.instance.modifiers,function(we){return"preventOverflow"===we.name}).boundaries;if(De.bottom<He.top||De.left>He.right||De.top>He.bottom||De.right<He.left){if(!0===ke.hide)return ke;ke.hide=!0,ke.attributes["x-out-of-boundaries"]=""}else{if(!1===ke.hide)return ke;ke.hide=!1,ke.attributes["x-out-of-boundaries"]=!1}return ke}},computeStyle:{order:850,enabled:!0,fn:function xn(ke,De){var He=De.x,we=De.y,ze=ke.offsets.popper,Ye=hl(ke.instance.modifiers,function(Qr){return"applyStyle"===Qr.name}).gpuAcceleration;void 0!==Ye&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var Lr,Qt,bt=void 0!==Ye?Ye:De.gpuAcceleration,Ot=qc(ke.instance.popper),Wt=Jl(Ot),In={position:ze.position},Sn=function Fn(ke,De){var He=ke.offsets,we=He.popper,Ye=Math.round,bt=Math.floor,Ot=function(ic){return ic},Wt=Ye(He.reference.width),In=Ye(we.width),Sn=-1!==["left","right"].indexOf(ke.placement),Hn=-1!==ke.placement.indexOf("-"),Lr=De?Sn||Hn||Wt%2==In%2?Ye:bt:Ot,Qt=De?Ye:Ot;return{left:Lr(Wt%2==1&&In%2==1&&!Hn&&De?we.left-1:we.left),top:Qt(we.top),bottom:Qt(we.bottom),right:Lr(we.right)}}(ke,window.devicePixelRatio<2||!on),Hn="bottom"===He?"top":"bottom",Cr="right"===we?"left":"right",Ur=nh("transform");if(Qt="bottom"===Hn?"HTML"===Ot.nodeName?-Ot.clientHeight+Sn.bottom:-Wt.height+Sn.bottom:Sn.top,Lr="right"===Cr?"HTML"===Ot.nodeName?-Ot.clientWidth+Sn.right:-Wt.width+Sn.right:Sn.left,bt&&Ur)In[Ur]="translate3d("+Lr+"px, "+Qt+"px, 0)",In[Hn]=0,In[Cr]=0,In.willChange="transform";else{var ic="right"===Cr?-1:1;In[Hn]=Qt*("bottom"===Hn?-1:1),In[Cr]=Lr*ic,In.willChange=Hn+", "+Cr}return ke.attributes=qa({},{"x-placement":ke.placement},ke.attributes),ke.styles=qa({},In,ke.styles),ke.arrowStyles=qa({},ke.offsets.arrow,ke.arrowStyles),ke},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function Xt(ke){return At(ke.instance.popper,ke.styles),function Bt(ke,De){Object.keys(De).forEach(function(He){!1!==De[He]?ke.setAttribute(He,De[He]):ke.removeAttribute(He)})}(ke.instance.popper,ke.attributes),ke.arrowElement&&Object.keys(ke.arrowStyles).length&&At(ke.arrowElement,ke.arrowStyles),ke},onLoad:function pn(ke,De,He,we,ze){var Ye=Vh(ze,De,ke,He.positionFixed),bt=th(He.placement,Ye,De,ke,He.modifiers.flip.boundariesElement,He.modifiers.flip.padding);return De.setAttribute("x-placement",bt),At(De,{position:He.positionFixed?"fixed":"absolute"}),He},gpuAcceleration:void 0}}},tr=function(){function ke(De,He){var we=this,ze=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Hh(this,ke),this.scheduleUpdate=function(){return requestAnimationFrame(we.update)},this.update=cl(this.update.bind(this)),this.options=qa({},ke.Defaults,ze),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=De&&De.jquery?De[0]:De,this.popper=He&&He.jquery?He[0]:He,this.options.modifiers={},Object.keys(qa({},ke.Defaults.modifiers,ze.modifiers)).forEach(function(bt){we.options.modifiers[bt]=qa({},ke.Defaults.modifiers[bt]||{},ze.modifiers?ze.modifiers[bt]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(bt){return qa({name:bt},we.options.modifiers[bt])}).sort(function(bt,Ot){return bt.order-Ot.order}),this.modifiers.forEach(function(bt){bt.enabled&&zh(bt.onLoad)&&bt.onLoad(we.reference,we.popper,we.options,bt,we.state)}),this.update();var Ye=this.options.eventsEnabled;Ye&&this.enableEventListeners(),this.state.eventsEnabled=Ye}return Wp(ke,[{key:"update",value:function(){return Wh.call(this)}},{key:"destroy",value:function(){return vu.call(this)}},{key:"enableEventListeners",value:function(){return Ne.call(this)}},{key:"disableEventListeners",value:function(){return qe.call(this)}}]),ke}();tr.Utils=(typeof window<"u"?window:global).PopperUtils,tr.placements=fs,tr.Defaults=Ds;var wn="dropdown",ss="bs.dropdown",Qi="."+ss,Hr=".data-api",di=x.default.fn[wn],lt=new RegExp("38|40|27"),$l="hide"+Qi,As="hidden"+Qi,Tp="show"+Qi,$s="shown"+Qi,Sc="click"+Qi,Di="click"+Qi+Hr,io="keydown"+Qi+Hr,ri="keyup"+Qi+Hr,Jc="disabled",$i="show",Ui="dropdown-menu-right",qr='[data-toggle="dropdown"]',bo=".dropdown-menu",Cl={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},Ja={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},Ba=function(){function ke(He,we){this._element=He,this._popper=null,this._config=this._getConfig(we),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var De=ke.prototype;return De.toggle=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Jc)){var we=x.default(this._menu).hasClass($i);ke._clearMenus(),!we&&this.show(!0)}},De.show=function(we){if(void 0===we&&(we=!1),!(this._element.disabled||x.default(this._element).hasClass(Jc)||x.default(this._menu).hasClass($i))){var ze={relatedTarget:this._element},Ye=x.default.Event(Tp,ze),bt=ke._getParentFromElement(this._element);if(x.default(bt).trigger(Ye),!Ye.isDefaultPrevented()){if(!this._inNavbar&&we){if(typeof tr>"u")throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var Ot=this._element;"parent"===this._config.reference?Ot=bt:q.isElement(this._config.reference)&&(Ot=this._config.reference,typeof this._config.reference.jquery<"u"&&(Ot=this._config.reference[0])),"scrollParent"!==this._config.boundary&&x.default(bt).addClass("position-static"),this._popper=new tr(Ot,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===x.default(bt).closest(".navbar-nav").length&&x.default(document.body).children().on("mouseover",null,x.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),x.default(this._menu).toggleClass($i),x.default(bt).toggleClass($i).trigger(x.default.Event($s,ze))}}},De.hide=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Jc)&&x.default(this._menu).hasClass($i)){var we={relatedTarget:this._element},ze=x.default.Event($l,we),Ye=ke._getParentFromElement(this._element);x.default(Ye).trigger(ze),!ze.isDefaultPrevented()&&(this._popper&&this._popper.destroy(),x.default(this._menu).toggleClass($i),x.default(Ye).toggleClass($i).trigger(x.default.Event(As,we)))}},De.dispose=function(){x.default.removeData(this._element,ss),x.default(this._element).off(Qi),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},De.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},De._addEventListeners=function(){var we=this;x.default(this._element).on(Sc,function(ze){ze.preventDefault(),ze.stopPropagation(),we.toggle()})},De._getConfig=function(we){return we=z({},this.constructor.Default,x.default(this._element).data(),we),q.typeCheckConfig(wn,we,this.constructor.DefaultType),we},De._getMenuElement=function(){if(!this._menu){var we=ke._getParentFromElement(this._element);we&&(this._menu=we.querySelector(bo))}return this._menu},De._getPlacement=function(){var we=x.default(this._element.parentNode),ze="bottom-start";return we.hasClass("dropup")?ze=x.default(this._menu).hasClass(Ui)?"top-end":"top-start":we.hasClass("dropright")?ze="right-start":we.hasClass("dropleft")?ze="left-start":x.default(this._menu).hasClass(Ui)&&(ze="bottom-end"),ze},De._detectNavbar=function(){return x.default(this._element).closest(".navbar").length>0},De._getOffset=function(){var we=this,ze={};return"function"==typeof this._config.offset?ze.fn=function(Ye){return Ye.offsets=z({},Ye.offsets,we._config.offset(Ye.offsets,we._element)||{}),Ye}:ze.offset=this._config.offset,ze},De._getPopperConfig=function(){var we={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(we.modifiers.applyStyle={enabled:!1}),z({},we,this._config.popperConfig)},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(ss);if(ze||(ze=new ke(this,"object"==typeof we?we:null),x.default(this).data(ss,ze)),"string"==typeof we){if(typeof ze[we]>"u")throw new TypeError('No method named "'+we+'"');ze[we]()}})},ke._clearMenus=function(we){if(!we||3!==we.which&&("keyup"!==we.type||9===we.which))for(var ze=[].slice.call(document.querySelectorAll(qr)),Ye=0,bt=ze.length;Ye<bt;Ye++){var Ot=ke._getParentFromElement(ze[Ye]),Wt=x.default(ze[Ye]).data(ss),In={relatedTarget:ze[Ye]};if(we&&"click"===we.type&&(In.clickEvent=we),Wt){var Sn=Wt._menu;if(x.default(Ot).hasClass($i)&&!(we&&("click"===we.type&&/input|textarea/i.test(we.target.tagName)||"keyup"===we.type&&9===we.which)&&x.default.contains(Ot,we.target))){var Hn=x.default.Event($l,In);x.default(Ot).trigger(Hn),!Hn.isDefaultPrevented()&&("ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),ze[Ye].setAttribute("aria-expanded","false"),Wt._popper&&Wt._popper.destroy(),x.default(Sn).removeClass($i),x.default(Ot).removeClass($i).trigger(x.default.Event(As,In)))}}}},ke._getParentFromElement=function(we){var ze,Ye=q.getSelectorFromElement(we);return Ye&&(ze=document.querySelector(Ye)),ze||we.parentNode},ke._dataApiKeydownHandler=function(we){if(!(/input|textarea/i.test(we.target.tagName)?32===we.which||27!==we.which&&(40!==we.which&&38!==we.which||x.default(we.target).closest(bo).length):!lt.test(we.which))&&!this.disabled&&!x.default(this).hasClass(Jc)){var ze=ke._getParentFromElement(this),Ye=x.default(ze).hasClass($i);if(Ye||27!==we.which){if(we.preventDefault(),we.stopPropagation(),!Ye||27===we.which||32===we.which)return 27===we.which&&x.default(ze.querySelector(qr)).trigger("focus"),void x.default(this).trigger("click");var bt=[].slice.call(ze.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(Wt){return x.default(Wt).is(":visible")});if(0!==bt.length){var Ot=bt.indexOf(we.target);38===we.which&&Ot>0&&Ot--,40===we.which&&Ot<bt.length-1&&Ot++,Ot<0&&(Ot=0),bt[Ot].focus()}}}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Cl}},{key:"DefaultType",get:function(){return Ja}}]),ke}();x.default(document).on(io,qr,Ba._dataApiKeydownHandler).on(io,bo,Ba._dataApiKeydownHandler).on(Di+" "+ri,Ba._clearMenus).on(Di,qr,function(ke){ke.preventDefault(),ke.stopPropagation(),Ba._jQueryInterface.call(x.default(this),"toggle")}).on(Di,".dropdown form",function(ke){ke.stopPropagation()}),x.default.fn[wn]=Ba._jQueryInterface,x.default.fn[wn].Constructor=Ba,x.default.fn[wn].noConflict=function(){return x.default.fn[wn]=di,Ba._jQueryInterface};var Kl="modal",Na="bs.modal",xo="."+Na,Mc=x.default.fn[Kl],xt={backdrop:!0,keyboard:!0,focus:!0,show:!0},Ut={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},yn="hide"+xo,qt="hidePrevented"+xo,fn="hidden"+xo,tn="show"+xo,qn="shown"+xo,Gn="focusin"+xo,Sr="resize"+xo,$r="click.dismiss"+xo,yr="keydown.dismiss"+xo,Xr="mouseup.dismiss"+xo,fi="mousedown.dismiss"+xo,Rr="click"+xo+".data-api",Bo="modal-open",ec="fade",Yo="show",Xi="modal-static",Ac=".modal-dialog",Eh=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",cd=".sticky-top",Th=function(){function ke(He,we){this._config=this._getConfig(we),this._element=He,this._dialog=He.querySelector(Ac),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var De=ke.prototype;return De.toggle=function(we){return this._isShown?this.hide():this.show(we)},De.show=function(we){var ze=this;if(!this._isShown&&!this._isTransitioning){x.default(this._element).hasClass(ec)&&(this._isTransitioning=!0);var Ye=x.default.Event(tn,{relatedTarget:we});x.default(this._element).trigger(Ye),!this._isShown&&!Ye.isDefaultPrevented()&&(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),x.default(this._element).on($r,'[data-dismiss="modal"]',function(bt){return ze.hide(bt)}),x.default(this._dialog).on(fi,function(){x.default(ze._element).one(Xr,function(bt){x.default(bt.target).is(ze._element)&&(ze._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return ze._showElement(we)}))}},De.hide=function(we){var ze=this;if(we&&we.preventDefault(),this._isShown&&!this._isTransitioning){var Ye=x.default.Event(yn);if(x.default(this._element).trigger(Ye),this._isShown&&!Ye.isDefaultPrevented()){this._isShown=!1;var bt=x.default(this._element).hasClass(ec);if(bt&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),x.default(document).off(Gn),x.default(this._element).removeClass(Yo),x.default(this._element).off($r),x.default(this._dialog).off(fi),bt){var Ot=q.getTransitionDurationFromElement(this._element);x.default(this._element).one(q.TRANSITION_END,function(Wt){return ze._hideModal(Wt)}).emulateTransitionEnd(Ot)}else this._hideModal()}}},De.dispose=function(){[window,this._element,this._dialog].forEach(function(we){return x.default(we).off(xo)}),x.default(document).off(Gn),x.default.removeData(this._element,Na),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},De.handleUpdate=function(){this._adjustDialog()},De._getConfig=function(we){return we=z({},xt,we),q.typeCheckConfig(Kl,we,Ut),we},De._triggerBackdropTransition=function(){var we=this;if("static"===this._config.backdrop){var ze=x.default.Event(qt);if(x.default(this._element).trigger(ze),ze.isDefaultPrevented())return;var Ye=this._element.scrollHeight>document.documentElement.clientHeight;Ye||(this._element.style.overflowY="hidden"),this._element.classList.add(Xi);var bt=q.getTransitionDurationFromElement(this._dialog);x.default(this._element).off(q.TRANSITION_END),x.default(this._element).one(q.TRANSITION_END,function(){we._element.classList.remove(Xi),Ye||x.default(we._element).one(q.TRANSITION_END,function(){we._element.style.overflowY=""}).emulateTransitionEnd(we._element,bt)}).emulateTransitionEnd(bt),this._element.focus()}else this.hide()},De._showElement=function(we){var ze=this,Ye=x.default(this._element).hasClass(ec),bt=this._dialog?this._dialog.querySelector(".modal-body"):null;(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE)&&document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),x.default(this._dialog).hasClass("modal-dialog-scrollable")&&bt?bt.scrollTop=0:this._element.scrollTop=0,Ye&&q.reflow(this._element),x.default(this._element).addClass(Yo),this._config.focus&&this._enforceFocus();var Ot=x.default.Event(qn,{relatedTarget:we}),Wt=function(){ze._config.focus&&ze._element.focus(),ze._isTransitioning=!1,x.default(ze._element).trigger(Ot)};if(Ye){var In=q.getTransitionDurationFromElement(this._dialog);x.default(this._dialog).one(q.TRANSITION_END,Wt).emulateTransitionEnd(In)}else Wt()},De._enforceFocus=function(){var we=this;x.default(document).off(Gn).on(Gn,function(ze){document!==ze.target&&we._element!==ze.target&&0===x.default(we._element).has(ze.target).length&&we._element.focus()})},De._setEscapeEvent=function(){var we=this;this._isShown?x.default(this._element).on(yr,function(ze){we._config.keyboard&&27===ze.which?(ze.preventDefault(),we.hide()):!we._config.keyboard&&27===ze.which&&we._triggerBackdropTransition()}):this._isShown||x.default(this._element).off(yr)},De._setResizeEvent=function(){var we=this;this._isShown?x.default(window).on(Sr,function(ze){return we.handleUpdate(ze)}):x.default(window).off(Sr)},De._hideModal=function(){var we=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){x.default(document.body).removeClass(Bo),we._resetAdjustments(),we._resetScrollbar(),x.default(we._element).trigger(fn)})},De._removeBackdrop=function(){this._backdrop&&(x.default(this._backdrop).remove(),this._backdrop=null)},De._showBackdrop=function(we){var ze=this,Ye=x.default(this._element).hasClass(ec)?ec:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",Ye&&this._backdrop.classList.add(Ye),x.default(this._backdrop).appendTo(document.body),x.default(this._element).on($r,function(In){ze._ignoreBackdropClick?ze._ignoreBackdropClick=!1:In.target===In.currentTarget&&ze._triggerBackdropTransition()}),Ye&&q.reflow(this._backdrop),x.default(this._backdrop).addClass(Yo),!we)return;if(!Ye)return void we();var bt=q.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(q.TRANSITION_END,we).emulateTransitionEnd(bt)}else if(!this._isShown&&this._backdrop){x.default(this._backdrop).removeClass(Yo);var Ot=function(){ze._removeBackdrop(),we&&we()};if(x.default(this._element).hasClass(ec)){var Wt=q.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(q.TRANSITION_END,Ot).emulateTransitionEnd(Wt)}else Ot()}else we&&we()},De._adjustDialog=function(){var we=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&we&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!we&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},De._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},De._checkScrollbar=function(){var we=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(we.left+we.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},De._setScrollbar=function(){var we=this;if(this._isBodyOverflowing){var ze=[].slice.call(document.querySelectorAll(Eh)),Ye=[].slice.call(document.querySelectorAll(cd));x.default(ze).each(function(Wt,In){var Sn=In.style.paddingRight,Hn=x.default(In).css("padding-right");x.default(In).data("padding-right",Sn).css("padding-right",parseFloat(Hn)+we._scrollbarWidth+"px")}),x.default(Ye).each(function(Wt,In){var Sn=In.style.marginRight,Hn=x.default(In).css("margin-right");x.default(In).data("margin-right",Sn).css("margin-right",parseFloat(Hn)-we._scrollbarWidth+"px")});var bt=document.body.style.paddingRight,Ot=x.default(document.body).css("padding-right");x.default(document.body).data("padding-right",bt).css("padding-right",parseFloat(Ot)+this._scrollbarWidth+"px")}x.default(document.body).addClass(Bo)},De._resetScrollbar=function(){var we=[].slice.call(document.querySelectorAll(Eh));x.default(we).each(function(bt,Ot){var Wt=x.default(Ot).data("padding-right");x.default(Ot).removeData("padding-right"),Ot.style.paddingRight=Wt||""});var ze=[].slice.call(document.querySelectorAll(""+cd));x.default(ze).each(function(bt,Ot){var Wt=x.default(Ot).data("margin-right");typeof Wt<"u"&&x.default(Ot).css("margin-right",Wt).removeData("margin-right")});var Ye=x.default(document.body).data("padding-right");x.default(document.body).removeData("padding-right"),document.body.style.paddingRight=Ye||""},De._getScrollbarWidth=function(){var we=document.createElement("div");we.className="modal-scrollbar-measure",document.body.appendChild(we);var ze=we.getBoundingClientRect().width-we.clientWidth;return document.body.removeChild(we),ze},ke._jQueryInterface=function(we,ze){return this.each(function(){var Ye=x.default(this).data(Na),bt=z({},xt,x.default(this).data(),"object"==typeof we&&we?we:{});if(Ye||(Ye=new ke(this,bt),x.default(this).data(Na,Ye)),"string"==typeof we){if(typeof Ye[we]>"u")throw new TypeError('No method named "'+we+'"');Ye[we](ze)}else bt.show&&Ye.show(ze)})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return xt}}]),ke}();x.default(document).on(Rr,'[data-toggle="modal"]',function(ke){var He,De=this,we=q.getSelectorFromElement(this);we&&(He=document.querySelector(we));var ze=x.default(He).data(Na)?"toggle":z({},x.default(He).data(),x.default(this).data());("A"===this.tagName||"AREA"===this.tagName)&&ke.preventDefault();var Ye=x.default(He).one(tn,function(bt){bt.isDefaultPrevented()||Ye.one(fn,function(){x.default(De).is(":visible")&&De.focus()})});Th._jQueryInterface.call(x.default(He),ze,this)}),x.default.fn[Kl]=Th._jQueryInterface,x.default.fn[Kl].Constructor=Th,x.default.fn[Kl].noConflict=function(){return x.default.fn[Kl]=Mc,Th._jQueryInterface};var Rd=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],$c=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,Ks=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function ar(ke,De,He){if(0===ke.length)return ke;if(He&&"function"==typeof He)return He(ke);for(var ze=(new window.DOMParser).parseFromString(ke,"text/html"),Ye=Object.keys(De),bt=[].slice.call(ze.body.querySelectorAll("*")),Ot=function(Cr,Ur){var Lr=bt[Cr],Qt=Lr.nodeName.toLowerCase();if(-1===Ye.indexOf(Lr.nodeName.toLowerCase()))return Lr.parentNode.removeChild(Lr),"continue";var Ao=[].slice.call(Lr.attributes),ic=[].concat(De["*"]||[],De[Qt]||[]);Ao.forEach(function(el){(function $p(ke,De){var He=ke.nodeName.toLowerCase();if(-1!==De.indexOf(He))return-1===Rd.indexOf(He)||Boolean(ke.nodeValue.match($c)||ke.nodeValue.match(Ks));for(var we=De.filter(function(bt){return bt instanceof RegExp}),ze=0,Ye=we.length;ze<Ye;ze++)if(He.match(we[ze]))return!0;return!1})(el,ic)||Lr.removeAttribute(el.nodeName)})},Wt=0,In=bt.length;Wt<In;Wt++)Ot(Wt);return ze.body.innerHTML}var Ll="tooltip",Jh="bs.tooltip",ga="."+Jh,hd=x.default.fn[Ll],zr="bs-tooltip",eo=new RegExp("(^|\\s)"+zr+"\\S+","g"),No=["sanitize","whiteList","sanitizeFn"],Cs={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Vr={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},dl={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Cc="show",Zh={HIDE:"hide"+ga,HIDDEN:"hidden"+ga,SHOW:"show"+ga,SHOWN:"shown"+ga,INSERTED:"inserted"+ga,CLICK:"click"+ga,FOCUSIN:"focusin"+ga,FOCUSOUT:"focusout"+ga,MOUSEENTER:"mouseenter"+ga,MOUSELEAVE:"mouseleave"+ga},Bl="fade",er="show",Nl="hover",Pi="focus",Ra=function(){function ke(He,we){if(typeof tr>"u")throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=He,this.config=this._getConfig(we),this.tip=null,this._setListeners()}var De=ke.prototype;return De.enable=function(){this._isEnabled=!0},De.disable=function(){this._isEnabled=!1},De.toggleEnabled=function(){this._isEnabled=!this._isEnabled},De.toggle=function(we){if(this._isEnabled)if(we){var ze=this.constructor.DATA_KEY,Ye=x.default(we.currentTarget).data(ze);Ye||(Ye=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(ze,Ye)),Ye._activeTrigger.click=!Ye._activeTrigger.click,Ye._isWithActiveTrigger()?Ye._enter(null,Ye):Ye._leave(null,Ye)}else{if(x.default(this.getTipElement()).hasClass(er))return void this._leave(null,this);this._enter(null,this)}},De.dispose=function(){clearTimeout(this._timeout),x.default.removeData(this.element,this.constructor.DATA_KEY),x.default(this.element).off(this.constructor.EVENT_KEY),x.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&x.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},De.show=function(){var we=this;if("none"===x.default(this.element).css("display"))throw new Error("Please use show on visible elements");var ze=x.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){x.default(this.element).trigger(ze);var Ye=q.findShadowRoot(this.element),bt=x.default.contains(null!==Ye?Ye:this.element.ownerDocument.documentElement,this.element);if(ze.isDefaultPrevented()||!bt)return;var Ot=this.getTipElement(),Wt=q.getUID(this.constructor.NAME);Ot.setAttribute("id",Wt),this.element.setAttribute("aria-describedby",Wt),this.setContent(),this.config.animation&&x.default(Ot).addClass(Bl);var In="function"==typeof this.config.placement?this.config.placement.call(this,Ot,this.element):this.config.placement,Sn=this._getAttachment(In);this.addAttachmentClass(Sn);var Hn=this._getContainer();x.default(Ot).data(this.constructor.DATA_KEY,this),x.default.contains(this.element.ownerDocument.documentElement,this.tip)||x.default(Ot).appendTo(Hn),x.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new tr(this.element,Ot,this._getPopperConfig(Sn)),x.default(Ot).addClass(er),"ontouchstart"in document.documentElement&&x.default(document.body).children().on("mouseover",null,x.default.noop);var Cr=function(){we.config.animation&&we._fixTransition();var Qt=we._hoverState;we._hoverState=null,x.default(we.element).trigger(we.constructor.Event.SHOWN),"out"===Qt&&we._leave(null,we)};if(x.default(this.tip).hasClass(Bl)){var Ur=q.getTransitionDurationFromElement(this.tip);x.default(this.tip).one(q.TRANSITION_END,Cr).emulateTransitionEnd(Ur)}else Cr()}},De.hide=function(we){var ze=this,Ye=this.getTipElement(),bt=x.default.Event(this.constructor.Event.HIDE),Ot=function(){ze._hoverState!==Cc&&Ye.parentNode&&Ye.parentNode.removeChild(Ye),ze._cleanTipClass(),ze.element.removeAttribute("aria-describedby"),x.default(ze.element).trigger(ze.constructor.Event.HIDDEN),null!==ze._popper&&ze._popper.destroy(),we&&we()};if(x.default(this.element).trigger(bt),!bt.isDefaultPrevented()){if(x.default(Ye).removeClass(er),"ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),this._activeTrigger.click=!1,this._activeTrigger[Pi]=!1,this._activeTrigger[Nl]=!1,x.default(this.tip).hasClass(Bl)){var Wt=q.getTransitionDurationFromElement(Ye);x.default(Ye).one(q.TRANSITION_END,Ot).emulateTransitionEnd(Wt)}else Ot();this._hoverState=""}},De.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},De.isWithContent=function(){return Boolean(this.getTitle())},De.addAttachmentClass=function(we){x.default(this.getTipElement()).addClass(zr+"-"+we)},De.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},De.setContent=function(){var we=this.getTipElement();this.setElementContent(x.default(we.querySelectorAll(".tooltip-inner")),this.getTitle()),x.default(we).removeClass(Bl+" "+er)},De.setElementContent=function(we,ze){"object"!=typeof ze||!ze.nodeType&&!ze.jquery?this.config.html?(this.config.sanitize&&(ze=ar(ze,this.config.whiteList,this.config.sanitizeFn)),we.html(ze)):we.text(ze):this.config.html?x.default(ze).parent().is(we)||we.empty().append(ze):we.text(x.default(ze).text())},De.getTitle=function(){var we=this.element.getAttribute("data-original-title");return we||(we="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),we},De._getPopperConfig=function(we){var ze=this;return z({},{placement:we,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(Ot){Ot.originalPlacement!==Ot.placement&&ze._handlePopperPlacementChange(Ot)},onUpdate:function(Ot){return ze._handlePopperPlacementChange(Ot)}},this.config.popperConfig)},De._getOffset=function(){var we=this,ze={};return"function"==typeof this.config.offset?ze.fn=function(Ye){return Ye.offsets=z({},Ye.offsets,we.config.offset(Ye.offsets,we.element)||{}),Ye}:ze.offset=this.config.offset,ze},De._getContainer=function(){return!1===this.config.container?document.body:q.isElement(this.config.container)?x.default(this.config.container):x.default(document).find(this.config.container)},De._getAttachment=function(we){return Vr[we.toUpperCase()]},De._setListeners=function(){var we=this;this.config.trigger.split(" ").forEach(function(Ye){if("click"===Ye)x.default(we.element).on(we.constructor.Event.CLICK,we.config.selector,function(Wt){return we.toggle(Wt)});else if("manual"!==Ye){var bt=Ye===Nl?we.constructor.Event.MOUSEENTER:we.constructor.Event.FOCUSIN,Ot=Ye===Nl?we.constructor.Event.MOUSELEAVE:we.constructor.Event.FOCUSOUT;x.default(we.element).on(bt,we.config.selector,function(Wt){return we._enter(Wt)}).on(Ot,we.config.selector,function(Wt){return we._leave(Wt)})}}),this._hideModalHandler=function(){we.element&&we.hide()},x.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=z({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},De._fixTitle=function(){var we=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==we)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},De._enter=function(we,ze){var Ye=this.constructor.DATA_KEY;(ze=ze||x.default(we.currentTarget).data(Ye))||(ze=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(Ye,ze)),we&&(ze._activeTrigger["focusin"===we.type?Pi:Nl]=!0),x.default(ze.getTipElement()).hasClass(er)||ze._hoverState===Cc?ze._hoverState=Cc:(clearTimeout(ze._timeout),ze._hoverState=Cc,ze.config.delay&&ze.config.delay.show?ze._timeout=setTimeout(function(){ze._hoverState===Cc&&ze.show()},ze.config.delay.show):ze.show())},De._leave=function(we,ze){var Ye=this.constructor.DATA_KEY;if((ze=ze||x.default(we.currentTarget).data(Ye))||(ze=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(Ye,ze)),we&&(ze._activeTrigger["focusout"===we.type?Pi:Nl]=!1),!ze._isWithActiveTrigger()){if(clearTimeout(ze._timeout),ze._hoverState="out",!ze.config.delay||!ze.config.delay.hide)return void ze.hide();ze._timeout=setTimeout(function(){"out"===ze._hoverState&&ze.hide()},ze.config.delay.hide)}},De._isWithActiveTrigger=function(){for(var we in this._activeTrigger)if(this._activeTrigger[we])return!0;return!1},De._getConfig=function(we){var ze=x.default(this.element).data();return Object.keys(ze).forEach(function(Ye){-1!==No.indexOf(Ye)&&delete ze[Ye]}),"number"==typeof(we=z({},this.constructor.Default,ze,"object"==typeof we&&we?we:{})).delay&&(we.delay={show:we.delay,hide:we.delay}),"number"==typeof we.title&&(we.title=we.title.toString()),"number"==typeof we.content&&(we.content=we.content.toString()),q.typeCheckConfig(Ll,we,this.constructor.DefaultType),we.sanitize&&(we.template=ar(we.template,we.whiteList,we.sanitizeFn)),we},De._getDelegateConfig=function(){var we={};if(this.config)for(var ze in this.config)this.constructor.Default[ze]!==this.config[ze]&&(we[ze]=this.config[ze]);return we},De._cleanTipClass=function(){var we=x.default(this.getTipElement()),ze=we.attr("class").match(eo);null!==ze&&ze.length&&we.removeClass(ze.join(""))},De._handlePopperPlacementChange=function(we){this.tip=we.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(we.placement))},De._fixTransition=function(){var we=this.getTipElement(),ze=this.config.animation;null===we.getAttribute("x-placement")&&(x.default(we).removeClass(Bl),this.config.animation=!1,this.hide(),this.show(),this.config.animation=ze)},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Ye=ze.data(Jh),bt="object"==typeof we&&we;if((Ye||!/dispose|hide/.test(we))&&(Ye||(Ye=new ke(this,bt),ze.data(Jh,Ye)),"string"==typeof we)){if(typeof Ye[we]>"u")throw new TypeError('No method named "'+we+'"');Ye[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return dl}},{key:"NAME",get:function(){return Ll}},{key:"DATA_KEY",get:function(){return Jh}},{key:"Event",get:function(){return Zh}},{key:"EVENT_KEY",get:function(){return ga}},{key:"DefaultType",get:function(){return Cs}}]),ke}();x.default.fn[Ll]=Ra._jQueryInterface,x.default.fn[Ll].Constructor=Ra,x.default.fn[Ll].noConflict=function(){return x.default.fn[Ll]=hd,Ra._jQueryInterface};var oh="popover",Pa="bs.popover",li="."+Pa,Zr=x.default.fn[oh],hn="bs-popover",Qc=new RegExp("(^|\\s)"+hn+"\\S+","g"),ci=z({},Ra.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),va=z({},Ra.DefaultType,{content:"(string|element|function)"}),gs={HIDE:"hide"+li,HIDDEN:"hidden"+li,SHOW:"show"+li,SHOWN:"shown"+li,INSERTED:"inserted"+li,CLICK:"click"+li,FOCUSIN:"focusin"+li,FOCUSOUT:"focusout"+li,MOUSEENTER:"mouseenter"+li,MOUSELEAVE:"mouseleave"+li},Ls=function(ke){function De(){return ke.apply(this,arguments)||this}!function M(ke,De){ke.prototype=Object.create(De.prototype),ke.prototype.constructor=ke,ke.__proto__=De}(De,ke);var He=De.prototype;return He.isWithContent=function(){return this.getTitle()||this._getContent()},He.addAttachmentClass=function(ze){x.default(this.getTipElement()).addClass(hn+"-"+ze)},He.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},He.setContent=function(){var ze=x.default(this.getTipElement());this.setElementContent(ze.find(".popover-header"),this.getTitle());var Ye=this._getContent();"function"==typeof Ye&&(Ye=Ye.call(this.element)),this.setElementContent(ze.find(".popover-body"),Ye),ze.removeClass("fade show")},He._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},He._cleanTipClass=function(){var ze=x.default(this.getTipElement()),Ye=ze.attr("class").match(Qc);null!==Ye&&Ye.length>0&&ze.removeClass(Ye.join(""))},De._jQueryInterface=function(ze){return this.each(function(){var Ye=x.default(this).data(Pa),bt="object"==typeof ze?ze:null;if((Ye||!/dispose|hide/.test(ze))&&(Ye||(Ye=new De(this,bt),x.default(this).data(Pa,Ye)),"string"==typeof ze)){if(typeof Ye[ze]>"u")throw new TypeError('No method named "'+ze+'"');Ye[ze]()}})},D(De,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return ci}},{key:"NAME",get:function(){return oh}},{key:"DATA_KEY",get:function(){return Pa}},{key:"Event",get:function(){return gs}},{key:"EVENT_KEY",get:function(){return li}},{key:"DefaultType",get:function(){return va}}]),De}(Ra);x.default.fn[oh]=Ls._jQueryInterface,x.default.fn[oh].Constructor=Ls,x.default.fn[oh].noConflict=function(){return x.default.fn[oh]=Zr,Ls._jQueryInterface};var ii="scrollspy",br="bs.scrollspy",ml="."+br,ah=x.default.fn[ii],Qa={offset:10,method:"auto",target:""},ns={offset:"number",method:"string",target:"(string|element)"},Ci="activate"+ml,Qh="scroll"+ml,Ah="load"+ml+".data-api",mr="active",_l=".nav, .list-group",Fr=".nav-link",lh=".list-group-item",Ns=".dropdown-item",tc="position",uo=function(){function ke(He,we){var ze=this;this._element=He,this._scrollElement="BODY"===He.tagName?window:He,this._config=this._getConfig(we),this._selector=this._config.target+" "+Fr+","+this._config.target+" "+lh+","+this._config.target+" "+Ns,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,x.default(this._scrollElement).on(Qh,function(Ye){return ze._process(Ye)}),this.refresh(),this._process()}var De=ke.prototype;return De.refresh=function(){var we=this,Ye="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":tc:this._config.method,bt=Ye===tc?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(Wt){var In,Sn=q.getSelectorFromElement(Wt);if(Sn&&(In=document.querySelector(Sn)),In){var Hn=In.getBoundingClientRect();if(Hn.width||Hn.height)return[x.default(In)[Ye]().top+bt,Sn]}return null}).filter(function(Wt){return Wt}).sort(function(Wt,In){return Wt[0]-In[0]}).forEach(function(Wt){we._offsets.push(Wt[0]),we._targets.push(Wt[1])})},De.dispose=function(){x.default.removeData(this._element,br),x.default(this._scrollElement).off(ml),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},De._getConfig=function(we){if("string"!=typeof(we=z({},Qa,"object"==typeof we&&we?we:{})).target&&q.isElement(we.target)){var ze=x.default(we.target).attr("id");ze||(ze=q.getUID(ii),x.default(we.target).attr("id",ze)),we.target="#"+ze}return q.typeCheckConfig(ii,we,ns),we},De._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},De._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},De._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},De._process=function(){var we=this._getScrollTop()+this._config.offset,ze=this._getScrollHeight(),Ye=this._config.offset+ze-this._getOffsetHeight();if(this._scrollHeight!==ze&&this.refresh(),we>=Ye){var bt=this._targets[this._targets.length-1];this._activeTarget!==bt&&this._activate(bt)}else{if(this._activeTarget&&we<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var Ot=this._offsets.length;Ot--;)this._activeTarget!==this._targets[Ot]&&we>=this._offsets[Ot]&&(typeof this._offsets[Ot+1]>"u"||we<this._offsets[Ot+1])&&this._activate(this._targets[Ot])}},De._activate=function(we){this._activeTarget=we,this._clear();var ze=this._selector.split(",").map(function(bt){return bt+'[data-target="'+we+'"],'+bt+'[href="'+we+'"]'}),Ye=x.default([].slice.call(document.querySelectorAll(ze.join(","))));Ye.hasClass("dropdown-item")?(Ye.closest(".dropdown").find(".dropdown-toggle").addClass(mr),Ye.addClass(mr)):(Ye.addClass(mr),Ye.parents(_l).prev(Fr+", "+lh).addClass(mr),Ye.parents(_l).prev(".nav-item").children(Fr).addClass(mr)),x.default(this._scrollElement).trigger(Ci,{relatedTarget:we})},De._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(we){return we.classList.contains(mr)}).forEach(function(we){return we.classList.remove(mr)})},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(br);if(ze||(ze=new ke(this,"object"==typeof we&&we),x.default(this).data(br,ze)),"string"==typeof we){if(typeof ze[we]>"u")throw new TypeError('No method named "'+we+'"');ze[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Qa}}]),ke}();x.default(window).on(Ah,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),He=ke.length;He--;){var we=x.default(ke[He]);uo._jQueryInterface.call(we,we.data())}}),x.default.fn[ii]=uo._jQueryInterface,x.default.fn[ii].Constructor=uo,x.default.fn[ii].noConflict=function(){return x.default.fn[ii]=ah,uo._jQueryInterface};var Ai="tab",Ps="bs.tab",Rl="."+Ps,Pl=x.default.fn[Ai],gl="hide"+Rl,nc="hidden"+Rl,Bc="show"+Rl,eu="shown"+Rl,hr="click"+Rl+".data-api",Ia="active",Eu=".active",ui="> li > .active",Mo=function(){function ke(He){this._element=He}var De=ke.prototype;return De.show=function(){var we=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&x.default(this._element).hasClass(Ia)||x.default(this._element).hasClass("disabled"))){var ze,Ye,bt=x.default(this._element).closest(".nav, .list-group")[0],Ot=q.getSelectorFromElement(this._element);if(bt){var Wt="UL"===bt.nodeName||"OL"===bt.nodeName?ui:Eu;Ye=(Ye=x.default.makeArray(x.default(bt).find(Wt)))[Ye.length-1]}var In=x.default.Event(gl,{relatedTarget:this._element}),Sn=x.default.Event(Bc,{relatedTarget:Ye});if(Ye&&x.default(Ye).trigger(In),x.default(this._element).trigger(Sn),!Sn.isDefaultPrevented()&&!In.isDefaultPrevented()){Ot&&(ze=document.querySelector(Ot)),this._activate(this._element,bt);var Hn=function(){var Ur=x.default.Event(nc,{relatedTarget:we._element}),Lr=x.default.Event(eu,{relatedTarget:Ye});x.default(Ye).trigger(Ur),x.default(we._element).trigger(Lr)};ze?this._activate(ze,ze.parentNode,Hn):Hn()}}},De.dispose=function(){x.default.removeData(this._element,Ps),this._element=null},De._activate=function(we,ze,Ye){var bt=this,Wt=(!ze||"UL"!==ze.nodeName&&"OL"!==ze.nodeName?x.default(ze).children(Eu):x.default(ze).find(ui))[0],In=Ye&&Wt&&x.default(Wt).hasClass("fade"),Sn=function(){return bt._transitionComplete(we,Wt,Ye)};if(Wt&&In){var Hn=q.getTransitionDurationFromElement(Wt);x.default(Wt).removeClass("show").one(q.TRANSITION_END,Sn).emulateTransitionEnd(Hn)}else Sn()},De._transitionComplete=function(we,ze,Ye){if(ze){x.default(ze).removeClass(Ia);var bt=x.default(ze.parentNode).find("> .dropdown-menu .active")[0];bt&&x.default(bt).removeClass(Ia),"tab"===ze.getAttribute("role")&&ze.setAttribute("aria-selected",!1)}if(x.default(we).addClass(Ia),"tab"===we.getAttribute("role")&&we.setAttribute("aria-selected",!0),q.reflow(we),we.classList.contains("fade")&&we.classList.add("show"),we.parentNode&&x.default(we.parentNode).hasClass("dropdown-menu")){var Ot=x.default(we).closest(".dropdown")[0];if(Ot){var Wt=[].slice.call(Ot.querySelectorAll(".dropdown-toggle"));x.default(Wt).addClass(Ia)}we.setAttribute("aria-expanded",!0)}Ye&&Ye()},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Ye=ze.data(Ps);if(Ye||(Ye=new ke(this),ze.data(Ps,Ye)),"string"==typeof we){if(typeof Ye[we]>"u")throw new TypeError('No method named "'+we+'"');Ye[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(hr,'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(ke){ke.preventDefault(),Mo._jQueryInterface.call(x.default(this),"show")}),x.default.fn[Ai]=Mo._jQueryInterface,x.default.fn[Ai].Constructor=Mo,x.default.fn[Ai].noConflict=function(){return x.default.fn[Ai]=Pl,Mo._jQueryInterface};var Vn="toast",Tu="bs.toast",vl="."+Tu,rc=x.default.fn[Vn],Mu="click.dismiss"+vl,ea="hide"+vl,vs="hidden"+vl,ya="show"+vl,ch="shown"+vl,$h="show",Rc="showing",uh={animation:"boolean",autohide:"boolean",delay:"number"},ba={animation:!0,autohide:!0,delay:500},Is=function(){function ke(He,we){this._element=He,this._config=this._getConfig(we),this._timeout=null,this._setListeners()}var De=ke.prototype;return De.show=function(){var we=this,ze=x.default.Event(ya);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var Ye=function(){we._element.classList.remove(Rc),we._element.classList.add($h),x.default(we._element).trigger(ch),we._config.autohide&&(we._timeout=setTimeout(function(){we.hide()},we._config.delay))};if(this._element.classList.remove("hide"),q.reflow(this._element),this._element.classList.add(Rc),this._config.animation){var bt=q.getTransitionDurationFromElement(this._element);x.default(this._element).one(q.TRANSITION_END,Ye).emulateTransitionEnd(bt)}else Ye()}},De.hide=function(){if(this._element.classList.contains($h)){var we=x.default.Event(ea);x.default(this._element).trigger(we),!we.isDefaultPrevented()&&this._close()}},De.dispose=function(){this._clearTimeout(),this._element.classList.contains($h)&&this._element.classList.remove($h),x.default(this._element).off(Mu),x.default.removeData(this._element,Tu),this._element=null,this._config=null},De._getConfig=function(we){return we=z({},ba,x.default(this._element).data(),"object"==typeof we&&we?we:{}),q.typeCheckConfig(Vn,we,this.constructor.DefaultType),we},De._setListeners=function(){var we=this;x.default(this._element).on(Mu,'[data-dismiss="toast"]',function(){return we.hide()})},De._close=function(){var we=this,ze=function(){we._element.classList.add("hide"),x.default(we._element).trigger(vs)};if(this._element.classList.remove($h),this._config.animation){var Ye=q.getTransitionDurationFromElement(this._element);x.default(this._element).one(q.TRANSITION_END,ze).emulateTransitionEnd(Ye)}else ze()},De._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Ye=ze.data(Tu);if(Ye||(Ye=new ke(this,"object"==typeof we&&we),ze.data(Tu,Ye)),"string"==typeof we){if(typeof Ye[we]>"u")throw new TypeError('No method named "'+we+'"');Ye[we](this)}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"DefaultType",get:function(){return uh}},{key:"Default",get:function(){return ba}}]),ke}();x.default.fn[Vn]=Is._jQueryInterface,x.default.fn[Vn].Constructor=Is,x.default.fn[Vn].noConflict=function(){return x.default.fn[Vn]=rc,Is._jQueryInterface},n.Alert=Ke,n.Button=Kr,n.Carousel=To,n.Collapse=Wc,n.Dropdown=Ba,n.Modal=Th,n.Popover=Ls,n.Scrollspy=uo,n.Tab=Mo,n.Toast=Is,n.Tooltip=Ra,n.Util=q,Object.defineProperty(n,"__esModule",{value:!0})});