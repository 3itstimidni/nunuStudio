!function(n,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Nunu=o():n.Nunu=o()}(self,()=>(()=>{var __webpack_modules__={872:(n,o,l)=>{"use strict";l(590),l(435),l(806);var x=l(808);o.fG=x.StaticPair},590:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),B=l(285);o.Decoder=class{constructor(D=[],G,M={}){this.dict=D,this.progressive=G,this.options=M}decode(D){D instanceof x||(D=x.wrap(D));const G=D.littleEndian;try{const M=this.decodeValue(D.LE());return D.littleEndian=G,M}catch(M){throw D.littleEndian=G,M}}decodeValue(D){let G=D.readUint8();if(G<=B.MAX)return x.zigZagDecode32(G);switch(G){case B.NULL:return null;case B.TRUE:return!0;case B.FALSE:return!1;case B.EOBJECT:return{};case B.EARRAY:return[];case B.ESTRING:return"";case B.OBJECT:G=D.readVarint32();const M={};for(;--G>=0;)M[this.decodeValue(D)]=this.decodeValue(D);return M;case B.ARRAY:G=D.readVarint32();const P=[];for(;--G>=0;)P.push(this.decodeValue(D));return P;case B.INTEGER:return D.readVarint32ZigZag();case B.LONG:const de=D.readVarint64ZigZag();return de.lessThanOrEqual(Number.MAX_SAFE_INTEGER)&&de.greaterThanOrEqual(Number.MIN_SAFE_INTEGER)?de.toNumber():de;case B.FLOAT:return D.readFloat32();case B.DOUBLE:return D.readFloat64();case B.STRING:return D.readVString();case B.STRING_ADD:const ye=D.readVString();return this.dict.push(ye),ye;case B.STRING_GET:return this.dict[D.readVarint32()];case B.BINARY:G=D.readVarint32();const ie=D.slice(D.offset,D.offset+G);return D.offset+=G,ie;default:throw new Error(`Illegal type at ${D.offset}: ${G}`)}}}},435:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),B=l(285),D=l(734),G=new x(4);G.compact(0,4),o.Encoder=class{constructor(M=[],P,de){if(this.progressive=P,this.dict=new Map,this.next=0,M)for(;this.next<M.length;)this.dict.set(M[this.next],this.next++)}encode(M,P){let de=!1;P||(P=new x,de=!0);const ye=P.littleEndian;try{return this.encodeValue(M,P.LE()),P.littleEndian=ye,de?P.flip():P}catch(ie){throw P.littleEndian=ye,ie}}encodeValue(M,P){if(null!==M)switch(typeof M){case"function":M=M.toString();case"string":0===M.length?P.writeUint8(B.ESTRING):this.dict.has(M)?(P.writeUint8(B.STRING_GET),P.writeVarint32(this.dict.get(M))):(P.writeUint8(B.STRING),P.writeVString(M));break;case"number":if(M%1==0)if(M<=2147483647&&M>=-2147483648){const ye=x.zigZagEncode32(M);ye<=B.MAX?P.writeUint8(ye):(P.writeUint8(B.INTEGER),P.writeVarint32ZigZag(M))}else P.writeUint8(B.LONG),P.writeVarint64ZigZag(M);else G.writeFloat32(M,0),M===G.readFloat32(0)?(P.writeUint8(B.FLOAT),P.writeFloat32(M)):(P.writeUint8(B.DOUBLE),P.writeFloat64(M));break;case"boolean":P.writeUint8(M?B.TRUE:B.FALSE);break;case"object":let de;if(Array.isArray(M))if(0===M.length)P.writeUint8(B.EARRAY);else for(P.writeUint8(B.ARRAY),P.writeVarint32(M.length),de=0;de<M.length;de++)this.encodeValue(M[de],P);else if(M instanceof D)P.writeUint8(B.LONG),P.writeVarint64ZigZag(M);else if(M instanceof Buffer||M instanceof ArrayBuffer||M instanceof Uint8Array||M instanceof x)M=x.wrap(M),P.writeUint8(B.BINARY),P.writeVarint32(M.remaining()),P.append(M);else{const ye=Object.keys(M);let ie=0;for(de=0;de<ye.length;de++)void 0!==M[ye[de]]&&ie++;if(0===ie)P.writeUint8(B.EOBJECT);else for(P.writeUint8(B.OBJECT),P.writeVarint32(ie),de=0;de<ye.length;de++){const ce=ye[de];void 0!==M[ce]&&(this.dict.has(ce)?(P.writeUint8(B.STRING_GET),P.writeVarint32(this.dict.get(ce))):(this.progressive?(this.dict.set(ce,this.next++),P.writeUint8(B.STRING_ADD)):P.writeUint8(B.STRING),P.writeVString(ce)),this.encodeValue(M[ce],P))}}break;case"undefined":P.writeUint8(B.NULL)}else P.writeUint8(B.NULL)}}},606:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Pair=class{encode(l){return this.encoder.encode(l)}toArrayBuffer(l){return this.encoder.encode(l).toArrayBuffer()}toBuffer(l){return this.encoder.encode(l).toBuffer()}decode(l){return this.decoder.decode(l)}}},806:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),B=l(435),D=l(590);o.ProgressivePair=class G extends x.Pair{constructor(P,de){super(),this.encoder=new B.Encoder(P,!0,de),this.decoder=new D.Decoder(P,!0,de)}}},808:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),B=l(435),D=l(590);o.StaticPair=class G extends x.Pair{constructor(P,de){super(),this.encoder=new B.Encoder(P,!1,de),this.decoder=new D.Decoder(P,!1,de)}}},285:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ZERO=0,o.MAX=239,o.NULL=240,o.TRUE=241,o.FALSE=242,o.EOBJECT=243,o.EARRAY=244,o.ESTRING=245,o.OBJECT=246,o.ARRAY=247,o.INTEGER=248,o.LONG=249,o.FLOAT=250,o.DOUBLE=251,o.STRING=252,o.STRING_ADD=253,o.STRING_GET=254,o.BINARY=255},175:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>ei,AddEquation:()=>Pe,AddOperation:()=>nr,AdditiveAnimationBlendMode:()=>th,AdditiveBlending:()=>U,AlphaFormat:()=>dp,AlwaysDepth:()=>Ln,AlwaysStencilFunc:()=>ha,AmbientLight:()=>am,AmbientLightProbe:()=>kf,AnimationClip:()=>xn,AnimationLoader:()=>xo,AnimationMixer:()=>ia,AnimationObjectGroup:()=>Qd,AnimationUtils:()=>Ye,ArcCurve:()=>cu,ArrayCamera:()=>zi,ArrowHelper:()=>B_,Audio:()=>Ff,AudioAnalyser:()=>_m,AudioContext:()=>cm,AudioListener:()=>fm,AudioLoader:()=>Wm,AxesHelper:()=>b_,AxisHelper:()=>m,BackSide:()=>W,BasicDepthPacking:()=>q,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>J,Bone:()=>jl,BooleanKeyframeTrack:()=>jt,BoundingBoxHelper:()=>g,Box2:()=>mh,Box3:()=>Ui,Box3Helper:()=>C_,BoxBufferGeometry:()=>tc,BoxGeometry:()=>tc,BoxHelper:()=>v_,BufferAttribute:()=>Pi,BufferGeometry:()=>br,BufferGeometryLoader:()=>o_,ByteType:()=>Wl,Cache:()=>ir,Camera:()=>Rl,CameraHelper:()=>$_,CanvasRenderer:()=>K,CanvasTexture:()=>gf,CatmullRomCurve3:()=>Gi,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>su,CircleGeometry:()=>su,ClampToEdgeWrapping:()=>Jr,Clock:()=>dm,Color:()=>Kn,ColorKeyframeTrack:()=>Pt,CompressedTexture:()=>Iu,CompressedTextureLoader:()=>po,ConeBufferGeometry:()=>Zp,ConeGeometry:()=>Zp,CubeCamera:()=>gl,CubeReflectionMapping:()=>Ei,CubeRefractionMapping:()=>So,CubeTexture:()=>nc,CubeTextureLoader:()=>Uo,CubeUVReflectionMapping:()=>Ni,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>na,CubicBezierCurve3:()=>Qi,CubicInterpolant:()=>pt,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>G,Curve:()=>Fa,CurvePath:()=>za,CustomBlending:()=>be,CustomToneMapping:()=>Wr,CylinderBufferGeometry:()=>rl,CylinderGeometry:()=>rl,Cylindrical:()=>bm,DataTexture:()=>Is,DataTexture2DArray:()=>Qr,DataTexture3D:()=>Cn,DataTextureLoader:()=>Hs,DataUtils:()=>R_,DecrementStencilOp:()=>Bt,DecrementWrapStencilOp:()=>pn,DefaultLoadingManager:()=>lr,DepthFormat:()=>To,DepthStencilFormat:()=>Ys,DepthTexture:()=>qd,DirectionalLight:()=>nd,DirectionalLightHelper:()=>A_,DiscreteInterpolant:()=>At,DodecahedronBufferGeometry:()=>eo,DodecahedronGeometry:()=>eo,DoubleSide:()=>Z,DstAlphaFactor:()=>sn,DstColorFactor:()=>An,DynamicBufferAttribute:()=>V_,DynamicCopyUsage:()=>pa,DynamicDrawUsage:()=>Br,DynamicReadUsage:()=>qi,EdgesGeometry:()=>lu,EdgesHelper:()=>E,EllipseCurve:()=>Fu,EqualDepth:()=>rr,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Ws,EquirectangularRefractionMapping:()=>la,Euler:()=>lo,EventDispatcher:()=>ks,ExtrudeBufferGeometry:()=>Ua,ExtrudeGeometry:()=>Ua,FaceColors:()=>k_,FileLoader:()=>zr,FlatShading:()=>A,Float16BufferAttribute:()=>Zr,Float32Attribute:()=>t,Float32BufferAttribute:()=>hn,Float64Attribute:()=>u,Float64BufferAttribute:()=>Qc,FloatType:()=>Xo,Fog:()=>Ia,FogExp2:()=>Lu,Font:()=>Vm,FontLoader:()=>u_,FrontSide:()=>ae,Frustum:()=>Fr,GLBufferAttribute:()=>Uf,GLSL1:()=>da,GLSL3:()=>Ri,GammaEncoding:()=>Ql,GreaterDepth:()=>or,GreaterEqualDepth:()=>ur,GreaterEqualStencilFunc:()=>es,GreaterStencilFunc:()=>Ar,GridHelper:()=>t_,Group:()=>ln,HalfFloatType:()=>hs,HemisphereLight:()=>ap,HemisphereLightHelper:()=>M_,HemisphereLightProbe:()=>um,IcosahedronBufferGeometry:()=>sp,IcosahedronGeometry:()=>sp,ImageBitmapLoader:()=>l_,ImageLoader:()=>wo,ImageUtils:()=>Ms,ImmediateRenderObject:()=>Km,IncrementStencilOp:()=>Mt,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>ou,InstancedBufferGeometry:()=>Of,InstancedInterleavedBuffer:()=>Ea,InstancedMesh:()=>Dc,Int16Attribute:()=>Y_,Int16BufferAttribute:()=>oh,Int32Attribute:()=>Z_,Int32BufferAttribute:()=>Na,Int8Attribute:()=>W_,Int8BufferAttribute:()=>Pd,IntType:()=>Hp,InterleavedBuffer:()=>Oc,InterleavedBufferAttribute:()=>Ii,Interpolant:()=>at,InterpolateDiscrete:()=>Jl,InterpolateLinear:()=>Zl,InterpolateSmooth:()=>Ku,InvertStencilOp:()=>Fn,JSONLoader:()=>me,KeepStencilOp:()=>qe,KeyframeTrack:()=>Jt,LOD:()=>ph,LatheBufferGeometry:()=>vi,LatheGeometry:()=>vi,Layers:()=>Js,LensFlare:()=>Se,LessDepth:()=>mn,LessEqualDepth:()=>cr,LessEqualStencilFunc:()=>ti,LessStencilFunc:()=>Sn,Light:()=>Hl,LightProbe:()=>Zd,Line:()=>ka,Line3:()=>Qm,LineBasicMaterial:()=>kt,LineCurve:()=>ra,LineCurve3:()=>yl,LineDashedMaterial:()=>je,LineLoop:()=>Qo,LinePieces:()=>I_,LineSegments:()=>dr,LineStrip:()=>P_,LinearEncoding:()=>Ji,LinearFilter:()=>ai,LinearInterpolant:()=>St,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>kh,LinearMipmapLinearFilter:()=>sl,LinearMipmapNearestFilter:()=>Gc,LinearToneMapping:()=>mi,Loader:()=>Yn,LoaderUtils:()=>vf,LoadingManager:()=>Hn,LogLuvEncoding:()=>Wh,LoopOnce:()=>gu,LoopPingPong:()=>bc,LoopRepeat:()=>qa,LuminanceAlphaFormat:()=>Wu,LuminanceFormat:()=>Vc,MOUSE:()=>B,Material:()=>$s,MaterialLoader:()=>lm,Math:()=>yu,MathUtils:()=>yu,Matrix3:()=>lt,Matrix4:()=>tn,MaxEquation:()=>Ke,Mesh:()=>Ro,MeshBasicMaterial:()=>fl,MeshDepthMaterial:()=>Vd,MeshDistanceMaterial:()=>Op,MeshFaceMaterial:()=>D_,MeshLambertMaterial:()=>Oe,MeshMatcapMaterial:()=>Fe,MeshNormalMaterial:()=>Ie,MeshPhongMaterial:()=>Te,MeshPhysicalMaterial:()=>xe,MeshStandardMaterial:()=>ve,MeshToonMaterial:()=>Ce,MinEquation:()=>Xe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>U_,MultiplyBlending:()=>Q,MultiplyOperation:()=>Kr,NearestFilter:()=>Ir,NearestMipMapLinearFilter:()=>qs,NearestMipMapNearestFilter:()=>Hu,NearestMipmapLinearFilter:()=>us,NearestMipmapNearestFilter:()=>Va,NeverDepth:()=>On,NeverStencilFunc:()=>on,NoBlending:()=>X,NoColors:()=>O_,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>eh,NormalBlending:()=>he,NotEqualDepth:()=>ni,NotEqualStencilFunc:()=>ds,NumberKeyframeTrack:()=>Nt,Object3D:()=>Pr,ObjectLoader:()=>Hm,ObjectSpaceNormalMap:()=>Be,OctahedronBufferGeometry:()=>xr,OctahedronGeometry:()=>xr,OneFactor:()=>dt,OneMinusDstAlphaFactor:()=>gt,OneMinusDstColorFactor:()=>Bn,OneMinusSrcAlphaFactor:()=>Dt,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>rc,PCFShadowMap:()=>ie,PCFSoftShadowMap:()=>ce,PMREMGenerator:()=>we,ParametricBufferGeometry:()=>a,ParametricGeometry:()=>a,Particle:()=>S_,ParticleBasicMaterial:()=>j_,ParticleSystem:()=>i_,ParticleSystemMaterial:()=>G_,Path:()=>ja,PerspectiveCamera:()=>Po,Plane:()=>Ra,PlaneBufferGeometry:()=>Eu,PlaneGeometry:()=>Eu,PlaneHelper:()=>L_,PointCloud:()=>w_,PointCloudMaterial:()=>z_,PointLight:()=>If,PointLightHelper:()=>tf,Points:()=>ta,PointsMaterial:()=>gi,PolarGridHelper:()=>Tm,PolyhedronBufferGeometry:()=>au,PolyhedronGeometry:()=>au,PositionalAudio:()=>mm,PropertyBinding:()=>fo,PropertyMixer:()=>Jm,QuadraticBezierCurve:()=>oo,QuadraticBezierCurve3:()=>Ko,Quaternion:()=>$i,QuaternionKeyframeTrack:()=>$t,QuaternionLinearInterpolant:()=>ft,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>ao,RGBAIntegerFormat:()=>yh,RGBA_ASTC_10x10_Format:()=>ul,RGBA_ASTC_10x5_Format:()=>Ju,RGBA_ASTC_10x6_Format:()=>cl,RGBA_ASTC_10x8_Format:()=>zh,RGBA_ASTC_12x10_Format:()=>jh,RGBA_ASTC_12x12_Format:()=>Zu,RGBA_ASTC_4x4_Format:()=>Xu,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>Wc,RGBA_ASTC_6x6_Format:()=>_c,RGBA_ASTC_8x5_Format:()=>xh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Yu,RGBA_BPTC_Format:()=>vc,RGBA_ETC2_EAC_Format:()=>Xl,RGBA_PVRTC_2BPPV1_Format:()=>ql,RGBA_PVRTC_4BPPV1_Format:()=>Ml,RGBA_S3TC_DXT1_Format:()=>mc,RGBA_S3TC_DXT3_Format:()=>Dh,RGBA_S3TC_DXT5_Format:()=>bh,RGBDEncoding:()=>vu,RGBEEncoding:()=>Yc,RGBEFormat:()=>vh,RGBFormat:()=>Os,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>nh,RGBM7Encoding:()=>xc,RGB_ETC1_Format:()=>qu,RGB_ETC2_Format:()=>ps,RGB_PVRTC_2BPPV1_Format:()=>Tl,RGB_PVRTC_4BPPV1_Format:()=>Uh,RGB_S3TC_DXT1_Format:()=>Fh,RGFormat:()=>mu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>Mu,Ray:()=>fn,Raycaster:()=>$d,RectAreaLight:()=>Gm,RedFormat:()=>Vp,RedIntegerFormat:()=>ll,ReinhardToneMapping:()=>_o,RepeatWrapping:()=>go,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Ae,RingBufferGeometry:()=>r,RingGeometry:()=>r,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Gh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Hh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>yc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>wh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>_u,SRGB8_ALPHA8_ASTC_6x5_Format:()=>qc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Xc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Qu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Yl,Scene:()=>Us,SceneUtils:()=>ge,ShaderChunk:()=>ui,ShaderLib:()=>Ol,ShaderMaterial:()=>Rs,ShadowMaterial:()=>ne,Shape:()=>Ga,ShapeBufferGeometry:()=>h,ShapeGeometry:()=>h,ShapePath:()=>c_,ShapeUtils:()=>Ss,ShortType:()=>Wa,Skeleton:()=>rp,SkeletonHelper:()=>zf,SkinnedMesh:()=>zl,SmoothShading:()=>R,Sphere:()=>bo,SphereBufferGeometry:()=>p,SphereGeometry:()=>p,Spherical:()=>__,SphericalHarmonics3:()=>rd,SplineCurve:()=>xs,SpotLight:()=>fh,SpotLightHelper:()=>zp,Sprite:()=>Fc,SpriteMaterial:()=>Jp,SrcAlphaFactor:()=>Gt,SrcAlphaSaturateFactor:()=>dn,SrcColorFactor:()=>It,StaticCopyUsage:()=>wc,StaticDrawUsage:()=>bi,StaticReadUsage:()=>Wi,StereoCamera:()=>h_,StreamCopyUsage:()=>pl,StreamDrawUsage:()=>Xa,StreamReadUsage:()=>qh,StringKeyframeTrack:()=>Zt,SubtractEquation:()=>Ge,SubtractiveBlending:()=>Re,TOUCH:()=>D,TangentSpaceNormalMap:()=>Me,TetrahedronBufferGeometry:()=>y,TetrahedronGeometry:()=>y,TextBufferGeometry:()=>b,TextGeometry:()=>b,Texture:()=>As,TextureLoader:()=>Vs,TorusBufferGeometry:()=>N,TorusGeometry:()=>N,TorusKnotBufferGeometry:()=>O,TorusKnotGeometry:()=>O,Triangle:()=>Ki,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Vh,TubeBufferGeometry:()=>T,TubeGeometry:()=>T,UVMapping:()=>yi,Uint16Attribute:()=>J_,Uint16BufferAttribute:()=>sh,Uint32Attribute:()=>Q_,Uint32BufferAttribute:()=>li,Uint8Attribute:()=>q_,Uint8BufferAttribute:()=>Cp,Uint8ClampedAttribute:()=>X_,Uint8ClampedBufferAttribute:()=>Ba,Uniform:()=>Ad,UniformsLib:()=>sr,UniformsUtils:()=>Ns,UnsignedByteType:()=>ca,UnsignedInt248Type:()=>Ts,UnsignedIntType:()=>Xs,UnsignedShort4444Type:()=>Vu,UnsignedShort5551Type:()=>du,UnsignedShort565Type:()=>fu,UnsignedShortType:()=>Hc,VSMShadowMap:()=>fe,Vector2:()=>zn,Vector3:()=>ht,Vector4:()=>Di,VectorKeyframeTrack:()=>_n,Vertex:()=>H_,VertexColors:()=>F_,VideoTexture:()=>Dp,WebGL1Renderer:()=>kp,WebGLCubeRenderTarget:()=>Bc,WebGLMultipleRenderTargets:()=>ri,WebGLMultisampleRenderTarget:()=>Jc,WebGLRenderTarget:()=>ro,WebGLRenderTargetCube:()=>Y,WebGLRenderer:()=>Yi,WebGLUtils:()=>Wd,WireframeGeometry:()=>z,WireframeHelper:()=>I,WrapAroundEnding:()=>Al,XHRLoader:()=>H,ZeroCurvatureEnding:()=>$a,ZeroFactor:()=>yt,ZeroSlopeEnding:()=>ua,ZeroStencilOp:()=>Ve,sRGBEncoding:()=>hl});const x="132",B={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,M=1,P=2,de=3,ye=0,ie=1,ce=2,fe=3,ae=0,W=1,Z=2,A=1,R=2,X=0,he=1,U=2,Re=3,Q=4,be=5,Pe=100,Ge=101,Ae=102,Xe=103,Ke=104,yt=200,dt=201,It=202,wt=203,Gt=204,Dt=205,sn=206,gt=207,An=208,Bn=209,dn=210,On=0,Ln=1,mn=2,cr=3,rr=4,ur=5,or=6,ni=7,Kr=0,pi=1,nr=2,vr=0,mi=1,_o=2,Nr=3,ei=4,Wr=5,yi=300,Ei=301,So=302,Ws=303,la=304,Ni=306,Eo=307,go=1e3,Jr=1001,os=1002,Ir=1003,Va=1004,Hu=1004,us=1005,qs=1005,ai=1006,Gc=1007,kh=1007,sl=1008,Gp=1008,ca=1009,Wl=1010,Wa=1011,Hc=1012,Hp=1013,Xs=1014,Xo=1015,hs=1016,Vu=1017,du=1018,fu=1019,Ts=1020,dp=1021,Os=1022,ao=1023,Vc=1024,Wu=1025,vh=ao,To=1026,Ys=1027,Vp=1028,ll=1029,mu=1030,fp=1031,mp=1032,yh=1033,Fh=33776,mc=33777,Dh=33778,bh=33779,Uh=35840,Tl=35841,Ml=35842,ql=35843,qu=36196,ps=37492,Xl=37496,Xu=37808,_p=37809,gp=37810,Wc=37811,_c=37812,xh=37813,vp=37814,Yu=37815,Ju=37816,cl=37817,zh=37818,ul=37819,jh=37820,Zu=37821,vc=36492,yc=37840,wh=37841,_u=37842,qc=37843,yp=37844,Xc=37845,Qu=37846,Yl=37847,bp=37848,Gh=37849,xp=37850,wp=37851,Hh=37852,Wp=37853,gu=2200,qa=2201,bc=2202,Jl=2300,Zl=2301,Ku=2302,$a=2400,ua=2401,Al=2402,eh=2500,th=2501,Vh=0,Sp=1,Ep=2,Ji=3e3,hl=3001,Ql=3007,Yc=3002,Wh=3003,xc=3004,nh=3005,vu=3006,q=3200,pe=3201,Me=0,Be=1,Ve=0,qe=7680,et=7681,Mt=7682,Bt=7683,Xt=34055,pn=34056,Fn=5386,on=512,Sn=513,Er=514,ti=515,Ar=516,ds=517,es=518,ha=519,bi=35044,Br=35048,Xa=35040,Wi=35045,qi=35049,qh=35041,wc=35046,pa=35050,pl=35042,da="100",Ri="300 es";class ks{addEventListener(e,c){void 0===this._listeners&&(this._listeners={});const d=this._listeners;void 0===d[e]&&(d[e]=[]),-1===d[e].indexOf(c)&&d[e].push(c)}hasEventListener(e,c){if(void 0===this._listeners)return!1;const d=this._listeners;return void 0!==d[e]&&-1!==d[e].indexOf(c)}removeEventListener(e,c){if(void 0===this._listeners)return;const d=this._listeners[e];if(void 0!==d){const _=d.indexOf(c);-1!==_&&d.splice(_,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const c=this._listeners[e.type];if(void 0!==c){e.target=this;const d=c.slice(0);for(let _=0,S=d.length;_<S;_++)d[_].call(this,e);e.target=null}}}const er=[];for(let w=0;w<256;w++)er[w]=(w<16?"0":"")+w.toString(16);let En=1234567;const Ho=Math.PI/180,ss=180/Math.PI;function Zi(){const w=4294967295*Math.random()|0,e=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(er[255&w]+er[w>>8&255]+er[w>>16&255]+er[w>>24&255]+"-"+er[255&e]+er[e>>8&255]+"-"+er[e>>16&15|64]+er[e>>24&255]+"-"+er[63&c|128]+er[c>>8&255]+"-"+er[c>>16&255]+er[c>>24&255]+er[255&d]+er[d>>8&255]+er[d>>16&255]+er[d>>24&255]).toUpperCase()}function Hr(w,e,c){return Math.max(e,Math.min(c,w))}function di(w,e){return(w%e+e)%e}function xi(w,e,c){return(1-c)*w+c*e}function Fs(w){return 0==(w&w-1)&&0!==w}function Xh(w){return Math.pow(2,Math.ceil(Math.log(w)/Math.LN2))}function vo(w){return Math.pow(2,Math.floor(Math.log(w)/Math.LN2))}var yu=Object.freeze({__proto__:null,DEG2RAD:Ho,RAD2DEG:ss,generateUUID:Zi,clamp:Hr,euclideanModulo:di,mapLinear:function(w,e,c,d,_){return d+(w-e)*(_-d)/(c-e)},inverseLerp:function(w,e,c){return w!==e?(c-w)/(e-w):0},lerp:xi,damp:function(w,e,c,d){return xi(w,e,1-Math.exp(-c*d))},pingpong:function(w,e=1){return e-Math.abs(di(w,2*e)-e)},smoothstep:function(w,e,c){return w<=e?0:w>=c?1:(w=(w-e)/(c-e))*w*(3-2*w)},smootherstep:function(w,e,c){return w<=e?0:w>=c?1:(w=(w-e)/(c-e))*w*w*(w*(6*w-15)+10)},randInt:function(w,e){return w+Math.floor(Math.random()*(e-w+1))},randFloat:function(w,e){return w+Math.random()*(e-w)},randFloatSpread:function(w){return w*(.5-Math.random())},seededRandom:function(w){return void 0!==w&&(En=w%2147483647),En=16807*En%2147483647,(En-1)/2147483646},degToRad:function(w){return w*Ho},radToDeg:function(w){return w*ss},isPowerOfTwo:Fs,ceilPowerOfTwo:Xh,floorPowerOfTwo:vo,setQuaternionFromProperEuler:function(w,e,c,d,_){const S=Math.cos,L=Math.sin,k=S(c/2),F=L(c/2),V=S((e+d)/2),te=L((e+d)/2),le=S((e-d)/2),ue=L((e-d)/2),_e=S((d-e)/2),Ee=L((d-e)/2);switch(_){case"XYX":w.set(k*te,F*le,F*ue,k*V);break;case"YZY":w.set(F*ue,k*te,F*le,k*V);break;case"ZXZ":w.set(F*le,F*ue,k*te,k*V);break;case"XZX":w.set(k*te,F*Ee,F*_e,k*V);break;case"YXY":w.set(F*_e,k*te,F*Ee,k*V);break;case"ZYZ":w.set(F*Ee,F*_e,k*te,k*V);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}});class zn{constructor(e=0,c=0){this.x=e,this.y=c}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,c){return this.x=e,this.y=c,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const c=this.x,d=this.y,_=e.elements;return this.x=_[0]*c+_[3]*d+_[6],this.y=_[1]*c+_[4]*d+_[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,d=this.y-e.y;return c*c+d*d}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this}rotateAround(e,c){const d=Math.cos(c),_=Math.sin(c),S=this.x-e.x,L=this.y-e.y;return this.x=S*d-L*_+e.x,this.y=S*_+L*d+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}zn.prototype.isVector2=!0;class lt{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,c,d,_,S,L,k,F,V){const te=this.elements;return te[0]=e,te[1]=_,te[2]=k,te[3]=c,te[4]=S,te[5]=F,te[6]=d,te[7]=L,te[8]=V,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const c=this.elements,d=e.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],this}extractBasis(e,c,d){return e.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const c=e.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const d=e.elements,_=c.elements,S=this.elements,L=d[0],k=d[3],F=d[6],V=d[1],te=d[4],le=d[7],ue=d[2],_e=d[5],Ee=d[8],$e=_[0],Le=_[3],Ne=_[6],We=_[1],tt=_[4],Ze=_[7],ot=_[2],st=_[5],Ct=_[8];return S[0]=L*$e+k*We+F*ot,S[3]=L*Le+k*tt+F*st,S[6]=L*Ne+k*Ze+F*Ct,S[1]=V*$e+te*We+le*ot,S[4]=V*Le+te*tt+le*st,S[7]=V*Ne+te*Ze+le*Ct,S[2]=ue*$e+_e*We+Ee*ot,S[5]=ue*Le+_e*tt+Ee*st,S[8]=ue*Ne+_e*Ze+Ee*Ct,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[3]*=e,c[6]*=e,c[1]*=e,c[4]*=e,c[7]*=e,c[2]*=e,c[5]*=e,c[8]*=e,this}determinant(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],L=e[4],k=e[5],F=e[6],V=e[7],te=e[8];return c*L*te-c*k*V-d*S*te+d*k*F+_*S*V-_*L*F}invert(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],L=e[4],k=e[5],F=e[6],V=e[7],te=e[8],le=te*L-k*V,ue=k*F-te*S,_e=V*S-L*F,Ee=c*le+d*ue+_*_e;if(0===Ee)return this.set(0,0,0,0,0,0,0,0,0);const $e=1/Ee;return e[0]=le*$e,e[1]=(_*V-te*d)*$e,e[2]=(k*d-_*L)*$e,e[3]=ue*$e,e[4]=(te*c-_*F)*$e,e[5]=(_*S-k*c)*$e,e[6]=_e*$e,e[7]=(d*F-V*c)*$e,e[8]=(L*c-d*S)*$e,this}transpose(){let e;const c=this.elements;return e=c[1],c[1]=c[3],c[3]=e,e=c[2],c[2]=c[6],c[6]=e,e=c[5],c[5]=c[7],c[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const c=this.elements;return e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8],this}setUvTransform(e,c,d,_,S,L,k){const F=Math.cos(S),V=Math.sin(S);return this.set(d*F,d*V,-d*(F*L+V*k)+L+e,-_*V,_*F,-_*(-V*L+F*k)+k+c,0,0,1),this}scale(e,c){const d=this.elements;return d[0]*=e,d[3]*=e,d[6]*=e,d[1]*=c,d[4]*=c,d[7]*=c,this}rotate(e){const c=Math.cos(e),d=Math.sin(e),_=this.elements,S=_[0],L=_[3],k=_[6],F=_[1],V=_[4],te=_[7];return _[0]=c*S+d*F,_[3]=c*L+d*V,_[6]=c*k+d*te,_[1]=-d*S+c*F,_[4]=-d*L+c*V,_[7]=-d*k+c*te,this}translate(e,c){const d=this.elements;return d[0]+=e*d[2],d[3]+=e*d[5],d[6]+=e*d[8],d[1]+=c*d[2],d[4]+=c*d[5],d[7]+=c*d[8],this}equals(e){const c=this.elements,d=e.elements;for(let _=0;_<9;_++)if(c[_]!==d[_])return!1;return!0}fromArray(e,c=0){for(let d=0;d<9;d++)this.elements[d]=e[d+c];return this}toArray(e=[],c=0){const d=this.elements;return e[c]=d[0],e[c+1]=d[1],e[c+2]=d[2],e[c+3]=d[3],e[c+4]=d[4],e[c+5]=d[5],e[c+6]=d[6],e[c+7]=d[7],e[c+8]=d[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let $l;lt.prototype.isMatrix3=!0;class Ms{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let c;if(e instanceof HTMLCanvasElement)c=e;else{void 0===$l&&($l=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$l.width=e.width,$l.height=e.height;const d=$l.getContext("2d");e instanceof ImageData?d.putImageData(e,0,0):d.drawImage(e,0,0,e.width,e.height),c=$l}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}}let Tp=0;class As extends ks{constructor(e=As.DEFAULT_IMAGE,c=As.DEFAULT_MAPPING,d=Jr,_=Jr,S=ai,L=sl,k=ao,F=ca,V=1,te=Ji){super(),Object.defineProperty(this,"id",{value:Tp++}),this.uuid=Zi(),this.name="",this.image=e,this.mipmaps=[],this.mapping=c,this.wrapS=d,this.wrapT=_,this.magFilter=S,this.minFilter=L,this.anisotropy=V,this.format=k,this.internalFormat=null,this.type=F,this.offset=new zn(0,0),this.repeat=new zn(1,1),this.center=new zn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new lt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=te,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const c=void 0===e||"string"==typeof e;if(!c&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const _=this.image;if(void 0===_.uuid&&(_.uuid=Zi()),!c&&void 0===e.images[_.uuid]){let S;if(Array.isArray(_)){S=[];for(let L=0,k=_.length;L<k;L++)S.push(Sc(_[L].isDataTexture?_[L].image:_[L]))}else S=Sc(_);e.images[_.uuid]={uuid:_.uuid,url:S}}d.image=_.uuid}return c||(e.textures[this.uuid]=d),d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==yi)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case go:e.x=e.x-Math.floor(e.x);break;case Jr:e.x=e.x<0?0:1;break;case os:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case go:e.y=e.y-Math.floor(e.y);break;case Jr:e.y=e.y<0?0:1;break;case os:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function Sc(w){return typeof HTMLImageElement<"u"&&w instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&w instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&w instanceof ImageBitmap?Ms.getDataURL(w):w.data?{data:Array.prototype.slice.call(w.data),width:w.width,height:w.height,type:w.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}As.DEFAULT_IMAGE=void 0,As.DEFAULT_MAPPING=yi,As.prototype.isTexture=!0;class Di{constructor(e=0,c=0,d=0,_=1){this.x=e,this.y=c,this.z=d,this.w=_}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,c,d,_){return this.x=e,this.y=c,this.z=d,this.w=_,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this.w=e.w+c.w,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this.w+=e.w*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this.w=e.w-c.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const c=this.x,d=this.y,_=this.z,S=this.w,L=e.elements;return this.x=L[0]*c+L[4]*d+L[8]*_+L[12]*S,this.y=L[1]*c+L[5]*d+L[9]*_+L[13]*S,this.z=L[2]*c+L[6]*d+L[10]*_+L[14]*S,this.w=L[3]*c+L[7]*d+L[11]*_+L[15]*S,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const c=Math.sqrt(1-e.w*e.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/c,this.y=e.y/c,this.z=e.z/c),this}setAxisAngleFromRotationMatrix(e){let c,d,_,S;const F=e.elements,V=F[0],te=F[4],le=F[8],ue=F[1],_e=F[5],Ee=F[9],$e=F[2],Le=F[6],Ne=F[10];if(Math.abs(te-ue)<.01&&Math.abs(le-$e)<.01&&Math.abs(Ee-Le)<.01){if(Math.abs(te+ue)<.1&&Math.abs(le+$e)<.1&&Math.abs(Ee+Le)<.1&&Math.abs(V+_e+Ne-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const tt=(V+1)/2,Ze=(_e+1)/2,ot=(Ne+1)/2,st=(te+ue)/4,Ct=(le+$e)/4,Ft=(Ee+Le)/4;return tt>Ze&&tt>ot?tt<.01?(d=0,_=.707106781,S=.707106781):(d=Math.sqrt(tt),_=st/d,S=Ct/d):Ze>ot?Ze<.01?(d=.707106781,_=0,S=.707106781):(_=Math.sqrt(Ze),d=st/_,S=Ft/_):ot<.01?(d=.707106781,_=.707106781,S=0):(S=Math.sqrt(ot),d=Ct/S,_=Ft/S),this.set(d,_,S,c),this}let We=Math.sqrt((Le-Ee)*(Le-Ee)+(le-$e)*(le-$e)+(ue-te)*(ue-te));return Math.abs(We)<.001&&(We=1),this.x=(Le-Ee)/We,this.y=(le-$e)/We,this.z=(ue-te)/We,this.w=Math.acos((V+_e+Ne-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this.w=Math.max(e.w,Math.min(c.w,this.w)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this.w=Math.max(e,Math.min(c,this.w)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this.w+=(e.w-this.w)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this.z=e.z+(c.z-e.z)*d,this.w=e.w+(c.w-e.w)*d,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this.w=e[c+3],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e[c+3]=this.w,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this.w=e.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Di.prototype.isVector4=!0;class ro extends ks{constructor(e,c,d={}){super(),this.width=e,this.height=c,this.depth=1,this.scissor=new Di(0,0,e,c),this.scissorTest=!1,this.viewport=new Di(0,0,e,c),this.texture=new As(void 0,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:c,depth:1},this.texture.generateMipmaps=void 0!==d.generateMipmaps&&d.generateMipmaps,this.texture.internalFormat=void 0!==d.internalFormat?d.internalFormat:null,this.texture.minFilter=void 0!==d.minFilter?d.minFilter:ai,this.depthBuffer=void 0===d.depthBuffer||d.depthBuffer,this.stencilBuffer=void 0!==d.stencilBuffer&&d.stencilBuffer,this.depthTexture=void 0!==d.depthTexture?d.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,c,d=1){this.width===e&&this.height===c&&this.depth===d||(this.width=e,this.height=c,this.depth=d,this.texture.image.width=e,this.texture.image.height=c,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}ro.prototype.isWebGLRenderTarget=!0;class ri extends ro{constructor(e,c,d){super(e,c);const _=this.texture;this.texture=[];for(let S=0;S<d;S++)this.texture[S]=_.clone()}setSize(e,c,d=1){if(this.width!==e||this.height!==c||this.depth!==d){this.width=e,this.height=c,this.depth=d;for(let _=0,S=this.texture.length;_<S;_++)this.texture[_].image.width=e,this.texture[_].image.height=c,this.texture[_].image.depth=d;this.dispose()}return this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let c=0,d=e.texture.length;c<d;c++)this.texture[c]=e.texture[c].clone();return this}}ri.prototype.isWebGLMultipleRenderTargets=!0;class Jc extends ro{constructor(e,c,d){super(e,c,d),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}Jc.prototype.isWebGLMultisampleRenderTarget=!0;class $i{constructor(e=0,c=0,d=0,_=1){this._x=e,this._y=c,this._z=d,this._w=_}static slerp(e,c,d,_){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),d.slerpQuaternions(e,c,_)}static slerpFlat(e,c,d,_,S,L,k){let F=d[_+0],V=d[_+1],te=d[_+2],le=d[_+3];const ue=S[L+0],_e=S[L+1],Ee=S[L+2],$e=S[L+3];if(0===k)return e[c+0]=F,e[c+1]=V,e[c+2]=te,void(e[c+3]=le);if(1===k)return e[c+0]=ue,e[c+1]=_e,e[c+2]=Ee,void(e[c+3]=$e);if(le!==$e||F!==ue||V!==_e||te!==Ee){let Le=1-k;const Ne=F*ue+V*_e+te*Ee+le*$e,We=Ne>=0?1:-1,tt=1-Ne*Ne;if(tt>Number.EPSILON){const ot=Math.sqrt(tt),st=Math.atan2(ot,Ne*We);Le=Math.sin(Le*st)/ot,k=Math.sin(k*st)/ot}const Ze=k*We;if(F=F*Le+ue*Ze,V=V*Le+_e*Ze,te=te*Le+Ee*Ze,le=le*Le+$e*Ze,Le===1-k){const ot=1/Math.sqrt(F*F+V*V+te*te+le*le);F*=ot,V*=ot,te*=ot,le*=ot}}e[c]=F,e[c+1]=V,e[c+2]=te,e[c+3]=le}static multiplyQuaternionsFlat(e,c,d,_,S,L){const k=d[_],F=d[_+1],V=d[_+2],te=d[_+3],le=S[L],ue=S[L+1],_e=S[L+2],Ee=S[L+3];return e[c]=k*Ee+te*le+F*_e-V*ue,e[c+1]=F*Ee+te*ue+V*le-k*_e,e[c+2]=V*Ee+te*_e+k*ue-F*le,e[c+3]=te*Ee-k*le-F*ue-V*_e,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,c,d,_){return this._x=e,this._y=c,this._z=d,this._w=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,c){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const d=e._x,_=e._y,S=e._z,L=e._order,k=Math.cos,F=Math.sin,V=k(d/2),te=k(_/2),le=k(S/2),ue=F(d/2),_e=F(_/2),Ee=F(S/2);switch(L){case"XYZ":this._x=ue*te*le+V*_e*Ee,this._y=V*_e*le-ue*te*Ee,this._z=V*te*Ee+ue*_e*le,this._w=V*te*le-ue*_e*Ee;break;case"YXZ":this._x=ue*te*le+V*_e*Ee,this._y=V*_e*le-ue*te*Ee,this._z=V*te*Ee-ue*_e*le,this._w=V*te*le+ue*_e*Ee;break;case"ZXY":this._x=ue*te*le-V*_e*Ee,this._y=V*_e*le+ue*te*Ee,this._z=V*te*Ee+ue*_e*le,this._w=V*te*le-ue*_e*Ee;break;case"ZYX":this._x=ue*te*le-V*_e*Ee,this._y=V*_e*le+ue*te*Ee,this._z=V*te*Ee-ue*_e*le,this._w=V*te*le+ue*_e*Ee;break;case"YZX":this._x=ue*te*le+V*_e*Ee,this._y=V*_e*le+ue*te*Ee,this._z=V*te*Ee-ue*_e*le,this._w=V*te*le-ue*_e*Ee;break;case"XZY":this._x=ue*te*le-V*_e*Ee,this._y=V*_e*le-ue*te*Ee,this._z=V*te*Ee+ue*_e*le,this._w=V*te*le+ue*_e*Ee;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+L)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(e,c){const d=c/2,_=Math.sin(d);return this._x=e.x*_,this._y=e.y*_,this._z=e.z*_,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(e){const c=e.elements,d=c[0],_=c[4],S=c[8],L=c[1],k=c[5],F=c[9],V=c[2],te=c[6],le=c[10],ue=d+k+le;if(ue>0){const _e=.5/Math.sqrt(ue+1);this._w=.25/_e,this._x=(te-F)*_e,this._y=(S-V)*_e,this._z=(L-_)*_e}else if(d>k&&d>le){const _e=2*Math.sqrt(1+d-k-le);this._w=(te-F)/_e,this._x=.25*_e,this._y=(_+L)/_e,this._z=(S+V)/_e}else if(k>le){const _e=2*Math.sqrt(1+k-d-le);this._w=(S-V)/_e,this._x=(_+L)/_e,this._y=.25*_e,this._z=(F+te)/_e}else{const _e=2*Math.sqrt(1+le-d-k);this._w=(L-_)/_e,this._x=(S+V)/_e,this._y=(F+te)/_e,this._z=.25*_e}return this._onChangeCallback(),this}setFromUnitVectors(e,c){let d=e.dot(c)+1;return d<Number.EPSILON?(d=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=d):(this._x=0,this._y=-e.z,this._z=e.y,this._w=d)):(this._x=e.y*c.z-e.z*c.y,this._y=e.z*c.x-e.x*c.z,this._z=e.x*c.y-e.y*c.x,this._w=d),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Hr(this.dot(e),-1,1)))}rotateTowards(e,c){const d=this.angleTo(e);if(0===d)return this;const _=Math.min(1,c/d);return this.slerp(e,_),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,c)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,c){const d=e._x,_=e._y,S=e._z,L=e._w,k=c._x,F=c._y,V=c._z,te=c._w;return this._x=d*te+L*k+_*V-S*F,this._y=_*te+L*F+S*k-d*V,this._z=S*te+L*V+d*F-_*k,this._w=L*te-d*k-_*F-S*V,this._onChangeCallback(),this}slerp(e,c){if(0===c)return this;if(1===c)return this.copy(e);const d=this._x,_=this._y,S=this._z,L=this._w;let k=L*e._w+d*e._x+_*e._y+S*e._z;if(k<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,k=-k):this.copy(e),k>=1)return this._w=L,this._x=d,this._y=_,this._z=S,this;const F=1-k*k;if(F<=Number.EPSILON){const _e=1-c;return this._w=_e*L+c*this._w,this._x=_e*d+c*this._x,this._y=_e*_+c*this._y,this._z=_e*S+c*this._z,this.normalize(),this._onChangeCallback(),this}const V=Math.sqrt(F),te=Math.atan2(V,k),le=Math.sin((1-c)*te)/V,ue=Math.sin(c*te)/V;return this._w=L*le+this._w*ue,this._x=d*le+this._x*ue,this._y=_*le+this._y*ue,this._z=S*le+this._z*ue,this._onChangeCallback(),this}slerpQuaternions(e,c,d){this.copy(e).slerp(c,d)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,c=0){return this._x=e[c],this._y=e[c+1],this._z=e[c+2],this._w=e[c+3],this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._w,e}fromBufferAttribute(e,c){return this._x=e.getX(c),this._y=e.getY(c),this._z=e.getZ(c),this._w=e.getW(c),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}$i.prototype.isQuaternion=!0;class ht{constructor(e=0,c=0,d=0){this.x=e,this.y=c,this.z=d}set(e,c,d){return void 0===d&&(d=this.z),this.x=e,this.y=c,this.z=d,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,c)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,c){return this.x=e.x*c.x,this.y=e.y*c.y,this.z=e.z*c.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Mp.setFromEuler(e))}applyAxisAngle(e,c){return this.applyQuaternion(Mp.setFromAxisAngle(e,c))}applyMatrix3(e){const c=this.x,d=this.y,_=this.z,S=e.elements;return this.x=S[0]*c+S[3]*d+S[6]*_,this.y=S[1]*c+S[4]*d+S[7]*_,this.z=S[2]*c+S[5]*d+S[8]*_,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const c=this.x,d=this.y,_=this.z,S=e.elements,L=1/(S[3]*c+S[7]*d+S[11]*_+S[15]);return this.x=(S[0]*c+S[4]*d+S[8]*_+S[12])*L,this.y=(S[1]*c+S[5]*d+S[9]*_+S[13])*L,this.z=(S[2]*c+S[6]*d+S[10]*_+S[14])*L,this}applyQuaternion(e){const c=this.x,d=this.y,_=this.z,S=e.x,L=e.y,k=e.z,F=e.w,V=F*c+L*_-k*d,te=F*d+k*c-S*_,le=F*_+S*d-L*c,ue=-S*c-L*d-k*_;return this.x=V*F+ue*-S+te*-k-le*-L,this.y=te*F+ue*-L+le*-S-V*-k,this.z=le*F+ue*-k+V*-L-te*-S,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const c=this.x,d=this.y,_=this.z,S=e.elements;return this.x=S[0]*c+S[4]*d+S[8]*_,this.y=S[1]*c+S[5]*d+S[9]*_,this.z=S[2]*c+S[6]*d+S[10]*_,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this}clampLength(e,c){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(c,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this}lerpVectors(e,c,d){return this.x=e.x+(c.x-e.x)*d,this.y=e.y+(c.y-e.y)*d,this.z=e.z+(c.z-e.z)*d,this}cross(e,c){return void 0!==c?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,c)):this.crossVectors(this,e)}crossVectors(e,c){const d=e.x,_=e.y,S=e.z,L=c.x,k=c.y,F=c.z;return this.x=_*F-S*k,this.y=S*L-d*F,this.z=d*k-_*L,this}projectOnVector(e){const c=e.lengthSq();if(0===c)return this.set(0,0,0);const d=e.dot(this)/c;return this.copy(e).multiplyScalar(d)}projectOnPlane(e){return bu.copy(this).projectOnVector(e),this.sub(bu)}reflect(e){return this.sub(bu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const c=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===c)return Math.PI/2;const d=this.dot(e)/c;return Math.acos(Hr(d,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,d=this.y-e.y,_=this.z-e.z;return c*c+d*d+_*_}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,c,d){const _=Math.sin(c)*e;return this.x=_*Math.sin(d),this.y=Math.cos(c)*e,this.z=_*Math.cos(d),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,c,d){return this.x=e*Math.sin(c),this.y=d,this.z=e*Math.cos(c),this}setFromMatrixPosition(e){const c=e.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(e){const c=this.setFromMatrixColumn(e,0).length(),d=this.setFromMatrixColumn(e,1).length(),_=this.setFromMatrixColumn(e,2).length();return this.x=c,this.y=d,this.z=_,this}setFromMatrixColumn(e,c){return this.fromArray(e.elements,4*c)}setFromMatrix3Column(e,c){return this.fromArray(e.elements,3*c)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e}fromBufferAttribute(e,c,d){return void 0!==d&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}ht.prototype.isVector3=!0;const bu=new ht,Mp=new $i;class Ui{constructor(e=new ht(1/0,1/0,1/0),c=new ht(-1/0,-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromArray(e){let c=1/0,d=1/0,_=1/0,S=-1/0,L=-1/0,k=-1/0;for(let F=0,V=e.length;F<V;F+=3){const te=e[F],le=e[F+1],ue=e[F+2];te<c&&(c=te),le<d&&(d=le),ue<_&&(_=ue),te>S&&(S=te),le>L&&(L=le),ue>k&&(k=ue)}return this.min.set(c,d,_),this.max.set(S,L,k),this}setFromBufferAttribute(e){let c=1/0,d=1/0,_=1/0,S=-1/0,L=-1/0,k=-1/0;for(let F=0,V=e.count;F<V;F++){const te=e.getX(F),le=e.getY(F),ue=e.getZ(F);te<c&&(c=te),le<d&&(d=le),ue<_&&(_=ue),te>S&&(S=te),le>L&&(L=le),ue>k&&(k=ue)}return this.min.set(c,d,_),this.max.set(S,L,k),this}setFromPoints(e){this.makeEmpty();for(let c=0,d=e.length;c<d;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const d=qr.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const c=e.geometry;void 0!==c&&(null===c.boundingBox&&c.computeBoundingBox(),Ya.copy(c.boundingBox),Ya.applyMatrix4(e.matrixWorld),this.union(Ya));const d=e.children;for(let _=0,S=d.length;_<S;_++)this.expandByObject(d[_]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,qr),qr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let c,d;return e.normal.x>0?(c=e.normal.x*this.min.x,d=e.normal.x*this.max.x):(c=e.normal.x*this.max.x,d=e.normal.x*this.min.x),e.normal.y>0?(c+=e.normal.y*this.min.y,d+=e.normal.y*this.max.y):(c+=e.normal.y*this.max.y,d+=e.normal.y*this.min.y),e.normal.z>0?(c+=e.normal.z*this.min.z,d+=e.normal.z*this.max.z):(c+=e.normal.z*this.max.z,d+=e.normal.z*this.min.z),c<=-e.constant&&d>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sh),Tc.subVectors(this.max,Sh),yo.subVectors(e.a,Sh),fa.subVectors(e.b,Sh),xu.subVectors(e.c,Sh),Ec.subVectors(fa,yo),Zc.subVectors(xu,fa),wu.subVectors(yo,xu);let c=[0,-Ec.z,Ec.y,0,-Zc.z,Zc.y,0,-wu.z,wu.y,Ec.z,0,-Ec.x,Zc.z,0,-Zc.x,wu.z,0,-wu.x,-Ec.y,Ec.x,0,-Zc.y,Zc.x,0,-wu.y,wu.x,0];return!!Ja(c,yo,fa,xu,Tc)&&(c=[1,0,0,0,1,0,0,0,1],!!Ja(c,yo,fa,xu,Tc)&&(Qn.crossVectors(Ec,Zc),c=[Qn.x,Qn.y,Qn.z],Ja(c,yo,fa,xu,Tc)))}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(qr).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(Or[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Or[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Or[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Or[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Or[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Or[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Or[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Or[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Or)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ui.prototype.isBox3=!0;const Or=[new ht,new ht,new ht,new ht,new ht,new ht,new ht,new ht],qr=new ht,Ya=new Ui,yo=new ht,fa=new ht,xu=new ht,Ec=new ht,Zc=new ht,wu=new ht,Sh=new ht,Tc=new ht,Qn=new ht,Cl=new ht;function Ja(w,e,c,d,_){for(let S=0,L=w.length-3;S<=L;S+=3){Cl.fromArray(w,S);const k=_.x*Math.abs(Cl.x)+_.y*Math.abs(Cl.y)+_.z*Math.abs(Cl.z),F=e.dot(Cl),V=c.dot(Cl),te=d.dot(Cl);if(Math.max(-Math.max(F,V,te),Math.min(F,V,te))>k)return!1}return!0}const Ca=new Ui,Kl=new ht,Su=new ht,La=new ht;class bo{constructor(e=new ht,c=-1){this.center=e,this.radius=c}set(e,c){return this.center.copy(e),this.radius=c,this}setFromPoints(e,c){const d=this.center;void 0!==c?d.copy(c):Ca.setFromPoints(e).getCenter(d);let _=0;for(let S=0,L=e.length;S<L;S++)_=Math.max(_,d.distanceToSquared(e[S]));return this.radius=Math.sqrt(_),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const c=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=c*c}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,c){const d=this.center.distanceToSquared(e);return c.copy(e),d>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){La.subVectors(e,this.center);const c=La.lengthSq();if(c>this.radius*this.radius){const d=Math.sqrt(c),_=.5*(d-this.radius);this.center.add(La.multiplyScalar(_/d)),this.radius+=_}return this}union(e){return Su.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Kl.copy(e.center).add(Su)),this.expandByPoint(Kl.copy(e.center).sub(Su)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Ds=new ht,Mc=new ht,it=new ht,xt=new ht,Ut=new ht,bn=new ht,qt=new ht;class fn{constructor(e=new ht,c=new ht(0,0,-1)){this.origin=e,this.direction=c}set(e,c){return this.origin.copy(e),this.direction.copy(c),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,c){return c.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ds)),this}closestPointToPoint(e,c){c.subVectors(e,this.origin);const d=c.dot(this.direction);return d<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const c=Ds.subVectors(e,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(e):(Ds.copy(this.direction).multiplyScalar(c).add(this.origin),Ds.distanceToSquared(e))}distanceSqToSegment(e,c,d,_){Mc.copy(e).add(c).multiplyScalar(.5),it.copy(c).sub(e).normalize(),xt.copy(this.origin).sub(Mc);const S=.5*e.distanceTo(c),L=-this.direction.dot(it),k=xt.dot(this.direction),F=-xt.dot(it),V=xt.lengthSq(),te=Math.abs(1-L*L);let le,ue,_e,Ee;if(te>0)if(le=L*F-k,ue=L*k-F,Ee=S*te,le>=0)if(ue>=-Ee)if(ue<=Ee){const $e=1/te;le*=$e,ue*=$e,_e=le*(le+L*ue+2*k)+ue*(L*le+ue+2*F)+V}else ue=S,le=Math.max(0,-(L*ue+k)),_e=-le*le+ue*(ue+2*F)+V;else ue=-S,le=Math.max(0,-(L*ue+k)),_e=-le*le+ue*(ue+2*F)+V;else ue<=-Ee?(le=Math.max(0,-(-L*S+k)),ue=le>0?-S:Math.min(Math.max(-S,-F),S),_e=-le*le+ue*(ue+2*F)+V):ue<=Ee?(le=0,ue=Math.min(Math.max(-S,-F),S),_e=ue*(ue+2*F)+V):(le=Math.max(0,-(L*S+k)),ue=le>0?S:Math.min(Math.max(-S,-F),S),_e=-le*le+ue*(ue+2*F)+V);else ue=L>0?-S:S,le=Math.max(0,-(L*ue+k)),_e=-le*le+ue*(ue+2*F)+V;return d&&d.copy(this.direction).multiplyScalar(le).add(this.origin),_&&_.copy(it).multiplyScalar(ue).add(Mc),_e}intersectSphere(e,c){Ds.subVectors(e.center,this.origin);const d=Ds.dot(this.direction),_=Ds.dot(Ds)-d*d,S=e.radius*e.radius;if(_>S)return null;const L=Math.sqrt(S-_),k=d-L,F=d+L;return k<0&&F<0?null:this.at(k<0?F:k,c)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const c=e.normal.dot(this.direction);if(0===c)return 0===e.distanceToPoint(this.origin)?0:null;const d=-(this.origin.dot(e.normal)+e.constant)/c;return d>=0?d:null}intersectPlane(e,c){const d=this.distanceToPlane(e);return null===d?null:this.at(d,c)}intersectsPlane(e){const c=e.distanceToPoint(this.origin);return 0===c||e.normal.dot(this.direction)*c<0}intersectBox(e,c){let d,_,S,L,k,F;const V=1/this.direction.x,te=1/this.direction.y,le=1/this.direction.z,ue=this.origin;return V>=0?(d=(e.min.x-ue.x)*V,_=(e.max.x-ue.x)*V):(d=(e.max.x-ue.x)*V,_=(e.min.x-ue.x)*V),te>=0?(S=(e.min.y-ue.y)*te,L=(e.max.y-ue.y)*te):(S=(e.max.y-ue.y)*te,L=(e.min.y-ue.y)*te),d>L||S>_?null:((S>d||d!=d)&&(d=S),(L<_||_!=_)&&(_=L),le>=0?(k=(e.min.z-ue.z)*le,F=(e.max.z-ue.z)*le):(k=(e.max.z-ue.z)*le,F=(e.min.z-ue.z)*le),d>F||k>_?null:((k>d||d!=d)&&(d=k),(F<_||_!=_)&&(_=F),_<0?null:this.at(d>=0?d:_,c)))}intersectsBox(e){return null!==this.intersectBox(e,Ds)}intersectTriangle(e,c,d,_,S){Ut.subVectors(c,e),bn.subVectors(d,e),qt.crossVectors(Ut,bn);let L,k=this.direction.dot(qt);if(k>0){if(_)return null;L=1}else{if(!(k<0))return null;L=-1,k=-k}xt.subVectors(this.origin,e);const F=L*this.direction.dot(bn.crossVectors(xt,bn));if(F<0)return null;const V=L*this.direction.dot(Ut.cross(xt));if(V<0||F+V>k)return null;const te=-L*xt.dot(qt);return te<0?null:this.at(te/k,S)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class tn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,c,d,_,S,L,k,F,V,te,le,ue,_e,Ee,$e,Le){const Ne=this.elements;return Ne[0]=e,Ne[4]=c,Ne[8]=d,Ne[12]=_,Ne[1]=S,Ne[5]=L,Ne[9]=k,Ne[13]=F,Ne[2]=V,Ne[6]=te,Ne[10]=le,Ne[14]=ue,Ne[3]=_e,Ne[7]=Ee,Ne[11]=$e,Ne[15]=Le,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new tn).fromArray(this.elements)}copy(e){const c=this.elements,d=e.elements;return c[0]=d[0],c[1]=d[1],c[2]=d[2],c[3]=d[3],c[4]=d[4],c[5]=d[5],c[6]=d[6],c[7]=d[7],c[8]=d[8],c[9]=d[9],c[10]=d[10],c[11]=d[11],c[12]=d[12],c[13]=d[13],c[14]=d[14],c[15]=d[15],this}copyPosition(e){const c=this.elements,d=e.elements;return c[12]=d[12],c[13]=d[13],c[14]=d[14],this}setFromMatrix3(e){const c=e.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(e,c,d){return e.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(e,c,d){return this.set(e.x,c.x,d.x,0,e.y,c.y,d.y,0,e.z,c.z,d.z,0,0,0,0,1),this}extractRotation(e){const c=this.elements,d=e.elements,_=1/qn.setFromMatrixColumn(e,0).length(),S=1/qn.setFromMatrixColumn(e,1).length(),L=1/qn.setFromMatrixColumn(e,2).length();return c[0]=d[0]*_,c[1]=d[1]*_,c[2]=d[2]*_,c[3]=0,c[4]=d[4]*S,c[5]=d[5]*S,c[6]=d[6]*S,c[7]=0,c[8]=d[8]*L,c[9]=d[9]*L,c[10]=d[10]*L,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,d=e.x,_=e.y,S=e.z,L=Math.cos(d),k=Math.sin(d),F=Math.cos(_),V=Math.sin(_),te=Math.cos(S),le=Math.sin(S);if("XYZ"===e.order){const ue=L*te,_e=L*le,Ee=k*te,$e=k*le;c[0]=F*te,c[4]=-F*le,c[8]=V,c[1]=_e+Ee*V,c[5]=ue-$e*V,c[9]=-k*F,c[2]=$e-ue*V,c[6]=Ee+_e*V,c[10]=L*F}else if("YXZ"===e.order){const ue=F*te,_e=F*le,Ee=V*te,$e=V*le;c[0]=ue+$e*k,c[4]=Ee*k-_e,c[8]=L*V,c[1]=L*le,c[5]=L*te,c[9]=-k,c[2]=_e*k-Ee,c[6]=$e+ue*k,c[10]=L*F}else if("ZXY"===e.order){const ue=F*te,_e=F*le,Ee=V*te,$e=V*le;c[0]=ue-$e*k,c[4]=-L*le,c[8]=Ee+_e*k,c[1]=_e+Ee*k,c[5]=L*te,c[9]=$e-ue*k,c[2]=-L*V,c[6]=k,c[10]=L*F}else if("ZYX"===e.order){const ue=L*te,_e=L*le,Ee=k*te,$e=k*le;c[0]=F*te,c[4]=Ee*V-_e,c[8]=ue*V+$e,c[1]=F*le,c[5]=$e*V+ue,c[9]=_e*V-Ee,c[2]=-V,c[6]=k*F,c[10]=L*F}else if("YZX"===e.order){const ue=L*F,_e=L*V,Ee=k*F,$e=k*V;c[0]=F*te,c[4]=$e-ue*le,c[8]=Ee*le+_e,c[1]=le,c[5]=L*te,c[9]=-k*te,c[2]=-V*te,c[6]=_e*le+Ee,c[10]=ue-$e*le}else if("XZY"===e.order){const ue=L*F,_e=L*V,Ee=k*F,$e=k*V;c[0]=F*te,c[4]=-le,c[8]=V*te,c[1]=ue*le+$e,c[5]=L*te,c[9]=_e*le-Ee,c[2]=Ee*le-_e,c[6]=k*te,c[10]=$e*le+ue}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sr,e,$r)}lookAt(e,c,d){const _=this.elements;return fi.subVectors(e,c),0===fi.lengthSq()&&(fi.z=1),fi.normalize(),yr.crossVectors(d,fi),0===yr.lengthSq()&&(1===Math.abs(d.z)?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),yr.crossVectors(d,fi)),yr.normalize(),Xr.crossVectors(fi,yr),_[0]=yr.x,_[4]=Xr.x,_[8]=fi.x,_[1]=yr.y,_[5]=Xr.y,_[9]=fi.y,_[2]=yr.z,_[6]=Xr.z,_[10]=fi.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,c)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const d=e.elements,_=c.elements,S=this.elements,L=d[0],k=d[4],F=d[8],V=d[12],te=d[1],le=d[5],ue=d[9],_e=d[13],Ee=d[2],$e=d[6],Le=d[10],Ne=d[14],We=d[3],tt=d[7],Ze=d[11],ot=d[15],st=_[0],Ct=_[4],Ft=_[8],Qe=_[12],nt=_[1],Tt=_[5],Yt=_[9],ct=_[13],Lt=_[2],_t=_[6],zt=_[10],Rt=_[14],nn=_[3],en=_[7],Mn=_[11],rt=_[15];return S[0]=L*st+k*nt+F*Lt+V*nn,S[4]=L*Ct+k*Tt+F*_t+V*en,S[8]=L*Ft+k*Yt+F*zt+V*Mn,S[12]=L*Qe+k*ct+F*Rt+V*rt,S[1]=te*st+le*nt+ue*Lt+_e*nn,S[5]=te*Ct+le*Tt+ue*_t+_e*en,S[9]=te*Ft+le*Yt+ue*zt+_e*Mn,S[13]=te*Qe+le*ct+ue*Rt+_e*rt,S[2]=Ee*st+$e*nt+Le*Lt+Ne*nn,S[6]=Ee*Ct+$e*Tt+Le*_t+Ne*en,S[10]=Ee*Ft+$e*Yt+Le*zt+Ne*Mn,S[14]=Ee*Qe+$e*ct+Le*Rt+Ne*rt,S[3]=We*st+tt*nt+Ze*Lt+ot*nn,S[7]=We*Ct+tt*Tt+Ze*_t+ot*en,S[11]=We*Ft+tt*Yt+Ze*zt+ot*Mn,S[15]=We*Qe+tt*ct+Ze*Rt+ot*rt,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[4]*=e,c[8]*=e,c[12]*=e,c[1]*=e,c[5]*=e,c[9]*=e,c[13]*=e,c[2]*=e,c[6]*=e,c[10]*=e,c[14]*=e,c[3]*=e,c[7]*=e,c[11]*=e,c[15]*=e,this}determinant(){const e=this.elements,c=e[0],d=e[4],_=e[8],S=e[12],L=e[1],k=e[5],F=e[9],V=e[13],te=e[2],le=e[6],ue=e[10],_e=e[14];return e[3]*(+S*F*le-_*V*le-S*k*ue+d*V*ue+_*k*_e-d*F*_e)+e[7]*(+c*F*_e-c*V*ue+S*L*ue-_*L*_e+_*V*te-S*F*te)+e[11]*(+c*V*le-c*k*_e-S*L*le+d*L*_e+S*k*te-d*V*te)+e[15]*(-_*k*te-c*F*le+c*k*ue+_*L*le-d*L*ue+d*F*te)}transpose(){const e=this.elements;let c;return c=e[1],e[1]=e[4],e[4]=c,c=e[2],e[2]=e[8],e[8]=c,c=e[6],e[6]=e[9],e[9]=c,c=e[3],e[3]=e[12],e[12]=c,c=e[7],e[7]=e[13],e[13]=c,c=e[11],e[11]=e[14],e[14]=c,this}setPosition(e,c,d){const _=this.elements;return e.isVector3?(_[12]=e.x,_[13]=e.y,_[14]=e.z):(_[12]=e,_[13]=c,_[14]=d),this}invert(){const e=this.elements,c=e[0],d=e[1],_=e[2],S=e[3],L=e[4],k=e[5],F=e[6],V=e[7],te=e[8],le=e[9],ue=e[10],_e=e[11],Ee=e[12],$e=e[13],Le=e[14],Ne=e[15],We=le*Le*V-$e*ue*V+$e*F*_e-k*Le*_e-le*F*Ne+k*ue*Ne,tt=Ee*ue*V-te*Le*V-Ee*F*_e+L*Le*_e+te*F*Ne-L*ue*Ne,Ze=te*$e*V-Ee*le*V+Ee*k*_e-L*$e*_e-te*k*Ne+L*le*Ne,ot=Ee*le*F-te*$e*F-Ee*k*ue+L*$e*ue+te*k*Le-L*le*Le,st=c*We+d*tt+_*Ze+S*ot;if(0===st)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Ct=1/st;return e[0]=We*Ct,e[1]=($e*ue*S-le*Le*S-$e*_*_e+d*Le*_e+le*_*Ne-d*ue*Ne)*Ct,e[2]=(k*Le*S-$e*F*S+$e*_*V-d*Le*V-k*_*Ne+d*F*Ne)*Ct,e[3]=(le*F*S-k*ue*S-le*_*V+d*ue*V+k*_*_e-d*F*_e)*Ct,e[4]=tt*Ct,e[5]=(te*Le*S-Ee*ue*S+Ee*_*_e-c*Le*_e-te*_*Ne+c*ue*Ne)*Ct,e[6]=(Ee*F*S-L*Le*S-Ee*_*V+c*Le*V+L*_*Ne-c*F*Ne)*Ct,e[7]=(L*ue*S-te*F*S+te*_*V-c*ue*V-L*_*_e+c*F*_e)*Ct,e[8]=Ze*Ct,e[9]=(Ee*le*S-te*$e*S-Ee*d*_e+c*$e*_e+te*d*Ne-c*le*Ne)*Ct,e[10]=(L*$e*S-Ee*k*S+Ee*d*V-c*$e*V-L*d*Ne+c*k*Ne)*Ct,e[11]=(te*k*S-L*le*S-te*d*V+c*le*V+L*d*_e-c*k*_e)*Ct,e[12]=ot*Ct,e[13]=(te*$e*_-Ee*le*_+Ee*d*ue-c*$e*ue-te*d*Le+c*le*Le)*Ct,e[14]=(Ee*k*_-L*$e*_-Ee*d*F+c*$e*F+L*d*Le-c*k*Le)*Ct,e[15]=(L*le*_-te*k*_+te*d*F-c*le*F-L*d*ue+c*k*ue)*Ct,this}scale(e){const c=this.elements,d=e.x,_=e.y,S=e.z;return c[0]*=d,c[4]*=_,c[8]*=S,c[1]*=d,c[5]*=_,c[9]*=S,c[2]*=d,c[6]*=_,c[10]*=S,c[3]*=d,c[7]*=_,c[11]*=S,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,c,d){return this.set(1,0,0,e,0,1,0,c,0,0,1,d,0,0,0,1),this}makeRotationX(e){const c=Math.cos(e),d=Math.sin(e);return this.set(1,0,0,0,0,c,-d,0,0,d,c,0,0,0,0,1),this}makeRotationY(e){const c=Math.cos(e),d=Math.sin(e);return this.set(c,0,d,0,0,1,0,0,-d,0,c,0,0,0,0,1),this}makeRotationZ(e){const c=Math.cos(e),d=Math.sin(e);return this.set(c,-d,0,0,d,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,c){const d=Math.cos(c),_=Math.sin(c),S=1-d,L=e.x,k=e.y,F=e.z,V=S*L,te=S*k;return this.set(V*L+d,V*k-_*F,V*F+_*k,0,V*k+_*F,te*k+d,te*F-_*L,0,V*F-_*k,te*F+_*L,S*F*F+d,0,0,0,0,1),this}makeScale(e,c,d){return this.set(e,0,0,0,0,c,0,0,0,0,d,0,0,0,0,1),this}makeShear(e,c,d,_,S,L){return this.set(1,d,S,0,e,1,L,0,c,_,1,0,0,0,0,1),this}compose(e,c,d){const _=this.elements,S=c._x,L=c._y,k=c._z,F=c._w,V=S+S,te=L+L,le=k+k,ue=S*V,_e=S*te,Ee=S*le,$e=L*te,Le=L*le,Ne=k*le,We=F*V,tt=F*te,Ze=F*le,ot=d.x,st=d.y,Ct=d.z;return _[0]=(1-($e+Ne))*ot,_[1]=(_e+Ze)*ot,_[2]=(Ee-tt)*ot,_[3]=0,_[4]=(_e-Ze)*st,_[5]=(1-(ue+Ne))*st,_[6]=(Le+We)*st,_[7]=0,_[8]=(Ee+tt)*Ct,_[9]=(Le-We)*Ct,_[10]=(1-(ue+$e))*Ct,_[11]=0,_[12]=e.x,_[13]=e.y,_[14]=e.z,_[15]=1,this}decompose(e,c,d){const _=this.elements;let S=qn.set(_[0],_[1],_[2]).length();const L=qn.set(_[4],_[5],_[6]).length(),k=qn.set(_[8],_[9],_[10]).length();this.determinant()<0&&(S=-S),e.x=_[12],e.y=_[13],e.z=_[14],jn.copy(this);const F=1/S,V=1/L,te=1/k;return jn.elements[0]*=F,jn.elements[1]*=F,jn.elements[2]*=F,jn.elements[4]*=V,jn.elements[5]*=V,jn.elements[6]*=V,jn.elements[8]*=te,jn.elements[9]*=te,jn.elements[10]*=te,c.setFromRotationMatrix(jn),d.x=S,d.y=L,d.z=k,this}makePerspective(e,c,d,_,S,L){void 0===L&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const k=this.elements,V=2*S/(d-_),te=(c+e)/(c-e),le=(d+_)/(d-_),ue=-(L+S)/(L-S),_e=-2*L*S/(L-S);return k[0]=2*S/(c-e),k[4]=0,k[8]=te,k[12]=0,k[1]=0,k[5]=V,k[9]=le,k[13]=0,k[2]=0,k[6]=0,k[10]=ue,k[14]=_e,k[3]=0,k[7]=0,k[11]=-1,k[15]=0,this}makeOrthographic(e,c,d,_,S,L){const k=this.elements,F=1/(c-e),V=1/(d-_),te=1/(L-S),le=(c+e)*F,ue=(d+_)*V,_e=(L+S)*te;return k[0]=2*F,k[4]=0,k[8]=0,k[12]=-le,k[1]=0,k[5]=2*V,k[9]=0,k[13]=-ue,k[2]=0,k[6]=0,k[10]=-2*te,k[14]=-_e,k[3]=0,k[7]=0,k[11]=0,k[15]=1,this}equals(e){const c=this.elements,d=e.elements;for(let _=0;_<16;_++)if(c[_]!==d[_])return!1;return!0}fromArray(e,c=0){for(let d=0;d<16;d++)this.elements[d]=e[d+c];return this}toArray(e=[],c=0){const d=this.elements;return e[c]=d[0],e[c+1]=d[1],e[c+2]=d[2],e[c+3]=d[3],e[c+4]=d[4],e[c+5]=d[5],e[c+6]=d[6],e[c+7]=d[7],e[c+8]=d[8],e[c+9]=d[9],e[c+10]=d[10],e[c+11]=d[11],e[c+12]=d[12],e[c+13]=d[13],e[c+14]=d[14],e[c+15]=d[15],e}}tn.prototype.isMatrix4=!0;const qn=new ht,jn=new tn,Sr=new ht(0,0,0),$r=new ht(1,1,1),yr=new ht,Xr=new ht,fi=new ht,Rr=new tn,ts=new $i;class lo{constructor(e=0,c=0,d=0,_=lo.DefaultOrder){this._x=e,this._y=c,this._z=d,this._order=_}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,c,d,_=this._order){return this._x=e,this._y=c,this._z=d,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,c=this._order,d=!0){const _=e.elements,S=_[0],L=_[4],k=_[8],F=_[1],V=_[5],te=_[9],le=_[2],ue=_[6],_e=_[10];switch(c){case"XYZ":this._y=Math.asin(Hr(k,-1,1)),Math.abs(k)<.9999999?(this._x=Math.atan2(-te,_e),this._z=Math.atan2(-L,S)):(this._x=Math.atan2(ue,V),this._z=0);break;case"YXZ":this._x=Math.asin(-Hr(te,-1,1)),Math.abs(te)<.9999999?(this._y=Math.atan2(k,_e),this._z=Math.atan2(F,V)):(this._y=Math.atan2(-le,S),this._z=0);break;case"ZXY":this._x=Math.asin(Hr(ue,-1,1)),Math.abs(ue)<.9999999?(this._y=Math.atan2(-le,_e),this._z=Math.atan2(-L,V)):(this._y=0,this._z=Math.atan2(F,S));break;case"ZYX":this._y=Math.asin(-Hr(le,-1,1)),Math.abs(le)<.9999999?(this._x=Math.atan2(ue,_e),this._z=Math.atan2(F,S)):(this._x=0,this._z=Math.atan2(-L,V));break;case"YZX":this._z=Math.asin(Hr(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(-te,V),this._y=Math.atan2(-le,S)):(this._x=0,this._y=Math.atan2(k,_e));break;case"XZY":this._z=Math.asin(-Hr(L,-1,1)),Math.abs(L)<.9999999?(this._x=Math.atan2(ue,V),this._y=Math.atan2(k,S)):(this._x=Math.atan2(-te,_e),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,!0===d&&this._onChangeCallback(),this}setFromQuaternion(e,c,d){return Rr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Rr,c,d)}setFromVector3(e,c=this._order){return this.set(e.x,e.y,e.z,c)}reorder(e){return ts.setFromEuler(this),this.setFromQuaternion(ts,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new ht(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}lo.prototype.isEuler=!0,lo.DefaultOrder="XYZ",lo.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Js{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}}let Bo=0;const ec=new ht,Yo=new $i,Xi=new tn,Ac=new ht,Yh=new ht,rh=new ht,Ap=new $i,Eh=new ht(1,0,0),cd=new ht(0,1,0),Th=new ht(0,0,1),Rd={type:"added"},ud={type:"removed"};class Pr extends ks{constructor(){super(),Object.defineProperty(this,"id",{value:Bo++}),this.uuid=Zi(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pr.DefaultUp.clone();const e=new ht,c=new lo,d=new $i,_=new ht(1,1,1);c._onChange(function(){d.setFromEuler(c,!1)}),d._onChange(function(){c.setFromQuaternion(d,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:d},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new tn},normalMatrix:{value:new lt}}),this.matrix=new tn,this.matrixWorld=new tn,this.matrixAutoUpdate=Pr.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Js,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,c){this.quaternion.setFromAxisAngle(e,c)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,c){return Yo.setFromAxisAngle(e,c),this.quaternion.multiply(Yo),this}rotateOnWorldAxis(e,c){return Yo.setFromAxisAngle(e,c),this.quaternion.premultiply(Yo),this}rotateX(e){return this.rotateOnAxis(Eh,e)}rotateY(e){return this.rotateOnAxis(cd,e)}rotateZ(e){return this.rotateOnAxis(Th,e)}translateOnAxis(e,c){return ec.copy(e).applyQuaternion(this.quaternion),this.position.add(ec.multiplyScalar(c)),this}translateX(e){return this.translateOnAxis(Eh,e)}translateY(e){return this.translateOnAxis(cd,e)}translateZ(e){return this.translateOnAxis(Th,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Xi.copy(this.matrixWorld).invert())}lookAt(e,c,d){e.isVector3?Ac.copy(e):Ac.set(e,c,d);const _=this.parent;this.updateWorldMatrix(!0,!1),Yh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Xi.lookAt(Yh,Ac,this.up):Xi.lookAt(Ac,Yh,this.up),this.quaternion.setFromRotationMatrix(Xi),_&&(Xi.extractRotation(_.matrixWorld),Yo.setFromRotationMatrix(Xi),this.quaternion.premultiply(Yo.invert()))}add(e){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Rd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.remove(arguments[d]);return this}const c=this.children.indexOf(e);return-1!==c&&(e.parent=null,this.children.splice(c,1),e.dispatchEvent(ud)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const c=this.children[e];c.parent=null,c.dispatchEvent(ud)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Xi.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Xi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Xi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,c){if(this[e]===c)return this;for(let d=0,_=this.children.length;d<_;d++){const S=this.children[d].getObjectByProperty(e,c);if(void 0!==S)return S}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yh,e,rh),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yh,Ap,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(e){e(this);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].traverseVisible(e)}traverseAncestors(e){const c=this.parent;null!==c&&(e(c),c.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const c=this.children;for(let d=0,_=c.length;d<_;d++)c[d].updateMatrixWorld(e)}updateWorldMatrix(e,c){const d=this.parent;if(!0===e&&null!==d&&d.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===c){const _=this.children;for(let S=0,L=_.length;S<L;S++)_[S].updateWorldMatrix(!1,!0)}}toJSON(e){const c=void 0===e||"string"==typeof e,d={};c&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},d.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const _={};function S(k,F){return void 0===k[F.uuid]&&(k[F.uuid]=F.toJSON(e)),F.uuid}if(_.uuid=this.uuid,_.type=this.type,""!==this.name&&(_.name=this.name),!0===this.castShadow&&(_.castShadow=!0),!0===this.receiveShadow&&(_.receiveShadow=!0),!1===this.visible&&(_.visible=!1),!1===this.frustumCulled&&(_.frustumCulled=!1),0!==this.renderOrder&&(_.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(_.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(_.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=S(e.geometries,this.geometry);const k=this.geometry.parameters;if(void 0!==k&&void 0!==k.shapes){const F=k.shapes;if(Array.isArray(F))for(let V=0,te=F.length;V<te;V++)S(e.shapes,F[V]);else S(e.shapes,F)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(S(e.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const k=[];for(let F=0,V=this.material.length;F<V;F++)k.push(S(e.materials,this.material[F]));_.material=k}else _.material=S(e.materials,this.material);if(this.children.length>0){_.children=[];for(let k=0;k<this.children.length;k++)_.children.push(this.children[k].toJSON(e).object)}if(this.animations.length>0){_.animations=[];for(let k=0;k<this.animations.length;k++)_.animations.push(S(e.animations,this.animations[k]))}if(c){const k=L(e.geometries),F=L(e.materials),V=L(e.textures),te=L(e.images),le=L(e.shapes),ue=L(e.skeletons),_e=L(e.animations);k.length>0&&(d.geometries=k),F.length>0&&(d.materials=F),V.length>0&&(d.textures=V),te.length>0&&(d.images=te),le.length>0&&(d.shapes=le),ue.length>0&&(d.skeletons=ue),_e.length>0&&(d.animations=_e)}return d.object=_,d;function L(k){const F=[];for(const V in k){const te=k[V];delete te.metadata,F.push(te)}return F}}clone(e){return(new this.constructor).copy(this,e)}copy(e,c=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===c)for(let d=0;d<e.children.length;d++)this.add(e.children[d].clone());return this}}Pr.DefaultUp=new ht(0,1,0),Pr.DefaultMatrixAutoUpdate=!0,Pr.prototype.isObject3D=!0;const $c=new ht,Zs=new ht,$p=new ht,ar=new ht,Ll=new ht,Mh=new ht,Jh=new ht,ma=new ht,hd=new ht,Ur=new ht;class Ki{constructor(e=new ht,c=new ht,d=new ht){this.a=e,this.b=c,this.c=d}static getNormal(e,c,d,_){_.subVectors(d,c),$c.subVectors(e,c),_.cross($c);const S=_.lengthSq();return S>0?_.multiplyScalar(1/Math.sqrt(S)):_.set(0,0,0)}static getBarycoord(e,c,d,_,S){$c.subVectors(_,c),Zs.subVectors(d,c),$p.subVectors(e,c);const L=$c.dot($c),k=$c.dot(Zs),F=$c.dot($p),V=Zs.dot(Zs),te=Zs.dot($p),le=L*V-k*k;if(0===le)return S.set(-2,-1,-1);const ue=1/le,_e=(V*F-k*te)*ue,Ee=(L*te-k*F)*ue;return S.set(1-_e-Ee,Ee,_e)}static containsPoint(e,c,d,_){return this.getBarycoord(e,c,d,_,ar),ar.x>=0&&ar.y>=0&&ar.x+ar.y<=1}static getUV(e,c,d,_,S,L,k,F){return this.getBarycoord(e,c,d,_,ar),F.set(0,0),F.addScaledVector(S,ar.x),F.addScaledVector(L,ar.y),F.addScaledVector(k,ar.z),F}static isFrontFacing(e,c,d,_){return $c.subVectors(d,c),Zs.subVectors(e,c),$c.cross(Zs).dot(_)<0}set(e,c,d){return this.a.copy(e),this.b.copy(c),this.c.copy(d),this}setFromPointsAndIndices(e,c,d,_){return this.a.copy(e[c]),this.b.copy(e[d]),this.c.copy(e[_]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return $c.subVectors(this.c,this.b),Zs.subVectors(this.a,this.b),.5*$c.cross(Zs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return Ki.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,c){return Ki.getBarycoord(e,this.a,this.b,this.c,c)}getUV(e,c,d,_,S){return Ki.getUV(e,this.a,this.b,this.c,c,d,_,S)}containsPoint(e){return Ki.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ki.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,c){const d=this.a,_=this.b,S=this.c;let L,k;Ll.subVectors(_,d),Mh.subVectors(S,d),ma.subVectors(e,d);const F=Ll.dot(ma),V=Mh.dot(ma);if(F<=0&&V<=0)return c.copy(d);hd.subVectors(e,_);const te=Ll.dot(hd),le=Mh.dot(hd);if(te>=0&&le<=te)return c.copy(_);const ue=F*le-te*V;if(ue<=0&&F>=0&&te<=0)return L=F/(F-te),c.copy(d).addScaledVector(Ll,L);Ur.subVectors(e,S);const _e=Ll.dot(Ur),Ee=Mh.dot(Ur);if(Ee>=0&&_e<=Ee)return c.copy(S);const $e=_e*V-F*Ee;if($e<=0&&V>=0&&Ee<=0)return k=V/(V-Ee),c.copy(d).addScaledVector(Mh,k);const Le=te*Ee-_e*le;if(Le<=0&&le-te>=0&&_e-Ee>=0)return Jh.subVectors(S,_),k=(le-te)/(le-te+(_e-Ee)),c.copy(_).addScaledVector(Jh,k);const Ne=1/(Le+$e+ue);return L=$e*Ne,k=ue*Ne,c.copy(d).addScaledVector(Ll,L).addScaledVector(Mh,k)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let No=0;class $s extends ks{constructor(){super(),Object.defineProperty(this,"id",{value:No++}),this.uuid=Zi(),this.name="",this.type="Material",this.fog=!0,this.blending=he,this.side=ae,this.vertexColors=!1,this.opacity=1,this.format=ao,this.transparent=!1,this.blendSrc=Gt,this.blendDst=Dt,this.blendEquation=Pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=cr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ha,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qe,this.stencilZFail=qe,this.stencilZPass=qe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const c in e){const d=e[c];if(void 0===d){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if("shading"===c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=d===A;continue}const _=this[c];void 0!==_?_&&_.isColor?_.set(d):_&&_.isVector3&&d&&d.isVector3?_.copy(d):this[c]=d:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")}}toJSON(e){const c=void 0===e||"string"==typeof e;c&&(e={textures:{},images:{}});const d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function _(S){const L=[];for(const k in S){const F=S[k];delete F.metadata,L.push(F)}return L}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(d.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(d.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(d.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(e).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(e).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(e).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(e).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(e).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(d.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(d.combine=this.combine)),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(d.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(d.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(d.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(d.size=this.size),null!==this.shadowSide&&(d.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),this.blending!==he&&(d.blending=this.blending),this.side!==ae&&(d.side=this.side),this.vertexColors&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),this.format!==ao&&(d.format=this.format),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.colorWrite=this.colorWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(d.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(d.flatShading=this.flatShading),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),c){const S=_(e.textures),L=_(e.images);S.length>0&&(d.textures=S),L.length>0&&(d.images=L)}return d}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const c=e.clippingPlanes;let d=null;if(null!==c){const _=c.length;d=new Array(_);for(let S=0;S!==_;++S)d[S]=c[S].clone()}return this.clippingPlanes=d,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}$s.prototype.isMaterial=!0;const Vr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dl={h:0,s:0,l:0},Cc={h:0,s:0,l:0};function ih(w,e,c){return c<0&&(c+=1),c>1&&(c-=1),c<.16666666666666666?w+6*(e-w)*c:c<.5?e:c<.6666666666666666?w+6*(e-w)*(.6666666666666666-c):w}function Zh(w){return w<.04045?.0773993808*w:Math.pow(.9478672986*w+.0521327014,2.4)}function Bl(w){return w<.0031308?12.92*w:1.055*Math.pow(w,.41666)-.055}class Kn{constructor(e,c,d){return void 0===c&&void 0===d?this.set(e):this.setRGB(e,c,d)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,c,d){return this.r=e,this.g=c,this.b=d,this}setHSL(e,c,d){if(e=di(e,1),c=Hr(c,0,1),d=Hr(d,0,1),0===c)this.r=this.g=this.b=d;else{const _=d<=.5?d*(1+c):d+c-d*c,S=2*d-_;this.r=ih(S,_,e+.3333333333333333),this.g=ih(S,_,e),this.b=ih(S,_,e-.3333333333333333)}return this}setStyle(e){function c(_){void 0!==_&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let d;if(d=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let _;const L=d[2];switch(d[1]){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,c(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,c(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L)){const k=parseFloat(_[1])/360,F=parseInt(_[2],10)/100,V=parseInt(_[3],10)/100;return c(_[4]),this.setHSL(k,F,V)}}}else if(d=/^\#([A-Fa-f\d]+)$/.exec(e)){const _=d[1],S=_.length;if(3===S)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(6===S)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const c=Vr[e.toLowerCase()];return void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,c=2){return this.r=Math.pow(e.r,c),this.g=Math.pow(e.g,c),this.b=Math.pow(e.b,c),this}copyLinearToGamma(e,c=2){const d=c>0?1/c:1;return this.r=Math.pow(e.r,d),this.g=Math.pow(e.g,d),this.b=Math.pow(e.b,d),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=Zh(e.r),this.g=Zh(e.g),this.b=Zh(e.b),this}copyLinearToSRGB(e){return this.r=Bl(e.r),this.g=Bl(e.g),this.b=Bl(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const c=this.r,d=this.g,_=this.b,S=Math.max(c,d,_),L=Math.min(c,d,_);let k,F;const V=(L+S)/2;if(L===S)k=0,F=0;else{const te=S-L;switch(F=V<=.5?te/(S+L):te/(2-S-L),S){case c:k=(d-_)/te+(d<_?6:0);break;case d:k=(_-c)/te+2;break;case _:k=(c-d)/te+4}k/=6}return e.h=k,e.s=F,e.l=V,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,c,d){return this.getHSL(dl),dl.h+=e,dl.s+=c,dl.l+=d,this.setHSL(dl.h,dl.s,dl.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,c){return this.r=e.r+c.r,this.g=e.g+c.g,this.b=e.b+c.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,c){return this.r+=(e.r-this.r)*c,this.g+=(e.g-this.g)*c,this.b+=(e.b-this.b)*c,this}lerpColors(e,c,d){return this.r=e.r+(c.r-e.r)*d,this.g=e.g+(c.g-e.g)*d,this.b=e.b+(c.b-e.b)*d,this}lerpHSL(e,c){this.getHSL(dl),e.getHSL(Cc);const d=xi(dl.h,Cc.h,c),_=xi(dl.s,Cc.s,c),S=xi(dl.l,Cc.l,c);return this.setHSL(d,_,S),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,c=0){return this.r=e[c],this.g=e[c+1],this.b=e[c+2],this}toArray(e=[],c=0){return e[c]=this.r,e[c+1]=this.g,e[c+2]=this.b,e}fromBufferAttribute(e,c){return this.r=e.getX(c),this.g=e.getY(c),this.b=e.getZ(c),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Kn.NAMES=Vr,Kn.prototype.isColor=!0,Kn.prototype.r=1,Kn.prototype.g=1,Kn.prototype.b=1;class fl extends $s{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Kn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}fl.prototype.isMeshBasicMaterial=!0;const Un=new ht,Nl=new zn;class Pi{constructor(e,c,d){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=c,this.count=void 0!==e?e.length/c:0,this.normalized=!0===d,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,c,d){e*=this.itemSize,d*=c.itemSize;for(let _=0,S=this.itemSize;_<S;_++)this.array[e+_]=c.array[d+_];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",_),L=new Kn),c[d++]=L.r,c[d++]=L.g,c[d++]=L.b}return this}copyVector2sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",_),L=new zn),c[d++]=L.x,c[d++]=L.y}return this}copyVector3sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",_),L=new ht),c[d++]=L.x,c[d++]=L.y,c[d++]=L.z}return this}copyVector4sArray(e){const c=this.array;let d=0;for(let _=0,S=e.length;_<S;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",_),L=new Di),c[d++]=L.x,c[d++]=L.y,c[d++]=L.z,c[d++]=L.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let c=0,d=this.count;c<d;c++)Nl.fromBufferAttribute(this,c),Nl.applyMatrix3(e),this.setXY(c,Nl.x,Nl.y);else if(3===this.itemSize)for(let c=0,d=this.count;c<d;c++)Un.fromBufferAttribute(this,c),Un.applyMatrix3(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}applyMatrix4(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.applyMatrix4(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}applyNormalMatrix(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.applyNormalMatrix(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}transformDirection(e){for(let c=0,d=this.count;c<d;c++)Un.x=this.getX(c),Un.y=this.getY(c),Un.z=this.getZ(c),Un.transformDirection(e),this.setXYZ(c,Un.x,Un.y,Un.z);return this}set(e,c=0){return this.array.set(e,c),this}getX(e){return this.array[e*this.itemSize]}setX(e,c){return this.array[e*this.itemSize]=c,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,c){return this.array[e*this.itemSize+1]=c,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,c){return this.array[e*this.itemSize+2]=c,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,c){return this.array[e*this.itemSize+3]=c,this}setXY(e,c,d){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this}setXYZ(e,c,d,_){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this.array[e+2]=_,this}setXYZW(e,c,d,_,S){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=d,this.array[e+2]=_,this.array[e+3]=S,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==bi&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}Pi.prototype.isBufferAttribute=!0;class Pd extends Pi{constructor(e,c,d){super(new Int8Array(e),c,d)}}class Cp extends Pi{constructor(e,c,d){super(new Uint8Array(e),c,d)}}class Ba extends Pi{constructor(e,c,d){super(new Uint8ClampedArray(e),c,d)}}class oh extends Pi{constructor(e,c,d){super(new Int16Array(e),c,d)}}class sh extends Pi{constructor(e,c,d){super(new Uint16Array(e),c,d)}}class Na extends Pi{constructor(e,c,d){super(new Int32Array(e),c,d)}}class li extends Pi{constructor(e,c,d){super(new Uint32Array(e),c,d)}}class Zr extends Pi{constructor(e,c,d){super(new Uint16Array(e),c,d)}}Zr.prototype.isFloat16BufferAttribute=!0;class hn extends Pi{constructor(e,c,d){super(new Float32Array(e),c,d)}}class Qc extends Pi{constructor(e,c,d){super(new Float64Array(e),c,d)}}function ci(w){if(0===w.length)return-1/0;let e=w[0];for(let c=1,d=w.length;c<d;++c)w[c]>e&&(e=w[c]);return e}const _a={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Za(w,e){return new _a[w](e)}let Rn=0;const wi=new tn,fs=new Pr,ms=new ht,Cs=new Ui,ii=new Ui,Tr=new ht;class br extends ks{constructor(){super(),Object.defineProperty(this,"id",{value:Rn++}),this.uuid=Zi(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ci(e)>65535?li:sh)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,c){return this.attributes[e]=c,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,c,d=0){this.groups.push({start:e,count:c,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(e,c){this.drawRange.start=e,this.drawRange.count=c}applyMatrix4(e){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(e),c.needsUpdate=!0);const d=this.attributes.normal;if(void 0!==d){const S=(new lt).getNormalMatrix(e);d.applyNormalMatrix(S),d.needsUpdate=!0}const _=this.attributes.tangent;return void 0!==_&&(_.transformDirection(e),_.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return wi.makeRotationFromQuaternion(e),this.applyMatrix4(wi),this}rotateX(e){return wi.makeRotationX(e),this.applyMatrix4(wi),this}rotateY(e){return wi.makeRotationY(e),this.applyMatrix4(wi),this}rotateZ(e){return wi.makeRotationZ(e),this.applyMatrix4(wi),this}translate(e,c,d){return wi.makeTranslation(e,c,d),this.applyMatrix4(wi),this}scale(e,c,d){return wi.makeScale(e,c,d),this.applyMatrix4(wi),this}lookAt(e){return fs.lookAt(e),fs.updateMatrix(),this.applyMatrix4(fs.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ms).negate(),this.translate(ms.x,ms.y,ms.z),this}setFromPoints(e){const c=[];for(let d=0,_=e.length;d<_;d++){const S=e[d];c.push(S.x,S.y,S.z||0)}return this.setAttribute("position",new hn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ui);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ht(-1/0,-1/0,-1/0),new ht(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),c)for(let d=0,_=c.length;d<_;d++)Cs.setFromBufferAttribute(c[d]),this.morphTargetsRelative?(Tr.addVectors(this.boundingBox.min,Cs.min),this.boundingBox.expandByPoint(Tr),Tr.addVectors(this.boundingBox.max,Cs.max),this.boundingBox.expandByPoint(Tr)):(this.boundingBox.expandByPoint(Cs.min),this.boundingBox.expandByPoint(Cs.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new bo);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ht,1/0);if(e){const d=this.boundingSphere.center;if(Cs.setFromBufferAttribute(e),c)for(let S=0,L=c.length;S<L;S++)ii.setFromBufferAttribute(c[S]),this.morphTargetsRelative?(Tr.addVectors(Cs.min,ii.min),Cs.expandByPoint(Tr),Tr.addVectors(Cs.max,ii.max),Cs.expandByPoint(Tr)):(Cs.expandByPoint(ii.min),Cs.expandByPoint(ii.max));Cs.getCenter(d);let _=0;for(let S=0,L=e.count;S<L;S++)Tr.fromBufferAttribute(e,S),_=Math.max(_,d.distanceToSquared(Tr));if(c)for(let S=0,L=c.length;S<L;S++){const k=c[S],F=this.morphTargetsRelative;for(let V=0,te=k.count;V<te;V++)Tr.fromBufferAttribute(k,V),F&&(ms.fromBufferAttribute(e,V),Tr.add(ms)),_=Math.max(_,d.distanceToSquared(Tr))}this.boundingSphere.radius=Math.sqrt(_),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,c=this.attributes;if(null===e||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const d=e.array,_=c.position.array,S=c.normal.array,L=c.uv.array,k=_.length/3;void 0===c.tangent&&this.setAttribute("tangent",new Pi(new Float32Array(4*k),4));const F=c.tangent.array,V=[],te=[];for(let nt=0;nt<k;nt++)V[nt]=new ht,te[nt]=new ht;const le=new ht,ue=new ht,_e=new ht,Ee=new zn,$e=new zn,Le=new zn,Ne=new ht,We=new ht;function tt(nt,Tt,Yt){le.fromArray(_,3*nt),ue.fromArray(_,3*Tt),_e.fromArray(_,3*Yt),Ee.fromArray(L,2*nt),$e.fromArray(L,2*Tt),Le.fromArray(L,2*Yt),ue.sub(le),_e.sub(le),$e.sub(Ee),Le.sub(Ee);const ct=1/($e.x*Le.y-Le.x*$e.y);isFinite(ct)&&(Ne.copy(ue).multiplyScalar(Le.y).addScaledVector(_e,-$e.y).multiplyScalar(ct),We.copy(_e).multiplyScalar($e.x).addScaledVector(ue,-Le.x).multiplyScalar(ct),V[nt].add(Ne),V[Tt].add(Ne),V[Yt].add(Ne),te[nt].add(We),te[Tt].add(We),te[Yt].add(We))}let Ze=this.groups;0===Ze.length&&(Ze=[{start:0,count:d.length}]);for(let nt=0,Tt=Ze.length;nt<Tt;++nt){const Yt=Ze[nt],ct=Yt.start;for(let Lt=ct,_t=ct+Yt.count;Lt<_t;Lt+=3)tt(d[Lt+0],d[Lt+1],d[Lt+2])}const ot=new ht,st=new ht,Ct=new ht,Ft=new ht;function Qe(nt){Ct.fromArray(S,3*nt),Ft.copy(Ct);const Tt=V[nt];ot.copy(Tt),ot.sub(Ct.multiplyScalar(Ct.dot(Tt))).normalize(),st.crossVectors(Ft,Tt);const Yt=st.dot(te[nt])<0?-1:1;F[4*nt]=ot.x,F[4*nt+1]=ot.y,F[4*nt+2]=ot.z,F[4*nt+3]=Yt}for(let nt=0,Tt=Ze.length;nt<Tt;++nt){const Yt=Ze[nt],ct=Yt.start;for(let Lt=ct,_t=ct+Yt.count;Lt<_t;Lt+=3)Qe(d[Lt+0]),Qe(d[Lt+1]),Qe(d[Lt+2])}}computeVertexNormals(){const e=this.index,c=this.getAttribute("position");if(void 0!==c){let d=this.getAttribute("normal");if(void 0===d)d=new Pi(new Float32Array(3*c.count),3),this.setAttribute("normal",d);else for(let ue=0,_e=d.count;ue<_e;ue++)d.setXYZ(ue,0,0,0);const _=new ht,S=new ht,L=new ht,k=new ht,F=new ht,V=new ht,te=new ht,le=new ht;if(e)for(let ue=0,_e=e.count;ue<_e;ue+=3){const Ee=e.getX(ue+0),$e=e.getX(ue+1),Le=e.getX(ue+2);_.fromBufferAttribute(c,Ee),S.fromBufferAttribute(c,$e),L.fromBufferAttribute(c,Le),te.subVectors(L,S),le.subVectors(_,S),te.cross(le),k.fromBufferAttribute(d,Ee),F.fromBufferAttribute(d,$e),V.fromBufferAttribute(d,Le),k.add(te),F.add(te),V.add(te),d.setXYZ(Ee,k.x,k.y,k.z),d.setXYZ($e,F.x,F.y,F.z),d.setXYZ(Le,V.x,V.y,V.z)}else for(let ue=0,_e=c.count;ue<_e;ue+=3)_.fromBufferAttribute(c,ue+0),S.fromBufferAttribute(c,ue+1),L.fromBufferAttribute(c,ue+2),te.subVectors(L,S),le.subVectors(_,S),te.cross(le),d.setXYZ(ue+0,te.x,te.y,te.z),d.setXYZ(ue+1,te.x,te.y,te.z),d.setXYZ(ue+2,te.x,te.y,te.z);this.normalizeNormals(),d.needsUpdate=!0}}merge(e,c){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===c&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const d=this.attributes;for(const _ in d){if(void 0===e.attributes[_])continue;const S=d[_].array,L=e.attributes[_],k=L.array,F=L.itemSize*c,V=Math.min(k.length,S.length-F);for(let te=0,le=F;te<V;te++,le++)S[le]=k[te]}return this}normalizeNormals(){const e=this.attributes.normal;for(let c=0,d=e.count;c<d;c++)Tr.fromBufferAttribute(e,c),Tr.normalize(),e.setXYZ(c,Tr.x,Tr.y,Tr.z)}toNonIndexed(){function e(k,F){const V=k.array,te=k.itemSize,le=k.normalized,ue=new V.constructor(F.length*te);let _e=0,Ee=0;for(let $e=0,Le=F.length;$e<Le;$e++){_e=k.isInterleavedBufferAttribute?F[$e]*k.data.stride+k.offset:F[$e]*te;for(let Ne=0;Ne<te;Ne++)ue[Ee++]=V[_e++]}return new Pi(ue,te,le)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new br,d=this.index.array,_=this.attributes;for(const k in _){const F=e(_[k],d);c.setAttribute(k,F)}const S=this.morphAttributes;for(const k in S){const F=[],V=S[k];for(let te=0,le=V.length;te<le;te++){const ue=e(V[te],d);F.push(ue)}c.morphAttributes[k]=F}c.morphTargetsRelative=this.morphTargetsRelative;const L=this.groups;for(let k=0,F=L.length;k<F;k++){const V=L[k];c.addGroup(V.start,V.count,V.materialIndex)}return c}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const F=this.parameters;for(const V in F)void 0!==F[V]&&(e[V]=F[V]);return e}e.data={attributes:{}};const c=this.index;null!==c&&(e.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const d=this.attributes;for(const F in d)e.data.attributes[F]=d[F].toJSON(e.data);const _={};let S=!1;for(const F in this.morphAttributes){const V=this.morphAttributes[F],te=[];for(let le=0,ue=V.length;le<ue;le++)te.push(V[le].toJSON(e.data));te.length>0&&(_[F]=te,S=!0)}S&&(e.data.morphAttributes=_,e.data.morphTargetsRelative=this.morphTargetsRelative);const L=this.groups;L.length>0&&(e.data.groups=JSON.parse(JSON.stringify(L)));const k=this.boundingSphere;return null!==k&&(e.data.boundingSphere={center:k.center.toArray(),radius:k.radius}),e}clone(){return(new br).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=e.name;const d=e.index;null!==d&&this.setIndex(d.clone(c));const _=e.attributes;for(const V in _)this.setAttribute(V,_[V].clone(c));const S=e.morphAttributes;for(const V in S){const te=[],le=S[V];for(let ue=0,_e=le.length;ue<_e;ue++)te.push(le[ue].clone(c));this.morphAttributes[V]=te}this.morphTargetsRelative=e.morphTargetsRelative;const L=e.groups;for(let V=0,te=L.length;V<te;V++){const le=L[V];this.addGroup(le.start,le.count,le.materialIndex)}const k=e.boundingBox;null!==k&&(this.boundingBox=k.clone());const F=e.boundingSphere;return null!==F&&(this.boundingSphere=F.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}br.prototype.isBufferGeometry=!0;const ml=new tn,Lc=new fn,ah=new bo,Qa=new ht,ns=new ht,Ci=new ht,Qh=new ht,Ah=new ht,Kh=new ht,mr=new ht,Jo=new ht,_l=new ht,kr=new zn,Ls=new zn,lh=new zn,Kc=new ht,Bs=new ht;class Ro extends Pr{constructor(e=new br,c=new fl){super(),this.type="Mesh",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,L=_.length;S<L;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,c){const d=this.geometry,_=this.material,S=this.matrixWorld;if(void 0===_||(null===d.boundingSphere&&d.computeBoundingSphere(),ah.copy(d.boundingSphere),ah.applyMatrix4(S),!1===e.ray.intersectsSphere(ah))||(ml.copy(S).invert(),Lc.copy(e.ray).applyMatrix4(ml),null!==d.boundingBox&&!1===Lc.intersectsBox(d.boundingBox)))return;let L;if(d.isBufferGeometry){const k=d.index,F=d.attributes.position,V=d.morphAttributes.position,te=d.morphTargetsRelative,le=d.attributes.uv,ue=d.attributes.uv2,_e=d.groups,Ee=d.drawRange;if(null!==k)if(Array.isArray(_))for(let $e=0,Le=_e.length;$e<Le;$e++){const Ne=_e[$e],We=_[Ne.materialIndex];for(let tt=Math.max(Ne.start,Ee.start),Ze=Math.min(Ne.start+Ne.count,Ee.start+Ee.count);tt<Ze;tt+=3){const ot=k.getX(tt),st=k.getX(tt+1),Ct=k.getX(tt+2);L=ep(this,We,e,Lc,F,V,te,le,ue,ot,st,Ct),L&&(L.faceIndex=Math.floor(tt/3),L.face.materialIndex=Ne.materialIndex,c.push(L))}}else for(let $e=Math.max(0,Ee.start),Le=Math.min(k.count,Ee.start+Ee.count);$e<Le;$e+=3){const Ne=k.getX($e),We=k.getX($e+1),tt=k.getX($e+2);L=ep(this,_,e,Lc,F,V,te,le,ue,Ne,We,tt),L&&(L.faceIndex=Math.floor($e/3),c.push(L))}else if(void 0!==F)if(Array.isArray(_))for(let $e=0,Le=_e.length;$e<Le;$e++){const Ne=_e[$e],We=_[Ne.materialIndex];for(let tt=Math.max(Ne.start,Ee.start),Ze=Math.min(Ne.start+Ne.count,Ee.start+Ee.count);tt<Ze;tt+=3)L=ep(this,We,e,Lc,F,V,te,le,ue,tt,tt+1,tt+2),L&&(L.faceIndex=Math.floor(tt/3),L.face.materialIndex=Ne.materialIndex,c.push(L))}else for(let $e=Math.max(0,Ee.start),Le=Math.min(F.count,Ee.start+Ee.count);$e<Le;$e+=3)L=ep(this,_,e,Lc,F,V,te,le,ue,$e,$e+1,$e+2),L&&(L.faceIndex=Math.floor($e/3),c.push(L))}else d.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function ep(w,e,c,d,_,S,L,k,F,V,te,le){Qa.fromBufferAttribute(_,V),ns.fromBufferAttribute(_,te),Ci.fromBufferAttribute(_,le);const ue=w.morphTargetInfluences;if(S&&ue){mr.set(0,0,0),Jo.set(0,0,0),_l.set(0,0,0);for(let Ee=0,$e=S.length;Ee<$e;Ee++){const Le=ue[Ee],Ne=S[Ee];0!==Le&&(Qh.fromBufferAttribute(Ne,V),Ah.fromBufferAttribute(Ne,te),Kh.fromBufferAttribute(Ne,le),L?(mr.addScaledVector(Qh,Le),Jo.addScaledVector(Ah,Le),_l.addScaledVector(Kh,Le)):(mr.addScaledVector(Qh.sub(Qa),Le),Jo.addScaledVector(Ah.sub(ns),Le),_l.addScaledVector(Kh.sub(Ci),Le)))}Qa.add(mr),ns.add(Jo),Ci.add(_l)}w.isSkinnedMesh&&(w.boneTransform(V,Qa),w.boneTransform(te,ns),w.boneTransform(le,Ci));const _e=function(Ee,$e,Le,Ne,We,tt,Ze,ot){let st;if(st=$e.side===W?Ne.intersectTriangle(Ze,tt,We,!0,ot):Ne.intersectTriangle(We,tt,Ze,$e.side!==Z,ot),null===st)return null;Bs.copy(ot),Bs.applyMatrix4(Ee.matrixWorld);const Ct=Le.ray.origin.distanceTo(Bs);return Ct<Le.near||Ct>Le.far?null:{distance:Ct,point:Bs.clone(),object:Ee}}(w,e,c,d,Qa,ns,Ci,Kc);if(_e){k&&(kr.fromBufferAttribute(k,V),Ls.fromBufferAttribute(k,te),lh.fromBufferAttribute(k,le),_e.uv=Ki.getUV(Kc,Qa,ns,Ci,kr,Ls,lh,new zn)),F&&(kr.fromBufferAttribute(F,V),Ls.fromBufferAttribute(F,te),lh.fromBufferAttribute(F,le),_e.uv2=Ki.getUV(Kc,Qa,ns,Ci,kr,Ls,lh,new zn));const Ee={a:V,b:te,c:le,normal:new ht,materialIndex:0};Ki.getNormal(Qa,ns,Ci,Ee.normal),_e.face=Ee}return _e}Ro.prototype.isMesh=!0;class tc extends br{constructor(e=1,c=1,d=1,_=1,S=1,L=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:c,depth:d,widthSegments:_,heightSegments:S,depthSegments:L};const k=this;_=Math.floor(_),S=Math.floor(S),L=Math.floor(L);const F=[],V=[],te=[],le=[];let ue=0,_e=0;function Ee($e,Le,Ne,We,tt,Ze,ot,st,Ct,Ft,Qe){const nt=Ze/Ct,Tt=ot/Ft,Yt=Ze/2,ct=ot/2,Lt=st/2,_t=Ct+1,zt=Ft+1;let Rt=0,nn=0;const en=new ht;for(let Mn=0;Mn<zt;Mn++){const rt=Mn*Tt-ct;for(let ut=0;ut<_t;ut++)en[$e]=(ut*nt-Yt)*We,en[Le]=rt*tt,en[Ne]=Lt,V.push(en.x,en.y,en.z),en[$e]=0,en[Le]=0,en[Ne]=st>0?1:-1,te.push(en.x,en.y,en.z),le.push(ut/Ct),le.push(1-Mn/Ft),Rt+=1}for(let Mn=0;Mn<Ft;Mn++)for(let rt=0;rt<Ct;rt++){const rn=ue+rt+_t*(Mn+1),un=ue+(rt+1)+_t*(Mn+1),gn=ue+(rt+1)+_t*Mn;F.push(ue+rt+_t*Mn,rn,gn),F.push(rn,un,gn),nn+=6}k.addGroup(_e,nn,Qe),_e+=nn,ue+=Rt}Ee("z","y","x",-1,-1,d,c,e,L,S,0),Ee("z","y","x",1,-1,d,c,-e,L,S,1),Ee("x","z","y",1,1,e,d,c,_,L,2),Ee("x","z","y",1,-1,e,d,-c,_,L,3),Ee("x","y","z",1,-1,e,c,d,_,S,4),Ee("x","y","z",-1,-1,e,c,-d,_,S,5),this.setIndex(F),this.setAttribute("position",new hn(V,3)),this.setAttribute("normal",new hn(te,3)),this.setAttribute("uv",new hn(le,2))}static fromJSON(e){return new tc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function co(w){const e={};for(const c in w){e[c]={};for(const d in w[c]){const _=w[c][d];e[c][d]=_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture||_.isQuaternion)?_.clone():Array.isArray(_)?_.slice():_}}return e}function Ai(w){const e={};for(let c=0;c<w.length;c++){const d=co(w[c]);for(const _ in d)e[_]=d[_]}return e}const Ns={clone:co,merge:Ai};class Rs extends $s{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=co(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const c=super.toJSON(e);c.glslVersion=this.glslVersion,c.uniforms={};for(const _ in this.uniforms){const S=this.uniforms[_].value;c.uniforms[_]=S&&S.isTexture?{type:"t",value:S.toJSON(e).uuid}:S&&S.isColor?{type:"c",value:S.getHex()}:S&&S.isVector2?{type:"v2",value:S.toArray()}:S&&S.isVector3?{type:"v3",value:S.toArray()}:S&&S.isVector4?{type:"v4",value:S.toArray()}:S&&S.isMatrix3?{type:"m3",value:S.toArray()}:S&&S.isMatrix4?{type:"m4",value:S.toArray()}:{value:S}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const d={};for(const _ in this.extensions)!0===this.extensions[_]&&(d[_]=!0);return Object.keys(d).length>0&&(c.extensions=d),c}}Rs.prototype.isShaderMaterial=!0;class Rl extends Pr{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new tn,this.projectionMatrix=new tn,this.projectionMatrixInverse=new tn}copy(e,c){return super.copy(e,c),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,c){super.updateWorldMatrix(e,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Rl.prototype.isCamera=!0;class Po extends Rl{constructor(e=50,c=1,d=.1,_=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=d,this.far=_,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const c=.5*this.getFilmHeight()/e;this.fov=2*ss*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Ho*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*ss*Math.atan(Math.tan(.5*Ho*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,c,d,_,S,L){this.aspect=e/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=_,this.view.width=S,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let c=e*Math.tan(.5*Ho*this.fov)/this.zoom,d=2*c,_=this.aspect*d,S=-.5*_;const L=this.view;if(null!==this.view&&this.view.enabled){const F=L.fullWidth,V=L.fullHeight;S+=L.offsetX*_/F,c-=L.offsetY*d/V,_*=L.width/F,d*=L.height/V}const k=this.filmOffset;0!==k&&(S+=e*k/this.getFilmWidth()),this.projectionMatrix.makePerspective(S,S+_,c,c-d,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}Po.prototype.isPerspectiveCamera=!0;class gl extends Pr{constructor(e,c,d){if(super(),this.type="CubeCamera",!0!==d.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=d;const _=new Po(90,1,e,c);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new ht(1,0,0)),this.add(_);const S=new Po(90,1,e,c);S.layers=this.layers,S.up.set(0,-1,0),S.lookAt(new ht(-1,0,0)),this.add(S);const L=new Po(90,1,e,c);L.layers=this.layers,L.up.set(0,0,1),L.lookAt(new ht(0,1,0)),this.add(L);const k=new Po(90,1,e,c);k.layers=this.layers,k.up.set(0,0,-1),k.lookAt(new ht(0,-1,0)),this.add(k);const F=new Po(90,1,e,c);F.layers=this.layers,F.up.set(0,-1,0),F.lookAt(new ht(0,0,1)),this.add(F);const V=new Po(90,1,e,c);V.layers=this.layers,V.up.set(0,-1,0),V.lookAt(new ht(0,0,-1)),this.add(V)}update(e,c){null===this.parent&&this.updateMatrixWorld();const d=this.renderTarget,[_,S,L,k,F,V]=this.children,te=e.xr.enabled,le=e.getRenderTarget();e.xr.enabled=!1;const ue=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,e.setRenderTarget(d,0),e.render(c,_),e.setRenderTarget(d,1),e.render(c,S),e.setRenderTarget(d,2),e.render(c,L),e.setRenderTarget(d,3),e.render(c,k),e.setRenderTarget(d,4),e.render(c,F),d.texture.generateMipmaps=ue,e.setRenderTarget(d,5),e.render(c,V),e.setRenderTarget(le),e.xr.enabled=te}}class nc extends As{constructor(e,c,d,_,S,L,k,F,V,te){super(e=void 0!==e?e:[],c=void 0!==c?c:Ei,d,_,S,L,k=void 0!==k?k:Os,F,V,te),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}nc.prototype.isCubeTexture=!0;class Bc extends ro{constructor(e,c,d){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=d),super(e,e,c),this.texture=new nc(void 0,(c=c||{}).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:ai,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,c){this.texture.type=c.type,this.texture.format=ao,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const L=new tc(5,5,5),k=new Rs({name:"CubemapFromEquirect",uniforms:co({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:W,blending:X});k.uniforms.tEquirect.value=c;const F=new Ro(L,k),V=c.minFilter;return c.minFilter===sl&&(c.minFilter=ai),new gl(1,10,this).update(e,F),c.minFilter=V,F.geometry.dispose(),F.material.dispose(),this}clear(e,c,d,_){const S=e.getRenderTarget();for(let L=0;L<6;L++)e.setRenderTarget(this,L),e.clear(c,d,_);e.setRenderTarget(S)}}Bc.prototype.isWebGLCubeRenderTarget=!0;const eu=new ht,hr=new ht,Lp=new lt;class Ra{constructor(e=new ht(1,0,0),c=0){this.normal=e,this.constant=c}set(e,c){return this.normal.copy(e),this.constant=c,this}setComponents(e,c,d,_){return this.normal.set(e,c,d),this.constant=_,this}setFromNormalAndCoplanarPoint(e,c){return this.normal.copy(e),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(e,c,d){const _=eu.subVectors(d,c).cross(hr.subVectors(e,c)).normalize();return this.setFromNormalAndCoplanarPoint(_,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,c){const d=e.delta(eu),_=this.normal.dot(d);if(0===_)return 0===this.distanceToPoint(e.start)?c.copy(e.start):null;const S=-(e.start.dot(this.normal)+this.constant)/_;return S<0||S>1?null:c.copy(d).multiplyScalar(S).add(e.start)}intersectsLine(e){const c=this.distanceToPoint(e.start),d=this.distanceToPoint(e.end);return c<0&&d>0||d<0&&c>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,c){const d=c||Lp.getNormalMatrix(e),_=this.coplanarPoint(eu).applyMatrix4(e),S=this.normal.applyMatrix3(d).normalize();return this.constant=-_.dot(S),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Ra.prototype.isPlane=!0;const Ka=new bo,Il=new ht;class Fr{constructor(e=new Ra,c=new Ra,d=new Ra,_=new Ra,S=new Ra,L=new Ra){this.planes=[e,c,d,_,S,L]}set(e,c,d,_,S,L){const k=this.planes;return k[0].copy(e),k[1].copy(c),k[2].copy(d),k[3].copy(_),k[4].copy(S),k[5].copy(L),this}copy(e){const c=this.planes;for(let d=0;d<6;d++)c[d].copy(e.planes[d]);return this}setFromProjectionMatrix(e){const c=this.planes,d=e.elements,_=d[0],S=d[1],L=d[2],k=d[3],F=d[4],V=d[5],te=d[6],le=d[7],ue=d[8],_e=d[9],Ee=d[10],$e=d[11],Le=d[12],Ne=d[13],We=d[14],tt=d[15];return c[0].setComponents(k-_,le-F,$e-ue,tt-Le).normalize(),c[1].setComponents(k+_,le+F,$e+ue,tt+Le).normalize(),c[2].setComponents(k+S,le+V,$e+_e,tt+Ne).normalize(),c[3].setComponents(k-S,le-V,$e-_e,tt-Ne).normalize(),c[4].setComponents(k-L,le-te,$e-Ee,tt-We).normalize(),c[5].setComponents(k+L,le+te,$e+Ee,tt+We).normalize(),this}intersectsObject(e){const c=e.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),Ka.copy(c.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ka)}intersectsSprite(e){return Ka.center.set(0,0,0),Ka.radius=.7071067811865476,Ka.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ka)}intersectsSphere(e){const c=this.planes,d=e.center,_=-e.radius;for(let S=0;S<6;S++)if(c[S].distanceToPoint(d)<_)return!1;return!0}intersectsBox(e){const c=this.planes;for(let d=0;d<6;d++){const _=c[d];if(Il.x=_.normal.x>0?e.max.x:e.min.x,Il.y=_.normal.y>0?e.max.y:e.min.y,Il.z=_.normal.z>0?e.max.z:e.min.z,_.distanceToPoint(Il)<0)return!1}return!0}containsPoint(e){const c=this.planes;for(let d=0;d<6;d++)if(c[d].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Nc(){let w=null,e=!1,c=null,d=null;function _(S,L){c(S,L),d=w.requestAnimationFrame(_)}return{start:function(){!0!==e&&null!==c&&(d=w.requestAnimationFrame(_),e=!0)},stop:function(){w.cancelAnimationFrame(d),e=!1},setAnimationLoop:function(S){c=S},setContext:function(S){w=S}}}function qp(w,e){const c=e.isWebGL2,d=new WeakMap;return{get:function(_){return _.isInterleavedBufferAttribute&&(_=_.data),d.get(_)},remove:function(_){_.isInterleavedBufferAttribute&&(_=_.data);const S=d.get(_);S&&(w.deleteBuffer(S.buffer),d.delete(_))},update:function(_,S){if(_.isGLBufferAttribute){const k=d.get(_);return void((!k||k.version<_.version)&&d.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version}))}_.isInterleavedBufferAttribute&&(_=_.data);const L=d.get(_);void 0===L?d.set(_,function(k,F){const V=k.array,te=k.usage,le=w.createBuffer();w.bindBuffer(F,le),w.bufferData(F,V,te),k.onUploadCallback();let ue=5126;return V instanceof Float32Array?ue=5126:V instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):V instanceof Uint16Array?k.isFloat16BufferAttribute?c?ue=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ue=5123:V instanceof Int16Array?ue=5122:V instanceof Uint32Array?ue=5125:V instanceof Int32Array?ue=5124:V instanceof Int8Array?ue=5120:(V instanceof Uint8Array||V instanceof Uint8ClampedArray)&&(ue=5121),{buffer:le,type:ue,bytesPerElement:V.BYTES_PER_ELEMENT,version:k.version}}(_,S)):L.version<_.version&&(function(k,F,V){const te=F.array,le=F.updateRange;w.bindBuffer(V,k),-1===le.count?w.bufferSubData(V,0,te):(c?w.bufferSubData(V,le.offset*te.BYTES_PER_ELEMENT,te,le.offset,le.count):w.bufferSubData(V,le.offset*te.BYTES_PER_ELEMENT,te.subarray(le.offset,le.offset+le.count)),le.count=-1)}(L.buffer,_,S),L.version=_.version)}}}class Eu extends br{constructor(e=1,c=1,d=1,_=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:c,widthSegments:d,heightSegments:_};const S=e/2,L=c/2,k=Math.floor(d),F=Math.floor(_),V=k+1,te=F+1,le=e/k,ue=c/F,_e=[],Ee=[],$e=[],Le=[];for(let Ne=0;Ne<te;Ne++){const We=Ne*ue-L;for(let tt=0;tt<V;tt++)Ee.push(tt*le-S,-We,0),$e.push(0,0,1),Le.push(tt/k),Le.push(1-Ne/F)}for(let Ne=0;Ne<F;Ne++)for(let We=0;We<k;We++){const Ze=We+V*(Ne+1),ot=We+1+V*(Ne+1),st=We+1+V*Ne;_e.push(We+V*Ne,Ze,st),_e.push(Ze,ot,st)}this.setIndex(_e),this.setAttribute("position",new hn(Ee,3)),this.setAttribute("normal",new hn($e,3)),this.setAttribute("uv",new hn(Le,2))}static fromJSON(e){return new Eu(e.width,e.height,e.widthSegments,e.heightSegments)}}const ui={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotVH = saturate( dot( geometry.viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float NoH ) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float NoV, float NoL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );\n}\nvec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in GeometricContext geometry ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = transmission.a;\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},sr={common:{diffuse:{value:new Kn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new lt},uv2Transform:{value:new lt},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new zn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Kn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Kn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lt}},sprite:{diffuse:{value:new Kn(16777215)},opacity:{value:1},center:{value:new zn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new lt}}},Ol={basic:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.fog]),vertexShader:ui.meshbasic_vert,fragmentShader:ui.meshbasic_frag},lambert:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.fog,sr.lights,{emissive:{value:new Kn(0)}}]),vertexShader:ui.meshlambert_vert,fragmentShader:ui.meshlambert_frag},phong:{uniforms:Ai([sr.common,sr.specularmap,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,sr.lights,{emissive:{value:new Kn(0)},specular:{value:new Kn(1118481)},shininess:{value:30}}]),vertexShader:ui.meshphong_vert,fragmentShader:ui.meshphong_frag},standard:{uniforms:Ai([sr.common,sr.envmap,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.roughnessmap,sr.metalnessmap,sr.fog,sr.lights,{emissive:{value:new Kn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag},toon:{uniforms:Ai([sr.common,sr.aomap,sr.lightmap,sr.emissivemap,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.gradientmap,sr.fog,sr.lights,{emissive:{value:new Kn(0)}}]),vertexShader:ui.meshtoon_vert,fragmentShader:ui.meshtoon_frag},matcap:{uniforms:Ai([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,sr.fog,{matcap:{value:null}}]),vertexShader:ui.meshmatcap_vert,fragmentShader:ui.meshmatcap_frag},points:{uniforms:Ai([sr.points,sr.fog]),vertexShader:ui.points_vert,fragmentShader:ui.points_frag},dashed:{uniforms:Ai([sr.common,sr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ui.linedashed_vert,fragmentShader:ui.linedashed_frag},depth:{uniforms:Ai([sr.common,sr.displacementmap]),vertexShader:ui.depth_vert,fragmentShader:ui.depth_frag},normal:{uniforms:Ai([sr.common,sr.bumpmap,sr.normalmap,sr.displacementmap,{opacity:{value:1}}]),vertexShader:ui.meshnormal_vert,fragmentShader:ui.meshnormal_frag},sprite:{uniforms:Ai([sr.sprite,sr.fog]),vertexShader:ui.sprite_vert,fragmentShader:ui.sprite_frag},background:{uniforms:{uvTransform:{value:new lt},t2D:{value:null}},vertexShader:ui.background_vert,fragmentShader:ui.background_frag},cube:{uniforms:Ai([sr.envmap,{opacity:{value:1}}]),vertexShader:ui.cube_vert,fragmentShader:ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ui.equirect_vert,fragmentShader:ui.equirect_frag},distanceRGBA:{uniforms:Ai([sr.common,sr.displacementmap,{referencePosition:{value:new ht},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ui.distanceRGBA_vert,fragmentShader:ui.distanceRGBA_frag},shadow:{uniforms:Ai([sr.lights,sr.fog,{color:{value:new Kn(0)},opacity:{value:1}}]),vertexShader:ui.shadow_vert,fragmentShader:ui.shadow_frag}};function tu(w,e,c,d,_){const S=new Kn(0);let L,k,F=0,V=null,te=0,le=null;function ue(_e,Ee){c.buffers.color.setClear(_e.r,_e.g,_e.b,Ee,_)}return{getClearColor:function(){return S},setClearColor:function(_e,Ee=1){S.set(_e),F=Ee,ue(S,F)},getClearAlpha:function(){return F},setClearAlpha:function(_e){F=_e,ue(S,F)},render:function(_e,Ee){let $e=!1,Le=!0===Ee.isScene?Ee.background:null;Le&&Le.isTexture&&(Le=e.get(Le));const Ne=w.xr,We=Ne.getSession&&Ne.getSession();We&&"additive"===We.environmentBlendMode&&(Le=null),null===Le?ue(S,F):Le&&Le.isColor&&(ue(Le,1),$e=!0),(w.autoClear||$e)&&w.clear(w.autoClearColor,w.autoClearDepth,w.autoClearStencil),Le&&(Le.isCubeTexture||Le.mapping===Ni)?(void 0===k&&(k=new Ro(new tc(1,1,1),new Rs({name:"BackgroundCubeMaterial",uniforms:co(Ol.cube.uniforms),vertexShader:Ol.cube.vertexShader,fragmentShader:Ol.cube.fragmentShader,side:W,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.deleteAttribute("normal"),k.geometry.deleteAttribute("uv"),k.onBeforeRender=function(tt,Ze,ot){this.matrixWorld.copyPosition(ot.matrixWorld)},Object.defineProperty(k.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(k)),k.material.uniforms.envMap.value=Le,k.material.uniforms.flipEnvMap.value=Le.isCubeTexture&&!1===Le.isRenderTargetTexture?-1:1,V===Le&&te===Le.version&&le===w.toneMapping||(k.material.needsUpdate=!0,V=Le,te=Le.version,le=w.toneMapping),_e.unshift(k,k.geometry,k.material,0,0,null)):Le&&Le.isTexture&&(void 0===L&&(L=new Ro(new Eu(2,2),new Rs({name:"BackgroundMaterial",uniforms:co(Ol.background.uniforms),vertexShader:Ol.background.vertexShader,fragmentShader:Ol.background.fragmentShader,side:ae,depthTest:!1,depthWrite:!1,fog:!1})),L.geometry.deleteAttribute("normal"),Object.defineProperty(L.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(L)),L.material.uniforms.t2D.value=Le,!0===Le.matrixAutoUpdate&&Le.updateMatrix(),L.material.uniforms.uvTransform.value.copy(Le.matrix),V===Le&&te===Le.version&&le===w.toneMapping||(L.material.needsUpdate=!0,V=Le,te=Le.version,le=w.toneMapping),_e.unshift(L,L.geometry,L.material,0,0,null))}}}function Mo(w,e,c,d){const _=w.getParameter(34921),S=d.isWebGL2?null:e.get("OES_vertex_array_object"),L=d.isWebGL2||null!==S,k={},F=ue(null);let V=F;function te(Ze){return d.isWebGL2?w.bindVertexArray(Ze):S.bindVertexArrayOES(Ze)}function le(Ze){return d.isWebGL2?w.deleteVertexArray(Ze):S.deleteVertexArrayOES(Ze)}function ue(Ze){const ot=[],st=[],Ct=[];for(let Ft=0;Ft<_;Ft++)ot[Ft]=0,st[Ft]=0,Ct[Ft]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ot,enabledAttributes:st,attributeDivisors:Ct,object:Ze,attributes:{},index:null}}function _e(){const Ze=V.newAttributes;for(let ot=0,st=Ze.length;ot<st;ot++)Ze[ot]=0}function Ee(Ze){$e(Ze,0)}function $e(Ze,ot){const Ct=V.enabledAttributes,Ft=V.attributeDivisors;V.newAttributes[Ze]=1,0===Ct[Ze]&&(w.enableVertexAttribArray(Ze),Ct[Ze]=1),Ft[Ze]!==ot&&((d.isWebGL2?w:e.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ze,ot),Ft[Ze]=ot)}function Le(){const Ze=V.newAttributes,ot=V.enabledAttributes;for(let st=0,Ct=ot.length;st<Ct;st++)ot[st]!==Ze[st]&&(w.disableVertexAttribArray(st),ot[st]=0)}function Ne(Ze,ot,st,Ct,Ft,Qe){!0!==d.isWebGL2||5124!==st&&5125!==st?w.vertexAttribPointer(Ze,ot,st,Ct,Ft,Qe):w.vertexAttribIPointer(Ze,ot,st,Ft,Qe)}function We(){tt(),V!==F&&(V=F,te(V.object))}function tt(){F.geometry=null,F.program=null,F.wireframe=!1}return{setup:function(Ze,ot,st,Ct,Ft){let Qe=!1;if(L){const nt=function(Tt,Yt,ct){const Lt=!0===ct.wireframe;let _t=k[Tt.id];void 0===_t&&(_t={},k[Tt.id]=_t);let zt=_t[Yt.id];void 0===zt&&(zt={},_t[Yt.id]=zt);let Rt=zt[Lt];return void 0===Rt&&(Rt=ue(d.isWebGL2?w.createVertexArray():S.createVertexArrayOES()),zt[Lt]=Rt),Rt}(Ct,st,ot);V!==nt&&(V=nt,te(V.object)),Qe=function(Tt,Yt){const ct=V.attributes,Lt=Tt.attributes;let _t=0;for(const zt in Lt){const Rt=ct[zt],nn=Lt[zt];if(void 0===Rt||Rt.attribute!==nn||Rt.data!==nn.data)return!0;_t++}return V.attributesNum!==_t||V.index!==Yt}(Ct,Ft),Qe&&function(Tt,Yt){const ct={},Lt=Tt.attributes;let _t=0;for(const zt in Lt){const Rt=Lt[zt],nn={};nn.attribute=Rt,Rt.data&&(nn.data=Rt.data),ct[zt]=nn,_t++}V.attributes=ct,V.attributesNum=_t,V.index=Yt}(Ct,Ft)}else{const nt=!0===ot.wireframe;V.geometry===Ct.id&&V.program===st.id&&V.wireframe===nt||(V.geometry=Ct.id,V.program=st.id,V.wireframe=nt,Qe=!0)}!0===Ze.isInstancedMesh&&(Qe=!0),null!==Ft&&c.update(Ft,34963),Qe&&(function(nt,Tt,Yt,ct){if(!1===d.isWebGL2&&(nt.isInstancedMesh||ct.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;_e();const Lt=ct.attributes,_t=Yt.getAttributes(),zt=Tt.defaultAttributeValues;for(const Rt in _t){const nn=_t[Rt];if(nn.location>=0){let en=Lt[Rt];if(void 0===en&&("instanceMatrix"===Rt&&nt.instanceMatrix&&(en=nt.instanceMatrix),"instanceColor"===Rt&&nt.instanceColor&&(en=nt.instanceColor)),void 0!==en){const Mn=en.normalized,rt=en.itemSize,ut=c.get(en);if(void 0===ut)continue;const rn=ut.buffer,un=ut.type,gn=ut.bytesPerElement;if(en.isInterleavedBufferAttribute){const kn=en.data,Jn=kn.stride,Zn=en.offset;if(kn&&kn.isInstancedInterleavedBuffer){for(let cn=0;cn<nn.locationSize;cn++)$e(nn.location+cn,kn.meshPerAttribute);!0!==nt.isInstancedMesh&&void 0===ct._maxInstanceCount&&(ct._maxInstanceCount=kn.meshPerAttribute*kn.count)}else for(let cn=0;cn<nn.locationSize;cn++)Ee(nn.location+cn);w.bindBuffer(34962,rn);for(let cn=0;cn<nn.locationSize;cn++)Ne(nn.location+cn,rt/nn.locationSize,un,Mn,Jn*gn,(Zn+rt/nn.locationSize*cn)*gn)}else{if(en.isInstancedBufferAttribute){for(let kn=0;kn<nn.locationSize;kn++)$e(nn.location+kn,en.meshPerAttribute);!0!==nt.isInstancedMesh&&void 0===ct._maxInstanceCount&&(ct._maxInstanceCount=en.meshPerAttribute*en.count)}else for(let kn=0;kn<nn.locationSize;kn++)Ee(nn.location+kn);w.bindBuffer(34962,rn);for(let kn=0;kn<nn.locationSize;kn++)Ne(nn.location+kn,rt/nn.locationSize,un,Mn,rt*gn,rt/nn.locationSize*kn*gn)}}else if(void 0!==zt){const Mn=zt[Rt];if(void 0!==Mn)switch(Mn.length){case 2:w.vertexAttrib2fv(nn.location,Mn);break;case 3:w.vertexAttrib3fv(nn.location,Mn);break;case 4:w.vertexAttrib4fv(nn.location,Mn);break;default:w.vertexAttrib1fv(nn.location,Mn)}}}}Le()}(Ze,ot,st,Ct),null!==Ft&&w.bindBuffer(34963,c.get(Ft).buffer))},reset:We,resetDefaultState:tt,dispose:function(){We();for(const Ze in k){const ot=k[Ze];for(const st in ot){const Ct=ot[st];for(const Ft in Ct)le(Ct[Ft].object),delete Ct[Ft];delete ot[st]}delete k[Ze]}},releaseStatesOfGeometry:function(Ze){if(void 0===k[Ze.id])return;const ot=k[Ze.id];for(const st in ot){const Ct=ot[st];for(const Ft in Ct)le(Ct[Ft].object),delete Ct[Ft];delete ot[st]}delete k[Ze.id]},releaseStatesOfProgram:function(Ze){for(const ot in k){const st=k[ot];if(void 0===st[Ze.id])continue;const Ct=st[Ze.id];for(const Ft in Ct)le(Ct[Ft].object),delete Ct[Ft];delete st[Ze.id]}},initAttributes:_e,enableAttribute:Ee,disableUnusedAttributes:Le}}function Vn(w,e,c,d){const _=d.isWebGL2;let S;this.setMode=function(L){S=L},this.render=function(L,k){w.drawArrays(S,L,k),c.update(k,S,1)},this.renderInstances=function(L,k,F){if(0===F)return;let V,te;if(_)V=w,te="drawArraysInstanced";else if(V=e.get("ANGLE_instanced_arrays"),te="drawArraysInstancedANGLE",null===V)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");V[te](S,L,k,F),c.update(k,S,F)}}function nu(w,e,c){let d;function _(Ze){if("highp"===Ze){if(w.getShaderPrecisionFormat(35633,36338).precision>0&&w.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Ze="mediump"}return"mediump"===Ze&&w.getShaderPrecisionFormat(35633,36337).precision>0&&w.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const S=typeof WebGL2RenderingContext<"u"&&w instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&w instanceof WebGL2ComputeRenderingContext;let L=void 0!==c.precision?c.precision:"highp";const k=_(L);k!==L&&(console.warn("THREE.WebGLRenderer:",L,"not supported, using",k,"instead."),L=k);const F=S||e.has("WEBGL_draw_buffers"),V=!0===c.logarithmicDepthBuffer,te=w.getParameter(34930),le=w.getParameter(35660),ue=w.getParameter(3379),_e=w.getParameter(34076),Ee=w.getParameter(34921),$e=w.getParameter(36347),Le=w.getParameter(36348),Ne=w.getParameter(36349),We=le>0,tt=S||e.has("OES_texture_float");return{isWebGL2:S,drawBuffers:F,getMaxAnisotropy:function(){if(void 0!==d)return d;if(!0===e.has("EXT_texture_filter_anisotropic")){const Ze=e.get("EXT_texture_filter_anisotropic");d=w.getParameter(Ze.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d},getMaxPrecision:_,precision:L,logarithmicDepthBuffer:V,maxTextures:te,maxVertexTextures:le,maxTextureSize:ue,maxCubemapSize:_e,maxAttributes:Ee,maxVertexUniforms:$e,maxVaryings:Le,maxFragmentUniforms:Ne,vertexTextures:We,floatFragmentTextures:tt,floatVertexTextures:We&&tt,maxSamples:S?w.getParameter(36183):0}}function Tu(w){const e=this;let c=null,d=0,_=!1,S=!1;const L=new Ra,k=new lt,F={value:null,needsUpdate:!1};function V(){F.value!==c&&(F.value=c,F.needsUpdate=d>0),e.numPlanes=d,e.numIntersection=0}function te(le,ue,_e,Ee){const $e=null!==le?le.length:0;let Le=null;if(0!==$e){if(Le=F.value,!0!==Ee||null===Le){const Ne=_e+4*$e,We=ue.matrixWorldInverse;k.getNormalMatrix(We),(null===Le||Le.length<Ne)&&(Le=new Float32Array(Ne));for(let tt=0,Ze=_e;tt!==$e;++tt,Ze+=4)L.copy(le[tt]).applyMatrix4(We,k),L.normal.toArray(Le,Ze),Le[Ze+3]=L.constant}F.value=Le,F.needsUpdate=!0}return e.numPlanes=$e,e.numIntersection=0,Le}this.uniform=F,this.numPlanes=0,this.numIntersection=0,this.init=function(le,ue,_e){const Ee=0!==le.length||ue||0!==d||_;return _=ue,c=te(le,_e,0),d=le.length,Ee},this.beginShadows=function(){S=!0,te(null)},this.endShadows=function(){S=!1,V()},this.setState=function(le,ue,_e){const Ee=le.clippingPlanes,$e=le.clipIntersection,Le=le.clipShadows,Ne=w.get(le);if(!_||null===Ee||0===Ee.length||S&&!Le)S?te(null):V();else{const We=S?0:d,tt=4*We;let Ze=Ne.clippingState||null;F.value=Ze,Ze=te(Ee,ue,tt,_e);for(let ot=0;ot!==tt;++ot)Ze[ot]=c[ot];Ne.clippingState=Ze,this.numIntersection=$e?this.numPlanes:0,this.numPlanes+=We}}}function vl(w){let e=new WeakMap;function c(_,S){return S===Ws?_.mapping=Ei:S===la&&(_.mapping=So),_}function d(_){const S=_.target;S.removeEventListener("dispose",d);const L=e.get(S);void 0!==L&&(e.delete(S),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const S=_.mapping;if(S===Ws||S===la){if(e.has(_))return c(e.get(_).texture,_.mapping);{const L=_.image;if(L&&L.height>0){const k=w.getRenderTarget(),F=new Bc(L.height/2);return F.fromEquirectangularTexture(w,_),e.set(_,F),w.setRenderTarget(k),_.addEventListener("dispose",d),c(F.texture,_.mapping)}return null}}}return _},dispose:function(){e=new WeakMap}}}Ol.physical={uniforms:Ai([Ol.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new zn(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new Kn(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new zn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new Kn(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new Kn(1,1,1)},specularTintMap:{value:null}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag};class rc extends Rl{constructor(e=-1,c=1,d=1,_=-1,S=.1,L=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=c,this.top=d,this.bottom=_,this.near=S,this.far=L,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,c,d,_,S,L){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=d,this.view.offsetY=_,this.view.width=S,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,_=(this.top+this.bottom)/2;let S=d-e,L=d+e,k=_+c,F=_-c;if(null!==this.view&&this.view.enabled){const V=(this.right-this.left)/this.view.fullWidth/this.zoom,te=(this.top-this.bottom)/this.view.fullHeight/this.zoom;S+=V*this.view.offsetX,L=S+V*this.view.width,k-=te*this.view.offsetY,F=k-te*this.view.height}this.projectionMatrix.makeOrthographic(S,L,k,F,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}rc.prototype.isOrthographicCamera=!0;class Mu extends Rs{constructor(e){super(e),this.type="RawShaderMaterial"}}Mu.prototype.isRawShaderMaterial=!0;const ga=Math.pow(2,8),ch=[.125,.215,.35,.446,.526,.582],pd=5+ch.length,ru={[Ji]:0,[hl]:1,[Yc]:2,[xc]:3,[nh]:4,[vu]:5,[Ql]:6},$h=new rc,{_lodPlanes:Rc,_sizeLods:uh,_sigmas:va}=function Je(){const w=[],e=[],c=[];let d=8;for(let _=0;_<pd;_++){const S=Math.pow(2,d);e.push(S);let L=1/S;_>4?L=ch[_-8+4-1]:0==_&&(L=0),c.push(L);const k=1/(S-1),F=-k/2,V=1+k/2,te=[F,F,V,F,V,V,F,F,V,V,F,V],le=6,ue=6,_e=3,Ee=2,$e=1,Le=new Float32Array(_e*ue*le),Ne=new Float32Array(Ee*ue*le),We=new Float32Array($e*ue*le);for(let Ze=0;Ze<le;Ze++){const ot=Ze%3*2/3-1,st=Ze>2?0:-1;Le.set([ot,st,0,ot+2/3,st,0,ot+2/3,st+1,0,ot,st,0,ot+2/3,st+1,0,ot,st+1,0],_e*ue*Ze),Ne.set(te,Ee*ue*Ze),We.set([Ze,Ze,Ze,Ze,Ze,Ze],$e*ue*Ze)}const tt=new br;tt.setAttribute("position",new Pi(Le,_e)),tt.setAttribute("uv",new Pi(Ne,Ee)),tt.setAttribute("faceIndex",new Pi(We,$e)),w.push(tt),d>4&&d--}return{_lodPlanes:w,_sizeLods:e,_sigmas:c}}(),Io=new Kn;let Ps=null;const ke=(1+Math.sqrt(5))/2,De=1/ke,He=[new ht(1,1,1),new ht(-1,1,1),new ht(1,1,-1),new ht(-1,1,-1),new ht(0,ke,De),new ht(0,ke,-De),new ht(De,0,ke),new ht(-De,0,ke),new ht(ke,De,0),new ht(-ke,De,0)];class we{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(c){const d=new Float32Array(20),_=new ht(0,1,0);return new Mu({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:d},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:_},inputEncoding:{value:ru[Ji]},outputEncoding:{value:ru[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,c=0,d=.1,_=100){Ps=this._renderer.getRenderTarget();const S=this._allocateTargets();return this._sceneToCubeUV(e,d,_,S),c>0&&this._blur(S,0,0,c),this._applyPMREM(S),this._cleanup(S),S}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=In(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=Wt(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Rc.length;e++)Rc[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Ps),e.scissorTest=!1,Ot(e,0,0,e.width,e.height)}_fromTexture(e){Ps=this._renderer.getRenderTarget();const c=this._allocateTargets(e);return this._textureToCubeUV(e,c),this._applyPMREM(c),this._cleanup(c),c}_allocateTargets(e){const c={magFilter:Ir,minFilter:Ir,generateMipmaps:!1,type:ca,format:vh,encoding:(w=e,void 0===w||w.type!==ca||w.encoding!==Ji&&w.encoding!==hl&&w.encoding!==Ql?Yc:e.encoding),depthBuffer:!1},d=bt(c);var w;return d.depthBuffer=!e,this._pingPongRenderTarget=bt(c),d}_compileMaterial(e){const c=new Ro(Rc[0],e);this._renderer.compile(c,$h)}_sceneToCubeUV(e,c,d,_){const S=new Po(90,1,c,d),L=[1,-1,1,1,1,1],k=[1,1,1,-1,-1,-1],F=this._renderer,V=F.autoClear,te=F.outputEncoding,le=F.toneMapping;F.getClearColor(Io),F.toneMapping=vr,F.outputEncoding=Ji,F.autoClear=!1;const ue=new fl({name:"PMREM.Background",side:W,depthWrite:!1,depthTest:!1}),_e=new Ro(new tc,ue);let Ee=!1;const $e=e.background;$e?$e.isColor&&(ue.color.copy($e),e.background=null,Ee=!0):(ue.color.copy(Io),Ee=!0);for(let Le=0;Le<6;Le++){const Ne=Le%3;0==Ne?(S.up.set(0,L[Le],0),S.lookAt(k[Le],0,0)):1==Ne?(S.up.set(0,0,L[Le]),S.lookAt(0,k[Le],0)):(S.up.set(0,L[Le],0),S.lookAt(0,0,k[Le])),Ot(_,Ne*ga,Le>2?ga:0,ga,ga),F.setRenderTarget(_),Ee&&F.render(_e,S),F.render(e,S)}_e.geometry.dispose(),_e.material.dispose(),F.toneMapping=le,F.outputEncoding=te,F.autoClear=V,e.background=$e}_textureToCubeUV(e,c){const d=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=In()):null==this._equirectShader&&(this._equirectShader=Wt());const _=e.isCubeTexture?this._cubemapShader:this._equirectShader,S=new Ro(Rc[0],_),L=_.uniforms;L.envMap.value=e,e.isCubeTexture||L.texelSize.value.set(1/e.image.width,1/e.image.height),L.inputEncoding.value=ru[e.encoding],L.outputEncoding.value=ru[c.texture.encoding],Ot(c,0,0,3*ga,2*ga),d.setRenderTarget(c),d.render(S,$h)}_applyPMREM(e){const c=this._renderer,d=c.autoClear;c.autoClear=!1;for(let _=1;_<pd;_++){const S=Math.sqrt(va[_]*va[_]-va[_-1]*va[_-1]);this._blur(e,_-1,_,S,He[(_-1)%He.length])}c.autoClear=d}_blur(e,c,d,_,S){const L=this._pingPongRenderTarget;this._halfBlur(e,L,c,d,_,"latitudinal",S),this._halfBlur(L,e,d,d,_,"longitudinal",S)}_halfBlur(e,c,d,_,S,L,k){const F=this._renderer,V=this._blurMaterial;"latitudinal"!==L&&"longitudinal"!==L&&console.error("blur direction must be either latitudinal or longitudinal!");const te=new Ro(Rc[_],V),le=V.uniforms,ue=uh[d]-1,_e=isFinite(S)?Math.PI/(2*ue):2*Math.PI/39,Ee=S/_e,$e=isFinite(S)?1+Math.floor(3*Ee):20;$e>20&&console.warn(`sigmaRadians, ${S}, is too large and will clip, as it requested ${$e} samples when the maximum is set to 20`);const Le=[];let Ne=0;for(let tt=0;tt<20;++tt){const Ze=tt/Ee,ot=Math.exp(-Ze*Ze/2);Le.push(ot),0==tt?Ne+=ot:tt<$e&&(Ne+=2*ot)}for(let tt=0;tt<Le.length;tt++)Le[tt]=Le[tt]/Ne;le.envMap.value=e.texture,le.samples.value=$e,le.weights.value=Le,le.latitudinal.value="latitudinal"===L,k&&(le.poleAxis.value=k),le.dTheta.value=_e,le.mipInt.value=8-d,le.inputEncoding.value=ru[e.texture.encoding],le.outputEncoding.value=ru[e.texture.encoding];const We=uh[_];Ot(c,3*Math.max(0,ga-2*We),(0===_?0:2*ga)+2*We*(_>4?_-8+4:0),3*We,2*We),F.setRenderTarget(c),F.render(te,$h)}}function bt(w){const e=new ro(3*ga,3*ga,w);return e.texture.mapping=Ni,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Ot(w,e,c,d,_){w.viewport.set(e,c,d,_),w.scissor.set(e,c,d,_)}function Wt(){const w=new zn(1,1);return new Mu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:w},inputEncoding:{value:ru[Ji]},outputEncoding:{value:ru[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function In(){return new Mu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:ru[Ji]},outputEncoding:{value:ru[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function Tn(w){let e=new WeakMap,c=null;function d(_){const S=_.target;S.removeEventListener("dispose",d);const L=e.get(S);void 0!==L&&(e.delete(S),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const S=_.mapping,L=S===Ws||S===la,k=S===Ei||S===So;if(L||k){if(e.has(_))return e.get(_).texture;{const F=_.image;if(L&&F&&F.height>0||k&&F&&function(V){let te=0;for(let le=0;le<6;le++)void 0!==V[le]&&te++;return 6===te}(F)){const V=w.getRenderTarget();null===c&&(c=new we(w));const te=L?c.fromEquirectangular(_):c.fromCubemap(_);return e.set(_,te),w.setRenderTarget(V),_.addEventListener("dispose",d),te.texture}return null}}}return _},dispose:function(){e=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function Gn(w){const e={};function c(d){if(void 0!==e[d])return e[d];let _;switch(d){case"WEBGL_depth_texture":_=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_=w.getExtension(d)}return e[d]=_,_}return{has:function(d){return null!==c(d)},init:function(d){d.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float")},get:function(d){const _=c(d);return null===_&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),_}}}function Cr(w,e,c,d){const _={},S=new WeakMap;function L(F){const V=F.target;null!==V.index&&e.remove(V.index);for(const le in V.attributes)e.remove(V.attributes[le]);V.removeEventListener("dispose",L),delete _[V.id];const te=S.get(V);te&&(e.remove(te),S.delete(V)),d.releaseStatesOfGeometry(V),!0===V.isInstancedBufferGeometry&&delete V._maxInstanceCount,c.memory.geometries--}function k(F){const V=[],te=F.index,le=F.attributes.position;let ue=0;if(null!==te){const $e=te.array;ue=te.version;for(let Le=0,Ne=$e.length;Le<Ne;Le+=3){const We=$e[Le+0],tt=$e[Le+1],Ze=$e[Le+2];V.push(We,tt,tt,Ze,Ze,We)}}else{ue=le.version;for(let Le=0,Ne=le.array.length/3-1;Le<Ne;Le+=3){const We=Le+0,tt=Le+1,Ze=Le+2;V.push(We,tt,tt,Ze,Ze,We)}}const _e=new(ci(V)>65535?li:sh)(V,1);_e.version=ue;const Ee=S.get(F);Ee&&e.remove(Ee),S.set(F,_e)}return{get:function(F,V){return!0===_[V.id]||(V.addEventListener("dispose",L),_[V.id]=!0,c.memory.geometries++),V},update:function(F){const V=F.attributes;for(const le in V)e.update(V[le],34962);const te=F.morphAttributes;for(const le in te){const ue=te[le];for(let _e=0,Ee=ue.length;_e<Ee;_e++)e.update(ue[_e],34962)}},getWireframeAttribute:function(F){const V=S.get(F);if(V){const te=F.index;null!==te&&V.version<te.version&&k(F)}else k(F);return S.get(F)}}}function Dr(w,e,c,d){const _=d.isWebGL2;let S,L,k;this.setMode=function(F){S=F},this.setIndex=function(F){L=F.type,k=F.bytesPerElement},this.render=function(F,V){w.drawElements(S,V,L,F*k),c.update(V,S,1)},this.renderInstances=function(F,V,te){if(0===te)return;let le,ue;if(_)le=w,ue="drawElementsInstanced";else if(le=e.get("ANGLE_instanced_arrays"),ue="drawElementsInstancedANGLE",null===le)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");le[ue](S,V,L,F*k,te),c.update(V,S,te)}}function Lr(w){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(c,d,_){switch(e.calls++,d){case 4:e.triangles+=_*(c/3);break;case 1:e.lines+=_*(c/2);break;case 3:e.lines+=_*(c-1);break;case 2:e.lines+=_*c;break;case 0:e.points+=_*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d)}}}}function Qt(w,e){return w[0]-e[0]}function Ao(w,e){return Math.abs(e[1])-Math.abs(w[1])}function ic(w){const e={},c=new Float32Array(8),d=[];for(let _=0;_<8;_++)d[_]=[_,0];return{update:function(_,S,L,k){const F=_.morphTargetInfluences,V=void 0===F?0:F.length;let te=e[S.id];if(void 0===te||te.length!==V){te=[];for(let $e=0;$e<V;$e++)te[$e]=[$e,0];e[S.id]=te}for(let $e=0;$e<V;$e++){const Le=te[$e];Le[0]=$e,Le[1]=F[$e]}te.sort(Ao);for(let $e=0;$e<8;$e++)$e<V&&te[$e][1]?(d[$e][0]=te[$e][0],d[$e][1]=te[$e][1]):(d[$e][0]=Number.MAX_SAFE_INTEGER,d[$e][1]=0);d.sort(Qt);const le=S.morphAttributes.position,ue=S.morphAttributes.normal;let _e=0;for(let $e=0;$e<8;$e++){const Le=d[$e],Ne=Le[0],We=Le[1];Ne!==Number.MAX_SAFE_INTEGER&&We?(le&&S.getAttribute("morphTarget"+$e)!==le[Ne]&&S.setAttribute("morphTarget"+$e,le[Ne]),ue&&S.getAttribute("morphNormal"+$e)!==ue[Ne]&&S.setAttribute("morphNormal"+$e,ue[Ne]),c[$e]=We,_e+=We):(le&&!0===S.hasAttribute("morphTarget"+$e)&&S.deleteAttribute("morphTarget"+$e),ue&&!0===S.hasAttribute("morphNormal"+$e)&&S.deleteAttribute("morphNormal"+$e),c[$e]=0)}const Ee=S.morphTargetsRelative?1:1-_e;k.getUniforms().setValue(w,"morphTargetBaseInfluence",Ee),k.getUniforms().setValue(w,"morphTargetInfluences",c)}}}function el(w,e,c,d){let _=new WeakMap;function S(L){const k=L.target;k.removeEventListener("dispose",S),c.remove(k.instanceMatrix),null!==k.instanceColor&&c.remove(k.instanceColor)}return{update:function(L){const k=d.render.frame,V=e.get(L,L.geometry);return _.get(V)!==k&&(e.update(V),_.set(V,k)),L.isInstancedMesh&&(!1===L.hasEventListener("dispose",S)&&L.addEventListener("dispose",S),c.update(L.instanceMatrix,34962),null!==L.instanceColor&&c.update(L.instanceColor,34962)),V},dispose:function(){_=new WeakMap}}}class Qr extends As{constructor(e=null,c=1,d=1,_=1){super(null),this.image={data:e,width:c,height:d,depth:_},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Qr.prototype.isDataTexture2DArray=!0;class Cn extends As{constructor(e=null,c=1,d=1,_=1){super(null),this.image={data:e,width:c,height:d,depth:_},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Cn.prototype.isDataTexture3D=!0;const Id=new As,Cm=new Qr,gr=new Cn,rf=new nc,of=[],Af=[],Au=new Float32Array(16),$f=new Float32Array(9),ya=new Float32Array(4);function oc(w,e,c){const d=w[0];if(d<=0||d>0)return w;const _=e*c;let S=of[_];if(void 0===S&&(S=new Float32Array(_),of[_]=S),0!==e){d.toArray(S,0);for(let L=1,k=0;L!==e;++L)k+=c,w[L].toArray(S,k)}return S}function vs(w,e){if(w.length!==e.length)return!1;for(let c=0,d=w.length;c<d;c++)if(w[c]!==e[c])return!1;return!0}function tl(w,e){for(let c=0,d=e.length;c<d;c++)w[c]=e[c]}function sf(w,e){let c=Af[e];void 0===c&&(c=new Int32Array(e),Af[e]=c);for(let d=0;d!==e;++d)c[d]=w.allocateTextureUnit();return c}function Vf(w,e){const c=this.cache;c[0]!==e&&(w.uniform1f(this.addr,e),c[0]=e)}function Wf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y||(w.uniform2f(this.addr,e.x,e.y),c[0]=e.x,c[1]=e.y);else{if(vs(c,e))return;w.uniform2fv(this.addr,e),tl(c,e)}}function Cf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z||(w.uniform3f(this.addr,e.x,e.y,e.z),c[0]=e.x,c[1]=e.y,c[2]=e.z);else if(void 0!==e.r)c[0]===e.r&&c[1]===e.g&&c[2]===e.b||(w.uniform3f(this.addr,e.r,e.g,e.b),c[0]=e.r,c[1]=e.g,c[2]=e.b);else{if(vs(c,e))return;w.uniform3fv(this.addr,e),tl(c,e)}}function qf(w,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z&&c[3]===e.w||(w.uniform4f(this.addr,e.x,e.y,e.z,e.w),c[0]=e.x,c[1]=e.y,c[2]=e.z,c[3]=e.w);else{if(vs(c,e))return;w.uniform4fv(this.addr,e),tl(c,e)}}function Lm(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(vs(c,e))return;w.uniformMatrix2fv(this.addr,!1,e),tl(c,e)}else{if(vs(c,d))return;ya.set(d),w.uniformMatrix2fv(this.addr,!1,ya),tl(c,d)}}function Bp(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(vs(c,e))return;w.uniformMatrix3fv(this.addr,!1,e),tl(c,e)}else{if(vs(c,d))return;$f.set(d),w.uniformMatrix3fv(this.addr,!1,$f),tl(c,d)}}function Xf(w,e){const c=this.cache,d=e.elements;if(void 0===d){if(vs(c,e))return;w.uniformMatrix4fv(this.addr,!1,e),tl(c,e)}else{if(vs(c,d))return;Au.set(d),w.uniformMatrix4fv(this.addr,!1,Au),tl(c,d)}}function Bm(w,e){const c=this.cache;c[0]!==e&&(w.uniform1i(this.addr,e),c[0]=e)}function Yf(w,e){const c=this.cache;vs(c,e)||(w.uniform2iv(this.addr,e),tl(c,e))}function Jf(w,e){const c=this.cache;vs(c,e)||(w.uniform3iv(this.addr,e),tl(c,e))}function Od(w,e){const c=this.cache;vs(c,e)||(w.uniform4iv(this.addr,e),tl(c,e))}function Nm(w,e){const c=this.cache;c[0]!==e&&(w.uniform1ui(this.addr,e),c[0]=e)}function Rm(w,e){const c=this.cache;vs(c,e)||(w.uniform2uiv(this.addr,e),tl(c,e))}function kd(w,e){const c=this.cache;vs(c,e)||(w.uniform3uiv(this.addr,e),tl(c,e))}function dd(w,e){const c=this.cache;vs(c,e)||(w.uniform4uiv(this.addr,e),tl(c,e))}function Zf(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.safeSetTexture2D(e||Id,_)}function Fd(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.setTexture3D(e||gr,_)}function tp(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.safeSetTextureCube(e||rf,_)}function Pm(w,e,c){const d=this.cache,_=c.allocateTextureUnit();d[0]!==_&&(w.uniform1i(this.addr,_),d[0]=_),c.setTexture2DArray(e||Cm,_)}function Im(w,e){w.uniform1fv(this.addr,e)}function Om(w,e){const c=oc(e,this.size,2);w.uniform2fv(this.addr,c)}function Qf(w,e){const c=oc(e,this.size,3);w.uniform3fv(this.addr,c)}function km(w,e){const c=oc(e,this.size,4);w.uniform4fv(this.addr,c)}function Dd(w,e){const c=oc(e,this.size,4);w.uniformMatrix2fv(this.addr,!1,c)}function Kf(w,e){const c=oc(e,this.size,9);w.uniformMatrix3fv(this.addr,!1,c)}function Fm(w,e){const c=oc(e,this.size,16);w.uniformMatrix4fv(this.addr,!1,c)}function Pc(w,e){w.uniform1iv(this.addr,e)}function Lf(w,e){w.uniform2iv(this.addr,e)}function em(w,e){w.uniform3iv(this.addr,e)}function tm(w,e){w.uniform4iv(this.addr,e)}function af(w,e){w.uniform1uiv(this.addr,e)}function Dm(w,e){w.uniform2uiv(this.addr,e)}function nm(w,e){w.uniform3uiv(this.addr,e)}function Um(w,e){w.uniform4uiv(this.addr,e)}function Bf(w,e,c){const d=e.length,_=sf(c,d);w.uniform1iv(this.addr,_);for(let S=0;S!==d;++S)c.safeSetTexture2D(e[S]||Id,_[S])}function zm(w,e,c){const d=e.length,_=sf(c,d);w.uniform1iv(this.addr,_);for(let S=0;S!==d;++S)c.safeSetTextureCube(e[S]||rf,_[S])}function lf(w,e,c){this.id=w,this.addr=c,this.cache=[],this.setValue=function(d){switch(d){case 5126:return Vf;case 35664:return Wf;case 35665:return Cf;case 35666:return qf;case 35674:return Lm;case 35675:return Bp;case 35676:return Xf;case 5124:case 35670:return Bm;case 35667:case 35671:return Yf;case 35668:case 35672:return Jf;case 35669:case 35673:return Od;case 5125:return Nm;case 36294:return Rm;case 36295:return kd;case 36296:return dd;case 35678:case 36198:case 36298:case 36306:case 35682:return Zf;case 35679:case 36299:case 36307:return Fd;case 35680:case 36300:case 36308:case 36293:return tp;case 36289:case 36303:case 36311:case 36292:return Pm}}(e.type)}function Ud(w,e,c){this.id=w,this.addr=c,this.cache=[],this.size=e.size,this.setValue=function(d){switch(d){case 5126:return Im;case 35664:return Om;case 35665:return Qf;case 35666:return km;case 35674:return Dd;case 35675:return Kf;case 35676:return Fm;case 5124:case 35670:return Pc;case 35667:case 35671:return Lf;case 35668:case 35672:return em;case 35669:case 35673:return tm;case 5125:return af;case 36294:return Dm;case 36295:return nm;case 36296:return Um;case 35678:case 36198:case 36298:case 36306:case 35682:return Bf;case 35680:case 36300:case 36308:case 36293:return zm}}(e.type)}function np(w){this.id=w,this.seq=[],this.map={}}Ud.prototype.updateCache=function(w){const e=this.cache;w instanceof Float32Array&&e.length!==w.length&&(this.cache=new Float32Array(w.length)),tl(e,w)},np.prototype.setValue=function(w,e,c){const d=this.seq;for(let _=0,S=d.length;_!==S;++_){const L=d[_];L.setValue(w,e[L.id],c)}};const Ks=/(\w+)(\])?(\[|\.)?/g;function Ch(w,e){w.seq.push(e),w.map[e.id]=e}function Ic(w,e,c){const d=w.name,_=d.length;for(Ks.lastIndex=0;;){const S=Ks.exec(d);let k=S[1];const V=S[3];if("]"===S[2]&&(k|=0),void 0===V||"["===V&&Ks.lastIndex+2===_){Ch(c,void 0===V?new lf(k,w,e):new Ud(k,w,e));break}{let te=c.map[k];void 0===te&&(te=new np(k),Ch(c,te)),c=te}}}function sc(w,e){this.seq=[],this.map={};const c=w.getProgramParameter(e,35718);for(let d=0;d<c;++d){const _=w.getActiveUniform(e,d);Ic(_,w.getUniformLocation(e,_.name),this)}}function ac(w,e,c){const d=w.createShader(e);return w.shaderSource(d,c),w.compileShader(d),d}sc.prototype.setValue=function(w,e,c,d){const _=this.map[e];void 0!==_&&_.setValue(w,c,d)},sc.prototype.setOptional=function(w,e,c){const d=e[c];void 0!==d&&this.setValue(w,c,d)},sc.upload=function(w,e,c,d){for(let _=0,S=e.length;_!==S;++_){const L=e[_],k=c[L.id];!1!==k.needsUpdate&&L.setValue(w,k.value,d)}},sc.seqWithValue=function(w,e){const c=[];for(let d=0,_=w.length;d!==_;++d){const S=w[d];S.id in e&&c.push(S)}return c};let fd=0;function zd(w){switch(w){case Ji:return["Linear","( value )"];case hl:return["sRGB","( value )"];case Yc:return["RGBE","( value )"];case xc:return["RGBM","( value, 7.0 )"];case nh:return["RGBM","( value, 16.0 )"];case vu:return["RGBD","( value, 256.0 )"];case Ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Wh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",w),["Linear","( value )"]}}function md(w,e,c){const d=w.getShaderParameter(e,35713),_=w.getShaderInfoLog(e).trim();return d&&""===_?"":c.toUpperCase()+"\n\n"+_+"\n\n"+function(S){const L=S.split("\n");for(let k=0;k<L.length;k++)L[k]=k+1+": "+L[k];return L.join("\n")}(w.getShaderSource(e))}function ba(w,e){const c=zd(e);return"vec4 "+w+"( vec4 value ) { return "+c[0]+"ToLinear"+c[1]+"; }"}function Np(w,e){const c=zd(e);return"vec4 "+w+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function cf(w,e){let c;switch(e){case mi:c="Linear";break;case _o:c="Reinhard";break;case Nr:c="OptimizedCineon";break;case ei:c="ACESFilmic";break;case Wr:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),c="Linear"}return"vec3 "+w+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function jd(w){return""!==w}function _d(w,e){return w.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function uf(w,e){return w.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const hf=/^[ \t]*#include +<([\w\d./]+)>/gm;function Xp(w){return w.replace(hf,Pa)}function Pa(w,e){const c=ui[e];if(void 0===c)throw new Error("Can not resolve #include <"+e+">");return Xp(c)}const $u=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Lh=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function _i(w){return w.replace(Lh,vd).replace($u,gd)}function gd(w,e,c,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),vd(0,e,c,d)}function vd(w,e,c,d){let _="";for(let S=parseInt(e);S<parseInt(c);S++)_+=d.replace(/\[\s*i\s*\]/g,"[ "+S+" ]").replace(/UNROLLED_LOOP_INDEX/g,S);return _}function Rp(w){let e="precision "+w.precision+" float;\nprecision "+w.precision+" int;";return"highp"===w.precision?e+="\n#define HIGH_PRECISION":"mediump"===w.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===w.precision&&(e+="\n#define LOW_PRECISION"),e}function yd(w,e,c,d){const _=w.getContext(),S=c.defines;let L=c.vertexShader,k=c.fragmentShader;const F=function(Ft){let Qe="SHADOWMAP_TYPE_BASIC";return Ft.shadowMapType===ie?Qe="SHADOWMAP_TYPE_PCF":Ft.shadowMapType===ce?Qe="SHADOWMAP_TYPE_PCF_SOFT":Ft.shadowMapType===fe&&(Qe="SHADOWMAP_TYPE_VSM"),Qe}(c),V=function(Ft){let Qe="ENVMAP_TYPE_CUBE";if(Ft.envMap)switch(Ft.envMapMode){case Ei:case So:Qe="ENVMAP_TYPE_CUBE";break;case Ni:case Eo:Qe="ENVMAP_TYPE_CUBE_UV"}return Qe}(c),te=function(Ft){let Qe="ENVMAP_MODE_REFLECTION";if(Ft.envMap)switch(Ft.envMapMode){case So:case Eo:Qe="ENVMAP_MODE_REFRACTION"}return Qe}(c),le=function(Ft){let Qe="ENVMAP_BLENDING_NONE";if(Ft.envMap)switch(Ft.combine){case Kr:Qe="ENVMAP_BLENDING_MULTIPLY";break;case pi:Qe="ENVMAP_BLENDING_MIX";break;case nr:Qe="ENVMAP_BLENDING_ADD"}return Qe}(c),ue=w.gammaFactor>0?w.gammaFactor:1,_e=c.isWebGL2?"":[(Ft=c).extensionDerivatives||Ft.envMapCubeUV||Ft.bumpMap||Ft.tangentSpaceNormalMap||Ft.clearcoatNormalMap||Ft.flatShading||"physical"===Ft.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(Ft.extensionFragDepth||Ft.logarithmicDepthBuffer)&&Ft.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Ft.extensionDrawBuffers&&Ft.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Ft.extensionShaderTextureLOD||Ft.envMap||Ft.transmission)&&Ft.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(jd).join("\n"),Ee=function(Ft){const Qe=[];for(const nt in Ft){const Tt=Ft[nt];!1!==Tt&&Qe.push("#define "+nt+" "+Tt)}return Qe.join("\n")}(S),$e=_.createProgram();var Ft;let Le,Ne,We=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(Le=[Ee].filter(jd).join("\n"),Le.length>0&&(Le+="\n"),Ne=[_e,Ee].filter(jd).join("\n"),Ne.length>0&&(Ne+="\n")):(Le=[Rp(c),"#define SHADER_NAME "+c.shaderName,Ee,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+ue,"#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+te:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(jd).join("\n"),Ne=[_e,Rp(c),"#define SHADER_NAME "+c.shaderName,Ee,"#define GAMMA_FACTOR "+ue,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+V:"",c.envMap?"#define "+te:"",c.envMap?"#define "+le:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheenTint?"#define USE_SHEEN":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==vr?"#define TONE_MAPPING":"",c.toneMapping!==vr?ui.tonemapping_pars_fragment:"",c.toneMapping!==vr?cf("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.format===Os?"#define OPAQUE":"",ui.encodings_pars_fragment,c.map?ba("mapTexelToLinear",c.mapEncoding):"",c.matcap?ba("matcapTexelToLinear",c.matcapEncoding):"",c.envMap?ba("envMapTexelToLinear",c.envMapEncoding):"",c.emissiveMap?ba("emissiveMapTexelToLinear",c.emissiveMapEncoding):"",c.specularTintMap?ba("specularTintMapTexelToLinear",c.specularTintMapEncoding):"",c.lightMap?ba("lightMapTexelToLinear",c.lightMapEncoding):"",Np("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(jd).join("\n")),L=Xp(L),L=_d(L,c),L=uf(L,c),k=Xp(k),k=_d(k,c),k=uf(k,c),L=_i(L),k=_i(k),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(We="#version 300 es\n",Le=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+Le,Ne=["#define varying in",c.glslVersion===Ri?"":"out highp vec4 pc_fragColor;",c.glslVersion===Ri?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+Ne);const tt=We+Ne+k,Ze=ac(_,35633,We+Le+L),ot=ac(_,35632,tt);if(_.attachShader($e,Ze),_.attachShader($e,ot),void 0!==c.index0AttributeName?_.bindAttribLocation($e,0,c.index0AttributeName):!0===c.morphTargets&&_.bindAttribLocation($e,0,"position"),_.linkProgram($e),w.debug.checkShaderErrors){const Ft=_.getProgramInfoLog($e).trim(),Qe=_.getShaderInfoLog(Ze).trim(),nt=_.getShaderInfoLog(ot).trim();let Tt=!0,Yt=!0;if(!1===_.getProgramParameter($e,35714)){Tt=!1;const ct=md(_,Ze,"vertex"),Lt=md(_,ot,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_.getError()+" - VALIDATE_STATUS "+_.getProgramParameter($e,35715)+"\n\nProgram Info Log: "+Ft+"\n"+ct+"\n"+Lt)}else""!==Ft?console.warn("THREE.WebGLProgram: Program Info Log:",Ft):""!==Qe&&""!==nt||(Yt=!1);Yt&&(this.diagnostics={runnable:Tt,programLog:Ft,vertexShader:{log:Qe,prefix:Le},fragmentShader:{log:nt,prefix:Ne}})}let st,Ct;return _.deleteShader(Ze),_.deleteShader(ot),this.getUniforms=function(){return void 0===st&&(st=new sc(_,$e)),st},this.getAttributes=function(){return void 0===Ct&&(Ct=function(Ft,Qe){const nt={},Tt=Ft.getProgramParameter(Qe,35721);for(let Yt=0;Yt<Tt;Yt++){const ct=Ft.getActiveAttrib(Qe,Yt),Lt=ct.name;let _t=1;35674===ct.type&&(_t=2),35675===ct.type&&(_t=3),35676===ct.type&&(_t=4),nt[Lt]={type:ct.type,location:Ft.getAttribLocation(Qe,Lt),locationSize:_t}}return nt}(_,$e)),Ct},this.destroy=function(){d.releaseStatesOfProgram(this),_.deleteProgram($e),this.program=void 0},this.name=c.shaderName,this.id=fd++,this.cacheKey=e,this.usedTimes=1,this.program=$e,this.vertexShader=Ze,this.fragmentShader=ot,this}function Pp(w,e,c,d,_,S,L){const k=[],F=_.isWebGL2,V=_.logarithmicDepthBuffer,te=_.floatVertexTextures,le=_.maxVertexUniforms,ue=_.vertexTextures;let _e=_.precision;const Ee={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},$e=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function Le(Ne){let We;return Ne&&Ne.isTexture?We=Ne.encoding:Ne&&Ne.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),We=Ne.texture.encoding):We=Ji,We}return{getParameters:function(Ne,We,tt,Ze,ot){const st=Ze.fog,Ft=(Ne.isMeshStandardMaterial?c:e).get(Ne.envMap||(Ne.isMeshStandardMaterial?Ze.environment:null)),Qe=Ee[Ne.type],nt=ot.isSkinnedMesh?function(zt){const Rt=zt.skeleton.bones;if(te)return 1024;{const en=Math.floor((le-20)/4),Mn=Math.min(en,Rt.length);return Mn<Rt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Rt.length+" bones. This GPU supports "+Mn+"."),0):Mn}}(ot):0;let Tt,Yt;if(null!==Ne.precision&&(_e=_.getMaxPrecision(Ne.precision),_e!==Ne.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ne.precision,"not supported, using",_e,"instead.")),Qe){const zt=Ol[Qe];Tt=zt.vertexShader,Yt=zt.fragmentShader}else Tt=Ne.vertexShader,Yt=Ne.fragmentShader;const ct=w.getRenderTarget(),Lt=Ne.alphaTest>0,_t=Ne.clearcoat>0;return{isWebGL2:F,shaderID:Qe,shaderName:Ne.type,vertexShader:Tt,fragmentShader:Yt,defines:Ne.defines,isRawShaderMaterial:!0===Ne.isRawShaderMaterial,glslVersion:Ne.glslVersion,precision:_e,instancing:!0===ot.isInstancedMesh,instancingColor:!0===ot.isInstancedMesh&&null!==ot.instanceColor,supportsVertexTextures:ue,outputEncoding:null!==ct?Le(ct.texture):w.outputEncoding,map:!!Ne.map,mapEncoding:Le(Ne.map),matcap:!!Ne.matcap,matcapEncoding:Le(Ne.matcap),envMap:!!Ft,envMapMode:Ft&&Ft.mapping,envMapEncoding:Le(Ft),envMapCubeUV:!!Ft&&(Ft.mapping===Ni||Ft.mapping===Eo),lightMap:!!Ne.lightMap,lightMapEncoding:Le(Ne.lightMap),aoMap:!!Ne.aoMap,emissiveMap:!!Ne.emissiveMap,emissiveMapEncoding:Le(Ne.emissiveMap),bumpMap:!!Ne.bumpMap,normalMap:!!Ne.normalMap,objectSpaceNormalMap:Ne.normalMapType===Be,tangentSpaceNormalMap:Ne.normalMapType===Me,clearcoat:_t,clearcoatMap:_t&&!!Ne.clearcoatMap,clearcoatRoughnessMap:_t&&!!Ne.clearcoatRoughnessMap,clearcoatNormalMap:_t&&!!Ne.clearcoatNormalMap,displacementMap:!!Ne.displacementMap,roughnessMap:!!Ne.roughnessMap,metalnessMap:!!Ne.metalnessMap,specularMap:!!Ne.specularMap,specularIntensityMap:!!Ne.specularIntensityMap,specularTintMap:!!Ne.specularTintMap,specularTintMapEncoding:Le(Ne.specularTintMap),alphaMap:!!Ne.alphaMap,alphaTest:Lt,gradientMap:!!Ne.gradientMap,sheenTint:!!Ne.sheenTint&&(Ne.sheenTint.r>0||Ne.sheenTint.g>0||Ne.sheenTint.b>0),transmission:Ne.transmission>0,transmissionMap:!!Ne.transmissionMap,thicknessMap:!!Ne.thicknessMap,combine:Ne.combine,vertexTangents:!!Ne.normalMap&&!!ot.geometry&&!!ot.geometry.attributes.tangent,vertexColors:Ne.vertexColors,vertexAlphas:!0===Ne.vertexColors&&!!ot.geometry&&!!ot.geometry.attributes.color&&4===ot.geometry.attributes.color.itemSize,vertexUvs:!!(Ne.map||Ne.bumpMap||Ne.normalMap||Ne.specularMap||Ne.alphaMap||Ne.emissiveMap||Ne.roughnessMap||Ne.metalnessMap||Ne.clearcoatMap||Ne.clearcoatRoughnessMap||Ne.clearcoatNormalMap||Ne.displacementMap||Ne.transmissionMap||Ne.thicknessMap||Ne.specularIntensityMap||Ne.specularTintMap),uvsVertexOnly:!(Ne.map||Ne.bumpMap||Ne.normalMap||Ne.specularMap||Ne.alphaMap||Ne.emissiveMap||Ne.roughnessMap||Ne.metalnessMap||Ne.clearcoatNormalMap||Ne.transmission>0||Ne.transmissionMap||Ne.thicknessMap||Ne.specularIntensityMap||Ne.specularTintMap||!Ne.displacementMap),fog:!!st,useFog:Ne.fog,fogExp2:st&&st.isFogExp2,flatShading:!!Ne.flatShading,sizeAttenuation:Ne.sizeAttenuation,logarithmicDepthBuffer:V,skinning:!0===ot.isSkinnedMesh&&nt>0,maxBones:nt,useVertexTexture:te,morphTargets:!!ot.geometry&&!!ot.geometry.morphAttributes.position,morphNormals:!!ot.geometry&&!!ot.geometry.morphAttributes.normal,numDirLights:We.directional.length,numPointLights:We.point.length,numSpotLights:We.spot.length,numRectAreaLights:We.rectArea.length,numHemiLights:We.hemi.length,numDirLightShadows:We.directionalShadowMap.length,numPointLightShadows:We.pointShadowMap.length,numSpotLightShadows:We.spotShadowMap.length,numClippingPlanes:L.numPlanes,numClipIntersection:L.numIntersection,format:Ne.format,dithering:Ne.dithering,shadowMapEnabled:w.shadowMap.enabled&&tt.length>0,shadowMapType:w.shadowMap.type,toneMapping:Ne.toneMapped?w.toneMapping:vr,physicallyCorrectLights:w.physicallyCorrectLights,premultipliedAlpha:Ne.premultipliedAlpha,doubleSided:Ne.side===Z,flipSided:Ne.side===W,depthPacking:void 0!==Ne.depthPacking&&Ne.depthPacking,index0AttributeName:Ne.index0AttributeName,extensionDerivatives:Ne.extensions&&Ne.extensions.derivatives,extensionFragDepth:Ne.extensions&&Ne.extensions.fragDepth,extensionDrawBuffers:Ne.extensions&&Ne.extensions.drawBuffers,extensionShaderTextureLOD:Ne.extensions&&Ne.extensions.shaderTextureLOD,rendererExtensionFragDepth:F||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:F||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:F||d.has("EXT_shader_texture_lod"),customProgramCacheKey:Ne.customProgramCacheKey()}},getProgramCacheKey:function(Ne){const We=[];if(Ne.shaderID?We.push(Ne.shaderID):(We.push(Ne.fragmentShader),We.push(Ne.vertexShader)),void 0!==Ne.defines)for(const tt in Ne.defines)We.push(tt),We.push(Ne.defines[tt]);if(!1===Ne.isRawShaderMaterial){for(let tt=0;tt<$e.length;tt++)We.push(Ne[$e[tt]]);We.push(w.outputEncoding),We.push(w.gammaFactor)}return We.push(Ne.customProgramCacheKey),We.join()},getUniforms:function(Ne){const We=Ee[Ne.type];let tt;return tt=We?Ns.clone(Ol[We].uniforms):Ne.uniforms,tt},acquireProgram:function(Ne,We){let tt;for(let Ze=0,ot=k.length;Ze<ot;Ze++){const st=k[Ze];if(st.cacheKey===We){tt=st,++tt.usedTimes;break}}return void 0===tt&&(tt=new yd(w,We,Ne,S),k.push(tt)),tt},releaseProgram:function(Ne){if(0==--Ne.usedTimes){const We=k.indexOf(Ne);k[We]=k[k.length-1],k.pop(),Ne.destroy()}},programs:k}}function Gd(){let w=new WeakMap;return{get:function(e){let c=w.get(e);return void 0===c&&(c={},w.set(e,c)),c},remove:function(e){w.delete(e)},update:function(e,c,d){w.get(e)[c]=d},dispose:function(){w=new WeakMap}}}function lc(w,e){return w.groupOrder!==e.groupOrder?w.groupOrder-e.groupOrder:w.renderOrder!==e.renderOrder?w.renderOrder-e.renderOrder:w.program!==e.program?w.program.id-e.program.id:w.material.id!==e.material.id?w.material.id-e.material.id:w.z!==e.z?w.z-e.z:w.id-e.id}function Hd(w,e){return w.groupOrder!==e.groupOrder?w.groupOrder-e.groupOrder:w.renderOrder!==e.renderOrder?w.renderOrder-e.renderOrder:w.z!==e.z?e.z-w.z:w.id-e.id}function bd(w){const e=[];let c=0;const d=[],_=[],S=[],L={id:-1};function k(F,V,te,le,ue,_e){let Ee=e[c];const $e=w.get(te);return void 0===Ee?(Ee={id:F.id,object:F,geometry:V,material:te,program:$e.program||L,groupOrder:le,renderOrder:F.renderOrder,z:ue,group:_e},e[c]=Ee):(Ee.id=F.id,Ee.object=F,Ee.geometry=V,Ee.material=te,Ee.program=$e.program||L,Ee.groupOrder=le,Ee.renderOrder=F.renderOrder,Ee.z=ue,Ee.group=_e),c++,Ee}return{opaque:d,transmissive:_,transparent:S,init:function(){c=0,d.length=0,_.length=0,S.length=0},push:function(F,V,te,le,ue,_e){const Ee=k(F,V,te,le,ue,_e);te.transmission>0?_.push(Ee):!0===te.transparent?S.push(Ee):d.push(Ee)},unshift:function(F,V,te,le,ue,_e){const Ee=k(F,V,te,le,ue,_e);te.transmission>0?_.unshift(Ee):!0===te.transparent?S.unshift(Ee):d.unshift(Ee)},finish:function(){for(let F=c,V=e.length;F<V;F++){const te=e[F];if(null===te.id)break;te.id=null,te.object=null,te.geometry=null,te.material=null,te.program=null,te.group=null}},sort:function(F,V){d.length>1&&d.sort(F||lc),_.length>1&&_.sort(V||Hd),S.length>1&&S.sort(V||Hd)}}}function pf(w){let e=new WeakMap;return{get:function(c,d){let _;return!1===e.has(c)?(_=new bd(w),e.set(c,[_])):d>=e.get(c).length?(_=new bd(w),e.get(c).push(_)):_=e.get(c)[d],_},dispose:function(){e=new WeakMap}}}function Nf(){const w={};return{get:function(e){if(void 0!==w[e.id])return w[e.id];let c;switch(e.type){case"DirectionalLight":c={direction:new ht,color:new Kn};break;case"SpotLight":c={position:new ht,direction:new ht,color:new Kn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new ht,color:new Kn,distance:0,decay:0};break;case"HemisphereLight":c={direction:new ht,skyColor:new Kn,groundColor:new Kn};break;case"RectAreaLight":c={color:new Kn,position:new ht,halfWidth:new ht,halfHeight:new ht}}return w[e.id]=c,c}}}let Rf=0;function rm(w,e){return(e.castShadow?1:0)-(w.castShadow?1:0)}function nl(w,e){const c=new Nf,d=function(){const F={};return{get:function(V){if(void 0!==F[V.id])return F[V.id];let te;switch(V.type){case"DirectionalLight":case"SpotLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn};break;case"PointLight":te={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new zn,shadowCameraNear:1,shadowCameraFar:1e3}}return F[V.id]=te,te}}}(),_={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let F=0;F<9;F++)_.probe.push(new ht);const S=new ht,L=new tn,k=new tn;return{setup:function(F,V){let te=0,le=0,ue=0;for(let Ct=0;Ct<9;Ct++)_.probe[Ct].set(0,0,0);let _e=0,Ee=0,$e=0,Le=0,Ne=0,We=0,tt=0,Ze=0;F.sort(rm);const ot=!0!==V?Math.PI:1;for(let Ct=0,Ft=F.length;Ct<Ft;Ct++){const Qe=F[Ct],nt=Qe.color,Tt=Qe.intensity,Yt=Qe.distance,ct=Qe.shadow&&Qe.shadow.map?Qe.shadow.map.texture:null;if(Qe.isAmbientLight)te+=nt.r*Tt*ot,le+=nt.g*Tt*ot,ue+=nt.b*Tt*ot;else if(Qe.isLightProbe)for(let Lt=0;Lt<9;Lt++)_.probe[Lt].addScaledVector(Qe.sh.coefficients[Lt],Tt);else if(Qe.isDirectionalLight){const Lt=c.get(Qe);if(Lt.color.copy(Qe.color).multiplyScalar(Qe.intensity*ot),Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,_.directionalShadow[_e]=zt,_.directionalShadowMap[_e]=ct,_.directionalShadowMatrix[_e]=Qe.shadow.matrix,We++}_.directional[_e]=Lt,_e++}else if(Qe.isSpotLight){const Lt=c.get(Qe);if(Lt.position.setFromMatrixPosition(Qe.matrixWorld),Lt.color.copy(nt).multiplyScalar(Tt*ot),Lt.distance=Yt,Lt.coneCos=Math.cos(Qe.angle),Lt.penumbraCos=Math.cos(Qe.angle*(1-Qe.penumbra)),Lt.decay=Qe.decay,Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,_.spotShadow[$e]=zt,_.spotShadowMap[$e]=ct,_.spotShadowMatrix[$e]=Qe.shadow.matrix,Ze++}_.spot[$e]=Lt,$e++}else if(Qe.isRectAreaLight){const Lt=c.get(Qe);Lt.color.copy(nt).multiplyScalar(Tt),Lt.halfWidth.set(.5*Qe.width,0,0),Lt.halfHeight.set(0,.5*Qe.height,0),_.rectArea[Le]=Lt,Le++}else if(Qe.isPointLight){const Lt=c.get(Qe);if(Lt.color.copy(Qe.color).multiplyScalar(Qe.intensity*ot),Lt.distance=Qe.distance,Lt.decay=Qe.decay,Qe.castShadow){const _t=Qe.shadow,zt=d.get(Qe);zt.shadowBias=_t.bias,zt.shadowNormalBias=_t.normalBias,zt.shadowRadius=_t.radius,zt.shadowMapSize=_t.mapSize,zt.shadowCameraNear=_t.camera.near,zt.shadowCameraFar=_t.camera.far,_.pointShadow[Ee]=zt,_.pointShadowMap[Ee]=ct,_.pointShadowMatrix[Ee]=Qe.shadow.matrix,tt++}_.point[Ee]=Lt,Ee++}else if(Qe.isHemisphereLight){const Lt=c.get(Qe);Lt.skyColor.copy(Qe.color).multiplyScalar(Tt*ot),Lt.groundColor.copy(Qe.groundColor).multiplyScalar(Tt*ot),_.hemi[Ne]=Lt,Ne++}}Le>0&&(e.isWebGL2||!0===w.has("OES_texture_float_linear")?(_.rectAreaLTC1=sr.LTC_FLOAT_1,_.rectAreaLTC2=sr.LTC_FLOAT_2):!0===w.has("OES_texture_half_float_linear")?(_.rectAreaLTC1=sr.LTC_HALF_1,_.rectAreaLTC2=sr.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_.ambient[0]=te,_.ambient[1]=le,_.ambient[2]=ue;const st=_.hash;st.directionalLength===_e&&st.pointLength===Ee&&st.spotLength===$e&&st.rectAreaLength===Le&&st.hemiLength===Ne&&st.numDirectionalShadows===We&&st.numPointShadows===tt&&st.numSpotShadows===Ze||(_.directional.length=_e,_.spot.length=$e,_.rectArea.length=Le,_.point.length=Ee,_.hemi.length=Ne,_.directionalShadow.length=We,_.directionalShadowMap.length=We,_.pointShadow.length=tt,_.pointShadowMap.length=tt,_.spotShadow.length=Ze,_.spotShadowMap.length=Ze,_.directionalShadowMatrix.length=We,_.pointShadowMatrix.length=tt,_.spotShadowMatrix.length=Ze,st.directionalLength=_e,st.pointLength=Ee,st.spotLength=$e,st.rectAreaLength=Le,st.hemiLength=Ne,st.numDirectionalShadows=We,st.numPointShadows=tt,st.numSpotShadows=Ze,_.version=Rf++)},setupView:function(F,V){let te=0,le=0,ue=0,_e=0,Ee=0;const $e=V.matrixWorldInverse;for(let Le=0,Ne=F.length;Le<Ne;Le++){const We=F[Le];if(We.isDirectionalLight){const tt=_.directional[te];tt.direction.setFromMatrixPosition(We.matrixWorld),S.setFromMatrixPosition(We.target.matrixWorld),tt.direction.sub(S),tt.direction.transformDirection($e),te++}else if(We.isSpotLight){const tt=_.spot[ue];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),tt.direction.setFromMatrixPosition(We.matrixWorld),S.setFromMatrixPosition(We.target.matrixWorld),tt.direction.sub(S),tt.direction.transformDirection($e),ue++}else if(We.isRectAreaLight){const tt=_.rectArea[_e];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),k.identity(),L.copy(We.matrixWorld),L.premultiply($e),k.extractRotation(L),tt.halfWidth.set(.5*We.width,0,0),tt.halfHeight.set(0,.5*We.height,0),tt.halfWidth.applyMatrix4(k),tt.halfHeight.applyMatrix4(k),_e++}else if(We.isPointLight){const tt=_.point[le];tt.position.setFromMatrixPosition(We.matrixWorld),tt.position.applyMatrix4($e),le++}else if(We.isHemisphereLight){const tt=_.hemi[Ee];tt.direction.setFromMatrixPosition(We.matrixWorld),tt.direction.transformDirection($e),tt.direction.normalize(),Ee++}}},state:_}}function Ip(w,e){const c=new nl(w,e),d=[],_=[];return{init:function(){d.length=0,_.length=0},state:{lightsArray:d,shadowsArray:_,lights:c},setupLights:function(S){c.setup(d,S)},setupLightsView:function(S){c.setupView(d,S)},pushLight:function(S){d.push(S)},pushShadow:function(S){_.push(S)}}}function df(w,e){let c=new WeakMap;return{get:function(d,_=0){let S;return!1===c.has(d)?(S=new Ip(w,e),c.set(d,[S])):_>=c.get(d).length?(S=new Ip(w,e),c.get(d).push(S)):S=c.get(d)[_],S},dispose:function(){c=new WeakMap}}}class Vd extends $s{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=q,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Vd.prototype.isMeshDepthMaterial=!0;class Op extends $s{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new ht,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Op.prototype.isMeshDistanceMaterial=!0;var ff="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",im="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function om(w,e,c){let d=new Fr;const _=new zn,S=new zn,L=new Di,k=new Vd({depthPacking:pe}),F=new Op,V={},te=c.maxTextureSize,le={0:W,1:ae,2:Z},ue=new Rs({uniforms:{shadow_pass:{value:null},resolution:{value:new zn},radius:{value:4},samples:{value:8}},vertexShader:im,fragmentShader:ff}),_e=ue.clone();_e.defines.HORIZONTAL_PASS=1;const Ee=new br;Ee.setAttribute("position",new Pi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const $e=new Ro(Ee,ue),Le=this;function Ne(Ze,ot){const st=e.update($e);ue.uniforms.shadow_pass.value=Ze.map.texture,ue.uniforms.resolution.value=Ze.mapSize,ue.uniforms.radius.value=Ze.radius,ue.uniforms.samples.value=Ze.blurSamples,w.setRenderTarget(Ze.mapPass),w.clear(),w.renderBufferDirect(ot,null,st,ue,$e,null),_e.uniforms.shadow_pass.value=Ze.mapPass.texture,_e.uniforms.resolution.value=Ze.mapSize,_e.uniforms.radius.value=Ze.radius,_e.uniforms.samples.value=Ze.blurSamples,w.setRenderTarget(Ze.map),w.clear(),w.renderBufferDirect(ot,null,st,_e,$e,null)}function We(Ze,ot,st,Ct,Ft,Qe,nt){let Tt=null;const Yt=!0===Ct.isPointLight?Ze.customDistanceMaterial:Ze.customDepthMaterial;if(Tt=void 0!==Yt?Yt:!0===Ct.isPointLight?F:k,w.localClippingEnabled&&!0===st.clipShadows&&0!==st.clippingPlanes.length||st.displacementMap&&0!==st.displacementScale||st.alphaMap&&st.alphaTest>0){const ct=Tt.uuid,Lt=st.uuid;let _t=V[ct];void 0===_t&&(_t={},V[ct]=_t);let zt=_t[Lt];void 0===zt&&(zt=Tt.clone(),_t[Lt]=zt),Tt=zt}return Tt.visible=st.visible,Tt.wireframe=st.wireframe,Tt.side=nt===fe?null!==st.shadowSide?st.shadowSide:st.side:null!==st.shadowSide?st.shadowSide:le[st.side],Tt.alphaMap=st.alphaMap,Tt.alphaTest=st.alphaTest,Tt.clipShadows=st.clipShadows,Tt.clippingPlanes=st.clippingPlanes,Tt.clipIntersection=st.clipIntersection,Tt.displacementMap=st.displacementMap,Tt.displacementScale=st.displacementScale,Tt.displacementBias=st.displacementBias,Tt.wireframeLinewidth=st.wireframeLinewidth,Tt.linewidth=st.linewidth,!0===Ct.isPointLight&&!0===Tt.isMeshDistanceMaterial&&(Tt.referencePosition.setFromMatrixPosition(Ct.matrixWorld),Tt.nearDistance=Ft,Tt.farDistance=Qe),Tt}function tt(Ze,ot,st,Ct,Ft){if(!1===Ze.visible)return;if(Ze.layers.test(ot.layers)&&(Ze.isMesh||Ze.isLine||Ze.isPoints)&&(Ze.castShadow||Ze.receiveShadow&&Ft===fe)&&(!Ze.frustumCulled||d.intersectsObject(Ze))){Ze.modelViewMatrix.multiplyMatrices(st.matrixWorldInverse,Ze.matrixWorld);const nt=e.update(Ze),Tt=Ze.material;if(Array.isArray(Tt)){const Yt=nt.groups;for(let ct=0,Lt=Yt.length;ct<Lt;ct++){const _t=Yt[ct],zt=Tt[_t.materialIndex];if(zt&&zt.visible){const Rt=We(Ze,0,zt,Ct,st.near,st.far,Ft);w.renderBufferDirect(st,null,nt,Rt,Ze,_t)}}}else if(Tt.visible){const Yt=We(Ze,0,Tt,Ct,st.near,st.far,Ft);w.renderBufferDirect(st,null,nt,Yt,Ze,null)}}const Qe=Ze.children;for(let nt=0,Tt=Qe.length;nt<Tt;nt++)tt(Qe[nt],ot,st,Ct,Ft)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ie,this.render=function(Ze,ot,st){if(!1===Le.enabled||!1===Le.autoUpdate&&!1===Le.needsUpdate||0===Ze.length)return;const Ct=w.getRenderTarget(),Ft=w.getActiveCubeFace(),Qe=w.getActiveMipmapLevel(),nt=w.state;nt.setBlending(X),nt.buffers.color.setClear(1,1,1,1),nt.buffers.depth.setTest(!0),nt.setScissorTest(!1);for(let Tt=0,Yt=Ze.length;Tt<Yt;Tt++){const ct=Ze[Tt],Lt=ct.shadow;if(void 0===Lt){console.warn("THREE.WebGLShadowMap:",ct,"has no shadow.");continue}if(!1===Lt.autoUpdate&&!1===Lt.needsUpdate)continue;_.copy(Lt.mapSize);const _t=Lt.getFrameExtents();if(_.multiply(_t),S.copy(Lt.mapSize),(_.x>te||_.y>te)&&(_.x>te&&(S.x=Math.floor(te/_t.x),_.x=S.x*_t.x,Lt.mapSize.x=S.x),_.y>te&&(S.y=Math.floor(te/_t.y),_.y=S.y*_t.y,Lt.mapSize.y=S.y)),null===Lt.map&&!Lt.isPointLightShadow&&this.type===fe){const Rt={minFilter:ai,magFilter:ai,format:ao};Lt.map=new ro(_.x,_.y,Rt),Lt.map.texture.name=ct.name+".shadowMap",Lt.mapPass=new ro(_.x,_.y,Rt),Lt.camera.updateProjectionMatrix()}null===Lt.map&&(Lt.map=new ro(_.x,_.y,{minFilter:Ir,magFilter:Ir,format:ao}),Lt.map.texture.name=ct.name+".shadowMap",Lt.camera.updateProjectionMatrix()),w.setRenderTarget(Lt.map),w.clear();const zt=Lt.getViewportCount();for(let Rt=0;Rt<zt;Rt++){const nn=Lt.getViewport(Rt);L.set(S.x*nn.x,S.y*nn.y,S.x*nn.z,S.y*nn.w),nt.viewport(L),Lt.updateMatrices(ct,Rt),d=Lt.getFrustum(),tt(ot,st,Lt.camera,ct,this.type)}Lt.isPointLightShadow||this.type!==fe||Ne(Lt,st),Lt.needsUpdate=!1}Le.needsUpdate=!1,w.setRenderTarget(Ct,Ft,Qe)}}function mf(w,e,c){const d=c.isWebGL2,_=new function(){let mt=!1;const Kt=new Di;let Vt=null;const yn=new Di(0,0,0,0);return{setMask:function(Nn){Vt===Nn||mt||(w.colorMask(Nn,Nn,Nn,Nn),Vt=Nn)},setLocked:function(Nn){mt=Nn},setClear:function(Nn,pr,_r,jr,ki){!0===ki&&(Nn*=jr,pr*=jr,_r*=jr),Kt.set(Nn,pr,_r,jr),!1===yn.equals(Kt)&&(w.clearColor(Nn,pr,_r,jr),yn.copy(Kt))},reset:function(){mt=!1,Vt=null,yn.set(-1,0,0,0)}}},S=new function(){let mt=!1,Kt=null,Vt=null,yn=null;return{setTest:function(Nn){Nn?rt(2929):ut(2929)},setMask:function(Nn){Kt===Nn||mt||(w.depthMask(Nn),Kt=Nn)},setFunc:function(Nn){if(Vt!==Nn){if(Nn)switch(Nn){case On:w.depthFunc(512);break;case Ln:w.depthFunc(519);break;case mn:w.depthFunc(513);break;case cr:w.depthFunc(515);break;case rr:w.depthFunc(514);break;case ur:w.depthFunc(518);break;case or:w.depthFunc(516);break;case ni:w.depthFunc(517);break;default:w.depthFunc(515)}else w.depthFunc(515);Vt=Nn}},setLocked:function(Nn){mt=Nn},setClear:function(Nn){yn!==Nn&&(w.clearDepth(Nn),yn=Nn)},reset:function(){mt=!1,Kt=null,Vt=null,yn=null}}},L=new function(){let mt=!1,Kt=null,Vt=null,yn=null,Nn=null,pr=null,_r=null,jr=null,ki=null;return{setTest:function(mo){mt||(mo?rt(2960):ut(2960))},setMask:function(mo){Kt===mo||mt||(w.stencilMask(mo),Kt=mo)},setFunc:function(mo,El,zo){Vt===mo&&yn===El&&Nn===zo||(w.stencilFunc(mo,El,zo),Vt=mo,yn=El,Nn=zo)},setOp:function(mo,El,zo){pr===mo&&_r===El&&jr===zo||(w.stencilOp(mo,El,zo),pr=mo,_r=El,jr=zo)},setLocked:function(mo){mt=mo},setClear:function(mo){ki!==mo&&(w.clearStencil(mo),ki=mo)},reset:function(){mt=!1,Kt=null,Vt=null,yn=null,Nn=null,pr=null,_r=null,jr=null,ki=null}}};let k={},F=null,V={},te=null,le=!1,ue=null,_e=null,Ee=null,$e=null,Le=null,Ne=null,We=null,tt=!1,Ze=null,ot=null,st=null,Ct=null,Ft=null;const Qe=w.getParameter(35661);let nt=!1,Tt=0;const Yt=w.getParameter(7938);-1!==Yt.indexOf("WebGL")?(Tt=parseFloat(/^WebGL (\d)/.exec(Yt)[1]),nt=Tt>=1):-1!==Yt.indexOf("OpenGL ES")&&(Tt=parseFloat(/^OpenGL ES (\d)/.exec(Yt)[1]),nt=Tt>=2);let ct=null,Lt={};const _t=w.getParameter(3088),zt=w.getParameter(2978),Rt=(new Di).fromArray(_t),nn=(new Di).fromArray(zt);function en(mt,Kt,Vt){const yn=new Uint8Array(4),Nn=w.createTexture();w.bindTexture(mt,Nn),w.texParameteri(mt,10241,9728),w.texParameteri(mt,10240,9728);for(let pr=0;pr<Vt;pr++)w.texImage2D(Kt+pr,0,6408,1,1,0,6408,5121,yn);return Nn}const Mn={};function rt(mt){!0!==k[mt]&&(w.enable(mt),k[mt]=!0)}function ut(mt){!1!==k[mt]&&(w.disable(mt),k[mt]=!1)}Mn[3553]=en(3553,3553,1),Mn[34067]=en(34067,34069,6),_.setClear(0,0,0,1),S.setClear(1),L.setClear(0),rt(2929),S.setFunc(cr),kn(!1),Jn(M),rt(2884),gn(X);const rn={[Pe]:32774,[Ge]:32778,[Ae]:32779};if(d)rn[Xe]=32775,rn[Ke]=32776;else{const mt=e.get("EXT_blend_minmax");null!==mt&&(rn[Xe]=mt.MIN_EXT,rn[Ke]=mt.MAX_EXT)}const un={[yt]:0,[dt]:1,[It]:768,[Gt]:770,[dn]:776,[An]:774,[sn]:772,[wt]:769,[Dt]:771,[Bn]:775,[gt]:773};function gn(mt,Kt,Vt,yn,Nn,pr,_r,jr){if(mt!==X){if(!1===le&&(rt(3042),le=!0),mt===be)Nn=Nn||Kt,pr=pr||Vt,_r=_r||yn,Kt===_e&&Nn===Le||(w.blendEquationSeparate(rn[Kt],rn[Nn]),_e=Kt,Le=Nn),Vt===Ee&&yn===$e&&pr===Ne&&_r===We||(w.blendFuncSeparate(un[Vt],un[yn],un[pr],un[_r]),Ee=Vt,$e=yn,Ne=pr,We=_r),ue=mt,tt=null;else if(mt!==ue||jr!==tt){if(_e===Pe&&Le===Pe||(w.blendEquation(32774),_e=Pe,Le=Pe),jr)switch(mt){case he:w.blendFuncSeparate(1,771,1,771);break;case U:w.blendFunc(1,1);break;case Re:w.blendFuncSeparate(0,0,769,771);break;case Q:w.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",mt)}else switch(mt){case he:w.blendFuncSeparate(770,771,1,771);break;case U:w.blendFunc(770,1);break;case Re:w.blendFunc(0,769);break;case Q:w.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",mt)}Ee=null,$e=null,Ne=null,We=null,ue=mt,tt=jr}}else!0===le&&(ut(3042),le=!1)}function kn(mt){Ze!==mt&&(w.frontFace(mt?2304:2305),Ze=mt)}function Jn(mt){mt!==G?(rt(2884),mt!==ot&&w.cullFace(mt===M?1029:mt===P?1028:1032)):ut(2884),ot=mt}function Zn(mt,Kt,Vt){mt?(rt(32823),Ct===Kt&&Ft===Vt||(w.polygonOffset(Kt,Vt),Ct=Kt,Ft=Vt)):ut(32823)}function cn(mt){void 0===mt&&(mt=33984+Qe-1),ct!==mt&&(w.activeTexture(mt),ct=mt)}return{buffers:{color:_,depth:S,stencil:L},enable:rt,disable:ut,bindFramebuffer:function(mt,Kt){return null===Kt&&null!==F&&(Kt=F),V[mt]!==Kt&&(w.bindFramebuffer(mt,Kt),V[mt]=Kt,d&&(36009===mt&&(V[36160]=Kt),36160===mt&&(V[36009]=Kt)),!0)},bindXRFramebuffer:function(mt){mt!==F&&(w.bindFramebuffer(36160,mt),F=mt)},useProgram:function(mt){return te!==mt&&(w.useProgram(mt),te=mt,!0)},setBlending:gn,setMaterial:function(mt,Kt){mt.side===Z?ut(2884):rt(2884);let Vt=mt.side===W;Kt&&(Vt=!Vt),kn(Vt),mt.blending===he&&!1===mt.transparent?gn(X):gn(mt.blending,mt.blendEquation,mt.blendSrc,mt.blendDst,mt.blendEquationAlpha,mt.blendSrcAlpha,mt.blendDstAlpha,mt.premultipliedAlpha),S.setFunc(mt.depthFunc),S.setTest(mt.depthTest),S.setMask(mt.depthWrite),_.setMask(mt.colorWrite);const yn=mt.stencilWrite;L.setTest(yn),yn&&(L.setMask(mt.stencilWriteMask),L.setFunc(mt.stencilFunc,mt.stencilRef,mt.stencilFuncMask),L.setOp(mt.stencilFail,mt.stencilZFail,mt.stencilZPass)),Zn(mt.polygonOffset,mt.polygonOffsetFactor,mt.polygonOffsetUnits),!0===mt.alphaToCoverage?rt(32926):ut(32926)},setFlipSided:kn,setCullFace:Jn,setLineWidth:function(mt){mt!==st&&(nt&&w.lineWidth(mt),st=mt)},setPolygonOffset:Zn,setScissorTest:function(mt){mt?rt(3089):ut(3089)},activeTexture:cn,bindTexture:function(mt,Kt){null===ct&&cn();let Vt=Lt[ct];void 0===Vt&&(Vt={type:void 0,texture:void 0},Lt[ct]=Vt),Vt.type===mt&&Vt.texture===Kt||(w.bindTexture(mt,Kt||Mn[mt]),Vt.type=mt,Vt.texture=Kt)},unbindTexture:function(){const mt=Lt[ct];void 0!==mt&&void 0!==mt.type&&(w.bindTexture(mt.type,null),mt.type=void 0,mt.texture=void 0)},compressedTexImage2D:function(){try{w.compressedTexImage2D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},texImage2D:function(){try{w.texImage2D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},texImage3D:function(){try{w.texImage3D.apply(w,arguments)}catch(mt){console.error("THREE.WebGLState:",mt)}},scissor:function(mt){!1===Rt.equals(mt)&&(w.scissor(mt.x,mt.y,mt.z,mt.w),Rt.copy(mt))},viewport:function(mt){!1===nn.equals(mt)&&(w.viewport(mt.x,mt.y,mt.z,mt.w),nn.copy(mt))},reset:function(){w.disable(3042),w.disable(2884),w.disable(2929),w.disable(32823),w.disable(3089),w.disable(2960),w.disable(32926),w.blendEquation(32774),w.blendFunc(1,0),w.blendFuncSeparate(1,0,1,0),w.colorMask(!0,!0,!0,!0),w.clearColor(0,0,0,0),w.depthMask(!0),w.depthFunc(513),w.clearDepth(1),w.stencilMask(4294967295),w.stencilFunc(519,0,4294967295),w.stencilOp(7680,7680,7680),w.clearStencil(0),w.cullFace(1029),w.frontFace(2305),w.polygonOffset(0,0),w.activeTexture(33984),w.bindFramebuffer(36160,null),!0===d&&(w.bindFramebuffer(36009,null),w.bindFramebuffer(36008,null)),w.useProgram(null),w.lineWidth(1),w.scissor(0,0,w.canvas.width,w.canvas.height),w.viewport(0,0,w.canvas.width,w.canvas.height),k={},ct=null,Lt={},F=null,V={},te=null,le=!1,ue=null,_e=null,Ee=null,$e=null,Le=null,Ne=null,We=null,tt=!1,Ze=null,ot=null,st=null,Ct=null,Ft=null,Rt.set(0,0,w.canvas.width,w.canvas.height),nn.set(0,0,w.canvas.width,w.canvas.height),_.reset(),S.reset(),L.reset()}}}function Cu(w,e,c,d,_,S,L){const k=_.isWebGL2,F=_.maxTextures,V=_.maxCubemapSize,te=_.maxTextureSize,le=_.maxSamples,ue=new WeakMap;let _e,Ee=!1;try{Ee=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function $e(rt,ut){return Ee?new OffscreenCanvas(rt,ut):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function Le(rt,ut,rn,un){let gn=1;if((rt.width>un||rt.height>un)&&(gn=un/Math.max(rt.width,rt.height)),gn<1||!0===ut){if(typeof HTMLImageElement<"u"&&rt instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&rt instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&rt instanceof ImageBitmap){const kn=ut?vo:Math.floor,Jn=kn(gn*rt.width),Zn=kn(gn*rt.height);void 0===_e&&(_e=$e(Jn,Zn));const cn=rn?$e(Jn,Zn):_e;return cn.width=Jn,cn.height=Zn,cn.getContext("2d").drawImage(rt,0,0,Jn,Zn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+rt.width+"x"+rt.height+") to ("+Jn+"x"+Zn+")."),cn}return"data"in rt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+rt.width+"x"+rt.height+")."),rt}return rt}function Ne(rt){return Fs(rt.width)&&Fs(rt.height)}function We(rt,ut){return rt.generateMipmaps&&ut&&rt.minFilter!==Ir&&rt.minFilter!==ai}function tt(rt,ut,rn,un,gn=1){w.generateMipmap(rt),d.get(ut).__maxMipLevel=Math.log2(Math.max(rn,un,gn))}function Ze(rt,ut,rn){if(!1===k)return ut;if(null!==rt){if(void 0!==w[rt])return w[rt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+rt+"'")}let un=ut;return 6403===ut&&(5126===rn&&(un=33326),5131===rn&&(un=33325),5121===rn&&(un=33321)),6407===ut&&(5126===rn&&(un=34837),5131===rn&&(un=34843),5121===rn&&(un=32849)),6408===ut&&(5126===rn&&(un=34836),5131===rn&&(un=34842),5121===rn&&(un=32856)),33325!==un&&33326!==un&&34842!==un&&34836!==un||e.get("EXT_color_buffer_float"),un}function ot(rt){return rt===Ir||rt===Va||rt===us?9728:9729}function st(rt){const ut=rt.target;ut.removeEventListener("dispose",st),function(rn){const un=d.get(rn);void 0!==un.__webglInit&&(w.deleteTexture(un.__webglTexture),d.remove(rn))}(ut),ut.isVideoTexture&&ue.delete(ut),L.memory.textures--}function Ct(rt){const ut=rt.target;ut.removeEventListener("dispose",Ct),function(rn){const un=rn.texture,gn=d.get(rn),kn=d.get(un);if(rn){if(void 0!==kn.__webglTexture&&(w.deleteTexture(kn.__webglTexture),L.memory.textures--),rn.depthTexture&&rn.depthTexture.dispose(),rn.isWebGLCubeRenderTarget)for(let Jn=0;Jn<6;Jn++)w.deleteFramebuffer(gn.__webglFramebuffer[Jn]),gn.__webglDepthbuffer&&w.deleteRenderbuffer(gn.__webglDepthbuffer[Jn]);else w.deleteFramebuffer(gn.__webglFramebuffer),gn.__webglDepthbuffer&&w.deleteRenderbuffer(gn.__webglDepthbuffer),gn.__webglMultisampledFramebuffer&&w.deleteFramebuffer(gn.__webglMultisampledFramebuffer),gn.__webglColorRenderbuffer&&w.deleteRenderbuffer(gn.__webglColorRenderbuffer),gn.__webglDepthRenderbuffer&&w.deleteRenderbuffer(gn.__webglDepthRenderbuffer);if(rn.isWebGLMultipleRenderTargets)for(let Jn=0,Zn=un.length;Jn<Zn;Jn++){const cn=d.get(un[Jn]);cn.__webglTexture&&(w.deleteTexture(cn.__webglTexture),L.memory.textures--),d.remove(un[Jn])}d.remove(un),d.remove(rn)}}(ut)}let Ft=0;function Qe(rt,ut){const rn=d.get(rt);if(rt.isVideoTexture&&function(un){const gn=L.render.frame;ue.get(un)!==gn&&(ue.set(un,gn),un.update())}(rt),rt.version>0&&rn.__version!==rt.version){const un=rt.image;if(void 0===un)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==un.complete)return void _t(rn,rt,ut);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.activeTexture(33984+ut),c.bindTexture(3553,rn.__webglTexture)}function nt(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?function(un,gn,kn){if(6!==gn.image.length)return;Lt(un,gn),c.activeTexture(33984+kn),c.bindTexture(34067,un.__webglTexture),w.pixelStorei(37440,gn.flipY),w.pixelStorei(37441,gn.premultiplyAlpha),w.pixelStorei(3317,gn.unpackAlignment),w.pixelStorei(37443,0);const Jn=gn&&(gn.isCompressedTexture||gn.image[0].isCompressedTexture),Zn=gn.image[0]&&gn.image[0].isDataTexture,cn=[];for(let _r=0;_r<6;_r++)cn[_r]=Jn||Zn?Zn?gn.image[_r].image:gn.image[_r]:Le(gn.image[_r],!1,!0,V);const mt=cn[0],Kt=Ne(mt)||k,Vt=S.convert(gn.format),yn=S.convert(gn.type),Nn=Ze(gn.internalFormat,Vt,yn);let pr;if(ct(34067,gn,Kt),Jn){for(let _r=0;_r<6;_r++){pr=cn[_r].mipmaps;for(let jr=0;jr<pr.length;jr++){const ki=pr[jr];gn.format!==ao&&gn.format!==Os?null!==Vt?c.compressedTexImage2D(34069+_r,jr,Nn,ki.width,ki.height,0,ki.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(34069+_r,jr,Nn,ki.width,ki.height,0,Vt,yn,ki.data)}}un.__maxMipLevel=pr.length-1}else{pr=gn.mipmaps;for(let _r=0;_r<6;_r++)if(Zn){c.texImage2D(34069+_r,0,Nn,cn[_r].width,cn[_r].height,0,Vt,yn,cn[_r].data);for(let jr=0;jr<pr.length;jr++){const ki=pr[jr].image[_r].image;c.texImage2D(34069+_r,jr+1,Nn,ki.width,ki.height,0,Vt,yn,ki.data)}}else{c.texImage2D(34069+_r,0,Nn,Vt,yn,cn[_r]);for(let jr=0;jr<pr.length;jr++)c.texImage2D(34069+_r,jr+1,Nn,Vt,yn,pr[jr].image[_r])}un.__maxMipLevel=pr.length}We(gn,Kt)&&tt(34067,gn,mt.width,mt.height),un.__version=gn.version,gn.onUpdate&&gn.onUpdate(gn)}(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(34067,rn.__webglTexture))}const Tt={[go]:10497,[Jr]:33071,[os]:33648},Yt={[Ir]:9728,[Va]:9984,[us]:9986,[ai]:9729,[Gc]:9985,[sl]:9987};function ct(rt,ut,rn){if(rn?(w.texParameteri(rt,10242,Tt[ut.wrapS]),w.texParameteri(rt,10243,Tt[ut.wrapT]),32879!==rt&&35866!==rt||w.texParameteri(rt,32882,Tt[ut.wrapR]),w.texParameteri(rt,10240,Yt[ut.magFilter]),w.texParameteri(rt,10241,Yt[ut.minFilter])):(w.texParameteri(rt,10242,33071),w.texParameteri(rt,10243,33071),32879!==rt&&35866!==rt||w.texParameteri(rt,32882,33071),ut.wrapS===Jr&&ut.wrapT===Jr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),w.texParameteri(rt,10240,ot(ut.magFilter)),w.texParameteri(rt,10241,ot(ut.minFilter)),ut.minFilter!==Ir&&ut.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const un=e.get("EXT_texture_filter_anisotropic");if(ut.type===Xo&&!1===e.has("OES_texture_float_linear")||!1===k&&ut.type===hs&&!1===e.has("OES_texture_half_float_linear"))return;(ut.anisotropy>1||d.get(ut).__currentAnisotropy)&&(w.texParameterf(rt,un.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ut.anisotropy,_.getMaxAnisotropy())),d.get(ut).__currentAnisotropy=ut.anisotropy)}}function Lt(rt,ut){void 0===rt.__webglInit&&(rt.__webglInit=!0,ut.addEventListener("dispose",st),rt.__webglTexture=w.createTexture(),L.memory.textures++)}function _t(rt,ut,rn){let un=3553;ut.isDataTexture2DArray&&(un=35866),ut.isDataTexture3D&&(un=32879),Lt(rt,ut),c.activeTexture(33984+rn),c.bindTexture(un,rt.__webglTexture),w.pixelStorei(37440,ut.flipY),w.pixelStorei(37441,ut.premultiplyAlpha),w.pixelStorei(3317,ut.unpackAlignment),w.pixelStorei(37443,0);const gn=(yn=ut,!k&&(yn.wrapS!==Jr||yn.wrapT!==Jr||yn.minFilter!==Ir&&yn.minFilter!==ai)&&!1===Ne(ut.image)),kn=Le(ut.image,gn,!1,te),Jn=Ne(kn)||k,Zn=S.convert(ut.format);var yn;let cn,mt=S.convert(ut.type),Kt=Ze(ut.internalFormat,Zn,mt);ct(un,ut,Jn);const Vt=ut.mipmaps;if(ut.isDepthTexture)Kt=6402,k?Kt=ut.type===Xo?36012:ut.type===Xs?33190:ut.type===Ts?35056:33189:ut.type===Xo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ut.format===To&&6402===Kt&&ut.type!==Hc&&ut.type!==Xs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ut.type=Hc,mt=S.convert(ut.type)),ut.format===Ys&&6402===Kt&&(Kt=34041,ut.type!==Ts&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ut.type=Ts,mt=S.convert(ut.type))),c.texImage2D(3553,0,Kt,kn.width,kn.height,0,Zn,mt,null);else if(ut.isDataTexture)if(Vt.length>0&&Jn){for(let yn=0,Nn=Vt.length;yn<Nn;yn++)cn=Vt[yn],c.texImage2D(3553,yn,Kt,cn.width,cn.height,0,Zn,mt,cn.data);ut.generateMipmaps=!1,rt.__maxMipLevel=Vt.length-1}else c.texImage2D(3553,0,Kt,kn.width,kn.height,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(ut.isCompressedTexture){for(let yn=0,Nn=Vt.length;yn<Nn;yn++)cn=Vt[yn],ut.format!==ao&&ut.format!==Os?null!==Zn?c.compressedTexImage2D(3553,yn,Kt,cn.width,cn.height,0,cn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(3553,yn,Kt,cn.width,cn.height,0,Zn,mt,cn.data);rt.__maxMipLevel=Vt.length-1}else if(ut.isDataTexture2DArray)c.texImage3D(35866,0,Kt,kn.width,kn.height,kn.depth,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(ut.isDataTexture3D)c.texImage3D(32879,0,Kt,kn.width,kn.height,kn.depth,0,Zn,mt,kn.data),rt.__maxMipLevel=0;else if(Vt.length>0&&Jn){for(let yn=0,Nn=Vt.length;yn<Nn;yn++)cn=Vt[yn],c.texImage2D(3553,yn,Kt,Zn,mt,cn);ut.generateMipmaps=!1,rt.__maxMipLevel=Vt.length-1}else c.texImage2D(3553,0,Kt,Zn,mt,kn),rt.__maxMipLevel=0;We(ut,Jn)&&tt(un,ut,kn.width,kn.height),rt.__version=ut.version,ut.onUpdate&&ut.onUpdate(ut)}function zt(rt,ut,rn,un,gn){const kn=S.convert(rn.format),Jn=S.convert(rn.type),Zn=Ze(rn.internalFormat,kn,Jn);32879===gn||35866===gn?c.texImage3D(gn,0,Zn,ut.width,ut.height,ut.depth,0,kn,Jn,null):c.texImage2D(gn,0,Zn,ut.width,ut.height,0,kn,Jn,null),c.bindFramebuffer(36160,rt),w.framebufferTexture2D(36160,un,gn,d.get(rn).__webglTexture,0),c.bindFramebuffer(36160,null)}function Rt(rt,ut,rn){if(w.bindRenderbuffer(36161,rt),ut.depthBuffer&&!ut.stencilBuffer){let un=33189;if(rn){const gn=ut.depthTexture;gn&&gn.isDepthTexture&&(gn.type===Xo?un=36012:gn.type===Xs&&(un=33190));const kn=nn(ut);w.renderbufferStorageMultisample(36161,kn,un,ut.width,ut.height)}else w.renderbufferStorage(36161,un,ut.width,ut.height);w.framebufferRenderbuffer(36160,36096,36161,rt)}else if(ut.depthBuffer&&ut.stencilBuffer){if(rn){const un=nn(ut);w.renderbufferStorageMultisample(36161,un,35056,ut.width,ut.height)}else w.renderbufferStorage(36161,34041,ut.width,ut.height);w.framebufferRenderbuffer(36160,33306,36161,rt)}else{const un=!0===ut.isWebGLMultipleRenderTargets?ut.texture[0]:ut.texture,gn=S.convert(un.format),kn=S.convert(un.type),Jn=Ze(un.internalFormat,gn,kn);if(rn){const Zn=nn(ut);w.renderbufferStorageMultisample(36161,Zn,Jn,ut.width,ut.height)}else w.renderbufferStorage(36161,Jn,ut.width,ut.height)}w.bindRenderbuffer(36161,null)}function nn(rt){return k&&rt.isWebGLMultisampleRenderTarget?Math.min(le,rt.samples):0}let en=!1,Mn=!1;this.allocateTextureUnit=function(){const rt=Ft;return rt>=F&&console.warn("THREE.WebGLTextures: Trying to use "+rt+" texture units while this GPU supports only "+F),Ft+=1,rt},this.resetTextureUnits=function(){Ft=0},this.setTexture2D=Qe,this.setTexture2DArray=function(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?_t(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(35866,rn.__webglTexture))},this.setTexture3D=function(rt,ut){const rn=d.get(rt);rt.version>0&&rn.__version!==rt.version?_t(rn,rt,ut):(c.activeTexture(33984+ut),c.bindTexture(32879,rn.__webglTexture))},this.setTextureCube=nt,this.setupRenderTarget=function(rt){const ut=rt.texture,rn=d.get(rt),un=d.get(ut);rt.addEventListener("dispose",Ct),!0!==rt.isWebGLMultipleRenderTargets&&(un.__webglTexture=w.createTexture(),un.__version=ut.version,L.memory.textures++);const gn=!0===rt.isWebGLCubeRenderTarget,kn=!0===rt.isWebGLMultipleRenderTargets,Jn=!0===rt.isWebGLMultisampleRenderTarget,Zn=ut.isDataTexture3D||ut.isDataTexture2DArray,cn=Ne(rt)||k;if(!k||ut.format!==Os||ut.type!==Xo&&ut.type!==hs||(ut.format=ao,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),gn){rn.__webglFramebuffer=[];for(let mt=0;mt<6;mt++)rn.__webglFramebuffer[mt]=w.createFramebuffer()}else if(rn.__webglFramebuffer=w.createFramebuffer(),kn)if(_.drawBuffers){const mt=rt.texture;for(let Kt=0,Vt=mt.length;Kt<Vt;Kt++){const yn=d.get(mt[Kt]);void 0===yn.__webglTexture&&(yn.__webglTexture=w.createTexture(),L.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Jn)if(k){rn.__webglMultisampledFramebuffer=w.createFramebuffer(),rn.__webglColorRenderbuffer=w.createRenderbuffer(),w.bindRenderbuffer(36161,rn.__webglColorRenderbuffer);const mt=S.convert(ut.format),Kt=S.convert(ut.type),Vt=Ze(ut.internalFormat,mt,Kt),yn=nn(rt);w.renderbufferStorageMultisample(36161,yn,Vt,rt.width,rt.height),c.bindFramebuffer(36160,rn.__webglMultisampledFramebuffer),w.framebufferRenderbuffer(36160,36064,36161,rn.__webglColorRenderbuffer),w.bindRenderbuffer(36161,null),rt.depthBuffer&&(rn.__webglDepthRenderbuffer=w.createRenderbuffer(),Rt(rn.__webglDepthRenderbuffer,rt,!0)),c.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(gn){c.bindTexture(34067,un.__webglTexture),ct(34067,ut,cn);for(let mt=0;mt<6;mt++)zt(rn.__webglFramebuffer[mt],rt,ut,36064,34069+mt);We(ut,cn)&&tt(34067,ut,rt.width,rt.height),c.unbindTexture()}else if(kn){const mt=rt.texture;for(let Kt=0,Vt=mt.length;Kt<Vt;Kt++){const yn=mt[Kt],Nn=d.get(yn);c.bindTexture(3553,Nn.__webglTexture),ct(3553,yn,cn),zt(rn.__webglFramebuffer,rt,yn,36064+Kt,3553),We(yn,cn)&&tt(3553,yn,rt.width,rt.height)}c.unbindTexture()}else{let mt=3553;Zn&&(k?mt=ut.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(mt,un.__webglTexture),ct(mt,ut,cn),zt(rn.__webglFramebuffer,rt,ut,36064,mt),We(ut,cn)&&tt(mt,ut,rt.width,rt.height,rt.depth),c.unbindTexture()}rt.depthBuffer&&function(mt){const Kt=d.get(mt),Vt=!0===mt.isWebGLCubeRenderTarget;if(mt.depthTexture){if(Vt)throw new Error("target.depthTexture not supported in Cube render targets");!function(yn,Nn){if(Nn&&Nn.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(36160,yn),!Nn.depthTexture||!Nn.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");d.get(Nn.depthTexture).__webglTexture&&Nn.depthTexture.image.width===Nn.width&&Nn.depthTexture.image.height===Nn.height||(Nn.depthTexture.image.width=Nn.width,Nn.depthTexture.image.height=Nn.height,Nn.depthTexture.needsUpdate=!0),Qe(Nn.depthTexture,0);const pr=d.get(Nn.depthTexture).__webglTexture;if(Nn.depthTexture.format===To)w.framebufferTexture2D(36160,36096,3553,pr,0);else{if(Nn.depthTexture.format!==Ys)throw new Error("Unknown depthTexture format");w.framebufferTexture2D(36160,33306,3553,pr,0)}}(Kt.__webglFramebuffer,mt)}else if(Vt){Kt.__webglDepthbuffer=[];for(let yn=0;yn<6;yn++)c.bindFramebuffer(36160,Kt.__webglFramebuffer[yn]),Kt.__webglDepthbuffer[yn]=w.createRenderbuffer(),Rt(Kt.__webglDepthbuffer[yn],mt,!1)}else c.bindFramebuffer(36160,Kt.__webglFramebuffer),Kt.__webglDepthbuffer=w.createRenderbuffer(),Rt(Kt.__webglDepthbuffer,mt,!1);c.bindFramebuffer(36160,null)}(rt)},this.updateRenderTargetMipmap=function(rt){const ut=Ne(rt)||k,rn=!0===rt.isWebGLMultipleRenderTargets?rt.texture:[rt.texture];for(let un=0,gn=rn.length;un<gn;un++){const kn=rn[un];if(We(kn,ut)){const Jn=rt.isWebGLCubeRenderTarget?34067:3553,Zn=d.get(kn).__webglTexture;c.bindTexture(Jn,Zn),tt(Jn,kn,rt.width,rt.height),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function(rt){if(rt.isWebGLMultisampleRenderTarget)if(k){const ut=rt.width,rn=rt.height;let un=16384;rt.depthBuffer&&(un|=256),rt.stencilBuffer&&(un|=1024);const gn=d.get(rt);c.bindFramebuffer(36008,gn.__webglMultisampledFramebuffer),c.bindFramebuffer(36009,gn.__webglFramebuffer),w.blitFramebuffer(0,0,ut,rn,0,0,ut,rn,un,9728),c.bindFramebuffer(36008,null),c.bindFramebuffer(36009,gn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(rt,ut){rt&&rt.isWebGLRenderTarget&&(!1===en&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),en=!0),rt=rt.texture),Qe(rt,ut)},this.safeSetTextureCube=function(rt,ut){rt&&rt.isWebGLCubeRenderTarget&&(!1===Mn&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Mn=!0),rt=rt.texture),nt(rt,ut)}}function Wd(w,e,c){const d=c.isWebGL2;return{convert:function(_){let S;if(_===ca)return 5121;if(_===Vu)return 32819;if(_===du)return 32820;if(_===fu)return 33635;if(_===Wl)return 5120;if(_===Wa)return 5122;if(_===Hc)return 5123;if(_===Hp)return 5124;if(_===Xs)return 5125;if(_===Xo)return 5126;if(_===hs)return d?5131:(S=e.get("OES_texture_half_float"),null!==S?S.HALF_FLOAT_OES:null);if(_===dp)return 6406;if(_===Os)return 6407;if(_===ao)return 6408;if(_===Vc)return 6409;if(_===Wu)return 6410;if(_===To)return 6402;if(_===Ys)return 34041;if(_===Vp)return 6403;if(_===ll)return 36244;if(_===mu)return 33319;if(_===fp)return 33320;if(_===mp)return 36248;if(_===yh)return 36249;if(_===Fh||_===mc||_===Dh||_===bh){if(S=e.get("WEBGL_compressed_texture_s3tc"),null===S)return null;if(_===Fh)return S.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===mc)return S.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===Dh)return S.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===bh)return S.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===Uh||_===Tl||_===Ml||_===ql){if(S=e.get("WEBGL_compressed_texture_pvrtc"),null===S)return null;if(_===Uh)return S.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===Tl)return S.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===Ml)return S.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===ql)return S.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===qu)return S=e.get("WEBGL_compressed_texture_etc1"),null!==S?S.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===ps||_===Xl)&&(S=e.get("WEBGL_compressed_texture_etc"),null!==S)){if(_===ps)return S.COMPRESSED_RGB8_ETC2;if(_===Xl)return S.COMPRESSED_RGBA8_ETC2_EAC}return _===Xu||_===_p||_===gp||_===Wc||_===_c||_===xh||_===vp||_===Yu||_===Ju||_===cl||_===zh||_===ul||_===jh||_===Zu||_===yc||_===wh||_===_u||_===qc||_===yp||_===Xc||_===Qu||_===Yl||_===bp||_===Gh||_===xp||_===wp||_===Hh||_===Wp?(S=e.get("WEBGL_compressed_texture_astc"),null!==S?_:null):_===vc?(S=e.get("EXT_texture_compression_bptc"),null!==S?_:null):_===Ts?d?34042:(S=e.get("WEBGL_depth_texture"),null!==S?S.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class zi extends Po{constructor(e=[]){super(),this.cameras=e}}zi.prototype.isArrayCamera=!0;class ln extends Pr{constructor(){super(),this.type="Group"}}ln.prototype.isGroup=!0;const Yp={type:"move"};class Zo{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new ln,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new ln,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ht,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ht),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new ln,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ht,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ht),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,c,d){let _=null,S=null,L=null;const k=this._targetRay,F=this._grip,V=this._hand;if(e&&"visible-blurred"!==c.session.visibilityState)if(null!==k&&(_=c.getPose(e.targetRaySpace,d),null!==_&&(k.matrix.fromArray(_.transform.matrix),k.matrix.decompose(k.position,k.rotation,k.scale),_.linearVelocity?(k.hasLinearVelocity=!0,k.linearVelocity.copy(_.linearVelocity)):k.hasLinearVelocity=!1,_.angularVelocity?(k.hasAngularVelocity=!0,k.angularVelocity.copy(_.angularVelocity)):k.hasAngularVelocity=!1,this.dispatchEvent(Yp))),V&&e.hand){L=!0;for(const $e of e.hand.values()){const Le=c.getJointPose($e,d);if(void 0===V.joints[$e.jointName]){const We=new ln;We.matrixAutoUpdate=!1,We.visible=!1,V.joints[$e.jointName]=We,V.add(We)}const Ne=V.joints[$e.jointName];null!==Le&&(Ne.matrix.fromArray(Le.transform.matrix),Ne.matrix.decompose(Ne.position,Ne.rotation,Ne.scale),Ne.jointRadius=Le.radius),Ne.visible=null!==Le}const ue=V.joints["index-finger-tip"].position.distanceTo(V.joints["thumb-tip"].position),_e=.02,Ee=.005;V.inputState.pinching&&ue>_e+Ee?(V.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!V.inputState.pinching&&ue<=_e-Ee&&(V.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==F&&e.gripSpace&&(S=c.getPose(e.gripSpace,d),null!==S&&(F.matrix.fromArray(S.transform.matrix),F.matrix.decompose(F.position,F.rotation,F.scale),S.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(S.linearVelocity)):F.hasLinearVelocity=!1,S.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(S.angularVelocity)):F.hasAngularVelocity=!1));return null!==k&&(k.visible=null!==_),null!==F&&(F.visible=null!==S),null!==V&&(V.visible=null!==L),this}}class $o extends ks{constructor(e,c){super();const d=this,_=e.state;let S=null,L=1,k=null,F="local-floor",V=null,te=null,le=null,ue=null,_e=null,Ee=!1,$e=null,Le=null,Ne=null,We=null,tt=null,Ze=null;const ot=[],st=new Map,Ct=new Po;Ct.layers.enable(1),Ct.viewport=new Di;const Ft=new Po;Ft.layers.enable(2),Ft.viewport=new Di;const Qe=[Ct,Ft],nt=new zi;nt.layers.enable(1),nt.layers.enable(2);let Tt=null,Yt=null;function ct(rt){const ut=st.get(rt.inputSource);ut&&ut.dispatchEvent({type:rt.type,data:rt.inputSource})}function Lt(){st.forEach(function(rt,ut){rt.disconnect(ut)}),st.clear(),Tt=null,Yt=null,_.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),le&&c.deleteFramebuffer(le),$e&&c.deleteFramebuffer($e),Le&&c.deleteRenderbuffer(Le),Ne&&c.deleteRenderbuffer(Ne),le=null,$e=null,Le=null,Ne=null,_e=null,ue=null,te=null,S=null,Mn.stop(),d.isPresenting=!1,d.dispatchEvent({type:"sessionend"})}function _t(rt){const ut=S.inputSources;for(let rn=0;rn<ot.length;rn++)st.set(ut[rn],ot[rn]);for(let rn=0;rn<rt.removed.length;rn++){const un=rt.removed[rn],gn=st.get(un);gn&&(gn.dispatchEvent({type:"disconnected",data:un}),st.delete(un))}for(let rn=0;rn<rt.added.length;rn++){const un=rt.added[rn],gn=st.get(un);gn&&gn.dispatchEvent({type:"connected",data:un})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getTargetRaySpace()},this.getControllerGrip=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getGripSpace()},this.getHand=function(rt){let ut=ot[rt];return void 0===ut&&(ut=new Zo,ot[rt]=ut),ut.getHandSpace()},this.setFramebufferScaleFactor=function(rt){L=rt,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(rt){F=rt,!0===d.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return k},this.getBaseLayer=function(){return null!==ue?ue:_e},this.getBinding=function(){return te},this.getFrame=function(){return We},this.getSession=function(){return S},this.setSession=async function(rt){if(S=rt,null!==S){S.addEventListener("select",ct),S.addEventListener("selectstart",ct),S.addEventListener("selectend",ct),S.addEventListener("squeeze",ct),S.addEventListener("squeezestart",ct),S.addEventListener("squeezeend",ct),S.addEventListener("end",Lt),S.addEventListener("inputsourceschange",_t);const ut=c.getContextAttributes();if(!0!==ut.xrCompatible&&await c.makeXRCompatible(),void 0===S.renderState.layers)_e=new XRWebGLLayer(S,c,{antialias:ut.antialias,alpha:ut.alpha,depth:ut.depth,stencil:ut.stencil,framebufferScaleFactor:L}),S.updateRenderState({baseLayer:_e});else if(c instanceof WebGLRenderingContext)_e=new XRWebGLLayer(S,c,{antialias:!0,alpha:ut.alpha,depth:ut.depth,stencil:ut.stencil,framebufferScaleFactor:L}),S.updateRenderState({layers:[_e]});else{Ee=ut.antialias;let rn=null;ut.depth&&(Ze=256,ut.stencil&&(Ze|=1024),tt=ut.stencil?33306:36096,rn=ut.stencil?35056:33190);const un={colorFormat:ut.alpha?32856:32849,depthFormat:rn,scaleFactor:L};te=new XRWebGLBinding(S,c),ue=te.createProjectionLayer(un),le=c.createFramebuffer(),S.updateRenderState({layers:[ue]}),Ee&&($e=c.createFramebuffer(),Le=c.createRenderbuffer(),c.bindRenderbuffer(36161,Le),c.renderbufferStorageMultisample(36161,4,32856,ue.textureWidth,ue.textureHeight),_.bindFramebuffer(36160,$e),c.framebufferRenderbuffer(36160,36064,36161,Le),c.bindRenderbuffer(36161,null),null!==rn&&(Ne=c.createRenderbuffer(),c.bindRenderbuffer(36161,Ne),c.renderbufferStorageMultisample(36161,4,rn,ue.textureWidth,ue.textureHeight),c.framebufferRenderbuffer(36160,tt,36161,Ne),c.bindRenderbuffer(36161,null)),_.bindFramebuffer(36160,null))}k=await S.requestReferenceSpace(F),Mn.setContext(S),Mn.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"})}};const zt=new ht,Rt=new ht;function nn(rt,ut){null===ut?rt.matrixWorld.copy(rt.matrix):rt.matrixWorld.multiplyMatrices(ut.matrixWorld,rt.matrix),rt.matrixWorldInverse.copy(rt.matrixWorld).invert()}this.updateCamera=function(rt){if(null===S)return;nt.near=Ft.near=Ct.near=rt.near,nt.far=Ft.far=Ct.far=rt.far,Tt===nt.near&&Yt===nt.far||(S.updateRenderState({depthNear:nt.near,depthFar:nt.far}),Tt=nt.near,Yt=nt.far);const ut=rt.parent,rn=nt.cameras;nn(nt,ut);for(let gn=0;gn<rn.length;gn++)nn(rn[gn],ut);nt.matrixWorld.decompose(nt.position,nt.quaternion,nt.scale),rt.position.copy(nt.position),rt.quaternion.copy(nt.quaternion),rt.scale.copy(nt.scale),rt.matrix.copy(nt.matrix),rt.matrixWorld.copy(nt.matrixWorld);const un=rt.children;for(let gn=0,kn=un.length;gn<kn;gn++)un[gn].updateMatrixWorld(!0);2===rn.length?function(gn,kn,Jn){zt.setFromMatrixPosition(kn.matrixWorld),Rt.setFromMatrixPosition(Jn.matrixWorld);const Zn=zt.distanceTo(Rt),cn=kn.projectionMatrix.elements,mt=Jn.projectionMatrix.elements,Kt=cn[14]/(cn[10]-1),Vt=cn[14]/(cn[10]+1),yn=(cn[9]+1)/cn[5],Nn=(cn[9]-1)/cn[5],pr=(cn[8]-1)/cn[0],_r=(mt[8]+1)/mt[0],jr=Kt*pr,ki=Kt*_r,mo=Zn/(-pr+_r),El=mo*-pr;kn.matrixWorld.decompose(gn.position,gn.quaternion,gn.scale),gn.translateX(El),gn.translateZ(mo),gn.matrixWorld.compose(gn.position,gn.quaternion,gn.scale),gn.matrixWorldInverse.copy(gn.matrixWorld).invert();const zo=Kt+mo,Ma=Vt+mo;gn.projectionMatrix.makePerspective(jr-El,ki+(Zn-El),yn*Vt/Ma*zo,Nn*Vt/Ma*zo,zo,Ma)}(nt,Ct,Ft):nt.projectionMatrix.copy(Ct.projectionMatrix)},this.getCamera=function(){return nt},this.getFoveation=function(){return null!==ue?ue.fixedFoveation:null!==_e?_e.fixedFoveation:void 0},this.setFoveation=function(rt){null!==ue&&(ue.fixedFoveation=rt),null!==_e&&void 0!==_e.fixedFoveation&&(_e.fixedFoveation=rt)};let en=null;const Mn=new Nc;Mn.setAnimationLoop(function(rt,ut){if(V=ut.getViewerPose(k),We=ut,null!==V){const un=V.views;null!==_e&&_.bindXRFramebuffer(_e.framebuffer);let gn=!1;un.length!==nt.cameras.length&&(nt.cameras.length=0,gn=!0);for(let kn=0;kn<un.length;kn++){const Jn=un[kn];let Zn=null;if(null!==_e)Zn=_e.getViewport(Jn);else{const mt=te.getViewSubImage(ue,Jn);_.bindXRFramebuffer(le),void 0!==mt.depthStencilTexture&&c.framebufferTexture2D(36160,tt,3553,mt.depthStencilTexture,0),c.framebufferTexture2D(36160,36064,3553,mt.colorTexture,0),Zn=mt.viewport}const cn=Qe[kn];cn.matrix.fromArray(Jn.transform.matrix),cn.projectionMatrix.fromArray(Jn.projectionMatrix),cn.viewport.set(Zn.x,Zn.y,Zn.width,Zn.height),0===kn&&nt.matrix.copy(cn.matrix),!0===gn&&nt.cameras.push(cn)}Ee&&(_.bindXRFramebuffer($e),null!==Ze&&c.clear(Ze))}const rn=S.inputSources;for(let un=0;un<ot.length;un++)ot[un].update(rn[un],ut,k);if(en&&en(rt,ut),Ee){const un=ue.textureWidth,gn=ue.textureHeight;_.bindFramebuffer(36008,$e),_.bindFramebuffer(36009,le),c.invalidateFramebuffer(36008,[tt]),c.invalidateFramebuffer(36009,[tt]),c.blitFramebuffer(0,0,un,gn,0,0,un,gn,16384,9728),c.invalidateFramebuffer(36008,[36064]),_.bindFramebuffer(36008,null),_.bindFramebuffer(36009,null),_.bindFramebuffer(36160,$e)}We=null}),this.setAnimationLoop=function(rt){en=rt},this.dispose=function(){}}}function sm(w){function e(d,_){d.opacity.value=_.opacity,_.color&&d.diffuse.value.copy(_.color),_.emissive&&d.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(d.map.value=_.map),_.alphaMap&&(d.alphaMap.value=_.alphaMap),_.specularMap&&(d.specularMap.value=_.specularMap),_.alphaTest>0&&(d.alphaTest.value=_.alphaTest);const S=w.get(_).envMap;if(S){d.envMap.value=S,d.flipEnvMap.value=S.isCubeTexture&&!1===S.isRenderTargetTexture?-1:1,d.reflectivity.value=_.reflectivity,d.ior.value=_.ior,d.refractionRatio.value=_.refractionRatio;const F=w.get(S).__maxMipLevel;void 0!==F&&(d.maxMipLevel.value=F)}let L,k;_.lightMap&&(d.lightMap.value=_.lightMap,d.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(d.aoMap.value=_.aoMap,d.aoMapIntensity.value=_.aoMapIntensity),_.map?L=_.map:_.specularMap?L=_.specularMap:_.displacementMap?L=_.displacementMap:_.normalMap?L=_.normalMap:_.bumpMap?L=_.bumpMap:_.roughnessMap?L=_.roughnessMap:_.metalnessMap?L=_.metalnessMap:_.alphaMap?L=_.alphaMap:_.emissiveMap?L=_.emissiveMap:_.clearcoatMap?L=_.clearcoatMap:_.clearcoatNormalMap?L=_.clearcoatNormalMap:_.clearcoatRoughnessMap?L=_.clearcoatRoughnessMap:_.specularIntensityMap?L=_.specularIntensityMap:_.specularTintMap?L=_.specularTintMap:_.transmissionMap?L=_.transmissionMap:_.thicknessMap&&(L=_.thicknessMap),void 0!==L&&(L.isWebGLRenderTarget&&(L=L.texture),!0===L.matrixAutoUpdate&&L.updateMatrix(),d.uvTransform.value.copy(L.matrix)),_.aoMap?k=_.aoMap:_.lightMap&&(k=_.lightMap),void 0!==k&&(k.isWebGLRenderTarget&&(k=k.texture),!0===k.matrixAutoUpdate&&k.updateMatrix(),d.uv2Transform.value.copy(k.matrix))}function c(d,_){d.roughness.value=_.roughness,d.metalness.value=_.metalness,_.roughnessMap&&(d.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(d.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(d.emissiveMap.value=_.emissiveMap),_.bumpMap&&(d.bumpMap.value=_.bumpMap,d.bumpScale.value=_.bumpScale,_.side===W&&(d.bumpScale.value*=-1)),_.normalMap&&(d.normalMap.value=_.normalMap,d.normalScale.value.copy(_.normalScale),_.side===W&&d.normalScale.value.negate()),_.displacementMap&&(d.displacementMap.value=_.displacementMap,d.displacementScale.value=_.displacementScale,d.displacementBias.value=_.displacementBias),w.get(_).envMap&&(d.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(d,_){d.fogColor.value.copy(_.color),_.isFog?(d.fogNear.value=_.near,d.fogFar.value=_.far):_.isFogExp2&&(d.fogDensity.value=_.density)},refreshMaterialUniforms:function(d,_,S,L,k){var V;_.isMeshBasicMaterial?e(d,_):_.isMeshLambertMaterial?(e(d,_),(V=_).emissiveMap&&(d.emissiveMap.value=V.emissiveMap)):_.isMeshToonMaterial?(e(d,_),function(F,V){V.gradientMap&&(F.gradientMap.value=V.gradientMap),V.emissiveMap&&(F.emissiveMap.value=V.emissiveMap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===W&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===W&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshPhongMaterial?(e(d,_),function(F,V){F.specular.value.copy(V.specular),F.shininess.value=Math.max(V.shininess,1e-4),V.emissiveMap&&(F.emissiveMap.value=V.emissiveMap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===W&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===W&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshStandardMaterial?(e(d,_),_.isMeshPhysicalMaterial?function(F,V,te){c(F,V),F.ior.value=V.ior,V.sheenTint&&F.sheenTint.value.copy(V.sheenTint),V.clearcoat>0&&(F.clearcoat.value=V.clearcoat,F.clearcoatRoughness.value=V.clearcoatRoughness,V.clearcoatMap&&(F.clearcoatMap.value=V.clearcoatMap),V.clearcoatRoughnessMap&&(F.clearcoatRoughnessMap.value=V.clearcoatRoughnessMap),V.clearcoatNormalMap&&(F.clearcoatNormalScale.value.copy(V.clearcoatNormalScale),F.clearcoatNormalMap.value=V.clearcoatNormalMap,V.side===W&&F.clearcoatNormalScale.value.negate())),V.transmission>0&&(F.transmission.value=V.transmission,F.transmissionSamplerMap.value=te.texture,F.transmissionSamplerSize.value.set(te.width,te.height),V.transmissionMap&&(F.transmissionMap.value=V.transmissionMap),F.thickness.value=V.thickness,V.thicknessMap&&(F.thicknessMap.value=V.thicknessMap),F.attenuationDistance.value=V.attenuationDistance,F.attenuationTint.value.copy(V.attenuationTint)),F.specularIntensity.value=V.specularIntensity,F.specularTint.value.copy(V.specularTint),V.specularIntensityMap&&(F.specularIntensityMap.value=V.specularIntensityMap),V.specularTintMap&&(F.specularTintMap.value=V.specularTintMap)}(d,_,k):c(d,_)):_.isMeshMatcapMaterial?(e(d,_),function(F,V){V.matcap&&(F.matcap.value=V.matcap),V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===W&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===W&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshDepthMaterial?(e(d,_),function(F,V){V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isMeshDistanceMaterial?(e(d,_),function(F,V){V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias),F.referencePosition.value.copy(V.referencePosition),F.nearDistance.value=V.nearDistance,F.farDistance.value=V.farDistance}(d,_)):_.isMeshNormalMaterial?(e(d,_),function(F,V){V.bumpMap&&(F.bumpMap.value=V.bumpMap,F.bumpScale.value=V.bumpScale,V.side===W&&(F.bumpScale.value*=-1)),V.normalMap&&(F.normalMap.value=V.normalMap,F.normalScale.value.copy(V.normalScale),V.side===W&&F.normalScale.value.negate()),V.displacementMap&&(F.displacementMap.value=V.displacementMap,F.displacementScale.value=V.displacementScale,F.displacementBias.value=V.displacementBias)}(d,_)):_.isLineBasicMaterial?(function(F,V){F.diffuse.value.copy(V.color),F.opacity.value=V.opacity}(d,_),_.isLineDashedMaterial&&function(F,V){F.dashSize.value=V.dashSize,F.totalSize.value=V.dashSize+V.gapSize,F.scale.value=V.scale}(d,_)):_.isPointsMaterial?function(F,V,te,le){let ue;F.diffuse.value.copy(V.color),F.opacity.value=V.opacity,F.size.value=V.size*te,F.scale.value=.5*le,V.map&&(F.map.value=V.map),V.alphaMap&&(F.alphaMap.value=V.alphaMap),V.alphaTest>0&&(F.alphaTest.value=V.alphaTest),V.map?ue=V.map:V.alphaMap&&(ue=V.alphaMap),void 0!==ue&&(!0===ue.matrixAutoUpdate&&ue.updateMatrix(),F.uvTransform.value.copy(ue.matrix))}(d,_,S,L):_.isSpriteMaterial?function(F,V){let te;F.diffuse.value.copy(V.color),F.opacity.value=V.opacity,F.rotation.value=V.rotation,V.map&&(F.map.value=V.map),V.alphaMap&&(F.alphaMap.value=V.alphaMap),V.alphaTest>0&&(F.alphaTest.value=V.alphaTest),V.map?te=V.map:V.alphaMap&&(te=V.alphaMap),void 0!==te&&(!0===te.matrixAutoUpdate&&te.updateMatrix(),F.uvTransform.value.copy(te.matrix))}(d,_):_.isShadowMaterial?(d.color.value.copy(_.color),d.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function Yi(w={}){const e=void 0!==w.canvas?w.canvas:function(){const vt=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return vt.style.display="block",vt}(),c=void 0!==w.context?w.context:null,d=void 0!==w.alpha&&w.alpha,_=void 0===w.depth||w.depth,S=void 0===w.stencil||w.stencil,L=void 0!==w.antialias&&w.antialias,k=void 0===w.premultipliedAlpha||w.premultipliedAlpha,F=void 0!==w.preserveDrawingBuffer&&w.preserveDrawingBuffer,V=void 0!==w.powerPreference?w.powerPreference:"default",te=void 0!==w.failIfMajorPerformanceCaveat&&w.failIfMajorPerformanceCaveat;let le=null,ue=null;const _e=[],Ee=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ji,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1;const $e=this;let Le=!1,Ne=0,We=0,tt=null,Ze=-1,ot=null;const st=new Di,Ct=new Di;let Ft=null,Qe=e.width,nt=e.height,Tt=1,Yt=null,ct=null;const Lt=new Di(0,0,Qe,nt),_t=new Di(0,0,Qe,nt);let zt=!1;const Rt=[],nn=new Fr;let en=!1,Mn=!1,rt=null;const ut=new tn,rn=new ht,un={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function gn(){return null===tt?Tt:1}let kn,Jn,Zn,cn,mt,Kt,Vt,yn,Nn,pr,_r,jr,ki,mo,El,zo,Ma,ju,Ld,Bd,Oh,gh,Et,Ht=c;function vn(vt,wn){for(let an=0;an<vt.length;an++){const Wn=e.getContext(vt[an],wn);if(null!==Wn)return Wn}return null}try{const vt={alpha:d,depth:_,stencil:S,antialias:L,premultipliedAlpha:k,preserveDrawingBuffer:F,powerPreference:V,failIfMajorPerformanceCaveat:te};if(e.addEventListener("webglcontextlost",Mi,!1),e.addEventListener("webglcontextrestored",Fi,!1),null===Ht){const wn=["webgl2","webgl","experimental-webgl"];if(!0===$e.isWebGL1Renderer&&wn.shift(),Ht=vn(wn,vt),null===Ht)throw vn(wn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ht.getShaderPrecisionFormat&&(Ht.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(vt){throw console.error("THREE.WebGLRenderer: "+vt.message),vt}function Dn(){kn=new Gn(Ht),Jn=new nu(Ht,kn,w),kn.init(Jn),gh=new Wd(Ht,kn,Jn),Zn=new mf(Ht,kn,Jn),Rt[0]=1029,cn=new Lr(Ht),mt=new Gd,Kt=new Cu(Ht,kn,Zn,mt,Jn,gh,cn),Vt=new vl($e),yn=new Tn($e),Nn=new qp(Ht,Jn),Et=new Mo(Ht,kn,Nn,Jn),pr=new Cr(Ht,Nn,cn,Et),_r=new el(Ht,pr,Nn,cn),Ld=new ic(Ht),zo=new Tu(mt),jr=new Pp($e,Vt,yn,kn,Jn,Et,zo),ki=new sm(mt),mo=new pf(mt),El=new df(kn,Jn),ju=new tu($e,Vt,Zn,_r,k),Ma=new om($e,_r,Jn),Bd=new Vn(Ht,kn,cn,Jn),Oh=new Dr(Ht,kn,cn,Jn),cn.programs=jr.programs,$e.capabilities=Jn,$e.extensions=kn,$e.properties=mt,$e.renderLists=mo,$e.shadowMap=Ma,$e.state=Zn,$e.info=cn}Dn();const tr=new $o($e,Ht);function Mi(vt){vt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Le=!0}function Fi(){console.log("THREE.WebGLRenderer: Context Restored."),Le=!1;const vt=cn.autoReset,wn=Ma.enabled,an=Ma.autoUpdate,$n=Ma.needsUpdate,Wn=Ma.type;Dn(),cn.autoReset=vt,Ma.enabled=wn,Ma.autoUpdate=an,Ma.needsUpdate=$n,Ma.type=Wn}function oi(vt){const wn=vt.target;var an;wn.removeEventListener("dispose",oi),function($n){const Wn=mt.get($n).programs;void 0!==Wn&&Wn.forEach(function(Si){jr.releaseProgram(Si)})}(an=wn),mt.remove(an)}this.xr=tr,this.getContext=function(){return Ht},this.getContextAttributes=function(){return Ht.getContextAttributes()},this.forceContextLoss=function(){const vt=kn.get("WEBGL_lose_context");vt&&vt.loseContext()},this.forceContextRestore=function(){const vt=kn.get("WEBGL_lose_context");vt&&vt.restoreContext()},this.getPixelRatio=function(){return Tt},this.setPixelRatio=function(vt){void 0!==vt&&(Tt=vt,this.setSize(Qe,nt,!1))},this.getSize=function(vt){return vt.set(Qe,nt)},this.setSize=function(vt,wn,an){tr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Qe=vt,nt=wn,e.width=Math.floor(vt*Tt),e.height=Math.floor(wn*Tt),!1!==an&&(e.style.width=vt+"px",e.style.height=wn+"px"),this.setViewport(0,0,vt,wn))},this.getDrawingBufferSize=function(vt){return vt.set(Qe*Tt,nt*Tt).floor()},this.setDrawingBufferSize=function(vt,wn,an){Qe=vt,nt=wn,Tt=an,e.width=Math.floor(vt*an),e.height=Math.floor(wn*an),this.setViewport(0,0,vt,wn)},this.getCurrentViewport=function(vt){return vt.copy(st)},this.getViewport=function(vt){return vt.copy(Lt)},this.setViewport=function(vt,wn,an,$n){vt.isVector4?Lt.set(vt.x,vt.y,vt.z,vt.w):Lt.set(vt,wn,an,$n),Zn.viewport(st.copy(Lt).multiplyScalar(Tt).floor())},this.getScissor=function(vt){return vt.copy(_t)},this.setScissor=function(vt,wn,an,$n){vt.isVector4?_t.set(vt.x,vt.y,vt.z,vt.w):_t.set(vt,wn,an,$n),Zn.scissor(Ct.copy(_t).multiplyScalar(Tt).floor())},this.getScissorTest=function(){return zt},this.setScissorTest=function(vt){Zn.setScissorTest(zt=vt)},this.setOpaqueSort=function(vt){Yt=vt},this.setTransparentSort=function(vt){ct=vt},this.getClearColor=function(vt){return vt.copy(ju.getClearColor())},this.setClearColor=function(){ju.setClearColor.apply(ju,arguments)},this.getClearAlpha=function(){return ju.getClearAlpha()},this.setClearAlpha=function(){ju.setClearAlpha.apply(ju,arguments)},this.clear=function(vt,wn,an){let $n=0;(void 0===vt||vt)&&($n|=16384),(void 0===wn||wn)&&($n|=256),(void 0===an||an)&&($n|=1024),Ht.clear($n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Mi,!1),e.removeEventListener("webglcontextrestored",Fi,!1),mo.dispose(),El.dispose(),mt.dispose(),Vt.dispose(),yn.dispose(),_r.dispose(),Et.dispose(),tr.dispose(),tr.removeEventListener("sessionstart",oa),tr.removeEventListener("sessionend",sa),rt&&(rt.dispose(),rt=null),jo.stop()},this.renderBufferImmediate=function(vt,wn){Et.initAttributes();const an=mt.get(vt);vt.hasPositions&&!an.position&&(an.position=Ht.createBuffer()),vt.hasNormals&&!an.normal&&(an.normal=Ht.createBuffer()),vt.hasUvs&&!an.uv&&(an.uv=Ht.createBuffer()),vt.hasColors&&!an.color&&(an.color=Ht.createBuffer());const $n=wn.getAttributes();vt.hasPositions&&(Ht.bindBuffer(34962,an.position),Ht.bufferData(34962,vt.positionArray,35048),Et.enableAttribute($n.position.location),Ht.vertexAttribPointer($n.position.location,3,5126,!1,0,0)),vt.hasNormals&&(Ht.bindBuffer(34962,an.normal),Ht.bufferData(34962,vt.normalArray,35048),Et.enableAttribute($n.normal.location),Ht.vertexAttribPointer($n.normal.location,3,5126,!1,0,0)),vt.hasUvs&&(Ht.bindBuffer(34962,an.uv),Ht.bufferData(34962,vt.uvArray,35048),Et.enableAttribute($n.uv.location),Ht.vertexAttribPointer($n.uv.location,2,5126,!1,0,0)),vt.hasColors&&(Ht.bindBuffer(34962,an.color),Ht.bufferData(34962,vt.colorArray,35048),Et.enableAttribute($n.color.location),Ht.vertexAttribPointer($n.color.location,3,5126,!1,0,0)),Et.disableUnusedAttributes(),Ht.drawArrays(4,0,vt.count),vt.count=0},this.renderBufferDirect=function(vt,wn,an,$n,Wn,Si){null===wn&&(wn=un);const Gr=Wn.isMesh&&Wn.matrixWorld.determinant()<0,Li=nf(vt,wn,$n,Wn);Zn.setMaterial($n,Gr);let to=an.index;const Es=an.attributes.position;if(null===to){if(void 0===Es||0===Es.count)return}else if(0===to.count)return;let Go,no=1;!0===$n.wireframe&&(to=pr.getWireframeAttribute(an),no=2),void 0===an.morphAttributes.position&&void 0===an.morphAttributes.normal||Ld.update(Wn,an,$n,Li),Et.setup(Wn,$n,Li,an,to);let Bi=Bd;null!==to&&(Go=Nn.get(to),Bi=Oh,Bi.setIndex(Go));const Gf=null!==to?to.count:Es.count,ol=an.drawRange.start*no,Tf=an.drawRange.count*no,sd=null!==Si?Si.start*no:0,Hf=null!==Si?Si.count*no:1/0,Mf=Math.max(ol,sd),jc=Math.min(Gf,ol+Tf,sd+Hf)-1,Nd=Math.max(0,jc-Mf+1);if(0!==Nd){if(Wn.isMesh)!0===$n.wireframe?(Zn.setLineWidth($n.wireframeLinewidth*gn()),Bi.setMode(1)):Bi.setMode(4);else if(Wn.isLine){let Gu=$n.linewidth;void 0===Gu&&(Gu=1),Zn.setLineWidth(Gu*gn()),Bi.setMode(Wn.isLineSegments?1:Wn.isLineLoop?2:3)}else Wn.isPoints?Bi.setMode(0):Wn.isSprite&&Bi.setMode(4);if(Wn.isInstancedMesh)Bi.renderInstances(Mf,Nd,Wn.count);else if(an.isInstancedBufferGeometry){const Gu=Math.min(an.instanceCount,an._maxInstanceCount);Bi.renderInstances(Mf,Nd,Gu)}else Bi.render(Mf,Nd)}},this.compile=function(vt,wn){ue=El.get(vt),ue.init(),Ee.push(ue),vt.traverseVisible(function(an){an.isLight&&an.layers.test(wn.layers)&&(ue.pushLight(an),an.castShadow&&ue.pushShadow(an))}),ue.setupLights($e.physicallyCorrectLights),vt.traverse(function(an){const $n=an.material;if($n)if(Array.isArray($n))for(let Wn=0;Wn<$n.length;Wn++)zc($n[Wn],vt,an);else zc($n,vt,an)}),Ee.pop(),ue=null};let cs=null;function oa(){jo.stop()}function sa(){jo.start()}const jo=new Nc;function Vi(vt,wn,an,$n){if(!1===vt.visible)return;if(vt.layers.test(wn.layers))if(vt.isGroup)an=vt.renderOrder;else if(vt.isLOD)!0===vt.autoUpdate&&vt.update(wn);else if(vt.isLight)ue.pushLight(vt),vt.castShadow&&ue.pushShadow(vt);else if(vt.isSprite){if(!vt.frustumCulled||nn.intersectsSprite(vt)){$n&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut);const Si=_r.update(vt),Gr=vt.material;Gr.visible&&le.push(vt,Si,Gr,an,rn.z,null)}}else if(vt.isImmediateRenderObject)$n&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut),le.push(vt,null,vt.material,an,rn.z,null);else if((vt.isMesh||vt.isLine||vt.isPoints)&&(vt.isSkinnedMesh&&vt.skeleton.frame!==cn.render.frame&&(vt.skeleton.update(),vt.skeleton.frame=cn.render.frame),!vt.frustumCulled||nn.intersectsObject(vt))){$n&&rn.setFromMatrixPosition(vt.matrixWorld).applyMatrix4(ut);const Si=_r.update(vt),Gr=vt.material;if(Array.isArray(Gr)){const Li=Si.groups;for(let to=0,Es=Li.length;to<Es;to++){const Go=Li[to],no=Gr[Go.materialIndex];no&&no.visible&&le.push(vt,Si,no,an,rn.z,Go)}}else Gr.visible&&le.push(vt,Si,Gr,an,rn.z,null)}const Wn=vt.children;for(let Si=0,Gr=Wn.length;Si<Gr;Si++)Vi(Wn[Si],wn,an,$n)}function aa(vt,wn,an,$n){const Wn=vt.opaque,Si=vt.transmissive,Gr=vt.transparent;ue.setupLightsView(an),Si.length>0&&function(Li,to,Es){null===rt&&(rt=new(!0===L&&!0===Jn.isWebGL2?Jc:ro)(1024,1024,{generateMipmaps:!0,type:null!==gh.convert(hs)?hs:ca,minFilter:sl,magFilter:Ir,wrapS:Jr,wrapT:Jr}));const Go=$e.getRenderTarget();$e.setRenderTarget(rt),$e.clear();const no=$e.toneMapping;$e.toneMapping=vr,Aa(Li,to,Es),$e.toneMapping=no,Kt.updateMultisampleRenderTarget(rt),Kt.updateRenderTargetMipmap(rt),$e.setRenderTarget(Go)}(Wn,wn,an),$n&&Zn.viewport(st.copy($n)),Wn.length>0&&Aa(Wn,wn,an),Si.length>0&&Aa(Si,wn,an),Gr.length>0&&Aa(Gr,wn,an)}function Aa(vt,wn,an){const $n=!0===wn.isScene?wn.overrideMaterial:null;for(let Wn=0,Si=vt.length;Wn<Si;Wn++){const Gr=vt[Wn],Li=Gr.object,to=Gr.geometry,Es=null===$n?Gr.material:$n,Go=Gr.group;Li.layers.test(an.layers)&&is(Li,wn,an,to,Es,Go)}}function is(vt,wn,an,$n,Wn,Si){if(vt.onBeforeRender($e,wn,an,$n,Wn,Si),vt.modelViewMatrix.multiplyMatrices(an.matrixWorldInverse,vt.matrixWorld),vt.normalMatrix.getNormalMatrix(vt.modelViewMatrix),vt.isImmediateRenderObject){const Gr=nf(an,wn,Wn,vt);Zn.setMaterial(Wn),Et.reset(),to=Gr,vt.render(function(Es){$e.renderBufferImmediate(Es,to)})}else!0===Wn.transparent&&Wn.side===Z?(Wn.side=W,Wn.needsUpdate=!0,$e.renderBufferDirect(an,wn,$n,Wn,vt,Si),Wn.side=ae,Wn.needsUpdate=!0,$e.renderBufferDirect(an,wn,$n,Wn,vt,Si),Wn.side=Z):$e.renderBufferDirect(an,wn,$n,Wn,vt,Si);var to;vt.onAfterRender($e,wn,an,$n,Wn,Si)}function zc(vt,wn,an){!0!==wn.isScene&&(wn=un);const $n=mt.get(vt),Wn=ue.state.lights,Gr=Wn.state.version,Li=jr.getParameters(vt,Wn.state,ue.state.shadowsArray,wn,an),to=jr.getProgramCacheKey(Li);let Es=$n.programs;$n.environment=vt.isMeshStandardMaterial?wn.environment:null,$n.fog=wn.fog,$n.envMap=(vt.isMeshStandardMaterial?yn:Vt).get(vt.envMap||$n.environment),void 0===Es&&(vt.addEventListener("dispose",oi),Es=new Map,$n.programs=Es);let Go=Es.get(to);if(void 0!==Go){if($n.currentProgram===Go&&$n.lightsStateVersion===Gr)return Vl(vt,Li),Go}else Li.uniforms=jr.getUniforms(vt),vt.onBuild(Li,$e),vt.onBeforeCompile(Li,$e),Go=jr.acquireProgram(Li,to),Es.set(to,Go),$n.uniforms=Li.uniforms;const no=$n.uniforms;var ol;(vt.isShaderMaterial||vt.isRawShaderMaterial)&&!0!==vt.clipping||(no.clippingPlanes=zo.uniform),Vl(vt,Li),$n.needsLights=(ol=vt).isMeshLambertMaterial||ol.isMeshToonMaterial||ol.isMeshPhongMaterial||ol.isMeshStandardMaterial||ol.isShadowMaterial||ol.isShaderMaterial&&!0===ol.lights,$n.lightsStateVersion=Gr,$n.needsLights&&(no.ambientLightColor.value=Wn.state.ambient,no.lightProbe.value=Wn.state.probe,no.directionalLights.value=Wn.state.directional,no.directionalLightShadows.value=Wn.state.directionalShadow,no.spotLights.value=Wn.state.spot,no.spotLightShadows.value=Wn.state.spotShadow,no.rectAreaLights.value=Wn.state.rectArea,no.ltc_1.value=Wn.state.rectAreaLTC1,no.ltc_2.value=Wn.state.rectAreaLTC2,no.pointLights.value=Wn.state.point,no.pointLightShadows.value=Wn.state.pointShadow,no.hemisphereLights.value=Wn.state.hemi,no.directionalShadowMap.value=Wn.state.directionalShadowMap,no.directionalShadowMatrix.value=Wn.state.directionalShadowMatrix,no.spotShadowMap.value=Wn.state.spotShadowMap,no.spotShadowMatrix.value=Wn.state.spotShadowMatrix,no.pointShadowMap.value=Wn.state.pointShadowMap,no.pointShadowMatrix.value=Wn.state.pointShadowMatrix);const Bi=Go.getUniforms(),Gf=sc.seqWithValue(Bi.seq,no);return $n.currentProgram=Go,$n.uniformsList=Gf,Go}function Vl(vt,wn){const an=mt.get(vt);an.outputEncoding=wn.outputEncoding,an.instancing=wn.instancing,an.skinning=wn.skinning,an.morphTargets=wn.morphTargets,an.morphNormals=wn.morphNormals,an.numClippingPlanes=wn.numClippingPlanes,an.numIntersection=wn.numClipIntersection,an.vertexAlphas=wn.vertexAlphas,an.vertexTangents=wn.vertexTangents}function nf(vt,wn,an,$n){!0!==wn.isScene&&(wn=un),Kt.resetTextureUnits();const Wn=wn.fog,Gr=null===tt?$e.outputEncoding:tt.texture.encoding,Li=(an.isMeshStandardMaterial?yn:Vt).get(an.envMap||(an.isMeshStandardMaterial?wn.environment:null)),to=!0===an.vertexColors&&!!$n.geometry&&!!$n.geometry.attributes.color&&4===$n.geometry.attributes.color.itemSize,Es=!!$n.geometry&&!!$n.geometry.attributes.tangent,Go=!!$n.geometry&&!!$n.geometry.morphAttributes.position,no=!!$n.geometry&&!!$n.geometry.morphAttributes.normal,Bi=mt.get(an),Gf=ue.state.lights;!0!==en||!0!==Mn&&vt===ot||zo.setState(an,vt,vt===ot&&an.id===Ze);let ol=!1;an.version===Bi.__version?Bi.needsLights&&Bi.lightsStateVersion!==Gf.state.version||Bi.outputEncoding!==Gr||$n.isInstancedMesh&&!1===Bi.instancing?ol=!0:$n.isInstancedMesh||!0!==Bi.instancing?$n.isSkinnedMesh&&!1===Bi.skinning?ol=!0:$n.isSkinnedMesh||!0!==Bi.skinning?Bi.envMap!==Li||an.fog&&Bi.fog!==Wn?ol=!0:void 0===Bi.numClippingPlanes||Bi.numClippingPlanes===zo.numPlanes&&Bi.numIntersection===zo.numIntersection?(Bi.vertexAlphas!==to||Bi.vertexTangents!==Es||Bi.morphTargets!==Go||Bi.morphNormals!==no)&&(ol=!0):ol=!0:ol=!0:ol=!0:(ol=!0,Bi.__version=an.version);let Tf=Bi.currentProgram;!0===ol&&(Tf=zc(an,wn,$n));let sd=!1,Hf=!1,Mf=!1;const jc=Tf.getUniforms(),Nd=Bi.uniforms;if(Zn.useProgram(Tf.program)&&(sd=!0,Hf=!0,Mf=!0),an.id!==Ze&&(Ze=an.id,Hf=!0),sd||ot!==vt){if(jc.setValue(Ht,"projectionMatrix",vt.projectionMatrix),Jn.logarithmicDepthBuffer&&jc.setValue(Ht,"logDepthBufFC",2/(Math.log(vt.far+1)/Math.LN2)),ot!==vt&&(ot=vt,Hf=!0,Mf=!0),an.isShaderMaterial||an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshStandardMaterial||an.envMap){const ld=jc.map.cameraPosition;void 0!==ld&&ld.setValue(Ht,rn.setFromMatrixPosition(vt.matrixWorld))}(an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshLambertMaterial||an.isMeshBasicMaterial||an.isMeshStandardMaterial||an.isShaderMaterial)&&jc.setValue(Ht,"isOrthographic",!0===vt.isOrthographicCamera),(an.isMeshPhongMaterial||an.isMeshToonMaterial||an.isMeshLambertMaterial||an.isMeshBasicMaterial||an.isMeshStandardMaterial||an.isShaderMaterial||an.isShadowMaterial||$n.isSkinnedMesh)&&jc.setValue(Ht,"viewMatrix",vt.matrixWorldInverse)}if($n.isSkinnedMesh){jc.setOptional(Ht,$n,"bindMatrix"),jc.setOptional(Ht,$n,"bindMatrixInverse");const ld=$n.skeleton;ld&&(Jn.floatVertexTextures?(null===ld.boneTexture&&ld.computeBoneTexture(),jc.setValue(Ht,"boneTexture",ld.boneTexture,Kt),jc.setValue(Ht,"boneTextureSize",ld.boneTextureSize)):jc.setOptional(Ht,ld,"boneMatrices"))}var Gu,ad;return(Hf||Bi.receiveShadow!==$n.receiveShadow)&&(Bi.receiveShadow=$n.receiveShadow,jc.setValue(Ht,"receiveShadow",$n.receiveShadow)),Hf&&(jc.setValue(Ht,"toneMappingExposure",$e.toneMappingExposure),Bi.needsLights&&((Gu=Nd).ambientLightColor.needsUpdate=ad=Mf,Gu.lightProbe.needsUpdate=ad,Gu.directionalLights.needsUpdate=ad,Gu.directionalLightShadows.needsUpdate=ad,Gu.pointLights.needsUpdate=ad,Gu.pointLightShadows.needsUpdate=ad,Gu.spotLights.needsUpdate=ad,Gu.spotLightShadows.needsUpdate=ad,Gu.rectAreaLights.needsUpdate=ad,Gu.hemisphereLights.needsUpdate=ad),Wn&&an.fog&&ki.refreshFogUniforms(Nd,Wn),ki.refreshMaterialUniforms(Nd,an,Tt,nt,rt),sc.upload(Ht,Bi.uniformsList,Nd,Kt)),an.isShaderMaterial&&!0===an.uniformsNeedUpdate&&(sc.upload(Ht,Bi.uniformsList,Nd,Kt),an.uniformsNeedUpdate=!1),an.isSpriteMaterial&&jc.setValue(Ht,"center",$n.center),jc.setValue(Ht,"modelViewMatrix",$n.modelViewMatrix),jc.setValue(Ht,"normalMatrix",$n.normalMatrix),jc.setValue(Ht,"modelMatrix",$n.matrixWorld),Tf}jo.setAnimationLoop(function(vt){cs&&cs(vt)}),typeof window<"u"&&jo.setContext(window),this.setAnimationLoop=function(vt){cs=vt,tr.setAnimationLoop(vt),null===vt?jo.stop():jo.start()},tr.addEventListener("sessionstart",oa),tr.addEventListener("sessionend",sa),this.render=function(vt,wn){if(void 0===wn||!0===wn.isCamera){if(!0!==Le){if(!0===vt.autoUpdate&&vt.updateMatrixWorld(),null===wn.parent&&wn.updateMatrixWorld(),!0===tr.enabled&&!0===tr.isPresenting&&(!0===tr.cameraAutoUpdate&&tr.updateCamera(wn),wn=tr.getCamera()),!0===vt.isScene&&vt.onBeforeRender($e,vt,wn,tt),ue=El.get(vt,Ee.length),ue.init(),Ee.push(ue),ut.multiplyMatrices(wn.projectionMatrix,wn.matrixWorldInverse),nn.setFromProjectionMatrix(ut),Mn=this.localClippingEnabled,en=zo.init(this.clippingPlanes,Mn,wn),le=mo.get(vt,_e.length),le.init(),_e.push(le),Vi(vt,wn,0,$e.sortObjects),le.finish(),!0===$e.sortObjects&&le.sort(Yt,ct),!0===en&&zo.beginShadows(),Ma.render(ue.state.shadowsArray,vt,wn),!0===en&&zo.endShadows(),!0===this.info.autoReset&&this.info.reset(),ju.render(le,vt),ue.setupLights($e.physicallyCorrectLights),wn.isArrayCamera){const $n=wn.cameras;for(let Wn=0,Si=$n.length;Wn<Si;Wn++){const Gr=$n[Wn];aa(le,vt,Gr,Gr.viewport)}}else aa(le,vt,wn);null!==tt&&(Kt.updateMultisampleRenderTarget(tt),Kt.updateRenderTargetMipmap(tt)),!0===vt.isScene&&vt.onAfterRender($e,vt,wn),Zn.buffers.depth.setTest(!0),Zn.buffers.depth.setMask(!0),Zn.buffers.color.setMask(!0),Zn.setPolygonOffset(!1),Et.resetDefaultState(),Ze=-1,ot=null,Ee.pop(),ue=Ee.length>0?Ee[Ee.length-1]:null,_e.pop(),le=_e.length>0?_e[_e.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return Ne},this.getActiveMipmapLevel=function(){return We},this.getRenderTarget=function(){return tt},this.setRenderTarget=function(vt,wn=0,an=0){tt=vt,Ne=wn,We=an,vt&&void 0===mt.get(vt).__webglFramebuffer&&Kt.setupRenderTarget(vt);let $n=null,Wn=!1,Si=!1;if(vt){const Gr=vt.texture;(Gr.isDataTexture3D||Gr.isDataTexture2DArray)&&(Si=!0);const Li=mt.get(vt).__webglFramebuffer;vt.isWebGLCubeRenderTarget?($n=Li[wn],Wn=!0):$n=vt.isWebGLMultisampleRenderTarget?mt.get(vt).__webglMultisampledFramebuffer:Li,st.copy(vt.viewport),Ct.copy(vt.scissor),Ft=vt.scissorTest}else st.copy(Lt).multiplyScalar(Tt).floor(),Ct.copy(_t).multiplyScalar(Tt).floor(),Ft=zt;if(Zn.bindFramebuffer(36160,$n)&&Jn.drawBuffers){let Gr=!1;if(vt)if(vt.isWebGLMultipleRenderTargets){const Li=vt.texture;if(Rt.length!==Li.length||36064!==Rt[0]){for(let to=0,Es=Li.length;to<Es;to++)Rt[to]=36064+to;Rt.length=Li.length,Gr=!0}}else 1===Rt.length&&36064===Rt[0]||(Rt[0]=36064,Rt.length=1,Gr=!0);else 1===Rt.length&&1029===Rt[0]||(Rt[0]=1029,Rt.length=1,Gr=!0);Gr&&(Jn.isWebGL2?Ht.drawBuffers(Rt):kn.get("WEBGL_draw_buffers").drawBuffersWEBGL(Rt))}if(Zn.viewport(st),Zn.scissor(Ct),Zn.setScissorTest(Ft),Wn){const Gr=mt.get(vt.texture);Ht.framebufferTexture2D(36160,36064,34069+wn,Gr.__webglTexture,an)}else if(Si){const Gr=mt.get(vt.texture);Ht.framebufferTextureLayer(36160,36064,Gr.__webglTexture,an||0,wn||0)}Ze=-1},this.readRenderTargetPixels=function(vt,wn,an,$n,Wn,Si,Gr){if(!vt||!vt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Li=mt.get(vt).__webglFramebuffer;if(vt.isWebGLCubeRenderTarget&&void 0!==Gr&&(Li=Li[Gr]),Li){Zn.bindFramebuffer(36160,Li);try{const to=vt.texture,Es=to.format,Go=to.type;if(Es!==ao&&gh.convert(Es)!==Ht.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const no=Go===hs&&(kn.has("EXT_color_buffer_half_float")||Jn.isWebGL2&&kn.has("EXT_color_buffer_float"));if(!(Go===ca||gh.convert(Go)===Ht.getParameter(35738)||Go===Xo&&(Jn.isWebGL2||kn.has("OES_texture_float")||kn.has("WEBGL_color_buffer_float"))||no))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Ht.checkFramebufferStatus(36160)?wn>=0&&wn<=vt.width-$n&&an>=0&&an<=vt.height-Wn&&Ht.readPixels(wn,an,$n,Wn,gh.convert(Es),gh.convert(Go),Si):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const to=null!==tt?mt.get(tt).__webglFramebuffer:null;Zn.bindFramebuffer(36160,to)}}},this.copyFramebufferToTexture=function(vt,wn,an=0){const $n=Math.pow(2,-an),Wn=Math.floor(wn.image.width*$n),Si=Math.floor(wn.image.height*$n);let Gr=gh.convert(wn.format);Jn.isWebGL2&&(6407===Gr&&(Gr=32849),6408===Gr&&(Gr=32856)),Kt.setTexture2D(wn,0),Ht.copyTexImage2D(3553,an,Gr,vt.x,vt.y,Wn,Si,0),Zn.unbindTexture()},this.copyTextureToTexture=function(vt,wn,an,$n=0){const Wn=wn.image.width,Si=wn.image.height,Gr=gh.convert(an.format),Li=gh.convert(an.type);Kt.setTexture2D(an,0),Ht.pixelStorei(37440,an.flipY),Ht.pixelStorei(37441,an.premultiplyAlpha),Ht.pixelStorei(3317,an.unpackAlignment),wn.isDataTexture?Ht.texSubImage2D(3553,$n,vt.x,vt.y,Wn,Si,Gr,Li,wn.image.data):wn.isCompressedTexture?Ht.compressedTexSubImage2D(3553,$n,vt.x,vt.y,wn.mipmaps[0].width,wn.mipmaps[0].height,Gr,wn.mipmaps[0].data):Ht.texSubImage2D(3553,$n,vt.x,vt.y,Gr,Li,wn.image),0===$n&&an.generateMipmaps&&Ht.generateMipmap(3553),Zn.unbindTexture()},this.copyTextureToTexture3D=function(vt,wn,an,$n,Wn=0){if($e.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const Si=vt.max.x-vt.min.x+1,Gr=vt.max.y-vt.min.y+1,Li=vt.max.z-vt.min.z+1,to=gh.convert($n.format),Es=gh.convert($n.type);let Go;if($n.isDataTexture3D)Kt.setTexture3D($n,0),Go=32879;else{if(!$n.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");Kt.setTexture2DArray($n,0),Go=35866}Ht.pixelStorei(37440,$n.flipY),Ht.pixelStorei(37441,$n.premultiplyAlpha),Ht.pixelStorei(3317,$n.unpackAlignment);const no=Ht.getParameter(3314),Bi=Ht.getParameter(32878),Gf=Ht.getParameter(3316),ol=Ht.getParameter(3315),Tf=Ht.getParameter(32877),sd=an.isCompressedTexture?an.mipmaps[0]:an.image;Ht.pixelStorei(3314,sd.width),Ht.pixelStorei(32878,sd.height),Ht.pixelStorei(3316,vt.min.x),Ht.pixelStorei(3315,vt.min.y),Ht.pixelStorei(32877,vt.min.z),an.isDataTexture||an.isDataTexture3D?Ht.texSubImage3D(Go,Wn,wn.x,wn.y,wn.z,Si,Gr,Li,to,Es,sd.data):an.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ht.compressedTexSubImage3D(Go,Wn,wn.x,wn.y,wn.z,Si,Gr,Li,to,sd.data)):Ht.texSubImage3D(Go,Wn,wn.x,wn.y,wn.z,Si,Gr,Li,to,Es,sd),Ht.pixelStorei(3314,no),Ht.pixelStorei(32878,Bi),Ht.pixelStorei(3316,Gf),Ht.pixelStorei(3315,ol),Ht.pixelStorei(32877,Tf),0===Wn&&$n.generateMipmaps&&Ht.generateMipmap(Go),Zn.unbindTexture()},this.initTexture=function(vt){Kt.setTexture2D(vt,0),Zn.unbindTexture()},this.resetState=function(){Ne=0,We=0,tt=null,Zn.reset(),Et.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class kp extends Yi{}kp.prototype.isWebGL1Renderer=!0;class Lu{constructor(e,c=25e-5){this.name="",this.color=new Kn(e),this.density=c}clone(){return new Lu(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Lu.prototype.isFogExp2=!0;class Ia{constructor(e,c=1,d=1e3){this.name="",this.color=new Kn(e),this.near=c,this.far=d}clone(){return new Ia(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Ia.prototype.isFog=!0;class Us extends Pr{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,c){return super.copy(e,c),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const c=super.toJSON(e);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),c}}Us.prototype.isScene=!0;class Oc{constructor(e,c){this.array=e,this.stride=c,this.count=void 0!==e?e.length/c:0,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Zi()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,c,d){e*=this.stride,d*=c.stride;for(let _=0,S=this.stride;_<S;_++)this.array[e+_]=c.array[d+_];return this}set(e,c=0){return this.array.set(e,c),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),d=new this.constructor(c,this.stride);return d.setUsage(this.usage),d}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Zi()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Oc.prototype.isInterleavedBuffer=!0;const ys=new ht;class Ii{constructor(e,c,d,_=!1){this.name="",this.data=e,this.itemSize=c,this.offset=d,this.normalized=!0===_}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let c=0,d=this.data.count;c<d;c++)ys.x=this.getX(c),ys.y=this.getY(c),ys.z=this.getZ(c),ys.applyMatrix4(e),this.setXYZ(c,ys.x,ys.y,ys.z);return this}applyNormalMatrix(e){for(let c=0,d=this.count;c<d;c++)ys.x=this.getX(c),ys.y=this.getY(c),ys.z=this.getZ(c),ys.applyNormalMatrix(e),this.setXYZ(c,ys.x,ys.y,ys.z);return this}transformDirection(e){for(let c=0,d=this.count;c<d;c++)ys.x=this.getX(c),ys.y=this.getY(c),ys.z=this.getZ(c),ys.transformDirection(e),this.setXYZ(c,ys.x,ys.y,ys.z);return this}setX(e,c){return this.data.array[e*this.data.stride+this.offset]=c,this}setY(e,c){return this.data.array[e*this.data.stride+this.offset+1]=c,this}setZ(e,c){return this.data.array[e*this.data.stride+this.offset+2]=c,this}setW(e,c){return this.data.array[e*this.data.stride+this.offset+3]=c,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,c,d){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this}setXYZ(e,c,d,_){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this.data.array[e+2]=_,this}setXYZW(e,c,d,_,S){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=d,this.data.array[e+2]=_,this.data.array[e+3]=S,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const _=d*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)c.push(this.data.array[_+S])}return new Pi(new this.array.constructor(c),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ii(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let d=0;d<this.count;d++){const _=d*this.data.stride+this.offset;for(let S=0;S<this.itemSize;S++)c.push(this.data.array[_+S])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Ii.prototype.isInterleavedBufferAttribute=!0;class Jp extends $s{constructor(e){super(),this.type="SpriteMaterial",this.color=new Kn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let kl;Jp.prototype.isSpriteMaterial=!0;const Vo=new ht,Fl=new ht,ea=new ht,Oa=new zn,kc=new zn,cc=new tn,xd=new ht,uc=new ht,iu=new ht,Bu=new zn,hc=new zn,hh=new zn;class Fc extends Pr{constructor(e){if(super(),this.type="Sprite",void 0===kl){kl=new br;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new Oc(c,5);kl.setIndex([0,1,2,0,2,3]),kl.setAttribute("position",new Ii(d,3,0,!1)),kl.setAttribute("uv",new Ii(d,2,3,!1))}this.geometry=kl,this.material=void 0!==e?e:new Jp,this.center=new zn(.5,.5)}raycast(e,c){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Fl.setFromMatrixScale(this.matrixWorld),cc.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ea.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Fl.multiplyScalar(-ea.z);const d=this.material.rotation;let _,S;0!==d&&(S=Math.cos(d),_=Math.sin(d));const L=this.center;Nu(xd.set(-.5,-.5,0),ea,L,Fl,_,S),Nu(uc.set(.5,-.5,0),ea,L,Fl,_,S),Nu(iu.set(.5,.5,0),ea,L,Fl,_,S),Bu.set(0,0),hc.set(1,0),hh.set(1,1);let k=e.ray.intersectTriangle(xd,uc,iu,!1,Vo);if(null===k&&(Nu(uc.set(-.5,.5,0),ea,L,Fl,_,S),hc.set(0,1),k=e.ray.intersectTriangle(xd,iu,uc,!1,Vo),null===k))return;const F=e.ray.origin.distanceTo(Vo);F<e.near||F>e.far||c.push({distance:F,point:Vo.clone(),uv:Ki.getUV(Vo,xd,uc,iu,Bu,hc,hh,new zn),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Nu(w,e,c,d,_,S){Oa.subVectors(w,c).addScalar(.5).multiply(d),void 0!==_?(kc.x=S*Oa.x-_*Oa.y,kc.y=_*Oa.x+S*Oa.y):kc.copy(Oa),w.copy(e),w.x+=kc.x,w.y+=kc.y,w.applyMatrix4(cc)}Fc.prototype.isSprite=!0;const bs=new ht,Ru=new ht;class ph extends Pr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const c=e.levels;for(let d=0,_=c.length;d<_;d++){const S=c[d];this.addLevel(S.object.clone(),S.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,c=0){c=Math.abs(c);const d=this.levels;let _;for(_=0;_<d.length&&!(c<d[_].distance);_++);return d.splice(_,0,{distance:c,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const c=this.levels;if(c.length>0){let d,_;for(d=1,_=c.length;d<_&&!(e<c[d].distance);d++);return c[d-1].object}return null}raycast(e,c){if(this.levels.length>0){bs.setFromMatrixPosition(this.matrixWorld);const d=e.ray.origin.distanceTo(bs);this.getObjectForDistance(d).raycast(e,c)}}update(e){const c=this.levels;if(c.length>1){bs.setFromMatrixPosition(e.matrixWorld),Ru.setFromMatrixPosition(this.matrixWorld);const d=bs.distanceTo(Ru)/e.zoom;let _,S;for(c[0].object.visible=!0,_=1,S=c.length;_<S&&d>=c[_].distance;_++)c[_-1].object.visible=!1,c[_].object.visible=!0;for(this._currentLevel=_-1;_<S;_++)c[_].object.visible=!1}}toJSON(e){const c=super.toJSON(e);!1===this.autoUpdate&&(c.object.autoUpdate=!1),c.object.levels=[];const d=this.levels;for(let _=0,S=d.length;_<S;_++){const L=d[_];c.object.levels.push({object:L.object.uuid,distance:L.distance})}return c}}const Bh=new ht,zs=new Di,Dl=new Di,xa=new ht,Ul=new tn;class zl extends Ro{constructor(e,c){super(e,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new tn,this.bindMatrixInverse=new tn}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,c){this.skeleton=e,void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Di,c=this.geometry.attributes.skinWeight;for(let d=0,_=c.count;d<_;d++){e.x=c.getX(d),e.y=c.getY(d),e.z=c.getZ(d),e.w=c.getW(d);const S=1/e.manhattanLength();S!==1/0?e.multiplyScalar(S):e.set(1,0,0,0),c.setXYZW(d,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,c){const d=this.skeleton,_=this.geometry;zs.fromBufferAttribute(_.attributes.skinIndex,e),Dl.fromBufferAttribute(_.attributes.skinWeight,e),Bh.fromBufferAttribute(_.attributes.position,e).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let S=0;S<4;S++){const L=Dl.getComponent(S);if(0!==L){const k=zs.getComponent(S);Ul.multiplyMatrices(d.bones[k].matrixWorld,d.boneInverses[k]),c.addScaledVector(xa.copy(Bh).applyMatrix4(Ul),L)}}return c.applyMatrix4(this.bindMatrixInverse)}}zl.prototype.isSkinnedMesh=!0;class jl extends Pr{constructor(){super(),this.type="Bone"}}jl.prototype.isBone=!0;class Is extends As{constructor(e=null,c=1,d=1,_,S,L,k,F,V=Ir,te=Ir,le,ue){super(null,L,k,F,V,te,_,S,le,ue),this.image={data:e,width:c,height:d},this.magFilter=V,this.minFilter=te,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Is.prototype.isDataTexture=!0;const Nh=new tn,Co=new tn;class rp{constructor(e=[],c=[]){this.uuid=Zi(),this.bones=e.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===c.length)this.calculateInverses();else if(e.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,_=this.bones.length;d<_;d++)this.boneInverses.push(new tn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,c=this.bones.length;e<c;e++){const d=new tn;this.bones[e]&&d.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let e=0,c=this.bones.length;e<c;e++){const d=this.bones[e];d&&d.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,c=this.bones.length;e<c;e++){const d=this.bones[e];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){const e=this.bones,c=this.boneInverses,d=this.boneMatrices,_=this.boneTexture;for(let S=0,L=e.length;S<L;S++)Nh.multiplyMatrices(e[S]?e[S].matrixWorld:Co,c[S]),Nh.toArray(d,16*S);null!==_&&(_.needsUpdate=!0)}clone(){return new rp(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Xh(e),e=Math.max(e,4);const c=new Float32Array(e*e*4);c.set(this.boneMatrices);const d=new Is(c,e,e,ao,Xo);return this.boneMatrices=c,this.boneTexture=d,this.boneTextureSize=e,this}getBoneByName(e){for(let c=0,d=this.bones.length;c<d;c++){const _=this.bones[c];if(_.name===e)return _}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,c){this.uuid=e.uuid;for(let d=0,_=e.bones.length;d<_;d++){const S=e.bones[d];let L=c[S];void 0===L&&(console.warn("THREE.Skeleton: No bone found with UUID:",S),L=new jl),this.bones.push(L),this.boneInverses.push((new tn).fromArray(e.boneInverses[d]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const c=this.bones,d=this.boneInverses;for(let _=0,S=c.length;_<S;_++)e.bones.push(c[_].uuid),e.boneInverses.push(d[_].toArray());return e}}class ou extends Pi{constructor(e,c,d,_=1){"number"==typeof d&&(_=d,d=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,c,d),this.meshPerAttribute=_}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}ou.prototype.isInstancedBufferAttribute=!0;const _f=new tn,Pu=new tn,Oo=[],Lo=new Ro;class Dc extends Ro{constructor(e,c,d){super(e,c),this.instanceMatrix=new ou(new Float32Array(16*d),16),this.instanceColor=null,this.count=d,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,c){c.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,c){c.fromArray(this.instanceMatrix.array,16*e)}raycast(e,c){const d=this.matrixWorld,_=this.count;if(Lo.geometry=this.geometry,Lo.material=this.material,void 0!==Lo.material)for(let S=0;S<_;S++){this.getMatrixAt(S,_f),Pu.multiplyMatrices(d,_f),Lo.matrixWorld=Pu,Lo.raycast(e,Oo);for(let L=0,k=Oo.length;L<k;L++){const F=Oo[L];F.instanceId=S,F.object=this,c.push(F)}Oo.length=0}}setColorAt(e,c){null===this.instanceColor&&(this.instanceColor=new ou(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,c){c.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Dc.prototype.isInstancedMesh=!0;class kt extends $s{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Kn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}kt.prototype.isLineBasicMaterial=!0;const Fp=new ht,ji=new ht,Gs=new tn,ko=new fn,io=new bo;class ka extends Pr{constructor(e=new br,c=new kt){super(),this.type="Line",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,d=[0];for(let _=1,S=c.count;_<S;_++)Fp.fromBufferAttribute(c,_-1),ji.fromBufferAttribute(c,_),d[_]=d[_-1],d[_]+=Fp.distanceTo(ji);e.setAttribute("lineDistance",new hn(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,c){const d=this.geometry,_=this.matrixWorld,S=e.params.Line.threshold,L=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),io.copy(d.boundingSphere),io.applyMatrix4(_),io.radius+=S,!1===e.ray.intersectsSphere(io))return;Gs.copy(_).invert(),ko.copy(e.ray).applyMatrix4(Gs);const k=S/((this.scale.x+this.scale.y+this.scale.z)/3),F=k*k,V=new ht,te=new ht,le=new ht,ue=new ht,_e=this.isLineSegments?2:1;if(d.isBufferGeometry){const Ee=d.index,$e=d.attributes.position;if(null!==Ee)for(let Le=Math.max(0,L.start),Ne=Math.min(Ee.count,L.start+L.count)-1;Le<Ne;Le+=_e){const We=Ee.getX(Le),tt=Ee.getX(Le+1);if(V.fromBufferAttribute($e,We),te.fromBufferAttribute($e,tt),ko.distanceSqToSegment(V,te,ue,le)>F)continue;ue.applyMatrix4(this.matrixWorld);const Ze=e.ray.origin.distanceTo(ue);Ze<e.near||Ze>e.far||c.push({distance:Ze,point:le.clone().applyMatrix4(this.matrixWorld),index:Le,face:null,faceIndex:null,object:this})}else for(let Le=Math.max(0,L.start),Ne=Math.min($e.count,L.start+L.count)-1;Le<Ne;Le+=_e){if(V.fromBufferAttribute($e,Le),te.fromBufferAttribute($e,Le+1),ko.distanceSqToSegment(V,te,ue,le)>F)continue;ue.applyMatrix4(this.matrixWorld);const We=e.ray.origin.distanceTo(ue);We<e.near||We>e.far||c.push({distance:We,point:le.clone().applyMatrix4(this.matrixWorld),index:Le,face:null,faceIndex:null,object:this})}}else d.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,L=_.length;S<L;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}ka.prototype.isLine=!0;const ip=new ht,Pf=new ht;class dr extends ka{constructor(e,c){super(e,c),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,d=[];for(let _=0,S=c.count;_<S;_+=2)ip.fromBufferAttribute(c,_),Pf.fromBufferAttribute(c,_+1),d[_]=0===_?0:d[_-1],d[_+1]=d[_]+ip.distanceTo(Pf);e.setAttribute("lineDistance",new hn(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}dr.prototype.isLineSegments=!0;class Qo extends ka{constructor(e,c){super(e,c),this.type="LineLoop"}}Qo.prototype.isLineLoop=!0;class gi extends $s{constructor(e){super(),this.type="PointsMaterial",this.color=new Kn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}gi.prototype.isPointsMaterial=!0;const Wo=new tn,hi=new fn,Fo=new bo,pc=new ht;class ta extends Pr{constructor(e=new br,c=new gi){super(),this.type="Points",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,c){const d=this.geometry,_=this.matrixWorld,S=e.params.Points.threshold,L=d.drawRange;if(null===d.boundingSphere&&d.computeBoundingSphere(),Fo.copy(d.boundingSphere),Fo.applyMatrix4(_),Fo.radius+=S,!1===e.ray.intersectsSphere(Fo))return;Wo.copy(_).invert(),hi.copy(e.ray).applyMatrix4(Wo);const k=S/((this.scale.x+this.scale.y+this.scale.z)/3),F=k*k;if(d.isBufferGeometry){const V=d.index,te=d.attributes.position;if(null!==V)for(let le=Math.max(0,L.start),ue=Math.min(V.count,L.start+L.count);le<ue;le++){const _e=V.getX(le);pc.fromBufferAttribute(te,_e),wd(pc,_e,F,_,e,c,this)}else for(let le=Math.max(0,L.start),ue=Math.min(te.count,L.start+L.count);le<ue;le++)pc.fromBufferAttribute(te,le),wd(pc,le,F,_,e,c,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,d=Object.keys(c);if(d.length>0){const _=c[d[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let S=0,L=_.length;S<L;S++){const k=_[S].name||String(S);this.morphTargetInfluences.push(0),this.morphTargetDictionary[k]=S}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function wd(w,e,c,d,_,S,L){const k=hi.distanceSqToPoint(w);if(k<c){const F=new ht;hi.closestPointToPoint(w,F),F.applyMatrix4(d);const V=_.ray.origin.distanceTo(F);if(V<_.near||V>_.far)return;S.push({distance:V,distanceToRay:Math.sqrt(k),point:F,index:e,face:null,object:L})}}ta.prototype.isPoints=!0;class Dp extends As{constructor(e,c,d,_,S,L,k,F,V){super(e,c,d,_,S,L,k,F,V),this.format=void 0!==k?k:Os,this.minFilter=void 0!==L?L:ai,this.magFilter=void 0!==S?S:ai,this.generateMipmaps=!1;const te=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function le(){te.needsUpdate=!0,e.requestVideoFrameCallback(le)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}Dp.prototype.isVideoTexture=!0;class Iu extends As{constructor(e,c,d,_,S,L,k,F,V,te,le,ue){super(null,L,k,F,V,te,_,S,le,ue),this.image={width:c,height:d},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Iu.prototype.isCompressedTexture=!0;class gf extends As{constructor(e,c,d,_,S,L,k,F,V){super(e,c,d,_,S,L,k,F,V),this.needsUpdate=!0}}gf.prototype.isCanvasTexture=!0;class qd extends As{constructor(e,c,d,_,S,L,k,F,V,te){if((te=void 0!==te?te:To)!==To&&te!==Ys)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===d&&te===To&&(d=Hc),void 0===d&&te===Ys&&(d=Ts),super(null,_,S,L,k,F,te,d,V),this.image={width:e,height:c},this.magFilter=void 0!==k?k:Ir,this.minFilter=void 0!==F?F:Ir,this.flipY=!1,this.generateMipmaps=!1}}qd.prototype.isDepthTexture=!0;class su extends br{constructor(e=1,c=8,d=0,_=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:c,thetaStart:d,thetaLength:_},c=Math.max(3,c);const S=[],L=[],k=[],F=[],V=new ht,te=new zn;L.push(0,0,0),k.push(0,0,1),F.push(.5,.5);for(let le=0,ue=3;le<=c;le++,ue+=3){const _e=d+le/c*_;V.x=e*Math.cos(_e),V.y=e*Math.sin(_e),L.push(V.x,V.y,V.z),k.push(0,0,1),te.x=(L[ue]/e+1)/2,te.y=(L[ue+1]/e+1)/2,F.push(te.x,te.y)}for(let le=1;le<=c;le++)S.push(le,le+1,0);this.setIndex(S),this.setAttribute("position",new hn(L,3)),this.setAttribute("normal",new hn(k,3)),this.setAttribute("uv",new hn(F,2))}static fromJSON(e){return new su(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class rl extends br{constructor(e=1,c=1,d=1,_=8,S=1,L=!1,k=0,F=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:c,height:d,radialSegments:_,heightSegments:S,openEnded:L,thetaStart:k,thetaLength:F};const V=this;_=Math.floor(_),S=Math.floor(S);const te=[],le=[],ue=[],_e=[];let Ee=0;const $e=[],Le=d/2;let Ne=0;function We(tt){const Ze=Ee,ot=new zn,st=new ht;let Ct=0;const Ft=!0===tt?e:c,Qe=!0===tt?1:-1;for(let Tt=1;Tt<=_;Tt++)le.push(0,Le*Qe,0),ue.push(0,Qe,0),_e.push(.5,.5),Ee++;const nt=Ee;for(let Tt=0;Tt<=_;Tt++){const Yt=Tt/_*F+k,ct=Math.cos(Yt),Lt=Math.sin(Yt);st.x=Ft*Lt,st.y=Le*Qe,st.z=Ft*ct,le.push(st.x,st.y,st.z),ue.push(0,Qe,0),ot.x=.5*ct+.5,ot.y=.5*Lt*Qe+.5,_e.push(ot.x,ot.y),Ee++}for(let Tt=0;Tt<_;Tt++){const Yt=Ze+Tt,ct=nt+Tt;!0===tt?te.push(ct,ct+1,Yt):te.push(ct+1,ct,Yt),Ct+=3}V.addGroup(Ne,Ct,!0===tt?1:2),Ne+=Ct}(function(){const tt=new ht,Ze=new ht;let ot=0;const st=(c-e)/d;for(let Ct=0;Ct<=S;Ct++){const Ft=[],Qe=Ct/S,nt=Qe*(c-e)+e;for(let Tt=0;Tt<=_;Tt++){const Yt=Tt/_,ct=Yt*F+k,Lt=Math.sin(ct),_t=Math.cos(ct);Ze.x=nt*Lt,Ze.y=-Qe*d+Le,Ze.z=nt*_t,le.push(Ze.x,Ze.y,Ze.z),tt.set(Lt,st,_t).normalize(),ue.push(tt.x,tt.y,tt.z),_e.push(Yt,1-Qe),Ft.push(Ee++)}$e.push(Ft)}for(let Ct=0;Ct<_;Ct++)for(let Ft=0;Ft<S;Ft++){const nt=$e[Ft+1][Ct],Tt=$e[Ft+1][Ct+1],Yt=$e[Ft][Ct+1];te.push($e[Ft][Ct],nt,Yt),te.push(nt,Tt,Yt),ot+=6}V.addGroup(Ne,ot,0),Ne+=ot})(),!1===L&&(e>0&&We(!0),c>0&&We(!1)),this.setIndex(te),this.setAttribute("position",new hn(le,3)),this.setAttribute("normal",new hn(ue,3)),this.setAttribute("uv",new hn(_e,2))}static fromJSON(e){return new rl(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Zp extends rl{constructor(e=1,c=1,d=8,_=1,S=!1,L=0,k=2*Math.PI){super(0,e,c,d,_,S,L,k),this.type="ConeGeometry",this.parameters={radius:e,height:c,radialSegments:d,heightSegments:_,openEnded:S,thetaStart:L,thetaLength:k}}static fromJSON(e){return new Zp(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class au extends br{constructor(e,c,d=1,_=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:c,radius:d,detail:_};const S=[],L=[];function k(ue,_e,Ee,$e){const Le=$e+1,Ne=[];for(let We=0;We<=Le;We++){Ne[We]=[];const tt=ue.clone().lerp(Ee,We/Le),Ze=_e.clone().lerp(Ee,We/Le),ot=Le-We;for(let st=0;st<=ot;st++)Ne[We][st]=0===st&&We===Le?tt:tt.clone().lerp(Ze,st/ot)}for(let We=0;We<Le;We++)for(let tt=0;tt<2*(Le-We)-1;tt++){const Ze=Math.floor(tt/2);tt%2==0?(F(Ne[We][Ze+1]),F(Ne[We+1][Ze]),F(Ne[We][Ze])):(F(Ne[We][Ze+1]),F(Ne[We+1][Ze+1]),F(Ne[We+1][Ze]))}}function F(ue){S.push(ue.x,ue.y,ue.z)}function V(ue,_e){const Ee=3*ue;_e.x=e[Ee+0],_e.y=e[Ee+1],_e.z=e[Ee+2]}function te(ue,_e,Ee,$e){$e<0&&1===ue.x&&(L[_e]=ue.x-1),0===Ee.x&&0===Ee.z&&(L[_e]=$e/2/Math.PI+.5)}function le(ue){return Math.atan2(ue.z,-ue.x)}(function(ue){const _e=new ht,Ee=new ht,$e=new ht;for(let Le=0;Le<c.length;Le+=3)V(c[Le+0],_e),V(c[Le+1],Ee),V(c[Le+2],$e),k(_e,Ee,$e,ue)})(_),function(ue){const _e=new ht;for(let Ee=0;Ee<S.length;Ee+=3)_e.x=S[Ee+0],_e.y=S[Ee+1],_e.z=S[Ee+2],_e.normalize().multiplyScalar(ue),S[Ee+0]=_e.x,S[Ee+1]=_e.y,S[Ee+2]=_e.z}(d),function(){const ue=new ht;for(let Ee=0;Ee<S.length;Ee+=3){ue.x=S[Ee+0],ue.y=S[Ee+1],ue.z=S[Ee+2];const $e=le(ue)/2/Math.PI+.5,Le=(_e=ue,Math.atan2(-_e.y,Math.sqrt(_e.x*_e.x+_e.z*_e.z))/Math.PI+.5);L.push($e,1-Le)}var _e;(function(){const Ee=new ht,$e=new ht,Le=new ht,Ne=new ht,We=new zn,tt=new zn,Ze=new zn;for(let ot=0,st=0;ot<S.length;ot+=9,st+=6){Ee.set(S[ot+0],S[ot+1],S[ot+2]),$e.set(S[ot+3],S[ot+4],S[ot+5]),Le.set(S[ot+6],S[ot+7],S[ot+8]),We.set(L[st+0],L[st+1]),tt.set(L[st+2],L[st+3]),Ze.set(L[st+4],L[st+5]),Ne.copy(Ee).add($e).add(Le).divideScalar(3);const Ct=le(Ne);te(We,st+0,Ee,Ct),te(tt,st+2,$e,Ct),te(Ze,st+4,Le,Ct)}})(),function(){for(let Ee=0;Ee<L.length;Ee+=6){const $e=L[Ee+0],Le=L[Ee+2],Ne=L[Ee+4],We=Math.max($e,Le,Ne),tt=Math.min($e,Le,Ne);We>.9&&tt<.1&&($e<.2&&(L[Ee+0]+=1),Le<.2&&(L[Ee+2]+=1),Ne<.2&&(L[Ee+4]+=1))}}()}(),this.setAttribute("position",new hn(S,3)),this.setAttribute("normal",new hn(S.slice(),3)),this.setAttribute("uv",new hn(L,2)),0===_?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new au(e.vertices,e.indices,e.radius,e.details)}}class eo extends au{constructor(e=1,c=0){const d=(1+Math.sqrt(5))/2,_=1/d;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-d,0,-_,d,0,_,-d,0,_,d,-_,-d,0,-_,d,0,_,-d,0,_,d,0,-d,0,-_,d,0,-_,-d,0,_,d,0,_],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,c),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new eo(e.radius,e.detail)}}const Mr=new ht,Yr=new ht,Ou=new ht,ku=new Ki;class lu extends br{constructor(e,c){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:c},c=void 0!==c?c:1,!0===e.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const d=Math.pow(10,4),_=Math.cos(Ho*c),S=e.getIndex(),L=e.getAttribute("position"),k=S?S.count:L.count,F=[0,0,0],V=["a","b","c"],te=new Array(3),le={},ue=[];for(let _e=0;_e<k;_e+=3){S?(F[0]=S.getX(_e),F[1]=S.getX(_e+1),F[2]=S.getX(_e+2)):(F[0]=_e,F[1]=_e+1,F[2]=_e+2);const{a:Ee,b:$e,c:Le}=ku;if(Ee.fromBufferAttribute(L,F[0]),$e.fromBufferAttribute(L,F[1]),Le.fromBufferAttribute(L,F[2]),ku.getNormal(Ou),te[0]=`${Math.round(Ee.x*d)},${Math.round(Ee.y*d)},${Math.round(Ee.z*d)}`,te[1]=`${Math.round($e.x*d)},${Math.round($e.y*d)},${Math.round($e.z*d)}`,te[2]=`${Math.round(Le.x*d)},${Math.round(Le.y*d)},${Math.round(Le.z*d)}`,te[0]!==te[1]&&te[1]!==te[2]&&te[2]!==te[0])for(let Ne=0;Ne<3;Ne++){const We=(Ne+1)%3,tt=te[Ne],Ze=te[We],ot=ku[V[Ne]],st=ku[V[We]],Ct=`${tt}_${Ze}`,Ft=`${Ze}_${tt}`;Ft in le&&le[Ft]?(Ou.dot(le[Ft].normal)<=_&&(ue.push(ot.x,ot.y,ot.z),ue.push(st.x,st.y,st.z)),le[Ft]=null):Ct in le||(le[Ct]={index0:F[Ne],index1:F[We],normal:Ou.clone()})}}for(const _e in le)if(le[_e]){const{index0:Ee,index1:$e}=le[_e];Mr.fromBufferAttribute(L,Ee),Yr.fromBufferAttribute(L,$e),ue.push(Mr.x,Mr.y,Mr.z),ue.push(Yr.x,Yr.y,Yr.z)}this.setAttribute("position",new hn(ue,3))}}class Fa{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,c){const d=this.getUtoTmapping(e);return this.getPoint(d,c)}getPoints(e=5){const c=[];for(let d=0;d<=e;d++)c.push(this.getPoint(d/e));return c}getSpacedPoints(e=5){const c=[];for(let d=0;d<=e;d++)c.push(this.getPointAt(d/e));return c}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let d,_=this.getPoint(0),S=0;c.push(0);for(let L=1;L<=e;L++)d=this.getPoint(L/e),S+=d.distanceTo(_),c.push(S),_=d;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,c){const d=this.getLengths();let _=0;const S=d.length;let L;L=c||e*d[S-1];let k,F=0,V=S-1;for(;F<=V;)if(_=Math.floor(F+(V-F)/2),k=d[_]-L,k<0)F=_+1;else{if(!(k>0)){V=_;break}V=_-1}if(_=V,d[_]===L)return _/(S-1);const te=d[_];return(_+(L-te)/(d[_+1]-te))/(S-1)}getTangent(e,c){let _=e-1e-4,S=e+1e-4;_<0&&(_=0),S>1&&(S=1);const L=this.getPoint(_),k=this.getPoint(S),F=c||(L.isVector2?new zn:new ht);return F.copy(k).sub(L).normalize(),F}getTangentAt(e,c){const d=this.getUtoTmapping(e);return this.getTangent(d,c)}computeFrenetFrames(e,c){const d=new ht,_=[],S=[],L=[],k=new ht,F=new tn;for(let _e=0;_e<=e;_e++)_[_e]=this.getTangentAt(_e/e,new ht),_[_e].normalize();S[0]=new ht,L[0]=new ht;let V=Number.MAX_VALUE;const te=Math.abs(_[0].x),le=Math.abs(_[0].y),ue=Math.abs(_[0].z);te<=V&&(V=te,d.set(1,0,0)),le<=V&&(V=le,d.set(0,1,0)),ue<=V&&d.set(0,0,1),k.crossVectors(_[0],d).normalize(),S[0].crossVectors(_[0],k),L[0].crossVectors(_[0],S[0]);for(let _e=1;_e<=e;_e++){if(S[_e]=S[_e-1].clone(),L[_e]=L[_e-1].clone(),k.crossVectors(_[_e-1],_[_e]),k.length()>Number.EPSILON){k.normalize();const Ee=Math.acos(Hr(_[_e-1].dot(_[_e]),-1,1));S[_e].applyMatrix4(F.makeRotationAxis(k,Ee))}L[_e].crossVectors(_[_e],S[_e])}if(!0===c){let _e=Math.acos(Hr(S[0].dot(S[e]),-1,1));_e/=e,_[0].dot(k.crossVectors(S[0],S[e]))>0&&(_e=-_e);for(let Ee=1;Ee<=e;Ee++)S[Ee].applyMatrix4(F.makeRotationAxis(_[Ee],_e*Ee)),L[Ee].crossVectors(_[Ee],S[Ee])}return{tangents:_,normals:S,binormals:L}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Fu extends Fa{constructor(e=0,c=0,d=1,_=1,S=0,L=2*Math.PI,k=!1,F=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=c,this.xRadius=d,this.yRadius=_,this.aStartAngle=S,this.aEndAngle=L,this.aClockwise=k,this.aRotation=F}getPoint(e,c){const d=c||new zn,_=2*Math.PI;let S=this.aEndAngle-this.aStartAngle;const L=Math.abs(S)<Number.EPSILON;for(;S<0;)S+=_;for(;S>_;)S-=_;S<Number.EPSILON&&(S=L?0:_),!0!==this.aClockwise||L||(S===_?S=-_:S-=_);const k=this.aStartAngle+e*S;let F=this.aX+this.xRadius*Math.cos(k),V=this.aY+this.yRadius*Math.sin(k);if(0!==this.aRotation){const te=Math.cos(this.aRotation),le=Math.sin(this.aRotation),ue=F-this.aX,_e=V-this.aY;F=ue*te-_e*le+this.aX,V=ue*le+_e*te+this.aY}return d.set(F,V)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Fu.prototype.isEllipseCurve=!0;class cu extends Fu{constructor(e,c,d,_,S,L){super(e,c,d,d,_,S,L),this.type="ArcCurve"}}function Xn(){let w=0,e=0,c=0,d=0;function _(S,L,k,F){w=S,e=k,c=-3*S+3*L-2*k-F,d=2*S-2*L+k+F}return{initCatmullRom:function(S,L,k,F,V){_(L,k,V*(k-S),V*(F-L))},initNonuniformCatmullRom:function(S,L,k,F,V,te,le){let ue=(L-S)/V-(k-S)/(V+te)+(k-L)/te,_e=(k-L)/te-(F-L)/(te+le)+(F-k)/le;ue*=te,_e*=te,_(L,k,ue,_e)},calc:function(S){const L=S*S;return w+e*S+c*L+d*(L*S)}}}cu.prototype.isArcCurve=!0;const Oi=new ht,Rh=new Xn,Pn=new Xn,Do=new Xn;class Gi extends Fa{constructor(e=[],c=!1,d="centripetal",_=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=c,this.curveType=d,this.tension=_}getPoint(e,c=new ht){const d=c,_=this.points,S=_.length,L=(S-(this.closed?0:1))*e;let k,F,V=Math.floor(L),te=L-V;this.closed?V+=V>0?0:(Math.floor(Math.abs(V)/S)+1)*S:0===te&&V===S-1&&(V=S-2,te=1),this.closed||V>0?k=_[(V-1)%S]:(Oi.subVectors(_[0],_[1]).add(_[0]),k=Oi);const le=_[V%S],ue=_[(V+1)%S];if(this.closed||V+2<S?F=_[(V+2)%S]:(Oi.subVectors(_[S-1],_[S-2]).add(_[S-1]),F=Oi),"centripetal"===this.curveType||"chordal"===this.curveType){const _e="chordal"===this.curveType?.5:.25;let Ee=Math.pow(k.distanceToSquared(le),_e),$e=Math.pow(le.distanceToSquared(ue),_e),Le=Math.pow(ue.distanceToSquared(F),_e);$e<1e-4&&($e=1),Ee<1e-4&&(Ee=$e),Le<1e-4&&(Le=$e),Rh.initNonuniformCatmullRom(k.x,le.x,ue.x,F.x,Ee,$e,Le),Pn.initNonuniformCatmullRom(k.y,le.y,ue.y,F.y,Ee,$e,Le),Do.initNonuniformCatmullRom(k.z,le.z,ue.z,F.z,Ee,$e,Le)}else"catmullrom"===this.curveType&&(Rh.initCatmullRom(k.x,le.x,ue.x,F.x,this.tension),Pn.initCatmullRom(k.y,le.y,ue.y,F.y,this.tension),Do.initCatmullRom(k.z,le.z,ue.z,F.z,this.tension));return d.set(Rh.calc(te),Pn.calc(te),Do.calc(te)),d}copy(e){super.copy(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++)this.points.push(e.points[c].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,d=this.points.length;c<d;c++)e.points.push(this.points[c].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++){const _=e.points[c];this.points.push((new ht).fromArray(_))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Qp(w,e,c,d,_){const S=.5*(d-e),L=.5*(_-c),k=w*w;return(2*c-2*d+S+L)*(w*k)+(-3*c+3*d-2*S-L)*k+S*w+c}function Ph(w,e,c,d){return function(_,S){const L=1-_;return L*L*S}(w,e)+2*(1-(_=w))*_*c+function(_,S){return _*_*S}(w,d);var _}function Du(w,e,c,d,_){return function(S,L){const k=1-S;return k*k*k*L}(w,e)+function(S,L){const k=1-S;return 3*k*k*S*L}(w,c)+3*(1-(S=w))*S*S*d+function(S,L){return S*S*S*L}(w,_);var S}Gi.prototype.isCatmullRomCurve3=!0;class na extends Fa{constructor(e=new zn,c=new zn,d=new zn,_=new zn){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=c,this.v2=d,this.v3=_}getPoint(e,c=new zn){const d=c,_=this.v0,S=this.v1,L=this.v2,k=this.v3;return d.set(Du(e,_.x,S.x,L.x,k.x),Du(e,_.y,S.y,L.y,k.y)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}na.prototype.isCubicBezierCurve=!0;class Qi extends Fa{constructor(e=new ht,c=new ht,d=new ht,_=new ht){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=c,this.v2=d,this.v3=_}getPoint(e,c=new ht){const d=c,_=this.v0,S=this.v1,L=this.v2,k=this.v3;return d.set(Du(e,_.x,S.x,L.x,k.x),Du(e,_.y,S.y,L.y,k.y),Du(e,_.z,S.z,L.z,k.z)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Qi.prototype.isCubicBezierCurve3=!0;class ra extends Fa{constructor(e=new zn,c=new zn){super(),this.type="LineCurve",this.v1=e,this.v2=c}getPoint(e,c=new zn){const d=c;return 1===e?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(e).add(this.v1)),d}getPointAt(e,c){return this.getPoint(e,c)}getTangent(e,c){const d=c||new zn;return d.copy(this.v2).sub(this.v1).normalize(),d}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}ra.prototype.isLineCurve=!0;class yl extends Fa{constructor(e=new ht,c=new ht){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=c}getPoint(e,c=new ht){const d=c;return 1===e?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(e).add(this.v1)),d}getPointAt(e,c){return this.getPoint(e,c)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oo extends Fa{constructor(e=new zn,c=new zn,d=new zn){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=c,this.v2=d}getPoint(e,c=new zn){const d=c,_=this.v0,S=this.v1,L=this.v2;return d.set(Ph(e,_.x,S.x,L.x),Ph(e,_.y,S.y,L.y)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}oo.prototype.isQuadraticBezierCurve=!0;class Ko extends Fa{constructor(e=new ht,c=new ht,d=new ht){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=c,this.v2=d}getPoint(e,c=new ht){const d=c,_=this.v0,S=this.v1,L=this.v2;return d.set(Ph(e,_.x,S.x,L.x),Ph(e,_.y,S.y,L.y),Ph(e,_.z,S.z,L.z)),d}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ko.prototype.isQuadraticBezierCurve3=!0;class xs extends Fa{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,c=new zn){const d=c,_=this.points,S=(_.length-1)*e,L=Math.floor(S),k=S-L,F=_[0===L?L:L-1],V=_[L],te=_[L>_.length-2?_.length-1:L+1],le=_[L>_.length-3?_.length-1:L+2];return d.set(Qp(k,F.x,V.x,te.x,le.x),Qp(k,F.y,V.y,te.y,le.y)),d}copy(e){super.copy(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++)this.points.push(e.points[c].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,d=this.points.length;c<d;c++)e.points.push(this.points[c].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,d=e.points.length;c<d;c++){const _=e.points[c];this.points.push((new zn).fromArray(_))}return this}}xs.prototype.isSplineCurve=!0;var uo=Object.freeze({__proto__:null,ArcCurve:cu,CatmullRomCurve3:Gi,CubicBezierCurve:na,CubicBezierCurve3:Qi,EllipseCurve:Fu,LineCurve:ra,LineCurve3:yl,QuadraticBezierCurve:oo,QuadraticBezierCurve3:Ko,SplineCurve:xs});function qo(w,e,c,d,_){let S,L;if(_===function(k,F,V,te){let le=0;for(let ue=F,_e=V-te;ue<V;ue+=te)le+=(k[_e]-k[ue])*(k[ue+1]+k[_e+1]),_e=ue;return le}(w,e,c,d)>0)for(S=e;S<c;S+=d)L=Yd(S,w[S],w[S+1],L);else for(S=c-d;S>=e;S-=d)L=Yd(S,w[S],w[S+1],L);return L&&dh(L,L.next)&&(Ti(L),L=L.next),L}function rs(w,e){if(!w)return w;e||(e=w);let c,d=w;do{if(c=!1,d.steiner||!dh(d,d.next)&&0!==ho(d.prev,d,d.next))d=d.next;else{if(Ti(d),d=e=d.prev,d===d.next)break;c=!0}}while(c||d!==e);return e}function wa(w,e,c,d,_,S,L){if(!w)return;!L&&S&&function(te,le,ue,_e){let Ee=te;do{null===Ee.z&&(Ee.z=Kp(Ee.x,Ee.y,le,ue,_e)),Ee.prevZ=Ee.prev,Ee.nextZ=Ee.next,Ee=Ee.next}while(Ee!==te);Ee.prevZ.nextZ=null,Ee.prevZ=null,function($e){let Le,Ne,We,tt,Ze,ot,st,Ct,Ft=1;do{for(Ne=$e,$e=null,Ze=null,ot=0;Ne;){for(ot++,We=Ne,st=0,Le=0;Le<Ft&&(st++,We=We.nextZ,We);Le++);for(Ct=Ft;st>0||Ct>0&&We;)0!==st&&(0===Ct||!We||Ne.z<=We.z)?(tt=Ne,Ne=Ne.nextZ,st--):(tt=We,We=We.nextZ,Ct--),Ze?Ze.nextZ=tt:$e=tt,tt.prevZ=Ze,Ze=tt;Ne=We}Ze.nextZ=null,Ft*=2}while(ot>1)}(Ee)}(w,d,_,S);let k,F,V=w;for(;w.prev!==w.next;)if(k=w.prev,F=w.next,S?so(w,d,_,S):Ih(w))e.push(k.i/c),e.push(w.i/c),e.push(F.i/c),Ti(w),w=F.next,V=F.next;else if((w=F)===V){L?1===L?wa(w=Sa(rs(w),e,c),e,c,d,_,S,2):2===L&&xl(w,e,c,d,_,S):wa(rs(w),e,c,d,_,S,1);break}}function Ih(w){const e=w.prev,c=w,d=w.next;if(ho(e,c,d)>=0)return!1;let _=w.next.next;for(;_!==w.prev;){if(Gl(e.x,e.y,c.x,c.y,d.x,d.y,_.x,_.y)&&ho(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function so(w,e,c,d){const _=w.prev,S=w,L=w.next;if(ho(_,S,L)>=0)return!1;const V=_.x>S.x?_.x>L.x?_.x:L.x:S.x>L.x?S.x:L.x,te=_.y>S.y?_.y>L.y?_.y:L.y:S.y>L.y?S.y:L.y,le=Kp(_.x<S.x?_.x<L.x?_.x:L.x:S.x<L.x?S.x:L.x,_.y<S.y?_.y<L.y?_.y:L.y:S.y<L.y?S.y:L.y,e,c,d),ue=Kp(V,te,e,c,d);let _e=w.prevZ,Ee=w.nextZ;for(;_e&&_e.z>=le&&Ee&&Ee.z<=ue;){if(_e!==w.prev&&_e!==w.next&&Gl(_.x,_.y,S.x,S.y,L.x,L.y,_e.x,_e.y)&&ho(_e.prev,_e,_e.next)>=0||(_e=_e.prevZ,Ee!==w.prev&&Ee!==w.next&&Gl(_.x,_.y,S.x,S.y,L.x,L.y,Ee.x,Ee.y)&&ho(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;_e&&_e.z>=le;){if(_e!==w.prev&&_e!==w.next&&Gl(_.x,_.y,S.x,S.y,L.x,L.y,_e.x,_e.y)&&ho(_e.prev,_e,_e.next)>=0)return!1;_e=_e.prevZ}for(;Ee&&Ee.z<=ue;){if(Ee!==w.prev&&Ee!==w.next&&Gl(_.x,_.y,S.x,S.y,L.x,L.y,Ee.x,Ee.y)&&ho(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function Sa(w,e,c){let d=w;do{const _=d.prev,S=d.next.next;!dh(_,S)&&hu(_,d,d.next,S)&&ws(_,S)&&ws(S,_)&&(e.push(_.i/c),e.push(d.i/c),e.push(S.i/c),Ti(d),Ti(d.next),d=w=S),d=d.next}while(d!==w);return rs(d)}function xl(w,e,c,d,_,S){let L=w;do{let k=L.next.next;for(;k!==L.prev;){if(L.i!==k.i&&Uu(L,k)){let F=Xd(L,k);return L=rs(L,L.next),F=rs(F,F.next),wa(L,e,c,d,_,S),void wa(F,e,c,d,_,S)}k=k.next}L=L.next}while(L!==w)}function uu(w,e){return w.x-e.x}function Da(w,e){if(e=function(c,d){let _=d;const S=c.x,L=c.y;let k,F=-1/0;do{if(L<=_.y&&L>=_.next.y&&_.next.y!==_.y){const Ee=_.x+(L-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(Ee<=S&&Ee>F){if(F=Ee,Ee===S){if(L===_.y)return _;if(L===_.next.y)return _.next}k=_.x<_.next.x?_:_.next}}_=_.next}while(_!==d);if(!k)return null;if(S===F)return k;const V=k,te=k.x,le=k.y;let ue,_e=1/0;_=k;do{S>=_.x&&_.x>=te&&S!==_.x&&Gl(L<le?S:F,L,te,le,L<le?F:S,L,_.x,_.y)&&(ue=Math.abs(L-_.y)/(S-_.x),ws(_,c)&&(ue<_e||ue===_e&&(_.x>k.x||_.x===k.x&&as(k,_)))&&(k=_,_e=ue)),_=_.next}while(_!==V);return k}(w,e)){const c=Xd(e,w);rs(e,e.next),rs(c,c.next)}}function as(w,e){return ho(w.prev,w,e.prev)<0&&ho(e.next,w,w.next)<0}function Kp(w,e,c,d,_){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w=32767*(w-c)*_)|w<<8))|w<<4))|w<<2))|w<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-d)*_)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function wl(w){let e=w,c=w;do{(e.x<c.x||e.x===c.x&&e.y<c.y)&&(c=e),e=e.next}while(e!==w);return c}function Gl(w,e,c,d,_,S,L,k){return(_-L)*(e-k)-(w-L)*(S-k)>=0&&(w-L)*(d-k)-(c-L)*(e-k)>=0&&(c-L)*(S-k)-(_-L)*(d-k)>=0}function Uu(w,e){return w.next.i!==e.i&&w.prev.i!==e.i&&!function(c,d){let _=c;do{if(_.i!==c.i&&_.next.i!==c.i&&_.i!==d.i&&_.next.i!==d.i&&hu(_,_.next,c,d))return!0;_=_.next}while(_!==c);return!1}(w,e)&&(ws(w,e)&&ws(e,w)&&function(c,d){let _=c,S=!1;const L=(c.x+d.x)/2,k=(c.y+d.y)/2;do{_.y>k!=_.next.y>k&&_.next.y!==_.y&&L<(_.next.x-_.x)*(k-_.y)/(_.next.y-_.y)+_.x&&(S=!S),_=_.next}while(_!==c);return S}(w,e)&&(ho(w.prev,w,e.prev)||ho(w,e.prev,e))||dh(w,e)&&ho(w.prev,w,w.next)>0&&ho(e.prev,e,e.next)>0)}function ho(w,e,c){return(e.y-w.y)*(c.x-e.x)-(e.x-w.x)*(c.y-e.y)}function dh(w,e){return w.x===e.x&&w.y===e.y}function hu(w,e,c,d){const _=Hi(ho(w,e,c)),S=Hi(ho(w,e,d)),L=Hi(ho(c,d,w)),k=Hi(ho(c,d,e));return _!==S&&L!==k||!(0!==_||!ls(w,c,e))||!(0!==S||!ls(w,d,e))||!(0!==L||!ls(c,w,d))||!(0!==k||!ls(c,e,d))}function ls(w,e,c){return e.x<=Math.max(w.x,c.x)&&e.x>=Math.min(w.x,c.x)&&e.y<=Math.max(w.y,c.y)&&e.y>=Math.min(w.y,c.y)}function Hi(w){return w>0?1:w<0?-1:0}function ws(w,e){return ho(w.prev,w,w.next)<0?ho(w,e,w.next)>=0&&ho(w,w.prev,e)>=0:ho(w,e,w.prev)<0||ho(w,w.next,e)<0}function Xd(w,e){const c=new dc(w.i,w.x,w.y),d=new dc(e.i,e.x,e.y),_=w.next,S=e.prev;return w.next=e,e.prev=w,c.next=_,_.prev=c,d.next=c,c.prev=d,S.next=d,d.prev=S,d}function Yd(w,e,c,d){const _=new dc(w,e,c);return d?(_.next=d.next,_.prev=d,d.next.prev=_,d.next=_):(_.prev=_,_.next=_),_}function Ti(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function dc(w,e,c){this.i=w,this.x=e,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ss{static area(e){const c=e.length;let d=0;for(let _=c-1,S=0;S<c;_=S++)d+=e[_].x*e[S].y-e[S].x*e[_].y;return.5*d}static isClockWise(e){return Ss.area(e)<0}static triangulateShape(e,c){const d=[],_=[],S=[];ed(e),td(d,e);let L=e.length;c.forEach(ed);for(let F=0;F<c.length;F++)_.push(L),L+=c[F].length,td(d,c[F]);const k=function(F,V,te=2){const le=V&&V.length,ue=le?V[0]*te:F.length;let _e=qo(F,0,ue,te,!0);const Ee=[];if(!_e||_e.next===_e.prev)return Ee;let $e,Le,Ne,We,tt,Ze,ot;if(le&&(_e=function(st,Ct,Ft,Qe){const nt=[];let Tt,Yt,ct,Lt,_t;for(Tt=0,Yt=Ct.length;Tt<Yt;Tt++)ct=Ct[Tt]*Qe,Lt=Tt<Yt-1?Ct[Tt+1]*Qe:st.length,_t=qo(st,ct,Lt,Qe,!1),_t===_t.next&&(_t.steiner=!0),nt.push(wl(_t));for(nt.sort(uu),Tt=0;Tt<nt.length;Tt++)Da(nt[Tt],Ft),Ft=rs(Ft,Ft.next);return Ft}(F,V,_e,te)),F.length>80*te){$e=Ne=F[0],Le=We=F[1];for(let st=te;st<ue;st+=te)tt=F[st],Ze=F[st+1],tt<$e&&($e=tt),Ze<Le&&(Le=Ze),tt>Ne&&(Ne=tt),Ze>We&&(We=Ze);ot=Math.max(Ne-$e,We-Le),ot=0!==ot?1/ot:0}return wa(_e,Ee,te,$e,Le,ot),Ee}(d,_);for(let F=0;F<k.length;F+=3)S.push(k.slice(F,F+3));return S}}function ed(w){const e=w.length;e>2&&w[e-1].equals(w[0])&&w.pop()}function td(w,e){for(let c=0;c<e.length;c++)w.push(e[c].x),w.push(e[c].y)}class Ua extends br{constructor(e,c){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:c},e=Array.isArray(e)?e:[e];const d=this,_=[],S=[];for(let k=0,F=e.length;k<F;k++)L(e[k]);function L(k){const F=[],V=void 0!==c.curveSegments?c.curveSegments:12,te=void 0!==c.steps?c.steps:1;let le=void 0!==c.depth?c.depth:100,ue=void 0===c.bevelEnabled||c.bevelEnabled,_e=void 0!==c.bevelThickness?c.bevelThickness:6,Ee=void 0!==c.bevelSize?c.bevelSize:_e-2,$e=void 0!==c.bevelOffset?c.bevelOffset:0,Le=void 0!==c.bevelSegments?c.bevelSegments:3;const Ne=c.extrudePath,We=void 0!==c.UVGenerator?c.UVGenerator:pu;void 0!==c.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),le=c.amount);let tt,Ze,ot,st,Ct,Ft=!1;Ne&&(tt=Ne.getSpacedPoints(te),Ft=!0,ue=!1,Ze=Ne.computeFrenetFrames(te,!1),ot=new ht,st=new ht,Ct=new ht),ue||(Le=0,_e=0,Ee=0,$e=0);const Qe=k.extractPoints(V);let nt=Qe.shape;const Tt=Qe.holes;if(!Ss.isClockWise(nt)){nt=nt.reverse();for(let cn=0,mt=Tt.length;cn<mt;cn++){const Kt=Tt[cn];Ss.isClockWise(Kt)&&(Tt[cn]=Kt.reverse())}}const Yt=Ss.triangulateShape(nt,Tt),ct=nt;for(let cn=0,mt=Tt.length;cn<mt;cn++)nt=nt.concat(Tt[cn]);function Lt(cn,mt,Kt){return mt||console.error("THREE.ExtrudeGeometry: vec does not exist"),mt.clone().multiplyScalar(Kt).add(cn)}const _t=nt.length,zt=Yt.length;function Rt(cn,mt,Kt){let Vt,yn,Nn;const pr=cn.x-mt.x,_r=cn.y-mt.y,jr=Kt.x-cn.x,ki=Kt.y-cn.y,mo=pr*pr+_r*_r;if(Math.abs(pr*ki-_r*jr)>Number.EPSILON){const zo=Math.sqrt(mo),Ma=Math.sqrt(jr*jr+ki*ki),ju=mt.x-_r/zo,Ld=mt.y+pr/zo,Bd=((Kt.x-ki/Ma-ju)*ki-(Kt.y+jr/Ma-Ld)*jr)/(pr*ki-_r*jr);Vt=ju+pr*Bd-cn.x,yn=Ld+_r*Bd-cn.y;const Oh=Vt*Vt+yn*yn;if(Oh<=2)return new zn(Vt,yn);Nn=Math.sqrt(Oh/2)}else{let zo=!1;pr>Number.EPSILON?jr>Number.EPSILON&&(zo=!0):pr<-Number.EPSILON?jr<-Number.EPSILON&&(zo=!0):Math.sign(_r)===Math.sign(ki)&&(zo=!0),zo?(Vt=-_r,yn=pr,Nn=Math.sqrt(mo)):(Vt=pr,yn=_r,Nn=Math.sqrt(mo/2))}return new zn(Vt/Nn,yn/Nn)}const nn=[];for(let cn=0,mt=ct.length,Kt=mt-1,Vt=cn+1;cn<mt;cn++,Kt++,Vt++)Kt===mt&&(Kt=0),Vt===mt&&(Vt=0),nn[cn]=Rt(ct[cn],ct[Kt],ct[Vt]);const en=[];let Mn,rt=nn.concat();for(let cn=0,mt=Tt.length;cn<mt;cn++){const Kt=Tt[cn];Mn=[];for(let Vt=0,yn=Kt.length,Nn=yn-1,pr=Vt+1;Vt<yn;Vt++,Nn++,pr++)Nn===yn&&(Nn=0),pr===yn&&(pr=0),Mn[Vt]=Rt(Kt[Vt],Kt[Nn],Kt[pr]);en.push(Mn),rt=rt.concat(Mn)}for(let cn=0;cn<Le;cn++){const mt=cn/Le,Kt=_e*Math.cos(mt*Math.PI/2),Vt=Ee*Math.sin(mt*Math.PI/2)+$e;for(let yn=0,Nn=ct.length;yn<Nn;yn++){const pr=Lt(ct[yn],nn[yn],Vt);un(pr.x,pr.y,-Kt)}for(let yn=0,Nn=Tt.length;yn<Nn;yn++){const pr=Tt[yn];Mn=en[yn];for(let _r=0,jr=pr.length;_r<jr;_r++){const ki=Lt(pr[_r],Mn[_r],Vt);un(ki.x,ki.y,-Kt)}}}const ut=Ee+$e;for(let cn=0;cn<_t;cn++){const mt=ue?Lt(nt[cn],rt[cn],ut):nt[cn];Ft?(st.copy(Ze.normals[0]).multiplyScalar(mt.x),ot.copy(Ze.binormals[0]).multiplyScalar(mt.y),Ct.copy(tt[0]).add(st).add(ot),un(Ct.x,Ct.y,Ct.z)):un(mt.x,mt.y,0)}for(let cn=1;cn<=te;cn++)for(let mt=0;mt<_t;mt++){const Kt=ue?Lt(nt[mt],rt[mt],ut):nt[mt];Ft?(st.copy(Ze.normals[cn]).multiplyScalar(Kt.x),ot.copy(Ze.binormals[cn]).multiplyScalar(Kt.y),Ct.copy(tt[cn]).add(st).add(ot),un(Ct.x,Ct.y,Ct.z)):un(Kt.x,Kt.y,le/te*cn)}for(let cn=Le-1;cn>=0;cn--){const mt=cn/Le,Kt=_e*Math.cos(mt*Math.PI/2),Vt=Ee*Math.sin(mt*Math.PI/2)+$e;for(let yn=0,Nn=ct.length;yn<Nn;yn++){const pr=Lt(ct[yn],nn[yn],Vt);un(pr.x,pr.y,le+Kt)}for(let yn=0,Nn=Tt.length;yn<Nn;yn++){const pr=Tt[yn];Mn=en[yn];for(let _r=0,jr=pr.length;_r<jr;_r++){const ki=Lt(pr[_r],Mn[_r],Vt);Ft?un(ki.x,ki.y+tt[te-1].y,tt[te-1].x+Kt):un(ki.x,ki.y,le+Kt)}}}function rn(cn,mt){let Kt=cn.length;for(;--Kt>=0;){const Vt=Kt;let yn=Kt-1;yn<0&&(yn=cn.length-1);for(let Nn=0,pr=te+2*Le;Nn<pr;Nn++){const _r=_t*Nn,jr=_t*(Nn+1);kn(mt+Vt+_r,mt+yn+_r,mt+yn+jr,mt+Vt+jr)}}}function un(cn,mt,Kt){F.push(cn),F.push(mt),F.push(Kt)}function gn(cn,mt,Kt){Jn(cn),Jn(mt),Jn(Kt);const Vt=_.length/3,yn=We.generateTopUV(d,_,Vt-3,Vt-2,Vt-1);Zn(yn[0]),Zn(yn[1]),Zn(yn[2])}function kn(cn,mt,Kt,Vt){Jn(cn),Jn(mt),Jn(Vt),Jn(mt),Jn(Kt),Jn(Vt);const yn=_.length/3,Nn=We.generateSideWallUV(d,_,yn-6,yn-3,yn-2,yn-1);Zn(Nn[0]),Zn(Nn[1]),Zn(Nn[3]),Zn(Nn[1]),Zn(Nn[2]),Zn(Nn[3])}function Jn(cn){_.push(F[3*cn+0]),_.push(F[3*cn+1]),_.push(F[3*cn+2])}function Zn(cn){S.push(cn.x),S.push(cn.y)}(function(){const cn=_.length/3;if(ue){let mt=0,Kt=_t*mt;for(let Vt=0;Vt<zt;Vt++){const yn=Yt[Vt];gn(yn[2]+Kt,yn[1]+Kt,yn[0]+Kt)}mt=te+2*Le,Kt=_t*mt;for(let Vt=0;Vt<zt;Vt++){const yn=Yt[Vt];gn(yn[0]+Kt,yn[1]+Kt,yn[2]+Kt)}}else{for(let mt=0;mt<zt;mt++){const Kt=Yt[mt];gn(Kt[2],Kt[1],Kt[0])}for(let mt=0;mt<zt;mt++){const Kt=Yt[mt];gn(Kt[0]+_t*te,Kt[1]+_t*te,Kt[2]+_t*te)}}d.addGroup(cn,_.length/3-cn,0)})(),function(){const cn=_.length/3;let mt=0;rn(ct,mt),mt+=ct.length;for(let Kt=0,Vt=Tt.length;Kt<Vt;Kt++){const yn=Tt[Kt];rn(yn,mt),mt+=yn.length}d.addGroup(cn,_.length/3-cn,1)}()}this.setAttribute("position",new hn(_,3)),this.setAttribute("uv",new hn(S,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(c,d,_){if(_.shapes=[],Array.isArray(c))for(let S=0,L=c.length;S<L;S++)_.shapes.push(c[S].uuid);else _.shapes.push(c.uuid);return void 0!==d.extrudePath&&(_.options.extrudePath=d.extrudePath.toJSON()),_}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,c){const d=[];for(let S=0,L=e.shapes.length;S<L;S++)d.push(c[e.shapes[S]]);const _=e.options.extrudePath;return void 0!==_&&(e.options.extrudePath=(new uo[_.type]).fromJSON(_)),new Ua(d,e.options)}}const pu={generateTopUV:function(w,e,c,d,_){const k=e[3*d],F=e[3*d+1],V=e[3*_],te=e[3*_+1];return[new zn(e[3*c],e[3*c+1]),new zn(k,F),new zn(V,te)]},generateSideWallUV:function(w,e,c,d,_,S){const L=e[3*c],k=e[3*c+1],F=e[3*c+2],V=e[3*d],te=e[3*d+1],le=e[3*d+2],ue=e[3*_],_e=e[3*_+1],Ee=e[3*_+2],$e=e[3*S],Le=e[3*S+1],Ne=e[3*S+2];return Math.abs(k-te)<Math.abs(L-V)?[new zn(L,1-F),new zn(V,1-le),new zn(ue,1-Ee),new zn($e,1-Ne)]:[new zn(k,1-F),new zn(te,1-le),new zn(_e,1-Ee),new zn(Le,1-Ne)]}};class sp extends au{constructor(e=1,c=0){const d=(1+Math.sqrt(5))/2;super([-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,c),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new sp(e.radius,e.detail)}}class vi extends br{constructor(e,c=12,d=0,_=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:c,phiStart:d,phiLength:_},c=Math.floor(c),_=Hr(_,0,2*Math.PI);const S=[],L=[],k=[],F=1/c,V=new ht,te=new zn;for(let le=0;le<=c;le++){const ue=d+le*F*_,_e=Math.sin(ue),Ee=Math.cos(ue);for(let $e=0;$e<=e.length-1;$e++)V.x=e[$e].x*_e,V.y=e[$e].y,V.z=e[$e].x*Ee,L.push(V.x,V.y,V.z),te.x=le/c,te.y=$e/(e.length-1),k.push(te.x,te.y)}for(let le=0;le<c;le++)for(let ue=0;ue<e.length-1;ue++){const _e=ue+le*e.length,$e=_e+e.length,Le=_e+e.length+1,Ne=_e+1;S.push(_e,$e,Ne),S.push($e,Le,Ne)}if(this.setIndex(S),this.setAttribute("position",new hn(L,3)),this.setAttribute("uv",new hn(k,2)),this.computeVertexNormals(),_===2*Math.PI){const le=this.attributes.normal.array,ue=new ht,_e=new ht,Ee=new ht,$e=c*e.length*3;for(let Le=0,Ne=0;Le<e.length;Le++,Ne+=3)ue.x=le[Ne+0],ue.y=le[Ne+1],ue.z=le[Ne+2],_e.x=le[$e+Ne+0],_e.y=le[$e+Ne+1],_e.z=le[$e+Ne+2],Ee.addVectors(ue,_e).normalize(),le[Ne+0]=le[$e+Ne+0]=Ee.x,le[Ne+1]=le[$e+Ne+1]=Ee.y,le[Ne+2]=le[$e+Ne+2]=Ee.z}}static fromJSON(e){return new vi(e.points,e.segments,e.phiStart,e.phiLength)}}class xr extends au{constructor(e=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,c),this.type="OctahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new xr(e.radius,e.detail)}}class a extends br{constructor(e,c,d){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:c,stacks:d};const _=[],S=[],L=[],k=[],F=1e-5,V=new ht,te=new ht,le=new ht,ue=new ht,_e=new ht;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const Ee=c+1;for(let $e=0;$e<=d;$e++){const Le=$e/d;for(let Ne=0;Ne<=c;Ne++){const We=Ne/c;e(We,Le,te),S.push(te.x,te.y,te.z),We-F>=0?(e(We-F,Le,le),ue.subVectors(te,le)):(e(We+F,Le,le),ue.subVectors(le,te)),Le-F>=0?(e(We,Le-F,le),_e.subVectors(te,le)):(e(We,Le+F,le),_e.subVectors(le,te)),V.crossVectors(ue,_e).normalize(),L.push(V.x,V.y,V.z),k.push(We,Le)}}for(let $e=0;$e<d;$e++)for(let Le=0;Le<c;Le++){const We=$e*Ee+Le+1,tt=($e+1)*Ee+Le+1,Ze=($e+1)*Ee+Le;_.push($e*Ee+Le,We,Ze),_.push(We,tt,Ze)}this.setIndex(_),this.setAttribute("position",new hn(S,3)),this.setAttribute("normal",new hn(L,3)),this.setAttribute("uv",new hn(k,2))}}class r extends br{constructor(e=.5,c=1,d=8,_=1,S=0,L=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:c,thetaSegments:d,phiSegments:_,thetaStart:S,thetaLength:L},d=Math.max(3,d);const k=[],F=[],V=[],te=[];let le=e;const ue=(c-e)/(_=Math.max(1,_)),_e=new ht,Ee=new zn;for(let $e=0;$e<=_;$e++){for(let Le=0;Le<=d;Le++){const Ne=S+Le/d*L;_e.x=le*Math.cos(Ne),_e.y=le*Math.sin(Ne),F.push(_e.x,_e.y,_e.z),V.push(0,0,1),Ee.x=(_e.x/c+1)/2,Ee.y=(_e.y/c+1)/2,te.push(Ee.x,Ee.y)}le+=ue}for(let $e=0;$e<_;$e++){const Le=$e*(d+1);for(let Ne=0;Ne<d;Ne++){const We=Ne+Le,Ze=We+d+1,ot=We+d+2,st=We+1;k.push(We,Ze,st),k.push(Ze,ot,st)}}this.setIndex(k),this.setAttribute("position",new hn(F,3)),this.setAttribute("normal",new hn(V,3)),this.setAttribute("uv",new hn(te,2))}static fromJSON(e){return new r(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class h extends br{constructor(e,c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:c};const d=[],_=[],S=[],L=[];let k=0,F=0;if(!1===Array.isArray(e))V(e);else for(let te=0;te<e.length;te++)V(e[te]),this.addGroup(k,F,te),k+=F,F=0;function V(te){const le=_.length/3,ue=te.extractPoints(c);let _e=ue.shape;const Ee=ue.holes;!1===Ss.isClockWise(_e)&&(_e=_e.reverse());for(let Le=0,Ne=Ee.length;Le<Ne;Le++){const We=Ee[Le];!0===Ss.isClockWise(We)&&(Ee[Le]=We.reverse())}const $e=Ss.triangulateShape(_e,Ee);for(let Le=0,Ne=Ee.length;Le<Ne;Le++)_e=_e.concat(Ee[Le]);for(let Le=0,Ne=_e.length;Le<Ne;Le++){const We=_e[Le];_.push(We.x,We.y,0),S.push(0,0,1),L.push(We.x,We.y)}for(let Le=0,Ne=$e.length;Le<Ne;Le++){const We=$e[Le];d.push(We[0]+le,We[1]+le,We[2]+le),F+=3}}this.setIndex(d),this.setAttribute("position",new hn(_,3)),this.setAttribute("normal",new hn(S,3)),this.setAttribute("uv",new hn(L,2))}toJSON(){const e=super.toJSON();return function(c,d){if(d.shapes=[],Array.isArray(c))for(let _=0,S=c.length;_<S;_++)d.shapes.push(c[_].uuid);else d.shapes.push(c.uuid);return d}(this.parameters.shapes,e)}static fromJSON(e,c){const d=[];for(let _=0,S=e.shapes.length;_<S;_++)d.push(c[e.shapes[_]]);return new h(d,e.curveSegments)}}class p extends br{constructor(e=1,c=32,d=16,_=0,S=2*Math.PI,L=0,k=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:c,heightSegments:d,phiStart:_,phiLength:S,thetaStart:L,thetaLength:k},c=Math.max(3,Math.floor(c)),d=Math.max(2,Math.floor(d));const F=Math.min(L+k,Math.PI);let V=0;const te=[],le=new ht,ue=new ht,_e=[],Ee=[],$e=[],Le=[];for(let Ne=0;Ne<=d;Ne++){const We=[],tt=Ne/d;let Ze=0;0==Ne&&0==L?Ze=.5/c:Ne==d&&F==Math.PI&&(Ze=-.5/c);for(let ot=0;ot<=c;ot++){const st=ot/c;le.x=-e*Math.cos(_+st*S)*Math.sin(L+tt*k),le.y=e*Math.cos(L+tt*k),le.z=e*Math.sin(_+st*S)*Math.sin(L+tt*k),Ee.push(le.x,le.y,le.z),ue.copy(le).normalize(),$e.push(ue.x,ue.y,ue.z),Le.push(st+Ze,1-tt),We.push(V++)}te.push(We)}for(let Ne=0;Ne<d;Ne++)for(let We=0;We<c;We++){const Ze=te[Ne][We],ot=te[Ne+1][We],st=te[Ne+1][We+1];(0!==Ne||L>0)&&_e.push(te[Ne][We+1],Ze,st),(Ne!==d-1||F<Math.PI)&&_e.push(Ze,ot,st)}this.setIndex(_e),this.setAttribute("position",new hn(Ee,3)),this.setAttribute("normal",new hn($e,3)),this.setAttribute("uv",new hn(Le,2))}static fromJSON(e){return new p(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class y extends au{constructor(e=1,c=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,c),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new y(e.radius,e.detail)}}class b extends Ua{constructor(e,c={}){const d=c.font;if(!d||!d.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new br;const _=d.generateShapes(e,c.size);c.depth=void 0!==c.height?c.height:50,void 0===c.bevelThickness&&(c.bevelThickness=10),void 0===c.bevelSize&&(c.bevelSize=8),void 0===c.bevelEnabled&&(c.bevelEnabled=!1),super(_,c),this.type="TextGeometry"}}class N extends br{constructor(e=1,c=.4,d=8,_=6,S=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:c,radialSegments:d,tubularSegments:_,arc:S},d=Math.floor(d),_=Math.floor(_);const L=[],k=[],F=[],V=[],te=new ht,le=new ht,ue=new ht;for(let _e=0;_e<=d;_e++)for(let Ee=0;Ee<=_;Ee++){const $e=Ee/_*S,Le=_e/d*Math.PI*2;le.x=(e+c*Math.cos(Le))*Math.cos($e),le.y=(e+c*Math.cos(Le))*Math.sin($e),le.z=c*Math.sin(Le),k.push(le.x,le.y,le.z),te.x=e*Math.cos($e),te.y=e*Math.sin($e),ue.subVectors(le,te).normalize(),F.push(ue.x,ue.y,ue.z),V.push(Ee/_),V.push(_e/d)}for(let _e=1;_e<=d;_e++)for(let Ee=1;Ee<=_;Ee++){const Le=(_+1)*(_e-1)+Ee-1,Ne=(_+1)*(_e-1)+Ee,We=(_+1)*_e+Ee;L.push((_+1)*_e+Ee-1,Le,We),L.push(Le,Ne,We)}this.setIndex(L),this.setAttribute("position",new hn(k,3)),this.setAttribute("normal",new hn(F,3)),this.setAttribute("uv",new hn(V,2))}static fromJSON(e){return new N(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class O extends br{constructor(e=1,c=.4,d=64,_=8,S=2,L=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:c,tubularSegments:d,radialSegments:_,p:S,q:L},d=Math.floor(d),_=Math.floor(_);const k=[],F=[],V=[],te=[],le=new ht,ue=new ht,_e=new ht,Ee=new ht,$e=new ht,Le=new ht,Ne=new ht;for(let tt=0;tt<=d;++tt){const Ze=tt/d*S*Math.PI*2;We(Ze,S,L,e,_e),We(Ze+.01,S,L,e,Ee),Le.subVectors(Ee,_e),Ne.addVectors(Ee,_e),$e.crossVectors(Le,Ne),Ne.crossVectors($e,Le),$e.normalize(),Ne.normalize();for(let ot=0;ot<=_;++ot){const st=ot/_*Math.PI*2,Ct=-c*Math.cos(st),Ft=c*Math.sin(st);le.x=_e.x+(Ct*Ne.x+Ft*$e.x),le.y=_e.y+(Ct*Ne.y+Ft*$e.y),le.z=_e.z+(Ct*Ne.z+Ft*$e.z),F.push(le.x,le.y,le.z),ue.subVectors(le,_e).normalize(),V.push(ue.x,ue.y,ue.z),te.push(tt/d),te.push(ot/_)}}for(let tt=1;tt<=d;tt++)for(let Ze=1;Ze<=_;Ze++){const st=(_+1)*tt+(Ze-1),Ct=(_+1)*tt+Ze,Ft=(_+1)*(tt-1)+Ze;k.push((_+1)*(tt-1)+(Ze-1),st,Ft),k.push(st,Ct,Ft)}function We(tt,Ze,ot,st,Ct){const Ft=Math.cos(tt),Qe=Math.sin(tt),nt=ot/Ze*tt,Tt=Math.cos(nt);Ct.x=st*(2+Tt)*.5*Ft,Ct.y=st*(2+Tt)*Qe*.5,Ct.z=st*Math.sin(nt)*.5}this.setIndex(k),this.setAttribute("position",new hn(F,3)),this.setAttribute("normal",new hn(V,3)),this.setAttribute("uv",new hn(te,2))}static fromJSON(e){return new O(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class T extends br{constructor(e,c=64,d=1,_=8,S=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:c,radius:d,radialSegments:_,closed:S};const L=e.computeFrenetFrames(c,S);this.tangents=L.tangents,this.normals=L.normals,this.binormals=L.binormals;const k=new ht,F=new ht,V=new zn;let te=new ht;const le=[],ue=[],_e=[],Ee=[];function $e(Le){te=e.getPointAt(Le/c,te);const Ne=L.normals[Le],We=L.binormals[Le];for(let tt=0;tt<=_;tt++){const Ze=tt/_*Math.PI*2,ot=Math.sin(Ze),st=-Math.cos(Ze);F.x=st*Ne.x+ot*We.x,F.y=st*Ne.y+ot*We.y,F.z=st*Ne.z+ot*We.z,F.normalize(),ue.push(F.x,F.y,F.z),k.x=te.x+d*F.x,k.y=te.y+d*F.y,k.z=te.z+d*F.z,le.push(k.x,k.y,k.z)}}(function(){for(let Le=0;Le<c;Le++)$e(Le);$e(!1===S?c:0),function(){for(let Le=0;Le<=c;Le++)for(let Ne=0;Ne<=_;Ne++)V.x=Le/c,V.y=Ne/_,_e.push(V.x,V.y)}(),function(){for(let Le=1;Le<=c;Le++)for(let Ne=1;Ne<=_;Ne++){const tt=(_+1)*Le+(Ne-1),Ze=(_+1)*Le+Ne,ot=(_+1)*(Le-1)+Ne;Ee.push((_+1)*(Le-1)+(Ne-1),tt,ot),Ee.push(tt,Ze,ot)}}()})(),this.setIndex(Ee),this.setAttribute("position",new hn(le,3)),this.setAttribute("normal",new hn(ue,3)),this.setAttribute("uv",new hn(_e,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new T((new uo[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class z extends br{constructor(e){if(super(),this.type="WireframeGeometry",!0===e.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const c=[],d=new Set,_=new ht,S=new ht;if(null!==e.index){const L=e.attributes.position,k=e.index;let F=e.groups;0===F.length&&(F=[{start:0,count:k.count,materialIndex:0}]);for(let V=0,te=F.length;V<te;++V){const le=F[V],ue=le.start;for(let _e=ue,Ee=ue+le.count;_e<Ee;_e+=3)for(let $e=0;$e<3;$e++){const Le=k.getX(_e+$e),Ne=k.getX(_e+($e+1)%3);_.fromBufferAttribute(L,Le),S.fromBufferAttribute(L,Ne),!0===ee(_,S,d)&&(c.push(_.x,_.y,_.z),c.push(S.x,S.y,S.z))}}}else{const L=e.attributes.position;for(let k=0,F=L.count/3;k<F;k++)for(let V=0;V<3;V++){const le=3*k+(V+1)%3;_.fromBufferAttribute(L,3*k+V),S.fromBufferAttribute(L,le),!0===ee(_,S,d)&&(c.push(_.x,_.y,_.z),c.push(S.x,S.y,S.z))}}this.setAttribute("position",new hn(c,3))}}function ee(w,e,c){const d=`${w.x},${w.y},${w.z}-${e.x},${e.y},${e.z}`,_=`${e.x},${e.y},${e.z}-${w.x},${w.y},${w.z}`;return!0!==c.has(d)&&!0!==c.has(_)&&(c.add(d,_),!0)}var oe=Object.freeze({__proto__:null,BoxGeometry:tc,BoxBufferGeometry:tc,CircleGeometry:su,CircleBufferGeometry:su,ConeGeometry:Zp,ConeBufferGeometry:Zp,CylinderGeometry:rl,CylinderBufferGeometry:rl,DodecahedronGeometry:eo,DodecahedronBufferGeometry:eo,EdgesGeometry:lu,ExtrudeGeometry:Ua,ExtrudeBufferGeometry:Ua,IcosahedronGeometry:sp,IcosahedronBufferGeometry:sp,LatheGeometry:vi,LatheBufferGeometry:vi,OctahedronGeometry:xr,OctahedronBufferGeometry:xr,ParametricGeometry:a,ParametricBufferGeometry:a,PlaneGeometry:Eu,PlaneBufferGeometry:Eu,PolyhedronGeometry:au,PolyhedronBufferGeometry:au,RingGeometry:r,RingBufferGeometry:r,ShapeGeometry:h,ShapeBufferGeometry:h,SphereGeometry:p,SphereBufferGeometry:p,TetrahedronGeometry:y,TetrahedronBufferGeometry:y,TextGeometry:b,TextBufferGeometry:b,TorusGeometry:N,TorusBufferGeometry:N,TorusKnotGeometry:O,TorusKnotBufferGeometry:O,TubeGeometry:T,TubeBufferGeometry:T,WireframeGeometry:z});class ne extends $s{constructor(e){super(),this.type="ShadowMaterial",this.color=new Kn(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}ne.prototype.isShadowMaterial=!0;class ve extends $s{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Kn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}ve.prototype.isMeshStandardMaterial=!0;class xe extends ve{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new zn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Hr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenTint=new Kn(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new Kn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new Kn(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}xe.prototype.isMeshPhysicalMaterial=!0;class Te extends $s{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Kn(16777215),this.specular=new Kn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Te.prototype.isMeshPhongMaterial=!0;class Ce extends $s{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Kn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Ce.prototype.isMeshToonMaterial=!0;class Ie extends $s{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Ie.prototype.isMeshNormalMaterial=!0;class Oe extends $s{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Kn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Oe.prototype.isMeshLambertMaterial=!0;class Fe extends $s{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Kn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new zn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Fe.prototype.isMeshMatcapMaterial=!0;class je extends kt{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}je.prototype.isLineDashedMaterial=!0;var Ue=Object.freeze({__proto__:null,ShadowMaterial:ne,SpriteMaterial:Jp,RawShaderMaterial:Mu,ShaderMaterial:Rs,PointsMaterial:gi,MeshPhysicalMaterial:xe,MeshStandardMaterial:ve,MeshPhongMaterial:Te,MeshToonMaterial:Ce,MeshNormalMaterial:Ie,MeshLambertMaterial:Oe,MeshDepthMaterial:Vd,MeshDistanceMaterial:Op,MeshBasicMaterial:fl,MeshMatcapMaterial:Fe,LineDashedMaterial:je,LineBasicMaterial:kt,Material:$s});const Ye={arraySlice:function(w,e,c){return Ye.isTypedArray(w)?new w.constructor(w.subarray(e,void 0!==c?c:w.length)):w.slice(e,c)},convertArray:function(w,e,c){return!w||!c&&w.constructor===e?w:"number"==typeof e.BYTES_PER_ELEMENT?new e(w):Array.prototype.slice.call(w)},isTypedArray:function(w){return ArrayBuffer.isView(w)&&!(w instanceof DataView)},getKeyframeOrder:function(w){const e=w.length,c=new Array(e);for(let d=0;d!==e;++d)c[d]=d;return c.sort(function(d,_){return w[d]-w[_]}),c},sortedArray:function(w,e,c){const d=w.length,_=new w.constructor(d);for(let S=0,L=0;L!==d;++S){const k=c[S]*e;for(let F=0;F!==e;++F)_[L++]=w[k+F]}return _},flattenJSON:function(w,e,c,d){let _=1,S=w[0];for(;void 0!==S&&void 0===S[d];)S=w[_++];if(void 0===S)return;let L=S[d];if(void 0!==L)if(Array.isArray(L))do{L=S[d],void 0!==L&&(e.push(S.time),c.push.apply(c,L)),S=w[_++]}while(void 0!==S);else if(void 0!==L.toArray)do{L=S[d],void 0!==L&&(e.push(S.time),L.toArray(c,c.length)),S=w[_++]}while(void 0!==S);else do{L=S[d],void 0!==L&&(e.push(S.time),c.push(L)),S=w[_++]}while(void 0!==S)},subclip:function(w,e,c,d,_=30){const S=w.clone();S.name=e;const L=[];for(let F=0;F<S.tracks.length;++F){const V=S.tracks[F],te=V.getValueSize(),le=[],ue=[];for(let _e=0;_e<V.times.length;++_e){const Ee=V.times[_e]*_;if(!(Ee<c||Ee>=d)){le.push(V.times[_e]);for(let $e=0;$e<te;++$e)ue.push(V.values[_e*te+$e])}}0!==le.length&&(V.times=Ye.convertArray(le,V.times.constructor),V.values=Ye.convertArray(ue,V.values.constructor),L.push(V))}S.tracks=L;let k=1/0;for(let F=0;F<S.tracks.length;++F)k>S.tracks[F].times[0]&&(k=S.tracks[F].times[0]);for(let F=0;F<S.tracks.length;++F)S.tracks[F].shift(-1*k);return S.resetDuration(),S},makeClipAdditive:function(w,e=0,c=w,d=30){d<=0&&(d=30);const _=c.tracks.length,S=e/d;for(let L=0;L<_;++L){const k=c.tracks[L],F=k.ValueTypeName;if("bool"===F||"string"===F)continue;const V=w.tracks.find(function(Ne){return Ne.name===k.name&&Ne.ValueTypeName===F});if(void 0===V)continue;let te=0;const le=k.getValueSize();k.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(te=le/3);let ue=0;const _e=V.getValueSize();V.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ue=_e/3);const Ee=k.times.length-1;let $e;if(S<=k.times[0])$e=Ye.arraySlice(k.values,te,le-te);else if(S>=k.times[Ee]){const Ne=Ee*le+te;$e=Ye.arraySlice(k.values,Ne,Ne+le-te)}else{const Ne=k.createInterpolant(),We=te,tt=le-te;Ne.evaluate(S),$e=Ye.arraySlice(Ne.resultBuffer,We,tt)}"quaternion"===F&&(new $i).fromArray($e).normalize().conjugate().toArray($e);const Le=V.times.length;for(let Ne=0;Ne<Le;++Ne){const We=Ne*_e+ue;if("quaternion"===F)$i.multiplyQuaternionsFlat(V.values,We,$e,0,V.values,We);else{const tt=_e-2*ue;for(let Ze=0;Ze<tt;++Ze)V.values[We+Ze]-=$e[Ze]}}}return w.blendMode=th,w}};class at{constructor(e,c,d,_){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==_?_:new c.constructor(d),this.sampleValues=c,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(e){const c=this.parameterPositions;let d=this._cachedIndex,_=c[d],S=c[d-1];e:{t:{let L;n:{r:if(!(e<_)){for(let k=d+2;;){if(void 0===_){if(e<S)break r;return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,e,S)}if(d===k)break;if(S=_,_=c[++d],e<_)break t}L=c.length;break n}if(e>=S)break e;{const k=c[1];e<k&&(d=2,S=k);for(let F=d-2;;){if(void 0===S)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(d===F)break;if(_=S,S=c[--d-1],e>=S)break t}L=d,d=0}}for(;d<L;){const k=d+L>>>1;e<c[k]?L=k:d=k+1}if(_=c[d],S=c[d-1],void 0===S)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(void 0===_)return d=c.length,this._cachedIndex=d,this.afterEnd_(d-1,S,e)}this._cachedIndex=d,this.intervalChanged_(d,S,_)}return this.interpolate_(d,S,e,_)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const c=this.resultBuffer,d=this.sampleValues,_=this.valueSize,S=e*_;for(let L=0;L!==_;++L)c[L]=d[S+L];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}at.prototype.beforeStart_=at.prototype.copySampleValue_,at.prototype.afterEnd_=at.prototype.copySampleValue_;class pt extends at{constructor(e,c,d,_){super(e,c,d,_),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$a,endingEnd:$a}}intervalChanged_(e,c,d){const _=this.parameterPositions;let S=e-2,L=e+1,k=_[S],F=_[L];if(void 0===k)switch(this.getSettings_().endingStart){case ua:S=e,k=2*c-d;break;case Al:S=_.length-2,k=c+_[S]-_[S+1];break;default:S=e,k=d}if(void 0===F)switch(this.getSettings_().endingEnd){case ua:L=e,F=2*d-c;break;case Al:L=1,F=d+_[1]-_[0];break;default:L=e-1,F=c}const V=.5*(d-c),te=this.valueSize;this._weightPrev=V/(c-k),this._weightNext=V/(F-d),this._offsetPrev=S*te,this._offsetNext=L*te}interpolate_(e,c,d,_){const S=this.resultBuffer,L=this.sampleValues,k=this.valueSize,F=e*k,V=F-k,te=this._offsetPrev,le=this._offsetNext,ue=this._weightPrev,_e=this._weightNext,Ee=(d-c)/(_-c),$e=Ee*Ee,Le=$e*Ee,Ne=-ue*Le+2*ue*$e-ue*Ee,We=(1+ue)*Le+(-1.5-2*ue)*$e+(-.5+ue)*Ee+1,tt=(-1-_e)*Le+(1.5+_e)*$e+.5*Ee,Ze=_e*Le-_e*$e;for(let ot=0;ot!==k;++ot)S[ot]=Ne*L[te+ot]+We*L[V+ot]+tt*L[F+ot]+Ze*L[le+ot];return S}}class St extends at{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e,c,d,_){const S=this.resultBuffer,L=this.sampleValues,k=this.valueSize,F=e*k,V=F-k,te=(d-c)/(_-c),le=1-te;for(let ue=0;ue!==k;++ue)S[ue]=L[V+ue]*le+L[F+ue]*te;return S}}class At extends at{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e){return this.copySampleValue_(e-1)}}class Jt{constructor(e,c,d,_){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ye.convertArray(c,this.TimeBufferType),this.values=Ye.convertArray(d,this.ValueBufferType),this.setInterpolation(_||this.DefaultInterpolation)}static toJSON(e){const c=e.constructor;let d;if(c.toJSON!==this.toJSON)d=c.toJSON(e);else{d={name:e.name,times:Ye.convertArray(e.times,Array),values:Ye.convertArray(e.values,Array)};const _=e.getInterpolation();_!==e.DefaultInterpolation&&(d.interpolation=_)}return d.type=e.ValueTypeName,d}InterpolantFactoryMethodDiscrete(e){return new At(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new St(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pt(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let c;switch(e){case Jl:c=this.InterpolantFactoryMethodDiscrete;break;case Zl:c=this.InterpolantFactoryMethodLinear;break;case Ku:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jl;case this.InterpolantFactoryMethodLinear:return Zl;case this.InterpolantFactoryMethodSmooth:return Ku}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const c=this.times;for(let d=0,_=c.length;d!==_;++d)c[d]+=e}return this}scale(e){if(1!==e){const c=this.times;for(let d=0,_=c.length;d!==_;++d)c[d]*=e}return this}trim(e,c){const d=this.times,_=d.length;let S=0,L=_-1;for(;S!==_&&d[S]<e;)++S;for(;-1!==L&&d[L]>c;)--L;if(++L,0!==S||L!==_){S>=L&&(L=Math.max(L,1),S=L-1);const k=this.getValueSize();this.times=Ye.arraySlice(d,S,L),this.values=Ye.arraySlice(this.values,S*k,L*k)}return this}validate(){let e=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const d=this.times,_=this.values,S=d.length;0===S&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let L=null;for(let k=0;k!==S;k++){const F=d[k];if("number"==typeof F&&isNaN(F)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,k,F),e=!1;break}if(null!==L&&L>F){console.error("THREE.KeyframeTrack: Out of order keys.",this,k,F,L),e=!1;break}L=F}if(void 0!==_&&Ye.isTypedArray(_))for(let k=0,F=_.length;k!==F;++k){const V=_[k];if(isNaN(V)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,k,V),e=!1;break}}return e}optimize(){const e=Ye.arraySlice(this.times),c=Ye.arraySlice(this.values),d=this.getValueSize(),_=this.getInterpolation()===Ku,S=e.length-1;let L=1;for(let k=1;k<S;++k){let F=!1;const V=e[k];if(V!==e[k+1]&&(1!==k||V!==e[0]))if(_)F=!0;else{const te=k*d,le=te-d,ue=te+d;for(let _e=0;_e!==d;++_e){const Ee=c[te+_e];if(Ee!==c[le+_e]||Ee!==c[ue+_e]){F=!0;break}}}if(F){if(k!==L){e[L]=e[k];const te=k*d,le=L*d;for(let ue=0;ue!==d;++ue)c[le+ue]=c[te+ue]}++L}}if(S>0){e[L]=e[S];for(let k=S*d,F=L*d,V=0;V!==d;++V)c[F+V]=c[k+V];++L}return L!==e.length?(this.times=Ye.arraySlice(e,0,L),this.values=Ye.arraySlice(c,0,L*d)):(this.times=e,this.values=c),this}clone(){const e=Ye.arraySlice(this.times,0),c=Ye.arraySlice(this.values,0),d=new this.constructor(this.name,e,c);return d.createInterpolant=this.createInterpolant,d}}Jt.prototype.TimeBufferType=Float32Array,Jt.prototype.ValueBufferType=Float32Array,Jt.prototype.DefaultInterpolation=Zl;class jt extends Jt{}jt.prototype.ValueTypeName="bool",jt.prototype.ValueBufferType=Array,jt.prototype.DefaultInterpolation=Jl,jt.prototype.InterpolantFactoryMethodLinear=void 0,jt.prototype.InterpolantFactoryMethodSmooth=void 0;class Pt extends Jt{}Pt.prototype.ValueTypeName="color";class Nt extends Jt{}Nt.prototype.ValueTypeName="number";class ft extends at{constructor(e,c,d,_){super(e,c,d,_)}interpolate_(e,c,d,_){const S=this.resultBuffer,L=this.sampleValues,k=this.valueSize,F=(d-c)/(_-c);let V=e*k;for(let te=V+k;V!==te;V+=4)$i.slerpFlat(S,0,L,V-k,L,V,F);return S}}class $t extends Jt{InterpolantFactoryMethodLinear(e){return new ft(this.times,this.values,this.getValueSize(),e)}}$t.prototype.ValueTypeName="quaternion",$t.prototype.DefaultInterpolation=Zl,$t.prototype.InterpolantFactoryMethodSmooth=void 0;class Zt extends Jt{}Zt.prototype.ValueTypeName="string",Zt.prototype.ValueBufferType=Array,Zt.prototype.DefaultInterpolation=Jl,Zt.prototype.InterpolantFactoryMethodLinear=void 0,Zt.prototype.InterpolantFactoryMethodSmooth=void 0;class _n extends Jt{}_n.prototype.ValueTypeName="vector";class xn{constructor(e,c=-1,d,_=eh){this.name=e,this.tracks=d,this.duration=c,this.blendMode=_,this.uuid=Zi(),this.duration<0&&this.resetDuration()}static parse(e){const c=[],d=e.tracks,_=1/(e.fps||1);for(let L=0,k=d.length;L!==k;++L)c.push(wr(d[L]).scale(_));const S=new this(e.name,e.duration,c,e.blendMode);return S.uuid=e.uuid,S}static toJSON(e){const c=[],d=e.tracks,_={name:e.name,duration:e.duration,tracks:c,uuid:e.uuid,blendMode:e.blendMode};for(let S=0,L=d.length;S!==L;++S)c.push(Jt.toJSON(d[S]));return _}static CreateFromMorphTargetSequence(e,c,d,_){const S=c.length,L=[];for(let k=0;k<S;k++){let F=[],V=[];F.push((k+S-1)%S,k,(k+1)%S),V.push(0,1,0);const te=Ye.getKeyframeOrder(F);F=Ye.sortedArray(F,1,te),V=Ye.sortedArray(V,1,te),_||0!==F[0]||(F.push(S),V.push(V[0])),L.push(new Nt(".morphTargetInfluences["+c[k].name+"]",F,V).scale(1/d))}return new this(e,-1,L)}static findByName(e,c){let d=e;Array.isArray(e)||(d=e.geometry&&e.geometry.animations||e.animations);for(let _=0;_<d.length;_++)if(d[_].name===c)return d[_];return null}static CreateClipsFromMorphTargetSequences(e,c,d){const _={},S=/^([\w-]*?)([\d]+)$/;for(let k=0,F=e.length;k<F;k++){const V=e[k],te=V.name.match(S);if(te&&te.length>1){const le=te[1];let ue=_[le];ue||(_[le]=ue=[]),ue.push(V)}}const L=[];for(const k in _)L.push(this.CreateFromMorphTargetSequence(k,_[k],c,d));return L}static parseAnimation(e,c){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(te,le,ue,_e,Ee){if(0!==ue.length){const $e=[],Le=[];Ye.flattenJSON(ue,$e,Le,_e),0!==$e.length&&Ee.push(new te(le,$e,Le))}},_=[],S=e.name||"default",L=e.fps||30,k=e.blendMode;let F=e.length||-1;const V=e.hierarchy||[];for(let te=0;te<V.length;te++){const le=V[te].keys;if(le&&0!==le.length)if(le[0].morphTargets){const ue={};let _e;for(_e=0;_e<le.length;_e++)if(le[_e].morphTargets)for(let Ee=0;Ee<le[_e].morphTargets.length;Ee++)ue[le[_e].morphTargets[Ee]]=-1;for(const Ee in ue){const $e=[],Le=[];for(let Ne=0;Ne!==le[_e].morphTargets.length;++Ne){const We=le[_e];$e.push(We.time),Le.push(We.morphTarget===Ee?1:0)}_.push(new Nt(".morphTargetInfluence["+Ee+"]",$e,Le))}F=ue.length*(L||1)}else{const ue=".bones["+c[te].name+"]";d(_n,ue+".position",le,"pos",_),d($t,ue+".quaternion",le,"rot",_),d(_n,ue+".scale",le,"scl",_)}}return 0===_.length?null:new this(S,F,_,k)}resetDuration(){let e=0;for(let c=0,d=this.tracks.length;c!==d;++c){const _=this.tracks[c];e=Math.max(e,_.times[_.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let c=0;c<this.tracks.length;c++)e=e&&this.tracks[c].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let c=0;c<this.tracks.length;c++)e.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function wr(w){if(void 0===w.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Nt;case"vector":case"vector2":case"vector3":case"vector4":return _n;case"color":return Pt;case"quaternion":return $t;case"bool":case"boolean":return jt;case"string":return Zt}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(w.type);if(void 0===w.times){const c=[],d=[];Ye.flattenJSON(w.keys,c,d,"value"),w.times=c,w.values=d}return void 0!==e.parse?e.parse(w):new e(w.name,w.times,w.values,w.interpolation)}const ir={enabled:!1,files:{},add:function(w,e){!1!==this.enabled&&(this.files[w]=e)},get:function(w){if(!1!==this.enabled)return this.files[w]},remove:function(w){delete this.files[w]},clear:function(){this.files={}}};class Hn{constructor(e,c,d){const _=this;let S,L=!1,k=0,F=0;const V=[];this.onStart=void 0,this.onLoad=e,this.onProgress=c,this.onError=d,this.itemStart=function(te){F++,!1===L&&void 0!==_.onStart&&_.onStart(te,k,F),L=!0},this.itemEnd=function(te){k++,void 0!==_.onProgress&&_.onProgress(te,k,F),k===F&&(L=!1,void 0!==_.onLoad&&_.onLoad())},this.itemError=function(te){void 0!==_.onError&&_.onError(te)},this.resolveURL=function(te){return S?S(te):te},this.setURLModifier=function(te){return S=te,this},this.addHandler=function(te,le){return V.push(te,le),this},this.removeHandler=function(te){const le=V.indexOf(te);return-1!==le&&V.splice(le,2),this},this.getHandler=function(te){for(let le=0,ue=V.length;le<ue;le+=2){const _e=V[le],Ee=V[le+1];if(_e.global&&(_e.lastIndex=0),_e.test(te))return Ee}return null}}}const lr=new Hn;class Yn{constructor(e){this.manager=void 0!==e?e:lr,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,c){const d=this;return new Promise(function(_,S){d.load(e,_,c,S)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const fr={};class zr extends Yn{constructor(e){super(e)}load(e,c,d,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,L=ir.get(e);if(void 0!==L)return S.manager.itemStart(e),setTimeout(function(){c&&c(L),S.manager.itemEnd(e)},0),L;if(void 0!==fr[e])return void fr[e].push({onLoad:c,onProgress:d,onError:_});const k=e.match(/^data:(.*?)(;base64)?,(.*)$/);let F;if(k){const V=k[1],te=!!k[2];let le=k[3];le=decodeURIComponent(le),te&&(le=atob(le));try{let ue;const _e=(this.responseType||"").toLowerCase();switch(_e){case"arraybuffer":case"blob":const Ee=new Uint8Array(le.length);for(let Le=0;Le<le.length;Le++)Ee[Le]=le.charCodeAt(Le);ue="blob"===_e?new Blob([Ee.buffer],{type:V}):Ee.buffer;break;case"document":ue=(new DOMParser).parseFromString(le,V);break;case"json":ue=JSON.parse(le);break;default:ue=le}setTimeout(function(){c&&c(ue),S.manager.itemEnd(e)},0)}catch(ue){setTimeout(function(){_&&_(ue),S.manager.itemError(e),S.manager.itemEnd(e)},0)}}else{fr[e]=[],fr[e].push({onLoad:c,onProgress:d,onError:_}),F=new XMLHttpRequest,F.open("GET",e,!0),F.addEventListener("load",function(V){const te=this.response,le=fr[e];if(delete fr[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ir.add(e,te);for(let ue=0,_e=le.length;ue<_e;ue++){const Ee=le[ue];Ee.onLoad&&Ee.onLoad(te)}S.manager.itemEnd(e)}else{for(let ue=0,_e=le.length;ue<_e;ue++){const Ee=le[ue];Ee.onError&&Ee.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)}},!1),F.addEventListener("progress",function(V){const te=fr[e];for(let le=0,ue=te.length;le<ue;le++){const _e=te[le];_e.onProgress&&_e.onProgress(V)}},!1),F.addEventListener("error",function(V){const te=fr[e];delete fr[e];for(let le=0,ue=te.length;le<ue;le++){const _e=te[le];_e.onError&&_e.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)},!1),F.addEventListener("abort",function(V){const te=fr[e];delete fr[e];for(let le=0,ue=te.length;le<ue;le++){const _e=te[le];_e.onError&&_e.onError(V)}S.manager.itemError(e),S.manager.itemEnd(e)},!1),void 0!==this.responseType&&(F.responseType=this.responseType),void 0!==this.withCredentials&&(F.withCredentials=this.withCredentials),F.overrideMimeType&&F.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const V in this.requestHeader)F.setRequestHeader(V,this.requestHeader[V]);F.send(null)}return S.manager.itemStart(e),F}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class xo extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=new zr(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c=[];for(let d=0;d<e.length;d++){const _=xn.parse(e[d]);c.push(_)}return c}}class po extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=[],k=new Iu,F=new zr(this.manager);F.setPath(this.path),F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setWithCredentials(S.withCredentials);let V=0;function te(le){F.load(e[le],function(ue){const _e=S.parse(ue,!0);L[le]={width:_e.width,height:_e.height,format:_e.format,mipmaps:_e.mipmaps},V+=1,6===V&&(1===_e.mipmapCount&&(k.minFilter=ai),k.image=L,k.format=_e.format,k.needsUpdate=!0,c&&c(k))},d,_)}if(Array.isArray(e))for(let le=0,ue=e.length;le<ue;++le)te(le);else F.load(e,function(le){const ue=S.parse(le,!0);if(ue.isCubemap){const _e=ue.mipmaps.length/ue.mipmapCount;for(let Ee=0;Ee<_e;Ee++){L[Ee]={mipmaps:[]};for(let $e=0;$e<ue.mipmapCount;$e++)L[Ee].mipmaps.push(ue.mipmaps[Ee*ue.mipmapCount+$e]),L[Ee].format=ue.format,L[Ee].width=ue.width,L[Ee].height=ue.height}k.image=L}else k.image.width=ue.width,k.image.height=ue.height,k.mipmaps=ue.mipmaps;1===ue.mipmapCount&&(k.minFilter=ai),k.format=ue.format,k.needsUpdate=!0,c&&c(k)},d,_);return k}}class wo extends Yn{constructor(e){super(e)}load(e,c,d,_){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,L=ir.get(e);if(void 0!==L)return S.manager.itemStart(e),setTimeout(function(){c&&c(L),S.manager.itemEnd(e)},0),L;const k=document.createElementNS("http://www.w3.org/1999/xhtml","img");function F(){k.removeEventListener("load",F,!1),k.removeEventListener("error",V,!1),ir.add(e,this),c&&c(this),S.manager.itemEnd(e)}function V(te){k.removeEventListener("load",F,!1),k.removeEventListener("error",V,!1),_&&_(te),S.manager.itemError(e),S.manager.itemEnd(e)}return k.addEventListener("load",F,!1),k.addEventListener("error",V,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(k.crossOrigin=this.crossOrigin),S.manager.itemStart(e),k.src=e,k}}class Uo extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=new nc,L=new wo(this.manager);L.setCrossOrigin(this.crossOrigin),L.setPath(this.path);let k=0;function F(V){L.load(e[V],function(te){S.images[V]=te,k++,6===k&&(S.needsUpdate=!0,c&&c(S))},void 0,_)}for(let V=0;V<e.length;++V)F(V);return S}}class Hs extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=new Is,k=new zr(this.manager);return k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(S.withCredentials),k.load(e,function(F){const V=S.parse(F);V&&(void 0!==V.image?L.image=V.image:void 0!==V.data&&(L.image.width=V.width,L.image.height=V.height,L.image.data=V.data),L.wrapS=void 0!==V.wrapS?V.wrapS:Jr,L.wrapT=void 0!==V.wrapT?V.wrapT:Jr,L.magFilter=void 0!==V.magFilter?V.magFilter:ai,L.minFilter=void 0!==V.minFilter?V.minFilter:ai,L.anisotropy=void 0!==V.anisotropy?V.anisotropy:1,void 0!==V.encoding&&(L.encoding=V.encoding),void 0!==V.flipY&&(L.flipY=V.flipY),void 0!==V.format&&(L.format=V.format),void 0!==V.type&&(L.type=V.type),void 0!==V.mipmaps&&(L.mipmaps=V.mipmaps,L.minFilter=sl),1===V.mipmapCount&&(L.minFilter=ai),void 0!==V.generateMipmaps&&(L.generateMipmaps=V.generateMipmaps),L.needsUpdate=!0,c&&c(L,V))},d,_),L}}class Vs extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=new As,L=new wo(this.manager);return L.setCrossOrigin(this.crossOrigin),L.setPath(this.path),L.load(e,function(k){S.image=k;const F=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);S.format=F?Os:ao,S.needsUpdate=!0,void 0!==c&&c(S)},d,_),S}}class za extends Fa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);e.equals(c)||this.curves.push(new ra(c,e))}getPoint(e){const c=e*this.getLength(),d=this.getCurveLengths();let _=0;for(;_<d.length;){if(d[_]>=c){const S=d[_]-c,L=this.curves[_],k=L.getLength();return L.getPointAt(0===k?0:1-S/k)}_++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let c=0;for(let d=0,_=this.curves.length;d<_;d++)c+=this.curves[d].getLength(),e.push(c);return this.cacheLengths=e,e}getSpacedPoints(e=40){const c=[];for(let d=0;d<=e;d++)c.push(this.getPoint(d/e));return this.autoClose&&c.push(c[0]),c}getPoints(e=12){const c=[];let d;for(let _=0,S=this.curves;_<S.length;_++){const L=S[_],F=L.getPoints(L&&L.isEllipseCurve?2*e:L&&(L.isLineCurve||L.isLineCurve3)?1:L&&L.isSplineCurve?e*L.points.length:e);for(let V=0;V<F.length;V++){const te=F[V];d&&d.equals(te)||(c.push(te),d=te)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(e){super.copy(e),this.curves=[];for(let c=0,d=e.curves.length;c<d;c++)this.curves.push(e.curves[c].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let c=0,d=this.curves.length;c<d;c++)e.curves.push(this.curves[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let c=0,d=e.curves.length;c<d;c++){const _=e.curves[c];this.curves.push((new uo[_.type]).fromJSON(_))}return this}}class ja extends za{constructor(e){super(),this.type="Path",this.currentPoint=new zn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let c=1,d=e.length;c<d;c++)this.lineTo(e[c].x,e[c].y);return this}moveTo(e,c){return this.currentPoint.set(e,c),this}lineTo(e,c){const d=new ra(this.currentPoint.clone(),new zn(e,c));return this.curves.push(d),this.currentPoint.set(e,c),this}quadraticCurveTo(e,c,d,_){const S=new oo(this.currentPoint.clone(),new zn(e,c),new zn(d,_));return this.curves.push(S),this.currentPoint.set(d,_),this}bezierCurveTo(e,c,d,_,S,L){const k=new na(this.currentPoint.clone(),new zn(e,c),new zn(d,_),new zn(S,L));return this.curves.push(k),this.currentPoint.set(S,L),this}splineThru(e){const c=[this.currentPoint.clone()].concat(e),d=new xs(c);return this.curves.push(d),this.currentPoint.copy(e[e.length-1]),this}arc(e,c,d,_,S,L){return this.absarc(e+this.currentPoint.x,c+this.currentPoint.y,d,_,S,L),this}absarc(e,c,d,_,S,L){return this.absellipse(e,c,d,d,_,S,L),this}ellipse(e,c,d,_,S,L,k,F){return this.absellipse(e+this.currentPoint.x,c+this.currentPoint.y,d,_,S,L,k,F),this}absellipse(e,c,d,_,S,L,k,F){const V=new Fu(e,c,d,_,S,L,k,F);if(this.curves.length>0){const le=V.getPoint(0);le.equals(this.currentPoint)||this.lineTo(le.x,le.y)}this.curves.push(V);const te=V.getPoint(1);return this.currentPoint.copy(te),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Ga extends ja{constructor(e){super(e),this.uuid=Zi(),this.type="Shape",this.holes=[]}getPointsHoles(e){const c=[];for(let d=0,_=this.holes.length;d<_;d++)c[d]=this.holes[d].getPoints(e);return c}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let c=0,d=e.holes.length;c<d;c++)this.holes.push(e.holes[c].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let c=0,d=this.holes.length;c<d;c++)e.holes.push(this.holes[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let c=0,d=e.holes.length;c<d;c++){const _=e.holes[c];this.holes.push((new ja).fromJSON(_))}return this}}class Hl extends Pr{constructor(e,c=1){super(),this.type="Light",this.color=new Kn(e),this.intensity=c}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const c=super.toJSON(e);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}Hl.prototype.isLight=!0;class ap extends Hl{constructor(e,c,d){super(e,d),this.type="HemisphereLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.groundColor=new Kn(c)}copy(e){return Hl.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}ap.prototype.isHemisphereLight=!0;const lp=new tn,Up=new ht,Sd=new ht;class Uc{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new zn(512,512),this.map=null,this.mapPass=null,this.matrix=new tn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Fr,this._frameExtents=new zn(1,1),this._viewportCount=1,this._viewports=[new Di(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const c=this.camera,d=this.matrix;Up.setFromMatrixPosition(e.matrixWorld),c.position.copy(Up),Sd.setFromMatrixPosition(e.target.matrixWorld),c.lookAt(Sd),c.updateMatrixWorld(),lp.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lp),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(c.projectionMatrix),d.multiply(c.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class up extends Uc{constructor(){super(new Po(50,1,.5,500)),this.focus=1}updateMatrices(e){const c=this.camera,d=2*ss*e.angle*this.focus,_=this.mapSize.width/this.mapSize.height,S=e.distance||c.far;d===c.fov&&_===c.aspect&&S===c.far||(c.fov=d,c.aspect=_,c.far=S,c.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}up.prototype.isSpotLightShadow=!0;class fh extends Hl{constructor(e,c,d=0,_=Math.PI/3,S=0,L=1){super(e,c),this.type="SpotLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.distance=d,this.angle=_,this.penumbra=S,this.decay=L,this.shadow=new up}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}fh.prototype.isSpotLight=!0;const il=new tn,hp=new ht,jm=new ht;class Ed extends Uc{constructor(){super(new Po(90,1,.5,500)),this._frameExtents=new zn(4,2),this._viewportCount=6,this._viewports=[new Di(2,1,1,1),new Di(0,1,1,1),new Di(3,1,1,1),new Di(1,1,1,1),new Di(3,0,1,1),new Di(1,0,1,1)],this._cubeDirections=[new ht(1,0,0),new ht(-1,0,0),new ht(0,0,1),new ht(0,0,-1),new ht(0,1,0),new ht(0,-1,0)],this._cubeUps=[new ht(0,1,0),new ht(0,1,0),new ht(0,1,0),new ht(0,1,0),new ht(0,0,1),new ht(0,0,-1)]}updateMatrices(e,c=0){const d=this.camera,_=this.matrix,S=e.distance||d.far;S!==d.far&&(d.far=S,d.updateProjectionMatrix()),hp.setFromMatrixPosition(e.matrixWorld),d.position.copy(hp),jm.copy(d.position),jm.add(this._cubeDirections[c]),d.up.copy(this._cubeUps[c]),d.lookAt(jm),d.updateMatrixWorld(),_.makeTranslation(-hp.x,-hp.y,-hp.z),il.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(il)}}Ed.prototype.isPointLightShadow=!0;class If extends Hl{constructor(e,c,d=0,_=1){super(e,c),this.type="PointLight",this.distance=d,this.decay=_,this.shadow=new Ed}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}If.prototype.isPointLight=!0;class Jd extends Uc{constructor(){super(new rc(-5,5,5,-5,.5,500))}}Jd.prototype.isDirectionalLightShadow=!0;class nd extends Hl{constructor(e,c){super(e,c),this.type="DirectionalLight",this.position.copy(Pr.DefaultUp),this.updateMatrix(),this.target=new Pr,this.shadow=new Jd}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}nd.prototype.isDirectionalLight=!0;class am extends Hl{constructor(e,c){super(e,c),this.type="AmbientLight"}}am.prototype.isAmbientLight=!0;class Gm extends Hl{constructor(e,c,d=10,_=10){super(e,c),this.type="RectAreaLight",this.width=d,this.height=_}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const c=super.toJSON(e);return c.object.width=this.width,c.object.height=this.height,c}}Gm.prototype.isRectAreaLight=!0;class rd{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ht)}set(e){for(let c=0;c<9;c++)this.coefficients[c].copy(e[c]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,c){const d=e.x,_=e.y,S=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.282095),c.addScaledVector(L[1],.488603*_),c.addScaledVector(L[2],.488603*S),c.addScaledVector(L[3],.488603*d),c.addScaledVector(L[4],d*_*1.092548),c.addScaledVector(L[5],_*S*1.092548),c.addScaledVector(L[6],.315392*(3*S*S-1)),c.addScaledVector(L[7],d*S*1.092548),c.addScaledVector(L[8],.546274*(d*d-_*_)),c}getIrradianceAt(e,c){const d=e.x,_=e.y,S=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.886227),c.addScaledVector(L[1],1.023328*_),c.addScaledVector(L[2],1.023328*S),c.addScaledVector(L[3],1.023328*d),c.addScaledVector(L[4],.858086*d*_),c.addScaledVector(L[5],.858086*_*S),c.addScaledVector(L[6],.743125*S*S-.247708),c.addScaledVector(L[7],.858086*d*S),c.addScaledVector(L[8],.429043*(d*d-_*_)),c}add(e){for(let c=0;c<9;c++)this.coefficients[c].add(e.coefficients[c]);return this}addScaledSH(e,c){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(e.coefficients[d],c);return this}scale(e){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(e);return this}lerp(e,c){for(let d=0;d<9;d++)this.coefficients[d].lerp(e.coefficients[d],c);return this}equals(e){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(e.coefficients[c]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,c=0){const d=this.coefficients;for(let _=0;_<9;_++)d[_].fromArray(e,c+3*_);return this}toArray(e=[],c=0){const d=this.coefficients;for(let _=0;_<9;_++)d[_].toArray(e,c+3*_);return e}static getBasisAt(e,c){const d=e.x,_=e.y,S=e.z;c[0]=.282095,c[1]=.488603*_,c[2]=.488603*S,c[3]=.488603*d,c[4]=1.092548*d*_,c[5]=1.092548*_*S,c[6]=.315392*(3*S*S-1),c[7]=1.092548*d*S,c[8]=.546274*(d*d-_*_)}}rd.prototype.isSphericalHarmonics3=!0;class Zd extends Hl{constructor(e=new rd,c=1){super(void 0,c),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const c=super.toJSON(e);return c.object.sh=this.sh.toArray(),c}}Zd.prototype.isLightProbe=!0;class lm extends Yn{constructor(e){super(e),this.textures={}}load(e,c,d,_){const S=this,L=new zr(S.manager);L.setPath(S.path),L.setRequestHeader(S.requestHeader),L.setWithCredentials(S.withCredentials),L.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c=this.textures;function d(S){return void 0===c[S]&&console.warn("THREE.MaterialLoader: Undefined texture",S),c[S]}const _=new Ue[e.type];if(void 0!==e.uuid&&(_.uuid=e.uuid),void 0!==e.name&&(_.name=e.name),void 0!==e.color&&void 0!==_.color&&_.color.setHex(e.color),void 0!==e.roughness&&(_.roughness=e.roughness),void 0!==e.metalness&&(_.metalness=e.metalness),void 0!==e.sheenTint&&(_.sheenTint=(new Kn).setHex(e.sheenTint)),void 0!==e.emissive&&void 0!==_.emissive&&_.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==_.specular&&_.specular.setHex(e.specular),void 0!==e.specularIntensity&&(_.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==_.specularTint&&_.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(_.shininess=e.shininess),void 0!==e.clearcoat&&(_.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(_.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(_.transmission=e.transmission),void 0!==e.thickness&&(_.thickness=e.thickness),void 0!==e.attenuationDistance&&(_.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==_.attenuationTint&&_.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(_.fog=e.fog),void 0!==e.flatShading&&(_.flatShading=e.flatShading),void 0!==e.blending&&(_.blending=e.blending),void 0!==e.combine&&(_.combine=e.combine),void 0!==e.side&&(_.side=e.side),void 0!==e.shadowSide&&(_.shadowSide=e.shadowSide),void 0!==e.opacity&&(_.opacity=e.opacity),void 0!==e.format&&(_.format=e.format),void 0!==e.transparent&&(_.transparent=e.transparent),void 0!==e.alphaTest&&(_.alphaTest=e.alphaTest),void 0!==e.depthTest&&(_.depthTest=e.depthTest),void 0!==e.depthWrite&&(_.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(_.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(_.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(_.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(_.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(_.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(_.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(_.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(_.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(_.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(_.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(_.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(_.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(_.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(_.rotation=e.rotation),1!==e.linewidth&&(_.linewidth=e.linewidth),void 0!==e.dashSize&&(_.dashSize=e.dashSize),void 0!==e.gapSize&&(_.gapSize=e.gapSize),void 0!==e.scale&&(_.scale=e.scale),void 0!==e.polygonOffset&&(_.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(_.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(_.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(_.dithering=e.dithering),void 0!==e.alphaToCoverage&&(_.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(_.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(_.visible=e.visible),void 0!==e.toneMapped&&(_.toneMapped=e.toneMapped),void 0!==e.userData&&(_.userData=e.userData),void 0!==e.vertexColors&&(_.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const S in e.uniforms){const L=e.uniforms[S];switch(_.uniforms[S]={},L.type){case"t":_.uniforms[S].value=d(L.value);break;case"c":_.uniforms[S].value=(new Kn).setHex(L.value);break;case"v2":_.uniforms[S].value=(new zn).fromArray(L.value);break;case"v3":_.uniforms[S].value=(new ht).fromArray(L.value);break;case"v4":_.uniforms[S].value=(new Di).fromArray(L.value);break;case"m3":_.uniforms[S].value=(new lt).fromArray(L.value);break;case"m4":_.uniforms[S].value=(new tn).fromArray(L.value);break;default:_.uniforms[S].value=L.value}}if(void 0!==e.defines&&(_.defines=e.defines),void 0!==e.vertexShader&&(_.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(_.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const S in e.extensions)_.extensions[S]=e.extensions[S];if(void 0!==e.shading&&(_.flatShading=1===e.shading),void 0!==e.size&&(_.size=e.size),void 0!==e.sizeAttenuation&&(_.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(_.map=d(e.map)),void 0!==e.matcap&&(_.matcap=d(e.matcap)),void 0!==e.alphaMap&&(_.alphaMap=d(e.alphaMap)),void 0!==e.bumpMap&&(_.bumpMap=d(e.bumpMap)),void 0!==e.bumpScale&&(_.bumpScale=e.bumpScale),void 0!==e.normalMap&&(_.normalMap=d(e.normalMap)),void 0!==e.normalMapType&&(_.normalMapType=e.normalMapType),void 0!==e.normalScale){let S=e.normalScale;!1===Array.isArray(S)&&(S=[S,S]),_.normalScale=(new zn).fromArray(S)}return void 0!==e.displacementMap&&(_.displacementMap=d(e.displacementMap)),void 0!==e.displacementScale&&(_.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(_.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(_.roughnessMap=d(e.roughnessMap)),void 0!==e.metalnessMap&&(_.metalnessMap=d(e.metalnessMap)),void 0!==e.emissiveMap&&(_.emissiveMap=d(e.emissiveMap)),void 0!==e.emissiveIntensity&&(_.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(_.specularMap=d(e.specularMap)),void 0!==e.specularIntensityMap&&(_.specularIntensityMap=d(e.specularIntensityMap)),void 0!==e.specularTintMap&&(_.specularTintMap=d(e.specularTintMap)),void 0!==e.envMap&&(_.envMap=d(e.envMap)),void 0!==e.envMapIntensity&&(_.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(_.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(_.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(_.lightMap=d(e.lightMap)),void 0!==e.lightMapIntensity&&(_.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(_.aoMap=d(e.aoMap)),void 0!==e.aoMapIntensity&&(_.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(_.gradientMap=d(e.gradientMap)),void 0!==e.clearcoatMap&&(_.clearcoatMap=d(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap=d(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(_.clearcoatNormalMap=d(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(_.clearcoatNormalScale=(new zn).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(_.transmissionMap=d(e.transmissionMap)),void 0!==e.thicknessMap&&(_.thicknessMap=d(e.thicknessMap)),_}setTextures(e){return this.textures=e,this}}class vf{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let c="";for(let d=0,_=e.length;d<_;d++)c+=String.fromCharCode(e[d]);try{return decodeURIComponent(escape(c))}catch{return c}}static extractUrlBase(e){const c=e.lastIndexOf("/");return-1===c?"./":e.substr(0,c+1)}}class Of extends br{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Of.prototype.isInstancedBufferGeometry=!0;class o_ extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=new zr(S.manager);L.setPath(S.path),L.setRequestHeader(S.requestHeader),L.setWithCredentials(S.withCredentials),L.load(e,function(k){try{c(S.parse(JSON.parse(k)))}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}parse(e){const c={},d={};function _(le,ue){if(void 0!==c[ue])return c[ue];const _e=le.interleavedBuffers[ue],Ee=function(Ne,We){if(void 0!==d[We])return d[We];const Ze=new Uint32Array(Ne.arrayBuffers[We]).buffer;return d[We]=Ze,Ze}(le,_e.buffer),$e=Za(_e.type,Ee),Le=new Oc($e,_e.stride);return Le.uuid=_e.uuid,c[ue]=Le,Le}const S=e.isInstancedBufferGeometry?new Of:new br,L=e.data.index;if(void 0!==L){const le=Za(L.type,L.array);S.setIndex(new Pi(le,1))}const k=e.data.attributes;for(const le in k){const ue=k[le];let _e;if(ue.isInterleavedBufferAttribute){const Ee=_(e.data,ue.data);_e=new Ii(Ee,ue.itemSize,ue.offset,ue.normalized)}else{const Ee=Za(ue.type,ue.array);_e=new(ue.isInstancedBufferAttribute?ou:Pi)(Ee,ue.itemSize,ue.normalized)}void 0!==ue.name&&(_e.name=ue.name),void 0!==ue.usage&&_e.setUsage(ue.usage),void 0!==ue.updateRange&&(_e.updateRange.offset=ue.updateRange.offset,_e.updateRange.count=ue.updateRange.count),S.setAttribute(le,_e)}const F=e.data.morphAttributes;if(F)for(const le in F){const ue=F[le],_e=[];for(let Ee=0,$e=ue.length;Ee<$e;Ee++){const Le=ue[Ee];let Ne;if(Le.isInterleavedBufferAttribute){const We=_(e.data,Le.data);Ne=new Ii(We,Le.itemSize,Le.offset,Le.normalized)}else{const We=Za(Le.type,Le.array);Ne=new Pi(We,Le.itemSize,Le.normalized)}void 0!==Le.name&&(Ne.name=Le.name),_e.push(Ne)}S.morphAttributes[le]=_e}e.data.morphTargetsRelative&&(S.morphTargetsRelative=!0);const V=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==V)for(let le=0,ue=V.length;le!==ue;++le){const _e=V[le];S.addGroup(_e.start,_e.count,_e.materialIndex)}const te=e.data.boundingSphere;if(void 0!==te){const le=new ht;void 0!==te.center&&le.fromArray(te.center),S.boundingSphere=new bo(le,te.radius)}return e.name&&(S.name=e.name),e.userData&&(S.userData=e.userData),S}}class Hm extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=""===this.path?vf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||L;const k=new zr(this.manager);k.setPath(this.path),k.setRequestHeader(this.requestHeader),k.setWithCredentials(this.withCredentials),k.load(e,function(F){let V=null;try{V=JSON.parse(F)}catch(le){return void 0!==_&&_(le),void console.error("THREE:ObjectLoader: Can't parse "+e+".",le.message)}const te=V.metadata;void 0!==te&&void 0!==te.type&&"geometry"!==te.type.toLowerCase()?S.parse(V,c):console.error("THREE.ObjectLoader: Can't load "+e)},d,_)}async loadAsync(e,c){const d=""===this.path?vf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||d;const _=new zr(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);const S=await _.loadAsync(e,c),L=JSON.parse(S),k=L.metadata;if(void 0===k||void 0===k.type||"geometry"===k.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(L)}parse(e,c){const d=this.parseAnimations(e.animations),_=this.parseShapes(e.shapes),S=this.parseGeometries(e.geometries,_),L=this.parseImages(e.images,function(){void 0!==c&&c(V)}),k=this.parseTextures(e.textures,L),F=this.parseMaterials(e.materials,k),V=this.parseObject(e.object,S,F,k,d),te=this.parseSkeletons(e.skeletons,V);if(this.bindSkeletons(V,te),void 0!==c){let le=!1;for(const ue in L)if(L[ue]instanceof HTMLImageElement){le=!0;break}!1===le&&c(V)}return V}async parseAsync(e){const c=this.parseAnimations(e.animations),d=this.parseShapes(e.shapes),_=this.parseGeometries(e.geometries,d),S=await this.parseImagesAsync(e.images),L=this.parseTextures(e.textures,S),k=this.parseMaterials(e.materials,L),F=this.parseObject(e.object,_,k,L,c),V=this.parseSkeletons(e.skeletons,F);return this.bindSkeletons(F,V),F}parseShapes(e){const c={};if(void 0!==e)for(let d=0,_=e.length;d<_;d++){const S=(new Ga).fromJSON(e[d]);c[S.uuid]=S}return c}parseSkeletons(e,c){const d={},_={};if(c.traverse(function(S){S.isBone&&(_[S.uuid]=S)}),void 0!==e)for(let S=0,L=e.length;S<L;S++){const k=(new rp).fromJSON(e[S],_);d[k.uuid]=k}return d}parseGeometries(e,c){const d={};if(void 0!==e){const _=new o_;for(let S=0,L=e.length;S<L;S++){let k;const F=e[S];switch(F.type){case"BufferGeometry":case"InstancedBufferGeometry":k=_.parse(F);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:F.type in oe?k=oe[F.type].fromJSON(F,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${F.type}"`)}k.uuid=F.uuid,void 0!==F.name&&(k.name=F.name),!0===k.isBufferGeometry&&void 0!==F.userData&&(k.userData=F.userData),d[F.uuid]=k}}return d}parseMaterials(e,c){const d={},_={};if(void 0!==e){const S=new lm;S.setTextures(c);for(let L=0,k=e.length;L<k;L++){const F=e[L];if("MultiMaterial"===F.type){const V=[];for(let te=0;te<F.materials.length;te++){const le=F.materials[te];void 0===d[le.uuid]&&(d[le.uuid]=S.parse(le)),V.push(d[le.uuid])}_[F.uuid]=V}else void 0===d[F.uuid]&&(d[F.uuid]=S.parse(F)),_[F.uuid]=d[F.uuid]}}return _}parseAnimations(e){const c={};if(void 0!==e)for(let d=0;d<e.length;d++){const S=xn.parse(e[d]);c[S.uuid]=S}return c}parseImages(e,c){const d=this,_={};let S;function L(k){if("string"==typeof k){const F=k;return V=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(F)?F:d.resourcePath+F,d.manager.itemStart(V),S.load(V,function(){d.manager.itemEnd(V)},void 0,function(){d.manager.itemError(V),d.manager.itemEnd(V)})}var V;return k.data?{data:Za(k.type,k.data),width:k.width,height:k.height}:null}if(void 0!==e&&e.length>0){const k=new Hn(c);S=new wo(k),S.setCrossOrigin(this.crossOrigin);for(let F=0,V=e.length;F<V;F++){const te=e[F],le=te.url;if(Array.isArray(le)){_[te.uuid]=[];for(let ue=0,_e=le.length;ue<_e;ue++){const Ee=L(le[ue]);null!==Ee&&(Ee instanceof HTMLImageElement?_[te.uuid].push(Ee):_[te.uuid].push(new Is(Ee.data,Ee.width,Ee.height)))}}else{const ue=L(te.url);null!==ue&&(_[te.uuid]=ue)}}}return _}async parseImagesAsync(e){const c=this,d={};let _;async function S(L){if("string"==typeof L){const k=L,F=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(k)?k:c.resourcePath+k;return await _.loadAsync(F)}return L.data?{data:Za(L.type,L.data),width:L.width,height:L.height}:null}if(void 0!==e&&e.length>0){_=new wo(this.manager),_.setCrossOrigin(this.crossOrigin);for(let L=0,k=e.length;L<k;L++){const F=e[L],V=F.url;if(Array.isArray(V)){d[F.uuid]=[];for(let te=0,le=V.length;te<le;te++){const ue=V[te],_e=await S(ue);null!==_e&&(_e instanceof HTMLImageElement?d[F.uuid].push(_e):d[F.uuid].push(new Is(_e.data,_e.width,_e.height)))}}else{const te=await S(F.url);null!==te&&(d[F.uuid]=te)}}}return d}parseTextures(e,c){function d(S,L){return"number"==typeof S?S:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",S),L[S])}const _={};if(void 0!==e)for(let S=0,L=e.length;S<L;S++){const k=e[S];let F;void 0===k.image&&console.warn('THREE.ObjectLoader: No "image" specified for',k.uuid),void 0===c[k.image]&&console.warn("THREE.ObjectLoader: Undefined image",k.image);const V=c[k.image];Array.isArray(V)?(F=new nc(V),6===V.length&&(F.needsUpdate=!0)):(F=V&&V.data?new Is(V.data,V.width,V.height):new As(V),V&&(F.needsUpdate=!0)),F.uuid=k.uuid,void 0!==k.name&&(F.name=k.name),void 0!==k.mapping&&(F.mapping=d(k.mapping,E_)),void 0!==k.offset&&F.offset.fromArray(k.offset),void 0!==k.repeat&&F.repeat.fromArray(k.repeat),void 0!==k.center&&F.center.fromArray(k.center),void 0!==k.rotation&&(F.rotation=k.rotation),void 0!==k.wrap&&(F.wrapS=d(k.wrap[0],s_),F.wrapT=d(k.wrap[1],s_)),void 0!==k.format&&(F.format=k.format),void 0!==k.type&&(F.type=k.type),void 0!==k.encoding&&(F.encoding=k.encoding),void 0!==k.minFilter&&(F.minFilter=d(k.minFilter,a_)),void 0!==k.magFilter&&(F.magFilter=d(k.magFilter,a_)),void 0!==k.anisotropy&&(F.anisotropy=k.anisotropy),void 0!==k.flipY&&(F.flipY=k.flipY),void 0!==k.premultiplyAlpha&&(F.premultiplyAlpha=k.premultiplyAlpha),void 0!==k.unpackAlignment&&(F.unpackAlignment=k.unpackAlignment),_[k.uuid]=F}return _}parseObject(e,c,d,_,S){let L,k,F;function V(ue){return void 0===c[ue]&&console.warn("THREE.ObjectLoader: Undefined geometry",ue),c[ue]}function te(ue){if(void 0!==ue){if(Array.isArray(ue)){const _e=[];for(let Ee=0,$e=ue.length;Ee<$e;Ee++){const Le=ue[Ee];void 0===d[Le]&&console.warn("THREE.ObjectLoader: Undefined material",Le),_e.push(d[Le])}return _e}return void 0===d[ue]&&console.warn("THREE.ObjectLoader: Undefined material",ue),d[ue]}}function le(ue){return void 0===_[ue]&&console.warn("THREE.ObjectLoader: Undefined texture",ue),_[ue]}switch(e.type){case"Scene":L=new Us,void 0!==e.background&&(L.background=Number.isInteger(e.background)?new Kn(e.background):le(e.background)),void 0!==e.environment&&(L.environment=le(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?L.fog=new Ia(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(L.fog=new Lu(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":L=new Po(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(L.focus=e.focus),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.filmGauge&&(L.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(L.filmOffset=e.filmOffset),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"OrthographicCamera":L=new rc(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"AmbientLight":L=new am(e.color,e.intensity);break;case"DirectionalLight":L=new nd(e.color,e.intensity);break;case"PointLight":L=new If(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":L=new Gm(e.color,e.intensity,e.width,e.height);break;case"SpotLight":L=new fh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":L=new ap(e.color,e.groundColor,e.intensity);break;case"LightProbe":L=(new Zd).fromJSON(e);break;case"SkinnedMesh":k=V(e.geometry),F=te(e.material),L=new zl(k,F),void 0!==e.bindMode&&(L.bindMode=e.bindMode),void 0!==e.bindMatrix&&L.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(L.skeleton=e.skeleton);break;case"Mesh":k=V(e.geometry),F=te(e.material),L=new Ro(k,F);break;case"InstancedMesh":k=V(e.geometry),F=te(e.material);const _e=e.instanceMatrix,Ee=e.instanceColor;L=new Dc(k,F,e.count),L.instanceMatrix=new ou(new Float32Array(_e.array),16),void 0!==Ee&&(L.instanceColor=new ou(new Float32Array(Ee.array),Ee.itemSize));break;case"LOD":L=new ph;break;case"Line":L=new ka(V(e.geometry),te(e.material));break;case"LineLoop":L=new Qo(V(e.geometry),te(e.material));break;case"LineSegments":L=new dr(V(e.geometry),te(e.material));break;case"PointCloud":case"Points":L=new ta(V(e.geometry),te(e.material));break;case"Sprite":L=new Fc(te(e.material));break;case"Group":L=new ln;break;case"Bone":L=new jl;break;default:L=new Pr}if(L.uuid=e.uuid,void 0!==e.name&&(L.name=e.name),void 0!==e.matrix?(L.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(L.matrixAutoUpdate=e.matrixAutoUpdate),L.matrixAutoUpdate&&L.matrix.decompose(L.position,L.quaternion,L.scale)):(void 0!==e.position&&L.position.fromArray(e.position),void 0!==e.rotation&&L.rotation.fromArray(e.rotation),void 0!==e.quaternion&&L.quaternion.fromArray(e.quaternion),void 0!==e.scale&&L.scale.fromArray(e.scale)),void 0!==e.castShadow&&(L.castShadow=e.castShadow),void 0!==e.receiveShadow&&(L.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(L.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(L.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(L.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&L.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(L.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(L.visible=e.visible),void 0!==e.frustumCulled&&(L.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(L.renderOrder=e.renderOrder),void 0!==e.userData&&(L.userData=e.userData),void 0!==e.layers&&(L.layers.mask=e.layers),void 0!==e.children){const ue=e.children;for(let _e=0;_e<ue.length;_e++)L.add(this.parseObject(ue[_e],c,d,_,S))}if(void 0!==e.animations){const ue=e.animations;for(let _e=0;_e<ue.length;_e++)L.animations.push(S[ue[_e]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(L.autoUpdate=e.autoUpdate);const ue=e.levels;for(let _e=0;_e<ue.length;_e++){const Ee=ue[_e],$e=L.getObjectByProperty("uuid",Ee.object);void 0!==$e&&L.addLevel($e,Ee.distance)}}return L}bindSkeletons(e,c){0!==Object.keys(c).length&&e.traverse(function(d){if(!0===d.isSkinnedMesh&&void 0!==d.skeleton){const _=c[d.skeleton];void 0===_?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(_,d.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const E_={UVMapping:yi,CubeReflectionMapping:Ei,CubeRefractionMapping:So,EquirectangularReflectionMapping:Ws,EquirectangularRefractionMapping:la,CubeUVReflectionMapping:Ni,CubeUVRefractionMapping:Eo},s_={RepeatWrapping:go,ClampToEdgeWrapping:Jr,MirroredRepeatWrapping:os},a_={NearestFilter:Ir,NearestMipmapNearestFilter:Va,NearestMipmapLinearFilter:us,LinearFilter:ai,LinearMipmapNearestFilter:Gc,LinearMipmapLinearFilter:sl};class l_ extends Yn{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,c,d,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const S=this,L=ir.get(e);if(void 0!==L)return S.manager.itemStart(e),setTimeout(function(){c&&c(L),S.manager.itemEnd(e)},0),L;const k={};k.credentials="anonymous"===this.crossOrigin?"same-origin":"include",k.headers=this.requestHeader,fetch(e,k).then(function(F){return F.blob()}).then(function(F){return createImageBitmap(F,Object.assign(S.options,{colorSpaceConversion:"none"}))}).then(function(F){ir.add(e,F),c&&c(F),S.manager.itemEnd(e)}).catch(function(F){_&&_(F),S.manager.itemError(e),S.manager.itemEnd(e)}),S.manager.itemStart(e)}}l_.prototype.isImageBitmapLoader=!0;class c_{constructor(){this.type="ShapePath",this.color=new Kn,this.subPaths=[],this.currentPath=null}moveTo(e,c){return this.currentPath=new ja,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,c),this}lineTo(e,c){return this.currentPath.lineTo(e,c),this}quadraticCurveTo(e,c,d,_){return this.currentPath.quadraticCurveTo(e,c,d,_),this}bezierCurveTo(e,c,d,_,S,L){return this.currentPath.bezierCurveTo(e,c,d,_,S,L),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,c){function d(We){const tt=[];for(let Ze=0,ot=We.length;Ze<ot;Ze++){const st=We[Ze],Ct=new Ga;Ct.curves=st.curves,tt.push(Ct)}return tt}function _(We,tt){const Ze=tt.length;let ot=!1;for(let st=Ze-1,Ct=0;Ct<Ze;st=Ct++){let Ft=tt[st],Qe=tt[Ct],nt=Qe.x-Ft.x,Tt=Qe.y-Ft.y;if(Math.abs(Tt)>Number.EPSILON){if(Tt<0&&(Ft=tt[Ct],nt=-nt,Qe=tt[st],Tt=-Tt),We.y<Ft.y||We.y>Qe.y)continue;if(We.y===Ft.y){if(We.x===Ft.x)return!0}else{const Yt=Tt*(We.x-Ft.x)-nt*(We.y-Ft.y);if(0===Yt)return!0;if(Yt<0)continue;ot=!ot}}else{if(We.y!==Ft.y)continue;if(Qe.x<=We.x&&We.x<=Ft.x||Ft.x<=We.x&&We.x<=Qe.x)return!0}}return ot}const S=Ss.isClockWise,L=this.subPaths;if(0===L.length)return[];if(!0===c)return d(L);let k,F,V;const te=[];if(1===L.length)return F=L[0],V=new Ga,V.curves=F.curves,te.push(V),te;let le=!S(L[0].getPoints());le=e?!le:le;const ue=[],_e=[];let Ee,$e,Le=[],Ne=0;_e[Ne]=void 0,Le[Ne]=[];for(let We=0,tt=L.length;We<tt;We++)F=L[We],Ee=F.getPoints(),k=S(Ee),k=e?!k:k,k?(!le&&_e[Ne]&&Ne++,_e[Ne]={s:new Ga,p:Ee},_e[Ne].s.curves=F.curves,le&&Ne++,Le[Ne]=[]):Le[Ne].push({h:F,p:Ee[0]});if(!_e[0])return d(L);if(_e.length>1){let We=!1;const tt=[];for(let Ze=0,ot=_e.length;Ze<ot;Ze++)ue[Ze]=[];for(let Ze=0,ot=_e.length;Ze<ot;Ze++){const st=Le[Ze];for(let Ct=0;Ct<st.length;Ct++){const Ft=st[Ct];let Qe=!0;for(let nt=0;nt<_e.length;nt++)_(Ft.p,_e[nt].p)&&(Ze!==nt&&tt.push({froms:Ze,tos:nt,hole:Ct}),Qe?(Qe=!1,ue[nt].push(Ft)):We=!0);Qe&&ue[Ze].push(Ft)}}tt.length>0&&(We||(Le=ue))}for(let We=0,tt=_e.length;We<tt;We++){V=_e[We].s,te.push(V),$e=Le[We];for(let Ze=0,ot=$e.length;Ze<ot;Ze++)V.holes.push($e[Ze].h)}return te}}class Vm{constructor(e){this.type="Font",this.data=e}generateShapes(e,c=100){const d=[],_=function(S,L,k){const F=Array.from(S),V=L/k.resolution,te=(k.boundingBox.yMax-k.boundingBox.yMin+k.underlineThickness)*V,le=[];let ue=0,_e=0;for(let Ee=0;Ee<F.length;Ee++){const $e=F[Ee];if("\n"===$e)ue=0,_e-=te;else{const Le=T_($e,V,ue,_e,k);ue+=Le.offsetX,le.push(Le.path)}}return le}(e,c,this.data);for(let S=0,L=_.length;S<L;S++)Array.prototype.push.apply(d,_[S].toShapes());return d}}function T_(w,e,c,d,_){const S=_.glyphs[w]||_.glyphs["?"];if(!S)return void console.error('THREE.Font: character "'+w+'" does not exists in font family '+_.familyName+".");const L=new c_;let k,F,V,te,le,ue,_e,Ee;if(S.o){const $e=S._cachedOutline||(S._cachedOutline=S.o.split(" "));for(let Le=0,Ne=$e.length;Le<Ne;)switch($e[Le++]){case"m":k=$e[Le++]*e+c,F=$e[Le++]*e+d,L.moveTo(k,F);break;case"l":k=$e[Le++]*e+c,F=$e[Le++]*e+d,L.lineTo(k,F);break;case"q":V=$e[Le++]*e+c,te=$e[Le++]*e+d,le=$e[Le++]*e+c,ue=$e[Le++]*e+d,L.quadraticCurveTo(le,ue,V,te);break;case"b":V=$e[Le++]*e+c,te=$e[Le++]*e+d,le=$e[Le++]*e+c,ue=$e[Le++]*e+d,_e=$e[Le++]*e+c,Ee=$e[Le++]*e+d,L.bezierCurveTo(le,ue,_e,Ee,V,te)}}return{offsetX:S.ha*e,path:L}}Vm.prototype.isFont=!0;class u_ extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=new zr(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(S.withCredentials),L.load(e,function(k){let F;try{F=JSON.parse(k)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),F=JSON.parse(k.substring(65,k.length-2))}const V=S.parse(F);c&&c(V)},d,_)}parse(e){return new Vm(e)}}let Sl;const cm={getContext:function(){return void 0===Sl&&(Sl=new(window.AudioContext||window.webkitAudioContext)),Sl},setContext:function(w){Sl=w}};class Wm extends Yn{constructor(e){super(e)}load(e,c,d,_){const S=this,L=new zr(this.manager);L.setResponseType("arraybuffer"),L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(k){try{const F=k.slice(0);cm.getContext().decodeAudioData(F,function(V){c(V)})}catch(F){_?_(F):console.error(F),S.manager.itemError(e)}},d,_)}}class um extends Zd{constructor(e,c,d=1){super(void 0,d);const _=(new Kn).set(e),S=(new Kn).set(c),L=new ht(_.r,_.g,_.b),k=new ht(S.r,S.g,S.b),F=Math.sqrt(Math.PI),V=F*Math.sqrt(.75);this.sh.coefficients[0].copy(L).add(k).multiplyScalar(F),this.sh.coefficients[1].copy(L).sub(k).multiplyScalar(V)}}um.prototype.isHemisphereLightProbe=!0;class kf extends Zd{constructor(e,c=1){super(void 0,c);const d=(new Kn).set(e);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}}kf.prototype.isAmbientLightProbe=!0;const hm=new tn,pm=new tn;class h_{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Po,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Po,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const c=this._cache;if(c.focus!==e.focus||c.fov!==e.fov||c.aspect!==e.aspect*this.aspect||c.near!==e.near||c.far!==e.far||c.zoom!==e.zoom||c.eyeSep!==this.eyeSep){c.focus=e.focus,c.fov=e.fov,c.aspect=e.aspect*this.aspect,c.near=e.near,c.far=e.far,c.zoom=e.zoom,c.eyeSep=this.eyeSep;const d=e.projectionMatrix.clone(),_=c.eyeSep/2,S=_*c.near/c.focus,L=c.near*Math.tan(Ho*c.fov*.5)/c.zoom;let k,F;pm.elements[12]=-_,hm.elements[12]=_,k=-L*c.aspect+S,F=L*c.aspect+S,d.elements[0]=2*c.near/(F-k),d.elements[8]=(F+k)/(F-k),this.cameraL.projectionMatrix.copy(d),k=-L*c.aspect-S,F=L*c.aspect-S,d.elements[0]=2*c.near/(F-k),d.elements[8]=(F+k)/(F-k),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(pm),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(hm)}}class dm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=p_(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=p_();e=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=e}return e}}function p_(){return(typeof performance>"u"?Date:performance).now()}const Td=new ht,qm=new $i,Xm=new ht,Md=new ht;class fm extends Pr{constructor(){super(),this.type="AudioListener",this.context=cm.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new dm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const c=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Td,qm,Xm),Md.set(0,0,-1).applyQuaternion(qm),c.positionX){const _=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(Td.x,_),c.positionY.linearRampToValueAtTime(Td.y,_),c.positionZ.linearRampToValueAtTime(Td.z,_),c.forwardX.linearRampToValueAtTime(Md.x,_),c.forwardY.linearRampToValueAtTime(Md.y,_),c.forwardZ.linearRampToValueAtTime(Md.z,_),c.upX.linearRampToValueAtTime(d.x,_),c.upY.linearRampToValueAtTime(d.y,_),c.upZ.linearRampToValueAtTime(d.z,_)}else c.setPosition(Td.x,Td.y,Td.z),c.setOrientation(Md.x,Md.y,Md.z,d.x,d.y,d.z)}}class Ff extends Pr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const pp=new ht,Ym=new $i,yf=new ht,zu=new ht;class mm extends Ff{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,c,d){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=d,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(pp,Ym,yf),zu.set(0,0,1).applyQuaternion(Ym);const c=this.panner;if(c.positionX){const d=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(pp.x,d),c.positionY.linearRampToValueAtTime(pp.y,d),c.positionZ.linearRampToValueAtTime(pp.z,d),c.orientationX.linearRampToValueAtTime(zu.x,d),c.orientationY.linearRampToValueAtTime(zu.y,d),c.orientationZ.linearRampToValueAtTime(zu.z,d)}else c.setPosition(pp.x,pp.y,pp.z),c.setOrientation(zu.x,zu.y,zu.z)}}class _m{constructor(e,c=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const c=this.getFrequencyData();for(let d=0;d<c.length;d++)e+=c[d];return e/c.length}}class Jm{constructor(e,c,d){let _,S,L;switch(this.binding=e,this.valueSize=d,c){case"quaternion":_=this._slerp,S=this._slerpAdditive,L=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*d),this._workIndex=5;break;case"string":case"bool":_=this._select,S=this._select,L=this._setAdditiveIdentityOther,this.buffer=new Array(5*d);break;default:_=this._lerp,S=this._lerpAdditive,L=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*d)}this._mixBufferRegion=_,this._mixBufferRegionAdditive=S,this._setIdentity=L,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,c){const d=this.buffer,_=this.valueSize,S=e*_+_;let L=this.cumulativeWeight;if(0===L){for(let k=0;k!==_;++k)d[S+k]=d[k];L=c}else L+=c,this._mixBufferRegion(d,S,0,c/L,_);this.cumulativeWeight=L}accumulateAdditive(e){const c=this.buffer,d=this.valueSize,_=d*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,_,0,e,d),this.cumulativeWeightAdditive+=e}apply(e){const c=this.valueSize,d=this.buffer,_=e*c+c,S=this.cumulativeWeight,L=this.cumulativeWeightAdditive,k=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,S<1&&this._mixBufferRegion(d,_,c*this._origIndex,1-S,c),L>0&&this._mixBufferRegionAdditive(d,_,this._addIndex*c,1,c);for(let F=c,V=c+c;F!==V;++F)if(d[F]!==d[F+c]){k.setValue(d,_);break}}saveOriginalState(){const c=this.buffer,d=this.valueSize,_=d*this._origIndex;this.binding.getValue(c,_);for(let S=d,L=_;S!==L;++S)c[S]=c[_+S%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,c=e+this.valueSize;for(let d=e;d<c;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[c+d]=this.buffer[e+d]}_select(e,c,d,_,S){if(_>=.5)for(let L=0;L!==S;++L)e[c+L]=e[d+L]}_slerp(e,c,d,_){$i.slerpFlat(e,c,e,c,e,d,_)}_slerpAdditive(e,c,d,_,S){const L=this._workIndex*S;$i.multiplyQuaternionsFlat(e,L,e,c,e,d),$i.slerpFlat(e,c,e,c,e,L,_)}_lerp(e,c,d,_,S){const L=1-_;for(let k=0;k!==S;++k){const F=c+k;e[F]=e[F]*L+e[d+k]*_}}_lerpAdditive(e,c,d,_,S){for(let L=0;L!==S;++L){const k=c+L;e[k]=e[k]+e[d+L]*_}}}const od="\\[\\]\\.:\\/",bf=new RegExp("["+od+"]","g"),Zm="[^"+od+"]",d_="[^"+od.replace("\\.","")+"]",f_=/((?:WC+[\/:])*)/.source.replace("WC",Zm),xf=/(WCOD+)?/.source.replace("WCOD",d_),Df=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Zm),gm=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Zm),m_=new RegExp("^"+f_+xf+Df+gm+"$"),vm=["material","materials","bones"];class fo{constructor(e,c,d){this.path=c,this.parsedPath=d||fo.parseTrackName(c),this.node=fo.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,c,d){return e&&e.isAnimationObjectGroup?new fo.Composite(e,c,d):new fo(e,c,d)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(bf,"")}static parseTrackName(e){const c=m_.exec(e);if(!c)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const d={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]},_=d.nodeName&&d.nodeName.lastIndexOf(".");if(void 0!==_&&-1!==_){const S=d.nodeName.substring(_+1);-1!==vm.indexOf(S)&&(d.nodeName=d.nodeName.substring(0,_),d.objectName=S)}if(null===d.propertyName||0===d.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return d}static findNode(e,c){if(!c||""===c||"."===c||-1===c||c===e.name||c===e.uuid)return e;if(e.skeleton){const d=e.skeleton.getBoneByName(c);if(void 0!==d)return d}if(e.children){const d=function(S){for(let L=0;L<S.length;L++){const k=S[L];if(k.name===c||k.uuid===c)return k;const F=d(k.children);if(F)return F}return null},_=d(e.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,c){e[c]=this.targetObject[this.propertyName]}_getValue_array(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)e[c++]=d[_]}_getValue_arrayElement(e,c){e[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,c){this.resolvedProperty.toArray(e,c)}_setValue_direct(e,c){this.targetObject[this.propertyName]=e[c]}_setValue_direct_setNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++]}_setValue_array_setNeedsUpdate(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,c){const d=this.resolvedProperty;for(let _=0,S=d.length;_!==S;++_)d[_]=e[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,c){this.resolvedProperty[this.propertyIndex]=e[c]}_setValue_arrayElement_setNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,c){this.resolvedProperty.fromArray(e,c)}_setValue_fromArray_setNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,c){this.bind(),this.getValue(e,c)}_setValue_unbound(e,c){this.bind(),this.setValue(e,c)}bind(){let e=this.node;const c=this.parsedPath,d=c.objectName,_=c.propertyName;let S=c.propertyIndex;if(e||(e=fo.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(d){let V=c.objectIndex;switch(d){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let te=0;te<e.length;te++)if(e[te].name===V){V=te;break}break;default:if(void 0===e[d])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[d]}if(void 0!==V){if(void 0===e[V])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[V]}}const L=e[_];if(void 0===L)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+c.nodeName+"."+_+" but it wasn't found.",e);let k=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?k=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(k=this.Versioning.MatrixWorldNeedsUpdate);let F=this.BindingType.Direct;if(void 0!==S){if("morphTargetInfluences"===_){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[S]&&(S=e.morphTargetDictionary[S])}F=this.BindingType.ArrayElement,this.resolvedProperty=L,this.propertyIndex=S}else void 0!==L.fromArray&&void 0!==L.toArray?(F=this.BindingType.HasFromToArray,this.resolvedProperty=L):Array.isArray(L)?(F=this.BindingType.EntireArray,this.resolvedProperty=L):this.propertyName=_;this.getValue=this.GetterByBindingType[F],this.setValue=this.SetterByBindingTypeAndVersioning[F][k]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}fo.Composite=class{constructor(w,e,c){const d=c||fo.parseTrackName(e);this._targetGroup=w,this._bindings=w.subscribe_(e,d)}getValue(w,e){this.bind();const d=this._bindings[this._targetGroup.nCachedObjects_];void 0!==d&&d.getValue(w,e)}setValue(w,e){const c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,_=c.length;d!==_;++d)c[d].setValue(w,e)}bind(){const w=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=w.length;e!==c;++e)w[e].bind()}unbind(){const w=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=w.length;e!==c;++e)w[e].unbind()}},fo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},fo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},fo.prototype.GetterByBindingType=[fo.prototype._getValue_direct,fo.prototype._getValue_array,fo.prototype._getValue_arrayElement,fo.prototype._getValue_toArray],fo.prototype.SetterByBindingTypeAndVersioning=[[fo.prototype._setValue_direct,fo.prototype._setValue_direct_setNeedsUpdate,fo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fo.prototype._setValue_array,fo.prototype._setValue_array_setNeedsUpdate,fo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fo.prototype._setValue_arrayElement,fo.prototype._setValue_arrayElement_setNeedsUpdate,fo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fo.prototype._setValue_fromArray,fo.prototype._setValue_fromArray_setNeedsUpdate,fo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Qd{constructor(){this.uuid=Zi(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let d=0,_=arguments.length;d!==_;++d)e[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const e=this._objects,c=this._indicesByUUID,d=this._paths,_=this._parsedPaths,S=this._bindings,L=S.length;let k,F=e.length,V=this.nCachedObjects_;for(let te=0,le=arguments.length;te!==le;++te){const ue=arguments[te],_e=ue.uuid;let Ee=c[_e];if(void 0===Ee){Ee=F++,c[_e]=Ee,e.push(ue);for(let $e=0,Le=L;$e!==Le;++$e)S[$e].push(new fo(ue,d[$e],_[$e]))}else if(Ee<V){k=e[Ee];const $e=--V,Le=e[$e];c[Le.uuid]=Ee,e[Ee]=Le,c[_e]=$e,e[$e]=ue;for(let Ne=0,We=L;Ne!==We;++Ne){const tt=S[Ne];let ot=tt[Ee];tt[Ee]=tt[$e],void 0===ot&&(ot=new fo(ue,d[Ne],_[Ne])),tt[$e]=ot}}else e[Ee]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=V}remove(){const e=this._objects,c=this._indicesByUUID,d=this._bindings,_=d.length;let S=this.nCachedObjects_;for(let L=0,k=arguments.length;L!==k;++L){const F=arguments[L],V=F.uuid,te=c[V];if(void 0!==te&&te>=S){const le=S++,ue=e[le];c[ue.uuid]=te,e[te]=ue,c[V]=le,e[le]=F;for(let _e=0,Ee=_;_e!==Ee;++_e){const $e=d[_e],Ne=$e[te];$e[te]=$e[le],$e[le]=Ne}}}this.nCachedObjects_=S}uncache(){const e=this._objects,c=this._indicesByUUID,d=this._bindings,_=d.length;let S=this.nCachedObjects_,L=e.length;for(let k=0,F=arguments.length;k!==F;++k){const V=arguments[k].uuid,te=c[V];if(void 0!==te)if(delete c[V],te<S){const le=--S,ue=e[le],_e=--L,Ee=e[_e];c[ue.uuid]=te,e[te]=ue,c[Ee.uuid]=le,e[le]=Ee,e.pop();for(let $e=0,Le=_;$e!==Le;++$e){const Ne=d[$e],tt=Ne[_e];Ne[te]=Ne[le],Ne[le]=tt,Ne.pop()}}else{const le=--L,ue=e[le];le>0&&(c[ue.uuid]=te),e[te]=ue,e.pop();for(let _e=0,Ee=_;_e!==Ee;++_e){const $e=d[_e];$e[te]=$e[le],$e.pop()}}}this.nCachedObjects_=S}subscribe_(e,c){const d=this._bindingsIndicesByPath;let _=d[e];const S=this._bindings;if(void 0!==_)return S[_];const L=this._paths,k=this._parsedPaths,F=this._objects,te=this.nCachedObjects_,le=new Array(F.length);_=S.length,d[e]=_,L.push(e),k.push(c),S.push(le);for(let ue=te,_e=F.length;ue!==_e;++ue)le[ue]=new fo(F[ue],e,c);return le}unsubscribe_(e){const c=this._bindingsIndicesByPath,d=c[e];if(void 0!==d){const _=this._paths,S=this._parsedPaths,L=this._bindings,k=L.length-1,F=L[k];c[e[k]]=d,L[d]=F,L.pop(),S[d]=S[k],S.pop(),_[d]=_[k],_.pop()}}}Qd.prototype.isAnimationObjectGroup=!0;class ym{constructor(e,c,d=null,_=c.blendMode){this._mixer=e,this._clip=c,this._localRoot=d,this.blendMode=_;const S=c.tracks,L=S.length,k=new Array(L),F={endingStart:$a,endingEnd:$a};for(let V=0;V!==L;++V){const te=S[V].createInterpolant(null);k[V]=te,te.settings=F}this._interpolantSettings=F,this._interpolants=k,this._propertyBindings=new Array(L),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,c){return this.loop=e,this.repetitions=c,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,c,d){if(e.fadeOut(c),this.fadeIn(c),d){const _=this._clip.duration,S=e._clip.duration,k=_/S;e.warp(1,S/_,c),this.warp(k,1,c)}return this}crossFadeTo(e,c,d){return e.crossFadeFrom(this,c,d)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,c,d){const _=this._mixer,S=_.time,L=this.timeScale;let k=this._timeScaleInterpolant;null===k&&(k=_._lendControlInterpolant(),this._timeScaleInterpolant=k);const F=k.parameterPositions,V=k.sampleValues;return F[0]=S,F[1]=S+d,V[0]=e/L,V[1]=c/L,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,c,d,_){if(!this.enabled)return void this._updateWeight(e);const S=this._startTime;if(null!==S){const F=(e-S)*d;if(F<0||0===d)return;this._startTime=null,c=d*F}c*=this._updateTimeScale(e);const L=this._updateTime(c),k=this._updateWeight(e);if(k>0){const F=this._interpolants,V=this._propertyBindings;if(this.blendMode===th)for(let te=0,le=F.length;te!==le;++te)F[te].evaluate(L),V[te].accumulateAdditive(k);else for(let te=0,le=F.length;te!==le;++te)F[te].evaluate(L),V[te].accumulate(_,k)}}_updateWeight(e){let c=0;if(this.enabled){c=this.weight;const d=this._weightInterpolant;if(null!==d){const _=d.evaluate(e)[0];c*=_,e>d.parameterPositions[1]&&(this.stopFading(),0===_&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(e){let c=0;if(!this.paused){c=this.timeScale;const d=this._timeScaleInterpolant;null!==d&&(c*=d.evaluate(e)[0],e>d.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c))}return this._effectiveTimeScale=c,c}_updateTime(e){const c=this._clip.duration,d=this.loop;let _=this.time+e,S=this._loopCount;const L=d===bc;if(0===e)return-1===S?_:L&&1==(1&S)?c-_:_;if(d===gu){-1===S&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=c)_=c;else{if(!(_<0)){this.time=_;break e}_=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===S&&(e>=0?(S=0,this._setEndings(!0,0===this.repetitions,L)):this._setEndings(0===this.repetitions,!0,L)),_>=c||_<0){const k=Math.floor(_/c);_-=c*k,S+=Math.abs(k);const F=this.repetitions-S;if(F<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=e>0?c:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===F){const V=e<0;this._setEndings(V,!V,L)}else this._setEndings(!1,!1,L);this._loopCount=S,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:k})}}else this.time=_;if(L&&1==(1&S))return c-_}return _}_setEndings(e,c,d){const _=this._interpolantSettings;d?(_.endingStart=ua,_.endingEnd=ua):(_.endingStart=e?this.zeroSlopeAtStart?ua:$a:Al,_.endingEnd=c?this.zeroSlopeAtEnd?ua:$a:Al)}_scheduleFading(e,c,d){const _=this._mixer,S=_.time;let L=this._weightInterpolant;null===L&&(L=_._lendControlInterpolant(),this._weightInterpolant=L);const k=L.parameterPositions,F=L.sampleValues;return k[0]=S,F[0]=c,k[1]=S+e,F[1]=d,this}}class ia extends ks{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,c){const d=e._localRoot||this._root,_=e._clip.tracks,S=_.length,L=e._propertyBindings,k=e._interpolants,F=d.uuid,V=this._bindingsByRootAndName;let te=V[F];void 0===te&&(te={},V[F]=te);for(let le=0;le!==S;++le){const ue=_[le],_e=ue.name;let Ee=te[_e];if(void 0!==Ee)L[le]=Ee;else{if(Ee=L[le],void 0!==Ee){null===Ee._cacheIndex&&(++Ee.referenceCount,this._addInactiveBinding(Ee,F,_e));continue}Ee=new Jm(fo.create(d,_e,c&&c._propertyBindings[le].binding.parsedPath),ue.ValueTypeName,ue.getValueSize()),++Ee.referenceCount,this._addInactiveBinding(Ee,F,_e),L[le]=Ee}k[le].resultBuffer=Ee.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const d=(e._localRoot||this._root).uuid,_=e._clip.uuid,S=this._actionsByClip[_];this._bindAction(e,S&&S.knownActions[0]),this._addInactiveAction(e,_,d)}const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==S.useCount++&&(this._lendBinding(S),S.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==--S.useCount&&(S.restoreOriginalState(),this._takeBackBinding(S))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const c=e._cacheIndex;return null!==c&&c<this._nActiveActions}_addInactiveAction(e,c,d){const _=this._actions,S=this._actionsByClip;let L=S[c];if(void 0===L)L={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,S[c]=L;else{const k=L.knownActions;e._byClipCacheIndex=k.length,k.push(e)}e._cacheIndex=_.length,_.push(e),L.actionByRoot[d]=e}_removeInactiveAction(e){const c=this._actions,d=c[c.length-1],_=e._cacheIndex;d._cacheIndex=_,c[_]=d,c.pop(),e._cacheIndex=null;const S=e._clip.uuid,L=this._actionsByClip,k=L[S],F=k.knownActions,V=F[F.length-1],te=e._byClipCacheIndex;V._byClipCacheIndex=te,F[te]=V,F.pop(),e._byClipCacheIndex=null,delete k.actionByRoot[(e._localRoot||this._root).uuid],0===F.length&&delete L[S],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const c=e._propertyBindings;for(let d=0,_=c.length;d!==_;++d){const S=c[d];0==--S.referenceCount&&this._removeInactiveBinding(S)}}_lendAction(e){const c=this._actions,d=e._cacheIndex,_=this._nActiveActions++,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_takeBackAction(e){const c=this._actions,d=e._cacheIndex,_=--this._nActiveActions,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_addInactiveBinding(e,c,d){const _=this._bindingsByRootAndName,S=this._bindings;let L=_[c];void 0===L&&(L={},_[c]=L),L[d]=e,e._cacheIndex=S.length,S.push(e)}_removeInactiveBinding(e){const c=this._bindings,d=e.binding,_=d.rootNode.uuid,S=d.path,L=this._bindingsByRootAndName,k=L[_],F=c[c.length-1],V=e._cacheIndex;F._cacheIndex=V,c[V]=F,c.pop(),delete k[S],0===Object.keys(k).length&&delete L[_]}_lendBinding(e){const c=this._bindings,d=e._cacheIndex,_=this._nActiveBindings++,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_takeBackBinding(e){const c=this._bindings,d=e._cacheIndex,_=--this._nActiveBindings,S=c[_];e._cacheIndex=_,c[_]=e,S._cacheIndex=d,c[d]=S}_lendControlInterpolant(){const e=this._controlInterpolants,c=this._nActiveControlInterpolants++;let d=e[c];return void 0===d&&(d=new St(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),d.__cacheIndex=c,e[c]=d),d}_takeBackControlInterpolant(e){const c=this._controlInterpolants,d=e.__cacheIndex,_=--this._nActiveControlInterpolants,S=c[_];e.__cacheIndex=_,c[_]=e,S.__cacheIndex=d,c[d]=S}clipAction(e,c,d){const _=c||this._root,S=_.uuid;let L="string"==typeof e?xn.findByName(_,e):e;const k=null!==L?L.uuid:e,F=this._actionsByClip[k];let V=null;if(void 0===d&&(d=null!==L?L.blendMode:eh),void 0!==F){const le=F.actionByRoot[S];if(void 0!==le&&le.blendMode===d)return le;V=F.knownActions[0],null===L&&(L=V._clip)}if(null===L)return null;const te=new ym(this,L,c,d);return this._bindAction(te,V),this._addInactiveAction(te,k,S),te}existingAction(e,c){const d=c||this._root,_=d.uuid,S="string"==typeof e?xn.findByName(d,e):e,k=this._actionsByClip[S?S.uuid:e];return void 0!==k&&k.actionByRoot[_]||null}stopAllAction(){const e=this._actions;for(let c=this._nActiveActions-1;c>=0;--c)e[c].stop();return this}update(e){const c=this._actions,d=this._nActiveActions,_=this.time+=e*=this.timeScale,S=Math.sign(e),L=this._accuIndex^=1;for(let V=0;V!==d;++V)c[V]._update(_,e,S,L);const k=this._bindings,F=this._nActiveBindings;for(let V=0;V!==F;++V)k[V].apply(L);return this}setTime(e){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const c=this._actions,d=e.uuid,_=this._actionsByClip,S=_[d];if(void 0!==S){const L=S.knownActions;for(let k=0,F=L.length;k!==F;++k){const V=L[k];this._deactivateAction(V);const te=V._cacheIndex,le=c[c.length-1];V._cacheIndex=null,V._byClipCacheIndex=null,le._cacheIndex=te,c[te]=le,c.pop(),this._removeInactiveBindingsForAction(V)}delete _[d]}}uncacheRoot(e){const c=e.uuid,d=this._actionsByClip;for(const S in d){const L=d[S].actionByRoot[c];void 0!==L&&(this._deactivateAction(L),this._removeInactiveAction(L))}const _=this._bindingsByRootAndName[c];if(void 0!==_)for(const S in _){const L=_[S];L.restoreOriginalState(),this._removeInactiveBinding(L)}}uncacheAction(e,c){const d=this.existingAction(e,c);null!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}}ia.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Ad{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Ad(void 0===this.value.clone?this.value:this.value.clone())}}class Ea extends Oc{constructor(e,c,d=1){super(e,c),this.meshPerAttribute=d}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const c=super.clone(e);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(e){const c=super.toJSON(e);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}Ea.prototype.isInstancedInterleavedBuffer=!0;class Uf{constructor(e,c,d,_,S){this.buffer=e,this.type=c,this.itemSize=d,this.elementSize=_,this.count=S,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,c){return this.type=e,this.elementSize=c,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}Uf.prototype.isGLBufferAttribute=!0;class $d{constructor(e,c,d=0,_=1/0){this.ray=new fn(e,c),this.near=d,this.far=_,this.camera=null,this.layers=new Js,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,c){this.ray.set(e,c)}setFromCamera(e,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(e,c=!1,d=[]){return Kd(e,this,d,c),d.sort(wf),d}intersectObjects(e,c=!1,d=[]){for(let _=0,S=e.length;_<S;_++)Kd(e[_],this,d,c);return d.sort(wf),d}}function wf(w,e){return w.distance-e.distance}function Kd(w,e,c,d){if(w.layers.test(e.layers)&&w.raycast(e,c),!0===d){const _=w.children;for(let S=0,L=_.length;S<L;S++)Kd(_[S],e,c,!0)}}class __{constructor(e=1,c=0,d=0){return this.radius=e,this.phi=c,this.theta=d,this}set(e,c,d){return this.radius=e,this.phi=c,this.theta=d,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,d){return this.radius=Math.sqrt(e*e+c*c+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,d),this.phi=Math.acos(Hr(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class bm{constructor(e=1,c=0,d=0){return this.radius=e,this.theta=c,this.y=d,this}set(e,c,d){return this.radius=e,this.theta=c,this.y=d,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,d){return this.radius=Math.sqrt(e*e+d*d),this.theta=Math.atan2(e,d),this.y=c,this}clone(){return(new this.constructor).copy(this)}}const xm=new zn;class mh{constructor(e=new zn(1/0,1/0),c=new zn(-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromPoints(e){this.makeEmpty();for(let c=0,d=e.length;c<d;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const d=xm.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return xm.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}mh.prototype.isBox2=!0;const Sf=new ht,_h=new ht;class Qm{constructor(e=new ht,c=new ht){this.start=e,this.end=c}set(e,c){return this.start.copy(e),this.end.copy(c),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,c){return this.delta(c).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,c){Sf.subVectors(e,this.start),_h.subVectors(this.end,this.start);const d=_h.dot(_h);let _=_h.dot(Sf)/d;return c&&(_=Hr(_,0,1)),_}closestPointToPoint(e,c,d){const _=this.closestPointToPointParameter(e,c);return this.delta(d).multiplyScalar(_).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class Km extends Pr{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}Km.prototype.isImmediateRenderObject=!0;const ef=new ht;class zp extends Pr{constructor(e,c){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const d=new br,_=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let L=0,k=1,F=32;L<F;L++,k++){const V=L/F*Math.PI*2,te=k/F*Math.PI*2;_.push(Math.cos(V),Math.sin(V),1,Math.cos(te),Math.sin(te),1)}d.setAttribute("position",new hn(_,3));const S=new kt({fog:!1,toneMapped:!1});this.cone=new dr(d,S),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,c=e*Math.tan(this.light.angle);this.cone.scale.set(c,c,e),ef.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ef),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const jp=new ht,Cd=new tn,wm=new tn;class zf extends dr{constructor(e){const c=Sm(e),d=new br,_=[],S=[],L=new Kn(0,0,1),k=new Kn(0,1,0);for(let F=0;F<c.length;F++){const V=c[F];V.parent&&V.parent.isBone&&(_.push(0,0,0),_.push(0,0,0),S.push(L.r,L.g,L.b),S.push(k.r,k.g,k.b))}d.setAttribute("position",new hn(_,3)),d.setAttribute("color",new hn(S,3)),super(d,new kt({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=c,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const c=this.bones,d=this.geometry,_=d.getAttribute("position");wm.copy(this.root.matrixWorld).invert();for(let S=0,L=0;S<c.length;S++){const k=c[S];k.parent&&k.parent.isBone&&(Cd.multiplyMatrices(wm,k.matrixWorld),jp.setFromMatrixPosition(Cd),_.setXYZ(L,jp.x,jp.y,jp.z),Cd.multiplyMatrices(wm,k.parent.matrixWorld),jp.setFromMatrixPosition(Cd),_.setXYZ(L+1,jp.x,jp.y,jp.z),L+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Sm(w){const e=[];w&&w.isBone&&e.push(w);for(let c=0;c<w.children.length;c++)e.push.apply(e,Sm(w.children[c]));return e}class tf extends Ro{constructor(e,c,d){super(new p(c,4,2),new fl({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ef=new ht,e_=new Kn,Em=new Kn;class M_ extends Pr{constructor(e,c,d){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=d;const _=new xr(c);_.rotateY(.5*Math.PI),this.material=new fl({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const S=_.getAttribute("position"),L=new Float32Array(3*S.count);_.setAttribute("color",new Pi(L,3)),this.add(new Ro(_,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=e.geometry.getAttribute("color");e_.copy(this.light.color),Em.copy(this.light.groundColor);for(let d=0,_=c.count;d<_;d++){const S=d<_/2?e_:Em;c.setXYZ(d,S.r,S.g,S.b)}c.needsUpdate=!0}e.lookAt(Ef.setFromMatrixPosition(this.light.matrixWorld).negate())}}class t_ extends dr{constructor(e=10,c=10,d=4473924,_=8947848){d=new Kn(d),_=new Kn(_);const S=c/2,L=e/c,k=e/2,F=[],V=[];for(let le=0,ue=0,_e=-k;le<=c;le++,_e+=L){F.push(-k,0,_e,k,0,_e),F.push(_e,0,-k,_e,0,k);const Ee=le===S?d:_;Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3,Ee.toArray(V,ue),ue+=3}const te=new br;te.setAttribute("position",new hn(F,3)),te.setAttribute("color",new hn(V,3)),super(te,new kt({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Tm extends dr{constructor(e=10,c=16,d=8,_=64,S=4473924,L=8947848){S=new Kn(S),L=new Kn(L);const k=[],F=[];for(let te=0;te<=c;te++){const le=te/c*(2*Math.PI),ue=Math.sin(le)*e,_e=Math.cos(le)*e;k.push(0,0,0),k.push(ue,0,_e);const Ee=1&te?S:L;F.push(Ee.r,Ee.g,Ee.b),F.push(Ee.r,Ee.g,Ee.b)}for(let te=0;te<=d;te++){const le=1&te?S:L,ue=e-e/d*te;for(let _e=0;_e<_;_e++){let Ee=_e/_*(2*Math.PI),$e=Math.sin(Ee)*ue,Le=Math.cos(Ee)*ue;k.push($e,0,Le),F.push(le.r,le.g,le.b),Ee=(_e+1)/_*(2*Math.PI),$e=Math.sin(Ee)*ue,Le=Math.cos(Ee)*ue,k.push($e,0,Le),F.push(le.r,le.g,le.b)}}const V=new br;V.setAttribute("position",new hn(k,3)),V.setAttribute("color",new hn(F,3)),super(V,new kt({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const n_=new ht,jf=new ht,g_=new ht;class A_ extends Pr{constructor(e,c,d){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,void 0===c&&(c=1);let _=new br;_.setAttribute("position",new hn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const S=new kt({fog:!1,toneMapped:!1});this.lightPlane=new ka(_,S),this.add(this.lightPlane),_=new br,_.setAttribute("position",new hn([0,0,0,0,0,1],3)),this.targetLine=new ka(_,S),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){n_.setFromMatrixPosition(this.light.matrixWorld),jf.setFromMatrixPosition(this.light.target.matrixWorld),g_.subVectors(jf,n_),this.lightPlane.lookAt(jf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(jf),this.targetLine.scale.z=g_.length()}}const Mm=new ht,Ta=new Rl;class $_ extends dr{constructor(e){const c=new br,d=new kt({color:16777215,vertexColors:!0,toneMapped:!1}),_=[],S=[],L={},k=new Kn(16755200),F=new Kn(16711680),V=new Kn(43775),te=new Kn(16777215),le=new Kn(3355443);function ue(Ee,$e,Le){_e(Ee,Le),_e($e,Le)}function _e(Ee,$e){_.push(0,0,0),S.push($e.r,$e.g,$e.b),void 0===L[Ee]&&(L[Ee]=[]),L[Ee].push(_.length/3-1)}ue("n1","n2",k),ue("n2","n4",k),ue("n4","n3",k),ue("n3","n1",k),ue("f1","f2",k),ue("f2","f4",k),ue("f4","f3",k),ue("f3","f1",k),ue("n1","f1",k),ue("n2","f2",k),ue("n3","f3",k),ue("n4","f4",k),ue("p","n1",F),ue("p","n2",F),ue("p","n3",F),ue("p","n4",F),ue("u1","u2",V),ue("u2","u3",V),ue("u3","u1",V),ue("c","t",te),ue("p","c",le),ue("cn1","cn2",le),ue("cn3","cn4",le),ue("cf1","cf2",le),ue("cf3","cf4",le),c.setAttribute("position",new hn(_,3)),c.setAttribute("color",new hn(S,3)),super(c,d),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=L,this.update()}update(){const e=this.geometry,c=this.pointMap;Ta.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ha("c",c,e,Ta,0,0,-1),Ha("t",c,e,Ta,0,0,1),Ha("n1",c,e,Ta,-1,-1,-1),Ha("n2",c,e,Ta,1,-1,-1),Ha("n3",c,e,Ta,-1,1,-1),Ha("n4",c,e,Ta,1,1,-1),Ha("f1",c,e,Ta,-1,-1,1),Ha("f2",c,e,Ta,1,-1,1),Ha("f3",c,e,Ta,-1,1,1),Ha("f4",c,e,Ta,1,1,1),Ha("u1",c,e,Ta,.7,1.1,-1),Ha("u2",c,e,Ta,-.7,1.1,-1),Ha("u3",c,e,Ta,0,2,-1),Ha("cf1",c,e,Ta,-1,0,1),Ha("cf2",c,e,Ta,1,0,1),Ha("cf3",c,e,Ta,0,-1,1),Ha("cf4",c,e,Ta,0,1,1),Ha("cn1",c,e,Ta,-1,0,-1),Ha("cn2",c,e,Ta,1,0,-1),Ha("cn3",c,e,Ta,0,-1,-1),Ha("cn4",c,e,Ta,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ha(w,e,c,d,_,S,L){Mm.set(_,S,L).unproject(d);const k=e[w];if(void 0!==k){const F=c.getAttribute("position");for(let V=0,te=k.length;V<te;V++)F.setXYZ(k[V],Mm.x,Mm.y,Mm.z)}}const Am=new Ui;class v_ extends dr{constructor(e,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new Float32Array(24),S=new br;S.setIndex(new Pi(d,1)),S.setAttribute("position",new Pi(_,3)),super(S,new kt({color:c,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Am.setFromObject(this.object),Am.isEmpty())return;const c=Am.min,d=Am.max,_=this.geometry.attributes.position,S=_.array;S[0]=d.x,S[1]=d.y,S[2]=d.z,S[3]=c.x,S[4]=d.y,S[5]=d.z,S[6]=c.x,S[7]=c.y,S[8]=d.z,S[9]=d.x,S[10]=c.y,S[11]=d.z,S[12]=d.x,S[13]=d.y,S[14]=c.z,S[15]=c.x,S[16]=d.y,S[17]=c.z,S[18]=c.x,S[19]=c.y,S[20]=c.z,S[21]=d.x,S[22]=c.y,S[23]=c.z,_.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return dr.prototype.copy.call(this,e),this.object=e.object,this}}class C_ extends dr{constructor(e,c=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new br;_.setIndex(new Pi(d,1)),_.setAttribute("position",new hn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(_,new kt({color:c,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class L_ extends ka{constructor(e,c=1,d=16776960){const _=d,S=new br;S.setAttribute("position",new hn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),S.computeBoundingSphere(),super(S,new kt({color:_,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=c;const L=new br;L.setAttribute("position",new hn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),L.computeBoundingSphere(),this.add(new Ro(L,new fl({color:_,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?W:ae,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const y_=new ht;let $m,r_;class B_ extends Pr{constructor(e=new ht(0,0,1),c=new ht(0,0,0),d=1,_=16776960,S=.2*d,L=.2*S){super(),this.type="ArrowHelper",void 0===$m&&($m=new br,$m.setAttribute("position",new hn([0,0,0,0,1,0],3)),r_=new rl(0,.5,1,5,1),r_.translate(0,-.5,0)),this.position.copy(c),this.line=new ka($m,new kt({color:_,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ro(r_,new fl({color:_,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(d,S,L)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{y_.set(e.z,0,-e.x).normalize();const c=Math.acos(e.y);this.quaternion.setFromAxisAngle(y_,c)}}setLength(e,c=.2*e,d=.2*c){this.line.scale.set(1,Math.max(1e-4,e-c),1),this.line.updateMatrix(),this.cone.scale.set(d,c,d),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class b_ extends dr{constructor(e=1){const c=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],d=new br;d.setAttribute("position",new hn(c,3)),d.setAttribute("color",new hn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(d,new kt({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,c,d){const _=new Kn,S=this.geometry.attributes.color.array;return _.set(e),_.toArray(S,0),_.toArray(S,3),_.set(c),_.toArray(S,6),_.toArray(S,9),_.set(d),_.toArray(S,12),_.toArray(S,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const x_=new Float32Array(1),N_=new Int32Array(x_.buffer);class R_{static toHalfFloat(e){x_[0]=e;const c=N_[0];let d=c>>16&32768,_=c>>12&2047;const S=c>>23&255;return S<103?d:S>142?(d|=31744,d|=(255==S?0:1)&&8388607&c,d):S<113?(_|=2048,d|=(_>>114-S)+(_>>113-S&1),d):(d|=S-112<<10|_>>1,d+=1&_,d)}}const P_=0,I_=1,O_=0,k_=1,F_=2;function D_(w){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),w}function U_(w=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),w.isMultiMaterial=!0,w.materials=w,w.clone=function(){return w.slice()},w}function w_(w,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ta(w,e)}function S_(w){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Fc(w)}function i_(w,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ta(w,e)}function z_(w){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function j_(w){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function G_(w){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new gi(w)}function H_(w,e,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ht(w,e,c)}function V_(w,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Pi(w,e).setUsage(Br)}function W_(w,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Pd(w,e)}function q_(w,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Cp(w,e)}function X_(w,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ba(w,e)}function Y_(w,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new oh(w,e)}function J_(w,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new sh(w,e)}function Z_(w,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Na(w,e)}function Q_(w,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new li(w,e)}function t(w,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new hn(w,e)}function u(w,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Qc(w,e)}function m(w){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new b_(w)}function g(w,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new v_(w,e)}function E(w,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new dr(new lu(w.geometry),new kt({color:void 0!==e?e:16777215}))}function I(w,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new dr(new z(w.geometry),new kt({color:void 0!==e?e:16777215}))}function H(w){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new zr(w)}function J(w){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Hs(w)}function Y(w,e,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Bc(w,c)}function K(){console.error("THREE.CanvasRenderer has been removed")}function me(){console.error("THREE.JSONLoader has been removed.")}Fa.create=function(w,e){return console.log("THREE.Curve.create() has been deprecated"),w.prototype=Object.create(Fa.prototype),w.prototype.constructor=w,w.prototype.getPoint=e,w},ja.prototype.fromPoints=function(w){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(w)},t_.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},zf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Yn.prototype.extractUrlBase=function(w){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),vf.extractUrlBase(w)},Yn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},mh.prototype.center=function(w){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(w)},mh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},mh.prototype.isIntersectionBox=function(w){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},mh.prototype.size=function(w){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(w)},Ui.prototype.center=function(w){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(w)},Ui.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ui.prototype.isIntersectionBox=function(w){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},Ui.prototype.isIntersectionSphere=function(w){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(w)},Ui.prototype.size=function(w){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(w)},bo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Fr.prototype.setFromMatrix=function(w){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(w)},Qm.prototype.center=function(w){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(w)},lt.prototype.flattenToArrayOffset=function(w,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(w,e)},lt.prototype.multiplyVector3=function(w){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),w.applyMatrix3(this)},lt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},lt.prototype.applyToBufferAttribute=function(w){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),w.applyMatrix3(this)},lt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},lt.prototype.getInverse=function(w){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(w).invert()},tn.prototype.extractPosition=function(w){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(w)},tn.prototype.flattenToArrayOffset=function(w,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(w,e)},tn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ht).setFromMatrixColumn(this,3)},tn.prototype.setRotationFromQuaternion=function(w){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(w)},tn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},tn.prototype.multiplyVector3=function(w){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.multiplyVector4=function(w){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},tn.prototype.rotateAxis=function(w){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),w.transformDirection(this)},tn.prototype.crossVector=function(w){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},tn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},tn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},tn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},tn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},tn.prototype.applyToBufferAttribute=function(w){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),w.applyMatrix4(this)},tn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},tn.prototype.makeFrustum=function(w,e,c,d,_,S){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(w,e,d,c,_,S)},tn.prototype.getInverse=function(w){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(w).invert()},Ra.prototype.isIntersectionLine=function(w){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(w)},$i.prototype.multiplyVector3=function(w){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),w.applyQuaternion(this)},$i.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},fn.prototype.isIntersectionBox=function(w){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(w)},fn.prototype.isIntersectionPlane=function(w){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(w)},fn.prototype.isIntersectionSphere=function(w){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(w)},Ki.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Ki.prototype.barycoordFromPoint=function(w,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(w,e)},Ki.prototype.midpoint=function(w){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(w)},Ki.prototypenormal=function(w){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(w)},Ki.prototype.plane=function(w){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(w)},Ki.barycoordFromPoint=function(w,e,c,d,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ki.getBarycoord(w,e,c,d,_)},Ki.normal=function(w,e,c,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ki.getNormal(w,e,c,d)},Ga.prototype.extractAllPoints=function(w){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(w)},Ga.prototype.extrude=function(w){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ua(this,w)},Ga.prototype.makeGeometry=function(w){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new h(this,w)},zn.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},zn.prototype.distanceToManhattan=function(w){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(w)},zn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ht.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},ht.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},ht.prototype.getPositionFromMatrix=function(w){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(w)},ht.prototype.getScaleFromMatrix=function(w){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(w)},ht.prototype.getColumnFromMatrix=function(w,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,w)},ht.prototype.applyProjection=function(w){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(w)},ht.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},ht.prototype.distanceToManhattan=function(w){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(w)},ht.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Di.prototype.fromAttribute=function(w,e,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(w,e,c)},Di.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Pr.prototype.getChildByName=function(w){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(w)},Pr.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Pr.prototype.translate=function(w,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,w)},Pr.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Pr.prototype.applyMatrix=function(w){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(w)},Object.defineProperties(Pr.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(w){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=w}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ro.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ro.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Vh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),zl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Po.prototype.setLens=function(w,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(w)},Object.defineProperties(Hl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(w){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=w}},shadowCameraLeft:{set:function(w){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=w}},shadowCameraRight:{set:function(w){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=w}},shadowCameraTop:{set:function(w){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=w}},shadowCameraBottom:{set:function(w){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=w}},shadowCameraNear:{set:function(w){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=w}},shadowCameraFar:{set:function(w){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=w}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(w){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=w}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(w){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=w}},shadowMapHeight:{set:function(w){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=w}}}),Object.defineProperties(Pi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Br},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Br)}}}),Pi.prototype.setDynamic=function(w){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===w?Br:bi),this},Pi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Pi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},br.prototype.addIndex=function(w){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(w)},br.prototype.addAttribute=function(w,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===w?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(w,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(w,new Pi(arguments[1],arguments[2])))},br.prototype.addDrawCall=function(w,e,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(w,e)},br.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},br.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},br.prototype.removeAttribute=function(w){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(w)},br.prototype.applyMatrix=function(w){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(w)},Object.defineProperties(br.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Oc.prototype.setDynamic=function(w){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===w?Br:bi),this},Oc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ua.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ua.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ua.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Us.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Ad.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties($s.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Kn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(w){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=w===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(w){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=w}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Rs.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(w){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=w}}}),Yi.prototype.clearTarget=function(w,e,c,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(w),this.clear(e,c,d)},Yi.prototype.animate=function(w){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(w)},Yi.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Yi.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Yi.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Yi.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Yi.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Yi.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Yi.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Yi.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Yi.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Yi.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Yi.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Yi.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Yi.prototype.enableScissorTest=function(w){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(w)},Yi.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Yi.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Yi.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Yi.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Yi.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Yi.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Yi.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Yi.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Yi.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Yi.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Yi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(w){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=w}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(w){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=w}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(w){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===w?hl:Ji}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(om.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ro.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(w){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=w}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(w){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=w}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(w){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=w}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(w){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=w}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(w){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=w}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(w){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=w}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(w){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=w}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(w){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=w}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(w){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=w}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(w){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=w}}}),Ff.prototype.load=function(w){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new Wm).load(w,function(c){e.setBuffer(c)}),this},_m.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},gl.prototype.updateCubeMap=function(w,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(w,e)},gl.prototype.clear=function(w,e,c,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(w,e,c,d)},Ms.crossOrigin=void 0,Ms.loadTexture=function(w,e,c,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const _=new Vs;_.setCrossOrigin(this.crossOrigin);const S=_.load(w,c,void 0,d);return e&&(S.mapping=e),S},Ms.loadTextureCube=function(w,e,c,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const _=new Uo;_.setCrossOrigin(this.crossOrigin);const S=_.load(w,c,void 0,d);return e&&(S.mapping=e),S},Ms.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ms.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const ge={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Se(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=x)},980:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var process={release:{name:""}},__BRYTHON__=__BRYTHON__||{};try{eval("async function* f(){}")}catch(n){console.warn("Your browser is not fully supported. If you are using Microsoft Edge, please upgrade to the latest version")}(function(n){var o;n.isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,n.isNode=void 0!==process&&"node"===process.release.name;var l,x=(o=n.isNode?{location:{href:"",origin:"",pathname:""},navigator:{userLanguage:""}}:self).location.href;if(n.protocol=x.split(":")[0],n.BigInt=o.BigInt,void 0===n.brython_path){var B;if(n.isWebWorker)(B=o.location.href).startsWith("blob:")&&(B=B.substr(5));else{var D=document.getElementsByTagName("script");B=D[D.length-1].src}var G=B.split("/");G.pop(),l=n.brython_path=G.join("/")+"/"}else n.brython_path.endsWith("/")||(n.brython_path+="/"),l=n.brython_path;var M=(o.location.origin+o.location.pathname).split("/");M.pop();var P=n.script_dir=M.join("/");if(n.__ARGV=[],n.webworkers={},n.$py_module_path={},n.file_cache={},n.$py_src={},n.path=[l+"Lib",l+"libs",P,l+"Lib/site-packages"],n.async_enabled=!1,n.async_enabled&&(n.block={}),n.imported={},n.precompiled={},n.frames_stack=[],n.builtins={},n.builtins_scope={id:"__builtins__",module:"__builtins__",binding:{}},n.builtin_funcs={},n.builtin_classes=[],n.__getattr__=function(de){return this[de]},n.__setattr__=function(de,ye){if(!(["debug","stdout","stderr"].indexOf(de)>-1))throw n.builtins.AttributeError.$factory("__BRYTHON__ object has no attribute "+de);n[de]=ye},n.language=o.navigator.userLanguage||o.navigator.language,n.locale="C",n.charset=n.isWebWorker?"utf-8":document.characterSet||document.inputEncoding||"utf-8",n.max_int=Math.pow(2,53)-1,n.min_int=-n.max_int,n.$py_next_hash=Math.pow(2,53)-1,n.$py_UUID=0,n.lambda_magic=Math.random().toString(36).substr(2,8),n.set_func_names=function(de,ye){if(de.$infos){var ie=de.$infos.__name__;de.$infos.__module__=ye,de.$infos.__qualname__=ie}else de.$infos={__name__:ie=de.__name__,__module__:ye,__qualname__:ie};for(var ce in de.__module__=ye,de)"function"==typeof de[ce]&&(de[ce].$infos={__doc__:de[ce].__doc__||"",__module__:ye,__qualname__:ie+"."+ce,__name__:ce},"classmethod"==de[ce].$type&&(de[ce].__class__=n.method))},typeof Storage<"u"){n.has_local_storage=!1;try{localStorage&&(n.local_storage=localStorage,n.has_local_storage=!0)}catch{}n.has_session_storage=!1;try{sessionStorage&&(n.session_storage=sessionStorage,n.has_session_storage=!0)}catch{}}else n.has_local_storage=!1,n.has_session_storage=!1;n.globals=function(){return n.frames_stack[n.frames_stack.length-1][3]},n.scripts={},n.$options={},n.update_VFS=function(de){n.VFS=n.VFS||{};var ye=de.$timestamp;for(var ie in void 0!==ye&&delete de.$timestamp,de)n.VFS.hasOwnProperty(ie)&&console.warn("Virtual File System: duplicate entry "+ie),n.VFS[ie]=de[ie],n.VFS[ie].timestamp=ye},n.add_files=function(de){for(var ye in n.files=n.files||{},de)n.files[ye]=de[ye]},n.python_to_js=function(de,ye){return n.meta_path=n.$meta_path.slice(),n.use_VFS||n.meta_path.shift(),void 0===ye&&(ye="__main__"),"(function() {\n var $locals_"+ye+" = {}\n"+__BRYTHON__.py2js(de,ye,ye).to_js()+"\n}())"},o.py=function(de){var ye=n.py2js(de[0],"script","script").to_js();n.set_import_paths(),new Function("$locals_script",ye)({})}})(__BRYTHON__),__BRYTHON__.implementation=[3,8,10,"final",0],__BRYTHON__.__MAGIC__="3.8.10",__BRYTHON__.version_info=[3,8,0,"final",0],__BRYTHON__.compiled_date="2020-10-06 14:56:18.181563",__BRYTHON__.timestamp=1601988978181,__BRYTHON__.builtin_module_names=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","array","builtins","dis","hashlib","long_int","marshal","math","math1","modulefinder","posix","random","unicodedata"],function($B){var js,$pos,res,$op;Number.isInteger=Number.isInteger||function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n},Number.isSafeInteger=Number.isSafeInteger||function(n){return Number.isInteger(n)&&Math.abs(n)<=Number.MAX_SAFE_INTEGER};var _b_=$B.builtins,_window;_window=$B.isNode?{location:{href:"",origin:"",pathname:""}}:self,$B.parser={};var clone=$B.clone=function(n){var o={};for(var l in n)o[l]=n[l];return o};$B.last=function(n){return void 0===n&&console.log($B.frames_stack.slice()),n[n.length-1]},$B.list2obj=function(n,o){var l={},x=n.length;for(void 0===o&&(o=!0);x-- >0;)l[n[x]]=o;return l},$B.op2method={operations:{"**":"pow","//":"floordiv","<<":"lshift",">>":"rshift","+":"add","-":"sub","*":"mul","/":"truediv","%":"mod","@":"matmul"},augmented_assigns:{"//=":"ifloordiv",">>=":"irshift","<<=":"ilshift","**=":"ipow","+=":"iadd","-=":"isub","*=":"imul","/=":"itruediv","%=":"imod","&=":"iand","|=":"ior","^=":"ixor","@=":"imatmul"},binary:{"&":"and","|":"or","~":"invert","^":"xor"},comparisons:{"<":"lt",">":"gt","<=":"le",">=":"ge","==":"eq","!=":"ne"},boolean:{or:"or",and:"and",in:"in",not:"not",is:"is",not_in:"not_in",is_not:"is_not"},subset:function(){var n={},o=[];if("all"==arguments[0])(o=Object.keys($B.op2method)).splice(o.indexOf("subset"),1);else for(var l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);for(l=0,x=o.length;l<x;l++){var B=o[l],D=$B.op2method[B];if(void 0===D)throw Error(B);for(var G in D)n[G]=D[G]}return n}};var $operators=$B.op2method.subset("all"),$augmented_assigns=$B.augmented_assigns=$B.op2method.augmented_assigns,noassign=$B.list2obj(["True","False","None","__debug__"]),$op_order=[["or"],["and"],["not"],["in","not_in"],["<","<=",">",">=","!=","==","is","is_not"],["|"],["^"],["&"],[">>","<<"],["+"],["-"],["*","@","/","//","%"],["unary_neg","unary_inv","unary_pos"],["**"]],$op_weight={},$weight=1;$op_order.forEach(function(n){n.forEach(function(o){$op_weight[o]=$weight}),$weight++});var $loop_num=0,create_temp_name=$B.parser.create_temp_name=function(n){return(n||"$temp")+$loop_num++},replace_node=$B.parser.replace_node=function(n,o){var l=n.parent,x=get_rank_in_parent(n);l.children[x]=o,o.parent=l,o.bindings=n.bindings},get_rank_in_parent=$B.parser.get_rank_in_parent=function(n){return n.parent.children.indexOf(n)},add_identnode=$B.parser.add_identnode=function(n,o,l,x){var B=new $Node;B.parent=n,B.locals=n.locals,B.module=n.module;var D=new $NodeCtx(B),G=new $ExprCtx(D,"id",!0),M=(new $IdCtx(G,l),new $AssignCtx(G));return-1===o?n.add(B):n.insert(o,B),M.tree[1]=x,B},chained_comp_num=0,$_SyntaxError=$B.parser.$_SyntaxError=function(n,o,l){for(var x=n;"node"!==x.type;)x=x.parent;for(var B=x.node,D=B;void 0!==D.parent;)D=D.parent;var G=B.module,M=D.src,P=B.line_num;if(M&&(P=M.substr(0,$pos).split("\n").length),D.line_info&&(P=D.line_info),void 0!==l&&"number"==typeof l)throw $B.$IndentationError(G,o,M,$pos,P,D);Array.isArray(o)&&$B.$SyntaxError(G,o[0],M,$pos,P,D),"Triple string end not found"===o&&$B.$SyntaxError(G,"invalid syntax : triple string end not found",M,$pos,P,D);var de="invalid syntax";o.startsWith("token ")||(de+=" ("+o+")"),$B.$SyntaxError(G,de,M,$pos,P,D)};function SyntaxWarning(n,o){var l=$get_node(n),x=$get_module(n),B=x.src.split("\n"),D=`Module ${x.module}line ${l.line_num}:${o}\n    `+B[l.line_num-1];$B.$getattr($B.stderr,"write")(D)}function check_assignment(n){for(var o=n,l=["assert","del","import","raise","return"];o;)l.indexOf(o.type)>-1?$_SyntaxError(n,"invalid syntax - assign"):"expr"==o.type&&"op"==o.tree[0].type&&$_SyntaxError(n,void 0!==$B.op2method.comparisons[o.tree[0].op]?["cannot assign to comparison"]:["cannot assign to operator"]),o=o.parent}var $Node=$B.parser.$Node=function(n){this.type=n,this.children=[]};$Node.prototype.add=function(n){this.children[this.children.length]=n,n.parent=this,n.module=this.module},$Node.prototype.insert=function(n,o){this.children.splice(n,0,o),o.parent=this,o.module=this.module},$Node.prototype.toString=function(){return"<object 'Node'>"},$Node.prototype.show=function(n){var o="";return"module"===this.type?(this.children.forEach(function(l){o+=l.show(n)}),o):(o+=" ".repeat(n=n||0),o+=this.C,this.children.length>0&&(o+="{"),o+="\n",this.children.forEach(function(l){o+="["+i+"] "+l.show(n+4)}),this.children.length>0&&(o+=" ".repeat(n),o+="}\n"),o)},$Node.prototype.to_js=function(n){if(void 0!==this.js)return this.js;if(this.res=[],this.unbound=[],"module"===this.type)return this.children.forEach(function(l){this.res.push(l.to_js())},this),this.js=this.res.join(""),this.js;n=n||0;var o=this.C.to_js();return o&&(this.res.push(" ".repeat(n)),this.res.push(o),this.children.length>0&&this.res.push("{"),this.res.push("\n"),this.children.forEach(function(l){this.res.push(l.to_js(n+4))},this),this.children.length>0&&(this.res.push(" ".repeat(n)),this.res.push("}\n"))),this.js=this.res.join(""),this.js},$Node.prototype.transform=function(n){if(this.has_await)return this.parent.insert(n,$NodeJS("var save_stack = $B.save_stack()")),this.parent.insert(n+2,$NodeJS("$B.restore_stack(save_stack, $locals)")),this.has_await=!1,1;if(this.has_yield&&!this.has_yield.transformed){var o=this.parent;if(this.has_yield.from){var l=new $Node,x=new $NodeCtx(l),B=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(B,`var _i${this.has_yield.from_num}`),G=new $AssignCtx(B);new $ExprCtx(G).tree=this.has_yield.tree,o.insert(n,l),$get_node(this.has_yield);var M=this.has_yield.from_num;return o.insert(n+1,$NodeJS(`$B.$import("sys",[],{})\n_i${M}=_b_.iter(_i${M})\nvar $failed${M}=false\ntry{var _y${M}=_b_.next(_i${M})}catch(_e){$B.set_exc(_e)\n$failed${M}=true\n$B.pmframe=$B.last($B.frames_stack)\n_e=$B.exception(_e)\nif(_e.__class__===_b_.StopIteration){var _r${M}=$B.$getattr(_e,"value")}else{throw _e}}\nif(! $failed${M}){while(true){var $failed1${M}=false\ntry{$B.leave_frame({$locals})\nvar _s${M}=yield _y${M}\n$B.frames_stack.push($top_frame)}catch(_e){if(_e.__class__===_b_.GeneratorExit){var $failed2${M}=false\ntry{var _m${M}=$B.$geatttr(_i${M},"close")}catch(_e1){$failed2${M}=true\nif(_e1.__class__ !==_b_.AttributeError){throw _e1}}\nif(! $failed2${M}){$B.$call(_m${M})()}\nthrow _e}else if($B.is_exc(_e,[_b_.BaseException])){var _x=$B.$call($B.$getattr($locals.sys,"exc_info"))()\nvar $failed3${M}=false\ntry{var _m${M}=$B.$getattr(_i${M},"throw")}catch(err){$failed3${M}=true\nif($B.is_exc(err,[_b_.AttributeError])){throw err}}\nif(! $failed3${M}){try{_y${M}=$B.$call(_m${M}).apply(null,_b_.list.$factory(_x${M}))}catch(err){if($B.$is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}\nif(! $failed1${M}){try{if(_s${M}===_b_.None){_y${M}=_b_.next(_i${M})}else{_y${M}=$B.$call($B.$getattr(_i${M},"send"))(_s${M})}}catch(err){if($B.is_exc(err,[_b_.StopIteration])){_r${M}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}`)),3}o.children.splice(n,1),"abstract_expr"===this.has_yield.tree[0].type?l=$NodeJS("var result = _b_.None"):(l=new $Node,x=new $NodeCtx(l),B=new $ExprCtx(x,"js",!1),D=new $RawJSCtx(B,"var result"),(G=new $AssignCtx(B)).tree[1]=this.has_yield.tree[0],D.parent=G),l.line_num=this.line_num,o.insert(n,l);var de=new $NodeJS("try");de.add($NodeJS("$B.leave_frame({$locals})")),de.add(this),o.insert(n+1,de),this.has_yield.to_js=function(){return"yield result"},this.has_yield.transformed=!0;for(var ye=0;ye<de.children.length;)void 0===(ae=de.children[ye].transform(ye))&&(ae=1),ye+=ae;var ie=$NodeJS(`catch(err${this.line_num})`);return ie.add($NodeJS("$B.frames_stack.push($top_frame)")),ie.add($NodeJS(`throw err${this.line_num}`)),o.insert(n+2,ie),o.insert(n+3,$NodeJS("$B.frames_stack.push($top_frame)")),2}if("module"!==this.type){var ce,fe=this.C.tree[0];for(void 0===fe&&console.log(this),void 0!==fe.transform&&(ce=fe.transform(this,n)),ye=0;ye<this.children.length;)void 0===(ae=this.children[ye].transform(ye))&&(ae=1),ye+=ae;return void 0===ce&&(ce=1),ce}for(this.__doc__=$get_docstring(this),ye=0;ye<this.children.length;){var ae;void 0===(ae=this.children[ye].transform(ye))&&(ae=1),ye+=ae}},$Node.prototype.clone=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];return n},$Node.prototype.clone_tree=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];n.children=[];for(var l=0,x=this.children.length;l<x;l++)n.add(this.children[l].clone_tree());return n};var $AbstractExprCtx=$B.parser.$AbstractExprCtx=function(n,o){this.type="abstract_expr",this.with_commas=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AbstractExprCtx.prototype.toString=function(){return"(abstract_expr "+this.with_commas+") "+this.tree},$AbstractExprCtx.prototype.transition=function(n,o){var l=this,x=l.packed,B=l.is_await,D=l.assign;if(!D)switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":case"yield":l.parent.tree.pop();var G=l.with_commas;(l=l.parent).packed=x,l.is_await=B,D&&(console.log("set assign to parent",l),l.assign=D)}switch(n){case"await":return new $AwaitCtx(l);case"id":return new $IdCtx(new $ExprCtx(l,"id",G),o);case"str":return new $StringCtx(new $ExprCtx(l,"str",G),o);case"bytes":return new $StringCtx(new $ExprCtx(l,"bytes",G),o);case"int":return new $NumberCtx("int",new $ExprCtx(l,"int",G),o);case"float":return new $NumberCtx("float",new $ExprCtx(l,"float",G),o);case"imaginary":return new $NumberCtx("imaginary",new $ExprCtx(l,"imaginary",G),o);case"(":return new $ListOrTupleCtx(new $ExprCtx(l,"tuple",G),"tuple");case"[":return new $ListOrTupleCtx(new $ExprCtx(l,"list",G),"list");case"{":return new $DictOrSetCtx(new $ExprCtx(l,"dict_or_set",G));case".":return new $EllipsisCtx(new $ExprCtx(l,"ellipsis",G));case"not":return"op"==l.type&&"is"==l.op?(l.op="is_not",l):new $NotCtx(new $ExprCtx(l,"not",G));case"lambda":return new $LambdaCtx(new $ExprCtx(l,"lambda",G));case"op":var M=o;switch(M){case"*":return l.parent.tree.pop(),G=l.with_commas,new $PackedCtx(new $ExprCtx(l=l.parent,"expr",G));case"-":case"~":case"+":l.parent.tree.pop();var P=new $UnaryCtx(l.parent,M);if("-"==M)var de=new $OpCtx(P,"unary_neg");else de=new $OpCtx(P,"+"==M?"unary_pos":"unary_inv");return new $AbstractExprCtx(de,!1);case"not":return l.parent.tree.pop(),G=l.with_commas,new $NotCtx(new $ExprCtx(l=l.parent,"not",G))}$_SyntaxError(l,"token "+n+" after "+l);case"=":$_SyntaxError(l,"token "+n+" after "+l);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case":":return"sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type?new $AbstractExprCtx(new $SliceCtx(l.parent),!1):$transition(l.parent,n,o);case")":case",":switch(l.parent.type){case"list_or_tuple":case"slice":case"call_arg":case"op":case"yield":break;case"annotation":$_SyntaxError(l,"empty annotation");default:$_SyntaxError(l,n)}}return $transition(l.parent,n,o)},$AbstractExprCtx.prototype.to_js=function(){return this.js_processed=!0,"list"===this.type?"["+$to_js(this.tree)+"]":$to_js(this.tree)};var $AliasCtx=$B.parser.$AliasCtx=function(n){this.type="ctx_manager_alias",this.parent=n,this.tree=[],n.tree[n.tree.length-1].alias=this};$AliasCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":case":":return l.parent.set_alias(l.tree[0].tree[0]),$transition(l.parent,n,o)}$_SyntaxError(l,"token "+n+" after "+l)};var $AnnotationCtx=$B.parser.$AnnotationCtx=function(n){this.type="annotation",this.parent=n,this.tree=[],n.annotation=this;var o=$get_scope(n);if(void 0===o.binding.__annotations__&&(o.binding.__annotations__=!0,n.create_annotations=!0),"def"==o.ntype&&n.tree&&n.tree.length>0&&"id"==n.tree[0].type){var l=n.tree[0].value;o.globals&&o.globals.has(l)>-1&&$_SyntaxError(n,["annotated name '"+l+"' can't be global"]),o.annotations=o.annotations||new Set,o.annotations.add(l),n.$in_parens||(o.binding=o.binding||{},o.binding[l]=!0)}};$AnnotationCtx.prototype.toString=function(){return"(annotation) "+this.tree},$AnnotationCtx.prototype.transition=function(n,o){var l=this;return"eol"==n&&1==l.tree.length&&0==l.tree[0].tree.length?$_SyntaxError(l,"empty annotation"):":"==n&&"def"!=l.parent.type?$_SyntaxError(l,"more than one annotation"):"augm_assign"==n?$_SyntaxError(l,"augmented assign as annotation"):"op"==n&&$_SyntaxError(l,"operator as annotation"),$transition(l.parent,n)},$AnnotationCtx.prototype.to_js=function(){return $to_js(this.tree)};var $AssertCtx=$B.parser.$AssertCtx=function(n){this.type="assert",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AssertCtx.prototype.toString=function(){return"(assert) "+this.tree},$AssertCtx.prototype.transition=function(n,o){var l=this;return","==n?(this.tree.length>1&&$_SyntaxError(l,"too many commas after assert"),new $AbstractExprCtx(this,!1)):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,n)},$AssertCtx.prototype.transform=function(n,o){if(this.tree.length>1)var l=this.tree[0],x=this.tree[1];else l=this.tree[0],x=null;"expr"==this.tree[0].type&&"tuple"==this.tree[0].name&&this.tree[0].tree[0].tree.length>1&&SyntaxWarning(this,"assertion is always true, perhaps remove parentheses?");var B=new $ConditionCtx(n.C,"if");new $NotCtx(B).tree=[l],n.C=B;var D=new $Node,G="throw _b_.AssertionError.$factory()";null!==x&&(G="throw _b_.AssertionError.$factory(_b_.str.$factory("+x.to_js()+"))"),new $NodeJSCtx(D,G),n.add(D)};var $AssignCtx=$B.parser.$AssignCtx=function(n,o){check_assignment(n),"expr"==n.type&&"lambda"==n.tree[0].type&&$_SyntaxError(n,["cannot assign to lambda"]),this.type="assign","expression"==o&&(this.expression=!0,console.log("parent of assign expr",n.parent)),n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.parent=n.parent,this.tree=[n];var l=$get_scope(this);if("expr"==n.type&&"call"==n.tree[0].type)$_SyntaxError(n,["cannot assign to function call "]);else if("list_or_tuple"==n.type||"expr"==n.type&&"list_or_tuple"==n.tree[0].type)"expr"==n.type&&(n=n.tree[0]),n.bind_ids(l);else if("assign"==n.type)n.tree.forEach(function(D){var G=D.tree[0];"id"==G.type&&$bind(G.value,l,this)},this);else{var x=n.tree[0];if(x&&"id"==x.type)if(!0===noassign[x.value]&&$_SyntaxError(n,["cannot assign to keyword"]),x.bound=!0,l.globals&&l.globals.has(x.value)){var B=$get_module(n);x.global_module=B.module,$bind(x.value,B,this)}else $get_node(this).bound_before=Object.keys(l.binding),$bind(x.value,l,this);else["str","int","float","complex"].indexOf(x.type)>-1?$_SyntaxError(n,["cannot assign to literal"]):"unary"==x.type&&$_SyntaxError(n,["cannot assign to operator"])}};$AssignCtx.prototype.guess_type=function(){},$AssignCtx.prototype.toString=function(){return"(assign) "+this.tree[0]+"="+this.tree[1]},$AssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),l.guess_type(),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AssignCtx.prototype.transform=function(n,o){for(var l=$get_scope(this),x=this.tree[0],B=this.tree[1],D=[];"assign"==x.type;)D.push(x.tree[1]),x=x.tree[0];if(D.length>0){D.push(x);var G=n.C;G.tree=[];var M=new $RawJSCtx(G,"var $temp"+$loop_num);return M.tree=G.tree,new $AssignCtx(M).tree[1]=B,D.forEach(function(Re){"expr"==Re.type&&"list_or_tuple"==Re.tree[0].type&&"tuple"==Re.tree[0].real&&1==Re.tree[0].tree.length&&(Re=Re.tree[0].tree[0]);var Q=new $Node,be=new $NodeCtx(Q);Q.locals=n.locals,Q.line_num=n.line_num,n.parent.insert(o+1,Q),Re.parent=be;var Pe=new $AssignCtx(Re);new $RawJSCtx(Pe,"$temp"+$loop_num)}),$loop_num++,void(this.tree[0]=x)}var P=null;switch(x.type){case"expr":x.tree.length>1?P=x.tree:"list_or_tuple"==x.tree[0].type||"target_list"==x.tree[0].type?P=x.tree[0].tree:"id"==x.tree[0].type&&(l.globals&&l.globals.has(x.tree[0].value)||(x.tree[0].bound=!0));break;case"target_list":case"list_or_tuple":P=x.tree}if(B=this.tree[1],null!==P){var ye=null;if(("list"==B.type||"tuple"==B.type||"expr"==B.type&&B.tree.length>1)&&(ye=B.tree),null!==ye){if(ye.length>P.length)throw Error("ValueError : too many values to unpack (expected "+P.length+")");if(ye.length<P.length)throw Error("ValueError : need more than "+ye.length+" to unpack");var ie=[],ce=0;(Z=new $Node).line_num=n.line_num,new $NodeJSCtx(Z,"void(0)"),ie[ce++]=Z;var fe="$temp"+$loop_num;(Z=new $Node).line_num=n.line_num,new $NodeJSCtx(Z,"var "+fe+" = [], $pos = 0"),ie[ce++]=Z,ye.forEach(function(Re){var Q=fe+"[$pos++] = "+Re.to_js(),be=new $Node;be.line_num=n.line_num,new $NodeJSCtx(be,Q),ie[ce++]=be});var ae=$get_node(this);P.forEach(function(Re){var Q=new $Node;Q.id=ae.module,Q.locals=ae.locals,Q.line_num=n.line_num;var be=new $NodeCtx(Q);Re.parent=be,new $AssignCtx(Re,!1).tree[1]=new $JSCode(fe+"["+W+"]"),ie[ce++]=Q},this),n.parent.children.splice(o,1);for(var W=ie.length-1;W>=0;W--)n.parent.insert(o,ie[W]);$loop_num++}else{n.parent.children.splice(o,1);var Z,A=create_temp_name("$right"),R=create_temp_name("$rlist");(Z=$NodeJS("var "+A+" = $B.$getattr($B.$iter("+B.to_js()+'), "__next__");')).line_num=n.line_num,n.parent.insert(o++,Z),n.parent.insert(o++,$NodeJS("var "+R+"=[], $pos=0;while(1){try{"+R+"[$pos++] = "+A+"()}catch(err){break}}"));var X=null,he=P.length;for(W=0;W<P.length;W++){var U=P[W];if("packed"==U.type||"expr"==U.type&&"packed"==U.tree[0].type){X=W,he--;break}}n.parent.insert(o++,$NodeJS("if("+R+".length<"+he+'){throw _b_.ValueError.$factory("need more than " +'+R+'.length + " value" + ('+R+'.length > 1 ? "s" : "") + " to unpack")}')),null==X&&n.parent.insert(o++,$NodeJS("if("+R+".length>"+he+'){throw _b_.ValueError.$factory("too many values to unpack (expected '+P.length+')")}')),P.forEach(function(Re,Q){var be=new $Node;be.id=l.id,be.line_num=n.line_num,n.parent.insert(o++,be);var Pe=new $NodeCtx(be);Re.parent=Pe;var Ge=new $AssignCtx(Re,!1),Ae=R;Ge.tree[1]=new $JSCode(Ae+=null==X||Q<X?"["+Q+"]":Q==X?".slice("+Q+","+R+".length-"+(P.length-Q-1)+")":"["+R+".length-"+(P.length-Q)+"]")}),$loop_num++}}else x.tree[0].bound&&"expr"==B.type&&"int"==B.name&&(n.bindings=n.bindings||{},n.bindings[x.tree[0].value]="int")},$AssignCtx.prototype.to_js=function(){if(this.js_processed=!0,"call"==this.parent.type)return'{$nat:"kw",name:'+this.tree[0].to_js()+",value:"+this.tree[1].to_js()+"}";for(var n=this.tree[0];"expr"==n.type&&!n.assign;)n=n.tree[0];var o=this.tree[1];if("attribute"==n.type||"sub"==n.type){var l=o.to_js(),x="",B="",D="$temp"+$loop_num;if("expr"!=o.type||void 0===o.tree[0]||"call"!=o.tree[0].type||"eval"!=o.tree[0].func.value&&"exec"!=o.tree[0].func.value?"expr"==o.type&&void 0!==o.tree[0]&&"sub"==o.tree[0].type?(x+="var "+D+" = "+l+";\n",B=D):B=l:(x+="var "+D+" = "+l+";\n",B=D),"attribute"==n.type){$loop_num++,n.func="setattr";var G=n.to_js();return n.func="getattr",n.assign_self?x+G[0]+B+G[1]+B+")":(x=(x+=G).substr(0,x.length-1))+","+B+");_b_.None;"}if("sub"==n.type){var M,P=n.value.to_js(),de="$temp"+$loop_num;return"id"==n.value.type&&(M=$get_node(this).locals[n.value.value]),$loop_num++,x="var "+de+" = "+P+"\n","list"!==M&&(x+="if(Array.isArray("+de+") && !"+de+".__class__){"),1==n.tree.length?x+="$B.set_list_key("+de+","+(n.tree[0].to_js()+""||"null")+","+o.to_js()+")":2==n.tree.length?x+="$B.set_list_slice("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+o.to_js()+")":3==n.tree.length&&(x+="$B.set_list_slice_step("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+(n.tree[2].to_js()+""||"null")+","+o.to_js()+")"),"list"==M||(x+="\n}else{",1==n.tree.length?x+="$B.$setitem("+n.value.to_js()+","+n.tree[0].to_js()+","+l+")};_b_.None;":(n.func="setitem",x=(x+=n.to_js()).substr(0,x.length-1),n.func="getitem",x+=","+l+")};_b_.None;")),x}}return n.to_js()+" = "+o.to_js()};var $AsyncCtx=$B.parser.$AsyncCtx=function(n){this.type="async",this.parent=n,n.async=!0};$AsyncCtx.prototype.toString=function(){return"(async)"},$AsyncCtx.prototype.transition=function(n,o){var l=this;if("def"==n)return $transition(l.parent,n,o);if("for"==n||"with"==n){var x=$get_scope(l).ntype;"def"!==x&&"generator"!=x&&$_SyntaxError(l,["'async "+n+"' outside async function"]);var B=$transition(l.parent,n,o);return B.parent.async=!0,B}$_SyntaxError(l,"token "+n+" after "+l)};var $AttrCtx=$B.parser.$AttrCtx=function(n){this.type="attribute",this.value=n.tree[0],this.parent=n,n.tree.pop(),n.tree[n.tree.length]=this,this.tree=[],this.func="getattr"};$AttrCtx.prototype.toString=function(){return"(attr) "+this.value+"."+this.name},$AttrCtx.prototype.transition=function(n,o){var l=this;if("id"===n){var x=o;return!0===noassign[x]&&$_SyntaxError(l,["cannot assign to "+x]),x=$mangle(x,l),l.name=x,l.parent}$_SyntaxError(l,n)},$AttrCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.value.to_js();if("setattr"==this.func&&"id"==this.value.type){var o=$get_scope(this),l=o.parent;if("def"==o.ntype&&"class"==l.ntype&&this.value.value==o.C.tree[0].positional_list[0]&&l.C&&void 0===l.C.tree[0].args)return this.assign_self=!0,[n+".__class__ && "+n+".__dict__ && !"+n+".__class__.$has_setattr && ! "+n+".$is_class ? _b_.dict.$setitem("+n+".__dict__, '"+this.name+"', ",") : $B.$setattr("+n+', "'+this.name+'", ']}return"setattr"==this.func?"$B.$setattr("+n+',"'+this.name+'")':"$B.$getattr("+n+',"'+this.name+'")'};var $AugmentedAssignCtx=$B.parser.$AugmentedAssignCtx=function(n,o){check_assignment(n),this.type="augm_assign",this.C=n,this.parent=n.parent,n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.op=o,this.tree=[n];var l=this.scope=$get_scope(this);if("expr"==n.type){var x=n.tree[0];if("id"==x.type){var B=x.value;!0===noassign[B]?$_SyntaxError(n,["cannot assign to keyword"]):"def"!=l.ntype&&"generator"!=l.ntype||void 0!==l.binding[B]||void 0!==l.globals&&l.globals.has(B)||(x.unbound=!0)}else["str","int","float","complex"].indexOf(x.type)>-1&&$_SyntaxError(n,["cannot assign to literal"])}$get_node(this).bound_before=Object.keys(l.binding),this.module=l.module};$AugmentedAssignCtx.prototype.toString=function(){return"(augm assign) "+this.tree},$AugmentedAssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AugmentedAssignCtx.prototype.transform=function(n,o){var l=this.C,x=this.op,B="__"+$operators[x]+"__",D=0,G=n.parent,M=n.line_num,P=!1;G.children.splice(o,1);var de="expr"==this.tree[0].type&&"id"==this.tree[0].tree[0].type;if(de){var ye="int"==this.tree[0].tree[0].bindingType(this.scope);if(this.tree[0].tree[0].augm_assign=!0,$B.debug>0){var ie=$NodeJS("if("+this.tree[0].to_js()+" === undefined){throw _b_.NameError.$factory(\"name '"+this.tree[0].tree[0].value+"' is not defined\")}");n.parent.insert(o,ie),D++}var ce=this.tree[0].tree[0].value,fe=void 0!==this.scope.binding[ce],ae=this.tree[0].tree[0].unbound}var W="expr"==this.tree[1].type&&"int"==this.tree[1].tree[0].type;if(W){var Z=this.tree[1].tree[0].value,A=parseInt(Z[1],Z[0]);W=A>$B.min_int&&A<$B.max_int}var R=W?this.tree[1].tree[0].to_js():"$temp";if(!W){(Ae=new $Node).line_num=M,P=!0,new $NodeJSCtx(Ae,"var $temp,$left;"),G.insert(o,Ae),D++,(Ae=new $Node).id=this.scope.id;var X=new $NodeCtx(Ae),he=new $ExprCtx(X,"js",!1),U=new $RawJSCtx(he,"$temp"),Re=new $AssignCtx(he);Re.tree[1]=this.tree[1],U.parent=Re,G.insert(o+D,Ae),D++}var Q="",be=!1;switch(x){case"+=":case"-=":case"*=":case"/=":if(de){var Pe=this.scope,Ge="$local_"+Pe.module.replace(/\./g,"_");switch(Pe.ntype){case"module":Q=Ge;break;case"def":case"generator":Q=Pe.globals&&Pe.globals.has(l.tree[0].value)?Ge:"$locals";break;case"class":var Ae=new $Node;P||(Ae.line_num=M,P=!0),new $NodeJSCtx(Ae,"var $left = "+l.to_js()),G.insert(o+D,Ae),be=!0,D++}}}var Xe=l.tree[0].to_js();if("id"==l.tree[0].type){var Ke=l.tree[0].firstBindingScopeId(),yt=l.tree[0].value;Xe=Ke?"$locals_"+Ke.replace(/\./g,"_")+'["'+yt+'"]':'$locals["'+yt+'"]'}if(ye&&W&&"//="!=x)return G.insert(o+D,$NodeJS(Xe+" "+x+" "+R)),D++;Q=Q&&!l.tree[0].unknown_binding&&!ae;var dt=x.charAt(0);if(Q){var It=be?"$left":Xe;Ae=new $Node,P||(Ae.line_num=M,P=!0),Gt=W?"if(":'if(typeof $temp.valueOf() == "number" && ',Gt+=It+".constructor === Number",Gt+=" && Number.isSafeInteger("+Xe+dt+R+")){"+(W?"(":'(typeof $temp == "number" && ')+"typeof "+It+' == "number") ? ',Gt+=Xe+x+R,new $NodeJSCtx(Ae,Gt+=" : "+Xe+" = new Number("+Xe+dt+(W?R:R+".valueOf()")+")}"),G.insert(o+D,Ae),D++}if("sub"==l.tree[0].type&&("+="==x||"-="==x||"*="==x)&&1==l.tree[0].tree.length){var wt="$B.augm_item_"+{"+=":"add","-=":"sub","*=":"mul"}[x]+"("+l.tree[0].value.to_js()+","+l.tree[0].tree[0].to_js()+","+R+");_b_.None;";return Ae=new $Node,P||(Ae.line_num=M,P=!0),new $NodeJSCtx(Ae,wt),G.insert(o+D,Ae),void D++}Ae=new $Node,P||(Ae.line_num=M,P=!0);var Gt="";Q&&(Gt+="else "),Gt+="if(! _b_.hasattr("+l.to_js()+',"'+B+'"))',new $NodeJSCtx(Ae,Gt),G.insert(o+D,Ae),D++;var Dt=new $Node;Dt.id=this.scope.id,Dt.line_num=n.line_num,Ae.add(Dt);var sn=new $NodeCtx(Dt),gt=new $ExprCtx(sn,"clone",!1);ae?new $RawJSCtx(gt,Xe):(gt.tree=l.tree,gt.tree.forEach(function(rr){rr.parent=gt}));var An=new $AssignCtx(gt),Bn=new $OpCtx(gt,x.substr(0,x.length-1));Bn.parent=An,new $RawJSCtx(Bn,R),An.tree.push(Bn),gt.parent.tree.pop(),gt.parent.tree.push(An);var dn=$NodeJS("else");G.insert(o+D,dn);var On=new $Node;On.line_num=n.line_num,dn.add(On);var Ln=new $NodeCtx(On),mn=new $ExprCtx(Ln,"clone",!1);ae?(Gt=Xe,Ke||(Gt='$B.$local_search("'+yt+'");'+Xe),new $RawJSCtx(mn,Gt)):(mn.tree=l.tree,mn.tree.forEach(function(rr){rr.parent=mn}));var cr=new $AssignCtx(mn);return cr.tree.push($NodeJS("$B.$getattr("+l.to_js()+',"'+B+'")('+R+")")),mn.parent.tree.pop(),mn.parent.tree.push(cr),!de||fe||this.scope.blurred||(this.scope.binding[ce]=void 0),D},$AugmentedAssignCtx.prototype.to_js=function(){return""};var $AwaitCtx=$B.parser.$AwaitCtx=function(n){this.type="await",this.parent=n,this.tree=[],n.tree.push(this);for(var o=n;o;)"list_or_tuple"==o.type&&(o.is_await=!0),o=o.parent};$AwaitCtx.prototype.transition=function(n,o){return this.parent.is_await=!0,$transition(this.parent,n,o)},$AwaitCtx.prototype.to_js=function(){return"var save_stack = $B.save_stack();await ($B.promise("+$to_js(this.tree)+"));$B.restore_stack(save_stack, $locals); "};var $BodyCtx=$B.parser.$BodyCtx=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node,x=new $Node;return x.is_body_node=!0,x.line_num=l.line_num,l.insert(0,x),new $NodeCtx(x)},set_loop_context=$B.parser.set_loop_context=function(n,o){for(var l=n;"node"!==l.type;)l=l.parent;for(var x=l.node.parent,B=!1;;)if("module"==x.type)$_SyntaxError(n,o+" outside of a loop");else{var D=x.C.tree[0];if("condition"==D.type&&"while"==D.token){this.loop_ctx=D,D["has_"+o]=!0;break}switch(D.type){case"for":this.loop_ctx=D,D["has_"+o]=!0,B=!0;break;case"def":case"generator":case"class":$_SyntaxError(n,o+" outside of a loop");default:x=x.parent}if(B)break}},$BreakCtx=$B.parser.$BreakCtx=function(n){this.type="break",this.parent=n,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"break"])};$BreakCtx.prototype.toString=function(){return"break "},$BreakCtx.prototype.transition=function(n,o){if("eol"==n)return $transition(this.parent,"eol");$_SyntaxError(this,n)},$BreakCtx.prototype.to_js=function(){return this.js_processed=!0,";$locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_ctx.loop_num+'"] = false'+("asyncfor"!=this.loop_ctx.type?";break":";throw _b_.StopIteration.$factory("+this.loop_ctx.loop_num+")")};var $CallArgCtx=$B.parser.$CallArgCtx=function(n){this.type="call_arg",this.parent=n,this.start=$pos,this.tree=[],n.tree.push(this),this.expect="id"};$CallArgCtx.prototype.toString=function(){return"call_arg "+this.tree},$CallArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":if("id"==l.expect){l.expect=",";var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o)}break;case"=":if(","==l.expect)return new $ExprCtx(new $KwArgCtx(l),"kw_value",!1);break;case"for":this.parent.tree.length>1&&$_SyntaxError(l,"non-parenthesized generator expression");var B=new $ListOrTupleCtx(l,"gen_expr");B.vars=l.vars,B.locals=l.locals,B.intervals=[l.start],l.tree.pop(),B.expression=l.tree,l.tree=[B],B.tree=[];var D=new $ComprehensionCtx(B);return new $TargetListCtx(new $CompForCtx(D));case"op":if("id"==l.expect){var G=o;switch(l.expect=",",G){case"+":case"-":case"~":return $transition(new $AbstractExprCtx(l,!1),n,G);case"*":return new $StarArgCtx(l);case"**":return new $DoubleStarArgCtx(l)}}$_SyntaxError(l,"token "+n+" after "+l);case")":if(l.parent.kwargs&&$B.last(l.parent.tree).tree[0]&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),l.tree.length>0){var M=l.tree[l.tree.length-1];"list_or_tuple"==M.type&&"gen_expr"==M.real&&M.intervals.push($pos)}return $transition(l.parent,n);case":":if(","==l.expect&&"lambda"==l.parent.parent.type)return $transition(l.parent.parent,n);break;case",":if(","==l.expect)return l.parent.kwargs&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),$transition(l.parent,n,o)}console.log("token ",n," after ",l),$_SyntaxError(l,"token "+n+" after "+l)},$CallArgCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CallCtx=$B.parser.$CallCtx=function(n){this.type="call",this.func=n.tree[0],void 0!==this.func&&(this.func.parent=this),this.parent=n,"class"!=n.type?(n.tree.pop(),n.tree[n.tree.length]=this):n.args=this,this.expect="id",this.tree=[],this.start=$pos,this.func&&"attribute"==this.func.type&&"wait"==this.func.name&&"id"==this.func.value.type&&"time"==this.func.value.value&&(console.log("call",this.func),$get_node(this).blocking={type:"wait",call:this}),this.func&&"input"==this.func.value&&($get_node(this).blocking={type:"input"})};$CallCtx.prototype.toString=function(){return"(call) "+this.func+"("+this.tree+")"},$CallCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":return"id"==l.expect&&$_SyntaxError(l,n),l.expect="id",l;case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case")":return l.end=$pos,l.parent;case"op":switch(l.expect=",",o){case"-":case"~":case"+":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case"*":return l.has_star=!0,new $StarArgCtx(l);case"**":return l.has_dstar=!0,new $DoubleStarArgCtx(l)}$_SyntaxError(l,n);case"yield":$_SyntaxError(l,n)}return $transition(l.parent,n,o)},$CallCtx.prototype.to_js=function(){this.js_processed=!0,this.tree.length>0&&0==this.tree[this.tree.length-1].tree.length&&this.tree.pop();var n=this.func.to_js();if(void 0!==this.func){if("classmethod"===this.func.value)return"_b_.classmethod.$factory("+$to_js(this.tree)+")";if("unary"==this.func.type){var o="$B.$getattr("+$to_js(this.tree);switch(this.func.op){case"+":return o+',"__pos__")()';case"-":return o+',"__neg__")()';case"~":return o+',"__invert__")()'}}var l,x=[],B=[],D=!1,G=[];if(this.tree.forEach(function(fe){switch(fe.type){case"star_arg":D=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(fe.tree[0].tree[0].to_js());break;case"id":x.push([fe.to_js(),"s"]);break;default:switch(fe.tree[0].type){case"expr":case"list_or_tuple":case"op":default:x.push([fe.to_js(),"s"]);break;case"kwarg":B.push(fe.tree[0].tree[0].value+":"+fe.tree[0].tree[1].to_js());break;case"star_arg":D=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(fe.tree[0].tree[0].to_js())}}}),D){for(var M=[],P=0,de=x.length;P<de;P++)if(arg=x[P],"*"==arg[1])M.push("_b_.list.$factory("+arg[0]+")");else{var ye=[x[P][0]];for(P++;P<de&&"s"==x[P][1];)ye.push(x[P][0]),P++;P--,M.push("["+ye.join(",")+"]")}for(l=M[0],P=1;P<M.length;P++)l+=".concat("+M[P]+")"}else{for(P=0,de=x.length;P<de;P++)x[P]=x[P][0];l=x.join(", ")}var ie="{"+B.join(", ")+"}";ie=G.length?'{$nat:"kw",kw:['+ie+","+G.join(", ")+"]}":"{}"!=ie?'{$nat:"kw",kw:'+ie+"}":"",D&&ie?l+=".concat(["+ie+"])":l&&ie?l+=","+ie:l||(l=ie);var ce="$B.$call("+n+")"+(l=D?".apply(null,"+l+")":"("+l+")");return this.tree.length>-1&&"id"==this.func.type&&this.func.is_builtin&&void 0!==$B.builtin_funcs[this.func.value]?-1==["complex","bytes","bytearray","object","memoryview","int","float","str","list","tuple","dict","set","frozenset","range","slice","zip","bool","type","classmethod","staticmethod","enumerate","reversed","property","$$super","zip","map","filter"].indexOf(this.func.value)?n+l:n+".$factory"+l:ce}};var $ClassCtx=$B.parser.$ClassCtx=function(n){this.type="class",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id";var o=this.scope=$get_scope(this);this.parent.node.parent_block=o,this.parent.node.bound={},this.parent.node.binding={__annotations__:!0}};$ClassCtx.prototype.toString=function(){return"(class) "+this.name+" "+this.tree+" args "+this.args},$ClassCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.set_name(o),l.expect="(:",l;break;case"(":return new $CallCtx(l);case":":return $BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ClassCtx.prototype.set_name=function(n){var o=this.parent;this.random=$B.UUID(),this.name=n,this.id=o.node.module+"_"+n+"_"+this.random,this.binding={},this.parent.node.id=this.id;for(var l=this.scope,x=l,B=l,D=[];"class"==B.ntype;)D.splice(0,0,B.C.tree[0].name),B=B.parent;for(this.qualname=D.concat([n]).join(".");x.C&&"class"==x.C.tree[0].type;)x=x.parent;for(;x.C&&"def"!=x.C.tree[0].type&&"generator"!=x.C.tree[0].type;)x=x.parent;this.parent.node.parent_block=x,$bind(n,l,this),l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$ClassCtx.prototype.transform=function(n,o){this.doc_string=$get_docstring(n),this.module=$get_module(this).module.replace(/\./g,"_");var l="\n"+" ".repeat(n.indent+12),x=new $Node,B="$locals_"+this.id.replace(/\./g,"_");new $NodeJSCtx(x,M="var "+B+" = {__annotations__: $B.empty_dict()}, "+l+"$locals = "+B),n.insert(0,x);for(var D=this.scope;"__builtins__"!==D.parent_block.id;)D=D.parent_block;var G="$locals_"+D.id.replace(/\./g,"_"),M=" ".repeat(n.indent+4)+'$locals.$name = "'+this.name+'"'+l+'$locals.$qualname = "'+this.qualname+'"'+l+"$locals.$is_class = true; "+l+'$locals.$line_info = "'+n.line_num+","+this.module+'";'+l+'var $top_frame = ["'+B+'", $locals,"'+D.id+'", '+G+"]"+l+"$locals.$f_trace = $B.enter_frame($top_frame);"+l+"if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_line()}";n.insert(1,$NodeJS(M)),n.add($NodeJS("if($locals.$f_trace !== _b_.None){$B.trace_return(_b_.None)}")),n.add($NodeJS("$B.leave_frame({$locals})"));var P=new $Node;new $NodeJSCtx(P,"return "+B+";"),n.insert(n.children.length,P);var de=new $Node;new $NodeJSCtx(de,")();"),n.parent.insert(o+1,de),o++,n.parent.insert(o+1,$NodeJS("$"+this.name+"_"+this.random+".__module__ = $locals_"+this.module+".__name__"));var ie=$get_scope(this),ce=";$locals_"+ie.id.replace(/\./g,"_"),fe=1;if((M=[(ce+='["'+this.name+'"]')+' = $B.$class_constructor("'+this.name])[fe++]='", $'+this.name+"_"+this.random,void 0!==this.args){var W=[],Z=[];this.args.tree.forEach(function(Q){"kwarg"==Q.tree[0].type?Z.push(Q.tree[0]):W.push(Q.to_js())}),M[fe++]=", _b_.tuple.$factory(["+W.join(",")+"]),[";var A=new RegExp('"',"g"),R=[],X=0;W.forEach(function(Q){R[X++]='"'+Q.replace(A,'\\"')+'"'}),M[fe++]=R.join(",")+"]",R=[],X=0,Z.forEach(function(Q){R[X++]='["'+Q.tree[0].value+'",'+Q.tree[1].to_js()+"]"}),M[fe++]=",["+R.join(",")+"]"}else M[fe++]=", _b_.tuple.$factory([]),[],[]";M[fe++]=")";var he=new $Node;new $NodeJSCtx(he,M.join("")),o++,n.parent.insert(o+1,he),o++;var U=new $Node;if(new $NodeJSCtx(U,M=ce+".__doc__ = "+(this.doc_string||"_b_.None")+";"),n.parent.insert(o+1,U),"module"==ie.ntype){var Re=new $Node;new $NodeJSCtx(Re,'$locals["'+this.name+'"] = '+this.name)}n.parent.insert(o+2,$NodeJS("_b_.None;")),this.transformed=!0},$ClassCtx.prototype.to_js=function(){return this.js_processed=!0,"var $"+this.name+"_"+this.random+" = (function()"};var $CompIfCtx=$B.parser.$CompIfCtx=function(n){this.type="comp_if",n.parent.intervals.push($pos),this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIfCtx.prototype.toString=function(){return"(comp if) "+this.tree},$CompIfCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIfCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ComprehensionCtx=$B.parser.$ComprehensionCtx=function(n){this.type="comprehension",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ComprehensionCtx.prototype.toString=function(){return"(comprehension) "+this.tree},$ComprehensionCtx.prototype.transition=function(n,o){var l=this;switch(n){case"if":return new $AbstractExprCtx(new $CompIfCtx(l),!1);case"for":return new $TargetListCtx(new $CompForCtx(l))}return $transition(l.parent,n,o)},$ComprehensionCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.tree.forEach(function(o){n.push(o.start)}),n};var $CompForCtx=$B.parser.$CompForCtx=function(n){this.type="comp_for",n.parent.intervals.push($pos),this.parent=n,this.tree=[],this.expect="in",n.tree[n.tree.length]=this};$CompForCtx.prototype.toString=function(){return"(comp for) "+this.tree},$CompForCtx.prototype.transition=function(n,o){var l=this;return"in"==n&&"in"==l.expect?(l.expect=null,new $AbstractExprCtx(new $CompIterableCtx(l),!0)):null===l.expect?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$CompForCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CompIterableCtx=$B.parser.$CompIterableCtx=function(n){this.type="comp_iterable",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIterableCtx.prototype.toString=function(){return"(comp iter) "+this.tree},$CompIterableCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIterableCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ConditionCtx=$B.parser.$ConditionCtx=function(n,o){this.type="condition",this.token=o,this.parent=n,this.tree=[],this.scope=$get_scope(this),"while"==o&&(this.loop_num=$loop_num++),n.tree[n.tree.length]=this};$ConditionCtx.prototype.toString=function(){return this.token+" "+this.tree},$ConditionCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return"abstract_expr"==l.tree[0].type&&0==l.tree[0].tree.length&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$ConditionCtx.prototype.transform=function(n,o){if($get_scope(this),"while"==this.token){n.parent.insert(o,$NodeJS('$locals["$no_break'+this.loop_num+'"] = true'));var l=$get_module(this).module;return"return"!=$B.last(n.children).C.tree[0].type&&n.add($NodeJS('$locals.$line_info = "'+n.line_num+","+l+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),2}},$ConditionCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.token;"elif"==n&&(n="else if");var o=[n+"($B.$bool("];if("while"==n)o.push('$locals["$no_break'+this.loop_num+'"] && ');else if("else if"==n){var l=$get_node(this).line_num+","+$get_scope(this).id;o.push('($B.set_line("'+l+'")) && ')}return 1==this.tree.length?o.push($to_js(this.tree)+"))"):(o.push(this.tree[0].to_js()+"))"),this.tree[1].tree.length>0&&o.push("{"+this.tree[1].to_js()+"}")),o.join("")};var $ContinueCtx=$B.parser.$ContinueCtx=function(n){this.type="continue",this.parent=n,$get_node(this).is_continue=!0,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"continue"])};$ContinueCtx.prototype.toString=function(){return"(continue)"},$ContinueCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$ContinueCtx.prototype.to_js=function(){this.js_processed=!0;var n="continue";return this.loop_ctx.has_break&&(n=`$locals["$no_break${this.loop_ctx.loop_num}"]=true;${n}`),n};var $DebuggerCtx=$B.parser.$DebuggerCtx=function(n){this.type="continue",this.parent=n,n.tree[n.tree.length]=this};$DebuggerCtx.prototype.toString=function(){return"(debugger)"},$DebuggerCtx.prototype.transition=function(n,o){},$DebuggerCtx.prototype.to_js=function(){return this.js_processed=!0,"debugger"};var $DecoratorCtx=$B.parser.$DecoratorCtx=function(n){this.type="decorator",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DecoratorCtx.prototype.toString=function(){return"(decorator) "+this.tree},$DecoratorCtx.prototype.transition=function(n,o){var l=this;return"id"==n&&0==l.tree.length?$transition(new $AbstractExprCtx(l,!1),n,o):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,"token "+n+" after "+l)},$DecoratorCtx.prototype.transform=function(n,o){for(var l=o+1,x=n.parent.children,B=[this.tree];;)if(l>=x.length)$_SyntaxError(C,["decorator expects function"]);else if("node_js"==x[l].C.type)l++;else{if("decorator"!=x[l].C.tree[0].type)break;B.push(x[l].C.tree[0].tree),x.splice(l,1)}this.dec_ids=[],B.forEach(function(){this.dec_ids.push("$id"+$B.UUID())},this);var D=x[l].C.tree[0];"def"==D.type&&(D.decorated=!0,D.alias="$dec"+$B.UUID());var G="",M=$get_scope(this),P='$locals["';M.globals&&M.globals.has(D.name)&&(P="$locals_"+$get_module(this).id+'["');var de=(P+=D.name+'"]')+" = ";B.forEach(function(ye,ie){de+="$B.$call("+this.dec_ids[ie]+")(",G+=")"},this),de+=(D.decorated?D.alias:P)+G+";",$bind(D.name,M,this),n.parent.insert(l+1,$NodeJS(de)),this.decorators=B},$DecoratorCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.decorators.forEach(function(o,l){n.push("var "+this.dec_ids[l]+" = "+$to_js(o)+";")},this),n.join("")};var $DefCtx=$B.parser.$DefCtx=function(n){this.type="def",this.name=null,this.parent=n,this.tree=[],this.async=n.async,this.locals=[],n.tree[n.tree.length]=this,this.enclosing=[];var o=this.scope=$get_scope(this);o.C&&"class"==o.C.tree[0].type&&(this.class_name=o.C.tree[0].name),n.node.binding={};for(var l=o;l.C&&"class"==l.C.tree[0].type;)l=l.parent;for(;l.C&&"def"!=l.C.tree[0].type;)l=l.parent;this.parent.node.parent_block=l;var x=l;for(this.is_comp=x.is_comp;x&&x.C;){if("def"==x.C.tree[0].type){this.inside_function=!0;break}x=x.parent_block}this.module=o.module,this.root=$get_module(this),this.num=$loop_num,$loop_num++,this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$DefCtx.prototype.set_name=function(n){try{n=$mangle(n,this.parent.tree[0])}catch(x){throw console.log(x),console.log("parent",this.parent),x}var o=new $IdCtx(this,n);this.name=n,this.id=this.scope.id+"_"+n,this.id=this.id.replace(/\./g,"_"),this.id+="_"+$B.UUID(),this.parent.node.id=this.id,this.parent.node.module=this.module,this.binding={};var l=this.scope;void 0!==l.globals&&l.globals.has(n)?$bind(n,this.root,this):$bind(n,l,this),o.bound=!0,l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$DefCtx.prototype.toString=function(){return"def "+this.name+"("+this.tree+")"},$DefCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.name&&$_SyntaxError(l,"token "+n+" after "+l),l.set_name(o),l;case"(":return null==l.name&&$_SyntaxError(l,"missing name in function definition"),l.has_args=!0,new $FuncArgs(l);case"annotation":return new $AbstractExprCtx(new $AnnotationCtx(l),!0);case":":if(l.has_args)return $BodyCtx(l);$_SyntaxError(l,"missing function parameters");case"eol":l.has_args&&$_SyntaxError(l,"missing colon")}$_SyntaxError(l,"token "+n+" after "+l)},$DefCtx.prototype.transform=function(n,o){if(this.is_comp&&($get_node(this).is_comp=!0),void 0===this.transformed){var l=this.scope;this.doc_string=$get_docstring(n),this.rank=o;var x=n.indent+12;if(this.name.substr(0,15)=="lambda_"+$B.lambda_magic){var B=l.parent_block;B.C&&"def"==B.C.tree[0].type&&this.enclosing.push(B)}for(var D=this.parent.node;D.parent&&D.parent.is_def_func;)this.enclosing.push(D.parent.parent),D=D.parent.parent;var G=[],M=[],P=!1;this.argcount=0,this.kwonlyargcount=0,this.kwonlyargsdefaults=[],this.otherdefaults=[],this.varnames={},this.args=[],this.__defaults__=[],this.slots=[];var de=[],ye=[],ie=[];this.annotation&&ie.push('"return":'+this.annotation.to_js()),this.func_name=this.tree[0].to_js();var ce=this.func_name;this.decorated&&(this.func_name="var "+this.alias,ce=this.alias),this.tree[1].tree.forEach(function(or){if("end_positional"==or.type?(this.args.push("/"),de.push('"/"'),P=!0):(this.args.push(or.name),this.varnames[or.name]=!0),"func_arg_id"==or.type?(this.star_arg?(this.kwonlyargcount++,or.has_default&&this.kwonlyargsdefaults.push(or.name)):(this.argcount++,or.has_default&&this.otherdefaults.push(or.name)),this.slots.push(or.name+":null"),de.push('"'+or.name+'"'),ye.push(or.name+":"+or.name),or.tree.length>0&&(G.push('"'+or.name+'"'),M.push(or.name+":"+$to_js(or.tree)),this.__defaults__.push($to_js(or.tree)))):"func_star_arg"==or.type&&("*"==or.op?this.star_arg=or.name:"**"==or.op&&(this.kw_arg=or.name)),or.annotation){var ni=$mangle(or.name,this);ie.push(ni+": "+or.annotation.to_js())}},this),ye="{"+ye.join(", ")+"}";var fe=67;this.star_arg&&(fe|=4),this.kw_arg&&(fe|=8),"generator"==this.type&&(fe|=32),this.async&&(fe|=128);for(var ae=[],W=l;W.parent_block&&"__builtins__"!==W.parent_block.id;)W=W.parent_block;var Z="$locals_"+W.id.replace(/\./g,"_"),A=this.name+this.num,R="$locals_"+this.id;U="var "+R+" = {},"+(gt="\n"+" ".repeat(x))+"$locals = "+R+";",(Re=new $Node).locals_def=!0,Re.func_node=n,new $NodeJSCtx(Re,U),ae.push(Re);var X=[$NodeJS('$locals.$line_info = "'+n.line_num+","+this.module+'"'),$NodeJS(`var $top_frame=["${this.id}",$locals,"`+W.id+'", '+Z+", "+(this.is_comp?this.name:A)+"]"),$NodeJS("$locals.$f_trace = $B.enter_frame($top_frame)"),$NodeJS("var $stack_length = $B.frames_stack.length;")];"generator"==this.type&&X.push($NodeJS("$locals.$is_generator = true")),this.async&&X.splice(1,0,$NodeJS(`$locals.$async="${this.id}"`)),X.forEach(function(or){or.enter_frame=!0}),this.is_comp&&ae.push($NodeJS("var $defaults = {}")),this.env=[];var he=[],U=R+' = $locals = $B.args("'+this.name+'", '+this.argcount+", {"+this.slots.join(", ")+"}, ["+de.join(", ")+"], arguments, $defaults, "+this.other_args+", "+this.other_kw+");",Re=new $Node;new $NodeJSCtx(Re,U),he.push(Re);var Q=!1;if(null!==this.other_args||null!==this.other_kw||0!=this.after_star.length||P)ae.push(he[0]),he.length>1&&ae.push(he[1]);else{Q=!0,ae.push($NodeJS("var $len = arguments.length;")),Re=new $Node,new $NodeJSCtx(Re,U="if($len > 0 && arguments[$len - 1].$nat !== undefined)"),ae.push(Re),he.forEach(function(or){Re.add(or)});var be=new $Node;new $NodeJSCtx(be,"else"),ae.push(be);var Pe=this.slots.length,Ge=$NodeJS("if($len == "+Pe+")");be.add(Ge),Ge.add($NodeJS(R+" = $locals = "+ye)),be.add($NodeJS("else if($len > "+Pe+'){$B.wrong_nb_args("'+this.name+'", $len, '+Pe+", ["+de+"])}")),Pe>0&&(be.add($NodeJS("else if($len + Object.keys($defaults).length < "+Pe+'){$B.wrong_nb_args("'+this.name+'", $len, '+Pe+", ["+de+"])}")),subelse_node=$NodeJS("else"),be.add(subelse_node),subelse_node.add($NodeJS(R+" = $locals = "+ye)),subelse_node.add($NodeJS("var defparams = ["+de+"]")),subelse_node.add($NodeJS("for(var i = $len; i < defparams.length; i++){$locals[defparams[i]] = $defaults[defparams[i]]}")))}ae=ae.concat(X),"class"==l.ntype&&(class_ref="$locals_"+l.parent_block.id.replace(/\./g,"_")+"."+l.C.tree[0].qualname,this.parent.node.binding.__class__=!0,ae.push($NodeJS("$locals.__class__ = "+class_ref))),ae.push($NodeJS("$B.js_this = this;"));for(var Ae=ae.length-1;Ae>=0;Ae--)n.children.splice(0,0,ae[Ae]);var Xe=new $Node;this.params="",Q&&(this.params=Object.keys(this.varnames).join(", ")),new $NodeJSCtx(Xe,""),Xe.is_def_func=!0,Xe.module=this.module;var Ke=n.children[n.children.length-1];x=Ke.indent,"return"!=Ke.C.tree[0].type&&(U="if($locals.$f_trace !== _b_.None){\n"+"    ".repeat(x)+"$B.trace_return(_b_.None)\n"+"    ".repeat(x)+"}\n"+"    ".repeat(x),U+="$B.leave_frame","$exec"==this.id.substr(0,5)&&(U+="_exec"),n.add($NodeJS(U+="({$locals});return _b_.None")));var yt=[];if(this.parent.node.referenced)for(var dt in this.parent.node.referenced)this.parent.node.binding[dt]||yt.push('"'+dt+'"');n.add(Xe);var It=1;if(x=n.indent,!this.is_comp){n.parent.insert(o+It++,$NodeJS(A+".$is_func = true")),this.$has_yield_in_cm&&n.parent.insert(o+It++,$NodeJS(A+".$has_yield_in_cm = true")),n.parent.insert(o+It++,$NodeJS(A+".$infos = {"));var wt=this.name;"$$"==this.name.substr(0,2)&&(wt=wt.substr(2)),wt.substr(0,15)=="lambda_"+$B.lambda_magic&&(wt="<lambda>"),n.parent.insert(o+It++,$NodeJS(U='    __name__:"'+wt+'",'));var Gt=wt;if(this.class_name&&(Gt=this.class_name+"."+wt),n.parent.insert(o+It++,$NodeJS(U='    __qualname__:"'+Gt+'",')),this.otherdefaults.length>0){var Dt=[];this.otherdefaults.forEach(function(or){Dt.push("$defaults."+or)}),n.parent.insert(o+It++,$NodeJS("    __defaults__ : $B.fast_tuple(["+Dt.join(", ")+"]),"))}else n.parent.insert(o+It++,$NodeJS("    __defaults__ : _b_.None,"));this.kwonlyargsdefaults.lengh>0?(Dt=[],this.kwonlyargsdefaults.forEach(function(or){Dt.push("$defaults."+or)}),n.parent.insert(o+It++,$NodeJS("    __kwdefaults__ : $B.fast_tuple(["+Dt.join(", ")+"]),"))):n.parent.insert(o+It++,$NodeJS("    __kwdefaults__ : _b_.None,")),n.parent.insert(o+It++,$NodeJS("    __annotations__: {"+ie.join(",")+"},")),n.parent.insert(o+It++,$NodeJS("    __dict__: $B.empty_dict(),")),n.parent.insert(o+It++,$NodeJS("    __doc__: "+(this.doc_string||"_b_.None")+","));var sn=$get_module(this);for(var dt in n.parent.insert(o+It++,$NodeJS('    __module__ : "'+sn.module+'",')),this.binding)this.varnames[dt]=!0;var gt,An=[];for(var dt in this.varnames)An.push('"'+$B.from_alias(dt)+'"');U="    __code__:{"+(gt="\n"+" ".repeat(x+8))+"    co_argcount:"+this.argcount;var Bn=","+gt+" ".repeat(4);U+=Bn+"co_filename:$locals_"+$get_module(this).module.replace(/\./g,"_")+'["__file__"] || "<string>"'+Bn+"co_firstlineno:"+n.line_num+Bn+"co_flags:"+fe+Bn+"co_freevars: ["+yt+"]"+Bn+"co_kwonlyargcount:"+this.kwonlyargcount+Bn+'co_name: "'+this.name+'"'+Bn+"co_nlocals: "+An.length+Bn+"co_posonlyargcount: "+(this.pos_only||0)+Bn+"co_varnames: $B.fast_tuple(["+An.join(", ")+"])"+gt+"}\n"+" ".repeat(x+4)+"};",n.parent.insert(o+It++,$NodeJS(U+="_b_.None;"))}if(this.default_str="{"+M.join(", ")+"}",!this.is_comp){var dn=A;"generator"==this.type&&(dn=`$B.generator.$factory(${A})`);var On="return "+dn;this.async&&(On="generator"==this.type?`return $B.async_generator.$factory(${A})`:"return $B.make_async("+dn+")"),n.parent.insert(o+It++,$NodeJS(On+"}")),n.parent.insert(o+It++,$NodeJS(this.func_name+" = "+this.name+"$"+this.num+"("+this.default_str+")")),n.parent.insert(o+It++,$NodeJS(ce+".$set_defaults = function(value){return "+ce+" = "+this.name+"$"+this.num+"(value)}")),this.$has_yield_in_cm&&n.parent.insert(o+It++,$NodeJS(`${ce}.$has_yield_in_cm=true`))}for(var Ln=n,mn=0;mn<Ln.children.length&&Ln.children[mn]!==$B.last(X);mn++);var cr=$NodeJS("try"),rr=Ln.children.slice(mn+1);Ln.insert(mn+1,cr),rr.forEach(function(or){or.is_def_func?or.children.forEach(function(ni){cr.add(ni)}):cr.add(or)}),Ln.children.splice(mn+2,Ln.children.length);var ur=$NodeJS("catch(err)");return ur.add($NodeJS("$B.set_exc(err)")),ur.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),ur.add($NodeJS("$B.leave_frame({$locals});throw err")),Ln.add(ur),this.transformed=!0,It}},$DefCtx.prototype.to_js=function(n){return this.js_processed=!0,this.is_comp?"var "+this.name+" = "+(this.async?" async ":"")+"function* (expr)":(n=n||this.tree[0].to_js(),this.decorated&&(n="var "+this.alias),"var "+this.name+"$"+this.num+" = function($defaults){"+(this.async?"async ":"")+"function"+("generator"==this.type?"* ":" ")+this.name+this.num+"("+this.params+")")};var $DelCtx=$B.parser.$DelCtx=function(n){this.type="del",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DelCtx.prototype.toString=function(){return"del "+this.tree},$DelCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return $transition(l.parent,n);$_SyntaxError(l,"token "+n+" after "+l)},$DelCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent;if("list_or_tuple"==this.tree[0].type){var o=[];return this.tree[0].tree.forEach(function(D){var G=new $DelCtx(n);G.tree=[D],o.push(G.to_js()),n.tree.pop()}),this.tree=[],o.join(";")}if("expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type)return this.tree[0]=this.tree[0].tree[0],this.to_js();var l=this.tree[0].tree[0];switch(l.type){case"id":var x=$get_scope(this),B=!1;if(("def"==x.ntype||"generator"==x.ntype)&&x.globals&&x.globals.has(l.value)){for(x=x.parent;x.parent&&"__builtins__"!==x.parent.id;)x=x.parent;B=!0}return o='$B.$delete("'+l.value+'"'+(B?', "global"':"")+");",delete x.binding[l.value],o;case"list_or_tuple":return o=[],l.tree.forEach(function(D){o.push("delete "+D.to_js())}),o.join(";");case"sub":return l.func="delitem",js=l.to_js(),l.func="getitem",js;case"op":$_SyntaxError(this,["cannot delete operator"]);case"call":$_SyntaxError(this,["cannot delete function call"]);case"attribute":return"_b_.delattr("+l.value.to_js()+',"'+l.name+'")';default:$_SyntaxError(this,["cannot delete "+l.type])}};var $DictOrSetCtx=$B.parser.$DictOrSetCtx=function(n){this.type="dict_or_set",this.real="dict_or_set",this.expect="id",this.closed=!1,this.start=$pos,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DictOrSetCtx.prototype.toString=function(){switch(this.real){case"dict":return"(dict) {"+this.items+"}";case"set":return"(set) {"+this.tree+"}"}return"(dict_or_set) {"+this.tree+"}"},$DictOrSetCtx.prototype.transition=function(n,o){var l=this;if(l.closed){switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return new $CallArgCtx(new $CallCtx(l.parent))}return $transition(l.parent,n,o)}if(","==l.expect){switch(n){case"}":switch(l.real){case"dict_or_set":if(1!=l.tree.length)break;l.real="set";case"set":case"set_comp":case"dict_comp":return l.items=l.tree,l.tree=[],l.closed=!0,l;case"dict":if(l.nb_dict_items()%2==0)return l.items=l.tree,l.tree=[],l.closed=!0,l}$_SyntaxError(l,"token "+n+" after "+l);case",":return"dict_or_set"==l.real&&(l.real="set"),"dict"==l.real&&l.nb_dict_items()%2&&$_SyntaxError(l,"token "+n+" after "+l),l.expect="id",l;case":":if("dict_or_set"==l.real&&(l.real="dict"),"dict"==l.real)return l.expect=",",new $AbstractExprCtx(l,!1);$_SyntaxError(l,"token "+n+" after "+l);case"for":l.real="dict_or_set"==l.real?"set_comp":"dict_comp";var x=new $ListOrTupleCtx(l,"dict_or_set_comp");x.intervals=[l.start+1],x.vars=l.vars,l.tree.pop(),x.expression=l.tree,l.yields&&(x.expression.yields=l.yields,delete l.yields),l.tree=[x],x.tree=[];var B=new $ComprehensionCtx(x);return new $TargetListCtx(new $CompForCtx(B))}$_SyntaxError(l,"token "+n+" after "+l)}else if("id"==l.expect){switch(n){case"}":return 0==l.tree.length?(l.items=[],l.real="dict"):l.items=l.tree,l.tree=[],l.closed=!0,l;case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":l.expect=",";var D=new $AbstractExprCtx(l,!1);return $transition(D,n,o);case"op":switch(o){case"*":case"**":return l.expect=",",(D=new $AbstractExprCtx(l,!1)).packed=o.length,"dict_or_set"==l.real?l.real="*"==o?"set":"dict":("set"==l.real&&"**"==o||"dict"==l.real&&"*"==o)&&$_SyntaxError(l,"token "+n+" after "+l),D;case"+":return l;case"-":case"~":l.expect=",";var G=new $UnaryCtx(l,o);if("-"==o)var M=new $OpCtx(G,"unary_neg");else M=new $OpCtx(G,"+"==o?"unary_pos":"unary_inv");return new $AbstractExprCtx(M,!1)}$_SyntaxError(l,"token "+n+" after "+l)}$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$DictOrSetCtx.prototype.nb_dict_items=function(){var n=0;return this.tree.forEach(function(o){o.packed?n+=2:n++}),n},$DictOrSetCtx.prototype.packed_indices=function(){var n=[];return this.items.forEach(function(o,l){"expr"==o.type&&o.packed&&n.push(l)}),n},$DictOrSetCtx.prototype.unpack_dict=function(n){for(var o,l,x,B="",D=0;D<this.items.length;)l=0==D,"expr"==(x=this.items[D]).type&&x.packed?(o="_b_.list.$factory(_b_.dict.items("+x.to_js()+"))",D++):(o="[["+x.to_js()+","+this.items[D+1].to_js()+"]]",D+=2),l||(o=".concat("+o+")"),B+=o;return B},$DictOrSetCtx.prototype.unpack_set=function(n){var o,l="";return this.items.forEach(function(x,B){o=n.indexOf(B)>-1?"_b_.list.$factory("+x.to_js()+")":"["+x.to_js()+"]",B>0&&(o=".concat("+o+")"),l+=o}),l},$DictOrSetCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.real){case"dict":if((l=this.packed_indices()).length>0)return"_b_.dict.$factory("+this.unpack_dict(l)+")"+$to_js(this.tree);for(var n=[],o=0;o<this.items.length;o+=2)n.push("["+this.items[o].to_js()+","+this.items[o+1].to_js()+"]");return"_b_.dict.$factory(["+n.join(",")+"])"+$to_js(this.tree);case"set_comp":return"_b_.set.$factory("+$to_js(this.items)+")"+$to_js(this.tree);case"dict_comp":return"_b_.dict.$factory("+$to_js(this.items)+")"+$to_js(this.tree)}var l;return(l=this.packed_indices()).length>0?"_b_.set.$factory("+this.unpack_set(l)+")":"_b_.set.$factory(["+$to_js(this.items)+"])"+$to_js(this.tree)};var $DoubleStarArgCtx=$B.parser.$DoubleStarArgCtx=function(n){this.type="double_star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DoubleStarArgCtx.prototype.toString=function(){return"**"+this.tree},$DoubleStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return $transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$DoubleStarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"pdict",arg:'+$to_js(this.tree)+"}"};var $EllipsisCtx=$B.parser.$EllipsisCtx=function(n){this.type="ellipsis",this.parent=n,this.nbdots=1,this.start=$pos,n.tree[n.tree.length]=this};$EllipsisCtx.prototype.toString=function(){return"ellipsis"},$EllipsisCtx.prototype.transition=function(n,o){var l=this;return"."==n?(l.nbdots++,3==l.nbdots&&$pos-l.start==2&&(l.$complete=!0),l):l.$complete?$transition(l.parent,n,o):($pos--,void $_SyntaxError(l,"token "+n+" after "+l))},$EllipsisCtx.prototype.to_js=function(){return this.js_processed=!0,'$B.builtins["Ellipsis"]'};var $EndOfPositionalCtx=$B.parser.$EndOfConditionalCtx=function(n){this.type="end_positional",this.parent=n,n.has_end_positional=!0,n.parent.pos_only=n.tree.length,n.tree.push(this)};$EndOfPositionalCtx.prototype.transition=function(n,o){var l=this;if(","==n||")"==n)return $transition(l.parent,n,o);$_SyntaxError(l,"token "+n+" after "+l)},$EndOfPositionalCtx.prototype.to_js=function(){return"/"};var $ExceptCtx=$B.parser.$ExceptCtx=function(n){this.type="except",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="id",this.scope=$get_scope(this)};$ExceptCtx.prototype.toString=function(){return"(except) "},$ExceptCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);case"as":if("as"==l.expect&&void 0===l.has_alias)return l.expect="alias",l.has_alias=!0,l;case"id":if("alias"==l.expect)return l.expect=":",l.set_alias(o),l;break;case":":var x=l.expect;if("id"==x||"as"==x||":"==x)return $BodyCtx(l);break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;break;case")":if(","==l.expect||"as"==l.expect)return l.expect="as",l;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&("as"==l.expect||","==l.expect))return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$ExceptCtx.prototype.set_alias=function(n){this.tree[0].alias=$mangle(n,this),$bind(n,this.scope,this)},$ExceptCtx.prototype.transform=function(n,o){var l=$NodeJS("void(0)");l.line_num=n.line_num,n.insert(0,l);var x=$B.last(n.children);x.C.tree&&x.C.tree[0]&&"return"==x.C.tree[0].type||n.add($NodeJS("$B.del_exc()"))},$ExceptCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.tree.length){case 0:return"else";case 1:if("Exception"==this.tree[0].name)return"else if(1)"}var n=[];this.tree.forEach(function(x){n.push(x.to_js())});var o="";if($B.debug>0){var l=$get_module(this);o='($locals.$line_info = "'+$get_node(this).line_num+","+l.id+'") && '}return"else if("+o+"$B.is_exc("+this.error_name+",["+n.join(",")+"]))"};var $ExprCtx=$B.parser.$ExprCtx=function(n,o,l){if(this.type="expr",this.name=o,this.with_commas=l,this.expect=",",this.parent=n,n.packed&&(this.packed=n.packed),n.is_await){var x=$get_node(this);x.has_await=x.has_await||[],this.is_await=n.is_await,x.has_await.push(this)}n.assign&&(this.assign=n.assign),this.tree=[],n.tree[n.tree.length]=this};$ExprCtx.prototype.toString=function(){return"(expr "+this.with_commas+") "+this.tree},$ExprCtx.prototype.transition=function(n,o){var l=this;switch(n){case"bytes":case"float":case"id":case"imaginary":case"int":case"lambda":case"pass":case"str":$_SyntaxError(l,"token "+n+" after "+l);break;case"{":return"id"==l.tree[0].type&&-1!=["print","exec"].indexOf(l.tree[0].value)||$_SyntaxError(l,"token "+n+" after "+l),new $DictOrSetCtx(l);case"[":case"(":case".":case"not":if("expr"==l.expect)return l.expect=",",$transition(new $AbstractExprCtx(l,!1),n,o)}switch(n){case"not":if(","==l.expect)return new $ExprNot(l);break;case"in":if("target_list"==l.parent.type)return $transition(l.parent,n);if(","==l.expect)return $transition(l,"op","in");break;case",":if(","==l.expect&&(l.with_commas||["assign","return"].indexOf(l.parent.type)>-1)){$parent_match(l,{type:"yield",from:!0})&&$_SyntaxError(l,"no implicit tuple for yield from"),l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.has_comma=!0,x.tree=[l],l.parent=x,x}return $transition(l.parent,n);case".":return new $AttrCtx(l);case"[":return new $AbstractExprCtx(new $SubCtx(l),!0);case"(":return new $CallCtx(l);case"op":var B=l.parent,D=o;if("ternary"==B.type&&B.in_else){var G=new $OpCtx(l,D);return new $AbstractExprCtx(G,!1)}for(var M=l.parent,P=null;;)if("expr"==M.type)M=M.parent;else if("op"==M.type&&$op_weight[M.op]>=$op_weight[D]&&("**"!=M.op||"**"!=D))P=M,M=M.parent;else{if(!("not"==M.type&&$op_weight.not>$op_weight[D]))break;P=M,M=M.parent}if(null===P){for(;l.parent!==M;)B=(l=l.parent).parent;var de;return l.parent.tree.pop(),(de=new $ExprCtx(B,"operand",l.with_commas)).expect=",",l.parent=de,G=new $OpCtx(l,D),new $AbstractExprCtx(G,!1)}if("and"===D||"or"===D)for(;"not"==P.parent.type||"expr"==P.parent.type&&"not"==P.parent.parent.type;)B=(P=P.parent).parent;if("op"==P.type){var ye=!1;switch(P.op){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":ye=!0}if(ye)switch(D){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":var ie=P.tree[1],ce=ie.to_js(),fe=new Object;for(var ae in ie)fe[ae]=ie[ae];var W="$c"+chained_comp_num;for(ie.to_js=function(){return W},fe.to_js=function(){return W},chained_comp_num++;P.parent&&"op"==P.parent.type&&$op_weight[P.parent.op]<$op_weight[P.op];)P=P.parent;P.parent.tree.pop();var Z=new $OpCtx(P,"and");return Z.wrap={name:W,js:ce},fe.parent=Z,Z.tree.push("xxx"),G=new $OpCtx(fe,D),new $AbstractExprCtx(G,!1)}}return P.parent.tree.pop(),(de=new $ExprCtx(P.parent,"operand",!1)).tree=[M],P.parent=de,G=new $OpCtx(P,D),new $AbstractExprCtx(G,!1);case"augm_assign":for(var A=l.parent;A;)"assign"==A.type||"augm_assign"==A.type?$_SyntaxError(l,"augmented assignment inside assignment"):"op"==A.type&&$_SyntaxError(l,["cannot assign to operator"]),A=A.parent;return","==l.expect?new $AbstractExprCtx(new $AugmentedAssignCtx(l,o),!0):$transition(l.parent,n,o);case":":if("sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type)return new $AbstractExprCtx(new $SliceCtx(l.parent),!1);if("slice"==l.parent.type)return $transition(l.parent,n,o);if("node"==l.parent.type){if(1==l.tree.length){var R=l.tree[0];if(["id","sub","attribute"].indexOf(R.type)>-1)return new $AbstractExprCtx(new $AnnotationCtx(l),!1);if("tuple"==R.real&&","==R.expect&&1==R.tree.length)return new $AbstractExprCtx(new $AnnotationCtx(R.tree[0]),!1)}$_SyntaxError(l,"invalid target for annotation")}break;case"=":var X;if(","==l.expect){if("call_arg"==l.parent.type)return"id"!=l.tree[0].type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']),new $AbstractExprCtx(new $KwArgCtx(l),!0);if(X=function(Ke,yt){for(;Ke.parent;){if("annotation"==Ke.parent.type)return Ke.parent;Ke=Ke.parent}return!1}(l))return $transition(X,n,o);if("op"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("not"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("list_or_tuple"==l.parent.type)for(var he=0;he<l.parent.tree.length;he++){var U=l.parent.tree[he];"expr"==U.type&&"operand"==U.name&&$_SyntaxError(l,["cannot assign to operator"])}else l.tree.length>0&&l.tree[0].assign?$_SyntaxError(l,["cannot assign to named expression"]):"expr"==l.parent.type&&"target list"==l.parent.name?$_SyntaxError(l,"token "+n+" after "+l):"lambda"==l.parent.type&&"node"!=l.parent.parent.parent.type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']);for(;void 0!==l.parent;)"condition"==(l=l.parent).type?$_SyntaxError(l,"token "+n+" after "+l):"augm_assign"==l.type&&$_SyntaxError(l,"assignment inside augmented assignment");return new $AbstractExprCtx(new $AssignCtx(l=l.tree[0]),!0)}break;case":=":var Re=l.parent.type;if(["node","assign","kwarg","annotation"].indexOf(Re)>-1||"func_arg_id"==Re&&l.parent.tree.length>0?$_SyntaxError(l,":= invalid, parent "+Re):"call_arg"==Re&&"call"==l.parent.parent.type&&"lambda"==l.parent.parent.parent.type&&$_SyntaxError(l,":= invalid inside function arguments"),1==l.tree.length&&"id"==l.tree[0].type){for(var Q=$get_scope(l),be=l.tree[0].value;Q.is_comp;)Q=Q.parent_block;$bind(be,Q,l),(A=l.parent).tree.pop();var Pe=new $AbstractExprCtx(A,!1);return Pe.assign=l.tree[0],Pe}$_SyntaxError(l,"token "+n+" after "+l);case"if":for(var Ge=!1,Ae=l.parent;"list_or_tuple"!=Ae.type;){if("comp_for"==Ae.type||"comp_if"==Ae.type){Ge=!0;break}if("call_arg"==Ae.type||void 0===Ae.parent)break;Ae=Ae.parent}if(Ge)break;for(Ae=l;Ae.parent&&("op"==Ae.parent.type||"expr"==Ae.parent.type&&"operand"==Ae.parent.name);)Ae=Ae.parent;return new $AbstractExprCtx(new $TernaryCtx(Ae),!0);case"eol":if(2==l.tree.length&&"id"==l.tree[0].type&&["print","exec"].indexOf(l.tree[0].value)>-1&&$_SyntaxError(l,["Missing parentheses in call to '"+l.tree[0].value+"'."]),-1==["dict_or_set","list_or_tuple"].indexOf(l.parent.type)){var Xe=l.tree[0];("packed"==Xe.type||"call"==Xe.type&&"packed"==Xe.func.type)&&$_SyntaxError(l,["can't use starred expression here"])}}return $transition(l.parent,n)},$ExprCtx.prototype.to_js=function(n){var o;if(this.js_processed=!0,o="list"==this.type?"["+$to_js(this.tree)+"]":1==this.tree.length?this.tree[0].to_js(n):"_b_.tuple.$factory(["+$to_js(this.tree)+"])",this.is_await&&(o="await ($B.promise("+o+"))"),this.assign){for(var l=$get_scope(this);l.is_comp;)l=l.parent_block;if(l.globals&&l.globals.has(this.assign.value))for(;l.parent_block&&"__builtins__"!==l.parent_block.id;)l=l.parent_block;else l.nonlocals&&l.nonlocals[this.assign.value]&&(l=l.parent_block);o="($locals_"+l.id.replace(/\./g,"_")+'["'+this.assign.value+'"] = '+o+")"}return o};var $ExprNot=$B.parser.$ExprNot=function(n){this.type="expr_not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ExprNot.prototype.transition=function(n,o){var l=this;if("in"==n)return l.parent.tree.pop(),new $AbstractExprCtx(new $OpCtx(l.parent,"not_in"),!1);$_SyntaxError(l,"token "+n+" after "+l)},$ExprNot.prototype.toString=function(){return"(expr_not)"};var $ForExpr=$B.parser.$ForExpr=function(n){n.node.parent.is_comp&&(n.node.parent.first_for=this),this.type="for",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.loop_num=$loop_num,this.scope=$get_scope(this),this.module=this.scope.module,$loop_num++};$ForExpr.prototype.toString=function(){return"(for) "+this.tree},$ForExpr.prototype.transition=function(n,o){var l=this;switch(n){case"in":return 0==l.tree[0].tree.length&&$_SyntaxError(l,"missing target between 'for' and 'in'"),new $AbstractExprCtx(new $ExprCtx(l,"target list",!0),!1);case":":return(l.tree.length<2||"abstract_expr"==l.tree[1].tree[0].type)&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ForExpr.prototype.transform=function(n,o){for(var l=this.parent.node.parent;l;){if(l.is_comp){var x=$get_module(this);void 0===x.outermost_expr&&(l.outermost_expr=this.tree[1],x.outermost_expr=this.tree[1],this.tree.pop(),new $RawJSCtx(this,"expr"));break}l=l.parent}if(this.async)return this.transform_async(n,o);var B=$get_scope(this),D=this.tree[0],G=1==D.tree.length&&"id"==D.expect,M=this.tree[1],P=this.loop_num,de="$locals_"+B.id.replace(/\./g,"_"),ye="\n"+" ".repeat(n.indent+4),ie=!1;if(1==D.tree.length&&!B.blurred&&"id"!=D.expct&&"expr"==M.type&&"expr"==M.tree[0].type&&"call"==M.tree[0].tree[0].type){var ce=M.tree[0].tree[0];"id"==ce.func.type&&"range"==ce.func.value&&ce.tree.length<3&&ce.tree.length>0&&(ie=ce)}var fe=[],ae=0,W=n.children;if(ie){this.has_break&&(It=new $Node,new $NodeJSCtx(It,de+'["$no_break'+P+'"] = true'),fe[ae++]=It);for(var Z,A=$get_scope(this),R=[];A.binding.range&&R.push(A.id),A.parent_block;)A=A.parent_block;Z=1==R.length&&"__builtins__"==R[0];var X=new $Node;X.module=n.parent.module,new $NodeJSCtx(X,Z?"if(1)":"if("+ce.func.to_js()+" === _b_.range)"),fe[ae++]=X;var he=D.to_js(),U=!1;if(1==ie.tree.length){if("int"==(be=ie.tree[0].tree[0]).tree[0].type&&0<(be=parseInt(be.to_js()))<$B.max_int){U=!0;var Re="$i"+$B.UUID();(Ge=$NodeJS("for (var "+Re+" = 0; "+Re+" < "+be+"; "+Re+"++)")).add($NodeJS(he+" = "+Re))}var Q=0,be=ie.tree[0].to_js()}else Q=ie.tree[0].to_js(),be=ie.tree[1].to_js();if(!U){var Pe="var $stop_"+P+" = $B.int_or_bool("+be+"),"+ye+"        $next"+P+" = "+Q+","+ye+"        $safe"+P+" = typeof $next"+P+' == "number" && typeof $stop_'+P+' == "number";'+ye+"    while(true)",Ge=new $Node;new $NodeJSCtx(Ge,Pe),Ge.add($NodeJS("if($safe"+P+" && $next"+P+">= $stop_"+P+"){break}")),Ge.add($NodeJS("else if(!$safe"+P+" && $B.ge($next"+P+", $stop_"+P+")){break}")),Ge.add($NodeJS(he+" = $next"+P)),Ge.add($NodeJS("if($safe"+P+"){$next"+P+" += 1}")),Ge.add($NodeJS("else{$next"+P+" = $B.add($next"+P+",1)}"))}W.forEach(function(On){Ge.add(On.clone_tree())}),"return"!=$B.last(n.children).C.tree[0].type&&Ge.add($NodeJS(Pe='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;'));var Ae=!1;if("module"==B.ntype)for(l=n.parent;l;){if(l.for_wrapper){Ae=!0;break}l=l.parent}if("module"!=B.ntype||Ae)X.add(Ge);else{var Xe=new $Node;Xe.for_wrapper=!0,Pe="function $f"+P+"(",this.has_break&&(Pe+="$no_break"+P),new $NodeJSCtx(Xe,Pe+=")"),X.add(Xe),Xe.add(Ge),this.has_break&&Xe.add($NodeJS("return $no_break"+P)),X.add($NodeJS("var $res"+P+" = $f"+P+"();")),this.has_break&&X.add($NodeJS("var $no_break"+P+" = $res"+P))}if(Z){n.parent.children.splice(o,1);var Ke=0;return this.has_break&&(n.parent.insert(o,fe[0]),Ke++),fe[Ke].children.forEach(function(On){n.parent.insert(o+Ke,On)}),n.parent.children[o].line_num=n.line_num,n.parent.children[o].bindings=n.bindings,n.children=[],0}var yt=$NodeJS("else");fe[ae++]=yt;for(var dt=fe.length-1;dt>=0;dt--)n.parent.insert(o+1,fe[dt]);this.test_range=!0,fe=[],ae=0}var It=new $Node;It.line_num=$get_node(this).line_num;var wt=M.to_js(),Gt="$iter"+P;new $NodeJSCtx(It,Pe="var "+Gt+" = "+wt+';$locals["$next'+P+'"] = $B.$getattr($B.$iter('+Gt+'),"__next__")'),fe[ae++]=It,this.has_break&&(fe[ae++]=$NodeJS(de+'["$no_break'+P+'"] = true;'));var Dt=new $Node;if(new $NodeJSCtx(Dt,Pe=this.has_break?"while("+de+'["$no_break'+P+'"])':"while(true)"),Dt.C.loop_num=P,Dt.C.type="for",fe[ae++]=Dt,n.parent.children.splice(o,1),this.test_range)for(dt=fe.length-1;dt>=0;dt--)yt.insert(0,fe[dt]);else for(dt=fe.length-1;dt>=0;dt--)n.parent.insert(o,fe[dt]);var sn=$NodeJS("try");sn.bindings=n.bindings,Dt.add(sn);var gt=new $Node;gt.id=this.module;var An=new $NodeCtx(gt),Bn=new $ExprCtx(An,"left",!0);if(G){var dn=new $ListOrTupleCtx(Bn);dn.real="tuple",dn.tree=D.tree}else Bn.tree=D.tree;return new $AssignCtx(Bn).tree[1]=new $JSCode('$locals["$next'+P+'"]()'),sn.add(gt),Dt.add($NodeJS("catch($err){if($B.is_exc($err, [_b_.StopIteration])){break;}else{throw($err)}}")),W.forEach(function(On){Dt.add(On.clone())}),0==n.children.length&&console.log("bizarre",this),"return"!=$B.last(n.children).C.tree[0].type&&Dt.add($NodeJS(Pe='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),n.children=[],0},$ForExpr.prototype.transform_async=function(n,o){var l=$get_scope(this),x=this.tree[0],B=this.tree[1],D=this.loop_num,G=(l.id.replace(/\./g,"_")," ".repeat(n.indent+4),[]),M="$iter"+D,P="$type"+D,de="$running"+D,ye="$anext"+D,ie="var "+M+" = "+B.to_js();G.push($NodeJS(ie)),G.push($NodeJS("var "+P+" = _b_.type.$factory( "+M+")")),G.push($NodeJS(ie=M+" = $B.$call($B.$getattr("+P+', "__aiter__"))('+M+")")),G.push($NodeJS("var "+de+" = true")),G.push($NodeJS("var "+ye+" = $B.$call($B.$getattr("+P+', "__anext__"))'));var ce=$NodeJS("while("+de+")");G.push(ce);var fe=$NodeJS("try");if(ce.add(fe),1==x.tree.length)ie=x.to_js()+" = await ($B.promise("+ye+"("+M+")))",fe.add($NodeJS(ie));else{var ae=new $Node,W=new $NodeCtx(ae),Z=new $ExprCtx(W,"left",!1);Z.tree.push(x),x.parent=Z;var A=new $AssignCtx(Z);new $RawJSCtx(A,"await ($B.promise("+ye+"("+M+")))"),fe.add(ae)}var R=$NodeJS("catch(err)");ce.add(R),R.add($NodeJS(ie="if(err.__class__ === _b_.StopAsyncIteration){"+de+" = false; continue}else{throw err}")),n.children.forEach(function(he){ce.add(he)}),n.parent.children.splice(o,1);for(var X=G.length-1;X>=0;X--)n.parent.insert(o,G[X]);return n.children=[],0},$ForExpr.prototype.to_js=function(){this.js_processed=!0;var n=this.tree.pop();return"for ("+$to_js(this.tree)+" in "+n.to_js()+")"};var $FromCtx=$B.parser.$FromCtx=function(n){this.type="from",this.parent=n,this.module="",this.names=[],n.tree[n.tree.length]=this,this.expect="module",this.scope=$get_scope(this)};$FromCtx.prototype.add_name=function(n){this.names[this.names.length]=n,"*"==n&&(this.scope.blurred=!0)},$FromCtx.prototype.bind_names=function(){var n=$get_scope(this);this.names.forEach(function(o){Array.isArray(o)&&(o=o[1]),$bind(o,n,this)},this)},$FromCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.add_name(o),l.expect=",",l;if("alias"==l.expect)return l.names[l.names.length-1]=[$B.last(l.names),o],l.expect=",",l;case".":if("module"==l.expect)return l.module+="id"==n?o:".",l;case"import":if("module"==l.expect)return l.expect="id",l;case"op":if("*"==o&&"id"==l.expect&&0==l.names.length)return"module"!==$get_scope(l).ntype&&$_SyntaxError(l,["import * only allowed at module level"]),l.add_name("*"),l.expect="eol",l;case",":if(","==l.expect)return l.expect="id",l;case"eol":switch(l.expect){case",":case"eol":return l.bind_names(),$transition(l.parent,n);case"id":$_SyntaxError(l,["trailing comma not allowed without surrounding parentheses"]);default:$_SyntaxError(l,["invalid syntax"])}case"as":if(","==l.expect||"eol"==l.expect)return l.expect="alias",l;case"(":if("id"==l.expect)return l.expect="id",l;case")":if(","==l.expect||"id"==l.expect)return l.expect="eol",l}$_SyntaxError(l,"token "+n+" after "+l)},$FromCtx.prototype.toString=function(){return"(from) "+this.module+" (import) "+this.names},$FromCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=$get_module(this),l=o.module,x=[],B=0,D=$get_node(this).indent,G=" ".repeat(D);if(l.startsWith("$exec")){var M=$B.last($B.frames_stack)[1];M.module&&M.module.__name__&&(l=M.module.__name__)}for(var P=this.module.split("."),de=0;de<P.length;de++)o.imports[P.slice(0,de+1).join(".")]=!0;for(var ye,ie=this.module.replace(/\$/g,""),ce=[];ie.length>0&&"."==ie.charAt(0);){if(void 0===ye?void 0!==$B.imported[l]&&(ce=(ye=$B.imported[l].__package__).split(".")):(ye=$B.imported[ye],ce.pop()),void 0===ye)return"throw _b_.SystemError.$factory(\"Parent module '' not loaded, cannot perform relative import\")";"None"==ye&&console.log("package is None !"),ie=ie.substr(1)}ie&&ce.push(ie),this.module=ce.join(".");var fe=this.module.replace(/\$/g,"");x[B++]='var module = $B.$import("',x[B++]=fe+'",["';for(var ae=[],W=(de=0,this.names.length);de<W;de++)Array.isArray(this.names[de])?ae.push(this.names[de][0]):ae.push(this.names[de]);x[B++]=ae.join('","')+'"], {';var Z="";for(var A in this.aliases)x[B++]=Z+'"'+A+'": "'+this.aliases[A]+'"',Z=",";return x[B++]="}, {}, true);","*"==this.names[0]?(n.blurred=!0,x[B++]="\n"+G+"$B.import_all($locals, module);"):this.names.forEach(function(R){var X=R;Array.isArray(R)&&(X=R[1],R=R[0]),o.imports[this.module+"."+R]=!0,x[B++]="\n"+G+'$locals["'+X+'"] = $B.$getattr($B.imported["'+fe+'"], "'+R+'");'},this),x[B++]="\n"+G+"_b_.None;",x.join("")};var $FuncArgs=$B.parser.$FuncArgs=function(n){this.type="func_args",this.parent=n,this.tree=[],this.names=[],n.tree[n.tree.length]=this,this.expect="id",this.has_default=!1,this.has_star_arg=!1,this.has_kw_arg=!1};$FuncArgs.prototype.toString=function(){return"func args "+this.tree},$FuncArgs.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument"),"id"==l.expect&&(l.expect=",",l.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"])),new $FuncArgIdCtx(l,o);case",":if(","==l.expect)return l.expect="id",l;$_SyntaxError(l,"token "+n+" after "+l);case")":var x=$B.last(l.tree);return x&&"func_star_arg"==x.type&&"*"==x.name&&$_SyntaxError(l,"*"==l.op?["named arguments must follow bare *"]:"invalid syntax"),l.parent;case"op":l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument");var B=o;if(l.expect=",","*"==B)return l.has_star_arg&&$_SyntaxError(l,"duplicate star argument"),new $FuncStarArgCtx(l,"*");if("**"==B)return new $FuncStarArgCtx(l,"**");if("/"==B)return l.has_end_positional?$_SyntaxError(l,["duplicate / in function parameters"]):l.has_star_arg&&$_SyntaxError(l,["/ after * in function parameters"]),new $EndOfPositionalCtx(l);$_SyntaxError(l,"token "+B+" after "+l);case":":if("lambda"==l.parent.type)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgs.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $FuncArgIdCtx=$B.parser.$FuncArgIdCtx=function(n,o){this.type="func_arg_id",this.name=o,this.parent=n,n.has_star_arg?n.parent.after_star.push(o):n.parent.positional_list.push(o);var l=$get_node(this);l.binding[o]&&$_SyntaxError(n,["duplicate argument '"+o+"' in function definition"]),$bind(o,l,this),this.tree=[],n.tree[n.tree.length]=this;for(var x=n;void 0!==x.parent;){if("def"==x.type){x.locals.push(o);break}x=x.parent}this.expect="="};$FuncArgIdCtx.prototype.toString=function(){return"func arg id "+this.name+"="+this.tree},$FuncArgIdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":if("="==l.expect){l.has_default=!0;var x=l.parent.parent;return x.default_list.push(l.parent.has_star_arg?x.after_star.pop():x.positional_list.pop()),new $AbstractExprCtx(l,!1)}break;case",":case")":if(!l.parent.has_default||0!=l.tree.length||void 0!==l.parent.has_star_arg)return $transition(l.parent,n);$pos-=l.name.length,$_SyntaxError(l,["non-default argument follows default argument"]);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(l.has_default&&$_SyntaxError(l,"token "+n+" after "+l),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgIdCtx.prototype.to_js=function(){return this.js_processed=!0,this.name+$to_js(this.tree)};var $FuncStarArgCtx=$B.parser.$FuncStarArgCtx=function(n,o){this.type="func_star_arg",this.op=o,this.parent=n,this.node=$get_node(this),n.has_star_arg="*"==o,n.has_kw_arg="**"==o,n.tree[n.tree.length]=this};$FuncStarArgCtx.prototype.toString=function(){return"(func star arg "+this.op+") "+this.name},$FuncStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return void 0===l.name&&l.parent.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"]),l.set_name(o),l.parent.names.push(o),l;case",":case")":return void 0===l.name&&(l.set_name("*"),l.parent.names.push("*")),$transition(l.parent,n);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(void 0===l.name&&$_SyntaxError(l,"annotation on an unnamed parameter"),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncStarArgCtx.prototype.set_name=function(n){this.name=n,this.node.binding[n]&&$_SyntaxError(C,["duplicate argument '"+n+"' in function definition"]),$bind(n,this.node,this);for(var o=this.parent;void 0!==o.parent;){if("def"==o.type){o.locals.push(n);break}o=o.parent}"*"==this.op?o.other_args='"'+n+'"':o.other_kw='"'+n+'"'};var $GlobalCtx=$B.parser.$GlobalCtx=function(n){for(this.type="global",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.globals=this.scope.globals||new Set,this.module=$get_module(this);this.module.module!=this.module.id;)this.module=this.module.parent_block;this.module.binding=this.module.binding||{}};$GlobalCtx.prototype.toString=function(){return"global "+this.tree},$GlobalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$GlobalCtx.prototype.add=function(n){this.scope.annotations&&this.scope.annotations.has(n)&&$_SyntaxError(C,["annotated name '"+n+"' can't be global"]),this.scope.globals.add(n);var o=this.scope.parent_block;if(this.module.module.startsWith("$exec"))for(;o&&o.parent_block!==this.module;)o._globals=o._globals||{},o._globals[n]=this.module.id,delete o.binding[n],o=o.parent_block;this.module.binding[n]=!0},$GlobalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $IdCtx=$B.parser.$IdCtx=function(n,o){this.type="id",this.value=$mangle(o,n),this.parent=n,this.tree=[],n.tree[n.tree.length]=this;var l=this.scope=$get_scope(this);this.blurred_scope=this.scope.blurred,this.env=clone(this.scope.binding),["def","generator"].indexOf(l.ntype)>-1&&(l.referenced=l.referenced||{},$B.builtins[this.value]||(l.referenced[this.value]=!0)),"call_arg"==n.parent.type&&(this.call_arg=!0);for(var x=n;void 0!==x.parent;){switch(x.type){case"ctx_manager_alias":$bind(o,l,this);break;case"list_or_tuple":case"dict_or_set":case"call_arg":case"def":case"lambda":void 0===x.vars?x.vars=[o]:-1==x.vars.indexOf(o)&&x.vars.push(o),this.call_arg&&"lambda"==x.type&&(void 0===x.locals?x.locals=[o]:x.locals.push(o))}x=x.parent}if($parent_match(n,{type:"target_list"})&&(this.no_bindings=!0,$bind(o,l,this),this.bound=!0),["def","generator"].indexOf(l.ntype)>-1){for(var B=this.parent;B;){if("list_or_tuple"==B.type&&B.is_comp()){this.in_comp=!0;break}B=B.parent}"expr"==n.type&&"comp_if"==n.parent.type||"global"==n.type&&(void 0===l.globals?l.globals=new Set([o]):l.globals.add(o))}};$IdCtx.prototype.toString=function(){return"(id) "+this.value+":"+(this.tree||"")},$IdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":return"expr"==l.parent.type&&void 0!==l.parent.parent&&"call_arg"==l.parent.parent.type?new $AbstractExprCtx(new $KwArgCtx(l.parent),!1):$transition(l.parent,n,o);case"op":return $transition(l.parent,n,o);case"id":case"str":case"int":case"float":case"imaginary":["print","exec"].indexOf(l.value)>-1&&$_SyntaxError(l,["missing parenthesis in call to '"+l.value+"'"]),$_SyntaxError(l,"token "+n+" after "+l)}return"packed"==this.parent.parent.type&&-1==[".","[","("].indexOf(n)?this.parent.parent.transition(n,o):$transition(l.parent,n,o)},$IdCtx.prototype.firstBindingScopeId=function(){for(var n=this.scope;n;){if(n.globals&&n.globals.has(this.value))return $get_module(this).id;if(n.binding&&n.binding[this.value])return n.id;n=n.parent}},$IdCtx.prototype.boundBefore=function(n){for(var o=$get_node(this);o.parent;){var l=o.parent;if(l.bindings&&l.bindings[this.value])return l.bindings[this.value];for(var x=0;x<l.children.length;x++){var B=l.children[x];if(B===o)break;if(B.bindings&&B.bindings[this.value])return B.bindings[this.value]}if(l===n)break;o=l}return!1},$IdCtx.prototype.bindingType=function(n){for(var o,l,x=0,B=$get_node(this),D=!1;!D&&B.parent&&x++<100;){var G=B.parent;if(G.bindings&&G.bindings[this.value])return G.bindings[this.value];for(var M=0;M<G.children.length;M++){var P=G.children[M];if(P===B)break;P.bindings&&P.bindings[this.value]&&(D=P.bindings[this.value],l=M)}if(D){for(var de=l+1;de<G.children.length;de++){if((P=G.children[de]).children.length>0){o=!0;break}if(P===B)break}return o||D}if(G===n)break;B=G}return D},$IdCtx.prototype.to_js=function(n){if(void 0!==this.result&&"generator"==this.scope.ntype)return this.result;var o=this.value;if("__BRYTHON__"==o||"$B"==o)return o;if(o.startsWith("comp_result_"+$B.lambda_magic))return this.bound?"var "+o:o;if(this.js_processed=!0,this.scope._globals&&this.scope._globals[o]&&(this.global_module=this.scope._globals[o]),this.global_module)return"$locals_"+this.global_module.replace(/\./g,"_")+'["'+o+'"]';var l=void 0!==this.scope.binding[o],x=$get_node(this),B=x.bound_before;if(this.nonlocal=this.scope.nonlocals&&void 0!==this.scope.nonlocals[o],this.unbound=this.unbound||l&&!this.bound&&B&&-1==B.indexOf(o),!this.bound&&this.scope.C&&"class"==this.scope.ntype&&this.scope.C.tree[0].name==o)return'$B.$search("'+o+'")';if(this.unbound&&!this.nonlocal)return"def"==this.scope.ntype||"generator"==this.scope.ntype?'$B.$local_search("'+o+'")':'$B.$search("'+o+'")';for(var D=$get_scope(this),G=D,M=[],P=['"'+D.id+'"'],de=D;;){if(de.parent_block){if(de.parent_block==$B.builtins_scope||void 0===de.parent_block.id)break;de=de.parent_block}P.push('"'+de.id+'"')}if(P="["+P.join(", ")+"]",D.globals&&D.globals.has(o)&&(P=['"'+de.id+'"'],D=de),this.nonlocal||this.bound){var ye=this.firstBindingScopeId();if(void 0!==ye)return"$locals_"+ye.replace(/\./g,"_")+'["'+o+'"]';if(this.bound)return"$locals_"+D.id.replace(/\./g,"_")+'["'+o+'"]'}for(var ie="$locals_"+de.id.replace(/\./g,"_");;){if(void 0!==G.globals&&G.globals.has(o))return this.boundBefore(de)||this.augm_assign?ie+'["'+o+'"]':'$B.$global_search("'+o+'", '+P+")";if(G===D){if(B)(B.indexOf(o)>-1||G.C&&"def"==G.C.tree[0].type&&G.C.tree[0].env.indexOf(o)>-1)&&M.push(G);else if(G.binding[o]){if(void 0!==x.locals[o]){M.push(G);break}G.is_comp||G.parent_block&&G.parent_block.is_comp||M.push(G)}}else void 0===G.binding&&console.log("scope",G,o,"no binding",D),G.binding[o]&&M.push(G);if(!G.parent_block)break;G=G.parent_block}if(this.found=M,this.nonlocal&&M[0]===D&&M.shift(),M.length>0){if(M[0].C&&M[0]===D&&"$"!=o.charAt(0)){var ce=x.locals||{},fe=D.nonlocals;try{if(void 0===ce[o]&&!this.augm_assign&&("def"!=D.type||"generator"!=D.type)&&"class"!=D.ntype&&D.C.tree[0].args&&-1==D.C.tree[0].args.indexOf(o)&&(void 0===fe||void 0===fe[o]))return this.result='$B.$local_search("'+o+'")',this.result}catch(R){throw console.log("error",o,D),R}}if(M.length>1&&M[0].C&&"class"==M[0].C.tree[0].type){var ae="$locals_"+M[0].id.replace(/\./g,"_"),W="$locals_"+M[1].id.replace(/\./g,"_");if(B)return B.indexOf(o)>-1?(this.found=M[0].binding[o],Z=ae):(this.found=M[1].binding[o],Z=W),this.result=Z+'["'+o+'"]',this.result;this.found=!1;var Z=ae+'["'+o+'"] !== undefined ? ';return this.result="("+(Z+=ae+'["'+o+'"] : ')+W+'["'+o+'"])',this.result}this.found=(G=M[0]).binding[o];var A="$locals_"+G.id.replace(/\./g,"_");if(void 0===G.C)if("__builtins__"==G.id)de.blurred?o="("+ie+'["'+o+'"] || _b_.'+o+")":(o="_b_."+o,this.is_builtin=!0);else if(this.bound||this.augm_assign)o=A+'["'+o+'"]';else{if(G===D&&void 0===this.env[o])return this.result='$B.$search("'+o+'")',this.result;o=this.boundBefore(G)?A+'["'+o+'"]':'$B.$check_def("'+o+'",'+A+'["'+o+'"])'}else o=G===D?G.globals&&G.globals.has(o)?ie+'["'+o+'"]':this.bound||this.augm_assign||this.boundBefore(G)?'$locals["'+o+'"]':'$B.$check_def_local("'+o+'",$locals["'+o+'"])':this.augm_assign?A+'["'+o+'"]':'$B.$check_def_free("'+o+'",'+A+'["'+o+'"])';return this.result=o+$to_js(this.tree,""),this.result}return this.unknown_binding=!0,this.result='$B.$global_search("'+o+'", '+P+")",this.result};var $ImportCtx=$B.parser.$ImportCtx=function(n){this.type="import",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id"};$ImportCtx.prototype.toString=function(){return"import "+this.tree},$ImportCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $ImportedModuleCtx(l,o),l.expect=",",l;if("qual"==l.expect)return l.expect=",",l.tree[l.tree.length-1].name+="."+o,l.tree[l.tree.length-1].alias+="."+o,l;if("alias"==l.expect)return l.expect=",",l.tree[l.tree.length-1].alias=o,l;break;case".":if(","==l.expect)return l.expect="qual",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"as":if(","==l.expect)return l.expect="alias",l;break;case"eol":if(","==l.expect)return l.bind_names(),$transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$ImportCtx.prototype.bind_names=function(){var n=$get_scope(this);this.tree.forEach(function(o){if(o.name==o.alias){var l=o.name,x=l.split("."),B=l;x.length>1&&(B=x[0])}else B=o.alias;$bind(B,n,this)},this)},$ImportCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=[],l=$get_module(this);return this.tree.forEach(function(x){for(var B=x.name,D=x.name==x.alias?"{}":'{"'+B+'" : "'+x.alias+'"}',G="$locals_"+n.id.replace(/\./g,"_"),M=x.name.split("."),P=0;P<M.length;P++)l.imports[M.slice(0,P+1).join(".")]=!0;o.push('$B.$import("'+B+'", [],'+D+","+G+", true);")}),o.join("")+"_b_.None;"};var $ImportedModuleCtx=$B.parser.$ImportedModuleCtx=function(n,o){this.type="imported module",this.parent=n,this.name=o,this.alias=o,n.tree[n.tree.length]=this};$ImportedModuleCtx.prototype.toString=function(){return" (imported module) "+this.name},$ImportedModuleCtx.prototype.transition=function(n,o){},$ImportedModuleCtx.prototype.to_js=function(){return this.js_processed=!0,'"'+this.name+'"'};var $JSCode=$B.parser.$JSCode=function(n){this.js=n};$JSCode.prototype.toString=function(){return this.js},$JSCode.prototype.transition=function(n,o){},$JSCode.prototype.to_js=function(){return this.js_processed=!0,this.js};var $KwArgCtx=$B.parser.$KwArgCtx=function(n){this.type="kwarg",this.parent=n.parent,this.tree=[n.tree[0]],n.parent.tree.pop(),n.parent.tree.push(this),n.parent.parent.has_kw=!0;var o=this.tree[0].value,l=n.parent.parent;void 0===l.kwargs?l.kwargs=[o]:-1==l.kwargs.indexOf(o)?l.kwargs.push(o):$_SyntaxError(n,["keyword argument repeated"])};$KwArgCtx.prototype.toString=function(){return"kwarg "+this.tree[0]+"="+this.tree[1]},$KwArgCtx.prototype.transition=function(n,o){return","==n?new $CallArgCtx(this.parent.parent):$transition(this.parent,n)},$KwArgCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.tree[0].value;return"$$"==n.substr(0,2)&&(n=n.substr(2)),'{$nat:"kw",name:"'+n+'",value:'+$to_js(this.tree.slice(1,this.tree.length))+"}"};var $LambdaCtx=$B.parser.$LambdaCtx=function(n){this.type="lambda",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.args_start=$pos+6,this.vars=[],this.locals=[],this.node=$get_node(this),this.node.binding={},this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$LambdaCtx.prototype.toString=function(){return"(lambda) "+this.args_start+" "+this.body_start},$LambdaCtx.prototype.transition=function(n,o){var l=this;return":"==n&&void 0===l.args?(l.args=l.tree,l.tree=[],l.body_start=$pos,new $AbstractExprCtx(l,!1)):void 0!==l.args?(l.body_end=$pos,$transition(l.parent,n)):void 0===l.args&&"("!=n?$transition(new $FuncArgs(l),n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$LambdaCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent,o=this.node,l=$get_module(this),x=$get_src(n),B=x.substring(this.args_start,this.body_start),D=x.substring(this.body_start+1,this.body_end);D=(D=D.replace(/\\\n/g," ")).replace(/\n/g," ");var G=$get_scope(this),M=$B.UUID(),P="lambda_"+$B.lambda_magic+"_"+M,de="def "+P+"("+B+"):";de+="    return "+D;var ye="lambda"+M,ie=l.id.replace(/\./g,"_"),ce=$B.py2js(de,ie,ye,G,o.line_num).to_js(),fe=`$locals_${ye}`;return B="{}",l.is_comp&&(fe+=`,$locals_${l.id.replace(/\./g,"_")}`,B+=`,typeof $locals_${l.id.replace(/\./g,"_")}==="undefined" ?{}:$locals_${l.id.replace(/\./g,"_")}`),ce=`(function(${fe}){\n`+ce+`\nreturn $locals.${P}})(${B})`,$B.clear_ns(ye),$B.$py_src[ye]=null,delete $B.$py_src[ye],ce};var $ListOrTupleCtx=$B.parser.$ListOrTupleCtx=function(n,o){this.type="list_or_tuple",this.start=$pos,this.real=o,this.expect="id",this.closed=!1,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ListOrTupleCtx.prototype.toString=function(){switch(this.real){case"list":return"(list) ["+this.tree+"]";case"list_comp":case"gen_expr":return"("+this.real+") ["+this.intervals+"-"+this.tree+"]";default:return"(tuple) ("+this.tree+")"}},$ListOrTupleCtx.prototype.transition=function(n,o){var l=this;if(l.closed)return"["==n?new $AbstractExprCtx(new $SubCtx(l.parent),!1):"("==n?new $CallCtx(l.parent):$transition(l.parent,n,o);if(","==l.expect){switch(l.real){case"tuple":case"gen_expr":if(")"==n){for(var x=!0;"list_or_tuple"==l.type&&"tuple"==l.real&&"expr"==l.parent.type&&"node"==l.parent.parent.type&&1==l.tree.length;){x=!1;var B=l.parent.parent,D=B.tree.indexOf(l.parent);(P=l.tree[0]).parent=B,P.$in_parens=!0,B.tree.splice(D,1,P),l=P.tree[0]}if(x&&l.close(),"gen_expr"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside generator expression"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.parent:"abstract_expr"==l.parent.type&&l.parent.assign?(l.parent.parent.tree.pop(),(P=new $ExprCtx(l.parent.parent,"assign",!1)).tree=l.parent.tree,P.tree[0].parent=P,P.assign=l.parent.assign,P):l.parent}break;case"list":case"list_comp":if("]"==n){if(l.close(),"list_comp"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside list comprehension"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.tree.length>0?l.parent.tree[0]:l.parent.parent:l.parent}break;case"dict_or_set_comp":if("}"==n){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,[`'yield' inside ${"set_comp"==l.parent.real?"set":"dict"}comprehension`]);return l.intervals.push($pos),$transition(l.parent,n)}}switch(n){case",":return"tuple"==l.real&&(l.has_comma=!0),l.expect="id",l;case"for":"list"==l.real?(this.tree.length>1&&$_SyntaxError(l,"unparenthesized expression before 'for'"),l.real="list_comp"):l.real="gen_expr",l.intervals=[l.start+1],l.expression=l.tree,l.yields&&(l.expression.yields=l.yields,delete l.yields),l.tree=[];var M=new $ComprehensionCtx(l);return new $TargetListCtx(new $CompForCtx(M))}return $transition(l.parent,n,o)}if("id"!=l.expect)return $transition(l.parent,n,o);switch(l.real){case"tuple":if(")"==n)return l.close(),l.parent;if("eol"==n&&!0===l.implicit)return l.close(),$transition(l.parent,n);break;case"gen_expr":if(")"==n)return l.close(),$transition(l.parent,n);break;case"list":if("]"==n)return l.close(),l}switch(n){case"=":if("tuple"==l.real&&!0===l.implicit)return l.close(),l.parent.tree.pop(),(P=new $ExprCtx(l.parent,"tuple",!1)).tree=[l],l.parent=P,$transition(l.parent,n);break;case")":break;case"]":if("tuple"==l.real&&!0===l.implicit)return $transition(l.parent,n,o);break;case",":$_SyntaxError(l,"unexpected comma inside list");default:l.expect=",";var P=new $AbstractExprCtx(l,!1);return $transition(P,n,o)}},$ListOrTupleCtx.prototype.close=function(){this.closed=!0;for(var n=0,o=this.tree.length;n<o;n++){var l=this.tree[n];"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&","==l.tree[0].expect&&(this.tree[n]=l.tree[0].tree[0],this.tree[n].parent=this)}},$ListOrTupleCtx.prototype.is_comp=function(){switch(this.real){case"list_comp":case"gen_expr":case"dict_or_set_comp":return!0}return!1},$ListOrTupleCtx.prototype.get_src=function(){var n=$get_module(this).src,o=$get_scope(this);return void 0===o.comments||o.comments.forEach(function(l){var x=l[0],B=l[1];n=n.substr(0,x)+" ".repeat(B+1)+n.substr(x+B+1)}),n},$ListOrTupleCtx.prototype.bind_ids=function(n){this.tree.forEach(function(o){if("id"==o.type)$bind(o.value,n,this),o.bound=!0;else if("expr"==o.type&&"id"==o.tree[0].type)$bind(o.tree[0].value,n,this),o.tree[0].bound=!0;else if("expr"==o.type&&"packed"==o.tree[0].type){var l=o.tree[0].tree[0];"expr"==l.type&&"id"==l.tree[0].type&&($bind(l.tree[0].value,n,this),l.tree[0].bound=!0)}else("list_or_tuple"==o.type||"expr"==o.type&&"list_or_tuple"==o.tree[0].type)&&("expr"==o.type&&(o=o.tree[0]),o.bind_ids(n))},this)},$ListOrTupleCtx.prototype.packed_indices=function(){for(var n=[],o=0;o<this.tree.length;o++){var l=this.tree[o];"expr"==l.type&&("packed"==(l=l.tree[0]).type||"call"==l.type&&"packed"==l.func.type)&&n.push(o)}return n},$ListOrTupleCtx.prototype.unpack=function(n){for(var o,l="",x=0;x<this.tree.length;x++)o=n.indexOf(x)>-1?"_b_.list.$factory("+this.tree[x].to_js()+")":"["+this.tree[x].to_js()+"]",x>0&&(o=".concat("+o+")"),l+=o;return l},$ListOrTupleCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=(n.id.replace(/\//g,"_"),0),l=(A=$get_module(this)).module;switch(this.real){case"list":return(Ae=this.packed_indices()).length>0?"$B.$list("+this.unpack(Ae)+")":"$B.$list(["+$to_js(this.tree)+"])";case"list_comp":case"gen_expr":case"dict_or_set_comp":for(var x=this.get_src(),B=[],D=[],G=new RegExp('"',"g"),M=A.comments,P=1;P<this.intervals.length;P++){for(var de=this.intervals[P-1],ye=this.intervals[P],ie=x.substring(de,ye),ce=M.length-1;ce>=0;ce--){var fe=M[ce];fe[0]>de&&fe[0]<ye&&(ie=ie.substr(0,o=fe[0]-de)+" ".repeat(fe[1])+ie.substr(o+fe[1]+1))}ie=ie.replace(/\\\n/g," "),D.push(ie);var ae=ie.split("\n"),W=[];ae.forEach(function(Xe){0!=Xe.replace(/ /g,"").length&&(Xe=(Xe=(Xe=Xe.replace(/\n/g," ")).replace(/\\/g,"\\\\")).replace(G,'\\"'),W.push('"'+Xe+'"'))}),B.push("["+W.join(",")+"]")}var Z=$get_node(this).line_num;switch(this.real){case"list_comp":var A,R=$B.$list_comp(D),he=R[1],U="lc"+$B.lambda_magic+he,Re=$pos,be=(A=$B.py2js({src:R[0],is_comp:!0,line_info:Z+","+l},l,U,n,1)).outermost_expr;$get_node(this).has_yield&&(be=this.tree[0].tree[0].tree[1]),void 0===be&&(be=A.first_for.tree[1]);var Pe=be.to_js();$pos=Re;var Ge=A.to_js();return A=null,$B.clear_ns(U),delete $B.$py_src[U],Ge=`function(expr){${Ge+="return $locals_"+U+'["x'+he+'"]'}})(${Pe})`,this.is_await&&(Ge="async "+Ge),"("+Ge;case"dict_or_set_comp":return 1==this.expression.length?$B.$gen_expr(l,n,D,Z,!0):$B.$dict_comp(l,n,D,Z)}return $B.$gen_expr(l,n,D,Z);case"tuple":var Ae;return(Ae=this.packed_indices()).length>0?"$B.fast_tuple("+this.unpack(Ae)+")":1==this.tree.length&&void 0===this.has_comma?this.tree[0].to_js():"$B.fast_tuple(["+$to_js(this.tree)+"])"}};var $NodeCtx=$B.parser.$NodeCtx=function(n){this.node=n,n.C=this,this.tree=[],this.type="node";for(var o=null,l=n;l.parent&&"module"!=l.parent.type;){var x=!1;switch(l.parent.C.tree[0].type){case"def":case"class":case"generator":o=l.parent,x=!0}if(x)break;l=l.parent}null===o&&(o=l.parent||l),this.node.locals=clone(o.binding),this.scope=o};$NodeCtx.prototype.toString=function(){return"node "+this.tree},$NodeCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":case".":var x=new $AbstractExprCtx(l,!0);return $transition(x,n,o);case"op":switch(o){case"*":case"+":case"-":case"~":return x=new $AbstractExprCtx(l,!0),$transition(x,n,o)}break;case"async":return new $AsyncCtx(l);case"await":return new $AbstractExprCtx(new $AwaitCtx(l),!0);case"class":return new $ClassCtx(l);case"continue":return new $ContinueCtx(l);case"__debugger__":return new $DebuggerCtx(l);case"break":return new $BreakCtx(l);case"def":return new $DefCtx(l);case"for":return new $TargetListCtx(new $ForExpr(l));case"if":case"while":return new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"elif":var B=$previous(l);return-1!=["condition"].indexOf(B.type)&&"while"!=B.token||$_SyntaxError(l,"elif after "+B.type),new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"else":return B=$previous(l),-1==["condition","except","for"].indexOf(B.type)&&$_SyntaxError(l,"else after "+B.type),new $SingleKwCtx(l,n);case"finally":return B=$previous(l),-1!=["try","except"].indexOf(B.type)||"single_kw"==B.type&&"else"==B.token||$_SyntaxError(l,"finally after "+B.type),new $SingleKwCtx(l,n);case"try":return new $TryCtx(l);case"except":return B=$previous(l),-1==["try","except"].indexOf(B.type)&&$_SyntaxError(l,"except after "+B.type),new $ExceptCtx(l);case"assert":return new $AbstractExprCtx(new $AssertCtx(l),!1,!0);case"from":return new $FromCtx(l);case"import":return new $ImportCtx(l);case"global":return new $GlobalCtx(l);case"nonlocal":return new $NonlocalCtx(l);case"lambda":return new $LambdaCtx(l);case"pass":return new $PassCtx(l);case"raise":return new $AbstractExprCtx(new $RaiseCtx(l),!0);case"return":return new $AbstractExprCtx(new $ReturnCtx(l),!0);case"with":return new $AbstractExprCtx(new $WithCtx(l),!1);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case"del":return new $AbstractExprCtx(new $DelCtx(l),!0);case"@":return new $DecoratorCtx(l);case",":l.tree&&0==l.tree.length&&$_SyntaxError(l,"token "+n+" after "+l);var D=l.tree[0];l.tree=[];var G=new $ListOrTupleCtx(l);return G.real="tuple",G.implicit=0,G.tree.push(D),D.parent=G,G;case"eol":return 0==l.tree.length?(l.node.parent.children.pop(),l.node.parent.C):l}$_SyntaxError(l,"token "+n+" after "+l)},$NodeCtx.prototype.to_js=function(){if(void 0!==this.js)return this.js;if(this.js_processed=!0,this.tree.length>1){var n=new $Node;new $NodeCtx(n).tree=[this.tree[1]],n.indent=node.indent+4,this.tree.pop(),node.add(n)}if(this.js="",this.tree[0]){var o="def"!=this.scope.ntype;if(this.tree[0].annotation)if(o){if("expr"==this.tree[0].type&&!this.tree[0].$in_parens&&"id"==this.tree[0].tree[0].type){var l="";return this.create_annotations&&(l+="$locals.__annotations__ = $B.empty_dict();"),l+"_b_.dict.$setitem($locals.__annotations__, '"+this.tree[0].tree[0].value+"', "+this.tree[0].annotation.to_js()+");"}"def"==this.tree[0].type?this.js=this.tree[0].annotation.to_js()+";":(this.js="",this.tree=[])}else"def"!=this.tree[0].type&&(this.tree=[]);else if("assign"==this.tree[0].type&&!this.tree[0].tree[0].$in_parens&&this.tree[0].tree[0].annotation){var x=this.tree[0].tree[0],B=this.tree[0].tree[1];if(this.create_annotations&&(this.js+="$locals.__annotations__ = $B.empty_dict();"),this.js+="var $value = "+B.to_js()+";",this.tree[0].tree.splice(1,1),new $RawJSCtx(this.tree[0],"$value"),!x.tree[0]||"id"!=x.tree[0].type||!o)return this.js+=$to_js(this.tree)+";",o&&(this.js+=x.annotation.to_js()),this.js;this.js+="_b_.dict.$setitem($locals.__annotations__, '"+x.tree[0].value+"', "+x.annotation.to_js()+");"}}return this.js+=0==this.node.children.length?$to_js(this.tree)+";":$to_js(this.tree),this.js};var $NodeJS=$B.parser.$NodeJS=function(n){var o=new $Node;return new $NodeJSCtx(o,n),o},$NodeJSCtx=$B.parser.$NodeJSCtx=function(n,o){this.node=n,n.C=this,this.type="node_js",this.tree=[o]};$NodeJSCtx.prototype.toString=function(){return"js "+js},$NodeJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.tree[0]};var $NonlocalCtx=$B.parser.$NonlocalCtx=function(n){this.type="nonlocal",this.parent=n,this.tree=[],this.names={},n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.nonlocals=this.scope.nonlocals||{},void 0===this.scope.C&&$_SyntaxError(n,["nonlocal declaration not allowed at module level"])};$NonlocalCtx.prototype.toString=function(){return"nonlocal "+this.tree},$NonlocalCtx.prototype.add=function(n){"arg"==this.scope.binding[n]&&$_SyntaxError(C,["name '"+n+"' is parameter and nonlocal"]),this.names[n]=[!1,$pos],this.scope.nonlocals[n]=!0},$NonlocalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$NonlocalCtx.prototype.transform=function(n,o){var l=this.parent,x=this.scope.parent_block;if(void 0===x.C)$_SyntaxError(l,["no binding for nonlocal '"+$B.last(Object.keys(this.names))+"' found"]);else{for(;void 0!==x&&void 0!==x.C;){for(var B in this.names)void 0!==x.binding[B]&&(this.names[B]=[!0]);x=x.parent_block}for(var B in this.names)this.names[B][0]||(console.log("nonlocal error, C "+l),$pos=this.names[B][1],$_SyntaxError(l,["no binding for nonlocal '"+B+"' found"]))}},$NonlocalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $NotCtx=$B.parser.$NotCtx=function(n){this.type="not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$NotCtx.prototype.toString=function(){return"not ("+this.tree+")"},$NotCtx.prototype.transition=function(n,o){var l=this;switch(n){case"in":return l.parent.parent.tree.pop(),new $ExprCtx(new $OpCtx(l.parent,"not_in"),"op",!1);case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"op":if("+"==o||"-"==o||"~"==o)return x=new $AbstractExprCtx(l,!1),$transition(x,n,o)}return $transition(l.parent,n)},$NotCtx.prototype.to_js=function(){return this.js_processed=!0,"!$B.$bool("+$to_js(this.tree)+")"};var $NumberCtx=$B.parser.$NumberCtx=function(n,o,l){this.type=n,this.value=l,this.parent=o,this.tree=[],o.tree[o.tree.length]=this};$NumberCtx.prototype.toString=function(){return this.type+" "+this.value},$NumberCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$NumberCtx.prototype.to_js=function(){this.js_processed=!0;var type=this.type,value=this.value;if("int"==type){var v=parseInt(value[1],value[0]);if(v>$B.min_int&&v<$B.max_int)return this.unary_op&&(v=eval(this.unary_op+v)),v;var v=$B.long_int.$factory(value[1],value[0]);switch(this.unary_op){case"-":v=$B.long_int.__neg__(v);break;case"~":v=$B.long_int.__invert__(v)}return'{__class__: $B.long_int, value: "'+v.value+'", pos: '+v.pos+"}"}return"float"==type?/^\d+$/.exec(value)||/^\d+\.\d*$/.exec(value)?"(new Number("+this.value+"))":"_b_.float.$factory("+value+")":"imaginary"==type?"$B.make_complex(0,"+value+")":void 0};var $OpCtx=$B.parser.$OpCtx=function(n,o){if(this.type="op",this.op=o,this.parent=n.parent,this.tree=[n],this.scope=$get_scope(this),"expr"==n.type)if(["int","float","str"].indexOf(n.tree[0].type)>-1)this.left_type=n.tree[0].type;else if("id"==n.tree[0].type){var l=this.scope.binding[n.tree[0].value];l&&(this.left_type=l.type)}n.parent.tree.pop(),n.parent.tree.push(this)};$OpCtx.prototype.toString=function(){return"(op "+this.op+") ["+this.tree+"]"},$OpCtx.prototype.transition=function(n,o){var l=this;if(void 0===l.op&&$_SyntaxError(l,["C op undefined "+l]),"unary"==l.op.substr(0,5)){if("eol"!=n&&("assign"==l.parent.type||"return"==l.parent.type)){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.tree.push(l),l.parent=x,x}2==l.tree.length&&"expr"==l.tree[1].type&&"int"==l.tree[1].tree[0].type&&(l.parent.tree.pop(),l.parent.tree.push(l.tree[1]),l.tree[1].parent=l.parent,l.tree[1].tree[0].unary_op=l.tree[0].op)}switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case"op":switch(o){case"+":case"-":case"~":return new $UnaryCtx(l,o)}default:"abstract_expr"==l.tree[l.tree.length-1].type&&$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n)},$OpCtx.prototype.to_js=function(){this.js_processed=!0;var n={"==":"eq","!=":"ne",">=":"ge","<=":"le","<":"lt",">":"gt"};if(void 0!==n[this.op]){var o=n[this.op];if("expr"==this.tree[0].type&&"expr"==this.tree[1].type){var l=this.tree[0].tree[0],x=this.tree[1].tree[0],B=l.to_js(),D=x.to_js();switch(x.type){case"int":switch(l.type){case"int":return Number.isSafeInteger(l.value)&&Number.isSafeInteger(x.value)?B+this.op+D:"$B.$getattr("+this.tree[0].to_js()+',"__'+o+'__")('+this.tree[1].to_js()+")";case"str":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  int() '+this.op+' str()")'}case"id":return"(typeof "+B+' == "number" ? '+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"str":switch(l.type){case"str":return B+this.op+D;case"int":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  str() '+this.op+' int()")'}case"id":return"(typeof "+B+' == "string" ? '+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"id":if("id"==l.type)return"typeof "+B+'!="object" && typeof '+B+'!="function" && typeof '+B+" == typeof "+D+" ? "+B+this.op+D+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")"}}}switch(this.op){case"and":var G=this.tree[0].to_js(),M=this.tree[1].to_js();return void 0!==this.wrap?"(function(){var "+this.wrap.name+" = "+this.wrap.js+";return $B.$test_expr($B.$test_item("+G+") && $B.$test_item("+M+"))})()":"$B.$test_expr($B.$test_item("+G+")&&$B.$test_item("+M+"))";case"or":return(X="$B.$test_expr($B.$test_item("+this.tree[0].to_js()+")||")+"$B.$test_item("+this.tree[1].to_js()+"))";case"in":return"$B.$is_member("+$to_js(this.tree)+")";case"not_in":return"!$B.$is_member("+$to_js(this.tree)+")";case"unary_neg":case"unary_pos":case"unary_inv":if("unary_neg"==this.op?(ye="-",o="__neg__"):"unary_pos"==this.op?(ye="+",o="__pos__"):(ye="~",o="__invert__"),"expr"==this.tree[1].type){var P=this.tree[1].tree[0];switch(P.type){case"int":var de=parseInt(P.value[1],P.value[0]);return Number.isSafeInteger(de)?ye+de:"$B.$getattr("+P.to_js()+', "'+o+'")()';case"float":return"_b_.float.$factory("+ye+P.value+")";case"imaginary":return"$B.make_complex(0,"+ye+P.value+")"}}return"$B.$getattr("+this.tree[1].to_js()+',"'+o+'")()';case"is":return"$B.$is("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"is_not":return this.tree[0].to_js()+"!=="+this.tree[1].to_js();case"+":return"$B.add("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"*":case"-":let Q=function(be,Pe){var Ge;return["int","float","str"].indexOf(Pe.type)>-1?Ge=Pe.type:"id"==Pe.type&&be[Pe.value]&&(Ge=be[Pe.value].type),Ge};var ye=this.op,ie=[],ce=!1,fe=$get_scope(this),ae=this.tree[0],W=this.tree[1];if(function be(Pe){if("expr"==Pe.type&&"int"==Pe.tree[0].type)return!0;if("expr"==Pe.type&&"float"==Pe.tree[0].type)return ce=!0,!0;if("expr"==Pe.type&&"list_or_tuple"==Pe.tree[0].type&&"tuple"==Pe.tree[0].real&&1==Pe.tree[0].tree.length&&"expr"==Pe.tree[0].tree[0].type)return be(Pe.tree[0].tree[0].tree[0]);if("expr"==Pe.type&&"id"==Pe.tree[0].type){var Ge=Pe.tree[0].to_js();return-1==ie.indexOf(Ge)&&ie.push(Ge),!0}if("op"==Pe.type&&["*","+","-"].indexOf(Pe.op)>-1){for(var Ae=0;Ae<Pe.tree.length;Ae++)if(!be(Pe.tree[Ae]))return!1;return!0}return!1}(this)){var Z=this.tree[0].tree[0],A=this.tree[1].tree[0];if(0!=ie.length||ce){if(0==ie.length)return"new Number("+this.simple_js()+")";var R=fe.binding;if(l=Q(R,Z),x=Q(R,A),"float"==l&&"float"==x||"+"==this.op&&"str"==l&&"str"==x)return this.result_type=l,Z.to_js()+this.op+A.to_js();if(["int","float"].indexOf(l)>-1&&["int","float"].indexOf(x)>-1)switch(this.result_type="int"==l&&"int"==x?"int":"float",this.op){case"-":return"$B.sub("+Z.to_js()+","+A.to_js()+")";case"*":return"$B.mul("+Z.to_js()+","+A.to_js()+")"}var X,he=[],U=[];return ie.forEach(function(be){he.push("typeof "+be+'.valueOf() == "number"'),U.push("typeof "+be+' == "number"')}),(X=[he.join(" && ")+" ? "]).push("("+U.join(" && ")+" ? "),X.push(this.simple_js()),X.push(" : new Number("+this.simple_js()+")"),X.push(")"),l=this.tree[0].to_js(),x=this.tree[1].to_js(),"+"==this.op&&X.push(" : (typeof "+l+' == "string" && typeof '+x+' == "string") ? '+l+"+"+x),X.push(': $B.rich_op("'+$operators[this.op]+'",'+l+","+x+")"),"("+X.join("")+")"}return this.simple_js()}return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+ae.to_js()+","+W.to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+ae.to_js()+", "+W.to_js()+")";default:return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+this.tree[0].to_js()+", "+this.tree[1].to_js()+")"}},$OpCtx.prototype.simple_js=function(){var n=this.op;function o(l){return"op"==l.type?l.simple_js():"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&"expr"==l.tree[0].tree[0].type?"("+l.tree[0].tree[0].tree[0].simple_js()+")":l.tree[0].to_js()}return"+"==n?"$B.add("+o(this.tree[0])+","+o(this.tree[1])+")":"-"==n?"$B.sub("+o(this.tree[0])+","+o(this.tree[1])+")":"*"==n?"$B.mul("+o(this.tree[0])+","+o(this.tree[1])+")":"/"==n?"$B.div("+o(this.tree[0])+","+o(this.tree[1])+")":o(this.tree[0])+n+o(this.tree[1])};var $PackedCtx=$B.parser.$PackedCtx=function(n){if(this.type="packed","list_or_tuple"==n.parent.type&&"node"==n.parent.parent.type)for(var o=0;o<n.parent.tree.length;o++){var l=n.parent.tree[o];"expr"==l.type&&l.tree.length>0&&"packed"==l.tree[0].type&&$_SyntaxError(n,["two starred expressions in assignment"])}this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PackedCtx.prototype.toString=function(){return"(packed) "+this.tree},$PackedCtx.prototype.transition=function(n,o){var l=this;if(l.tree.length>0&&"["==n)return $transition(l.tree[0],n,o);if("id"==n){var x=new $AbstractExprCtx(l,!1);return x.packed=!0,l.parent.expect=",",$transition(x,n,o)}return"["==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"list")):"("==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"tuple")):"]"==n?$transition(l.parent,n,o):"{"==n?(l.parent.expect=",",new $DictOrSetCtx(l)):l.parent.transition(n,l)},$PackedCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $PassCtx=$B.parser.$PassCtx=function(n){this.type="pass",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PassCtx.prototype.toString=function(){return"(pass)"},$PassCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$PassCtx.prototype.to_js=function(){return this.js_processed=!0,"void(0)"};var $RaiseCtx=$B.parser.$RaiseCtx=function(n){this.type="raise",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope_type=$get_scope(this).ntype};$RaiseCtx.prototype.toString=function(){return" (raise) "+this.tree},$RaiseCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if(0==l.tree.length)return new $IdCtx(new $ExprCtx(l,"exc",!1),o);break;case"from":if(l.tree.length>0)return new $AbstractExprCtx(l,!1);break;case"eol":return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$RaiseCtx.prototype.to_js=function(){return this.js_processed=!0,"$B.$raise("+(0==this.tree.length?"":this.tree[0].to_js())+")"};var $RawJSCtx=$B.parser.$RawJSCtx=function(n,o){this.type="raw_js",n.tree[n.tree.length]=this,this.parent=n,this.js=o};$RawJSCtx.prototype.toString=function(){return"(js) "+this.js},$RawJSCtx.prototype.transition=function(n,o){},$RawJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.js};var $ReturnCtx=$B.parser.$ReturnCtx=function(n){this.type="return",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope=$get_scope(this),-1==["def","generator"].indexOf(this.scope.ntype)&&$_SyntaxError(n,["'return' outside function"]);for(var o=this.node=$get_node(this);o.parent;){if(o.parent.C){var l=o.parent.C.tree[0];if("for"==l.type){l.has_return=!0;break}("try"==l.type||"single_kw"==l.type&&"finally"==l.token)&&(l.has_return=!0)}o=o.parent}};$ReturnCtx.prototype.toString=function(){return"return "+this.tree},$ReturnCtx.prototype.transition=function(n,o){return $transition(this.parent,n)},$ReturnCtx.prototype.to_js=function(){this.js_processed=!0,1==this.tree.length&&"abstract_expr"==this.tree[0].type&&(this.tree.pop(),new $IdCtx(new $ExprCtx(this,"rvalue",!1),"None"));var n=this.scope;if("generator"==n.ntype)return"var $res = "+$to_js(this.tree)+"; $B.leave_frame({$locals});return $B.generator_return($res)";var o="    ".repeat(this.node.indent-1),l="var $res = "+$to_js(this.tree)+";\n"+o+"if($locals.$f_trace !== _b_.None){$B.trace_return($res)}\n"+o+"$B.leave_frame";return"$exec_"==n.id.substr(0,6)&&(l+="_exec"),l+"({$locals});\n"+o+"return $res"};var $SingleKwCtx=$B.parser.$SingleKwCtx=function(n,o){if(this.type="single_kw",this.token=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this,"else"==o){for(var l=n.node,x=l.parent,B=0;B<x.children.length&&x.children[B]!==l;B++);var D=x.children[B-1].C;if(D.tree.length>0){var G=D.tree[0];("for"==G.type||"asyncfor"==G.type||"condition"==G.type&&"while"==G.token)&&(G.has_break=!0,G.else_node=$get_node(this),this.loop_num=G.loop_num)}}};$SingleKwCtx.prototype.toString=function(){return this.token},$SingleKwCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$SingleKwCtx.prototype.transform=function(n,o){if("finally"==this.token){var l=$get_scope(this);n.insert(0,$NodeJS("var $exit;if($B.frames_stack.length < $stack_length){$exit = true;$B.frames_stack.push($top_frame)}")),l.id.replace(/\./g,"_"),"return"!=n.children[n.children.length-1].C.tree[0].type&&n.add($NodeJS("if($exit){$B.leave_frame({$locals})}"))}},$SingleKwCtx.prototype.to_js=function(){return this.js_processed=!0,"finally"==this.token?this.token:void 0!==this.loop_num?"if($locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_num+'"])':this.token};var $SliceCtx=$B.parser.$SliceCtx=function(n){this.type="slice",this.parent=n,this.tree=n.tree.length>0?[n.tree.pop()]:[],n.tree.push(this)};$SliceCtx.prototype.transition=function(n,o){return":"==n?new $AbstractExprCtx(this,!1):$transition(this.parent,n,o)},$SliceCtx.prototype.to_js=function(){for(var n=0;n<this.tree.length;n++)"abstract_expr"==this.tree[n].type&&(this.tree[n].to_js=function(){return"_b_.None"});return"_b_.slice.$factory("+$to_js(this.tree)+")"};var $StarArgCtx=$B.parser.$StarArgCtx=function(n){this.type="star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$StarArgCtx.prototype.toString=function(){return"(star arg) "+this.tree},$StarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return"target_list"==l.parent.type?(l.tree.push(o),l.parent.expect=",",l.parent):$transition(new $AbstractExprCtx(l,!1),n,o);case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return 0==l.tree.length&&$_SyntaxError(l,"unnamed star argument"),$transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$StarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"ptuple",arg:'+$to_js(this.tree)+"}"};var $StringCtx=$B.parser.$StringCtx=function(n,o){this.type="str",this.parent=n,this.tree=[o],n.tree[n.tree.length]=this,this.raw=!1};$StringCtx.prototype.toString=function(){return"string "+(this.tree||"")},$StringCtx.prototype.transition=function(n,o){var l=this;switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return l.parent.tree[0]=l,new $CallCtx(l.parent);case"str":return l.tree.push(o),l}return $transition(l.parent,n,o)},$StringCtx.prototype.to_js=function(){this.js_processed=!0;var n="",o=null,l=$get_scope(this),x=!1;function B(ie){for(var ce=0;ce<ie.length;ce++){try{code=ie.charCodeAt(ce)}catch(fe){throw console.log("err for s",ie),fe}if(code>=55296&&code<=56319)return!0}return!1}function D(ie){for(var ce=[],fe=0;fe<ie.length;fe++)if("expression"==ie[fe].type){for(var ae=ie[fe].expression,W=0,Z=[],A=[ae];W<ae.length;){var R=ae.charAt(W);if(":"==R&&0==Z.length){A=[ae.substr(0,W),ae.substr(W+1)];break}"{[(".indexOf(R)>-1?Z.push(R):")]}".indexOf(R)>-1&&Z.pop(),W++}var X=$pos,he=$B.py2js(ae=A[0],l.module,l.id,l);he.to_js(),$pos=X;for(var U=0;U<he.children.length;U++){var Re=he.children[U];if(Re.C.tree&&1==Re.C.tree.length&&"try"==Re.C.tree[0]){for(var Q=0;Q<Re.children.length;Q++)if(!Re.children[Q].is_line_num){for(var be=Re.children[Q].js;"\n;".indexOf(be.charAt(be.length-1))>-1;)be=be.substr(0,be.length-1);break}break}}switch(ie[fe].conversion){case"a":be="_b_.ascii("+be+")";break;case"r":be="_b_.repr("+be+")";break;case"s":be="_b_.str.$factory("+be+")"}var Pe=A[1];if(void 0!==Pe){var Ge=$B.parse_fstring(Pe),Ae="_b_.str.format('{0:' + "+(Pe=Ge.length>1?D(Ge):"'"+Pe+"'")+" + '}', "+be+")";ce.push(Ae)}else null===ie[fe].conversion&&(be="_b_.str.$factory("+be+")"),ce.push(be)}else{var Xe=new RegExp("'","g"),Ke=ie[fe].replace(Xe,"\\'").replace(/\n/g,"\\n");x=x||B(Ke),ce.push("'"+Ke+"'")}return ce.join(" + ")}function G(ie){return(ie=ie.replace(/\n/g,"\\n\\\n")).replace(/\\U([A-Fa-f0-9]{8})/gm,function(ce){return String.fromCharCode("0x"+ce.slice(2))})}for(var M=0;M<this.tree.length;M++){if("call"==this.tree[M].type)return"(function(){throw _b_.TypeError.$factory(\"'str' object is not callable\")}())";var P=this.tree[M],de=Array.isArray(P),ye=!1;if(de||(ye="b"==P.charAt(0)),null==o)o=ye,ye&&(n+="_b_.bytes.$new(_b_.bytes, ");else if(o!=ye)return'$B.$TypeError("can\'t concat bytes to str")';ye?n+=G(P.substr(1)):de?n+=D(P):(x=x||B(P),n+=G(P)),M<this.tree.length-1&&(n+="+")}return ye&&(n+=',"ISO-8859-1")'),0==n.length&&(n='""'),x&&(n="_b_.str.$surrogate.$factory("+n+")"),n};var $SubCtx=$B.parser.$SubCtx=function(n){this.type="sub",this.func="getitem",this.value=n.tree[0],n.tree.pop(),n.tree[n.tree.length]=this,this.parent=n,this.tree=[]};$SubCtx.prototype.toString=function(){return"(sub) (value) "+this.value+" (tree) "+this.tree},$SubCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"]":if(l.parent.packed)return l.parent.tree[0];if(l.tree[0].tree.length>0)return l.parent;break;case":":return new $AbstractExprCtx(new $SliceCtx(l),!1);case",":return new $AbstractExprCtx(l,!1)}$_SyntaxError(l,"token "+n+" after "+l)},$SubCtx.prototype.to_js=function(){if(this.js_processed=!0,"getitem"==this.func&&"id"==this.value.type){var n=$get_node(this).locals[this.value.value],o=this.value.to_js();if("list"==n||"tuple"==n){if(1==this.tree.length)return"$B.list_key("+o+", "+this.tree[0].to_js()+")";if(2==this.tree.length)return"$B.list_slice("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+")";if(3==this.tree.length)return"$B.list_slice_step("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+","+(this.tree[2].to_js()||"null")+")"}}if("getitem"==this.func&&1==this.tree.length)return"slice"==this.tree[0].type?`$B.getitem_slice(${this.value.to_js()},${this.tree[0].to_js()})`:"$B.$getitem("+this.value.to_js()+","+this.tree[0].to_js()+")";var l="",x=!1;if("delitem"!==this.func&&1==this.tree.length&&!this.in_sub){var B="",D=this;for(x=!0;"sub"==D.value.type;)B+="["+D.tree[0].to_js()+"]",D.value.in_sub=!0,D=D.value;var G=D.value.to_js()+"["+D.tree[0].to_js()+"]((Array.isArray("+D.value.to_js()+") || typeof "+D.value.to_js()+' == "string") && '+G+" !== undefined ?"+G+B+" : "}if(l+="$B.$getattr("+(o=this.value.to_js())+',"__'+this.func+'__")(',1==this.tree.length)l+=this.tree[0].to_js()+")";else{var M=[];this.tree.forEach(function(P){M.push("abstract_expr"==P.type?"_b_.None":P.to_js())}),l+="_b_.tuple.$factory(["+M.join(",")+"]))"}return x?l+")":l};var $TargetListCtx=$B.parser.$TargetListCtx=function(n){this.type="target_list",this.parent=n,this.tree=[],this.expect="id",n.tree[n.tree.length]=this};$TargetListCtx.prototype.toString=function(){return"(target list) "+this.tree},$TargetListCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect=",",new $IdCtx(new $ExprCtx(l,"target",!1),o);case"op":if("id"==l.expect&&"*"==o)return new $PackedCtx(l);case"(":case"[":if("id"==l.expect)return l.expect=",",new $ListOrTupleCtx(l,"("==n?"tuple":"list");case")":case"]":if(","==l.expect)return l.parent;case",":if(","==l.expect)return l.expect="id",l}return","==l.expect||"in"==n?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$TargetListCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $TernaryCtx=$B.parser.$TernaryCtx=function(n){this.type="ternary",this.parent=n.parent,n.parent.tree.pop(),n.parent.tree.push(this),n.parent=this,this.tree=[n]};$TernaryCtx.prototype.toString=function(){return"(ternary) "+this.tree},$TernaryCtx.prototype.transition=function(n,o){var l=this;if("else"==n)return l.in_else=!0,new $AbstractExprCtx(l,!1);if(l.in_else){if(","==n&&["assign","augm_assign","node","return"].indexOf(l.parent.type)>-1){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.tree[0]=l,l.parent=x,x.expect="id",x}}else $_SyntaxError(l,"token "+n+" after "+l);return $transition(l.parent,n,o)},$TernaryCtx.prototype.to_js=function(){this.js_processed=!0;var n="$B.$bool("+this.tree[1].to_js()+") ? ";return(n+=this.tree[0].to_js()+" : ")+this.tree[2].to_js()};var $TryCtx=$B.parser.$TryCtx=function(n){this.type="try",this.parent=n,n.tree[n.tree.length]=this};$TryCtx.prototype.toString=function(){return"(try) "},$TryCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$TryCtx.prototype.transform=function(n,o){if(n.parent.children.length==o+1)$_SyntaxError(C,["unexpected EOF while parsing"]);else switch(n.parent.children[o+1].C.tree[0].type){case"except":case"finally":case"single_kw":break;default:$_SyntaxError(C,"no clause after try")}var l=$get_scope(this),x=create_temp_name("$err"),B="$locals."+create_temp_name("$failed"),D=B+" = false;\n"+" ".repeat(n.indent+4)+"try";new $NodeJSCtx(n,D),n.has_return=this.has_return;var G=$NodeJS("catch("+x+")");n.parent.insert(o+1,G),G.add($NodeJS("$B.set_exc("+x+")")),G.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),G.add($NodeJS(B+" = true;$B.pmframe = $B.last($B.frames_stack);if(false){}"));for(var M=o+2,P=!1,de=!1,ye=!1;M!=n.parent.children.length&&void 0!==(W=n.parent.children[M].C.tree[0]);)if("except"==W.type)de&&$_SyntaxError(C,"'except' or 'finally' after 'else'"),ye&&$_SyntaxError(C,"'except' after 'finally'"),W.error_name=x,W.tree.length>0&&null!=W.tree[0].alias&&n.parent.children[M].insert(0,$NodeJS('$locals["'+W.tree[0].alias+'"] = $B.exception('+x+")")),G.insert(G.children.length,n.parent.children[M]),0==W.tree.length&&(P&&$_SyntaxError(C,"more than one except: line"),P=!0),n.parent.children.splice(M,1);else if("single_kw"==W.type&&"finally"==W.token){ye=!0;var ce=n.parent.children[M];M++}else{if("single_kw"!=W.type||"else"!=W.token)break;de&&$_SyntaxError(C,"more than one 'else'"),ye&&$_SyntaxError(C,"'else' after 'finally'"),de=!0;var fe=n.parent.children[M];n.parent.children.splice(M,1)}if(!P){var ae=new $Node,W=new $NodeCtx(ae);G.insert(G.children.length,ae),new $SingleKwCtx(W,"else"),ae.add($NodeJS("throw "+x))}if(de){var Z=new $Node;Z.module=l.module,new $NodeJSCtx(Z,"if(!"+B+")"),fe.children.forEach(function(A){Z.add(A)}),ye?ce.insert(0,Z):n.parent.insert(M,Z),M++}$loop_num++},$TryCtx.prototype.to_js=function(){return this.js_processed=!0,"try"};var $UnaryCtx=$B.parser.$UnaryCtx=function(n,o){this.type="unary",this.op=o,this.parent=n,n.tree[n.tree.length]=this};$UnaryCtx.prototype.toString=function(){return"(unary) "+this.op},$UnaryCtx.prototype.transition=function(n,o){var l=this;switch(n){case"int":case"float":case"imaginary":var x=l.parent;return l.parent.parent.tree.pop(),"-"==l.op?o="-"+o:"~"==l.op&&(o=~o),$transition(l.parent.parent,n,o);case"id":l.parent.parent.tree.pop(),x=new $ExprCtx(l.parent.parent,"call",!1);var B=new $ExprCtx(x,"id",!1);return new $IdCtx(B,o),new $AttrCtx(x).name="+"==l.op?"__pos__":"-"==l.op?"__neg__":"__invert__",B;case"op":if("+"==o||"-"==o)return l.op=l.op===o?"+":"-",l}return $transition(l.parent,n,o)},this.to_js=function(){return this.js_processed=!0,this.op};var $WithCtx=$B.parser.$WithCtx=function(n){this.type="with",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="as",this.scope=$get_scope(this)};$WithCtx.prototype.toString=function(){return"(with) "+this.tree},$WithCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);$_SyntaxError(l,"token "+n+" after "+l);case"as":return new $AbstractExprCtx(new $AliasCtx(l));case":":switch(l.expect){case"id":case"as":case":":return $BodyCtx(l)}break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;if("alias"==l.expect)return l.expect=":",new $TargetListCtx(l,!1);break;case")":if(","==l.expect||"as"==l.expect)return l.expect=":",l;break;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&(","==l.expect||"as"==l.expect)||"as"==l.expect||":"==l.expect)return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$WithCtx.prototype.set_alias=function(n){var o=[];"id"==n.type?o=[n]:"list_or_tuple"==n.type&&n.tree.forEach(function(D){"expr"==D.type&&"id"==D.tree[0].type&&o.push(D.tree[0])});for(var l=0,x=o.length;l<x;l++){var B=o[l];$bind(B.value,this.scope,this),B.bound=!0,"module"!==this.scope.ntype&&this.scope.C.tree[0].locals.push(B.value)}},$WithCtx.prototype.transform=function(n,o){for(;this.tree.length>1;){var l=n.children,x=this.tree.pop(),B=new $Node,D=new $NodeCtx(B),G=new $WithCtx(D);x.parent=G,G.tree=[x],G.async=this.async,l.forEach(function(X){B.add(X)}),n.children=[B]}if(!this.transformed){if(this.prefix="",this.tree.length>1){var M=new $Node;D=new $NodeCtx(M),M.parent=n,M.module=n.module,M.indent=n.indent+4;var P=new $WithCtx(D);return P.async=this.async,P.tree=this.tree.slice(1),n.children.forEach(function(X){M.add(X)}),n.children=[M],void(this.transformed=!0)}if(this.async)return this.transform_async(n,o);var de=$NodeJS("try");n.parent.insert(o+1,de);var ye=this.num=$loop_num++;if(de.ctx_manager_num=ye,this.cm_name=this.prefix+"$ctx_manager"+ye,this.cmexit_name=this.prefix+"$ctx_manager_exit"+ye,this.exc_name=this.prefix+"$exc"+ye,this.err_name="$err"+ye,this.val_name="$value"+ye,this.yield_name=this.prefix+"$yield"+ye,null===this.tree[0].alias&&(this.tree[0].alias="$temp"),"expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type){"expr"==this.tree[1].type&&"list_or_tuple"==this.tree[1].tree[0].type||$_SyntaxError(C),this.tree[0].tree[0].tree.length!=this.tree[1].tree[0].tree.length&&$_SyntaxError(C,["wrong number of alias"]);var ie=this.tree[0].tree[0].tree,ce=this.tree[1].tree[0].tree;this.tree.shift(),this.tree.shift();for(var fe=ie.length-1;fe>=0;fe--)ie[fe].alias=ce[fe].value,this.tree.splice(0,0,ie[fe])}var ae=n.children;n.children=[];var W=new $Node;new $NodeJSCtx(W,"try"),de.add(W),this.tree[0].alias&&W.add($NodeJS('$locals["'+(ce=this.tree[0].alias.tree[0].tree[0].value)+'"] = '+this.val_name)),ae.forEach(function(X){W.add(X)});var Z=new $Node;new $NodeJSCtx(Z,"catch("+this.err_name+")");var A=this.exc_name+" = false;"+this.err_name+" = $B.exception("+this.err_name+", true)\n"+" ".repeat(n.indent+4)+"var $b = "+this.cmexit_name+"("+this.err_name+".__class__,"+this.err_name+",$B.$getattr("+this.err_name+', "__traceback__"));';"generator"==this.scope.ntype&&(A+="$B.set_cm_in_generator("+this.cmexit_name+");"),Z.add($NodeJS(A+="if(!$B.$bool($b)){throw "+this.err_name+"}")),de.add(Z);var R=new $Node;new $NodeJSCtx(R,"finally"),R.C.type="single_kw",R.C.token="finally",R.C.in_ctx_manager=!0,R.is_except=!0,R.in_ctx_manager=!0,A="if("+this.exc_name,A+="){"+this.cmexit_name+"(_b_.None, _b_.None, _b_.None);","generator"==this.scope.ntype&&(A+="delete "+this.cmexit_name),R.add($NodeJS(A+="};")),n.parent.insert(o+2,R),this.transformed=!0}},$WithCtx.prototype.transform_async=function(n,o){$get_scope(this);var l=this.tree[0],x=this.tree[0].alias,B=[],D=this.num=$loop_num++;this.cm_name="$ctx_manager"+D,this.cmexit_name="$ctx_manager_exit"+D,this.exc_name="$exc"+D;var G="$ctx_mgr_type"+D,M="$ctx_manager_enter"+D,P="$err"+D,de="var "+this.cm_name+" = "+l.to_js()+",";if(B.push($NodeJS(de)),B.push($NodeJS("    "+G+" = _b_.type.$factory("+this.cm_name+"),")),B.push($NodeJS("    "+this.cmexit_name+" = $B.$call($B.$getattr("+G+', "__aexit__")),')),B.push($NodeJS("    "+M+" = $B.$call($B.$getattr("+G+', "__aenter__"))('+this.cm_name+"),")),B.push($NodeJS("    "+this.exc_name+" = false")),de="",x)if("list_or_tuple"!=x.tree[0].tree[0].type)de=x.tree[0].to_js()+" = await ($B.promise("+M+"))",B.push($NodeJS(de));else{var ye=new $Node,ie=new $NodeCtx(ye);(l=new $ExprCtx(ie,"left",!1)).tree.push(x.tree[0].tree[0]),x.tree[0].tree[0].parent=l;var ce=new $AssignCtx(l);new $RawJSCtx(ce,"await ($B.promise("+M+"))"),B.push(ye)}else B.push($NodeJS("await ($B.promise("+M+"))"));var fe=new $NodeJS("try");n.children.forEach(function(R){fe.add(R)}),B.push(fe);var ae=new $NodeJS("catch(err)");B.push(ae),ae.add($NodeJS(this.exc_name+" = true")),ae.add($NodeJS("var "+P+' = $B.imported["_sys"].exc_info()'));var W=$NodeJS("if(! await ($B.promise("+this.cmexit_name+"("+this.cm_name+", "+P+"[0], "+P+"[1], "+P+"[2]))))");ae.add(W),W.add($NodeJS("$B.$raise()"));var Z=$NodeJS("if(! "+this.exc_name+")");B.push(Z),Z.add($NodeJS("await ($B.promise("+this.cmexit_name+"("+this.cm_name+", _b_.None, _b_.None, _b_.None)))")),n.parent.children.splice(o,1);for(var A=B.length-1;A>=0;A--)n.parent.insert(o,B[A]);return n.children=[],0},$WithCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_node(this).indent,o=" ".repeat(n),l=this.num,x=""==this.prefix?"var ":this.prefix,B="$ctx_manager"+l,D=x+"$ctx_manager_exit"+l,G=x+"$exc"+l,M="$value"+l;return"var "+B+" = "+this.tree[0].to_js()+"\n"+o+D+" = $B.$getattr("+B+',"__exit__")\n'+o+"var "+M+" = $B.$getattr("+B+',"__enter__")()\n'+o+G+" = true\n"};var $YieldCtx=$B.parser.$YieldCtx=function(n,o){this.type="yield",this.parent=n,this.tree=[],this.is_await=o,n.tree[n.tree.length]=this,"list_or_tuple"==n.type&&n.tree.length>1&&$_SyntaxError(n,"non-parenthesized yield"),$parent_match(n,{type:"annotation"})&&$_SyntaxError(n,["'yield' outside function"]);for(var l=this;;){var x=$parent_match(l,{type:"list_or_tuple"});if(!x)break;x.yields=x.yields||[],x.yields.push([this,$pos]),l=x}for(l=this;;){var B=$parent_match(l,{type:"dict_or_set"});if(!B)break;B.yields=B.yields||[],B.yields.push([this,$pos]),l=B}var D=$get_module(this);D.yields_func_check=D.yields_func_check||[],D.yields_func_check.push([this,$pos]);var G=this.scope=$get_scope(this,!0),M=$get_node(this);M.has_yield=this;var P=$parent_match(this,{type:"comprehension"});if($get_scope(this).id.startsWith("lc"+$B.lambda_magic)&&delete M.has_yield,P){var de=P.tree[0].tree[1];for(l=n;l&&l!==de;)l=l.parent;l||$_SyntaxError(n,["'yield' inside list comprehension"])}var ye=!1;for(l=n;l;){if("lambda"==l.type){ye=!0,this.in_lambda=!0;break}l=l.parent}for(l=M.parent;l;){if(l.C&&l.C.tree.length>0&&"with"==l.C.tree[0].type){G.C.tree[0].$has_yield_in_cm=!0;break}l=l.parent}if(!ye)switch(n.type){case"node":case"assign":case"list_or_tuple":break;default:$_SyntaxError(n,"yield atom must be inside ()")}};$YieldCtx.prototype.toString=function(){return"(yield) "+(this.from?"(from) ":"")+this.tree},$YieldCtx.prototype.transition=function(n,o){var l=this;return"from"==n?("abstract_expr"!=l.tree[0].type&&$_SyntaxError(l,"'from' must follow 'yield'"),l.from=!0,l.from_num=$B.UUID(),l.tree[0]):$transition(l.parent,n)},$YieldCtx.prototype.transform=function(n,o){for(var l=n.parent;l;){if(void 0!==l.ctx_manager_num){n.parent.insert(o+1,$NodeJS("$top_frame[1].$has_yield_in_cm = true"));break}l=l.parent}},$YieldCtx.prototype.to_js=function(){return this.from?`_r${this.from_num}`:"yield "+$to_js(this.tree)},$YieldCtx.prototype.check_in_function=function(){if(!this.in_lambda){var n=$get_scope(this),o=n.is_function,l=n;if(!o&&n.is_comp){for(var x=n.parent_block;x.is_comp;)x=parent_block;o=x.is_function,l=x}o?this.is_await||(l.C.tree[0].type="generator"):$_SyntaxError(this.parent,["'yield' outside function"])}};var $add_line_num=$B.parser.$add_line_num=function(n,o,l){if("module"!=n.type){if("marker"!==n.type){for(var x=n.C.tree[0],B=1,D=!0,G=n;void 0!==G.parent;)G=G.parent;var P=n.line_num;if(void 0===P&&(D=!1),("condition"==x.type&&"elif"==x.token||"except"==x.type||"single_kw"==x.type)&&(D=!1),D){var de=';$locals.$line_info = "'+(void 0===l?P+","+G.id:l)+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;',ye=new $Node;ye.is_line_num=!0,new $NodeJSCtx(ye,de),n.parent.insert(o,ye),B=2}for(ie=0;ie<n.children.length;)ie+=$add_line_num(n.children[ie],ie,l);return B}return 1}for(var ie=0;ie<n.children.length;)ie+=$add_line_num(n.children[ie],ie,l)},$bind=$B.parser.$bind=function(n,o,l){if(!o.nonlocals||!o.nonlocals[n])if(o.globals&&o.globals.has(n))$get_module(l).binding[n]=!0;else{if(!l.no_bindings){var x=$get_node(l);x.bindings=x.bindings||{},x.bindings[n]=!0}o.binding=o.binding||{},void 0===o.binding[n]&&(o.binding[n]=!0)}};function $parent_match(n,o){for(var l;n.parent;){for(var x in l=!0,o)if(n.parent[x]!=o[x]){l=!1;break}if(l)return n.parent;n=n.parent}return!1}var $previous=$B.parser.$previous=function(n){var o=n.node.parent.children[n.node.parent.children.length-2];return o&&o.C||$_SyntaxError(n,"keyword not following correct keyword"),o.C.tree[0]},$get_docstring=$B.parser.$get_docstring=function(n){var o="";if(n.children.length>0){var l=n.children[0];if(l.C.tree&&l.C.tree.length>0&&"expr"==l.C.tree[0].type){var x=l.C.tree[0].tree[0];"str"!=x.type||Array.isArray(x.tree[0])||(o=l.C.tree[0].tree[0].to_js())}}return o},$get_scope=$B.parser.$get_scope=function(n,o){for(var l=n.parent;"node"!==l.type;)l=l.parent;for(var x=l.node,B=null;x.parent&&"module"!==x.parent.type;){var D=x.parent.C.tree[0].type;switch(D){case"def":case"class":case"generator":return(B=x.parent).ntype=D,B.is_function="class"!=D,B}x=x.parent}return(B=x.parent||x).ntype="module",B},$get_line_num=$B.parser.$get_line_num=function(n){var o=$get_node(n),l=o.line_num;if(void 0===o.line_num){for(o=o.parent;o&&void 0===o.line_num;)o=o.parent;o&&o.line_num&&(l=o.line_num)}return l},$get_module=$B.parser.$get_module=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node;if("module"==l.ntype)return l;for(var x=null;"module"!=l.parent.type;)l=l.parent;return(x=l.parent).ntype="module",x},$get_src=$B.parser.$get_src=function(n){for(var o=$get_node(n);void 0!==o.parent;)o=o.parent;return o.src},$get_node=$B.parser.$get_node=function(n){for(var o=n;o.parent;)o=o.parent;return o.node},$to_js_map=$B.parser.$to_js_map=function(n){if(void 0!==n.to_js)return n.to_js();throw Error("no to_js() for "+n)},$to_js=$B.parser.$to_js=function(n,o){return void 0===o&&(o=","),n.map($to_js_map).join(o)},$mangle=$B.parser.$mangle=function(n,o){if("__"!=n.substr(0,2)||"__"===n.substr(n.length-2))return n;for(var l=$get_scope(o);;){if("module"==l.ntype)return n;if("class"==l.ntype){for(var x=l.C.tree[0].name;"_"==x.charAt(0);)x=x.substr(1);return"_"+x+n}if(!l.parent||!l.parent.C)return n;l=$get_scope(l.C.tree[0])}},$transition=$B.parser.$transition=function(n,o,l){return n.transition(o,l)};$B.forbidden=["alert","arguments","case","catch","const","constructor","Date","debugger","delete","default","do","document","enum","export","eval","extends","Error","history","function","instanceof","keys","length","location","Math","message","new","null","Number","RegExp","String","super","switch","this","throw","typeof","var","window","toLocaleString","toString","void"],$B.aliased_names=$B.list2obj($B.forbidden);for(var s_escaped="abfnrtvxuU\"0123456789'\\",is_escaped={},i=0;i<s_escaped.length;i++)is_escaped[s_escaped.charAt(i)]=!0;var $tokenize=$B.parser.$tokenize=function(root,src){for(var br_close={")":"(","]":"[","}":"{"},br_stack="",br_pos=[],kwdict=["class","return","break","for","lambda","try","finally","raise","def","from","nonlocal","while","del","global","with","as","elif","else","if","yield","assert","import","except","raise","in","pass","with","continue","__debugger__","async","await"],unsupported=[],$indented=["class","def","for","condition","single_kw","try","except","with"],int_pattern=/^(\d[0-9_]*)(j|J)?/,float_pattern1=/^(\d[\d_]*)\.(\d+(_\d+)*)?([eE][+-]?\d+(_\d+)*)?(j|J)?/,float_pattern2=/^(\d[\d_]*)([eE][+-]?\d+(_\d+)*)(j|J)?/,hex_pattern=/^0[xX]([\da-fA-F_]+)/,octal_pattern=/^0[oO]([0-7_]+)/,binary_pattern=/^0[bB]([01_]+)/,C=null,new_node=new $Node,current=root,name="",_type=null,pos=0,indent=null,string_modifier=!1,module=root.module,lnum=root.line_num||1;pos<src.length;){function rmuf(n){return(n.search("__")>-1||n.endsWith("_"))&&$_SyntaxError(C,"invalid literal"),n.replace(/_/g,"")}function check_int(n){if(rmuf(n),n.startsWith("0")){if(!(n.substr(1).search(/[^0_]/)>-1))return"0";$_SyntaxError(C,"invalid literal")}}function rmu(n){return n.replace(/_/g,"")}var car=src.charAt(pos);if(null!==indent)if("#"!=car)if('"'!=car&&"'"!=car){if(""==name&&"$"!=car){if($B.unicode_tables.XID_Start[car.charCodeAt(0)]){name=car;var p0=pos;for(pos++;pos<src.length&&$B.unicode_tables.XID_Continue[src.charCodeAt(pos)];)name+=src.charAt(pos),pos++}if(name){if(kwdict.indexOf(name)>-1)$pos=pos-name.length,unsupported.indexOf(name)>-1&&$_SyntaxError(C,"Unsupported Python keyword '"+name+"'"),C=$transition(C,name);else if("string"==typeof $operators[name]&&-1==["is_not","not_in"].indexOf(name))if("is"==name){var re=/^\s+not\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","is_not")):($pos=pos-name.length,C=$transition(C,"op",name))}else if("not"==name){var re=/^\s+in\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","not_in")):($pos=pos-name.length,C=$transition(C,name))}else $pos=pos-name.length,C=$transition(C,"op",name);else{if(('"'==src.charAt(pos)||"'"==src.charAt(pos))&&-1!==["r","b","u","rb","br","f","fr","rf"].indexOf(name.toLowerCase())){string_modifier=name.toLowerCase(),name="";continue}$B.forbidden.indexOf(name)>-1&&(name="$$"+name),$pos=pos-name.length,C=$transition(C,"id",name)}name="";continue}}switch(car){case" ":case"\t":pos++;break;case".":if(pos<src.length-1&&/^\d$/.test(src.charAt(pos+1))){for(var j=pos+1;j<src.length&&src.charAt(j).search(/\d|e|E|_/)>-1;)j++;"j"==src.charAt(j)?(C=$transition(C,"imaginary","0"+rmu(src.substr(pos,j-pos))),j++):C=$transition(C,"float","0"+rmu(src.substr(pos,j-pos))),pos=j;break}$pos=pos,C=$transition(C,"."),pos++;break;case"0":var res=hex_pattern.exec(src.substr(pos));if(res){rmuf(res[1]),C=$transition(C,"int",[16,rmu(res[1])]),pos+=res[0].length;break}var res=octal_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[8,rmuf(res[1])]),pos+=res[0].length;break}var res=binary_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[2,rmuf(res[1])]),pos+=res[0].length;break}if(src.charAt(pos+1).search(/\d/)>-1){if(0===parseInt(src.substr(pos))){res=int_pattern.exec(src.substr(pos)),$pos=pos,check_int(res[0]),C=$transition(C,"int",[10,rmu(res[0])]),pos+=res[0].length;break}$_SyntaxError(C,"invalid literal starting with 0")}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var res=float_pattern1.exec(src.substr(pos));res?(check_int(res[1]),res[2]&&rmuf(res[2]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=float_pattern2.exec(src.substr(pos)),res?(check_int(res[1]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=int_pattern.exec(src.substr(pos)),check_int(res[1]),$pos=pos,C=void 0!==res[2]?$transition(C,"imaginary",rmu(res[1])):$transition(C,"int",[10,rmu(res[0])]))),pos+=res[0].length;break;case"\n":lnum++,br_stack.length>0||(current.C.tree.length>0||current.C.async?($pos=pos,C=$transition(C,"eol"),indent=null,new_node=new $Node):new_node.line_num=lnum),pos++;break;case"(":case"[":case"{":br_stack+=car,br_pos[br_stack.length-1]=[C,pos],$pos=pos,C=$transition(C,car),pos++;break;case")":case"]":case"}":""==br_stack?($pos=pos,$_SyntaxError(C,"Unexpected closing bracket")):br_close[car]!=br_stack.charAt(br_stack.length-1)?($pos=pos,$_SyntaxError(C,"Unbalanced bracket")):(br_stack=br_stack.substr(0,br_stack.length-1),$pos=pos,C=$transition(C,car),pos++);break;case"=":"="!=src.charAt(pos+1)?($pos=pos,C=$transition(C,"="),pos++):($pos=pos,C=$transition(C,"op","=="),pos+=2);break;case",":case":":$pos=pos,":="==src.substr(pos,2)?(C=$transition(C,":="),pos++):C=$transition(C,car),pos++;break;case";":$transition(C,"eol"),0==current.C.tree.length&&($pos=pos,$_SyntaxError(C,"invalid syntax"));for(var pos1=pos+1,ends_line=!1;pos1<src.length;){var _s=src.charAt(pos1);if("\n"==_s||"#"==_s){ends_line=!0;break}if(" "!=_s)break;pos1++}if(ends_line){pos++;break}new_node=new $Node,new_node.indent=$get_node(C).indent,new_node.line_num=lnum,new_node.module=module,$get_node(C).parent.add(new_node),current=new_node,C=new $NodeCtx(new_node),pos++;break;case"/":case"%":case"&":case">":case"<":case"-":case"+":case"*":case"@":case"/":case"^":case"=":case"|":case"~":case"!":if("-"==car&&">"==src.charAt(pos+1)){C=$transition(C,"annotation"),pos+=2;continue}if("@"==car&&"node"==C.type){$pos=pos,C=$transition(C,car),pos++;break}var op_match="";for(var op_sign in $operators)op_sign==src.substr(pos,op_sign.length)&&op_sign.length>op_match.length&&(op_match=op_sign);$pos=pos,op_match.length>0?(C=$transition(C,op_match in $augmented_assigns?"augm_assign":"op",op_match),pos+=op_match.length):$_SyntaxError(C,"invalid character: "+car);break;case"\\":if("\n"==src.charAt(pos+1)){lnum++,pos+=2,pos==src.length?$_SyntaxError(C,["unexpected EOF while parsing"]):"node"==C.type&&$_SyntaxError(C,"nothing before \\");break}$pos=pos,$_SyntaxError(C,["unexpected character after line continuation character"]);case String.fromCharCode(12):pos+=1;break;default:$pos=pos,$_SyntaxError(C,"unknown token ["+car+"]")}}else{var raw="str"==C.type&&C.raw,bytes=!1,fstring=!1,sm_length,end=null;if(string_modifier){switch(string_modifier){case"r":raw=!0;break;case"u":break;case"b":bytes=!0;break;case"rb":case"br":bytes=!0,raw=!0;break;case"f":fstring=!0,sm_length=1;break;case"rf":fstring=!0,sm_length=2,raw=!0}string_modifier=!1}src.substr(pos,3)==car+car+car?(_type="triple_string",end=pos+3):(_type="string",end=pos+1);for(var escaped=!1,zone=car,found=!1;end<src.length;)if(escaped)"a"==src.charAt(end)?zone=zone.substr(0,zone.length-1)+"\x07":(zone+=src.charAt(end),raw&&"\\"==src.charAt(end)&&(zone+="\\")),escaped=!1,end++;else if("\\"==src.charAt(end))if(raw)end<src.length-1&&src.charAt(end+1)==car?(zone+="\\\\"+car,end+=2):(zone+="\\\\",end++),escaped=!0;else if("\n"==src.charAt(end+1))end+=2,lnum++;else if("N{"==src.substr(end+1,2)){var end_lit=end+3,re=new RegExp("[-a-zA-Z0-9 ]+"),search=re.exec(src.substr(end_lit));null===search&&$_SyntaxError(C,"(unicode error) malformed \\N character escape",pos);var end_lit=end_lit+search[0].length;"}"!=src.charAt(end_lit)&&$_SyntaxError(C,"(unicode error) malformed \\N character escape");var description=search[0].toUpperCase();if(void 0===$B.unicodedb){var xhr=new XMLHttpRequest;xhr.open("GET",$B.brython_path+"unicode.txt",!1),xhr.onreadystatechange=function(){4==this.readyState&&(200==this.status?$B.unicodedb=this.responseText:console.log("Warning - could not load unicode.txt"))},xhr.send()}if(void 0!==$B.unicodedb){var re=new RegExp("^([0-9A-F]+);"+description+";.*$","m");search=re.exec($B.unicodedb),null===search&&$_SyntaxError(C,"(unicode error) unknown Unicode character name");var cp="0x"+search[1];zone+=String.fromCodePoint(eval(cp)),end=end_lit+1}else end++}else end<src.length-1&&void 0===is_escaped[src.charAt(end+1)]&&(zone+="\\"),zone+="\\",escaped=!0,end++;else if("\n"==src.charAt(end)&&"triple_string"!=_type)console.log(pos,end,src.substring(pos,end)),$pos=end,$_SyntaxError(C,["EOL while scanning string literal"]);else if(src.charAt(end)==car){if("triple_string"!=_type||src.substr(end,3)==car+car+car){found=!0,$pos=pos;for(var $string=zone.substr(1),string="",i=0;i<$string.length;i++){var $car=$string.charAt(i);$car!=car||!raw&&0!=i&&"\\"==$string.charAt(i-1)||(string+="\\"),string+=$car}if(fstring)try{var re=new RegExp("\\\\"+car,"g"),string_no_bs=string.replace(re,car),elts=$B.parse_fstring(string_no_bs)}catch(n){$_SyntaxError(C,[n.toString()])}bytes?C=$transition(C,"str","b"+car+string+car):fstring?($pos-=sm_length,C=$transition(C,"str",elts),$pos+=sm_length):C=$transition(C,"str",car+string+car),C.raw=raw,pos=end+1,"triple_string"==_type&&(pos=end+3);break}zone+=src.charAt(end),end++}else zone+=src.charAt(end),"\n"==src.charAt(end)&&lnum++,end++;found||$_SyntaxError(C,"triple_string"===_type?"Triple string end not found":"String end not found")}else{var end=src.substr(pos+1).search("\n");-1==end&&(end=src.length-1),root.comments.push([pos,end]),pos+=end+1}else{for(var indent=0;pos<src.length;){var _s=src.charAt(pos);if(" "==_s)indent++,pos++;else{if("\t"!=_s)break;indent++,pos++,indent%8>0&&(indent+=8-indent%8)}}var _s=src.charAt(pos);if("\n"==_s){pos++,lnum++,indent=null;continue}if("#"==_s){var offset=src.substr(pos).search(/\n/);if(-1==offset)break;pos+=offset+1,lnum++,indent=null;continue}if(new_node.indent=indent,new_node.line_num=lnum,new_node.module=module,current.is_body_node&&(current.indent=indent),indent>current.indent)null!==C&&-1==$indented.indexOf(C.tree[0].type)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos)),current.add(new_node);else if(indent<=current.indent&&C&&C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1&&C.tree.length<2)$pos=pos,$_SyntaxError(C,"expected an indented block",pos);else{for(;indent!==current.indent;)current=current.parent,(void 0===current||indent>current.indent)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos));current.parent.add(new_node)}current=new_node,C=new $NodeCtx(new_node)}}if(0!=br_stack.length){var br_err=br_pos[0];$pos=br_err[1];var lines=src.split("\n"),id=root.id,fname=id.startsWith("$")?"<string>":id;$_SyntaxError(br_err[0],["unexpected EOF while parsing ("+fname+", line "+(lines.length-1)+")"])}if(null!==C){if("async"==C.type)throw console.log("error with async",pos,src,src.substr(pos)),$pos=pos-7,$_SyntaxError(C,"car "+car+"after async",pos);if(C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1)$pos=pos-1,$_SyntaxError(C,"expected an indented block",pos);else{var parent=current.parent;if(parent.C&&parent.C.tree&&parent.C.tree[0]&&"try"==parent.C.tree[0].type&&($pos=pos-1,$_SyntaxError(C,["unexpected EOF while parsing"])),root.yields_func_check){var save_pos=$pos;for(const n of root.yields_func_check)$pos=n[1],n[0].check_in_function();$pos=save_pos}}}},$create_root_node=$B.parser.$create_root_node=function(n,o,l,x,B){var D=new $Node("module");return D.module=o,D.id=l,D.binding={__doc__:!0,__name__:!0,__file__:!0,__package__:!0},D.parent_block=x,D.line_num=B,D.indent=-1,D.comments=[],D.imports={},"object"==typeof n&&(D.is_comp=n.is_comp,n.has_annotations&&(D.binding.__annotations__=!0),n=n.src),D.src=n,D};$B.py2js=function(n,o,l,x,B){if($pos=0,"object"==typeof o){var D=o.__package__;o=o.__name__}else D="";x=x||$B.builtins_scope;var G=(new Date).getTime(),M=!1,P=!0;if("object"==typeof n){M=n.is_comp,P=n.has_annotations;var de=n.line_info,ye=n.ix;void 0!==de&&(B=parseInt(de.split(",")[0])),n=n.src}(n=n.replace(/\r\n/gm,"\n")).endsWith("\\")&&!n.endsWith("\\\\")&&(n=n.substr(0,n.length-1)),"\n"!=n.charAt(n.length-1)&&(n+="\n"),Array.isArray(l)&&(l=l[0]),l.charAt(0);var ie="$locals_"+l.replace(/\./g,"_"),ce="$locals_"+o.replace(/\./g,"_"),fe=$create_root_node({src:n,is_comp:M,has_annotations:P},o,l,x,B);$tokenize(fe,n),fe.is_comp=M,null!=ye&&(fe.ix=ye),fe.transform();var ae=1;(A=["var $B = __BRYTHON__;\n"])[ae++]="var _b_ = __BRYTHON__.builtins;\n",A[2]="var $locals = "+ie,M&&(A[2]+=" = {}");var W=0;fe.insert(0,$NodeJS(A.join(""))),W++,fe.insert(W++,$NodeJS(ie+'.__package__ = "'+D+'"')),fe.binding.__annotations__&&fe.insert(W++,$NodeJS("$locals.__annotations__ = $B.empty_dict()"));var Z=W,A='var $top_frame = ["'+l.replace(/\./g,"_")+'", '+ie+', "'+o.replace(/\./g,"_")+'", '+ce+"]\n$locals.$f_trace = $B.enter_frame($top_frame)\nvar $stack_length = $B.frames_stack.length;";fe.insert(W++,$NodeJS(A));var R=new $NodeJS("try"),X=fe.children.slice(Z+1,fe.children.length);fe.insert(Z+1,R),0==X.length&&(X=[$NodeJS("")]),X.forEach(function(Re){R.add(Re)}),R.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),fe.children.splice(Z+2,fe.children.length);var he=$NodeJS("catch(err)");he.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),he.add($NodeJS("throw err")),fe.add(he),$add_line_num(fe,null,de);var U=(new Date).getTime();return $B.debug>2&&o==l&&console.log("module "+o+" translated in "+(U-G)+" ms"),$B.compile_time+=U-G,fe},$B.set_import_paths=function(){var n=[],o=[];$B.use_VFS&&n.push($B.finders.VFS),!1!==$B.$options.static_stdlib_import&&"file"!=$B.protocol&&(n.push($B.finders.stdlib_static),$B.path.length>3&&($B.path.shift(),$B.path.shift())),"file"!==$B.protocol&&(n.push($B.finders.path),o.push($B.$path_hooks[0])),$B.$options.cpython_import&&("replace"==$B.$options.cpython_import&&$B.path.pop(),n.push($B.finders.CPython)),$B.meta_path=n,$B.path_hooks=o};var brython=$B.parser.brython=function(n){void 0===n&&(n={debug:1}),"number"==typeof n&&(n={debug:n}),void 0===n.debug&&(n.debug=1),$B.debug=n.debug,_b_.__debug__=$B.debug>0,$B.compile_time=0,void 0===n.profile&&(n.profile=0),$B.profile=n.profile,void 0===n.indexedDB&&(n.indexedDB=!0),void 0===n.static_stdlib_import&&(n.static_stdlib_import=!0),$B.static_stdlib_import=n.static_stdlib_import,$B.$options=n,$B.set_import_paths();var o=($B.script_path=_window.location.href).split("/");if(o.pop(),($B.isWebWorker||$B.isNode)&&o.pop(),$B.curdir=o.join("/"),void 0!==n.pythonpath&&($B.path=n.pythonpath,$B.$options.static_stdlib_import=!1),n.python_paths&&n.python_paths.forEach(function(P){var de,ye;"string"!=typeof P&&(de=P.lang,ye=P.prefetch,P=P.path),$B.path.push(P),".vfs.js"!=P.slice(-7).toLowerCase()||void 0!==ye&&!0!==ye||($B.path_importer_cache[P+"/"]=$B.imported._importlib.VFSPathFinder(P)),de&&B.optimize_import_for_path(P,de)}),!$B.isWebWorker&&!$B.isNode)for(var l,x=document.querySelectorAll("head link[rel~=pythonpath]"),B=$B.imported._importlib,D=0;l=x[D];++D){var G=l.href;-1!=(" "+l.rel+" ").indexOf(" prepend ")?$B.path.unshift(G):$B.path.push(G);var M=l.hreflang;M&&("x-"==M.slice(0,2)&&(M=M.slice(2)),B.optimize_import_for_path(l.href,M))}$B.__ARGV=$B.$options.args?$B.$options.args:_b_.list.$factory([]),$B.isWebWorker||$B.isNode||_run_scripts(n)};$B.run_script=function(n,o,l){$B.$py_module_path[o]=$B.script_path;try{var x=$B.py2js(n,o,o),B=x.to_js(),D={__doc__:x.__doc__,js:B,__name__:o,$src:n,__file__:$B.script_path+($B.script_path.endsWith("/")?"":"/")+o};$B.file_cache[D.__file__]=n,$B.debug>1&&console.log(B)}catch(P){$B.handle_error(P)}if($B.hasOwnProperty("VFS")&&$B.has_indexedDB){var G=Object.keys(x.imports).slice().filter(function(P){return $B.VFS.hasOwnProperty(P)});Object.keys(G).forEach(function(P){if($B.VFS.hasOwnProperty(P)){var de=$B.VFS[P],ye=de[0];if(".py"==ye){var ie=de[2];".py"==ye&&required_stdlib_imports(ie),ie.forEach(function(ce){-1==G.indexOf(ce)&&G.push(ce)})}}});for(var M=0;M<G.length;M++)$B.tasks.push([$B.inImported,G[M]]);x=null}$B.tasks.push(["execute",D]),l&&$B.loop()};var $log=$B.$log=function(n){n.split("\n").forEach(function(o,l){console.log(l+1,":",o)})},_run_scripts=$B.parser._run_scripts=function(options){var kk=Object.keys(_window),defined_ids={};if(void 0!==options.ipy_id){var $elts=[];options.ipy_id.forEach(function(n){$elts.push(document.getElementById(n))})}else for(var scripts=document.getElementsByTagName("script"),$elts=[],webworkers=[],i=0;i<scripts.length;i++){var script=scripts[i];if("text/python"==script.type||"text/python3"==script.type)if("webworker"==script.className){if(void 0===script.id)throw _b_.AttributeError.$factory("webworker script has no attribute 'id'");webworkers.push(script)}else $elts.push(script)}var first_script=!0,module_name;if(void 0!==options.ipy_id){module_name="__main__";var $src="",js,root;$B.$py_module_path[module_name]=$B.script_path,$elts.forEach(function(n){$src+=n.innerHTML||n.textContent});try{root=$B.py2js($src,module_name,module_name),js=root.to_js(),$B.debug>1&&$log(js),eval(js),$B.clear_ns(module_name),root=null,js=null}catch(n){if(root=null,js=null,console.log(n),$B.debug>1)for(var attr in console.log(n),n)console.log(attr+" : ",n[attr]);void 0===n.$py_error&&(console.log("Javascript error",n),n=_b_.RuntimeError.$factory(n+""));var $trace=$B.$getattr(n,"info")+"\n"+n.__name__+": "+n.args;try{$B.$getattr($B.stderr,"write")($trace)}catch{console.log($trace)}throw n}}else{$elts.length>0&&options.indexedDB&&$B.has_indexedDB&&$B.hasOwnProperty("VFS")&&$B.tasks.push([$B.idb_open]);for(var i=0;i<$elts.length;i++){var elt=$elts[i];if(elt.id){if(defined_ids[elt.id])throw Error("Brython error : Found 2 scripts with the same id '"+elt.id+"'");defined_ids[elt.id]=!0}}for(var src,i=0,len=webworkers.length;i<len;i++){var worker=webworkers[i];worker.src?$B.tasks.push([$B.ajax_load_script,{name:worker.id,url:worker.src,is_ww:!0}]):(src=worker.innerHTML||worker.textContent,src=src.replace(/^\n/,""),$B.webworkers[worker.id]=src)}for(var i=0;i<$elts.length;i++){var elt=$elts[i];if("text/python"==elt.type||"text/python3"==elt.type){if(elt.id)module_name=elt.id;else for(first_script?(module_name="__main__",first_script=!1):module_name="__main__"+$B.UUID();void 0!==defined_ids[module_name];)module_name="__main__"+$B.UUID();elt.src?$B.tasks.push([$B.ajax_load_script,{name:module_name,url:elt.src}]):(src=elt.innerHTML||elt.textContent,src=src.replace(/^\n/,""),$B.run_script(src,module_name))}}}void 0===options.ipy_id&&$B.loop()};$B.$operators=$operators,$B.$Node=$Node,$B.$NodeJSCtx=$NodeJSCtx,$B.brython=brython}(__BRYTHON__);var brython=__BRYTHON__.brython;__BRYTHON__.isNode&&(__webpack_require__.g.__BRYTHON__=__BRYTHON__,module.exports={__BRYTHON__}),function(n){var o=n.builtins;function l(G,M,P,de,ye){var ie=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules"),ce=(ie.openCursor(),{name:G,content:M,imports:de,origin,timestamp:__BRYTHON__.timestamp,source_ts:P,is_package:ye}),fe=ie.put(ce);n.debug>1&&console.log("store precompiled",G,"package",ye),document.dispatchEvent(new CustomEvent("precompile",{detail:"cache module "+G}));var ae=n.outdated.indexOf(G);ae>-1&&n.outdated.splice(ae,1),fe.onsuccess=function(W){n.tasks.splice(0,0,[x,G]),D()}}function x(G){var M=n.idb_cx.result.transaction("modules","readonly");try{var P=M.objectStore("modules");req=P.get(G),req.onsuccess=function(de){!function(ye,ie){var ce=ye.target.result;if(void 0===ce||ce.timestamp!=n.timestamp||n.VFS[ie]&&ce.source_ts!==n.VFS[ie].timestamp){if(void 0!==n.VFS[ie]){var fe=(Ge=n.VFS[ie])[0],ae=Ge[1];if(".py"==fe){var W,Z,A=Ge[2],R=4==Ge.length,X=Ge.timestamp;R?W=ie:((Z=ie.split(".")).pop(),W=Z.join(".")),n.imported[ie]=n.module.$factory(ie,"",W);try{var he=n.py2js(ae,ie,ie).to_js()}catch(Xe){n.handle_error(Xe)}delete n.imported[ie],n.debug>1&&console.log("precompile",ie),(Z=ie.split(".")).length>1&&Z.pop(),n.stdlib.hasOwnProperty(Z.join("."))&&(A=(A=Ge[2]).join(","),n.tasks.splice(0,0,[l,ie,he,X,A,R]))}else console.log("bizarre",ie,fe)}}else if(n.precompiled[ie]=ce.is_package?[ce.content]:ce.content,ce.imports.length>0){n.debug>1&&console.log(ie,"imports",ce.imports);for(var U=ce.imports.split(","),Re=0;Re<U.length;Re++){var Q=U[Re];if(Q.startsWith(".")){for(var be=ie.split("."),Pe=0;Q.startsWith(".");)Pe++,Q=Q.substr(1);var Ge=be.slice(0,Pe);Q&&(Ge=Ge.concat([Q])),Q=Ge.join(".")}if(!n.imported.hasOwnProperty(Q)&&!n.precompiled.hasOwnProperty(Q)&&n.VFS.hasOwnProperty(Q)){var Ae=n.VFS[Q];fe=Ae[0],ae=Ae[1],".py"==Ae[0]?n.tasks.splice(0,0,[x,Q]):B(Q,ae)}}}D()}(de,G)}}catch(de){console.info("error",de)}}function B(G,M){M+="\nvar $locals_"+G.replace(/\./g,"_")+" = $module",n.precompiled[G]=M}n.VFS_timestamp&&n.VFS_timestamp>n.timestamp&&(n.timestamp=n.VFS_timestamp),n.idb_open=function(G){n.idb_name="brython-cache";var M=n.idb_cx=indexedDB.open(n.idb_name);M.onsuccess=function(){var P=M.result;if(P.objectStoreNames.contains("modules")){n.debug>1&&console.info("using indexedDB for stdlib modules cache");var de,ye=P.transaction("modules","readwrite").objectStore("modules"),ie=[],ce=ye.openCursor();ce.onerror=function(ae){console.log("open cursor error",ae)},ce.onsuccess=function(ae){cursor=ae.target.result,cursor?((de=cursor.value).timestamp==n.timestamp?n.VFS&&n.VFS[de.name]&&n.VFS[de.name].timestamp!=de.source_ts?ie.push(de.name):(n.precompiled[de.name]=de.is_package?[de.content]:de.content,n.debug>1&&console.info("load from cache",de.name)):ie.push(de.name),cursor.continue()):(n.debug>1&&console.log("done"),n.outdated=ie,D())}}else{var fe=P.version;P.close(),console.info("create object store",fe),(M=indexedDB.open(n.idb_name,fe+1)).onupgradeneeded=function(){console.info("upgrade needed"),n.idb_cx.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onversionchanged=function(){console.log("version changed")},M.onsuccess=function(){console.info("db opened",M),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D}}},M.onupgradeneeded=function(){console.info("upgrade needed"),M.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=D},M.onerror=function(){console.info("could not open indexedDB database"),n.idb_cx=null,n.idb_name=null,n.$options.indexedDB=!1,D()}},n.ajax_load_script=function(G){var M=G.url,P=G.name;if(n.files&&n.files.hasOwnProperty(P))n.tasks.splice(0,0,[n.run_script,n.files[P],P,!0]);else{if("file"==n.protocol)throw o.IOError.$factory("can't load external script at "+G.url+" (Ajax calls not supported with protocol file:///)");var de=new XMLHttpRequest,ye=n.$options.cache?"":(M.search(/\?/)>-1?"&":"?")+Date.now();de.open("GET",M+ye,!0),de.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var ie=this.responseText;G.is_ww?n.webworkers[P]=ie:n.tasks.splice(0,0,[n.run_script,ie,P,!0]),D()}else if(404==this.status)throw Error(M+" not found")},de.send()}},n.inImported=function(G){if(!n.imported.hasOwnProperty(G))if(__BRYTHON__.VFS&&__BRYTHON__.VFS.hasOwnProperty(G)){var M=__BRYTHON__.VFS[G];void 0===M&&console.log("bizarre",G);var de=M[1];".py"==M[0]?n.idb_cx&&!n.idb_cx.$closed&&n.tasks.splice(0,0,[x,G]):B(G,de)}else console.log("bizarre",G);D()};var D=n.loop=function(){if(0!=n.tasks.length){var G=n.tasks.shift(),M=G[0],P=G.slice(1);if("execute"==M){try{var de=G[1],ye=de.__name__.replace(/\./g,"_");(ce=n.module.$factory(de.__name__)).$src=de.$src,ce.__file__=de.__file__,n.imported[ye]=ce,new Function("$locals_"+ye,de.js)(ce)}catch(fe){void 0===fe.__class__&&(console.log("Javascript error",fe),n.is_recursion_error(fe)?fe=o.RecursionError.$factory("too much recursion"):(n.print_stack(),fe=o.RuntimeError.$factory(fe+""))),n.debug>1&&(console.log("handle error",fe.__class__,fe.args,fe.$stack),console.log(n.frames_stack.slice())),n.handle_error(fe)}D()}else try{M.apply(null,P)}catch(fe){n.handle_error(fe)}}else if(n.idb_cx&&!n.idb_cx.$closed){for(var ie=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules");n.outdated.length>0;){var ce=n.outdated.pop();ie.delete(ce).onsuccess=function(fe){n.debug>1&&console.info("delete outdated",ce),document.dispatchEvent(new CustomEvent("precompile",{detail:"remove outdated "+ce+" from cache"}))}}document.dispatchEvent(new CustomEvent("precompile",{detail:"close"})),n.idb_cx.result.close(),n.idb_cx.$closed=!0}};n.tasks=[],n.has_indexedDB=void 0!==self.indexedDB,n.handle_error=function(G){if(n.debug>1&&console.log("handle error",G.__class__,G.args),void 0!==G.__class__){var M=n.class_name(G),P=n.$getattr(G,"info");"SyntaxError"==M||"IndentationError"==M?P+="\n    "+" ".repeat(G.args[3])+"^\n"+M+": "+G.args[0]:(P+="\n"+M,G.args[0]&&G.args[0]!==o.None&&(P+=": "+o.str.$factory(G.args[0])))}else console.log(G),P=G+"";try{n.$getattr(n.stderr,"write")(P);try{n.$getattr(n.stderr,"flush")()}catch(ye){console.log(ye)}}catch{console.log(P)}throw G}}(__BRYTHON__),__BRYTHON__.builtins.object=function(n){var o=n.builtins,l={$infos:{__name__:"object"},$is_class:!0,$native:!0};function x(B){return n.$getattr(B,"__new__").apply(null,arguments)}return l.__delattr__=function(B,D){if(D=n.from_alias(D),B.__dict__&&B.__dict__.$string_dict&&void 0!==B.__dict__.$string_dict[D])return delete B.__dict__.$string_dict[D],o.None;if(void 0===B.__dict__&&void 0!==B[D])return delete B[D],o.None;var G=B.__class__;if(G){var M=n.$getattr(G,D);if(M.__class__===o.property&&void 0!==M.__delete__)return M.__delete__(B),o.None}throw o.AttributeError.$factory(D)},l.__dir__=function(B){var D;if(B.$is_class)D=[B].concat(B.__mro__);else{var G=B.__class__||n.get_class(B);D=[B,G].concat(G.__mro__)}for(var M=[],P=0,de=D.length;P<de;P++)for(var ye in D[P])"$"!=ye.charAt(0)?isNaN(parseInt(ye.charAt(0)))&&"__mro__"!=ye&&M.push(ye):"$"==ye.charAt(1)&&M.push(ye.substr(2));if(B.__dict__)for(var ye in B.__dict__.$string_dict)"$$"==ye.substr(0,2)?M.push(ye.substr(2)):"$"!=ye.charAt(0)&&M.push(ye);return M=o.list.$factory(o.set.$factory(M)),o.list.sort(M),M},l.__eq__=function(B,D){return B===D||o.NotImplemented},l.__format__=function(){var B=n.args("__format__",2,{self:null,spec:null},["self","spec"],arguments,{},null,null);if(""!==B.spec)throw o.TypeError.$factory("non-empty format string passed to object.__format__");return o.getattr(B.self,"__str__")()},l.__ge__=function(){return o.NotImplemented},l.__getattribute__=function(B,D){var G=B.__class__||n.get_class(B),M=!1;if("__class__"===D)return G;var P=B[D];if(Array.isArray(B)&&void 0!==Array.prototype[D]&&(P=void 0),void 0===P&&B.__dict__){var de=B.__dict__;if(de.$string_dict.hasOwnProperty(D))return de.$string_dict[D][0]}if(void 0===P){let he=function(U,Re,Q){var be=Re[Q];if(void 0!==be)return be};if(void 0===(P=he(0,G,D)))for(var ye=0,ie=(A=G.__mro__).length;ye<ie&&void 0===(P=he(0,A[ye],D));ye++);else P.__class__!==n.method&&void 0===P.__get__&&(M=!0)}else if(void 0===P.__set__)return P;if(void 0!==P){if(P.__class__===o.property)return P.__get__(P,B,G);if(P.__class__===n.method)return void 0===P.__get__&&console.log("bizarre",B,D,P),P.__get__(B,G);if(void 0===(ce=P.__get__)&&P.__class__){var ce=P.__class__.__get__;for(ye=0;ye<P.__class__.__mro__.length&&void 0===ce;ye++)ce=P.__class__.__mro__[ye].__get__}var fe=void 0===ce?null:n.$getattr(P,"__get__",null);if(null!==fe)try{return fe.apply(null,[B,G])}catch(he){throw console.log("error in get.apply",he),console.log("get attr",D,"of",B),console.log(fe+""),he}if("object"==typeof P&&fe&&"function"==typeof fe&&(get_func=function(he,U){return fe.apply(he,[U,G.$factory])}),null===fe&&"function"==typeof P&&(fe=function(he){return he}),null!==fe){P.__name__=D,"__new__"==D&&(P.$type="staticmethod");var ae=fe.apply(null,[P,B,G]);if("function"==typeof ae){if(ae.__class__===n.method||"staticmethod"==P.$type)return P;var W=P.__class__===n.method?G:B,Z=function(){for(var he=[W],U=0,Re=arguments.length;U<Re;U++)he.push(arguments[U]);return P.apply(this,he)};return Z.__class__=n.method,(Z.__get__=function(he,U){var Re=P.bind(null,U);return Re.__class__=n.method,Re.$infos={__self__:U,__func__:P,__name__:P.$infos.__name__,__qualname__:U.$infos.__name__+"."+P.$infos.__name__},Re}).__class__=n.method_wrapper,Z.__get__.$infos=P.$infos,void 0===G.$infos&&(console.log("no $infos",G),console.log(n.last(n.frames_stack))),Z.$infos={__self__:W,__func__:P,__name__:D,__qualname__:G.$infos.__name__+"."+D},M&&(B.$method_cache=B.$method_cache||{},B.$method_cache[D]=[Z,P]),Z}return ae}return P}var A,R=B.__getattr__;if(void 0===R&&void 0===(R=G.__getattr__))for(ye=0,ie=(A=G.__mro__).length;ye<ie&&void 0===(R=A[ye].__getattr__);ye++);if(void 0!==R)return G===n.module?R(D):R(B,D);throw o.AttributeError.$factory(D)},l.__gt__=function(){return o.NotImplemented},l.__hash__=function(B){var D=B.__hashvalue__;return void 0!==D?D:B.__hashvalue__=n.$py_next_hash--},l.__init__=function(){if(0==arguments.length)throw o.TypeError.$factory("descriptor '__init__' of 'object' object needs an argument");return o.None},l.__init_subclass__=function(){return n.args("__init_subclass__",0,{},[],arguments,{},null,null),o.None},l.__init_subclass__.$type="staticmethod",l.__le__=function(){return o.NotImplemented},l.__lt__=function(){return o.NotImplemented},l.__mro__=[],l.__new__=function(B,...D){if(void 0===B)throw o.TypeError.$factory("object.__new__(): not enough arguments");if(n.$getattr(B,"__init__")===l.__init__&&D.length>0)throw o.TypeError.$factory("object() takes no parameters");return{__class__:B,__dict__:n.empty_dict()}},l.__ne__=function(B,D){if(B===D)return!1;var G=n.$getattr(B,"__eq__",null);if(null!==G){var M=n.$call(G)(D);return M===o.NotImplemented?M:!n.$bool(M)}return o.NotImplemented},l.__reduce__=function(B){function D(de){return n.$call(de)()}D.$infos={__qualname__:"_reconstructor"};var G=[D];G.push(o.tuple.$factory([B.__class__].concat(B.__class__.__mro__)));var M=n.empty_dict();for(var P in B.__dict__.$string_dict)o.dict.$setitem(M.$string_dict,P,B.__dict__.$string_dict[P][0]);return console.log("object.__reduce__, d",M),G.push(M),o.tuple.$factory(G)},x.$infos={__name__:"__newobj__",__qualname__:"__newobj__"},o.__newobj__=x,l.__reduce_ex__=function(B){var D=[x],G=o.tuple.$factory([B.__class__]);Array.isArray(B)&&B.forEach(function(ye){G.push(ye)}),D.push(G);var M=n.empty_dict(),P=0;if(void 0===B.__dict__)throw o.TypeError.$factory("cannot pickle '"+n.class_name(B)+"' object");for(var de in B.__dict__.$string_dict)"__class__"==de||de.startsWith("$")||(o.dict.$setitem(M,de,B.__dict__.$string_dict[de][0]),P++);return 0==P&&(M=o.None),D.push(M),D.push(o.None),o.tuple.$factory(D)},l.__repr__=function(B){if(B===l)return"<class 'object'>";if(B.__class__===o.type)return"<class '"+B.__name__+"'>";var D=B.__class__.$infos.__module__;return void 0===D||D.startsWith("$")||"builtins"===D?"<"+n.class_name(B)+" object>":"<"+B.__class__.$infos.__module__+"."+n.class_name(B)+" object>"},l.__setattr__=function(B,D,G){if(void 0===G)throw o.TypeError.$factory("can't set attributes of built-in/extension type 'object'");if(B.__class__===l)throw o.AttributeError.$factory(void 0===l[D]?"'object' object has no attribute '"+D+"'":"'object' object attribute '"+D+"' is read-only");return n.aliased_names[D]&&(D="$$"+D),B.__dict__?o.dict.$setitem(B.__dict__,D,G):B[D]=G,o.None},l.__setattr__.__get__=function(B){return function(D,G){l.__setattr__(B,D,G)}},l.__setattr__.__str__=function(){return"method object.setattr"},l.__str__=function(B){var D=n.$getattr(B,"__repr__");return n.$call(D)()},l.__subclasshook__=function(){return o.NotImplemented},l.$factory=function(){var B={__class__:l},D=[B].concat(Array.prototype.slice.call(arguments));return l.__init__.apply(null,D),B},n.set_func_names(l,"builtins"),n.make_class=function(B,D){var G={__class__:o.type,__mro__:[l],$infos:{__name__:B},$is_class:!0};return G.$factory=D,G},l}(__BRYTHON__),function(n){var o=n.builtins;n.$class_constructor=function(M,P,de,ye,ie){var ce;de=de||[];var fe=P.__module__;void 0===fe&&(fe=P.__module__=n.last(n.frames_stack)[2]);for(var ae=0;ae<de.length;ae++)if(void 0===de[ae])throw n.line_info=P.$def_line,o.NameError.$factory("name '"+ye[ae]+"' is not defined");var W={},Z={};if(ie)for(ae=0;ae<ie.length;ae++){var R=ie[ae][1];"metaclass"==(A=ie[ae][0])?ce=R:W[A]=R,Z[A]=R}var X=P;void 0!==P.__eq__&&void 0===P.__hash__&&(P.__hash__=o.None);var he=de.slice(),U=!1;for(ae=0;ae<de.length;ae++)if(void 0===de[ae]||void 0===de[ae].__mro__){var Re=n.$getattr(de[ae],"__mro_entries__",o.None);if(Re!==o.None){var Q=o.list.$factory(Re(de));de.splice(ae,1,...Q),U=!0,ae--;continue}}if(void 0===ce)if(de&&de.length>0){if(void 0===(ce=de[0].__class__)){if("function"!=typeof de[0])throw o.TypeError.$factory("Argument of "+M+"is not a class (type '"+n.class_name(de[0])+"')");if(1!=de.length)throw o.TypeError.$factory("A Brython class can inherit at most 1 Javascript constructor");ce=de[0].__class__=n.JSMeta,n.set_func_names(de[0],fe)}for(ae=1;ae<de.length;ae++){var be=de[ae].__class__;if(be!==ce&&!o.issubclass(ce,be))if(o.issubclass(be,ce))ce=be;else if(ce.__bases__&&-1==ce.__bases__.indexOf(be))throw o.TypeError.$factory("metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases")}}else ce=o.type;var Pe=n.$getattr(ce,"__prepare__",o.None),Ge=n.$call(Pe)(M,de);for(var Ae in set_class_item=Ge.__class__!==o.dict?n.$getattr(Ge,"__setitem__"):function(dn,On){Ge.$string_dict[dn]=[On,Ge.$order++]},P)if("__annotations__"==Ae)for(var A in void 0===Ge.$string_dict[Ae]&&(Ge.$string_dict[Ae]=[n.empty_dict(),Ge.$order++]),P[Ae].$string_dict)n.$setitem(Ge.$string_dict[Ae][0],A,P[Ae].$string_dict[A][0]);else"$"==Ae.charAt(0)&&"$$"!=Ae.substr(0,2)||set_class_item(Ae,P[Ae]);U&&set_class_item("__orig_bases__",o.tuple.$factory(he));var Xe={__bases__:de,__class__:ce,__dict__:Ge};if(Ge.__class__===o.dict)for(var A in Ge.$string_dict)Xe[A]=Ge.$string_dict[A][0];else for(var Ke=n.$getattr(Ge,"__getitem__"),yt=o.iter(Ge);;)try{Xe[A=o.next(yt)]=Ke(A)}catch{break}Xe.__mro__=o.type.mro(Xe).slice(1);var dt=!0,It={},wt={},Gt=[Xe].concat(Xe.__mro__);for(ae=0;ae<Gt.length;ae++){var Dt=0==ae?X:Gt[ae];for(var Ae in Dt)if(!It[Ae]){var sn=Dt[Ae];"function"==typeof sn&&(!0===sn.__isabstractmethod__||sn.$attrs&&sn.$attrs.__isabstractmethod__?(dt=!1,wt[Ae]=!0):It[Ae]=!0)}}var gt=P.__slots__;for(void 0!==gt&&(gt="string"==typeof gt?[gt]:o.list.$factory(gt),Ge.__slots__=gt),ae=0;ae<Gt.length-1;ae++)for(var Ae in Gt[ae]){if("__setattr__"==Ae){Ge.$has_setattr=!0;break}if(Gt[ae][Ae]&&(Gt[ae][Ae].__get__||Gt[ae][Ae].__class__&&Gt[ae][Ae].__class__.__get__)){Ge.$has_setattr=!0;break}}var An=o.type.__getattribute__(ce,"__new__")(ce,M,de,Ge);for(var Ae in An.__module__=fe,An.$infos={__module__:fe,__name__:n.from_alias(M),__qualname__:P.$qualname},An.$subclasses=[],P)"$"==Ae.charAt(0)&&"$$"!=Ae.substr(0,2)||"function"==typeof P[Ae]&&(P[Ae].$infos.$class=An);for(An.__class__===ce&&o.type.__getattribute__(ce,"__init__")(An,M,de,Ge),ae=0;ae<de.length;ae++)de[ae].$subclasses=de[ae].$subclasses||[],de[ae].$subclasses.push(An);var Bn=o.$$super.$factory(An,An);return o.$$super.__getattribute__(Bn,"__init_subclass__")({$nat:"kw",kw:W}),dt||(An.$factory=function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods "+Object.keys(wt).join(", "))}),An.__qualname__=M.replace("$$",""),An};var l=n.make_class("type",function(M,P,de){return 1==arguments.length?void 0===M?n.UndefinedClass:M.__class__||n.get_class(M):l.__new__(l,M,P,de)});l.__call__=function(){for(var M=[],P=arguments[0],de=1,ye=arguments.length;de<ye;de++)M.push(arguments[de]);var ie=o.type.__getattribute__(P,"__new__").apply(null,arguments);if(ie.__class__===P){var ce=o.type.__getattribute__(P,"__init__");if(ce!==o.object.__init__){var fe=[ie].concat(M);ce.apply(null,fe)}}return ie},l.__class__=l,l.__format__=function(M,P){return o.str.$factory(M)},l.__getattribute__=function(M,P){switch(P){case"__annotations__":for(var de=0,ye=(ae=[M].concat(M.__mro__)).length;de<ye;de++)if(ae[de].__dict__){var ie=ae[de].__dict__.$string_dict.__annotations__[0];if(ie)if(void 0===R)R=ie;else if(R.__class__===o.dict&&ie.__class__===o.dict)for(var ce in ie.$string_dict)R.$string_dict[ce]=ie.$string_dict[ce]}return void 0===R&&(R=n.empty_dict()),R;case"__bases__":return(R=M.__bases__||o.tuple.$factory()).__class__=o.tuple,0==R.length&&R.push(o.object),R;case"__class__":return M.__class__;case"__doc__":return M.__doc__||o.None;case"__setattr__":if(void 0!==M.__setattr__)var fe=M.__setattr__;else fe=function(Re,Q,be){Re[Q]=be};return B.$factory(P,M,fe);case"__delattr__":return void 0!==M.__delattr__?M.__delattr__:B.$factory(P,M,function(Re){delete M[Re]})}if(void 0===(R=M[P])&&M.__slots__&&M.__slots__.indexOf(P)>-1)return D.$factory(P,M);if(M.__class__&&M.__class__[P]&&M.__class__[P].__get__&&M.__class__[P].__set__)return M.__class__[P].__get__(M);if(void 0===R){var ae;if(void 0===(W=M[P]))for(void 0===(ae=M.__mro__)&&console.log("pas de mro pour",M),de=0;de<ae.length;de++){var W;if(void 0!==(W=ae[de][P])){R=W;break}}else R=W;if(void 0===R){var Z=M.__class__||n.get_class(M);if(void 0===(R=Z[P])){var A=Z.__mro__;for(de=0;de<A.length;de++){var R;if(void 0!==(R=A[de][P]))break}}if(void 0!==R){if(R.__class__===o.property)return R.fget(M);if("function"==typeof R){var X=R.bind(null,M);return X.__class__=n.method,X.$infos={__self__:M,__func__:R,__name__:P,__qualname__:M.$infos.__name__+"."+P,__module__:R.$infos?R.$infos.__module__:""},X}}if(void 0===R){var he=Z.__getattr__;if(void 0===he)for(de=0;de<A.length;de++)if(void 0!==A[de].__getattr__){he=A[de].__getattr__;break}if(void 0!==he)return he(M,P)}}}if(void 0!==R){if(R.__class__===o.property)return R;if(R.__get__){if(R.__class__===G){var U=R.__get__(R.__func__,M);U.$infos={__func__:R,__name__:R.$infos.__name__,__qualname__:M.$infos.__name__+"."+R.$infos.__name__,__self__:M}}else U=R.__get__(M);return U}return!R.__class__||!R.__class__.__get__||P.startsWith("__")&&P.endsWith("__")?"function"==typeof R?(void 0===R.$infos&&n.debug>1&&console.log("warning: no attribute $infos for",R,"klass",M,"attr",P),"__new__"==P&&(R.$type="staticmethod"),"__class_getitem__"==P&&R.__class__!==n.method&&(R=o.classmethod.$factory(R)),"__init_subclass__"==P&&(R=o.classmethod.$factory(R)),R.__class__===n.method?R.__get__(null,M):R):R:R.__class__.__get__(R,o.None,M)}},l.__hash__=function(M){return o.hash(M)},l.__init__=function(){},l.__init_subclass__=function(){var M=n.args("__init_subclass__",1,{},[],arguments,{},"args","kwargs");if(void 0!==M.kwargs&&(M.kwargs.__class__!==o.dict||Object.keys(M.kwargs.$string_dict).length>0))throw o.TypeError.$factory("__init_subclass__() takes no keyword arguments");return o.None},l.__instancecheck__=function(M,P){var de=P.__class__||n.get_class(P);if(de===M)return!0;for(var ye=0;ye<de.__mro__.length;ye++)if(de.__mro__[ye]===M)return!0;return!1},l.__instancecheck__.$type="staticmethod",l.__name__={__get__:function(M){return M.$infos.__name__},__set__:function(M,P){M.$infos.__name__=P},__str__:function(M){return"type"},__eq__:function(M,P){return M.$infos.__name__==P}},l.__new__=function(M,P,de,ye){var ie=ye.$string_dict.__module__;ie&&(ie=ie[0]);var ce={__class__:M,__bases__:de,__dict__:ye,$infos:{__name__:P.replace("$$",""),__module__:ie},$is_class:!0,$has_setattr:ye.$has_setattr};ce.__mro__=l.mro(ce).slice(1);for(var fe=n.dict_to_list(ye),ae=0;ae<fe.length;ae++){var W=n.to_alias(fe[ae][0]),Z=fe[ae][1];if("__module__"!==W&&void 0!==Z){if(ce[W]=Z,Z.__class__){var A=n.$getattr(Z.__class__,"__set_name__",o.None);A!==o.None&&A(Z,ce,W)}"function"==typeof Z&&(void 0===Z.$infos&&(console.log("type new",Z,Z+""),console.log(n.frames_stack.slice())),Z.$infos.$class=ce,Z.$infos.__qualname__=P+"."+Z.$infos.__name__,Z.$infos.$defaults)&&n.Function.__setattr__(Z,"__defaults__",Z.$infos.$defaults)}}return ce},l.__repr__=l.__str__=function(M){void 0===M.$infos&&console.log("no $infos",M);var P=M.$infos.__qualname__;return M.$infos.__module__&&"builtins"!=M.$infos.__module__&&!M.$infos.__module__.startsWith("$")&&(P=M.$infos.__module__+"."+P),"<class '"+P+"'>"},l.__prepare__=function(){return n.empty_dict()},l.__qualname__={__get__:function(M){return M.$infos.__qualname__||M.$infos.__name__},__set__:function(M,P){M.$infos.__qualname__=P},__str__:function(M){console.log("type.__qualname__")},__eq__:function(M,P){return M.$infos.__qualname__==P}},l.mro=function(M){for(var P=M.__bases__,de=[],ye=0,ie=0;ie<P.length;ie++){P[ie]===o.str&&(P[ie]=n.StringSubclass);var ce=[],fe=0;if(void 0===P[ie]||void 0===P[ie].__mro__){if(void 0===P[ie].__class__)return[o.object];throw o.TypeError.$factory("Object passed as base class is not a class")}ce[fe++]=P[ie];var ae=P[ie].__mro__;ae[0]===P[ie]&&ae.splice(0,1);for(var W=0;W<ae.length;W++)ce[fe++]=ae[W];de[ye++]=ce}-1==P.indexOf(o.object)&&(P=P.concat(o.tuple.$factory([o.object]))),de[ye++]=P.slice();for(var Z=[M],A=1;;){var R=[];for(fe=0,ie=0;ie<de.length;ie++)de[ie].length>0&&(R[fe++]=de[ie]);if(0==R.length)break;for(ie=0;ie<R.length;ie++){for(var X=R[ie][0],he=[],U=(fe=0,0);U<R.length;U++){var Re=R[U];Re.slice(1).indexOf(X)>-1&&(he[fe++]=Re)}if(!(he.length>0))break;X=null}if(null===X)throw o.TypeError.$factory("inconsistent hierarchy, no C3 MRO is possible");for(Z[A++]=X,ie=0;ie<de.length;ie++)de[ie][0]===X&&de[ie].shift()}return Z[Z.length-1]!==o.object&&(Z[A++]=o.object),Z},l.__subclasscheck__=function(M,P){var de=M;return de===o.str?de=n.StringSubclass:de===o.float&&(de=n.FloatSubclass),void 0===P.__bases__?M===o.object:P.__bases__.indexOf(de)>-1},n.set_func_names(l,"builtins"),o.type=l;var x=n.make_class("wrapper_descriptor");n.set_func_names(x,"builtins"),l.__call__.__class__=x,n.$instance_creator=function(M){if(void 0!==M.$instanciable)return function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods")};var P,de=M.__class__;if(de!==o.type||M.__bases__&&0!=M.__bases__.length){P=o.type.__getattribute__(de,"__call__");var ye=function(){return P.bind(null,M).apply(null,arguments)}}else ye=M.hasOwnProperty("__new__")?M.hasOwnProperty("__init__")?function(){var ie=M.__new__.bind(null,M).apply(null,arguments);return M.__init__.bind(null,ie).apply(null,arguments),ie}:function(){return M.__new__.bind(null,M).apply(null,arguments)}:M.hasOwnProperty("__init__")?function(){var ie={__class__:M,__dict__:n.empty_dict()};return M.__init__.bind(null,ie).apply(null,arguments),ie}:function(){if(arguments.length>0&&(1!=arguments.length||!arguments[0].$nat||0!=Object.keys(arguments[0].kw).length))throw o.TypeError.$factory("object() takes no parameters");return{__class__:M,__dict__:n.empty_dict()}};return ye.__class__=n.Function,ye.$infos={__name__:M.$infos.__name__,__module__:M.$infos.__module__},ye};var B=n.method_wrapper=n.make_class("method_wrapper",function(M,P,de){var ye=function(){return de.apply(null,arguments)};return ye.$infos={__name__:M,__module__:P.__module__},ye});B.__str__=B.__repr__=function(M){return"<method '"+M.$infos.__name__+"' of function object>"};var D=n.make_class("member_descriptor",function(M,P){return{__class__:D,cls:P,attr:M}});D.__str__=D.__repr__=function(M){return"<member '"+M.attr+"' of '"+M.cls.$infos.__name__+"' objects>"},n.set_func_names(D,"builtins");var G=n.method=n.make_class("method",function(M,P){var de=function(){return n.$call(M).bind(null,P).apply(null,arguments)};return de.__class__=G,de.$infos=M.$infos,de});G.__eq__=function(M,P){return void 0!==M.$infos&&void 0!==P.$infos&&M.$infos.__func__===P.$infos.__func__&&M.$infos.__self__===P.$infos.__self__},G.__ne__=function(M,P){return!n.method.__eq__(M,P)},G.__get__=function(M){var P=function(){return M(arguments)};return P.__class__=n.method_wrapper,P.$infos=G.$infos,P},G.__getattribute__=function(M,P){var de=M.$infos;if(de&&de[P]){if("__code__"==P){var ye={__class__:n.Code};for(var P in de.__code__)ye[P]=de.__code__[P];return ye}return de[P]}return G.hasOwnProperty(P)?o.object.__getattribute__(M,P):n.Function.__getattribute__(M.$infos.__func__,P)},G.__repr__=G.__str__=function(M){return"<bound method "+M.$infos.__qualname__+" of "+o.str.$factory(M.$infos.__self__)+">"},G.__setattr__=function(M,P,de){throw"__class__"==P?o.TypeError.$factory("__class__ assignment only supported for heap types or ModuleType subclasses"):o.AttributeError.$factory("'method' object has no attribute '"+P+"'")},n.set_func_names(G,"builtins"),n.method_descriptor=n.make_class("method_descriptor"),n.classmethod_descriptor=n.make_class("classmethod_descriptor"),n.GenericAlias=n.make_class("GenericAlias",function(M,P){return{__class__:n.GenericAlias,origin_class:M,items:P}}),n.GenericAlias.__args__={__get__:function(M){return n.fast_tuple(M.items)}},n.GenericAlias.__call__=function(M,...P){return M.origin_class.$factory.apply(null,P)},n.GenericAlias.__eq__=function(M,P){return n.rich_comp("__eq__",M.origin_class,P.origin_class)&&n.rich_comp("__eq__",M.items,P.items)},n.GenericAlias.__getitem__=function(M,P){throw o.TypeError.$factory("descriptor '__getitem__' for '"+M.origin_class.$infos.__name__+"' objects doesn't apply to a '"+n.class_name(P)+"' object")},n.GenericAlias.__origin__={__get__:function(M){return M.origin_class}},n.GenericAlias.__parameters__={__get__:function(M){return n.fast_tuple([])}},n.GenericAlias.__repr__=function(M){for(var P=M.items,de=0,ye=P.length;de<ye;de++)P[de]=P[de]===o.Ellipsis?"...":P[de].$infos.__name__;return M.origin_class.$infos.__qualname__+"["+P.join(", ")+"]"},o.object.__class__=l}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator;function index_error(n){throw _b_.IndexError.$factory(("string"==typeof n?"string":"list")+" index out of range")}$B.args=function(n,o,l,x,B,D,G,M){n.startsWith("lambda_"+$B.lambda_magic)&&(n="<lambda>");var P,de,ye=!1,ie=B.length,ce=0,fe=x.indexOf("/");if(-1!=fe&&(x.splice(fe,1),de=x.slice(0,fe)),ie>0&&B[ie-1].$nat&&(ie--,Object.keys(B[ie].kw).length>0)){ye=!0;var ae=B[ie].kw;if(Array.isArray(ae)){for(var W=ae[0],Z=1,A=ae.length;Z<A;Z++){var R=ae[Z];if(R.__class__===_b_.dict){for(var X in R.$numeric_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in R.$object_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var X in R.$string_dict){if(void 0!==W[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");W[X]=R.$string_dict[X][0]}}else for(var he=_b_.iter(R),U=$B.$getattr(R,"__getitem__");;)try{if("string"!=typeof(X=_b_.next(he)))throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==W[X])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+X+"'");W[X]=U(X)}catch(Xe){if($B.is_exc(Xe,[_b_.StopIteration]))break;throw Xe}}ae=W}}if(G&&(l[G]=[],l[G].__class__=_b_.tuple),M&&(P=$B.empty_dict()),ie>o){if(null===G||"*"==G)throw _b_.TypeError.$factory(Ae=n+"() takes "+o+" positional argument"+(o>1?"s":"")+" but more were given");for(Z=o;Z<ie;Z++)l[G].push(B[Z]);ie=o}for(Z=0;Z<ie;Z++)l[x[Z]]=B[Z],ce++;if(ce==o&&o===x.length&&!ye)return M&&(l[M]=P),l;if(ye)for(var Re in ae){var Q=ae[Re],be=$B.to_alias(Re);if(void 0===l[be]){if(!M)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Re+"'");"$$"==Re.substr(0,2)&&(Re=Re.substr(2)),P.$string_dict[Re]=[Q,P.$order++]}else{if(null!==l[be])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+Re+"'");if(de&&de.indexOf(be)>-1)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Re+"'");l[be]=Q}}var Pe=[];for(var Ge in l)null===l[Ge]&&(void 0!==D[Ge]?l[Ge]=D[Ge]:Pe.push("'"+Ge+"'"));if(Pe.length>0){if(1==Pe.length)throw _b_.TypeError.$factory(n+" missing 1 positional argument: "+Pe[0]);var Ae=n+" missing "+Pe.length+" positional arguments: ";throw Ae+=Pe.join(" and "),_b_.TypeError.$factory(Ae)}return M&&(l[M]=P),l},$B.wrong_nb_args=function(n,o,l,x){if(o<l){var B=l-o;throw _b_.TypeError.$factory(n+"() missing "+B+" positional argument"+(B>1?"s":"")+": "+x.slice(o))}throw _b_.TypeError.$factory(n+"() takes "+l+" positional argument"+(l>1?"s":"")+" but more were given")},$B.get_class=function(n){if(null===n)return $B.$NoneDict;if(void 0===n)return $B.UndefinedClass;var o=n.__class__;if(void 0===o)switch(typeof n){case"number":return n%1==0?_b_.int:_b_.float;case"string":return _b_.str;case"boolean":return _b_.bool;case"function":return n.$is_js_func?$B.JSObj:(n.__class__=$B.Function,$B.Function);case"object":if(Array.isArray(n)){if(Object.getPrototypeOf(n)===Array.prototype)return n.__class__=_b_.list,_b_.list}else{if(n.constructor===Number)return _b_.float;if(typeof Node<"u"&&n instanceof Node)return $B.DOMNode}}return void 0===o?$B.JSObj:o},$B.class_name=function(n){var o=$B.get_class(n);return o===$B.JSObj?"Javascript "+n.constructor.name:o.$infos.__name__},$B.$list_comp=function(n){for(var o=$B.UUID(),l="x"+o+" = []\n",x=0,B=1,D=n.length;B<D;B++){var G=n[B].replace(/\s+$/,"").replace(/\n/g,"");l+=" ".repeat(x)+G+":\n",x+=4}return l+=" ".repeat(x),[l+="x"+o+".append("+n[0]+")\n",o]},$B.$dict_comp=function(n,o,l,x){for(var B=$B.UUID(),D="comp_result_"+$B.lambda_magic+B,G=D+" = {}\n",M=0,P=1,de=l.length;P<de;P++){var ye=l[P].replace(/\s+$/,"").replace(/\n/g,"");G+="    ".repeat(M)+ye+":\n",M++}G+="    ".repeat(M)+D+".update({"+l[0]+"})";var ce="dc"+B,fe=$B.py2js({src:G,is_comp:!0,line_info:x+","+n},n,ce,o,x),ae=fe.outermost_expr.to_js(),W=fe.to_js();return W="(function(expr){"+(W+="\nreturn "+D+"\n")+"})("+ae+")",$B.clear_ns(ce),delete $B.$py_src[ce],W},$B.$gen_expr=function(n,o,l,x,B){for(var D=$B.UUID(),G=(B?"set_comp"+$B.lambda_magic:"__ge")+D,M=`def ${G}(expr):\n`,P=1,de=1,ye=l.length;de<ye;de++){var ie=l[de].replace(/\s+$/,"").replace(/\n/g,"");M+=" ".repeat(P)+ie+":\n",P+=4}M+=" ".repeat(P);var fe=$B.py2js({src:M+="yield ("+l[0]+")",is_comp:!0,line_info:x+","+n,ix:D},G,G,o,x),ae=fe.to_js(),W=ae.split("\n");void 0===fe.outermost_expr&&console.log("no outermost",n,o);var Z=fe.outermost_expr.to_js();return ae=W.join("\n"),"(function($locals_"+G+"){"+(ae+="\nvar $res = $B.generator.$factory("+G+")("+Z+");\nreturn $res\n")+"})($locals)\n"},$B.copy_namespace=function(){var n={};for(const l of $B.frames_stack)for(const x of[l[1],l[3]])for(var o in x)!o.startsWith("$$")&&o.startsWith("$")||(n[o]=x[o]);return n},$B.clear_ns=function(n){n.startsWith("__ge")&&console.log("clear ns",n);var o=n.length;for(var l in $B.$py_module_path)l.substr(0,o)==n&&($B.$py_module_path[l]=null,delete $B.$py_module_path[l]);$B.$py_src[n]=null,delete $B.$py_src[n];var x=n.replace(/\./g,"_");x!=n&&$B.clear_ns(x)},$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.$search=function(n,o){var l=$B.last($B.frames_stack);if(void 0!==l[1][n])return l[1][n];if(void 0!==l[3][n])return l[3][n];if(void 0!==_b_[n])return _b_[n];throw l[0]==l[2]||"class"==l[1].$type||l[1].$exec_locals?_b_.NameError.$factory("name '"+n+"' is not defined"):_b_.UnboundLocalError.$factory("local variable '"+n+"' referenced before assignment")},$B.$global_search=function(n,o){for(var l=0;l<$B.frames_stack.length;l++){var x=$B.frames_stack[l];if(o.indexOf(x[0])>-1&&void 0!==x[1][n])return x[1][n];if(o.indexOf(x[2])>-1&&void 0!==x[3][n])return x[3][n]}for(l=0;l<o.length;l++){var B=o[l];if($B.imported[B]&&$B.imported[B][n])return $B.imported[B][n]}throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$local_search=function(n){var o=$B.last($B.frames_stack);if(void 0!==o[1][n])return o[1][n];throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def=function(n,o){if(void 0!==o)return o;if(void 0!==_b_[n])return _b_[n];var l=$B.last($B.frames_stack);if(void 0!==l[3][n])return l[3][n];throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$check_def_local=function(n,o){if(void 0!==o)return o;throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def_free=function(n,o){if(void 0!==o)return o;for(var l,x=$B.frames_stack.length-1;x>=0;x--)if(void 0!==(l=$B.frames_stack[x][1][n])||void 0!==(l=$B.frames_stack[x][3][n]))return l;throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$check_def_free1=function(n,o){for(var l,x=$B.frames_stack.length-1;x>=0;x--){var B=$B.frames_stack[x];if(void 0!==(l=B[1][n])||B[1].$parent&&void 0!==(l=B[1].$parent[n])||B[2]==o&&void 0!==(l=B[3][n]))return l}throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$JS2Py=function(n){return"number"==typeof n?n%1==0?n:_b_.float.$factory(n):null==n?_b_.None:(Array.isArray(n)&&Object.getPrototypeOf(n)===Array.prototype&&(n.$brython_class="js"),n)},$B.list_key=function(n,o){(o=$B.$GetInt(o))<0&&(o+=n.length);var l=n[o];if(void 0===l)throw _b_.IndexError.$factory("list index out of range");return l},$B.list_slice=function(n,o,l){return null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l?n.slice(o):((l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length)),n.slice(o,l))},$B.list_slice_step=function(n,o,l,x){if(null===x||1==x)return $B.list_slice(n,o,l);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),null===o?o=x>=0?0:n.length-1:(o=$B.$GetInt(o))<0&&(o=Math.min(0,o+n.length)),null===l?l=x>=0?n.length:-1:(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var B=[];if(x>0)for(var D=o;D<l;D+=x)B.push(n[D]);else for(D=o;D>l;D+=x)B.push(n[D]);return B},$B.$getitem=function(n,o){var l=Array.isArray(n)&&n.__class__===_b_.list;if("number"==typeof o&&(l||"string"==typeof n)){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}try{o=$B.$GetInt(o)}catch{}if((l||"string"==typeof n)&&"number"==typeof o){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}if(n.$is_class){var x=$B.$getattr(n,"__class_getitem__",_b_.None);if(x!==_b_.None)return x(o);if(n.__class__&&(x=$B.$getattr(n.__class__,"__getitem__",_b_.None))!==_b_.None)return x(n,o)}if(l)return _b_.list.$getitem(n,o);var B=$B.$getattr(n,"__getitem__",_b_.None);if(B!==_b_.None)return B(o);throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not subscriptable")},$B.getitem_slice=function(n,o){var l;return Array.isArray(n)?(o.start===_b_.None&&o.stop===_b_.None?o.step===_b_.None||1==o.step?l=n.slice():-1==o.step&&(l=n.slice().reverse()):o.step===_b_.None&&(o.start===_b_.None&&(o.start=0),o.stop===_b_.None&&(o.stop=n.length),"number"==typeof o.start&&"number"==typeof o.stop&&(o.start<0&&(o.start+=n.length),o.stop<0&&(o.stop+=n.length),l=n.slice(o.start,o.stop))),l?(l.__class__=n.__class__,l):_b_.list.$getitem(n,o)):$B.$getattr(n,"__getitem__")(o)},$B.set_list_key=function(n,o,l){try{o=$B.$GetInt(o)}catch{if(_b_.isinstance(o,_b_.slice)){var x=_b_.slice.$conv_for_seq(o,n.length);return $B.set_list_slice_step(n,x.start,x.stop,x.step,l)}}if(o<0&&(o+=n.length),void 0===n[o])throw console.log(n,o),_b_.IndexError.$factory("list assignment index out of range");n[o]=l},$B.set_list_slice=function(n,o,l,x){null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l&&(l=n.length),(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var B=_b_.list.$factory(x);n.splice.apply(n,[o,l-o].concat(B))},$B.set_list_slice_step=function(n,o,l,x,B){if(null===x||1==x)return $B.set_list_slice(n,o,l,B);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),o=null===o?x>0?0:n.length-1:$B.$GetInt(o),l=null===l?x>0?n.length:-1:$B.$GetInt(l);var D,G=_b_.list.$factory(B),M=0,P=0;D=x>0?function(ye){return ye<l}:function(ye){return ye>l};for(var de=o;D(de);de+=x)P++;if(P!=G.length)throw _b_.ValueError.$factory("attempt to assign sequence of size "+G.length+" to extended slice of size "+P);for(de=o;D(de);de+=x)n[de]=G[M],M++},$B.$setitem=function(n,o,l){if(!Array.isArray(n)||void 0!==n.__class__||"number"!=typeof o||_b_.isinstance(n,_b_.tuple)){if(n.__class__!==_b_.dict)return n.__class__===_b_.list?_b_.list.$setitem(n,o,l):void $B.$getattr(n,"__setitem__")(o,l);_b_.dict.$setitem(n,o,l)}else{if(o<0&&(o+=n.length),void 0===n[o])throw _b_.IndexError.$factory("list assignment index out of range");n[o]=l}},$B.augm_item_add=function(n,o,l){if(Array.isArray(n)&&"number"==typeof o&&void 0!==n[o]){if(Array.isArray(n[o])&&Array.isArray(l)){for(var x=0,B=l.length;x<B;x++)n[o].push(l[x]);return}if("string"==typeof n[o]&&"string"==typeof l)return void(n[o]+=l)}var D=$B.$getattr;try{var G=D(D(n,"__getitem__")(o),"__iadd__")}catch{return void D(n,"__setitem__")(o,D(D(n,"__getitem__")(o),"__add__")(l))}G(l)};for(var augm_item_src=""+$B.augm_item_add,augm_ops=[["-=","sub"],["*=","mul"]],i=0,len=augm_ops.length;i<len;i++){var augm_code=augm_item_src.replace(/add/g,augm_ops[i][1]);augm_code=augm_code.replace(/\+=/g,augm_ops[i][0]),eval("$B.augm_item_"+augm_ops[i][1]+"="+augm_code)}$B.extend=function(n,o){for(var l=2;l<arguments.length;l++)for(var x=arguments[l],B=_b_.iter(x),D=$B.$getattr(x,"__getitem__");;)try{var G=_b_.next(B);if("string"!=typeof G)throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==o[G])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+G+"'");o[G]=D(G)}catch(M){if(_b_.isinstance(M,[_b_.StopIteration]))break;throw M}return o},$B.extend_list=function(){for(var n=Array.prototype.slice.call(arguments,0,arguments.length-1),o=$B.last(arguments),l=_b_.iter(o);;)try{n.push(_b_.next(l))}catch(x){if(_b_.isinstance(x,[_b_.StopIteration]))break;throw x}return n},$B.$test_item=function(n){return $B.$test_result=n,_b_.bool.$factory(n)},$B.$test_expr=function(){return $B.$test_result},$B.$is=function(n,o){return n instanceof Number&&o instanceof Number?n.valueOf()==o.valueOf():n===_b_.int&&o==$B.long_int||n===$B.long_int&&o===_b_.int||n===o},$B.$is_member=function(n,o){var l,x,B;try{B=$B.$getattr(o.__class__||$B.get_class(o),"__contains__")}catch{}if(B)return $B.$call(B)(o,n);try{x=_b_.iter(o)}catch{}if(x)for(;;)try{var D=_b_.next(x);if($B.rich_comp("__eq__",D,n))return!0}catch{return!1}try{l=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(o)+"' object is not iterable")}if(l)for(var G=-1;;){G++;try{if(D=l(G),$B.rich_comp("__eq__",D,n))return!0}catch(M){if(M.__class__===_b_.IndexError)return!1;throw M}}},$B.$call=function(n){if(n.__class__===$B.method||n.$is_func||"function"==typeof n)return n;if(n.$factory)return n.$factory;if(n.$is_class)return n.$factory=$B.$instance_creator(n);try{return $B.$getattr(n,"__call__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not callable")}};var $io=$B.make_class("io",function(n){return{__class__:$io,out:n}});function $err(n,o,l){var x="unsupported operand type(s) for "+n+" : '"+o.$infos.__name__+"' and '"+$B.class_name(l)+"'";throw _b_.TypeError.$factory(x)}$io.flush=function(){},$io.write=function(n,o){return console[n.out](o),_b_.None},$B.stderr=void 0!==console.error?$io.$factory("error"):$io.$factory("log"),$B.stdout=$io.$factory("log"),$B.stdin={__class__:$io,__original__:!0,closed:!1,len:1,pos:0,read:function(){return""},readline:function(){return""}},$B.make_iterator_class=function(n){var o={__class__:_b_.type,__mro__:[_b_.object],$factory:function(l){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:l,len:l.length}},$infos:{__name__:n},$is_class:!0,__iter__:function(l){return l.counter=void 0===l.counter?-1:l.counter,l.len=l.items.length,l},__len__:function(l){return l.items.length},__next__:function(l){if("function"==typeof l.len_func&&l.len_func()!=l.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(l.counter++,l.counter<l.items.length){var x=l.items[l.counter];return"js"==l.items.$brython_class&&(x=$B.$JS2Py(x)),x}throw _b_.StopIteration.$factory("StopIteration")},__reduce_ex__:function(l,x){return $B.fast_tuple([_b_.iter,_b_.tuple.$factory([l.items])])}};return $B.set_func_names(o,"builtins"),o};var ropnames=["add","sub","mul","truediv","floordiv","mod","pow","lshift","rshift","and","xor","or"],ropsigns=["+","-","*","/","//","%","**","<<",">>","&","^","|"];function exit_ctx_managers_in_generators(n){for(key in n[1])n[1][key]&&n[1][key].__class__==$B.generator&&n[1][key].return()}$B.make_rmethods=function(n){for(var o=0,l=ropnames.length;o<l;o++)void 0===n["__"+ropnames[o]+"__"]&&(n["__"+ropnames[o]+"__"]=function(x,B){return function(D,G){try{return $B.$getattr(G,"__r"+x+"__")(D)}catch{$err(B,n,G)}}}(ropnames[o],ropsigns[o]))},$B.UUID=function(){return $B.$py_UUID++},$B.InjectBuiltins=function(){var n=["var _b_ = $B.builtins"],o=1;for(var l in $B.builtins)n[o++]="var "+l+'=_b_["'+l+'"]';return n.join(";")},$B.$GetInt=function(n){if("number"==typeof n||n.constructor===Number)return n;if("boolean"==typeof n)return n?1:0;if(_b_.isinstance(n,_b_.int))return n;if(_b_.isinstance(n,_b_.float))return n.valueOf();if(!n.$is_class){try{return $B.$getattr(n,"__int__")()}catch{}try{return $B.$getattr(n,"__index__")()}catch{}}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")},$B.to_num=function(n,o){for(var l={__complex__:_b_.complex,__float__:_b_.float,__index__:_b_.int,__int__:_b_.int},x=n.__class__||$B.get_class(n),B=0;B<o.length;B++){var D={},G=$B.$getattr(x,o[B],D);if(G!==D){var M=G(n);if(!_b_.isinstance(M,l[o[B]]))throw console.log(M,o[B],l[o[B]]),_b_.TypeError.$factory(o[B]+"returned non-"+l[o[B]].$infos.__name__+"(type "+$B.get_class(M)+")");return M}}return null},$B.PyNumber_Index=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;if(_b_.isinstance(n,_b_.int))return n.$brython_value;var o=$B.$getattr(n,"__index__",_b_.None);if(o!==_b_.None)return o="function"==typeof o?o:$B.$getattr(o,"__call__"),$B.int_or_bool(o());default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.int_or_bool=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer");default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.enter_frame=function(n){if($B.frames_stack.push(n),$B.tracefunc&&$B.tracefunc!==_b_.None){if(n[4]===$B.tracefunc||$B.tracefunc.$infos&&n[4]&&n[4]===$B.tracefunc.$infos.__func__)return $B.tracefunc.$frame_id=n[0],_b_.None;for(var o=$B.frames_stack.length-1;o>=0;o--)if($B.frames_stack[o][0]==$B.tracefunc.$frame_id)return _b_.None;return $B.tracefunc($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"call",_b_.None)}return _b_.None},$B.trace_exception=function(){var n=$B.last($B.frames_stack);if(n[0]==$B.tracefunc.$current_frame_id)return _b_.None;var l=n[1].$current_exception;return(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"exception",$B.fast_tuple([l.__class__,l,$B.traceback.$factory(l)]))},$B.trace_line=function(){var n=$B.last($B.frames_stack);return n[0]==$B.tracefunc.$current_frame_id?_b_.None:(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"line",_b_.None)},$B.set_line=function(n){var o=$B.last($B.frames_stack);if($B.tracefunc&&o[0]==$B.tracefunc.$current_frame_id)return _b_.None;o[1].$line_info=n;var l=o[1].$f_trace;if(l!==_b_.None){var x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);o[1].$ftrace=l(x,"line",_b_.None)}return!0},$B.trace_return=function(n){var o=$B.last($B.frames_stack),l=o[1].$f_trace,x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);if(o[0]==$B.tracefunc.$current_frame_id)return _b_.None;l(x,"return",n)},$B.set_cm_in_generator=function(n){void 0!==n&&$B.frames_stack.forEach(function(o){o[1].$cm_in_gen=o[1].$cm_in_gen||new Set,o[1].$cm_in_gen.add(n)})},$B.leave_frame=function(n){if(0!=$B.frames_stack.length){n&&void 0!==n.value&&$B.tracefunc&&(void 0===$B.last($B.frames_stack)[1].$f_trace&&($B.last($B.frames_stack)[1].$f_trace=$B.tracefunc),$B.last($B.frames_stack)[1].$f_trace!==_b_.None&&$B.trace_return(n.value));var o=$B.frames_stack.pop();if(o[1].$current_exception=void 0,o[1].$close_generators)for(var l=0,x=o[1].$close_generators.length;l<x;l++){var B=o[1].$close_generators[l];B.$has_run&&B.return()}return _b_.None}console.log("empty stack")},$B.leave_frame_exec=function(n){if($B.profile>0&&$B.$profile.return(),0!=$B.frames_stack.length){var o=$B.frames_stack.pop();exit_ctx_managers_in_generators(o);for(var l=$B.frames_stack.length-1;l>=0;l--)$B.frames_stack[l][2]==o[2]&&($B.frames_stack[l][3]=o[3])}else console.log("empty stack")};var min_int=Math.pow(-2,53),max_int=Math.pow(2,53)-1;$B.is_safe_int=function(){for(var n=0;n<arguments.length;n++){var o=arguments[n];if(o<min_int||o>max_int)return!1}return!0},$B.add=function(n,o){if("number"==typeof n.valueOf()&&"number"==typeof o.valueOf()){if("number"==typeof n&&"number"==typeof o){var l=n+o;return l<$B.max_int&&l>$B.min_int?l:l===1/0?_b_.float.$factory("inf"):l===-1/0?_b_.float.$factory("-inf"):isNaN(l)?_b_.float.$factory("nan"):$B.long_int.__add__($B.long_int.$factory(n),$B.long_int.$factory(o))}return new Number(n+o)}if("string"==typeof n&&"string"==typeof o)return n+o;try{var x=$B.$getattr(n.__class__||$B.get_class(n),"__add__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("unsupported operand type(s) for +: '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'"):D}var B=$B.$call(x)(n,o);return B===_b_.NotImplemented?$B.rich_op("add",n,o):B},$B.div=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?l:$B.long_int.__truediv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.eq=function(n,o){return n>min_int&&n<max_int&&o>min_int&&o<max_int?n==o:$B.long_int.__eq__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.floordiv=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?Math.floor(l):$B.long_int.__floordiv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.mul=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n*o):n*o;if(n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int)return l;if("number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o))return _b_.float.$factory("nan");switch(n){case 1/0:case-1/0:return 0==o?_b_.float.$factory("nan"):o>0?n:-n}return $B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.sub=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n-o):n-o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int?l:"number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o)?_b_.float.$factory("nan"):$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.ge=function(n,o){return"number"==typeof n&&"number"==typeof o?n>=o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__ge__(n,o)},$B.gt=function(n,o){return"number"==typeof n&&"number"==typeof o?n>o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__gt__(n,o)};var reversed_op={__lt__:"__gt__",__le__:"__ge__",__gt__:"__lt__",__ge__:"__le__"},method2comp={__lt__:"<",__le__:"<=",__gt__:">",__ge__:">="};$B.rich_comp=function(n,o,l){var x,B,D=o.valueOf(),G=l.valueOf();if("number"==typeof D&&"number"==typeof G&&void 0===o.__class__&&void 0===l.__class__)switch(n){case"__eq__":return D==G;case"__ne__":return D!=G;case"__le__":return D<=G;case"__lt__":return D<G;case"__ge__":return D>=G;case"__gt__":return D>G}if(o.$is_class||o.$factory){if("__eq__"==n)return o===l;if("__ne__"==n)return o!==l;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if(o.__class__&&l.__class__&&l.__class__.__mro__.indexOf(o.__class__)>-1&&($B.$getattr(l,B=reversed_op[n]||n),(x=$B.$call($B.$getattr(l,B))(o))!==_b_.NotImplemented)||(x=$B.$call($B.$getattr(o,n))(l))!==_b_.NotImplemented||(x=$B.$call($B.$getattr(l,B=reversed_op[n]||n))(o))!==_b_.NotImplemented)return x;if("__eq__"==n)return _b_.False;if("__ne__"==n)return _b_.True;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")};var opname2opsign={sub:"-",xor:"^",mul:"*"};$B.rich_op=function(n,o,l){var x,B,D=o.__class__||$B.get_class(o);if(D===(l.__class__||$B.get_class(l))){if(D===_b_.int)return _b_.int["__"+n+"__"](o,l);try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__===_b_.AttributeError){var G=$B.class_name(o);throw _b_.TypeError.$factory("unsupported operand type(s) for "+opname2opsign[n]+" : '"+G+"' and '"+G+"'")}throw M}return x(l)}try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(M){if(M.__class__!==_b_.AttributeError)throw M;if((B=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return B;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if((B=x(l))===_b_.NotImplemented){if((B=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return B;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}return B},$B.is_none=function(n){return null==n||n==_b_.None};var repr_stack=new Set;$B.repr={enter:function(n){if(repr_stack.has(n))return!0;repr_stack.add(n)},leave:function(n){repr_stack.delete(n)}}}(__BRYTHON__),function($B){var _b_=$B.builtins;_b_.__debug__=!1,$B.$comps={">":"gt",">=":"ge","<":"lt","<=":"le"},$B.$inv_comps={">":"lt",">=":"le","<":"gt","<=":"ge"};var check_nb_args=$B.check_nb_args=function(n,o,l){var x=l.length,B=l[x-1];if(B&&"kw"==B.$nat){var D=B.kw;Array.isArray(D)&&D[1]&&D[1].__class__===_b_.dict&&0==Object.keys(D[1].$string_dict).length&&x--}if(x!=o)throw _b_.TypeError.$factory(0==o?n+"() takes no argument ("+x+" given)":n+"() takes exactly "+o+" argument"+(o<2?"":"s")+" ("+x+" given)")},check_no_kw=$B.check_no_kw=function(n,o,l){if(void 0===o&&console.log("x undef",n,o,l),o.$nat&&o.kw&&o.kw[0]&&o.kw[0].length>0||void 0!==l&&l.$nat)throw _b_.TypeError.$factory(n+"() takes no keyword arguments")},NoneType={$factory:function(){return None},$infos:{__name__:"NoneType",__module__:"builtins"},__bool__:function(n){return False},__class__:_b_.type,__hash__:function(n){return 0},__mro__:[_b_.object],__repr__:function(n){return"None"},__str__:function(n){return"None"},$is_class:!0,__setattr__:function(n,o){return no_set_attr(NoneType,o)}},None={__class__:NoneType};for(var $op in $B.$comps){var key=$B.$comps[$op];switch(key){case"ge":case"gt":case"le":case"lt":NoneType["__"+key+"__"]=function(n){return _b_.NotImplemented}}}for(var $func in None)"function"==typeof None[$func]&&(None[$func].__str__=function(n){return function(){return"<method-wrapper "+n+" of NoneType object>"}}($func));function abs(n){if(check_nb_args("abs",1,arguments),check_no_kw("abs",n),isinstance(n,_b_.int))return n.__class__===$B.long_int?{__class__:$B.long_int,value:n.value,pos:!0}:_b_.int.$factory(Math.abs(n));if(isinstance(n,_b_.float))return _b_.float.$factory(Math.abs(_b_.float.numerator(n)));var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__abs__")}catch(x){throw x.__class__===_b_.AttributeError?_b_.TypeError.$factory("Bad operand type for abs(): '"+$B.class_name(n)+"'"):x}return $B.$call(l)(n)}function all(n){check_nb_args("all",1,arguments),check_no_kw("all",n);for(var o=iter(n);;)try{var l=next(o);if(!$B.$bool(l))return!1}catch{return!0}}function any(n){check_nb_args("any",1,arguments),check_no_kw("any",n);for(var o=iter(n);;)try{var l=next(o);if($B.$bool(l))return!0}catch{return!1}}function ascii(n){check_nb_args("ascii",1,arguments),check_no_kw("ascii",n);for(var o,l=repr(n),x="",B=0;B<l.length;B++)if((o=l.charCodeAt(B))<128)x+=l.charAt(B);else if(o<256)x+="\\x"+o.toString(16);else{var D=o.toString(16);D.length%2==1&&(D="0"+D),x+="\\u"+D}return x}function $builtin_base_convert_helper(n,o){var l="";switch(o){case 2:l="0b";break;case 8:l="0o";break;case 16:l="0x";break;default:console.log("invalid base:"+o)}if(n.__class__===$B.long_int){var x=l+$B.long_int.to_base(n,o);return n.pos||(x="-"+x),x}var B=$B.$GetInt(n);if(void 0===B)throw _b_.TypeError.$factory("Error, argument must be an integer or contains an __index__ function");return B>=0?l+B.toString(o):"-"+l+(-B).toString(o)}function bin_hex_oct(n,o){if(isinstance(o,_b_.int))return $builtin_base_convert_helper(o,n);try{var l=o.__class__||$B.get_class(o),x=$B.$getattr(l,"__index__")}catch(B){throw B.__class__===_b_.AttributeError?_b_.TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer"):B}return $builtin_base_convert_helper($B.$call(x)(o),n)}function bin(n){return check_nb_args("bin",1,arguments),check_no_kw("bin",n),bin_hex_oct(2,n)}function breakpoint(){$B.$import("sys",[]);var n={},o=$B.$getattr($B.imported.sys,"breakpointhook",n);if(o===n)throw _b_.RuntimeError.$factory("lost sys.breakpointhook");return $B.$call(o).apply(null,arguments)}function callable(n){return check_nb_args("callable",1,arguments),check_no_kw("callable",n),hasattr(n,"__call__")}function chr(n){if(check_nb_args("chr",1,arguments),check_no_kw("chr",n),n<0||n>1114111)throw _b_.ValueError.$factory("Outside valid range");return String.fromCodePoint(n)}$B.set_func_names(NoneType,"builtins");var classmethod=$B.make_class("classmethod",function(n){check_nb_args("classmethod",1,arguments),check_no_kw("classmethod",n);var o=function(){return n.apply(null,arguments)};if(o.__class__=$B.method,n.$attrs)for(var l in n.$attrs)o[l]=n.$attrs[l];return o.$infos={__func__:n,__name__:n.$infos.__name__},o.__get__=function(x,B){var D=function(){return o(B,...arguments)};return D.__class__=$B.method,D.$infos={__self__:B,__func__:o,__name__:n.$infos.__name__,__qualname__:B.$infos.__name__+"."+n.$infos.__name__},D},o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});$B.set_func_names(classmethod,"builtins");var code=$B.code=$B.make_class("code");function compile(){var n=$B.args("compile",6,{source:null,filename:null,mode:null,flags:null,dont_inherit:null,optimize:null,_feature_version:null},["source","filename","mode","flags","dont_inherit","optimize","_feature_version"],arguments,{flags:0,dont_inherit:!1,optimize:-1,_feature_version:0},null,null),o="$exec_"+$B.UUID();if($B.clear_ns(o),n.__class__=code,n.co_flags=n.flags,n.name="<module>","single"==n.mode&&512&n.flags&&!n.source.endsWith("\n")){var l=n.source.split("\n");if($B.last(l).startsWith(" "))throw _b_.SyntaxError.$factory("unexpected EOF while parsing")}return $B.py2js(n.source,o,o),n}code.__repr__=code.__str__=function(n){return"<code object "+n.co_name+", file "+n.co_filename+">"},code.__getattribute__=function(n,o){return n[o]},$B.set_func_names(code,"builtins");var __debug__=$B.debug>0;function delattr(n,o){if(check_no_kw("delattr",n,o),check_nb_args("delattr",2,arguments),"string"!=typeof o)throw _b_.TypeError.$factory("attribute name must be string, not '"+$B.class_name(o)+"'");return $B.$getattr(n,"__delattr__")(o)}function dir(n){if(void 0===n){var o=$B.last($B.frames_stack);for(var l in locals_obj=o[1],B=_b_.list.$factory(),D=0,locals_obj)"$"==l.charAt(0)&&"$"!=l.charAt(1)||(B[D++]=l);return _b_.list.sort(B),B}if(check_nb_args("dir",1,arguments),check_no_kw("dir",n),n.__class__||$B.get_class(n),n.$is_class){var x=$B.$getattr(n.__class__,"__dir__");return $B.$call(x)(n)}try{var B=$B.$call($B.$getattr(n,"__dir__"))();return _b_.list.$factory(B)}catch{}B=[];var D=0;for(var l in n)"$"!==l.charAt(0)&&"__class__"!==l&&void 0!==n[l]&&(B[D++]=l);return B.sort(),B}function divmod(n,o){check_no_kw("divmod",n,o),check_nb_args("divmod",2,arguments);var l=n.__class__||$B.get_class(n),x=$B.$getattr(l,"__divmod__",_b_.None);return x!==_b_.None?x(n,o):_b_.tuple.$factory([$B.$getattr(l,"__floordiv__")(n,o),$B.$getattr(l,"__mod__")(n,o)])}$B.$delete=function(n,o){function l(D){D.__class__===$B.generator&&D.return()}var x=!1,B=$B.last($B.frames_stack);if(o?B[2]!=B[0]&&void 0!==B[3][n]&&(x=!0,l(B[3][n]),delete B[3][n]):void 0!==B[1][n]&&(x=!0,l(B[1][n]),delete B[1][n]),!x)throw _b_.NameError.$factory(n)};var enumerate=$B.make_class("enumerate",function(){var n=$B.args("enumerate",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null),o=iter(n.iterable),l=n.start;return{__class__:enumerate,__name__:"enumerate iterator",counter:l-1,iter:o,start:l}});function $$eval(src,_globals,_locals){var $=$B.args("eval",4,{src:null,globals:null,locals:null,mode:null},["src","globals","locals","mode"],arguments,{globals:_b_.None,locals:_b_.None,mode:"eval"},null,null),src=$.src,_globals=$.globals,_locals=$.locals,mode=$.mode;$.src.mode&&"single"==$.src.mode&&["<console>","<stdin>"].indexOf($.src.filename)>-1&&_b_.print(">",$.src.source.trim());var current_frame=$B.frames_stack[$B.frames_stack.length-1];if(void 0!==current_frame)var current_locals_id=current_frame[0].replace(/\./g,"_"),current_globals_id=current_frame[2].replace(/\./g,"_");var stack_len=$B.frames_stack.length;if(src.__class__===code)mode=src.mode,src=src.source;else if("string"!=typeof src)throw _b_.TypeError.$factory("eval() arg 1 must be a string, bytes or code object");var globals_id="$exec_"+$B.UUID(),globals_name=globals_id,locals_id="$exec_"+$B.UUID(),parent_scope;if(_globals===_b_.None){current_locals_id==current_globals_id&&(locals_id=globals_id);var local_scope={module:globals_id,id:locals_id,binding:{},bindings:{}};for(var attr in current_frame[1])local_scope.binding[attr]=!0,local_scope.bindings[attr]=!0;var global_scope={module:globals_id,id:globals_id,binding:{},bindings:{}};for(var attr in current_frame[3])global_scope.binding[attr]=!0,global_scope.bindings[attr]=!0;local_scope.parent_block=global_scope,global_scope.parent_block=$B.builtins_scope,parent_scope=local_scope,eval("$locals_"+parent_scope.id+" = current_frame[1]")}else{if(_globals.__class__!=_b_.dict)throw _b_.TypeError.$factory("exec() globals must be a dict, not "+$B.class_name(_globals));if(_globals.globals_id&&(globals_id=globals_name=_globals.globals_id),_globals.globals_id=globals_id,_locals===_globals||_locals===_b_.None)locals_id=globals_id,parent_scope=$B.builtins_scope;else{var grandparent_scope={id:globals_id,parent_block:$B.builtins_scope,binding:{}};for(var attr in parent_scope={id:locals_id,parent_block:grandparent_scope,binding:{}},_globals.$string_dict)grandparent_scope.binding[attr]=!0;for(var attr in _locals.$string_dict)parent_scope.binding[attr]=!0}}if($B.$py_module_path[globals_id]=$B.$py_module_path[current_globals_id],eval("var $locals_"+globals_id+" = {}\nvar $locals_"+locals_id+" = {}"),_globals===_b_.None){var gobj=current_frame[3],ex="var $locals_"+globals_id+" = gobj;",obj={};for(var attr in eval(ex),gobj)attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=gobj[attr]);eval("$locals_"+globals_id+" = obj")}else{var globals_is_dict=!1;if(_globals.$jsobj)var items=_globals.$jsobj;else{var items=_b_.dict.$to_obj(_globals);_globals.$jsobj=items,globals_is_dict=!0}for(var item in eval("$locals_"+globals_id+" = _globals.$jsobj"),items){var item1=$B.to_alias(item);try{eval("$locals_"+globals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}}if(_globals.$is_namespace=!0,_locals===_b_.None)if(_globals!==_b_.None)eval("var $locals_"+locals_id+" = $locals_"+globals_id);else{var lobj=current_frame[1],ex="",obj={};for(var attr in current_frame[1])attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=lobj[attr]);eval("$locals_"+locals_id+" = obj")}else{var locals_is_dict=!1;if(_locals.$jsobj)var items=_locals.$jsobj;else{locals_id_dict=!0;var items=_b_.dict.$to_obj(_locals);_locals.$jsobj=items}for(var item in items){var item1=$B.to_alias(item);try{eval("$locals_"+locals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}eval("$locals_"+locals_id+".$exec_locals = true")}_locals.$is_namespace=!0,_globals===_b_.None&&_locals===_b_.None&&current_frame[0]==current_frame[2]||eval("$locals_"+locals_id+".$src = src");var root=$B.py2js(src,globals_id,locals_id,parent_scope),js,gns,lns;if(_globals!==_b_.None&&_locals==_b_.None)for(var attr in _globals.$string_dict)root.binding[attr]=!0;try{var try_node=root.children[root.children.length-2],instr=try_node.children[try_node.children.length-2],type=instr.C.tree[0].type;switch(type){case"expr":case"list_or_tuple":case"op":case"ternary":var children=try_node.children;root.children.splice(root.children.length-2,2);for(var i=0;i<children.length-1;i++)root.add(children[i]);break;default:if("eval"==mode)throw _b_.SyntaxError.$factory("eval() argument must be an expression","<string>",1,1,src)}if("eval"!=mode){var last=$B.last(root.children),js=last.to_js();-1==["node_js"].indexOf(last.C.type)&&(last.to_js=function(){for(;js.endsWith("\n");)js=js.substr(0,js.length-1);for(;js.endsWith(";");)js=js.substr(0,js.length-1);return"return ("+js+")"}),js=root.to_js();var locals_obj=eval("$locals_"+locals_id),globals_obj=eval("$locals_"+globals_id);if(_globals===_b_.None)var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,js)(globals_obj,locals_obj);else{current_globals_obj=current_frame[3],current_locals_obj=current_frame[1];var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,"$locals_"+current_globals_id,"$locals_"+current_locals_id,js)(globals_obj,locals_obj,current_globals_obj,current_locals_obj)}$.src.mode&&"single"==$.src.mode&&"<stdin>"==$.src.filename&&res!==_b_.None&&void 0!==res&&_b_.print(_b_.repr(res))}else{js=root.to_js();var res=eval(js)}if("<console>"==$.src.filename&&"single"==$.src.mode&&void 0!==res&&res!==_b_.None&&_b_.print(res),gns=eval("$locals_"+globals_id),$B.frames_stack[$B.frames_stack.length-1][2]==globals_id&&(gns=$B.frames_stack[$B.frames_stack.length-1][3]),_locals!==_b_.None)for(var attr in lns=eval("$locals_"+locals_id),lns){var attr1=$B.from_alias(attr);"$"!=attr1.charAt(0)&&(_locals.$jsobj?_locals.$jsobj[attr]=lns[attr]:_b_.dict.$setitem(_locals,attr1,lns[attr]))}else for(var attr in lns)"$src"!==attr&&(current_frame[1][attr]=lns[attr]);if(_globals!==_b_.None){if(globals_is_dict){var jsobj=_globals.$jsobj;delete _globals.$jsobj}for(var attr in gns)attr1=$B.from_alias(attr),"$"!=attr1.charAt(0)&&(globals_is_dict?_b_.dict.$setitem(_globals,attr,gns[attr]):_globals.$jsobj[attr1]=gns[attr]);for(var attr in _globals.$string_dict)attr.startsWith("$")&&!attr.startsWith("$$")&&delete _globals.$string_dict[attr]}else for(var attr in gns)"$src"!==attr&&(current_frame[3][attr]=gns[attr]);return void 0===res?_b_.None:res}catch(n){throw n.src=src,n.module=globals_id,void 0===n.$py_error?$B.exception(n):n}finally{$B.frames_stack.length==stack_len+1&&$B.frames_stack.pop(),root=null,js=null,gns=null,lns=null,$B.clear_ns(globals_id),$B.clear_ns(locals_id)}}function exec(n,o,l){var x=$B.args("exec",3,{src:null,globals:null,locals:null},["src","globals","locals"],arguments,{globals:_b_.None,locals:_b_.None},null,null);return $$eval(x.src,x.globals,x.locals,"exec")||_b_.None}function exit(){throw _b_.SystemExit}enumerate.__iter__=function(n){return n.counter=n.start-1,n},enumerate.__next__=function(n){return n.counter++,$B.fast_tuple([n.counter,next(n.iter)])},$B.set_func_names(enumerate,"builtins"),$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.to_alias=function(n){return $B.aliased_names[n]?"$$"+n:n},$$eval.$is_func=!0,exec.$is_func=!0,exit.__repr__=exit.__str__=function(){return"Use exit() or Ctrl-Z plus Return to exit"};var filter=$B.make_class("filter",function(n,o){return check_no_kw("filter",n,o),check_nb_args("filter",2,arguments),o=iter(o),n===_b_.None&&(n=$B.$bool),{__class__:filter,func:n,iterable:o}});function format(n,o){var l=$B.args("format",2,{value:null,format_spec:null},["value","format_spec"],arguments,{format_spec:""},null,null),x=n.__class__||$B.get_class(n);try{var B=$B.$getattr(x,"__format__")}catch(D){throw D.__class__===_b_.AttributeError?_b_.NotImplementedError("__format__ is not implemented for object '"+_b_.str.$factory(n)+"'"):D}return $B.$call(B)(n,l.format_spec)}function attr_error(n,o){var l="bad operand type for unary #: '"+o+"'";switch(n){case"__neg__":throw _b_.TypeError.$factory(l.replace("#","-"));case"__pos__":throw _b_.TypeError.$factory(l.replace("#","+"));case"__invert__":throw _b_.TypeError.$factory(l.replace("#","~"));case"__call__":throw _b_.TypeError.$factory("'"+o+"' object is not callable");default:for(;"$"==n.charAt(0);)n=n.substr(1);throw _b_.AttributeError.$factory("'"+o+"' object has no attribute '"+n+"'")}}function getattr(){var n={},o=$B.args("getattr",3,{obj:null,attr:null,_default:null},["obj","attr","_default"],arguments,{_default:n},null,null);return $B.$getattr(o.obj,o.attr,o._default===n?void 0:o._default)}function in_mro(n,o){if(void 0===n)return!1;if(n.hasOwnProperty(o))return n[o];for(var l=n.__mro__,x=0,B=l.length;x<B;x++)if(l[x].hasOwnProperty(o))return l[x][o];return!1}function globals(){check_nb_args("globals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[3]);return n.$jsobj.__BRYTHON__=$B.JSObj.$factory($B),n.$is_namespace=!0,n}function hasattr(n,o){check_no_kw("hasattr",n,o),check_nb_args("hasattr",2,arguments);try{return $B.$getattr(n,o),!0}catch{return!1}}filter.__iter__=function(n){return n},filter.__next__=function(n){for(;;){var o=next(n.iterable);if(n.func(o))return o}},$B.set_func_names(filter,"builtins"),$B.$getattr=function(n,o,l){if(o=$B.to_alias(o),n.$method_cache&&n.$method_cache[o]&&n.__class__&&n.__class__[o]==n.$method_cache[o][1])return n.$method_cache[o][0];var x=o;void 0===n&&console.log("get attr",o,"of undefined");var B,D=n.$is_class||n.$factory,G=n.__class__;if(void 0!==G&&G.__bases__&&(0==G.__bases__.length||1==G.__bases__.length&&G.__bases__[0]===_b_.object)){if(n.hasOwnProperty(o))return n[o];if(n.__dict__&&n.__dict__.$string_dict.hasOwnProperty(o)&&(!G.hasOwnProperty(o)||!G[o].__get__))return n.__dict__.$string_dict[o][0];if(G.hasOwnProperty(o)&&"function"!=typeof G[o]&&"__dict__"!=o&&void 0===G[o].__get__&&!in_mro(G[o].__class__,"__get__"))return G[o]}if(void 0===G)if("string"==typeof n)G=_b_.str;else if("number"==typeof n)G=n%1==0?_b_.int:_b_.float;else if(n instanceof Number)G=_b_.float;else if(void 0===(G=$B.get_class(n))){if(void 0!==(P=n[o])){if("function"==typeof P){var M=function(){return P.apply(n,arguments)};return M.$infos={__name__:o,__qualname__:o},M}return $B.$JS2Py(P)}if(void 0!==l)return l;throw _b_.AttributeError.$factory("object has no attribute "+x)}switch(o){case"__call__":if("function"==typeof n){var P=function(){return n.apply(null,arguments)};return P.__class__=method_wrapper,P.$infos={__name__:"__call__"},P}break;case"__class__":return G;case"__dict__":if(D){var de={};for(var ye in n){var ie=$B.from_alias(ye);ie.startsWith("$")||(de[ie]=n[ye])}return de.__dict__=$B.getset_descriptor.$factory(n,"__dict__"),$B.mappingproxy.$factory(de)}if(n.hasOwnProperty(o))return n[o];if(n.$infos){if(n.$infos.hasOwnProperty("__dict__"))return n.$infos.__dict__;if(n.$infos.hasOwnProperty("__func__"))return n.$infos.__func__.$infos.__dict__}return $B.obj_dict(n);case"__doc__":for(var ce=0;ce<builtin_names.length;ce++)if(n===_b_[builtin_names[ce]])return _get_builtins_doc(),$B.builtins_doc[builtin_names[ce]];break;case"__mro__":if(n.$is_class)return _b_.tuple.$factory([n].concat(n.__mro__));if(n.__dict__&&void 0!==n.__dict__.$string_dict.__mro__)return n.__dict__.$string_dict.__mro__;throw _b_.AttributeError.$factory(o);case"__subclasses__":if(G.$factory||G.$is_class){var fe=n.$subclasses||[];return function(){return fe}}}if("function"==typeof n){var ae=n[o];if(void 0!==ae&&"__module__"==o)return ae}if(!D&&G.$native){if(n.$method_cache&&n.$method_cache[o])return n.$method_cache[o];if("__doc__"==o&&void 0===G[o]&&G.$infos&&(_get_builtins_doc(),G[o]=$B.builtins_doc[G.$infos.__name__]),void 0===G[o]){var W=_b_.object[o];if(void 0===W){var Z=n.__dict__;return Z&&void 0!==(W=Z.$string_dict[o])?W[0]:(void 0===l&&attr_error(o,G.$infos.__name__),l)}G[o]=W}if(G.$descriptors&&void 0!==G.$descriptors[o])return G[o](n);if("function"==typeof G[o]){var A=G[o];if("__new__"==o&&(A.$type="staticmethod"),"staticmethod"==A.$type)return A;var R=G[o].__class__==$B.method?G:n,X=G[o].bind(null,R);return X.__class__=$B.method,X.$infos={__func__:A,__name__:o,__self__:R,__qualname__:G.$infos.__name__+"."+o},"object"==typeof n&&(n.__class__=G,n.$method_cache=n.$method_cache||{},n.$method_cache[o]=X),X}if(void 0!==G[o])return G[o];attr_error(x,G.$infos.__name__)}if(D)B=_b_.type.__getattribute__;else if(void 0===(B=G.__getattribute__)){var he;void 0===(he=G.__mro__)&&console.log(n,o,"no mro, klass",G),ce=0;for(var U=he.length;ce<U&&void 0===(B=he[ce].__getattribute__);ce++);}if("function"!=typeof B&&console.log(o+" is not a function "+B,G),B===_b_.object.__getattribute__){if(P=n[o],Array.isArray(n)&&void 0!==Array.prototype[o]&&(P=void 0),null===P)return null;if(void 0===P&&n.hasOwnProperty(o)||void 0!==P&&(void 0===P.__set__||P.$is_class))return P}try{P=B(n,o)}catch(Q){if(void 0!==l)return l;throw Q}if(void 0!==P)return P;if(void 0!==l)return l;var Re=G.$infos.__name__;D&&(Re=n.$infos.__name__),attr_error(x,Re)};var hash_cache={};function hash(n){if(check_no_kw("hash",n),check_nb_args("hash",1,arguments),void 0!==n.__hashvalue__)return n.__hashvalue__;if(isinstance(n,_b_.bool))return _b_.int.$factory(n);if(isinstance(n,_b_.int))return void 0===n.$brython_value?n.valueOf():n.__hashvalue__=n.$brython_value;if(n.$is_class||n.__class__===_b_.type||n.__class__===$B.Function)return n.__hashvalue__=$B.$py_next_hash--;if("string"==typeof n){var o=hash_cache[n];return void 0!==o?o:hash_cache[n]=_b_.str.__hash__(n)}var l=n.__class__||$B.get_class(n);if(void 0===l)throw _b_.TypeError.$factory("unhashable type: '"+_b_.str.$factory($B.JSObj.$factory(n))+"'");var x=$B.$getattr(l,"__hash__",_b_.None);if(x===_b_.None)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'");if(x.$infos.__func__===_b_.object.__hash__){if($B.$getattr(n,"__eq__").$infos.__func__!==_b_.object.__eq__)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'","hash");return n.__hashvalue__=_b_.object.__hash__(n)}return $B.$call(x)(n)}function _get_builtins_doc(){if(void 0===$B.builtins_doc){var url=$B.brython_path;"/"==url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url+="/builtins_docstrings.js";var f=_b_.open(url);eval(f.$string),$B.builtins_doc=docs}}function help(n){if(void 0===n&&(n="help"),"string"==typeof n&&void 0!==_b_[n]){_get_builtins_doc();var o=$B.builtins_doc[n];if(void 0!==o&&""!=o)return void _b_.print(o)}for(var l=0;l<builtin_names.length;l++)n===_b_[builtin_names[l]]&&(_get_builtins_doc(),_b_.print(o=$B.builtins_doc[builtin_names[l]]));if("string"!=typeof n)try{return $B.$getattr(n,"__doc__")}catch{return""}else $B.$import("pydoc"),$B.$getattr($B.$getattr($B.imported.pydoc,"help"),"__call__")(n)}function hex(n){return check_no_kw("hex",n),check_nb_args("hex",1,arguments),bin_hex_oct(16,n)}function id(n){return check_no_kw("id",n),check_nb_args("id",1,arguments),isinstance(n,[_b_.str,_b_.int,_b_.float])&&!isinstance(n,$B.long_int)?$B.$getattr(_b_.str.$factory(n),"__hash__")():void 0!==n.$id?n.$id:n.$id=$B.UUID()}function __import__(n,o,l,x,B){var D=$B.args("__import__",5,{name:null,globals:null,locals:null,fromlist:null,level:null},["name","globals","locals","fromlist","level"],arguments,{globals:None,locals:None,fromlist:_b_.tuple.$factory(),level:0},null,null);return $B.$__import__(D.name,D.globals,D.locals,D.fromlist)}function input(n){var o=prompt(n||"")||"";return $B.imported.sys&&$B.imported.sys.ps1&&(n!=$B.imported.sys.ps1&&n!=$B.imported.sys.ps2||console.log(n,o)),o}function isinstance(n,o){if(check_no_kw("isinstance",n,o),check_nb_args("isinstance",2,arguments),null===n)return o===None;if(void 0===n)return!1;if(o.constructor===Array){for(var l=0;l<o.length;l++)if(isinstance(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("isinstance() arg 2 cannot be a parameterized generic");if(!o.__class__||void 0===o.$factory&&void 0===o.$is_class)throw _b_.TypeError.$factory("isinstance() arg 2 must be a type or tuple of types");if(o===_b_.int&&(n===True||n===False))return True;if(o===_b_.bool)switch(typeof n){case"string":case"number":return!1;case"boolean":return!0}var x=n.__class__;if(null==x){if("string"==typeof n){if(o==_b_.str)return!0;if($B.builtin_classes.indexOf(o)>-1)return!1}else if(n.contructor===Number&&Number.isFinite(n)){if(o==_b_.float)return!0}else if("number"==typeof n&&Number.isFinite(n)&&Number.isFinite(n)&&o==_b_.int)return!0;x=$B.get_class(n)}if(void 0===x)return!1;function B(M,P){return M===P||P===_b_.str&&M===$B.StringSubclass||P===_b_.int&&M===$B.IntSubclass||void 0}if(B(x,o))return!0;var D=x.__mro__;for(l=0;l<D.length;l++)if(B(D[l],o))return!0;var G=$B.$getattr(o.__class__||$B.get_class(o),"__instancecheck__",_b_.None);return G!==_b_.None&&G(o,n)}function issubclass(n,o){if(check_no_kw("issubclass",n,o),check_nb_args("issubclass",2,arguments),!n.__class__||void 0===n.$factory&&void 0===n.$is_class)throw _b_.TypeError.$factory("issubclass() arg 1 must be a class");if(isinstance(o,_b_.tuple)){for(var l=0;l<o.length;l++)if(issubclass(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("issubclass() arg 2 cannot be a parameterized generic");if((o.$factory||o.$is_class)&&(n===o||n.__mro__.indexOf(o)>-1))return!0;var x=$B.$getattr(o.__class__||$B.get_class(o),"__subclasscheck__",_b_.None);return x!=_b_.None&&x(o,n)}help.__repr__=help.__str__=function(){return"Type help() for interactive help, or help(object) for help about object."};var iterator_class=$B.make_class("iterator",function(n,o){return{__class__:iterator_class,getitem:n,len:o,counter:-1}});function iter(){var n=$B.args("iter",1,{obj:null},["obj"],arguments,{},"args","kw");if(n.args.length>0)var o=n.args[0];return $B.$iter(n.obj,o)}function len(n){check_no_kw("len",n),check_nb_args("len",1,arguments);var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__len__")}catch{throw _b_.TypeError.$factory("object of type '"+$B.class_name(n)+"' has no len()")}return $B.$call(l)(n)}function locals(){check_nb_args("locals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[1]);return n.$is_namespace=!0,delete n.$jsobj.__annotations__,n}iterator_class.__next__=function(n){if(n.counter++,null!==n.len&&n.counter==n.len)throw _b_.StopIteration.$factory("");try{return n.getitem(n.counter)}catch{throw _b_.StopIteration.$factory("")}},callable_iterator=$B.make_class("callable_iterator",function(n,o){return{__class__:callable_iterator,func:n,sentinel:o}}),callable_iterator.__iter__=function(n){return n},callable_iterator.__next__=function(n){var o=n.func();if($B.rich_comp("__eq__",o,n.sentinel))throw _b_.StopIteration.$factory();return o},$B.$iter=function(n,o){if(void 0===o){var l=n.__class__||$B.get_class(n);try{var x=$B.$call($B.$getattr(l,"__iter__"))}catch(G){if(G.__class__===_b_.AttributeError)try{var B=$B.$call($B.$getattr(l,"__getitem__"));return len(n),iterator_class.$factory(function(M){return B(n,M)},len)}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not iterable")}throw G}var D=$B.$call(x)(n);try{$B.$getattr(D,"__next__")}catch(G){if(isinstance(G,_b_.AttributeError))throw _b_.TypeError.$factory("iter() returned non-iterator of type '"+$B.class_name(D)+"'")}return D}return callable_iterator.$factory(n,o)};var map=$B.make_class("map",function(){var n=$B.args("map",2,{func:null,it1:null},["func","it1"],arguments,{},"args",null),o=$B.$call(n.func),l=[$B.$iter(n.it1)];return n.args.forEach(function(x){l.push($B.$iter(x))}),{__class__:map,args:l,func:o}});function $extreme(n,o){var l="min";if("__gt__"===o&&(l="max"),0==n.length)throw _b_.TypeError.$factory(l+" expected 1 arguments, got 0");var x=n[n.length-1],B=n.length,D=!1,G=!1;if("kw"==x.$nat)for(var M in B--,x=x.kw)switch(M){case"key":G=x[M];break;case"$$default":var P=x[M];D=!0;break;default:throw _b_.TypeError.$factory("'"+M+"' is an invalid keyword argument for this function")}if(G||(G=function(fe){return fe}),0==B)throw _b_.TypeError.$factory(l+" expected 1 argument, got 0");if(1!=B){if(D)throw _b_.TypeError.$factory("Cannot specify a default for "+l+"() with multiple positional arguments");ie=null;for(var de=0;de<B;de++)ce=n[de],(null===ie||$B.$bool($B.$getattr(G(ce),o)(G(ie))))&&(ie=ce);return ie}for(var ye=iter(n[0]),ie=null;;)try{var ce=next(ye);(null===ie||$B.$bool($B.$getattr(G(ce),o)(G(ie))))&&(ie=ce)}catch(fe){if(fe.__class__==_b_.StopIteration){if(null===ie){if(D)return P;throw _b_.ValueError.$factory(l+"() arg is an empty sequence")}return ie}throw fe}}function max(){return $extreme(arguments,"__gt__")}map.__iter__=function(n){return n},map.__next__=function(n){for(var o=[],l=0;l<n.args.length;l++)o.push(next(n.args[l]));return n.func.apply(null,o)},$B.set_func_names(map,"builtins");var memoryview=$B.make_class("memoryview",function(n){if(check_no_kw("memoryview",n),check_nb_args("memoryview",1,arguments),n.__class__===memoryview)return n;if($B.get_class(n).$buffer_protocol)return{__class__:memoryview,obj:n,format:"B",itemsize:1,ndim:1,shape:_b_.tuple.$factory([_b_.len(n)]),strides:_b_.tuple.$factory([1]),suboffsets:_b_.tuple.$factory([]),c_contiguous:!0,f_contiguous:!0,contiguous:!0};throw _b_.TypeError.$factory("memoryview: a bytes-like object is required, not '"+$B.class_name(n)+"'")});function min(){return $extreme(arguments,"__lt__")}function next(n){check_no_kw("next",n);var o={},l=$B.args("next",2,{obj:null,def:null},["obj","def"],arguments,{def:o},null,null),x=n.__class__||$B.get_class(n),B=$B.$call($B.$getattr(x,"__next__"));if(void 0!==B)try{return $B.$call(B)(n)}catch(D){if(D.__class__===_b_.StopIteration&&l.def!==o)return l.def;throw D}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not an iterator")}memoryview.__eq__=function(n,o){return o.__class__===memoryview&&$B.$getattr(n.obj,"__eq__")(o.obj)},memoryview.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o*n.itemsize;if("I"==n.format){for(var x=n.obj.source[l],B=256,D=1;D<4;D++)x+=n.obj.source[l+D]*B,B*=256;return x}if("B".indexOf(n.format)>-1){if(o>n.obj.source.length-1)throw _b_.KeyError.$factory(o);return n.obj.source[o]}return n.obj.source[o]}if(x=n.obj.__class__.__getitem__(n.obj,o),o.__class__===_b_.slice)return memoryview.$factory(x)},memoryview.__len__=function(n){return len(n.obj)/n.itemsize},memoryview.cast=function(n,o){switch(o){case"B":return memoryview.$factory(n.obj);case"I":var l=memoryview.$factory(n.obj),x=len(n.obj);if(l.itemsize=4,l.format="I",x%4!=0)throw _b_.TypeError.$factory("memoryview: length is not a multiple of itemsize");return l}},memoryview.hex=function(n){var o="";return _b_.bytes.$factory(n).source.forEach(function(l){o+=l.toString(16)}),o},memoryview.tobytes=function(n){return _b_.bytes.$factory(n.obj)},memoryview.tolist=function(n){if(1==n.itemsize)return _b_.list.$factory(_b_.bytes.$factory(n.obj));if(4==n.itemsize&&"I"==n.format){for(var o=[],l=0;l<n.obj.source.length;l+=4){for(var x=n.obj.source[l],B=256,D=1;D<4;D++)x+=B*n.obj.source[l+D],B*=256;o.push(x)}return o}},$B.set_func_names(memoryview,"builtins");var NotImplementedType=$B.make_class("NotImplementedType",function(){return NotImplemented});NotImplementedType.__repr__=NotImplementedType.__str__=function(n){return"NotImplemented"};var NotImplemented={__class__:NotImplementedType};function $not(n){return!$B.$bool(n)}function oct(n){return check_no_kw("oct",n),check_nb_args("oct",1,arguments),bin_hex_oct(8,n)}function ord(n){if(check_no_kw("ord",n),check_nb_args("ord",1,arguments),"string"==typeof n){if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found")}switch($B.get_class(n)){case _b_.str:if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found");case _b_.str.$surrogate:if(1==n.items.length)return n.items[0].codePointAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.items.length+" found");case _b_.bytes:case _b_.bytearray:if(1==n.source.length)return n.source[0];throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.source.length+" found");default:throw _b_.TypeError.$factory("ord() expected a character, but "+$B.class_name(n)+" was found")}}function pow(){var n=$B.args("pow",3,{x:null,y:null,mod:null},["x","y","mod"],arguments,{mod:None},null,null),o=n.x,l=n.y,x=n.mod,B=o.__class__||$B.get_class(o);if(x===_b_.None)return $B.$call($B.$getattr(B,"__pow__"))(o,l);if(o!=_b_.int.$factory(o)||l!=_b_.int.$factory(l))throw _b_.TypeError.$factory("pow() 3rd argument not allowed unless all arguments are integers");return $B.$call($B.$getattr(B,"__pow__"))(o,l,x)}function $print(){var n=$B.args("print",0,{},[],arguments,{},"args","kw"),o=n.kw.$string_dict,l=void 0===o.end||o.end===None?"\n":o.end[0],x=void 0===o.sep||o.sep===None?" ":o.sep[0],B=void 0===o.file?$B.stdout:o.file[0],G=[];n.args.forEach(function(de){G.push(_b_.str.$factory(de))});var M=G.join(x)+l;M=M.replace(new RegExp("\x07","g"),"").replace(new RegExp("(.)\b","g"),""),$B.$getattr(B,"write")(M);var P=$B.$getattr(B,"flush",None);return P!==None&&P(),None}$print.__name__="print",$print.is_func=!0;var property=$B.make_class("property",function(n,o,l,x){var B={__class__:property};return property.__init__(B,n,o,l,x),B});function quit(){throw _b_.SystemExit}function repr(n){check_no_kw("repr",n),check_nb_args("repr",1,arguments);var o=n.__class__||$B.get_class(n);return $B.$call($B.$getattr(o,"__repr__"))(n)}property.__init__=function(n,o,l,x,B){if(n.__doc__=B||"",n.$type=o.$type,n.fget=o,n.fset=l,n.fdel=x,o&&o.$attrs)for(var D in o.$attrs)n[D]=o.$attrs[D];n.__get__=function(G,M,P){if(void 0===M)return G;if(void 0===G.fget)throw _b_.AttributeError.$factory("unreadable attribute");return $B.$call(G.fget)(M)},void 0!==l&&(n.__set__=function(G,M,P){if(void 0===G.fset)throw _b_.AttributeError.$factory("can't set attribute");$B.$getattr(G.fset,"__call__")(M,P)}),n.__delete__=x,n.getter=function(G){return property.$factory(G,n.fset,n.fdel,n.__doc__)},n.setter=function(G){return property.$factory(n.fget,G,n.fdel,n.__doc__)},n.deleter=function(G){return property.$factory(n.fget,n.fset,G,n.__doc__)}},property.__repr__=function(n){return _b_.repr(n.fget(n))},property.__str__=function(n){return _b_.str.$factory(n.fget(n))},$B.set_func_names(property,"builtins"),quit.__repr__=quit.__str__=function(){return"Use quit() or Ctrl-Z plus Return to exit"};var reversed=$B.make_class("reversed",function(n){check_no_kw("reversed",n),check_nb_args("reversed",1,arguments);var o=n.__class__||$B.get_class(n),l=$B.$getattr(o,"__reversed__",null);if(null!==l)return $B.$call(l)(n);try{var x=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("argument to reversed() must be a sequence")}return{__class__:reversed,$counter:_b_.len(n),getter:function(D){return $B.$call(x)(n,D)}}});function round(){var n=$B.args("round",2,{number:null,ndigits:null},["number","ndigits"],arguments,{ndigits:None},null,null),o=n.number,l=n.ndigits===None?0:n.ndigits;if(!isinstance(o,[_b_.int,_b_.float])){var x=o.__class__||$B.get_class(o);try{return $B.$call($B.$getattr(x,"__round__")).apply(null,arguments)}catch(P){throw P.__class__===_b_.AttributeError?_b_.TypeError.$factory("type "+$B.class_name(o)+" doesn't define __round__ method"):P}}if(isinstance(o,_b_.float)&&(o.value===1/0||o.value===-1/0))throw _b_.OverflowError.$factory("cannot convert float infinity to integer");if(!isinstance(l,_b_.int))throw _b_.TypeError.$factory("'"+$B.class_name(l)+"' object cannot be interpreted as an integer");var B,D=Math.pow(10,l),G=o*D,M=Math.floor(G);return.5==Math.abs(G-M)?(M%2&&(M+=1),B=_b_.int.__truediv__(M,D)):B=_b_.int.__truediv__(Math.round(G),D),n.ndigits===None?B.valueOf():o instanceof Number?new Number(B):B.valueOf()}function setattr(){var n=$B.args("setattr",3,{obj:null,attr:null,value:null},["obj","attr","value"],arguments,{},null,null),o=n.obj,l=n.attr,x=n.value;if("string"!=typeof l)throw _b_.TypeError.$factory("setattr(): attribute name must be string");return $B.$setattr(o,l,x)}function sorted(){for(var n=$B.args("sorted",1,{iterable:null},["iterable"],arguments,{},null,"kw"),o=_b_.list.$factory(iter(n.iterable)),l=[o],x=1;x<arguments.length;x++)l.push(arguments[x]);return _b_.list.sort.apply(null,l),o}reversed.__iter__=function(n){return n},reversed.__next__=function(n){if(n.$counter--,n.$counter<0)throw _b_.StopIteration.$factory("");return n.getter(n.$counter)},$B.set_func_names(reversed,"builtins"),$B.$setattr=function(n,o,l){if($B.aliased_names[o])o="$$"+o;else{if("__dict__"==o){if(!isinstance(l,_b_.dict))throw _b_.TypeError.$factory("__dict__ must be set to a dictionary, not a '"+$B.class_name(l)+"'");return n.$infos?(n.$infos.__dict__=l,None):(n.__dict__=l,None)}if("__class__"==o){let A=function(R){throw _b_.TypeError.$factory(R)};if(l.__class__)if("builtins"==l.__module__)A("__class__ assignement only supported for heap types or ModuleType subclasses");else if(Array.isArray(l.__bases__))for(var x=0;x<l.__bases__.length;x++)"builtins"==l.__bases__[x].__module__&&A("__class__ assignment: '"+$B.class_name(n)+"' object layout differs from '"+$B.class_name(l)+"'");return n.__class__=l,None}"__doc__"==o&&n.__class__===_b_.property&&(n[o]=l)}if(n.$factory||n.$is_class){var B=n.__class__;return B&&B[o]&&B[o].__get__&&B[o].__set__?(B[o].__set__(n,l),None):(n[o]=l,"__init__"==o||"__new__"==o?n.$factory=$B.$instance_creator(n):"__bases__"==o&&(n.__mro__=_b_.type.mro(n)),None)}var D=n[o],G=n.__class__||$B.get_class(n);if(void 0===D&&G&&void 0===(D=G[o])){var M=(ce=G.__mro__).length;for(x=0;x<M&&void 0===(D=ce[x][o]);x++);}if(null!=D){if(void 0!==D.__set__)return D.__set__(D,n,l),None;var P,de=D.__class__;if(void 0!==de&&void 0===(P=de.__set__))for(x=0,M=(ce=de.__mro__).length;x<M&&!(P=ce[x].__set__);x++);if(void 0!==P){var ye=$B.$getattr(D,"__set__",null);if(ye&&"function"==typeof ye)return ye.apply(D,[n,l]),None}else if(G&&void 0!==G.$descriptors&&void 0!==G[o]){var ie=G[o].setter;if("function"==typeof ie)return ie(n,l),None;throw _b_.AttributeError.$factory("readonly attribute")}}var ce,fe=!1;if(void 0!==G&&void 0===(fe=G.__setattr__))for(x=0,M=(ce=G.__mro__).length-1;x<M&&!(fe=ce[x].__setattr__);x++);if(G&&G.__slots__&&-1==["__module__"].indexOf(o)&&!fe){let A=function(R){return R.__slots__?Array.isArray(R.__slots__)?R.__slots__.map(function(X){return X.startsWith("__")&&!X.endsWith("_")?"_"+R.$infos.__name__+X:X}):R.__slots__:[]};var ae=!1;if(A(G).indexOf(o)>-1)ae=!0;else for(x=0;x<G.__mro__.length;x++)if(A(G.__mro__[x]).indexOf(o)>-1){ae=!0;break}if(!ae)throw _b_.AttributeError.$factory("'"+G.$infos.__name__+"' object has no attribute '"+o+"'")}return fe?fe(n,o,l):void 0===n.__dict__?n[o]=l:_b_.dict.$setitem(n.__dict__,o,l),None};var staticmethod=$B.make_class("staticmethod",function(n){var o={$infos:n.$infos,__get__:function(){return n}};return o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});function sum(n,o){var l=$B.args("sum",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null);if(n=l.iterable,_b_.isinstance(o=l.start,[_b_.str,_b_.bytes]))throw _b_.TypeError.$factory("TypeError: sum() can't sum bytes [use b''.join(seq) instead]");var x=o;for(n=iter(n);;)try{var B=next(n);x=$B.$getattr(x,"__add__")(B)}catch(D){if(D.__class__===_b_.StopIteration)break;throw D}return x}$B.set_func_names(staticmethod,"builtins"),$B.missing_super2=function(n){return n.$missing=!0,n};var $$super=$B.make_class("super",function(n,o){if(void 0===n&&void 0===o){var l=$B.last($B.frames_stack),x=$B.imported._sys.Getframe();if(!x.f_code||!x.f_code.co_varnames||void 0===(n=l[1].__class__))throw _b_.RuntimeError.$factory("super(): no arguments");o=l[1][x.f_code.co_varnames[0]]}return Array.isArray(o)&&(o=o[0]),{__class__:$$super,__thisclass__:n,__self_class__:o}});function vars(){var n={},o=$B.args("vars",1,{obj:null},["obj"],arguments,{obj:n},null,null);if(o.obj===n)return _b_.locals();try{return $B.$getattr(o.obj,"__dict__")}catch(l){throw l.__class__===_b_.AttributeError?_b_.TypeError.$factory("vars() argument must have __dict__ attribute"):l}}$$super.__get__=function(n,o,l){return $$super.$factory(n.__thisclass__,o)},$$super.__getattribute__=function(n,o){var l=n.__thisclass__.__mro__,x=n.__self_class__;if(void 0!==x){x.$is_class||(x=x.__class__||$B.get_class(x));for(var B=[x].concat(x.__mro__),D=0;D<B.length;D++)if(B[D]===n.__thisclass__){l=B.slice(D+1);break}}D=0;for(var G,M,P=l.length;D<P;D++)if(void 0!==l[D][o]){G=l[D][o];break}if(void 0===G){if(void 0!==$$super[o])return M=n,function(){for(var ce=[M],fe=0,ae=arguments.length;fe<ae;fe++)ce.push(arguments[fe]);return $$super[o].apply(null,ce)};throw _b_.AttributeError.$factory(o)}if("staticmethod"==G.$type||"__new__"==o||"function"!=typeof G)return G;G.__class__===$B.method&&(G=G.$infos.__func__);var de,ye=$B.$call(G),ie=function(){return ye(n.__self_class__,...arguments)};return ie.__class__=$B.method,void 0!==G.$infos?de=G.$infos.__module__:G.__class__===property?de=G.fget.$infos.__module:G.$is_class&&(de=G.__module__),ie.$infos={__self__:n.__self_class__,__func__:G,__name__:o,__module__:de,__qualname__:n.__thisclass__.$infos.__name__+"."+o},ie},$$super.__repr__=$$super.__str__=function(n){var o="<super: <class '"+n.__thisclass__.$infos.__name__+"'>";return(o+=void 0!==n.__self_class__?", <"+n.__self_class__.__class__.$infos.__name__+" object>":", NULL")+">"},$B.set_func_names($$super,"builtins");var $Reader=$B.make_class("Reader");function make_content(n){n.$binary&&void 0===n.$bytes?n.$bytes=_b_.str.encode(n.$string,n.encoding):n.$binary||void 0!==n.$string||(n.$string=_b_.bytes.decode(n.$bytes,n.encoding))}function make_lines(n){if(void 0===n.$lines)if(make_content(n),n.$binary){console.log("make lines, binary");for(var o=[],l=n.$bytes.source;;){var x=l.indexOf(10);if(-1==x){o.push({__class__:_b_.bytes,source:l});break}o.push({__class__:_b_.bytes,source:l.slice(0,x+1)}),l=l.slice(x+1)}n.$lines=o}else n.$lines=n.$string.split("\n")}$Reader.__enter__=function(n){return n},$Reader.__exit__=function(n){return!1},$Reader.__iter__=function(n){return iter($Reader.readlines(n))},$Reader.__len__=function(n){return n.lines.length},$Reader.close=function(n){n.closed=!0},$Reader.flush=function(n){return None},$Reader.read=function(){var n=$B.args("read",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null),o=n.self,l=$B.$GetInt(n.size);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");return make_content(o),l<0&&(l=(o.$binary?o.$bytes.source.length:o.$string.length)-o.$counter),res=o.$binary?_b_.bytes.$factory(o.$bytes.source.slice(o.$counter,o.$counter+l)):o.$string.substr(o.$counter,l),o.$counter+=l,res},$Reader.readable=function(n){return!0},$Reader.readline=function(n,o){var l=$B.args("readline",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null);if(n=l.self,o=$B.$GetInt(l.size),n.$lc=void 0===n.$lc?-1:n.$lc,!0===n.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(make_content(n),n.$binary){var x;if(-1==(x=n.$bytes.source.indexOf(10,n.$counter)))return _b_.bytes.$factory();var B={__class__:_b_.bytes,source:n.$bytes.source.slice(n.$counter,x+1)};return n.$counter=x+1,B}return-1==(x=n.$string.indexOf("\n",n.$counter))?"":(B=n.$string.substring(n.$counter,x+1),n.$counter=x+1,n.$lc+=1,B)},$Reader.readlines=function(){var n=$B.args("readlines",2,{self:null,hint:null},["self","hint"],arguments,{hint:-1},null,null),o=n.self,l=$B.$GetInt(n.hint);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(o.$lc=void 0===o.$lc?-1:o.$lc,make_lines(o),l<0)var x=o.$lines.slice(o.$lc+1);else for(x=[];o.$lc<o.$lines.length&&0<l;)o.$lc++,x.push(o.$lines[o.$lc]);for(;""==x[x.length-1];)x.pop();return x},$Reader.seek=function(n,o,l){if(n.closed===True)throw _b_.ValueError.$factory("I/O operation on closed file");void 0===l&&(l=0),0===l?n.$counter=o:1===l?n.$counter+=o:2===l&&(n.$counter=n.$content.length+o)},$Reader.seekable=function(n){return!0},$Reader.tell=function(n){return n.$counter},$Reader.writable=function(n){return!1},$B.set_func_names($Reader,"builtins");var $BufferedReader=$B.make_class("_io.BufferedReader");$BufferedReader.__mro__=[$Reader,_b_.object];var $TextIOWrapper=$B.make_class("_io.TextIOWrapper",function(){var n=$B.args("TextIOWrapper",6,{buffer:null,encoding:null,errors:null,newline:null,line_buffering:null,write_through:null},["buffer","encoding","errors","newline","line_buffering","write_through"],arguments,{encoding:"utf-8",errors:_b_.None,newline:_b_.None,line_buffering:_b_.False,write_through:_b_.False},null,null);return{__class__:$TextIOWrapper,$bytes:n.buffer.$bytes,encoding:n.encoding,errors:n.errors,newline:n.newline}});function $url_open(){var $ns=$B.args("open",3,{file:null,mode:null,encoding:null},["file","mode","encoding"],arguments,{mode:"r",encoding:"utf-8"},"args","kw"),$bytes,$string,$res;for(var attr in $ns)eval("var "+attr+'=$ns["'+attr+'"]');if(args.length>0)var mode=args[0];if(args.length>1)var encoding=args[1];if(mode.search("w")>-1)throw _b_.IOError.$factory("Browsers cannot write on disk");if(-1==["r","rb"].indexOf(mode))throw _b_.ValueError.$factory("Invalid mode '"+mode+"'");if(isinstance(file,_b_.str)){var is_binary=mode.search("b")>-1;if($B.file_cache.hasOwnProperty($ns.file))$string=$B.file_cache[$ns.file];else if($B.files&&$B.files.hasOwnProperty($ns.file)){$res=atob($B.files[$ns.file].content);var source=[];for(const n of $res)source.push(n.charCodeAt(0));$bytes=_b_.bytes.$factory(),$bytes.source=source}else{if("file"==$B.protocol)throw _b_.FileNotFoundError.$factory("cannot use 'open()' with protocol 'file'");if(is_binary)throw _b_.IOError.$factory("open() in binary mode is not supported");var req=new XMLHttpRequest;req.onreadystatechange=function(){try{var n=this.status;$res=404==n?_b_.FileNotFoundError.$factory(file):200!=n?_b_.IOError.$factory("Could not open file "+file+" : status "+n):this.responseText}catch(o){$res=_b_.IOError.$factory("Could not open file "+file+" : error "+o)}};var fake_qs=$B.$options.cache?"":"?foo="+(new Date).getTime();if(req.open("GET",file+fake_qs,!1),req.overrideMimeType("text/plain; charset=utf-8"),req.send(),$res.constructor===Error)throw $res;$string=$res}if(void 0===$string&&void 0===$bytes)throw _b_.FileNotFoundError.$factory($ns.file);var res={$binary:is_binary,$string,$bytes,$counter:0,closed:False,encoding,mode,name:file};return res.__class__=is_binary?$BufferedReader:$TextIOWrapper,res}throw _b_.TypeError.$factory("invalid argument for open(): "+_b_.str.$factory(file))}$TextIOWrapper.__mro__=[$Reader,_b_.object],$B.set_func_names($TextIOWrapper,"builtins"),$B.Reader=$Reader,$B.TextIOWrapper=$TextIOWrapper,$B.BufferedReader=$BufferedReader;var zip=$B.make_class("zip",function(){var n={__class__:zip,items:[]};if(0==arguments.length)return n;for(var o=$B.args("zip",0,{},[],arguments,{},"args","kw").args,l=[],x=0;x<o.length;x++)l.push(iter(o[x]));for(var B=0,D=[];;){var G=[],M=!0;for(x=0;x<l.length;x++)try{G.push(next(l[x]))}catch(P){if(P.__class__==_b_.StopIteration){M=!1;break}throw P}if(!M)break;D[B++]=_b_.tuple.$factory(G)}return n.items=D,n}),zip_iterator=$B.make_iterator_class("zip_iterator");function no_set_attr(n,o){throw _b_.AttributeError.$factory(void 0!==n[o]?"'"+n.$infos.__name__+"' object attribute '"+o+"' is read-only":"'"+n.$infos.__name__+"' object has no attribute '"+o+"'")}zip.__iter__=function(n){return zip_iterator.$factory(n.items)},$B.set_func_names(zip,"builtins");var True=!0,False=!1,ellipsis=$B.make_class("ellipsis",function(){return Ellipsis}),Ellipsis={__class__:ellipsis,__bool__:function(){return True}};for(var $key in $B.$comps)switch($B.$comps[$key]){case"ge":case"gt":case"le":case"lt":ellipsis["__"+$B.$comps[$key]+"__"]=function(n){return function(o){throw _b_.TypeError.$factory("unorderable types: ellipsis() "+n+" "+$B.class_name(o))}}($key)}for(var $func in Ellipsis)"function"==typeof Ellipsis[$func]&&(Ellipsis[$func].__str__=function(o){return function(){return"<method-wrapper "+o+" of Ellipsis object>"}}($func));$B.set_func_names(ellipsis);var FunctionCode=$B.make_class("function code"),FunctionGlobals=$B.make_class("function globals");$B.Function={__class__:_b_.type,__code__:{__class__:FunctionCode,__name__:"function code"},__globals__:{__class__:FunctionGlobals,__name__:"function globals"},__mro__:[_b_.object],$infos:{__name__:"function",__module__:"builtins"},$is_class:!0},$B.Function.__delattr__=function(n,o){if("__dict__"==o)throw _b_.TypeError.$factory("can't deleted function __dict__")},$B.Function.__dir__=function(n){var l=n.$attrs||{};return Object.keys(n.$infos||{}).concat(Object.keys(l))},$B.Function.__eq__=function(n,o){return n===o},$B.Function.__get__=function(n,o){if(o===_b_.None)return n;var l=function(){return n(o,...arguments)};return l.__class__=$B.method,void 0===n.$infos&&(console.log("no $infos",n),console.log($B.last($B.frames_stack))),l.$infos={__name__:n.$infos.__name__,__qualname__:$B.class_name(o)+"."+n.$infos.__name__,__self__:o,__func__:n},l},$B.Function.__getattribute__=function(n,o){if(!n.$infos||void 0===n.$infos[o]){if(n.$infos&&n.$infos.__dict__&&void 0!==n.$infos.__dict__.$string_dict[o])return n.$infos.__dict__.$string_dict[o][0];if("__closure__"==o){var l=n.$infos.__code__.co_freevars;if(0==l.length)return None;for(var x=[],B=0;B<l.length;B++)try{x.push($B.cell.$factory($B.$check_def_free(l[B])))}catch{x.push($B.cell.$factory(None))}return _b_.tuple.$factory(x)}return"__globals__"==o?$B.obj_dict($B.imported[n.$infos.__module__]):n.$attrs&&void 0!==n.$attrs[o]?n.$attrs[o]:_b_.object.__getattribute__(n,o)}if("__code__"==o){var D={__class__:code};for(var o in n.$infos.__code__)D[o]=n.$infos.__code__[o];return D.name=n.$infos.__name__,D.filename=n.$infos.__code__.co_filename,D.co_code=n+"",D}return"__annotations__"==o?$B.obj_dict(n.$infos[o]):n.$infos.hasOwnProperty(o)?n.$infos[o]:void 0},$B.Function.__repr__=$B.Function.__str__=function(n){return void 0===n.$infos?"<function "+n.name+">":"<function "+n.$infos.__qualname__+">"},$B.Function.__mro__=[_b_.object],$B.Function.__setattr__=function(n,o,l){if("__closure__"==o)throw _b_.AttributeError.$factory("readonly attribute");if("__defaults__"==o){if(l===_b_.None)l=[];else if(!isinstance(l,_b_.tuple))throw _b_.TypeError.$factory("__defaults__ must be set to a tuple object");var x=n.$set_defaults;if(void 0===x||!n.$infos||!n.$infos.__code__)throw _b_.AttributeError.$factory("cannot set attribute "+o+" of "+_b_.str.$factory(n));for(var D=n.$infos.__code__.co_varnames.slice(0,n.$infos.__code__.co_argcount),G={},M=l.length-1;M>=0;M--){var P=D.length-l.length+M;if(P<0)break;G[D[P]]=l[M]}var de=n.$infos.$class,ye=x(G);return ye.$set_defaults=x,de?(de[n.$infos.__name__]=ye,ye.$infos.$class=de,ye.$infos.__defaults__=l):(n.$infos.$defaults=l,n.$infos.__defaults__=l),_b_.None}void 0!==n.$infos[o]?n.$infos[o]=l:(n.$attrs=n.$attrs||{},n.$attrs[o]=l)},$B.Function.$factory=function(){},$B.set_func_names($B.Function,"builtins"),_b_.__BRYTHON__=__BRYTHON__,$B.builtin_funcs=["abs","all","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dir","divmod","eval","exec","exit","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","locals","max","min","next","oct","open","ord","pow","print","quit","repr","round","setattr","sorted","sum","vars"];var builtin_function=$B.builtin_function=$B.make_class("builtin_function_or_method");builtin_function.__getattribute__=$B.Function.__getattribute__,builtin_function.__reduce_ex__=builtin_function.__reduce__=function(n){return n.$infos.__name__},builtin_function.__repr__=builtin_function.__str__=function(n){return"<built-in function "+n.$infos.__name__+">"},$B.set_func_names(builtin_function,"builtins");var method_wrapper=$B.make_class("method_wrapper");method_wrapper.__repr__=method_wrapper.__str__=function(n){return"<method wrapper '"+n.$infos.__name__+"' of function object>"},$B.set_func_names(method_wrapper,"builtins");var wrapper_descriptor=$B.wrapper_descriptor=$B.make_class("wrapper_descriptor");wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,wrapper_descriptor.__repr__=wrapper_descriptor.__str__=function(n){return"<slot wrapper '"+n.$infos.__name__+"' of '"+n.__objclass__.$infos.__name__+"' object>"},$B.set_func_names(wrapper_descriptor,"builtins"),$B.builtin_classes=["bool","bytearray","bytes","classmethod","complex","dict","enumerate","filter","float","frozenset","int","list","map","memoryview","object","property","range","reversed","set","slice","staticmethod","str","super","tuple","type","zip"];for(var other_builtins=["Ellipsis","False","None","True","__debug__","__import__","copyright","credits","license","NotImplemented"],builtin_names=$B.builtin_funcs.concat($B.builtin_classes).concat(other_builtins),i=0;i<builtin_names.length;i++){var name=builtin_names[i],orig_name=name,name1=name;"open"==name&&(name1="$url_open"),"super"==name&&(name=name1="$$super"),"eval"==name&&(name=name1="$$eval"),"print"==name&&(name1="$print");try{_b_[name]=eval(name1),$B.builtin_funcs.indexOf(orig_name)>-1&&(_b_[name].__class__=builtin_function,_b_[name].$infos={__module__:"builtins",__name__:orig_name,__qualname__:orig_name})}catch(n){}}_b_.open=$url_open,_b_.print=$print,_b_.$$super=$$super,_b_.object.__init__.__class__=wrapper_descriptor,_b_.object.__new__.__class__=builtin_function}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns),$B.del_exc=function(){$B.last($B.frames_stack)[1].$current_exception=void 0},$B.set_exc=function(n){var o=$B.last($B.frames_stack);void 0===o&&console.log("no frame",n),o[1].$current_exception=$B.exception(n)},$B.get_exc=function(){return $B.last($B.frames_stack)[1].$current_exception},$B.$raise=function(n){if(void 0===n){var o=$B.get_exc();throw void 0!==o?o:_b_.RuntimeError.$factory("No active exception to reraise")}throw isinstance(n,BaseException)?(n.__class__===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator&&(n=_b_.RuntimeError.$factory("generator raised StopIteration")),n):n.$is_class&&issubclass(n,BaseException)?n===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator?_b_.RuntimeError.$factory("generator raised StopIteration"):$B.$call(n)():_b_.TypeError.$factory("exceptions must derive from BaseException")},$B.$syntax_err_line=function(n,o,l,x,B){var D={},G=1;if(o="$"==o.charAt(0)?"<string>":o,void 0===l)n.$line_info=B+","+o,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,B,0,0]);else{for(var M={1:0},P=0,de=l.length;P<de;P++)D[P]=G,"\n"==l.charAt(P)&&(M[++G]=P);for(;void 0===B;)B=D[x],x--;n.$line_info=B+","+o;var ye=l.split("\n")[B-1],ie=x-M[B];for(de=ye.length,n.text=ye,(ie-=de-ye.length)<0&&(ie=0);" "==ye.charAt(0);)ye=ye.substr(1),ie>0&&ie--;n.offset=ie,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,B,ie,ye])}n.lineno=B,n.msg=n.args[0],n.filename=o},$B.$SyntaxError=function(n,o,l,x,B,D){void 0!==D&&void 0!==D.line_info&&(B=D.line_info);var G=_b_.SyntaxError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,B),G},$B.$IndentationError=function(n,o,l,x,B,D){$B.frames_stack.push([n,{$line_info:B+","+n},n,{$src:l}]),void 0!==D&&void 0!==D.line_info&&(B=D.line_info);var G=_b_.IndentationError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,B),G},$B.print_stack=function(n){var o=[];return(n=n||$B.frames_stack).forEach(function(l){var x=l[1].$line_info;if(void 0!==x){var B=x.split(",");B[1].startsWith("$exec")&&(B[1]="<module>"),o.push(B[1]+" line "+B[0]);var D=$B.file_cache[l[3].__file__];if(D){var G=D.split("\n")[parseInt(B[0])-1];o.push("  "+G.trim())}}}),console.log("print stack ok",o),o.join("\n")};var traceback=$B.traceback=$B.make_class("traceback",function(n,o){return $B.last($B.frames_stack),void 0===o&&(o=n.$stack),{__class__:traceback,$stack:o,exc:n}});traceback.__getattribute__=function(n,o){var l;if("tb_frame"===o||"tb_lineno"===o||"tb_lasti"===o||"tb_next"===o){0==n.$stack.length&&console.log("no stack",o);var x=n.$stack[0];l=n.exc.$line_infos[n.exc.$line_infos.length-n.$stack.length]}switch(o){case"tb_frame":return frame.$factory(n.$stack);case"tb_lineno":return void 0===l||x[0].startsWith($B.lambda_magic)?x[4]&&x[4].$infos&&x[4].$infos.__code__?x[4].$infos.__code__.co_firstlineno:-1:parseInt(l.split(",")[0]);case"tb_lasti":if(void 0===l)return console.log("no line info",n.$stack),"";for(var B,D,G=l.split(","),M=n.$stack.length-1;M>=0;M--){var P=n.$stack[M];if(P[2]==G[1].replace(/\./g,"_")){D=P[3].__file__;break}}if(void 0===B&&($B.file_cache.hasOwnProperty(D)?B=$B.file_cache[D]:$B.imported[G[1]]&&$B.imported[G[1]].__file__&&(B=$B.file_cache[$B.imported[G[1]].__file__],console.log("from filecache",l,$B.imported[G[1]].__file__))),void 0===B)return console.log(D),console.log("no src for",G),"";try{return B.split("\n")[parseInt(G[0]-1)].trim()}catch(de){throw console.log("error in attr tb_lasti of",n),console.log(B,G),de}case"tb_next":return n.$stack.length<=1?None:traceback.$factory(n.exc,n.$stack.slice(1));default:return _b_.object.__getattribute__(n,o)}},$B.set_func_names(traceback,"builtins");var frame=$B.make_class("frame",function(n,o){var l=n,x={__class__:frame,f_builtins:{},$stack:n.slice()};if(void 0===o&&(o=0),x.$pos=o,l.length){var B,D=l[o],G=D[0];try{x.f_locals=$B.obj_dict(D[1])}catch(ye){throw console.log("err "+ye),ye}if(x.f_globals=$B.obj_dict(D[3]),void 0!==D[3].__file__&&(B=D[3].__file__),G.startsWith("$exec")&&(B="<string>"),void 0===D[1].$line_info)x.f_lineno=-1;else{var M=D[1].$line_info.split(",");x.f_lineno=parseInt(M[0]);var P=M[1];$B.imported.hasOwnProperty(P)&&(B=$B.imported[P].__file__),x.f_lineno=parseInt(D[1].$line_info.split(",")[0])}var de=G.startsWith("$exec")?"<module>":G;G==D[2]?de="<module>":G.startsWith("lc"+$B.lambda_magic)?de="<listcomp>":D[1].$name?de=D[1].$name:D[1].$dict_comp?de="<dictcomp>":D[1].$list_comp?de="<listcomp>":D.length>4&&(de=D[4].$infos?D[4].$infos.__name__:D[4].name,void 0===D[4].$infos?D[4].name.startsWith("__ge")?de="<genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?de="<setcomp>":D[4].name.startsWith("lambda"+$B.lambda_magic)&&(de="<lambda>"):void 0===B&&D[4].$infos.__code__&&(void 0===(B=D[4].$infos.__code__.co_filename)&&(B=D[4].$infos.__module__),x.f_lineno=D[4].$infos.__code__.co_firstlineno)),x.f_code=D.length>4&&void 0!==D[4].$infos?D[4].$infos.__code__:{co_name:de,co_filename:B},x.f_code.__class__=$B.code,x.f_code.co_code=_b_.None,void 0===B&&(x.f_code.co_filename="<string>")}return x});frame.__delattr__=function(n,o){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=_b_.None)},frame.__getattr__=function(n,o){if("f_back"==o)return n.$pos>0?frame.$factory(n.$stack.slice(0,n.$stack.length-1),n.$pos-1):_b_.None;if("clear"==o)return function(){};if("f_trace"==o){var l=$B.last(n.$stack)[1];return void 0===l.$f_trace?_b_.None:l.$f_trace}},frame.__setattr__=function(n,o,l){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=l)},frame.__str__=frame.__repr__=function(n){return"<frame object, file "+n.f_code.co_filename+", line "+n.f_lineno+", code "+n.f_code.co_name+">"},$B.set_func_names(frame,"builtins"),$B._frame=frame;var BaseException=_b_.BaseException={__class__:_b_.type,__bases__:[_b_.object],__mro__:[_b_.object],args:[],$infos:{__name__:"BaseException",__module__:"builtins"},$is_class:!0};BaseException.__init__=function(n){n.args=_b_.tuple.$factory(void 0===arguments[1]?[]:[arguments[1]])},BaseException.__repr__=function(n){var o=n.__class__.$infos.__name__;return n.args[0]&&(o+="("+repr(n.args[0])),n.args.length>1&&(o+=", "+repr($B.fast_tuple(n.args.slice(1)))),o+")"},BaseException.__str__=function(n){return n.args.length>0?_b_.str.$factory(n.args[0]):n.__class__.$infos.__name__},BaseException.__new__=function(n){var o=_b_.BaseException.$factory();return o.__class__=n,o.__dict__=$B.empty_dict(),o};var getExceptionTrace=function(n,o){if(void 0===n.__class__)return $B.debug>1&&console.log("no class",n),n+"";var l="";void 0!==n.$js_exc&&o&&(l+="\nJS stack:\n"+n.$js_exc.stack+"\n"),l+="Traceback (most recent call last):";for(var x=n.$line_info,B=0;B<n.$stack.length;B++){var D=n.$stack[B];if(D[1]&&D[1].$line_info){var G;if(x=D[1].$line_info.split(","),n.module==x[1]&&(G=n.src),!o&&void 0===(G=D[3].$src))if($B.VFS&&$B.VFS.hasOwnProperty(D[2]))G=$B.VFS[D[2]][1];else if(!(G=$B.file_cache[D[3].__file__]))continue;var M=D[3].__file__||"<string>",P=x[1],de="$"==P.charAt(0);if(de&&(P="<module>"),l+="\n  File "+M+" line "+x[0],D.length>4)if(D[4].$infos){var ye=D[4].$infos.__name__;ye.startsWith("lc"+$B.lambda_magic)?l+=",in <listcomp>":l+=", in "+ye}else D[4].name.startsWith("__ge")?l+=", in <genexpr>":D[4].name.startsWith("set_comp"+$B.lambda_magic)?l+=", in <setcomp>":D[4].name.startsWith("lc"+$B.lambda_magic)?l+=", in <listcomp>":console.log("frame[4]",D[4]);else l+=D[1].$list_comp?", in <listcomp>":D[1].$dict_comp?", in <dictcomp>":", in <module>";if(void 0!==G&&!de){var ie=G.split("\n")[parseInt(x[0])-1];ie&&(ie=ie.replace(/^[ ]+/g,"")),l+="\n    "+ie}}}return n.__class__===_b_.SyntaxError&&(l+="\n  File "+n.args[1]+", line "+n.args[2]+"\n    "+n.args[4]),l};BaseException.__getattr__=function(n,o){if("info"==o)return getExceptionTrace(n,!1);if("infoWithInternal"==o)return getExceptionTrace(n,!0);if("__traceback__"==o)return void 0!==n.$traceback?n.$traceback:traceback.$factory(n);throw _b_.AttributeError.$factory(n.__class__.$infos.__name__+" has no attribute '"+o+"'")},BaseException.with_traceback=function(n,o){return n.$traceback=o,n},$B.deep_copy=function(n){var o=[];for(const B of n){var l=[B[0],{},B[2],{}];void 0!==B[4]&&l.push(B[4]);for(const D of[1,3])for(var x in B[D])l[D][x]=B[D][x];o.push(l)}return o},$B.save_stack=function(){return $B.deep_copy($B.frames_stack)},$B.restore_stack=function(n,o){$B.frames_stack=n,$B.frames_stack[$B.frames_stack.length-1][1]=o},$B.freeze=function(n){if(void 0===n.$stack){n.$line_infos=[];for(var o=0,l=$B.frames_stack.length;o<l;o++)n.$line_infos.push($B.frames_stack[o][1].$line_info);n.$stack=$B.frames_stack.slice(),$B.frames_stack.length&&(n.$line_info=$B.last($B.frames_stack)[1].$line_info)}};var show_stack=$B.show_stack=function(n){n=n||$B.frames_stack;for(const o of n)console.log(o[0],o[1].$line_info)};function $make_exc(names,parent){for(var _str=[],pos=0,i=0;i<names.length;i++){var name=names[i],code="";if(Array.isArray(name))var code=name[1],name=name[0];$B.builtins_scope[name]=!0;var $exc=(BaseException.$factory+"").replace(/BaseException/g,name);$exc=$exc.replace("//placeholder//",code),_str[pos++]="_b_."+name+" = {__class__:_b_.type, __mro__: [_b_."+parent.$infos.__name__+"].concat(parent.__mro__), $is_class: true,$infos: {__name__:'"+name+"'}}",_str[pos++]="_b_."+name+".$factory = "+$exc,_str[pos++]="_b_."+name+'.$factory.$infos = {__name__: "'+name+'", __qualname__: "'+name+'"}',_str[pos++]="$B.set_func_names(_b_."+name+", 'builtins')"}try{eval(_str.join(";"))}catch(n){throw console.log("--err"+n),n}}BaseException.$factory=function(){var err=Error();return err.args=$B.fast_tuple(Array.prototype.slice.call(arguments)),err.__class__=_b_.BaseException,err.$py_error=!0,$B.freeze(err),eval("//placeholder//"),err.__cause__=_b_.None,err.__context__=_b_.None,err.__suppress_context__=!1,err},BaseException.$factory.$infos={__name__:"BaseException",__qualname__:"BaseException"},$B.set_func_names(BaseException),_b_.BaseException=BaseException,$B.exception=function(n,o){if(n.__class__){if($B.freeze(D=n),o)for(var l=$B.last($B.frames_stack)[0],x=0,B=D.$stack.length;x<B;x++)if(D.$stack[x][0]==l){D.$stack=D.$stack.slice(x),D.$traceback=traceback.$factory(D);break}}else{var D;if(console.log("Javascript exception:",n),console.log($B.last($B.frames_stack)),console.log("recursion error ?",$B.is_recursion_error(n)),(D=Error()).__name__="Internal Javascript error: "+(n.__name__||n.name),D.__class__=_b_.Exception,D.$js_exc=n,$B.is_recursion_error(n))return _b_.RecursionError.$factory("too much recursion");"ReferenceError"==n.name?(D.__name__="NameError",D.__class__=_b_.NameError,n.message=n.message.replace("$$","")):"InternalError"==n.name&&(D.__name__="RuntimeError",D.__class__=_b_.RuntimeError),D.__cause__=_b_.None,D.__context__=_b_.None,D.__suppress_context__=!1,D.args=_b_.tuple.$factory(["<Javascript "+n.name+">: "+(n.message||"<"+n+">")]),D.$py_error=!0,$B.freeze(D)}return D},$B.is_exc=function(n,o){void 0===n.__class__&&(n=$B.exception(n));for(var l=n.$is_class?n:n.__class__,x=0;x<o.length;x++){var B=o[x];if(void 0===l&&console.log("exc class undefined",n),issubclass(l,B))return!0}return!1},$B.is_recursion_error=function(n){console.log("test is js exc is recursion error",n,n+"");var o=(n+"").split(":"),l=o[0].trim(),x=o[1].trim();return"InternalError"==l&&"too much recursion"==x||"Error"==l&&"Out of stack space"==x||"RangeError"==l&&"Maximum call stack size exceeded"==x},$make_exc(["SystemExit","KeyboardInterrupt","GeneratorExit","Exception"],BaseException),$make_exc([["StopIteration","err.value = arguments[0]"],["StopAsyncIteration","err.value = arguments[0]"],"ArithmeticError","AssertionError","AttributeError","BufferError","EOFError",["ImportError","err.name = arguments[0]"],"LookupError","MemoryError","NameError","OSError","ReferenceError","RuntimeError",["SyntaxError","err.msg = arguments[0]"],"SystemError","TypeError","ValueError","Warning"],_b_.Exception),$make_exc(["FloatingPointError","OverflowError","ZeroDivisionError"],_b_.ArithmeticError),$make_exc([["ModuleNotFoundError","err.name = arguments[0]"]],_b_.ImportError),$make_exc(["IndexError","KeyError"],_b_.LookupError),$make_exc(["UnboundLocalError"],_b_.NameError),$make_exc(["BlockingIOError","ChildProcessError","ConnectionError","FileExistsError","FileNotFoundError","InterruptedError","IsADirectoryError","NotADirectoryError","PermissionError","ProcessLookupError","TimeoutError"],_b_.OSError),$make_exc(["BrokenPipeError","ConnectionAbortedError","ConnectionRefusedError","ConnectionResetError"],_b_.ConnectionError),$make_exc(["NotImplementedError","RecursionError"],_b_.RuntimeError),$make_exc(["IndentationError"],_b_.SyntaxError),$make_exc(["TabError"],_b_.IndentationError),$make_exc(["UnicodeError"],_b_.ValueError),$make_exc(["UnicodeDecodeError","UnicodeEncodeError","UnicodeTranslateError"],_b_.UnicodeError),$make_exc(["DeprecationWarning","PendingDeprecationWarning","RuntimeWarning","SyntaxWarning","UserWarning","FutureWarning","ImportWarning","UnicodeWarning","BytesWarning","ResourceWarning"],_b_.Warning),$make_exc(["EnvironmentError","IOError","VMSError","WindowsError"],_b_.OSError),$B.$TypeError=function(n){throw _b_.TypeError.$factory(n)};var se=_b_.SyntaxError.$factory;_b_.SyntaxError.$factory=function(){var n=arguments[0];if(n.__class__===_b_.SyntaxError)return n;var o=se.apply(null,arguments),l=$B.last($B.frames_stack);if(l){line_info=l[1].$line_info,o.filename=l[3].__file__,o.lineno=parseInt(line_info.split(",")[0]);var x=$B.file_cache[l[3].__file__];x&&(lines=x.split("\n"),o.text=lines[o.lineno-1]),o.offset=n.offset}return o},_b_}(__BRYTHON__),function(n){var o=n.builtins,l=o.None,x={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"range"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function B(P,de){var ye=x.__len__(P);return 0==ye?P.start:de>ye?P.stop:n.add(P.start,n.mul(P.step,de))}x.__contains__=function(P,de){if(0==x.__len__(P))return!1;try{de=n.int_or_bool(de)}catch{try{return x.index(P,de),!0}catch{return!1}}var ye=n.sub(de,P.start),ie=n.floordiv(ye,P.step),ce=n.mul(P.step,ie);return!!n.eq(ce,ye)&&(n.gt(P.stop,P.start)?n.ge(de,P.start)&&n.gt(P.stop,de):n.ge(P.start,de)&&n.gt(de,P.stop))},x.__delattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},x.__eq__=function(P,de){if(o.isinstance(de,x)){var ye=x.__len__(P);return!!n.eq(ye,x.__len__(de))&&(0==ye||!!n.eq(P.start,de.start)&&(1==ye||n.eq(P.step,de.step)))}return!1},x.__getitem__=function(P,de){if(o.isinstance(de,o.slice)){var ye=o.slice.$conv_for_seq(de,x.__len__(P)),ie=n.mul(P.step,ye.step),ce=B(P,ye.start),fe=B(P,ye.stop);return x.$factory(ce,fe,ie)}"number"!=typeof de&&(de=n.$GetInt(de)),n.gt(0,de)&&(de=n.add(de,x.__len__(P)));var ae=n.add(P.start,n.mul(de,P.step));if(n.gt(P.step,0)&&(n.ge(ae,P.stop)||n.gt(P.start,ae))||n.gt(0,P.step)&&(n.ge(P.stop,ae)||n.gt(ae,P.start)))throw o.IndexError.$factory("range object index out of range");return ae},x.__hash__=function(P){var de=x.__len__(P);return o.hash(o.tuple.$factory(0==de?[0,l,l]:1==de?[1,P.start,l]:[de,P.start,P.step]))};var D={__class__:o.type,__mro__:[o.object],__iter__:function(P){return P},__next__:function(P){return o.next(P.obj)},$infos:{__name__:"range_iterator",__module__:"builtins"},$is_class:!0,$factory:function(P){return{__class__:D,obj:P}}};n.set_func_names(D,"builtins"),x.__iter__=function(P){var de={__class__:x,start:P.start,stop:P.stop,step:P.step};return de.$counter=P.$safe?P.start-P.step:n.sub(P.start,P.step),D.$factory(de)},x.__len__=function(P){var de;if(n.gt(P.step,0)){if(n.ge(P.start,P.stop))return 0;var ye=n.sub(P.stop,n.add(1,P.start)),ie=n.floordiv(ye,P.step);de=n.add(1,ie)}else{if(n.ge(P.stop,P.start))return 0;ye=n.sub(P.start,n.add(1,P.stop)),ie=n.floordiv(ye,n.mul(-1,P.step)),de=n.add(1,ie)}return void 0===n.maxsize&&(n.maxsize=n.long_int.__pow__(n.long_int.$factory(2),63),n.maxsize=n.long_int.__sub__(n.maxsize,1)),de},x.__next__=function(P){if(P.$safe){if(P.$counter+=P.step,P.step>0&&P.$counter>=P.stop||P.step<0&&P.$counter<=P.stop)throw o.StopIteration.$factory("")}else if(P.$counter=n.add(P.$counter,P.step),n.gt(P.step,0)&&n.ge(P.$counter,P.stop)||n.gt(0,P.step)&&n.ge(P.stop,P.$counter))throw o.StopIteration.$factory("");return P.$counter},x.__reversed__=function(P){var de=n.sub(x.__len__(P),1);return x.$factory(n.add(P.start,n.mul(de,P.step)),n.sub(P.start,P.step),n.mul(-1,P.step))},x.__repr__=x.__str__=function(P){var de="range("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop);return 1!=P.step&&(de+=", "+o.str.$factory(P.step)),de+")"},x.__setattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},x.start=function(P){return P.start},x.step=function(P){return P.step},x.stop=function(P){return P.stop},x.count=function(P,de){if(o.isinstance(de,[o.int,o.float,o.bool]))return o.int.$factory(x.__contains__(P,de));for(var ye=x.__iter__(P),ie=D.__next__,ce=0;;)try{fe=ie(ye),n.rich_comp("__eq__",de,fe)&&ce++}catch(ae){if(o.isinstance(ae,o.StopIteration))return ce;throw ae}var fe},x.index=function(P,de){var ye,ie=n.args("index",2,{self:null,other:null},["self","other"],arguments,{},null,null);P=ie.self,de=ie.other;try{de=n.int_or_bool(de)}catch{for(var ce=x.__iter__(P),fe=D.__next__,ae=0;;)try{if(ye=fe(ce),n.rich_comp("__eq__",de,ye))return ae;ae++}catch(X){throw o.isinstance(X,o.StopIteration)?o.ValueError.$factory(o.str.$factory(de)+" not in range"):X}}var W=n.sub(de,P.start),Z=n.floordiv(W,P.step),A=n.mul(P.step,Z);if(n.eq(A,W)){if(n.gt(P.stop,P.start)&&n.ge(de,P.start)&&n.gt(P.stop,de)||n.ge(P.start,P.stop)&&n.ge(P.start,de)&&n.gt(de,P.stop))return Z;throw o.ValueError.$factory(o.str.$factory(de)+" not in range")}throw o.ValueError.$factory(o.str.$factory(de)+" not in range")},x.$factory=function(){var P=n.args("range",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{start:null,stop:null,step:null},null,null),de=P.start,ye=P.stop,ie=P.step;if(null===ye&&null===ie){if(null==de)throw o.TypeError.$factory("range expected 1 arguments, got 0");return ye=n.PyNumber_Index(de),{__class__:x,start:0,stop:ye,step:1,$is_range:!0,$safe:"number"==typeof ye}}if(null===ie&&(ie=1),de=n.PyNumber_Index(de),ye=n.PyNumber_Index(ye),0==(ie=n.PyNumber_Index(ie)))throw o.ValueError.$factory("range arg 3 must not be zero");return{__class__:x,start:de,stop:ye,step:ie,$is_range:!0,$safe:"number"==typeof de&&"number"==typeof ye&&"number"==typeof ie}},n.set_func_names(x,"builtins");var G={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"slice"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function M(P){for(var de=["start","stop","step"],ye=[],ie=0;ie<de.length;ie++){var ce=P[de[ie]];if(ce===o.None)ye.push(ce);else try{ye.push(n.PyNumber_Index(ce))}catch{throw o.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}}return ye}G.__eq__=function(P,de){var ye=M(P),ie=M(de);return ye[0]==ie[0]&&ye[1]==ie[1]&&ye[2]==ie[2]},G.__repr__=G.__str__=function(P){return"slice("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop)+", "+o.str.$factory(P.step)+")"},G.__setattr__=function(P,de,ye){throw o.AttributeError.$factory("readonly attribute")},G.$conv_for_seq=function(P,de){var ye,ie=P.step===l?1:n.PyNumber_Index(P.step),ce=n.gt(0,ie),fe=n.sub(de,1);if(0==ie)throw o.ValueError.$factory("slice step cannot be zero");return P.start===l?ye=ce?fe:0:(ye=n.PyNumber_Index(P.start),n.gt(0,ye)&&(ye=n.add(ye,de),n.gt(0,ye)&&(ye=0)),n.ge(ye,de)&&(ye=ie<0?fe:de)),P.stop===l?stop=ce?-1:de:(stop=n.PyNumber_Index(P.stop),n.gt(0,stop)&&(stop=n.add(stop,de)),n.ge(stop,de)&&(stop=ce?fe:de)),{start:ye,stop,step:ie}},G.start=function(P){return P.start},G.step=function(P){return P.step},G.stop=function(P){return P.stop},G.indices=function(P,de){var ye=n.args("indices",2,{self:null,length:null},["self","length"],arguments,{},null,null),ie=n.$GetInt(ye.length);ie<0&&o.ValueError.$factory("length should not be negative");var ce=P.step==o.None?1:P.step;if(ce<0){var fe=P.start,ae=P.stop;fe=fe==o.None?ie-1:fe<0?o.max(-1,fe+ie):o.min(ie-1,P.start),ae=P.stop==o.None?-1:ae<0?o.max(-1,ae+ie):o.min(ie-1,P.stop)}else fe=P.start==o.None?0:o.min(ie,P.start),ae=P.stop==o.None?ie:o.min(ie,P.stop),fe<0&&(fe=o.max(0,fe+ie)),ae<0&&(ae=o.max(0,ae+ie));return o.tuple.$factory([fe,ae,ce])},G.$factory=function(){var P,de,ye,ie=n.args("slice",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{stop:null,step:null},null,null);null===ie.stop&&null===ie.step?(P=o.None,de=ie.start,ye=o.None):(P=ie.start,de=ie.stop,ye=null===ie.step?o.None:ie.step);var ce={__class__:G,start:P,stop:de,step:ye};return M(ce),ce},n.set_func_names(G,"builtins"),o.range=x,o.slice=G}(__BRYTHON__),function(n){var o=n.builtins,l={},x={};function B(W,Z,A){if(void 0===Z){Z=[];for(var R="\r\n \t",X=0,he=R.length;X<he;X++)Z.push(R.charCodeAt(X))}else{if(!o.isinstance(Z,P))throw o.TypeError.$factory("Type str doesn't support the buffer API");Z=Z.source}if("l"==A){for(X=0,he=W.source.length;X<he&&-1!=Z.indexOf(W.source[X]);X++);return P.$factory(W.source.slice(X))}for(X=W.source.length-1;X>=0&&-1!=Z.indexOf(W.source[X]);X--);return P.$factory(W.source.slice(0,X+1))}function D(W){return!o.isinstance(W,[P,G])}n.to_bytes=function(W){var Z;if(o.isinstance(W,[P,G]))Z=W.source;else{var A=n.$getattr(W,"tobytes",null);if(null===A)throw o.TypeError.$factory("object doesn't support the buffer protocol");Z=n.$call(A)().source}return Z};var G={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytearray"},$is_class:!0};["__delitem__","clear","copy","count","index","pop","remove","reverse","sort"].forEach(function(W){var Z;G[W]=(Z=W,function(A){for(var R=[A.source],X=1,he=1,U=arguments.length;he<U;he++)R[X++]=arguments[he];return o.list[Z].apply(null,R)})});var M=n.make_iterator_class("bytearray_iterator");G.__iter__=function(W){return M.$factory(W.source)},G.__mro__=[o.object],G.__repr__=G.__str__=function(W){return"bytearray("+P.__repr__(W)+")"},G.__setitem__=function(W,Z,A){if(o.isinstance(Z,o.int)){if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");var R=Z;if(Z<0&&(R=W.source.length+R),!(R>=0&&R<W.source.length))throw o.IndexError.$factory("list index out of range");W.source[R]=A}else{if(!o.isinstance(Z,o.slice))throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(Z));var X=Z.start===o.None?0:Z.start,he=Z.stop===o.None?W.source.length:Z.stop;X<0&&(X=W.source.length+X),he<0&&(he=W.source.length+he),W.source.splice(X,he-X);try{for(var U=o.list.$factory(A),Re=U.length-1;Re>=0;Re--){if(!o.isinstance(U[Re],o.int))throw o.TypeError.$factory("an integer is required");if(U[Re]>255)throw ValueError.$factory("byte must be in range(0, 256)");W.source.splice(X,0,U[Re])}}catch{throw o.TypeError.$factory("can only assign an iterable")}}},G.append=function(W,Z){if(2!=arguments.length)throw o.TypeError.$factory("append takes exactly one argument ("+(arguments.length-1)+" given)");if(!o.isinstance(Z,o.int))throw o.TypeError.$factory("an integer is required");if(Z>255)throw ValueError.$factory("byte must be in range(0, 256)");W.source[W.source.length]=Z},G.extend=function(W,Z){if(Z.__class__===G||Z.__class__===P)return Z.source.forEach(function(R){W.source.push(R)}),o.None;for(var A=o.iter(Z);;)try{G.__add__(W,o.next(A))}catch(R){if(R===o.StopIteration)break;throw R}return o.None},G.insert=function(W,Z,A){if(3!=arguments.length)throw o.TypeError.$factory("insert takes exactly 2 arguments ("+(arguments.length-1)+" given)");if(!o.isinstance(A,o.int))throw o.TypeError.$factory("an integer is required");if(A>255)throw ValueError.$factory("byte must be in range(0, 256)");o.list.insert(W.source,Z,A)},G.$factory=function(){for(var W=[G],Z=0,A=arguments.length;Z<A;Z++)W.push(arguments[Z]);return G.__new__.apply(null,W)};var P={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytes"},$is_class:!0,__add__:function(W,Z){if(o.isinstance(Z,P))return W.__class__.$factory(W.source.concat(Z.source));if(o.isinstance(Z,G))return W.__class__.$factory(P.__add__(W,P.$factory(Z)));if(o.isinstance(Z,o.memoryview))return W.__class__.$factory(P.__add__(W,o.memoryview.tobytes(Z)));throw o.TypeError.$factory("can't concat bytes to "+o.str.$factory(Z))},__contains__:function(W,Z){if("number"==typeof Z)return W.source.indexOf(Z)>-1;if(W.source.length<Z.source.length)return!1;for(var A=Z.source.length,R=0;R<W.source.length-Z.source.length+1;R++){for(var X=!0,he=0;he<A;he++)if(Z.source[R+he]!=W.source[he]){X=!1;break}if(X)return!0}return!1}},de=n.make_iterator_class("bytes_iterator");function ye(W,Z,A){throw o.UnicodeEncodeError.$factory("'"+W+"' codec can't encode character "+o.hex(Z)+" in position "+A)}function ie(W){var Z=W.toLowerCase();return"windows"==Z.substr(0,7)&&(Z="cp"+Z.substr(7)),(Z.startsWith("cp")||Z.startsWith("iso"))&&(Z=Z.replace("-","")),Z.replace(/-/g,"_")}P.__iter__=function(W){return de.$factory(W.source)},P.__eq__=function(W,Z){return!D(Z)&&n.$getattr(W.source,"__eq__")(Z.source)},P.__ge__=function(W,Z){return D(Z)?o.NotImplemented:o.list.__ge__(W.source,Z.source)},P.__getitem__=function(W,Z){if(o.isinstance(Z,o.int)){var A=Z;if(Z<0&&(A=W.source.length+A),A>=0&&A<W.source.length)return W.source[A];throw o.IndexError.$factory("index out of range")}if(o.isinstance(Z,o.slice)){var R=o.slice.$conv_for_seq(Z,W.source.length),X=R.start,he=R.stop,U=R.step,Re=[],Q=null;if(A=0,U>0){if((he=Math.min(he,W.source.length))<=X)return P.$factory([]);for(Q=X;Q<he;Q+=U)Re[A++]=W.source[Q]}else{if(he>=X)return P.$factory([]);for(he=Math.max(0,he),Q=X;Q>=he;Q+=U)Re[A++]=W.source[Q]}return P.$factory(Re)}if(o.isinstance(Z,o.bool))return W.source.__getitem__(o.int.$factory(Z))},P.__gt__=function(W,Z){return D(Z)?o.NotImplemented:o.list.__gt__(W.source,Z.source)},P.__hash__=function(W){if(void 0===W)return P.__hashvalue__||n.$py_next_hash--;for(var Z=1,A=0,R=W.source.length;A<R;A++)Z=101*Z+W.source[A]&4294967295;return Z},P.__init__=function(){return o.None},P.__le__=function(W,Z){return D(Z)?o.NotImplemented:o.list.__le__(W.source,Z.source)},P.__len__=function(W){return W.source.length},P.__lt__=function(W,Z){return D(Z)?o.NotImplemented:o.list.__lt__(W.source,Z.source)},P.__mod__=function(W,Z){var A=ce(W,"ascii","strict"),R=o.str.__mod__(A,Z);return o.str.encode(R,"ascii")},P.__mul__=function(){for(var W=n.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null),Z=n.PyNumber_Index(W.other),A=[],R=W.self.source,X=R.length,he=0;he<Z;he++)for(var U=0;U<X;U++)A.push(R[U]);var Re=P.$factory();return Re.source=A,Re},P.__ne__=function(W,Z){return!P.__eq__(W,Z)},P.__new__=function(W,Z,A,R){var X=n.args("__new__",4,{cls:null,source:null,encoding:null,errors:null},["cls","source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(X.cls,X.source,X.encoding,X.errors)},P.$new=function(W,Z,A,R){var X={__class__:W},he=[],U=0;if(void 0!==Z)if("number"==typeof Z||o.isinstance(Z,o.int))for(var Re=Z;Re--;)he[U++]=0;else if("string"==typeof Z||o.isinstance(Z,o.str)){if(void 0===A)throw o.TypeError.$factory("string argument without an encoding");he=fe(Z,A||"utf-8",R||"strict")}else for(he=o.list.$factory(Z),Re=0;Re<he.length;Re++){try{var Q=o.int.$factory(he[Re])}catch{throw o.TypeError.$factory("'"+n.class_name(he[Re])+"' object cannot be interpreted as an integer")}if(Q<0||Q>255)throw o.ValueError.$factory("bytes must be in range(0, 256)")}return X.source=he,X.encoding=A,X.errors=R,X},P.__repr__=P.__str__=function(W){for(var Z="",A=0,R=W.source.length;A<R;A++){var X=W.source[A];if(10==X)Z+="\\n";else if(X<32||X>=128){var he=X.toString(16);Z+="\\x"+(he=(1==he.length?"0":"")+he)}else X=="\\".charCodeAt(0)?Z+="\\\\":Z+=String.fromCharCode(X)}return Z.indexOf("'")>-1&&-1==Z.indexOf('"')?'b"'+Z+'"':"b'"+Z.replace(new RegExp("'","g"),"\\'")+"'"},P.__reduce_ex__=function(W){return P.__repr__(W)},P.capitalize=function(W){var Z=W.source,A=Z.length,R=Z.slice();R[0]>96&&R[0]<123&&(R[0]-=32);for(var X=1;X<A;++X)R[X]>64&&R[X]<91&&(R[X]+=32);return P.$factory(R)},P.center=function(){var W=n.args("center",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null),Z=W.width-W.self.source.length;if(Z<=0)return P.$factory(W.self.source);var A=P.ljust(W.self,W.self.source.length+Math.floor(Z/2),W.fillbyte);return P.rjust(A,W.width,W.fillbyte)},P.count=function(){var W=n.args("count",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Z=0,A=-1,R=0;if("number"==typeof W.sub){if(W.sub<0||W.sub>255)throw o.ValueError.$factory("byte must be in range(0, 256)");R=1}else{if(!W.sub.__class__||!W.sub.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.sub)+"'");R=W.sub.source.length}do{-1!=(A=P.find(W.self,W.sub,Math.max(A+R,W.start),W.end))&&Z++}while(-1!=A);return Z},P.decode=function(W,Z,A){var R=n.args("decode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);switch(R.errors){case"strict":case"ignore":case"replace":case"surrogateescape":case"surrogatepass":case"xmlcharrefreplace":case"backslashreplace":return ce(R.self,R.encoding,R.errors)}},P.endswith=function(){var W=n.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:-1,end:-1},null,null);if(o.isinstance(W.suffix,P)){for(var Z=-1==W.start?W.self.source.length-W.suffix.source.length:Math.min(W.self.source.length-W.suffix.source.length,W.start),A=-1==W.end?-1==W.start?W.self.source.length:Z+W.suffix.source.length:Math.min(W.self.source.length-1,W.end),R=!0,X=W.suffix.source.length-1,he=W.suffix.source.length;X>=0&&R;--X)R=W.self.source[A-he+X]==W.suffix.source[X];return R}if(o.isinstance(W.suffix,o.tuple)){for(X=0;X<W.suffix.length;++X){if(!o.isinstance(W.suffix[X],P))throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.suffix));if(P.endswith(W.self,W.suffix[X],W.start,W.end))return!0}return!1}throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.suffix))},P.expandtabs=function(){var W=n.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),Z=[];for(let R=0;R<W.tabsize;++R)Z.push(32);var A=W.self.source.slice();for(let R=0;R<A.length;++R)9===A[R]&&A.splice.apply(A,[R,1].concat(Z));return o.bytes.$factory(A)},P.find=function(W,Z){if(2!=arguments.length)var A=n.args("find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),R=(Z=A.sub,A.start),X=A.end;else R=0,X=-1;if("number"==typeof Z){if(Z<0||Z>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return W.source.slice(0,-1==X?void 0:X).indexOf(Z,R)}if(!Z.__class__||!Z.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(Z)+"'");X=-1==X?W.source.length:Math.min(W.source.length,X);for(var he=Z.source.length,U=R;U<=X-he;U++){for(var Re=W.source.slice(U,U+he),Q=!0,be=0;be<he;be++)if(Re[be]!=Z.source[be]){Q=!1;break}if(Q)return U}return-1},P.fromhex=function(){for(var W=n.args("fromhex",2,{cls:null,string:null},["cls","string"],arguments,{},null,null),Z=W.string.replace(/\s/g,""),A=[],R=0;R<Z.length;R+=2){if(R+2>Z.length)throw o.ValueError.$factory("non-hexadecimal number found in fromhex() arg");A.push(o.int.$factory(Z.substr(R,2),16))}return W.cls.$factory(A)},P.hex=function(){for(var W=n.args("hex",1,{self:null},["self"],arguments,{},null,null).self,Z="",A=0,R=W.source.length;A<R;A++){var X=W.source[A].toString(16);X.length<2&&(X="0"+X),Z+=X}return Z},P.index=function(){var W=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Z=P.find(W.self,W.sub,W.start,W.end);if(-1==Z)throw o.ValueError.$factory("subsection not found");return Z},P.isalnum=function(W){for(var Z=W.source,A=Z.length,R=A>0,X=0;X<A&&R;++X)R=Z[X]>96&&Z[X]<123||Z[X]>64&&Z[X]<91||Z[X]>47&&Z[X]<58;return R},P.isalpha=function(W){for(var Z=W.source,A=Z.length,R=A>0,X=0;X<A&&R;++X)R=Z[X]>96&&Z[X]<123||Z[X]>64&&Z[X]<91;return R},P.isdigit=function(W){var Z=W.source,A=Z.length,R=A>0;for(let X=0;X<A&&R;++X)R=Z[X]>47&&Z[X]<58;return R},P.islower=function(W){var Z=W.source,A=Z.length,R=!1;for(let X=0;X<A;++X)if(R=R||Z[X]>96&&Z[X]<123,Z[X]>64&&Z[X]<91)return!1;return R},P.isspace=function(W){var Z=W.source,A=Z.length;for(let R=0;R<A;++R)switch(Z[R]){case 9:case 10:case 11:case 12:case 13:case 32:break;default:return!1}return!0},P.isupper=function(W){var Z=W.source,A=Z.length,R=!1;for(let X=0;X<A;++X)if(R=R||Z[X]>64&&Z[X]<91,Z[X]>96&&Z[X]<123)return!1;return R},P.istitle=function(W){for(var Z=W.source,A=Z.length,R=!1,X=!1,he=!1,U=!1,Re=0;Re<A;++Re){if(he=Z[Re]>64&&Z[Re]<91,(R=(U=Z[Re]>96&&Z[Re]<123)||he)&&X&&he||!X&&U)return!1;X=R}return!0},P.join=function(){for(var W=n.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{}),Z=W.self,R=n.$getattr(o.iter(W.iterable),"__next__"),X=Z.__class__.$factory(),he=!0;;)try{var U=R();he?he=!1:X=P.__add__(X,Z),X=P.__add__(X,U)}catch(Re){if(o.isinstance(Re,o.StopIteration))break;throw Re}return X},P.lower=function(W){for(var Z,A=[],R=0,X=0,he=W.source.length;X<he;X++)W.source[X]&&(A[R++]=(Z=W.source[X])>=65&&Z<=90?Z+32:Z);return P.$factory(A)},P.ljust=function(){var W=n.args("ljust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!W.fillbyte.__class__||!W.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(W.fillbyte)+"'");for(var Z=[],A=W.width-W.self.source.length,R=0;R<A;++R)Z.push(W.fillbyte.source[0]);return P.$factory(W.self.source.concat(Z))},P.lstrip=function(W,Z){return B(W,Z,"l")},P.maketrans=function(W,Z){for(var A=[],R=(Z=n.to_bytes(Z),0);R<256;R++)A[R]=R;R=0;for(var X=W.source.length;R<X;R++)A[W.source[R]]=Z[R];return P.$factory(A)},P.partition=function(){var W=n.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");var Z=W.sep.source.length,A=W.self.source,R=P.find(W.self,W.sep);return o.tuple.$factory([P.$factory(A.slice(0,R)),P.$factory(A.slice(R,R+Z)),P.$factory(A.slice(R+Z))])},P.removeprefix=function(){var W=n.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!o.isinstance(W.prefix,[P,G]))throw o.ValueError.$factory(`prefix should be bytes, not '${n.class_name(W.prefix)}'`);return P.startswith(W.self,W.prefix)?P.__getitem__(W.self,o.slice.$factory(W.prefix.source.length,o.None)):P.__getitem__(W.self,o.slice.$factory(0,o.None))},P.removesuffix=function(){var W=n.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!o.isinstance(W.suffix,[P,G]))throw o.ValueError.$factory(`suffix should be bytes, not '${n.class_name(W.suffix)}'`);return P.endswith(W.self,W.suffix)?P.__getitem__(W.self,o.slice.$factory(0,W.suffix.source.length+1)):P.__getitem__(W.self,o.slice.$factory(0,o.None))},P.replace=function(){var W=n.args("replace",4,{self:null,old:null,new:null,count:null},["self","old","new","count"],arguments,{count:-1},null,null),Z=[],A=W.self,R=A.source,X=R.length,he=W.old,U=W.new,Re=W.count>=0?W.count:R.length;if(!W.old.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.old)+"'");if(!W.old.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(W.sep)+"'");if(!W.new.__class__)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(W.old)+"'");if(!W.new.__class__.$buffer_protocol)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(W.sep)+"'");for(var Q=0;Q<X;Q++)if(P.startswith(A,he,Q)&&Re){for(var be=0;be<U.source.length;be++)Z.push(U.source[be]);Q+=he.source.length-1,Re--}else Z.push(R[Q]);return P.$factory(Z)},P.rfind=function(W,Z){if(2==arguments.length&&Z.__class__===P)var A=Z,R=0,X=-1;else{var he=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null);W=he.self,A=he.sub,R=he.start,X=he.end}if("number"==typeof A){if(A<0||A>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return he.self.source.slice(R,-1==he.end?void 0:he.end).lastIndexOf(A)+R}if(!A.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(he.sub)+"'");if(!A.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(A)+"'");X=-1==X?W.source.length:Math.min(W.source.length,X);for(var U=A.source.length,Re=X-U;Re>=R;--Re){for(var Q=W.source.slice(Re,Re+U),be=!0,Pe=0;Pe<U;Pe++)if(Q[Pe]!=A.source[Pe]){be=!1;break}if(be)return Re}return-1},P.rindex=function(){var W=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),Z=P.rfind(W.self,W.sub,W.start,W.end);if(-1==Z)throw o.ValueError.$factory("subsection not found");return Z},P.rjust=function(){var W=n.args("rjust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!W.fillbyte.__class__||!W.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(W.fillbyte)+"'");for(var Z=[],A=W.width-W.self.source.length,R=0;R<A;++R)Z.push(W.fillbyte.source[0]);return P.$factory(Z.concat(W.self.source))},P.rpartition=function(){var W=n.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");var Z=W.sep.source.length,A=W.self.source,R=P.rfind(W.self,W.sep);return o.tuple.$factory([P.$factory(A.slice(0,R)),P.$factory(A.slice(R,R+Z)),P.$factory(A.slice(R+Z))])},P.rstrip=function(W,Z){return B(W,Z,"r")},P.split=function(){var W=n.args("split",2,{self:null,sep:null},["self","sep"],arguments,{},null,null),Z=[],A=0,R=0;if(!W.sep.__class__||!W.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(W.sep)+"'");for(var X=W.sep.source,he=X.length,U=W.self.source,Re=U.length;R<Re;){for(var Q=!0,be=0;be<he&&Q;be++)U[R+be]!=X[be]&&(Q=!1);Q?(Z.push(P.$factory(U.slice(A,R))),R=A=R+he):R++}return(Q||R>A)&&Z.push(P.$factory(U.slice(A,R))),Z},P.splitlines=function(W){var Z=n.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!o.isinstance(Z.keepends,[o.bool,o.int]))throw o.TypeError("integer argument expected, got "+n.get_class(Z.keepends).__name);var A=o.int.$factory(Z.keepends),R=[],X=Z.self.source,he=0,U=0;if(!X.length)return R;for(;U<X.length;)U<X.length-1&&13==X[U]&&10==X[U+1]?(R.push(P.$factory(X.slice(he,A?U+2:U))),he=U+=2):13==X[U]||10==X[U]?(R.push(P.$factory(X.slice(he,A?U+1:U))),he=U+=1):U++;return he<X.length&&R.push(P.$factory(X.slice(he))),R},P.startswith=function(){var W=n.args("startswith",3,{self:null,prefix:null,start:null},["self","prefix","start"],arguments,{start:0},null,null),Z=W.start;if(o.isinstance(W.prefix,P)){for(var A=!0,R=0;R<W.prefix.source.length&&A;R++)A=W.self.source[Z+R]==W.prefix.source[R];return A}if(o.isinstance(W.prefix,o.tuple)){var X=[];for(R=0;R<W.prefix.length;R++){if(!o.isinstance(W.prefix[R],P))throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.prefix));X=X.concat(W.prefix[R].source)}var he=P.$factory(X);return P.startswith(W.self,he,Z)}throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(W.prefix))},P.strip=function(W,Z){var A=P.lstrip(W,Z);return P.rstrip(A,Z)},P.swapcase=function(W){for(var Z=W.source,A=Z.length,R=Z.slice(),X=0;X<A;++X)R[X]>96&&R[X]<123?R[X]-=32:R[X]>64&&R[X]<91&&(R[X]+=32);return P.$factory(R)},P.title=function(W){var Z=W.source,A=Z.length;buffer=Z.slice(),current_char_is_letter=!1,prev_char_was_letter=!1,is_uppercase=!1,is_lowercase=!1;for(var R=0;R<A;++R)is_lowercase=buffer[R]>96&&buffer[R]<123,is_uppercase=buffer[R]>64&&buffer[R]<91,current_char_is_letter=is_lowercase||is_uppercase,current_char_is_letter&&(prev_char_was_letter&&is_uppercase?buffer[R]+=32:!prev_char_was_letter&&is_lowercase&&(buffer[R]-=32)),prev_char_was_letter=current_char_is_letter;return P.$factory(buffer)},P.translate=function(W,Z,A){if(void 0===A)A=[];else{if(!o.isinstance(A,P))throw o.TypeError.$factory("Type "+n.get_class(A).__name+" doesn't support the buffer API");A=A.source}var R=[],X=0;if(o.isinstance(Z,P)&&256==Z.source.length)for(var he=0,U=W.source.length;he<U;he++)A.indexOf(W.source[he])>-1||(R[X++]=Z.source[W.source[he]]);return P.$factory(R)},P.upper=function(W){for(var Z,A=[],R=0,X=0,he=W.source.length;X<he;X++)W.source[X]&&(A[R++]=(Z=W.source[X])>=97&&Z<=122?Z-32:Z);return P.$factory(A)},P.zfill=function(W,Z){for(var A=W.source.slice(),R=43==A[0]||45==A[0]?1:0,X=Z-W.source.length,he=[],U=0;U<X;++U)he.push(48);return A.splice.apply(A,[R,0].concat(he)),P.$factory(A)};var ce=n.decode=function(W,Z,A){var R="",X=W.source,he=ie(Z),U=!1;switch(he){case"utf_8":case"utf-8":case"utf8":case"U8":case"UTF":var Re,Q=0;for(R="";Q<X.length;){var be=X[Q];if(Re=null,128&be)if(be>>5==6)if(void 0===X[Q+1]?Re=[be,Q,"end"]:128!=(192&X[Q+1])&&(Re=[be,Q,"continuation"]),null!==Re){if("ignore"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Re[0].toString(16)+"  in position "+Re[1]+("end"==Re[2]?": unexpected end of data":": invalid continuation byte"));Q++}else{var Pe=31&be;Pe<<=6,Pe+=63&X[Q+1],R+=String.fromCodePoint(Pe),Q+=2}else if(be>>4==14)if(void 0===X[Q+1]?Re=[be,Q,"end",Q+1]:128!=(192&X[Q+1])?Re=[be,Q,"continuation",Q+2]:void 0===X[Q+2]?Re=[be,Q+"-"+(Q+1),"end",Q+2]:128!=(192&X[Q+2])&&(Re=[be,Q,"continuation",Q+3]),null!==Re)if("ignore"==A)Q=Re[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Re[0].toString(16)+"  in position "+Re[1]+("end"==Re[2]?": unexpected end of data":": invalid continuation byte"));for(var Ge=Q;Ge<Re[3];Ge++)R+=String.fromCodePoint(56448+X[Ge]-128);Q=Re[3]}else Pe=15&be,Pe<<=12,Pe+=(63&X[Q+1])<<6,Pe+=63&X[Q+2],R+=String.fromCodePoint(Pe),Q+=3;else if(be>>3==30)if(U=!0,void 0===X[Q+1]?Re=[be,Q,"end",Q+1]:128!=(192&X[Q+1])?Re=[be,Q,"continuation",Q+2]:void 0===X[Q+2]?Re=[be,Q+"-"+(Q+1),"end",Q+2]:128!=(192&X[Q+2])?Re=[be,Q,"continuation",Q+3]:void 0===X[Q+3]?Re=[be,Q+"-"+(Q+1)+"-"+(Q+2),"end",Q+3]:128!=(192&X[Q+2])&&(Re=[be,Q,"continuation",Q+3]),null!==Re)if("ignore"==A)Q=Re[3];else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Re[0].toString(16)+"  in position "+Re[1]+("end"==Re[2]?": unexpected end of data":": invalid continuation byte"));for(Ge=Q;Ge<Re[3];Ge++)R+=String.fromCodePoint(56448+X[Ge]-128);Q=Re[3]}else Pe=15&be,Pe<<=18,Pe+=(63&X[Q+1])<<12,Pe+=(63&X[Q+2])<<6,Pe+=63&X[Q+3],R+=String.fromCodePoint(Pe),Q+=4;else if("ignore"==A)Q++;else{if("surrogateescape"!=A)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+be.toString(16)+" in position "+Q+": invalid start byte");R+=String.fromCodePoint(56448+X[Q]-128),Q++}else R+=String.fromCodePoint(be),Q++}return U?o.str.$surrogate.$factory(R):R;case"latin_1":case"windows1252":case"iso-8859-1":case"iso8859-1":case"8859":case"cp819":case"latin":case"latin1":case"L1":X.forEach(function(Ke){R+=String.fromCharCode(Ke)});break;case"unicode_escape":return W.__class__!==P&&W.__class__!==G||(W=ce(W,"latin-1","strict")),W.replace(/\\n/g,"\n").replace(/\\a/g,"\x07").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\t/g,"\t").replace(/\\'/g,"'").replace(/\\"/g,'"');case"raw_unicode_escape":return W.__class__!==P&&W.__class__!==G||(W=ce(W,"latin-1","strict")),W.replace(/\\u([a-fA-F0-9]{4})/g,function(Ke){var yt=parseInt(Ke.substr(2),16);return String.fromCharCode(yt)});case"ascii":Ge=0;for(var Ae=X.length;Ge<Ae;Ge++)if((Pe=X[Ge])<=127)R+=String.fromCharCode(Pe);else if("ignore"!=A){var Xe="'ascii' codec can't decode byte 0x"+Pe.toString(16)+" in position "+Ge+": ordinal not in range(128)";throw o.UnicodeDecodeError.$factory(Xe)}break;default:try{!function(Ke){if(void 0===x[Ke]){var yt=o.__import__("encodings."+Ke);yt[Ke].getregentry&&(x[Ke]=n.$getattr(yt[Ke].getregentry(),"decode"))}}(he)}catch(Ke){throw console.log(X,Z,"error load_decoder",Ke),o.LookupError.$factory("unknown encoding: "+he)}return x[he](W)[0]}return R},fe=n.encode=function(){var W=n.args("encode",3,{s:null,encoding:null,errors:null},["s","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null),Z=W.s,A=W.encoding,R=W.errors,X=[],he=0,U=ie(A);switch(U){case"utf-8":case"utf_8":case"utf8":for(var Re=[],Q=0,be=Z.length;Q<be;Q++)(Pe=Z.charCodeAt(Q))<127?Re.push(Pe):Pe<2047?Re.push(192+(Pe>>6),128+(63&Pe)):Pe<65535?Re.push(224+(Pe>>12),128+((4095&Pe)>>6),128+(63&Pe)):console.log("4 bytes");return Re;case"latin":case"latin1":case"latin-1":case"latin_1":case"L1":case"iso8859_1":case"iso_8859_1":case"8859":case"cp819":case"windows1252":for(Q=0,be=Z.length;Q<be;Q++)(Pe=Z.charCodeAt(Q))<=255?X[he++]=Pe:"ignore"!=R&&ye(A,Q);break;case"ascii":for(Q=0,be=Z.length;Q<be;Q++)(Pe=Z.charCodeAt(Q))<=127?X[he++]=Pe:"ignore"!=R&&ye(A,Q);break;case"raw_unicode_escape":for(Q=0,be=Z.length;Q<be;Q++){var Pe;if((Pe=Z.charCodeAt(Q))<256)X[he++]=Pe;else{var Ge=Pe.toString(16);Ge.length%2&&(Ge="0"+Ge),Ge="\\u"+Ge;for(var Ae=0;Ae<Ge.length;Ae++)X[he++]=Ge.charCodeAt(Ae)}}break;default:try{!function(Xe){if(void 0===l[Xe]){var Ke=o.__import__("encodings."+Xe);Ke[Xe].getregentry&&(l[Xe]=n.$getattr(Ke[Xe].getregentry(),"encode"))}}(U)}catch{throw o.LookupError.$factory("unknown encoding: "+A)}X=l[U](Z)[0].source}return X};for(var ae in P.$factory=function(W,Z,A){var R=n.args("bytes",3,{source:null,encoding:null,errors:null},["source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(P,R.source,R.encoding,R.errors)},P.__class__=o.type,P.$is_class=!0,P)void 0===G[ae]&&"function"==typeof P[ae]&&(G[ae]=function(W){return function(){return P[W].apply(null,arguments)}}(ae));n.set_func_names(P,"builtins"),P.fromhex=o.classmethod.$factory(P.fromhex),n.set_func_names(G,"builtins"),G.fromhex=o.classmethod.$factory(G.fromhex),o.bytes=P,o.bytearray=G}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,$N=_b_.None;function create_type(n){return $B.get_class(n).$factory()}function clone(n){var o=create_type(n);for(key in o.$items=n.$items.slice(),n.$hashes)o.$hashes[key]=n.$hashes[key];return o}var set={__class__:_b_.type,$infos:{__module__:"builtins",__name__:"set"},$is_class:!0,$native:!0,__add__:function(n,o){throw _b_.TypeError.$factory("unsupported operand type(s) for +: 'set' and "+typeof o)},__and__:function(n,o,l){try{$test(l,o)}catch{return _b_.NotImplemented}for(var x=create_type(n),B=0,D=n.$items.length;B<D;B++)_b_.getattr(o,"__contains__")(n.$items[B])&&set.add(x,n.$items[B]);return x},__class_getitem__:function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},__contains__:function(n,o){if(n.$simple){if("number"==typeof o||o instanceof Number){if(isNaN(o)){for(var l=n.$items.length-1;l>=0;l--)if(isNaN(n.$items[l]))return!0;return!1}return o instanceof Number?n.$numbers.indexOf(o.valueOf())>-1:n.$items.indexOf(o)>-1}if("string"==typeof o)return n.$items.indexOf(o)>-1}_b_.isinstance(o,set)||$B.$getattr(o,"__hash__");var x=_b_.hash(o);if(n.$hashes[x]){l=0;for(var B=n.$hashes[x].length;l<B;l++)if($B.rich_comp("__eq__",n.$hashes[x][l],o))return!0}return!1},__eq__:function(n,o){if(void 0===o)return n===set;if(_b_.isinstance(o,[_b_.set,_b_.frozenset])){if(o.$items.length==n.$items.length){for(var l=0,x=n.$items.length;l<x;l++)if(!1===set.__contains__(n,o.$items[l]))return!1;return!0}return!1}return _b_.NotImplemented},__format__:function(n,o){return set.__str__(n)},__ge__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(o,n):_b_.NotImplemented},__gt__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__lt__(o,n):_b_.NotImplemented}};set.__hash__=_b_.None,set.__init__=function(n,o,l){if(void 0===l&&Array.isArray(o)){for(var x=0,B=o.length;x<B;x++)$add(n,o[x]);return $N}var D=$B.args("__init__",2,{self:null,iterable:null},["self","iterable"],arguments,{iterable:[]},null,null);if(n=D.self,_b_.isinstance(o=D.iterable,[set,frozenset])){for(var G in n.$items=o.$items.slice(),n.$hashes={},o.$hashes)n.$hashes[G]=o.$hashes[G];return $N}for(var M=$B.$iter(o);;)try{$add(n,_b_.next(M))}catch(P){if(_b_.isinstance(P,_b_.StopIteration))break;throw P}return $N};var set_iterator=$B.make_iterator_class("set iterator");function $test(n,o,l){if(void 0===n&&!_b_.isinstance(o,[set,frozenset]))throw _b_.TypeError.$factory("unsupported operand type(s) for "+l+": 'set' and '"+$B.class_name(o)+"'")}function $add(n,o){var x=!1;if(("string"==typeof o||"number"==typeof o||o instanceof Number)&&(x=!0),x){var B=n.$items.indexOf(o);if(-1==B){if(!(o instanceof Number&&n.$numbers.indexOf(o.valueOf())>-1||"number"==typeof o&&n.$numbers.indexOf(o)>-1)){n.$items.push(o);var D=o.valueOf();"number"==typeof D&&n.$numbers.push(D)}}else o!==n.$items[B]&&n.$items.push(o)}else{var G=_b_.hash(o);if(void 0===(M=n.$hashes[G]))n.$hashes[G]=[o],n.$items.push(o);else{for(var M,P=0,de=(M=n.$hashes[G]).length;P<de;P++)if($B.rich_comp("__eq__",o,M[P]))return $N;n.$hashes[G].push(o),n.$items.push(o)}}return $N}set.__iter__=function(n){return n.$items.sort(),set_iterator.$factory(n.$items)},set.__le__=function(n,o){if(_b_.isinstance(o,[set,frozenset])){for(var l=_b_.getattr(o,"__contains__"),x=0,B=n.$items.length;x<B;x++)if(!l(n.$items[x]))return!1;return!0}return _b_.NotImplemented},set.__len__=function(n){return n.$items.length},set.__lt__=function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(n,o)&&set.__len__(n)<_b_.getattr(o,"__len__")():_b_.NotImplemented},set.__mro__=[_b_.object],set.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("set.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}},set.__or__=function(n,o,l){for(var x=clone(n),B=_b_.getattr($B.$iter(o),"__next__");;)try{set.add(x,B())}catch(D){if(_b_.isinstance(D,_b_.StopIteration))break;throw D}return x.__class__=n.__class__,x},set.__rand__=function(n,o){return set.__and__(n,o)},set.__reduce__=function(n){return _b_.tuple.$factory([n.__class__,_b_.tuple.$factory([n.$items]),$N])},set.__reduce_ex__=function(n,o){return set.__reduce__(n)},set.__rsub__=function(n,o){return set.__sub__(n,o)},set.__rxor__=function(n,o){return set.__xor__(n,o)},set.__str__=set.__repr__=function(n){var o=$B.class_name(n);if(0===n.$items.length)return o+"()";var l=o+"({",x="})";"set({"==l&&(l="{",x="}");var B=[];if($B.repr.enter(n))return o+"(...)";n.$items.sort();for(var D=0,G=n.$items.length;D<G;D++){var M=_b_.repr(n.$items[D]);B.push(M===n||M===n.$items[D]?"{...}":M)}return B=B.join(", "),$B.repr.leave(n),l+B+x},set.__sub__=function(n,o,l){try{$test(l,o,"-")}catch{return _b_.NotImplemented}for(var x=create_type(n),B=_b_.getattr(o,"__contains__"),D=[],G=0,M=n.$items.length;G<M;G++)B(n.$items[G])||D.push(n.$items[G]);return set.__init__.call(null,x,D),x},set.__xor__=function(n,o,l){try{$test(l,o,"^")}catch{return _b_.NotImplemented}for(var x=create_type(n),B=_b_.getattr(o,"__contains__"),D=0,G=n.$items.length;D<G;D++)B(n.$items[D])||set.add(x,n.$items[D]);for(D=0,G=o.$items.length;D<G;D++)set.__contains__(n,o.$items[D])||set.add(x,o.$items[D]);return x},$B.make_rmethods(set),set.add=function(){var n=$B.args("add",2,{self:null,item:null},["self","item"],arguments,{},null,null);return $add(n.self,n.item)},set.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null);return n.self.$items=[],n.self.$hashes={},$N},set.copy=function(){var n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null);if(_b_.isinstance(n.self,frozenset))return n.self;var o=set.$factory();for(key in n.self.$items.forEach(function(l){o.$items.push(l)}),n.self.$numbers.forEach(function(l){o.$numbers.push(l)}),self.$hashes)o.$hashes[key]=self.$hashes[key];return o},set.difference_update=function(n){for(var o=$B.args("difference_update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x,B=set.$factory(o.args[l]),D=_b_.getattr($B.$iter(B),"__next__");;)try{var G=typeof(x=D());if("string"==G||"number"==G){var M=n.$items.indexOf(x);M>-1&&n.$items.splice(M,1)}else for(var P=0;P<n.$items.length;P++)if($B.rich_comp("__eq__",n.$items[P],x)){n.$items.splice(P,1);var de=_b_.hash(x);if(n.$hashes[de])for(var ye=0;ye<n.$hashes[de].length;ye++)if($B.rich_comp("__eq__",n.$hashes[de][ye],x)){n.$hashes[de].splice(ye,1);break}}}catch(ie){if(_b_.isinstance(ie,_b_.StopIteration))break;throw ie}return $N},set.discard=function(){var n=$B.args("discard",2,{self:null,item:null},["self","item"],arguments,{},null,null);try{set.remove(n.self,n.item)}catch(o){if(!_b_.isinstance(o,[_b_.KeyError,_b_.LookupError]))throw o}return $N},set.intersection_update=function(){for(var n=$B.args("intersection_update",1,{self:null},["self"],arguments,{},"args",null),o=n.self,l=0;l<n.args.length;l++){for(var x=[],B=set.$factory(n.args[l]),D=0;D<o.$items.length;D++){var G=o.$items[D],M=typeof G;if("string"==M||"number"==M)-1==B.$items.indexOf(G)&&x.push(D);else{var P=!1,de=_b_.hash(G);if(B.$hashes[de]){for(var ye=B.$hashes[de],ie=0;!P&&ie<ye.length;ie++)$B.rich_comp("__eq__",ye[ie],G)&&(P=!0);if(!P)for(x.push(D),ye=o.$hashes[de],ie=0;!P&&ie<ye.length;ie++)$B.rich_comp("__eq__",ye[ie],G)&&o.$hashes.splice(ie,1)}}}for(x.sort(function(ce,fe){return ce-fe}).reverse(),D=0;D<x.length;D++)o.$items.splice(x[D],1)}return $N},set.isdisjoint=function(){for(var n=$B.args("is_disjoint",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=0,l=n.self.$items.length;o<l;o++)if(_b_.getattr(n.other,"__contains__")(n.self.$items[o]))return!1;return!0},set.pop=function(n){if(0===n.$items.length)throw _b_.KeyError.$factory("pop from an empty set");var o=n.$items.pop();if("string"!=typeof o&&"number"!=typeof o)for(var l=_b_.hash(o),x=n.$hashes[l],B=0;B<x.length;B++)if($B.rich_comp("__eq__",x[B],o)){n.$hashes[l].splice(B,1);break}return o},set.remove=function(n,o){var l=$B.args("remove",2,{self:null,item:null},["self","item"],arguments,{},null,null);if(n=l.self,_b_.isinstance(o=l.item,set)||_b_.hash(o),"string"==typeof o||"number"==typeof o){var x=n.$items.indexOf(o);if(-1==x)throw _b_.KeyError.$factory(o);return n.$items.splice(x,1),"number"==typeof o&&n.$numbers.splice(n.$numbers.indexOf(o),1),$N}var B=_b_.hash(o);if(n.$hashes[B]){for(var D=0,G=n.$items.length;D<G;D++)if($B.rich_comp("__eq__",n.$items[D],o)){n.$items.splice(D,1),o instanceof Number&&n.$numbers.splice(n.$numbers.indexOf(o.valueOf()),1);break}for(D=0,G=n.$hashes[B].length;D<G;D++)if($B.rich_comp("__eq__",n.$hashes[B][D],o)){n.$hashes[B].splice(D,1);break}return $N}throw _b_.KeyError.$factory(o)},set.symmetric_difference_update=function(n,o){for(var l,x=$B.args("symmetric_difference_update",2,{self:null,s:null},["self","s"],arguments,{},null,null),B=(n=x.self,_b_.getattr($B.$iter(o=x.s),"__next__")),D=[],G=[];;)try{var M=typeof(l=B());if("string"==M||"number"==M){var P=n.$items.indexOf(l);P>-1?D.push(P):G.push(l)}else{for(var de=!1,ye=0;!de&&ye<n.$items.length;ye++)$B.rich_comp("__eq__",n.$items[ye],l)&&(D.push(ye),de=!0);de||G.push(l)}}catch(ce){if(_b_.isinstance(ce,_b_.StopIteration))break;throw ce}D.sort(function(ce,fe){return ce-fe}).reverse();for(var ie=0;ie<D.length;ie++)D[ie]!=D[ie-1]&&n.$items.splice(D[ie],1);for(ie=0;ie<G.length;ie++)set.add(n,G[ie]);return $N},set.update=function(n){for(var o=$B.args("update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x=set.$factory(o.args[l]),B=0,D=x.$items.length;B<D;B++)$add(n,x.$items[B]);return $N},set.difference=function(){var n=$B.args("difference",1,{self:null},["self"],arguments,{},"args",null);if(0==n.args.length)return set.copy(n.self);for(var o=clone(n.self),l=0;l<n.args.length;l++)o=set.__sub__(o,set.$factory(n.args[l]),!0);return o};var fc=set.difference+"";function $accept_only_set(n,o){return function(l,x,B){return $test(B,x,o),n(l,x),l}}eval("set.intersection = "+fc.replace(/difference/g,"intersection").replace("__sub__","__and__")),eval("set.symmetric_difference = "+fc.replace(/difference/g,"symmetric_difference").replace("__sub__","__xor__")),eval("set.union = "+fc.replace(/difference/g,"union").replace("__sub__","__or__")),set.issubset=function(){for(var n=$B.args("issubset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.other,"__contains__"),l=0,x=n.self.$items.length;l<x;l++)if(!o(n.self.$items[l]))return!1;return!0},set.issuperset=function(){for(var n=$B.args("issuperset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.self,"__contains__"),l=$B.$iter(n.other);;)try{if(!o(_b_.next(l)))return!1}catch(x){if(_b_.isinstance(x,_b_.StopIteration))return!0;throw x}return!0},set.__iand__=$accept_only_set(set.intersection_update,"&="),set.__isub__=$accept_only_set(set.difference_update,"-="),set.__ixor__=$accept_only_set(set.symmetric_difference_update,"^="),set.__ior__=$accept_only_set(set.update,"|="),set.$factory=function(){var n={__class__:set,$simple:!0,$items:[],$numbers:[],$hashes:{}},o=[n].concat(Array.prototype.slice.call(arguments));return set.__init__.apply(null,o),n},$B.set_func_names(set,"builtins"),set.__class_getitem__=_b_.classmethod.$factory(set.__class_getitem__);var frozenset={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"frozenset"},$is_class:!0,$native:!0};for(var attr in set)switch(attr){case"add":case"clear":case"discard":case"pop":case"remove":case"update":break;default:null==frozenset[attr]&&(frozenset[attr]="function"==typeof set[attr]?function(n){return function(){return set[n].apply(null,arguments)}}(attr):set[attr])}frozenset.__hash__=function(n){if(void 0===n)return frozenset.__hashvalue__||$B.$py_next_hash--;if(void 0!==n.__hashvalue__)return n.__hashvalue__;var o=1927868237;o*=n.$items.length;for(var l=0,x=n.$items.length;l<x;l++){var B=_b_.hash(n.$items[l]);o^=3644798167*(89869747^B^B<<16)}return-1==(o=69069*o+907133923)&&(o=590923713),n.__hashvalue__=o},frozenset.__init__=function(){return $N},frozenset.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("frozenset.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}};var singleton_id=Math.floor(Math.random()*Math.pow(2,40));function empty_frozenset(){var n=frozenset.__new__(frozenset);return n.$id=singleton_id,n}frozenset.$factory=function(){var n=$B.args("frozenset",1,{iterable:null},["iterable"],arguments,{iterable:null},null,null);if(null===n.iterable)return empty_frozenset();if(n.iterable.__class__==frozenset)return n.iterable;var o=set.$factory(n.iterable);return 0==o.$items.length?empty_frozenset():(o.__class__=frozenset,o)},$B.set_func_names(frozenset,"builtins"),_b_.set=set,_b_.frozenset=frozenset}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,_window=self;function to_simple(n){switch(typeof n){case"string":case"number":return n;case"boolean":return n?"true":"false";case"object":if(n===_b_.None)return"null";if(n instanceof Number)return n.valueOf();default:throw console.log("erreur",n),_b_.TypeError.$factory("keys must be str, int, float, bool or None, not "+$B.class_name(n))}}$B.pyobj2structuredclone=function(n,o){if(o=void 0===o||o,"boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(n===_b_.None)return null;if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var l=[],x=0,B=n.length;x<B;x++)l.push($B.pyobj2structuredclone(n[x]));return l}if(_b_.isinstance(n,_b_.dict)){if(o&&(Object.keys(n.$numeric_dict).length>0||Object.keys(n.$object_dict).length>0))throw _b_.TypeError.$factory("a dictionary with non-string keys does not support structured clone");var D=$B.dict_to_list(n);for(l={},x=0,B=D.length;x<B;x++)l[to_simple(D[x][0])]=$B.pyobj2structuredclone(D[x][1]);return l}return n},$B.structuredclone2pyobj=function(n){if(null===n)return _b_.None;if(void 0===n)return $B.Undefined;if("boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var o=_b_.list.$factory(),l=0,x=n.length;l<x;l++)o.push($B.structuredclone2pyobj(n[l]));return o}if("object"==typeof n){for(var B in o=$B.empty_dict(),n)_b_.dict.$setitem(o,B,$B.structuredclone2pyobj(n[B]));return o}throw console.log(n,Array.isArray(n),n.__class__,_b_.list,n.__class__===_b_.list),_b_.TypeError.$factory(_b_.str.$factory(n)+" does not support the structured clone algorithm")};var JSConstructor={__class__:_b_.type,__mro__:[object],$infos:{__module__:"<javascript>",__name__:"JSConstructor"},$is_class:!0,__call__:function(n){return function(){for(var o=[null],l=0,x=arguments.length;l<x;l++)o.push(pyobj2jsobj(arguments[l]));var B=new(n.func.bind.apply(n.func,o));return $B.$JS2Py(B)}},__getattribute__:function(n,o){return"__call__"==o?function(){for(var l=[null],x=0,B=arguments.length;x<B;x++)l.push(pyobj2jsobj(arguments[x]));var D=new(n.func.bind.apply(n.func,l));return $B.$JS2Py(D)}:JSObject.__getattribute__(n,o)},$factory:function(n){return{__class__:JSConstructor,js:n,func:n.js_func}}},jsobj2pyobj=$B.jsobj2pyobj=function(n){switch(n){case!0:case!1:return n}return void 0===n?$B.Undefined:null===n?_b_.None:Array.isArray(n)?_b_.list.$factory(n.map(jsobj2pyobj)):"number"==typeof n?-1==n.toString().indexOf(".")?_b_.int.$factory(n):_b_.float.$factory(n):"kw"===n.$nat?n:$B.$isNode(n)?$B.DOMNode.$factory(n):$B.JSObj.$factory(n)},pyobj2jsobj=$B.pyobj2jsobj=function(n){if(!0===n||!1===n)return n;if(n===_b_.None)return null;if(n!==$B.Undefined){var o=$B.get_class(n);if(void 0===o)return n;if(o===JSConstructor)return void 0!==n.js_func?n.js_func:n.js;if(o===$B.DOMNode||o.__mro__.indexOf($B.DOMNode)>-1)return n;if([_b_.list,_b_.tuple].indexOf(o)>-1){var l=[];return n.forEach(function(B){l.push(pyobj2jsobj(B))}),l}if(o===_b_.dict||_b_.issubclass(o,_b_.dict)){var x={};return _b_.list.$factory(_b_.dict.items(n)).forEach(function(B){"function"==typeof B[1]&&B[1].bind(x),x[B[0]]=pyobj2jsobj(B[1])}),x}return o===_b_.float?n.valueOf():o===$B.Function||o===$B.method?function(){try{for(var B=[],D=0;D<arguments.length;D++)B.push(void 0===arguments[D]?_b_.None:jsobj2pyobj(arguments[D]));return pyobj2jsobj(n.apply(this,B))}catch(G){throw console.log(G),console.log($B.$getattr(G,"info")),console.log($B.class_name(G)+":",G.args.length>0?G.args[0]:""),G}}:n}};function pyargs2jsargs(n){for(var o=[],l=0,x=n.length;l<x;l++){var B=n[l];if(null!=B&&void 0!==B.$nat){var D=B.kw;if(Array.isArray(D)&&(D=$B.extend(js_attr.name,...D)),Object.keys(D).length>0)throw _b_.TypeError.$factory("A Javascript function can't take keyword arguments")}else o.push($B.pyobj2jsobj(B))}return o}$B.JSConstructor=JSConstructor,$B.JSObj=$B.make_class("JSObj",function(n){if(!Array.isArray(n))if("function"==typeof n)n.$is_js_func=!0;else if("number"==typeof n&&!Number.isInteger(n))return new Number(n);return n}),$B.JSObj.__sub__=function(n,o){if("bigint"==typeof n&&"bigint"==typeof o)return n-o;throw _b_.TypeError.$factory("unsupported operand type(s) for - : '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'")};var ops={"+":"__add__","*":"__mul__","**":"__pow__","%":"__mod__"};for(var op in ops)eval("$B.JSObj."+ops[op]+" = "+($B.JSObj.__sub__+"").replace(/-/g,op));$B.JSObj.__eq__=function(n,o){if("object"==typeof n){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(var l in n)if(!$B.JSObj.__eq__(n[l],o[l]))return!1}return n===o},$B.JSObj.__ne__=function(n,o){return!$B.JSObj.__eq__(n,o)},$B.JSObj.__getattribute__=function(n,o){if("$$new"==o&&"function"==typeof n)return n.$js_func?function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n.$js_func(...G))}:function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n(...G))};"string"==typeof o&&(o=$B.from_alias(o));var l=n[o];if(null==l&&"function"==typeof n&&n.$js_func&&(l=n.$js_func[o]),void 0===l){if("function"==typeof n.getNamedItem&&void 0!==(D=n.getNamedItem(o)))return $B.JSObj.$factory(D);var x=$B.get_class(n);if(x&&x[o]){var B=x[o];return"function"==typeof B?function(){for(var G=[n],M=0,P=arguments.length;M<P;M++)G.push(arguments[M]);return $B.JSObj.$factory(B.apply(null,G))}:B}if("bind"==o&&"function"==typeof n.addEventListener)return function(G,M){return n.addEventListener(G,M)};throw _b_.AttributeError.$factory(o)}if("function"==typeof l){var D=function(){var G=pyargs2jsargs(arguments),M=n.$js_func||n;try{var P=l.apply(M,G)}catch(de){throw console.log("error",de),console.log("attribute",o,"of self",n,l,G,arguments),de}return void 0===P?$B.Undefined:null===P?_b_.None:$B.JSObj.$factory(P)};return D.prototype=l.prototype,D.$js_func=l,D.__mro__=[_b_.object],D.$infos={__name__:l.name,__qualname__:l.name},$B.frames_stack.length>0&&(D.$infos.__module__=$B.last($B.frames_stack)[3].__name__),$B.JSObj.$factory(D)}return $B.JSObj.$factory(l)},$B.JSObj.__setattr__=function(n,o,l){return"string"==typeof o&&(o=$B.from_alias(o)),n[o]=$B.pyobj2structuredclone(l),_b_.None},$B.JSObj.__getitem__=function(n,o){if("string"==typeof o)return $B.JSObj.__getattribute__(n,o);if("number"==typeof o){if(void 0!==n[o])return $B.JSObj.$factory(n[o]);if("number"==typeof n.length&&("number"==typeof o||"boolean"==typeof o)&&"function"==typeof n.item){var l=_b_.int.$factory(o);l<0&&(l+=n.length);var x=n.item(l);if(null===x)throw _b_.IndexError.$factory(l);return $B.JSObj.$factory(x)}}throw _b_.KeyError.$factory(l)},$B.JSObj.__setitem__=$B.JSObj.__setattr__;var JSObj_iterator=$B.make_iterator_class("JS object iterator");$B.JSObj.__iter__=function(n){var o=[];if(_window.Symbol&&void 0!==n[Symbol.iterator]){if(o=[],void 0!==n.next)for(;;){var l=n.next();if(l.done)break;o.push($B.JSObj.$factory(l.value))}else if(void 0!==n.length&&void 0!==n.item)for(var x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.item(x)));return JSObj_iterator.$factory(o)}if(void 0!==n.length&&void 0!==n.item){for(x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.js.item(x)));return JSObj_iterator.$factory(o)}var B=$B.JSObj.to_dict(n);return _b_.dict.__iter__(B)},$B.JSObj.__len__=function(n){if("number"==typeof n.length)return n.length;throw _b_.AttributeError.$factory(n+" has no attribute __len__")},$B.JSObj.__repr__=$B.JSObj.__str__=function(n){return"<Javascript "+n.constructor.name+" object: "+n.toString()+">"},$B.JSObj.bind=function(n,o,l){return n.addEventListener(o,function(x){return l(jsobj2pyobj(x))}),_b_.None},$B.JSObj.to_dict=function(n){return $B.structuredclone2pyobj(n)},$B.set_func_names($B.JSObj,"builtins"),$B.JSMeta=$B.make_class("JSMeta"),$B.JSMeta.__call__=function(n){for(var o=[],l=1,x=arguments.length;l<x;l++)o.push(arguments[l]);return new n.__mro__[0].$js_func(...o)},$B.JSMeta.__mro__=[_b_.type,_b_.object],$B.JSMeta.__getattribute__=function(n,o){return void 0!==n[o]?n[o]:void 0!==$B.JSMeta[o]?$B.JSMeta[o]:_b_.type.__getattribute__(n,o)},$B.JSMeta.__init_subclass__=function(){},$B.set_func_names($B.JSMeta,"builtins")}(__BRYTHON__),function(n){n.stdlib={};for(var o=["VFS_import","__future__","_abcoll","_codecs","_collections","_collections_abc","_compat_pickle","_contextvars","_csv","_dummy_thread","_frozen_importlib","_functools","_imp","_io","_markupbase","_operator","_py_abc","_pydecimal","_queue","_random","_socket","_sre","_struct","_sysconfigdata","_sysconfigdata_0_brython_","_testcapi","_thread","_threading_local","_weakref","_weakrefset","abc","antigravity","argparse","atexit","base64","bdb","binascii","bisect","browser.aio","browser.ajax","browser.highlight","browser.html","browser.indexed_db","browser.local_storage","browser.markdown","browser.object_storage","browser.session_storage","browser.svg","browser.template","browser.timer","browser.webcomponent","browser.websocket","browser.webworker","browser.worker","calendar","cmath","cmd","code","codecs","codeop","colorsys","configparser","contextlib","contextvars","copy","copyreg","csv","dataclasses","datetime","decimal","difflib","doctest","enum","errno","external_import","faulthandler","fnmatch","formatter","fractions","functools","gc","genericpath","getopt","gettext","glob","heapq","hmac","imp","inspect","interpreter","io","ipaddress","itertools","json","keyword","linecache","locale","mimetypes","nntplib","ntpath","numbers","opcode","operator","optparse","os","pathlib","pdb","pickle","pkgutil","platform","posixpath","pprint","profile","pwd","py_compile","pydoc","queue","quopri","re","reprlib","select","selectors","shlex","shutil","signal","site","site-packages.__future__","site-packages.docs","site-packages.header","site-packages.test","site-packages.test_sp","socket","sre_compile","sre_constants","sre_parse","stat","string","stringprep","struct","subprocess","sys","sysconfig","tarfile","tb","tempfile","test.namespace_pkgs.module_and_namespace_package.a_test","textwrap","this","threading","time","timeit","token","tokenize","traceback","turtle","types","typing","uu","uuid","warnings","weakref","webbrowser","zipfile","zipimport","zlib"],l=0;l<o.length;l++)n.stdlib[o[l]]=["py"];var x=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","aes","array","builtins","dis","hashlib","hmac-md5","hmac-ripemd160","hmac-sha1","hmac-sha224","hmac-sha256","hmac-sha3","hmac-sha384","hmac-sha512","long_int","marshal","math","math1","md5","modulefinder","pbkdf2","posix","rabbit","rabbit-legacy","random","rc4","ripemd160","sha1","sha224","sha256","sha3","sha384","sha512","tripledes","unicodedata"];for(l=0;l<x.length;l++)n.stdlib[x[l]]=["js"];var B=["browser.widgets","collections","concurrent","concurrent.futures","email","email.mime","encodings","html","http","importlib","logging","multiprocessing","multiprocessing.dummy","pydoc_data","site-packages.foobar","site-packages.simpleaio","site-packages.simpy","site-packages.simpy.resources","site-packages.ui","test","test.encoded_modules","test.leakers","test.namespace_pkgs.not_a_namespace_pkg.foo","test.support","test.test_email","test.test_importlib","test.test_importlib.builtin","test.test_importlib.extension","test.test_importlib.frozen","test.test_importlib.import_","test.test_importlib.source","test.test_json","test.tracedmodules","unittest","unittest.test","unittest.test.testmock","urllib"];for(l=0;l<B.length;l++)n.stdlib[B[l]]=["py",!0]}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,module=$B.module={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"module"},$is_class:!0};function parent_package(n){var o=n.split(".");return o.pop(),o.join(".")}function $download_module(n,o,l){var x=new XMLHttpRequest,B="?v="+(new Date).getTime(),D=null,G=n.__name__,M=_window.setTimeout(function(){x.abort()},5e3);if(x.open("GET",$B.$options.cache?o:o+B,!1),x.send(),$B.$CORS?D=200==x.status||0==x.status?x.responseText:_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"):4==x.readyState&&(200==x.status?(D=x.responseText,n.$last_modified=x.getResponseHeader("Last-Modified")):(console.info("Error "+x.status+" means that Python module "+G+" was not found at url "+o),D=_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"))),_window.clearTimeout(M),null==D)throw _b_.ModuleNotFoundError.$factory("No module named '"+G+"' (res is null)");if(D.constructor===Error)throw D;return D}function import_js(n,o){try{var l=$download_module(n,o,void 0)}catch{return null}return run_js(l,o,n),!0}function run_js(n,o,l){try{var x=new Function(n+";\nreturn $module")();$B.$options.store&&(l.$js=n)}catch(D){throw console.log(D),console.log(o,l),D}for(var B in x.__name__=l.__name__,x)"function"==typeof x[B]&&(x[B].$infos={__module__:l.__name__,__name__:B,__qualname__:B});if(void 0!==l){for(var B in x)l[B]=x[B];(x=l).__class__=module}else x.__class__=module,x.__name__=l.__name__,x.__repr__=x.__str__=function(){return $B.builtin_module_names.indexOf(l.name)>-1?"<module '"+l.__name__+"' (built-in)>":"<module '"+l.__name__+"' from "+o+" >"},"builtins"!=l.name&&(x.__file__=o);return $B.imported[l.__name__]=x,!0}function show_ns(){for(var kk=Object.keys(_window),i=0,len=kk.length;i<len;i++)console.log(kk[i]),"$"==kk[i].charAt(0)&&console.log(eval(kk[i]));console.log("---")}function import_py(n,o,l){var x=n.__name__,B=$download_module(n,o,l);if(n.$src=B,$B.imported[x].$is_package=n.$is_package,$B.imported[x].$last_modified=n.$last_modified,"/__init__.py"==o.substr(o.length-12))$B.imported[x].__package__=x,$B.imported[x].__path__=o,$B.imported[x].$is_package=n.$is_package=!0;else if(l)$B.imported[x].__package__=l;else{var D=x.split(".");D.pop(),$B.imported[x].__package__=D.join(".")}return $B.imported[x].__file__=o,run_py(B,o,n)}function run_py(module_contents,path,module,compiled){$B.file_cache[path]=module_contents;var root,js,mod_name=module.__name__;if(!compiled){var $Node=$B.$Node,$NodeJSCtx=$B.$NodeJSCtx;$B.$py_module_path[module.__name__]=path;var src={src:module_contents,has_annotations:!1};root=$B.py2js(src,module,module.__name__,$B.builtins_scope),void 0!==module.__package__&&(root.binding.__package__=!0)}try{js=compiled?module_contents:root.to_js(),10==$B.$options.debug&&(console.log("code for module "+module.__name__),console.log(js));var src=js;js="var $module = (function(){\n"+js+"return $locals_"+module.__name__.replace(/\./g,"_")+"})(__BRYTHON__)\nreturn $module";var module_id="$locals_"+module.__name__.replace(/\./g,"_"),$module=new Function(module_id,js)(module)}catch(n){for(var attr in console.log(n+" for module "+module.__name__),console.log("module",module),console.log(root),$B.debug>1&&console.log(js),n)console.log(attr,n[attr]);throw console.log(_b_.getattr(n,"info","[no info]")),console.log("message: "+n.$message),console.log("filename: "+n.fileName),console.log("linenum: "+n.lineNumber),$B.debug>0&&console.log("line info "+$B.line_info),n}finally{$B.clear_ns(module.__name__)}try{var mod=eval("$module");for(var attr in mod)module[attr]=mod[attr];return module.__initializing__=!1,$B.imported[module.__name__]=module,{content:src,name:mod_name,imports:Object.keys(root.imports).join(",")}}catch(n){for(var attr in console.log(n+"  for module "+module.__name__),n)console.log(attr+" "+n[attr]);throw $B.debug>0&&console.log("line info "+__BRYTHON__.line_info),n}}function new_spec(n){return n.__class__=module,n}module.__init__=function(){},module.__new__=function(n,o,l,x){return{__class__:n,__name__:o,__doc__:l||_b_.None,__package__:x||_b_.None}},module.__repr__=module.__str__=function(n){var o="<module "+n.__name__;return void 0===n.__file__&&(o+=" (built-in)"),o+">"},module.__setattr__=function(n,o,l){"__builtins__"==n.__name__?$B.builtins[o]=l:n[o]=l},module.$factory=function(n,o,l){return{__class__:module,__name__:n,__doc__:o||_b_.None,__package__:l||_b_.None}},$B.set_func_names(module,"builtins"),$B.$download_module=$download_module,$B.run_py=run_py;var finder_VFS={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"VFSFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state.stored,x=o.__spec__.loader_state.timestamp;delete o.__spec__.loader_state;var B=l[0],D=l[1];o.$is_package=l[3]||!1;var G="VFS."+o.__name__;if(o.__file__=G+=o.$is_package?"/__init__.py":B,$B.file_cache[o.__file__]=$B.VFS[o.__name__][1],".js"==B)run_js(D,o.__path__,o);else{if($B.precompiled.hasOwnProperty(o.__name__)){$B.debug>1&&console.info("load",o.__name__,"from precompiled");for(var M=o.__name__.split("."),P=0;P<M.length;P++){var de=M.slice(0,P+1).join(".");if(!$B.imported.hasOwnProperty(de)||!$B.imported[de].__initialized__){var ye=$B.precompiled[de],ie=o.$is_package;Array.isArray(ye)&&(ye=ye[0]);var ce=$B.imported[de]=module.$factory(de,void 0,ie);ce.__initialized__=!0,ie?(ce.__path__="<stdlib>",ce.__package__=de):((R=de.split(".")).pop(),ce.__package__=R.join(".")),ce.__file__=G;try{var fe=de.replace(/\./g,"_");ye+="return $locals_"+fe;var ae=new Function("$locals_"+fe,ye)(ce)}catch(he){if($B.debug>1){for(var W in console.log(he),he)console.log(W,he[W]);console.log(Object.keys($B.imported)),$B.debug>2&&console.log(o,"mod_js",ye)}throw he}for(var Z in ae)ce[Z]=ae[Z];ae.__file__=G,P>0&&$B.builtins.setattr($B.imported[M.slice(0,P).join(".")],M[P],ae)}}return ae}var A=o.__name__;$B.debug>1&&console.log("run Python code from VFS",A);var R,X=run_py(D,o.__path__,o);X.is_package=o.$is_package,X.timestamp=$B.timestamp,X.source_ts=x,$B.precompiled[A]=X.is_package?[X.content]:X.content,(R=A.split(".")).length>1&&R.pop(),$B.$options.indexedDB&&self.indexedDB&&$B.idb_name&&(indexedDB.open($B.idb_name).onsuccess=function(he){var U=he.target.result.transaction("modules","readwrite").objectStore("modules"),Re=(U.openCursor(),U.put(X));Re.onsuccess=function(){$B.debug>1&&console.info(o.__name__,"stored in db")},Re.onerror=function(){console.info("could not store "+o.__name__)}})}},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,B){var D=n.find_spec(n,x,B),G=module.$factory(x);$B.imported[x]=G,G.__spec__=D,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){var B,D,G;return $B.use_VFS?void 0===(B=$B.VFS[o])?_b_.None:(D=B[3]||!1,G=B.timestamp,B?new_spec({name:o,loader:n,origin:$B.builtin_module_names.indexOf(o)>-1?"built-in":"brython_stdlib",submodule_search_locations:D?[]:_b_.None,loader_state:{stored:B,timestamp:G},cached:_b_.None,parent:D?o:parent_package(o),has_location:_b_.False}):void 0):_b_.None}};for(var method in $B.set_func_names(finder_VFS,"<import>"),finder_VFS)"function"==typeof finder_VFS[method]&&(finder_VFS[method]=_b_.classmethod.$factory(finder_VFS[method]));finder_VFS.$factory=function(){return{__class__:finder_VFS}};var finder_cpython={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"CPythonFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){console.log("exec PYthon module",o);var l=o.__spec__.loader_state,x=l.content;delete o.__spec__.loader_state,o.$is_package=l.is_package,o.__file__=l.__file__,$B.file_cache[o.__file__]=x,$B.debug>1&&console.log("run Python code from CPython",o.__name__),run_py(x,o.__path__,o)},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,B){var D=n.find_spec(n,x,B),G=module.$factory(x);$B.imported[x]=G,G.__spec__=D,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){console.log("finder cpython",o);var B,D=new XMLHttpRequest;return D.open("GET","/cpython_import?module="+o,!1),D.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var M=JSON.parse(this.responseText);B=new_spec({name:o,loader:n,origin:"CPython",submodule_search_locations:M.is_package?[]:_b_.None,loader_state:{content:M.content},cached:_b_.None,parent:M.is_package?o:parent_package(o),has_location:_b_.False})}},D.send(),B}};for(var method in $B.set_func_names(finder_cpython,"<import>"),finder_cpython)"function"==typeof finder_cpython[method]&&(finder_cpython[method]=_b_.classmethod.$factory(finder_cpython[method]));finder_cpython.$factory=function(){return{__class__:finder_cpython}};var finder_stdlib_static={$factory:finder_stdlib_static,__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"StdlibStatic"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state;o.$is_package=l.is_package,"py"==l.ext?import_py(o,l.path,o.__package__):import_js(o,l.path),delete o.__spec__.loader_state},find_module:function(n,o,l){var x=n.find_spec(n,o,l);return x===_b_.None?_b_.None:{__class__:Loader,load_module:function(B,D){var G=module.$factory(B);$B.imported[B]=G,G.__spec__=x,G.__package__=x.parent,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){if($B.stdlib&&$B.$options.static_stdlib_import){var B=$B.stdlib[o];if(void 0===B){var D=o.split(".");if(D.length>1){D.pop();var G=$B.stdlib[D.join(".")];G&&G[1]&&(B=["py"])}}if(void 0!==B){var M=B[0],P=void 0!==B[1],de={ext:M,is_package:P,path:(l=$B.brython_path+("py"==M?"Lib/":"libs/")+o.replace(/\./g,"/"))+(P?"/__init__.py":"py"==M?".py":".js"),address:B};return new_spec({name:o,loader:n,origin:de.path,submodule_search_locations:P?[l]:_b_.None,loader_state:de,cached:_b_.None,parent:P?o:parent_package(o),has_location:_b_.True})}}return _b_.None}};for(var method in $B.set_func_names(finder_stdlib_static,"<import>"),finder_stdlib_static)"function"==typeof finder_stdlib_static[method]&&(finder_stdlib_static[method]=_b_.classmethod.$factory(finder_stdlib_static[method]));finder_stdlib_static.$factory=function(){return{__class__:finder_stdlib_static}};var finder_path={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"ImporterPath"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=$B.$getattr(o,"__spec__"),x=l.loader_state.code;o.$is_package=l.loader_state.is_package,delete l.loader_state.code;var B=l.loader_state.type;"py"==B||"pyc.js"==B?run_py(x,l.origin,o,"pyc.js"==B):"js"==l.loader_state.type&&run_js(x,l.origin,o)},find_module:function(n,o,l){return finder_path.find_spec(n,o,l)},find_spec:function(n,o,l,x){var B=$B.last($B.frames_stack)[2];if($B.VFS&&$B.VFS[B])return _b_.None;$B.is_none(l)&&(l=$B.path);for(var D=0,G=l.length;D<G;++D){var M=l[D];"/"!=M[M.length-1]&&(M+="/");var P=$B.path_importer_cache[M];if(void 0===P){for(var de=!0,ye=0,ie=$B.path_hooks.length;ye<ie&&de;++ye){var ce=$B.path_hooks[ye].$factory;try{P=("function"==typeof ce?ce:$B.$getattr(ce,"__call__"))(M),de=!1}catch(W){if(W.__class__!==_b_.ImportError)throw W}}de&&($B.path_importer_cache[M]=_b_.None)}if(!$B.is_none(P)){var fe=$B.$getattr(P,"find_spec"),ae=("function"==typeof fe?fe:$B.$getattr(fe,"__call__"))(o,x);if(!$B.is_none(ae))return ae}}return _b_.None}};for(var method in $B.set_func_names(finder_path,"<import>"),finder_path)"function"==typeof finder_path[method]&&(finder_path[method]=_b_.classmethod.$factory(finder_path[method]));finder_path.$factory=function(){return{__class__:finder_path}};var url_hook={__class__:_b_.type,__mro__:[_b_.object],__repr__:function(n){return"<UrlPathFinder"+(n.hint?" for '"+n.hint+"'":"(unbound)")+" at "+n.path_entry+">"},$infos:{__module__:"builtins",__name__:"UrlPathFinder"},find_spec:function(n,o,l){var x={},B=!0,D=n.hint,G=n.path_entry+o.match(/[^.]+$/g)[0],M=[];(void 0===D||"py"==D)&&(M=M.concat([[G+".py","py",!1],[G+"/__init__.py","py",!0]]));for(var P=0;B&&P<M.length;++P)try{var de=M[P];x.code=$download_module({__name__:o,$is_package:!1},de[0],void 0),B=!1,x.type=de[1],x.is_package=de[2],void 0===D&&(n.hint=de[1],$B.path_importer_cache[n.path_entry]=n),x.is_package&&($B.path_importer_cache[G+"/"]=url_hook.$factory(G+"/",n.hint)),x.path=de[0]}catch{}return B?_b_.None:new_spec({name:o,loader:finder_path,origin:x.path,submodule_search_locations:x.is_package?[G]:_b_.None,loader_state:x,cached:_b_.None,parent:x.is_package?o:parent_package(o),has_location:_b_.True})},invalidate_caches:function(n){},$factory:function(n,o){return{__class__:url_hook,path_entry:n.endsWith("/")?n:n+"/",hint:o}}};$B.set_func_names(url_hook,"<import>"),$B.path_importer_cache={};for(var _sys_paths=[[$B.script_dir+"/","py"],[$B.brython_path+"Lib/","py"],[$B.brython_path+"Lib/site-packages/","py"],[$B.brython_path+"libs/","js"]],i=0;i<_sys_paths.length;++i){var _path=_sys_paths[i],_type=_path[1];_path=_path[0],$B.path_importer_cache[_path]=url_hook.$factory(_path,_type)}function import_error(n){var o=_b_.ImportError.$factory(n);throw o.name=n,o}function optimize_import_for_path(n,o){"/"!=n.slice(-1)&&(n+="/");var l="none"==o?_b_.None:url_hook.$factory(n,o);$B.path_importer_cache[n]=l}$B.$__import__=function(n,o,l,x,B){var D=!1;if(o.$jsobj&&o.$jsobj.__file__){var G=o.$jsobj.__file__;(G.startsWith($B.brython_path+"Lib/")&&!G.startsWith($B.brython_path+"Lib/site-packages/")||G.startsWith($B.brython_path+"libs/")||G.startsWith("VFS."))&&(D=!0)}var M=$B.imported[n],P=n.split("."),de=x.length>0;if(M==_b_.None&&import_error(n),void 0===M){$B.is_none(x)&&(x=[]);for(var ye=0,ie="",ce="",fe=P.length-1,ae=_b_.None;ye<=fe;++ye){var W=ce;if(ce+=ie+P[ye],ie=".",(M=$B.imported[ce])==_b_.None)import_error(ce);else if(void 0===M){try{$B.import_hooks(ce,ae,D)}catch(A){throw delete $B.imported[ce],A}$B.is_none($B.imported[ce])?import_error(ce):W&&_b_.setattr($B.imported[W],P[ye],$B.imported[ce])}else $B.imported[W]&&void 0===$B.imported[W][P[ye]]&&_b_.setattr($B.imported[W],P[ye],$B.imported[ce]);if(ye<fe)try{ae=$B.$getattr($B.imported[ce],"__path__")}catch{if(ye==fe-1&&$B.imported[ce][P[fe]]&&$B.imported[ce][P[fe]].__class__===module)return $B.imported[ce][P[fe]];if(!de){var Z=_b_.ModuleNotFoundError.$factory();throw Z.msg="No module named '"+n+"'; '"+ce+"' is not a package",Z.args=$B.fast_tuple([Z.msg]),Z.name=n,Z.path=_b_.None,Z}import_error(n)}}}else if($B.imported[P[0]]&&2==P.length)try{void 0===$B.imported[P[0]][P[1]]&&$B.$setattr($B.imported[P[0]],P[1],M)}catch(A){throw console.log("error",P,M),A}return x.length>0?$B.imported[n]:$B.imported[P[0]]},$B.$import=function(n,o,l,x){o=void 0===o?[]:o,l=void 0===l?{}:l,x=void 0===x?{}:x;var B=n.split(".");"."==n[n.length-1]&&B.pop();for(var D=[],G=!0,M=0,P=B.length;M<P;M++){var de=B[M];if(G&&""==de){if(elt=D.pop(),void 0===elt)throw _b_.ImportError.$factory("Parent module '' not loaded, cannot perform relative import")}else G=!1,D.push("$$"==de.substr(0,2)?de.substr(2):de)}n=D.join("."),10==$B.$options.debug&&(console.log("$import "+n),console.log("use VFS ? "+$B.use_VFS),console.log("use static stdlib paths ? "+$B.static_stdlib_import));var ye=$B.frames_stack[$B.frames_stack.length-1],ie=ye[3],ce=ie.__import__,fe=$B.obj_dict(ie);void 0===ce&&(ce=$B.$__import__);var ae=("function"==typeof ce?ce:$B.$getattr(ce,"__call__"))(n,fe,void 0,o,0);if(o&&0!=o.length){var W=o,Z={};if(o&&"*"==o[0]&&(W=$B.$getattr(ae,"__all__",Z))!==Z&&(l={}),W===Z)for(var A in ae)"_"!==A[0]&&(x[A]=ae[A]);else{M=0;for(var R=W.length;M<R;++M){var X=W[M],he=l[X]||X;try{x[he]=$B.$getattr(ae,X)}catch{try{var U=$B.from_alias(X);$B.$getattr(ce,"__call__")(n+"."+U,fe,void 0,[],0),x[he]=$B.$getattr(ae,U)}catch(Ge){if("__future__"===n){var Re=$B.last($B.frames_stack),Q=Re[3].$line_info.split(","),be=parseInt(Q[0]);$B.$SyntaxError(Re[2],"future feature "+X+" is not defined",ye[3].src,void 0,be)}throw Ge.$py_error?(Ge.__class__!==_b_.ImportError&&Ge.__class__!==_b_.ModuleNotFoundError&&$B.handle_error(Ge),_b_.ImportError.$factory("cannot import name '"+X+"'")):($B.debug>1&&(console.log(Ge),console.log($B.last($B.frames_stack))),_b_.ImportError.$factory("cannot import name '"+X+"'"))}}}}return x}(he=l[n])?x[he]=$B.imported[n]:x[$B.to_alias(D[0])]=ae},$B.import_all=function(n,o){for(var l in o)(l.startsWith("$$")||-1=="_$".indexOf(l.charAt(0)))&&(n[l]=o[l])},$B.$path_hooks=[url_hook],$B.$meta_path=[finder_VFS,finder_stdlib_static,finder_path],$B.finders={VFS:finder_VFS,stdlib_static:finder_stdlib_static,path:finder_path,CPython:finder_cpython};var Loader={__class__:$B.$type,__mro__:[_b_.object],__name__:"Loader"},_importlib_module={__class__:module,__name__:"_importlib",Loader,VFSFinder:finder_VFS,StdlibStatic:finder_stdlib_static,ImporterPath:finder_path,UrlPathFinder:url_hook,optimize_import_for_path};_importlib_module.__repr__=_importlib_module.__str__=function(){return"<module '_importlib' (built-in)>"},$B.imported._importlib=_importlib_module}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var object=_b_.object;function $err(n,o){var l="unsupported operand type(s) for "+n+": 'float' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function float_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var float={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"float"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="eEfFgGn%".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'float'");if(isNaN(n))return"f"==o.type||"g"==o.type?"nan":"NAN";if(n==Number.POSITIVE_INFINITY)return"f"==o.type||"g"==o.type?"inf":"INF";if(void 0===o.precision&&void 0!==o.type&&(o.precision=6),"%"==o.type&&(n*=100),"e"==o.type){var l=n.toExponential(o.precision),x=parseInt(l.substr(l.search("e")+1));return Math.abs(x)<10&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),l}if(void 0!==o.precision){var B=o.precision;if(0==B)return Math.round(n)+"";var D=(l=n.toFixed(B)).indexOf(".");if(void 0===o.type||"%"!=o.type&&"f"!=o.type.toLowerCase()){if(o.type&&"g"==o.type.toLowerCase()){var G=preformat(n,{type:"e"}).split("e"),M=(l=-4<=(x=parseInt(G[1]))&&x<o.precision?preformat(n,{type:"f",precision:o.precision-1-x}):preformat(n,{type:"e",precision:o.precision-1})).split("e");if(o.alternate)-1==M[0].search(/\./)&&(M[0]+=".");else if(M[1]){for(var P=M[0];P.endsWith("0");)P=P.substr(0,P.length-1);P.endsWith(".")&&(P=P.substr(0,P.length-1)),M[0]=P}return l=M.join("e"),"G"==o.type&&(l=l.toUpperCase()),l}if(void 0===o.type)o.type="g",l=preformat(n,o),o.type=void 0;else{var de=n.toExponential(o.precision-1);if((x=parseInt(de.substr(de.search("e")+1)))<-4||x>=o.precision-1){for(var ye=de.split("e");ye[0].endsWith("0");)ye[0]=ye[0].substr(0,ye[0].length-1);l=ye.join("e")}}}else if(-1==D)l+="."+"0".repeat(o.precision);else{var ie=o.precision-l.length+D+1;ie>0&&(l+="0".repeat(ie))}}else l=_b_.str.$factory(n);if(void 0===o.type||-1!="gGn".indexOf(o.type)){if(-1==l.search("e"))for(;"0"==l.charAt(l.length-1);)l=l.substr(0,l.length-1);"."==l.charAt(l.length-1)&&(void 0===o.type?l+="0":l=l.substr(0,l.length-1))}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>0&&(l=o.sign+l),"%"==o.type&&(l+="%"),l}float.numerator=function(n){return float_value(n)},float.denominator=function(n){return _b_.int.$factory(1)},float.imag=function(n){return _b_.int.$factory(0)},float.real=function(n){return float_value(n)},float.__float__=function(n){return float_value(n)},float.as_integer_ratio=function(n){if((n=float_value(n)).valueOf()==Number.POSITIVE_INFINITY||n.valueOf()==Number.NEGATIVE_INFINITY)throw _b_.OverflowError.$factory("Cannot pass infinity to float.as_integer_ratio.");if(!Number.isFinite(n.valueOf()))throw _b_.ValueError.$factory("Cannot pass NaN to float.as_integer_ratio.");for(var o=_b_.$frexp(n.valueOf()),l=o[0],x=o[1],B=0;B<300&&l!=Math.floor(l);B++)l*=2,x--;return numerator=float.$factory(l),py_exponent=abs(x),denominator=1,py_exponent=_b_.getattr(_b_.int.$factory(denominator),"__lshift__")(py_exponent),x>0?numerator*=py_exponent:denominator=py_exponent,_b_.tuple.$factory([_b_.int.$factory(numerator),_b_.int.$factory(denominator)])},float.__bool__=function(n){return n=float_value(n),_b_.bool.$factory(n.valueOf())},float.__eq__=function(n,o){return n=float_value(n),o=float_value(o),(!isNaN(n)||!isNaN(o))&&(isinstance(o,_b_.int)?n==o:isinstance(o,float)?n.valueOf()==o.valueOf():isinstance(o,_b_.complex)?0==o.$imag&&n==o.$real:_b_.NotImplemented)},float.__floordiv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(Math.floor(n/o))}if(hasattr(o,"__rfloordiv__"))return getattr(o,"__rfloordiv__")(n);$err("//",o)},float.fromhex=function(n){if(!isinstance(n,_b_.str))throw _b_.ValueError.$factory("argument must be a string");var o,l=n.trim();switch(l.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return $FloatClass(1/0);case"-inf":case"-infinity":return $FloatClass(-1/0);case"+nan":case"nan":return $FloatClass(Number.NaN);case"-nan":return $FloatClass(-Number.NaN);case"":throw _b_.ValueError.$factory("could not convert string to float")}if(null!==(o=/^(\d*\.?\d*)$/.exec(l)))return $FloatClass(parseFloat(o[1]));if(null==(o=/^(\+|-)?(0x)?([0-9A-F]+\.?)?(\.[0-9A-F]+)?(p(\+|-)?\d+)?$/i.exec(l)))throw _b_.ValueError.$factory("invalid hexadecimal floating-point string");var x=o[1],B=parseInt(o[3]||"0",16),D=o[4]||".0",G=o[5]||"p0";x="-"==x?-1:1;for(var M=B,P=1,de=D.length;P<de;P++)M+=parseInt(D.charAt(P),16)/Math.pow(16,P);return new Number(x*M*Math.pow(2,parseInt(G.substring(1))))},float.__getformat__=function(n){if("double"==n||"float"==n)return"IEEE, little-endian";throw _b_.ValueError.$factory("__getformat__() argument 1 must be 'double' or 'float'")},float.__format__=function(n,o){n=float_value(n);var l=new $B.parse_format_spec(o);l.align=l.align||">";var x=preformat(n,l).split("."),B=x[0];if(l.comma){for(var D=B.length,G=Math.ceil(B.length/3),M=[],P=0;P<G;P++)M.push(B.substring(D-3*P-3,D-3*P));M.reverse(),x[0]=M.join(",")}return $B.format_width(x.join("."),l)},float.__hash__=function(n){if(void 0===n)return float.__hashvalue__||$B.$py_next_hash--;var o=n.valueOf();if(o===1/0)return 314159;if(o===-1/0)return-271828;if(isNaN(o))return 0;if(o==Math.round(o))return Math.round(o);var l=_b_.$frexp(o);l[0]*=Math.pow(2,31);var x=_b_.int.$factory(l[0]);return l[0]=(l[0]-x)*Math.pow(2,31),4294967295&x+_b_.int.$factory(l[0])+(l[1]<<15)},_b_.$isninf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==-1/0||o==Number.NEGATIVE_INFINITY},_b_.$isinf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==1/0||o==-1/0||o==Number.POSITIVE_INFINITY||o==Number.NEGATIVE_INFINITY},_b_.$fabs=function(n){return float.$factory(n>0?n:-n)},_b_.$frexp=function(n){var o=n;if(isinstance(n,float)&&(o=n.valueOf()),isNaN(o)||_b_.$isinf(o))return[o,-1];if(0==o)return[0,0];var l=1,x=0,B=o;for(B<0&&(l=-l,B=-B);B<.5;)B*=2,x--;for(;B>=1;)B*=.5,x++;return[B*=l,x]},_b_.$ldexp=function(n,o){if(_b_.$isninf(n))return float.$factory("-inf");if(_b_.$isinf(n))return float.$factory("inf");var l=n;if(isinstance(n,float)&&(l=n.valueOf()),0==l)return l;var x=o;return isinstance(o,float)&&(x=o.valueOf()),l*Math.pow(2,x)},float.hex=function(n){switch((n=float_value(n)).valueOf()){case 1/0:case-1/0:case Number.NaN:case-Number.NaN:return n;case-0:return"-0x0.0p0";case 0:return"0x0.0p0"}var o=_b_.$frexp(_b_.$fabs(n.valueOf())),l=o[0],x=o[1],B=1-Math.max(-1021-x,0);l=_b_.$ldexp(l,B),x-=B;var D="0123456789ABCDEF".split(""),G=D[Math.floor(l)];G+=".",l-=Math.floor(l);for(var M=0;M<13;M++)l*=16,G+=D[Math.floor(l)],l-=Math.floor(l);var P="+";return x<0&&(P="-",x=-x),n.value<0?"-0x"+G+"p"+P+x:"0x"+G+"p"+P+x},float.__init__=function(n,o){return _b_.None},float.__int__=function(n){return parseInt(n)},float.is_integer=function(n){return _b_.int.$factory(n)==n},float.__mod__=function(n,o){if(n=float_value(n),0==(o=float_value(o)))throw ZeroDivisionError.$factory("float modulo");if(isinstance(o,_b_.int))return new Number((n%o+o)%o);if(isinstance(o,float)){var l=Math.floor(n/o);return new Number(n-o*l)}if(isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),new Number((n%x+x)%x)}if(hasattr(o,"__rmod__"))return getattr(o,"__rmod__")(n);$err("%",o)},float.__mro__=[object],float.__mul__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return new Number(o.__class__==$B.long_int?n*parseFloat(o.value):n*o);if(isinstance(o,float))return new Number(n*float_value(o));if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),new Number(n*l)}return isinstance(o,_b_.complex)?$B.make_complex(float.$factory(n*o.$real),float.$factory(n*o.$imag)):hasattr(o,"__rmul__")?getattr(o,"__rmul__")(n):void $err("*",o)},float.__ne__=function(n,o){var l=float.__eq__(n,o);return l===_b_.NotImplemented?l:!l},float.__neg__=function(n,o){return float.$factory(-float_value(n))},float.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("float.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("float.__new__(X): X is not a type object");return n===float?float.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},float.__pos__=function(n){return float_value(n)},float.__pow__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int)||isinstance(o,float)){if(1==n)return n;if(0==o)return new Number(1);if(!(-1!=n||isFinite(o)&&o.__class__!==$B.long_int&&$B.is_safe_int(o)||isNaN(o)))return new Number(1);if(0==n&&isFinite(o)&&o<0)throw _b_.ZeroDivisionError.$factory("0.0 cannot be raised to a negative power");return n!=Number.NEGATIVE_INFINITY||isNaN(o)?n!=Number.POSITIVE_INFINITY||isNaN(o)?o!=Number.NEGATIVE_INFINITY||isNaN(n)?o!=Number.POSITIVE_INFINITY||isNaN(n)?n<0&&!_b_.getattr(o,"__eq__")(_b_.int.$factory(o))?_b_.complex.__pow__($B.make_complex(n,0),o):float.$factory(Math.pow(n,o)):Math.abs(n)<1?new Number(0):Number.POSITIVE_INFINITY:Math.abs(n)<1?Number.POSITIVE_INFINITY:new Number(0):o>0?n:new Number(0):o<0&&o%2==1?new Number(-0):o<0?new Number(0):o>0&&o%2==1?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}if(isinstance(o,_b_.complex)){var l=Math.pow(n,o.$real),x=Math.log(n);return $B.make_complex(l*Math.cos(x),l*Math.sin(x))}if(hasattr(o,"__rpow__"))return getattr(o,"__rpow__")(n);$err("** or pow()",o)},float.__repr__=float.__str__=function(n){if((n=float_value(n)).valueOf()==1/0)return"inf";if(n.valueOf()==-1/0)return"-inf";if(isNaN(n.valueOf()))return"nan";var o,l,x=n.valueOf()+"";if(-1==x.indexOf(".")&&(x+=".0"),[o,l]=x.split("."),o.length>16){for(var B=o.length-1,D=o[0],G=o.substr(1)+l;G.endsWith("0");)G=G.substr(0,G.length-1);var M=D;return G.length>0&&(M+="."+G),M+"e+"+B}if("0"==o){for(B=0;B<l.length&&"0"==l.charAt(B);)B++;if(B>3){var P=l.substr(B);for(B=(B+1).toString();P.endsWith("0");)P=P.substr(0,x.length-1);return M=P[0],P.length>1&&(M+="."+P.substr(1)),1==B.length&&(B="0"+B),M+"e-"+B}}return _b_.str.$factory(x)},float.__setattr__=function(n,o,l){if(n.constructor===Number)throw void 0===float[o]?_b_.AttributeError.$factory("'float' object has no attribute '"+o+"'"):_b_.AttributeError.$factory("'float' object attribute '"+o+"' is read-only");return n[o]=l,_b_.None},float.__truediv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(n/o)}if(isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw ZeroDivisionError.$factory("division by zero");return $B.make_complex(float.$factory(n*o.$real/l),float.$factory(-n*o.$imag/l))}if(hasattr(o,"__rtruediv__"))return getattr(o,"__rtruediv__")(n);$err("/",o)};var $op_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return"boolean"==typeof o?o?n-1:n:float.$factory(o.__class__===$B.long_int?n-parseInt(o.value):n-o);if(isinstance(o,float))return float.$factory(n-o);if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),float.$factory(n-l)}return isinstance(o,_b_.complex)?$B.make_complex(n-o.$real,-o.$imag):hasattr(o,"__rsub__")?getattr(o,"__rsub__")(n):void $err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var $opf=$op_func.replace(/-/gm,$op);$opf=$opf.replace(/__rsub__/gm,"__r"+$ops[$op]+"__"),eval("float.__"+$ops[$op]+"__ = "+$opf)}var $comp_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return o.__class__===$B.long_int?n>parseInt(o.value):n>o.valueOf();if(isinstance(o,float))return n>o;if(isinstance(o,_b_.bool))return n.valueOf()>_b_.bool.__hash__(o);if(hasattr(o,"__int__")||hasattr(o,"__index__"))return _b_.int.__gt__(n,$B.$GetInt(o));var l=getattr(o,"__le__",None);if(l!==None)return l(n);throw _b_.TypeError.$factory("unorderable types: float() > "+$B.class_name(o)+"()")};for(var $op in $comp_func+="",$B.$comps)eval("float.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__le__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(float);var $notimplemented=function(n,o){throw _b_.TypeError.$factory("unsupported operand types for OPERATOR: 'float' and '"+$B.class_name(o)+"'")};for(var $op in $notimplemented+="",$B.$operators)if(void 0===$B.augmented_assigns[$op]){var $opfunc="__"+$B.$operators[$op]+"__";void 0===float[$opfunc]&&eval("float."+$opfunc+"="+$notimplemented.replace(/OPERATOR/gm,$op))}function $FloatClass(n){return new Number(n)}function to_digits(n){for(var o="",l=0;l<n.length;l++){var x="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".indexOf(n[l]);o+=x>-1?x:n[l]}return o}float.$factory=function(value){switch(value){case void 0:return $FloatClass(0);case Number.MAX_VALUE:return $FloatClass(1/0);case-Number.MAX_VALUE:return $FloatClass(-1/0);case!0:return new Number(1);case!1:return new Number(0)}if("number"==typeof value)return new Number(value);if(isinstance(value,float))return float_value(value);if(isinstance(value,bytes)){var s=getattr(value,"decode")("latin-1");return float.$factory(getattr(value,"decode")("latin-1"))}if("string"==typeof value)switch(value=value.trim(),value.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return Number.POSITIVE_INFINITY;case"-inf":case"-infinity":return Number.NEGATIVE_INFINITY;case"+nan":case"nan":return Number.NaN;case"-nan":return-Number.NaN;case"":throw _b_.ValueError.$factory("count not convert string to float");default:if(value=value.charAt(0)+value.substr(1).replace(/_/g,""),value=to_digits(value),isFinite(value))return $FloatClass(eval(value));throw _b_.str.encode(value,"latin-1"),_b_.ValueError.$factory("Could not convert to float(): '"+_b_.str.$factory(value)+"'")}var klass=value.__class__||$B.get_class(value),num_value=$B.to_num(value,["__float__","__index__"]);if(null!==num_value)return num_value;throw _b_.TypeError.$factory("float() argument must be a string or a number, not '"+$B.class_name(value)+"'")},$B.$FloatClass=$FloatClass,$B.set_func_names(float,"builtins");var FloatSubclass=$B.FloatSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"float"},$is_class:!0};for(var $attr in float)"function"==typeof float[$attr]&&(FloatSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,B=arguments.length;x<B;x++)o[l++]=arguments[x]}return float[n].apply(null,o)}}($attr));$B.set_func_names(FloatSubclass,"builtins"),_b_.float=float}(__BRYTHON__),function($B){var _b_=$B.builtins;function $err(n,o){var l="unsupported operand type(s) for "+n+" : 'int' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function int_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var int={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="bcdoxXn".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'int'");var l;switch(o.type){case void 0:case"d":l=n.toString();break;case"b":l=(o.alternate?"0b":"")+n.toString(2);break;case"c":l=_b_.chr(n);break;case"o":l=(o.alternate?"0o":"")+n.toString(8);break;case"x":l=(o.alternate?"0x":"")+n.toString(16);break;case"X":l=(o.alternate?"0X":"")+n.toString(16).toUpperCase();break;case"n":return n}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>=0&&(l=o.sign+l),l}function extended_euclidean(n,o){var l,x,B;return 0==o?[n,1,0]:([l,x,B]=extended_euclidean(o,n%o),[l,B,x-Math.floor(n/o)*B])}int.as_integer_ratio=function(){var n=$B.args("as_integer_ratio",1,{self:null},["self"],arguments,{},null,null);return $B.$list([n.self,1])},int.from_bytes=function(){var n,o,l=$B.args("from_bytes",3,{bytes:null,byteorder:null,signed:null},["bytes","byteorder","signed"],arguments,{signed:!1},null,null),x=l.bytes,B=l.byteorder,D=l.signed;if(_b_.isinstance(x,[_b_.bytes,_b_.bytearray]))n=x.source,o=x.source.length;else{o=(n=_b_.list.$factory(x)).length;for(var G=0;G<o;G++)_b_.bytes.$factory([n[G]])}switch(B){case"big":var M=n[o-1],P=256;for(G=o-2;G>=0;G--)M=$B.add($B.mul(P,n[G]),M),P=$B.mul(P,256);return D?n[0]<128?M:$B.sub(M,P):M;case"little":for((M=n[0])>=128&&(M-=256),P=256,G=1;G<o;G++)M=$B.add($B.mul(P,n[G]),M),P=$B.mul(P,256);return D?n[o-1]<128?M:$B.sub(M,P):M}throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'")},int.to_bytes=function(){var n=$B.args("to_bytes",3,{self:null,len:null,byteorder:null},["self","len","byteorder"],arguments,{},"args","kw"),o=n.self,l=n.len,x=n.byteorder,B=n.kw;if(!_b_.isinstance(l,_b_.int))throw _b_.TypeError.$factory("integer argument expected, got "+$B.class_name(l));if(-1==["little","big"].indexOf(x))throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'");var G=[];if(o<0){if(!B.$string_dict.signed)throw _b_.OverflowError.$factory("can't convert negative int to unsigned");o=Math.pow(256,l)+o}for(var M=o;;){var P=Math.floor(M/256);if(G.push(M-256*P),0==P)break;M=P}if(G.length>l)throw _b_.OverflowError.$factory("int too big to convert");for(;G.length<l;)G=G.concat([0]);return"big"==x&&(G=G.reverse()),{__class__:_b_.bytes,source:G}},int.__abs__=function(n){return _b_.abs(n)},int.__bool__=function(n){return 0!=int_value(n).valueOf()},int.__ceil__=function(n){return Math.ceil(int_value(n))},int.__divmod__=function(n,o){return $B.fast_tuple([int.__floordiv__(n,o),int.__mod__(n,o)])},int.__eq__=function(n,o){return void 0===o?n===int:_b_.isinstance(o,int)?n.valueOf()==int_value(o).valueOf():_b_.isinstance(o,_b_.float)?n.valueOf()==o.valueOf():_b_.isinstance(o,_b_.complex)?0!=o.$imag?False:n.valueOf()==o.$real:_b_.NotImplemented},int.__float__=function(n){return new Number(n)},int.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(l.type&&-1!="eEfFgG%".indexOf(l.type))return _b_.float.__format__(n,o);l.align=l.align||">";var x=preformat(n,l);if(l.comma){for(var B="-"==x[0]?"-":"",D=x.substr(B.length),G=D.length,M=Math.ceil(D.length/3),P=[],de=0;de<M;de++)P.push(D.substring(G-3*de-3,G-3*de));P.reverse(),x=B+P.join(",")}return $B.format_width(x,l)},int.__floordiv__=function(n,o){if(o.__class__===$B.long_int)return $B.long_int.__floordiv__($B.long_int.$factory(n),o);if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.hasattr(o,"__rfloordiv__"))return $B.$getattr(o,"__rfloordiv__")(n);$err("//",o)},int.__hash__=function(n){return void 0===n?int.__hashvalue__||$B.$py_next_hash--:n.valueOf()},int.__index__=function(n){return int_value(n)},int.__init__=function(n,o){return void 0===o&&(o=0),n.toString=function(){return o},_b_.None},int.__int__=function(n){return n},int.__invert__=function(n){return~n},int.__lshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__lshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rlshift__",_b_.None);if(l!==_b_.None)return l(n);$err("<<",o)},int.__mod__=function(n,o){if(_b_.isinstance(o,_b_.tuple)&&1==o.length&&(o=o[0]),o.__class__===$B.long_int)return $B.long_int.__mod__($B.long_int.$factory(n),o);if(_b_.isinstance(o,[int,_b_.float,bool])){if(!1===(o=int_value(o))?o=0:!0===o&&(o=1),0==o)throw _b_.ZeroDivisionError.$factory("integer division or modulo by zero");return(n%o+o)%o}if(_b_.hasattr(o,"__rmod__"))return $B.$getattr(o,"__rmod__")(n);$err("%",o)},int.__mro__=[_b_.object],int.__mul__=function(n,o){var l=n.valueOf();if("string"==typeof o)return o.repeat(l);if(_b_.isinstance(o,int))return(x=n*(o=int_value(o)))>$B.min_int&&x<$B.max_int?x:int.$factory($B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o)));if(_b_.isinstance(o,_b_.float))return new Number(n*o);if(_b_.isinstance(o,_b_.bool))return o.valueOf()?n:int.$factory(0);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(int.__mul__(n,o.$real),int.__mul__(n,o.$imag));if(_b_.isinstance(o,[_b_.list,_b_.tuple])){for(var x=[],B=o.slice(0,o.length),D=0;D<l;D++)x=x.concat(B);return _b_.isinstance(o,_b_.tuple)&&(x=_b_.tuple.$factory(x)),x}if(_b_.hasattr(o,"__rmul__"))return $B.$getattr(o,"__rmul__")(n);$err("*",o)},int.__ne__=function(n,o){var l=int.__eq__(n,o);return l===_b_.NotImplemented?l:!l},int.__neg__=function(n){return-n},int.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("int.__new__(X): X is not a type object");return n===int?int.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},int.__pos__=function(n){return n},$B.use_bigint=0,int.__pow__=function(n,o,l){if("number"==typeof o||_b_.isinstance(o,int)){switch((o=int_value(o)).valueOf()){case 0:return int.$factory(1);case 1:return int.$factory(n.valueOf())}if(void 0!==l&&l!==_b_.None){if(1==l)return 0;var x=1,B=n%l,D=o,G=$B.long_int;if(D<0){var M,P,de;if([M,P,de]=extended_euclidean(n,l),1!==M)throw _b_.ValueError.$factory("not relative primes: "+n+" and "+l);return int.__pow__(P,-D,l)}for(;D>0;)D%2==1&&(x*B>$B.max_int?(x=G.__mul__(G.$factory(x),G.$factory(B)),x=G.__mod__(x,l)):x=x*B%l),D>>=1,B*B>$B.max_int?(B=G.__mul__(G.$factory(B),G.$factory(B)),B=G.__mod__(B,l)):B=B*B%l;return x}var ye=Math.pow(n.valueOf(),o.valueOf());return ye>$B.min_int&&ye<$B.max_int?ye:ye===1/0||isFinite(ye)?$B.BigInt?($B.use_bigint++,{__class__:$B.long_int,value:($B.BigInt(n)**$B.BigInt(o)).toString(),pos:!0}):$B.long_int.__pow__($B.long_int.$from_int(n),$B.long_int.$from_int(o)):ye}if(_b_.isinstance(o,_b_.float))return n>=0?new Number(Math.pow(n,o.valueOf())):_b_.complex.__pow__($B.make_complex(n,0),o);if(_b_.isinstance(o,_b_.complex)){var ie=Math.pow(n,o.$real),ce=Math.log(n);return $B.make_complex(ie*Math.cos(ce),ie*Math.sin(ce))}var fe=$B.$getattr(o,"__rpow__",_b_.None);if(fe!==_b_.None)return fe(n);$err("**",o)},int.__repr__=function(n){return n===int?"<class 'int'>":n.toString()},int.__rshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__rshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rrshift__",_b_.None);if(l!==_b_.None)return l(n);$err(">>",o)},int.__setattr__=function(n,o,l){if("number"==typeof n)throw _b_.AttributeError.$factory(void 0===int.$factory[o]?"'int' object has no attribute '"+o+"'":"'int' object attribute '"+o+"' is read-only");return _b_.dict.$setitem(n.__dict__,o,l),_b_.None},int.__str__=int.__repr__,int.__truediv__=function(n,o){if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(o.__class__===$B.long_int?n/parseInt(o.value):n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(n/o)}if(_b_.isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw _b_.ZeroDivisionError.$factory("division by zero");return $B.make_complex(n*o.$real/l,-n*o.$imag/l)}if(_b_.hasattr(o,"__rtruediv__"))return $B.$getattr(o,"__rtruediv__")(n);$err("/",o)},int.bit_length=function(n){return s=_b_.bin(n),s=$B.$getattr(s,"lstrip")("-0b"),s.length},int.numerator=function(n){return n},int.denominator=function(n){return int.$factory(1)},int.imag=function(n){return int.$factory(0)},int.real=function(n){return n},$B.max_int32=2147483647,$B.min_int32=-$B.max_int32;var $op_func=function(n,o){if(_b_.isinstance(o,int))return o.__class__===$B.long_int?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):(o=int_value(o),n>$B.max_int32||n<$B.min_int32||o>$B.max_int32||o<$B.min_int32?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):n-o);if(_b_.isinstance(o,_b_.bool))return n-o;var l=$B.$getattr(o,"__rsub__",_b_.None);if(l!==_b_.None)return l(n);$err("-",o)};$op_func+="";var $ops={"&":"and","|":"or","^":"xor"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $op_func=function(n,o){if(_b_.isinstance(o,int)){if("number"==typeof(o=int_value(o))){var l=n.valueOf()-o.valueOf();return l>$B.min_int&&l<$B.max_int?l:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}return"boolean"==typeof o?o?n-1:n:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}if(_b_.isinstance(o,_b_.float))return new Number(n-o);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n-o.$real,-o.$imag);if(_b_.isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),n-x}if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n.valueOf()-o.$real,o.$imag);var B=$B.$getattr(o,"__rsub__",_b_.None);if(B!==_b_.None)return B(n);throw console.log("err",n,o),console.log($B.frames_stack.slice()),$err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $comp_func=function(n,o){return o.__class__===$B.long_int?$B.long_int.__lt__(o,$B.long_int.$factory(n)):_b_.isinstance(o,int)?(o=int_value(o),n.valueOf()>o.valueOf()):_b_.isinstance(o,_b_.float)?n.valueOf()>o.valueOf():_b_.isinstance(o,_b_.bool)?n.valueOf()>_b_.bool.__hash__(o):_b_.hasattr(o,"__int__")||_b_.hasattr(o,"__index__")?int.__gt__(n,$B.$GetInt(o)):_b_.NotImplemented};for(var $op in $comp_func+="",$B.$comps)eval("int.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__lt__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(int);var $valid_digits=function(n){var o="";if(0===n)return"0";if(n<10){for(var l=0;l<n;l++)o+=String.fromCharCode(l+48);return o}for(o="0123456789",l=10;l<n;l++)o+=String.fromCharCode(l+55);return o};int.$factory=function(n,o){if(void 0===n)return 0;if("number"==typeof n&&(void 0===o||10==o))return parseInt(n);if(_b_.isinstance(n,_b_.complex))throw _b_.TypeError.$factory("can't convert complex to int");var l=$B.args("int",2,{x:null,base:null},["x","base"],arguments,{base:10},null,null);if(o=l.base,_b_.isinstance(n=l.x,_b_.float)&&10==o)return(n=_b_.float.numerator(n))<$B.min_int||n>$B.max_int?$B.long_int.$from_float(n):n>0?Math.floor(n):Math.ceil(n);if(!(o>=2&&o<=36)&&0!=o)throw _b_.ValueError.$factory("invalid base");if("number"==typeof n){if(10==o)return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n):n;if(n.toString().search("e")>-1)throw _b_.OverflowError.$factory("can't convert to base "+o);var x=parseInt(n,o);return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n,o):x}if(!0===n)return Number(1);if(!1===n)return Number(0);if(n.__class__===$B.long_int){var B=parseInt(n.value);return B>$B.min_int&&B<$B.max_int?B:n}function D(ye,ie){throw _b_.ValueError.$factory("invalid literal for int() with base "+ie+": '"+_b_.str.$factory(ye)+"'")}if(o=$B.$GetInt(o),_b_.isinstance(n,_b_.str)&&(n=n.valueOf()),"string"==typeof n){var G=n.trim();if(2==G.length&&0==o&&("0b"==G||"0o"==G||"0x"==G))throw _b_.ValueError.$factory("invalid value");if(G.length>2){var M=G.substr(0,2).toUpperCase();if(0==o?("0B"==M&&(o=2),"0O"==M&&(o=8),"0X"==M&&(o=16)):("0X"==M&&16!=o||"0O"==M&&8!=o)&&D(G,o),"0B"==M&&2==o||"0O"==M||"0X"==M)for(G=G.substr(2);G.startsWith("_");)G=G.substr(1)}else 0==o&&(o=10);var P=$valid_digits(o);return null===new RegExp("^[+-]?["+P+"]["+P+"_]*$","i").exec(G)?D(n,o):n=G.replace(/_/g,""),o<=10&&!isFinite(n)&&D(G,o),(x=parseInt(n,o))<$B.min_int||x>$B.max_int?$B.long_int.$factory(n,o):x}if(_b_.isinstance(n,[_b_.bytes,_b_.bytearray]))return int.$factory($B.$getattr(n,"decode")("latin-1"),o);var de=$B.to_num(n,["__int__","__index__","__trunc__"]);if(null===de)throw _b_.TypeError.$factory("int() argument must be a string, a bytes-like object or a number, not '"+$B.class_name(n)+"'");return de},$B.set_func_names(int,"builtins"),_b_.int=int,$B.$bool=function(n){if(null==n)return!1;switch(typeof n){case"boolean":return n;case"number":case"string":return!!n;default:if(n.$is_class)return!0;var o=n.__class__||$B.get_class(n),l={},x=$B.$getattr(o,"__bool__",l);if(x!==l){var B=$B.$call(x)(n);if(!0!==B&&!1!==B)throw _b_.TypeError.$factory("__bool__ should return bool, returned "+$B.class_name(B));return B}try{return _b_.len(n)>0}catch{return!0}}};var bool={__bases__:[int],__class__:_b_.type,__mro__:[int,_b_.object],$infos:{__name__:"bool",__module__:"builtins"},$is_class:!0,$native:!0},methods=$B.op2method.subset("operations","binary","comparisons","boolean");for(var op in methods){var method="__"+methods[op]+"__";bool[method]=function(n){return function(o,l){if(void 0!==int[n])return int[n](o?1:0,l)}}(method)}bool.__and__=function(n,o){return _b_.isinstance(o,bool)?n&&o:_b_.isinstance(o,int)?int.__and__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__hash__=bool.__index__=bool.__int__=function(n){return n.valueOf()?1:0},bool.__neg__=function(n){return-$B.int_or_bool(n)},bool.__or__=function(n,o){return _b_.isinstance(o,bool)?n||o:_b_.isinstance(o,int)?int.__or__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__pos__=$B.int_or_bool,bool.__repr__=bool.__str__=function(n){return n?"True":"False"},bool.__setattr__=function(n,o){if(_b_.dir(n).indexOf(o)>-1)var l="attribute '"+o+"' of 'int' objects is not writable";else l="'bool' object has no attribute '"+o+"'";throw _b_.AttributeError.$factory(l)},bool.__xor__=function(n,o){return _b_.isinstance(o,bool)?!!(n^o):_b_.isinstance(o,int)?int.__xor__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.$factory=function(){var n=$B.args("bool",1,{x:null},["x"],arguments,{x:!1},null,null);return $B.$bool(n.x)},_b_.bool=bool,$B.set_func_names(bool,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);try{eval("window")}catch(n){window=self}var long_int={__class__:_b_.type,__mro__:[int,object],$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function add_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)+BigInt(o)).toString(),pos:!0};for(var l,x="",B=0,D=n.length,G=o.length-1;G>=0;G--)2==(l=(B+(--D<0?0:parseInt(n.charAt(D)))+parseInt(o.charAt(G))).toString()).length?(x=l.charAt(1)+x,B=parseInt(l.charAt(0))):(x=l+x,B=0);for(;D>0;)D--,2==(l=(B+parseInt(n.charAt(D))).toString()).length?(x=l.charAt(1)+x,B=parseInt(l.charAt(0))):(x=l+x,B=0);return B&&(x=B+x),{__class__:long_int,value:x,pos:!0}}var len=(Math.pow(2,53)-1+"").length-1;function binary_pos(n){for(var o,l,x,B,D=Math.ceil(n.length/len),G=[],M=[],P=0;P<D;P++)x=(o=n.length-(P+1)*len)-(l=Math.max(0,o)),G.push(n.substr(l,len+x));(G=G.reverse()).forEach(function(ye,ie){G[ie]=parseInt(ye)});for(var de=Math.pow(10,15);G[G.length-1]>0;)G.forEach(function(ye,ie){B=ye%2,G[ie]=Math.floor(ye/2),B&&ie<G.length-1&&(G[ie+1]+=de)}),M.push(B),0==G[0]&&G.shift();return M.reverse().join("")}function binary(n){var o=binary_pos(n.value);if(n.pos)return o;for(var l="",x=0,B=o.length;x<B;x++)l+="0"==o.charAt(x)?"1":"0";var D=add_pos(l,"1").value;return l.substr(0,l.length-D.length)+D}function check_shift(n){if(!isinstance(n,long_int))throw TypeError.$factory("shift must be int, not '"+$B.class_name(n)+"'");if(!n.pos)throw ValueError.$factory("negative shift count")}function clone(n){var o={};for(var l in n)o[l]=n[l];return o}function comp_pos(n,o){return n.length>o.length?1:n.length<o.length?-1:n>o?1:n<o?-1:0}function divmod_by_safe_int(n,o){if(1==o)return[n,0];for(var l,x,B,D=(Math.floor((Math.pow(2,53)-1)/o)+"").length-1,G=Math.ceil(n.length/D),M=[],P=0;P<G;P++)B=(l=n.length-(P+1)*D)-(x=Math.max(0,l)),M.push(n.substr(x,D+B));(M=M.reverse()).forEach(function(ce,fe){M[fe]=parseInt(ce)});var de,ye,ie=Math.pow(10,D);for(M.forEach(function(ce,fe){de=ce%o,M[fe]=Math.floor(ce/o),fe<M.length-1&&(M[fe+1]+=ie*de)});0==M[0];)if(M.shift(),0==M.length)return[0,de];return ye=M[0]+"",M.forEach(function(ce,fe){fe>0&&(ye+="0".repeat(D-ce.toString().length)+ce)}),[ye,de]}function divmod_pos(n,o){if(window.BigInt)return[{__class__:long_int,value:(BigInt(n)/BigInt(o)).toString(),pos:!0},{__class__:long_int,value:(BigInt(n)%BigInt(o)).toString(),pos:!0}];var l,x=parseInt(n),B=parseInt(o);if(x<$B.max_int&&B<$B.max_int){var D=x%B,G=Math.floor(x/B).toString();return[{__class__:long_int,value:G.toString(),pos:!0},{__class__:long_int,value:D.toString(),pos:!0}]}if(B<$B.max_int){var M=divmod_by_safe_int(n,B);return[long_int.$factory(M[0]),long_int.$factory(M[1])]}if(-1==comp_pos(n,o))P="0",l=long_int.$factory(n);else if(o==n)P="1",l=long_int.$factory("0");else{var P="",de=n.substr(0,o.length);n<o&&(de=n.substr(0,o.length+1));for(var ye=n.substr(de.length),ie={};;){var ce=Math.floor(parseInt(de)/parseInt(o))+"";if("10"==ce&&(ce="9"),void 0===ie[ce]&&(ie[ce]=mul_pos(o,ce).value),-1==comp_pos(de,ie[ce])&&void 0===ie[--ce]&&(ie[ce]=mul_pos(o,ce).value),P+=ce,de=sub_pos(de,ie[ce]).value,0==ye.length)break;de+=ye.charAt(0),ye=ye.substr(1)}l=sub_pos(n,mul_pos(P,o).value)}return[long_int.$factory(P),l]}function split_chunks(n,o){for(var l=Math.ceil(n.length/o),x=[],B=n.length,D=0;D<l;D++){var G=B-o*(D+1);G<0&&(o+=G,G=0),x.push(parseInt(n.substr(G,o)))}return x}function mul_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)*BigInt(o)).toString(),pos:!0};var l,x=parseInt(n)*parseInt(o);if(x<$B.max_int)return{__class__:long_int,value:x.toString(),pos:!0};for(var B=split_chunks(n,6),D=split_chunks(o,6),G={},M=B.length+D.length,P=0;P<M-1;P++)G[P]=0;for(P=0;P<B.length;P++)for(var de=0;de<D.length;de++)G[P+de]+=B[P]*D[de];for(P=0;P<M-1;P++){var ye=split_chunks(G[P].toString(),6);for(de=1;de<ye.length;de++)void 0===G[l=P+de]?G[l]=parseInt(ye[de]):G[l]+=parseInt(ye[de]);G[P]=ye[0]}var ie,ce="";for(P=0;void 0!==G[P];)ie=G[P].toString(),void 0!==G[P+1]&&(ie="0".repeat(6-ie.length)+ie),ce=ie+ce,P++;try{return long_int.$factory(ce)}catch(fe){throw console.log(n,o,G,ce),fe}}function sub_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)-BigInt(o)).toString(),pos:!0};for(var l,x="",B=0,D=n.length,G=0,M=o.length-1;M>=0;M--)D--,l=(G=parseInt(n.charAt(D)))-B-parseInt(o.charAt(M)),isNaN(l)&&console.log("x is NaN",n.length,o.length,M,D,G,B,M,o.charAt(M)),l<0?(x=10+l+x,B=1):(x=l+x,B=0);for(x.startsWith("NaN")&&alert(x);D>0;)D--,(l=parseInt(n.charAt(D))-B)<0?(x=10+l+x,B=1):(x=l+x,B=0);for(;"0"==x.charAt(0)&&x.length>1;)x=x.substr(1);return x.startsWith("NaN")&&console.log("hoho !!",n,o,n>=o,x),{__class__:long_int,value:x,pos:!0}}function to_BigInt(n){var o=$B.BigInt(n.value);return n.pos?o:-o}function from_BigInt(n){var o=n>=0;return n=(n=(n=n.toString()).endsWith("n")?n.substr(0,n.length-1):n).startsWith("-")?n.substr(1):n,intOrLong({__class__:long_int,value:n,pos:o})}function digits(n){for(var o={},l=0;l<n&&10!=l;l++)o[l]=!0;if(n>10)for(l=0;l<n-10;l++)o[String.fromCharCode(65+l)]=!0,o[String.fromCharCode(97+l)]=!0;return o}long_int.$from_float=function(n){var o=Math.abs(n).toString(),l=o;if(o.search("e")>-1){var x=/-?(\d)(\.\d+)?e([+-])(\d*)/.exec(o),B=x[1],D=x[2],M=x[4];"+"==x[3]&&(l=void 0===D?B+"0".repeat(M-1):B+D+"0".repeat(M-1-D.length))}return{__class__:long_int,value:l,pos:n>=0}},long_int.__abs__=function(n){return{__class__:long_int,value:n.value,pos:!0}},long_int.__add__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)+o.value);if("number"==typeof o)o=long_int.$factory(_b_.str.$factory(o));else if(o.__class__!==long_int)if(isinstance(o,_b_.bool))o=long_int.$factory(o?1:0);else{if(!isinstance(o,int))return _b_.NotImplemented;o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)))}var l;if(n.pos&&o.pos)return add_pos(n.value,o.value);if(n.pos||o.pos){if(n.pos&&!o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)}return(l=add_pos(n.value,o.value)).pos=!1,intOrLong(l)},long_int.__and__=function(n,o){if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),$B.BigInt)return from_BigInt(to_BigInt(n)&to_BigInt(o));var l="",x=!n.pos&&!o.pos;x&&(n=long_int.__neg__(n),o=long_int.__neg__(o));var B,D,G=binary(n),M=G.length,P=binary(o),de=P.length,ye=1;for(l="";!(ye>M&&ye>de);)B=ye>M?n.pos?"0":"1":G.charAt(M-ye),D=ye>de?o.pos?"0":"1":P.charAt(de-ye),l="1"==B&&"1"==D?"1"+l:"0"+l,ye++;for(;"0"==l.charAt(0);)l=l.substr(1);return l=$B.long_int.$factory(l,2),x&&(l.pos=!1),intOrLong(l)},long_int.__divmod__=function(n,o){"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o)));var l=divmod_pos(n.value,o.value);return n.pos!==o.pos&&("0"!=l[0].value&&(l[0].pos=!1),"0"!=l[1].value&&(l[0]=long_int.__sub__(l[0],long_int.$factory("1")),l[1]=long_int.__sub__(n,long_int.__mul__(o,long_int.$factory(l[0]))))),$B.fast_tuple([intOrLong(l[0]),intOrLong(l[1])])},long_int.__eq__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.value==o.value&&n.pos==o.pos},long_int.__float__=function(n){return new Number(parseFloat(n.value))},long_int.__floordiv__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);if("number"==typeof o){var l=divmod_by_safe_int(n.value,o);return{__class__:long_int,value:l[0],pos:o>0?n.pos:!n.pos}}return intOrLong(long_int.__divmod__(n,o)[0])},long_int.__ge__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!=o.pos?!o.pos:n.value.length>o.value.length?n.pos:n.value.length<o.value.length?!n.pos:n.pos?n.value>=o.value:n.value<=o.value},long_int.__gt__=function(n,o){return!long_int.__le__(n,o)},long_int.__index__=function(n){for(var o,l="",x=n.value;l=(o=divmod_pos(x,"2"))[1].value+l,"0"!=(x=o[0].value););if(n.pos)l="0"+l;else{for(var B="",D=!1,G=l.length-1;G>=0;G--)"0"==l.charAt(G)?B=D?"1"+B:"0"+B:D?B="0"+B:(D=!0,B="1"+B);l=B="1"+B}return intOrLong(l)},long_int.__invert__=function(n){return long_int.__sub__(long_int.$factory("-1"),n)},long_int.__le__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!==o.pos||n.value.length>o.value.length?!n.pos:n.value.length<o.value.length?n.pos:n.pos?n.value<=o.value:n.value>=o.value},long_int.__lt__=function(n,o){return!long_int.__ge__(n,o)},long_int.__lshift__=function(n,o){if(window.BigInt)return o.__class__==long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)<<BigInt(o)).toString(),pos:n.pos});var l;if(o.__class__===long_int){var x=parseInt(o.value);if(x<0)throw _b_.ValueError.$factory("negative shift count");x<$B.max_int&&(l=!0,o=x)}if(l){if(0==x)return n}else if("0"==(o=long_int.$factory(o)).value)return n;for(var B=n.value;;){for(var D,G=0,M="",P=B.length-1;P>=0;P--)2==(D=(G+2*parseInt(B.charAt(P))).toString()).length?(M=D.charAt(1)+M,G=parseInt(D.charAt(0))):(M=D+M,G=0);if(G&&(M=G+M),B=M,l){if(0==--o)break}else if("0"==(o=sub_pos(o.value,"1")).value)break}return intOrLong({__class__:long_int,value:B,pos:n.pos})},long_int.__mod__=function(n,o){return intOrLong(long_int.__divmod__(n,o)[1])},long_int.__mro__=[_b_.int,_b_.object],long_int.__mul__=function(n,o){switch(n){case Number.NEGATIVE_INFINITY:case Number.POSITIVE_INFINITY:return $B.rich_comp("__eq__",o,0)?NaN:_b_.getattr(o,"__gt__")(0)?n:-n}if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)*o);if("number"==typeof o&&(o=long_int.$factory(o)),other_value=o.value,other_pos=o.pos,o.__class__!==long_int&&isinstance(o,int)){var l=int.__index__(o);other_value=_b_.str.$factory(l),other_pos=l>0}if($B.BigInt)return from_BigInt(to_BigInt(n)*to_BigInt(o));var x=mul_pos(n.value,other_value);return n.pos==other_pos||(x.pos=!1),intOrLong(x)},long_int.__neg__=function(n){return{__class__:long_int,value:n.value,pos:!n.pos}},long_int.__or__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var B=x;x=l,l=B}for(var D=l.length-x.length,G=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)||"1"==x.charAt(M)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.__pos__=function(n){return n},long_int.__pow__=function(n,o,l){if("number"==typeof o)o=long_int.$from_int(o);else if(isinstance(o,int))o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)));else if(!isinstance(o,long_int))throw TypeError.$factory("power must be an integer, not '"+$B.class_name(o)+"'");if(!o.pos)return"1"==n.value?n:long_int.$factory("0");if("0"==o.value)return long_int.$factory("1");if($B.BigInt){var x=$B.BigInt(n.value),B=$B.BigInt(1),D=$B.BigInt(o.value);if(void 0===(l=void 0===l?l:$B.BigInt("number"==typeof l?l:l.value)))return{__class__:long_int,value:(x**D).toString(),pos:!0};for(;D>0;)D%$B.BigInt(2)==1&&(B*=x),(D/=$B.BigInt(2))>0&&(x*=x),void 0!==l&&(B%=l);return{__class__:long_int,value:B.toString(),pos:!0}}B={__class__:long_int,value:"1",pos:!0},x=n;for(var G,M=o.value;"string"==typeof M&&parseInt(M)<$B.max_int&&(M=parseInt(M)),0!=M;)"string"==typeof M?(parseInt(M.charAt(M.length-1))%2==1&&(B=long_int.__mul__(B,x)),M=long_int.__floordiv__(M,2)):(M%2==1&&(B="number"==typeof B&&"number"==typeof x&&(G=B*x)<$B.max_int?G:long_int.__mul__(long_int.$factory(B),long_int.$factory(x))),M=Math.floor(M/2)),M>0&&("number"==typeof x&&(G=x*x)<$B.max_int?x=G:(x=long_int.$factory(x),x=long_int.__mul__(x,x))),void 0!==l&&(B=long_int.__mod__(B,l));return intOrLong(B)},long_int.__rshift__=function(n,o){if(window.BigInt)return o.__class__===long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)>>BigInt(o)).toString(),pos:n.pos});if("number"==typeof o){var l=Math.pow(2,o);if(l<$B.max_int){var x=divmod_by_safe_int(n.value,l);return intOrLong({__class__:long_int,value:x[0],pos:n.pos})}}if("0"==(o=long_int.$factory(o)).value)return n;for(x=n.value;"0"!=(x=divmod_pos(x,"2")[0].value).value&&"0"!=(o=sub_pos(o.value,"1")).value;);return intOrLong({__class__:long_int,value:x,pos:n.pos})},long_int.__str__=long_int.__repr__=function(n){var o="";return n.pos||(o+="-"),o+n.value},long_int.__sub__=function(n,o){if(isinstance(o,_b_.float))return o=o instanceof Number?o:o.$brython_value,_b_.float.$factory(parseInt(n.value)-o);var l;if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos&&o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}if(n.pos||o.pos)return n.pos&&!o.pos?intOrLong(add_pos(n.value,o.value)):((l=add_pos(n.value,o.value)).pos=!1,intOrLong(l));switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)},long_int.__truediv__=function(n,o){if(isinstance(o,long_int))return _b_.float.$factory(parseInt(n.value)/parseInt(o.value));if(isinstance(o,_b_.int)||isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);throw TypeError.$factory("unsupported operand type(s) for /: 'int' and '"+$B.class_name(o)+"'")},long_int.__xor__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var B=x;x=l,l=B}for(var D=l.length-x.length,G=l.substr(0,D),M=0;M<x.length;M++)"1"==l.charAt(D+M)&&"0"==x.charAt(M)||"0"==l.charAt(D+M)&&"1"==x.charAt(M)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.numerator=function(n){return n},long_int.denominator=function(n){return _b_.int.$factory(1)},long_int.imag=function(n){return _b_.int.$factory(0)},long_int.real=function(n){return n},long_int.to_base=function(n,o){if(2==o)return binary_pos(n.value);for(var l="",x=n.value;x>0;){var B=divmod_pos(x,o.toString());if(l=parseInt(B[1].value).toString(o)+l,0==(x=B[0].value))break}return l};var MAX_SAFE_INTEGER=Math.pow(2,53)-1,MIN_SAFE_INTEGER=-MAX_SAFE_INTEGER;function isSafeInteger(n){return"number"==typeof n&&Math.round(n)===n&&MIN_SAFE_INTEGER<=n&&n<=MAX_SAFE_INTEGER}function intOrLong(n){var o=parseInt(n.value)*(n.pos?1:-1);return o>MIN_SAFE_INTEGER&&o<MAX_SAFE_INTEGER?o:n}long_int.$from_int=function(n){return{__class__:long_int,value:n.toString(),pos:n>0}},long_int.$factory=function(n,o){if(arguments.length>2)throw _b_.TypeError.$factory("long_int takes at most 2 arguments ("+arguments.length+" given)");if(void 0===o)o=10;else if(!isinstance(o,int))throw TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer");if(o<0||1==o||o>36)throw ValueError.$factory("long_int.$factory() base must be >= 2 and <= 36");if("number"==typeof n){var l=n>0;if(isSafeInteger(n=Math.abs(n)))P=long_int.$from_int(n);else{if(n.constructor!=Number)throw ValueError.$factory("argument of long_int is not a safe integer");var x=n.toString(),B=x.search("e");if(B>-1){var D=x.substr(0,B),G=parseInt(x.substr(B+1));if((ce=D.search(/\./))>-1){var M=D.substr(ce+1).length;if(M>G){var P=D.substr(0,ce)+D.substr(ce+1).substr(0,G);P=long_int.$from_int(P)}else P=D.substr(0,ce)+D.substr(ce+1)+"0".repeat(G-M),P=long_int.$from_int(P)}else P=long_int.$from_int(D+"0".repeat(G))}else P=(ce=x.search(/\./))>-1?long_int.$from_int(x.substr(0,ce)):long_int.$from_int(x)}return P.pos=l,P}if(isinstance(n,_b_.float)){if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)return n;n=new Number(n>=0?Math.round(n.value):Math.ceil(n.value))}else{if(isinstance(n,_b_.bool))return n.valueOf()?int.$factory(1):int.$factory(0);if(n.__class__===long_int)return n;if(isinstance(n,int))n=n.$brython_value+"";else if(isinstance(n,_b_.bool))n=_b_.bool.__int__(n)+"";else if("string"!=typeof n)throw ValueError.$factory("argument of long_int must be a string, not "+$B.class_name(n))}for(var de=!1,ye=(l=!0,0);" "==n.charAt(0)&&n.length;)n=n.substr(1);for(;" "==n.charAt(n.length-1)&&n.length;)n=n.substr(0,n.length-1);if("+"==n.charAt(0)?de=!0:"-"==n.charAt(0)&&(de=!0,l=!1),de){if(1==n.length)throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');n=n.substr(1)}for(;ye<n.length-1&&"0"==n.charAt(ye);)ye++;n=n.substr(ye);for(var ie=digits(o),ce=-1,fe=0;fe<n.length;fe++)if("."==n.charAt(fe)&&-1==ce)ce=fe;else if(!ie[n.charAt(fe)])throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');if(-1!=ce&&(n=n.substr(0,ce)),10!=o){for(var ae="1",W=long_int.$factory(0),Z=n.length;Z--;){var A=mul_pos(ae,parseInt(n.charAt(Z),o).toString()).value;W=add_pos(W.value,A),ae=mul_pos(ae,o.toString()).value}return W}return{__class__:long_int,value:n,pos:l}},$B.set_func_names(long_int,"builtins"),$B.long_int=long_int}(__BRYTHON__),function($B){var _b_=$B.builtins;function $UnsupportedOpType(n,o,l){throw _b_.TypeError.$factory("unsupported operand type(s) for "+n+": '"+o+"' and '"+l+"'")}var complex={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"complex"},$is_class:!0,$native:!0,$descriptors:{real:!0,imag:!0}};function complex2expo(n){var o=Math.sqrt(n.$real*n.$real+n.$imag*n.$imag),l=n.$imag/o,x=n.$real/o;return{norm:o,angle:0==x?1==l?Math.PI/2:3*Math.PI/2:0==l?1==x?0:Math.PI:Math.atan(l/x)}}complex.__abs__=function(n){var o=isFinite(n.$real),l=isFinite(n.$imag);if(o&&isNaN(n.$imag)||l&&isNaN(n.$real)||isNaN(n.$imag)&&isNaN(n.$real))return NaN;if(!o||!l)return 1/0;var x=Math.sqrt(Math.pow(n.$real,2)+Math.pow(n.$imag,2));if(!isFinite(x)&&o&&l)throw _b_.OverflowError.$factory("absolute value too large");return x},complex.__bool__=function(n){return 0!=n.$real||0!=n.$imag},complex.__eq__=function(n,o){return _b_.isinstance(o,complex)?n.$real.valueOf()==o.$real.valueOf()&&n.$imag.valueOf()==o.$imag.valueOf():_b_.isinstance(o,_b_.int)||_b_.isinstance(o,_b_.float)?0==n.$imag&&n.$real==o.valueOf():_b_.NotImplemented},complex.__floordiv__=function(n,o){$UnsupportedOpType("//","complex",$B.get_class(o))},complex.__hash__=function(n){return 1000003*n.$imag+n.$real},complex.__init__=function(){return _b_.None},complex.__invert__=function(n){return~n},complex.__mod__=function(n,o){throw _b_.TypeError.$factory("TypeError: can't mod complex numbers.")},complex.__mro__=[_b_.object],complex.__mul__=function(n,o){return _b_.isinstance(o,complex)?make_complex(n.$real*o.$real-n.$imag*o.$imag,n.$imag*o.$real+n.$real*o.$imag):_b_.isinstance(o,_b_.int)?make_complex(n.$real*o.valueOf(),n.$imag*o.valueOf()):_b_.isinstance(o,_b_.float)?make_complex(n.$real*o,n.$imag*o):_b_.isinstance(o,_b_.bool)?o.valueOf()?n:make_complex(0,0):void $UnsupportedOpType("*",complex,o)},complex.__ne__=function(n,o){var l=complex.__eq__(n,o);return l===_b_.NotImplemented?l:!l},complex.__neg__=function(n){return make_complex(-n.$real,-n.$imag)},complex.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("complex.__new__(): not enough arguments");var o={},l=$B.args("complex",3,{cls:null,real:null,imag:null},["cls","real","imag"],arguments,{real:0,imag:o},null,null),x=l.real,B=l.imag;if("string"==typeof x){if(B!==o)throw _b_.TypeError.$factory("complex() can't take second arg if first is a string");{let de=function(ye){var ie=parseFloat(ye.charAt(0)+ye.substr(1).replace(/_/g,""));if(isNaN(ie))throw _b_.ValueError.$factory("could not convert string to complex: '"+D+"'");return ie};var D=x;(x=x.trim()).startsWith("(")&&x.endsWith(")")&&(x=(x=x.substr(1)).substr(0,x.length-1));var G=/^\s*([\+\-]*[0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)([\+\-]?)([0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)(j?)\s*$/i.exec(x);if(null===G||"."==G[_real]||"."==G[_imag]||".e"==G[_real]||".e"==G[_imag]||"e"==G[_real]||"e"==G[_imag])throw _b_.ValueError.$factory("complex() arg is a malformed string");return""!=G[_j]?""==G[_sign]?(x=0,B="+"==G[_real]||""==G[_real]?1:"-"==G[_real]?-1:de(G[_real])):(x=de(G[_real]),B=""==G[_imag]?1:de(G[_imag]),B="-"==G[_sign]?-B:B):(x=de(G[_real]),B=0),{__class__:complex,$real:x||0,$imag:B||0}}}if(B=B===o?0:B,1==arguments.length&&x.__class__===complex&&0==B)return x;if(_b_.isinstance(x,[_b_.float,_b_.int])&&_b_.isinstance(B,[_b_.float,_b_.int]))return{__class__:complex,$real:x,$imag:B};var M=$B.to_num(x,["__complex__","__float__","__index__"]);if(null===M)throw _b_.TypeError.$factory("complex() first argument must be a  string or a number, not '"+$B.class_name(x)+"'");if(x=M,B=_convert(B),!_b_.isinstance(x,_b_.float)&&!_b_.isinstance(x,_b_.int)&&!_b_.isinstance(x,_b_.complex))throw _b_.TypeError.$factory("complex() argument must be a string or a number");if("string"==typeof B)throw _b_.TypeError.$factory("complex() second arg can't be a string");if(!_b_.isinstance(B,_b_.float)&&!_b_.isinstance(B,_b_.int)&&!_b_.isinstance(B,_b_.complex)&&B!==o)throw _b_.TypeError.$factory("complex() argument must be a string or a number");return B=complex.__mul__(complex.$factory("1j"),B),complex.__add__(B,x)},complex.__pos__=function(n){return n},complex.__pow__=function(n,o){var l=complex2expo(n),x=l.angle,B=Math.pow(l.norm,o);if(_b_.isinstance(o,[_b_.int,_b_.float]))return make_complex(B*Math.cos(x*o),B*Math.sin(x*o));if(_b_.isinstance(o,complex)){var D=o.$real,G=o.$imag,M=Math.pow(l.norm,D)*Math.pow(Math.E,-G*x),P=G*Math.log(l.norm)-D*x;return make_complex(M*Math.cos(P),M*Math.sin(P))}throw _b_.TypeError.$factory("unsupported operand type(s) for ** or pow(): 'complex' and '"+$B.class_name(o)+"'")},complex.__str__=complex.__repr__=function(n){return 0==n.$real?1/n.$real<0?n.$imag<0?"(-0"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"(-0-"+n.$imag+"j)":"(-0+"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"-"+n.$imag+"j":n.$imag+"j":n.$imag>0?"("+n.$real+"+"+n.$imag+"j)":0==n.$imag?1/n.$imag<0?"("+n.$real+"-"+n.$imag+"j)":"("+n.$real+"+"+n.$imag+"j)":"("+n.$real+"-"+-n.$imag+"j)"},complex.__sqrt__=function(n){if(0==n.$imag)return complex(Math.sqrt(n.$real));var o=n.$real,l=n.$imag,x=Math.sqrt((o+sqrt)/2),B=Number.sign(l)*Math.sqrt((-o+sqrt)/2);return make_complex(x,B)},complex.__truediv__=function(n,o){if(_b_.isinstance(o,complex)){if(0==o.$real&&0==o.$imag)throw _b_.ZeroDivisionError.$factory("division by zero");var x=o.$real*o.$real+o.$imag*o.$imag;return make_complex((n.$real*o.$real+n.$imag*o.$imag)/x,(n.$imag*o.$real-n.$real*o.$imag)/x)}if(_b_.isinstance(o,_b_.int)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}$UnsupportedOpType("//","complex",o.__class__)},complex.conjugate=function(n){return make_complex(n.$real,-n.$imag)};var $op_func=function(n,o){throw _b_.TypeError.$factory("TypeError: unsupported operand type(s) for -: 'complex' and '"+$B.class_name(o)+"'")};$op_func+="";var $ops={"&":"and","|":"ior","<<":"lshift",">>":"rshift","^":"xor"};for(var $op in $ops)eval("complex.__"+$ops[$op]+"__ = "+$op_func.replace(/-/gm,$op));complex.__ior__=complex.__or__;var $op_func=function(n,o){if(_b_.isinstance(o,complex))return make_complex(n.$real-o.$real,n.$imag-o.$imag);if(_b_.isinstance(o,_b_.int))return make_complex($B.sub(n.$real,o.valueOf()),n.$imag);if(_b_.isinstance(o,_b_.float))return make_complex(n.$real-o.valueOf(),n.$imag);if(_b_.isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),make_complex(n.$real-l,n.$imag)}throw _b_.TypeError.$factory("unsupported operand type(s) for -: "+n.__repr__()+" and '"+$B.class_name(o)+"'")};complex.__sub__=$op_func,$op_func+="",$op_func=$op_func.replace(/-/gm,"+").replace(/sub/gm,"add"),eval("complex.__add__ = "+$op_func);var $comp_func=function(n,o){if(void 0===o||o==_b_.None)return _b_.NotImplemented;throw _b_.TypeError.$factory("TypeError: no ordering relation is defined for complex numbers")};for(var $op in $comp_func+="",$B.$comps)eval("complex.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(complex),complex.real=function(n){return new Number(n.$real)},complex.real.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")},complex.imag=function(n){return new Number(n.$imag)},complex.imag.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")};var _real=1,_real_mantissa=2,_sign=3,_imag=4,_imag_mantissa=5,_j=6,type_conversions=["__complex__","__float__","__index__"],_convert=function(n){for(var o=n.__class__||$B.get_class(n),l=0;l<type_conversions.length;l++){var x={},B=$B.$getattr(o,type_conversions[l],x);if(B!==x)return B(n)}return null},make_complex=$B.make_complex=function(n,o){return{__class__:complex,$real:n,$imag:o}};complex.$factory=function(){return complex.__new__(complex,...arguments)},$B.set_func_names(complex,"builtins"),_b_.complex=complex}(__BRYTHON__),function(n){var o=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function l(ie){return ie<1e5?ie<100?ie<10?0:1:ie<1e4?ie<1e3?2:3:4:ie<1e7?ie<1e6?5:6:ie<1e9?ie<1e8?7:8:9}function x(ie,ce){if(ie===ce)return 0;if(~~ie===ie&&~~ce===ce){if(0===ie||0===ce)return ie<ce?-1:1;if(ie<0||ce<0){if(ce>=0)return-1;if(ie>=0)return 1;ie=-ie,ce=-ce}al=l(ie),bl=l(ce);var fe=0;return al<bl?(ie*=o[bl-al-1],ce/=10,fe=-1):al>bl&&(ce*=o[al-bl-1],ie/=10,fe=1),ie===ce?fe:ie<ce?-1:1}var ae=String(ie),W=String(ce);return ae===W?0:ae<W?-1:1}function B(ie,ce,fe,ae){var W=ce+1;if(W===fe)return 1;if(ae(ie[W++],ie[ce])<0){for(;W<fe&&ae(ie[W],ie[W-1])<0;)W++;!function(Z,A,R){for(R--;A<R;){var X=Z[A];Z[A++]=Z[R],Z[R--]=X}}(ie,ce,W)}else for(;W<fe&&ae(ie[W],ie[W-1])>=0;)W++;return W-ce}function D(ie,ce,fe,ae,W){for(ae===ce&&ae++;ae<fe;ae++){for(var Z=ie[ae],A=ce,R=ae;A<R;){var X=A+R>>>1;W(Z,ie[X])<0?R=X:A=X+1}var he=ae-A;switch(he){case 3:ie[A+3]=ie[A+2];case 2:ie[A+2]=ie[A+1];case 1:ie[A+1]=ie[A];break;default:for(;he>0;)ie[A+he]=ie[A+he-1],he--}ie[A]=Z}}function G(ie,ce,fe,ae,W,Z){var A=0,R=0,X=1;if(Z(ie,ce[fe+W])>0){for(R=ae-W;X<R&&Z(ie,ce[fe+W+X])>0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R),A+=W,X+=W}else{for(R=W+1;X<R&&Z(ie,ce[fe+W-X])<=0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R);var he=A;A=W-X,X=W-he}for(A++;A<X;){var U=A+(X-A>>>1);Z(ie,ce[fe+U])>0?A=U+1:X=U}return X}function M(ie,ce,fe,ae,W,Z){var A=0,R=0,X=1;if(Z(ie,ce[fe+W])<0){for(R=W+1;X<R&&Z(ie,ce[fe+W-X])<0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R);var he=A;A=W-X,X=W-he}else{for(R=ae-W;X<R&&Z(ie,ce[fe+W+X])>=0;)A=X,(X=1+(X<<1))<=0&&(X=R);X>R&&(X=R),A+=W,X+=W}for(A++;A<X;){var U=A+(X-A>>>1);Z(ie,ce[fe+U])<0?X=U:A=U+1}return X}var P="TimSortAssertion",de=function(ie){this.name=P,this.message=ie},ye=function(ie,ce){var fe={array:ie,compare:ce,minGallop:7,length:ie.length,tmpStorageLength:256,stackLength:0,runStart:null,runLength:null,stackSize:0,pushRun:function(ae,W){this.runStart[this.stackSize]=ae,this.runLength[this.stackSize]=W,this.stackSize+=1},mergeRuns:function(){for(;this.stackSize>1;){var ae=this.stackSize-2;if(ae>=1&&this.runLength[ae-1]<=this.runLength[ae]+this.runLength[ae+1]||ae>=2&&this.runLength[ae-2]<=this.runLength[ae]+this.runLength[ae-1])this.runLength[ae-1]<this.runLength[ae+1]&&ae--;else if(this.runLength[ae]>this.runLength[ae+1])break;this.mergeAt(ae)}},forceMergeRuns:function(){for(;this.stackSize>1;){var ae=this.stackSize-2;ae>0&&this.runLength[ae-1]<this.runLength[ae+1]&&ae--,this.mergeAt(ae)}},mergeAt:function(ae){var W=this.compare,Z=this.array,A=this.runStart[ae],R=this.runLength[ae],X=this.runStart[ae+1],he=this.runLength[ae+1];this.runLength[ae]=R+he,ae===this.stackSize-3&&(this.runStart[ae+1]=this.runStart[ae+2],this.runLength[ae+1]=this.runLength[ae+2]),this.stackSize--;var U=M(Z[X],Z,A,R,0,W);A+=U,0!=(R-=U)&&0!==(he=G(Z[A+R-1],Z,X,he,he-1,W))&&(R<=he?this.mergeLow(A,R,X,he):this.mergeHigh(A,R,X,he))},mergeLow:function(ae,W,Z,A){var R=this.compare,X=this.array,he=this.tmp,U=0;for(U=0;U<W;U++)he[U]=X[ae+U];var Re=0,Q=Z,be=ae;if(X[be++]=X[Q++],0!=--A)if(1!==W){for(var Pe=this.minGallop;;){var Ge=0,Ae=0,Xe=!1;do{if(R(X[Q],he[Re])<0){if(X[be++]=X[Q++],Ae++,Ge=0,0==--A){Xe=!0;break}}else if(X[be++]=he[Re++],Ge++,Ae=0,1==--W){Xe=!0;break}}while((Ge|Ae)<Pe);if(Xe)break;do{if(0!==(Ge=M(X[Q],he,Re,W,0,R))){for(U=0;U<Ge;U++)X[be+U]=he[Re+U];if(be+=Ge,Re+=Ge,(W-=Ge)<=1){Xe=!0;break}}if(X[be++]=X[Q++],0==--A){Xe=!0;break}if(0!==(Ae=G(he[Re],X,Q,A,0,R))){for(U=0;U<Ae;U++)X[be+U]=X[Q+U];if(be+=Ae,Q+=Ae,0==(A-=Ae)){Xe=!0;break}}if(X[be++]=he[Re++],1==--W){Xe=!0;break}Pe--}while(Ge>=7||Ae>=7);if(Xe)break;Pe<0&&(Pe=0),Pe+=2}if(this.minGallop=Pe,Pe<1&&(this.minGallop=1),1===W){for(U=0;U<A;U++)X[be+U]=X[Q+U];X[be+A]=he[Re]}else{if(0===W)throw new de("mergeLow preconditions were not respected");for(U=0;U<W;U++)X[be+U]=he[Re+U]}}else{for(U=0;U<A;U++)X[be+U]=X[Q+U];X[be+A]=he[Re]}else for(U=0;U<W;U++)X[be+U]=he[Re+U]},mergeHigh:function(ae,W,Z,A){var R=this.compare,X=this.array,he=this.tmp,U=0;for(U=0;U<A;U++)he[U]=X[Z+U];var Re=ae+W-1,Q=A-1,be=Z+A-1,Pe=0,Ge=0;if(X[be--]=X[Re--],0!=--W)if(1!==A){for(var Ae=this.minGallop;;){var Xe=0,Ke=0,yt=!1;do{if(R(he[Q],X[Re])<0){if(X[be--]=X[Re--],Xe++,Ke=0,0==--W){yt=!0;break}}else if(X[be--]=he[Q--],Ke++,Xe=0,1==--A){yt=!0;break}}while((Xe|Ke)<Ae);if(yt)break;do{if(0!=(Xe=W-M(he[Q],X,ae,W,W-1,R))){for(W-=Xe,Ge=1+(be-=Xe),Pe=1+(Re-=Xe),U=Xe-1;U>=0;U--)X[Ge+U]=X[Pe+U];if(0===W){yt=!0;break}}if(X[be--]=he[Q--],1==--A){yt=!0;break}if(0!=(Ke=A-G(X[Re],he,0,A,A-1,R))){for(A-=Ke,Ge=1+(be-=Ke),Pe=1+(Q-=Ke),U=0;U<Ke;U++)X[Ge+U]=he[Pe+U];if(A<=1){yt=!0;break}}if(X[be--]=X[Re--],0==--W){yt=!0;break}Ae--}while(Xe>=7||Ke>=7);if(yt)break;Ae<0&&(Ae=0),Ae+=2}if(this.minGallop=Ae,Ae<1&&(this.minGallop=1),1===A){for(Ge=1+(be-=W),Pe=1+(Re-=W),U=W-1;U>=0;U--)X[Ge+U]=X[Pe+U];X[be]=he[Q]}else{if(0==A)throw new de("mergeHigh preconditions were not respected");for(Pe=be-(A-1),U=0;U<A;U++)X[Pe+U]=he[U]}}else{for(Ge=1+(be-=W),Pe=1+(Re-=W),U=W-1;U>=0;U--)X[Ge+U]=X[Pe+U];X[be]=he[Q]}else for(Pe=be-(A-1),U=0;U<A;U++)X[Pe+U]=he[U]}};return fe.length<512&&(fe.tmpStorageLength=fe.length>>>1),fe.tmp=new Array(fe.tmpStorageLength),fe.stackLength=fe.length<120?5:fe.length<1542?10:fe.length<119151?19:40,fe.runStart=new Array(fe.stackLength),fe.runLength=new Array(fe.stackLength),fe};n.$TimSort=function(ie,ce){try{!function(fe,ae,W,Z){if(!Array.isArray(fe))throw TypeError.$factory("Can only sort arrays");ae?"function"!=typeof ae&&(Z=W,W=ae,ae=x):ae=x,W||(W=0),Z||(Z=fe.length);var A=Z-W;if(!(A<2)){var R=0;if(A<32)D(fe,W,Z,W+(R=B(fe,W,Z,ae)),ae);else{var X=new ye(fe,ae),he=function(Re){for(var Q=0;Re>=32;)Q|=1&Re,Re>>=1;return Re+Q}(A);do{if((R=B(fe,W,Z,ae))<he){var U=A;U>he&&(U=he),D(fe,W,W+U,W+R,ae),R=U}X.pushRun(W,R),X.mergeRuns(),A-=R,W+=R}while(0!==A);X.forceMergeRuns()}}}(ie,ce,0,ie.length)}catch(fe){if(fe.name!=P)throw fe;ie.sort(ce)}},n.$AlphabeticalCompare=x}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=n.$getattr,B=o.isinstance,D=o.None;function G(ae,W){if(ae.__class__===ce)throw o.AttributeError.$factory("'tuple' object has no attribute '"+W+"'")}var M={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"list"},$is_class:!0,$native:!0,__dir__:l.__dir__,__add__:function(ae,W){if(n.get_class(ae)!==n.get_class(W)){var Z=x(W,"__radd__",o.NotImplemented);if(Z!==o.NotImplemented)return Z(ae);throw o.TypeError.$factory('can only concatenate list (not "'+n.class_name(W)+'") to list')}var A=ae.slice(),R="js"==W.$brython_class;for(const X of W)A.push(R?n.$JS2Py(X):X);return A.__brython__=!0,B(ae,ce)&&(A=ce.$factory(A)),A},__class_getitem__:function(ae,W){return Array.isArray(W)||(W=[W]),n.GenericAlias.$factory(ae,W)},__contains__:function(ae,W){for(var A=n.args("__contains__",2,{self:null,item:null},["self","item"],arguments,{},null,null),R=(ae=A.self,W=A.item,0);R<ae.length;){if(n.rich_comp("__eq__",W,ae[R]))return!0;R++}return!1},__delitem__:function(ae,W){if(B(W,o.int)){var Z=W;if(W<0&&(Z=ae.length+Z),Z>=0&&Z<ae.length)return ae.splice(Z,1),D;throw o.IndexError.$factory(n.class_name(ae)+" index out of range")}if(B(W,o.slice)){var A=W.step;A===D&&(A=1);var R=W.start;R===D&&(R=A>0?0:ae.length);var X=W.stop;X===D&&(X=A>0?ae.length:0),R<0&&(R=ae.length+R),X<0&&(X=ae.length+X);var he=[],U=null;if(Z=0,A>0){if(X>R)for(U=R;U<X;U+=A)void 0!==ae[U]&&(he[Z++]=U)}else if(X<R){for(U=R;U>X;U+=A)void 0!==ae[U]&&(he[Z++]=U);he.reverse()}for(U=he.length;U--;)ae.splice(he[U],1);return D}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__delitem__(ae,o.int.$factory(W)),D;throw o.TypeError.$factory(n.class_name(ae)+" indices must be integer, not "+n.class_name(W))},__eq__:function(ae,W){if(B(ae,M))var Z=M;else Z=ce;if(B(W,Z)&&W.length==ae.length){for(var A=ae.length;A--;)if(!n.rich_comp("__eq__",ae[A],W[A]))return!1;return!0}return o.NotImplemented},__getitem__:function(ae,W){return n.check_no_kw("__getitem__",ae,W),n.check_nb_args("__getitem__",2,arguments),M.$getitem(ae,W)},$getitem:function(ae,W){var Z=(ae.__class__||n.get_class(ae)).$factory;if(B(W,o.int)){var A=ae.valueOf(),R=W;if(W<0&&(R=A.length+R),R>=0&&R<A.length)return A[R];throw o.IndexError.$factory(n.class_name(ae)+" index out of range")}if(W.__class__===o.slice||B(W,o.slice)){if(W.start===o.None&&W.stop===o.None&&W.step===o.None)return ae.slice();var X=o.slice.$conv_for_seq(W,ae.length),he=[],U=null,Re=(A=ae.valueOf(),R=0,X.start),Q=X.stop,be=X.step;if(be>0){if(Q<=Re)return Z(he);for(U=Re;U<Q;U+=be)he[R++]=A[U];return Z(he)}if(Q>Re)return Z(he);for(U=Re;U>Q;U+=be)he[R++]=A[U];return Z(he)}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__getitem__(ae,o.int.$factory(W));throw o.TypeError.$factory(n.class_name(ae)+" indices must be integer, not "+n.class_name(W))},__ge__:function(ae,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Z=0;Z<ae.length;){if(Z>=W.length)return!0;if(!n.rich_comp("__eq__",ae[Z],W[Z])){if(res=x(ae[Z],"__ge__")(W[Z]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ae[Z])+"() >= "+n.class_name(W[Z])+"()");return res}Z++}return W.length==ae.length},__gt__:function(ae,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Z=0;Z<ae.length;){if(Z>=W.length)return!0;if(!n.rich_comp("__eq__",ae[Z],W[Z])){if(res=x(ae[Z],"__gt__")(W[Z]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ae[Z])+"() > "+n.class_name(W[Z])+"()");return res}Z++}return!1}};M.__hash__=D,M.__iadd__=function(){var ae=n.args("__iadd__",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=x(ae.x,"__radd__",o.NotImplemented);if(W!==o.NotImplemented)return W(ae.self);for(var Z=M.$factory(n.$iter(ae.x)),A=0;A<Z.length;A++)ae.self.push(Z[A]);return ae.self},M.__imul__=function(){var ae=n.args("__imul__",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=n.$GetInt(ae.x),Z=ae.self.length,A=Z;if(0==W)return M.clear(ae.self),ae.self;for(var R=1;R<W;R++)for(j=0;j<Z;j++)ae.self[A++]=ae.self[j];return ae.self},M.__init__=function(ae,W){var Z=n.$call(x(ae,"__len__")),A=x(ae,"pop",D);if(A!==D)for(A=n.$call(A);Z();)A();if(void 0===W)return D;W=n.$iter(W);for(var R=n.$call(x(W,"__next__")),X=Z();;)try{var he=R();ae[X++]=he}catch(U){if(U.__class__===o.StopIteration)break;throw U}return D};var P=n.make_iterator_class("list_iterator");P.__reduce__=P.__reduce_ex__=function(ae){return n.fast_tuple([o.iter,n.fast_tuple([M.$factory(ae)]),0])},M.__iter__=function(ae){return P.$factory(ae)},M.__le__=function(ae,W){var Z=M.__ge__(ae,W);return Z===o.NotImplemented?Z:!Z},M.__len__=function(ae){return ae.length},M.__lt__=function(ae,W){if(!B(W,[M,o.tuple]))return o.NotImplemented;for(var Z=0;Z<ae.length;){if(Z>=W.length)return!1;if(!n.rich_comp("__eq__",ae[Z],W[Z])){if(res=x(ae[Z],"__lt__")(W[Z]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(ae[Z])+"() >= "+n.class_name(W[Z])+"()");return res}Z++}return W.length>ae.length},M.__mul__=function(ae,W){if(B(W,o.int)){for(var Z=[],A=ae.slice(),R=A.length,X=0;X<W;X++)for(var he=0;he<R;he++)Z.push(A[he]);return Z.__class__=ae.__class__,Z}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__mul__(ae,o.int.$factory(W));var U=n.$getattr(W,"__rmul__",o.NotImplemented);if(U!==o.NotImplemented)return U(ae);throw o.TypeError.$factory("can't multiply sequence by non-int of type '"+n.class_name(W)+"'")},M.__new__=function(ae,...W){if(void 0===ae)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Z=[];return Z.__class__=ae,Z.__brython__=!0,Z.__dict__=n.empty_dict(),Z},M.__repr__=function(ae){if(n.repr.enter(ae))return"[...]";for(var W,Z=[],A=0;A<ae.length;A++)Z.push(o.repr(ae[A]));return W=ae.__class__===ce?1==ae.length?"("+Z[0]+",)":"("+Z.join(", ")+")":"["+Z.join(", ")+"]",n.repr.leave(ae),W},M.__setattr__=function(ae,W,Z){if(ae.__class__===M)throw M.hasOwnProperty(W)?o.AttributeError.$factory("'list' object attribute '"+W+"' is read-only"):o.AttributeError.$factory("'list' object has no attribute '"+W+"'");return o.dict.$setitem(ae.__dict__,W,Z),D},M.__setitem__=function(){var ae=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);M.$setitem(ae.self,ae.key,ae.value)},M.$setitem=function(ae,W,Z){if("number"==typeof W||B(W,o.int)){var A=W;if(W<0&&(A=ae.length+A),!(A>=0&&A<ae.length))throw o.IndexError.$factory("list index out of range");return ae[A]=Z,D}if(B(W,o.slice)){var R=o.slice.$conv_for_seq(W,ae.length);return null===W.step?n.set_list_slice(ae,R.start,R.stop,Z):n.set_list_slice_step(ae,R.start,R.stop,R.step,Z),D}if(o.hasattr(W,"__int__")||o.hasattr(W,"__index__"))return M.__setitem__(ae,o.int.$factory(W),Z),D;throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(W))},n.make_rmethods(M),M.append=function(ae,W){return n.check_no_kw("append",ae,W),n.check_nb_args("append",2,arguments),ae.push(W),D},M.clear=function(){for(var ae=n.args("clear",1,{self:null},["self"],arguments,{},null,null);ae.self.length;)ae.self.pop();return D},M.copy=function(){return n.args("copy",1,{self:null},["self"],arguments,{},null,null).self.slice()},M.count=function(){for(var W=n.args("count",2,{self:null,x:null},["self","x"],arguments,{},null,null),Z=0,A=W.self.length;A--;)n.rich_comp("__eq__",W.x,W.self[A])&&Z++;return Z},M.extend=function(){for(var ae=n.args("extend",2,{self:null,t:null},["self","t"],arguments,{},null,null),W=M.$factory(n.$iter(ae.t)),Z=0;Z<W.length;Z++)ae.self.push(W[Z]);return D},M.index=function(){var W={},Z=n.args("index",4,{self:null,x:null,start:null,stop:null},["self","x","start","stop"],arguments,{start:0,stop:W},null,null),A=Z.self,R=Z.start,X=Z.stop;R.__class__===n.long_int&&(R=parseInt(R.value)*(R.pos?1:-1)),R<0&&(R=Math.max(0,R+A.length)),X===W?X=A.length:(X.__class__===n.long_int&&(X=parseInt(X.value)*(X.pos?1:-1)),X<0&&(X=Math.min(A.length,X+A.length)),X=Math.min(X,A.length));for(var he=R;he<X;he++)if(n.rich_comp("__eq__",Z.x,A[he]))return he;throw o.ValueError.$factory(o.repr(Z.x)+" is not in "+n.class_name(A))},M.insert=function(){var ae=n.args("insert",3,{self:null,i:null,item:null},["self","i","item"],arguments,{},null,null);return ae.self.splice(ae.i,0,ae.item),D},M.pop=function(){var ae={},W=n.args("pop",2,{self:null,pos:null},["self","pos"],arguments,{pos:ae},null,null),Z=W.self,A=W.pos;G(Z,"pop"),A===ae&&(A=Z.length-1),(A=n.$GetInt(A))<0&&(A+=Z.length);var R=Z[A];if(void 0===R)throw o.IndexError.$factory("pop index out of range");return Z.splice(A,1),R},M.remove=function(){for(var ae=n.args("remove",2,{self:null,x:null},["self","x"],arguments,{},null,null),W=0,Z=ae.self.length;W<Z;W++)if(n.rich_comp("__eq__",ae.self[W],ae.x))return ae.self.splice(W,1),D;throw o.ValueError.$factory(o.str.$factory(ae.x)+" is not in list")},M.reverse=function(ae){for(var W=n.args("reverse",1,{self:null},["self"],arguments,{},null,null),Z=W.self.length-1,A=parseInt(W.self.length/2);A--;){var R=W.self[A];W.self[A]=W.self[Z-A],W.self[Z-A]=R}return D},M.sort=function(ae){var U,W=n.args("sort",1,{self:null},["self"],arguments,{},null,"kw");G(ae,"sort");for(var Z=D,A=!1,R=W.kw,X=o.list.$factory(o.dict.$$keys(R)),he=0;he<X.length;he++)if("key"==X[he])Z=R.$string_dict[X[he]][0];else{if("reverse"!=X[he])throw o.TypeError.$factory("'"+X[he]+"' is an invalid keyword argument for this function");A=R.$string_dict[X[he]][0]}if(0!=ae.length)return Z!==D&&(Z=n.$call(Z)),ae.$cl=function(Re){if(0==Re.length)return null;for(var Q=n.get_class(Re[0]),be=Re.length;be--;)if(n.get_class(Re[be])!==Q)return!1;return Q}(ae),U=Z===D&&ae.$cl===o.str?A?function(Re,Q){return n.$AlphabeticalCompare(Q,Re)}:function(Re,Q){return n.$AlphabeticalCompare(Re,Q)}:Z===D&&ae.$cl===o.int?A?function(Re,Q){return Q-Re}:function(Re,Q){return Re-Q}:Z===D?A?function(Re,Q){if(res=x(Q,"__lt__")(Re),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Re)+"() < "+n.class_name(Q)+"()");return res?Q==Re?0:-1:1}:function(Re,Q){if(res=x(Re,"__lt__")(Q),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Re)+"() < "+n.class_name(Q)+"()");return res?Re==Q?0:-1:1}:A?function(Re,Q){var be=Z(Q),Pe=Z(Re);if(res=x(be,"__lt__")(Pe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Re)+"() < "+n.class_name(Q)+"()");return res?be==Pe?0:-1:1}:function(Re,Q){var be=Z(Re),Pe=Z(Q);if(res=n.$getattr(be,"__lt__")(Pe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(Re)+"() < "+n.class_name(Q)+"()");return res?be==Pe?0:-1:1},n.$TimSort(ae,U),ae.__brython__?D:ae},n.$list=function(ae){return ae.__brython__=!0,ae},M.$factory=function(){if(0==arguments.length)return[];var ae=n.args("list",1,{obj:null},["obj"],arguments,{},null,null).obj;if(Array.isArray(ae))return(ae=ae.slice()).__brython__=!0,ae.__class__==ce?((W=ae.slice()).__class__=M,W):ae;for(var W=[],Z=0,A=n.$iter(ae),R=n.$call(x(A,"__next__"));;)try{W[Z++]=R()}catch(X){if(!B(X,o.StopIteration))throw X;break}return W.__brython__=!0,W},n.set_func_names(M,"builtins"),M.__class_getitem__=o.classmethod.$factory(M.__class_getitem__);var de=n.JSArray=n.make_class("JSArray",function(ae){return{__class__:de,js:ae}});function ye(ae){for(var W=[ae[0].js],Z=1,A=ae.length;Z<A;Z++)W.push(ae[Z]);return W}for(var ie in de.__repr__=de.__str__=function(){return"<JSArray object>"},M)void 0===n.JSArray[ie]&&"function"==typeof M[ie]&&(n.JSArray[ie]=function(ae){return function(){return n.$JS2Py(M[ae].apply(null,ye(arguments)))}}(ie));n.set_func_names(n.JSArray,"builtins");var ce={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"tuple"},$is_class:!0,$native:!0},fe=n.make_iterator_class("tuple_iterator");for(var ie in ce.__iter__=function(W){return fe.$factory(W)},ce.$factory=function(){var W=M.$factory(...arguments);return W.__class__=ce,W},n.fast_tuple=function(W){return W.__class__=ce,W.__brython__=!0,W.__dict__=n.empty_dict(),W},M)switch(ie){case"__delitem__":case"__iadd__":case"__imul__":case"__setitem__":case"append":case"extend":case"insert":case"remove":case"reverse":break;default:void 0===ce[ie]&&"function"==typeof M[ie]&&(ce[ie]=function(W){return function(){return M[W].apply(null,arguments)}}(ie))}ce.__eq__=function(ae,W){return void 0===W?ae===ce:M.__eq__(ae,W)},ce.__hash__=function(ae){for(var W,Z=54880137,A=0,R=ae.length;A<R;A++){var X=o.hash(ae[A]);W=Z,s=(parseInt(1000003)*W&4294967295).toString(16),Z=parseInt(s.substr(0,s.length-1),16)^4294967295&X}return Z},ce.__init__=function(){return D},ce.__new__=function(ae,...W){if(void 0===ae)throw o.TypeError.$factory("list.__new__(): not enough arguments");var Z=[];Z.__class__=ae,Z.__brython__=!0,Z.__dict__=n.empty_dict();for(var A=n.$iter(W[0]),R=n.$call(x(A,"__next__"));;)try{var X=R();Z.push(X)}catch(he){if(he.__class__===o.StopIteration)break;throw he}return Z},n.set_func_names(ce,"builtins"),o.list=M,o.tuple=ce,o.object.__bases__=ce.$factory()}(__BRYTHON__);var $B=__BRYTHON__;for(var gc in $B.unicode={Cc:[[0,32],[127,33]],Zs:[32,160,5760,6158,[8192,11],8239,8287,12288],Po:[[33,3],[37,3],[42,3,2],47,58,59,63,64,92,161,183,191,894,903,[1370,6],1417,[1472,3,3],1523,1524,1545,1546,1548,1549,1563,1566,1567,[1642,4],1748,[1792,14],[2039,3],[2096,15],2404,2405,2416,3572,3663,3674,3675,[3844,15],3973,[4048,5],[4170,6],4347,[4961,8],5741,5742,[5867,3],5941,5942,[6100,3],[6104,3],[6144,6],[6151,4],6468,6469,6622,6623,6686,6687,[6816,7],[6824,6],[7002,7],[7227,5],7294,7295,7379,8214,8215,[8224,8],[8240,9],[8251,4],[8257,3],[8263,11],8275,[8277,10],[11513,4],11518,11519,11776,11777,[11782,3],11787,[11790,9],11800,11801,11803,11806,11807,[11818,5],11824,11825,[12289,3],12349,12539,42238,42239,[42509,3],42611,42622,[42738,6],[43124,4],43214,43215,[43256,3],43310,43311,43359,[43457,13],43486,43487,[43612,4],43742,43743,44011,[65040,7],65049,65072,65093,65094,[65097,4],[65104,3],[65108,4],[65119,3],65128,65130,65131,[65281,3],[65285,3],[65290,3,2],65295,65306,65307,65311,65312,65340,65377,65380,65381,65792,65793,66463,66512,67671,67871,67903,[68176,9],68223,[68409,7],69819,69820,[69822,4],[74864,4]],Sc:[36,[162,4],1547,2546,2547,2555,2801,3065,3647,6107,[8352,25],43064,65020,65129,65284,65504,65505,65509,65510],Ps:[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,9001,[10088,7,2],10181,[10214,5,2],[10627,11,2],10712,10714,10748,[11810,4,2],[12296,5,2],[12308,4,2],12317,64830,65047,[65077,8,2],65095,[65113,3,2],65288,65339,65371,65375,65378],Pe:[41,93,125,3899,3901,5788,8262,8318,8334,9002,[10089,7,2],10182,[10215,5,2],[10628,11,2],10713,10715,10749,[11811,4,2],[12297,5,2],[12309,4,2],12318,12319,64831,65048,[65078,8,2],65096,[65114,3,2],65289,65341,[65373,3,3]],Sm:[43,[60,3],124,126,172,177,215,247,1014,[1542,3],8260,8274,[8314,3],[8330,3],[8512,5],8523,[8592,5],8602,8603,[8608,3,3],8622,8654,8655,8658,8660,[8692,268],[8968,4],8992,8993,9084,[9115,25],[9180,6],9655,9665,[9720,8],9839,[10176,5],[10183,4],10188,[10192,22],[10224,16],[10496,131],[10649,63],[10716,32],[10750,258],[11056,21],[11079,6],64297,65122,[65124,3],65291,[65308,3],65372,65374,65506,[65513,4],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771],Pd:[45,1418,1470,5120,6150,[8208,6],11799,11802,12316,12336,12448,65073,65074,65112,65123,65293],Nd:[[48,10],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],[42528,10],[43216,10],[43264,10],[43472,10],[43600,10],[44016,10],[65296,10],[66720,10],[120782,50]],Lu:[[65,26],[192,23],[216,7],[256,28,2],[313,8,2],[330,24,2],[377,3,2],385,[386,3,2],391,[393,3],[398,4],403,404,[406,3],412,413,415,[416,4,2],423,425,428,430,431,[433,3],437,439,440,444,[452,4,3],[463,7,2],[478,9,2],497,500,[502,3],[506,29,2],570,571,573,574,577,[579,4],[584,4,2],880,882,886,902,[904,3],908,910,911,[913,17],[931,9],975,[978,3],[984,12,2],1012,1015,1017,1018,[1021,51],[1120,17,2],[1162,28,2],[1217,7,2],[1232,43,2],[1329,38],[4256,38],[7680,75,2],[7838,49,2],[7944,8],[7960,6],[7976,8],[7992,8],[8008,6],[8025,4,2],[8040,8],[8120,4],[8136,4],[8152,4],[8168,5],[8184,4],8450,8455,[8459,3],[8464,3],8469,[8473,5],[8484,4,2],[8491,3],[8496,4],8510,8511,8517,8579,[11264,47],11360,[11362,3],[11367,4,2],[11374,3],11378,11381,[11390,3],[11394,49,2],11499,11501,[42560,16,2],[42594,6,2],[42624,12,2],[42786,7,2],[42802,31,2],[42873,3,2],[42878,5,2],42891,[65313,26],[66560,40],[119808,26],[119860,26],[119912,26],119964,119966,[119967,3,3],119974,[119977,4],[119982,8],[120016,26],120068,120069,[120071,4],[120077,8],[120086,7],120120,120121,[120123,4],[120128,5],120134,[120138,7],[120172,26],[120224,26],[120276,26],[120328,26],[120380,26],[120432,26],[120488,25],[120546,25],[120604,25],[120662,25],[120720,25],120778],Sk:[94,96,168,175,180,184,[706,4],[722,14],[741,7],749,[751,17],885,900,901,8125,[8127,3],[8141,3],[8157,3],[8173,3],8189,8190,12443,12444,[42752,23],42784,42785,42889,42890,65342,65344,65507],Pc:[95,8255,8256,8276,65075,65076,[65101,3],65343],Ll:[[97,26],170,181,186,[223,24],[248,8],[257,28,2],[312,9,2],[329,24,2],[378,3,2],383,384,387,389,392,396,397,402,405,[409,3],414,[417,3,2],424,426,427,429,432,436,438,441,442,[445,3],[454,3,3],[462,8,2],[477,10,2],496,499,501,[505,30,2],[564,6],572,575,576,578,[583,5,2],[592,68],[661,27],881,[883,3,4],892,893,912,[940,35],976,977,[981,3],[985,12,2],[1008,4],[1013,3,3],1020,[1072,48],[1121,17,2],[1163,27,2],[1218,7,2],[1231,44,2],[1377,39],[7424,44],[7522,22],[7545,34],[7681,75,2],[7830,8],[7839,49,2],[7936,8],[7952,6],[7968,8],[7984,8],[8e3,6],[8016,8],[8032,8],[8048,14],[8064,8],[8080,8],[8096,8],[8112,5],8118,8119,8126,[8130,3],8134,8135,[8144,4],8150,8151,[8160,8],[8178,3],8182,8183,8458,8462,8463,8467,[8495,3,5],8508,8509,[8518,4],8526,8580,[11312,47],11361,11365,[11366,4,2],11377,11379,11380,[11382,7],[11393,50,2],11492,11500,11502,[11520,38],[42561,16,2],[42595,6,2],[42625,12,2],[42787,7,2],42800,[42801,33,2],[42866,7],42874,42876,[42879,5,2],42892,[64256,7],[64275,5],[65345,26],[66600,40],[119834,26],[119886,7],[119894,18],[119938,26],[119990,4],119995,[119997,7],[120005,11],[120042,26],[120094,26],[120146,26],[120198,26],[120250,26],[120302,26],[120354,26],[120406,26],[120458,28],[120514,25],[120540,6],[120572,25],[120598,6],[120630,25],[120656,6],[120688,25],[120714,6],[120746,25],[120772,6],120779],So:[166,167,169,174,176,182,1154,1550,1551,1769,1789,1790,2038,2554,2928,[3059,6],3066,3199,3313,3314,3449,[3841,3],[3859,5],[3866,6],[3892,3,2],[4030,8],[4039,6],4046,4047,[4053,4],4254,4255,4960,[5008,10],6464,[6624,32],[7009,10],[7028,9],8448,8449,[8451,4],8456,8457,8468,[8470,3],[8478,6],[8485,3,2],8494,8506,8507,8522,8524,8525,8527,[8597,5],[8604,4],8609,8610,8612,8613,[8615,7],[8623,31],8656,[8657,3,2],[8662,30],[8960,8],[8972,20],[8994,7],[9003,81],[9085,30],[9140,40],[9186,7],[9216,39],[9280,11],[9372,78],[9472,183],[9656,9],[9666,54],[9728,111],[9840,94],[9935,19],9955,[9960,24],[9985,4],[9990,4],[9996,28],[10025,35],10061,[10063,4],[10070,9],[10081,7],10132,[10136,24],[10161,14],[10240,256],[11008,48],11077,11078,[11088,10],[11493,6],[11904,26],[11931,89],[12032,214],[12272,12],12292,12306,12307,12320,12342,12343,12350,12351,12688,12689,[12694,10],[12736,36],[12800,31],[12842,39],[12896,32],[12938,39],[12992,63],[13056,256],[19904,64],[42128,55],[43048,4],43062,43063,43065,[43639,3],65021,65508,65512,65517,65518,65532,65533,65794,[65847,9],[65913,17],[65936,12],[66e3,45],[118784,246],[119040,39],[119081,60],[119146,3],119171,119172,[119180,30],[119214,48],[119296,66],119365,[119552,87],[126976,44],[127024,100],[127248,31],127281,127293,127295,[127298,3,4],[127307,4],127319,127327,127353,127355,127356,127359,[127370,4],127376,127488,[127504,34],[127552,9]],Pi:[171,8216,8219,8220,8223,8249,11778,11780,11785,11788,11804,11808],Cf:[173,[1536,4],1757,1807,6068,6069,[8203,5],[8234,5],[8288,5],[8298,6],65279,[65529,3],69821,[119155,8],917505,[917536,96]],No:[178,179,185,[188,3],[2548,6],[3056,3],[3192,7],[3440,6],[3882,10],[4969,20],[6128,10],8304,[8308,6],[8320,10],[8528,16],8585,[9312,60],[9450,22],[10102,30],11517,[12690,4],[12832,10],[12881,15],[12928,10],[12977,15],[43056,6],[65799,45],[65909,4],65930,[66336,4],[67672,8],[67862,6],[68160,8],68221,68222,[68440,8],[68472,8],[69216,31],[119648,18],[127232,11]],Pf:[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],Lo:[443,[448,4],660,[1488,27],[1520,3],[1569,31],[1601,10],1646,1647,[1649,99],1749,1774,1775,[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2048,22],[2308,54],2365,2384,[2392,10],2418,[2425,7],[2437,8],2447,2448,[2451,22],[2474,7],2482,[2486,4],2493,2510,2524,2525,[2527,3],2544,2545,[2565,6],2575,2576,[2579,22],[2602,7],2610,2611,2613,2614,2616,2617,[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],2738,2739,[2741,5],2749,2768,2784,2785,[2821,8],2831,2832,[2835,22],[2858,7],2866,2867,[2869,5],2877,2908,2909,[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],2969,[2970,3,2],2975,2979,2980,[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,3160,3161,3168,3169,[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,3296,3297,[3333,8],[3342,3],[3346,23],[3370,16],3389,3424,3425,[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,3635,[3648,6],3713,3714,3716,3719,3720,3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,3754,3755,[3757,4],3762,3763,3773,[3776,5],3804,3805,3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,4197,4198,[4206,3],[4213,13],4238,[4304,43],[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6108,[6176,35],[6212,52],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],[6917,47],[6981,7],[7043,30],7086,7087,[7168,36],[7245,3],[7258,30],[7401,4],[7406,4],[8501,4],[11568,54],[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12294,12348,[12353,86],12447,[12449,90],12543,[12549,41],[12593,94],[12704,24],[12784,16],13312,19893,19968,40907,[40960,21],[40982,1143],[42192,40],[42240,268],[42512,16],42538,42539,42606,[42656,70],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],[43520,41],[43584,3],[43588,8],[43616,16],[43633,6],43642,[43648,48],43697,43701,43702,[43705,5],43712,43714,43739,43740,[43968,35],44032,55203,[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],64285,[64287,10],[64298,13],[64312,5],64318,64320,64321,64323,64324,[64326,108],[64467,363],[64848,64],[64914,54],[65008,12],[65136,5],[65142,135],[65382,10],[65393,45],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],65596,65597,[65599,15],[65616,14],[65664,123],[66176,29],[66208,49],[66304,31],[66352,17],[66370,8],[66432,30],[66464,36],[66504,8],[66640,78],[67584,6],67592,[67594,44],67639,67640,67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[77824,1071],131072,173782,173824,177972,[194560,542]],Lt:[[453,3,3],498,[8072,8],[8088,8],[8104,8],8124,8140,8188],Lm:[[688,18],[710,12],[736,5],748,750,884,890,1369,1600,1765,1766,2036,2037,2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,6],[7468,54],7544,[7579,37],8305,8319,[8336,5],11389,11631,11823,12293,[12337,5],12347,12445,12446,[12540,3],40981,[42232,6],42508,42623,[42775,9],42864,42888,43471,43632,43741,65392,65438,65439],Mn:[[768,112],[1155,5],[1425,45],1471,1473,1474,1476,1477,1479,[1552,11],[1611,20],1648,[1750,7],[1759,6],1767,1768,[1770,4],1809,[1840,27],[1958,11],[2027,9],[2070,4],[2075,9],[2085,3],[2089,5],[2304,3],2364,[2369,8],2381,[2385,5],2402,2403,2433,2492,[2497,4],2509,2530,2531,2561,2562,2620,2625,2626,2631,2632,[2635,3],2641,2672,2673,2677,2689,2690,2748,[2753,5],2759,2760,2765,2786,2787,2817,2876,2879,[2881,4],2893,2902,2914,2915,2946,3008,3021,[3134,3],[3142,3],[3146,4],3157,3158,3170,3171,3260,3263,3270,3276,3277,3298,3299,[3393,4],3405,3426,3427,3530,[3538,3],3542,3633,[3636,7],[3655,8],3761,[3764,6],3771,3772,[3784,6],3864,3865,[3893,3,2],[3953,14],[3968,5],3974,3975,[3984,8],[3993,36],4038,[4141,4],[4146,6],4153,4154,4157,4158,4184,4185,[4190,3],[4209,4],4226,4229,4230,4237,4253,4959,[5906,3],[5938,3],5970,5971,6002,6003,[6071,7],6086,[6089,11],6109,[6155,3],6313,[6432,3],6439,6440,6450,[6457,3],6679,6680,6742,[6744,7],6752,6754,[6757,8],[6771,10],6783,[6912,4],6964,[6966,5],6972,6978,[7019,9],7040,7041,[7074,4],7080,7081,[7212,8],7222,7223,[7376,3],[7380,13],[7394,7],7405,[7616,39],[7677,3],[8400,13],8417,[8421,12],[11503,3],[11744,32],[12330,6],12441,12442,42607,42620,42621,42736,42737,43010,43014,43019,43045,43046,43204,[43232,18],[43302,8],[43335,11],[43392,3],43443,[43446,4],43452,[43561,6],43569,43570,43573,43574,43587,43596,43696,[43698,3],43703,43704,43710,43711,43713,44005,44008,44013,64286,[65024,16],[65056,7],66045,[68097,3],68101,68102,[68108,4],[68152,3],68159,69760,69761,[69811,4],69817,69818,[119143,3],[119163,8],[119173,7],[119210,4],[119362,3],[917760,240]],Me:[1160,1161,1758,[8413,4],[8418,3],[42608,3]],Mc:[2307,[2366,3],[2377,4],2382,2434,2435,[2494,3],2503,2504,2507,2508,2519,2563,[2622,3],2691,[2750,3],2761,2763,2764,2818,2819,2878,2880,2887,2888,2891,2892,2903,3006,3007,3009,3010,[3014,3],[3018,3],3031,[3073,3],[3137,4],3202,3203,3262,[3264,5],3271,3272,3274,3275,3285,3286,3330,3331,[3390,3],[3398,3],[3402,3],3415,3458,3459,[3535,3],[3544,8],3570,3571,3902,3903,3967,4139,4140,4145,4152,4155,4156,4182,4183,[4194,3],[4199,7],4227,4228,[4231,6],4239,[4250,3],6070,[6078,8],6087,6088,[6435,4],[6441,3],6448,6449,[6451,6],[6576,17],6600,6601,[6681,3],6741,6743,6753,6755,6756,[6765,6],6916,6965,6971,[6973,5],6979,6980,7042,7073,7078,7079,7082,[7204,8],7220,7221,7393,7410,43043,43044,43047,43136,43137,[43188,16],43346,43347,43395,43444,43445,43450,43451,[43453,4],43567,43568,43571,43572,43597,43643,44003,44004,44006,44007,44009,44010,44012,69762,[69808,3],69815,69816,119141,119142,[119149,6]],Nl:[[5870,3],[8544,35],[8581,4],12295,[12321,9],[12344,3],[42726,10],[65856,53],66369,66378,[66513,5],[74752,99]],Zl:[8232],Zp:[8233],Cs:[55296,56191,56192,56319,56320,57343],Co:[57344,63743,983040,1048573,1048576,1114109],digits:[[48,10],178,179,185,[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3558,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[4969,9],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[9312,9],[9332,9],[9352,9],9450,[9461,9],9471,[10102,9],[10112,9],[10122,9],[42528,10],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],[65296,10],[66720,10],[68160,4],[68912,10],[69216,9],[69714,9],[69734,10],[69872,10],[69942,10],[70096,10],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,10],[71904,10],[72784,10],[73040,10],[73120,10],[92768,10],[93008,10],[120782,50],[123200,10],[123632,10],[125264,10],[127232,11]],numeric:[[48,10],178,179,185,[188,3],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2548,6],[2662,10],[2790,10],[2918,10],[2930,6],[3046,13],[3174,10],[3192,7],[3302,10],[3416,7],[3430,19],[3558,10],[3664,10],[3792,10],[3872,20],[4160,10],[4240,10],[4969,20],[5870,3],[6112,10],[6128,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[8528,51],[8581,5],[9312,60],[9450,22],[10102,30],11517,12295,[12321,9],[12344,3],[12690,4],[12832,10],[12872,8],[12881,15],[12928,10],[12977,15],13317,13443,14378,15181,19968,19971,19975,19977,20061,20108,20116,20118,20159,20160,20191,20200,20237,20336,20740,20806,[20841,3,2],21313,[21315,3],21324,[21441,4],22235,22769,22777,24186,24318,24319,[24332,3],24336,25342,25420,26578,28422,29590,30334,32902,33836,36014,36019,36144,38433,38470,38476,38520,38646,[42528,10],[42726,10],[43056,6],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],63851,63859,63864,63922,63953,63955,63997,[65296,10],[65799,45],[65856,57],65930,65931,[66273,27],[66336,4],66369,66378,[66513,5],[66720,10],[67672,8],[67705,7],[67751,9],[67835,5],[67862,6],68028,68029,[68032,16],[68050,46],[68160,9],68221,68222,[68253,3],[68331,5],[68440,8],[68472,8],[68521,7],[68858,6],[68912,10],[69216,31],[69405,10],[69457,4],[69714,30],[69872,10],[69942,10],[70096,10],[70113,20],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,12],[71904,19],[72784,29],[73040,10],[73120,10],[73664,21],[74752,111],[92768,10],[93008,10],[93019,7],[93824,23],[119520,20],[119648,25],[120782,50],[123200,10],[123632,10],[125127,9],[125264,10],[126065,59],[126125,3],[126129,4],[126209,45],[126255,15],[127232,13],131073,131172,131298,131361,133418,133507,133516,133532,133866,133885,133913,140176,141720,146203,156269,194704],Cn:[[888,2],[896,4],[907,1],[909,1],[930,1],[1328,1],[1367,2],[1419,2],[1424,1],[1480,8],[1515,4],[1525,11],[1565,1],[1806,1],[1867,2],[1970,14],[2043,2],[2094,2],[2111,1],[2140,2],[2143,1],[2155,53],[2229,1],[2238,21],[2436,1],[2445,2],[2449,2],[2473,1],[2481,1],[2483,3],[2490,2],[2501,2],[2505,2],[2511,8],[2520,4],[2526,1],[2532,2],[2559,2],[2564,1],[2571,4],[2577,2],[2601,1],[2609,1],[2612,1],[2615,1],[2618,2],[2621,1],[2627,4],[2633,2],[2638,3],[2642,7],[2653,1],[2655,7],[2679,10],[2692,1],[2702,1],[2706,1],[2729,1],[2737,1],[2740,1],[2746,2],[2758,1],[2762,1],[2766,2],[2769,15],[2788,2],[2802,7],[2816,1],[2820,1],[2829,2],[2833,2],[2857,1],[2865,1],[2868,1],[2874,2],[2885,2],[2889,2],[2894,8],[2904,4],[2910,1],[2916,2],[2936,10],[2948,1],[2955,3],[2961,1],[2966,3],[2971,1],[2973,1],[2976,3],[2981,3],[2987,3],[3002,4],[3011,3],[3017,1],[3022,2],[3025,6],[3032,14],[3067,5],[3085,1],[3089,1],[3113,1],[3130,3],[3141,1],[3145,1],[3150,7],[3159,1],[3163,5],[3172,2],[3184,7],[3213,1],[3217,1],[3241,1],[3252,1],[3258,2],[3269,1],[3273,1],[3278,7],[3287,7],[3295,1],[3300,2],[3312,1],[3315,13],[3332,1],[3341,1],[3345,1],[3397,1],[3401,1],[3408,4],[3428,2],[3456,2],[3460,1],[3479,3],[3506,1],[3516,1],[3518,2],[3527,3],[3531,4],[3541,1],[3543,1],[3552,6],[3568,2],[3573,12],[3643,4],[3676,37],[3715,1],[3717,1],[3723,1],[3748,1],[3750,1],[3774,2],[3781,1],[3783,1],[3790,2],[3802,2],[3808,32],[3912,1],[3949,4],[3992,1],[4029,1],[4045,1],[4059,37],[4294,1],[4296,5],[4302,2],[4681,1],[4686,2],[4695,1],[4697,1],[4702,2],[4745,1],[4750,2],[4785,1],[4790,2],[4799,1],[4801,1],[4806,2],[4823,1],[4881,1],[4886,2],[4955,2],[4989,3],[5018,6],[5110,2],[5118,2],[5789,3],[5881,7],[5901,1],[5909,11],[5943,9],[5972,12],[5997,1],[6001,1],[6004,12],[6110,2],[6122,6],[6138,6],[6159,1],[6170,6],[6265,7],[6315,5],[6390,10],[6431,1],[6444,4],[6460,4],[6465,3],[6510,2],[6517,11],[6572,4],[6602,6],[6619,3],[6684,2],[6751,1],[6781,2],[6794,6],[6810,6],[6830,2],[6847,65],[6988,4],[7037,3],[7156,8],[7224,3],[7242,3],[7305,7],[7355,2],[7368,8],[7419,5],[7674,1],[7958,2],[7966,2],[8006,2],[8014,2],[8024,1],[8026,1],[8028,1],[8030,1],[8062,2],[8117,1],[8133,1],[8148,2],[8156,1],[8176,2],[8181,1],[8191,1],[8293,1],[8306,2],[8335,1],[8349,3],[8384,16],[8433,15],[8588,4],[9255,25],[9291,21],[11124,2],[11158,2],[11311,1],[11359,1],[11508,5],[11558,1],[11560,5],[11566,2],[11624,7],[11633,14],[11671,9],[11687,1],[11695,1],[11703,1],[11711,1],[11719,1],[11727,1],[11735,1],[11743,1],[11856,48],[11930,1],[12020,12],[12246,26],[12284,4],[12352,1],[12439,2],[12544,5],[12592,1],[12687,1],[12731,5],[12772,12],[12831,1],[19894,10],[40944,16],[42125,3],[42183,9],[42540,20],[42744,8],[42944,2],[42951,48],[43052,4],[43066,6],[43128,8],[43206,8],[43226,6],[43348,11],[43389,3],[43470,1],[43482,4],[43519,1],[43575,9],[43598,2],[43610,2],[43715,24],[43767,10],[43783,2],[43791,2],[43799,9],[43815,1],[43823,1],[43880,8],[44014,2],[44026,6],[55204,12],[55239,4],[55292,4],[64110,2],[64218,38],[64263,12],[64280,5],[64311,1],[64317,1],[64319,1],[64322,1],[64325,1],[64450,17],[64832,16],[64912,2],[64968,40],[65022,2],[65050,6],[65107,1],[65127,1],[65132,4],[65141,1],[65277,2],[65280,1],[65471,3],[65480,2],[65488,2],[65496,2],[65501,3],[65511,1],[65519,10],[65534,2],[65548,1],[65575,1],[65595,1],[65598,1],[65614,2],[65630,34],[65787,5],[65795,4],[65844,3],[65935,1],[65948,4],[65953,47],[66046,130],[66205,3],[66257,15],[66300,4],[66340,9],[66379,5],[66427,5],[66462,1],[66500,4],[66518,42],[66718,2],[66730,6],[66772,4],[66812,4],[66856,8],[66916,11],[66928,144],[67383,9],[67414,10],[67432,152],[67590,2],[67593,1],[67638,1],[67641,3],[67645,2],[67670,1],[67743,8],[67760,48],[67827,1],[67830,5],[67868,3],[67898,5],[67904,64],[68024,4],[68048,2],[68100,1],[68103,5],[68116,1],[68120,1],[68150,2],[68155,4],[68169,7],[68185,7],[68256,32],[68327,4],[68343,9],[68406,3],[68438,2],[68467,5],[68498,7],[68509,12],[68528,80],[68681,55],[68787,13],[68851,7],[68904,8],[68922,294],[69247,129],[69416,8],[69466,134],[69623,9],[69710,4],[69744,15],[69826,11],[69838,2],[69865,7],[69882,6],[69941,1],[69959,9],[70007,9],[70094,2],[70112,1],[70133,11],[70162,1],[70207,65],[70279,1],[70281,1],[70286,1],[70302,1],[70314,6],[70379,5],[70394,6],[70404,1],[70413,2],[70417,2],[70441,1],[70449,1],[70452,1],[70458,1],[70469,2],[70473,2],[70478,2],[70481,6],[70488,5],[70500,2],[70509,3],[70517,139],[70746,1],[70748,1],[70752,32],[70856,8],[70874,166],[71094,2],[71134,34],[71237,11],[71258,6],[71277,19],[71353,7],[71370,54],[71451,2],[71468,4],[71488,192],[71740,100],[71923,12],[71936,160],[72104,2],[72152,2],[72165,27],[72264,8],[72355,29],[72441,263],[72713,1],[72759,1],[72774,10],[72813,3],[72848,2],[72872,1],[72887,73],[72967,1],[72970,1],[73015,3],[73019,1],[73022,1],[73032,8],[73050,6],[73062,1],[73065,1],[73103,1],[73106,1],[73113,7],[73130,310],[73465,199],[73714,13],[74650,102],[74863,1],[74869,11],[75076,2748],[78895,1],[78905,4039],[83527,8633],[92729,7],[92767,1],[92778,4],[92784,96],[92910,2],[92918,10],[92998,10],[93018,1],[93026,1],[93048,5],[93072,688],[93851,101],[94027,4],[94088,7],[94112,64],[94180,28],[100344,8],[101107,9485],[110879,49],[110931,17],[110952,8],[111356,2308],[113771,5],[113789,3],[113801,7],[113818,2],[113828,4956],[119030,10],[119079,2],[119273,23],[119366,154],[119540,12],[119639,9],[119673,135],[119893,1],[119965,1],[119968,2],[119971,2],[119975,2],[119981,1],[119994,1],[119996,1],[120004,1],[120070,1],[120075,2],[120085,1],[120093,1],[120122,1],[120127,1],[120133,1],[120135,3],[120145,1],[120486,2],[120780,2],[121484,15],[121504,1],[121520,1360],[122887,1],[122905,2],[122914,1],[122917,1],[122923,213],[123181,3],[123198,2],[123210,4],[123216,368],[123642,5],[123648,1280],[125125,2],[125143,41],[125260,4],[125274,4],[125280,785],[126133,76],[126270,194],[126468,1],[126496,1],[126499,1],[126501,2],[126504,1],[126515,1],[126520,1],[126522,1],[126524,6],[126531,4],[126536,1],[126538,1],[126540,1],[126544,1],[126547,1],[126549,2],[126552,1],[126554,1],[126556,1],[126558,1],[126560,1],[126563,1],[126565,2],[126571,1],[126579,1],[126584,1],[126589,1],[126591,1],[126602,1],[126620,5],[126628,1],[126634,1],[126652,52],[126706,270],[127020,4],[127124,12],[127151,2],[127168,1],[127184,1],[127222,10],[127245,3],[127341,3],[127405,57],[127491,13],[127548,4],[127561,7],[127570,14],[127590,154],[128726,10],[128749,3],[128763,5],[128884,12],[128985,7],[129004,20],[129036,4],[129096,8],[129114,6],[129160,8],[129198,82],[129292,1],[129394,1],[129399,3],[129443,2],[129451,3],[129483,2],[129620,12],[129646,2],[129652,4],[129659,5],[129667,13],[129686,1386],[173783,41],[177973,11],[178206,2],[183970,14],[191457,3103],[195102,722403],[917506,30],[917632,128],[918e3,65040],[1048574,2]]},$B.unicode_casefold={223:[115,115],304:[105,775],329:[700,110],496:[106,780],912:[953,776,769],944:[965,776,769],1415:[1381,1410],7830:[104,817],7831:[116,776],7832:[119,778],7833:[121,778],7834:[97,702],7838:[223],8016:[965,787],8018:[965,787,768],8020:[965,787,769],8022:[965,787,834],8064:[7936,953],8065:[7937,953],8066:[7938,953],8067:[7939,953],8068:[7940,953],8069:[7941,953],8070:[7942,953],8071:[7943,953],8072:[8064],8073:[8065],8074:[8066],8075:[8067],8076:[8068],8077:[8069],8078:[8070],8079:[8071],8080:[7968,953],8081:[7969,953],8082:[7970,953],8083:[7971,953],8084:[7972,953],8085:[7973,953],8086:[7974,953],8087:[7975,953],8088:[8080],8089:[8081],8090:[8082],8091:[8083],8092:[8084],8093:[8085],8094:[8086],8095:[8087],8096:[8032,953],8097:[8033,953],8098:[8034,953],8099:[8035,953],8100:[8036,953],8101:[8037,953],8102:[8038,953],8103:[8039,953],8104:[8096],8105:[8097],8106:[8098],8107:[8099],8108:[8100],8109:[8101],8110:[8102],8111:[8103],8114:[8048,953],8115:[945,953],8116:[940,953],8118:[945,834],8119:[945,834,953],8124:[8115],8130:[8052,953],8131:[951,953],8132:[942,953],8134:[951,834],8135:[951,834,953],8140:[8131],8146:[953,776,768],8147:[953,776,769],8150:[953,834],8151:[953,776,834],8162:[965,776,768],8163:[965,776,769],8164:[961,787],8166:[965,834],8167:[965,776,834],8178:[8060,953],8179:[969,953],8180:[974,953],8182:[969,834],8183:[969,834,953],8188:[8179],64256:[102,102],64257:[102,105],64258:[102,108],64259:[102,102,105],64260:[102,102,108],64261:[115,116],64262:[115,116],64275:[1396,1398],64276:[1396,1381],64277:[1396,1387],64278:[1406,1398],64279:[1396,1389]},$B.unicode_bidi_whitespace=[9,10,11,12,13,28,29,30,31,32,133,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8287,12288],$B.unicode_identifiers={XID_Start:[95,[65,26],[97,26],170,181,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[880,5],[886,2],[891,3],902,[904,3],908,[910,20],[931,83],[1015,139],[1162,156],[1329,38],1369,[1377,39],[1488,27],[1520,3],[1569,42],[1646,2],[1649,99],1749,[1765,2],[1774,2],[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2036,2],2042,[2048,22],2074,2084,2088,[2308,54],2365,2384,[2392,10],2417,2418,[2425,7],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2493,2510,[2524,2],[2527,3],[2544,2],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2749,2768,[2784,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2877,[2908,2],[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3160,2],[3168,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,[3296,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3424,2],[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,[3648,7],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,4],3762,3773,[3776,5],3782,[3804,2],3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,[4197,2],[4206,3],[4213,13],4238,[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6103,6108,[6176,88],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],6823,[6917,47],[6981,7],[7043,30],[7086,2],[7168,36],[7245,3],[7258,36],[7401,4],[7406,4],[7424,192],[7680,278],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],8305,8319,[8336,5],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,4],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12293,12294,12295,[12321,9],[12337,5],[12344,5],[12353,86],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,16],[42538,2],[42560,32],[42594,13],42623,[42624,24],[42656,80],[42775,9],[42786,103],[42891,2],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],43471,[43520,41],[43584,3],[43588,8],[43616,23],43642,[43648,48],43697,[43701,2],[43705,5],43712,43714,[43739,3],[43968,35],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],65137,65139,65143,65145,65147,65149,[65151,126],[65313,26],[65345,26],[65382,56],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[74752,99],[77824,1071],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[131072,42711],[173824,4149],[194560,542]],XID_Continue:[[48,10],[65,26],95,[97,26],170,181,183,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[768,117],[886,2],[891,3],902,903,[904,3],908,[910,20],[931,83],[1015,139],[1155,5],[1162,156],[1329,38],1369,[1377,39],[1425,45],1471,[1473,2],[1476,2],1479,[1488,27],[1520,3],[1552,11],[1569,62],[1632,10],[1646,102],1749,[1750,7],[1759,10],[1770,19],1791,1808,1809,[1810,57],[1869,101],[1984,54],2042,[2048,46],[2304,58],2364,2365,[2366,17],2384,[2385,5],[2392,12],[2406,10],2417,2418,[2425,7],2433,[2434,2],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2492,2493,[2494,7],[2503,2],[2507,4],2519,[2524,2],[2527,5],[2534,12],[2561,3],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],2620,[2622,5],[2631,2],[2635,3],2641,[2649,4],2654,[2662,16],[2689,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2748,2749,[2750,8],[2759,3],[2763,3],2768,[2784,4],[2790,10],2817,[2818,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2876,2877,2878,2879,2880,[2881,4],[2887,2],[2891,3],2902,2903,[2908,2],[2911,5],[2918,10],2929,2946,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],[3006,5],[3014,3],[3018,4],3024,3031,[3046,10],[3073,3],[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3134,7],[3142,3],[3146,4],[3157,2],[3160,2],[3168,4],[3174,10],[3202,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3260,3261,3262,3263,[3264,5],3270,[3271,2],[3274,4],[3285,2],3294,[3296,4],[3302,10],[3330,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3390,7],[3398,3],[3402,4],3415,[3424,4],[3430,10],[3450,6],[3458,2],[3461,18],[3482,24],[3507,9],3517,[3520,7],3530,[3535,6],3542,[3544,8],[3570,2],[3585,58],[3648,15],[3664,10],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,13],[3771,3],[3776,5],3782,[3784,6],[3792,10],[3804,2],3840,[3864,2],[3872,10],3893,3895,3897,[3902,10],[3913,36],[3953,20],[3974,6],[3984,8],[3993,36],4038,[4096,74],[4176,78],[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],4959,[4969,9],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,7],[5920,21],[5952,20],[5984,13],[5998,3],[6002,2],[6016,52],6070,[6071,29],6103,6108,6109,[6112,10],[6155,3],[6160,10],[6176,88],[6272,43],[6320,70],[6400,29],[6432,12],[6448,12],[6470,40],[6512,5],[6528,44],[6576,26],[6608,11],[6656,28],[6688,63],6752,6753,6754,[6755,26],6783,[6784,10],[6800,10],6823,[6912,76],[6992,10],[7019,9],[7040,43],[7086,12],[7168,56],[7232,10],[7245,49],[7376,3],[7380,31],[7424,231],[7677,281],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],[8255,2],8276,8305,8319,[8336,5],[8400,13],8417,[8421,12],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,7],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],[11744,32],12293,12294,12295,[12321,15],[12337,5],[12344,5],[12353,86],[12441,2],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,28],[42560,32],[42594,14],[42620,2],42623,[42624,24],[42656,82],[42775,9],[42786,103],[42891,2],[43003,45],[43072,52],[43136,69],[43216,10],[43232,24],43259,[43264,46],[43312,36],[43360,29],[43392,65],43471,[43472,10],[43520,55],[43584,14],[43600,10],[43616,23],43642,43643,[43648,67],[43739,3],[43968,43],44012,44013,[44016,10],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,64286,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],[65024,16],[65056,7],[65075,2],[65101,3],65137,65139,65143,65145,65147,65149,[65151,126],[65296,10],[65313,26],65343,[65345,26],[65382,89],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],66045,[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[66720,10],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68097,3],[68101,2],[68108,8],[68117,3],[68121,27],[68152,3],68159,[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69760,59],[73728,879],[74752,99],[77824,1071],[119141,5],[119149,6],[119163,8],[119173,7],[119210,4],[119362,3],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[120782,50],[131072,42711],[173824,4149],[194560,542],[917760,240]]},$B.unicode_tables={},$B.unicode)$B.unicode_tables[gc]={},$B.unicode[gc].forEach(function(n){if(Array.isArray(n))for(var o=n[2]||1,l=0,x=n[1];l<x;l+=1)$B.unicode_tables[gc][n[0]+l*o]=!0;else $B.unicode_tables[gc][n]=!0});for(var key in $B.unicode_identifiers){$B.unicode_tables[key]={};for(const n of $B.unicode_identifiers[key])if(Array.isArray(n))for(var i=0;i<n[1];i++)$B.unicode_tables[key][n[0]+i]=!0;else $B.unicode_tables[key][n]=!0}$B.is_unicode_cn=function(n){for(var o=$B.unicode.Cn,l=0,x=o.length;l<x;l++)return n>=o[l][0]&&n<o[l][0]+o[l][1];return!1},function($B){var bltns=$B.InjectBuiltins();eval(bltns);var unicode_tables=$B.unicode_tables,str={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"str"},$is_class:!0,$native:!0};function normalize_start_end(n){if(null===n.start||n.start===_b_.None?n.start=0:n.start<0&&(n.start+=n.self.length,n.start=Math.max(0,n.start)),null===n.end||n.end===_b_.None?n.end=n.self.length:n.end<0&&(n.end+=n.self.length,n.end=Math.max(0,n.end)),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}function reverse(n){return n.split("").reverse().join("")}function check_str(n){if(!_b_.isinstance(n,str))throw _b_.TypeError.$factory("can't convert '"+$B.class_name(n)+"' object to str implicitly")}function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&"s"!=o.type)throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'str'");return n}str.__add__=function(n,o){if("string"!=typeof o)try{return getattr(o,"__radd__")(n)}catch{throw _b_.TypeError.$factory("Can't convert "+$B.class_name(o)+" to str implicitly")}return n+o},str.__contains__=function(n,o){if(!_b_.isinstance(o,str))throw _b_.TypeError.$factory("'in <string>' requires string as left operand, not "+o.__class__);if("string"==typeof o)var l=o.length;else l=_b_.len(o);if(0==l)return!0;if(0==n.length)return 0==l;for(var x=0,B=n.length;x<B;x++)if(n.substr(x,l)==o)return!0;return!1},str.__delitem__=function(){throw _b_.TypeError.$factory("'str' object doesn't support item deletion")},str.__dir__=object.__dir__,str.__eq__=function(n,o){return void 0===o?n===str:_b_.isinstance(o,_b_.str)?o.valueOf()==n.valueOf():_b_.NotImplemented},str.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(void 0!==l.sign)throw _b_.ValueError.$factory("Sign not allowed in string format specifier");return l.precision&&(n=n.substr(0,l.precision)),l.align=l.align||"<",$B.format_width(preformat(n,l),l)},str.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.length),l>=0&&l<n.length)return n.charAt(l);throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.length),B=x.start,D=x.stop,G=x.step,M="",P=null;if(G>0){if(D<=B)return"";for(P=B;P<D;P+=G)M+=n.charAt(P)}else{if(D>=B)return"";for(P=B;P>D;P+=G)M+=n.charAt(P)}return M}if(isinstance(o,_b_.bool))return n.__getitem__(_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")};var prefix=2,suffix=3,mask=2**32-1,str_hash_cache={};function fnv(n){if(0==n.length)return 0;var o=prefix;o=(o^n.charCodeAt(0)<<7)&mask;for(var l=0,x=n.length;l<x;l++)o=(1000003*o^n.charCodeAt(l))&mask;return-1==(o=((o=(o^n.length)&mask)^suffix)&mask)&&(o=-2),o}str.$nb_str_hash_cache=0,str.__hash__=function(n){return void 0!==str_hash_cache[n]?str_hash_cache[n]:(str.$nb_str_hash_cache++,str.$nb_str_hash_cache>1e5&&(str.$nb_str_hash_cache=0,str_hash_cache={}),str_hash_cache[n]=fnv(n))},str.__init__=function(n,o){return n.valueOf=function(){return o},n.toString=function(){return o},_b_.None};var str_iterator=$B.make_iterator_class("str_iterator");str.__iter__=function(n){var o=n.split("");return str_iterator.$factory(o)},str.__len__=function(n){return n.length};var kwarg_key=new RegExp("([^\\)]*)\\)"),NotANumber=function(){this.name="NotANumber"},number_check=function(n){if(!isinstance(n,[_b_.int,_b_.float]))throw new NotANumber},get_char_array=function(n,o){return n<=0?"":new Array(n+1).join(o)},format_padding=function(n,o,l){var x=o.padding;return x?(n=n.toString(),x=parseInt(x,10),l&&(x-=1),o.left?n+get_char_array(x-n.length,o.pad_char):get_char_array(x-n.length,o.pad_char)+n):n},format_int_precision=function(n,o){var l,x=o.precision;return x?(x=parseInt(x,10),"-"===(l=n.__class__===$B.long_int?$B.long_int.to_base(n,10):n.toString())[0]?"-"+get_char_array(x-l.length+1,"0")+l.slice(1):get_char_array(x-l.length,"0")+l):n.toString()},format_float_precision=function(n,o,l,x){var B=l.precision;return isFinite(n)?x(n,B,l,o):(n=n===1/0?"inf":n===-1/0?"-inf":"nan",o?n.toUpperCase():n)},format_sign=function(n,o){if(o.sign){if(n>=0)return"+"}else if(o.space&&n>=0)return" ";return""},str_format=function(n,o){return o.pad_char=" ",format_padding(str.$factory(n),o)},num_format=function(n,o){number_check(n),n=n.__class__===$B.long_int?$B.long_int.to_base(n,10):parseInt(n);var l=format_int_precision(n,o);if("0"===o.pad_char){if(n<0)return l=l.substring(1),"-"+format_padding(l,o,!0);var x=format_sign(n,o);if(""!==x)return x+format_padding(l,o,!0)}return format_padding(format_sign(n,o)+l,o)},repr_format=function(n,o){return o.pad_char=" ",format_padding(repr(n),o)},ascii_format=function(n,o){return o.pad_char=" ",format_padding(ascii(n),o)},_float_helper=function(n,o){return number_check(n),o.precision?(o.precision=parseInt(o.precision,10),validate_precision(o.precision)):o.precision=o.decimal_point?0:6,parseFloat(n)},trailing_zeros=/(.*?)(0+)([eE].*)/,leading_zeros=/\.(0*)/,trailing_dot=/\.$/,validate_precision=function(n){n>20&&(n=20)},floating_point_format=function(n,o,l){if(n=_float_helper(n,l),v=n.toString(),v_len=v.length,dot_idx=v.indexOf("."),dot_idx<0&&(dot_idx=v_len),n<1&&n>-1){var x,B=leading_zeros.exec(v);return(x=B?B[1].length:0)>=4?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):(l.precision=(l.precision||0)+x,format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,M){return G.toFixed(min(M,v_len-dot_idx)+x)}),l))}var D;return dot_idx>l.precision?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(D=trailing_zeros.exec(n))&&(n=D[1].replace(trailing_dot,"")+D[3]),format_padding(n,l)):format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,M){return l.decimal_point?M>v_len&&(l.alternate||(M=v_len)):M=min(v_len-1,6),M<dot_idx&&(M=dot_idx),G.toFixed(M-dot_idx)}),l)},_floating_g_exp_helper=function(n,o,l,x){o&&--o;var B=(n=n.toExponential(o)).lastIndexOf("e");return B>n.length-4&&(n=n.substring(0,B+2)+"0"+n.substring(B+2)),x?n.toUpperCase():n},floating_point_decimal_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(x,B,D){return x=x.toFixed(B),0===B&&D.alternate&&(x+="."),x}),l)},_floating_exp_helper=function(n,o,l,x){var B=(n=n.toExponential(o)).lastIndexOf("e");return B>n.length-4&&(n=n.substring(0,B+2)+"0"+n.substring(B+2)),x?n.toUpperCase():n},floating_point_exponential_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,_floating_exp_helper),l)},signed_hex_format=function(n,o,l){var x;if(number_check(n),x=n.__class__===$B.long_int?$B.long_int.to_base(n,16):(x=parseInt(n)).toString(16),x=format_int_precision(x,l),o&&(x=x.toUpperCase()),"0"===l.pad_char){n<0&&(x=x.substring(1),x="-"+format_padding(x,l,!0));var B=format_sign(n,l);""!==B&&(x=B+format_padding(x,l,!0))}return l.alternate&&(x="-"===x.charAt(0)?o?"-0X"+x.slice(1):"-0x"+x.slice(1):o?"0X"+x:"0x"+x),format_padding(format_sign(n,l)+x,l)},octal_format=function(n,o){var l;if(number_check(n),l=n.__class__===$B.long_int?$B.long_int.to_base(8):(l=parseInt(n)).toString(8),l=format_int_precision(l,o),"0"===o.pad_char){n<0&&(l=l.substring(1),l="-"+format_padding(l,o,!0));var x=format_sign(n,o);""!==x&&(l=x+format_padding(l,o,!0))}return o.alternate&&(l="-"===l.charAt(0)?"-0o"+l.slice(1):"0o"+l),format_padding(l,o)};function series_of_bytes(n,o){if(n.__class__&&n.__class__.$buffer_protocol)for(var l=_b_.iter(n),x=[];;)try{x.push(_b_.next(l))}catch(D){if(D.__class__===_b_.StopIteration){var B=_b_.bytes.$factory(x);return format_padding(_b_.bytes.decode(B,"ascii"),o)}throw D}else try{return bytes_obj=$B.$getattr(n,"__bytes__"),format_padding(_b_.bytes.decode(bytes_obj),o)}catch(D){throw D.__class__===_b_.AttributeError?_b_.TypeError.$factory("%b does not accept '"+$B.class_name(n)+"'"):D}}var single_char_format=function(n,o){if(isinstance(n,str)&&1==n.length)return n;if(isinstance(n,bytes)&&1==n.source.length)n=n.source[0];else try{n=_b_.int.$factory(n)}catch{throw _b_.TypeError.$factory("%c requires int or char")}return format_padding(chr(n),o)},num_flag=function(n,o){"0"!==n||o.padding||o.decimal_point||o.left?o.decimal_point?o.precision=(o.precision||"")+n:o.padding=(o.padding||"")+n:o.pad_char="0"},decimal_point_flag=function(n,o){if(o.decimal_point)throw new UnsupportedChar;o.decimal_point=!0},neg_flag=function(n,o){o.pad_char=" ",o.left=!0},space_flag=function(n,o){o.space=!0},sign_flag=function(n,o){o.sign=!0},alternate_flag=function(n,o){o.alternate=!0},char_mapping={b:series_of_bytes,s:str_format,d:num_format,i:num_format,u:num_format,o:octal_format,r:repr_format,a:ascii_format,g:function(n,o){return floating_point_format(n,!1,o)},G:function(n,o){return floating_point_format(n,!0,o)},f:function(n,o){return floating_point_decimal_format(n,!1,o)},F:function(n,o){return floating_point_decimal_format(n,!0,o)},e:function(n,o){return floating_point_exponential_format(n,!1,o)},E:function(n,o){return floating_point_exponential_format(n,!0,o)},x:function(n,o){return signed_hex_format(n,!1,o)},X:function(n,o){return signed_hex_format(n,!0,o)},c:single_char_format,0:function(n,o){return num_flag("0",o)},1:function(n,o){return num_flag("1",o)},2:function(n,o){return num_flag("2",o)},3:function(n,o){return num_flag("3",o)},4:function(n,o){return num_flag("4",o)},5:function(n,o){return num_flag("5",o)},6:function(n,o){return num_flag("6",o)},7:function(n,o){return num_flag("7",o)},8:function(n,o){return num_flag("8",o)},9:function(n,o){return num_flag("9",o)},"-":neg_flag," ":space_flag,"+":sign_flag,".":decimal_point_flag,"#":alternate_flag},UnsupportedChar=function(){this.name="UnsupportedChar"};str.__mod__=function(n,o){var l,x=n.length,B=0,D=null;_b_.isinstance(o,_b_.tuple)?D=0:l=_b_.getattr(o,"__getitem__",_b_.None);var G="",M=function(ce){++B;var fe=kwarg_key.exec(ce.substring(ie));if(!fe)throw _b_.ValueError.$factory("incomplete format key");var ae=fe[1];ie+=fe[0].length;try{var W=l(ae)}catch(Z){throw"KeyError"===Z.name?Z:_b_.TypeError.$factory("format requires a mapping")}return de(ce,W)},P=function(ce){var fe;if(null===D)fe=o;else if(void 0===(fe=o[D++]))throw _b_.TypeError.$factory("not enough arguments for format string");return de(ce,fe)},de=function(ce,fe){for(var ae={pad_char:" "};;){var W=char_mapping[ce[ie]];try{if(void 0===W)throw new UnsupportedChar;var Z=W(fe,ae);if(void 0!==Z)return Z;++ie}catch(X){if("UnsupportedChar"==X.name)throw invalid_char=ce[ie],void 0===invalid_char?_b_.ValueError.$factory("incomplete format"):_b_.ValueError.$factory("unsupported format character '"+invalid_char+"' (0x"+invalid_char.charCodeAt(0).toString(16)+") at index "+ie);if("NotANumber"===X.name){var R=fe.__class__;throw R=R?R.$infos.__name__:"string"==typeof fe?"str":typeof fe,_b_.TypeError.$factory("%"+ce[ie]+" format: a number is required, not "+R)}throw X}}},ye=0;do{var ie=n.indexOf("%",B);if(ie<0){G+=n.substring(B);break}if(G+=n.substring(B,ie),!(++ie<x))throw _b_.ValueError.$factory("incomplete format");"%"===n[ie]?G+="%":(ye++,"("===n[ie]?(++ie,G+=M(n)):G+=P(n)),B=ie+1}while(B<x);if(null!==D){if(o.length>D)throw _b_.TypeError.$factory("not enough arguments for format string");if(o.length<D)throw _b_.TypeError.$factory("not all arguments converted during string formatting")}else if(0==ye)throw _b_.TypeError.$factory("not all arguments converted during string formatting");return G},str.__mro__=[object],str.__mul__=function(){var n=$B.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null);if(!isinstance(n.other,_b_.int))throw _b_.TypeError.$factory("Can't multiply sequence by non-int of type '"+$B.class_name(n.other)+"'");for(var o="",l=0;l<n.other;l++)o+=n.self.valueOf();return o},str.__ne__=function(n,o){return o!==n.valueOf()},str.__repr__=function(n){var o=n;o=(o=(o=n.replace(/\\/g,"\\\\")).replace(new RegExp("\x07","g"),"\\x07").replace(new RegExp("\b","g"),"\\x08").replace(new RegExp("\v","g"),"\\x0b").replace(new RegExp("\f","g"),"\\x0c").replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r").replace(new RegExp("\t","g"),"\\t")).replace(combining_re,"\u200b$1");for(var l="",x=0;x<o.length;x++)if($B.is_unicode_cn(o.codePointAt(x))){for(var B=o.codePointAt(x).toString(16);B.length<4;)B="0"+B;l+="\\u"+B}else l+=o.charAt(x);if(-1==(o=l).search('"')&&-1==o.search("'"))return"'"+o+"'";if(-1==n.search('"'))return'"'+o+'"';var D=new RegExp("'","g");return"'"+o.replace(D,"\\'")+"'"},str.__setitem__=function(n,o,l){throw _b_.TypeError.$factory("'str' object does not support item assignment")};for(var combining=[],cp=768;cp<=879;cp++)combining.push(String.fromCharCode(cp));var combining_re=new RegExp("("+combining.join("|")+")");str.__str__=function(n){return n.replace(combining_re,"\u200b$1")},str.toString=function(){return"string!"};var $comp_func=function(n,o){return"string"!=typeof o?_b_.NotImplemented:n>o};$comp_func+="";var $comps={">":"gt",">=":"ge","<":"lt","<=":"le"};for(var $op in $comps)eval("str.__"+$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(str);var $notimplemented=function(n,o){throw NotImplementedError.$factory("OPERATOR not implemented for class str")};str.capitalize=function(n){return $B.args("capitalize",1,{self:n},["self"],arguments,{},null,null),0==n.length?"":n.charAt(0).toUpperCase()+n.substr(1)},str.casefold=function(n){$B.args("casefold",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",B=0,D=n.length;B<D;B++)o=n.charCodeAt(B),(l=$B.unicode_casefold[o])?l.forEach(function(G){x+=String.fromCharCode(G)}):x+=n.charAt(B).toLowerCase();return x},str.center=function(){var n=$B.args("center",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null),o=n.self;if(n.width<=o.length)return o;var l=parseInt((n.width-o.length)/2),x=n.fillchar.repeat(l);return(x+=o+x).length<n.width&&(x+=n.fillchar),x},str.count=function(){var n=$B.args("count",4,{self:null,sub:null,start:null,stop:null},["self","sub","start","stop"],arguments,{start:null,stop:null},null,null);if("string"!=typeof n.sub)throw _b_.TypeError.$factory("Can't convert '"+$B.class_name(n.sub)+"' object to str implicitly");var o,l=n.self;if(null!==n.start)o=null!==n.stop?_b_.slice.$factory(n.start,n.stop):_b_.slice.$factory(n.start,n.self.length),l=str.__getitem__.apply(null,[n.self].concat(o));else if(n.self.length+n.sub.length==0)return 1;if(0==n.sub.length)return n.start==n.self.length?1:0==l.length?0:l.length+1;for(var x=0,B=0;B<l.length&&(B=l.indexOf(n.sub,B))>=0;)x++,B+=n.sub.length;return x},str.encode=function(){var n=$B.args("encode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);if("rot13"==n.encoding||"rot_13"==n.encoding){for(var o="",l=0,x=n.self.length;l<x;l++){var B=n.self.charAt(l);o+="a"<=B&&B<="m"||"A"<=B&&B<="M"?String.fromCharCode(String.charCodeAt(B)+13):"m"<B&&B<="z"||"M"<B&&B<="Z"?String.fromCharCode(String.charCodeAt(B)-13):B}return o}return _b_.bytes.__new__(_b_.bytes,n.self,n.encoding,n.errors)},str.endswith=function(){var n=$B.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.suffix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,B=o.length;x<B;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(D.length<=l.length&&l.substr(l.length-D.length)==D)return!0}return!1},str.expandtabs=function(n,o){var l=$B.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),x=$B.$GetInt(l.tabsize),B=0,D=0,G="";if(1==x)return n.replace(/\t/g," ");for(;D<n.length;){var M=n.charAt(D);switch(M){case"\t":for(;B%x>0;)G+=" ",B++;break;case"\r":case"\n":G+=M,B=0;break;default:G+=M,B++}D++}return G},str.find=function(){var n=$B.args("str.find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(check_str(n.sub),normalize_start_end(n),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method");for(var o="",l=n.start;l<n.end;l++)o+=n.self.charAt(l);if(0==n.sub.length&&n.start==n.self.length)return n.self.length;if(o.length+n.sub.length==0)return-1;var x=o.length-n.sub.length;for(l=0;l<=x;l++)if(o.substr(l,n.sub.length)==n.sub)return n.start+l;return-1},$B.parse_format=function(n){var o,l,x,B=n.split(":"),D=[];return 1==B.length?o=n:(o=B[0],x=B.splice(1).join(":")),(B=o.split("!")).length>1&&(o=B[0],l=B[1]),void 0!==o&&(o=o.replace(/\.[_a-zA-Z][_a-zA-Z0-9]*|\[[_a-zA-Z][_a-zA-Z0-9]*\]|\[[0-9]+\]/g,function(G){return D.push(G),""})),{name:o,name_ext:D,conv:l,spec:x||"",string:n}},$B.split_format=function(n){for(var o,l=0,x=n.length,B="",D=[],G=0;l<x;)if("{"==(o=n.charAt(l))&&"{"==n.charAt(l+1))B+="{",l+=2;else if("}"==o&&"}"==n.charAt(l+1))B+="}",l+=2;else if("{"==o){D.push(B);for(var M=l+1,P=1;M<x;)if("{"==n.charAt(M))P++,M++;else if("}"==n.charAt(M)){if(M++,0==--P){var de=n.substring(l+1,M-1),ye=$B.parse_format(de);if(ye.raw_name=ye.name,ye.raw_spec=ye.spec,ye.name||(ye.name=G+"",G++),void 0!==ye.spec){ye.spec=ye.spec.replace(/\{(.*?)\}/g,function(fe,ae){return""==ae?"{"+G+++"}":"{"+ae+"}"})}D.push(ye),B="";break}}else M++;if(P>0)throw ValueError.$factory("wrong format "+n);l=M}else B+=o,l++;return B&&D.push(B),D},str.format=function(n){for(var o,l=$B.args("format",1,{self:null},["self"],arguments,{},"$args","$kw"),x=$B.split_format(l.self),B="",D=0;D<x.length;D++)if("string"!=typeof x[D]){if(void 0!==(o=x[D]).spec){o.spec=o.spec.replace(/\{(.*?)\}/g,function(fe,ae){return/\d+/.exec(ae)?_b_.tuple.__getitem__(l.$args,parseInt(ae)):_b_.dict.__getitem__(l.$kw,ae)})}if(o.name.charAt(0).search(/\d/)>-1)var G=parseInt(o.name),M=_b_.tuple.__getitem__(l.$args,G);else M=_b_.dict.__getitem__(l.$kw,o.name);for(var P=0;P<o.name_ext.length;P++){var de=o.name_ext[P];if("."==de.charAt(0))M=_b_.getattr(M,de.substr(1));else{var ye=de.substr(1,de.length-2);ye.charAt(0).search(/\d/)>-1&&(ye=parseInt(ye)),M=_b_.getattr(M,"__getitem__")(ye)}}"a"==o.conv?M=_b_.ascii(M):"r"==o.conv?M=_b_.repr(M):"s"==o.conv&&(M=_b_.str.$factory(M)),B+=M.$is_class||M.$factory?M.__class__.__format__(M,o.spec):$B.$getattr(M,"__format__")(o.spec)}else B+=x[D];return B},str.format_map=function(n){throw NotImplementedError.$factory("function format_map not implemented yet")},str.index=function(n){var o=str.find.apply(null,arguments);if(-1===o)throw _b_.ValueError.$factory("substring not found");return o},str.isascii=function(n){for(var o=0,l=n.length;o<l;o++)if(n.charCodeAt(o)>127)return!1;return!0},str.isalnum=function(n){$B.args("isalnum",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]||unicode_tables.Nd[o]||unicode_tables.digits[o]||unicode_tables.numeric[o]))return!1;return!0},str.isalpha=function(n){$B.args("isalpha",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]))return!1;return!0},str.isdecimal=function(n){$B.args("isdecimal",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Nd[o])return!1;return n.length>0},str.isdigit=function(n){$B.args("isdigit",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.digits[o])return!1;return n.length>0},str.isidentifier=function(n){if($B.args("isidentifier",1,{self:null},["self"],arguments,{},null,null),0==n.length||void 0===unicode_tables.XID_Start[n.charCodeAt(0)])return!1;for(var o=1,l=n.length;o<l;o++)if(void 0===unicode_tables.XID_Continue[n.charCodeAt(o)])return!1;return!0},str.islower=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,B=n.length;x<B;x++)if(o=n.charCodeAt(x),unicode_tables.Ll[o])l=!0;else if(unicode_tables.Lu[o]||unicode_tables.Lt[o])return!1;return l},str.isnumeric=function(n){$B.args("isnumeric",1,{self:null},["self"],arguments,{},null,null);for(var o=0,l=n.length;o<l;o++)if(!unicode_tables.numeric[n.charCodeAt(o)])return!1;return n.length>0};var unprintable={},unprintable_gc=["Cc","Cf","Co","Cs","Zl","Zp","Zs"];function $re_escape(n){for(var o="[.*+?|()$^",l=0,x=o.length;l<x;l++){var B=new RegExp("\\"+o.charAt(l),"g");n=n.replace(B,"\\"+o.charAt(l))}return n}str.isprintable=function(n){if(0==Object.keys(unprintable).length){for(var o=0;o<unprintable_gc.length;o++){var l=unicode_tables[unprintable_gc[o]];for(var x in l)unprintable[x]=!0}unprintable[32]=!0}$B.args("isprintable",1,{self:null},["self"],arguments,{},null,null),o=0;for(var B=n.length;o<B;o++)if(unprintable[n.charCodeAt(o)])return!1;return!0},str.isspace=function(n){$B.args("isspace",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Zs[o]&&-1==$B.unicode_bidi_whitespace.indexOf(o))return!1;return n.length>0},str.istitle=function(n){return $B.args("istitle",1,{self:null},["self"],arguments,{},null,null),n.length>0&&str.title(n)==n},str.isupper=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,B=n.length;x<B;x++)if(o=n.charCodeAt(x),unicode_tables.Lu[o])l=!0;else if(unicode_tables.Ll[o]||unicode_tables.Lt[o])return!1;return l},str.join=function(){for(var n=$B.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{},null,null),o=_b_.iter(n.iterable),l=[];;)try{var x=_b_.next(o);if(!isinstance(x,str))throw _b_.TypeError.$factory("sequence item 0: expected str instance, "+$B.class_name(x)+" found");l.push(x)}catch(B){if(_b_.isinstance(B,_b_.StopIteration))break;throw B}return l.join(n.self)},str.ljust=function(n){var o=$B.args("ljust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:n+o.fillchar.repeat(o.width-n.length)},str.lower=function(n){return $B.args("lower",1,{self:null},["self"],arguments,{},null,null),n.toLowerCase()},str.lstrip=function(n,o){var l=$B.args("lstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimLeft();for(var x=0;x<l.self.length;x++)if(-1===l.chars.indexOf(l.self.charAt(x)))return l.self.substring(x);return""},str.maketrans=function(){var n=$B.args("maketrans",3,{x:null,y:null,z:null},["x","y","z"],arguments,{y:null,z:null},null,null),o=$B.empty_dict();if(null===n.y&&null===n.z){if(!_b_.isinstance(n.x,_b_.dict))throw _b_.TypeError.$factory("maketrans only argument must be a dict");for(var l=_b_.list.$factory(_b_.dict.items(n.x)),x=0,B=l.length;x<B;x++){var D=l[x][0],G=l[x][1];if(!_b_.isinstance(D,_b_.int)){if(!_b_.isinstance(D,_b_.str)||1!=D.length)throw _b_.TypeError.$factory("dictionary key "+D+" is not int or 1-char string");D=_b_.ord(D)}if(G!==_b_.None&&!_b_.isinstance(G,[_b_.int,_b_.str]))throw _b_.TypeError.$factory("dictionary value "+G+" is not None, integer or string");_b_.dict.$setitem(o,D,G)}return o}if(_b_.isinstance(n.x,_b_.str)&&_b_.isinstance(n.y,_b_.str)){if(n.x.length!==n.y.length)throw _b_.TypeError.$factory("maketrans arguments must be strings or same length");var M={};if(null!==n.z){if(!_b_.isinstance(n.z,_b_.str))throw _b_.TypeError.$factory("maketrans third argument must be a string");for(x=0,B=n.z.length;x<B;x++)M[_b_.ord(n.z.charAt(x))]=!0}for(x=0,B=n.x.length;x<B;x++){var P=_b_.ord(n.x.charAt(x)),de=n.y.charCodeAt(x);_b_.dict.$setitem(o,P,de)}for(var D in M)_b_.dict.$setitem(o,parseInt(D),_b_.None);return o}throw _b_.TypeError.$factory("maketrans arguments must be strings")},str.maketrans.$type="staticmethod",str.partition=function(){var n=$B.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(""==n.sep)throw _b_.ValueError.$factory("empty separator");check_str(n.sep);var o=n.self.indexOf(n.sep);return-1==o?_b_.tuple.$factory([n.self,"",""]):_b_.tuple.$factory([n.self.substring(0,o),n.sep,n.self.substring(o+n.sep.length)])},str.removeprefix=function(){var n=$B.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!_b_.isinstance(n.prefix,str))throw _b_.ValueError.$factory(`prefix should be str, not '${$B.class_name(n.prefix)}'`);return str.startswith(n.self,n.prefix)?n.self.substr(n.prefix.length):n.self.substr(0)},str.removesuffix=function(){var n=$B.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!_b_.isinstance(n.suffix,str))throw _b_.ValueError.$factory(`suffix should be str, not '${$B.class_name(n.prefix)}'`);return n.suffix.length>0&&str.endswith(n.self,n.suffix)?n.self.substr(0,n.self.length-n.suffix.length):n.self.substr(0)},str.replace=function(n,o,l,x){var B=$B.args("replace",4,{self:null,old:null,$$new:null,count:null},["self","old","$$new","count"],arguments,{count:-1},null,null);if(x=B.count,n=B.self,l=B.$$new,check_str(o=B.old),check_str(l),!isinstance(x,[_b_.int,_b_.float]))throw _b_.TypeError.$factory("'"+$B.class_name(x)+"' object cannot be interpreted as an integer");if(isinstance(x,_b_.float))throw _b_.TypeError.$factory("integer argument expected, got float");if(0==x)return n;if(x.__class__==$B.long_int&&(x=parseInt(x.value)),""==o){if(""==l)return n;if(""==n)return l;var D=n.split("");if(x>-1&&D.length>=x){var G=D.slice(x).join("");return l+D.slice(0,x).join(l)+G}return l+D.join(l)+l}D=str.split(n,o,x);var M=n,P=-1;if(0==o.length){M=l;for(var de=0;de<D.length;de++)M+=D[de]+l;return M+G}for(x<0&&(x=M.length);x>0&&!((P=M.indexOf(o,P))<0);)M=M.substr(0,P)+l+M.substr(P+o.length),P+=l.length,x--;return M},str.rfind=function(n,o){if(2==arguments.length&&"string"==typeof o)return n.lastIndexOf(o);var l=$B.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(normalize_start_end(l),check_str(l.sub),0==l.sub.length)return l.start>l.self.length?-1:l.self.length;for(var x=l.sub.length,B=l.end-x;B>=l.start;B--)if(l.self.substr(B,x)==l.sub)return B;return-1},str.rindex=function(){var n=str.rfind.apply(null,arguments);if(-1==n)throw _b_.ValueError.$factory("substring not found");return n},str.rjust=function(n){var o=$B.args("rjust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:o.fillchar.repeat(o.width-n.length)+n},str.rpartition=function(n,o){var l=$B.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);check_str(l.sep),n=reverse(l.self),o=reverse(l.sep);for(var x=str.partition(n,o).reverse(),B=0;B<x.length;B++)x[B]=x[B].split("").reverse().join("");return x},str.rsplit=function(n){var o=$B.args("rsplit",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),l=o.sep,x=reverse(o.self),B=l===_b_.None?l:reverse(o.sep),D=str.split(x,B,o.maxsplit);D.reverse();for(var G=0;G<D.length;G++)D[G]=reverse(D[G]);return D},str.rstrip=function(n,o){var l=$B.args("rstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimRight();for(var x=l.self.length-1;x>=0;x--)if(-1==l.chars.indexOf(l.self.charAt(x)))return l.self.substring(0,x+1);return""},str.split=function(){var n=$B.args("split",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),o=n.sep,l=n.maxsplit,x=n.self,B=0;if(l.__class__===$B.long_int&&(l=parseInt(l.value)),""==o)throw _b_.ValueError.$factory("empty separator");if(o===_b_.None){for(var D=[];B<x.length&&x.charAt(B).search(/\s/)>-1;)B++;if(B===x.length-1)return[x];for(var G="";;){if(-1==x.charAt(B).search(/\s/))""==G?G=x.charAt(B):G+=x.charAt(B);else if(""!==G){if(D.push(G),-1!==l&&D.length==l+1)return D.pop(),D.push(G+x.substr(B)),D;G=""}if(++B>x.length-1){G&&D.push(G);break}}return D}D=[];var M="",P=o.length;if(0==l)return[x];for(;B<x.length;)if(x.substr(B,P)==o){if(D.push(M),B+=P,l>-1&&D.length>=l)return D.push(x.substr(B)),D;M=""}else M+=x.charAt(B),B++;return D.push(M),D},str.splitlines=function(n){var o=$B.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!_b_.isinstance(o.keepends,[_b_.bool,_b_.int]))throw _b_.TypeError("integer argument expected, got "+$B.get_class(o.keepends).__name);var l=_b_.int.$factory(o.keepends),x=[],B=0,D=0;if(!(n=o.self).length)return x;for(;D<n.length;)"\r\n"==n.substr(D,2)?(x.push(n.slice(B,l?D+2:D)),B=D+=2):"\r"==n[D]||"\n"==n[D]?(x.push(n.slice(B,l?D+1:D)),B=D+=1):D++;return B<n.length&&x.push(n.slice(B)),x},str.startswith=function(){var n=$B.args("startswith",4,{self:null,prefix:null,start:null,end:null},["self","prefix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.prefix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,B=o.length;x<B;x++){var D=o[x];if(!_b_.isinstance(D,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(l.substr(0,D.length)==D)return!0}return!1},str.strip=function(){var n=$B.args("strip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(n.chars===_b_.None)return n.self.trim();for(var o=0;o<n.self.length&&-1!=n.chars.indexOf(n.self.charAt(o));o++);for(var l=n.self.length-1;l>=o&&-1!=n.chars.indexOf(n.self.charAt(l));l--);return n.self.substring(o,l+1)},str.swapcase=function(n){$B.args("swapcase",1,{self:n},["self"],arguments,{},null,null);for(var o,l="",x=0,B=n.length;x<B;x++)o=n.charCodeAt(x),l+=unicode_tables.Ll[o]?n.charAt(x).toUpperCase():unicode_tables.Lu[o]?n.charAt(x).toLowerCase():n.charAt(x);return l},str.title=function(n){$B.args("title",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",B=0,D=n.length;B<D;B++)l=n.charCodeAt(B),unicode_tables.Ll[l]?o?x+=n.charAt(B):(x+=n.charAt(B).toUpperCase(),o="word"):unicode_tables.Lu[l]||unicode_tables.Lt[l]?(x+=o?n.charAt(B).toLowerCase():n.charAt(B),o="word"):(o=null,x+=n.charAt(B));return x},str.translate=function(n,o){for(var l=[],x=$B.$getattr(o,"__getitem__"),B=0,D=n.length;B<D;B++)try{var G=x(n.charCodeAt(B));G!==_b_.None&&("string"==typeof G?l.push(G):"number"==typeof G&&l.push(String.fromCharCode(G)))}catch{l.push(n.charAt(B))}return l.join("")},str.upper=function(n){return $B.args("upper",1,{self:null},["self"],arguments,{},null,null),n.toUpperCase()},str.zfill=function(n,o){var l=$B.args("zfill",2,{self:null,width:null},["self","width"],arguments,{},null,null);if(l.width<=n.length)return n;switch(n.charAt(0)){case"+":case"-":return n.charAt(0)+"0".repeat(l.width-n.length)+n.substr(1);default:return"0".repeat(o-n.length)+n}},str.$factory=function(n,o,l){if(0==arguments.length)return"";if(void 0===n)return $B.UndefinedClass.__str__();if(void 0!==o){var x=$B.args("str",3,{arg:null,encoding:null,errors:null},["arg","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);o=x.encoding,l=x.errors}switch(typeof n){case"string":return str.__str__(n);case"number":if(isFinite(n))return n.toString()}try{if(n.$is_class||n.$factory)return $B.$getattr(n.__class__,"__str__")(n);if(n.__class__&&n.__class__===_b_.bytes&&void 0!==o)return _b_.bytes.decode(n,x.encoding,x.errors);var B=n.__class__||$B.get_class(n);if(void 0===B)return $B.JSObj.__str__($B.JSObj.$factory(n));if(null===(D=$B.$getattr(B,"__str__",null))||n.__class__&&n.__class__!==_b_.object&&D.$infos&&D.$infos.__func__===_b_.object.__str__)var D=$B.$getattr(B,"__repr__")}catch(G){throw console.log("no __str__ for",n),console.log("err ",G),$B.debug>1&&console.log(G),console.log("Warning - no method __str__ or __repr__, default to toString",n),G}return $B.$call(D)(n)},str.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("str.__new__(): not enough arguments");return{__class__:n}},$B.set_func_names(str,"builtins");var StringSubclass=$B.StringSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"str"},$is_class:!0};for(var $attr in str)"function"==typeof str[$attr]&&(StringSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,B=arguments.length;x<B;x++)o[l++]=arguments[x]}return str[n].apply(null,o)}}($attr));function fstring_expression(){this.type="expression",this.expression="",this.conversion=null,this.fmt=null}StringSubclass.__new__=function(n){return{__class__:n}},$B.set_func_names(StringSubclass,"builtins"),_b_.str=str,$B.parse_format_spec=function(n){if(""==n)this.empty=!0;else{var o=0,l="<>=^",x="0123456789",B=l.indexOf(n.charAt(0));-1!=B?n.charAt(1)&&-1!=l.indexOf(n.charAt(1))?(this.fill=n.charAt(0),this.align=n.charAt(1),o=2):(this.align=l[B],this.fill=" ",o++):(B=l.indexOf(n.charAt(1)),n.charAt(1)&&-1!=B&&(this.align=l[B],this.fill=n.charAt(0),o=2));var D=n.charAt(o);for("+"!=D&&"-"!=D&&" "!=D||(this.sign=D,o++,D=n.charAt(o)),"#"==D&&(this.alternate=!0,o++,D=n.charAt(o)),"0"==D&&(this.fill="0",-1==B&&(this.align="="),o++,D=n.charAt(o));D&&x.indexOf(D)>-1;)void 0===this.width?this.width=D:this.width+=D,o++,D=n.charAt(o);if(void 0!==this.width&&(this.width=parseInt(this.width)),void 0===this.width&&"{"==D){var G=n.substr(o).search("}");this.width=n.substring(o,G),console.log("width","["+this.width+"]"),o+=G+1}if(","==D&&(this.comma=!0,o++,D=n.charAt(o)),"."==D){if(-1==x.indexOf(n.charAt(o+1)))throw _b_.ValueError.$factory("Missing precision in format spec");for(this.precision=n.charAt(o+1),D=n.charAt(o+=2);D&&x.indexOf(D)>-1;)this.precision+=D,o++,D=n.charAt(o);this.precision=parseInt(this.precision)}if(D&&"bcdeEfFgGnosxX%".indexOf(D)>-1&&(this.type=D,o++,D=n.charAt(o)),o!==n.length)throw _b_.ValueError.$factory("Invalid format specifier: "+n)}this.toString=function(){return(void 0===this.fill?"":_b_.str.$factory(this.fill))+(this.align||"")+(this.sign||"")+(this.alternate?"#":"")+(this.sign_aware?"0":"")+(this.width||"")+(this.comma?",":"")+(this.precision?"."+this.precision:"")+(this.type||"")}},$B.format_width=function(n,o){if(o.width&&n.length<o.width){var l=o.fill||" ",B=o.width-n.length;switch(o.align||"<"){case"<":return n+l.repeat(B);case">":return l.repeat(B)+n;case"=":return"+-".indexOf(n.charAt(0))>-1?n.charAt(0)+l.repeat(B)+n.substr(1):l.repeat(B)+n;case"^":var D=parseInt(B/2);return l.repeat(D)+n+l.repeat(B-D)}}return n},$B.parse_fstring=function(n){for(var o,l=[],x=0,B="",D=null,G=0;x<n.length;)if(null===D)if("{"==(o=n.charAt(x)))"{"==n.charAt(x+1)?(D="string",B="{",x+=2):(D="expression",G=1,x++);else if("}"==o){if(n.charAt(x+1)!=o)throw Error(" f-string: single '}' is not allowed");D="string",B="}",x+=2}else D="string",B=o,x++;else if("string"==D){for(var M=x;M<n.length;)if("{"==(o=n.charAt(M))){if("{"!=n.charAt(M+1)){l.push(B),D="expression",x=M+1;break}B+="{",M+=2}else if("}"==o){if(n.charAt(M+1)!=o)throw Error(" f-string: single '}' is not allowed");B+=o,M+=2}else B+=o,M++;x=M+1}else if("debug"==D){for(;" "==n.charAt(M);)M++;"}"==n.charAt(M)&&(l.push(B),D=null,B="",x=M+1)}else{M=x,G=1;var P=0;for(B=new fstring_expression;M<n.length;)if("{"==(o=n.charAt(M))&&0==P)G++,B.expression+=o,M++;else if("}"==o&&0==P){if(0==(G-=1)){l.push(B),D=null,B="",x=M+1;break}B.expression+=o,M++}else{if("\\"==o)throw Error("f-string expression part cannot include a backslash");if(0==P&&"!"==o&&null===B.fmt&&":}".indexOf(n.charAt(M+2))>-1){if(0==B.expression.length)throw Error("f-string: empty expression not allowed");if(-1=="ars".indexOf(n.charAt(M+1)))throw Error("f-string: invalid conversion character: expected 's', 'r', or 'a'");B.conversion=n.charAt(M+1),M+=2}else if("("==o)P++,B.expression+=o,M++;else if(")"==o)P--,B.expression+=o,M++;else if('"'==o)if('"""'==n.substr(M,3)){if(-1==(ye=n.indexOf('"""',M+3)))throw Error("f-string: unterminated string");var de=n.substring(M,ye+3);de=de.replace("\n","\\n\\"),B.expression+=de,M=ye+3}else{var ye;if(-1==(ye=n.indexOf('"',M+1)))throw Error("f-string: unterminated string");B.expression+=n.substring(M,ye+1),M=ye+1}else if(0==P&&":"==o)B.fmt=!0,B.expression+=o,M++;else if("="==o){var ie=B.expression,ce=ie.charAt(ie.length-1),fe=("()".indexOf(ce)>-1?"\\":"")+ce;if(0==ie.length||"="==n.charAt(M+1)||"=!<>:".search(fe)>-1)B.expression+=o+n.charAt(M+1),M+=2;else{for(tail=o;n.charAt(M+1).match(/\s/);)tail+=n.charAt(M+1),M++;for(l.push(B.expression+tail);ie.match(/\s$/);)ie=ie.substr(0,ie.length-1);B.expression=ie,D="debug",M++}}else B.expression+=o,M++}if(G>0)throw Error("f-string: expected '}'")}return B.length>0&&l.push(B),l};var surrogate=str.$surrogate=$B.make_class("surrogate_string",function(n){for(var o=[],l=0,x=n.length;l<x;l++){var B=n.charCodeAt(l);B>=55296&&B<=56319&&(l++,B=1024*(B-55296)+(n.charCodeAt(l)-56320)+65536),o.push(String.fromCodePoint(B))}return{__class__:str.$surrogate,items:o}});surrogate.__mro__=[str,object],surrogate.__contains__=function(n,o){return str.__contains__(n.items.join(""),o)},surrogate.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.items.length),l>=0&&l<n.items.length)return 2==n.items[l].length?surrogate.$factory(n.items[l]):n.items[l];throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.items.length),B=x.start,D=x.stop,G=x.step,M="",P=null;if(G>0){if(D<=B)return"";for(P=B;P<D;P+=G)M+=n.items[P]}else{if(D>=B)return"";for(P=B;P>D;P+=G)M+=n.items[P]}return M}if(isinstance(o,_b_.bool))return surrogate.__getitem__(n,_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")},surrogate.__hash__=function(n){return str.__hash__(n.items.join(""))},surrogate.__iter__=function(n){return str_iterator.$factory(n.items)},surrogate.__len__=function(n){return n.items.length},surrogate.__repr__=function(n){return str.__repr__(n.items.join(""))},surrogate.__str__=function(n){return str.__str__(n.items.join(""))},$B.set_func_names(surrogate,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var str_hash=_b_.str.__hash__,$N=_b_.None,set_ops=["eq","le","lt","ge","gt","sub","rsub","and","or","xor"];function is_sublist(n,o){for(var l=0,x=n.length;l<x;l++){for(var B=n[l],D=!1,G=0,M=o.length;G<M;G++)if($B.rich_comp("__eq__",B,o[G])){o.splice(G,1),D=!0;break}if(!D)return!1}return!0}dict_view_op={__eq__:function(n,o){return n.length==o.length&&is_sublist(n,o)},__ne__:function(n,o){return!dict_view_op.__eq__(n,o)},__lt__:function(n,o){return n.length<o.length&&is_sublist(n,o)},__gt__:function(n,o){return dict_view_op.__lt__(o,n)},__le__:function(n,o){return n.length<=o.length&&is_sublist(n,o)},__ge__:function(n,o){return dict_view_op.__le__(o,n)},__and__:function(n,o){for(var l=[],x=0,B=n.length;x<B;x++){var D=n[x];flag=!1;for(var G=0,M=o.length;G<M;G++)if($B.rich_comp("__eq__",D,o[G])){o.splice(G,1),l.push(D);break}}return l},__or__:function(n,o){for(var l=n,x=0,B=o.length;x<B;x++){for(var D=o[x],G=!1,M=0,P=n.length;M<P;M++)if($B.rich_comp("__eq__",D,n[M])){o.splice(x,1),G=!0;break}G||l.push(D)}return l}},$B.make_view=function(n){for(var o=$B.make_class(n,function(D,G){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:D,len:D.length,set_like:G}}),l=0,x=set_ops.length;l<x;l++){var B="__"+set_ops[l]+"__";o[B]=function(D){return function(G,M){if(G.set_like)return _b_.set[D](_b_.set.$factory(G),_b_.set.$factory(M));if(M.__class__!==o)return!1;var P=_b_.list.$factory(M);return dict_view_op[D](G.items,P)}}(B)}return o.__iter__=function(D){var G=o.$iterator.$factory(D.items);return G.len_func=D.len_func,G},o.__len__=function(D){return D.len},o.__repr__=function(D){return o.$infos.__name__+"("+_b_.repr(D.items)+")"},$B.set_func_names(o,"builtins"),o};var dict={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"dict"},$is_class:!0,$native:!0};function to_list(n,o){var l=[];if(n.$jsobj){for(var x in l=[],n.$jsobj)if("$"!=x.charAt(0)){var B=n.$jsobj[x];void 0===B?B=_b_.NotImplemented:null===B&&(B=$N),l.push([x,B])}}else if(_b_.isinstance(n,_b_.dict)){for(var D in n.$numeric_dict)l.push([parseFloat(D),n.$numeric_dict[D]]);for(var D in n.$string_dict)l.push([D,n.$string_dict[D]]);for(var D in n.$object_dict)n.$object_dict[D].forEach(function(M){l.push(M)});l.sort(function(G,M){return G[1][1]-M[1][1]}),l=l.map(function(G){return[G[0],G[1][0]]})}return void 0!==o?l.map(function(G){return G[o]}):(l.__class__=_b_.tuple,l.map(function(G){return G.__class__=_b_.tuple,G}))}function dict_iterator_next(n){if(n.len_func()!=n.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(n.counter++,n.counter<n.items.length)return n.items[n.counter];throw _b_.StopIteration.$factory("StopIteration")}dict.$to_obj=function(n){var o={};for(var l in n.$string_dict)o[l]=n.$string_dict[l][0];return o},$B.dict_to_list=to_list;var $copy_dict=function(n,o){var l=to_list(o),x=dict.$setitem;o.$version=o.$version||0;for(var B=o.$version||0,D=0,G=l.length;D<G;D++)if(x(n,l[D][0],l[D][1]),o.$version!=B)throw _b_.RuntimeError.$factory("dict mutated during update")};function rank(n,o,l){var x=n.$object_dict[o];if(void 0!==x)for(var B=0,D=x.length;B<D;B++)if($B.rich_comp("__eq__",l,x[B][0]))return B;return-1}function init_from_list(n,o){for(var l=-1,x=o.length-1,B=dict.__setitem__;l++<x;){var D=o[l];switch(typeof D[0]){case"string":n.$string_dict[D[0]]=[D[1],n.$order++],n.$str_hash[str_hash(D[0])]=D[0],n.$version++;break;case"number":if(0!=D[0]&&1!=D[0]){n.$numeric_dict[D[0]]=[D[1],n.$order++],n.$version++;break}default:B(n,D[0],D[1])}}}dict.__bool__=function(){var n=$B.args("__bool__",1,{self:null},["self"],arguments,{},null,null);return dict.__len__(n.self)>0},dict.__class_getitem__=function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},dict.__contains__=function(){var n=$B.args("__contains__",2,{self:null,key:null},["self","key"],arguments,{},null,null),o=n.self,l=n.key;if(o.$is_namespace&&(l=$B.to_alias(l)),o.$jsobj)return void 0!==o.$jsobj[l];switch(typeof l){case"string":return void 0!==o.$string_dict[l];case"number":return void 0!==o.$numeric_dict[l]}var x=_b_.hash(l);return!(void 0===o.$str_hash[x]||!$B.rich_comp("__eq__",l,o.$str_hash[x]))||!(void 0===o.$numeric_dict[x]||!$B.rich_comp("__eq__",l,x))||rank(o,x,l)>-1},dict.__delitem__=function(){var n=$B.args("__eq__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null),o=n.self,l=n.arg;if(o.$jsobj){if(void 0===o.$jsobj[l])throw _b_.KeyError.$factory(l);return delete o.$jsobj[l],$N}switch(typeof l){case"string":if(void 0===o.$string_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$string_dict[l],delete o.$str_hash[str_hash(l)],o.$version++,$N;case"number":if(void 0===o.$numeric_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$numeric_dict[l],o.$version++,$N}var x,B=_b_.hash(l);if(!((x=rank(o,B,l))>-1))throw _b_.KeyError.$factory(_b_.str.$factory(l));return o.$object_dict[B].splice(x,1),o.$version++,$N},dict.__eq__=function(){var n=$B.args("__eq__",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=n.self,l=n.other;if(!_b_.isinstance(l,dict)||(o.$jsobj&&(o=jsobj2dict(o.$jsobj)),l.$jsobj&&(l=jsobj2dict(l.$jsobj)),dict.__len__(o)!=dict.__len__(l))||o.$string_dict.length!=l.$string_dict.length)return!1;for(var x in o.$numeric_dict)if(l.$numeric_dict.hasOwnProperty(x)){if(!$B.rich_comp("__eq__",l.$numeric_dict[x][0],o.$numeric_dict[x][0]))return!1}else{if(!l.$object_dict.hasOwnProperty(x))return!1;for(var B=!1,D=0,G=(P=l.$object_dict[x]).length;D<G;D++)if($B.rich_comp("__eq__",x,P[D][0])&&$B.rich_comp("__eq__",o.$numeric_dict[x],P[D][1])){B=!0;break}if(!B)return!1}for(var x in o.$string_dict)if(!l.$string_dict.hasOwnProperty(x)||!$B.rich_comp("__eq__",l.$string_dict[x][0],o.$string_dict[x][0]))return!1;for(var M in o.$object_dict){var P=o.$object_dict[M],de=[];if(void 0!==l.$numeric_dict[M]&&de.push([M,l.$numeric_dict[M]]),void 0!==l.$object_dict[M]&&(de=de.concat(l.$object_dict[M])),0==de.length)return!1;D=0;for(var ye=P.length;D<ye;D++){B=!1;for(var ie=P[D][0],ce=P[D][1][0],fe=0,ae=de.length;fe<ae;fe++)if($B.rich_comp("__eq__",ie,de[fe][0])&&$B.rich_comp("__eq__",ce,de[fe][1][0])){B=!0;break}if(!B)return!1}}return!0},dict.__getitem__=function(){var n=$B.args("__getitem__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null);return dict.$getitem(n.self,n.arg)},dict.$getitem=function(n,o){if(n.$jsobj){if(void 0===n.$jsobj[o]){if(n.$jsobj.hasOwnProperty(o))return $B.Undefined;throw _b_.KeyError.$factory(o)}return n.$jsobj[o]}switch(typeof o){case"string":if(void 0!==n.$string_dict[o])return n.$string_dict[o][0];break;case"number":if(void 0!==n.$numeric_dict[o])return n.$numeric_dict[o][0]}var l=_b_.hash(o),x=function(P){return $B.rich_comp("__eq__",o,P)};"object"==typeof o&&(o.$hash=l);var B=n.$str_hash[l];if(void 0!==B&&x(B))return n.$string_dict[B][0];if(void 0!==n.$numeric_dict[l]&&x(l))return n.$numeric_dict[l][0];if(_b_.isinstance(o,_b_.str)){var D=n.$string_dict[o.valueOf()];if(void 0!==D)return D[0]}var G=rank(n,l,o);if(G>-1)return n.$object_dict[l][G][1][0];if(n.__class__!==dict){try{var M=getattr(n.__class__,"__missing__",_b_.None)}catch(P){console.log(P)}if(M!==_b_.None)return M(n,o)}throw _b_.KeyError.$factory(o)},dict.__hash__=_b_.None,dict.__init__=function(n,o,l){var x;if(void 0===o)return $N;if(void 0===l){if("kw"!=o.$nat&&$B.get_class(o)===$B.JSObj){for(var B in o)n.$string_dict[B]=[o[B],n.$order++];return _b_.None}if(o.$jsobj){for(var D in n.$jsobj={},o.$jsobj)n.$jsobj[D]=o.$jsobj[D];return $N}if(Array.isArray(o))return init_from_list(n,o),$N}var G=(x=x||$B.args("dict",1,{self:null},["self"],arguments,{},"first","second")).first;if(G.length>1)throw _b_.TypeError.$factory("dict expected at most 1 argument, got 2");if(1==G.length)if((G=G[0]).__class__===dict)["$string_dict","$str_hash","$numeric_dict","$object_dict"].forEach(function(ce){for(B in G[ce])n[ce][B]=G[ce][B]});else if(_b_.isinstance(G,dict))$copy_dict(n,G);else{var M=$B.$getattr(G,"keys",null);if(null!==M){var P=$B.$getattr(G,"__getitem__",null);if(null!==P){P=$B.$call(P);for(var de=_b_.iter($B.$call(M)());;)try{var ye=P(B=_b_.next(de));dict.__setitem__(n,B,ye)}catch(ce){if(ce.__class__===_b_.StopIteration)break;throw ce}return $N}}Array.isArray(G)||(G=_b_.list.$factory(G)),init_from_list(n,G)}var ie=x.second.$string_dict;for(var D in ie)switch(typeof D){case"string":n.$string_dict[D]=[ie[D][0],n.$order++],n.$str_hash[str_hash(D)]=D;break;case"number":n.$numeric_dict[D]=[ie[D][0],n.$order++];break;default:si(n,D,ie[D][0])}return $N},dict.__iter__=function(n){return _b_.iter(dict.$$keys(n))},dict.__ior__=function(n,o){return dict.update(n,o),n},dict.__len__=function(n){var o=0;if(n.$jsobj){for(var l in n.$jsobj)"$"!=l.charAt(0)&&o++;return o}for(var x in n.$numeric_dict)o++;for(var x in n.$string_dict)o++;for(var B in n.$object_dict)o+=n.$object_dict[B].length;return o},dict.__ne__=function(n,o){return!dict.__eq__(n,o)},dict.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");var o={__class__:n,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0};return n!==dict&&(o.__dict__=$B.empty_dict()),o},dict.__or__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(n);return dict.update(l,o),l},dict.__repr__=function(n){if(n.$jsobj)return dict.__repr__(jsobj2dict(n.$jsobj));if($B.repr.enter(n))return"{...}";var o=[];return to_list(n).forEach(function(l){try{o.push(repr(l[0])+": "+repr(l[1]))}catch(x){throw x}}),$B.repr.leave(n),"{"+o.join(", ")+"}"},dict.__ror__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(o);return dict.update(l,n),l},dict.__setitem__=function(n,o,l){var x=$B.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);return dict.$setitem(x.self,x.key,x.value)},dict.$setitem=function(n,o,l,x){if(n.$jsobj)return n.$from_js&&(l=$B.pyobj2jsobj(l)),n.$jsobj.__class__===_b_.type?(n.$jsobj[o]=l,"__init__"!=o&&"__new__"!=o||(n.$jsobj.$factory=$B.$instance_creator(n.$jsobj))):n.$jsobj[o]=l,$N;switch(typeof o){case"string":return void 0===n.$string_dict&&console.log("pas de string dict",n,o,l),void 0!==n.$string_dict[o]?n.$string_dict[o][0]=l:(n.$string_dict[o]=[l,n.$order++],n.$str_hash[str_hash(o)]=o,n.$version++),$N;case"number":if(void 0!==n.$numeric_dict[o])n.$numeric_dict[o][0]=l;else{var B=!1;if((0==o||1==o)&&void 0!==n.$object_dict[o])for(const ie of n.$object_dict[o])(0==o&&!1===ie[0]||1==o&&!0===ie[0])&&(ie[1][0]=l,B=!0);B||(n.$numeric_dict[o]=[l,n.$order++]),n.$version++}return $N;case"boolean":var D=o?1:0;if(void 0!==n.$numeric_dict[D])return void(n.$numeric_dict[D]=[l,n.$numeric_dict[D][1]]);void 0!==n.$object_dict[D]?n.$object_dict[D].push([o,[l,n.$order++]]):n.$object_dict[D]=[[o,[l,n.$order++]]]}var M=void 0===x?_b_.hash(o):x,P=function(ie){return $B.rich_comp("__eq__",o,ie)};if(void 0!==n.$numeric_dict[M]&&P(M))return n.$numeric_dict[M]=[l,n.$numeric_dict[M][1]],n.$version++,$N;var de=n.$str_hash[M];if(void 0!==de&&P(de))return n.$string_dict[de]=[l,n.$string_dict[de][1]],n.$version++,$N;if(x)return void 0!==n.$object_dict[x]?n.$object_dict[x].push([o,[l,n.$order++]]):n.$object_dict[x]=[[o,[l,n.$order++]]],n.$version++,$N;var ye=rank(n,M,o);return ye>-1?(n.$object_dict[M][ye][1]=[l,n.$object_dict[M][ye][1][1]],$N):(n.$object_dict.hasOwnProperty(M)?n.$object_dict[M].push([o,[l,n.$order++]]):n.$object_dict[M]=[[o,[l,n.$order++]]],n.$version++,$N)},dict.__str__=function(){return dict.__repr__.apply(null,arguments)},$B.make_rmethods(dict),dict.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null).self;if(n.$numeric_dict={},n.$string_dict={},n.$str_hash={},n.$object_dict={},n.$jsobj)for(var o in n.$jsobj)"$"!==o.charAt(0)&&"__class__"!==o&&delete n.$jsobj[o];return n.$version++,n.$order=0,$N},dict.copy=function(n){n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null).self;var o=$B.empty_dict();return $copy_dict(o,n),o},dict.fromkeys=function(){for(var n=$B.args("fromkeys",3,{cls:null,keys:null,value:null},["cls","keys","value"],arguments,{value:_b_.None},null,null),o=n.keys,l=n.value,x=n.cls,B=$B.$call(x)(),D=$B.$iter(o);;)try{var G=_b_.next(D);x===dict?dict.$setitem(B,G,l):$B.$getattr(B,"__setitem__")(G,l)}catch(M){if($B.is_exc(M,[_b_.StopIteration]))return B;throw M}},dict.get=function(){var n=$B.args("get",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null);try{return dict.__getitem__(n.self,n.key)}catch(o){if(_b_.isinstance(o,_b_.KeyError))return n._default;throw o}};var dict_items=$B.make_view("dict_items",!0);dict_items.$iterator=$B.make_iterator_class("dict_itemiterator"),dict.items=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("items() takes no arguments ("+(arguments.length-1)+" given)");for(var l=to_list(n),x=!0,B=0,D=l.length;B<D;B++)try{_b_.hash(l[B][1])}catch{x=!1;break}var G=dict_items.$factory(to_list(n),x);return G.len_func=function(){return dict.__len__(n)},G};var dict_keys=$B.make_view("dict_keys");dict_keys.$iterator=$B.make_iterator_class("dict_keyiterator"),dict.$$keys=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("keys() takes no arguments ("+(arguments.length-1)+" given)");var l=dict_keys.$factory(to_list(n,0),!0);return l.len_func=function(){return dict.__len__(n)},l},dict.pop=function(){var n={},o=$B.args("pop",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:n},null,null),l=o.self,x=o.key,B=o._default;try{var D=dict.__getitem__(l,x);return dict.__delitem__(l,x),D}catch(G){if(G.__class__===_b_.KeyError){if(B!==n)return B;throw G}throw G}},dict.popitem=function(n){try{var o=_b_.next(_b_.iter(dict.items(n)));return dict.__delitem__(n,o[0]),_b_.tuple.$factory(o)}catch(l){if(l.__class__==_b_.StopIteration)throw _b_.KeyError.$factory("'popitem(): dictionary is empty'")}},dict.setdefault=function(){var n=$B.args("setdefault",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null),o=n.self,l=n.key,x=n._default;try{return dict.__getitem__(o,l)}catch(D){if(D.__class__!==_b_.KeyError)throw D;void 0===x&&(x=$N);var B=l.$hash;return l.$hash=void 0,dict.$setitem(o,l,x,B),x}},dict.update=function(n){var o=$B.args("update",1,{self:null},["self"],arguments,{},"args","kw"),l=(n=o.self,o.args),x=o.kw;if(l.length>0){var B=l[0];if(_b_.isinstance(B,dict))B.$jsobj&&(B=jsobj2dict(B.$jsobj)),$copy_dict(n,B);else if(_b_.hasattr(B,"keys"))for(var D=_b_.list.$factory($B.$call($B.$getattr(B,"keys"))()),G=0,M=D.length;G<M;G++){var P=getattr(B,"__getitem__")(D[G]);dict.$setitem(n,D[G],P)}else{var de=_b_.iter(B);for(G=0;;){try{var ye=_b_.next(de)}catch(ie){if(ie.__class__===_b_.StopIteration)break;throw ie}try{key_value=_b_.list.$factory(ye)}catch{throw _b_.TypeError.$factory("cannot convert dictionary update sequence element #"+G+" to a sequence")}if(2!==key_value.length)throw _b_.ValueError.$factory("dictionary update sequence element #"+G+" has length "+key_value.length+"; 2 is required");dict.$setitem(n,key_value[0],key_value[1]),G++}}}return $copy_dict(n,x),n.$version++,$N};var dict_values=$B.make_view("dict_values");dict_values.$iterator=$B.make_iterator_class("dict_valueiterator"),dict.values=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("values() takes no arguments ("+(arguments.length-1)+" given)");to_list(n,1);var l=dict_values.$factory(to_list(n,1),!1);return l.len_func=function(){return dict.__len__(n)},l},dict.$factory=function(){for(var n=dict.__new__(dict),o=[n],l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);return dict.__init__.apply(null,o),n},_b_.dict=dict,$B.set_func_names(dict,"builtins"),dict.__class_getitem__=_b_.classmethod.$factory(dict.__class_getitem__),$B.empty_dict=function(){return{__class__:dict,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0}},dict.fromkeys=_b_.classmethod.$factory(dict.fromkeys),$B.getset_descriptor=$B.make_class("getset_descriptor",function(n,o){return{__class__:$B.getset_descriptor,__doc__:_b_.None,cls:n,attr:o}}),$B.getset_descriptor.__repr__=$B.getset_descriptor.__str__=function(n){return`<attribute '${n.attr}' of '${n.cls.$infos.__name__}' objects>`},$B.set_func_names($B.getset_descriptor,"builtins");var mappingproxy=$B.mappingproxy=$B.make_class("mappingproxy",function(n){if(_b_.isinstance(n,dict))var o=$B.obj_dict(dict.$to_obj(n));else o=$B.obj_dict(n);return o.__class__=mappingproxy,o});for(var attr in mappingproxy.__setitem__=function(){throw _b_.TypeError.$factory("'mappingproxy' object does not support item assignment")},dict)void 0!==mappingproxy[attr]||["__class__","__mro__","__new__","__init__","__delitem__","clear","fromkeys","pop","popitem","setdefault","update"].indexOf(attr)>-1||(mappingproxy[attr]="function"==typeof dict[attr]?function(n){return function(){return dict[n].apply(null,arguments)}}(attr):dict[attr]);function jsobj2dict(n){var o=$B.empty_dict();for(var l in n)if("$"!=l.charAt(0)&&"__class__"!==l)if(null===n[l])o.$string_dict[l]=[_b_.None,o.$order++];else{if(void 0===n[l])continue;o.$string_dict[l]=n[l].$jsobj===n?[o,o.$order++]:[$B.$JS2Py(n[l]),o.$order++]}return o}$B.set_func_names(mappingproxy,"builtins"),$B.obj_dict=function(n,o){var l=n.__class__||$B.get_class(n);if(void 0!==l&&l.$native)throw _b_.AttributeError.$factory(l.__name__+" has no attribute '__dict__'");var x=$B.empty_dict();return x.$jsobj=n,x.$from_js=o,x}}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=self;function B(Q){var be=0,Pe=0,Ge=Q.width||Q.offsetWidth,Ae=Q.height||Q.offsetHeight;for(document;Q.offsetParent;)be+=Q.offsetLeft,Pe+=Q.offsetTop,Q=Q.offsetParent;if(be+=Q.offsetLeft||0,Pe+=Q.offsetTop||0,Q.parentElement){var Xe=B(Q.parentElement);be+=Xe.left,Pe+=Xe.top}return{left:be,top:Pe,width:Ge,height:Ae}}function D(Q){if(Q.type.startsWith("touch"))return(be={}).x=o.int.$factory(Q.touches[0].screenX),be.y=o.int.$factory(Q.touches[0].screenY),be.__getattr__=function(Ae){return this[Ae]},be.__class__="MouseCoords",be;var be,Pe=0,Ge=0;return Q||(Q=x.event),Q.pageX||Q.pageY?(Pe=Q.pageX,Ge=Q.pageY):(Q.clientX||Q.clientY)&&(Pe=Q.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,Ge=Q.clientY+document.body.scrollTop+document.documentElement.scrollTop),(be={}).x=o.int.$factory(Pe),be.y=o.int.$factory(Ge),be.__getattr__=function(Ae){return this[Ae]},be.__class__="MouseCoords",be}n.$isNode=function(Q){return"object"==typeof Node?Q instanceof Node:Q&&"object"==typeof Q&&"number"==typeof Q.nodeType&&"string"==typeof Q.nodeName},n.$isNodeList=function(Q){try{var be=Object.prototype.toString.call(Q),Pe=new RegExp("^\\[object (HTMLCollection|NodeList)\\]$");return"object"==typeof Q&&null!==Pe.exec(be)&&void 0!==Q.length&&(0==Q.length||"object"==typeof Q[0]&&Q[0].nodeType>0)}catch{return!1}};var G=["NONE","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","type","target","currentTarget","eventPhase","bubbles","cancelable","timeStamp","stopPropagation","preventDefault","initEvent"],M=["altKey","altLeft","button","cancelBubble","clientX","clientY","contentOverflow","ctrlKey","ctrlLeft","data","dataFld","dataTransfer","fromElement","keyCode","nextPage","offsetX","offsetY","origin","propertyName","reason","recordset","repeat","screenX","screenY","shiftKey","shiftLeft","source","srcElement","srcFilter","srcUrn","toElement","type","url","wheelDelta","x","y"];n.$isEvent=function(Q){for(var be=!0,Pe=0;Pe<G.length;Pe++)if(void 0===Q[G[Pe]]){be=!1;break}if(be)return!0;for(Pe=0;Pe<M.length;Pe++)if(void 0===Q[M[Pe]])return!1;return!0};var P={1:"ELEMENT",2:"ATTRIBUTE",3:"TEXT",4:"CDATA_SECTION",5:"ENTITY_REFERENCE",6:"ENTITY",7:"PROCESSING_INSTRUCTION",8:"COMMENT",9:"DOCUMENT",10:"DOCUMENT_TYPE",11:"DOCUMENT_FRAGMENT",12:"NOTATION"},de=n.make_class("Attributes",function(Q){return{__class__:de,elt:Q}});de.__contains__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);return Q.self.elt instanceof SVGElement?Q.self.elt.hasAttributeNS(null,Q.key):"function"==typeof Q.self.elt.hasAttribute&&Q.self.elt.hasAttribute(Q.key)},de.__delitem__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(!de.__contains__(Q.self,Q.key))throw o.KeyError.$factory(Q.key);return Q.self.elt instanceof SVGElement?(Q.self.elt.removeAttributeNS(null,Q.key),o.None):"function"==typeof Q.self.elt.hasAttribute?(Q.self.elt.removeAttribute(Q.key),o.None):void 0},de.__getitem__=function(){var Q=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(Q.self.elt instanceof SVGElement&&Q.self.elt.hasAttributeNS(null,Q.key))return Q.self.elt.getAttributeNS(null,Q.key);if("function"==typeof Q.self.elt.hasAttribute&&Q.self.elt.hasAttribute(Q.key))return Q.self.elt.getAttribute(Q.key);throw o.KeyError.$factory(Q.key)},de.__iter__=function(Q){Q.$counter=0;for(var be=Q.elt.attributes,Pe=[],Ge=0;Ge<be.length;Ge++)Pe.push(be[Ge].name);return Q.$items=Pe,Q},de.__next__=function(){var Q=n.args("__next__",1,{self:null},["self"],arguments,{},null,null);if(Q.self.$counter<Q.self.$items.length){var be=Q.self.$items[Q.self.$counter];return Q.self.$counter++,be}throw o.StopIteration.$factory("")},de.__setitem__=function(){var Q=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);if(Q.self.elt instanceof SVGElement&&"function"==typeof Q.self.elt.setAttributeNS)return Q.self.elt.setAttributeNS(null,Q.key,Q.value),o.None;if("function"==typeof Q.self.elt.setAttribute)return Q.self.elt.setAttribute(Q.key,Q.value),o.None;throw o.TypeError.$factory("Can't set attributes on element")},de.__repr__=de.__str__=function(Q){for(var be=Q.elt.attributes,Pe=[],Ge=0;Ge<be.length;Ge++)Pe.push(be[Ge].name+': "'+Q.elt.getAttributeNS(null,be[Ge].name)+'"');return"{"+Pe.join(", ")+"}"},de.get=function(){var Q=n.args("get",3,{self:null,key:null,deflt:null},["self","key","deflt"],arguments,{deflt:o.None},null,null);try{return de.__getitem__(Q.self,Q.key)}catch(be){if(be.__class__===o.KeyError)return Q.deflt;throw be}},de.keys=function(){return de.__iter__.apply(null,arguments)},de.items=function(){for(var Q=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,be=[],Pe=0;Pe<Q.length;Pe++)be.push([Q[Pe].name,Q[Pe].value]);return o.list.__iter__(be)},de.values=function(){for(var Q=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,be=[],Pe=0;Pe<Q.length;Pe++)be.push(Q[Pe].value);return o.list.__iter__(be)},n.set_func_names(de,"<dom>");var ye=n.DOMEvent={__class__:o.type,__mro__:[l],$infos:{__name__:"DOMEvent"}};function ie(Q,be){var Pe=Q.createSVGPoint();return Pe.x=be.x,Pe.y=be.y,Pe.matrixTransform(Q.getScreenCTM().inverse())}ye.__new__=function(Q,be){var Pe=new Event(be);return Pe.__class__=ye,void 0===Pe.preventDefault&&(Pe.preventDefault=function(){Pe.returnValue=!1}),void 0===Pe.stopPropagation&&(Pe.stopPropagation=function(){Pe.cancelBubble=!0}),Pe},ye.__getattribute__=function(Q,be){switch(be){case"__repr__":case"__str__":return function(){return"<DOMEvent object>"};case"x":return D(Q).x;case"y":return D(Q).y;case"data":return null!==Q.dataTransfer?fe.$factory(Q.dataTransfer):n.$JS2Py(Q.data);case"target":if(void 0!==Q.target)return A.$factory(Q.target);case"char":return String.fromCharCode(Q.which);case"svgX":if(Q.target instanceof SVGSVGElement)return Math.floor(ie(Q.target,D(Q)).x);throw o.AttributeError.$factory("event target is not an SVG element");case"svgY":if(Q.target instanceof SVGSVGElement)return Math.floor(ie(Q.target,D(Q)).y);throw o.AttributeError.$factory("event target is not an SVG element")}var Pe=Q[be];if(void 0!==Pe){if("function"==typeof Pe){var Ge=function(){for(var Ae=[],Xe=0;Xe<arguments.length;Xe++)Ae.push(n.pyobj2jsobj(arguments[Xe]));return Pe.apply(Q,arguments)};return Ge.$infos={__name__:Pe.name,__qualname__:Pe.name},Ge}return n.$JS2Py(Pe)}throw o.AttributeError.$factory("object DOMEvent has no attribute '"+be+"'")},ye.$factory=function(Q){return ye.__new__(ye,Q)};var ce=n.$DOMEvent=function(Q){return Q.__class__=ye,Q.$no_dict=!0,void 0===Q.preventDefault&&(Q.preventDefault=function(){Q.returnValue=!1}),void 0===Q.stopPropagation&&(Q.stopPropagation=function(){Q.cancelBubble=!0}),Q};n.set_func_names(ye,"browser");var fe={__class__:o.type,$infos:{__module__:"browser",__name__:"Clipboard"},__getitem__:function(Q,be){return Q.data.getData(be)}};fe.__mro__=[l],fe.__setitem__=function(Q,be,Pe){Q.data.setData(be,Pe)},fe.$factory=function(Q){return{__class__:fe,__dict__:n.empty_dict(),data:Q}},n.set_func_names(fe,"<dom>");var ae=n.OpenFile={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"OpenFile"}};ae.$factory=function(Q,be,Pe){var Ge={__class__:$OpenFileDict,file:Q,reader:new FileReader};return"r"===be?Ge.reader.readAsText(Q,Pe):"rb"===be&&Ge.reader.readAsBinaryString(Q),Ge},ae.__getattr__=function(Q,be){return void 0!==Q["get_"+be]?Q["get_"+be]:Q.reader[be]},ae.__setattr__=function(Q,be,Pe){var Ge=Q.reader;if("on"==be.substr(0,2))Ge.addEventListener(be.substr(2),function(Ae){return Pe(ce(Ae))});else{if("set_"+be in Ge)return Ge["set_"+be](Pe);be in Ge?Ge[be]=Pe:setattr(Ge,be,Pe)}},n.set_func_names(ae,"<dom>");var W={File:function(){},FileReader:function(){}};W.File.__class__=o.type,W.File.__str__=function(){return"<class 'File'>"},W.FileReader.__class__=o.type,W.FileReader.__str__=function(){return"<class 'FileReader'>"};var Z={__class__:o.type,__delitem__:function(Q,be){Q.parent.options.remove(be.elt)},__getitem__:function(Q,be){return A.$factory(Q.parent.options[be])},__len__:function(Q){return Q.parent.options.length},__mro__:[l],__setattr__:function(Q,be,Pe){Q.parent.options[be]=Pe},__setitem__:function(Q,be,Pe){Q.parent.options[be]=n.$JS2Py(Pe)},__str__:function(Q){return"<object Options wraps "+Q.parent.options+">"},append:function(Q,be){Q.parent.options.add(be.elt)},insert:function(Q,be,Pe){void 0===be?Q.parent.options.add(Pe.elt):Q.parent.options.add(Pe.elt,be)},item:function(Q,be){return Q.parent.options.item(be)},namedItem:function(Q,be){return Q.parent.options.namedItem(be)},remove:function(Q,be){Q.parent.options.remove(be.elt)},$infos:{__module__:"<pydom>",__name__:"Options"},$factory:function(Q){return{__class__:Z,parent:Q}}};n.set_func_names(Z,"<dom>");var A={__class__:o.type,__mro__:[l],$infos:{__module__:"browser",__name__:"DOMNode"}};function R(Q){for(var be=[],Pe=0;Pe<Q.length;Pe++)be.push(A.$factory(Q[Pe]));return be}A.$factory=function(Q,be){if(Q.__class__===A||"number"==typeof Q||"boolean"==typeof Q||"string"==typeof Q)return Q;if(void 0===be&&void 0!==A.tags){var Pe=A.tags.$string_dict;if(void 0!==Pe&&Pe.hasOwnProperty(Q.tagName)){try{var Ge=Pe[Q.tagName][0]}catch(Ae){throw console.log("tdict",Pe,"tag name",Q.tagName),Ae}if(void 0!==Ge)return Ge.$elt_wrap=Q,Ge.$factory()}}return void 0!==Q.$brython_id&&9!=Q.nodeType||(Q.$brython_id="DOM-"+n.UUID()),Q},A.__add__=function(Q,be){var Pe=U.$factory();if(Pe.children=[Q],pos=1,o.isinstance(be,U))Pe.children=Pe.children.concat(be.children);else if(o.isinstance(be,[o.str,o.int,o.float,o.list,o.dict,o.set,o.tuple]))Pe.children[pos++]=A.$factory(document.createTextNode(o.str.$factory(be)));else if(o.isinstance(be,A))Pe.children[pos++]=be;else try{Pe.children=Pe.children.concat(o.list.$factory(be))}catch{throw o.TypeError.$factory("can't add '"+n.class_name(be)+"' object to DOMNode instance")}return Pe},A.__bool__=function(Q){return!0},A.__contains__=function(Q,be){if(9==Q.nodeType&&"string"==typeof be)return null!==document.getElementById(be);if(void 0!==Q.length&&"function"==typeof Q.item)for(var Pe=0,Ge=Q.length;Pe<Ge;Pe++)if(Q.item(Pe)===be)return!0;return!1},A.__del__=function(Q){if(!Q.parentNode)throw o.ValueError.$factory("can't delete "+o.str.$factory(Q));Q.parentNode.removeChild(Q)},A.__delattr__=function(Q,be){if(void 0===Q[be])throw o.AttributeError.$factory(`cannot delete DOMNode attribute '${be}'`);return delete Q[be],o.None},A.__delitem__=function(Q,be){if(9==Q.nodeType){var Pe=Q.getElementById(be);if(!Pe)throw o.KeyError.$factory(be);Pe.parentNode.removeChild(Pe)}else Q.parentNode.removeChild(Q)},A.__dir__=function(Q){var be=[];for(var Pe in Q)"$"!=Pe.charAt(0)&&be.push(Pe);return be.sort(),be},A.__eq__=function(Q,be){return Q==be},A.__getattribute__=function(Q,be){switch("$$"==be.substr(0,2)&&(be=be.substr(2)),be){case"attrs":return de.$factory(Q);case"class_name":case"html":case"id":case"parent":case"text":return A[be](Q);case"height":case"left":case"top":case"width":if("CANVAS"==Q.tagName&&Q[be])return Q[be];if(Q instanceof SVGElement)return Q[be].baseVal.value;if(Q.style[be])return parseInt(Q.style[be]);var Pe=window.getComputedStyle(Q)[be];if(void 0!==Pe)return Math.floor(parseFloat(Pe)+.5);throw o.AttributeError.$factory("style."+be+" is not set for "+o.str.$factory(Q));case"x":case"y":if(!(Q instanceof SVGElement)){var Ge=B(Q);return"x"==be?Ge.left:Ge.top}case"clear":case"closest":return function(){return A[be](Q,arguments[0])};case"headers":if(9==Q.nodeType){var Ae=new XMLHttpRequest;Ae.open("GET",document.location,!1),Ae.send(null);var Xe=Ae.getAllResponseHeaders();Xe=Xe.split("\r\n");for(var Ke=n.empty_dict(),yt=0;yt<Xe.length;yt++){var dt=Xe[yt];0!=dt.strip().length&&(Ge=dt.search(":"),Ke.__setitem__(dt.substr(0,Ge),dt.substr(Ge+1).lstrip()))}return Ke}break;case"$$location":be="location"}if("select"==be&&1==Q.nodeType&&["INPUT","TEXTAREA"].indexOf(Q.tagName.toUpperCase())>-1)return function(dn){return void 0===dn?(Q.select(),o.None):A.select(Q,dn)};if("query"==be&&9==Q.nodeType){Ke={__class__:X,_keys:[],_values:{}};var It=location.search.substr(1).split("&");if(""!=location.search)for(yt=0;yt<It.length;yt++){Ge=It[yt].search("=");var wt=[It[yt].substr(0,Ge),It[yt].substr(Ge+1)],Gt=decodeURIComponent(wt[0]),Dt=decodeURIComponent(wt[1]);Ke._keys.indexOf(Gt)>-1?Ke._values[Gt].push(Dt):(Ke._keys.push(Gt),Ke._values[Gt]=[Dt])}return Ke}var dn,On,sn=Q[be];if(void 0===sn&&n.aliased_names[be]&&(sn=Q["$$"+be]),void 0===sn){if(Q.tagName){var gt=customElements.get(Q.tagName.toLowerCase());if(void 0!==gt&&void 0!==gt.$cls){var An=Q.__class__;Q.__class__=gt.$cls;try{return Ke=o.object.__getattribute__(Q,be),Q.__class__=An,Ke}catch(dn){if(Q.__class__=An,!n.is_exc(dn,[o.AttributeError]))throw dn}}}return l.__getattribute__(Q,be)}if(void 0!==(Ke=sn)){if(null===Ke)return o.None;if("function"==typeof Ke){var Bn=(dn=Ke,On=Q,function(){for(var Ln=[],mn=0,cr=0;cr<arguments.length;cr++){var rr=arguments[cr];if("function"==typeof rr){if(rr.$cache)var ur=rr.$cache;else ur=function(ni){return function(){try{return ni.apply(null,arguments)}catch(Kr){n.handle_error(Kr)}}}(rr),rr.$cache=ur;Ln[mn++]=ur}else o.isinstance(rr,A)?Ln[mn++]=rr:Ln[mn++]=rr===o.None?null:rr.__class__==o.dict?o.dict.$to_obj(rr):rr}var or=dn.apply(On,Ln);return n.$JS2Py(or)});return Bn.$infos={__name__:be,__qualname__:be},Bn.$is_func=!0,Bn}return"options"==be?Z.$factory(Q):"style"==be?n.JSObj.$factory(Q[be]):Array.isArray(Ke)?Ke:n.$JS2Py(Ke)}return l.__getattribute__(Q,be)},A.__getitem__=function(Q,be){if(9==Q.nodeType){if("string"==typeof be){if(Ge=Q.getElementById(be))return A.$factory(Ge);throw o.KeyError.$factory(be)}try{for(var Pe=Q.getElementsByTagName(be.$infos.__name__),Ge=[],Ae=0;Ae<Pe.length;Ae++)Ge.push(A.$factory(Pe[Ae]));return Ge}catch{throw o.KeyError.$factory(o.str.$factory(be))}}else{if(("number"==typeof be||"boolean"==typeof be)&&"function"==typeof Q.item){var Xe=o.int.$factory(be);if(Xe<0&&(Xe+=Q.length),void 0===(Ge=A.$factory(Q.item(Xe))))throw o.KeyError.$factory(be);return Ge}if("string"==typeof be&&Q.attributes&&"function"==typeof Q.attributes.getNamedItem){var Ke=Q.attributes.getNamedItem(be);if(Ke)return Ke.value;throw o.KeyError.$factory(be)}}},A.__hash__=function(Q){return void 0===Q.__hashvalue__?Q.__hashvalue__=n.$py_next_hash--:Q.__hashvalue__},A.__iter__=function(Q){if(void 0!==Q.length&&"function"==typeof Q.item)for(var be=[],Pe=0,Ge=Q.length;Pe<Ge;Pe++)be.push(A.$factory(Q.item(Pe)));else if(void 0!==Q.childNodes)for(be=[],Pe=0,Ge=Q.childNodes.length;Pe<Ge;Pe++)be.push(A.$factory(Q.childNodes[Pe]));return n.$iter(be)},A.__le__=function(Q,be){if(9==Q.nodeType&&(Q=Q.body),o.isinstance(be,U))for(var Pe=0;Pe<be.children.length;Pe++)Q.appendChild(be.children[Pe]);else if("string"==typeof be||"number"==typeof be){var Ge=document.createTextNode(be.toString());Q.appendChild(Ge)}else if(o.isinstance(be,A))Q.appendChild(be);else try{o.list.$factory(be).forEach(function(Ae){A.__le__(Q,Ae)})}catch{throw o.TypeError.$factory("can't add '"+n.class_name(be)+"' object to DOMNode instance")}return!0},A.__len__=function(Q){return Q.length},A.__mul__=function(Q,be){if(o.isinstance(be,o.int)&&be.valueOf()>0){for(var Pe=U.$factory(),Ge=Pe.children.length,Ae=0;Ae<be.valueOf();Ae++)Pe.children[Ge++]=A.clone(Q)();return Pe}throw o.ValueError.$factory("can't multiply "+Q.__class__+"by "+be)},A.__ne__=function(Q,be){return!A.__eq__(Q,be)},A.__next__=function(Q){if(Q.$counter++,Q.$counter<Q.childNodes.length)return A.$factory(Q.childNodes[Q.$counter]);throw o.StopIteration.$factory("StopIteration")},A.__radd__=function(Q,be){var Pe=U.$factory(),Ge=A.$factory(document.createTextNode(be));return Pe.children=[Ge,Q],Pe},A.__str__=A.__repr__=function(Q){var be=Q.attributes;if(void 0!==be)for(var Pe=[],Ge=0;Ge<be.length;Ge++)Pe.push(be[Ge].name+'="'+Q.getAttributeNS(null,be[Ge].name)+'"');var Ae=Object.getPrototypeOf(Q);if(Ae){var Xe=Ae.constructor.name;if(void 0===Xe){var Ke=Ae.constructor.toString();Xe=Ke.substring(8,Ke.length-1)}return Pe.splice(0,0,Xe),"<"+Pe.join(" ")+">"}return"<DOMNode object type '"+P[Q.nodeType]+"' name '"+Q.nodeName+"'>"},A.__setattr__=function(Q,be,Pe){if("on"!=be.substr(0,2)){let yt=function(dt){console.log(dt);var It=n.last(n.frames_stack);if(n.debug>0){var wt=It[1].$line_info.split(",");console.log("module",wt[1],"line",wt[0]),n.$py_src.hasOwnProperty(wt[1])&&console.log(n.$py_src[wt[1]].split("\n")[parseInt(wt[0])-1])}else console.log("module",It[2])};switch(be){case"left":case"top":case"width":case"height":if(o.isinstance(Pe,o.int)&&1==Q.nodeType)return Q.style[be]=Pe+"px",o.None;throw o.ValueError.$factory(be+" value should be an integer, not "+n.class_name(Pe))}if(void 0!==A["set_"+be])return A["set_"+be](Q,Pe);for(var Ge=Object.getPrototypeOf(Q),Ae=0;Ge&&Ge!==Object.prototype&&Ae++<10;){var Xe=Object.getOwnPropertyDescriptors(Ge);if(!Xe||"function"!=typeof Xe.hasOwnProperty)break;if(Xe.hasOwnProperty(be)){Xe[be].writable||void 0!==Xe[be].set||yt("Warning: property '"+be+"' is not writable. Use element.attrs['"+be+"'] instead.");break}Ge=Object.getPrototypeOf(Ge)}return Q.style&&void 0!==Q.style[be]&&yt("Warning: '"+be+"' is a property of element.style"),Q[be]=Pe,o.None}n.$bool(Pe)?A.bind(Q,be.substr(2),Pe):A.unbind(Q,be.substr(2))},A.__setitem__=function(Q,be,Pe){"number"==typeof be?Q.childNodes[be]=Pe:"string"==typeof be&&Q.attributes&&(Q instanceof SVGElement?Q.setAttributeNS(null,be,Pe):"function"==typeof Q.setAttribute&&Q.setAttribute(be,Pe))},A.abs_left={__get__:function(Q){return B(Q).left},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_left' is read-only")}},A.abs_top={__get__:function(Q){return B(Q).top},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_top' is read-only")}},A.attach=A.__le__,A.bind=function(Q,be){var Pe=n.args("bind",4,{self:null,event:null,func:null,options:null},["self","event","func","options"],arguments,{func:o.None,options:o.None},null,null),Ge=(Q=Pe.self,be=Pe.event,Pe.func),Ae=Pe.options;if(Ge===o.None)return function(yt){return A.bind(Q,be,yt)};var Xe,Ke=(Xe=Ge,function(yt){try{return Xe(ce(yt))}catch(dt){if(void 0!==dt.__class__)n.handle_error(dt);else try{n.$getattr(n.stderr,"write")(dt)}catch{console.log(dt)}}});return Ke.$infos=Ge.$infos,Ke.$attrs=Ge.$attrs||{},Ke.$func=Ge,"boolean"==typeof Ae?Q.addEventListener(be,Ke,Ae):Ae.__class__===o.dict?Q.addEventListener(be,Ke,o.dict.$to_obj(Ae)):Ae===o.None&&Q.addEventListener(be,Ke,!1),Q.$events=Q.$events||{},Q.$events[be]=Q.$events[be]||[],Q.$events[be].push([Ge,Ke]),Q},A.children=function(Q){var be=[];return 9==Q.nodeType&&(Q=Q.body),Q.childNodes.forEach(function(Pe){be.push(A.$factory(Pe))}),be},A.clear=function(Q){for(9==Q.nodeType&&(Q=Q.body);Q.firstChild;)Q.removeChild(Q.firstChild)},A.Class=function(Q){return void 0!==Q.className?Q.className:o.None},A.class_name=function(Q){return A.Class(Q)},A.clone=function(Q){var be=A.$factory(Q.cloneNode(!0)),Pe=Q.$events||{};for(var Ge in Pe)Pe[Ge].forEach(function(Ae){A.bind(be,Ge,Ae[0])});return be},A.closest=function(Q,be){var Pe=Q.closest(be);if(null===Pe)throw o.KeyError.$factory("no parent with selector "+be);return A.$factory(Pe)},A.events=function(Q,be){Q.$events=Q.$events||{};var Pe=Q.$events[be]=Q.$events[be]||[],Ge=[];return Pe.forEach(function(Ae){Ge.push(Ae[1])}),Ge},A.focus=function(Q){return be=Q,function(){setTimeout(function(){be.focus()},10)};var be},A.get=function(Q){for(var be=[],Pe=1;Pe<arguments.length;Pe++)be.push(arguments[Pe]);var Ge=n.args("get",0,{},[],be,{},null,"kw"),Ae={};if(o.list.$factory(o.dict.items(Ge.kw)).forEach(function(Ke){Ae[Ke[0]]=Ke[1]}),void 0!==Ae.name){if(void 0===Q.getElementsByName)throw o.TypeError.$factory("DOMNode object doesn't support selection by name");return R(Q.getElementsByName(Ae.name))}if(void 0!==Ae.tag){if(void 0===Q.getElementsByTagName)throw o.TypeError.$factory("DOMNode object doesn't support selection by tag name");return R(Q.getElementsByTagName(Ae.tag))}if(void 0!==Ae.classname){if(void 0===Q.getElementsByClassName)throw o.TypeError.$factory("DOMNode object doesn't support selection by class name");return R(Q.getElementsByClassName(Ae.classname))}if(void 0!==Ae.id){if(void 0===Q.getElementById)throw o.TypeError.$factory("DOMNode object doesn't support selection by id");var Xe=document.getElementById(Ae.id);return Xe?[A.$factory(Xe)]:[]}if(void 0!==Ae.selector){if(void 0===Q.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return R(Q.querySelectorAll(Ae.selector))}return res},A.getContext=function(Q){if(!("getContext"in Q))throw o.AttributeError.$factory("object has no attribute 'getContext'");return function(be){return n.JSObj.$factory(Q.getContext(be))}},A.getSelectionRange=function(Q){if(void 0!==Q.getSelectionRange)return Q.getSelectionRange.apply(null,arguments)},A.html=function(Q){var be=Q.innerHTML;return void 0===be&&(be=9==Q.nodeType?Q.body.innerHTML:o.None),be},A.id=function(Q){return void 0!==Q.id?Q.id:o.None},A.index=function(Q,be){var Pe;Pe=void 0===be?Q.parentElement.childNodes:Q.parentElement.querySelectorAll(be);for(var Ge=-1,Ae=0;Ae<Pe.length;Ae++)if(Pe[Ae]===Q){Ge=Ae;break}return Ge},A.inside=function(Q,be){for(var Pe=Q;;){if(be===Pe)return!0;if(!(Pe=Pe.parentElement))return!1}},A.options=function(Q){return new $OptionsClass(Q)},A.parent=function(Q){return Q.parentElement?A.$factory(Q.parentElement):o.None},A.reset=function(Q){return function(){Q.reset()}},A.scrolled_left={__get__:function(Q){return B(Q).left-document.scrollingElement.scrollLeft},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_left' is read-only")}},A.scrolled_top={__get__:function(Q){return B(Q).top-document.scrollingElement.scrollTop},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_top' is read-only")}},A.select=function(Q,be){if(void 0===Q.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return R(Q.querySelectorAll(be))},A.select_one=function(Q,be){if(void 0===Q.querySelector)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");var Pe=Q.querySelector(be);return null===Pe?o.None:A.$factory(Pe)},A.style=function(Q){return Q.style.float=Q.style.cssFloat||Q.styleFloat,n.JSObj.$factory(Q.style)},A.setSelectionRange=function(Q){return void 0!==this.setSelectionRange?(be=this,function(){return be.setSelectionRange.apply(be,arguments)}):void 0!==this.createTextRange?(Pe=this,function(Ge,Ae){null==Ae&&(Ae=Ge);var Xe=Pe.createTextRange();Xe.collapse(!0),Xe.moveEnd("character",Ge),Xe.moveStart("character",Ae),Xe.select()}):void 0;var Pe,be},A.set_class_name=function(Q,be){Q.setAttribute("class",be)},A.set_html=function(Q,be){9==Q.nodeType&&(Q=Q.body),Q.innerHTML=o.str.$factory(be)},A.set_style=function(Q,be){if(!o.isinstance(be,o.dict))throw o.TypeError.$factory("style must be dict, not "+n.class_name(be));for(var Pe=o.list.$factory(o.dict.items(be)),Ge=0;Ge<Pe.length;Ge++){var Ae=Pe[Ge][0],Xe=Pe[Ge][1];if("float"==Ae.toLowerCase())Q.style.cssFloat=Xe,Q.style.styleFloat=Xe;else{switch(Ae){case"top":case"left":case"width":case"borderWidth":o.isinstance(Xe,o.int)&&(Xe+="px")}Q.style[Ae]=Xe}}},A.set_text=function(Q,be){9==Q.nodeType&&(Q=Q.body),Q.innerText=o.str.$factory(be),Q.textContent=o.str.$factory(be)},A.set_value=function(Q,be){Q.value=o.str.$factory(be)},A.submit=function(Q){return function(){Q.submit()}},A.text=function(Q){9==Q.nodeType&&(Q=Q.body);var be=Q.innerText||Q.textContent;return null===be&&(be=o.None),be},A.toString=function(Q){return void 0===Q?"DOMNode":Q.nodeName},A.trigger=function(Q,be){if(Q.fireEvent)Q.fireEvent("on"+be);else{var Pe=document.createEvent("Events");Pe.initEvent(be,!0,!1),Q.dispatchEvent(Pe)}},A.unbind=function(Q,be){if(Q.$events=Q.$events||{},Q.$events==={})return o.None;if(void 0===be){for(var be in Q.$events)A.unbind(Q,be);return o.None}if(void 0===Q.$events[be]||0==Q.$events[be].length)return o.None;var Pe=Q.$events[be];if(2==arguments.length){for(var Ge=0;Ge<Pe.length;Ge++){var Ae=Pe[Ge][1];Q.removeEventListener(be,Ae,!1)}return Q.$events[be]=[],o.None}for(Ge=2;Ge<arguments.length;Ge++){var Xe=!1;if(void 0===(dt=(Ae=arguments[Ge]).$func)){for(var Ke=!1,yt=0;yt<Pe.length;yt++)if(Pe[yt][0]===Ae){var dt=Ae;Ke=!0;break}if(!Ke)throw o.TypeError.$factory("function is not an event callback")}for(yt=0;yt<Pe.length;yt++)if(n.$getattr(dt,"__eq__")(Pe[yt][0])){Q.removeEventListener(be,Ae=Pe[yt][1],!1),Pe.splice(yt,1),Xe=!0;break}if(!Xe)throw o.KeyError.$factory("missing callback for event "+be)}},n.set_func_names(A,"browser");var X={__class__:o.type,__mro__:[o.object],$infos:{__name__:"query"},__contains__:function(Q,be){return Q._keys.indexOf(be)>-1},__getitem__:function(Q,be){var Pe=Q._values[be];if(void 0===Pe)throw o.KeyError.$factory(be);return 1==Pe.length?Pe[0]:Pe}},he=n.make_iterator_class("query string iterator");X.__iter__=function(Q){return he.$factory(Q._keys)},X.__setitem__=function(Q,be,Pe){return Q._values[be]=[Pe],o.None},X.__str__=X.__repr__=function(Q){var be=[];for(var Pe in Q._values)for(const Ge of Q._values[Pe])be.push(encodeURIComponent(Pe)+"="+encodeURIComponent(Ge));return 0==be.length?"":"?"+be.join("&")},X.getfirst=function(Q,be,Pe){var Ge=Q._values[be];return void 0===Ge?void 0===Pe?o.None:Pe:Ge[0]},X.getlist=function(Q,be){var Pe=Q._values[be];return void 0===Pe?[]:Pe},X.getvalue=function(Q,be,Pe){try{return X.__getitem__(Q,be)}catch{return void 0===Pe?o.None:Pe}},X.keys=function(Q){return Q._keys},n.set_func_names(X,"<dom>");var U={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"TagSum"},appendChild:function(Q,be){Q.children.push(be)},__add__:function(Q,be){return n.get_class(be)===U?Q.children=Q.children.concat(be.children):o.isinstance(be,[o.str,o.int,o.float,o.dict,o.set,o.list])?Q.children=Q.children.concat(A.$factory(document.createTextNode(be))):Q.children.push(be),Q},__radd__:function(Q,be){var Pe=U.$factory();return Pe.children=Q.children.concat(A.$factory(document.createTextNode(be))),Pe},__repr__:function(Q){for(var be="<object TagSum> ",Pe=0;Pe<Q.children.length;Pe++)be+=Q.children[Pe],"[object Text]"==Q.children[Pe].toString()&&(be+=" ["+Q.children[Pe].textContent+"]\n");return be}};U.__str__=U.toString=U.__repr__,U.clone=function(Q){for(var be=U.$factory(),Pe=0;Pe<Q.children.length;Pe++)be.children.push(Q.children[Pe].cloneNode(!0));return be},U.$factory=function(){return{__class__:U,children:[],toString:function(){return"(TagSum)"}}},n.set_func_names(U,"<dom>"),n.TagSum=U;var Re=n.JSObj.$factory(x);Re.get_postMessage=function(Q,be){if(o.isinstance(Q,dict)){var Pe={__class__:"dict"};o.list.$factory(o.dict.items(Q)).forEach(function(Ge){Pe[Ge[0]]=Ge[1]}),Q=Pe}return x.postMessage(Q,be)},n.DOMNode=A,n.win=Re}(__BRYTHON__),function($B){var _b_=$B.builtins,bltns=$B.InjectBuiltins();eval(bltns);var $GeneratorReturn={};$B.generator_return=function(n){return{__class__:$GeneratorReturn,value:n}},$B.generator=$B.make_class("generator",function(n){var o=function(){var l=n.apply(null,arguments);if(l.$name=n.name,l.$func=n,l.$has_run=!1,l.__class__=$B.generator,n.$has_yield_in_cm){var x=$B.last($B.frames_stack)[1];x.$close_generators=x.$close_generators||[],x.$close_generators.push(l)}return l};return o.$infos=n.$infos,o.$is_genfunc=!0,o}),$B.generator.__iter__=function(n){return n},$B.generator.__next__=function(n){return $B.generator.send(n,_b_.None)},$B.generator.close=function(n){try{$B.generator.$$throw(n,_b_.GeneratorExit.$factory())}catch(o){if(!$B.is_exc(o,[_b_.GeneratorExit,_b_.StopIteration]))throw _b_.RuntimeError.$factory("generator ignored GeneratorExit")}},$B.generator.send=function(n,o){if(n.$has_run=!0,n.$finished)throw _b_.StopIteration.$factory(o);if(!0===n.gi_running)throw _b_.ValueError.$factory("generator already executing");n.gi_running=!0;try{var l=n.next(o)}catch(x){throw n.$finished=!0,x}if(l.value&&l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopIteration.$factory(l.value.value);if(n.gi_running=!1,l.done)throw _b_.StopIteration.$factory(l.value);return l.value},$B.generator.$$throw=function(n,o,l,x){var B=o;if(B.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l?B=$B.$call(B)():_b_.isinstance(l,o)&&(B=l)}else void 0===l?l=B:B=$B.$call(B)(l);void 0!==x&&(B.$traceback=x);var D=n.throw(B);if(D.done)throw _b_.StopIteration.$factory("StopIteration");return D.value},$B.set_func_names($B.generator,"builtins"),$B.async_generator=$B.make_class("async_generator",function(n){return function(){var o=n.apply(null,arguments);return o.__class__=$B.async_generator,o}});var ag_closed={};function rstrip(n,o){for(var l=o||" \t\n",x=0,B=n.length;x<B&&l.indexOf(n.charAt(B-1-x))>-1;)x++;return n.substr(0,B-x)}$B.async_generator.__aiter__=function(n){return n},$B.async_generator.__anext__=function(n){return $B.async_generator.asend(n,_b_.None)},$B.async_generator.aclose=function(n){return n.$finished=!0,_b_.None},$B.async_generator.asend=async function(n,o){if(n.$finished)throw _b_.StopAsyncIteration.$factory(o);if(!0===n.ag_running)throw _b_.ValueError.$factory("generator already executing");n.ag_running=!0;try{var l=await n.next(o)}catch(x){throw n.$finished=!0,x}if(l.done)throw _b_.StopAsyncIteration.$factory(o);if(l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopAsyncIteration.$factory(l.value.value);return n.ag_running=!1,l.value},$B.async_generator.athrow=async function(n,o,l,x){var B=o;if(B.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l&&(l=$B.$call(B)())}else void 0===l?l=B:B=$B.$call(B)(l);void 0!==x&&(B.$traceback=x),await n.throw(l)},$B.set_func_names($B.async_generator,"builtins")}(__BRYTHON__),function($B){var _b_=$B.builtins,update=function(n,o){for(attr in o)n[attr]=o[attr]},_window=self,modules={},browser={$package:!0,$is_package:!0,__initialized__:!0,__package__:"browser",__file__:$B.brython_path.replace(/\/*$/g,"")+"/Lib/browser/__init__.py",bind:function(){var n=$B.args("bind",3,{elt:null,evt:null,options:null},["elt","evt","options"],arguments,{options:_b_.None},null,null),o=n.options;return"boolean"==typeof o||o.__class__===_b_.dict&&(o=o.$string_dict),function(l){if($B.get_class(n.elt)===$B.JSObj)return n.elt.addEventListener(n.evt,function(M){try{return l($B.JSObj.$factory(M))}catch(P){$B.handle_error(P)}},o),l;if(_b_.isinstance(n.elt,$B.DOMNode))return $B.DOMNode.bind(n.elt,n.evt,l,o),l;if(_b_.isinstance(n.elt,_b_.str)){for(var x=document.querySelectorAll(n.elt),B=0;B<x.length;B++)$B.DOMNode.bind($B.DOMNode.$factory(x[B]),n.evt,l,o);return l}try{for(var D=$B.$iter(n.elt);;)try{var G=_b_.next(D);$B.DOMNode.bind(G,n.evt,l)}catch(M){if(_b_.isinstance(M,_b_.StopIteration))break;throw M}}catch(M){throw _b_.isinstance(M,_b_.AttributeError)&&$B.DOMNode.bind(n.elt,n.evt,l),M}return l}},console:self.console&&$B.JSObj.$factory(self.console),self:$B.win,win:$B.win,$$window:$B.win};browser.__path__=browser.__file__,$B.isNode?(delete browser.$$window,delete browser.win):$B.isWebWorker?(browser.is_webworker=!0,delete browser.$$window,delete browser.win,browser.self.send=self.postMessage):(browser.is_webworker=!1,update(browser,{$$alert:function(n){window.alert($B.builtins.str.$factory(n||""))},confirm:$B.JSObj.$factory(window.confirm),$$document:$B.DOMNode.$factory(document),doc:$B.DOMNode.$factory(document),DOMEvent:$B.DOMEvent,DOMNode:$B.DOMNode,load:function(script_url){var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},mouseCoords:function(n){return $B.JSObj.$factory($mouseCoords(n))},prompt:function(n,o){return $B.JSObj.$factory(window.prompt(n,o||""))},reload:function(){var n=document.getElementsByTagName("script"),o=[];for(var l in n.forEach(function(x){void 0!==x.type&&"text/javascript"!=x.type||(o.push(x),x.src&&console.log(x.src))}),console.log(o),$B.imported)$B.imported[l].$last_modified?console.log("check",l,$B.imported[l].__file__,$B.imported[l].$last_modified):console.log("no date for mod",l)},run_script:function(){var n=$B.args("run_script",2,{src:null,name:null},["src","name"],arguments,{name:"script_"+$B.UUID()},null,null);$B.run_script(n.src,n.name,!0)},URLParameter:function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(location.search);return o=null===o?"":decodeURIComponent(o[1].replace(/\+/g," ")),$B.builtins.str.$factory(o)}}),modules["browser.html"]=function($B){var _b_=$B.builtins,TagSum=$B.TagSum;function makeTagDict(tagName){var dict={__class__:_b_.type,$infos:{__name__:tagName,__module__:"browser.html"},__init__:function(){var $ns=$B.args("pow",1,{self:null},["self"],arguments,{},"args","kw"),self=$ns.self,args=$ns.args;if(1==args.length){var first=args[0];if(_b_.isinstance(first,[_b_.str,_b_.int,_b_.float]))self.innerHTML=_b_.str.$factory(first);else if(first.__class__===TagSum)for(var i=0,len=first.children.length;i<len;i++)self.appendChild(first.children[i]);else if(_b_.isinstance(first,$B.DOMNode))self.appendChild(first);else try{var items=_b_.list.$factory(first);items.forEach(function(n){$B.DOMNode.__le__(self,n)})}catch(n){$B.debug>1&&(console.log(n,n.__class__,n.args),console.log("first",first),console.log(arguments)),$B.handle_error(n)}}for(var items=_b_.list.$factory(_b_.dict.items($ns.kw)),i=0,len=items.length;i<len;i++){var arg=items[i][0],value=items[i][1];if("on"==arg.toLowerCase().substr(0,2)){var js='$B.DOMNode.bind(self,"'+arg.toLowerCase().substr(2);eval(js+'",function(){'+value+"})")}else if("style"==arg.toLowerCase())$B.DOMNode.set_style(self,value);else if(!1!==value)try{arg=$B.imported["browser.html"].attribute_mapper(arg),self.setAttribute(arg,value)}catch(n){throw _b_.ValueError.$factory("can't set attribute "+arg)}}}};return dict.__mro__=[$B.DOMNode,$B.builtins.object],dict.__new__=function(n){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{var l;(l=$B.DOMNode.$factory(document.createElement(tagName),!0))._wrapped=!1}return l.__class__=n,l.__dict__=$B.empty_dict(),l},$B.set_func_names(dict,"browser.html"),dict}function makeFactory(n){return function(){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{if("SVG"==n.$infos.__name__)var l=$B.DOMNode.$factory(document.createElementNS("http://www.w3.org/2000/svg","svg"),!0);else o=document.createElement(n.$infos.__name__),l=$B.DOMNode.$factory(o,!0);l._wrapped=!1}return l.__class__=n,n.__init__(l,...arguments),l}}var tags=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","B","BASE","BASEFONT","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HR","HTML","I","IFRAME","IMG","INPUT","INS","ISINDEX","KBD","LABEL","LEGEND","LI","LINK","MAP","MENU","META","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","P","PARAM","PRE","Q","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRIKE","STRONG","STYLE","SUB","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL","VAR","ARTICLE","ASIDE","AUDIO","BDI","CANVAS","COMMAND","DATA","DATALIST","EMBED","FIGCAPTION","FIGURE","FOOTER","HEADER","KEYGEN","MAIN","MARK","MATH","METER","NAV","OUTPUT","PROGRESS","RB","RP","RT","RTC","RUBY","SECTION","SOURCE","TEMPLATE","TIME","TRACK","VIDEO","WBR","DETAILS","DIALOG","MENUITEM","PICTURE","SUMMARY"],obj={tags:$B.empty_dict()},dicts={};function maketag(n){if("string"!=typeof n)throw _b_.TypeError.$factory("html.maketag expects a string as argument");var o=dicts[n]=makeTagDict(n);return o.$factory=makeFactory(o),_b_.dict.$setitem(obj.tags,n,o),o}return $B.DOMNode.tags=obj.tags,tags.forEach(function(n){obj[n]=maketag(n)}),obj.maketag=maketag,obj.attribute_mapper=function(n){return n.replace(/_/g,"-")},obj}(__BRYTHON__)),modules.browser=browser,$B.UndefinedClass=$B.make_class("Undefined",function(){return $B.Undefined}),$B.UndefinedClass.__mro__=[_b_.object],$B.UndefinedClass.__bool__=function(n){return!1},$B.UndefinedClass.__repr__=$B.UndefinedClass.__str__=function(n){return"<Javascript undefined>"},$B.Undefined={__class__:$B.UndefinedClass},$B.set_func_names($B.UndefinedClass,"javascript"),modules.javascript={$$this:function(){return void 0===$B.js_this?$B.builtins.None:$B.JSObj.$factory($B.js_this)},$$Date:self.Date&&$B.JSObj.$factory(self.Date),$$extends:function(n){return function(o){if("function"==typeof o){var l=function(){n.call(this,...arguments),o.apply(this,arguments)};return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l}if(o.$is_class){for(var x in console.log("obj",o),"Named"==n.$js_func.name&&console.log("-- Named"),l=function(){if(console.log("call parent class",o.$parent_class),o.$parent_class.call(this,...arguments),o.$$constructor){for(var D=[this],G=0,M=arguments.length;G<M;G++)D.push(arguments[G]);o.$$constructor.apply(this,D)}},l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l.$class=o,o.$parent_class=n,o.__dict__.$string_dict){var B=o.__dict__.$string_dict[x][0];l.prototype[x]="function"==typeof B?function(D){return function(){for(var G=[this],M=0,P=arguments.length;M<P;M++)G.push($B.pyobj2jsobj(arguments[M]));return D.apply(this,G)}}(B):$B.pyobj2jsobj(B)}return l}}},JSON:{__class__:$B.make_class("JSON"),parse:function(){return $B.structuredclone2pyobj(JSON.parse.apply(this,arguments))},stringify:function(n,o,l){return JSON.stringify($B.pyobj2structuredclone(n,!1),$B.JSObj.$factory(o),l)}},jsobj2pyobj:function(n){return $B.jsobj2pyobj(n)},load:function(script_url){console.log('"javascript.load" is deprecrated. Use browser.load instead.');var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},$$Math:self.Math&&$B.JSObj.$factory(self.Math),NULL:null,$$Number:self.Number&&$B.JSObj.$factory(self.Number),py2js:function(n,o){return void 0===o&&(o="__main__"+$B.UUID()),$B.py2js(n,o,o,$B.builtins_scope).to_js()},pyobj2jsobj:function(n){return $B.pyobj2jsobj(n)},$$RegExp:self.RegExp&&$B.JSObj.$factory(self.RegExp),$$String:self.String&&$B.JSObj.$factory(self.String),UNDEFINED:$B.Undefined,UndefinedType:$B.UndefinedClass};var arraybuffers=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];arraybuffers.forEach(function(n){void 0!==self[n]&&(modules.javascript[n]=$B.JSObj.$factory(self[n]))});var _b_=$B.builtins;function load(n,o){for(var l in o.__class__=$B.module,o.__name__=n,$B.imported[n]=o,o)if("function"==typeof o[l]){var x=$B.from_alias(l);o[l].$infos={__module__:n,__name__:x,__qualname__:n+"."+x}}}for(var attr in modules._sys={Getframe:function(){var n=$B.args("_getframe",1,{depth:null},["depth"],arguments,{depth:0},null,null).depth;return $B._frame.$factory($B.frames_stack,$B.frames_stack.length-n-1)},breakpointhook:function(){var n,o,l,x,B=$B.$options.breakpoint;void 0===B&&(B="pdb.set_trace"),[n,o,l]=_b_.str.rpartition(B,"."),""==o&&(n="builtins");try{$B.$import(n),x=$B.$getattr($B.imported[n],l)}catch{return console.warn("cannot import breakpoint",B),_b_.None}return $B.$call(x).apply(null,arguments)},exc_info:function(){for(var n=$B.frames_stack.length-1;n>=0;n--){var o=$B.frames_stack[n][1].$current_exception;if(o)return _b_.tuple.$factory([o.__class__,o,$B.$getattr(o,"__traceback__")])}return _b_.tuple.$factory([_b_.None,_b_.None,_b_.None])},excepthook:function(n,o,l){$B.handle_error(o)},gettrace:function(){return $B.tracefunc||_b_.None},modules:_b_.property.$factory(function(){return $B.obj_dict($B.imported)},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.modules'")}),path:_b_.property.$factory(function(){return $B.path},function(n,o,l){$B.path=l}),meta_path:_b_.property.$factory(function(){return $B.meta_path},function(n,o,l){$B.meta_path=l}),path_hooks:_b_.property.$factory(function(){return $B.path_hooks},function(n,o,l){$B.path_hooks=l}),path_importer_cache:_b_.property.$factory(function(){return _b_.dict.$factory($B.JSObj.$factory($B.path_importer_cache))},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.path_importer_cache'")}),settrace:function(){var n=$B.args("settrace",1,{tracefunc:null},["tracefunc"],arguments,{},null,null);return $B.tracefunc=n.tracefunc,$B.last($B.frames_stack)[1].$f_trace=$B.tracefunc,$B.tracefunc.$current_frame_id=$B.last($B.frames_stack)[0],_b_.None},stderr:_b_.property.$factory(function(){return $B.stderr},function(n,o){$B.stderr=o}),stdout:_b_.property.$factory(function(){return $B.stdout},function(n,o){$B.stdout=o}),stdin:_b_.property.$factory(function(){return $B.stdin},function(n,o){$B.stdin=o}),vfs:_b_.property.$factory(function(){return $B.hasOwnProperty("VFS")?$B.obj_dict($B.VFS):_b_.None},function(){throw _b_.TypeError.$factory("Read only property 'sys.vfs'")})},modules._sys.__breakpointhook__=modules._sys.breakpointhook,modules._sys.stderr.write=function(n){return $B.$getattr(_sys.stderr.__get__(),"write")(n)},modules._sys.stdout.write=function(n){return $B.$getattr(_sys.stdout.__get__(),"write")(n)},modules)load(attr,modules[attr]);$B.isWebWorker||$B.isNode||(modules.browser.html=modules["browser.html"]);var _b_=$B.builtins;for(var attr in _b_.__builtins__=$B.module.$factory("__builtins__","Python builtins"),_b_)_b_.__builtins__[attr]=_b_[attr],$B.builtins_scope.binding[attr]=!0;for(var name in _b_.__builtins__.__setattr__=function(n,o){_b_[n]=o},$B.method_descriptor.__getattribute__=$B.Function.__getattribute__,$B.wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,_b_)if(_b_[name].__class__===_b_.type)for(var key in $B.builtin_classes.push(_b_[name]),_b_[name]){var value=_b_[name][key];void 0!==value&&(value.__class__||"function"==typeof value&&(value.__class__="__new__"==key?$B.builtin_function:key.startsWith("__")?$B.wrapper_descriptor:$B.method_descriptor,value.__objclass__=_b_[name]))}for(var attr in $B)Array.isArray($B[attr])&&($B[attr].__class__=_b_.list);$B.cell=$B.make_class("cell",function(n){return{__class__:$B.cell,$cell_contents:n}}),$B.cell.cell_contents=$B.$call(_b_.property)(function(n){if(null===n.$cell_contents)throw _b_.ValueError.$factory("empty cell");return n.$cell_contents},function(n,o){n.$cell_contents=o});var $comps=Object.values($B.$comps).concat(["eq","ne"]);$comps.forEach(function(n){var l,o="__"+n+"__";$B.cell[o]=(l=o,function(x,B){return _b_.isinstance(B,$B.cell)?null===x.$cell_contents?null===B.$cell_contents?"__eq__"==l:["__ne__","__lt__","__le__"].indexOf(l)>-1:null===B.$cell_contents?["__ne__","__gt__","__ge__"].indexOf(l)>-1:$B.rich_comp(l,x.$cell_contents,B.$cell_contents):NotImplemented})}),$B.set_func_names($B.cell,"builtins")}(__BRYTHON__);var docs={ArithmeticError:"Base class for arithmetic errors.",AssertionError:"Assertion failed.",AttributeError:"Attribute not found.",BaseException:"Common base class for all exceptions",BlockingIOError:"I/O operation would block.",BrokenPipeError:"Broken pipe.",BufferError:"Buffer error.",BytesWarning:"Base class for warnings about bytes and buffer related problems, mostly\nrelated to conversion from str or comparing to str.",ChildProcessError:"Child process error.",ConnectionAbortedError:"Connection aborted.",ConnectionError:"Connection error.",ConnectionRefusedError:"Connection refused.",ConnectionResetError:"Connection reset.",DeprecationWarning:"Base class for warnings about deprecated features.",EOFError:"Read beyond end of file.",Ellipsis:"",EnvironmentError:"Base class for I/O related errors.",Exception:"Common base class for all non-exit exceptions.",False:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",FileExistsError:"File already exists.",FileNotFoundError:"File not found.",FloatingPointError:"Floating point operation failed.",FutureWarning:"Base class for warnings about constructs that will change semantically\nin the future.",GeneratorExit:"Request that a generator exit.",IOError:"Base class for I/O related errors.",ImportError:"Import can't find module, or can't find name in module.",ImportWarning:"Base class for warnings about probable mistakes in module imports",IndentationError:"Improper indentation.",IndexError:"Sequence index out of range.",InterruptedError:"Interrupted by signal.",IsADirectoryError:"Operation doesn't work on directories.",KeyError:"Mapping key not found.",KeyboardInterrupt:"Program interrupted by user.",LookupError:"Base class for lookup errors.",MemoryError:"Out of memory.",NameError:"Name not found globally.",None:"",NotADirectoryError:"Operation only works on directories.",NotImplemented:"",NotImplementedError:"Method or function hasn't been implemented yet.",OSError:"Base class for I/O related errors.",OverflowError:"Result too large to be represented.",PendingDeprecationWarning:"Base class for warnings about features which will be deprecated\nin the future.",PermissionError:"Not enough permissions.",ProcessLookupError:"Process not found.",ReferenceError:"Weak ref proxy used after referent went away.",ResourceWarning:"Base class for warnings about resource usage.",RuntimeError:"Unspecified run-time error.",RuntimeWarning:"Base class for warnings about dubious runtime behavior.",StopIteration:"Signal the end from iterator.__next__().",SyntaxError:"Invalid syntax.",SyntaxWarning:"Base class for warnings about dubious syntax.",SystemError:"Internal error in the Python interpreter.\n\nPlease report this to the Python maintainer, along with the traceback,\nthe Python version, and the hardware/OS platform and version.",SystemExit:"Request to exit from the interpreter.",TabError:"Improper mixture of spaces and tabs.",TimeoutError:"Timeout expired.",True:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",TypeError:"Inappropriate argument type.",UnboundLocalError:"Local name referenced but not bound to a value.",UnicodeDecodeError:"Unicode decoding error.",UnicodeEncodeError:"Unicode encoding error.",UnicodeError:"Unicode related error.",UnicodeTranslateError:"Unicode translation error.",UnicodeWarning:"Base class for warnings about Unicode related problems, mostly\nrelated to conversion problems.",UserWarning:"Base class for warnings generated by user code.",ValueError:"Inappropriate argument value (of correct type).",Warning:"Base class for warning categories.",WindowsError:"Base class for I/O related errors.",ZeroDivisionError:"Second argument to a division or modulo operation was zero.",__debug__:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",abs:"abs(number) -> number\n\nReturn the absolute value of the argument.",all:"all(iterable) -> bool\n\nReturn True if bool(x) is True for all values x in the iterable.\nIf the iterable is empty, return True.",any:"any(iterable) -> bool\n\nReturn True if bool(x) is True for any x in the iterable.\nIf the iterable is empty, return False.",ascii:"ascii(object) -> string\n\nAs repr(), return a string containing a printable representation of an\nobject, but escape the non-ASCII characters in the string returned by\nrepr() using \\x, \\u or \\U escapes.  This generates a string similar\nto that returned by repr() in Python 2.",bin:"bin(number) -> string\n\nReturn the binary representation of an integer.\n\n   >>> bin(2796202)\n   '0b1010101010101010101010'\n",bool:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",bytearray:"bytearray(iterable_of_ints) -> bytearray\nbytearray(string, encoding[, errors]) -> bytearray\nbytearray(bytes_or_buffer) -> mutable copy of bytes_or_buffer\nbytearray(int) -> bytes array of size given by the parameter initialized with null bytes\nbytearray() -> empty bytes array\n\nConstruct an mutable bytearray object from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - a bytes or a buffer object\n  - any object implementing the buffer API.\n  - an integer",bytes:"bytes(iterable_of_ints) -> bytes\nbytes(string, encoding[, errors]) -> bytes\nbytes(bytes_or_buffer) -> immutable copy of bytes_or_buffer\nbytes(int) -> bytes object of size given by the parameter initialized with null bytes\nbytes() -> empty bytes object\n\nConstruct an immutable array of bytes from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - any object implementing the buffer API.\n  - an integer",callable:"callable(object) -> bool\n\nReturn whether the object is callable (i.e., some kind of function).\nNote that classes are callable, as are instances of classes with a\n__call__() method.",chr:"chr(i) -> Unicode character\n\nReturn a Unicode string of one character with ordinal i; 0 <= i <= 0x10ffff.",classmethod:"classmethod(function) -> method\n\nConvert a function to be a class method.\n\nA class method receives the class as implicit first argument,\njust like an instance method receives the instance.\nTo declare a class method, use this idiom:\n\n  class C:\n      def f(cls, arg1, arg2, ...): ...\n      f = classmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\nIf a class method is called for a derived class, the derived class\nobject is passed as the implied first argument.\n\nClass methods are different than C++ or Java static methods.\nIf you want those, see the staticmethod builtin.",compile:"compile(source, filename, mode[, flags[, dont_inherit]]) -> code object\n\nCompile the source (a Python module, statement or expression)\ninto a code object that can be executed by exec() or eval().\nThe filename will be used for run-time error messages.\nThe mode must be 'exec' to compile a module, 'single' to compile a\nsingle (interactive) statement, or 'eval' to compile an expression.\nThe flags argument, if present, controls which future statements influence\nthe compilation of the code.\nThe dont_inherit argument, if non-zero, stops the compilation inheriting\nthe effects of any future statements in effect in the code calling\ncompile; if absent or zero these statements do influence the compilation,\nin addition to any features explicitly specified.",complex:"complex(real[, imag]) -> complex number\n\nCreate a complex number from a real part and an optional imaginary part.\nThis is equivalent to (real + imag*1j) where imag defaults to 0.",copyright:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",credits:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",delattr:"delattr(object, name)\n\nDelete a named attribute on an object; delattr(x, 'y') is equivalent to\n``del x.y''.",dict:"dict() -> new empty dictionary\ndict(mapping) -> new dictionary initialized from a mapping object's\n    (key, value) pairs\ndict(iterable) -> new dictionary initialized as if via:\n    d = {}\n    for k, v in iterable:\n        d[k] = v\ndict(**kwargs) -> new dictionary initialized with the name=value pairs\n    in the keyword argument list.  For example:  dict(one=1, two=2)",dir:"dir([object]) -> list of strings\n\nIf called without an argument, return the names in the current scope.\nElse, return an alphabetized list of names comprising (some of) the attributes\nof the given object, and of attributes reachable from it.\nIf the object supplies a method named __dir__, it will be used; otherwise\nthe default dir() logic is used and returns:\n  for a module object: the module's attributes.\n  for a class object:  its attributes, and recursively the attributes\n    of its bases.\n  for any other object: its attributes, its class's attributes, and\n    recursively the attributes of its class's base classes.",divmod:"divmod(x, y) -> (div, mod)\n\nReturn the tuple ((x-x%y)/y, x%y).  Invariant: div*y + mod == x.",enumerate:"enumerate(iterable[, start]) -> iterator for index, value of iterable\n\nReturn an enumerate object.  iterable must be another object that supports\niteration.  The enumerate object yields pairs containing a count (from\nstart, which defaults to zero) and a value yielded by the iterable argument.\nenumerate is useful for obtaining an indexed list:\n    (0, seq[0]), (1, seq[1]), (2, seq[2]), ...",eval:"eval(source[, globals[, locals]]) -> value\n\nEvaluate the source in the C of globals and locals.\nThe source may be a string representing a Python expression\nor a code object as returned by compile().\nThe globals must be a dictionary and locals can be any mapping,\ndefaulting to the current globals and locals.\nIf only globals is given, locals defaults to it.\n",exec:"exec(object[, globals[, locals]])\n\nRead and execute code from an object, which can be a string or a code\nobject.\nThe globals and locals are dictionaries, defaulting to the current\nglobals and locals.  If only globals is given, locals defaults to it.",exit:"",filter:"filter(function or None, iterable) --\x3e filter object\n\nReturn an iterator yielding those items of iterable for which function(item)\nis true. If function is None, return the items that are true.",float:"float(x) -> floating point number\n\nConvert a string or number to a floating point number, if possible.",format:'format(value[, format_spec]) -> string\n\nReturns value.__format__(format_spec)\nformat_spec defaults to ""',frozenset:"frozenset()-> empty frozenset object\nfrozenset(iterable)-> frozenset object\n\nBuild an immutable unordered collection of unique elements.",getattr:"getattr(object,name[,default])-> value\n\nGet a named attribute from an object;getattr(x,'y')is equivalent to x.y.\nWhen a default argument is given,it is returned when the attribute doesn't\nexist; without it, an exception is raised in that case.",globals:"globals() -> dictionary\n\nReturn the dictionary containing the current scope's global variables.",hasattr:"hasattr(object,name)-> bool\n\nReturn whether the object has an attribute with the given name.\n(This is done by calling getattr(object,name)and catching AttributeError.)",hash:"hash(object)-> integer\n\nReturn a hash value for the object. Two objects with the same value have\nthe same hash value. The reverse is not necessarily true,but likely.",help:"Define the builtin 'help'.\n\n This is a wrapper around pydoc.help that provides a helpful message\n when 'help' is typed at the Python interactive prompt.\n\n Calling help()at the Python prompt starts an interactive help session.\n Calling help(thing)prints help for the python object 'thing'.\n ",hex:"hex(number)-> string\n\nReturn the hexadecimal representation of an integer.\n\n >>> hex(3735928559)\n '0xdeadbeef'\n",id:"id(object)-> integer\n\nReturn the identity of an object. This is guaranteed to be unique among\nsimultaneously existing objects.(Hint:it's the object's memory address.)",input:"input([prompt])-> string\n\nRead a string from standard input. The trailing newline is stripped.\nIf the user hits EOF(Unix:Ctl-D,Windows:Ctl-Z+Return),raise EOFError.\nOn Unix,GNU readline is used if enabled. The prompt string,if given,\nis printed without a trailing newline before reading.",int:"int(x=0)-> integer\nint(x,base=10)-> integer\n\nConvert a number or string to an integer,or return 0 if no arguments\nare given. If x is a number,return x.__int__(). For floating point\nnumbers,this truncates towards zero.\n\nIf x is not a number or if base is given,then x must be a string,\nbytes,or bytearray instance representing an integer literal in the\ngiven base. The literal can be preceded by '+' or '-' and be surrounded\nby whitespace. The base defaults to 10. Valid bases are 0 and 2-36.\nBase 0 means to interpret the base from the string as an integer literal.\n>>> int('0b100',base=0)\n4",isinstance:"isinstance(object,class-or-type-or-tuple)-> bool\n\nReturn whether an object is an instance of a class or of a subclass thereof.\nWith a type as second argument,return whether that is the object's type.\nThe form using a tuple, isinstance(x, (A, B, ...)), is a shortcut for\nisinstance(x, A) or isinstance(x, B) or ... (etc.).",issubclass:"issubclass(C, B) -> bool\n\nReturn whether class C is a subclass (i.e., a derived class) of class B.\nWhen using a tuple as the second argument issubclass(X, (A, B, ...)),\nis a shortcut for issubclass(X, A) or issubclass(X, B) or ... (etc.).",iter:"iter(iterable) -> iterator\niter(callable, sentinel) -> iterator\n\nGet an iterator from an object.  In the first form, the argument must\nsupply its own iterator, or be a sequence.\nIn the second form, the callable is called until it returns the sentinel.",len:"len(object)\n\nReturn the number of items of a sequence or collection.",license:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",list:"list() -> new empty list\nlist(iterable) -> new list initialized from iterable's items",locals:"locals()-> dictionary\n\nUpdate and return a dictionary containing the current scope's local variables.",map:"map(func, *iterables) --\x3e map object\n\nMake an iterator that computes the function using arguments from\neach of the iterables.  Stops when the shortest iterable is exhausted.",max:"max(iterable, *[, default=obj, key=func]) -> value\nmax(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its biggest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the largest argument.",memoryview:"memoryview(object)\n\nCreate a new memoryview object which references the given object.",min:"min(iterable, *[, default=obj, key=func]) -> value\nmin(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its smallest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the smallest argument.",next:"next(iterator[, default])\n\nReturn the next item from the iterator. If default is given and the iterator\nis exhausted, it is returned instead of raising StopIteration.",object:"The most base type",oct:"oct(number) -> string\n\nReturn the octal representation of an integer.\n\n   >>> oct(342391)\n   '0o1234567'\n",open:"open(file, mode='r', buffering=-1, encoding=None,\n     errors=None, newline=None, closefd=True, opener=None) -> file object\n\nOpen file and return a stream.  Raise IOError upon failure.\n\nfile is either a text or byte string giving the name (and the path\nif the file isn't in the current working directory)of the file to\nbe opened or an integer file descriptor of the file to be\nwrapped.(If a file descriptor is given,it is closed when the\nreturned I/O object is closed,unless closefd is set to False.)\n\nmode is an optional string that specifies the mode in which the file\nis opened. It defaults to 'r' which means open for reading in text\nmode. Other common values are 'w' for writing(truncating the file if\nit already exists),'x' for creating and writing to a new file,and\n'a' for appending(which on some Unix systems,means that all writes\nappend to the end of the file regardless of the current seek position).\nIn text mode,if encoding is not specified the encoding used is platform\ndependent:locale.getpreferredencoding(False)is called to get the\ncurrent locale encoding.(For reading and writing raw bytes use binary\nmode and leave encoding unspecified.)The available modes are:\n\n========================================================================\nCharacter Meaning\n------------------------------------------------------------------------\n'r' open for reading(default)\n'w' open for writing,truncating the file first\n'x' create a new file and open it for writing\n'a' open for writing,appending to the end of the file if it exists\n'b' binary mode\n't' text mode(default)\n'+' open a disk file for updating(reading and writing)\n'U' universal newline mode(deprecated)\n========================================================================\n\nThe default mode is 'rt'(open for reading text). For binary random\naccess,the mode 'w+b' opens and truncates the file to 0 bytes,while\n'r+b' opens the file without truncation. The 'x' mode implies 'w' and\nraises an `FileExistsError` if the file already exists.\n\nPython distinguishes between files opened in binary and text modes,\neven when the underlying operating system doesn't. Files opened in\nbinary mode (appending 'b' to the mode argument) return contents as\nbytes objects without any decoding. In text mode (the default, or when\n't' is appended to the mode argument), the contents of the file are\nreturned as strings, the bytes having been first decoded using a\nplatform-dependent encoding or using the specified encoding if given.\n\n'U' mode is deprecated and will raise an exception in future versions\nof Python.  It has no effect in Python 3.  Use newline to control\nuniversal newlines mode.\n\nbuffering is an optional integer used to set the buffering policy.\nPass 0 to switch buffering off (only allowed in binary mode), 1 to select\nline buffering (only usable in text mode), and an integer > 1 to indicate\nthe size of a fixed-size chunk buffer.  When no buffering argument is\ngiven, the default buffering policy works as follows:\n\n* Binary files are buffered in fixed-size chunks; the size of the buffer\n  is chosen using a heuristic trying to determine the underlying device's\n \"block size\" and falling back on `io.DEFAULT_BUFFER_SIZE`.\n  On many systems, the buffer will typically be 4096 or 8192 bytes long.\n\n* \"Interactive\" text files (files for which isatty() returns True)\n  use line buffering.  Other text files use the policy described above\n  for binary files.\n\nencoding is the name of the encoding used to decode or encode the\nfile. This should only be used in text mode. The default encoding is\nplatform dependent, but any encoding supported by Python can be\npassed.  See the codecs module for the list of supported encodings.\n\nerrors is an optional string that specifies how encoding errors are to\nbe handled---this argument should not be used in binary mode. Pass\n'strict' to raise a ValueError exception if there is an encoding error\n(the default of None has the same effect), or pass 'ignore' to ignore\nerrors. (Note that ignoring encoding errors can lead to data loss.)\nSee the documentation for codecs.register or run 'help(codecs.Codec)'\nfor a list of the permitted encoding error strings.\n\nnewline controls how universal newlines works (it only applies to text\nmode). It can be None, '', '\\n', '\\r', and '\\r\\n'.  It works as\nfollows:\n\n* On input, if newline is None, universal newlines mode is\n  enabled. Lines in the input can end in '\\n', '\\r', or '\\r\\n', and\n  these are translated into '\\n' before being returned to the\n  caller. If it is '', universal newline mode is enabled, but line\n  endings are returned to the caller untranslated. If it has any of\n  the other legal values, input lines are only terminated by the given\n  string, and the line ending is returned to the caller untranslated.\n\n* On output, if newline is None, any '\\n' characters written are\n  translated to the system default line separator, os.linesep. If\n  newline is '' or '\\n', no translation takes place. If newline is any\n  of the other legal values, any '\\n' characters written are translated\n  to the given string.\n\nIf closefd is False, the underlying file descriptor will be kept open\nwhen the file is closed. This does not work when a file name is given\nand must be True in that case.\n\nA custom opener can be used by passing a callable as *opener*. The\nunderlying file descriptor for the file object is then obtained by\ncalling *opener* with (*file*, *flags*). *opener* must return an open\nfile descriptor (passing os.open as *opener* results in functionality\nsimilar to passing None).\n\nopen() returns a file object whose type depends on the mode, and\nthrough which the standard file operations such as reading and writing\nare performed. When open() is used to open a file in a text mode ('w',\n'r', 'wt', 'rt', etc.), it returns a TextIOWrapper. When used to open\na file in a binary mode, the returned class varies: in read binary\nmode, it returns a BufferedReader; in write binary and append binary\nmodes, it returns a BufferedWriter, and in read/write mode, it returns\na BufferedRandom.\n\nIt is also possible to use a string or bytearray as a file for both\nreading and writing. For strings StringIO can be used like a file\nopened in a text mode, and for bytes a BytesIO can be used like a file\nopened in a binary mode.\n",ord:"ord(c) -> integer\n\nReturn the integer ordinal of a one-character string.",pow:"pow(x, y[, z]) -> number\n\nWith two arguments, equivalent to x**y.  With three arguments,\nequivalent to (x**y) % z, but may be more efficient (e.g. for ints).",print:"print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n\nPrints the values to a stream, or to sys.stdout by default.\nOptional keyword arguments:\nfile:  a file-like object (stream); defaults to the current sys.stdout.\nsep:   string inserted between values, default a space.\nend:   string appended after the last value, default a newline.\nflush: whether to forcibly flush the stream.",property:"property(fget=None, fset=None, fdel=None, doc=None) -> property attribute\n\nfget is a function to be used for getting an attribute value, and likewise\nfset is a function for setting, and fdel a function for del'ing, an\nattribute.  Typical use is to define a managed attribute x:\n\nclass C(object):\n    def getx(self): return self._x\n    def setx(self, value): self._x = value\n    def delx(self): del self._x\n    x = property(getx, setx, delx, \"I'm the 'x' property.\")\n\nDecorators make defining new properties or modifying existing ones easy:\n\nclass C(object):\n    @property\n    def x(self):\n        \"I am the 'x' property.\"\n        return self._x\n    @x.setter\n    def x(self, value):\n        self._x = value\n    @x.deleter\n    def x(self):\n        del self._x\n",quit:"",range:"range(stop) -> range object\nrange(start, stop[, step]) -> range object\n\nReturn a virtual sequence of numbers from start to stop by step.",repr:"repr(object) -> string\n\nReturn the canonical string representation of the object.\nFor most object types, eval(repr(object)) == object.",reversed:"reversed(sequence) -> reverse iterator over values of the sequence\n\nReturn a reverse iterator",round:"round(number[, ndigits]) -> number\n\nRound a number to a given precision in decimal digits (default 0 digits).\nThis returns an int when called with one argument, otherwise the\nsame type as the number. ndigits may be negative.",set:"set() -> new empty set object\nset(iterable) -> new set object\n\nBuild an unordered collection of unique elements.",setattr:"setattr(object, name, value)\n\nSet a named attribute on an object; setattr(x, 'y', v) is equivalent to\n``x.y = v''.",slice:"slice(stop)\nslice(start, stop[, step])\n\nCreate a slice object.  This is used for extended slicing (e.g. a[0:10:2]).",sorted:"sorted(iterable, key=None, reverse=False) --\x3e new sorted list",staticmethod:"staticmethod(function) -> method\n\nConvert a function to be a static method.\n\nA static method does not receive an implicit first argument.\nTo declare a static method, use this idiom:\n\n     class C:\n     def f(arg1, arg2, ...): ...\n     f = staticmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\n\nStatic methods in Python are similar to those found in Java or C++.\nFor a more advanced concept, see the classmethod builtin.",str:"str(object='') -> str\nstr(bytes_or_buffer[, encoding[, errors]]) -> str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.",sum:"sum(iterable[, start]) -> value\n\nReturn the sum of an iterable of numbers (NOT strings) plus the value\nof parameter 'start' (which defaults to 0).  When the iterable is\nempty, return start.",super:"super() -> same as super(__class__, <first argument>)\nsuper(type) -> unbound super object\nsuper(type, obj) -> bound super object; requires isinstance(obj, type)\nsuper(type, type2) -> bound super object; requires issubclass(type2, type)\nTypical use to call a cooperative superclass method:\nclass C(B):\n    def meth(self, arg):\n        super().meth(arg)\nThis works for class methods too:\nclass C(B):\n    @classmethod\n    def cmeth(cls, arg):\n        super().cmeth(arg)\n",tuple:"tuple() -> empty tuple\ntuple(iterable) -> tuple initialized from iterable's items\n\nIf the argument is a tuple, the return value is the same object.",type:"type(object_or_name, bases, dict)\ntype(object) -> the object's type\ntype(name, bases, dict) -> a new type",vars:"vars([object]) -> dictionary\n\nWithout arguments, equivalent to locals().\nWith an argument, equivalent to object.__dict__.",zip:"zip(iter1 [,iter2 [...]]) --\x3e zip object\n\nReturn a zip object whose .__next__() method returns a tuple where\nthe i-th element comes from the i-th iterable argument.  The .__next__()\nmethod continues until the shortest iterable in the argument sequence\nis exhausted and then it raises StopIteration."},n,o;return __BRYTHON__.builtins_doc=docs,n=__BRYTHON__,o=n.builtins,n.import_hooks=function(l,x,B){var D,G,M=n.meta_path.slice(),P=n.imported;if(B){var de=M.indexOf(n.finders.path);de>-1&&M.splice(de,1)}for(var ye=0,ie=M.length;ye<ie;ye++){var ce=M[ye],fe=n.$getattr(ce,"find_spec",o.None);if(fe==o.None){var ae=n.$getattr(ce,"find_module",o.None);if(ae!==o.None&&(D=ae(l,x))!==o.None){var W=n.$getattr(D,"load_module"),Z=n.$call(W)(l);return P[l]=Z,Z}}else if(G=fe(l,x),!n.is_none(G)){if(void 0!==(Z=n.imported[G.name]))return P[G.name]=Z;D=o.getattr(G,"loader",o.None);break}}if(void 0===D){message=l,"file"==n.protocol&&(message+=" (warning: cannot import local files with protocol 'file')");var A=o.ModuleNotFoundError.$factory(message);throw A.name=l,A}if(n.is_none(Z)){if(G===o.None)throw o.ModuleNotFoundError.$factory(l);var R=o.getattr(G,"name");if(!n.is_none(D)){var X=o.getattr(D,"create_module",o.None);n.is_none(X)||(Z=n.$call(X)(G))}if(void 0===Z)throw o.ImportError.$factory(l);if(n.is_none(Z)){Z=n.module.$factory(l);var he=o.getattr(G,"origin");he=o.getattr(G,"has_location")?"from '"+he+"'":"("+he+")"}}Z.__name__=R,Z.__loader__=D,Z.__package__=o.getattr(G,"parent",""),Z.__spec__=G;var U=o.getattr(G,"submodule_search_locations");(Z.$is_package=!n.is_none(U))&&(Z.__path__=U),o.getattr(G,"has_location")&&(Z.__file__=o.getattr(G,"origin"),n.$py_module_path[Z.__name__]=Z.__file__);var Re=o.getattr(G,"cached");if(n.is_none(Re)||(Z.__cached__=Re),n.is_none(D)){if(n.is_none(U))throw o.ImportError.$factory(l);P[R]=Z}else{var Q=o.getattr(D,"exec_module",o.None);if(n.is_none(Q))Z=o.getattr(D,"load_module")(R);else{P[R]=Z;try{Q(Z)}catch(be){throw delete P[R],be}}}return P[R]},function(n){var o=n.coroutine=n.make_class("coroutine");o.close=function(l){},o.send=function(l){return l.$func.apply(null,l.$args)},o.__repr__=o.__str__=function(l){return l.$func.$infos?"<coroutine "+l.$func.$infos.__name__+">":"<coroutine object>"},n.set_func_names(o,"builtins"),n.make_async=l=>{if(l.$is_genfunc)return l;var x=function(){var B=arguments,D=n.deep_copy(n.frames_stack);return{__class__:o,$args:B,$func:l,$stack:D}};return x.$infos=l.$infos,x},n.promise=function(l){return l.__class__===o?o.send(l):"function"==typeof l?l():l}}(__BRYTHON__),window.__BRYTHON__=__BRYTHON__,__BRYTHON__},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},561:n=>{var o=Object.prototype.toString;n.exports=function(l){return l.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===o.call(l.buffer)||Array.isArray(l)}},355:n=>{n.exports=function(o,l){return"number"==typeof o?o:"number"==typeof l?l:0}},546:function(n,o,l){var x,B,D;B=[l(734)],x=function(G){"use strict";var M=function(A,R,X){if(void 0===A&&(A=M.DEFAULT_CAPACITY),void 0===R&&(R=M.DEFAULT_ENDIAN),void 0===X&&(X=M.DEFAULT_NOASSERT),!X){if((A|=0)<0)throw RangeError("Illegal capacity");R=!!R,X=!!X}this.buffer=0===A?de:new ArrayBuffer(A),this.view=0===A?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=A,this.littleEndian=R,this.noAssert=X};M.VERSION="5.0.1",M.LITTLE_ENDIAN=!0,M.BIG_ENDIAN=!1,M.DEFAULT_CAPACITY=16,M.DEFAULT_ENDIAN=M.BIG_ENDIAN,M.DEFAULT_NOASSERT=!1,M.Long=G||null;var P=M.prototype;Object.defineProperty(P,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var de=new ArrayBuffer(0),ye=String.fromCharCode;function ie(A){var R=0;return function(){return R<A.length?A.charCodeAt(R++):null}}function ce(){var A=[],R=[];return function(){if(0===arguments.length)return R.join("")+ye.apply(String,A);A.length+arguments.length>1024&&(R.push(ye.apply(String,A)),A.length=0),Array.prototype.push.apply(A,arguments)}}function fe(A,R,X,he,U){var Re,Q,be=8*U-he-1,Pe=(1<<be)-1,Ge=Pe>>1,Ae=-7,Xe=X?U-1:0,Ke=X?-1:1,yt=A[R+Xe];for(Xe+=Ke,Re=yt&(1<<-Ae)-1,yt>>=-Ae,Ae+=be;Ae>0;Re=256*Re+A[R+Xe],Xe+=Ke,Ae-=8);for(Q=Re&(1<<-Ae)-1,Re>>=-Ae,Ae+=he;Ae>0;Q=256*Q+A[R+Xe],Xe+=Ke,Ae-=8);if(0===Re)Re=1-Ge;else{if(Re===Pe)return Q?NaN:1/0*(yt?-1:1);Q+=Math.pow(2,he),Re-=Ge}return(yt?-1:1)*Q*Math.pow(2,Re-he)}function ae(A,R,X,he,U,Re){var Q,be,Pe,Ge=8*Re-U-1,Ae=(1<<Ge)-1,Xe=Ae>>1,Ke=23===U?Math.pow(2,-24)-Math.pow(2,-77):0,yt=he?0:Re-1,dt=he?1:-1,It=R<0||0===R&&1/R<0?1:0;for(R=Math.abs(R),isNaN(R)||R===1/0?(be=isNaN(R)?1:0,Q=Ae):(Q=Math.floor(Math.log(R)/Math.LN2),R*(Pe=Math.pow(2,-Q))<1&&(Q--,Pe*=2),(R+=Q+Xe>=1?Ke/Pe:Ke*Math.pow(2,1-Xe))*Pe>=2&&(Q++,Pe/=2),Q+Xe>=Ae?(be=0,Q=Ae):Q+Xe>=1?(be=(R*Pe-1)*Math.pow(2,U),Q+=Xe):(be=R*Math.pow(2,Xe-1)*Math.pow(2,U),Q=0));U>=8;A[X+yt]=255&be,yt+=dt,be/=256,U-=8);for(Q=Q<<U|be,Ge+=U;Ge>0;A[X+yt]=255&Q,yt+=dt,Q/=256,Ge-=8);A[X+yt-dt]|=128*It}M.accessor=function(){return Uint8Array},M.allocate=function(A,R,X){return new M(A,R,X)},M.concat=function(A,R,X,he){"boolean"!=typeof R&&"string"==typeof R||(he=X,X=R,R=void 0);for(var U,Re=0,Q=0,be=A.length;Q<be;++Q)M.isByteBuffer(A[Q])||(A[Q]=M.wrap(A[Q],R)),(U=A[Q].limit-A[Q].offset)>0&&(Re+=U);if(0===Re)return new M(0,X,he);var Pe,Ge=new M(Re,X,he);for(Q=0;Q<be;)(U=(Pe=A[Q++]).limit-Pe.offset)<=0||(Ge.view.set(Pe.view.subarray(Pe.offset,Pe.limit),Ge.offset),Ge.offset+=U);return Ge.limit=Ge.offset,Ge.offset=0,Ge},M.isByteBuffer=function(A){return!0===(A&&A.__isByteBuffer__)},M.type=function(){return ArrayBuffer},M.wrap=function(A,R,X,he){if("string"!=typeof R&&(he=X,X=R,R=void 0),"string"==typeof A)switch(void 0===R&&(R="utf8"),R){case"base64":return M.fromBase64(A,X);case"hex":return M.fromHex(A,X);case"binary":return M.fromBinary(A,X);case"utf8":return M.fromUTF8(A,X);case"debug":return M.fromDebug(A,X);default:throw Error("Unsupported encoding: "+R)}if(null===A||"object"!=typeof A)throw TypeError("Illegal buffer");var U;if(M.isByteBuffer(A))return(U=P.clone.call(A)).markedOffset=-1,U;if(A instanceof Uint8Array)U=new M(0,X,he),A.length>0&&(U.buffer=A.buffer,U.offset=A.byteOffset,U.limit=A.byteOffset+A.byteLength,U.view=new Uint8Array(A.buffer));else if(A instanceof ArrayBuffer)U=new M(0,X,he),A.byteLength>0&&(U.buffer=A,U.offset=0,U.limit=A.byteLength,U.view=A.byteLength>0?new Uint8Array(A):null);else{if("[object Array]"!==Object.prototype.toString.call(A))throw TypeError("Illegal buffer");(U=new M(A.length,X,he)).limit=A.length;for(var Re=0;Re<A.length;++Re)U.view[Re]=A[Re]}return U},P.writeBitSet=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if(!(A instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,U=R,Re=A.length,Q=Re>>3,be=0;for(R+=this.writeVarint32(Re,R);Q--;)he=1&!!A[be++]|(1&!!A[be++])<<1|(1&!!A[be++])<<2|(1&!!A[be++])<<3|(1&!!A[be++])<<4|(1&!!A[be++])<<5|(1&!!A[be++])<<6|(1&!!A[be++])<<7,this.writeByte(he,R++);if(be<Re){var Pe=0;for(he=0;be<Re;)he|=(1&!!A[be++])<<Pe++;this.writeByte(he,R++)}return X?(this.offset=R,this):R-U},P.readBitSet=function(A){var R=void 0===A;R&&(A=this.offset);var X,he=this.readVarint32(A),U=he.value,Re=U>>3,Q=0,be=[];for(A+=he.length;Re--;)X=this.readByte(A++),be[Q++]=!!(1&X),be[Q++]=!!(2&X),be[Q++]=!!(4&X),be[Q++]=!!(8&X),be[Q++]=!!(16&X),be[Q++]=!!(32&X),be[Q++]=!!(64&X),be[Q++]=!!(128&X);if(Q<U){var Pe=0;for(X=this.readByte(A++);Q<U;)be[Q++]=!!(X>>Pe++&1)}return R&&(this.offset=A),be},P.readBytes=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+"+A+") <= "+this.buffer.byteLength)}var he=this.slice(R,R+A);return X&&(this.offset+=A),he},P.writeBytes=P.append,P.writeInt8=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=1)>he&&this.resize((he*=2)>R?he:R),this.view[R-=1]=A,X&&(this.offset+=1),this},P.writeByte=P.writeInt8,P.readInt8=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return 128==(128&X)&&(X=-(255-X+1)),R&&(this.offset+=1),X},P.readByte=P.readInt8,P.writeUint8=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=1)>he&&this.resize((he*=2)>R?he:R),this.view[R-=1]=A,X&&(this.offset+=1),this},P.writeUInt8=P.writeUint8,P.readUint8=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=this.view[A];return R&&(this.offset+=1),X},P.readUInt8=P.readUint8,P.writeInt16=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=2)>he&&this.resize((he*=2)>R?he:R),R-=2,this.littleEndian?(this.view[R+1]=(65280&A)>>>8,this.view[R]=255&A):(this.view[R]=(65280&A)>>>8,this.view[R+1]=255&A),X&&(this.offset+=2),this},P.writeShort=P.writeInt16,P.readInt16=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),32768==(32768&X)&&(X=-(65535-X+1)),R&&(this.offset+=2),X},P.readShort=P.readInt16,P.writeUint16=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=2)>he&&this.resize((he*=2)>R?he:R),R-=2,this.littleEndian?(this.view[R+1]=(65280&A)>>>8,this.view[R]=255&A):(this.view[R]=(65280&A)>>>8,this.view[R+1]=255&A),X&&(this.offset+=2),this},P.writeUInt16=P.writeUint16,P.readUint16=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+2) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A],X|=this.view[A+1]<<8):(X=this.view[A]<<8,X|=this.view[A+1]),R&&(this.offset+=2),X},P.readUInt16=P.readUint16,P.writeInt32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),R-=4,this.littleEndian?(this.view[R+3]=A>>>24&255,this.view[R+2]=A>>>16&255,this.view[R+1]=A>>>8&255,this.view[R]=255&A):(this.view[R]=A>>>24&255,this.view[R+1]=A>>>16&255,this.view[R+2]=A>>>8&255,this.view[R+3]=255&A),X&&(this.offset+=4),this},P.writeInt=P.writeInt32,P.readInt32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),X|=0,R&&(this.offset+=4),X},P.readInt=P.readInt32,P.writeUint32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),R-=4,this.littleEndian?(this.view[R+3]=A>>>24&255,this.view[R+2]=A>>>16&255,this.view[R+1]=A>>>8&255,this.view[R]=255&A):(this.view[R]=A>>>24&255,this.view[R+1]=A>>>16&255,this.view[R+2]=A>>>8&255,this.view[R+3]=255&A),X&&(this.offset+=4),this},P.writeUInt32=P.writeUint32,P.readUint32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=0;return this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0):(X=this.view[A+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0),R&&(this.offset+=4),X},P.readUInt32=P.readUint32,G&&(P.writeInt64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var he=this.buffer.byteLength;(R+=8)>he&&this.resize((he*=2)>R?he:R),R-=8;var U=A.low,Re=A.high;return this.littleEndian?(this.view[R+3]=U>>>24&255,this.view[R+2]=U>>>16&255,this.view[R+1]=U>>>8&255,this.view[R]=255&U,this.view[(R+=4)+3]=Re>>>24&255,this.view[R+2]=Re>>>16&255,this.view[R+1]=Re>>>8&255,this.view[R]=255&Re):(this.view[R]=Re>>>24&255,this.view[R+1]=Re>>>16&255,this.view[R+2]=Re>>>8&255,this.view[R+3]=255&Re,this.view[R+=4]=U>>>24&255,this.view[R+1]=U>>>16&255,this.view[R+2]=U>>>8&255,this.view[R+3]=255&U),X&&(this.offset+=8),this},P.writeLong=P.writeInt64,P.readInt64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,he=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,he=this.view[(A+=4)+2]<<16,he|=this.view[A+1]<<8,he|=this.view[A],he+=this.view[A+3]<<24>>>0):(he=this.view[A+1]<<16,he|=this.view[A+2]<<8,he|=this.view[A+3],he+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var U=new G(X,he,!1);return R&&(this.offset+=8),U},P.readLong=P.readInt64,P.writeUint64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var he=this.buffer.byteLength;(R+=8)>he&&this.resize((he*=2)>R?he:R),R-=8;var U=A.low,Re=A.high;return this.littleEndian?(this.view[R+3]=U>>>24&255,this.view[R+2]=U>>>16&255,this.view[R+1]=U>>>8&255,this.view[R]=255&U,this.view[(R+=4)+3]=Re>>>24&255,this.view[R+2]=Re>>>16&255,this.view[R+1]=Re>>>8&255,this.view[R]=255&Re):(this.view[R]=Re>>>24&255,this.view[R+1]=Re>>>16&255,this.view[R+2]=Re>>>8&255,this.view[R+3]=255&Re,this.view[R+=4]=U>>>24&255,this.view[R+1]=U>>>16&255,this.view[R+2]=U>>>8&255,this.view[R+3]=255&U),X&&(this.offset+=8),this},P.writeUInt64=P.writeUint64,P.readUint64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=0,he=0;this.littleEndian?(X=this.view[A+2]<<16,X|=this.view[A+1]<<8,X|=this.view[A],X+=this.view[A+3]<<24>>>0,he=this.view[(A+=4)+2]<<16,he|=this.view[A+1]<<8,he|=this.view[A],he+=this.view[A+3]<<24>>>0):(he=this.view[A+1]<<16,he|=this.view[A+2]<<8,he|=this.view[A+3],he+=this.view[A]<<24>>>0,X=this.view[(A+=4)+1]<<16,X|=this.view[A+2]<<8,X|=this.view[A+3],X+=this.view[A]<<24>>>0);var U=new G(X,he,!0);return R&&(this.offset+=8),U},P.readUInt64=P.readUint64),P.writeFloat32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=4)>he&&this.resize((he*=2)>R?he:R),ae(this.view,A,R-=4,this.littleEndian,23,4),X&&(this.offset+=4),this},P.writeFloat=P.writeFloat32,P.readFloat32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=fe(this.view,A,this.littleEndian,23,4);return R&&(this.offset+=4),X},P.readFloat=P.readFloat32,P.writeFloat64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A)throw TypeError("Illegal value: "+A+" (not a number)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he=this.buffer.byteLength;return(R+=8)>he&&this.resize((he*=2)>R?he:R),ae(this.view,A,R-=8,this.littleEndian,52,8),X&&(this.offset+=8),this},P.writeDouble=P.writeFloat64,P.readFloat64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+8) <= "+this.buffer.byteLength)}var X=fe(this.view,A,this.littleEndian,52,8);return R&&(this.offset+=8),X},P.readDouble=P.readFloat64,M.MAX_VARINT32_BYTES=5,M.calculateVarint32=function(A){return(A>>>=0)<128?1:A<16384?2:A<2097152?3:A<268435456?4:5},M.zigZagEncode32=function(A){return((A|=0)<<1^A>>31)>>>0},M.zigZagDecode32=function(A){return A>>>1^-(1&A)|0},P.writeVarint32=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var U=M.calculateVarint32(A),Re=this.buffer.byteLength;for((R+=U)>Re&&this.resize((Re*=2)>R?Re:R),R-=U,A>>>=0;A>=128;)this.view[R++]=127&A|128,A>>>=7;return this.view[R++]=A,X?(this.offset=R,this):U},P.writeVarint32ZigZag=function(A,R){return this.writeVarint32(M.zigZagEncode32(A),R)},P.readVarint32=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,he=0,U=0;do{if(!this.noAssert&&A>this.limit){var Re=Error("Truncated");throw Re.truncated=!0,Re}X=this.view[A++],he<5&&(U|=(127&X)<<7*he),++he}while(128&X);return U|=0,R?(this.offset=A,U):{value:U,length:he}},P.readVarint32ZigZag=function(A){var R=this.readVarint32(A);return"object"==typeof R?R.value=M.zigZagDecode32(R.value):R=M.zigZagDecode32(R),R},G&&(M.MAX_VARINT64_BYTES=10,M.calculateVarint64=function(A){"number"==typeof A?A=G.fromNumber(A):"string"==typeof A&&(A=G.fromString(A));var R=A.toInt()>>>0,X=A.shiftRightUnsigned(28).toInt()>>>0,he=A.shiftRightUnsigned(56).toInt()>>>0;return 0==he?0==X?R<16384?R<128?1:2:R<2097152?3:4:X<16384?X<128?5:6:X<2097152?7:8:he<128?9:10},M.zigZagEncode64=function(A){return"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftLeft(1).xor(A.shiftRight(63)).toUnsigned()},M.zigZagDecode64=function(A){return"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned()),A.shiftRightUnsigned(1).xor(A.and(G.ONE).toSigned().negate()).toSigned()},P.writeVarint64=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("number"==typeof A)A=G.fromNumber(A);else if("string"==typeof A)A=G.fromString(A);else if(!(A&&A instanceof G))throw TypeError("Illegal value: "+A+" (not an integer or Long)");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}"number"==typeof A?A=G.fromNumber(A,!1):"string"==typeof A?A=G.fromString(A,!1):!1!==A.unsigned&&(A=A.toSigned());var he=M.calculateVarint64(A),U=A.toInt()>>>0,Re=A.shiftRightUnsigned(28).toInt()>>>0,Q=A.shiftRightUnsigned(56).toInt()>>>0,be=this.buffer.byteLength;switch((R+=he)>be&&this.resize((be*=2)>R?be:R),R-=he,he){case 10:this.view[R+9]=Q>>>7&1;case 9:this.view[R+8]=9!==he?128|Q:127&Q;case 8:this.view[R+7]=8!==he?Re>>>21|128:Re>>>21&127;case 7:this.view[R+6]=7!==he?Re>>>14|128:Re>>>14&127;case 6:this.view[R+5]=6!==he?Re>>>7|128:Re>>>7&127;case 5:this.view[R+4]=5!==he?128|Re:127&Re;case 4:this.view[R+3]=4!==he?U>>>21|128:U>>>21&127;case 3:this.view[R+2]=3!==he?U>>>14|128:U>>>14&127;case 2:this.view[R+1]=2!==he?U>>>7|128:U>>>7&127;case 1:this.view[R]=1!==he?128|U:127&U}return X?(this.offset+=he,this):he},P.writeVarint64ZigZag=function(A,R){return this.writeVarint64(M.zigZagEncode64(A),R)},P.readVarint64=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,he=0,U=0,Re=0,Q=0;if(he=127&(Q=this.view[A++]),128&Q&&(he|=(127&(Q=this.view[A++]))<<7,(128&Q||this.noAssert&&void 0===Q)&&(he|=(127&(Q=this.view[A++]))<<14,(128&Q||this.noAssert&&void 0===Q)&&(he|=(127&(Q=this.view[A++]))<<21,(128&Q||this.noAssert&&void 0===Q)&&(U=127&(Q=this.view[A++]),(128&Q||this.noAssert&&void 0===Q)&&(U|=(127&(Q=this.view[A++]))<<7,(128&Q||this.noAssert&&void 0===Q)&&(U|=(127&(Q=this.view[A++]))<<14,(128&Q||this.noAssert&&void 0===Q)&&(U|=(127&(Q=this.view[A++]))<<21,(128&Q||this.noAssert&&void 0===Q)&&(Re=127&(Q=this.view[A++]),(128&Q||this.noAssert&&void 0===Q)&&(Re|=(127&(Q=this.view[A++]))<<7,128&Q||this.noAssert&&void 0===Q))))))))))throw Error("Buffer overrun");var be=G.fromBits(he|U<<28,U>>>4|Re<<24,!1);return R?(this.offset=A,be):{value:be,length:A-X}},P.readVarint64ZigZag=function(A){var R=this.readVarint64(A);return R&&R.value instanceof G?R.value=M.zigZagDecode64(R.value):R=M.zigZagDecode64(R),R}),P.writeCString=function(A,R){var X=void 0===R;X&&(R=this.offset);var he,U=A.length;if(!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");for(he=0;he<U;++he)if(0===A.charCodeAt(he))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}U=Z.calculateUTF16asUTF8(ie(A))[1];var Re=this.buffer.byteLength;return(R+=U+1)>Re&&this.resize((Re*=2)>R?Re:R),R-=U+1,Z.encodeUTF16toUTF8(ie(A),function(Q){this.view[R++]=Q}.bind(this)),this.view[R++]=0,X?(this.offset=R,this):U},P.readCString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X,he=A,U=-1;return Z.decodeUTF8toUTF16(function(){if(0===U)return null;if(A>=this.limit)throw RangeError("Illegal range: Truncated data, "+A+" < "+this.limit);return 0===(U=this.view[A++])?null:U}.bind(this),X=ce(),!0),R?(this.offset=A,X()):{string:X(),length:A-he}},P.writeIString=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,U=R;he=Z.calculateUTF16asUTF8(ie(A),this.noAssert)[1];var Re=this.buffer.byteLength;if((R+=4+he)>Re&&this.resize((Re*=2)>R?Re:R),R-=4+he,this.littleEndian?(this.view[R+3]=he>>>24&255,this.view[R+2]=he>>>16&255,this.view[R+1]=he>>>8&255,this.view[R]=255&he):(this.view[R]=he>>>24&255,this.view[R+1]=he>>>16&255,this.view[R+2]=he>>>8&255,this.view[R+3]=255&he),R+=4,Z.encodeUTF16toUTF8(ie(A),function(Q){this.view[R++]=Q}.bind(this)),R!==U+4+he)throw RangeError("Illegal range: Truncated data, "+R+" == "+(R+4+he));return X?(this.offset=R,this):R-U},P.readIString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+4) <= "+this.buffer.byteLength)}var X=A,he=this.readUint32(A),U=this.readUTF8String(he,M.METRICS_BYTES,A+=4);return A+=U.length,R?(this.offset=A,U.string):{string:U.string,length:A-X}},M.METRICS_CHARS="c",M.METRICS_BYTES="b",P.writeUTF8String=function(A,R){var X,he=void 0===R;if(he&&(R=this.offset),!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var U=R;X=Z.calculateUTF16asUTF8(ie(A))[1];var Re=this.buffer.byteLength;return(R+=X)>Re&&this.resize((Re*=2)>R?Re:R),R-=X,Z.encodeUTF16toUTF8(ie(A),function(Q){this.view[R++]=Q}.bind(this)),he?(this.offset=R,this):R-U},P.writeString=P.writeUTF8String,M.calculateUTF8Chars=function(A){return Z.calculateUTF16asUTF8(ie(A))[0]},M.calculateUTF8Bytes=function(A){return Z.calculateUTF16asUTF8(ie(A))[1]},M.calculateString=M.calculateUTF8Bytes,P.readUTF8String=function(A,R,X){"number"==typeof R&&(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),void 0===R&&(R=M.METRICS_CHARS),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");if(A|=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}var U,Re=0,Q=X;if(R===M.METRICS_CHARS){if(U=ce(),Z.decodeUTF8(function(){return Re<A&&X<this.limit?this.view[X++]:null}.bind(this),function(Pe){++Re,Z.UTF8toUTF16(Pe,U)}),Re!==A)throw RangeError("Illegal range: Truncated data, "+Re+" == "+A);return he?(this.offset=X,U()):{string:U(),length:X-Q}}if(R===M.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+A>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+"+A+") <= "+this.buffer.byteLength)}var be=X+A;if(Z.decodeUTF8toUTF16(function(){return X<be?this.view[X++]:null}.bind(this),U=ce(),this.noAssert),X!==be)throw RangeError("Illegal range: Truncated data, "+X+" == "+be);return he?(this.offset=X,U()):{string:U(),length:X-Q}}throw TypeError("Unsupported metrics: "+R)},P.readString=P.readUTF8String,P.writeVString=function(A,R){var X=void 0===R;if(X&&(R=this.offset),!this.noAssert){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: "+R+" (not an integer)");if((R>>>=0)<0||R+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+R+" (+0) <= "+this.buffer.byteLength)}var he,U,Re=R;he=Z.calculateUTF16asUTF8(ie(A),this.noAssert)[1],U=M.calculateVarint32(he);var Q=this.buffer.byteLength;if((R+=U+he)>Q&&this.resize((Q*=2)>R?Q:R),R-=U+he,R+=this.writeVarint32(he,R),Z.encodeUTF16toUTF8(ie(A),function(be){this.view[R++]=be}.bind(this)),R!==Re+he+U)throw RangeError("Illegal range: Truncated data, "+R+" == "+(R+he+U));return X?(this.offset=R,this):R-Re},P.readVString=function(A){var R=void 0===A;if(R&&(A=this.offset),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+1) <= "+this.buffer.byteLength)}var X=A,he=this.readVarint32(A),U=this.readUTF8String(he.value,M.METRICS_BYTES,A+=he.length);return A+=U.length,R?(this.offset=A,U.string):{string:U.string,length:A-X}},P.append=function(A,R,X){"number"!=typeof R&&"string"==typeof R||(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,R));var U=A.limit-A.offset;if(U<=0)return this;var Re=this.buffer.byteLength;return(X+=U)>Re&&this.resize((Re*=2)>X?Re:X),X-=U,this.view.set(A.view.subarray(A.offset,A.limit),X),A.offset+=U,he&&(this.offset+=U),this},P.appendTo=function(A,R){return A.append(this,R),this},P.assert=function(A){return this.noAssert=!A,this},P.capacity=function(){return this.buffer.byteLength},P.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},P.clone=function(A){var R=new M(0,this.littleEndian,this.noAssert);return A?(R.buffer=new ArrayBuffer(this.buffer.byteLength),R.view=new Uint8Array(R.buffer)):(R.buffer=this.buffer,R.view=this.view),R.offset=this.offset,R.markedOffset=this.markedOffset,R.limit=this.limit,R},P.compact=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}if(0===A&&R===this.buffer.byteLength)return this;var X=R-A;if(0===X)return this.buffer=de,this.view=null,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=0,this;var he=new ArrayBuffer(X),U=new Uint8Array(he);return U.set(this.view.subarray(A,R)),this.buffer=he,this.view=U,this.markedOffset>=0&&(this.markedOffset-=A),this.offset=0,this.limit=X,this},P.copy=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}if(A===R)return new M(0,this.littleEndian,this.noAssert);var X=R-A,he=new M(X,this.littleEndian,this.noAssert);return he.offset=0,he.limit=X,he.markedOffset>=0&&(he.markedOffset-=A),this.copyTo(he,0,A,R),he},P.copyTo=function(A,R,X,he){var U,Re;if(!this.noAssert&&!M.isByteBuffer(A))throw TypeError("Illegal target: Not a ByteBuffer");if(R=(Re=void 0===R)?A.offset:0|R,X=(U=void 0===X)?this.offset:0|X,he=void 0===he?this.limit:0|he,R<0||R>A.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+R+" <= "+A.buffer.byteLength);if(X<0||he>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+X+" <= "+this.buffer.byteLength);var Q=he-X;return 0===Q?A:(A.ensureCapacity(R+Q),A.view.set(this.view.subarray(X,he),R),U&&(this.offset+=Q),Re&&(A.offset+=Q),this)},P.ensureCapacity=function(A){var R=this.buffer.byteLength;return R<A?this.resize((R*=2)>A?R:A):this},P.fill=function(A,R,X){var he=void 0===R;if(he&&(R=this.offset),"string"==typeof A&&A.length>0&&(A=A.charCodeAt(0)),void 0===R&&(R=this.offset),void 0===X&&(X=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal value: "+A+" (not an integer)");if(A|=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal begin: Not an integer");if(R>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal end: Not an integer");if(X>>>=0,R<0||R>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+R+" <= "+X+" <= "+this.buffer.byteLength)}if(R>=X)return this;for(;R<X;)this.view[R++]=A;return he&&(this.offset=R),this},P.flip=function(){return this.limit=this.offset,this.offset=0,this},P.mark=function(A){if(A=void 0===A?this.offset:A,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal offset: "+A+" (not an integer)");if((A>>>=0)<0||A+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+A+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=A,this},P.order=function(A){if(!this.noAssert&&"boolean"!=typeof A)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!A,this},P.LE=function(A){return this.littleEndian=void 0===A||!!A,this},P.BE=function(A){return this.littleEndian=void 0!==A&&!A,this},P.prepend=function(A,R,X){"number"!=typeof R&&"string"==typeof R||(X=R,R=void 0);var he=void 0===X;if(he&&(X=this.offset),!this.noAssert){if("number"!=typeof X||X%1!=0)throw TypeError("Illegal offset: "+X+" (not an integer)");if((X>>>=0)<0||X+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+X+" (+0) <= "+this.buffer.byteLength)}A instanceof M||(A=M.wrap(A,R));var U=A.limit-A.offset;if(U<=0)return this;var Re=U-X;if(Re>0){var Q=new ArrayBuffer(this.buffer.byteLength+Re),be=new Uint8Array(Q);be.set(this.view.subarray(X,this.buffer.byteLength),U),this.buffer=Q,this.view=be,this.offset+=Re,this.markedOffset>=0&&(this.markedOffset+=Re),this.limit+=Re,X+=Re}else new Uint8Array(this.buffer);return this.view.set(A.view.subarray(A.offset,A.limit),X-U),A.offset=A.limit,he&&(this.offset-=U),this},P.prependTo=function(A,R){return A.prepend(this,R),this},P.printDebug=function(A){"function"!=typeof A&&(A=console.log.bind(console)),A(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},P.remaining=function(){return this.limit-this.offset},P.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},P.resize=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal capacity: "+A+" (not an integer)");if((A|=0)<0)throw RangeError("Illegal capacity: 0 <= "+A)}if(this.buffer.byteLength<A){var R=new ArrayBuffer(A),X=new Uint8Array(R);X.set(this.view),this.buffer=R,this.view=X}return this},P.reverse=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}return A===R||Array.prototype.reverse.call(this.view.subarray(A,R)),this},P.skip=function(A){if(!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal length: "+A+" (not an integer)");A|=0}var R=this.offset+A;if(!this.noAssert&&(R<0||R>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+A+" <= "+this.buffer.byteLength);return this.offset=R,this},P.slice=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}var X=this.clone();return X.offset=A,X.limit=R,X},P.toBuffer=function(A){var R=this.offset,X=this.limit;if(!this.noAssert){if("number"!=typeof R||R%1!=0)throw TypeError("Illegal offset: Not an integer");if(R>>>=0,"number"!=typeof X||X%1!=0)throw TypeError("Illegal limit: Not an integer");if(X>>>=0,R<0||R>X||X>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+R+" <= "+X+" <= "+this.buffer.byteLength)}if(!A&&0===R&&X===this.buffer.byteLength)return this.buffer;if(R===X)return de;var he=new ArrayBuffer(X-R);return new Uint8Array(he).set(new Uint8Array(this.buffer).subarray(R,X),0),he},P.toArrayBuffer=P.toBuffer,P.toString=function(A,R,X){if(void 0===A)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof A&&(X=R=A="utf8"),A){case"utf8":return this.toUTF8(R,X);case"base64":return this.toBase64(R,X);case"hex":return this.toHex(R,X);case"binary":return this.toBinary(R,X);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+A)}};var W=function(){for(var A={},R=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],X=[],he=0,U=R.length;he<U;++he)X[R[he]]=he;return A.encode=function(Re,Q){for(var be,Pe;null!==(be=Re());)Q(R[be>>2&63]),Pe=(3&be)<<4,null!==(be=Re())?(Q(R[63&((Pe|=be>>4&15)|be>>4&15)]),Pe=(15&be)<<2,null!==(be=Re())?(Q(R[63&(Pe|be>>6&3)]),Q(R[63&be])):(Q(R[63&Pe]),Q(61))):(Q(R[63&Pe]),Q(61),Q(61))},A.decode=function(Re,Q){var be,Pe,Ge;function Ae(Xe){throw Error("Illegal character code: "+Xe)}for(;null!==(be=Re());)if(void 0===(Pe=X[be])&&Ae(be),null!==(be=Re())&&(void 0===(Ge=X[be])&&Ae(be),Q(Pe<<2>>>0|(48&Ge)>>4),null!==(be=Re()))){if(void 0===(Pe=X[be])){if(61===be)break;Ae(be)}if(Q((15&Ge)<<4>>>0|(60&Pe)>>2),null!==(be=Re())){if(void 0===(Ge=X[be])){if(61===be)break;Ae(be)}Q((3&Pe)<<6>>>0|Ge)}}},A.test=function(Re){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Re)},A}();P.toBase64=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),R|=0,(A|=0)<0||R>this.capacity||A>R)throw RangeError("begin, end");var X;return W.encode(function(){return A<R?this.view[A++]:null}.bind(this),X=ce()),X()},M.fromBase64=function(A,R){if("string"!=typeof A)throw TypeError("str");var X=new M(A.length/4*3,R),he=0;return W.decode(ie(A),function(U){X.view[he++]=U}),X.limit=he,X},M.btoa=function(A){return M.fromBinary(A).toBase64()},M.atob=function(A){return M.fromBase64(A).toBinary()},P.toBinary=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),R|=0,(A|=0)<0||R>this.capacity()||A>R)throw RangeError("begin, end");if(A===R)return"";for(var X=[],he=[];A<R;)X.push(this.view[A++]),X.length>=1024&&(he.push(String.fromCharCode.apply(String,X)),X=[]);return he.join("")+String.fromCharCode.apply(String,X)},M.fromBinary=function(A,R){if("string"!=typeof A)throw TypeError("str");for(var X,he=0,U=A.length,Re=new M(U,R);he<U;){if((X=A.charCodeAt(he))>255)throw RangeError("illegal char code: "+X);Re.view[he++]=X}return Re.limit=U,Re},P.toDebug=function(A){for(var R,X=-1,he=this.buffer.byteLength,U="",Re="",Q="";X<he;){if(-1!==X&&(U+=(R=this.view[X])<16?"0"+R.toString(16).toUpperCase():R.toString(16).toUpperCase(),A&&(Re+=R>32&&R<127?String.fromCharCode(R):".")),++X,A&&X>0&&X%16==0&&X!==he){for(;U.length<51;)U+=" ";Q+=U+Re+"\n",U=Re=""}U+=X===this.offset&&X===this.limit?X===this.markedOffset?"!":"|":X===this.offset?X===this.markedOffset?"[":"<":X===this.limit?X===this.markedOffset?"]":">":X===this.markedOffset?"'":A||0!==X&&X!==he?" ":""}if(A&&" "!==U){for(;U.length<51;)U+=" ";Q+=U+Re+"\n"}return A?Q:U},M.fromDebug=function(A,R,X){for(var he,U,Re=A.length,Q=new M((Re+1)/3|0,R,X),be=0,Pe=0,Ge=!1,Ae=!1,Xe=!1,Ke=!1,yt=!1;be<Re;){switch(he=A.charAt(be++)){case"!":if(!X){if(Ae||Xe||Ke){yt=!0;break}Ae=Xe=Ke=!0}Q.offset=Q.markedOffset=Q.limit=Pe,Ge=!1;break;case"|":if(!X){if(Ae||Ke){yt=!0;break}Ae=Ke=!0}Q.offset=Q.limit=Pe,Ge=!1;break;case"[":if(!X){if(Ae||Xe){yt=!0;break}Ae=Xe=!0}Q.offset=Q.markedOffset=Pe,Ge=!1;break;case"<":if(!X){if(Ae){yt=!0;break}Ae=!0}Q.offset=Pe,Ge=!1;break;case"]":if(!X){if(Ke||Xe){yt=!0;break}Ke=Xe=!0}Q.limit=Q.markedOffset=Pe,Ge=!1;break;case">":if(!X){if(Ke){yt=!0;break}Ke=!0}Q.limit=Pe,Ge=!1;break;case"'":if(!X){if(Xe){yt=!0;break}Xe=!0}Q.markedOffset=Pe,Ge=!1;break;case" ":Ge=!1;break;default:if(!X&&Ge){yt=!0;break}if(U=parseInt(he+A.charAt(be++),16),!X&&(isNaN(U)||U<0||U>255))throw TypeError("Illegal str: Not a debug encoded string");Q.view[Pe++]=U,Ge=!0}if(yt)throw TypeError("Illegal str: Invalid symbol at "+be)}if(!X){if(!Ae||!Ke)throw TypeError("Illegal str: Missing offset or limit");if(Pe<Q.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+Pe+" < "+Re)}return Q},P.toHex=function(A,R){if(A=void 0===A?this.offset:A,R=void 0===R?this.limit:R,!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}for(var X,he=new Array(R-A);A<R;)(X=this.view[A++])<16?he.push("0",X.toString(16)):he.push(X.toString(16));return he.join("")},M.fromHex=function(A,R,X){if(!X){if("string"!=typeof A)throw TypeError("Illegal str: Not a string");if(A.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var he,U=A.length,Re=new M(U/2|0,R),Q=0,be=0;Q<U;Q+=2){if(he=parseInt(A.substring(Q,Q+2),16),!X&&(!isFinite(he)||he<0||he>255))throw TypeError("Illegal str: Contains non-hex characters");Re.view[be++]=he}return Re.limit=be,Re};var A,Z=A={MAX_CODEPOINT:1114111,encodeUTF8:function(R,X){var he=null;for("number"==typeof R&&(he=R,R=function(){return null});null!==he||null!==(he=R());)he<128?X(127&he):he<2048?(X(he>>6&31|192),X(63&he|128)):he<65536?(X(he>>12&15|224),X(he>>6&63|128),X(63&he|128)):(X(he>>18&7|240),X(he>>12&63|128),X(he>>6&63|128),X(63&he|128)),he=null},decodeUTF8:function(R,X){for(var he,U,Re,Q,be=function(Pe){Pe=Pe.slice(0,Pe.indexOf(null));var Ge=Error(Pe.toString());throw Ge.name="TruncatedError",Ge.bytes=Pe,Ge};null!==(he=R());)if(128&he)if(192==(224&he))null===(U=R())&&be([he,U]),X((31&he)<<6|63&U);else if(224==(240&he))(null===(U=R())||null===(Re=R()))&&be([he,U,Re]),X((15&he)<<12|(63&U)<<6|63&Re);else{if(240!=(248&he))throw RangeError("Illegal starting byte: "+he);(null===(U=R())||null===(Re=R())||null===(Q=R()))&&be([he,U,Re,Q]),X((7&he)<<18|(63&U)<<12|(63&Re)<<6|63&Q)}else X(he)},UTF16toUTF8:function(R,X){for(var he,U=null;null!==(he=null!==U?U:R());)he>=55296&&he<=57343&&null!==(U=R())&&U>=56320&&U<=57343?(X(1024*(he-55296)+U-56320+65536),U=null):X(he);null!==U&&X(U)},UTF8toUTF16:function(R,X){var he=null;for("number"==typeof R&&(he=R,R=function(){return null});null!==he||null!==(he=R());)he<=65535?X(he):(X(55296+((he-=65536)>>10)),X(he%1024+56320)),he=null},encodeUTF16toUTF8:function(R,X){A.UTF16toUTF8(R,function(he){A.encodeUTF8(he,X)})},decodeUTF8toUTF16:function(R,X){A.decodeUTF8(R,function(he){A.UTF8toUTF16(he,X)})},calculateCodePoint:function(R){return R<128?1:R<2048?2:R<65536?3:4},calculateUTF8:function(R){for(var X,he=0;null!==(X=R());)he+=X<128?1:X<2048?2:X<65536?3:4;return he},calculateUTF16asUTF8:function(R){var X=0,he=0;return A.UTF16toUTF8(R,function(U){++X,he+=U<128?1:U<2048?2:U<65536?3:4}),[X,he]}};return P.toUTF8=function(A,R){if(void 0===A&&(A=this.offset),void 0===R&&(R=this.limit),!this.noAssert){if("number"!=typeof A||A%1!=0)throw TypeError("Illegal begin: Not an integer");if(A>>>=0,"number"!=typeof R||R%1!=0)throw TypeError("Illegal end: Not an integer");if(R>>>=0,A<0||A>R||R>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+A+" <= "+R+" <= "+this.buffer.byteLength)}var X;try{Z.decodeUTF8toUTF16(function(){return A<R?this.view[A++]:null}.bind(this),X=ce())}catch{if(A!==R)throw RangeError("Illegal range: Truncated data, "+A+" != "+R)}return X()},M.fromUTF8=function(A,R,X){if(!X&&"string"!=typeof A)throw TypeError("Illegal str: Not a string");var he=new M(Z.calculateUTF16asUTF8(ie(A),!0)[1],R,X),U=0;return Z.encodeUTF16toUTF8(ie(A),function(Re){he.view[U++]=Re}),he.limit=U,he},M},void 0===(D=x.apply(o,B))||(n.exports=D)},690:n=>{n.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},87:n=>{n.exports="function"==typeof Object.create?function(o,l){l&&(o.super_=l,o.prototype=Object.create(l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,l){if(l){o.super_=l;var x=function(){};x.prototype=l.prototype,o.prototype=new x,o.prototype.constructor=o}}},809:n=>{function o(l){return!!l.constructor&&"function"==typeof l.constructor.isBuffer&&l.constructor.isBuffer(l)}n.exports=function(l){return null!=l&&(o(l)||"function"==typeof(x=l).readFloatLE&&"function"==typeof x.slice&&o(x.slice(0,0))||!!l._isBuffer);var x}},190:(n,o,l)=>{var x=l(408),B=l(720),D=l(355),G=["x","e","a","o","n","s","r","c","u","m","v","w","z"],M=["m","w"],P=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],de="\t".charCodeAt(0),ye=" ".charCodeAt(0);function ie(Z){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(Z)}function ce(Z){return new Function(["return function "+Z+"() {","  return this._"+Z,"}"].join("\n"))()}function fe(Z,A){if(!Z.chars||0===Z.chars.length)return null;var R=W(Z.chars,A);return R>=0?Z.chars[R]:null}function ae(Z,A,R){if(!Z.kernings||0===Z.kernings.length)return 0;for(var X=Z.kernings,he=0;he<X.length;he++){var U=X[he];if(U.first===A&&U.second===R)return U.amount}return 0}function W(Z,A,R){for(var X=R=R||0;X<Z.length;X++)if(Z[X].id===A)return X;return-1}n.exports=function(Z){return new ie(Z)},ie.prototype.update=function(Z){if(Z=B({measure:this._measure},Z),this._opt=Z,this._opt.tabSize=D(this._opt.tabSize,4),!Z.font)throw new Error("must provide a valid bitmap font");var A=this.glyphs,R=Z.text||"",X=Z.font;this._setupSpaceGlyphs(X);var he=x.lines(R,Z),U=Z.width||0;A.length=0;var It,Re=he.reduce(function(It,wt){return Math.max(It,wt.width,U)},0),Q=0,be=0,Pe=D(Z.lineHeight,X.common.lineHeight),Ge=X.common.base,Ae=Pe-Ge,Xe=Z.letterSpacing||0,Ke=Pe*he.length-Ae,yt="center"===(It=this._opt.align)?1:"right"===It?2:0;be-=Ke,this._width=Re,this._height=Ke,this._descender=Pe-Ge,this._baseline=Ge,this._xHeight=function(It){for(var wt=0;wt<G.length;wt++){var Gt=G[wt].charCodeAt(0),Dt=W(It.chars,Gt);if(Dt>=0)return It.chars[Dt].height}return 0}(X),this._capHeight=function(It){for(var wt=0;wt<P.length;wt++){var Gt=P[wt].charCodeAt(0),Dt=W(It.chars,Gt);if(Dt>=0)return It.chars[Dt].height}return 0}(X),this._lineHeight=Pe,this._ascender=Pe-Ae-this._xHeight;var dt=this;he.forEach(function(It,wt){for(var Gt,sn=It.end,gt=It.width,An=It.start;An<sn;An++){var Bn=R.charCodeAt(An),dn=dt.getGlyph(X,Bn);if(dn){Gt&&(Q+=ae(X,Gt.id,dn.id));var On=Q;1===yt?On+=(Re-gt)/2:2===yt&&(On+=Re-gt),A.push({position:[On,be],data:dn,index:An,line:wt}),Q+=dn.xadvance+Xe,Gt=dn}}be+=Pe,Q=0}),this._linesTotal=he.length},ie.prototype._setupSpaceGlyphs=function(Z){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,Z.chars&&0!==Z.chars.length){var A=fe(Z,ye)||function(X){for(var he=0;he<M.length;he++){var U=M[he].charCodeAt(0),Re=W(X.chars,U);if(Re>=0)return X.chars[Re]}return 0}(Z)||Z.chars[0],R=this._opt.tabSize*A.xadvance;this._fallbackSpaceGlyph=A,this._fallbackTabGlyph=B(A,{x:0,y:0,xadvance:R,id:de,xoffset:0,yoffset:0,width:0,height:0})}},ie.prototype.getGlyph=function(Z,A){return fe(Z,A)||(A===de?this._fallbackTabGlyph:A===ye?this._fallbackSpaceGlyph:null)},ie.prototype.computeMetrics=function(Z,A,R,X){var he,U=this._opt.letterSpacing||0,Re=this._opt.font,Q=0,be=0,Pe=0;if(!Re.chars||0===Re.chars.length)return{start:A,end:A,width:0};R=Math.min(Z.length,R);for(var Ge=A;Ge<R;Ge++){var Ae,Xe=Z.charCodeAt(Ge);if(Ae=this.getGlyph(Re,Xe)){var Ke=(Q+=he?ae(Re,he.id,Ae.id):0)+Ae.xadvance+U,yt=Q+Ae.width;if(yt>=X||Ke>=X)break;Q=Ke,be=yt,he=Ae}Pe++}return he&&(be+=he.xoffset),{start:A,end:A+Pe,width:be}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(Z){Object.defineProperty(ie.prototype,Z,{get:ce(Z),configurable:!0})})},734:function(n,o){var l,x;void 0===(x="function"==typeof(l=function(){"use strict";function B(Ae,Xe,Ke){this.low=0|Ae,this.high=0|Xe,this.unsigned=!!Ke}function D(Ae){return!0===(Ae&&Ae.__isLong__)}Object.defineProperty(B.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),B.isLong=D;var G={},M={};function P(Ae,Xe){var Ke,yt,dt;return Xe?(dt=0<=(Ae>>>=0)&&Ae<256)&&(yt=M[Ae])?yt:(Ke=ye(Ae,(0|Ae)<0?-1:0,!0),dt&&(M[Ae]=Ke),Ke):(dt=-128<=(Ae|=0)&&Ae<128)&&(yt=G[Ae])?yt:(Ke=ye(Ae,Ae<0?-1:0,!1),dt&&(G[Ae]=Ke),Ke)}function de(Ae,Xe){if(isNaN(Ae)||!isFinite(Ae))return Xe?X:R;if(Xe){if(Ae<0)return X;if(Ae>=W)return be}else{if(Ae<=-Z)return Pe;if(Ae+1>=Z)return Q}return Ae<0?de(-Ae,Xe).neg():ye(Ae%ae|0,Ae/ae|0,Xe)}function ye(Ae,Xe,Ke){return new B(Ae,Xe,Ke)}B.fromInt=P,B.fromNumber=de,B.fromBits=ye;var ie=Math.pow;function ce(Ae,Xe,Ke){if(0===Ae.length)throw Error("empty string");if("NaN"===Ae||"Infinity"===Ae||"+Infinity"===Ae||"-Infinity"===Ae)return R;if("number"==typeof Xe?(Ke=Xe,Xe=!1):Xe=!!Xe,(Ke=Ke||10)<2||36<Ke)throw RangeError("radix");var yt;if((yt=Ae.indexOf("-"))>0)throw Error("interior hyphen");if(0===yt)return ce(Ae.substring(1),Xe,Ke).neg();for(var dt=de(ie(Ke,8)),It=R,wt=0;wt<Ae.length;wt+=8){var Gt=Math.min(8,Ae.length-wt),Dt=parseInt(Ae.substring(wt,wt+Gt),Ke);if(Gt<8){var sn=de(ie(Ke,Gt));It=It.mul(sn).add(de(Dt))}else It=(It=It.mul(dt)).add(de(Dt))}return It.unsigned=Xe,It}function fe(Ae){return Ae instanceof B?Ae:"number"==typeof Ae?de(Ae):"string"==typeof Ae?ce(Ae):ye(Ae.low,Ae.high,Ae.unsigned)}B.fromString=ce,B.fromValue=fe;var ae=4294967296,W=ae*ae,Z=W/2,A=P(1<<24),R=P(0);B.ZERO=R;var X=P(0,!0);B.UZERO=X;var he=P(1);B.ONE=he;var U=P(1,!0);B.UONE=U;var Re=P(-1);B.NEG_ONE=Re;var Q=ye(-1,2147483647,!1);B.MAX_VALUE=Q;var be=ye(-1,-1,!0);B.MAX_UNSIGNED_VALUE=be;var Pe=ye(0,-2147483648,!1);B.MIN_VALUE=Pe;var Ge=B.prototype;return Ge.toInt=function(){return this.unsigned?this.low>>>0:this.low},Ge.toNumber=function(){return this.unsigned?(this.high>>>0)*ae+(this.low>>>0):this.high*ae+(this.low>>>0)},Ge.toString=function(Ae){if((Ae=Ae||10)<2||36<Ae)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Pe)){var Xe=de(Ae),Ke=this.div(Xe),yt=Ke.mul(Xe).sub(this);return Ke.toString(Ae)+yt.toInt().toString(Ae)}return"-"+this.neg().toString(Ae)}for(var dt=de(ie(Ae,6),this.unsigned),It=this,wt="";;){var Gt=It.div(dt),Dt=(It.sub(Gt.mul(dt)).toInt()>>>0).toString(Ae);if((It=Gt).isZero())return Dt+wt;for(;Dt.length<6;)Dt="0"+Dt;wt=""+Dt+wt}},Ge.getHighBits=function(){return this.high},Ge.getHighBitsUnsigned=function(){return this.high>>>0},Ge.getLowBits=function(){return this.low},Ge.getLowBitsUnsigned=function(){return this.low>>>0},Ge.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Pe)?64:this.neg().getNumBitsAbs();for(var Ae=0!=this.high?this.high:this.low,Xe=31;Xe>0&&!(Ae&1<<Xe);Xe--);return 0!=this.high?Xe+33:Xe+1},Ge.isZero=function(){return 0===this.high&&0===this.low},Ge.isNegative=function(){return!this.unsigned&&this.high<0},Ge.isPositive=function(){return this.unsigned||this.high>=0},Ge.isOdd=function(){return 1==(1&this.low)},Ge.isEven=function(){return 0==(1&this.low)},Ge.equals=function(Ae){return D(Ae)||(Ae=fe(Ae)),(this.unsigned===Ae.unsigned||this.high>>>31!=1||Ae.high>>>31!=1)&&this.high===Ae.high&&this.low===Ae.low},Ge.eq=Ge.equals,Ge.notEquals=function(Ae){return!this.eq(Ae)},Ge.neq=Ge.notEquals,Ge.lessThan=function(Ae){return this.comp(Ae)<0},Ge.lt=Ge.lessThan,Ge.lessThanOrEqual=function(Ae){return this.comp(Ae)<=0},Ge.lte=Ge.lessThanOrEqual,Ge.greaterThan=function(Ae){return this.comp(Ae)>0},Ge.gt=Ge.greaterThan,Ge.greaterThanOrEqual=function(Ae){return this.comp(Ae)>=0},Ge.gte=Ge.greaterThanOrEqual,Ge.compare=function(Ae){if(D(Ae)||(Ae=fe(Ae)),this.eq(Ae))return 0;var Xe=this.isNegative(),Ke=Ae.isNegative();return Xe&&!Ke?-1:!Xe&&Ke?1:this.unsigned?Ae.high>>>0>this.high>>>0||Ae.high===this.high&&Ae.low>>>0>this.low>>>0?-1:1:this.sub(Ae).isNegative()?-1:1},Ge.comp=Ge.compare,Ge.negate=function(){return!this.unsigned&&this.eq(Pe)?Pe:this.not().add(he)},Ge.neg=Ge.negate,Ge.add=function(Ae){D(Ae)||(Ae=fe(Ae));var Dt=0,sn=0,gt=0,An=0;return gt+=(An+=(65535&this.low)+(65535&Ae.low))>>>16,sn+=(gt+=(this.low>>>16)+(Ae.low>>>16))>>>16,Dt+=(sn+=(65535&this.high)+(65535&Ae.high))>>>16,Dt+=(this.high>>>16)+(Ae.high>>>16),ye((gt&=65535)<<16|(An&=65535),(Dt&=65535)<<16|(sn&=65535),this.unsigned)},Ge.subtract=function(Ae){return D(Ae)||(Ae=fe(Ae)),this.add(Ae.neg())},Ge.sub=Ge.subtract,Ge.multiply=function(Ae){if(this.isZero()||(D(Ae)||(Ae=fe(Ae)),Ae.isZero()))return R;if(this.eq(Pe))return Ae.isOdd()?Pe:R;if(Ae.eq(Pe))return this.isOdd()?Pe:R;if(this.isNegative())return Ae.isNegative()?this.neg().mul(Ae.neg()):this.neg().mul(Ae).neg();if(Ae.isNegative())return this.mul(Ae.neg()).neg();if(this.lt(A)&&Ae.lt(A))return de(this.toNumber()*Ae.toNumber(),this.unsigned);var Ke=65535&this.high,yt=this.low>>>16,dt=65535&this.low,wt=65535&Ae.high,Gt=Ae.low>>>16,Dt=65535&Ae.low,sn=0,gt=0,An=0,Bn=0;return An+=(Bn+=dt*Dt)>>>16,gt+=(An+=yt*Dt)>>>16,An&=65535,gt+=(An+=dt*Gt)>>>16,sn+=(gt+=Ke*Dt)>>>16,gt&=65535,sn+=(gt+=yt*Gt)>>>16,gt&=65535,sn+=(gt+=dt*wt)>>>16,sn+=(this.high>>>16)*Dt+Ke*Gt+yt*wt+dt*(Ae.high>>>16),ye((An&=65535)<<16|(Bn&=65535),(sn&=65535)<<16|(gt&=65535),this.unsigned)},Ge.mul=Ge.multiply,Ge.divide=function(Ae){if(D(Ae)||(Ae=fe(Ae)),Ae.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?X:R;var Xe,Ke,yt;if(this.unsigned){if(Ae.unsigned||(Ae=Ae.toUnsigned()),Ae.gt(this))return X;if(Ae.gt(this.shru(1)))return U;yt=X}else{if(this.eq(Pe))return Ae.eq(he)||Ae.eq(Re)?Pe:Ae.eq(Pe)?he:(Xe=this.shr(1).div(Ae).shl(1)).eq(R)?Ae.isNegative()?he:Re:(Ke=this.sub(Ae.mul(Xe)),yt=Xe.add(Ke.div(Ae)));if(Ae.eq(Pe))return this.unsigned?X:R;if(this.isNegative())return Ae.isNegative()?this.neg().div(Ae.neg()):this.neg().div(Ae).neg();if(Ae.isNegative())return this.div(Ae.neg()).neg();yt=R}for(Ke=this;Ke.gte(Ae);){Xe=Math.max(1,Math.floor(Ke.toNumber()/Ae.toNumber()));for(var dt=Math.ceil(Math.log(Xe)/Math.LN2),It=dt<=48?1:ie(2,dt-48),wt=de(Xe),Gt=wt.mul(Ae);Gt.isNegative()||Gt.gt(Ke);)Gt=(wt=de(Xe-=It,this.unsigned)).mul(Ae);wt.isZero()&&(wt=he),yt=yt.add(wt),Ke=Ke.sub(Gt)}return yt},Ge.div=Ge.divide,Ge.modulo=function(Ae){return D(Ae)||(Ae=fe(Ae)),this.sub(this.div(Ae).mul(Ae))},Ge.mod=Ge.modulo,Ge.not=function(){return ye(~this.low,~this.high,this.unsigned)},Ge.and=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low&Ae.low,this.high&Ae.high,this.unsigned)},Ge.or=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low|Ae.low,this.high|Ae.high,this.unsigned)},Ge.xor=function(Ae){return D(Ae)||(Ae=fe(Ae)),ye(this.low^Ae.low,this.high^Ae.high,this.unsigned)},Ge.shiftLeft=function(Ae){return D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63)?this:Ae<32?ye(this.low<<Ae,this.high<<Ae|this.low>>>32-Ae,this.unsigned):ye(0,this.low<<Ae-32,this.unsigned)},Ge.shl=Ge.shiftLeft,Ge.shiftRight=function(Ae){return D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63)?this:Ae<32?ye(this.low>>>Ae|this.high<<32-Ae,this.high>>Ae,this.unsigned):ye(this.high>>Ae-32,this.high>=0?0:-1,this.unsigned)},Ge.shr=Ge.shiftRight,Ge.shiftRightUnsigned=function(Ae){if(D(Ae)&&(Ae=Ae.toInt()),0==(Ae&=63))return this;var Xe=this.high;return Ae<32?ye(this.low>>>Ae|Xe<<32-Ae,Xe>>>Ae,this.unsigned):ye(32===Ae?Xe:Xe>>>Ae-32,0,this.unsigned)},Ge.shru=Ge.shiftRightUnsigned,Ge.toSigned=function(){return this.unsigned?ye(this.low,this.high,!1):this},Ge.toUnsigned=function(){return this.unsigned?this:ye(this.low,this.high,!0)},Ge.toBytes=function(Ae){return Ae?this.toBytesLE():this.toBytesBE()},Ge.toBytesLE=function(){var Ae=this.high,Xe=this.low;return[255&Xe,Xe>>>8&255,Xe>>>16&255,Xe>>>24&255,255&Ae,Ae>>>8&255,Ae>>>16&255,Ae>>>24&255]},Ge.toBytesBE=function(){var Ae=this.high,Xe=this.low;return[Ae>>>24&255,Ae>>>16&255,Ae>>>8&255,255&Ae,Xe>>>24&255,Xe>>>16&255,Xe>>>8&255,255&Xe]},B})?l.apply(o,[]):l)||(n.exports=x)},166:(n,o,l)=>{var x=l(690),B=l(561),D=l(809),G=[0,2,3],M=[2,1,3];n.exports=function(P,de){P&&(B(P)||D(P))||(de=P||{},P=null);for(var ye="string"==typeof(de="number"==typeof de?{count:de}:de||{}).type?de.type:"uint16",ce=de.start||0,fe=!1!==de.clockwise?G:M,ae=fe[0],W=fe[1],Z=fe[2],A=6*("number"==typeof de.count?de.count:1),R=P||new(x(ye))(A),X=0,he=0;X<A;X+=6,he+=4){var U=X+ce;R[U+0]=he+0,R[U+1]=he+1,R[U+2]=he+2,R[U+3]=he+ae,R[U+4]=he+W,R[U+5]=he+Z}return R}},573:(n,o,l)=>{var x=l(412),B=l(190),D=l(87),G=l(166),M=l(991),P=l(47),de=x.BufferGeometry;function ye(ie){de.call(this),"string"==typeof ie&&(ie={text:ie}),this._opt=Object.assign({},ie),ie&&this.update(ie)}n.exports=function(ie){return new ye(ie)},D(ye,de),ye.prototype.update=function(ie){if("string"==typeof ie&&(ie={text:ie}),!(ie=Object.assign({},this._opt,ie)).font)throw new TypeError("must specify a { font } in options");this.layout=B(ie);var ce=!1!==ie.flipY,fe=ie.font,ae=fe.common.scaleW,W=fe.common.scaleH,Z=this.layout.glyphs.filter(function(U){var Re=U.data;return Re.width*Re.height>0});this.visibleGlyphs=Z;var A=M.positions(Z),R=M.uvs(Z,ae,W,ce),X=G([],{clockwise:!0,type:"uint16",count:Z.length});if(this.setIndex(X),this.setAttribute("position",new x.BufferAttribute(A,2)),this.setAttribute("uv",new x.BufferAttribute(R,2)),!ie.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(ie.multipage){var he=M.pages(Z);this.setAttribute("page",new x.BufferAttribute(he,1))}},ye.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new x.Sphere);var ie=this.attributes.position.array;if(!ie||!this.attributes.position.itemSize||ie.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);P.computeSphere(ie,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},ye.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new x.Box3);var ie=this.boundingBox,ce=this.attributes.position.array;!ce||!this.attributes.position.itemSize||ce.length<2?ie.makeEmpty():P.computeBox(ce,ie)}},47:n=>{var o={min:[0,0],max:[0,0]};function l(x){var B=x.length/2;o.min[0]=x[0],o.min[1]=x[1],o.max[0]=x[0],o.max[1]=x[1];for(var D=0;D<B;D++){var G=x[2*D+0],M=x[2*D+1];o.min[0]=Math.min(G,o.min[0]),o.min[1]=Math.min(M,o.min[1]),o.max[0]=Math.max(G,o.max[0]),o.max[1]=Math.max(M,o.max[1])}}n.exports.computeBox=function(x,B){l(x),B.min.set(o.min[0],o.min[1],0),B.max.set(o.max[0],o.max[1],0)},n.exports.computeSphere=function(x,B){l(x);var D=o.min[0],G=o.min[1],M=o.max[0]-D,P=o.max[1]-G,de=Math.sqrt(M*M+P*P);B.center.set(D+M/2,G+P/2,0),B.radius=de/2}},991:n=>{n.exports.pages=function(o){var l=new Float32Array(4*o.length*1),x=0;return o.forEach(function(B){var D=B.data.page||0;l[x++]=D,l[x++]=D,l[x++]=D,l[x++]=D}),l},n.exports.uvs=function(o,l,x,B){var D=new Float32Array(4*o.length*2),G=0;return o.forEach(function(M){var P=M.data,ye=P.y+P.height,ie=P.x/l,ce=P.y/x,fe=(P.x+P.width)/l,ae=ye/x;B&&(ce=(x-P.y)/x,ae=(x-ye)/x),D[G++]=ie,D[G++]=ce,D[G++]=ie,D[G++]=ae,D[G++]=fe,D[G++]=ae,D[G++]=fe,D[G++]=ce}),D},n.exports.positions=function(o){var l=new Float32Array(4*o.length*2),x=0;return o.forEach(function(B){var D=B.data,G=B.position[0]+D.xoffset,M=B.position[1]+D.yoffset,P=D.width,de=D.height;l[x++]=G,l[x++]=M,l[x++]=G,l[x++]=M+de,l[x++]=G+P,l[x++]=M+de,l[x++]=G+P,l[x++]=M}),l}},412:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>ei,AddEquation:()=>Pe,AddOperation:()=>nr,AdditiveAnimationBlendMode:()=>th,AdditiveBlending:()=>U,AlphaFormat:()=>dp,AlwaysDepth:()=>Ln,AlwaysStencilFunc:()=>ha,AmbientLight:()=>$t,AmbientLightProbe:()=>Up,AnimationClip:()=>ls,AnimationLoader:()=>ed,AnimationMixer:()=>um,AnimationObjectGroup:()=>cm,AnimationUtils:()=>so,ArcCurve:()=>r,ArrayCamera:()=>md,ArrowHelper:()=>mh,Audio:()=>Jd,AudioAnalyser:()=>lm,AudioContext:()=>Hl,AudioListener:()=>If,AudioLoader:()=>ap,AxesHelper:()=>Sf,AxisHelper:()=>z_,BackSide:()=>W,BasicDepthPacking:()=>q,BasicShadowMap:()=>ye,BinaryTextureLoader:()=>W_,Bone:()=>Cu,BooleanKeyframeTrack:()=>Kp,BoundingBoxHelper:()=>j_,Box2:()=>Xm,Box3:()=>fn,Box3Helper:()=>wf,BoxBufferGeometry:()=>lh,BoxGeometry:()=>Ls,BoxHelper:()=>$d,BufferAttribute:()=>Vr,BufferGeometry:()=>hn,BufferGeometryLoader:()=>Yn,ByteType:()=>Wl,Cache:()=>ws,Camera:()=>Ai,CameraHelper:()=>Ad,CanvasRenderer:()=>Y_,CanvasTexture:()=>iu,CatmullRomCurve3:()=>O,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>Du,CircleGeometry:()=>Ph,ClampToEdgeWrapping:()=>Jr,Clock:()=>fh,ClosedSplineCurve3:()=>w_,Color:()=>ar,ColorKeyframeTrack:()=>wl,CompressedTexture:()=>uc,CompressedTextureLoader:()=>td,ConeBufferGeometry:()=>Qp,ConeGeometry:()=>Gi,CubeCamera:()=>Po,CubeGeometry:()=>Ls,CubeReflectionMapping:()=>Ei,CubeRefractionMapping:()=>So,CubeTexture:()=>Qs,CubeTextureLoader:()=>sp,CubeUVReflectionMapping:()=>Ni,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>oe,CubicBezierCurve3:()=>ne,CubicInterpolant:()=>xl,CullFaceBack:()=>M,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>G,Curve:()=>xr,CurvePath:()=>Fe,CustomBlending:()=>be,CustomToneMapping:()=>Wr,CylinderBufferGeometry:()=>Do,CylinderGeometry:()=>Pn,Cylindrical:()=>Td,DataTexture:()=>gl,DataTexture2DArray:()=>gs,DataTexture3D:()=>ga,DataTextureLoader:()=>Ua,DecrementStencilOp:()=>Bt,DecrementWrapStencilOp:()=>pn,DefaultLoadingManager:()=>Yd,DepthFormat:()=>To,DepthStencilFormat:()=>Ys,DepthTexture:()=>Bu,DirectionalLight:()=>ft,DirectionalLightHelper:()=>Qd,DirectionalLightShadow:()=>Nt,DiscreteInterpolant:()=>Da,DodecahedronBufferGeometry:()=>zl,DodecahedronGeometry:()=>Ul,DoubleSide:()=>Z,DstAlphaFactor:()=>sn,DstColorFactor:()=>An,DynamicBufferAttribute:()=>x_,DynamicCopyUsage:()=>pa,DynamicDrawUsage:()=>Br,DynamicReadUsage:()=>qi,EdgesGeometry:()=>Rh,EdgesHelper:()=>G_,EllipseCurve:()=>a,EqualDepth:()=>rr,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Ws,EquirectangularRefractionMapping:()=>la,Euler:()=>ht,EventDispatcher:()=>da,ExtrudeBufferGeometry:()=>rl,ExtrudeGeometry:()=>su,Face3:()=>ma,Face4:()=>g_,FaceColors:()=>$_,FileLoader:()=>Ss,FlatShading:()=>A,Float32Attribute:()=>D_,Float32BufferAttribute:()=>Un,Float64Attribute:()=>U_,Float64BufferAttribute:()=>Nl,FloatType:()=>Xo,Fog:()=>Xp,FogExp2:()=>hf,Font:()=>Vs,FontLoader:()=>ja,FrontSide:()=>ae,Frustum:()=>eu,GammaEncoding:()=>Ql,Geometry:()=>kr,GeometryUtils:()=>X_,GreaterDepth:()=>or,GreaterEqualDepth:()=>ur,GreaterEqualStencilFunc:()=>es,GreaterStencilFunc:()=>Ar,GridHelper:()=>Df,Group:()=>ba,HalfFloatType:()=>hs,HemisphereLight:()=>at,HemisphereLightHelper:()=>xf,HemisphereLightProbe:()=>lp,IcosahedronBufferGeometry:()=>xa,IcosahedronGeometry:()=>Dl,ImageBitmapLoader:()=>Uo,ImageLoader:()=>pu,ImageUtils:()=>Zi,ImmediateRenderObject:()=>pp,IncrementStencilOp:()=>Mt,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>lr,InstancedBufferGeometry:()=>Hn,InstancedInterleavedBuffer:()=>hm,InstancedMesh:()=>Zo,Int16Attribute:()=>I_,Int16BufferAttribute:()=>Zh,Int32Attribute:()=>k_,Int32BufferAttribute:()=>Kn,Int8Attribute:()=>N_,Int8BufferAttribute:()=>dl,IntType:()=>Hp,InterleavedBuffer:()=>Pa,InterleavedBufferAttribute:()=>Lh,Interpolant:()=>Sa,InterpolateDiscrete:()=>Jl,InterpolateLinear:()=>Zl,InterpolateSmooth:()=>Ku,InvertStencilOp:()=>Fn,JSONLoader:()=>J_,KeepStencilOp:()=>qe,KeyframeTrack:()=>as,LOD:()=>Op,LatheBufferGeometry:()=>Fu,LatheGeometry:()=>Fa,Layers:()=>bu,LensFlare:()=>Q_,LessDepth:()=>mn,LessEqualDepth:()=>cr,LessEqualStencilFunc:()=>ti,LessStencilFunc:()=>Sn,Light:()=>Ye,LightProbe:()=>xn,LightShadow:()=>pt,Line:()=>Us,Line3:()=>Ff,LineBasicMaterial:()=>$o,LineCurve:()=>ve,LineCurve3:()=>xe,LineDashedMaterial:()=>wa,LineLoop:()=>Jp,LinePieces:()=>Mm,LineSegments:()=>Ii,LineStrip:()=>A_,LinearEncoding:()=>Ji,LinearFilter:()=>ai,LinearInterpolant:()=>uu,LinearMipMapLinearFilter:()=>Gp,LinearMipMapNearestFilter:()=>kh,LinearMipmapLinearFilter:()=>sl,LinearMipmapNearestFilter:()=>Gc,LinearToneMapping:()=>mi,Loader:()=>Ti,LoaderUtils:()=>ir,LoadingManager:()=>Xd,LogLuvEncoding:()=>Wh,LoopOnce:()=>gu,LoopPingPong:()=>bc,LoopRepeat:()=>qa,LuminanceAlphaFormat:()=>Wu,LuminanceFormat:()=>Vc,MOUSE:()=>B,Material:()=>Ur,MaterialLoader:()=>wr,Math:()=>er,MathUtils:()=>er,Matrix3:()=>Ho,Matrix4:()=>ri,MaxEquation:()=>Ke,Mesh:()=>Ci,MeshBasicMaterial:()=>Ki,MeshDepthMaterial:()=>np,MeshDistanceMaterial:()=>Ks,MeshFaceMaterial:()=>Am,MeshLambertMaterial:()=>qo,MeshMatcapMaterial:()=>rs,MeshNormalMaterial:()=>uo,MeshPhongMaterial:()=>Ko,MeshPhysicalMaterial:()=>oo,MeshStandardMaterial:()=>yl,MeshToonMaterial:()=>xs,MinEquation:()=>Xe,MirroredRepeatWrapping:()=>os,MixOperation:()=>pi,MultiMaterial:()=>v_,MultiplyBlending:()=>Q,MultiplyOperation:()=>Kr,NearestFilter:()=>Ir,NearestMipMapLinearFilter:()=>qs,NearestMipMapNearestFilter:()=>Hu,NearestMipmapLinearFilter:()=>us,NearestMipmapNearestFilter:()=>Va,NeverDepth:()=>On,NeverStencilFunc:()=>on,NoBlending:()=>X,NoColors:()=>Ta,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>eh,NormalBlending:()=>he,NotEqualDepth:()=>ni,NotEqualStencilFunc:()=>ds,NumberKeyframeTrack:()=>Gl,Object3D:()=>Qn,ObjectLoader:()=>zr,ObjectSpaceNormalMap:()=>Be,OctahedronBufferGeometry:()=>zs,OctahedronGeometry:()=>Bh,OneFactor:()=>dt,OneMinusDstAlphaFactor:()=>gt,OneMinusDstColorFactor:()=>Bn,OneMinusSrcAlphaFactor:()=>Dt,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>Pt,PCFShadowMap:()=>ie,PCFSoftShadowMap:()=>ce,PMREMGenerator:()=>Em,ParametricBufferGeometry:()=>Fc,ParametricGeometry:()=>hh,Particle:()=>L_,ParticleBasicMaterial:()=>r_,ParticleSystem:()=>y_,ParticleSystemMaterial:()=>B_,Path:()=>je,PerspectiveCamera:()=>Ns,Plane:()=>Yo,PlaneBufferGeometry:()=>Il,PlaneGeometry:()=>Ka,PlaneHelper:()=>Kd,PointCloud:()=>C_,PointCloudMaterial:()=>$m,PointLight:()=>jt,PointLightHelper:()=>bf,Points:()=>kc,PointsMaterial:()=>kl,PolarGridHelper:()=>gm,PolyhedronBufferGeometry:()=>bs,PolyhedronGeometry:()=>Nu,PositionalAudio:()=>Zd,PropertyBinding:()=>Sl,PropertyMixer:()=>vf,QuadraticBezierCurve:()=>Te,QuadraticBezierCurve3:()=>Ce,Quaternion:()=>vo,QuaternionKeyframeTrack:()=>ho,QuaternionLinearInterpolant:()=>Uu,REVISION:()=>x,RGBADepthPacking:()=>pe,RGBAFormat:()=>ao,RGBAIntegerFormat:()=>yh,RGBA_ASTC_10x10_Format:()=>ul,RGBA_ASTC_10x5_Format:()=>Ju,RGBA_ASTC_10x6_Format:()=>cl,RGBA_ASTC_10x8_Format:()=>zh,RGBA_ASTC_12x10_Format:()=>jh,RGBA_ASTC_12x12_Format:()=>Zu,RGBA_ASTC_4x4_Format:()=>Xu,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>Wc,RGBA_ASTC_6x6_Format:()=>_c,RGBA_ASTC_8x5_Format:()=>xh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Yu,RGBA_BPTC_Format:()=>vc,RGBA_ETC2_EAC_Format:()=>Xl,RGBA_PVRTC_2BPPV1_Format:()=>ql,RGBA_PVRTC_4BPPV1_Format:()=>Ml,RGBA_S3TC_DXT1_Format:()=>mc,RGBA_S3TC_DXT3_Format:()=>Dh,RGBA_S3TC_DXT5_Format:()=>bh,RGBDEncoding:()=>vu,RGBEEncoding:()=>Yc,RGBEFormat:()=>vh,RGBFormat:()=>Os,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>nh,RGBM7Encoding:()=>xc,RGB_ETC1_Format:()=>qu,RGB_ETC2_Format:()=>ps,RGB_PVRTC_2BPPV1_Format:()=>Tl,RGB_PVRTC_4BPPV1_Format:()=>Uh,RGB_S3TC_DXT1_Format:()=>Fh,RGFormat:()=>mu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>ra,Ray:()=>lo,Raycaster:()=>pm,RectAreaLight:()=>Zt,RedFormat:()=>Vp,RedIntegerFormat:()=>ll,ReinhardToneMapping:()=>_o,RepeatWrapping:()=>go,ReplaceStencilOp:()=>et,ReverseSubtractEquation:()=>Ae,RingBufferGeometry:()=>lu,RingGeometry:()=>ku,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Gh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Hh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Wp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>yc,SRGB8_ALPHA8_ASTC_5x4_Format:()=>wh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>_u,SRGB8_ALPHA8_ASTC_6x5_Format:()=>qc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Xc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Qu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Yl,Scene:()=>Cl,SceneUtils:()=>Z_,ShaderChunk:()=>Fr,ShaderLib:()=>Nc,ShaderMaterial:()=>co,ShadowMaterial:()=>Qi,Shape:()=>Ue,ShapeBufferGeometry:()=>Xn,ShapeGeometry:()=>cu,ShapePath:()=>Hs,ShapeUtils:()=>Iu,ShortType:()=>Wa,Skeleton:()=>mf,SkeletonHelper:()=>od,SkinnedMesh:()=>ff,SmoothShading:()=>R,Sphere:()=>jn,SphereBufferGeometry:()=>Ou,SphereGeometry:()=>Yr,Spherical:()=>p_,SphericalHarmonics3:()=>_n,Spline:()=>i_,SplineCurve:()=>Ie,SplineCurve3:()=>S_,SpotLight:()=>At,SpotLightHelper:()=>yf,SpotLightShadow:()=>St,Sprite:()=>nl,SpriteMaterial:()=>_i,SrcAlphaFactor:()=>Gt,SrcAlphaSaturateFactor:()=>dn,SrcColorFactor:()=>It,StaticCopyUsage:()=>wc,StaticDrawUsage:()=>bi,StaticReadUsage:()=>Wi,StereoCamera:()=>up,StreamCopyUsage:()=>pl,StreamDrawUsage:()=>Xa,StreamReadUsage:()=>qh,StringKeyframeTrack:()=>dh,SubtractEquation:()=>Ge,SubtractiveBlending:()=>Re,TOUCH:()=>D,TangentSpaceNormalMap:()=>Me,TetrahedronBufferGeometry:()=>ph,TetrahedronGeometry:()=>Ru,TextBufferGeometry:()=>Mr,TextGeometry:()=>eo,Texture:()=>di,TextureLoader:()=>vi,TorusBufferGeometry:()=>ou,TorusGeometry:()=>rp,TorusKnotBufferGeometry:()=>Co,TorusKnotGeometry:()=>Nh,Triangle:()=>Pr,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Vh,TubeBufferGeometry:()=>Is,TubeGeometry:()=>jl,UVMapping:()=>yi,Uint16Attribute:()=>O_,Uint16BufferAttribute:()=>Bl,Uint32Attribute:()=>F_,Uint32BufferAttribute:()=>fl,Uint8Attribute:()=>R_,Uint8BufferAttribute:()=>Cc,Uint8ClampedAttribute:()=>P_,Uint8ClampedBufferAttribute:()=>ih,Uniform:()=>kf,UniformsLib:()=>hr,UniformsUtils:()=>Ro,UnsignedByteType:()=>ca,UnsignedInt248Type:()=>Ts,UnsignedIntType:()=>Xs,UnsignedShort4444Type:()=>Vu,UnsignedShort5551Type:()=>du,UnsignedShort565Type:()=>fu,UnsignedShortType:()=>Hc,VSMShadowMap:()=>fe,Vector2:()=>En,Vector3:()=>lt,Vector4:()=>xi,VectorKeyframeTrack:()=>hu,Vertex:()=>b_,VertexColors:()=>Ha,VideoTexture:()=>xd,WebGL1Renderer:()=>uf,WebGLCubeRenderTarget:()=>Pl,WebGLMultisampleRenderTarget:()=>Xh,WebGLRenderTarget:()=>Fs,WebGLRenderTargetCube:()=>q_,WebGLRenderer:()=>_d,WebGLUtils:()=>zd,WireframeGeometry:()=>hc,WireframeHelper:()=>H_,WrapAroundEnding:()=>Al,XHRLoader:()=>V_,ZeroCurvatureEnding:()=>$a,ZeroFactor:()=>yt,ZeroSlopeEnding:()=>ua,ZeroStencilOp:()=>Ve,sRGBEncoding:()=>hl}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const u=Object(t);for(let m=1;m<arguments.length;m++){const g=arguments[m];if(null!=g)for(const E in g)Object.prototype.hasOwnProperty.call(g,E)&&(u[E]=g[E])}return u});const x="119",B={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},D={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,M=1,P=2,de=3,ye=0,ie=1,ce=2,fe=3,ae=0,W=1,Z=2,A=1,R=2,X=0,he=1,U=2,Re=3,Q=4,be=5,Pe=100,Ge=101,Ae=102,Xe=103,Ke=104,yt=200,dt=201,It=202,wt=203,Gt=204,Dt=205,sn=206,gt=207,An=208,Bn=209,dn=210,On=0,Ln=1,mn=2,cr=3,rr=4,ur=5,or=6,ni=7,Kr=0,pi=1,nr=2,vr=0,mi=1,_o=2,Nr=3,ei=4,Wr=5,yi=300,Ei=301,So=302,Ws=303,la=304,Ni=306,Eo=307,go=1e3,Jr=1001,os=1002,Ir=1003,Va=1004,Hu=1004,us=1005,qs=1005,ai=1006,Gc=1007,kh=1007,sl=1008,Gp=1008,ca=1009,Wl=1010,Wa=1011,Hc=1012,Hp=1013,Xs=1014,Xo=1015,hs=1016,Vu=1017,du=1018,fu=1019,Ts=1020,dp=1021,Os=1022,ao=1023,Vc=1024,Wu=1025,vh=ao,To=1026,Ys=1027,Vp=1028,ll=1029,mu=1030,fp=1031,mp=1032,yh=1033,Fh=33776,mc=33777,Dh=33778,bh=33779,Uh=35840,Tl=35841,Ml=35842,ql=35843,qu=36196,ps=37492,Xl=37496,Xu=37808,_p=37809,gp=37810,Wc=37811,_c=37812,xh=37813,vp=37814,Yu=37815,Ju=37816,cl=37817,zh=37818,ul=37819,jh=37820,Zu=37821,vc=36492,yc=37840,wh=37841,_u=37842,qc=37843,yp=37844,Xc=37845,Qu=37846,Yl=37847,bp=37848,Gh=37849,xp=37850,wp=37851,Hh=37852,Wp=37853,gu=2200,qa=2201,bc=2202,Jl=2300,Zl=2301,Ku=2302,$a=2400,ua=2401,Al=2402,eh=2500,th=2501,Vh=0,Sp=1,Ep=2,Ji=3e3,hl=3001,Ql=3007,Yc=3002,Wh=3003,xc=3004,nh=3005,vu=3006,q=3200,pe=3201,Me=0,Be=1,Ve=0,qe=7680,et=7681,Mt=7682,Bt=7683,Xt=34055,pn=34056,Fn=5386,on=512,Sn=513,Er=514,ti=515,Ar=516,ds=517,es=518,ha=519,bi=35044,Br=35048,Xa=35040,Wi=35045,qi=35049,qh=35041,wc=35046,pa=35050,pl=35042;function da(){}Object.assign(da.prototype,{addEventListener:function(t,u){void 0===this._listeners&&(this._listeners={});const m=this._listeners;void 0===m[t]&&(m[t]=[]),-1===m[t].indexOf(u)&&m[t].push(u)},hasEventListener:function(t,u){if(void 0===this._listeners)return!1;const m=this._listeners;return void 0!==m[t]&&-1!==m[t].indexOf(u)},removeEventListener:function(t,u){if(void 0===this._listeners)return;const m=this._listeners[t];if(void 0!==m){const g=m.indexOf(u);-1!==g&&m.splice(g,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const u=this._listeners[t.type];if(void 0!==u){t.target=this;const m=u.slice(0);for(let g=0,E=m.length;g<E;g++)m[g].call(this,t)}}});const Ri=[];for(let t=0;t<256;t++)Ri[t]=(t<16?"0":"")+t.toString(16);let ks=1234567;const er={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,u=4294967295*Math.random()|0,m=4294967295*Math.random()|0,g=4294967295*Math.random()|0;return(Ri[255&t]+Ri[t>>8&255]+Ri[t>>16&255]+Ri[t>>24&255]+"-"+Ri[255&u]+Ri[u>>8&255]+"-"+Ri[u>>16&15|64]+Ri[u>>24&255]+"-"+Ri[63&m|128]+Ri[m>>8&255]+"-"+Ri[m>>16&255]+Ri[m>>24&255]+Ri[255&g]+Ri[g>>8&255]+Ri[g>>16&255]+Ri[g>>24&255]).toUpperCase()},clamp:function(t,u,m){return Math.max(u,Math.min(m,t))},euclideanModulo:function(t,u){return(t%u+u)%u},mapLinear:function(t,u,m,g,E){return g+(t-u)*(E-g)/(m-u)},lerp:function(t,u,m){return(1-m)*t+m*u},smoothstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*(3-2*t)},smootherstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*t*(t*(6*t-15)+10)},randInt:function(t,u){return t+Math.floor(Math.random()*(u-t+1))},randFloat:function(t,u){return t+Math.random()*(u-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(ks=t%2147483647),ks=16807*ks%2147483647,(ks-1)/2147483646},degToRad:function(t){return t*er.DEG2RAD},radToDeg:function(t){return t*er.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,u,m,g,E){const I=Math.cos,H=Math.sin,J=I(m/2),Y=H(m/2),K=I((u+g)/2),me=H((u+g)/2),ge=I((u-g)/2),Se=H((u-g)/2),w=I((g-u)/2),e=H((g-u)/2);switch(E){case"XYX":t.set(J*me,Y*ge,Y*Se,J*K);break;case"YZY":t.set(Y*Se,J*me,Y*ge,J*K);break;case"ZXZ":t.set(Y*ge,Y*Se,J*me,J*K);break;case"XZX":t.set(J*me,Y*e,Y*w,J*K);break;case"YXY":t.set(Y*w,J*me,Y*e,J*K);break;case"ZYZ":t.set(Y*e,Y*w,J*me,J*K);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+E)}}};function En(t=0,u=0){this.x=t,this.y=u}function Ho(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let ss;Object.defineProperties(En.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(En.prototype,{isVector2:!0,set:function(t,u){return this.x=t,this.y=u,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){const u=this.x,m=this.y,g=t.elements;return this.x=g[0]*u+g[3]*m+g[6],this.y=g[1]*u+g[4]*m+g[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y;return u*u+m*m},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this},rotateAround:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=this.x-t.x,I=this.y-t.y;return this.x=E*m-I*g+t.x,this.y=E*g+I*m+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(Ho.prototype,{isMatrix3:!0,set:function(t,u,m,g,E,I,H,J,Y){const K=this.elements;return K[0]=t,K[1]=g,K[2]=H,K[3]=u,K[4]=E,K[5]=J,K[6]=m,K[7]=I,K[8]=Y,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],this},extractBasis:function(t,u,m){return t.setFromMatrix3Column(this,0),u.setFromMatrix3Column(this,1),m.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){const u=t.elements;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],H=m[3],J=m[6],Y=m[1],K=m[4],me=m[7],ge=m[2],Se=m[5],w=m[8],e=g[0],c=g[3],d=g[6],_=g[1],S=g[4],L=g[7],k=g[2],F=g[5],V=g[8];return E[0]=I*e+H*_+J*k,E[3]=I*c+H*S+J*F,E[6]=I*d+H*L+J*V,E[1]=Y*e+K*_+me*k,E[4]=Y*c+K*S+me*F,E[7]=Y*d+K*L+me*V,E[2]=ge*e+Se*_+w*k,E[5]=ge*c+Se*S+w*F,E[8]=ge*d+Se*L+w*V,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[3]*=t,u[6]*=t,u[1]*=t,u[4]*=t,u[7]*=t,u[2]*=t,u[5]*=t,u[8]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[1],g=t[2],E=t[3],I=t[4],H=t[5],J=t[6],Y=t[7],K=t[8];return u*I*K-u*H*Y-m*E*K+m*H*J+g*E*Y-g*I*J},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const m=t.elements,g=this.elements,E=m[0],I=m[1],H=m[2],J=m[3],Y=m[4],K=m[5],me=m[6],ge=m[7],Se=m[8],w=Se*Y-K*ge,e=K*me-Se*J,c=ge*J-Y*me,d=E*w+I*e+H*c;if(0===d)return this.set(0,0,0,0,0,0,0,0,0);const _=1/d;return g[0]=w*_,g[1]=(H*ge-Se*I)*_,g[2]=(K*I-H*Y)*_,g[3]=e*_,g[4]=(Se*E-H*me)*_,g[5]=(H*J-K*E)*_,g[6]=c*_,g[7]=(I*me-ge*E)*_,g[8]=(Y*E-I*J)*_,this},transpose:function(){let t;const u=this.elements;return t=u[1],u[1]=u[3],u[3]=t,t=u[2],u[2]=u[6],u[6]=t,t=u[5],u[5]=u[7],u[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){const u=this.elements;return t[0]=u[0],t[1]=u[3],t[2]=u[6],t[3]=u[1],t[4]=u[4],t[5]=u[7],t[6]=u[2],t[7]=u[5],t[8]=u[8],this},setUvTransform:function(t,u,m,g,E,I,H){const J=Math.cos(E),Y=Math.sin(E);this.set(m*J,m*Y,-m*(J*I+Y*H)+I+t,-g*Y,g*J,-g*(-Y*I+J*H)+H+u,0,0,1)},scale:function(t,u){const m=this.elements;return m[0]*=t,m[3]*=t,m[6]*=t,m[1]*=u,m[4]*=u,m[7]*=u,this},rotate:function(t){const u=Math.cos(t),m=Math.sin(t),g=this.elements,E=g[0],I=g[3],H=g[6],J=g[1],Y=g[4],K=g[7];return g[0]=u*E+m*J,g[3]=u*I+m*Y,g[6]=u*H+m*K,g[1]=-m*E+u*J,g[4]=-m*I+u*Y,g[7]=-m*H+u*K,this},translate:function(t,u){const m=this.elements;return m[0]+=t*m[2],m[3]+=t*m[5],m[6]+=t*m[8],m[1]+=u*m[2],m[4]+=u*m[5],m[7]+=u*m[8],this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<9;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<9;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t}});const Zi={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let u;if(t instanceof HTMLCanvasElement)u=t;else{void 0===ss&&(ss=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ss.width=t.width,ss.height=t.height;const m=ss.getContext("2d");t instanceof ImageData?m.putImageData(t,0,0):m.drawImage(t,0,0,t.width,t.height),u=ss}return u.width>2048||u.height>2048?u.toDataURL("image/jpeg",.6):u.toDataURL("image/png")}};let Hr=0;function di(t,u,m,g,E,I,H,J,Y,K){Object.defineProperty(this,"id",{value:Hr++}),this.uuid=er.generateUUID(),this.name="",this.image=void 0!==t?t:di.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==u?u:di.DEFAULT_MAPPING,this.wrapS=void 0!==m?m:Jr,this.wrapT=void 0!==g?g:Jr,this.magFilter=void 0!==E?E:ai,this.minFilter=void 0!==I?I:sl,this.anisotropy=void 0!==Y?Y:1,this.format=void 0!==H?H:ao,this.internalFormat=null,this.type=void 0!==J?J:ca,this.offset=new En(0,0),this.repeat=new En(1,1),this.center=new En(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ho,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==K?K:Ji,this.version=0,this.onUpdate=null}function xi(t=0,u=0,m=0,g=1){this.x=t,this.y=u,this.z=m,this.w=g}function Fs(t,u,m){this.width=t,this.height=u,this.scissor=new xi(0,0,t,u),this.scissorTest=!1,this.viewport=new xi(0,0,t,u),this.texture=new di(void 0,(m=m||{}).mapping,m.wrapS,m.wrapT,m.magFilter,m.minFilter,m.format,m.type,m.anisotropy,m.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=u,this.texture.generateMipmaps=void 0!==m.generateMipmaps&&m.generateMipmaps,this.texture.minFilter=void 0!==m.minFilter?m.minFilter:ai,this.depthBuffer=void 0===m.depthBuffer||m.depthBuffer,this.stencilBuffer=void 0===m.stencilBuffer||m.stencilBuffer,this.depthTexture=void 0!==m.depthTexture?m.depthTexture:null}function Xh(t,u,m){Fs.call(this,t,u,m),this.samples=4}function vo(t=0,u=0,m=0,g=1){this._x=t,this._y=u,this._z=m,this._w=g}di.DEFAULT_IMAGE=void 0,di.DEFAULT_MAPPING=yi,di.prototype=Object.assign(Object.create(da.prototype),{constructor:di,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const u=void 0===t||"string"==typeof t;if(!u&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const m={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const g=this.image;if(void 0===g.uuid&&(g.uuid=er.generateUUID()),!u&&void 0===t.images[g.uuid]){let E;if(Array.isArray(g)){E=[];for(let I=0,H=g.length;I<H;I++)E.push(Zi.getDataURL(g[I]))}else E=Zi.getDataURL(g);t.images[g.uuid]={uuid:g.uuid,url:E}}m.image=g.uuid}return u||(t.textures[this.uuid]=m),m},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==yi)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case go:t.x=t.x-Math.floor(t.x);break;case Jr:t.x=t.x<0?0:1;break;case os:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case go:t.y=t.y-Math.floor(t.y);break;case Jr:t.y=t.y<0?0:1;break;case os:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(di.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(xi.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(xi.prototype,{isVector4:!0,set:function(t,u,m,g){return this.x=t,this.y=u,this.z=m,this.w=g,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this.w=t.w+u.w,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this.w+=t.w*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this.w=t.w-u.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=this.w,I=t.elements;return this.x=I[0]*u+I[4]*m+I[8]*g+I[12]*E,this.y=I[1]*u+I[5]*m+I[9]*g+I[13]*E,this.z=I[2]*u+I[6]*m+I[10]*g+I[14]*E,this.w=I[3]*u+I[7]*m+I[11]*g+I[15]*E,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);const u=Math.sqrt(1-t.w*t.w);return u<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/u,this.y=t.y/u,this.z=t.z/u),this},setAxisAngleFromRotationMatrix:function(t){let u,m,g,E;const J=t.elements,Y=J[0],K=J[4],me=J[8],ge=J[1],Se=J[5],w=J[9],e=J[2],c=J[6],d=J[10];if(Math.abs(K-ge)<.01&&Math.abs(me-e)<.01&&Math.abs(w-c)<.01){if(Math.abs(K+ge)<.1&&Math.abs(me+e)<.1&&Math.abs(w+c)<.1&&Math.abs(Y+Se+d-3)<.1)return this.set(1,0,0,0),this;u=Math.PI;const S=(Y+1)/2,L=(Se+1)/2,k=(d+1)/2,F=(K+ge)/4,V=(me+e)/4,te=(w+c)/4;return S>L&&S>k?S<.01?(m=0,g=.707106781,E=.707106781):(m=Math.sqrt(S),g=F/m,E=V/m):L>k?L<.01?(m=.707106781,g=0,E=.707106781):(g=Math.sqrt(L),m=F/g,E=te/g):k<.01?(m=.707106781,g=.707106781,E=0):(E=Math.sqrt(k),m=V/E,g=te/E),this.set(m,g,E,u),this}let _=Math.sqrt((c-w)*(c-w)+(me-e)*(me-e)+(ge-K)*(ge-K));return Math.abs(_)<.001&&(_=1),this.x=(c-w)/_,this.y=(me-e)/_,this.z=(ge-K)/_,this.w=Math.acos((Y+Se+d-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this.w=Math.max(t.w,Math.min(u.w,this.w)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this.w=Math.max(t,Math.min(u,this.w)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this.w+=(t.w-this.w)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this.w=t.w+(u.w-t.w)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this.w=t[u+3],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t[u+3]=this.w,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this.w=t.getW(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Fs.prototype=Object.assign(Object.create(da.prototype),{constructor:Fs,isWebGLRenderTarget:!0,setSize:function(t,u){this.width===t&&this.height===u||(this.width=t,this.height=u,this.texture.image.width=t,this.texture.image.height=u,this.dispose()),this.viewport.set(0,0,t,u),this.scissor.set(0,0,t,u)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Xh.prototype=Object.assign(Object.create(Fs.prototype),{constructor:Xh,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Fs.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(vo,{slerp:function(t,u,m,g){return m.copy(t).slerp(u,g)},slerpFlat:function(t,u,m,g,E,I,H){let J=m[g+0],Y=m[g+1],K=m[g+2],me=m[g+3];const ge=E[I+0],Se=E[I+1],w=E[I+2],e=E[I+3];if(me!==e||J!==ge||Y!==Se||K!==w){let c=1-H,d=J*ge+Y*Se+K*w+me*e,_=d>=0?1:-1,S=1-d*d;if(S>Number.EPSILON){const k=Math.sqrt(S),F=Math.atan2(k,d*_);c=Math.sin(c*F)/k,H=Math.sin(H*F)/k}const L=H*_;if(J=J*c+ge*L,Y=Y*c+Se*L,K=K*c+w*L,me=me*c+e*L,c===1-H){const k=1/Math.sqrt(J*J+Y*Y+K*K+me*me);J*=k,Y*=k,K*=k,me*=k}}t[u]=J,t[u+1]=Y,t[u+2]=K,t[u+3]=me},multiplyQuaternionsFlat:function(t,u,m,g,E,I){const H=m[g],J=m[g+1],Y=m[g+2],K=m[g+3],me=E[I],ge=E[I+1],Se=E[I+2],w=E[I+3];return t[u]=H*w+K*me+J*Se-Y*ge,t[u+1]=J*w+K*ge+Y*me-H*Se,t[u+2]=Y*w+K*Se+H*ge-J*me,t[u+3]=K*w-H*me-J*ge-Y*Se,t}}),Object.defineProperties(vo.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(vo.prototype,{isQuaternion:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._w=g,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,u){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const m=t._x,g=t._y,E=t._z,I=t.order,H=Math.cos,J=Math.sin,Y=H(m/2),K=H(g/2),me=H(E/2),ge=J(m/2),Se=J(g/2),w=J(E/2);switch(I){case"XYZ":this._x=ge*K*me+Y*Se*w,this._y=Y*Se*me-ge*K*w,this._z=Y*K*w+ge*Se*me,this._w=Y*K*me-ge*Se*w;break;case"YXZ":this._x=ge*K*me+Y*Se*w,this._y=Y*Se*me-ge*K*w,this._z=Y*K*w-ge*Se*me,this._w=Y*K*me+ge*Se*w;break;case"ZXY":this._x=ge*K*me-Y*Se*w,this._y=Y*Se*me+ge*K*w,this._z=Y*K*w+ge*Se*me,this._w=Y*K*me-ge*Se*w;break;case"ZYX":this._x=ge*K*me-Y*Se*w,this._y=Y*Se*me+ge*K*w,this._z=Y*K*w-ge*Se*me,this._w=Y*K*me+ge*Se*w;break;case"YZX":this._x=ge*K*me+Y*Se*w,this._y=Y*Se*me+ge*K*w,this._z=Y*K*w-ge*Se*me,this._w=Y*K*me-ge*Se*w;break;case"XZY":this._x=ge*K*me-Y*Se*w,this._y=Y*Se*me-ge*K*w,this._z=Y*K*w+ge*Se*me,this._w=Y*K*me+ge*Se*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+I)}return!1!==u&&this._onChangeCallback(),this},setFromAxisAngle:function(t,u){const m=u/2,g=Math.sin(m);return this._x=t.x*g,this._y=t.y*g,this._z=t.z*g,this._w=Math.cos(m),this._onChangeCallback(),this},setFromRotationMatrix:function(t){const u=t.elements,m=u[0],g=u[4],E=u[8],I=u[1],H=u[5],J=u[9],Y=u[2],K=u[6],me=u[10],ge=m+H+me;if(ge>0){const Se=.5/Math.sqrt(ge+1);this._w=.25/Se,this._x=(K-J)*Se,this._y=(E-Y)*Se,this._z=(I-g)*Se}else if(m>H&&m>me){const Se=2*Math.sqrt(1+m-H-me);this._w=(K-J)/Se,this._x=.25*Se,this._y=(g+I)/Se,this._z=(E+Y)/Se}else if(H>me){const Se=2*Math.sqrt(1+H-m-me);this._w=(E-Y)/Se,this._x=(g+I)/Se,this._y=.25*Se,this._z=(J+K)/Se}else{const Se=2*Math.sqrt(1+me-m-H);this._w=(I-g)/Se,this._x=(E+Y)/Se,this._y=(J+K)/Se,this._z=.25*Se}return this._onChangeCallback(),this},setFromUnitVectors:function(t,u){let m=t.dot(u)+1;return m<1e-6?(m=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=m):(this._x=0,this._y=-t.z,this._z=t.y,this._w=m)):(this._x=t.y*u.z-t.z*u.y,this._y=t.z*u.x-t.x*u.z,this._z=t.x*u.y-t.y*u.x,this._w=m),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(er.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,u){const m=this.angleTo(t);if(0===m)return this;const g=Math.min(1,u/m);return this.slerp(t,g),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,u)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,u){const m=t._x,g=t._y,E=t._z,I=t._w,H=u._x,J=u._y,Y=u._z,K=u._w;return this._x=m*K+I*H+g*Y-E*J,this._y=g*K+I*J+E*H-m*Y,this._z=E*K+I*Y+m*J-g*H,this._w=I*K-m*H-g*J-E*Y,this._onChangeCallback(),this},slerp:function(t,u){if(0===u)return this;if(1===u)return this.copy(t);const m=this._x,g=this._y,E=this._z,I=this._w;let H=I*t._w+m*t._x+g*t._y+E*t._z;if(H<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,H=-H):this.copy(t),H>=1)return this._w=I,this._x=m,this._y=g,this._z=E,this;const J=1-H*H;if(J<=Number.EPSILON){const Se=1-u;return this._w=Se*I+u*this._w,this._x=Se*m+u*this._x,this._y=Se*g+u*this._y,this._z=Se*E+u*this._z,this.normalize(),this._onChangeCallback(),this}const Y=Math.sqrt(J),K=Math.atan2(Y,H),me=Math.sin((1-u)*K)/Y,ge=Math.sin(u*K)/Y;return this._w=I*me+this._w*ge,this._x=m*me+this._x*ge,this._y=g*me+this._y*ge,this._z=E*me+this._z*ge,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,u){return void 0===u&&(u=0),this._x=t[u],this._y=t[u+1],this._z=t[u+2],this._w=t[u+3],this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._w,t},fromBufferAttribute:function(t,u){return this._x=t.getX(u),this._y=t.getY(u),this._z=t.getZ(u),this._w=t.getW(u),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});const yu=new lt,zn=new vo;function lt(t=0,u=0,m=0){this.x=t,this.y=u,this.z=m}Object.assign(lt.prototype,{isVector3:!0,set:function(t,u,m){return void 0===m&&(m=this.z),this.x=t,this.y=u,this.z=m,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,u)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,u){return this.x=t.x*u.x,this.y=t.y*u.y,this.z=t.z*u.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(zn.setFromEuler(t))},applyAxisAngle:function(t,u){return this.applyQuaternion(zn.setFromAxisAngle(t,u))},applyMatrix3:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[3]*m+E[6]*g,this.y=E[1]*u+E[4]*m+E[7]*g,this.z=E[2]*u+E[5]*m+E[8]*g,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements,I=1/(E[3]*u+E[7]*m+E[11]*g+E[15]);return this.x=(E[0]*u+E[4]*m+E[8]*g+E[12])*I,this.y=(E[1]*u+E[5]*m+E[9]*g+E[13])*I,this.z=(E[2]*u+E[6]*m+E[10]*g+E[14])*I,this},applyQuaternion:function(t){const u=this.x,m=this.y,g=this.z,E=t.x,I=t.y,H=t.z,J=t.w,Y=J*u+I*g-H*m,K=J*m+H*u-E*g,me=J*g+E*m-I*u,ge=-E*u-I*m-H*g;return this.x=Y*J+ge*-E+K*-H-me*-I,this.y=K*J+ge*-I+me*-E-Y*-H,this.z=me*J+ge*-H+Y*-I-K*-E,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[4]*m+E[8]*g,this.y=E[1]*u+E[5]*m+E[9]*g,this.z=E[2]*u+E[6]*m+E[10]*g,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this},cross:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,u)):this.crossVectors(this,t)},crossVectors:function(t,u){const m=t.x,g=t.y,E=t.z,I=u.x,H=u.y,J=u.z;return this.x=g*J-E*H,this.y=E*I-m*J,this.z=m*H-g*I,this},projectOnVector:function(t){const u=t.lengthSq();if(0===u)return this.set(0,0,0);const m=t.dot(this)/u;return this.copy(t).multiplyScalar(m)},projectOnPlane:function(t){return yu.copy(this).projectOnVector(t),this.sub(yu)},reflect:function(t){return this.sub(yu.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){const u=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===u)return Math.PI/2;const m=this.dot(t)/u;return Math.acos(er.clamp(m,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y,g=this.z-t.z;return u*u+m*m+g*g},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,u,m){const g=Math.sin(u)*t;return this.x=g*Math.sin(m),this.y=Math.cos(u)*t,this.z=g*Math.cos(m),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,u,m){return this.x=t*Math.sin(u),this.y=m,this.z=t*Math.cos(u),this},setFromMatrixPosition:function(t){const u=t.elements;return this.x=u[12],this.y=u[13],this.z=u[14],this},setFromMatrixScale:function(t){const u=this.setFromMatrixColumn(t,0).length(),m=this.setFromMatrixColumn(t,1).length(),g=this.setFromMatrixColumn(t,2).length();return this.x=u,this.y=m,this.z=g,this},setFromMatrixColumn:function(t,u){return this.fromArray(t.elements,4*u)},setFromMatrix3Column:function(t,u){return this.fromArray(t.elements,3*u)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const $l=new lt,Ms=new ri,Tp=new lt(0,0,0),As=new lt(1,1,1),Sc=new lt,Di=new lt,ro=new lt;function ri(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ri.prototype,{isMatrix4:!0,set:function(t,u,m,g,E,I,H,J,Y,K,me,ge,Se,w,e,c){const d=this.elements;return d[0]=t,d[4]=u,d[8]=m,d[12]=g,d[1]=E,d[5]=I,d[9]=H,d[13]=J,d[2]=Y,d[6]=K,d[10]=me,d[14]=ge,d[3]=Se,d[7]=w,d[11]=e,d[15]=c,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ri).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],u[9]=m[9],u[10]=m[10],u[11]=m[11],u[12]=m[12],u[13]=m[13],u[14]=m[14],u[15]=m[15],this},copyPosition:function(t){const u=this.elements,m=t.elements;return u[12]=m[12],u[13]=m[13],u[14]=m[14],this},extractBasis:function(t,u,m){return t.setFromMatrixColumn(this,0),u.setFromMatrixColumn(this,1),m.setFromMatrixColumn(this,2),this},makeBasis:function(t,u,m){return this.set(t.x,u.x,m.x,0,t.y,u.y,m.y,0,t.z,u.z,m.z,0,0,0,0,1),this},extractRotation:function(t){const u=this.elements,m=t.elements,g=1/$l.setFromMatrixColumn(t,0).length(),E=1/$l.setFromMatrixColumn(t,1).length(),I=1/$l.setFromMatrixColumn(t,2).length();return u[0]=m[0]*g,u[1]=m[1]*g,u[2]=m[2]*g,u[3]=0,u[4]=m[4]*E,u[5]=m[5]*E,u[6]=m[6]*E,u[7]=0,u[8]=m[8]*I,u[9]=m[9]*I,u[10]=m[10]*I,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const u=this.elements,m=t.x,g=t.y,E=t.z,I=Math.cos(m),H=Math.sin(m),J=Math.cos(g),Y=Math.sin(g),K=Math.cos(E),me=Math.sin(E);if("XYZ"===t.order){const ge=I*K,Se=I*me,w=H*K,e=H*me;u[0]=J*K,u[4]=-J*me,u[8]=Y,u[1]=Se+w*Y,u[5]=ge-e*Y,u[9]=-H*J,u[2]=e-ge*Y,u[6]=w+Se*Y,u[10]=I*J}else if("YXZ"===t.order){const ge=J*K,Se=J*me,w=Y*K,e=Y*me;u[0]=ge+e*H,u[4]=w*H-Se,u[8]=I*Y,u[1]=I*me,u[5]=I*K,u[9]=-H,u[2]=Se*H-w,u[6]=e+ge*H,u[10]=I*J}else if("ZXY"===t.order){const ge=J*K,Se=J*me,w=Y*K,e=Y*me;u[0]=ge-e*H,u[4]=-I*me,u[8]=w+Se*H,u[1]=Se+w*H,u[5]=I*K,u[9]=e-ge*H,u[2]=-I*Y,u[6]=H,u[10]=I*J}else if("ZYX"===t.order){const ge=I*K,Se=I*me,w=H*K,e=H*me;u[0]=J*K,u[4]=w*Y-Se,u[8]=ge*Y+e,u[1]=J*me,u[5]=e*Y+ge,u[9]=Se*Y-w,u[2]=-Y,u[6]=H*J,u[10]=I*J}else if("YZX"===t.order){const ge=I*J,Se=I*Y,w=H*J,e=H*Y;u[0]=J*K,u[4]=e-ge*me,u[8]=w*me+Se,u[1]=me,u[5]=I*K,u[9]=-H*K,u[2]=-Y*K,u[6]=Se*me+w,u[10]=ge-e*me}else if("XZY"===t.order){const ge=I*J,Se=I*Y,w=H*J,e=H*Y;u[0]=J*K,u[4]=-me,u[8]=Y*K,u[1]=ge*me+e,u[5]=I*K,u[9]=Se*me-w,u[2]=w*me-Se,u[6]=H*K,u[10]=e*me+ge}return u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Tp,t,As)},lookAt:function(t,u,m){const g=this.elements;return ro.subVectors(t,u),0===ro.lengthSq()&&(ro.z=1),ro.normalize(),Sc.crossVectors(m,ro),0===Sc.lengthSq()&&(1===Math.abs(m.z)?ro.x+=1e-4:ro.z+=1e-4,ro.normalize(),Sc.crossVectors(m,ro)),Sc.normalize(),Di.crossVectors(ro,Sc),g[0]=Sc.x,g[4]=Di.x,g[8]=ro.x,g[1]=Sc.y,g[5]=Di.y,g[9]=ro.y,g[2]=Sc.z,g[6]=Di.z,g[10]=ro.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,u)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],H=m[4],J=m[8],Y=m[12],K=m[1],me=m[5],ge=m[9],Se=m[13],w=m[2],e=m[6],c=m[10],d=m[14],_=m[3],S=m[7],L=m[11],k=m[15],F=g[0],V=g[4],te=g[8],le=g[12],ue=g[1],_e=g[5],Ee=g[9],$e=g[13],Le=g[2],Ne=g[6],We=g[10],tt=g[14],Ze=g[3],ot=g[7],st=g[11],Ct=g[15];return E[0]=I*F+H*ue+J*Le+Y*Ze,E[4]=I*V+H*_e+J*Ne+Y*ot,E[8]=I*te+H*Ee+J*We+Y*st,E[12]=I*le+H*$e+J*tt+Y*Ct,E[1]=K*F+me*ue+ge*Le+Se*Ze,E[5]=K*V+me*_e+ge*Ne+Se*ot,E[9]=K*te+me*Ee+ge*We+Se*st,E[13]=K*le+me*$e+ge*tt+Se*Ct,E[2]=w*F+e*ue+c*Le+d*Ze,E[6]=w*V+e*_e+c*Ne+d*ot,E[10]=w*te+e*Ee+c*We+d*st,E[14]=w*le+e*$e+c*tt+d*Ct,E[3]=_*F+S*ue+L*Le+k*Ze,E[7]=_*V+S*_e+L*Ne+k*ot,E[11]=_*te+S*Ee+L*We+k*st,E[15]=_*le+S*$e+L*tt+k*Ct,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[4]*=t,u[8]*=t,u[12]*=t,u[1]*=t,u[5]*=t,u[9]*=t,u[13]*=t,u[2]*=t,u[6]*=t,u[10]*=t,u[14]*=t,u[3]*=t,u[7]*=t,u[11]*=t,u[15]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[4],g=t[8],E=t[12],I=t[1],H=t[5],J=t[9],Y=t[13],K=t[2],me=t[6],ge=t[10],Se=t[14];return t[3]*(+E*J*me-g*Y*me-E*H*ge+m*Y*ge+g*H*Se-m*J*Se)+t[7]*(+u*J*Se-u*Y*ge+E*I*ge-g*I*Se+g*Y*K-E*J*K)+t[11]*(+u*Y*me-u*H*Se-E*I*me+m*I*Se+E*H*K-m*Y*K)+t[15]*(-g*H*K-u*J*me+u*H*ge+g*I*me-m*I*ge+m*J*K)},transpose:function(){const t=this.elements;let u;return u=t[1],t[1]=t[4],t[4]=u,u=t[2],t[2]=t[8],t[8]=u,u=t[6],t[6]=t[9],t[9]=u,u=t[3],t[3]=t[12],t[12]=u,u=t[7],t[7]=t[13],t[13]=u,u=t[11],t[11]=t[14],t[14]=u,this},setPosition:function(t,u,m){const g=this.elements;return t.isVector3?(g[12]=t.x,g[13]=t.y,g[14]=t.z):(g[12]=t,g[13]=u,g[14]=m),this},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const m=this.elements,g=t.elements,E=g[0],I=g[1],H=g[2],J=g[3],Y=g[4],K=g[5],me=g[6],ge=g[7],Se=g[8],w=g[9],e=g[10],c=g[11],d=g[12],_=g[13],S=g[14],L=g[15],k=w*S*ge-_*e*ge+_*me*c-K*S*c-w*me*L+K*e*L,F=d*e*ge-Se*S*ge-d*me*c+Y*S*c+Se*me*L-Y*e*L,V=Se*_*ge-d*w*ge+d*K*c-Y*_*c-Se*K*L+Y*w*L,te=d*w*me-Se*_*me-d*K*e+Y*_*e+Se*K*S-Y*w*S,le=E*k+I*F+H*V+J*te;if(0===le)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ue=1/le;return m[0]=k*ue,m[1]=(_*e*J-w*S*J-_*H*c+I*S*c+w*H*L-I*e*L)*ue,m[2]=(K*S*J-_*me*J+_*H*ge-I*S*ge-K*H*L+I*me*L)*ue,m[3]=(w*me*J-K*e*J-w*H*ge+I*e*ge+K*H*c-I*me*c)*ue,m[4]=F*ue,m[5]=(Se*S*J-d*e*J+d*H*c-E*S*c-Se*H*L+E*e*L)*ue,m[6]=(d*me*J-Y*S*J-d*H*ge+E*S*ge+Y*H*L-E*me*L)*ue,m[7]=(Y*e*J-Se*me*J+Se*H*ge-E*e*ge-Y*H*c+E*me*c)*ue,m[8]=V*ue,m[9]=(d*w*J-Se*_*J-d*I*c+E*_*c+Se*I*L-E*w*L)*ue,m[10]=(Y*_*J-d*K*J+d*I*ge-E*_*ge-Y*I*L+E*K*L)*ue,m[11]=(Se*K*J-Y*w*J-Se*I*ge+E*w*ge+Y*I*c-E*K*c)*ue,m[12]=te*ue,m[13]=(Se*_*H-d*w*H+d*I*e-E*_*e-Se*I*S+E*w*S)*ue,m[14]=(d*K*H-Y*_*H-d*I*me+E*_*me+Y*I*S-E*K*S)*ue,m[15]=(Y*w*H-Se*K*H+Se*I*me-E*w*me-Y*I*e+E*K*e)*ue,this},scale:function(t){const u=this.elements,m=t.x,g=t.y,E=t.z;return u[0]*=m,u[4]*=g,u[8]*=E,u[1]*=m,u[5]*=g,u[9]*=E,u[2]*=m,u[6]*=g,u[10]*=E,u[3]*=m,u[7]*=g,u[11]*=E,this},getMaxScaleOnAxis:function(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,u,m){return this.set(1,0,0,t,0,1,0,u,0,0,1,m,0,0,0,1),this},makeRotationX:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(1,0,0,0,0,u,-m,0,0,m,u,0,0,0,0,1),this},makeRotationY:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,0,m,0,0,1,0,0,-m,0,u,0,0,0,0,1),this},makeRotationZ:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,-m,0,0,m,u,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=1-m,I=t.x,H=t.y,J=t.z,Y=E*I,K=E*H;return this.set(Y*I+m,Y*H-g*J,Y*J+g*H,0,Y*H+g*J,K*H+m,K*J-g*I,0,Y*J-g*H,K*J+g*I,E*J*J+m,0,0,0,0,1),this},makeScale:function(t,u,m){return this.set(t,0,0,0,0,u,0,0,0,0,m,0,0,0,0,1),this},makeShear:function(t,u,m){return this.set(1,u,m,0,t,1,m,0,t,u,1,0,0,0,0,1),this},compose:function(t,u,m){const g=this.elements,E=u._x,I=u._y,H=u._z,J=u._w,Y=E+E,K=I+I,me=H+H,ge=E*Y,Se=E*K,w=E*me,e=I*K,c=I*me,d=H*me,_=J*Y,S=J*K,L=J*me,k=m.x,F=m.y,V=m.z;return g[0]=(1-(e+d))*k,g[1]=(Se+L)*k,g[2]=(w-S)*k,g[3]=0,g[4]=(Se-L)*F,g[5]=(1-(ge+d))*F,g[6]=(c+_)*F,g[7]=0,g[8]=(w+S)*V,g[9]=(c-_)*V,g[10]=(1-(ge+e))*V,g[11]=0,g[12]=t.x,g[13]=t.y,g[14]=t.z,g[15]=1,this},decompose:function(t,u,m){const g=this.elements;let E=$l.set(g[0],g[1],g[2]).length(),I=$l.set(g[4],g[5],g[6]).length(),H=$l.set(g[8],g[9],g[10]).length();this.determinant()<0&&(E=-E),t.x=g[12],t.y=g[13],t.z=g[14],Ms.copy(this);const J=1/E,Y=1/I,K=1/H;return Ms.elements[0]*=J,Ms.elements[1]*=J,Ms.elements[2]*=J,Ms.elements[4]*=Y,Ms.elements[5]*=Y,Ms.elements[6]*=Y,Ms.elements[8]*=K,Ms.elements[9]*=K,Ms.elements[10]*=K,u.setFromRotationMatrix(Ms),m.x=E,m.y=I,m.z=H,this},makePerspective:function(t,u,m,g,E,I){void 0===I&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const H=this.elements,Y=2*E/(m-g),K=(u+t)/(u-t),me=(m+g)/(m-g),ge=-(I+E)/(I-E),Se=-2*I*E/(I-E);return H[0]=2*E/(u-t),H[4]=0,H[8]=K,H[12]=0,H[1]=0,H[5]=Y,H[9]=me,H[13]=0,H[2]=0,H[6]=0,H[10]=ge,H[14]=Se,H[3]=0,H[7]=0,H[11]=-1,H[15]=0,this},makeOrthographic:function(t,u,m,g,E,I){const H=this.elements,J=1/(u-t),Y=1/(m-g),K=1/(I-E),me=(u+t)*J,ge=(m+g)*Y,Se=(I+E)*K;return H[0]=2*J,H[4]=0,H[8]=0,H[12]=-me,H[1]=0,H[5]=2*Y,H[9]=0,H[13]=-ge,H[2]=0,H[6]=0,H[10]=-2*K,H[14]=-Se,H[3]=0,H[7]=0,H[11]=0,H[15]=1,this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<16;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<16;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t[u+9]=m[9],t[u+10]=m[10],t[u+11]=m[11],t[u+12]=m[12],t[u+13]=m[13],t[u+14]=m[14],t[u+15]=m[15],t}});const Jc=new ri,$i=new vo;function ht(t=0,u=0,m=0,g=ht.DefaultOrder){this._x=t,this._y=u,this._z=m,this._order=g}function bu(){this.mask=1}ht.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],ht.DefaultOrder="XYZ",Object.defineProperties(ht.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(ht.prototype,{isEuler:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._order=g||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,u,m){const g=er.clamp,E=t.elements,I=E[0],H=E[4],J=E[8],Y=E[1],K=E[5],me=E[9],ge=E[2],Se=E[6],w=E[10];switch(u=u||this._order){case"XYZ":this._y=Math.asin(g(J,-1,1)),Math.abs(J)<.9999999?(this._x=Math.atan2(-me,w),this._z=Math.atan2(-H,I)):(this._x=Math.atan2(Se,K),this._z=0);break;case"YXZ":this._x=Math.asin(-g(me,-1,1)),Math.abs(me)<.9999999?(this._y=Math.atan2(J,w),this._z=Math.atan2(Y,K)):(this._y=Math.atan2(-ge,I),this._z=0);break;case"ZXY":this._x=Math.asin(g(Se,-1,1)),Math.abs(Se)<.9999999?(this._y=Math.atan2(-ge,w),this._z=Math.atan2(-H,K)):(this._y=0,this._z=Math.atan2(Y,I));break;case"ZYX":this._y=Math.asin(-g(ge,-1,1)),Math.abs(ge)<.9999999?(this._x=Math.atan2(Se,w),this._z=Math.atan2(Y,I)):(this._x=0,this._z=Math.atan2(-H,K));break;case"YZX":this._z=Math.asin(g(Y,-1,1)),Math.abs(Y)<.9999999?(this._x=Math.atan2(-me,K),this._y=Math.atan2(-ge,I)):(this._x=0,this._y=Math.atan2(J,w));break;case"XZY":this._z=Math.asin(-g(H,-1,1)),Math.abs(H)<.9999999?(this._x=Math.atan2(Se,K),this._y=Math.atan2(J,I)):(this._x=Math.atan2(-me,w),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+u)}return this._order=u,!1!==m&&this._onChangeCallback(),this},setFromQuaternion:function(t,u,m){return Jc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Jc,u,m)},setFromVector3:function(t,u){return this.set(t.x,t.y,t.z,u||this._order)},reorder:function(t){return $i.setFromEuler(this),this.setFromQuaternion($i,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new lt(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(bu.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}});let Mp=0;const Ui=new lt,Or=new vo,qr=new ri,Ya=new lt,yo=new lt,fa=new lt,xu=new vo,Ec=new lt(1,0,0),Zc=new lt(0,1,0),wu=new lt(0,0,1),Sh={type:"added"},Tc={type:"removed"};function Qn(){Object.defineProperty(this,"id",{value:Mp++}),this.uuid=er.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qn.DefaultUp.clone();const t=new lt,u=new ht,m=new vo,g=new lt(1,1,1);u._onChange(function(){m.setFromEuler(u,!1)}),m._onChange(function(){u.setFromQuaternion(m,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:u},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:g},modelViewMatrix:{value:new ri},normalMatrix:{value:new Ho}}),this.matrix=new ri,this.matrixWorld=new ri,this.matrixAutoUpdate=Qn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new bu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Cl(){Qn.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Qn.DefaultUp=new lt(0,1,0),Qn.DefaultMatrixAutoUpdate=!0,Qn.prototype=Object.assign(Object.create(da.prototype),{constructor:Qn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,u){this.quaternion.setFromAxisAngle(t,u)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,u){return Or.setFromAxisAngle(t,u),this.quaternion.multiply(Or),this},rotateOnWorldAxis:function(t,u){return Or.setFromAxisAngle(t,u),this.quaternion.premultiply(Or),this},rotateX:function(t){return this.rotateOnAxis(Ec,t)},rotateY:function(t){return this.rotateOnAxis(Zc,t)},rotateZ:function(t){return this.rotateOnAxis(wu,t)},translateOnAxis:function(t,u){return Ui.copy(t).applyQuaternion(this.quaternion),this.position.add(Ui.multiplyScalar(u)),this},translateX:function(t){return this.translateOnAxis(Ec,t)},translateY:function(t){return this.translateOnAxis(Zc,t)},translateZ:function(t){return this.translateOnAxis(wu,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(qr.getInverse(this.matrixWorld))},lookAt:function(t,u,m){t.isVector3?Ya.copy(t):Ya.set(t,u,m);const g=this.parent;this.updateWorldMatrix(!0,!1),yo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?qr.lookAt(yo,Ya,this.up):qr.lookAt(Ya,yo,this.up),this.quaternion.setFromRotationMatrix(qr),g&&(qr.extractRotation(g.matrixWorld),Or.setFromRotationMatrix(qr),this.quaternion.premultiply(Or.inverse()))},add:function(t){if(arguments.length>1){for(let u=0;u<arguments.length;u++)this.add(arguments[u]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(Sh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const u=this.children.indexOf(t);return-1!==u&&(t.parent=null,this.children.splice(u,1),t.dispatchEvent(Tc)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),qr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),qr.multiply(t.parent.matrixWorld)),t.applyMatrix4(qr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,u){if(this[t]===u)return this;for(let m=0,g=this.children.length;m<g;m++){const E=this.children[m].getObjectByProperty(t,u);if(void 0!==E)return E}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new lt),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new vo),this.updateMatrixWorld(!0),this.matrixWorld.decompose(yo,t,fa),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new lt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(yo,xu,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(u[8],u[9],u[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverseVisible(t)},traverseAncestors:function(t){const u=this.parent;null!==u&&(t(u),u.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].updateMatrixWorld(t)},updateWorldMatrix:function(t,u){const m=this.parent;if(!0===t&&null!==m&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===u){const g=this.children;for(let E=0,I=g.length;E<I;E++)g[E].updateWorldMatrix(!1,!0)}},toJSON:function(t){const u=void 0===t||"string"==typeof t,m={};u&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},m.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const g={};function E(H,J){return void 0===H[J.uuid]&&(H[J.uuid]=J.toJSON(t)),J.uuid}if(g.uuid=this.uuid,g.type=this.type,""!==this.name&&(g.name=this.name),!0===this.castShadow&&(g.castShadow=!0),!0===this.receiveShadow&&(g.receiveShadow=!0),!1===this.visible&&(g.visible=!1),!1===this.frustumCulled&&(g.frustumCulled=!1),0!==this.renderOrder&&(g.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(g.userData=this.userData),g.layers=this.layers.mask,g.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(g.matrixAutoUpdate=!1),this.isInstancedMesh&&(g.type="InstancedMesh",g.count=this.count,g.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){g.geometry=E(t.geometries,this.geometry);const H=this.geometry.parameters;if(void 0!==H&&void 0!==H.shapes){const J=H.shapes;if(Array.isArray(J))for(let Y=0,K=J.length;Y<K;Y++)E(t.shapes,J[Y]);else E(t.shapes,J)}}if(void 0!==this.material)if(Array.isArray(this.material)){const H=[];for(let J=0,Y=this.material.length;J<Y;J++)H.push(E(t.materials,this.material[J]));g.material=H}else g.material=E(t.materials,this.material);if(this.children.length>0){g.children=[];for(let H=0;H<this.children.length;H++)g.children.push(this.children[H].toJSON(t).object)}if(u){const H=I(t.geometries),J=I(t.materials),Y=I(t.textures),K=I(t.images),me=I(t.shapes);H.length>0&&(m.geometries=H),J.length>0&&(m.materials=J),Y.length>0&&(m.textures=Y),K.length>0&&(m.images=K),me.length>0&&(m.shapes=me)}return m.object=g,m;function I(H){const J=[];for(const Y in H){const K=H[Y];delete K.metadata,J.push(K)}return J}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,u){if(void 0===u&&(u=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===u)for(let m=0;m<t.children.length;m++)this.add(t.children[m].clone());return this}}),Cl.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Cl,isScene:!0,copy:function(t,u){return Qn.prototype.copy.call(this,t,u),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){const u=Qn.prototype.toJSON.call(this,t);return null!==this.background&&(u.object.background=this.background.toJSON(t)),null!==this.environment&&(u.object.environment=this.environment.toJSON(t)),null!==this.fog&&(u.object.fog=this.fog.toJSON()),u},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Ja=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],Ca=new lt,Kl=new fn,Su=new lt,La=new lt,bo=new lt,Ds=new lt,Mc=new lt,it=new lt,xt=new lt,Ut=new lt,bn=new lt,qt=new lt;function fn(t,u){this.min=void 0!==t?t:new lt(1/0,1/0,1/0),this.max=void 0!==u?u:new lt(-1/0,-1/0,-1/0)}function tn(t,u,m,g,E){for(let I=0,H=t.length-3;I<=H;I+=3){qt.fromArray(t,I);const J=E.x*Math.abs(qt.x)+E.y*Math.abs(qt.y)+E.z*Math.abs(qt.z),Y=u.dot(qt),K=m.dot(qt),me=g.dot(qt);if(Math.max(-Math.max(Y,K,me),Math.min(Y,K,me))>J)return!1}return!0}Object.assign(fn.prototype,{isBox3:!0,set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromArray:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,H=-1/0;for(let J=0,Y=t.length;J<Y;J+=3){const K=t[J],me=t[J+1],ge=t[J+2];K<u&&(u=K),me<m&&(m=me),ge<g&&(g=ge),K>E&&(E=K),me>I&&(I=me),ge>H&&(H=ge)}return this.min.set(u,m,g),this.max.set(E,I,H),this},setFromBufferAttribute:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,H=-1/0;for(let J=0,Y=t.count;J<Y;J++){const K=t.getX(J),me=t.getY(J),ge=t.getZ(J);K<u&&(u=K),me<m&&(m=me),ge<g&&(g=ge),K>E&&(E=K),me>I&&(I=me),ge>H&&(H=ge)}return this.min.set(u,m,g),this.max.set(E,I,H),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=Ca.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new lt),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);const u=t.geometry;void 0!==u&&(null===u.boundingBox&&u.computeBoundingBox(),Kl.copy(u.boundingBox),Kl.applyMatrix4(t.matrixWorld),this.union(Kl));const m=t.children;for(let g=0,E=m.length;g<E;g++)this.expandByObject(m[g]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .getParameter() target is now required"),u=new lt),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,Ca),Ca.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){let u,m;return t.normal.x>0?(u=t.normal.x*this.min.x,m=t.normal.x*this.max.x):(u=t.normal.x*this.max.x,m=t.normal.x*this.min.x),t.normal.y>0?(u+=t.normal.y*this.min.y,m+=t.normal.y*this.max.y):(u+=t.normal.y*this.max.y,m+=t.normal.y*this.min.y),t.normal.z>0?(u+=t.normal.z*this.min.z,m+=t.normal.z*this.max.z):(u+=t.normal.z*this.max.z,m+=t.normal.z*this.min.z),u<=-t.constant&&m>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(xt),Ut.subVectors(this.max,xt),Su.subVectors(t.a,xt),La.subVectors(t.b,xt),bo.subVectors(t.c,xt),Ds.subVectors(La,Su),Mc.subVectors(bo,La),it.subVectors(Su,bo);let u=[0,-Ds.z,Ds.y,0,-Mc.z,Mc.y,0,-it.z,it.y,Ds.z,0,-Ds.x,Mc.z,0,-Mc.x,it.z,0,-it.x,-Ds.y,Ds.x,0,-Mc.y,Mc.x,0,-it.y,it.x,0];return!!tn(u,Su,La,bo,Ut)&&(u=[1,0,0,0,1,0,0,0,1],!!tn(u,Su,La,bo,Ut)&&(bn.crossVectors(Ds,Mc),u=[bn.x,bn.y,bn.z],tn(u,Su,La,bo,Ut)))},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .clampPoint() target is now required"),u=new lt),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Ca.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(Ca).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(Ja[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ja[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ja[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ja[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ja[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ja[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ja[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ja[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ja)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const qn=new fn;function jn(t,u){this.center=void 0!==t?t:new lt,this.radius=void 0!==u?u:-1}Object.assign(jn.prototype,{set:function(t,u){return this.center.copy(t),this.radius=u,this},setFromPoints:function(t,u){const m=this.center;void 0!==u?m.copy(u):qn.setFromPoints(t).getCenter(m);let g=0;for(let E=0,I=t.length;E<I;E++)g=Math.max(g,m.distanceToSquared(t[E]));return this.radius=Math.sqrt(g),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){const u=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=u*u},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,u){const m=this.center.distanceToSquared(t);return void 0===u&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),u=new lt),u.copy(t),m>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new fn),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});const Sr=new lt,$r=new lt,yr=new lt,Xr=new lt,fi=new lt,Rr=new lt,ts=new lt;function lo(t,u){this.origin=void 0!==t?t:new lt,this.direction=void 0!==u?u:new lt(0,0,-1)}Object.assign(lo.prototype,{set:function(t,u){return this.origin.copy(t),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,u){return void 0===u&&(console.warn("THREE.Ray: .at() target is now required"),u=new lt),u.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Sr)),this},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),u=new lt),u.subVectors(t,this.origin);const m=u.dot(this.direction);return m<0?u.copy(this.origin):u.copy(this.direction).multiplyScalar(m).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){const u=Sr.subVectors(t,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(t):(Sr.copy(this.direction).multiplyScalar(u).add(this.origin),Sr.distanceToSquared(t))},distanceSqToSegment:function(t,u,m,g){$r.copy(t).add(u).multiplyScalar(.5),yr.copy(u).sub(t).normalize(),Xr.copy(this.origin).sub($r);const E=.5*t.distanceTo(u),I=-this.direction.dot(yr),H=Xr.dot(this.direction),J=-Xr.dot(yr),Y=Xr.lengthSq(),K=Math.abs(1-I*I);let me,ge,Se,w;if(K>0)if(me=I*J-H,ge=I*H-J,w=E*K,me>=0)if(ge>=-w)if(ge<=w){const e=1/K;me*=e,ge*=e,Se=me*(me+I*ge+2*H)+ge*(I*me+ge+2*J)+Y}else ge=E,me=Math.max(0,-(I*ge+H)),Se=-me*me+ge*(ge+2*J)+Y;else ge=-E,me=Math.max(0,-(I*ge+H)),Se=-me*me+ge*(ge+2*J)+Y;else ge<=-w?(me=Math.max(0,-(-I*E+H)),ge=me>0?-E:Math.min(Math.max(-E,-J),E),Se=-me*me+ge*(ge+2*J)+Y):ge<=w?(me=0,ge=Math.min(Math.max(-E,-J),E),Se=ge*(ge+2*J)+Y):(me=Math.max(0,-(I*E+H)),ge=me>0?E:Math.min(Math.max(-E,-J),E),Se=-me*me+ge*(ge+2*J)+Y);else ge=I>0?-E:E,me=Math.max(0,-(I*ge+H)),Se=-me*me+ge*(ge+2*J)+Y;return m&&m.copy(this.direction).multiplyScalar(me).add(this.origin),g&&g.copy(yr).multiplyScalar(ge).add($r),Se},intersectSphere:function(t,u){Sr.subVectors(t.center,this.origin);const m=Sr.dot(this.direction),g=Sr.dot(Sr)-m*m,E=t.radius*t.radius;if(g>E)return null;const I=Math.sqrt(E-g),H=m-I,J=m+I;return H<0&&J<0?null:this.at(H<0?J:H,u)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){const u=t.normal.dot(this.direction);if(0===u)return 0===t.distanceToPoint(this.origin)?0:null;const m=-(this.origin.dot(t.normal)+t.constant)/u;return m>=0?m:null},intersectPlane:function(t,u){const m=this.distanceToPlane(t);return null===m?null:this.at(m,u)},intersectsPlane:function(t){const u=t.distanceToPoint(this.origin);return 0===u||t.normal.dot(this.direction)*u<0},intersectBox:function(t,u){let m,g,E,I,H,J;const Y=1/this.direction.x,K=1/this.direction.y,me=1/this.direction.z,ge=this.origin;return Y>=0?(m=(t.min.x-ge.x)*Y,g=(t.max.x-ge.x)*Y):(m=(t.max.x-ge.x)*Y,g=(t.min.x-ge.x)*Y),K>=0?(E=(t.min.y-ge.y)*K,I=(t.max.y-ge.y)*K):(E=(t.max.y-ge.y)*K,I=(t.min.y-ge.y)*K),m>I||E>g?null:((E>m||m!=m)&&(m=E),(I<g||g!=g)&&(g=I),me>=0?(H=(t.min.z-ge.z)*me,J=(t.max.z-ge.z)*me):(H=(t.max.z-ge.z)*me,J=(t.min.z-ge.z)*me),m>J||H>g?null:((H>m||m!=m)&&(m=H),(J<g||g!=g)&&(g=J),g<0?null:this.at(m>=0?m:g,u)))},intersectsBox:function(t){return null!==this.intersectBox(t,Sr)},intersectTriangle:function(t,u,m,g,E){fi.subVectors(u,t),Rr.subVectors(m,t),ts.crossVectors(fi,Rr);let I,H=this.direction.dot(ts);if(H>0){if(g)return null;I=1}else{if(!(H<0))return null;I=-1,H=-H}Xr.subVectors(this.origin,t);const J=I*this.direction.dot(Rr.crossVectors(Xr,Rr));if(J<0)return null;const Y=I*this.direction.dot(fi.cross(Xr));if(Y<0||J+Y>H)return null;const K=-I*Xr.dot(ts);return K<0?null:this.at(K/H,E)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});const Js=new lt,Bo=new lt,ec=new Ho;function Yo(t,u){this.normal=void 0!==t?t:new lt(1,0,0),this.constant=void 0!==u?u:0}Object.assign(Yo.prototype,{isPlane:!0,set:function(t,u){return this.normal.copy(t),this.constant=u,this},setComponents:function(t,u,m,g){return this.normal.set(t,u,m),this.constant=g,this},setFromNormalAndCoplanarPoint:function(t,u){return this.normal.copy(t),this.constant=-u.dot(this.normal),this},setFromCoplanarPoints:function(t,u,m){const g=Js.subVectors(m,u).cross(Bo.subVectors(t,u)).normalize();return this.setFromNormalAndCoplanarPoint(g,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,u){return void 0===u&&(console.warn("THREE.Plane: .projectPoint() target is now required"),u=new lt),u.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,u){void 0===u&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new lt);const m=t.delta(Js),g=this.normal.dot(m);if(0===g)return 0===this.distanceToPoint(t.start)?u.copy(t.start):void 0;const E=-(t.start.dot(this.normal)+this.constant)/g;return E<0||E>1?void 0:u.copy(m).multiplyScalar(E).add(t.start)},intersectsLine:function(t){const u=this.distanceToPoint(t.start),m=this.distanceToPoint(t.end);return u<0&&m>0||m<0&&u>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new lt),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,u){const m=u||ec.getNormalMatrix(t),g=this.coplanarPoint(Js).applyMatrix4(t),E=this.normal.applyMatrix3(m).normalize();return this.constant=-g.dot(E),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});const Xi=new lt,Ac=new lt,Yh=new lt,rh=new lt,Ap=new lt,Eh=new lt,cd=new lt,Th=new lt,Rd=new lt,ud=new lt;function Pr(t,u,m){this.a=void 0!==t?t:new lt,this.b=void 0!==u?u:new lt,this.c=void 0!==m?m:new lt}Object.assign(Pr,{getNormal:function(t,u,m,g){void 0===g&&(console.warn("THREE.Triangle: .getNormal() target is now required"),g=new lt),g.subVectors(m,u),Xi.subVectors(t,u),g.cross(Xi);const E=g.lengthSq();return E>0?g.multiplyScalar(1/Math.sqrt(E)):g.set(0,0,0)},getBarycoord:function(t,u,m,g,E){Xi.subVectors(g,u),Ac.subVectors(m,u),Yh.subVectors(t,u);const I=Xi.dot(Xi),H=Xi.dot(Ac),J=Xi.dot(Yh),Y=Ac.dot(Ac),K=Ac.dot(Yh),me=I*Y-H*H;if(void 0===E&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),E=new lt),0===me)return E.set(-2,-1,-1);const ge=1/me,Se=(Y*J-H*K)*ge,w=(I*K-H*J)*ge;return E.set(1-Se-w,w,Se)},containsPoint:function(t,u,m,g){return Pr.getBarycoord(t,u,m,g,rh),rh.x>=0&&rh.y>=0&&rh.x+rh.y<=1},getUV:function(t,u,m,g,E,I,H,J){return this.getBarycoord(t,u,m,g,rh),J.set(0,0),J.addScaledVector(E,rh.x),J.addScaledVector(I,rh.y),J.addScaledVector(H,rh.z),J},isFrontFacing:function(t,u,m,g){return Xi.subVectors(m,u),Ac.subVectors(t,u),Xi.cross(Ac).dot(g)<0}}),Object.assign(Pr.prototype,{set:function(t,u,m){return this.a.copy(t),this.b.copy(u),this.c.copy(m),this},setFromPointsAndIndices:function(t,u,m,g){return this.a.copy(t[u]),this.b.copy(t[m]),this.c.copy(t[g]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Xi.subVectors(this.c,this.b),Ac.subVectors(this.a,this.b),.5*Xi.cross(Ac).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new lt),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)},getNormal:function(t){return Pr.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Yo),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,u){return Pr.getBarycoord(t,this.a,this.b,this.c,u)},getUV:function(t,u,m,g,E){return Pr.getUV(t,this.a,this.b,this.c,u,m,g,E)},containsPoint:function(t){return Pr.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Pr.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),u=new lt);const m=this.a,g=this.b,E=this.c;let I,H;Ap.subVectors(g,m),Eh.subVectors(E,m),Th.subVectors(t,m);const J=Ap.dot(Th),Y=Eh.dot(Th);if(J<=0&&Y<=0)return u.copy(m);Rd.subVectors(t,g);const K=Ap.dot(Rd),me=Eh.dot(Rd);if(K>=0&&me<=K)return u.copy(g);const ge=J*me-K*Y;if(ge<=0&&J>=0&&K<=0)return I=J/(J-K),u.copy(m).addScaledVector(Ap,I);ud.subVectors(t,E);const Se=Ap.dot(ud),w=Eh.dot(ud);if(w>=0&&Se<=w)return u.copy(E);const e=Se*Y-J*w;if(e<=0&&Y>=0&&w<=0)return H=Y/(Y-w),u.copy(m).addScaledVector(Eh,H);const c=K*w-Se*me;if(c<=0&&me-K>=0&&Se-w>=0)return cd.subVectors(E,g),H=(me-K)/(me-K+(Se-w)),u.copy(g).addScaledVector(cd,H);const d=1/(c+e+ge);return I=e*d,H=ge*d,u.copy(m).addScaledVector(Ap,I).addScaledVector(Eh,H)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});const $c={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zs={h:0,s:0,l:0},$p={h:0,s:0,l:0};function ar(t,u,m){return void 0===u&&void 0===m?this.set(t):this.setRGB(t,u,m)}function Ll(t,u,m){return m<0&&(m+=1),m>1&&(m-=1),m<.16666666666666666?t+6*(u-t)*m:m<.5?u:m<.6666666666666666?t+6*(u-t)*(.6666666666666666-m):t}function Mh(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Jh(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function ma(t,u,m,g,E,I){this.a=t,this.b=u,this.c=m,this.normal=g&&g.isVector3?g:new lt,this.vertexNormals=Array.isArray(g)?g:[],this.color=E&&E.isColor?E:new ar,this.vertexColors=Array.isArray(E)?E:[],this.materialIndex=void 0!==I?I:0}Object.assign(ar.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,u,m){return this.r=t,this.g=u,this.b=m,this},setHSL:function(t,u,m){if(t=er.euclideanModulo(t,1),u=er.clamp(u,0,1),m=er.clamp(m,0,1),0===u)this.r=this.g=this.b=m;else{const g=m<=.5?m*(1+u):m+u-m*u,E=2*m-g;this.r=Ll(E,g,t+.3333333333333333),this.g=Ll(E,g,t),this.b=Ll(E,g,t-.3333333333333333)}return this},setStyle:function(t){function u(g){void 0!==g&&parseFloat(g)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let g;const I=m[2];switch(m[1]){case"rgb":case"rgba":if(g=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(255,parseInt(g[1],10))/255,this.g=Math.min(255,parseInt(g[2],10))/255,this.b=Math.min(255,parseInt(g[3],10))/255,u(g[5]),this;if(g=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(100,parseInt(g[1],10))/100,this.g=Math.min(100,parseInt(g[2],10))/100,this.b=Math.min(100,parseInt(g[3],10))/100,u(g[5]),this;break;case"hsl":case"hsla":if(g=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I)){const H=parseFloat(g[1])/360,J=parseInt(g[2],10)/100,Y=parseInt(g[3],10)/100;return u(g[5]),this.setHSL(H,J,Y)}}}else if(m=/^\#([A-Fa-f0-9]+)$/.exec(t)){const g=m[1],E=g.length;if(3===E)return this.r=parseInt(g.charAt(0)+g.charAt(0),16)/255,this.g=parseInt(g.charAt(1)+g.charAt(1),16)/255,this.b=parseInt(g.charAt(2)+g.charAt(2),16)/255,this;if(6===E)return this.r=parseInt(g.charAt(0)+g.charAt(1),16)/255,this.g=parseInt(g.charAt(2)+g.charAt(3),16)/255,this.b=parseInt(g.charAt(4)+g.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){const u=$c[t];return void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,u){return void 0===u&&(u=2),this.r=Math.pow(t.r,u),this.g=Math.pow(t.g,u),this.b=Math.pow(t.b,u),this},copyLinearToGamma:function(t,u){void 0===u&&(u=2);const m=u>0?1/u:1;return this.r=Math.pow(t.r,m),this.g=Math.pow(t.g,m),this.b=Math.pow(t.b,m),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Mh(t.r),this.g=Mh(t.g),this.b=Mh(t.b),this},copyLinearToSRGB:function(t){return this.r=Jh(t.r),this.g=Jh(t.g),this.b=Jh(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const u=this.r,m=this.g,g=this.b,E=Math.max(u,m,g),I=Math.min(u,m,g);let H,J;const Y=(I+E)/2;if(I===E)H=0,J=0;else{const K=E-I;switch(J=Y<=.5?K/(E+I):K/(2-E-I),E){case u:H=(m-g)/K+(m<g?6:0);break;case m:H=(g-u)/K+2;break;case g:H=(u-m)/K+4}H/=6}return t.h=H,t.s=J,t.l=Y,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,u,m){return this.getHSL(Zs),Zs.h+=t,Zs.s+=u,Zs.l+=m,this.setHSL(Zs.h,Zs.s,Zs.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,u){return this.r=t.r+u.r,this.g=t.g+u.g,this.b=t.b+u.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,u){return this.r+=(t.r-this.r)*u,this.g+=(t.g-this.g)*u,this.b+=(t.b-this.b)*u,this},lerpHSL:function(t,u){this.getHSL(Zs),t.getHSL($p);const m=er.lerp(Zs.h,$p.h,u),g=er.lerp(Zs.s,$p.s,u),E=er.lerp(Zs.l,$p.l,u);return this.setHSL(m,g,E),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,u){return void 0===u&&(u=0),this.r=t[u],this.g=t[u+1],this.b=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.r,t[u+1]=this.g,t[u+2]=this.b,t},fromBufferAttribute:function(t,u){return this.r=t.getX(u),this.g=t.getY(u),this.b=t.getZ(u),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),ar.NAMES=$c,Object.assign(ma.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let u=0,m=t.vertexNormals.length;u<m;u++)this.vertexNormals[u]=t.vertexNormals[u].clone();for(let u=0,m=t.vertexColors.length;u<m;u++)this.vertexColors[u]=t.vertexColors[u].clone();return this}});let hd=0;function Ur(){Object.defineProperty(this,"id",{value:hd++}),this.uuid=er.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=he,this.side=ae,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Gt,this.blendDst=Dt,this.blendEquation=Pe,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=cr,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ha,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=qe,this.stencilZFail=qe,this.stencilZPass=qe,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Ki(t){Ur.call(this),this.type="MeshBasicMaterial",this.color=new ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Ur.prototype=Object.assign(Object.create(da.prototype),{constructor:Ur,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const u in t){const m=t[u];if(void 0===m){console.warn("THREE.Material: '"+u+"' parameter is undefined.");continue}if("shading"===u){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===A;continue}const g=this[u];void 0!==g?g&&g.isColor?g.set(m):g&&g.isVector3&&m&&m.isVector3?g.copy(m):this[u]=m:console.warn("THREE."+this.type+": '"+u+"' is not a property of this material.")}},toJSON:function(t){const u=void 0===t||"string"==typeof t;u&&(t={textures:{},images:{}});const m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function g(E){const I=[];for(const H in E){const J=E[H];delete J.metadata,I.push(J)}return I}if(m.uuid=this.uuid,m.type=this.type,""!==this.name&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),void 0!==this.roughness&&(m.roughness=this.roughness),void 0!==this.metalness&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),void 0!==this.shininess&&(m.shininess=this.shininess),void 0!==this.clearcoat&&(m.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(t).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(t).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(t).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(t).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(t).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,void 0!==this.combine&&(m.combine=this.combine),void 0!==this.envMapIntensity&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(m.size=this.size),void 0!==this.sizeAttenuation&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==he&&(m.blending=this.blending),!0===this.flatShading&&(m.flatShading=this.flatShading),this.side!==ae&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),this.opacity<1&&(m.opacity=this.opacity),!0===this.transparent&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(m.rotation=this.rotation),!0===this.polygonOffset&&(m.polygonOffset=!0),0!==this.polygonOffsetFactor&&(m.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(m.linewidth=this.linewidth),void 0!==this.dashSize&&(m.dashSize=this.dashSize),void 0!==this.gapSize&&(m.gapSize=this.gapSize),void 0!==this.scale&&(m.scale=this.scale),!0===this.dithering&&(m.dithering=!0),this.alphaTest>0&&(m.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(m.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(m.wireframe=this.wireframe),this.wireframeLinewidth>1&&(m.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(m.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(m.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(m.morphTargets=!0),!0===this.morphNormals&&(m.morphNormals=!0),!0===this.skinning&&(m.skinning=!0),!1===this.visible&&(m.visible=!1),!1===this.toneMapped&&(m.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(m.userData=this.userData),u){const E=g(t.textures),I=g(t.images);E.length>0&&(m.textures=E),I.length>0&&(m.images=I)}return m},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const u=t.clippingPlanes;let m=null;if(null!==u){const g=u.length;m=new Array(g);for(let E=0;E!==g;++E)m[E]=u[E].clone()}return this.clippingPlanes=m,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ur.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(Ki.prototype=Object.create(Ur.prototype)).constructor=Ki,Ki.prototype.isMeshBasicMaterial=!0,Ki.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const No=new lt,$s=new En;function Vr(t,u,m){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=u,this.count=void 0!==t?t.length/u:0,this.normalized=!0===m,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0}function dl(t,u,m){Vr.call(this,new Int8Array(t),u,m)}function Cc(t,u,m){Vr.call(this,new Uint8Array(t),u,m)}function ih(t,u,m){Vr.call(this,new Uint8ClampedArray(t),u,m)}function Zh(t,u,m){Vr.call(this,new Int16Array(t),u,m)}function Bl(t,u,m){Vr.call(this,new Uint16Array(t),u,m)}function Kn(t,u,m){Vr.call(this,new Int32Array(t),u,m)}function fl(t,u,m){Vr.call(this,new Uint32Array(t),u,m)}function Un(t,u,m){Vr.call(this,new Float32Array(t),u,m)}function Nl(t,u,m){Vr.call(this,new Float64Array(t),u,m)}function Pi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Pd(t){if(0===t.length)return-1/0;let u=t[0];for(let m=1,g=t.length;m<g;++m)t[m]>u&&(u=t[m]);return u}Object.defineProperty(Vr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Vr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.itemSize,m*=u.itemSize;for(let g=0,E=this.itemSize;g<E;g++)this.array[t+g]=u.array[m+g];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",g),I=new ar),u[m++]=I.r,u[m++]=I.g,u[m++]=I.b}return this},copyVector2sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",g),I=new En),u[m++]=I.x,u[m++]=I.y}return this},copyVector3sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",g),I=new lt),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z}return this},copyVector4sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",g),I=new xi),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z,u[m++]=I.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let u=0,m=this.count;u<m;u++)$s.fromBufferAttribute(this,u),$s.applyMatrix3(t),this.setXY(u,$s.x,$s.y);else if(3===this.itemSize)for(let u=0,m=this.count;u<m;u++)No.fromBufferAttribute(this,u),No.applyMatrix3(t),this.setXYZ(u,No.x,No.y,No.z);return this},applyMatrix4:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.applyMatrix4(t),this.setXYZ(u,No.x,No.y,No.z);return this},applyNormalMatrix:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.applyNormalMatrix(t),this.setXYZ(u,No.x,No.y,No.z);return this},transformDirection:function(t){for(let u=0,m=this.count;u<m;u++)No.x=this.getX(u),No.y=this.getY(u),No.z=this.getZ(u),No.transformDirection(t),this.setXYZ(u,No.x,No.y,No.z);return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,u){return this.array[t*this.itemSize]=u,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,u){return this.array[t*this.itemSize+1]=u,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,u){return this.array[t*this.itemSize+2]=u,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,u){return this.array[t*this.itemSize+3]=u,this},setXY:function(t,u,m){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this.array[t+3]=E,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(dl.prototype=Object.create(Vr.prototype)).constructor=dl,(Cc.prototype=Object.create(Vr.prototype)).constructor=Cc,(ih.prototype=Object.create(Vr.prototype)).constructor=ih,(Zh.prototype=Object.create(Vr.prototype)).constructor=Zh,(Bl.prototype=Object.create(Vr.prototype)).constructor=Bl,(Kn.prototype=Object.create(Vr.prototype)).constructor=Kn,(fl.prototype=Object.create(Vr.prototype)).constructor=fl,(Un.prototype=Object.create(Vr.prototype)).constructor=Un,(Nl.prototype=Object.create(Vr.prototype)).constructor=Nl,Object.assign(Pi.prototype,{computeGroups:function(t){const u=[];let m,g,E;const I=t.faces;for(g=0;g<I.length;g++){const H=I[g];H.materialIndex!==E&&(E=H.materialIndex,void 0!==m&&(m.count=3*g-m.start,u.push(m)),m={start:3*g,materialIndex:E})}void 0!==m&&(m.count=3*g-m.start,u.push(m)),this.groups=u},fromGeometry:function(t){const u=t.faces,m=t.vertices,g=t.faceVertexUvs,E=g[0]&&g[0].length>0,I=g[1]&&g[1].length>0,H=t.morphTargets,J=H.length;let Y;if(J>0){Y=[];for(let d=0;d<J;d++)Y[d]={name:H[d].name,data:[]};this.morphTargets.position=Y}const K=t.morphNormals,me=K.length;let ge;if(me>0){ge=[];for(let d=0;d<me;d++)ge[d]={name:K[d].name,data:[]};this.morphTargets.normal=ge}const Se=t.skinIndices,w=t.skinWeights,e=Se.length===m.length,c=w.length===m.length;m.length>0&&0===u.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let d=0;d<u.length;d++){const _=u[d];this.vertices.push(m[_.a],m[_.b],m[_.c]);const S=_.vertexNormals;if(3===S.length)this.normals.push(S[0],S[1],S[2]);else{const k=_.normal;this.normals.push(k,k,k)}const L=_.vertexColors;if(3===L.length)this.colors.push(L[0],L[1],L[2]);else{const k=_.color;this.colors.push(k,k,k)}if(!0===E){const k=g[0][d];void 0!==k?this.uvs.push(k[0],k[1],k[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",d),this.uvs.push(new En,new En,new En))}if(!0===I){const k=g[1][d];void 0!==k?this.uvs2.push(k[0],k[1],k[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",d),this.uvs2.push(new En,new En,new En))}for(let k=0;k<J;k++){const F=H[k].vertices;Y[k].data.push(F[_.a],F[_.b],F[_.c])}for(let k=0;k<me;k++){const F=K[k].vertexNormals[d];ge[k].data.push(F.a,F.b,F.c)}e&&this.skinIndices.push(Se[_.a],Se[_.b],Se[_.c]),c&&this.skinWeights.push(w[_.a],w[_.b],w[_.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});let Cp=1;const Ba=new ri,oh=new Qn,sh=new lt,Na=new fn,li=new fn,Zr=new lt;function hn(){Object.defineProperty(this,"id",{value:Cp+=2}),this.uuid=er.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}hn.prototype=Object.assign(Object.create(da.prototype),{constructor:hn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(Pd(t)>65535?fl:Bl)(t,1):t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,u){return this.attributes[t]=u,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,u,m){this.groups.push({start:t,count:u,materialIndex:void 0!==m?m:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,u){this.drawRange.start=t,this.drawRange.count=u},applyMatrix4:function(t){const u=this.attributes.position;void 0!==u&&(u.applyMatrix4(t),u.needsUpdate=!0);const m=this.attributes.normal;if(void 0!==m){const E=(new Ho).getNormalMatrix(t);m.applyNormalMatrix(E),m.needsUpdate=!0}const g=this.attributes.tangent;return void 0!==g&&(g.transformDirection(t),g.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return Ba.makeRotationX(t),this.applyMatrix4(Ba),this},rotateY:function(t){return Ba.makeRotationY(t),this.applyMatrix4(Ba),this},rotateZ:function(t){return Ba.makeRotationZ(t),this.applyMatrix4(Ba),this},translate:function(t,u,m){return Ba.makeTranslation(t,u,m),this.applyMatrix4(Ba),this},scale:function(t,u,m){return Ba.makeScale(t,u,m),this.applyMatrix4(Ba),this},lookAt:function(t){return oh.lookAt(t),oh.updateMatrix(),this.applyMatrix4(oh.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(sh).negate(),this.translate(sh.x,sh.y,sh.z),this},setFromObject:function(t){const u=t.geometry;if(t.isPoints||t.isLine){const m=new Un(3*u.vertices.length,3),g=new Un(3*u.colors.length,3);if(this.setAttribute("position",m.copyVector3sArray(u.vertices)),this.setAttribute("color",g.copyColorsArray(u.colors)),u.lineDistances&&u.lineDistances.length===u.vertices.length){const E=new Un(u.lineDistances.length,1);this.setAttribute("lineDistance",E.copyArray(u.lineDistances))}null!==u.boundingSphere&&(this.boundingSphere=u.boundingSphere.clone()),null!==u.boundingBox&&(this.boundingBox=u.boundingBox.clone())}else t.isMesh&&u&&u.isGeometry&&this.fromGeometry(u);return this},setFromPoints:function(t){const u=[];for(let m=0,g=t.length;m<g;m++){const E=t[m];u.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new Un(u,3)),this},updateFromObject:function(t){let u=t.geometry;if(t.isMesh){let m=u.__directGeometry;if(!0===u.elementsNeedUpdate&&(m=void 0,u.elementsNeedUpdate=!1),void 0===m)return this.fromGeometry(u);m.verticesNeedUpdate=u.verticesNeedUpdate,m.normalsNeedUpdate=u.normalsNeedUpdate,m.colorsNeedUpdate=u.colorsNeedUpdate,m.uvsNeedUpdate=u.uvsNeedUpdate,m.groupsNeedUpdate=u.groupsNeedUpdate,u.verticesNeedUpdate=!1,u.normalsNeedUpdate=!1,u.colorsNeedUpdate=!1,u.uvsNeedUpdate=!1,u.groupsNeedUpdate=!1,u=m}if(!0===u.verticesNeedUpdate){const m=this.attributes.position;void 0!==m&&(m.copyVector3sArray(u.vertices),m.needsUpdate=!0),u.verticesNeedUpdate=!1}if(!0===u.normalsNeedUpdate){const m=this.attributes.normal;void 0!==m&&(m.copyVector3sArray(u.normals),m.needsUpdate=!0),u.normalsNeedUpdate=!1}if(!0===u.colorsNeedUpdate){const m=this.attributes.color;void 0!==m&&(m.copyColorsArray(u.colors),m.needsUpdate=!0),u.colorsNeedUpdate=!1}if(u.uvsNeedUpdate){const m=this.attributes.uv;void 0!==m&&(m.copyVector2sArray(u.uvs),m.needsUpdate=!0),u.uvsNeedUpdate=!1}if(u.lineDistancesNeedUpdate){const m=this.attributes.lineDistance;void 0!==m&&(m.copyArray(u.lineDistances),m.needsUpdate=!0),u.lineDistancesNeedUpdate=!1}return u.groupsNeedUpdate&&(u.computeGroups(t.geometry),this.groups=u.groups,u.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Pi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const u=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Vr(u,3).copyVector3sArray(t.vertices)),t.normals.length>0){const m=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Vr(m,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const m=new Float32Array(3*t.colors.length);this.setAttribute("color",new Vr(m,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const m=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Vr(m,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const m=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Vr(m,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const m in t.morphTargets){const g=[],E=t.morphTargets[m];for(let I=0,H=E.length;I<H;I++){const J=E[I],Y=new Un(3*J.data.length,3);Y.name=J.name,g.push(Y.copyVector3sArray(J.data))}this.morphAttributes[m]=g}if(t.skinIndices.length>0){const m=new Un(4*t.skinIndices.length,4);this.setAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const m=new Un(4*t.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fn);const t=this.attributes.position,u=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),u)for(let m=0,g=u.length;m<g;m++)Na.setFromBufferAttribute(u[m]),this.morphTargetsRelative?(Zr.addVectors(this.boundingBox.min,Na.min),this.boundingBox.expandByPoint(Zr),Zr.addVectors(this.boundingBox.max,Na.max),this.boundingBox.expandByPoint(Zr)):(this.boundingBox.expandByPoint(Na.min),this.boundingBox.expandByPoint(Na.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new jn);const t=this.attributes.position,u=this.morphAttributes.position;if(t){const m=this.boundingSphere.center;if(Na.setFromBufferAttribute(t),u)for(let E=0,I=u.length;E<I;E++)li.setFromBufferAttribute(u[E]),this.morphTargetsRelative?(Zr.addVectors(Na.min,li.min),Na.expandByPoint(Zr),Zr.addVectors(Na.max,li.max),Na.expandByPoint(Zr)):(Na.expandByPoint(li.min),Na.expandByPoint(li.max));Na.getCenter(m);let g=0;for(let E=0,I=t.count;E<I;E++)Zr.fromBufferAttribute(t,E),g=Math.max(g,m.distanceToSquared(Zr));if(u)for(let E=0,I=u.length;E<I;E++){const H=u[E],J=this.morphTargetsRelative;for(let Y=0,K=H.count;Y<K;Y++)Zr.fromBufferAttribute(H,Y),J&&(sh.fromBufferAttribute(t,Y),Zr.add(sh)),g=Math.max(g,m.distanceToSquared(Zr))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,u=this.getAttribute("position");if(void 0!==u){let m=this.getAttribute("normal");if(void 0===m)m=new Vr(new Float32Array(3*u.count),3),this.setAttribute("normal",m);else for(let ge=0,Se=m.count;ge<Se;ge++)m.setXYZ(ge,0,0,0);const g=new lt,E=new lt,I=new lt,H=new lt,J=new lt,Y=new lt,K=new lt,me=new lt;if(t)for(let ge=0,Se=t.count;ge<Se;ge+=3){const w=t.getX(ge+0),e=t.getX(ge+1),c=t.getX(ge+2);g.fromBufferAttribute(u,w),E.fromBufferAttribute(u,e),I.fromBufferAttribute(u,c),K.subVectors(I,E),me.subVectors(g,E),K.cross(me),H.fromBufferAttribute(m,w),J.fromBufferAttribute(m,e),Y.fromBufferAttribute(m,c),H.add(K),J.add(K),Y.add(K),m.setXYZ(w,H.x,H.y,H.z),m.setXYZ(e,J.x,J.y,J.z),m.setXYZ(c,Y.x,Y.y,Y.z)}else for(let ge=0,Se=u.count;ge<Se;ge+=3)g.fromBufferAttribute(u,ge+0),E.fromBufferAttribute(u,ge+1),I.fromBufferAttribute(u,ge+2),K.subVectors(I,E),me.subVectors(g,E),K.cross(me),m.setXYZ(ge+0,K.x,K.y,K.z),m.setXYZ(ge+1,K.x,K.y,K.z),m.setXYZ(ge+2,K.x,K.y,K.z);this.normalizeNormals(),m.needsUpdate=!0}},merge:function(t,u){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===u&&(u=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const m=this.attributes;for(const g in m){if(void 0===t.attributes[g])continue;const E=m[g].array,I=t.attributes[g],H=I.array,J=I.itemSize*u,Y=Math.min(H.length,E.length-J);for(let K=0,me=J;K<Y;K++,me++)E[me]=H[K]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let u=0,m=t.count;u<m;u++)Zr.fromBufferAttribute(t,u),Zr.normalize(),t.setXYZ(u,Zr.x,Zr.y,Zr.z)},toNonIndexed:function(){function t(H,J){const Y=H.array,K=H.itemSize,me=H.normalized,ge=new Y.constructor(J.length*K);let Se=0,w=0;for(let e=0,c=J.length;e<c;e++){Se=J[e]*K;for(let d=0;d<K;d++)ge[w++]=Y[Se++]}return new Vr(ge,K,me)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const u=new hn,m=this.index.array,g=this.attributes;for(const H in g){const J=t(g[H],m);u.setAttribute(H,J)}const E=this.morphAttributes;for(const H in E){const J=[],Y=E[H];for(let K=0,me=Y.length;K<me;K++){const ge=t(Y[K],m);J.push(ge)}u.morphAttributes[H]=J}u.morphTargetsRelative=this.morphTargetsRelative;const I=this.groups;for(let H=0,J=I.length;H<J;H++){const Y=I[H];u.addGroup(Y.start,Y.count,Y.materialIndex)}return u},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const J=this.parameters;for(const Y in J)void 0!==J[Y]&&(t[Y]=J[Y]);return t}t.data={attributes:{}};const u=this.index;null!==u&&(t.data.index={type:u.array.constructor.name,array:Array.prototype.slice.call(u.array)});const m=this.attributes;for(const J in m){const Y=m[J],K=Y.toJSON(t.data);""!==Y.name&&(K.name=Y.name),t.data.attributes[J]=K}const g={};let E=!1;for(const J in this.morphAttributes){const Y=this.morphAttributes[J],K=[];for(let me=0,ge=Y.length;me<ge;me++){const Se=Y[me],w=Se.toJSON(t.data);""!==Se.name&&(w.name=Se.name),K.push(w)}K.length>0&&(g[J]=K,E=!0)}E&&(t.data.morphAttributes=g,t.data.morphTargetsRelative=this.morphTargetsRelative);const I=this.groups;I.length>0&&(t.data.groups=JSON.parse(JSON.stringify(I)));const H=this.boundingSphere;return null!==H&&(t.data.boundingSphere={center:H.center.toArray(),radius:H.radius}),t},clone:function(){return(new hn).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const u={};this.name=t.name;const m=t.index;null!==m&&this.setIndex(m.clone(u));const g=t.attributes;for(const Y in g)this.setAttribute(Y,g[Y].clone(u));const E=t.morphAttributes;for(const Y in E){const K=[],me=E[Y];for(let ge=0,Se=me.length;ge<Se;ge++)K.push(me[ge].clone(u));this.morphAttributes[Y]=K}this.morphTargetsRelative=t.morphTargetsRelative;const I=t.groups;for(let Y=0,K=I.length;Y<K;Y++){const me=I[Y];this.addGroup(me.start,me.count,me.materialIndex)}const H=t.boundingBox;null!==H&&(this.boundingBox=H.clone());const J=t.boundingSphere;return null!==J&&(this.boundingSphere=J.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Qc=new ri,ci=new lo,_a=new jn,Za=new lt,Rn=new lt,wi=new lt,fs=new lt,ms=new lt,Cs=new lt,ii=new lt,Tr=new lt,br=new lt,ml=new En,Lc=new En,ah=new En,Qa=new lt,ns=new lt;function Ci(t,u){Qn.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new Ki,this.updateMorphTargets()}function Qh(t,u,m,g,E,I,H,J){let Y;if(Y=u.side===W?g.intersectTriangle(H,I,E,!0,J):g.intersectTriangle(E,I,H,u.side!==Z,J),null===Y)return null;ns.copy(J),ns.applyMatrix4(t.matrixWorld);const K=m.ray.origin.distanceTo(ns);return K<m.near||K>m.far?null:{distance:K,point:ns.clone(),object:t}}function Ah(t,u,m,g,E,I,H,J,Y,K,me,ge){Za.fromBufferAttribute(E,K),Rn.fromBufferAttribute(E,me),wi.fromBufferAttribute(E,ge);const Se=t.morphTargetInfluences;if(u.morphTargets&&I&&Se){ii.set(0,0,0),Tr.set(0,0,0),br.set(0,0,0);for(let e=0,c=I.length;e<c;e++){const d=Se[e],_=I[e];0!==d&&(fs.fromBufferAttribute(_,K),ms.fromBufferAttribute(_,me),Cs.fromBufferAttribute(_,ge),H?(ii.addScaledVector(fs,d),Tr.addScaledVector(ms,d),br.addScaledVector(Cs,d)):(ii.addScaledVector(fs.sub(Za),d),Tr.addScaledVector(ms.sub(Rn),d),br.addScaledVector(Cs.sub(wi),d)))}Za.add(ii),Rn.add(Tr),wi.add(br)}t.isSkinnedMesh&&(t.boneTransform(K,Za),t.boneTransform(me,Rn),t.boneTransform(ge,wi));const w=Qh(t,u,m,g,Za,Rn,wi,Qa);if(w){J&&(ml.fromBufferAttribute(J,K),Lc.fromBufferAttribute(J,me),ah.fromBufferAttribute(J,ge),w.uv=Pr.getUV(Qa,Za,Rn,wi,ml,Lc,ah,new En)),Y&&(ml.fromBufferAttribute(Y,K),Lc.fromBufferAttribute(Y,me),ah.fromBufferAttribute(Y,ge),w.uv2=Pr.getUV(Qa,Za,Rn,wi,ml,Lc,ah,new En));const e=new ma(K,me,ge);Pr.getNormal(Za,Rn,wi,e.normal),w.face=e}return w}Ci.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Ci,isMesh:!0,copy:function(t){return Qn.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const H=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[H]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,u){const m=this.geometry,g=this.material,E=this.matrixWorld;if(void 0===g||(null===m.boundingSphere&&m.computeBoundingSphere(),_a.copy(m.boundingSphere),_a.applyMatrix4(E),!1===t.ray.intersectsSphere(_a))||(Qc.getInverse(E),ci.copy(t.ray).applyMatrix4(Qc),null!==m.boundingBox&&!1===ci.intersectsBox(m.boundingBox)))return;let I;if(m.isBufferGeometry){const H=m.index,J=m.attributes.position,Y=m.morphAttributes.position,K=m.morphTargetsRelative,me=m.attributes.uv,ge=m.attributes.uv2,Se=m.groups,w=m.drawRange;if(null!==H)if(Array.isArray(g))for(let e=0,c=Se.length;e<c;e++){const d=Se[e],_=g[d.materialIndex];for(let S=Math.max(d.start,w.start),L=Math.min(d.start+d.count,w.start+w.count);S<L;S+=3){const k=H.getX(S),F=H.getX(S+1),V=H.getX(S+2);I=Ah(this,_,t,ci,J,Y,K,me,ge,k,F,V),I&&(I.faceIndex=Math.floor(S/3),I.face.materialIndex=d.materialIndex,u.push(I))}}else for(let e=Math.max(0,w.start),c=Math.min(H.count,w.start+w.count);e<c;e+=3){const d=H.getX(e),_=H.getX(e+1),S=H.getX(e+2);I=Ah(this,g,t,ci,J,Y,K,me,ge,d,_,S),I&&(I.faceIndex=Math.floor(e/3),u.push(I))}else if(void 0!==J)if(Array.isArray(g))for(let e=0,c=Se.length;e<c;e++){const d=Se[e],_=g[d.materialIndex];for(let S=Math.max(d.start,w.start),L=Math.min(d.start+d.count,w.start+w.count);S<L;S+=3)I=Ah(this,_,t,ci,J,Y,K,me,ge,S,S+1,S+2),I&&(I.faceIndex=Math.floor(S/3),I.face.materialIndex=d.materialIndex,u.push(I))}else for(let e=Math.max(0,w.start),c=Math.min(J.count,w.start+w.count);e<c;e+=3)I=Ah(this,g,t,ci,J,Y,K,me,ge,e,e+1,e+2),I&&(I.faceIndex=Math.floor(e/3),u.push(I))}else if(m.isGeometry){const H=Array.isArray(g),J=m.vertices,Y=m.faces;let K;const me=m.faceVertexUvs[0];me.length>0&&(K=me);for(let ge=0,Se=Y.length;ge<Se;ge++){const w=Y[ge],e=H?g[w.materialIndex]:g;if(void 0===e)continue;const c=J[w.a],d=J[w.b],_=J[w.c];if(I=Qh(this,e,t,ci,c,d,_,Qa),I){if(K&&K[ge]){const S=K[ge];ml.copy(S[0]),Lc.copy(S[1]),ah.copy(S[2]),I.uv=Pr.getUV(Qa,c,d,_,ml,Lc,ah,new En)}I.face=w,I.faceIndex=ge,u.push(I)}}}}});let Kh=0;const mr=new ri,Jo=new Qn,_l=new lt;function kr(){Object.defineProperty(this,"id",{value:Kh+=2}),this.uuid=er.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}kr.prototype=Object.assign(Object.create(da.prototype),{constructor:kr,isGeometry:!0,applyMatrix4:function(t){const u=(new Ho).getNormalMatrix(t);for(let m=0,g=this.vertices.length;m<g;m++)this.vertices[m].applyMatrix4(t);for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];E.normal.applyMatrix3(u).normalize();for(let I=0,H=E.vertexNormals.length;I<H;I++)E.vertexNormals[I].applyMatrix3(u).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return mr.makeRotationX(t),this.applyMatrix4(mr),this},rotateY:function(t){return mr.makeRotationY(t),this.applyMatrix4(mr),this},rotateZ:function(t){return mr.makeRotationZ(t),this.applyMatrix4(mr),this},translate:function(t,u,m){return mr.makeTranslation(t,u,m),this.applyMatrix4(mr),this},scale:function(t,u,m){return mr.makeScale(t,u,m),this.applyMatrix4(mr),this},lookAt:function(t){return Jo.lookAt(t),Jo.updateMatrix(),this.applyMatrix4(Jo.matrix),this},fromBufferGeometry:function(t){const u=this,m=null!==t.index?t.index:void 0,g=t.attributes;if(void 0===g.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const E=g.position,I=g.normal,H=g.color,J=g.uv,Y=g.uv2;void 0!==Y&&(this.faceVertexUvs[1]=[]);for(let ge=0;ge<E.count;ge++)u.vertices.push((new lt).fromBufferAttribute(E,ge)),void 0!==H&&u.colors.push((new ar).fromBufferAttribute(H,ge));function K(ge,Se,w,e){const c=void 0===H?[]:[u.colors[ge].clone(),u.colors[Se].clone(),u.colors[w].clone()],d=new ma(ge,Se,w,void 0===I?[]:[(new lt).fromBufferAttribute(I,ge),(new lt).fromBufferAttribute(I,Se),(new lt).fromBufferAttribute(I,w)],c,e);u.faces.push(d),void 0!==J&&u.faceVertexUvs[0].push([(new En).fromBufferAttribute(J,ge),(new En).fromBufferAttribute(J,Se),(new En).fromBufferAttribute(J,w)]),void 0!==Y&&u.faceVertexUvs[1].push([(new En).fromBufferAttribute(Y,ge),(new En).fromBufferAttribute(Y,Se),(new En).fromBufferAttribute(Y,w)])}const me=t.groups;if(me.length>0)for(let ge=0;ge<me.length;ge++){const Se=me[ge],w=Se.start;for(let e=w,c=w+Se.count;e<c;e+=3)void 0!==m?K(m.getX(e),m.getX(e+1),m.getX(e+2),Se.materialIndex):K(e,e+1,e+2,Se.materialIndex)}else if(void 0!==m)for(let ge=0;ge<m.count;ge+=3)K(m.getX(ge),m.getX(ge+1),m.getX(ge+2));else for(let ge=0;ge<E.count;ge+=3)K(ge,ge+1,ge+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_l).negate(),this.translate(_l.x,_l.y,_l.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,u=this.boundingSphere.radius,m=0===u?1:1/u,g=new ri;return g.set(m,0,0,-m*t.x,0,m,0,-m*t.y,0,0,m,-m*t.z,0,0,0,1),this.applyMatrix4(g),this},computeFaceNormals:function(){const t=new lt,u=new lt;for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=this.vertices[E.a],H=this.vertices[E.b];t.subVectors(this.vertices[E.c],H),u.subVectors(I,H),t.cross(u),t.normalize(),E.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);const u=new Array(this.vertices.length);for(let m=0,g=this.vertices.length;m<g;m++)u[m]=new lt;if(t){const m=new lt,g=new lt;for(let E=0,I=this.faces.length;E<I;E++){const H=this.faces[E],J=this.vertices[H.a],Y=this.vertices[H.b];m.subVectors(this.vertices[H.c],Y),g.subVectors(J,Y),m.cross(g),u[H.a].add(m),u[H.b].add(m),u[H.c].add(m)}}else{this.computeFaceNormals();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];u[E.a].add(E.normal),u[E.b].add(E.normal),u[E.c].add(E.normal)}}for(let m=0,g=this.vertices.length;m<g;m++)u[m].normalize();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=E.vertexNormals;3===I.length?(I[0].copy(u[E.a]),I[1].copy(u[E.b]),I[2].copy(u[E.c])):(I[0]=u[E.a].clone(),I[1]=u[E.b].clone(),I[2]=u[E.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,u=this.faces.length;t<u;t++){const m=this.faces[t],g=m.vertexNormals;3===g.length?(g[0].copy(m.normal),g[1].copy(m.normal),g[2].copy(m.normal)):(g[0]=m.normal.clone(),g[1]=m.normal.clone(),g[2]=m.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]);for(let E=0,I=g.vertexNormals.length;E<I;E++)g.__originalVertexNormals[E]?g.__originalVertexNormals[E].copy(g.vertexNormals[E]):g.__originalVertexNormals[E]=g.vertexNormals[E].clone()}const t=new kr;t.faces=this.faces;for(let u=0,m=this.morphTargets.length;u<m;u++){if(!this.morphNormals[u]){this.morphNormals[u]={},this.morphNormals[u].faceNormals=[],this.morphNormals[u].vertexNormals=[];const E=this.morphNormals[u].faceNormals,I=this.morphNormals[u].vertexNormals;for(let H=0,J=this.faces.length;H<J;H++){const Y=new lt,K={a:new lt,b:new lt,c:new lt};E.push(Y),I.push(K)}}const g=this.morphNormals[u];t.vertices=this.morphTargets[u].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let E=0,I=this.faces.length;E<I;E++){const H=this.faces[E],Y=g.vertexNormals[E];g.faceNormals[E].copy(H.normal),Y.a.copy(H.vertexNormals[0]),Y.b.copy(H.vertexNormals[1]),Y.c.copy(H.vertexNormals[2])}}for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new fn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new jn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,u,m){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let g,E=this.vertices.length,I=this.vertices,H=t.vertices,J=this.faces,Y=t.faces,K=this.colors,me=t.colors;void 0===m&&(m=0),void 0!==u&&(g=(new Ho).getNormalMatrix(u));for(let ge=0,Se=H.length;ge<Se;ge++){const w=H[ge].clone();void 0!==u&&w.applyMatrix4(u),I.push(w)}for(let ge=0,Se=me.length;ge<Se;ge++)K.push(me[ge].clone());for(let ge=0,Se=Y.length;ge<Se;ge++){let w,e,c,d=Y[ge],_=d.vertexNormals,S=d.vertexColors;w=new ma(d.a+E,d.b+E,d.c+E),w.normal.copy(d.normal),void 0!==g&&w.normal.applyMatrix3(g).normalize();for(let L=0,k=_.length;L<k;L++)e=_[L].clone(),void 0!==g&&e.applyMatrix3(g).normalize(),w.vertexNormals.push(e);w.color.copy(d.color);for(let L=0,k=S.length;L<k;L++)c=S[L],w.vertexColors.push(c.clone());w.materialIndex=d.materialIndex+m,J.push(w)}for(let ge=0,Se=t.faceVertexUvs.length;ge<Se;ge++){const w=t.faceVertexUvs[ge];void 0===this.faceVertexUvs[ge]&&(this.faceVertexUvs[ge]=[]);for(let e=0,c=w.length;e<c;e++){const d=w[e],_=[];for(let S=0,L=d.length;S<L;S++)_.push(d[S].clone());this.faceVertexUvs[ge].push(_)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){const t={},u=[],m=[],g=Math.pow(10,4);for(let H=0,J=this.vertices.length;H<J;H++){const Y=this.vertices[H],K=Math.round(Y.x*g)+"_"+Math.round(Y.y*g)+"_"+Math.round(Y.z*g);void 0===t[K]?(t[K]=H,u.push(this.vertices[H]),m[H]=u.length-1):m[H]=m[t[K]]}const E=[];for(let H=0,J=this.faces.length;H<J;H++){const Y=this.faces[H];Y.a=m[Y.a],Y.b=m[Y.b],Y.c=m[Y.c];const K=[Y.a,Y.b,Y.c];for(let me=0;me<3;me++)if(K[me]===K[(me+1)%3]){E.push(H);break}}for(let H=E.length-1;H>=0;H--){const J=E[H];this.faces.splice(J,1);for(let Y=0,K=this.faceVertexUvs.length;Y<K;Y++)this.faceVertexUvs[Y].splice(J,1)}const I=this.vertices.length-u.length;return this.vertices=u,I},setFromPoints:function(t){this.vertices=[];for(let u=0,m=t.length;u<m;u++){const g=t[u];this.vertices.push(new lt(g.x,g.y,g.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,u=t.length;for(let H=0;H<u;H++)t[H]._id=H;t.sort(function(H,J){return H.materialIndex-J.materialIndex});const m=this.faceVertexUvs[0],g=this.faceVertexUvs[1];let E,I;m&&m.length===u&&(E=[]),g&&g.length===u&&(I=[]);for(let H=0;H<u;H++){const J=t[H]._id;E&&E.push(m[J]),I&&I.push(g[J])}E&&(this.faceVertexUvs[0]=E),I&&(this.faceVertexUvs[1]=I)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const w=this.parameters;for(const e in w)void 0!==w[e]&&(t[e]=w[e]);return t}const u=[];for(let w=0;w<this.vertices.length;w++){const e=this.vertices[w];u.push(e.x,e.y,e.z)}const m=[],g=[],E={},I=[],H={},J=[],Y={};for(let w=0;w<this.faces.length;w++){const e=this.faces[w],c=!0,d=!1,_=void 0!==this.faceVertexUvs[0][w],S=e.normal.length()>0,L=e.vertexNormals.length>0,k=1!==e.color.r||1!==e.color.g||1!==e.color.b,F=e.vertexColors.length>0;let V=0;if(V=K(V,0,0),V=K(V,1,c),V=K(V,2,d),V=K(V,3,_),V=K(V,4,S),V=K(V,5,L),V=K(V,6,k),V=K(V,7,F),m.push(V),m.push(e.a,e.b,e.c),m.push(e.materialIndex),_){const te=this.faceVertexUvs[0][w];m.push(Se(te[0]),Se(te[1]),Se(te[2]))}if(S&&m.push(me(e.normal)),L){const te=e.vertexNormals;m.push(me(te[0]),me(te[1]),me(te[2]))}if(k&&m.push(ge(e.color)),F){const te=e.vertexColors;m.push(ge(te[0]),ge(te[1]),ge(te[2]))}}function K(w,e,c){return c?w|1<<e:w&~(1<<e)}function me(w){const e=w.x.toString()+w.y.toString()+w.z.toString();return void 0!==E[e]||(E[e]=g.length/3,g.push(w.x,w.y,w.z)),E[e]}function ge(w){const e=w.r.toString()+w.g.toString()+w.b.toString();return void 0!==H[e]||(H[e]=I.length,I.push(w.getHex())),H[e]}function Se(w){const e=w.x.toString()+w.y.toString();return void 0!==Y[e]||(Y[e]=J.length/2,J.push(w.x,w.y)),Y[e]}return t.data={},t.data.vertices=u,t.data.normals=g,I.length>0&&(t.data.colors=I),J.length>0&&(t.data.uvs=[J]),t.data.faces=m,t},clone:function(){return(new kr).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const u=t.vertices;for(let ge=0,Se=u.length;ge<Se;ge++)this.vertices.push(u[ge].clone());const m=t.colors;for(let ge=0,Se=m.length;ge<Se;ge++)this.colors.push(m[ge].clone());const g=t.faces;for(let ge=0,Se=g.length;ge<Se;ge++)this.faces.push(g[ge].clone());for(let ge=0,Se=t.faceVertexUvs.length;ge<Se;ge++){const w=t.faceVertexUvs[ge];void 0===this.faceVertexUvs[ge]&&(this.faceVertexUvs[ge]=[]);for(let e=0,c=w.length;e<c;e++){const d=w[e],_=[];for(let S=0,L=d.length;S<L;S++)_.push(d[S].clone());this.faceVertexUvs[ge].push(_)}}const E=t.morphTargets;for(let ge=0,Se=E.length;ge<Se;ge++){const w={};if(w.name=E[ge].name,void 0!==E[ge].vertices){w.vertices=[];for(let e=0,c=E[ge].vertices.length;e<c;e++)w.vertices.push(E[ge].vertices[e].clone())}if(void 0!==E[ge].normals){w.normals=[];for(let e=0,c=E[ge].normals.length;e<c;e++)w.normals.push(E[ge].normals[e].clone())}this.morphTargets.push(w)}const I=t.morphNormals;for(let ge=0,Se=I.length;ge<Se;ge++){const w={};if(void 0!==I[ge].vertexNormals){w.vertexNormals=[];for(let e=0,c=I[ge].vertexNormals.length;e<c;e++){const d=I[ge].vertexNormals[e],_={};_.a=d.a.clone(),_.b=d.b.clone(),_.c=d.c.clone(),w.vertexNormals.push(_)}}if(void 0!==I[ge].faceNormals){w.faceNormals=[];for(let e=0,c=I[ge].faceNormals.length;e<c;e++)w.faceNormals.push(I[ge].faceNormals[e].clone())}this.morphNormals.push(w)}const H=t.skinWeights;for(let ge=0,Se=H.length;ge<Se;ge++)this.skinWeights.push(H[ge].clone());const J=t.skinIndices;for(let ge=0,Se=J.length;ge<Se;ge++)this.skinIndices.push(J[ge].clone());const Y=t.lineDistances;for(let ge=0,Se=Y.length;ge<Se;ge++)this.lineDistances.push(Y[ge]);const K=t.boundingBox;null!==K&&(this.boundingBox=K.clone());const me=t.boundingSphere;return null!==me&&(this.boundingSphere=me.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Ls extends kr{constructor(u,m,g,E,I,H){super(),this.type="BoxGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:H},this.fromBufferGeometry(new lh(u,m,g,E,I,H)),this.mergeVertices()}}class lh extends hn{constructor(u=1,m=1,g=1,E=1,I=1,H=1){super(),this.type="BoxBufferGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:H};const J=this;E=Math.floor(E),I=Math.floor(I),H=Math.floor(H);const Y=[],K=[],me=[],ge=[];let Se=0,w=0;function e(c,d,_,S,L,k,F,V,te,le,ue){const _e=k/te,Ee=F/le,$e=k/2,Le=F/2,Ne=V/2,We=te+1,tt=le+1;let Ze=0,ot=0;const st=new lt;for(let Ct=0;Ct<tt;Ct++){const Ft=Ct*Ee-Le;for(let Qe=0;Qe<We;Qe++)st[c]=(Qe*_e-$e)*S,st[d]=Ft*L,st[_]=Ne,K.push(st.x,st.y,st.z),st[c]=0,st[d]=0,st[_]=V>0?1:-1,me.push(st.x,st.y,st.z),ge.push(Qe/te),ge.push(1-Ct/le),Ze+=1}for(let Ct=0;Ct<le;Ct++)for(let Ft=0;Ft<te;Ft++){const nt=Se+Ft+We*(Ct+1),Tt=Se+(Ft+1)+We*(Ct+1),Yt=Se+(Ft+1)+We*Ct;Y.push(Se+Ft+We*Ct,nt,Yt),Y.push(nt,Tt,Yt),ot+=6}J.addGroup(w,ot,ue),w+=ot,Se+=Ze}e("z","y","x",-1,-1,g,m,u,H,I,0),e("z","y","x",1,-1,g,m,-u,H,I,1),e("x","z","y",1,1,u,g,m,E,H,2),e("x","z","y",1,-1,u,g,-m,E,H,3),e("x","y","z",1,-1,u,m,g,E,I,4),e("x","y","z",-1,-1,u,m,-g,E,I,5),this.setIndex(Y),this.setAttribute("position",new Un(K,3)),this.setAttribute("normal",new Un(me,3)),this.setAttribute("uv",new Un(ge,2))}}function Kc(t){const u={};for(const m in t){u[m]={};for(const g in t[m]){const E=t[m][g];u[m][g]=E&&(E.isColor||E.isMatrix3||E.isMatrix4||E.isVector2||E.isVector3||E.isVector4||E.isTexture)?E.clone():Array.isArray(E)?E.slice():E}}return u}function Bs(t){const u={};for(let m=0;m<t.length;m++){const g=Kc(t[m]);for(const E in g)u[E]=g[E]}return u}const Ro={clone:Kc,merge:Bs};var ep="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",tc="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function co(t){Ur.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=ep,this.fragmentShader=tc,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Ai(){Qn.call(this),this.type="Camera",this.matrixWorldInverse=new ri,this.projectionMatrix=new ri,this.projectionMatrixInverse=new ri}function Ns(t,u,m,g){Ai.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==m?m:.1,this.far=void 0!==g?g:2e3,this.focus=10,this.aspect=void 0!==u?u:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(co.prototype=Object.create(Ur.prototype)).constructor=co,co.prototype.isShaderMaterial=!0,co.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Kc(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this},co.prototype.toJSON=function(t){const u=Ur.prototype.toJSON.call(this,t);u.uniforms={};for(const g in this.uniforms){const E=this.uniforms[g].value;u.uniforms[g]=E&&E.isTexture?{type:"t",value:E.toJSON(t).uuid}:E&&E.isColor?{type:"c",value:E.getHex()}:E&&E.isVector2?{type:"v2",value:E.toArray()}:E&&E.isVector3?{type:"v3",value:E.toArray()}:E&&E.isVector4?{type:"v4",value:E.toArray()}:E&&E.isMatrix3?{type:"m3",value:E.toArray()}:E&&E.isMatrix4?{type:"m4",value:E.toArray()}:{value:E}}Object.keys(this.defines).length>0&&(u.defines=this.defines),u.vertexShader=this.vertexShader,u.fragmentShader=this.fragmentShader;const m={};for(const g in this.extensions)!0===this.extensions[g]&&(m[g]=!0);return Object.keys(m).length>0&&(u.extensions=m),u},Ai.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Ai,isCamera:!0,copy:function(t,u){return Qn.prototype.copy.call(this,t,u),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new lt),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(-u[8],-u[9],-u[10]).normalize()},updateMatrixWorld:function(t){Qn.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,u){Qn.prototype.updateWorldMatrix.call(this,t,u),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Ns.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Ns,isPerspectiveCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const u=.5*this.getFilmHeight()/t;this.fov=2*er.RAD2DEG*Math.atan(u),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*er.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*er.RAD2DEG*Math.atan(Math.tan(.5*er.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,u,m,g,E,I){this.aspect=t/u,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let t=this.near,u=t*Math.tan(.5*er.DEG2RAD*this.fov)/this.zoom,m=2*u,g=this.aspect*m,E=-.5*g,I=this.view;if(null!==this.view&&this.view.enabled){const J=I.fullWidth,Y=I.fullHeight;E+=I.offsetX*g/J,u-=I.offsetY*m/Y,g*=I.width/J,m*=I.height/Y}const H=this.filmOffset;0!==H&&(E+=t*H/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+g,u,u-m,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Qn.prototype.toJSON.call(this,t);return u.object.fov=this.fov,u.object.zoom=this.zoom,u.object.near=this.near,u.object.far=this.far,u.object.focus=this.focus,u.object.aspect=this.aspect,null!==this.view&&(u.object.view=Object.assign({},this.view)),u.object.filmGauge=this.filmGauge,u.object.filmOffset=this.filmOffset,u}});const Rs=90,Rl=1;function Po(t,u,m){if(Qn.call(this),this.type="CubeCamera",!0!==m.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=m;const g=new Ns(Rs,Rl,t,u);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new lt(1,0,0)),this.add(g);const E=new Ns(Rs,Rl,t,u);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new lt(-1,0,0)),this.add(E);const I=new Ns(Rs,Rl,t,u);I.layers=this.layers,I.up.set(0,0,1),I.lookAt(new lt(0,1,0)),this.add(I);const H=new Ns(Rs,Rl,t,u);H.layers=this.layers,H.up.set(0,0,-1),H.lookAt(new lt(0,-1,0)),this.add(H);const J=new Ns(Rs,Rl,t,u);J.layers=this.layers,J.up.set(0,-1,0),J.lookAt(new lt(0,0,1)),this.add(J);const Y=new Ns(Rs,Rl,t,u);Y.layers=this.layers,Y.up.set(0,-1,0),Y.lookAt(new lt(0,0,-1)),this.add(Y),this.update=function(K,me){null===this.parent&&this.updateMatrixWorld();const ge=K.xr.enabled,Se=K.getRenderTarget();K.xr.enabled=!1;const w=m.texture.generateMipmaps;m.texture.generateMipmaps=!1,K.setRenderTarget(m,0),K.render(me,g),K.setRenderTarget(m,1),K.render(me,E),K.setRenderTarget(m,2),K.render(me,I),K.setRenderTarget(m,3),K.render(me,H),K.setRenderTarget(m,4),K.render(me,J),m.texture.generateMipmaps=w,K.setRenderTarget(m,5),K.render(me,Y),K.setRenderTarget(Se),K.xr.enabled=ge},this.clear=function(K,me,ge,Se){const w=K.getRenderTarget();for(let e=0;e<6;e++)K.setRenderTarget(m,e),K.clear(me,ge,Se);K.setRenderTarget(w)}}function Pl(t,u,m){Number.isInteger(u)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),u=m),Fs.call(this,t,t,u)}function gl(t,u,m,g,E,I,H,J,Y,K,me,ge){di.call(this,null,I,H,J,Y,K,g,E,me,ge),this.image={data:t||null,width:u||1,height:m||1},this.magFilter=void 0!==Y?Y:Ir,this.minFilter=void 0!==K?K:Ir,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Po.prototype=Object.create(Qn.prototype)).constructor=Po,(Pl.prototype=Object.create(Fs.prototype)).constructor=Pl,Pl.prototype.isWebGLCubeRenderTarget=!0,Pl.prototype.fromEquirectangularTexture=function(t,u){this.texture.type=u.type,this.texture.format=ao,this.texture.encoding=u.encoding,this.texture.generateMipmaps=u.generateMipmaps,this.texture.minFilter=u.minFilter,this.texture.magFilter=u.magFilter;const m=new Cl,I=new co({name:"CubemapFromEquirect",uniforms:Kc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:W,blending:X});I.uniforms.tEquirect.value=u;const H=new Ci(new lh(5,5,5),I);return m.add(H),new Po(1,10,this).update(t,m),H.geometry.dispose(),H.material.dispose(),this},(gl.prototype=Object.create(di.prototype)).constructor=gl,gl.prototype.isDataTexture=!0;const nc=new jn,Bc=new lt;function eu(t,u,m,g,E,I){this.planes=[void 0!==t?t:new Yo,void 0!==u?u:new Yo,void 0!==m?m:new Yo,void 0!==g?g:new Yo,void 0!==E?E:new Yo,void 0!==I?I:new Yo]}Object.assign(eu.prototype,{set:function(t,u,m,g,E,I){const H=this.planes;return H[0].copy(t),H[1].copy(u),H[2].copy(m),H[3].copy(g),H[4].copy(E),H[5].copy(I),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const u=this.planes;for(let m=0;m<6;m++)u[m].copy(t.planes[m]);return this},setFromProjectionMatrix:function(t){const u=this.planes,m=t.elements,g=m[0],E=m[1],I=m[2],H=m[3],J=m[4],Y=m[5],K=m[6],me=m[7],ge=m[8],Se=m[9],w=m[10],e=m[11],c=m[12],d=m[13],_=m[14],S=m[15];return u[0].setComponents(H-g,me-J,e-ge,S-c).normalize(),u[1].setComponents(H+g,me+J,e+ge,S+c).normalize(),u[2].setComponents(H+E,me+Y,e+Se,S+d).normalize(),u[3].setComponents(H-E,me-Y,e-Se,S-d).normalize(),u[4].setComponents(H-I,me-K,e-w,S-_).normalize(),u[5].setComponents(H+I,me+K,e+w,S+_).normalize(),this},intersectsObject:function(t){const u=t.geometry;return null===u.boundingSphere&&u.computeBoundingSphere(),nc.copy(u.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(nc)},intersectsSprite:function(t){return nc.center.set(0,0,0),nc.radius=.7071067811865476,nc.applyMatrix4(t.matrixWorld),this.intersectsSphere(nc)},intersectsSphere:function(t){const u=this.planes,m=t.center,g=-t.radius;for(let E=0;E<6;E++)if(u[E].distanceToPoint(m)<g)return!1;return!0},intersectsBox:function(t){const u=this.planes;for(let m=0;m<6;m++){const g=u[m];if(Bc.x=g.normal.x>0?t.max.x:t.min.x,Bc.y=g.normal.y>0?t.max.y:t.min.y,Bc.z=g.normal.z>0?t.max.z:t.min.z,g.distanceToPoint(Bc)<0)return!1}return!0},containsPoint:function(t){const u=this.planes;for(let m=0;m<6;m++)if(u[m].distanceToPoint(t)<0)return!1;return!0}});const hr={common:{diffuse:{value:new ar(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ho},uv2Transform:{value:new Ho},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new En(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ar(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ar(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ho}},sprite:{diffuse:{value:new ar(15658734)},opacity:{value:1},center:{value:new En(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ho}}};function Lp(){let t=null,u=!1,m=null,g=null;function E(I,H){m(I,H),g=t.requestAnimationFrame(E)}return{start:function(){!0!==u&&null!==m&&(g=t.requestAnimationFrame(E),u=!0)},stop:function(){t.cancelAnimationFrame(g),u=!1},setAnimationLoop:function(I){m=I},setContext:function(I){t=I}}}function Ra(t,u){const m=u.isWebGL2,g=new WeakMap;return{get:function(E){return E.isInterleavedBufferAttribute&&(E=E.data),g.get(E)},remove:function(E){E.isInterleavedBufferAttribute&&(E=E.data);const I=g.get(E);I&&(t.deleteBuffer(I.buffer),g.delete(E))},update:function(E,I){E.isInterleavedBufferAttribute&&(E=E.data);const H=g.get(E);void 0===H?g.set(E,function(J,Y){const K=J.array,me=J.usage,ge=t.createBuffer();t.bindBuffer(Y,ge),t.bufferData(Y,K,me),J.onUploadCallback();let Se=5126;return K instanceof Float32Array?Se=5126:K instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):K instanceof Uint16Array?Se=5123:K instanceof Int16Array?Se=5122:K instanceof Uint32Array?Se=5125:K instanceof Int32Array?Se=5124:K instanceof Int8Array?Se=5120:K instanceof Uint8Array&&(Se=5121),{buffer:ge,type:Se,bytesPerElement:K.BYTES_PER_ELEMENT,version:J.version}}(E,I)):H.version<E.version&&(function(J,Y,K){const me=Y.array,ge=Y.updateRange;t.bindBuffer(K,J),-1===ge.count?t.bufferSubData(K,0,me):(m?t.bufferSubData(K,ge.offset*me.BYTES_PER_ELEMENT,me,ge.offset,ge.count):t.bufferSubData(K,ge.offset*me.BYTES_PER_ELEMENT,me.subarray(ge.offset,ge.offset+ge.count)),ge.count=-1)}(H.buffer,E,I),H.version=E.version)}}}function Ka(t,u,m,g){kr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g},this.fromBufferGeometry(new Il(t,u,m,g)),this.mergeVertices()}function Il(t,u,m,g){hn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g};const E=(t=t||1)/2,I=(u=u||1)/2,H=Math.floor(m)||1,J=Math.floor(g)||1,Y=H+1,K=J+1,me=t/H,ge=u/J,Se=[],w=[],e=[],c=[];for(let d=0;d<K;d++){const _=d*ge-I;for(let S=0;S<Y;S++)w.push(S*me-E,-_,0),e.push(0,0,1),c.push(S/H),c.push(1-d/J)}for(let d=0;d<J;d++)for(let _=0;_<H;_++){const L=_+Y*(d+1),k=_+1+Y*(d+1),F=_+1+Y*d;Se.push(_+Y*d,L,F),Se.push(L,k,F)}this.setIndex(Se),this.setAttribute("position",new Un(w,3)),this.setAttribute("normal",new Un(e,3)),this.setAttribute("uv",new Un(c,2))}(Ka.prototype=Object.create(kr.prototype)).constructor=Ka,(Il.prototype=Object.create(hn.prototype)).constructor=Il;const Fr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},Nc={basic:{uniforms:Bs([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.fog]),vertexShader:Fr.meshbasic_vert,fragmentShader:Fr.meshbasic_frag},lambert:{uniforms:Bs([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.fog,hr.lights,{emissive:{value:new ar(0)}}]),vertexShader:Fr.meshlambert_vert,fragmentShader:Fr.meshlambert_frag},phong:{uniforms:Bs([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new ar(0)},specular:{value:new ar(1118481)},shininess:{value:30}}]),vertexShader:Fr.meshphong_vert,fragmentShader:Fr.meshphong_frag},standard:{uniforms:Bs([hr.common,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.roughnessmap,hr.metalnessmap,hr.fog,hr.lights,{emissive:{value:new ar(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag},toon:{uniforms:Bs([hr.common,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.gradientmap,hr.fog,hr.lights,{emissive:{value:new ar(0)}}]),vertexShader:Fr.meshtoon_vert,fragmentShader:Fr.meshtoon_frag},matcap:{uniforms:Bs([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,{matcap:{value:null}}]),vertexShader:Fr.meshmatcap_vert,fragmentShader:Fr.meshmatcap_frag},points:{uniforms:Bs([hr.points,hr.fog]),vertexShader:Fr.points_vert,fragmentShader:Fr.points_frag},dashed:{uniforms:Bs([hr.common,hr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fr.linedashed_vert,fragmentShader:Fr.linedashed_frag},depth:{uniforms:Bs([hr.common,hr.displacementmap]),vertexShader:Fr.depth_vert,fragmentShader:Fr.depth_frag},normal:{uniforms:Bs([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,{opacity:{value:1}}]),vertexShader:Fr.normal_vert,fragmentShader:Fr.normal_frag},sprite:{uniforms:Bs([hr.sprite,hr.fog]),vertexShader:Fr.sprite_vert,fragmentShader:Fr.sprite_frag},background:{uniforms:{uvTransform:{value:new Ho},t2D:{value:null}},vertexShader:Fr.background_vert,fragmentShader:Fr.background_frag},cube:{uniforms:Bs([hr.envmap,{opacity:{value:1}}]),vertexShader:Fr.cube_vert,fragmentShader:Fr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fr.equirect_vert,fragmentShader:Fr.equirect_frag},distanceRGBA:{uniforms:Bs([hr.common,hr.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fr.distanceRGBA_vert,fragmentShader:Fr.distanceRGBA_frag},shadow:{uniforms:Bs([hr.lights,hr.fog,{color:{value:new ar(0)},opacity:{value:1}}]),vertexShader:Fr.shadow_vert,fragmentShader:Fr.shadow_frag}};function qp(t,u,m,g){const E=new ar(0);let I,H,J=0,Y=null,K=0,me=null;function ge(Se,w){u.buffers.color.setClear(Se.r,Se.g,Se.b,w,g)}return{getClearColor:function(){return E},setClearColor:function(Se,w){E.set(Se),J=void 0!==w?w:1,ge(E,J)},getClearAlpha:function(){return J},setClearAlpha:function(Se){J=Se,ge(E,J)},render:function(Se,w,e,c){let d=!0===w.isScene?w.background:null;const _=t.xr,S=_.getSession&&_.getSession();if(S&&"additive"===S.environmentBlendMode&&(d=null),null===d?ge(E,J):d&&d.isColor&&(ge(d,1),c=!0),(t.autoClear||c)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&(d.isCubeTexture||d.isWebGLCubeRenderTarget||d.mapping===Ni)){void 0===H&&(H=new Ci(new lh(1,1,1),new co({name:"BackgroundCubeMaterial",uniforms:Kc(Nc.cube.uniforms),vertexShader:Nc.cube.vertexShader,fragmentShader:Nc.cube.fragmentShader,side:W,depthTest:!1,depthWrite:!1,fog:!1})),H.geometry.deleteAttribute("normal"),H.geometry.deleteAttribute("uv"),H.onBeforeRender=function(k,F,V){this.matrixWorld.copyPosition(V.matrixWorld)},Object.defineProperty(H.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),m.update(H));const L=d.isWebGLCubeRenderTarget?d.texture:d;H.material.uniforms.envMap.value=L,H.material.uniforms.flipEnvMap.value=L.isCubeTexture?-1:1,Y===d&&K===L.version&&me===t.toneMapping||(H.material.needsUpdate=!0,Y=d,K=L.version,me=t.toneMapping),Se.unshift(H,H.geometry,H.material,0,0,null)}else d&&d.isTexture&&(void 0===I&&(I=new Ci(new Il(2,2),new co({name:"BackgroundMaterial",uniforms:Kc(Nc.background.uniforms),vertexShader:Nc.background.vertexShader,fragmentShader:Nc.background.fragmentShader,side:ae,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),m.update(I)),I.material.uniforms.t2D.value=d,!0===d.matrixAutoUpdate&&d.updateMatrix(),I.material.uniforms.uvTransform.value.copy(d.matrix),Y===d&&K===d.version&&me===t.toneMapping||(I.material.needsUpdate=!0,Y=d,K=d.version,me=t.toneMapping),Se.unshift(I,I.geometry,I.material,0,0,null))}}}function Eu(t,u,m,g){const E=t.getParameter(34921),I=g.isWebGL2?null:u.get("OES_vertex_array_object"),H=g.isWebGL2||null!==I,J={},Y=Se(null);let K=Y;function me(k){return g.isWebGL2?t.bindVertexArray(k):I.bindVertexArrayOES(k)}function ge(k){return g.isWebGL2?t.deleteVertexArray(k):I.deleteVertexArrayOES(k)}function Se(k){const F=[],V=[],te=[];for(let le=0;le<E;le++)F[le]=0,V[le]=0,te[le]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:F,enabledAttributes:V,attributeDivisors:te,object:k,attributes:{}}}function w(){const k=K.newAttributes;for(let F=0,V=k.length;F<V;F++)k[F]=0}function e(k){c(k,0)}function c(k,F){const te=K.enabledAttributes,le=K.attributeDivisors;K.newAttributes[k]=1,0===te[k]&&(t.enableVertexAttribArray(k),te[k]=1),le[k]!==F&&((g.isWebGL2?t:u.get("ANGLE_instanced_arrays"))[g.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,F),le[k]=F)}function d(){const k=K.newAttributes,F=K.enabledAttributes;for(let V=0,te=F.length;V<te;V++)F[V]!==k[V]&&(t.disableVertexAttribArray(V),F[V]=0)}function _(k,F,V,te,le,ue){!0!==g.isWebGL2||5124!==V&&5125!==V?t.vertexAttribPointer(k,F,V,te,le,ue):t.vertexAttribIPointer(k,F,V,le,ue)}function S(){L(),K!==Y&&(K=Y,me(K.object))}function L(){Y.geometry=null,Y.program=null,Y.wireframe=!1}return{setup:function(k,F,V,te,le){let ue=!1;if(H){const _e=function(Ee,$e,Le){const Ne=!0===Le.wireframe;let We=J[Ee.id];void 0===We&&(We={},J[Ee.id]=We);let tt=We[$e.id];void 0===tt&&(tt={},We[$e.id]=tt);let Ze=tt[Ne];return void 0===Ze&&(Ze=Se(g.isWebGL2?t.createVertexArray():I.createVertexArrayOES()),tt[Ne]=Ze),Ze}(te,V,F);K!==_e&&(K=_e,me(K.object)),ue=function(Ee){const $e=K.attributes,Le=Ee.attributes;if(Object.keys($e).length!==Object.keys(Le).length)return!0;for(const Ne in Le){const We=$e[Ne],tt=Le[Ne];if(We.attribute!==tt||We.data!==tt.data)return!0}return!1}(te),ue&&function(Ee){const $e={},Le=Ee.attributes;for(const Ne in Le){const We=Le[Ne],tt={};tt.attribute=We,We.data&&(tt.data=We.data),$e[Ne]=tt}K.attributes=$e}(te)}else{const _e=!0===F.wireframe;K.geometry===te.id&&K.program===V.id&&K.wireframe===_e||(K.geometry=te.id,K.program=V.id,K.wireframe=_e,ue=!0)}!0===k.isInstancedMesh&&(ue=!0),null!==le&&m.update(le,34963),ue&&(function(_e,Ee,$e,Le){if(!1===g.isWebGL2&&(_e.isInstancedMesh||Le.isInstancedBufferGeometry)&&null===u.get("ANGLE_instanced_arrays"))return;w();const Ne=Le.attributes,We=$e.getAttributes(),tt=Ee.defaultAttributeValues;for(const Ze in We){const ot=We[Ze];if(ot>=0){const st=Ne[Ze];if(void 0!==st){const Ct=st.normalized,Ft=st.itemSize,Qe=m.get(st);if(void 0===Qe)continue;const nt=Qe.buffer,Tt=Qe.type,Yt=Qe.bytesPerElement;if(st.isInterleavedBufferAttribute){const ct=st.data,Lt=ct.stride,_t=st.offset;ct&&ct.isInstancedInterleavedBuffer?(c(ot,ct.meshPerAttribute),void 0===Le._maxInstanceCount&&(Le._maxInstanceCount=ct.meshPerAttribute*ct.count)):e(ot),t.bindBuffer(34962,nt),_(ot,Ft,Tt,Ct,Lt*Yt,_t*Yt)}else st.isInstancedBufferAttribute?(c(ot,st.meshPerAttribute),void 0===Le._maxInstanceCount&&(Le._maxInstanceCount=st.meshPerAttribute*st.count)):e(ot),t.bindBuffer(34962,nt),_(ot,Ft,Tt,Ct,0,0)}else if("instanceMatrix"===Ze){const Ct=m.get(_e.instanceMatrix);if(void 0===Ct)continue;const Ft=Ct.buffer,Qe=Ct.type;c(ot+0,1),c(ot+1,1),c(ot+2,1),c(ot+3,1),t.bindBuffer(34962,Ft),t.vertexAttribPointer(ot+0,4,Qe,!1,64,0),t.vertexAttribPointer(ot+1,4,Qe,!1,64,16),t.vertexAttribPointer(ot+2,4,Qe,!1,64,32),t.vertexAttribPointer(ot+3,4,Qe,!1,64,48)}else if(void 0!==tt){const Ct=tt[Ze];if(void 0!==Ct)switch(Ct.length){case 2:t.vertexAttrib2fv(ot,Ct);break;case 3:t.vertexAttrib3fv(ot,Ct);break;case 4:t.vertexAttrib4fv(ot,Ct);break;default:t.vertexAttrib1fv(ot,Ct)}}}}d()}(k,F,V,te),null!==le&&t.bindBuffer(34963,m.get(le).buffer))},reset:S,resetDefaultState:L,dispose:function(){S();for(const k in J){const F=J[k];for(const V in F){const te=F[V];for(const le in te)ge(te[le].object),delete te[le];delete F[V]}delete J[k]}},releaseStatesOfGeometry:function(k){if(void 0===J[k.id])return;const F=J[k.id];for(const V in F){const te=F[V];for(const le in te)ge(te[le].object),delete te[le];delete F[V]}delete J[k.id]},releaseStatesOfProgram:function(k){for(const F in J){const V=J[F];if(void 0===V[k.id])continue;const te=V[k.id];for(const le in te)ge(te[le].object),delete te[le];delete V[k.id]}},initAttributes:w,enableAttribute:e,disableUnusedAttributes:d}}function ui(t,u,m,g){const E=g.isWebGL2;let I;this.setMode=function(H){I=H},this.render=function(H,J){t.drawArrays(I,H,J),m.update(J,I,1)},this.renderInstances=function(H,J,Y){if(0===Y)return;let K,me;if(E)K=t,me="drawArraysInstanced";else if(K=u.get("ANGLE_instanced_arrays"),me="drawArraysInstancedANGLE",null===K)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");K[me](I,H,J,Y),m.update(J,I,Y)}}function sr(t,u,m){let g;function E(L){if("highp"===L){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";L="mediump"}return"mediump"===L&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const I=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext;let H=void 0!==m.precision?m.precision:"highp";const J=E(H);J!==H&&(console.warn("THREE.WebGLRenderer:",H,"not supported, using",J,"instead."),H=J);const Y=!0===m.logarithmicDepthBuffer,K=t.getParameter(34930),me=t.getParameter(35660),ge=t.getParameter(3379),Se=t.getParameter(34076),w=t.getParameter(34921),e=t.getParameter(36347),c=t.getParameter(36348),d=t.getParameter(36349),_=me>0,S=I||!!u.get("OES_texture_float");return{isWebGL2:I,getMaxAnisotropy:function(){if(void 0!==g)return g;const L=u.get("EXT_texture_filter_anisotropic");return g=null!==L?t.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,g},getMaxPrecision:E,precision:H,logarithmicDepthBuffer:Y,maxTextures:K,maxVertexTextures:me,maxTextureSize:ge,maxCubemapSize:Se,maxAttributes:w,maxVertexUniforms:e,maxVaryings:c,maxFragmentUniforms:d,vertexTextures:_,floatFragmentTextures:S,floatVertexTextures:_&&S,maxSamples:I?t.getParameter(36183):0}}function Ol(){const t=this;let u=null,m=0,g=!1,E=!1;const I=new Yo,H=new Ho,J={value:null,needsUpdate:!1};function Y(){J.value!==u&&(J.value=u,J.needsUpdate=m>0),t.numPlanes=m,t.numIntersection=0}function K(me,ge,Se,w){let e=null!==me?me.length:0,c=null;if(0!==e){if(c=J.value,!0!==w||null===c){const d=Se+4*e,_=ge.matrixWorldInverse;H.getNormalMatrix(_),(null===c||c.length<d)&&(c=new Float32Array(d));for(let S=0,L=Se;S!==e;++S,L+=4)I.copy(me[S]).applyMatrix4(_,H),I.normal.toArray(c,L),c[L+3]=I.constant}J.value=c,J.needsUpdate=!0}return t.numPlanes=e,t.numIntersection=0,c}this.uniform=J,this.numPlanes=0,this.numIntersection=0,this.init=function(me,ge,Se){const w=0!==me.length||ge||0!==m||g;return g=ge,u=K(me,Se,0),m=me.length,w},this.beginShadows=function(){E=!0,K(null)},this.endShadows=function(){E=!1,Y()},this.setState=function(me,ge,Se,w,e,c){if(!g||null===me||0===me.length||E&&!Se)E?K(null):Y();else{const d=E?0:m,_=4*d;let S=e.clippingState||null;J.value=S,S=K(me,w,_,c);for(let L=0;L!==_;++L)S[L]=u[L];e.clippingState=S,this.numIntersection=ge?this.numPlanes:0,this.numPlanes+=d}}}function tu(t){const u={};return{has:function(m){if(void 0!==u[m])return u[m];let g;switch(m){case"WEBGL_depth_texture":g=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=t.getExtension(m)}return u[m]=g,!!g},get:function(m){return this.has(m)||console.warn("THREE.WebGLRenderer: "+m+" extension not supported."),u[m]}}}function Mo(t,u,m,g){const E=new WeakMap,I=new WeakMap;function H(Y){const K=Y.target,me=E.get(K);null!==me.index&&u.remove(me.index);for(const Se in me.attributes)u.remove(me.attributes[Se]);K.removeEventListener("dispose",H),E.delete(K);const ge=I.get(me);ge&&(u.remove(ge),I.delete(me)),g.releaseStatesOfGeometry(K),!0===K.isInstancedBufferGeometry&&delete K._maxInstanceCount,m.memory.geometries--}function J(Y){const K=[],me=Y.index,ge=Y.attributes.position;let Se=0;if(null!==me){const c=me.array;Se=me.version;for(let d=0,_=c.length;d<_;d+=3){const S=c[d+0],L=c[d+1],k=c[d+2];K.push(S,L,L,k,k,S)}}else{Se=ge.version;for(let d=0,_=ge.array.length/3-1;d<_;d+=3){const S=d+0,L=d+1,k=d+2;K.push(S,L,L,k,k,S)}}const w=new(Pd(K)>65535?fl:Bl)(K,1);w.version=Se;const e=I.get(Y);e&&u.remove(e),I.set(Y,w)}return{get:function(Y,K){let me=E.get(K);return me||(K.addEventListener("dispose",H),K.isBufferGeometry?me=K:K.isGeometry&&(void 0===K._bufferGeometry&&(K._bufferGeometry=(new hn).setFromObject(Y)),me=K._bufferGeometry),E.set(K,me),m.memory.geometries++,me)},update:function(Y){const K=Y.attributes;for(const ge in K)u.update(K[ge],34962);const me=Y.morphAttributes;for(const ge in me){const Se=me[ge];for(let w=0,e=Se.length;w<e;w++)u.update(Se[w],34962)}},getWireframeAttribute:function(Y){const K=I.get(Y);if(K){const me=Y.index;null!==me&&K.version<me.version&&J(Y)}else J(Y);return I.get(Y)}}}function Vn(t,u,m,g){const E=g.isWebGL2;let I,H,J;this.setMode=function(Y){I=Y},this.setIndex=function(Y){H=Y.type,J=Y.bytesPerElement},this.render=function(Y,K){t.drawElements(I,K,H,Y*J),m.update(K,I,1)},this.renderInstances=function(Y,K,me){if(0===me)return;let ge,Se;if(E)ge=t,Se="drawElementsInstanced";else if(ge=u.get("ANGLE_instanced_arrays"),Se="drawElementsInstancedANGLE",null===ge)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ge[Se](I,K,H,Y*J,me),m.update(K,I,me)}}function nu(t){const u={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:u,programs:null,autoReset:!0,reset:function(){u.frame++,u.calls=0,u.triangles=0,u.points=0,u.lines=0},update:function(m,g,E){switch(u.calls++,g){case 4:u.triangles+=E*(m/3);break;case 1:u.lines+=E*(m/2);break;case 3:u.lines+=E*(m-1);break;case 2:u.lines+=E*m;break;case 0:u.points+=E*m;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",g)}}}}function Tu(t,u){return t[0]-u[0]}function vl(t,u){return Math.abs(u[1])-Math.abs(t[1])}function rc(t){const u={},m=new Float32Array(8),g=[];for(let E=0;E<8;E++)g[E]=[E,0];return{update:function(E,I,H,J){const Y=E.morphTargetInfluences,K=void 0===Y?0:Y.length;let me=u[I.id];if(void 0===me){me=[];for(let c=0;c<K;c++)me[c]=[c,0];u[I.id]=me}for(let c=0;c<K;c++){const d=me[c];d[0]=c,d[1]=Y[c]}me.sort(vl);for(let c=0;c<8;c++)c<K&&me[c][1]?(g[c][0]=me[c][0],g[c][1]=me[c][1]):(g[c][0]=Number.MAX_SAFE_INTEGER,g[c][1]=0);g.sort(Tu);const ge=H.morphTargets&&I.morphAttributes.position,Se=H.morphNormals&&I.morphAttributes.normal;let w=0;for(let c=0;c<8;c++){const d=g[c],_=d[0],S=d[1];_!==Number.MAX_SAFE_INTEGER&&S?(ge&&I.getAttribute("morphTarget"+c)!==ge[_]&&I.setAttribute("morphTarget"+c,ge[_]),Se&&I.getAttribute("morphNormal"+c)!==Se[_]&&I.setAttribute("morphNormal"+c,Se[_]),m[c]=S,w+=S):(ge&&void 0!==I.getAttribute("morphTarget"+c)&&I.deleteAttribute("morphTarget"+c),Se&&void 0!==I.getAttribute("morphNormal"+c)&&I.deleteAttribute("morphNormal"+c),m[c]=0)}const e=I.morphTargetsRelative?1:1-w;J.getUniforms().setValue(t,"morphTargetBaseInfluence",e),J.getUniforms().setValue(t,"morphTargetInfluences",m)}}}function Mu(t,u,m,g){let E=new WeakMap;return{update:function(I){const H=g.render.frame,J=I.geometry,Y=u.get(I,J);return E.get(Y)!==H&&(J.isGeometry&&Y.updateFromObject(I),u.update(Y),E.set(Y,H)),I.isInstancedMesh&&m.update(I.instanceMatrix,34962),Y},dispose:function(){E=new WeakMap}}}function Qs(t,u,m,g,E,I,H,J,Y,K){di.call(this,t=void 0!==t?t:[],u=void 0!==u?u:Ei,m,g,E,I,H=void 0!==H?H:Os,J,Y,K),this.flipY=!1}function gs(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function ga(t,u,m,g){di.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Ir,this.minFilter=Ir,this.wrapR=Jr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Nc.physical={uniforms:Bs([Nc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new En(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new ar(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Fr.meshphysical_vert,fragmentShader:Fr.meshphysical_frag},(Qs.prototype=Object.create(di.prototype)).constructor=Qs,Qs.prototype.isCubeTexture=!0,Object.defineProperty(Qs.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),(gs.prototype=Object.create(di.prototype)).constructor=gs,gs.prototype.isDataTexture2DArray=!0,(ga.prototype=Object.create(di.prototype)).constructor=ga,ga.prototype.isDataTexture3D=!0;const ch=new di,pd=new gs,ru=new ga,$h=new Qs,Rc=[],uh=[],va=new Float32Array(16),Io=new Float32Array(9),Ps=new Float32Array(4);function ke(t,u,m){const g=t[0];if(g<=0||g>0)return t;let E=u*m,I=Rc[E];if(void 0===I&&(I=new Float32Array(E),Rc[E]=I),0!==u){g.toArray(I,0);for(let H=1,J=0;H!==u;++H)J+=m,t[H].toArray(I,J)}return I}function De(t,u){if(t.length!==u.length)return!1;for(let m=0,g=t.length;m<g;m++)if(t[m]!==u[m])return!1;return!0}function He(t,u){for(let m=0,g=u.length;m<g;m++)t[m]=u[m]}function we(t,u){let m=uh[u];void 0===m&&(m=new Int32Array(u),uh[u]=m);for(let g=0;g!==u;++g)m[g]=t.allocateTextureUnit();return m}function ze(t,u){const m=this.cache;m[0]!==u&&(t.uniform1f(this.addr,u),m[0]=u)}function Je(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y||(t.uniform2f(this.addr,u.x,u.y),m[0]=u.x,m[1]=u.y);else{if(De(m,u))return;t.uniform2fv(this.addr,u),He(m,u)}}function bt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z||(t.uniform3f(this.addr,u.x,u.y,u.z),m[0]=u.x,m[1]=u.y,m[2]=u.z);else if(void 0!==u.r)m[0]===u.r&&m[1]===u.g&&m[2]===u.b||(t.uniform3f(this.addr,u.r,u.g,u.b),m[0]=u.r,m[1]=u.g,m[2]=u.b);else{if(De(m,u))return;t.uniform3fv(this.addr,u),He(m,u)}}function Ot(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z&&m[3]===u.w||(t.uniform4f(this.addr,u.x,u.y,u.z,u.w),m[0]=u.x,m[1]=u.y,m[2]=u.z,m[3]=u.w);else{if(De(m,u))return;t.uniform4fv(this.addr,u),He(m,u)}}function Wt(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix2fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;Ps.set(g),t.uniformMatrix2fv(this.addr,!1,Ps),He(m,g)}}function In(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix3fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;Io.set(g),t.uniformMatrix3fv(this.addr,!1,Io),He(m,g)}}function Tn(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(De(m,u))return;t.uniformMatrix4fv(this.addr,!1,u),He(m,u)}else{if(De(m,g))return;va.set(g),t.uniformMatrix4fv(this.addr,!1,va),He(m,g)}}function Gn(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTexture2D(u||ch,E)}function Cr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture2DArray(u||pd,E)}function Dr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture3D(u||ru,E)}function Lr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTextureCube(u||$h,E)}function Qt(t,u){const m=this.cache;m[0]!==u&&(t.uniform1i(this.addr,u),m[0]=u)}function Ao(t,u){const m=this.cache;De(m,u)||(t.uniform2iv(this.addr,u),He(m,u))}function ic(t,u){const m=this.cache;De(m,u)||(t.uniform3iv(this.addr,u),He(m,u))}function el(t,u){const m=this.cache;De(m,u)||(t.uniform4iv(this.addr,u),He(m,u))}function Qr(t,u){const m=this.cache;m[0]!==u&&(t.uniform1ui(this.addr,u),m[0]=u)}function Cn(t,u){t.uniform1fv(this.addr,u)}function Id(t,u){t.uniform1iv(this.addr,u)}function Cm(t,u){t.uniform2iv(this.addr,u)}function gr(t,u){t.uniform3iv(this.addr,u)}function rf(t,u){t.uniform4iv(this.addr,u)}function of(t,u){const m=ke(u,this.size,2);t.uniform2fv(this.addr,m)}function Af(t,u){const m=ke(u,this.size,3);t.uniform3fv(this.addr,m)}function Au(t,u){const m=ke(u,this.size,4);t.uniform4fv(this.addr,m)}function $f(t,u){const m=ke(u,this.size,4);t.uniformMatrix2fv(this.addr,!1,m)}function ya(t,u){const m=ke(u,this.size,9);t.uniformMatrix3fv(this.addr,!1,m)}function oc(t,u){const m=ke(u,this.size,16);t.uniformMatrix4fv(this.addr,!1,m)}function vs(t,u,m){const g=u.length,E=we(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTexture2D(u[I]||ch,E[I])}function tl(t,u,m){const g=u.length,E=we(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTextureCube(u[I]||$h,E[I])}function sf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.setValue=function(g){switch(g){case 5126:return ze;case 35664:return Je;case 35665:return bt;case 35666:return Ot;case 35674:return Wt;case 35675:return In;case 35676:return Tn;case 5124:case 35670:return Qt;case 35667:case 35671:return Ao;case 35668:case 35672:return ic;case 35669:case 35673:return el;case 5125:return Qr;case 35678:case 36198:case 36298:case 36306:case 35682:return Gn;case 35679:case 36299:case 36307:return Dr;case 35680:case 36300:case 36308:case 36293:return Lr;case 36289:case 36303:case 36311:case 36292:return Cr}}(u.type)}function Vf(t,u,m){this.id=t,this.addr=m,this.cache=[],this.size=u.size,this.setValue=function(g){switch(g){case 5126:return Cn;case 35664:return of;case 35665:return Af;case 35666:return Au;case 35674:return $f;case 35675:return ya;case 35676:return oc;case 5124:case 35670:return Id;case 35667:case 35671:return Cm;case 35668:case 35672:return gr;case 35669:case 35673:return rf;case 35678:case 36198:case 36298:case 36306:case 35682:return vs;case 35680:case 36300:case 36308:case 36293:return tl}}(u.type)}function Wf(t){this.id=t,this.seq=[],this.map={}}Vf.prototype.updateCache=function(t){let u=this.cache;t instanceof Float32Array&&u.length!==t.length&&(this.cache=new Float32Array(t.length)),He(u,t)},Wf.prototype.setValue=function(t,u,m){const g=this.seq;for(let E=0,I=g.length;E!==I;++E){const H=g[E];H.setValue(t,u[H.id],m)}};const Cf=/([\w\d_]+)(\])?(\[|\.)?/g;function qf(t,u){t.seq.push(u),t.map[u.id]=u}function Lm(t,u,m){const g=t.name,E=g.length;for(Cf.lastIndex=0;;){const I=Cf.exec(g);let J=I[1],K=I[3];if("]"===I[2]&&(J|=0),void 0===K||"["===K&&Cf.lastIndex+2===E){qf(m,void 0===K?new sf(J,t,u):new Vf(J,t,u));break}{let me=m.map[J];void 0===me&&(me=new Wf(J),qf(m,me)),m=me}}}function Bp(t,u){this.seq=[],this.map={};const m=t.getProgramParameter(u,35718);for(let g=0;g<m;++g){const E=t.getActiveUniform(u,g);Lm(E,t.getUniformLocation(u,E.name),this)}}function Xf(t,u,m){const g=t.createShader(u);return t.shaderSource(g,m),t.compileShader(g),g}Bp.prototype.setValue=function(t,u,m,g){const E=this.map[u];void 0!==E&&E.setValue(t,m,g)},Bp.prototype.setOptional=function(t,u,m){const g=u[m];void 0!==g&&this.setValue(t,m,g)},Bp.upload=function(t,u,m,g){for(let E=0,I=u.length;E!==I;++E){const H=u[E],J=m[H.id];!1!==J.needsUpdate&&H.setValue(t,J.value,g)}},Bp.seqWithValue=function(t,u){const m=[];for(let g=0,E=t.length;g!==E;++g){const I=t[g];I.id in u&&m.push(I)}return m};let Bm=0;function Yf(t){switch(t){case Ji:return["Linear","( value )"];case hl:return["sRGB","( value )"];case Yc:return["RGBE","( value )"];case xc:return["RGBM","( value, 7.0 )"];case nh:return["RGBM","( value, 16.0 )"];case vu:return["RGBD","( value, 256.0 )"];case Ql:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Wh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function Jf(t,u,m){const g=t.getShaderParameter(u,35713),E=t.getShaderInfoLog(u).trim();return g&&""===E?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+m+"\n"+E+function(I){const H=I.split("\n");for(let J=0;J<H.length;J++)H[J]=J+1+": "+H[J];return H.join("\n")}(t.getShaderSource(u))}function Od(t,u){const m=Yf(u);return"vec4 "+t+"( vec4 value ) { return "+m[0]+"ToLinear"+m[1]+"; }"}function Nm(t,u){const m=Yf(u);return"vec4 "+t+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"}function Rm(t,u){let m;switch(u){case mi:m="Linear";break;case _o:m="Reinhard";break;case Nr:m="OptimizedCineon";break;case ei:m="ACESFilmic";break;case Wr:m="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",u),m="Linear"}return"vec3 "+t+"( vec3 color ) { return "+m+"ToneMapping( color ); }"}function kd(t){return""!==t}function dd(t,u){return t.replace(/NUM_DIR_LIGHTS/g,u.numDirLights).replace(/NUM_SPOT_LIGHTS/g,u.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,u.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,u.numPointLights).replace(/NUM_HEMI_LIGHTS/g,u.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,u.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,u.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,u.numPointLightShadows)}function Zf(t,u){return t.replace(/NUM_CLIPPING_PLANES/g,u.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,u.numClippingPlanes-u.numClipIntersection)}const Fd=/^[ \t]*#include +<([\w\d./]+)>/gm;function tp(t){return t.replace(Fd,Pm)}function Pm(t,u){const m=Fr[u];if(void 0===m)throw new Error("Can not resolve #include <"+u+">");return tp(m)}const Im=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Om=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Qf(t){return t.replace(Om,Dd).replace(Im,km)}function km(t,u,m,g){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Dd(0,u,m,g)}function Dd(t,u,m,g){let E="";for(let I=parseInt(u);I<parseInt(m);I++)E+=g.replace(/\[ i \]/g,"[ "+I+" ]").replace(/UNROLLED_LOOP_INDEX/g,I);return E}function Kf(t){let u="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?u+="\n#define HIGH_PRECISION":"mediump"===t.precision?u+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(u+="\n#define LOW_PRECISION"),u}function Fm(t,u,m,g){const E=t.getContext(),I=m.defines;let H=m.vertexShader,J=m.fragmentShader;const Y=function(te){let le="SHADOWMAP_TYPE_BASIC";return te.shadowMapType===ie?le="SHADOWMAP_TYPE_PCF":te.shadowMapType===ce?le="SHADOWMAP_TYPE_PCF_SOFT":te.shadowMapType===fe&&(le="SHADOWMAP_TYPE_VSM"),le}(m),K=function(te){let le="ENVMAP_TYPE_CUBE";if(te.envMap)switch(te.envMapMode){case Ei:case So:le="ENVMAP_TYPE_CUBE";break;case Ni:case Eo:le="ENVMAP_TYPE_CUBE_UV";break;case Ws:case la:le="ENVMAP_TYPE_EQUIREC"}return le}(m),me=function(te){let le="ENVMAP_MODE_REFLECTION";if(te.envMap)switch(te.envMapMode){case So:case la:case Eo:le="ENVMAP_MODE_REFRACTION"}return le}(m),ge=function(te){let le="ENVMAP_BLENDING_NONE";if(te.envMap)switch(te.combine){case Kr:le="ENVMAP_BLENDING_MULTIPLY";break;case pi:le="ENVMAP_BLENDING_MIX";break;case nr:le="ENVMAP_BLENDING_ADD"}return le}(m),Se=t.gammaFactor>0?t.gammaFactor:1,w=m.isWebGL2?"":[(te=m).extensionDerivatives||te.envMapCubeUV||te.bumpMap||te.tangentSpaceNormalMap||te.clearcoatNormalMap||te.flatShading||"physical"===te.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(te.extensionFragDepth||te.logarithmicDepthBuffer)&&te.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",te.extensionDrawBuffers&&te.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(te.extensionShaderTextureLOD||te.envMap)&&te.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(kd).join("\n"),e=function(te){const le=[];for(const ue in te){const _e=te[ue];!1!==_e&&le.push("#define "+ue+" "+_e)}return le.join("\n")}(I),c=E.createProgram();var te;let d,_;m.isRawShaderMaterial?(d=[e].filter(kd).join("\n"),d.length>0&&(d+="\n"),_=[w,e].filter(kd).join("\n"),_.length>0&&(_+="\n")):(d=[Kf(m),"#define SHADER_NAME "+m.shaderName,e,m.instancing?"#define USE_INSTANCING":"",m.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Se,"#define MAX_BONES "+m.maxBones,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+me:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.displacementMap&&m.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.flatShading?"#define FLAT_SHADED":"",m.skinning?"#define USE_SKINNING":"",m.useVertexTexture?"#define BONE_TEXTURE":"",m.morphTargets?"#define USE_MORPHTARGETS":"",m.morphNormals&&!1===m.flatShading?"#define USE_MORPHNORMALS":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+Y:"",m.sizeAttenuation?"#define USE_SIZEATTENUATION":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(kd).join("\n"),_=[w,Kf(m),"#define SHADER_NAME "+m.shaderName,e,m.alphaTest?"#define ALPHATEST "+m.alphaTest+(m.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+Se,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.matcap?"#define USE_MATCAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+K:"",m.envMap?"#define "+me:"",m.envMap?"#define "+ge:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.sheen?"#define USE_SHEEN":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.gradientMap?"#define USE_GRADIENTMAP":"",m.flatShading?"#define FLAT_SHADED":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+Y:"",m.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",m.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(m.extensionShaderTextureLOD||m.envMap)&&m.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",m.toneMapping!==vr?"#define TONE_MAPPING":"",m.toneMapping!==vr?Fr.tonemapping_pars_fragment:"",m.toneMapping!==vr?Rm("toneMapping",m.toneMapping):"",m.dithering?"#define DITHERING":"",Fr.encodings_pars_fragment,m.map?Od("mapTexelToLinear",m.mapEncoding):"",m.matcap?Od("matcapTexelToLinear",m.matcapEncoding):"",m.envMap?Od("envMapTexelToLinear",m.envMapEncoding):"",m.emissiveMap?Od("emissiveMapTexelToLinear",m.emissiveMapEncoding):"",m.lightMap?Od("lightMapTexelToLinear",m.lightMapEncoding):"",Nm("linearToOutputTexel",m.outputEncoding),m.depthPacking?"#define DEPTH_PACKING "+m.depthPacking:"","\n"].filter(kd).join("\n")),H=tp(H),H=dd(H,m),H=Zf(H,m),J=tp(J),J=dd(J,m),J=Zf(J,m),H=Qf(H),J=Qf(J),m.isWebGL2&&!m.isRawShaderMaterial&&(d=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+d,_=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const S=_+J,L=Xf(E,35633,d+H),k=Xf(E,35632,S);if(E.attachShader(c,L),E.attachShader(c,k),void 0!==m.index0AttributeName?E.bindAttribLocation(c,0,m.index0AttributeName):!0===m.morphTargets&&E.bindAttribLocation(c,0,"position"),E.linkProgram(c),t.debug.checkShaderErrors){const te=E.getProgramInfoLog(c).trim(),le=E.getShaderInfoLog(L).trim(),ue=E.getShaderInfoLog(k).trim();let _e=!0,Ee=!0;if(!1===E.getProgramParameter(c,35714)){_e=!1;const $e=Jf(E,L,"vertex"),Le=Jf(E,k,"fragment");console.error("THREE.WebGLProgram: shader error: ",E.getError(),"35715",E.getProgramParameter(c,35715),"gl.getProgramInfoLog",te,$e,Le)}else""!==te?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",te):""!==le&&""!==ue||(Ee=!1);Ee&&(this.diagnostics={runnable:_e,programLog:te,vertexShader:{log:le,prefix:d},fragmentShader:{log:ue,prefix:_}})}let F,V;return E.deleteShader(L),E.deleteShader(k),this.getUniforms=function(){return void 0===F&&(F=new Bp(E,c)),F},this.getAttributes=function(){return void 0===V&&(V=function(te,le){const ue={},_e=te.getProgramParameter(le,35721);for(let Ee=0;Ee<_e;Ee++){const $e=te.getActiveAttrib(le,Ee).name;ue[$e]=te.getAttribLocation(le,$e)}return ue}(E,c)),V},this.destroy=function(){g.releaseStatesOfProgram(this),E.deleteProgram(c),this.program=void 0},this.name=m.shaderName,this.id=Bm++,this.cacheKey=u,this.usedTimes=1,this.program=c,this.vertexShader=L,this.fragmentShader=k,this}function Pc(t,u,m,g){const E=[],I=m.isWebGL2,H=m.logarithmicDepthBuffer,J=m.floatVertexTextures,Y=m.maxVertexUniforms,K=m.vertexTextures;let me=m.precision;const ge={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Se=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function w(e){let c;return e?e.isTexture?c=e.encoding:e.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),c=e.texture.encoding):c=Ji,c}return{getParameters:function(e,c,d,_,S,L,k){const F=_.fog,te=e.envMap||(e.isMeshStandardMaterial?_.environment:null),le=ge[e.type],ue=k.isSkinnedMesh?function(Le){const Ne=Le.skeleton.bones;if(J)return 1024;{const tt=Math.floor((Y-20)/4),Ze=Math.min(tt,Ne.length);return Ze<Ne.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ne.length+" bones. This GPU supports "+Ze+"."),0):Ze}}(k):0;let _e,Ee;if(null!==e.precision&&(me=m.getMaxPrecision(e.precision),me!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",me,"instead.")),le){const Le=Nc[le];_e=Le.vertexShader,Ee=Le.fragmentShader}else _e=e.vertexShader,Ee=e.fragmentShader;const $e=t.getRenderTarget();return{isWebGL2:I,shaderID:le,shaderName:e.type,vertexShader:_e,fragmentShader:Ee,defines:e.defines,isRawShaderMaterial:e.isRawShaderMaterial,isShaderMaterial:e.isShaderMaterial,precision:me,instancing:!0===k.isInstancedMesh,supportsVertexTextures:K,outputEncoding:null!==$e?w($e.texture):t.outputEncoding,map:!!e.map,mapEncoding:w(e.map),matcap:!!e.matcap,matcapEncoding:w(e.matcap),envMap:!!te,envMapMode:te&&te.mapping,envMapEncoding:w(te),envMapCubeUV:!!te&&(te.mapping===Ni||te.mapping===Eo),lightMap:!!e.lightMap,lightMapEncoding:w(e.lightMap),aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:w(e.emissiveMap),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,objectSpaceNormalMap:e.normalMapType===Be,tangentSpaceNormalMap:e.normalMapType===Me,clearcoatMap:!!e.clearcoatMap,clearcoatRoughnessMap:!!e.clearcoatRoughnessMap,clearcoatNormalMap:!!e.clearcoatNormalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,sheen:!!e.sheen,transmissionMap:!!e.transmissionMap,combine:e.combine,vertexTangents:e.normalMap&&e.vertexTangents,vertexColors:e.vertexColors,vertexUvs:!!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatMap||e.clearcoatRoughnessMap||e.clearcoatNormalMap||e.displacementMap||e.transmissionMap),uvsVertexOnly:!(e.map||e.bumpMap||e.normalMap||e.specularMap||e.alphaMap||e.emissiveMap||e.roughnessMap||e.metalnessMap||e.clearcoatNormalMap||e.transmissionMap||!e.displacementMap),fog:!!F,useFog:e.fog,fogExp2:F&&F.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:H,skinning:e.skinning&&ue>0,maxBones:ue,useVertexTexture:J,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numClippingPlanes:S,numClipIntersection:L,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&d.length>0,shadowMapType:t.shadowMap.type,toneMapping:e.toneMapped?t.toneMapping:vr,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===Z,flipSided:e.side===W,depthPacking:void 0!==e.depthPacking&&e.depthPacking,index0AttributeName:e.index0AttributeName,extensionDerivatives:e.extensions&&e.extensions.derivatives,extensionFragDepth:e.extensions&&e.extensions.fragDepth,extensionDrawBuffers:e.extensions&&e.extensions.drawBuffers,extensionShaderTextureLOD:e.extensions&&e.extensions.shaderTextureLOD,rendererExtensionFragDepth:I||null!==u.get("EXT_frag_depth"),rendererExtensionDrawBuffers:I||null!==u.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:I||null!==u.get("EXT_shader_texture_lod"),customProgramCacheKey:e.customProgramCacheKey()}},getProgramCacheKey:function(e){const c=[];if(e.shaderID?c.push(e.shaderID):(c.push(e.fragmentShader),c.push(e.vertexShader)),void 0!==e.defines)for(const d in e.defines)c.push(d),c.push(e.defines[d]);if(void 0===e.isRawShaderMaterial){for(let d=0;d<Se.length;d++)c.push(e[Se[d]]);c.push(t.outputEncoding),c.push(t.gammaFactor)}return c.push(e.customProgramCacheKey),c.join()},getUniforms:function(e){const c=ge[e.type];let d;return d=c?Ro.clone(Nc[c].uniforms):e.uniforms,d},acquireProgram:function(e,c){let d;for(let _=0,S=E.length;_<S;_++){const L=E[_];if(L.cacheKey===c){d=L,++d.usedTimes;break}}return void 0===d&&(d=new Fm(t,c,e,g),E.push(d)),d},releaseProgram:function(e){if(0==--e.usedTimes){const c=E.indexOf(e);E[c]=E[E.length-1],E.pop(),e.destroy()}},programs:E}}function Lf(){let t=new WeakMap;return{get:function(u){let m=t.get(u);return void 0===m&&(m={},t.set(u,m)),m},remove:function(u){t.delete(u)},update:function(u,m,g){t.get(u)[m]=g},dispose:function(){t=new WeakMap}}}function em(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.program!==u.program?t.program.id-u.program.id:t.material.id!==u.material.id?t.material.id-u.material.id:t.z!==u.z?t.z-u.z:t.id-u.id}function tm(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.z!==u.z?u.z-t.z:t.id-u.id}function af(t){const u=[];let m=0;const g=[],E=[],I={id:-1};function H(J,Y,K,me,ge,Se){let w=u[m];const e=t.get(K);return void 0===w?(w={id:J.id,object:J,geometry:Y,material:K,program:e.program||I,groupOrder:me,renderOrder:J.renderOrder,z:ge,group:Se},u[m]=w):(w.id=J.id,w.object=J,w.geometry=Y,w.material=K,w.program=e.program||I,w.groupOrder=me,w.renderOrder=J.renderOrder,w.z=ge,w.group=Se),m++,w}return{opaque:g,transparent:E,init:function(){m=0,g.length=0,E.length=0},push:function(J,Y,K,me,ge,Se){const w=H(J,Y,K,me,ge,Se);(!0===K.transparent?E:g).push(w)},unshift:function(J,Y,K,me,ge,Se){const w=H(J,Y,K,me,ge,Se);(!0===K.transparent?E:g).unshift(w)},finish:function(){for(let J=m,Y=u.length;J<Y;J++){const K=u[J];if(null===K.id)break;K.id=null,K.object=null,K.geometry=null,K.material=null,K.program=null,K.group=null}},sort:function(J,Y){g.length>1&&g.sort(J||em),E.length>1&&E.sort(Y||tm)}}}function Dm(t){let u=new WeakMap;function m(g){const E=g.target;E.removeEventListener("dispose",m),u.delete(E)}return{get:function(g,E){const I=u.get(g);let H;return void 0===I?(H=new af(t),u.set(g,new WeakMap),u.get(g).set(E,H),g.addEventListener("dispose",m)):(H=I.get(E),void 0===H&&(H=new af(t),I.set(E,H))),H},dispose:function(){u=new WeakMap}}}function nm(){const t={};return{get:function(u){if(void 0!==t[u.id])return t[u.id];let m;switch(u.type){case"DirectionalLight":m={direction:new lt,color:new ar};break;case"SpotLight":m={position:new lt,direction:new lt,color:new ar,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":m={position:new lt,color:new ar,distance:0,decay:0};break;case"HemisphereLight":m={direction:new lt,skyColor:new ar,groundColor:new ar};break;case"RectAreaLight":m={color:new ar,position:new lt,halfWidth:new lt,halfHeight:new lt}}return t[u.id]=m,m}}}let Um=0;function Bf(t,u){return(u.castShadow?1:0)-(t.castShadow?1:0)}function zm(){const t=new nm,u=function(){const H={};return{get:function(J){if(void 0!==H[J.id])return H[J.id];let Y;switch(J.type){case"DirectionalLight":case"SpotLight":Y={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new En};break;case"PointLight":Y={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new En,shadowCameraNear:1,shadowCameraFar:1e3}}return H[J.id]=Y,Y}}}(),m={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let H=0;H<9;H++)m.probe.push(new lt);const g=new lt,E=new ri,I=new ri;return{setup:function(H,J,Y){let K=0,me=0,ge=0;for(let V=0;V<9;V++)m.probe[V].set(0,0,0);let Se=0,w=0,e=0,c=0,d=0,_=0,S=0,L=0;const k=Y.matrixWorldInverse;H.sort(Bf);for(let V=0,te=H.length;V<te;V++){const le=H[V],ue=le.color,_e=le.intensity,Ee=le.distance,$e=le.shadow&&le.shadow.map?le.shadow.map.texture:null;if(le.isAmbientLight)K+=ue.r*_e,me+=ue.g*_e,ge+=ue.b*_e;else if(le.isLightProbe)for(let Le=0;Le<9;Le++)m.probe[Le].addScaledVector(le.sh.coefficients[Le],_e);else if(le.isDirectionalLight){const Le=t.get(le);if(Le.color.copy(le.color).multiplyScalar(le.intensity),Le.direction.setFromMatrixPosition(le.matrixWorld),g.setFromMatrixPosition(le.target.matrixWorld),Le.direction.sub(g),Le.direction.transformDirection(k),le.castShadow){const Ne=le.shadow,We=u.get(le);We.shadowBias=Ne.bias,We.shadowNormalBias=Ne.normalBias,We.shadowRadius=Ne.radius,We.shadowMapSize=Ne.mapSize,m.directionalShadow[Se]=We,m.directionalShadowMap[Se]=$e,m.directionalShadowMatrix[Se]=le.shadow.matrix,_++}m.directional[Se]=Le,Se++}else if(le.isSpotLight){const Le=t.get(le);if(Le.position.setFromMatrixPosition(le.matrixWorld),Le.position.applyMatrix4(k),Le.color.copy(ue).multiplyScalar(_e),Le.distance=Ee,Le.direction.setFromMatrixPosition(le.matrixWorld),g.setFromMatrixPosition(le.target.matrixWorld),Le.direction.sub(g),Le.direction.transformDirection(k),Le.coneCos=Math.cos(le.angle),Le.penumbraCos=Math.cos(le.angle*(1-le.penumbra)),Le.decay=le.decay,le.castShadow){const Ne=le.shadow,We=u.get(le);We.shadowBias=Ne.bias,We.shadowNormalBias=Ne.normalBias,We.shadowRadius=Ne.radius,We.shadowMapSize=Ne.mapSize,m.spotShadow[e]=We,m.spotShadowMap[e]=$e,m.spotShadowMatrix[e]=le.shadow.matrix,L++}m.spot[e]=Le,e++}else if(le.isRectAreaLight){const Le=t.get(le);Le.color.copy(ue).multiplyScalar(_e),Le.position.setFromMatrixPosition(le.matrixWorld),Le.position.applyMatrix4(k),I.identity(),E.copy(le.matrixWorld),E.premultiply(k),I.extractRotation(E),Le.halfWidth.set(.5*le.width,0,0),Le.halfHeight.set(0,.5*le.height,0),Le.halfWidth.applyMatrix4(I),Le.halfHeight.applyMatrix4(I),m.rectArea[c]=Le,c++}else if(le.isPointLight){const Le=t.get(le);if(Le.position.setFromMatrixPosition(le.matrixWorld),Le.position.applyMatrix4(k),Le.color.copy(le.color).multiplyScalar(le.intensity),Le.distance=le.distance,Le.decay=le.decay,le.castShadow){const Ne=le.shadow,We=u.get(le);We.shadowBias=Ne.bias,We.shadowNormalBias=Ne.normalBias,We.shadowRadius=Ne.radius,We.shadowMapSize=Ne.mapSize,We.shadowCameraNear=Ne.camera.near,We.shadowCameraFar=Ne.camera.far,m.pointShadow[w]=We,m.pointShadowMap[w]=$e,m.pointShadowMatrix[w]=le.shadow.matrix,S++}m.point[w]=Le,w++}else if(le.isHemisphereLight){const Le=t.get(le);Le.direction.setFromMatrixPosition(le.matrixWorld),Le.direction.transformDirection(k),Le.direction.normalize(),Le.skyColor.copy(le.color).multiplyScalar(_e),Le.groundColor.copy(le.groundColor).multiplyScalar(_e),m.hemi[d]=Le,d++}}m.ambient[0]=K,m.ambient[1]=me,m.ambient[2]=ge;const F=m.hash;F.directionalLength===Se&&F.pointLength===w&&F.spotLength===e&&F.rectAreaLength===c&&F.hemiLength===d&&F.numDirectionalShadows===_&&F.numPointShadows===S&&F.numSpotShadows===L||(m.directional.length=Se,m.spot.length=e,m.rectArea.length=c,m.point.length=w,m.hemi.length=d,m.directionalShadow.length=_,m.directionalShadowMap.length=_,m.pointShadow.length=S,m.pointShadowMap.length=S,m.spotShadow.length=L,m.spotShadowMap.length=L,m.directionalShadowMatrix.length=_,m.pointShadowMatrix.length=S,m.spotShadowMatrix.length=L,F.directionalLength=Se,F.pointLength=w,F.spotLength=e,F.rectAreaLength=c,F.hemiLength=d,F.numDirectionalShadows=_,F.numPointShadows=S,F.numSpotShadows=L,m.version=Um++)},state:m}}function lf(){const t=new zm,u=[],m=[];return{init:function(){u.length=0,m.length=0},state:{lightsArray:u,shadowsArray:m,lights:t},setupLights:function(g){t.setup(u,m,g)},pushLight:function(g){u.push(g)},pushShadow:function(g){m.push(g)}}}function Ud(){let t=new WeakMap;function u(m){const g=m.target;g.removeEventListener("dispose",u),t.delete(g)}return{get:function(m,g){let E;return!1===t.has(m)?(E=new lf,t.set(m,new WeakMap),t.get(m).set(g,E),m.addEventListener("dispose",u)):!1===t.get(m).has(g)?(E=new lf,t.get(m).set(g,E)):E=t.get(m).get(g),E},dispose:function(){t=new WeakMap}}}function np(t){Ur.call(this),this.type="MeshDepthMaterial",this.depthPacking=q,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ks(t){Ur.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new lt,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}(np.prototype=Object.create(Ur.prototype)).constructor=np,np.prototype.isMeshDepthMaterial=!0,np.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(Ks.prototype=Object.create(Ur.prototype)).constructor=Ks,Ks.prototype.isMeshDistanceMaterial=!0,Ks.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var Ch="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Ic="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function sc(t,u,m){let g=new eu;const E=new En,I=new En,H=new xi,J=[],Y=[],K={},me={0:W,1:ae,2:Z},ge=new co({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new En},radius:{value:4}},vertexShader:Ic,fragmentShader:Ch}),Se=ge.clone();Se.defines.HORIZONAL_PASS=1;const w=new hn;w.setAttribute("position",new Vr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const e=new Ci(w,ge),c=this;function d(F,V){const te=u.update(e);ge.uniforms.shadow_pass.value=F.map.texture,ge.uniforms.resolution.value=F.mapSize,ge.uniforms.radius.value=F.radius,t.setRenderTarget(F.mapPass),t.clear(),t.renderBufferDirect(V,null,te,ge,e,null),Se.uniforms.shadow_pass.value=F.mapPass.texture,Se.uniforms.resolution.value=F.mapSize,Se.uniforms.radius.value=F.radius,t.setRenderTarget(F.map),t.clear(),t.renderBufferDirect(V,null,te,Se,e,null)}function _(F,V,te){const le=F<<0|V<<1|te<<2;let ue=J[le];return void 0===ue&&(ue=new np({depthPacking:pe,morphTargets:F,skinning:V}),J[le]=ue),ue}function S(F,V,te){const le=F<<0|V<<1|te<<2;let ue=Y[le];return void 0===ue&&(ue=new Ks({morphTargets:F,skinning:V}),Y[le]=ue),ue}function L(F,V,te,le,ue,_e,Ee){let $e=null,Le=_,Ne=F.customDepthMaterial;if(!0===le.isPointLight&&(Le=S,Ne=F.customDistanceMaterial),void 0===Ne){let We=!1;!0===te.morphTargets&&(We=V.morphAttributes&&V.morphAttributes.position&&V.morphAttributes.position.length>0);let tt=!1;!0===F.isSkinnedMesh&&(!0===te.skinning?tt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",F)),$e=Le(We,tt,!0===F.isInstancedMesh)}else $e=Ne;if(t.localClippingEnabled&&!0===te.clipShadows&&0!==te.clippingPlanes.length){const We=$e.uuid,tt=te.uuid;let Ze=K[We];void 0===Ze&&(Ze={},K[We]=Ze);let ot=Ze[tt];void 0===ot&&(ot=$e.clone(),Ze[tt]=ot),$e=ot}return $e.visible=te.visible,$e.wireframe=te.wireframe,$e.side=Ee===fe?null!==te.shadowSide?te.shadowSide:te.side:null!==te.shadowSide?te.shadowSide:me[te.side],$e.clipShadows=te.clipShadows,$e.clippingPlanes=te.clippingPlanes,$e.clipIntersection=te.clipIntersection,$e.wireframeLinewidth=te.wireframeLinewidth,$e.linewidth=te.linewidth,!0===le.isPointLight&&!0===$e.isMeshDistanceMaterial&&($e.referencePosition.setFromMatrixPosition(le.matrixWorld),$e.nearDistance=ue,$e.farDistance=_e),$e}function k(F,V,te,le,ue){if(!1===F.visible)return;if(F.layers.test(V.layers)&&(F.isMesh||F.isLine||F.isPoints)&&(F.castShadow||F.receiveShadow&&ue===fe)&&(!F.frustumCulled||g.intersectsObject(F))){F.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,F.matrixWorld);const Ee=u.update(F),$e=F.material;if(Array.isArray($e)){const Le=Ee.groups;for(let Ne=0,We=Le.length;Ne<We;Ne++){const tt=Le[Ne],Ze=$e[tt.materialIndex];if(Ze&&Ze.visible){const ot=L(F,Ee,Ze,le,te.near,te.far,ue);t.renderBufferDirect(te,null,Ee,ot,F,tt)}}}else if($e.visible){const Le=L(F,Ee,$e,le,te.near,te.far,ue);t.renderBufferDirect(te,null,Ee,Le,F,null)}}const _e=F.children;for(let Ee=0,$e=_e.length;Ee<$e;Ee++)k(_e[Ee],V,te,le,ue)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=ie,this.render=function(F,V,te){if(!1===c.enabled||!1===c.autoUpdate&&!1===c.needsUpdate||0===F.length)return;const le=t.getRenderTarget(),ue=t.getActiveCubeFace(),_e=t.getActiveMipmapLevel(),Ee=t.state;Ee.setBlending(X),Ee.buffers.color.setClear(1,1,1,1),Ee.buffers.depth.setTest(!0),Ee.setScissorTest(!1);for(let $e=0,Le=F.length;$e<Le;$e++){const Ne=F[$e],We=Ne.shadow;if(!1===We.autoUpdate&&!1===We.needsUpdate)continue;if(void 0===We){console.warn("THREE.WebGLShadowMap:",Ne,"has no shadow.");continue}E.copy(We.mapSize);const tt=We.getFrameExtents();if(E.multiply(tt),I.copy(We.mapSize),(E.x>m||E.y>m)&&(E.x>m&&(I.x=Math.floor(m/tt.x),E.x=I.x*tt.x,We.mapSize.x=I.x),E.y>m&&(I.y=Math.floor(m/tt.y),E.y=I.y*tt.y,We.mapSize.y=I.y)),null===We.map&&!We.isPointLightShadow&&this.type===fe){const ot={minFilter:ai,magFilter:ai,format:ao,stencilBuffer:!1};We.map=new Fs(E.x,E.y,ot),We.map.texture.name=Ne.name+".shadowMap",We.mapPass=new Fs(E.x,E.y,ot),We.camera.updateProjectionMatrix()}null===We.map&&(We.map=new Fs(E.x,E.y,{minFilter:Ir,magFilter:Ir,format:ao,stencilBuffer:!1}),We.map.texture.name=Ne.name+".shadowMap",We.camera.updateProjectionMatrix()),t.setRenderTarget(We.map),t.clear();const Ze=We.getViewportCount();for(let ot=0;ot<Ze;ot++){const st=We.getViewport(ot);H.set(I.x*st.x,I.y*st.y,I.x*st.z,I.y*st.w),Ee.viewport(H),We.updateMatrices(Ne,ot),g=We.getFrustum(),k(V,te,We.camera,Ne,this.type)}We.isPointLightShadow||this.type!==fe||d(We,te),We.needsUpdate=!1}c.needsUpdate=!1,t.setRenderTarget(le,ue,_e)}}function ac(t,u,m){const g=m.isWebGL2,E=new function(){let ct=!1;const Lt=new xi;let _t=null;const zt=new xi(0,0,0,0);return{setMask:function(Rt){_t===Rt||ct||(t.colorMask(Rt,Rt,Rt,Rt),_t=Rt)},setLocked:function(Rt){ct=Rt},setClear:function(Rt,nn,en,Mn,rt){!0===rt&&(Rt*=Mn,nn*=Mn,en*=Mn),Lt.set(Rt,nn,en,Mn),!1===zt.equals(Lt)&&(t.clearColor(Rt,nn,en,Mn),zt.copy(Lt))},reset:function(){ct=!1,_t=null,zt.set(-1,0,0,0)}}},I=new function(){let ct=!1,Lt=null,_t=null,zt=null;return{setTest:function(Rt){Rt?Ze(2929):ot(2929)},setMask:function(Rt){Lt===Rt||ct||(t.depthMask(Rt),Lt=Rt)},setFunc:function(Rt){if(_t!==Rt){if(Rt)switch(Rt){case On:t.depthFunc(512);break;case Ln:t.depthFunc(519);break;case mn:t.depthFunc(513);break;case cr:t.depthFunc(515);break;case rr:t.depthFunc(514);break;case ur:t.depthFunc(518);break;case or:t.depthFunc(516);break;case ni:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);_t=Rt}},setLocked:function(Rt){ct=Rt},setClear:function(Rt){zt!==Rt&&(t.clearDepth(Rt),zt=Rt)},reset:function(){ct=!1,Lt=null,_t=null,zt=null}}},H=new function(){let ct=!1,Lt=null,_t=null,zt=null,Rt=null,nn=null,en=null,Mn=null,rt=null;return{setTest:function(ut){ct||(ut?Ze(2960):ot(2960))},setMask:function(ut){Lt===ut||ct||(t.stencilMask(ut),Lt=ut)},setFunc:function(ut,rn,un){_t===ut&&zt===rn&&Rt===un||(t.stencilFunc(ut,rn,un),_t=ut,zt=rn,Rt=un)},setOp:function(ut,rn,un){nn===ut&&en===rn&&Mn===un||(t.stencilOp(ut,rn,un),nn=ut,en=rn,Mn=un)},setLocked:function(ut){ct=ut},setClear:function(ut){rt!==ut&&(t.clearStencil(ut),rt=ut)},reset:function(){ct=!1,Lt=null,_t=null,zt=null,Rt=null,nn=null,en=null,Mn=null,rt=null}}};let J={},Y=null,K=null,me=null,ge=null,Se=null,w=null,e=null,c=null,d=null,_=!1,S=null,L=null,k=null,F=null,V=null;const te=t.getParameter(35661);let le=!1,ue=0;const _e=t.getParameter(7938);-1!==_e.indexOf("WebGL")?(ue=parseFloat(/^WebGL\ ([0-9])/.exec(_e)[1]),le=ue>=1):-1!==_e.indexOf("OpenGL ES")&&(ue=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(_e)[1]),le=ue>=2);let Ee=null,$e={};const Le=new xi,Ne=new xi;function We(ct,Lt,_t){const zt=new Uint8Array(4),Rt=t.createTexture();t.bindTexture(ct,Rt),t.texParameteri(ct,10241,9728),t.texParameteri(ct,10240,9728);for(let nn=0;nn<_t;nn++)t.texImage2D(Lt+nn,0,6408,1,1,0,6408,5121,zt);return Rt}const tt={};function Ze(ct){!0!==J[ct]&&(t.enable(ct),J[ct]=!0)}function ot(ct){!1!==J[ct]&&(t.disable(ct),J[ct]=!1)}tt[3553]=We(3553,3553,1),tt[34067]=We(34067,34069,6),E.setClear(0,0,0,1),I.setClear(1),H.setClear(0),Ze(2929),I.setFunc(cr),Qe(!1),nt(M),Ze(2884),Ft(X);const st={[Pe]:32774,[Ge]:32778,[Ae]:32779};if(g)st[Xe]=32775,st[Ke]=32776;else{const ct=u.get("EXT_blend_minmax");null!==ct&&(st[Xe]=ct.MIN_EXT,st[Ke]=ct.MAX_EXT)}const Ct={[yt]:0,[dt]:1,[It]:768,[Gt]:770,[dn]:776,[An]:774,[sn]:772,[wt]:769,[Dt]:771,[Bn]:775,[gt]:773};function Ft(ct,Lt,_t,zt,Rt,nn,en,Mn){if(ct!==X){if(K||(Ze(3042),K=!0),ct===be)Rt=Rt||Lt,nn=nn||_t,en=en||zt,Lt===ge&&Rt===e||(t.blendEquationSeparate(st[Lt],st[Rt]),ge=Lt,e=Rt),_t===Se&&zt===w&&nn===c&&en===d||(t.blendFuncSeparate(Ct[_t],Ct[zt],Ct[nn],Ct[en]),Se=_t,w=zt,c=nn,d=en),me=ct,_=null;else if(ct!==me||Mn!==_){if(ge===Pe&&e===Pe||(t.blendEquation(32774),ge=Pe,e=Pe),Mn)switch(ct){case he:t.blendFuncSeparate(1,771,1,771);break;case U:t.blendFunc(1,1);break;case Re:t.blendFuncSeparate(0,0,769,771);break;case Q:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}else switch(ct){case he:t.blendFuncSeparate(770,771,1,771);break;case U:t.blendFunc(770,1);break;case Re:t.blendFunc(0,769);break;case Q:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}Se=null,w=null,c=null,d=null,me=ct,_=Mn}}else K&&(ot(3042),K=!1)}function Qe(ct){S!==ct&&(t.frontFace(ct?2304:2305),S=ct)}function nt(ct){ct!==G?(Ze(2884),ct!==L&&t.cullFace(ct===M?1029:ct===P?1028:1032)):ot(2884),L=ct}function Tt(ct,Lt,_t){ct?(Ze(32823),F===Lt&&V===_t||(t.polygonOffset(Lt,_t),F=Lt,V=_t)):ot(32823)}function Yt(ct){void 0===ct&&(ct=33984+te-1),Ee!==ct&&(t.activeTexture(ct),Ee=ct)}return{buffers:{color:E,depth:I,stencil:H},enable:Ze,disable:ot,useProgram:function(ct){return Y!==ct&&(t.useProgram(ct),Y=ct,!0)},setBlending:Ft,setMaterial:function(ct,Lt){ct.side===Z?ot(2884):Ze(2884);let _t=ct.side===W;Lt&&(_t=!_t),Qe(_t),ct.blending===he&&!1===ct.transparent?Ft(X):Ft(ct.blending,ct.blendEquation,ct.blendSrc,ct.blendDst,ct.blendEquationAlpha,ct.blendSrcAlpha,ct.blendDstAlpha,ct.premultipliedAlpha),I.setFunc(ct.depthFunc),I.setTest(ct.depthTest),I.setMask(ct.depthWrite),E.setMask(ct.colorWrite);const zt=ct.stencilWrite;H.setTest(zt),zt&&(H.setMask(ct.stencilWriteMask),H.setFunc(ct.stencilFunc,ct.stencilRef,ct.stencilFuncMask),H.setOp(ct.stencilFail,ct.stencilZFail,ct.stencilZPass)),Tt(ct.polygonOffset,ct.polygonOffsetFactor,ct.polygonOffsetUnits)},setFlipSided:Qe,setCullFace:nt,setLineWidth:function(ct){ct!==k&&(le&&t.lineWidth(ct),k=ct)},setPolygonOffset:Tt,setScissorTest:function(ct){ct?Ze(3089):ot(3089)},activeTexture:Yt,bindTexture:function(ct,Lt){null===Ee&&Yt();let _t=$e[Ee];void 0===_t&&(_t={type:void 0,texture:void 0},$e[Ee]=_t),_t.type===ct&&_t.texture===Lt||(t.bindTexture(ct,Lt||tt[ct]),_t.type=ct,_t.texture=Lt)},unbindTexture:function(){const ct=$e[Ee];void 0!==ct&&void 0!==ct.type&&(t.bindTexture(ct.type,null),ct.type=void 0,ct.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},scissor:function(ct){!1===Le.equals(ct)&&(t.scissor(ct.x,ct.y,ct.z,ct.w),Le.copy(ct))},viewport:function(ct){!1===Ne.equals(ct)&&(t.viewport(ct.x,ct.y,ct.z,ct.w),Ne.copy(ct))},reset:function(){J={},Ee=null,$e={},Y=null,me=null,S=null,L=null,E.reset(),I.reset(),H.reset()}}}function fd(t,u,m,g,E,I,H){const J=E.isWebGL2,Y=E.maxTextures,K=E.maxCubemapSize,me=E.maxTextureSize,ge=E.maxSamples,Se=new WeakMap;let w,e=!1;try{e=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function c(Qe,nt){return e?new OffscreenCanvas(Qe,nt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function d(Qe,nt,Tt,Yt){let ct=1;if((Qe.width>Yt||Qe.height>Yt)&&(ct=Yt/Math.max(Qe.width,Qe.height)),ct<1||!0===nt){if(typeof HTMLImageElement<"u"&&Qe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Qe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Qe instanceof ImageBitmap){const Lt=nt?er.floorPowerOfTwo:Math.floor,_t=Lt(ct*Qe.width),zt=Lt(ct*Qe.height);void 0===w&&(w=c(_t,zt));const Rt=Tt?c(_t,zt):w;return Rt.width=_t,Rt.height=zt,Rt.getContext("2d").drawImage(Qe,0,0,_t,zt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Qe.width+"x"+Qe.height+") to ("+_t+"x"+zt+")."),Rt}return"data"in Qe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Qe.width+"x"+Qe.height+")."),Qe}return Qe}function _(Qe){return er.isPowerOfTwo(Qe.width)&&er.isPowerOfTwo(Qe.height)}function S(Qe,nt){return Qe.generateMipmaps&&nt&&Qe.minFilter!==Ir&&Qe.minFilter!==ai}function L(Qe,nt,Tt,Yt){t.generateMipmap(Qe),g.get(nt).__maxMipLevel=Math.log(Math.max(Tt,Yt))*Math.LOG2E}function k(Qe,nt,Tt){if(!1===J)return nt;if(null!==Qe){if(void 0!==t[Qe])return t[Qe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Qe+"'")}let Yt=nt;return 6403===nt&&(5126===Tt&&(Yt=33326),5131===Tt&&(Yt=33325),5121===Tt&&(Yt=33321)),6407===nt&&(5126===Tt&&(Yt=34837),5131===Tt&&(Yt=34843),5121===Tt&&(Yt=32849)),6408===nt&&(5126===Tt&&(Yt=34836),5131===Tt&&(Yt=34842),5121===Tt&&(Yt=32856)),33325!==Yt&&33326!==Yt&&34842!==Yt&&34836!==Yt||u.get("EXT_color_buffer_float"),Yt}function F(Qe){return Qe===Ir||Qe===Va||Qe===us?9728:9729}function V(Qe){const nt=Qe.target;nt.removeEventListener("dispose",V),function(Tt){const Yt=g.get(Tt);void 0!==Yt.__webglInit&&(t.deleteTexture(Yt.__webglTexture),g.remove(Tt))}(nt),nt.isVideoTexture&&Se.delete(nt),H.memory.textures--}function te(Qe){const nt=Qe.target;nt.removeEventListener("dispose",te),function(Tt){const Yt=g.get(Tt),ct=g.get(Tt.texture);if(Tt){if(void 0!==ct.__webglTexture&&t.deleteTexture(ct.__webglTexture),Tt.depthTexture&&Tt.depthTexture.dispose(),Tt.isWebGLCubeRenderTarget)for(let Lt=0;Lt<6;Lt++)t.deleteFramebuffer(Yt.__webglFramebuffer[Lt]),Yt.__webglDepthbuffer&&t.deleteRenderbuffer(Yt.__webglDepthbuffer[Lt]);else t.deleteFramebuffer(Yt.__webglFramebuffer),Yt.__webglDepthbuffer&&t.deleteRenderbuffer(Yt.__webglDepthbuffer),Yt.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Yt.__webglMultisampledFramebuffer),Yt.__webglColorRenderbuffer&&t.deleteRenderbuffer(Yt.__webglColorRenderbuffer),Yt.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Yt.__webglDepthRenderbuffer);g.remove(Tt.texture),g.remove(Tt)}}(nt),H.memory.textures--}let le=0;function ue(Qe,nt){const Tt=g.get(Qe);if(Qe.isVideoTexture&&function(Yt){const ct=H.render.frame;Se.get(Yt)!==ct&&(Se.set(Yt,ct),Yt.update())}(Qe),Qe.version>0&&Tt.__version!==Qe.version){const Yt=Qe.image;if(void 0===Yt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Yt.complete)return void tt(Tt,Qe,nt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}m.activeTexture(33984+nt),m.bindTexture(3553,Tt.__webglTexture)}function _e(Qe,nt){if(6!==Qe.image.length)return;const Tt=g.get(Qe);if(Qe.version>0&&Tt.__version!==Qe.version){We(Tt,Qe),m.activeTexture(33984+nt),m.bindTexture(34067,Tt.__webglTexture),t.pixelStorei(37440,Qe.flipY);const Yt=Qe&&(Qe.isCompressedTexture||Qe.image[0].isCompressedTexture),ct=Qe.image[0]&&Qe.image[0].isDataTexture,Lt=[];for(let rt=0;rt<6;rt++)Lt[rt]=Yt||ct?ct?Qe.image[rt].image:Qe.image[rt]:d(Qe.image[rt],!1,!0,K);const _t=Lt[0],zt=_(_t)||J,Rt=I.convert(Qe.format),nn=I.convert(Qe.type),en=k(Qe.internalFormat,Rt,nn);let Mn;if(Ne(34067,Qe,zt),Yt){for(let rt=0;rt<6;rt++){Mn=Lt[rt].mipmaps;for(let ut=0;ut<Mn.length;ut++){const rn=Mn[ut];Qe.format!==ao&&Qe.format!==Os?null!==Rt?m.compressedTexImage2D(34069+rt,ut,en,rn.width,rn.height,0,rn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(34069+rt,ut,en,rn.width,rn.height,0,Rt,nn,rn.data)}}Tt.__maxMipLevel=Mn.length-1}else{Mn=Qe.mipmaps;for(let rt=0;rt<6;rt++)if(ct){m.texImage2D(34069+rt,0,en,Lt[rt].width,Lt[rt].height,0,Rt,nn,Lt[rt].data);for(let ut=0;ut<Mn.length;ut++){const rn=Mn[ut].image[rt].image;m.texImage2D(34069+rt,ut+1,en,rn.width,rn.height,0,Rt,nn,rn.data)}}else{m.texImage2D(34069+rt,0,en,Rt,nn,Lt[rt]);for(let ut=0;ut<Mn.length;ut++)m.texImage2D(34069+rt,ut+1,en,Rt,nn,Mn[ut].image[rt])}Tt.__maxMipLevel=Mn.length}S(Qe,zt)&&L(34067,Qe,_t.width,_t.height),Tt.__version=Qe.version,Qe.onUpdate&&Qe.onUpdate(Qe)}else m.activeTexture(33984+nt),m.bindTexture(34067,Tt.__webglTexture)}function Ee(Qe,nt){m.activeTexture(33984+nt),m.bindTexture(34067,g.get(Qe).__webglTexture)}const $e={[go]:10497,[Jr]:33071,[os]:33648},Le={[Ir]:9728,[Va]:9984,[us]:9986,[ai]:9729,[Gc]:9985,[sl]:9987};function Ne(Qe,nt,Tt){Tt?(t.texParameteri(Qe,10242,$e[nt.wrapS]),t.texParameteri(Qe,10243,$e[nt.wrapT]),32879!==Qe&&35866!==Qe||t.texParameteri(Qe,32882,$e[nt.wrapR]),t.texParameteri(Qe,10240,Le[nt.magFilter]),t.texParameteri(Qe,10241,Le[nt.minFilter])):(t.texParameteri(Qe,10242,33071),t.texParameteri(Qe,10243,33071),32879!==Qe&&35866!==Qe||t.texParameteri(Qe,32882,33071),nt.wrapS===Jr&&nt.wrapT===Jr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Qe,10240,F(nt.magFilter)),t.texParameteri(Qe,10241,F(nt.minFilter)),nt.minFilter!==Ir&&nt.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Yt=u.get("EXT_texture_filter_anisotropic");if(Yt){if(nt.type===Xo&&null===u.get("OES_texture_float_linear")||nt.type===hs&&null===(J||u.get("OES_texture_half_float_linear")))return;(nt.anisotropy>1||g.get(nt).__currentAnisotropy)&&(t.texParameterf(Qe,Yt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(nt.anisotropy,E.getMaxAnisotropy())),g.get(nt).__currentAnisotropy=nt.anisotropy)}}function We(Qe,nt){void 0===Qe.__webglInit&&(Qe.__webglInit=!0,nt.addEventListener("dispose",V),Qe.__webglTexture=t.createTexture(),H.memory.textures++)}function tt(Qe,nt,Tt){let Yt=3553;nt.isDataTexture2DArray&&(Yt=35866),nt.isDataTexture3D&&(Yt=32879),We(Qe,nt),m.activeTexture(33984+Tt),m.bindTexture(Yt,Qe.__webglTexture),t.pixelStorei(37440,nt.flipY),t.pixelStorei(37441,nt.premultiplyAlpha),t.pixelStorei(3317,nt.unpackAlignment);const ct=(rt=nt,!J&&(rt.wrapS!==Jr||rt.wrapT!==Jr||rt.minFilter!==Ir&&rt.minFilter!==ai)&&!1===_(nt.image)),Lt=d(nt.image,ct,!1,me),_t=_(Lt)||J,zt=I.convert(nt.format);var rt;let Rt,nn=I.convert(nt.type),en=k(nt.internalFormat,zt,nn);Ne(Yt,nt,_t);const Mn=nt.mipmaps;if(nt.isDepthTexture)en=6402,J?en=nt.type===Xo?36012:nt.type===Xs?33190:nt.type===Ts?35056:33189:nt.type===Xo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),nt.format===To&&6402===en&&nt.type!==Hc&&nt.type!==Xs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),nt.type=Hc,nn=I.convert(nt.type)),nt.format===Ys&&6402===en&&(en=34041,nt.type!==Ts&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),nt.type=Ts,nn=I.convert(nt.type))),m.texImage2D(3553,0,en,Lt.width,Lt.height,0,zt,nn,null);else if(nt.isDataTexture)if(Mn.length>0&&_t){for(let rt=0,ut=Mn.length;rt<ut;rt++)Rt=Mn[rt],m.texImage2D(3553,rt,en,Rt.width,Rt.height,0,zt,nn,Rt.data);nt.generateMipmaps=!1,Qe.__maxMipLevel=Mn.length-1}else m.texImage2D(3553,0,en,Lt.width,Lt.height,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(nt.isCompressedTexture){for(let rt=0,ut=Mn.length;rt<ut;rt++)Rt=Mn[rt],nt.format!==ao&&nt.format!==Os?null!==zt?m.compressedTexImage2D(3553,rt,en,Rt.width,Rt.height,0,Rt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(3553,rt,en,Rt.width,Rt.height,0,zt,nn,Rt.data);Qe.__maxMipLevel=Mn.length-1}else if(nt.isDataTexture2DArray)m.texImage3D(35866,0,en,Lt.width,Lt.height,Lt.depth,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(nt.isDataTexture3D)m.texImage3D(32879,0,en,Lt.width,Lt.height,Lt.depth,0,zt,nn,Lt.data),Qe.__maxMipLevel=0;else if(Mn.length>0&&_t){for(let rt=0,ut=Mn.length;rt<ut;rt++)Rt=Mn[rt],m.texImage2D(3553,rt,en,zt,nn,Rt);nt.generateMipmaps=!1,Qe.__maxMipLevel=Mn.length-1}else m.texImage2D(3553,0,en,zt,nn,Lt),Qe.__maxMipLevel=0;S(nt,_t)&&L(Yt,nt,Lt.width,Lt.height),Qe.__version=nt.version,nt.onUpdate&&nt.onUpdate(nt)}function Ze(Qe,nt,Tt,Yt){const ct=I.convert(nt.texture.format),Lt=I.convert(nt.texture.type),_t=k(nt.texture.internalFormat,ct,Lt);m.texImage2D(Yt,0,_t,nt.width,nt.height,0,ct,Lt,null),t.bindFramebuffer(36160,Qe),t.framebufferTexture2D(36160,Tt,Yt,g.get(nt.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function ot(Qe,nt,Tt){if(t.bindRenderbuffer(36161,Qe),nt.depthBuffer&&!nt.stencilBuffer){let Yt=33189;if(Tt){const ct=nt.depthTexture;ct&&ct.isDepthTexture&&(ct.type===Xo?Yt=36012:ct.type===Xs&&(Yt=33190));const Lt=st(nt);t.renderbufferStorageMultisample(36161,Lt,Yt,nt.width,nt.height)}else t.renderbufferStorage(36161,Yt,nt.width,nt.height);t.framebufferRenderbuffer(36160,36096,36161,Qe)}else if(nt.depthBuffer&&nt.stencilBuffer){if(Tt){const Yt=st(nt);t.renderbufferStorageMultisample(36161,Yt,35056,nt.width,nt.height)}else t.renderbufferStorage(36161,34041,nt.width,nt.height);t.framebufferRenderbuffer(36160,33306,36161,Qe)}else{const Yt=I.convert(nt.texture.format),ct=I.convert(nt.texture.type),Lt=k(nt.texture.internalFormat,Yt,ct);if(Tt){const _t=st(nt);t.renderbufferStorageMultisample(36161,_t,Lt,nt.width,nt.height)}else t.renderbufferStorage(36161,Lt,nt.width,nt.height)}t.bindRenderbuffer(36161,null)}function st(Qe){return J&&Qe.isWebGLMultisampleRenderTarget?Math.min(ge,Qe.samples):0}let Ct=!1,Ft=!1;this.allocateTextureUnit=function(){const Qe=le;return Qe>=Y&&console.warn("THREE.WebGLTextures: Trying to use "+Qe+" texture units while this GPU supports only "+Y),le+=1,Qe},this.resetTextureUnits=function(){le=0},this.setTexture2D=ue,this.setTexture2DArray=function(Qe,nt){const Tt=g.get(Qe);Qe.version>0&&Tt.__version!==Qe.version?tt(Tt,Qe,nt):(m.activeTexture(33984+nt),m.bindTexture(35866,Tt.__webglTexture))},this.setTexture3D=function(Qe,nt){const Tt=g.get(Qe);Qe.version>0&&Tt.__version!==Qe.version?tt(Tt,Qe,nt):(m.activeTexture(33984+nt),m.bindTexture(32879,Tt.__webglTexture))},this.setTextureCube=_e,this.setTextureCubeDynamic=Ee,this.setupRenderTarget=function(Qe){const nt=g.get(Qe),Tt=g.get(Qe.texture);Qe.addEventListener("dispose",te),Tt.__webglTexture=t.createTexture(),H.memory.textures++;const Yt=!0===Qe.isWebGLCubeRenderTarget,ct=!0===Qe.isWebGLMultisampleRenderTarget,Lt=_(Qe)||J;if(!J||Qe.texture.format!==Os||Qe.texture.type!==Xo&&Qe.texture.type!==hs||(Qe.texture.format=ao,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Yt){nt.__webglFramebuffer=[];for(let _t=0;_t<6;_t++)nt.__webglFramebuffer[_t]=t.createFramebuffer()}else if(nt.__webglFramebuffer=t.createFramebuffer(),ct)if(J){nt.__webglMultisampledFramebuffer=t.createFramebuffer(),nt.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,nt.__webglColorRenderbuffer);const _t=I.convert(Qe.texture.format),zt=I.convert(Qe.texture.type),Rt=k(Qe.texture.internalFormat,_t,zt),nn=st(Qe);t.renderbufferStorageMultisample(36161,nn,Rt,Qe.width,Qe.height),t.bindFramebuffer(36160,nt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,nt.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),Qe.depthBuffer&&(nt.__webglDepthRenderbuffer=t.createRenderbuffer(),ot(nt.__webglDepthRenderbuffer,Qe,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Yt){m.bindTexture(34067,Tt.__webglTexture),Ne(34067,Qe.texture,Lt);for(let _t=0;_t<6;_t++)Ze(nt.__webglFramebuffer[_t],Qe,36064,34069+_t);S(Qe.texture,Lt)&&L(34067,Qe.texture,Qe.width,Qe.height),m.bindTexture(34067,null)}else m.bindTexture(3553,Tt.__webglTexture),Ne(3553,Qe.texture,Lt),Ze(nt.__webglFramebuffer,Qe,36064,3553),S(Qe.texture,Lt)&&L(3553,Qe.texture,Qe.width,Qe.height),m.bindTexture(3553,null);Qe.depthBuffer&&function(_t){const zt=g.get(_t),Rt=!0===_t.isWebGLCubeRenderTarget;if(_t.depthTexture){if(Rt)throw new Error("target.depthTexture not supported in Cube render targets");!function(nn,en){if(en&&en.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,nn),!en.depthTexture||!en.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(en.depthTexture).__webglTexture&&en.depthTexture.image.width===en.width&&en.depthTexture.image.height===en.height||(en.depthTexture.image.width=en.width,en.depthTexture.image.height=en.height,en.depthTexture.needsUpdate=!0),ue(en.depthTexture,0);const Mn=g.get(en.depthTexture).__webglTexture;if(en.depthTexture.format===To)t.framebufferTexture2D(36160,36096,3553,Mn,0);else{if(en.depthTexture.format!==Ys)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,Mn,0)}}(zt.__webglFramebuffer,_t)}else if(Rt){zt.__webglDepthbuffer=[];for(let nn=0;nn<6;nn++)t.bindFramebuffer(36160,zt.__webglFramebuffer[nn]),zt.__webglDepthbuffer[nn]=t.createRenderbuffer(),ot(zt.__webglDepthbuffer[nn],_t,!1)}else t.bindFramebuffer(36160,zt.__webglFramebuffer),zt.__webglDepthbuffer=t.createRenderbuffer(),ot(zt.__webglDepthbuffer,_t,!1);t.bindFramebuffer(36160,null)}(Qe)},this.updateRenderTargetMipmap=function(Qe){const nt=Qe.texture;if(S(nt,_(Qe)||J)){const Tt=Qe.isWebGLCubeRenderTarget?34067:3553,Yt=g.get(nt).__webglTexture;m.bindTexture(Tt,Yt),L(Tt,nt,Qe.width,Qe.height),m.bindTexture(Tt,null)}},this.updateMultisampleRenderTarget=function(Qe){if(Qe.isWebGLMultisampleRenderTarget)if(J){const nt=g.get(Qe);t.bindFramebuffer(36008,nt.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,nt.__webglFramebuffer);const Tt=Qe.width,Yt=Qe.height;let ct=16384;Qe.depthBuffer&&(ct|=256),Qe.stencilBuffer&&(ct|=1024),t.blitFramebuffer(0,0,Tt,Yt,0,0,Tt,Yt,ct,9728),t.bindFramebuffer(36160,nt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Qe,nt){Qe&&Qe.isWebGLRenderTarget&&(!1===Ct&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ct=!0),Qe=Qe.texture),ue(Qe,nt)},this.safeSetTextureCube=function(Qe,nt){Qe&&Qe.isWebGLCubeRenderTarget&&(!1===Ft&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ft=!0),Qe=Qe.texture),Qe&&Qe.isCubeTexture||Array.isArray(Qe.image)&&6===Qe.image.length?_e(Qe,nt):Ee(Qe,nt)}}function zd(t,u,m){const g=m.isWebGL2;return{convert:function(E){let I;if(E===ca)return 5121;if(E===Vu)return 32819;if(E===du)return 32820;if(E===fu)return 33635;if(E===Wl)return 5120;if(E===Wa)return 5122;if(E===Hc)return 5123;if(E===Hp)return 5124;if(E===Xs)return 5125;if(E===Xo)return 5126;if(E===hs)return g?5131:(I=u.get("OES_texture_half_float"),null!==I?I.HALF_FLOAT_OES:null);if(E===dp)return 6406;if(E===Os)return 6407;if(E===ao)return 6408;if(E===Vc)return 6409;if(E===Wu)return 6410;if(E===To)return 6402;if(E===Ys)return 34041;if(E===Vp)return 6403;if(E===ll)return 36244;if(E===mu)return 33319;if(E===fp)return 33320;if(E===mp)return 36248;if(E===yh)return 36249;if(E===Fh||E===mc||E===Dh||E===bh){if(I=u.get("WEBGL_compressed_texture_s3tc"),null===I)return null;if(E===Fh)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(E===mc)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(E===Dh)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(E===bh)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(E===Uh||E===Tl||E===Ml||E===ql){if(I=u.get("WEBGL_compressed_texture_pvrtc"),null===I)return null;if(E===Uh)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(E===Tl)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(E===Ml)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(E===ql)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(E===qu)return I=u.get("WEBGL_compressed_texture_etc1"),null!==I?I.COMPRESSED_RGB_ETC1_WEBGL:null;if((E===ps||E===Xl)&&(I=u.get("WEBGL_compressed_texture_etc"),null!==I)){if(E===ps)return I.COMPRESSED_RGB8_ETC2;if(E===Xl)return I.COMPRESSED_RGBA8_ETC2_EAC}return E===Xu||E===_p||E===gp||E===Wc||E===_c||E===xh||E===vp||E===Yu||E===Ju||E===cl||E===zh||E===ul||E===jh||E===Zu||E===yc||E===wh||E===_u||E===qc||E===yp||E===Xc||E===Qu||E===Yl||E===bp||E===Gh||E===xp||E===wp||E===Hh||E===Wp?(I=u.get("WEBGL_compressed_texture_astc"),null!==I?E:null):E===vc?(I=u.get("EXT_texture_compression_bptc"),null!==I?E:null):E===Ts?g?34042:(I=u.get("WEBGL_depth_texture"),null!==I?I.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function md(t){Ns.call(this),this.cameras=t||[]}function ba(){Qn.call(this),this.type="Group"}function Np(){this._targetRay=null,this._grip=null,this._hand=null}function cf(t,u){const m=this;let g=null,E=1,I=null,H="local-floor",J=null;const Y=[],K=new Map,me=new Ns;me.layers.enable(1),me.viewport=new xi;const ge=new Ns;ge.layers.enable(2),ge.viewport=new xi;const Se=[me,ge],w=new md;w.layers.enable(1),w.layers.enable(2);let e=null,c=null;function d(ue){const _e=K.get(ue.inputSource);_e&&_e.dispatchEvent({type:ue.type})}function _(){K.forEach(function(ue,_e){ue.disconnect(_e)}),K.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),le.stop(),m.isPresenting=!1,m.dispatchEvent({type:"sessionend"})}function S(ue){I=ue,le.setContext(g),le.start(),m.isPresenting=!0,m.dispatchEvent({type:"sessionstart"})}function L(ue){const _e=g.inputSources;for(let Ee=0;Ee<Y.length;Ee++)K.set(_e[Ee],Y[Ee]);for(let Ee=0;Ee<ue.removed.length;Ee++){const $e=ue.removed[Ee],Le=K.get($e);Le&&(Le.dispatchEvent({type:"disconnected",data:$e}),K.delete($e))}for(let Ee=0;Ee<ue.added.length;Ee++){const $e=ue.added[Ee],Le=K.get($e);Le&&Le.dispatchEvent({type:"connected",data:$e})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let _e=Y[ue];return void 0===_e&&(_e=new Np,Y[ue]=_e),_e.getTargetRaySpace()},this.getControllerGrip=function(ue){let _e=Y[ue];return void 0===_e&&(_e=new Np,Y[ue]=_e),_e.getGripSpace()},this.getHand=function(ue){let _e=Y[ue];return void 0===_e&&(_e=new Np,Y[ue]=_e),_e.getHandSpace()},this.setFramebufferScaleFactor=function(ue){E=ue,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){H=ue,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return I},this.getSession=function(){return g},this.setSession=function(ue){if(g=ue,null!==g){g.addEventListener("select",d),g.addEventListener("selectstart",d),g.addEventListener("selectend",d),g.addEventListener("squeeze",d),g.addEventListener("squeezestart",d),g.addEventListener("squeezeend",d),g.addEventListener("end",_);const _e=u.getContextAttributes();!0!==_e.xrCompatible&&u.makeXRCompatible();const $e=new XRWebGLLayer(g,u,{antialias:_e.antialias,alpha:_e.alpha,depth:_e.depth,stencil:_e.stencil,framebufferScaleFactor:E});g.updateRenderState({baseLayer:$e}),g.requestReferenceSpace(H).then(S),g.addEventListener("inputsourceschange",L)}};const k=new lt,F=new lt;function V(ue,_e){null===_e?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(_e.matrixWorld,ue.matrix),ue.matrixWorldInverse.getInverse(ue.matrixWorld)}this.getCamera=function(ue){w.near=ge.near=me.near=ue.near,w.far=ge.far=me.far=ue.far,e===w.near&&c===w.far||(g.updateRenderState({depthNear:w.near,depthFar:w.far}),e=w.near,c=w.far);const _e=ue.parent,Ee=w.cameras;V(w,_e);for(let Le=0;Le<Ee.length;Le++)V(Ee[Le],_e);ue.matrixWorld.copy(w.matrixWorld);const $e=ue.children;for(let Le=0,Ne=$e.length;Le<Ne;Le++)$e[Le].updateMatrixWorld(!0);return 2===Ee.length?function(Le,Ne,We){k.setFromMatrixPosition(Ne.matrixWorld),F.setFromMatrixPosition(We.matrixWorld);const tt=k.distanceTo(F),Ze=Ne.projectionMatrix.elements,ot=We.projectionMatrix.elements,st=Ze[14]/(Ze[10]-1),Ct=Ze[14]/(Ze[10]+1),Ft=(Ze[9]+1)/Ze[5],Qe=(Ze[9]-1)/Ze[5],nt=(Ze[8]-1)/Ze[0],Tt=(ot[8]+1)/ot[0],Yt=st*nt,ct=st*Tt,Lt=tt/(-nt+Tt),_t=Lt*-nt;Ne.matrixWorld.decompose(Le.position,Le.quaternion,Le.scale),Le.translateX(_t),Le.translateZ(Lt),Le.matrixWorld.compose(Le.position,Le.quaternion,Le.scale),Le.matrixWorldInverse.getInverse(Le.matrixWorld);const zt=st+Lt,Rt=Ct+Lt;Le.projectionMatrix.makePerspective(Yt-_t,ct+(tt-_t),Ft*Ct/Rt*zt,Qe*Ct/Rt*zt,zt,Rt)}(w,me,ge):w.projectionMatrix.copy(me.projectionMatrix),w};let te=null;const le=new Lp;le.setAnimationLoop(function(ue,_e){if(J=_e.getViewerPose(I),null!==J){const $e=J.views,Le=g.renderState.baseLayer;t.setFramebuffer(Le.framebuffer);let Ne=!1;$e.length!==w.cameras.length&&(w.cameras.length=0,Ne=!0);for(let We=0;We<$e.length;We++){const tt=$e[We],Ze=Le.getViewport(tt),ot=Se[We];ot.matrix.fromArray(tt.transform.matrix),ot.projectionMatrix.fromArray(tt.projectionMatrix),ot.viewport.set(Ze.x,Ze.y,Ze.width,Ze.height),0===We&&w.matrix.copy(ot.matrix),!0===Ne&&w.cameras.push(ot)}}const Ee=g.inputSources;for(let $e=0;$e<Y.length;$e++)Y[$e].update(Ee[$e],_e,I);te&&te(ue,_e)}),this.setAnimationLoop=function(ue){te=ue},this.dispose=function(){}}function jd(t){function u(g,E,I){g.opacity.value=E.opacity,E.color&&g.diffuse.value.copy(E.color),E.emissive&&g.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(g.map.value=E.map),E.alphaMap&&(g.alphaMap.value=E.alphaMap),E.specularMap&&(g.specularMap.value=E.specularMap);const H=E.envMap||I;if(H){g.envMap.value=H,g.flipEnvMap.value=H.isCubeTexture?-1:1,g.reflectivity.value=E.reflectivity,g.refractionRatio.value=E.refractionRatio;var J=t.get(H).__maxMipLevel;void 0!==J&&(g.maxMipLevel.value=J)}let Y,K;E.lightMap&&(g.lightMap.value=E.lightMap,g.lightMapIntensity.value=E.lightMapIntensity),E.aoMap&&(g.aoMap.value=E.aoMap,g.aoMapIntensity.value=E.aoMapIntensity),E.map?Y=E.map:E.specularMap?Y=E.specularMap:E.displacementMap?Y=E.displacementMap:E.normalMap?Y=E.normalMap:E.bumpMap?Y=E.bumpMap:E.roughnessMap?Y=E.roughnessMap:E.metalnessMap?Y=E.metalnessMap:E.alphaMap?Y=E.alphaMap:E.emissiveMap&&(Y=E.emissiveMap),void 0!==Y&&(Y.isWebGLRenderTarget&&(Y=Y.texture),!0===Y.matrixAutoUpdate&&Y.updateMatrix(),g.uvTransform.value.copy(Y.matrix)),E.aoMap?K=E.aoMap:E.lightMap&&(K=E.lightMap),void 0!==K&&(K.isWebGLRenderTarget&&(K=K.texture),!0===K.matrixAutoUpdate&&K.updateMatrix(),g.uv2Transform.value.copy(K.matrix))}function m(g,E,I){g.roughness.value=E.roughness,g.metalness.value=E.metalness,E.roughnessMap&&(g.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(g.metalnessMap.value=E.metalnessMap),E.emissiveMap&&(g.emissiveMap.value=E.emissiveMap),E.bumpMap&&(g.bumpMap.value=E.bumpMap,g.bumpScale.value=E.bumpScale,E.side===W&&(g.bumpScale.value*=-1)),E.normalMap&&(g.normalMap.value=E.normalMap,g.normalScale.value.copy(E.normalScale),E.side===W&&g.normalScale.value.negate()),E.displacementMap&&(g.displacementMap.value=E.displacementMap,g.displacementScale.value=E.displacementScale,g.displacementBias.value=E.displacementBias),(E.envMap||I)&&(g.envMapIntensity.value=E.envMapIntensity)}return{refreshFogUniforms:function(g,E){g.fogColor.value.copy(E.color),E.isFog?(g.fogNear.value=E.near,g.fogFar.value=E.far):E.isFogExp2&&(g.fogDensity.value=E.density)},refreshMaterialUniforms:function(g,E,I,H,J){var K;E.isMeshBasicMaterial?u(g,E):E.isMeshLambertMaterial?(u(g,E),(K=E).emissiveMap&&(g.emissiveMap.value=K.emissiveMap)):E.isMeshToonMaterial?(u(g,E),function(Y,K){K.gradientMap&&(Y.gradientMap.value=K.gradientMap),K.emissiveMap&&(Y.emissiveMap.value=K.emissiveMap),K.bumpMap&&(Y.bumpMap.value=K.bumpMap,Y.bumpScale.value=K.bumpScale,K.side===W&&(Y.bumpScale.value*=-1)),K.normalMap&&(Y.normalMap.value=K.normalMap,Y.normalScale.value.copy(K.normalScale),K.side===W&&Y.normalScale.value.negate()),K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshPhongMaterial?(u(g,E),function(Y,K){Y.specular.value.copy(K.specular),Y.shininess.value=Math.max(K.shininess,1e-4),K.emissiveMap&&(Y.emissiveMap.value=K.emissiveMap),K.bumpMap&&(Y.bumpMap.value=K.bumpMap,Y.bumpScale.value=K.bumpScale,K.side===W&&(Y.bumpScale.value*=-1)),K.normalMap&&(Y.normalMap.value=K.normalMap,Y.normalScale.value.copy(K.normalScale),K.side===W&&Y.normalScale.value.negate()),K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshStandardMaterial?(u(g,E,I),E.isMeshPhysicalMaterial?function(Y,K,me){m(Y,K,me),Y.reflectivity.value=K.reflectivity,Y.clearcoat.value=K.clearcoat,Y.clearcoatRoughness.value=K.clearcoatRoughness,K.sheen&&Y.sheen.value.copy(K.sheen),K.clearcoatMap&&(Y.clearcoatMap.value=K.clearcoatMap),K.clearcoatRoughnessMap&&(Y.clearcoatRoughnessMap.value=K.clearcoatRoughnessMap),K.clearcoatNormalMap&&(Y.clearcoatNormalScale.value.copy(K.clearcoatNormalScale),Y.clearcoatNormalMap.value=K.clearcoatNormalMap,K.side===W&&Y.clearcoatNormalScale.value.negate()),Y.transmission.value=K.transmission,K.transmissionMap&&(Y.transmissionMap.value=K.transmissionMap)}(g,E,I):m(g,E,I)):E.isMeshMatcapMaterial?(u(g,E),function(Y,K){K.matcap&&(Y.matcap.value=K.matcap),K.bumpMap&&(Y.bumpMap.value=K.bumpMap,Y.bumpScale.value=K.bumpScale,K.side===W&&(Y.bumpScale.value*=-1)),K.normalMap&&(Y.normalMap.value=K.normalMap,Y.normalScale.value.copy(K.normalScale),K.side===W&&Y.normalScale.value.negate()),K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshDepthMaterial?(u(g,E),function(Y,K){K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias)}(g,E)):E.isMeshDistanceMaterial?(u(g,E),function(Y,K){K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias),Y.referencePosition.value.copy(K.referencePosition),Y.nearDistance.value=K.nearDistance,Y.farDistance.value=K.farDistance}(g,E)):E.isMeshNormalMaterial?(u(g,E),function(Y,K){K.bumpMap&&(Y.bumpMap.value=K.bumpMap,Y.bumpScale.value=K.bumpScale,K.side===W&&(Y.bumpScale.value*=-1)),K.normalMap&&(Y.normalMap.value=K.normalMap,Y.normalScale.value.copy(K.normalScale),K.side===W&&Y.normalScale.value.negate()),K.displacementMap&&(Y.displacementMap.value=K.displacementMap,Y.displacementScale.value=K.displacementScale,Y.displacementBias.value=K.displacementBias)}(g,E)):E.isLineBasicMaterial?(function(Y,K){Y.diffuse.value.copy(K.color),Y.opacity.value=K.opacity}(g,E),E.isLineDashedMaterial&&function(Y,K){Y.dashSize.value=K.dashSize,Y.totalSize.value=K.dashSize+K.gapSize,Y.scale.value=K.scale}(g,E)):E.isPointsMaterial?function(Y,K,me,ge){let Se;Y.diffuse.value.copy(K.color),Y.opacity.value=K.opacity,Y.size.value=K.size*me,Y.scale.value=.5*ge,K.map&&(Y.map.value=K.map),K.alphaMap&&(Y.alphaMap.value=K.alphaMap),K.map?Se=K.map:K.alphaMap&&(Se=K.alphaMap),void 0!==Se&&(!0===Se.matrixAutoUpdate&&Se.updateMatrix(),Y.uvTransform.value.copy(Se.matrix))}(g,E,H,J):E.isSpriteMaterial?function(Y,K){let me;Y.diffuse.value.copy(K.color),Y.opacity.value=K.opacity,Y.rotation.value=K.rotation,K.map&&(Y.map.value=K.map),K.alphaMap&&(Y.alphaMap.value=K.alphaMap),K.map?me=K.map:K.alphaMap&&(me=K.alphaMap),void 0!==me&&(!0===me.matrixAutoUpdate&&me.updateMatrix(),Y.uvTransform.value.copy(me.matrix))}(g,E):E.isShadowMaterial?(g.color.value.copy(E.color),g.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}}}function _d(t){const u=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m=void 0!==t.context?t.context:null,g=void 0!==t.alpha&&t.alpha,E=void 0===t.depth||t.depth,I=void 0===t.stencil||t.stencil,H=void 0!==t.antialias&&t.antialias,J=void 0===t.premultipliedAlpha||t.premultipliedAlpha,Y=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,K=void 0!==t.powerPreference?t.powerPreference:"default",me=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let ge=null,Se=null;this.domElement=u,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ji,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const w=this;let e=!1,c=null,d=0,_=0,S=null,L=null,k=-1,F=null,V=null;const te=new xi,le=new xi;let ue=null,_e=u.width,Ee=u.height,$e=1,Le=null,Ne=null;const We=new xi(0,0,_e,Ee),tt=new xi(0,0,_e,Ee);let Ze=!1;const ot=new eu,st=new Ol;let Ct=!1,Ft=!1;const Qe=new ri,nt=new lt,Tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Yt(){return null===S?$e:1}let ct,Lt,_t,zt,Rt,nn,en,Mn,rt,ut,rn,un,gn,kn,Jn,Zn,cn,mt,Kt,Vt=m;function yn(Et,Ht){for(let vn=0;vn<Et.length;vn++){const tr=u.getContext(Et[vn],Ht);if(null!==tr)return tr}return null}try{const Et={alpha:g,depth:E,stencil:I,antialias:H,premultipliedAlpha:J,preserveDrawingBuffer:Y,powerPreference:K,failIfMajorPerformanceCaveat:me};if(u.addEventListener("webglcontextlost",jr,!1),u.addEventListener("webglcontextrestored",ki,!1),null===Vt){const Ht=["webgl2","webgl","experimental-webgl"];if(!0===w.isWebGL1Renderer&&Ht.shift(),Vt=yn(Ht,Et),null===Vt)throw yn(Ht)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Vt.getShaderPrecisionFormat&&(Vt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Et){throw console.error("THREE.WebGLRenderer: "+Et.message),Et}function Nn(){ct=new tu(Vt),Lt=new sr(Vt,ct,t),!1===Lt.isWebGL2&&(ct.get("WEBGL_depth_texture"),ct.get("OES_texture_float"),ct.get("OES_texture_half_float"),ct.get("OES_texture_half_float_linear"),ct.get("OES_standard_derivatives"),ct.get("OES_element_index_uint"),ct.get("OES_vertex_array_object"),ct.get("ANGLE_instanced_arrays")),ct.get("OES_texture_float_linear"),mt=new zd(Vt,ct,Lt),_t=new ac(Vt,ct,Lt),_t.scissor(le.copy(tt).multiplyScalar($e).floor()),_t.viewport(te.copy(We).multiplyScalar($e).floor()),zt=new nu(Vt),Rt=new Lf,nn=new fd(Vt,ct,_t,Rt,Lt,mt,zt),en=new Ra(Vt,Lt),Kt=new Eu(Vt,ct,en,Lt),Mn=new Mo(Vt,en,zt,Kt),rt=new Mu(Vt,Mn,en,zt),Jn=new rc(Vt),ut=new Pc(w,ct,Lt,Kt),rn=new jd(Rt),un=new Dm(Rt),gn=new Ud,kn=new qp(w,_t,rt,J),Zn=new ui(Vt,ct,zt,Lt),cn=new Vn(Vt,ct,zt,Lt),zt.programs=ut.programs,w.capabilities=Lt,w.extensions=ct,w.properties=Rt,w.renderLists=un,w.state=_t,w.info=zt}Nn();const pr=new cf(w,Vt);this.xr=pr;const _r=new sc(w,rt,Lt.maxTextureSize);function jr(Et){Et.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),e=!0}function ki(){console.log("THREE.WebGLRenderer: Context Restored."),e=!1,Nn()}function mo(Et){const Ht=Et.target;var vn;Ht.removeEventListener("dispose",mo),El(vn=Ht),Rt.remove(vn)}function El(Et){const Ht=Rt.get(Et).program;void 0!==Ht&&ut.releaseProgram(Ht)}this.shadowMap=_r,this.getContext=function(){return Vt},this.getContextAttributes=function(){return Vt.getContextAttributes()},this.forceContextLoss=function(){const Et=ct.get("WEBGL_lose_context");Et&&Et.loseContext()},this.forceContextRestore=function(){const Et=ct.get("WEBGL_lose_context");Et&&Et.restoreContext()},this.getPixelRatio=function(){return $e},this.setPixelRatio=function(Et){void 0!==Et&&($e=Et,this.setSize(_e,Ee,!1))},this.getSize=function(Et){return void 0===Et&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Et=new En),Et.set(_e,Ee)},this.setSize=function(Et,Ht,vn){pr.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(_e=Et,Ee=Ht,u.width=Math.floor(Et*$e),u.height=Math.floor(Ht*$e),!1!==vn&&(u.style.width=Et+"px",u.style.height=Ht+"px"),this.setViewport(0,0,Et,Ht))},this.getDrawingBufferSize=function(Et){return void 0===Et&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Et=new En),Et.set(_e*$e,Ee*$e).floor()},this.setDrawingBufferSize=function(Et,Ht,vn){_e=Et,Ee=Ht,$e=vn,u.width=Math.floor(Et*vn),u.height=Math.floor(Ht*vn),this.setViewport(0,0,Et,Ht)},this.getCurrentViewport=function(Et){return void 0===Et&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Et=new xi),Et.copy(te)},this.getViewport=function(Et){return Et.copy(We)},this.setViewport=function(Et,Ht,vn,Dn){Et.isVector4?We.set(Et.x,Et.y,Et.z,Et.w):We.set(Et,Ht,vn,Dn),_t.viewport(te.copy(We).multiplyScalar($e).floor())},this.getScissor=function(Et){return Et.copy(tt)},this.setScissor=function(Et,Ht,vn,Dn){Et.isVector4?tt.set(Et.x,Et.y,Et.z,Et.w):tt.set(Et,Ht,vn,Dn),_t.scissor(le.copy(tt).multiplyScalar($e).floor())},this.getScissorTest=function(){return Ze},this.setScissorTest=function(Et){_t.setScissorTest(Ze=Et)},this.setOpaqueSort=function(Et){Le=Et},this.setTransparentSort=function(Et){Ne=Et},this.getClearColor=function(){return kn.getClearColor()},this.setClearColor=function(){kn.setClearColor.apply(kn,arguments)},this.getClearAlpha=function(){return kn.getClearAlpha()},this.setClearAlpha=function(){kn.setClearAlpha.apply(kn,arguments)},this.clear=function(Et,Ht,vn){let Dn=0;(void 0===Et||Et)&&(Dn|=16384),(void 0===Ht||Ht)&&(Dn|=256),(void 0===vn||vn)&&(Dn|=1024),Vt.clear(Dn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){u.removeEventListener("webglcontextlost",jr,!1),u.removeEventListener("webglcontextrestored",ki,!1),un.dispose(),gn.dispose(),Rt.dispose(),rt.dispose(),Kt.dispose(),pr.dispose(),Ma.stop()},this.renderBufferImmediate=function(Et,Ht){Kt.initAttributes();const vn=Rt.get(Et);Et.hasPositions&&!vn.position&&(vn.position=Vt.createBuffer()),Et.hasNormals&&!vn.normal&&(vn.normal=Vt.createBuffer()),Et.hasUvs&&!vn.uv&&(vn.uv=Vt.createBuffer()),Et.hasColors&&!vn.color&&(vn.color=Vt.createBuffer());const Dn=Ht.getAttributes();Et.hasPositions&&(Vt.bindBuffer(34962,vn.position),Vt.bufferData(34962,Et.positionArray,35048),Kt.enableAttribute(Dn.position),Vt.vertexAttribPointer(Dn.position,3,5126,!1,0,0)),Et.hasNormals&&(Vt.bindBuffer(34962,vn.normal),Vt.bufferData(34962,Et.normalArray,35048),Kt.enableAttribute(Dn.normal),Vt.vertexAttribPointer(Dn.normal,3,5126,!1,0,0)),Et.hasUvs&&(Vt.bindBuffer(34962,vn.uv),Vt.bufferData(34962,Et.uvArray,35048),Kt.enableAttribute(Dn.uv),Vt.vertexAttribPointer(Dn.uv,2,5126,!1,0,0)),Et.hasColors&&(Vt.bindBuffer(34962,vn.color),Vt.bufferData(34962,Et.colorArray,35048),Kt.enableAttribute(Dn.color),Vt.vertexAttribPointer(Dn.color,3,5126,!1,0,0)),Kt.disableUnusedAttributes(),Vt.drawArrays(4,0,Et.count),Et.count=0},this.renderBufferDirect=function(Et,Ht,vn,Dn,tr,Mi){null===Ht&&(Ht=Tt);const Fi=tr.isMesh&&tr.matrixWorld.determinant()<0,oi=gh(Et,Ht,Dn,tr);_t.setMaterial(Dn,Fi);let cs=vn.index;const oa=vn.attributes.position;if(null===cs){if(void 0===oa||0===oa.count)return}else if(0===cs.count)return;let sa,jo=1;!0===Dn.wireframe&&(cs=Mn.getWireframeAttribute(vn),jo=2),(Dn.morphTargets||Dn.morphNormals)&&Jn.update(tr,vn,Dn,oi),Kt.setup(tr,Dn,oi,vn,cs);let Vi=Zn;null!==cs&&(sa=en.get(cs),Vi=cn,Vi.setIndex(sa));const aa=null!==cs?cs.count:oa.count,Aa=vn.drawRange.start*jo,is=vn.drawRange.count*jo,zc=null!==Mi?Mi.start*jo:0,Vl=null!==Mi?Mi.count*jo:1/0,nf=Math.max(Aa,zc),vt=Math.min(aa,Aa+is,zc+Vl)-1,wn=Math.max(0,vt-nf+1);if(0!==wn){if(tr.isMesh)!0===Dn.wireframe?(_t.setLineWidth(Dn.wireframeLinewidth*Yt()),Vi.setMode(1)):Vi.setMode(4);else if(tr.isLine){let an=Dn.linewidth;void 0===an&&(an=1),_t.setLineWidth(an*Yt()),Vi.setMode(tr.isLineSegments?1:tr.isLineLoop?2:3)}else tr.isPoints?Vi.setMode(0):tr.isSprite&&Vi.setMode(4);if(tr.isInstancedMesh)Vi.renderInstances(nf,wn,tr.count);else if(vn.isInstancedBufferGeometry){const an=Math.min(vn.instanceCount,vn._maxInstanceCount);Vi.renderInstances(nf,wn,an)}else Vi.render(nf,wn)}},this.compile=function(Et,Ht){Se=gn.get(Et,Ht),Se.init(),Et.traverse(function(Dn){Dn.isLight&&(Se.pushLight(Dn),Dn.castShadow&&Se.pushShadow(Dn))}),Se.setupLights(Ht);const vn=new WeakMap;Et.traverse(function(Dn){let tr=Dn.material;if(tr)if(Array.isArray(tr))for(let Mi=0;Mi<tr.length;Mi++){let Fi=tr[Mi];!1===vn.has(Fi)&&(Oh(Fi,Et,Dn),vn.set(Fi))}else!1===vn.has(tr)&&(Oh(tr,Et,Dn),vn.set(tr))})};let zo=null;const Ma=new Lp;function ju(Et,Ht,vn,Dn){if(!1===Et.visible)return;if(Et.layers.test(Ht.layers))if(Et.isGroup)vn=Et.renderOrder;else if(Et.isLOD)!0===Et.autoUpdate&&Et.update(Ht);else if(Et.isLight)Se.pushLight(Et),Et.castShadow&&Se.pushShadow(Et);else if(Et.isSprite){if(!Et.frustumCulled||ot.intersectsSprite(Et)){Dn&&nt.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(Qe);const Mi=rt.update(Et),Fi=Et.material;Fi.visible&&ge.push(Et,Mi,Fi,vn,nt.z,null)}}else if(Et.isImmediateRenderObject)Dn&&nt.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(Qe),ge.push(Et,null,Et.material,vn,nt.z,null);else if((Et.isMesh||Et.isLine||Et.isPoints)&&(Et.isSkinnedMesh&&Et.skeleton.frame!==zt.render.frame&&(Et.skeleton.update(),Et.skeleton.frame=zt.render.frame),!Et.frustumCulled||ot.intersectsObject(Et))){Dn&&nt.setFromMatrixPosition(Et.matrixWorld).applyMatrix4(Qe);const Mi=rt.update(Et),Fi=Et.material;if(Array.isArray(Fi)){const oi=Mi.groups;for(let cs=0,oa=oi.length;cs<oa;cs++){const sa=oi[cs],jo=Fi[sa.materialIndex];jo&&jo.visible&&ge.push(Et,Mi,jo,vn,nt.z,sa)}}else Fi.visible&&ge.push(Et,Mi,Fi,vn,nt.z,null)}const tr=Et.children;for(let Mi=0,Fi=tr.length;Mi<Fi;Mi++)ju(tr[Mi],Ht,vn,Dn)}function Ld(Et,Ht,vn){const Dn=!0===Ht.isScene?Ht.overrideMaterial:null;for(let tr=0,Mi=Et.length;tr<Mi;tr++){const Fi=Et[tr],oi=Fi.object,cs=Fi.geometry,oa=null===Dn?Fi.material:Dn,sa=Fi.group;if(vn.isArrayCamera){V=vn;const jo=vn.cameras;for(let Vi=0,aa=jo.length;Vi<aa;Vi++){const Aa=jo[Vi];oi.layers.test(Aa.layers)&&(_t.viewport(te.copy(Aa.viewport)),Se.setupLights(Aa),Bd(oi,Ht,Aa,cs,oa,sa))}}else V=null,Bd(oi,Ht,vn,cs,oa,sa)}}function Bd(Et,Ht,vn,Dn,tr,Mi){if(Et.onBeforeRender(w,Ht,vn,Dn,tr,Mi),Se=gn.get(Ht,V||vn),Et.modelViewMatrix.multiplyMatrices(vn.matrixWorldInverse,Et.matrixWorld),Et.normalMatrix.getNormalMatrix(Et.modelViewMatrix),Et.isImmediateRenderObject){const Fi=gh(vn,Ht,tr,Et);_t.setMaterial(tr),Kt.reset(),cs=Fi,Et.render(function(oa){w.renderBufferImmediate(oa,cs)})}else w.renderBufferDirect(vn,Ht,Dn,tr,Et,Mi);var cs;Et.onAfterRender(w,Ht,vn,Dn,tr,Mi),Se=gn.get(Ht,V||vn)}function Oh(Et,Ht,vn){!0!==Ht.isScene&&(Ht=Tt);const Dn=Rt.get(Et),tr=Se.state.lights,Fi=tr.state.version,oi=ut.getParameters(Et,tr.state,Se.state.shadowsArray,Ht,st.numPlanes,st.numIntersection,vn),cs=ut.getProgramCacheKey(oi);let oa=Dn.program,sa=!0;if(void 0===oa)Et.addEventListener("dispose",mo);else if(oa.cacheKey!==cs)El(Et);else if(Dn.lightsStateVersion!==Fi)Dn.lightsStateVersion=Fi,sa=!1;else{if(void 0!==oi.shaderID)return;sa=!1}sa&&(oi.uniforms=ut.getUniforms(Et,oi),Et.onBeforeCompile(oi,w),oa=ut.acquireProgram(oi,cs),Dn.program=oa,Dn.uniforms=oi.uniforms,Dn.outputEncoding=oi.outputEncoding);const jo=oa.getAttributes();if(Et.morphTargets){Et.numSupportedMorphTargets=0;for(let is=0;is<w.maxMorphTargets;is++)jo["morphTarget"+is]>=0&&Et.numSupportedMorphTargets++}if(Et.morphNormals){Et.numSupportedMorphNormals=0;for(let is=0;is<w.maxMorphNormals;is++)jo["morphNormal"+is]>=0&&Et.numSupportedMorphNormals++}const Vi=Dn.uniforms;var is;(Et.isShaderMaterial||Et.isRawShaderMaterial)&&!0!==Et.clipping||(Dn.numClippingPlanes=st.numPlanes,Dn.numIntersection=st.numIntersection,Vi.clippingPlanes=st.uniform),Dn.environment=Et.isMeshStandardMaterial?Ht.environment:null,Dn.fog=Ht.fog,Dn.needsLights=(is=Et).isMeshLambertMaterial||is.isMeshToonMaterial||is.isMeshPhongMaterial||is.isMeshStandardMaterial||is.isShadowMaterial||is.isShaderMaterial&&!0===is.lights,Dn.lightsStateVersion=Fi,Dn.needsLights&&(Vi.ambientLightColor.value=tr.state.ambient,Vi.lightProbe.value=tr.state.probe,Vi.directionalLights.value=tr.state.directional,Vi.directionalLightShadows.value=tr.state.directionalShadow,Vi.spotLights.value=tr.state.spot,Vi.spotLightShadows.value=tr.state.spotShadow,Vi.rectAreaLights.value=tr.state.rectArea,Vi.pointLights.value=tr.state.point,Vi.pointLightShadows.value=tr.state.pointShadow,Vi.hemisphereLights.value=tr.state.hemi,Vi.directionalShadowMap.value=tr.state.directionalShadowMap,Vi.directionalShadowMatrix.value=tr.state.directionalShadowMatrix,Vi.spotShadowMap.value=tr.state.spotShadowMap,Vi.spotShadowMatrix.value=tr.state.spotShadowMatrix,Vi.pointShadowMap.value=tr.state.pointShadowMap,Vi.pointShadowMatrix.value=tr.state.pointShadowMatrix);const aa=Dn.program.getUniforms(),Aa=Bp.seqWithValue(aa.seq,Vi);Dn.uniformsList=Aa}function gh(Et,Ht,vn,Dn){!0!==Ht.isScene&&(Ht=Tt),nn.resetTextureUnits();const tr=Ht.fog,Mi=vn.isMeshStandardMaterial?Ht.environment:null,Fi=null===S?w.outputEncoding:S.texture.encoding,oi=Rt.get(vn),cs=Se.state.lights;!0!==Ct||!0!==Ft&&Et===F||st.setState(vn.clippingPlanes,vn.clipIntersection,vn.clipShadows,Et,oi,Et===F&&vn.id===k),vn.version===oi.__version?void 0===oi.program||vn.fog&&oi.fog!==tr||oi.environment!==Mi||oi.needsLights&&oi.lightsStateVersion!==cs.state.version?Oh(vn,Ht,Dn):void 0===oi.numClippingPlanes||oi.numClippingPlanes===st.numPlanes&&oi.numIntersection===st.numIntersection?oi.outputEncoding!==Fi&&Oh(vn,Ht,Dn):Oh(vn,Ht,Dn):(Oh(vn,Ht,Dn),oi.__version=vn.version);let oa=!1,sa=!1,jo=!1;const Vi=oi.program,aa=Vi.getUniforms(),Aa=oi.uniforms;if(_t.useProgram(Vi.program)&&(oa=!0,sa=!0,jo=!0),vn.id!==k&&(k=vn.id,sa=!0),oa||F!==Et){if(aa.setValue(Vt,"projectionMatrix",Et.projectionMatrix),Lt.logarithmicDepthBuffer&&aa.setValue(Vt,"logDepthBufFC",2/(Math.log(Et.far+1)/Math.LN2)),F!==Et&&(F=Et,sa=!0,jo=!0),vn.isShaderMaterial||vn.isMeshPhongMaterial||vn.isMeshToonMaterial||vn.isMeshStandardMaterial||vn.envMap){const Vl=aa.map.cameraPosition;void 0!==Vl&&Vl.setValue(Vt,nt.setFromMatrixPosition(Et.matrixWorld))}(vn.isMeshPhongMaterial||vn.isMeshToonMaterial||vn.isMeshLambertMaterial||vn.isMeshBasicMaterial||vn.isMeshStandardMaterial||vn.isShaderMaterial)&&aa.setValue(Vt,"isOrthographic",!0===Et.isOrthographicCamera),(vn.isMeshPhongMaterial||vn.isMeshToonMaterial||vn.isMeshLambertMaterial||vn.isMeshBasicMaterial||vn.isMeshStandardMaterial||vn.isShaderMaterial||vn.isShadowMaterial||vn.skinning)&&aa.setValue(Vt,"viewMatrix",Et.matrixWorldInverse)}if(vn.skinning){aa.setOptional(Vt,Dn,"bindMatrix"),aa.setOptional(Vt,Dn,"bindMatrixInverse");const Vl=Dn.skeleton;if(Vl)if(Lt.floatVertexTextures){if(void 0===Vl.boneTexture){let vt=Math.sqrt(4*Vl.bones.length);vt=er.ceilPowerOfTwo(vt),vt=Math.max(vt,4);const wn=new Float32Array(vt*vt*4);wn.set(Vl.boneMatrices);const an=new gl(wn,vt,vt,ao,Xo);Vl.boneMatrices=wn,Vl.boneTexture=an,Vl.boneTextureSize=vt}aa.setValue(Vt,"boneTexture",Vl.boneTexture,nn),aa.setValue(Vt,"boneTextureSize",Vl.boneTextureSize)}else aa.setOptional(Vt,Vl,"boneMatrices")}var is,zc;return(sa||oi.receiveShadow!==Dn.receiveShadow)&&(oi.receiveShadow=Dn.receiveShadow,aa.setValue(Vt,"receiveShadow",Dn.receiveShadow)),sa&&(aa.setValue(Vt,"toneMappingExposure",w.toneMappingExposure),oi.needsLights&&((is=Aa).ambientLightColor.needsUpdate=zc=jo,is.lightProbe.needsUpdate=zc,is.directionalLights.needsUpdate=zc,is.directionalLightShadows.needsUpdate=zc,is.pointLights.needsUpdate=zc,is.pointLightShadows.needsUpdate=zc,is.spotLights.needsUpdate=zc,is.spotLightShadows.needsUpdate=zc,is.rectAreaLights.needsUpdate=zc,is.hemisphereLights.needsUpdate=zc),tr&&vn.fog&&rn.refreshFogUniforms(Aa,tr),rn.refreshMaterialUniforms(Aa,vn,Mi,$e,Ee),void 0!==Aa.ltc_1&&(Aa.ltc_1.value=hr.LTC_1),void 0!==Aa.ltc_2&&(Aa.ltc_2.value=hr.LTC_2),Bp.upload(Vt,oi.uniformsList,Aa,nn)),vn.isShaderMaterial&&!0===vn.uniformsNeedUpdate&&(Bp.upload(Vt,oi.uniformsList,Aa,nn),vn.uniformsNeedUpdate=!1),vn.isSpriteMaterial&&aa.setValue(Vt,"center",Dn.center),aa.setValue(Vt,"modelViewMatrix",Dn.modelViewMatrix),aa.setValue(Vt,"normalMatrix",Dn.normalMatrix),aa.setValue(Vt,"modelMatrix",Dn.matrixWorld),Vi}Ma.setAnimationLoop(function(Et){pr.isPresenting||zo&&zo(Et)}),typeof window<"u"&&Ma.setContext(window),this.setAnimationLoop=function(Et){zo=Et,pr.setAnimationLoop(Et),null===Et?Ma.stop():Ma.start()},this.render=function(Et,Ht){let vn,Dn;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),vn=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Dn=arguments[3]),void 0!==Ht&&!0!==Ht.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===e)return;Kt.resetDefaultState(),k=-1,F=null,!0===Et.autoUpdate&&Et.updateMatrixWorld(),null===Ht.parent&&Ht.updateMatrixWorld(),!0===pr.enabled&&!0===pr.isPresenting&&(Ht=pr.getCamera(Ht)),!0===Et.isScene&&Et.onBeforeRender(w,Et,Ht,vn||S),Se=gn.get(Et,Ht),Se.init(),Qe.multiplyMatrices(Ht.projectionMatrix,Ht.matrixWorldInverse),ot.setFromProjectionMatrix(Qe),Ft=this.localClippingEnabled,Ct=st.init(this.clippingPlanes,Ft,Ht),ge=un.get(Et,Ht),ge.init(),ju(Et,Ht,0,w.sortObjects),ge.finish(),!0===w.sortObjects&&ge.sort(Le,Ne),!0===Ct&&st.beginShadows(),_r.render(Se.state.shadowsArray,Et,Ht),Se.setupLights(Ht),!0===Ct&&st.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==vn&&this.setRenderTarget(vn),kn.render(ge,Et,Ht,Dn);const Mi=ge.opaque,Fi=ge.transparent;Mi.length>0&&Ld(Mi,Et,Ht),Fi.length>0&&Ld(Fi,Et,Ht),!0===Et.isScene&&Et.onAfterRender(w,Et,Ht),null!==S&&(nn.updateRenderTargetMipmap(S),nn.updateMultisampleRenderTarget(S)),_t.buffers.depth.setTest(!0),_t.buffers.depth.setMask(!0),_t.buffers.color.setMask(!0),_t.setPolygonOffset(!1),ge=null,Se=null},this.setFramebuffer=function(Et){c!==Et&&null===S&&Vt.bindFramebuffer(36160,Et),c=Et},this.getActiveCubeFace=function(){return d},this.getActiveMipmapLevel=function(){return _},this.getRenderTarget=function(){return S},this.setRenderTarget=function(Et,Ht,vn){S=Et,d=Ht,_=vn,Et&&void 0===Rt.get(Et).__webglFramebuffer&&nn.setupRenderTarget(Et);let Dn=c,tr=!1;if(Et){const Mi=Rt.get(Et).__webglFramebuffer;Et.isWebGLCubeRenderTarget?(Dn=Mi[Ht||0],tr=!0):Dn=Et.isWebGLMultisampleRenderTarget?Rt.get(Et).__webglMultisampledFramebuffer:Mi,te.copy(Et.viewport),le.copy(Et.scissor),ue=Et.scissorTest}else te.copy(We).multiplyScalar($e).floor(),le.copy(tt).multiplyScalar($e).floor(),ue=Ze;if(L!==Dn&&(Vt.bindFramebuffer(36160,Dn),L=Dn),_t.viewport(te),_t.scissor(le),_t.setScissorTest(ue),tr){const Mi=Rt.get(Et.texture);Vt.framebufferTexture2D(36160,36064,34069+(Ht||0),Mi.__webglTexture,vn||0)}},this.readRenderTargetPixels=function(Et,Ht,vn,Dn,tr,Mi,Fi){if(!Et||!Et.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let oi=Rt.get(Et).__webglFramebuffer;if(Et.isWebGLCubeRenderTarget&&void 0!==Fi&&(oi=oi[Fi]),oi){let cs=!1;oi!==L&&(Vt.bindFramebuffer(36160,oi),cs=!0);try{const oa=Et.texture,sa=oa.format,jo=oa.type;if(sa!==ao&&mt.convert(sa)!==Vt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(jo===ca||mt.convert(jo)===Vt.getParameter(35738)||jo===Xo&&(Lt.isWebGL2||ct.get("OES_texture_float")||ct.get("WEBGL_color_buffer_float"))||jo===hs&&ct.get(Lt.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Vt.checkFramebufferStatus(36160)?Ht>=0&&Ht<=Et.width-Dn&&vn>=0&&vn<=Et.height-tr&&Vt.readPixels(Ht,vn,Dn,tr,mt.convert(sa),mt.convert(jo),Mi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{cs&&Vt.bindFramebuffer(36160,L)}}},this.copyFramebufferToTexture=function(Et,Ht,vn){void 0===vn&&(vn=0);const Dn=Math.pow(2,-vn),tr=Math.floor(Ht.image.width*Dn),Mi=Math.floor(Ht.image.height*Dn),Fi=mt.convert(Ht.format);nn.setTexture2D(Ht,0),Vt.copyTexImage2D(3553,vn,Fi,Et.x,Et.y,tr,Mi,0),_t.unbindTexture()},this.copyTextureToTexture=function(Et,Ht,vn,Dn){void 0===Dn&&(Dn=0);const tr=Ht.image.width,Mi=Ht.image.height,Fi=mt.convert(vn.format),oi=mt.convert(vn.type);nn.setTexture2D(vn,0),Vt.pixelStorei(37440,vn.flipY),Vt.pixelStorei(37441,vn.premultiplyAlpha),Vt.pixelStorei(3317,vn.unpackAlignment),Ht.isDataTexture?Vt.texSubImage2D(3553,Dn,Et.x,Et.y,tr,Mi,Fi,oi,Ht.image.data):Ht.isCompressedTexture?Vt.compressedTexSubImage2D(3553,Dn,Et.x,Et.y,Ht.mipmaps[0].width,Ht.mipmaps[0].height,Fi,Ht.mipmaps[0].data):Vt.texSubImage2D(3553,Dn,Et.x,Et.y,Fi,oi,Ht.image),0===Dn&&vn.generateMipmaps&&Vt.generateMipmap(3553),_t.unbindTexture()},this.initTexture=function(Et){nn.setTexture2D(Et,0),_t.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function uf(t){_d.call(this,t)}function hf(t,u){this.name="",this.color=new ar(t),this.density=void 0!==u?u:25e-5}function Xp(t,u,m){this.name="",this.color=new ar(t),this.near=void 0!==u?u:1,this.far=void 0!==m?m:1e3}function Pa(t,u){this.array=t,this.stride=u,this.count=void 0!==t?t.length/u:0,this.usage=bi,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=er.generateUUID()}md.prototype=Object.assign(Object.create(Ns.prototype),{constructor:md,isArrayCamera:!0}),ba.prototype=Object.assign(Object.create(Qn.prototype),{constructor:ba,isGroup:!0}),Object.assign(Np.prototype,{constructor:Np,getHandSpace:function(){if(null===this._hand&&(this._hand=new ba,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){let u=new ba;u.matrixAutoUpdate=!1,u.visible=!1,this._hand.joints.push(u),this._hand.add(u)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new ba,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new ba,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,u,m){let g=null,E=null,I=null;const H=this._targetRay,J=this._grip,Y=this._hand;if(t)if(t.hand){I=!0;for(let K=0;K<=window.XRHand.LITTLE_PHALANX_TIP;K++)if(t.hand[K]){let me=u.getJointPose(t.hand[K],m);const ge=Y.joints[K];null!==me&&(ge.matrix.fromArray(me.transform.matrix),ge.matrix.decompose(ge.position,ge.rotation,ge.scale),ge.jointRadius=me.radius),ge.visible=null!==me;const Se=Y.joints[window.XRHand.INDEX_PHALANX_TIP],w=Y.joints[window.XRHand.THUMB_PHALANX_TIP],e=Se.position.distanceTo(w.position),c=.02,d=.005;Y.inputState.pinching&&e>c+d?(Y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!Y.inputState.pinching&&e<=c-d&&(Y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else null!==H&&(g=u.getPose(t.targetRaySpace,m),null!==g&&(H.matrix.fromArray(g.transform.matrix),H.matrix.decompose(H.position,H.rotation,H.scale))),null!==J&&t.gripSpace&&(E=u.getPose(t.gripSpace,m),null!==E&&(J.matrix.fromArray(E.transform.matrix),J.matrix.decompose(J.position,J.rotation,J.scale)));return null!==H&&(H.visible=null!==g),null!==J&&(J.visible=null!==E),null!==Y&&(Y.visible=null!==I),this}}),Object.assign(cf.prototype,da.prototype),uf.prototype=Object.assign(Object.create(_d.prototype),{constructor:uf,isWebGL1Renderer:!0}),Object.assign(hf.prototype,{isFogExp2:!0,clone:function(){return new hf(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(Xp.prototype,{isFog:!0,clone:function(){return new Xp(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Pa.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Pa.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.stride,m*=u.stride;for(let g=0,E=this.stride;g<E;g++)this.array[t+g]=u.array[m+g];return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=er.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const u=new Pa(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return u.setUsage(this.usage),u},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=er.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const $u=new lt;function Lh(t,u,m,g){this.name="",this.data=t,this.itemSize=u,this.offset=m,this.normalized=!0===g}function _i(t){Ur.call(this),this.type="SpriteMaterial",this.color=new ar(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let gd;Object.defineProperties(Lh.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(Lh.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let u=0,m=this.data.count;u<m;u++)$u.x=this.getX(u),$u.y=this.getY(u),$u.z=this.getZ(u),$u.applyMatrix4(t),this.setXYZ(u,$u.x,$u.y,$u.z);return this},setX:function(t,u){return this.data.array[t*this.data.stride+this.offset]=u,this},setY:function(t,u){return this.data.array[t*this.data.stride+this.offset+1]=u,this},setZ:function(t,u){return this.data.array[t*this.data.stride+this.offset+2]=u,this},setW:function(t,u){return this.data.array[t*this.data.stride+this.offset+3]=u,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,u,m){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this.data.array[t+3]=E,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return new Vr(new this.array.constructor(u),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Lh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:u,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(_i.prototype=Object.create(Ur.prototype)).constructor=_i,_i.prototype.isSpriteMaterial=!0,_i.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const vd=new lt,Rp=new lt,yd=new lt,Pp=new En,Gd=new En,lc=new ri,Hd=new lt,bd=new lt,pf=new lt,Nf=new En,Rf=new En,rm=new En;function nl(t){if(Qn.call(this),this.type="Sprite",void 0===gd){gd=new hn;const u=new Pa(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);gd.setIndex([0,1,2,0,2,3]),gd.setAttribute("position",new Lh(u,3,0,!1)),gd.setAttribute("uv",new Lh(u,2,3,!1))}this.geometry=gd,this.material=void 0!==t?t:new _i,this.center=new En(.5,.5)}function Ip(t,u,m,g,E,I){Pp.subVectors(t,m).addScalar(.5).multiply(g),void 0!==E?(Gd.x=I*Pp.x-E*Pp.y,Gd.y=E*Pp.x+I*Pp.y):Gd.copy(Pp),t.copy(u),t.x+=Gd.x,t.y+=Gd.y,t.applyMatrix4(lc)}nl.prototype=Object.assign(Object.create(Qn.prototype),{constructor:nl,isSprite:!0,raycast:function(t,u){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Rp.setFromMatrixScale(this.matrixWorld),lc.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),yd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Rp.multiplyScalar(-yd.z);const m=this.material.rotation;let g,E;0!==m&&(E=Math.cos(m),g=Math.sin(m));const I=this.center;Ip(Hd.set(-.5,-.5,0),yd,I,Rp,g,E),Ip(bd.set(.5,-.5,0),yd,I,Rp,g,E),Ip(pf.set(.5,.5,0),yd,I,Rp,g,E),Nf.set(0,0),Rf.set(1,0),rm.set(1,1);let H=t.ray.intersectTriangle(Hd,bd,pf,!1,vd);if(null===H&&(Ip(bd.set(-.5,.5,0),yd,I,Rp,g,E),Rf.set(0,1),H=t.ray.intersectTriangle(Hd,pf,bd,!1,vd),null===H))return;const J=t.ray.origin.distanceTo(vd);J<t.near||J>t.far||u.push({distance:J,point:vd.clone(),uv:Pr.getUV(vd,Hd,bd,pf,Nf,Rf,rm,new En),face:null,object:this})},copy:function(t){return Qn.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const df=new lt,Vd=new lt;function Op(){Qn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function ff(t,u){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Ci.call(this,t,u),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ri,this.bindMatrixInverse=new ri}Op.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Op,isLOD:!0,copy:function(t){Qn.prototype.copy.call(this,t,!1);const u=t.levels;for(let m=0,g=u.length;m<g;m++){const E=u[m];this.addLevel(E.object.clone(),E.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,u){void 0===u&&(u=0),u=Math.abs(u);const m=this.levels;let g;for(g=0;g<m.length&&!(u<m[g].distance);g++);return m.splice(g,0,{distance:u,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const u=this.levels;if(u.length>0){let m,g;for(m=1,g=u.length;m<g&&!(t<u[m].distance);m++);return u[m-1].object}return null},raycast:function(t,u){if(this.levels.length>0){df.setFromMatrixPosition(this.matrixWorld);const m=t.ray.origin.distanceTo(df);this.getObjectForDistance(m).raycast(t,u)}},update:function(t){const u=this.levels;if(u.length>1){df.setFromMatrixPosition(t.matrixWorld),Vd.setFromMatrixPosition(this.matrixWorld);const m=df.distanceTo(Vd)/t.zoom;let g,E;for(u[0].object.visible=!0,g=1,E=u.length;g<E&&m>=u[g].distance;g++)u[g-1].object.visible=!1,u[g].object.visible=!0;for(this._currentLevel=g-1;g<E;g++)u[g].object.visible=!1}},toJSON:function(t){const u=Qn.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(u.object.autoUpdate=!1),u.object.levels=[];const m=this.levels;for(let g=0,E=m.length;g<E;g++){const I=m[g];u.object.levels.push({object:I.object.uuid,distance:I.distance})}return u}}),ff.prototype=Object.assign(Object.create(Ci.prototype),{constructor:ff,isSkinnedMesh:!0,copy:function(t){return Ci.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,u){this.skeleton=t,void 0===u&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),u=this.matrixWorld),this.bindMatrix.copy(u),this.bindMatrixInverse.getInverse(u)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new xi,u=this.geometry.attributes.skinWeight;for(let m=0,g=u.count;m<g;m++){t.x=u.getX(m),t.y=u.getY(m),t.z=u.getZ(m),t.w=u.getW(m);const E=1/t.manhattanLength();E!==1/0?t.multiplyScalar(E):t.set(1,0,0,0),u.setXYZW(m,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Ci.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const t=new lt,u=new xi,m=new xi,g=new lt,E=new ri;return function(I,H){const J=this.skeleton,Y=this.geometry;u.fromBufferAttribute(Y.attributes.skinIndex,I),m.fromBufferAttribute(Y.attributes.skinWeight,I),t.fromBufferAttribute(Y.attributes.position,I).applyMatrix4(this.bindMatrix),H.set(0,0,0);for(let K=0;K<4;K++){const me=m.getComponent(K);if(0!==me){const ge=u.getComponent(K);E.multiplyMatrices(J.bones[ge].matrixWorld,J.boneInverses[ge]),H.addScaledVector(g.copy(t).applyMatrix4(E),me)}}return H.applyMatrix4(this.bindMatrixInverse)}}()});const im=new ri,om=new ri;function mf(t,u){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===u)this.calculateInverses();else if(this.bones.length===u.length)this.boneInverses=u.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let m=0,g=this.bones.length;m<g;m++)this.boneInverses.push(new ri)}}function Cu(){Qn.call(this),this.type="Bone"}Object.assign(mf.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,u=this.bones.length;t<u;t++){const m=new ri;this.bones[t]&&m.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(m)}},pose:function(){for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&m.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&(m.parent&&m.parent.isBone?(m.matrix.getInverse(m.parent.matrixWorld),m.matrix.multiply(m.matrixWorld)):m.matrix.copy(m.matrixWorld),m.matrix.decompose(m.position,m.quaternion,m.scale))}},update:function(){const t=this.bones,u=this.boneInverses,m=this.boneMatrices,g=this.boneTexture;for(let E=0,I=t.length;E<I;E++)im.multiplyMatrices(t[E]?t[E].matrixWorld:om,u[E]),im.toArray(m,16*E);void 0!==g&&(g.needsUpdate=!0)},clone:function(){return new mf(this.bones,this.boneInverses)},getBoneByName:function(t){for(let u=0,m=this.bones.length;u<m;u++){const g=this.bones[u];if(g.name===t)return g}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Cu.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Cu,isBone:!0});const Wd=new ri,zi=new ri,ln=[],Yp=new Ci;function Zo(t,u,m){Ci.call(this,t,u),this.instanceMatrix=new Vr(new Float32Array(16*m),16),this.count=m,this.frustumCulled=!1}function $o(t){Ur.call(this),this.type="LineBasicMaterial",this.color=new ar(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}Zo.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Zo,isInstancedMesh:!0,copy:function(t){return Ci.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},getMatrixAt:function(t,u){u.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,u){const m=this.matrixWorld,g=this.count;if(Yp.geometry=this.geometry,Yp.material=this.material,void 0!==Yp.material)for(let E=0;E<g;E++){this.getMatrixAt(E,Wd),zi.multiplyMatrices(m,Wd),Yp.matrixWorld=zi,Yp.raycast(t,ln);for(let I=0,H=ln.length;I<H;I++){const J=ln[I];J.instanceId=E,J.object=this,u.push(J)}ln.length=0}},setMatrixAt:function(t,u){u.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),($o.prototype=Object.create(Ur.prototype)).constructor=$o,$o.prototype.isLineBasicMaterial=!0,$o.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const sm=new lt,Yi=new lt,kp=new ri,Lu=new lo,Ia=new jn;function Us(t,u,m){1===m&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Qn.call(this),this.type="Line",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new $o,this.updateMorphTargets()}Us.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Us,isLine:!0,copy:function(t){return Qn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[0];for(let g=1,E=u.count;g<E;g++)sm.fromBufferAttribute(u,g-1),Yi.fromBufferAttribute(u,g),m[g]=m[g-1],m[g]+=sm.distanceTo(Yi);t.setAttribute("lineDistance",new Un(m,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;m[0]=0;for(let g=1,E=u.length;g<E;g++)m[g]=m[g-1],m[g]+=u[g-1].distanceTo(u[g])}return this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Line.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),Ia.copy(m.boundingSphere),Ia.applyMatrix4(g),Ia.radius+=E,!1===t.ray.intersectsSphere(Ia))return;kp.getInverse(g),Lu.copy(t.ray).applyMatrix4(kp);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),H=I*I,J=new lt,Y=new lt,K=new lt,me=new lt,ge=this&&this.isLineSegments?2:1;if(m.isBufferGeometry){const Se=m.index,w=m.attributes.position.array;if(null!==Se){const e=Se.array;for(let c=0,d=e.length-1;c<d;c+=ge){const S=e[c+1];if(J.fromArray(w,3*e[c]),Y.fromArray(w,3*S),Lu.distanceSqToSegment(J,Y,me,K)>H)continue;me.applyMatrix4(this.matrixWorld);const L=t.ray.origin.distanceTo(me);L<t.near||L>t.far||u.push({distance:L,point:K.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this})}}else for(let e=0,c=w.length/3-1;e<c;e+=ge){if(J.fromArray(w,3*e),Y.fromArray(w,3*e+3),Lu.distanceSqToSegment(J,Y,me,K)>H)continue;me.applyMatrix4(this.matrixWorld);const d=t.ray.origin.distanceTo(me);d<t.near||d>t.far||u.push({distance:d,point:K.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}else if(m.isGeometry){const Se=m.vertices,w=Se.length;for(let e=0;e<w-1;e+=ge){if(Lu.distanceSqToSegment(Se[e],Se[e+1],me,K)>H)continue;me.applyMatrix4(this.matrixWorld);const c=t.ray.origin.distanceTo(me);c<t.near||c>t.far||u.push({distance:c,point:K.clone().applyMatrix4(this.matrixWorld),index:e,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const H=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[H]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Oc=new lt,ys=new lt;function Ii(t,u){Us.call(this,t,u),this.type="LineSegments"}function Jp(t,u){Us.call(this,t,u),this.type="LineLoop"}function kl(t){Ur.call(this),this.type="PointsMaterial",this.color=new ar(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Ii.prototype=Object.assign(Object.create(Us.prototype),{constructor:Ii,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[];for(let g=0,E=u.count;g<E;g+=2)Oc.fromBufferAttribute(u,g),ys.fromBufferAttribute(u,g+1),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Oc.distanceTo(ys);t.setAttribute("lineDistance",new Un(m,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;for(let g=0,E=u.length;g<E;g+=2)Oc.copy(u[g]),ys.copy(u[g+1]),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Oc.distanceTo(ys)}return this}}),Jp.prototype=Object.assign(Object.create(Us.prototype),{constructor:Jp,isLineLoop:!0}),(kl.prototype=Object.create(Ur.prototype)).constructor=kl,kl.prototype.isPointsMaterial=!0,kl.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const Vo=new ri,Fl=new lo,ea=new jn,Oa=new lt;function kc(t,u){Qn.call(this),this.type="Points",this.geometry=void 0!==t?t:new hn,this.material=void 0!==u?u:new kl,this.updateMorphTargets()}function cc(t,u,m,g,E,I,H){const J=Fl.distanceSqToPoint(t);if(J<m){const Y=new lt;Fl.closestPointToPoint(t,Y),Y.applyMatrix4(g);const K=E.ray.origin.distanceTo(Y);if(K<E.near||K>E.far)return;I.push({distance:K,distanceToRay:Math.sqrt(J),point:Y,index:u,face:null,object:H})}}function xd(t,u,m,g,E,I,H,J,Y){di.call(this,t,u,m,g,E,I,H,J,Y),this.format=void 0!==H?H:Os,this.minFilter=void 0!==I?I:ai,this.magFilter=void 0!==E?E:ai,this.generateMipmaps=!1;const K=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function me(){K.needsUpdate=!0,t.requestVideoFrameCallback(me)})}function uc(t,u,m,g,E,I,H,J,Y,K,me,ge){di.call(this,null,I,H,J,Y,K,g,E,me,ge),this.image={width:u,height:m},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function iu(t,u,m,g,E,I,H,J,Y){di.call(this,t,u,m,g,E,I,H,J,Y),this.needsUpdate=!0}function Bu(t,u,m,g,E,I,H,J,Y,K){if((K=void 0!==K?K:To)!==To&&K!==Ys)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===m&&K===To&&(m=Hc),void 0===m&&K===Ys&&(m=Ts),di.call(this,null,g,E,I,H,J,K,m,Y),this.image={width:t,height:u},this.magFilter=void 0!==H?H:Ir,this.minFilter=void 0!==J?J:Ir,this.flipY=!1,this.generateMipmaps=!1}function hc(t){hn.call(this),this.type="WireframeGeometry";const u=[],m=[0,0],g={},E=["a","b","c"];if(t&&t.isGeometry){const I=t.faces;for(let H=0,J=I.length;H<J;H++){const Y=I[H];for(let K=0;K<3;K++){const me=Y[E[K]],ge=Y[E[(K+1)%3]];m[0]=Math.min(me,ge),m[1]=Math.max(me,ge);const Se=m[0]+","+m[1];void 0===g[Se]&&(g[Se]={index1:m[0],index2:m[1]})}}for(const H in g){const J=g[H];let Y=t.vertices[J.index1];u.push(Y.x,Y.y,Y.z),Y=t.vertices[J.index2],u.push(Y.x,Y.y,Y.z)}}else if(t&&t.isBufferGeometry){let I=new lt;if(null!==t.index){const H=t.attributes.position,J=t.index;let Y=t.groups;0===Y.length&&(Y=[{start:0,count:J.count,materialIndex:0}]);for(let K=0,me=Y.length;K<me;++K){const ge=Y[K],Se=ge.start;for(let w=Se,e=Se+ge.count;w<e;w+=3)for(let c=0;c<3;c++){const d=J.getX(w+c),_=J.getX(w+(c+1)%3);m[0]=Math.min(d,_),m[1]=Math.max(d,_);const S=m[0]+","+m[1];void 0===g[S]&&(g[S]={index1:m[0],index2:m[1]})}}for(const K in g){const me=g[K];I.fromBufferAttribute(H,me.index1),u.push(I.x,I.y,I.z),I.fromBufferAttribute(H,me.index2),u.push(I.x,I.y,I.z)}}else{const H=t.attributes.position;for(let J=0,Y=H.count/3;J<Y;J++)for(let K=0;K<3;K++)I.fromBufferAttribute(H,3*J+K),u.push(I.x,I.y,I.z),I.fromBufferAttribute(H,3*J+(K+1)%3),u.push(I.x,I.y,I.z)}}this.setAttribute("position",new Un(u,3))}function hh(t,u,m){kr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:u,stacks:m},this.fromBufferGeometry(new Fc(t,u,m)),this.mergeVertices()}function Fc(t,u,m){hn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:u,stacks:m};const g=[],E=[],I=[],H=[],J=1e-5,Y=new lt,K=new lt,me=new lt,ge=new lt,Se=new lt;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const w=u+1;for(let e=0;e<=m;e++){const c=e/m;for(let d=0;d<=u;d++){const _=d/u;t(_,c,K),E.push(K.x,K.y,K.z),_-J>=0?(t(_-J,c,me),ge.subVectors(K,me)):(t(_+J,c,me),ge.subVectors(me,K)),c-J>=0?(t(_,c-J,me),Se.subVectors(K,me)):(t(_,c+J,me),Se.subVectors(me,K)),Y.crossVectors(ge,Se).normalize(),I.push(Y.x,Y.y,Y.z),H.push(_,c)}}for(let e=0;e<m;e++)for(let c=0;c<u;c++){const _=e*w+c+1,S=(e+1)*w+c+1,L=(e+1)*w+c;g.push(e*w+c,_,L),g.push(_,S,L)}this.setIndex(g),this.setAttribute("position",new Un(E,3)),this.setAttribute("normal",new Un(I,3)),this.setAttribute("uv",new Un(H,2))}function Nu(t,u,m,g){kr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},this.fromBufferGeometry(new bs(t,u,m,g)),this.mergeVertices()}function bs(t,u,m,g){hn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},m=m||1;const E=[],I=[];function H(ge,Se,w,e){const c=Math.pow(2,e),d=[];for(let _=0;_<=c;_++){d[_]=[];const S=ge.clone().lerp(w,_/c),L=Se.clone().lerp(w,_/c),k=c-_;for(let F=0;F<=k;F++)d[_][F]=0===F&&_===c?S:S.clone().lerp(L,F/k)}for(let _=0;_<c;_++)for(let S=0;S<2*(c-_)-1;S++){const L=Math.floor(S/2);S%2==0?(J(d[_][L+1]),J(d[_+1][L]),J(d[_][L])):(J(d[_][L+1]),J(d[_+1][L+1]),J(d[_+1][L]))}}function J(ge){E.push(ge.x,ge.y,ge.z)}function Y(ge,Se){const w=3*ge;Se.x=t[w+0],Se.y=t[w+1],Se.z=t[w+2]}function K(ge,Se,w,e){e<0&&1===ge.x&&(I[Se]=ge.x-1),0===w.x&&0===w.z&&(I[Se]=e/2/Math.PI+.5)}function me(ge){return Math.atan2(ge.z,-ge.x)}(function(ge){const Se=new lt,w=new lt,e=new lt;for(let c=0;c<u.length;c+=3)Y(u[c+0],Se),Y(u[c+1],w),Y(u[c+2],e),H(Se,w,e,ge)})(g=g||0),function(ge){const Se=new lt;for(let w=0;w<E.length;w+=3)Se.x=E[w+0],Se.y=E[w+1],Se.z=E[w+2],Se.normalize().multiplyScalar(ge),E[w+0]=Se.x,E[w+1]=Se.y,E[w+2]=Se.z}(m),function(){const ge=new lt;for(let w=0;w<E.length;w+=3){ge.x=E[w+0],ge.y=E[w+1],ge.z=E[w+2];const e=me(ge)/2/Math.PI+.5,c=(Se=ge,Math.atan2(-Se.y,Math.sqrt(Se.x*Se.x+Se.z*Se.z))/Math.PI+.5);I.push(e,1-c)}var Se;(function(){const w=new lt,e=new lt,c=new lt,d=new lt,_=new En,S=new En,L=new En;for(let k=0,F=0;k<E.length;k+=9,F+=6){w.set(E[k+0],E[k+1],E[k+2]),e.set(E[k+3],E[k+4],E[k+5]),c.set(E[k+6],E[k+7],E[k+8]),_.set(I[F+0],I[F+1]),S.set(I[F+2],I[F+3]),L.set(I[F+4],I[F+5]),d.copy(w).add(e).add(c).divideScalar(3);const V=me(d);K(_,F+0,w,V),K(S,F+2,e,V),K(L,F+4,c,V)}})(),function(){for(let w=0;w<I.length;w+=6){const e=I[w+0],c=I[w+2],d=I[w+4],_=Math.max(e,c,d),S=Math.min(e,c,d);_>.9&&S<.1&&(e<.2&&(I[w+0]+=1),c<.2&&(I[w+2]+=1),d<.2&&(I[w+4]+=1))}}()}(),this.setAttribute("position",new Un(E,3)),this.setAttribute("normal",new Un(E.slice(),3)),this.setAttribute("uv",new Un(I,2)),0===g?this.computeVertexNormals():this.normalizeNormals()}function Ru(t,u){kr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new ph(t,u)),this.mergeVertices()}function ph(t,u){bs.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,u),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Bh(t,u){kr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new zs(t,u)),this.mergeVertices()}function zs(t,u){bs.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,u),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Dl(t,u){kr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new xa(t,u)),this.mergeVertices()}function xa(t,u){const m=(1+Math.sqrt(5))/2;bs.call(this,[-1,m,0,1,m,0,-1,-m,0,1,-m,0,0,-1,m,0,1,m,0,-1,-m,0,1,-m,m,0,-1,m,0,1,-m,0,-1,-m,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,u),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Ul(t,u){kr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new zl(t,u)),this.mergeVertices()}function zl(t,u){const m=(1+Math.sqrt(5))/2,g=1/m;bs.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-g,-m,0,-g,m,0,g,-m,0,g,m,-g,-m,0,-g,m,0,g,-m,0,g,m,0,-m,0,-g,m,0,-g,-m,0,g,m,0,g],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,u),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:u}}function jl(t,u,m,g,E,I){kr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},void 0!==I&&console.warn("THREE.TubeGeometry: taper has been removed.");const H=new Is(t,u,m,g,E);this.tangents=H.tangents,this.normals=H.normals,this.binormals=H.binormals,this.fromBufferGeometry(H),this.mergeVertices()}function Is(t,u,m,g,E){hn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},m=m||1,g=g||8;const I=t.computeFrenetFrames(u=u||64,E=E||!1);this.tangents=I.tangents,this.normals=I.normals,this.binormals=I.binormals;const H=new lt,J=new lt,Y=new En;let K=new lt;const me=[],ge=[],Se=[],w=[];function e(c){K=t.getPointAt(c/u,K);const d=I.normals[c],_=I.binormals[c];for(let S=0;S<=g;S++){const L=S/g*Math.PI*2,k=Math.sin(L),F=-Math.cos(L);J.x=F*d.x+k*_.x,J.y=F*d.y+k*_.y,J.z=F*d.z+k*_.z,J.normalize(),ge.push(J.x,J.y,J.z),H.x=K.x+m*J.x,H.y=K.y+m*J.y,H.z=K.z+m*J.z,me.push(H.x,H.y,H.z)}}(function(){for(let c=0;c<u;c++)e(c);e(!1===E?u:0),function(){for(let c=0;c<=u;c++)for(let d=0;d<=g;d++)Y.x=c/u,Y.y=d/g,Se.push(Y.x,Y.y)}(),function(){for(let c=1;c<=u;c++)for(let d=1;d<=g;d++){const S=(g+1)*c+(d-1),L=(g+1)*c+d,k=(g+1)*(c-1)+d;w.push((g+1)*(c-1)+(d-1),S,k),w.push(S,L,k)}}()})(),this.setIndex(w),this.setAttribute("position",new Un(me,3)),this.setAttribute("normal",new Un(ge,3)),this.setAttribute("uv",new Un(Se,2))}function Nh(t,u,m,g,E,I,H){kr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},void 0!==H&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Co(t,u,m,g,E,I)),this.mergeVertices()}function Co(t,u,m,g,E,I){hn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},t=t||1,u=u||.4,m=Math.floor(m)||64,g=Math.floor(g)||8,E=E||2,I=I||3;const H=[],J=[],Y=[],K=[],me=new lt,ge=new lt,Se=new lt,w=new lt,e=new lt,c=new lt,d=new lt;for(let S=0;S<=m;++S){const L=S/m*E*Math.PI*2;_(L,E,I,t,Se),_(L+.01,E,I,t,w),c.subVectors(w,Se),d.addVectors(w,Se),e.crossVectors(c,d),d.crossVectors(e,c),e.normalize(),d.normalize();for(let k=0;k<=g;++k){const F=k/g*Math.PI*2,V=-u*Math.cos(F),te=u*Math.sin(F);me.x=Se.x+(V*d.x+te*e.x),me.y=Se.y+(V*d.y+te*e.y),me.z=Se.z+(V*d.z+te*e.z),J.push(me.x,me.y,me.z),ge.subVectors(me,Se).normalize(),Y.push(ge.x,ge.y,ge.z),K.push(S/m),K.push(k/g)}}for(let S=1;S<=m;S++)for(let L=1;L<=g;L++){const F=(g+1)*S+(L-1),V=(g+1)*S+L,te=(g+1)*(S-1)+L;H.push((g+1)*(S-1)+(L-1),F,te),H.push(F,V,te)}function _(S,L,k,F,V){const te=Math.cos(S),le=Math.sin(S),ue=k/L*S,_e=Math.cos(ue);V.x=F*(2+_e)*.5*te,V.y=F*(2+_e)*le*.5,V.z=F*Math.sin(ue)*.5}this.setIndex(H),this.setAttribute("position",new Un(J,3)),this.setAttribute("normal",new Un(Y,3)),this.setAttribute("uv",new Un(K,2))}function rp(t,u,m,g,E){kr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},this.fromBufferGeometry(new ou(t,u,m,g,E)),this.mergeVertices()}function ou(t,u,m,g,E){hn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},t=t||1,u=u||.4,m=Math.floor(m)||8,g=Math.floor(g)||6,E=E||2*Math.PI;const I=[],H=[],J=[],Y=[],K=new lt,me=new lt,ge=new lt;for(let Se=0;Se<=m;Se++)for(let w=0;w<=g;w++){const e=w/g*E,c=Se/m*Math.PI*2;me.x=(t+u*Math.cos(c))*Math.cos(e),me.y=(t+u*Math.cos(c))*Math.sin(e),me.z=u*Math.sin(c),H.push(me.x,me.y,me.z),K.x=t*Math.cos(e),K.y=t*Math.sin(e),ge.subVectors(me,K).normalize(),J.push(ge.x,ge.y,ge.z),Y.push(w/g),Y.push(Se/m)}for(let Se=1;Se<=m;Se++)for(let w=1;w<=g;w++){const c=(g+1)*(Se-1)+w-1,d=(g+1)*(Se-1)+w,_=(g+1)*Se+w;I.push((g+1)*Se+w-1,c,_),I.push(c,d,_)}this.setIndex(I),this.setAttribute("position",new Un(H,3)),this.setAttribute("normal",new Un(J,3)),this.setAttribute("uv",new Un(Y,2))}function _f(t,u,m,g,E){let I,H;if(E===function(J,Y,K,me){let ge=0;for(let Se=Y,w=K-me;Se<K;Se+=me)ge+=(J[w]-J[Se])*(J[Se+1]+J[w+1]),w=Se;return ge}(t,u,m,g)>0)for(I=u;I<m;I+=g)H=ta(I,t[I],t[I+1],H);else for(I=m-g;I>=u;I-=g)H=ta(I,t[I],t[I+1],H);return H&&Qo(H,H.next)&&(wd(H),H=H.next),H}function Pu(t,u){if(!t)return t;u||(u=t);let m,g=t;do{if(m=!1,g.steiner||!Qo(g,g.next)&&0!==dr(g.prev,g,g.next))g=g.next;else{if(wd(g),g=u=g.prev,g===g.next)break;m=!0}}while(m||g!==u);return u}function Oo(t,u,m,g,E,I,H){if(!t)return;!H&&I&&function(me,ge,Se,w){let e=me;do{null===e.z&&(e.z=io(e.x,e.y,ge,Se,w)),e.prevZ=e.prev,e.nextZ=e.next,e=e.next}while(e!==me);e.prevZ.nextZ=null,e.prevZ=null,function(c){let d,_,S,L,k,F,V,te,le=1;do{for(_=c,c=null,k=null,F=0;_;){for(F++,S=_,V=0,d=0;d<le&&(V++,S=S.nextZ,S);d++);for(te=le;V>0||te>0&&S;)0!==V&&(0===te||!S||_.z<=S.z)?(L=_,_=_.nextZ,V--):(L=S,S=S.nextZ,te--),k?k.nextZ=L:c=L,L.prevZ=k,k=L;_=S}k.nextZ=null,le*=2}while(F>1)}(e)}(t,g,E,I);let J,Y,K=t;for(;t.prev!==t.next;)if(J=t.prev,Y=t.next,I?Dc(t,g,E,I):Lo(t))u.push(J.i/m),u.push(t.i/m),u.push(Y.i/m),wd(t),t=Y.next,K=Y.next;else if((t=Y)===K){H?1===H?Oo(t=kt(Pu(t),u,m),u,m,g,E,I,2):2===H&&Fp(t,u,m,g,E,I):Oo(Pu(t),u,m,g,E,I,1);break}}function Lo(t){let u=t.prev,m=t,g=t.next;if(dr(u,m,g)>=0)return!1;let E=t.next.next;for(;E!==t.prev;){if(ip(u.x,u.y,m.x,m.y,g.x,g.y,E.x,E.y)&&dr(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Dc(t,u,m,g){let E=t.prev,I=t,H=t.next;if(dr(E,I,H)>=0)return!1;let K=E.x>I.x?E.x>H.x?E.x:H.x:I.x>H.x?I.x:H.x,me=E.y>I.y?E.y>H.y?E.y:H.y:I.y>H.y?I.y:H.y,ge=io(E.x<I.x?E.x<H.x?E.x:H.x:I.x<H.x?I.x:H.x,E.y<I.y?E.y<H.y?E.y:H.y:I.y<H.y?I.y:H.y,u,m,g),Se=io(K,me,u,m,g),w=t.prevZ,e=t.nextZ;for(;w&&w.z>=ge&&e&&e.z<=Se;){if(w!==t.prev&&w!==t.next&&ip(E.x,E.y,I.x,I.y,H.x,H.y,w.x,w.y)&&dr(w.prev,w,w.next)>=0||(w=w.prevZ,e!==t.prev&&e!==t.next&&ip(E.x,E.y,I.x,I.y,H.x,H.y,e.x,e.y)&&dr(e.prev,e,e.next)>=0))return!1;e=e.nextZ}for(;w&&w.z>=ge;){if(w!==t.prev&&w!==t.next&&ip(E.x,E.y,I.x,I.y,H.x,H.y,w.x,w.y)&&dr(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;e&&e.z<=Se;){if(e!==t.prev&&e!==t.next&&ip(E.x,E.y,I.x,I.y,H.x,H.y,e.x,e.y)&&dr(e.prev,e,e.next)>=0)return!1;e=e.nextZ}return!0}function kt(t,u,m){let g=t;do{let E=g.prev,I=g.next.next;!Qo(E,I)&&gi(E,g,g.next,I)&&Fo(E,I)&&Fo(I,E)&&(u.push(E.i/m),u.push(g.i/m),u.push(I.i/m),wd(g),wd(g.next),g=t=I),g=g.next}while(g!==t);return Pu(g)}function Fp(t,u,m,g,E,I){let H=t;do{let J=H.next.next;for(;J!==H.prev;){if(H.i!==J.i&&Pf(H,J)){let Y=pc(H,J);return H=Pu(H,H.next),Y=Pu(Y,Y.next),Oo(H,u,m,g,E,I),void Oo(Y,u,m,g,E,I)}J=J.next}H=H.next}while(H!==t)}function ji(t,u){return t.x-u.x}function Gs(t,u){if(u=function(m,g){let E,I=g,H=m.x,J=m.y,Y=-1/0;do{if(J<=I.y&&J>=I.next.y&&I.next.y!==I.y){let e=I.x+(J-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(e<=H&&e>Y){if(Y=e,e===H){if(J===I.y)return I;if(J===I.next.y)return I.next}E=I.x<I.next.x?I:I.next}}I=I.next}while(I!==g);if(!E)return null;if(H===Y)return E;let K,me=E,ge=E.x,Se=E.y,w=1/0;I=E;do{H>=I.x&&I.x>=ge&&H!==I.x&&ip(J<Se?H:Y,J,ge,Se,J<Se?Y:H,J,I.x,I.y)&&(K=Math.abs(J-I.y)/(H-I.x),Fo(I,m)&&(K<w||K===w&&(I.x>E.x||I.x===E.x&&ko(E,I)))&&(E=I,w=K)),I=I.next}while(I!==me);return E}(t,u)){const m=pc(u,t);Pu(u,u.next),Pu(m,m.next)}}function ko(t,u){return dr(t.prev,t,u.prev)<0&&dr(u.next,t,t.next)<0}function io(t,u,m,g,E){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-m)*E)|t<<8))|t<<4))|t<<2))|t<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-g)*E)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function ka(t){let u=t,m=t;do{(u.x<m.x||u.x===m.x&&u.y<m.y)&&(m=u),u=u.next}while(u!==t);return m}function ip(t,u,m,g,E,I,H,J){return(E-H)*(u-J)-(t-H)*(I-J)>=0&&(t-H)*(g-J)-(m-H)*(u-J)>=0&&(m-H)*(I-J)-(E-H)*(g-J)>=0}function Pf(t,u){return t.next.i!==u.i&&t.prev.i!==u.i&&!function(m,g){let E=m;do{if(E.i!==m.i&&E.next.i!==m.i&&E.i!==g.i&&E.next.i!==g.i&&gi(E,E.next,m,g))return!0;E=E.next}while(E!==m);return!1}(t,u)&&(Fo(t,u)&&Fo(u,t)&&function(m,g){let E=m,I=!1,H=(m.x+g.x)/2,J=(m.y+g.y)/2;do{E.y>J!=E.next.y>J&&E.next.y!==E.y&&H<(E.next.x-E.x)*(J-E.y)/(E.next.y-E.y)+E.x&&(I=!I),E=E.next}while(E!==m);return I}(t,u)&&(dr(t.prev,t,u.prev)||dr(t,u.prev,u))||Qo(t,u)&&dr(t.prev,t,t.next)>0&&dr(u.prev,u,u.next)>0)}function dr(t,u,m){return(u.y-t.y)*(m.x-u.x)-(u.x-t.x)*(m.y-u.y)}function Qo(t,u){return t.x===u.x&&t.y===u.y}function gi(t,u,m,g){const E=hi(dr(t,u,m)),I=hi(dr(t,u,g)),H=hi(dr(m,g,t)),J=hi(dr(m,g,u));return E!==I&&H!==J||!(0!==E||!Wo(t,m,u))||!(0!==I||!Wo(t,g,u))||!(0!==H||!Wo(m,t,g))||!(0!==J||!Wo(m,u,g))}function Wo(t,u,m){return u.x<=Math.max(t.x,m.x)&&u.x>=Math.min(t.x,m.x)&&u.y<=Math.max(t.y,m.y)&&u.y>=Math.min(t.y,m.y)}function hi(t){return t>0?1:t<0?-1:0}function Fo(t,u){return dr(t.prev,t,t.next)<0?dr(t,u,t.next)>=0&&dr(t,t.prev,u)>=0:dr(t,u,t.prev)<0||dr(t,t.next,u)<0}function pc(t,u){let m=new Dp(t.i,t.x,t.y),g=new Dp(u.i,u.x,u.y),E=t.next,I=u.prev;return t.next=u,u.prev=t,m.next=E,E.prev=m,g.next=m,m.prev=g,I.next=g,g.prev=I,g}function ta(t,u,m,g){const E=new Dp(t,u,m);return g?(E.next=g.next,E.prev=g,g.next.prev=E,g.next=E):(E.prev=E,E.next=E),E}function wd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Dp(t,u,m){this.i=t,this.x=u,this.y=m,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}kc.prototype=Object.assign(Object.create(Qn.prototype),{constructor:kc,isPoints:!0,copy:function(t){return Qn.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Points.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),ea.copy(m.boundingSphere),ea.applyMatrix4(g),ea.radius+=E,!1===t.ray.intersectsSphere(ea))return;Vo.getInverse(g),Fl.copy(t.ray).applyMatrix4(Vo);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),H=I*I;if(m.isBufferGeometry){const J=m.index,Y=m.attributes.position.array;if(null!==J){const K=J.array;for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Oa.fromArray(Y,3*Se),cc(Oa,Se,H,g,t,u,this)}}else for(let K=0,me=Y.length/3;K<me;K++)Oa.fromArray(Y,3*K),cc(Oa,K,H,g,t,u,this)}else{const J=m.vertices;for(let Y=0,K=J.length;Y<K;Y++)cc(J[Y],Y,H,g,t,u,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const H=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[H]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),xd.prototype=Object.assign(Object.create(di.prototype),{constructor:xd,isVideoTexture:!0,update:function(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(uc.prototype=Object.create(di.prototype)).constructor=uc,uc.prototype.isCompressedTexture=!0,(iu.prototype=Object.create(di.prototype)).constructor=iu,iu.prototype.isCanvasTexture=!0,(Bu.prototype=Object.create(di.prototype)).constructor=Bu,Bu.prototype.isDepthTexture=!0,(hc.prototype=Object.create(hn.prototype)).constructor=hc,(hh.prototype=Object.create(kr.prototype)).constructor=hh,(Fc.prototype=Object.create(hn.prototype)).constructor=Fc,(Nu.prototype=Object.create(kr.prototype)).constructor=Nu,(bs.prototype=Object.create(hn.prototype)).constructor=bs,(Ru.prototype=Object.create(kr.prototype)).constructor=Ru,(ph.prototype=Object.create(bs.prototype)).constructor=ph,(Bh.prototype=Object.create(kr.prototype)).constructor=Bh,(zs.prototype=Object.create(bs.prototype)).constructor=zs,(Dl.prototype=Object.create(kr.prototype)).constructor=Dl,(xa.prototype=Object.create(bs.prototype)).constructor=xa,(Ul.prototype=Object.create(kr.prototype)).constructor=Ul,(zl.prototype=Object.create(bs.prototype)).constructor=zl,(jl.prototype=Object.create(kr.prototype)).constructor=jl,(Is.prototype=Object.create(hn.prototype)).constructor=Is,Is.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Nh.prototype=Object.create(kr.prototype)).constructor=Nh,(Co.prototype=Object.create(hn.prototype)).constructor=Co,(rp.prototype=Object.create(kr.prototype)).constructor=rp,(ou.prototype=Object.create(hn.prototype)).constructor=ou;const Iu={area:function(t){const u=t.length;let m=0;for(let g=u-1,E=0;E<u;g=E++)m+=t[g].x*t[E].y-t[E].x*t[g].y;return.5*m},isClockWise:function(t){return Iu.area(t)<0},triangulateShape:function(t,u){const m=[],g=[],E=[];gf(t),qd(m,t);let I=t.length;u.forEach(gf);for(let J=0;J<u.length;J++)g.push(I),I+=u[J].length,qd(m,u[J]);const H=function(J,Y,K){K=K||2;let me,ge,Se,w,e,c,d,_=Y&&Y.length,S=_?Y[0]*K:J.length,L=_f(J,0,S,K,!0),k=[];if(!L||L.next===L.prev)return k;if(_&&(L=function(F,V,te,le){let ue,_e,Ee,$e,Le,Ne=[];for(ue=0,_e=V.length;ue<_e;ue++)Ee=V[ue]*le,$e=ue<_e-1?V[ue+1]*le:F.length,Le=_f(F,Ee,$e,le,!1),Le===Le.next&&(Le.steiner=!0),Ne.push(ka(Le));for(Ne.sort(ji),ue=0;ue<Ne.length;ue++)Gs(Ne[ue],te),te=Pu(te,te.next);return te}(J,Y,L,K)),J.length>80*K){me=Se=J[0],ge=w=J[1];for(let F=K;F<S;F+=K)e=J[F],c=J[F+1],e<me&&(me=e),c<ge&&(ge=c),e>Se&&(Se=e),c>w&&(w=c);d=Math.max(Se-me,w-ge),d=0!==d?1/d:0}return Oo(L,k,K,me,ge,d),k}(m,g);for(let J=0;J<H.length;J+=3)E.push(H.slice(J,J+3));return E}};function gf(t){const u=t.length;u>2&&t[u-1].equals(t[0])&&t.pop()}function qd(t,u){for(let m=0;m<u.length;m++)t.push(u[m].x),t.push(u[m].y)}function su(t,u){kr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:u},this.fromBufferGeometry(new rl(t,u)),this.mergeVertices()}function rl(t,u){hn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:u},t=Array.isArray(t)?t:[t];const m=this,g=[],E=[];for(let H=0,J=t.length;H<J;H++)I(t[H]);function I(H){const J=[],Y=void 0!==u.curveSegments?u.curveSegments:12,K=void 0!==u.steps?u.steps:1;let me=void 0!==u.depth?u.depth:100,ge=void 0===u.bevelEnabled||u.bevelEnabled,Se=void 0!==u.bevelThickness?u.bevelThickness:6,w=void 0!==u.bevelSize?u.bevelSize:Se-2,e=void 0!==u.bevelOffset?u.bevelOffset:0,c=void 0!==u.bevelSegments?u.bevelSegments:3;const d=u.extrudePath,_=void 0!==u.UVGenerator?u.UVGenerator:Zp;void 0!==u.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),me=u.amount);let S,L,k,F,V,te=!1;d&&(S=d.getSpacedPoints(K),te=!0,ge=!1,L=d.computeFrenetFrames(K,!1),k=new lt,F=new lt,V=new lt),ge||(c=0,Se=0,w=0,e=0);const le=H.extractPoints(Y);let ue=le.shape;const _e=le.holes;if(!Iu.isClockWise(ue)){ue=ue.reverse();for(let _t=0,zt=_e.length;_t<zt;_t++){const Rt=_e[_t];Iu.isClockWise(Rt)&&(_e[_t]=Rt.reverse())}}const Ee=Iu.triangulateShape(ue,_e),$e=ue;for(let _t=0,zt=_e.length;_t<zt;_t++)ue=ue.concat(_e[_t]);function Le(_t,zt,Rt){return zt||console.error("THREE.ExtrudeGeometry: vec does not exist"),zt.clone().multiplyScalar(Rt).add(_t)}const Ne=ue.length,We=Ee.length;function tt(_t,zt,Rt){let nn,en,Mn;const rt=_t.x-zt.x,ut=_t.y-zt.y,rn=Rt.x-_t.x,un=Rt.y-_t.y,gn=rt*rt+ut*ut;if(Math.abs(rt*un-ut*rn)>Number.EPSILON){const Jn=Math.sqrt(gn),Zn=Math.sqrt(rn*rn+un*un),cn=zt.x-ut/Jn,mt=zt.y+rt/Jn,Kt=((Rt.x-un/Zn-cn)*un-(Rt.y+rn/Zn-mt)*rn)/(rt*un-ut*rn);nn=cn+rt*Kt-_t.x,en=mt+ut*Kt-_t.y;const Vt=nn*nn+en*en;if(Vt<=2)return new En(nn,en);Mn=Math.sqrt(Vt/2)}else{let Jn=!1;rt>Number.EPSILON?rn>Number.EPSILON&&(Jn=!0):rt<-Number.EPSILON?rn<-Number.EPSILON&&(Jn=!0):Math.sign(ut)===Math.sign(un)&&(Jn=!0),Jn?(nn=-ut,en=rt,Mn=Math.sqrt(gn)):(nn=rt,en=ut,Mn=Math.sqrt(gn/2))}return new En(nn/Mn,en/Mn)}const Ze=[];for(let _t=0,zt=$e.length,Rt=zt-1,nn=_t+1;_t<zt;_t++,Rt++,nn++)Rt===zt&&(Rt=0),nn===zt&&(nn=0),Ze[_t]=tt($e[_t],$e[Rt],$e[nn]);const ot=[];let st,Ct=Ze.concat();for(let _t=0,zt=_e.length;_t<zt;_t++){const Rt=_e[_t];st=[];for(let nn=0,en=Rt.length,Mn=en-1,rt=nn+1;nn<en;nn++,Mn++,rt++)Mn===en&&(Mn=0),rt===en&&(rt=0),st[nn]=tt(Rt[nn],Rt[Mn],Rt[rt]);ot.push(st),Ct=Ct.concat(st)}for(let _t=0;_t<c;_t++){const zt=_t/c,Rt=Se*Math.cos(zt*Math.PI/2),nn=w*Math.sin(zt*Math.PI/2)+e;for(let en=0,Mn=$e.length;en<Mn;en++){const rt=Le($e[en],Ze[en],nn);nt(rt.x,rt.y,-Rt)}for(let en=0,Mn=_e.length;en<Mn;en++){const rt=_e[en];st=ot[en];for(let ut=0,rn=rt.length;ut<rn;ut++){const un=Le(rt[ut],st[ut],nn);nt(un.x,un.y,-Rt)}}}const Ft=w+e;for(let _t=0;_t<Ne;_t++){const zt=ge?Le(ue[_t],Ct[_t],Ft):ue[_t];te?(F.copy(L.normals[0]).multiplyScalar(zt.x),k.copy(L.binormals[0]).multiplyScalar(zt.y),V.copy(S[0]).add(F).add(k),nt(V.x,V.y,V.z)):nt(zt.x,zt.y,0)}for(let _t=1;_t<=K;_t++)for(let zt=0;zt<Ne;zt++){const Rt=ge?Le(ue[zt],Ct[zt],Ft):ue[zt];te?(F.copy(L.normals[_t]).multiplyScalar(Rt.x),k.copy(L.binormals[_t]).multiplyScalar(Rt.y),V.copy(S[_t]).add(F).add(k),nt(V.x,V.y,V.z)):nt(Rt.x,Rt.y,me/K*_t)}for(let _t=c-1;_t>=0;_t--){const zt=_t/c,Rt=Se*Math.cos(zt*Math.PI/2),nn=w*Math.sin(zt*Math.PI/2)+e;for(let en=0,Mn=$e.length;en<Mn;en++){const rt=Le($e[en],Ze[en],nn);nt(rt.x,rt.y,me+Rt)}for(let en=0,Mn=_e.length;en<Mn;en++){const rt=_e[en];st=ot[en];for(let ut=0,rn=rt.length;ut<rn;ut++){const un=Le(rt[ut],st[ut],nn);te?nt(un.x,un.y+S[K-1].y,S[K-1].x+Rt):nt(un.x,un.y,me+Rt)}}}function Qe(_t,zt){let Rt=_t.length;for(;--Rt>=0;){const nn=Rt;let en=Rt-1;en<0&&(en=_t.length-1);for(let Mn=0,rt=K+2*c;Mn<rt;Mn++){const ut=Ne*Mn,rn=Ne*(Mn+1);Yt(zt+nn+ut,zt+en+ut,zt+en+rn,zt+nn+rn)}}}function nt(_t,zt,Rt){J.push(_t),J.push(zt),J.push(Rt)}function Tt(_t,zt,Rt){ct(_t),ct(zt),ct(Rt);const nn=g.length/3,en=_.generateTopUV(m,g,nn-3,nn-2,nn-1);Lt(en[0]),Lt(en[1]),Lt(en[2])}function Yt(_t,zt,Rt,nn){ct(_t),ct(zt),ct(nn),ct(zt),ct(Rt),ct(nn);const en=g.length/3,Mn=_.generateSideWallUV(m,g,en-6,en-3,en-2,en-1);Lt(Mn[0]),Lt(Mn[1]),Lt(Mn[3]),Lt(Mn[1]),Lt(Mn[2]),Lt(Mn[3])}function ct(_t){g.push(J[3*_t+0]),g.push(J[3*_t+1]),g.push(J[3*_t+2])}function Lt(_t){E.push(_t.x),E.push(_t.y)}(function(){const _t=g.length/3;if(ge){let zt=0,Rt=Ne*zt;for(let nn=0;nn<We;nn++){const en=Ee[nn];Tt(en[2]+Rt,en[1]+Rt,en[0]+Rt)}zt=K+2*c,Rt=Ne*zt;for(let nn=0;nn<We;nn++){const en=Ee[nn];Tt(en[0]+Rt,en[1]+Rt,en[2]+Rt)}}else{for(let zt=0;zt<We;zt++){const Rt=Ee[zt];Tt(Rt[2],Rt[1],Rt[0])}for(let zt=0;zt<We;zt++){const Rt=Ee[zt];Tt(Rt[0]+Ne*K,Rt[1]+Ne*K,Rt[2]+Ne*K)}}m.addGroup(_t,g.length/3-_t,0)})(),function(){const _t=g.length/3;let zt=0;Qe($e,zt),zt+=$e.length;for(let Rt=0,nn=_e.length;Rt<nn;Rt++){const en=_e[Rt];Qe(en,zt),zt+=en.length}m.addGroup(_t,g.length/3-_t,1)}()}this.setAttribute("position",new Un(g,3)),this.setAttribute("uv",new Un(E,2)),this.computeVertexNormals()}(su.prototype=Object.create(kr.prototype)).constructor=su,su.prototype.toJSON=function(){const t=kr.prototype.toJSON.call(this);return au(this.parameters.shapes,this.parameters.options,t)},(rl.prototype=Object.create(hn.prototype)).constructor=rl,rl.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return au(this.parameters.shapes,this.parameters.options,t)};const Zp={generateTopUV:function(t,u,m,g,E){const J=u[3*g],Y=u[3*g+1],K=u[3*E],me=u[3*E+1];return[new En(u[3*m],u[3*m+1]),new En(J,Y),new En(K,me)]},generateSideWallUV:function(t,u,m,g,E,I){const H=u[3*m],J=u[3*m+1],Y=u[3*m+2],K=u[3*g],me=u[3*g+1],ge=u[3*g+2],Se=u[3*E],w=u[3*E+1],e=u[3*E+2],c=u[3*I],d=u[3*I+1],_=u[3*I+2];return Math.abs(J-me)<.01?[new En(H,1-Y),new En(K,1-ge),new En(Se,1-e),new En(c,1-_)]:[new En(J,1-Y),new En(me,1-ge),new En(w,1-e),new En(d,1-_)]}};function au(t,u,m){if(m.shapes=[],Array.isArray(t))for(let g=0,E=t.length;g<E;g++)m.shapes.push(t[g].uuid);else m.shapes.push(t.uuid);return void 0!==u.extrudePath&&(m.options.extrudePath=u.extrudePath.toJSON()),m}function eo(t,u){kr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:u},this.fromBufferGeometry(new Mr(t,u)),this.mergeVertices()}function Mr(t,u){const m=(u=u||{}).font;if(!m||!m.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new kr;const g=m.generateShapes(t,u.size);u.depth=void 0!==u.height?u.height:50,void 0===u.bevelThickness&&(u.bevelThickness=10),void 0===u.bevelSize&&(u.bevelSize=8),void 0===u.bevelEnabled&&(u.bevelEnabled=!1),rl.call(this,g,u),this.type="TextBufferGeometry"}function Yr(t,u,m,g,E,I,H){kr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:H},this.fromBufferGeometry(new Ou(t,u,m,g,E,I,H)),this.mergeVertices()}function Ou(t,u,m,g,E,I,H){hn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:H},t=t||1,u=Math.max(3,Math.floor(u)||8),m=Math.max(2,Math.floor(m)||6),g=void 0!==g?g:0,E=void 0!==E?E:2*Math.PI,I=void 0!==I?I:0,H=void 0!==H?H:Math.PI;const J=Math.min(I+H,Math.PI);let Y=0;const K=[],me=new lt,ge=new lt,Se=[],w=[],e=[],c=[];for(let d=0;d<=m;d++){const _=[],S=d/m;let L=0;0==d&&0==I?L=.5/u:d==m&&J==Math.PI&&(L=-.5/u);for(let k=0;k<=u;k++){const F=k/u;me.x=-t*Math.cos(g+F*E)*Math.sin(I+S*H),me.y=t*Math.cos(I+S*H),me.z=t*Math.sin(g+F*E)*Math.sin(I+S*H),w.push(me.x,me.y,me.z),ge.copy(me).normalize(),e.push(ge.x,ge.y,ge.z),c.push(F+L,1-S),_.push(Y++)}K.push(_)}for(let d=0;d<m;d++)for(let _=0;_<u;_++){const L=K[d][_],k=K[d+1][_],F=K[d+1][_+1];(0!==d||I>0)&&Se.push(K[d][_+1],L,F),(d!==m-1||J<Math.PI)&&Se.push(L,k,F)}this.setIndex(Se),this.setAttribute("position",new Un(w,3)),this.setAttribute("normal",new Un(e,3)),this.setAttribute("uv",new Un(c,2))}function ku(t,u,m,g,E,I){kr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},this.fromBufferGeometry(new lu(t,u,m,g,E,I)),this.mergeVertices()}function lu(t,u,m,g,E,I){hn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},t=t||.5,u=u||1,E=void 0!==E?E:0,I=void 0!==I?I:2*Math.PI,m=void 0!==m?Math.max(3,m):8;const H=[],J=[],Y=[],K=[];let me=t;const ge=(u-t)/(g=void 0!==g?Math.max(1,g):1),Se=new lt,w=new En;for(let e=0;e<=g;e++){for(let c=0;c<=m;c++){const d=E+c/m*I;Se.x=me*Math.cos(d),Se.y=me*Math.sin(d),J.push(Se.x,Se.y,Se.z),Y.push(0,0,1),w.x=(Se.x/u+1)/2,w.y=(Se.y/u+1)/2,K.push(w.x,w.y)}me+=ge}for(let e=0;e<g;e++){const c=e*(m+1);for(let d=0;d<m;d++){const _=d+c,L=_+m+1,k=_+m+2,F=_+1;H.push(_,L,F),H.push(L,k,F)}}this.setIndex(H),this.setAttribute("position",new Un(J,3)),this.setAttribute("normal",new Un(Y,3)),this.setAttribute("uv",new Un(K,2))}function Fa(t,u,m,g){kr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},this.fromBufferGeometry(new Fu(t,u,m,g)),this.mergeVertices()}function Fu(t,u,m,g){hn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},u=Math.floor(u)||12,m=m||0,g=g||2*Math.PI,g=er.clamp(g,0,2*Math.PI);const E=[],I=[],H=[],J=1/u,Y=new lt,K=new En;for(let me=0;me<=u;me++){const ge=m+me*J*g,Se=Math.sin(ge),w=Math.cos(ge);for(let e=0;e<=t.length-1;e++)Y.x=t[e].x*Se,Y.y=t[e].y,Y.z=t[e].x*w,I.push(Y.x,Y.y,Y.z),K.x=me/u,K.y=e/(t.length-1),H.push(K.x,K.y)}for(let me=0;me<u;me++)for(let ge=0;ge<t.length-1;ge++){const Se=ge+me*t.length,e=Se+t.length,c=Se+t.length+1,d=Se+1;E.push(Se,e,d),E.push(e,c,d)}if(this.setIndex(E),this.setAttribute("position",new Un(I,3)),this.setAttribute("uv",new Un(H,2)),this.computeVertexNormals(),g===2*Math.PI){const me=this.attributes.normal.array,ge=new lt,Se=new lt,w=new lt,e=u*t.length*3;for(let c=0,d=0;c<t.length;c++,d+=3)ge.x=me[d+0],ge.y=me[d+1],ge.z=me[d+2],Se.x=me[e+d+0],Se.y=me[e+d+1],Se.z=me[e+d+2],w.addVectors(ge,Se).normalize(),me[d+0]=me[e+d+0]=w.x,me[d+1]=me[e+d+1]=w.y,me[d+2]=me[e+d+2]=w.z}}function cu(t,u){kr.call(this),this.type="ShapeGeometry","object"==typeof u&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),u=u.curveSegments),this.parameters={shapes:t,curveSegments:u},this.fromBufferGeometry(new Xn(t,u)),this.mergeVertices()}function Xn(t,u){hn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:u},u=u||12;const m=[],g=[],E=[],I=[];let H=0,J=0;if(!1===Array.isArray(t))Y(t);else for(let K=0;K<t.length;K++)Y(t[K]),this.addGroup(H,J,K),H+=J,J=0;function Y(K){const me=g.length/3,ge=K.extractPoints(u);let Se=ge.shape;const w=ge.holes;!1===Iu.isClockWise(Se)&&(Se=Se.reverse());for(let c=0,d=w.length;c<d;c++){const _=w[c];!0===Iu.isClockWise(_)&&(w[c]=_.reverse())}const e=Iu.triangulateShape(Se,w);for(let c=0,d=w.length;c<d;c++)Se=Se.concat(w[c]);for(let c=0,d=Se.length;c<d;c++){const _=Se[c];g.push(_.x,_.y,0),E.push(0,0,1),I.push(_.x,_.y)}for(let c=0,d=e.length;c<d;c++){const _=e[c];m.push(_[0]+me,_[1]+me,_[2]+me),J+=3}}this.setIndex(m),this.setAttribute("position",new Un(g,3)),this.setAttribute("normal",new Un(E,3)),this.setAttribute("uv",new Un(I,2))}function Oi(t,u){if(u.shapes=[],Array.isArray(t))for(let m=0,g=t.length;m<g;m++)u.shapes.push(t[m].uuid);else u.shapes.push(t.uuid);return u}function Rh(t,u){hn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:u},u=void 0!==u?u:1;const m=[],g=Math.cos(er.DEG2RAD*u),E=[0,0],I={};let H,J,Y;const K=["a","b","c"];let me;t.isBufferGeometry?(me=new kr,me.fromBufferGeometry(t)):me=t.clone(),me.mergeVertices(),me.computeFaceNormals();const ge=me.vertices,Se=me.faces;for(let w=0,e=Se.length;w<e;w++){const c=Se[w];for(let d=0;d<3;d++)H=c[K[d]],J=c[K[(d+1)%3]],E[0]=Math.min(H,J),E[1]=Math.max(H,J),Y=E[0]+","+E[1],void 0===I[Y]?I[Y]={index1:E[0],index2:E[1],face1:w,face2:void 0}:I[Y].face2=w}for(Y in I){const w=I[Y];if(void 0===w.face2||Se[w.face1].normal.dot(Se[w.face2].normal)<=g){let e=ge[w.index1];m.push(e.x,e.y,e.z),e=ge[w.index2],m.push(e.x,e.y,e.z)}}this.setAttribute("position",new Un(m,3))}function Pn(t,u,m,g,E,I,H,J){kr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:H,thetaLength:J},this.fromBufferGeometry(new Do(t,u,m,g,E,I,H,J)),this.mergeVertices()}function Do(t,u,m,g,E,I,H,J){hn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:H,thetaLength:J};const Y=this;t=void 0!==t?t:1,u=void 0!==u?u:1,m=m||1,g=Math.floor(g)||8,E=Math.floor(E)||1,I=void 0!==I&&I,H=void 0!==H?H:0,J=void 0!==J?J:2*Math.PI;const K=[],me=[],ge=[],Se=[];let w=0;const e=[],c=m/2;let d=0;function _(S){let L,k;const F=new En,V=new lt;let te=0;const le=!0===S?t:u,ue=!0===S?1:-1;L=w;for(let _e=1;_e<=g;_e++)me.push(0,c*ue,0),ge.push(0,ue,0),Se.push(.5,.5),w++;k=w;for(let _e=0;_e<=g;_e++){const Ee=_e/g*J+H,$e=Math.cos(Ee),Le=Math.sin(Ee);V.x=le*Le,V.y=c*ue,V.z=le*$e,me.push(V.x,V.y,V.z),ge.push(0,ue,0),F.x=.5*$e+.5,F.y=.5*Le*ue+.5,Se.push(F.x,F.y),w++}for(let _e=0;_e<g;_e++){const Ee=L+_e,$e=k+_e;!0===S?K.push($e,$e+1,Ee):K.push($e+1,$e,Ee),te+=3}Y.addGroup(d,te,!0===S?1:2),d+=te}(function(){const S=new lt,L=new lt;let k=0;const F=(u-t)/m;for(let V=0;V<=E;V++){const te=[],le=V/E,ue=le*(u-t)+t;for(let _e=0;_e<=g;_e++){const Ee=_e/g,$e=Ee*J+H,Le=Math.sin($e),Ne=Math.cos($e);L.x=ue*Le,L.y=-le*m+c,L.z=ue*Ne,me.push(L.x,L.y,L.z),S.set(Le,F,Ne).normalize(),ge.push(S.x,S.y,S.z),Se.push(Ee,1-le),te.push(w++)}e.push(te)}for(let V=0;V<g;V++)for(let te=0;te<E;te++){const ue=e[te+1][V],_e=e[te+1][V+1],Ee=e[te][V+1];K.push(e[te][V],ue,Ee),K.push(ue,_e,Ee),k+=6}Y.addGroup(d,k,0),d+=k})(),!1===I&&(t>0&&_(!0),u>0&&_(!1)),this.setIndex(K),this.setAttribute("position",new Un(me,3)),this.setAttribute("normal",new Un(ge,3)),this.setAttribute("uv",new Un(Se,2))}function Gi(t,u,m,g,E,I,H){Pn.call(this,0,t,u,m,g,E,I,H),this.type="ConeGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:H}}function Qp(t,u,m,g,E,I,H){Do.call(this,0,t,u,m,g,E,I,H),this.type="ConeBufferGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:H}}function Ph(t,u,m,g){kr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},this.fromBufferGeometry(new Du(t,u,m,g)),this.mergeVertices()}function Du(t,u,m,g){hn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},t=t||1,u=void 0!==u?Math.max(3,u):8,m=void 0!==m?m:0,g=void 0!==g?g:2*Math.PI;const E=[],I=[],H=[],J=[],Y=new lt,K=new En;I.push(0,0,0),H.push(0,0,1),J.push(.5,.5);for(let me=0,ge=3;me<=u;me++,ge+=3){const Se=m+me/u*g;Y.x=t*Math.cos(Se),Y.y=t*Math.sin(Se),I.push(Y.x,Y.y,Y.z),H.push(0,0,1),K.x=(I[ge]/t+1)/2,K.y=(I[ge+1]/t+1)/2,J.push(K.x,K.y)}for(let me=1;me<=u;me++)E.push(me,me+1,0);this.setIndex(E),this.setAttribute("position",new Un(I,3)),this.setAttribute("normal",new Un(H,3)),this.setAttribute("uv",new Un(J,2))}(eo.prototype=Object.create(kr.prototype)).constructor=eo,(Mr.prototype=Object.create(rl.prototype)).constructor=Mr,(Yr.prototype=Object.create(kr.prototype)).constructor=Yr,(Ou.prototype=Object.create(hn.prototype)).constructor=Ou,(ku.prototype=Object.create(kr.prototype)).constructor=ku,(lu.prototype=Object.create(hn.prototype)).constructor=lu,(Fa.prototype=Object.create(kr.prototype)).constructor=Fa,(Fu.prototype=Object.create(hn.prototype)).constructor=Fu,(cu.prototype=Object.create(kr.prototype)).constructor=cu,cu.prototype.toJSON=function(){const t=kr.prototype.toJSON.call(this);return Oi(this.parameters.shapes,t)},(Xn.prototype=Object.create(hn.prototype)).constructor=Xn,Xn.prototype.toJSON=function(){const t=hn.prototype.toJSON.call(this);return Oi(this.parameters.shapes,t)},(Rh.prototype=Object.create(hn.prototype)).constructor=Rh,(Pn.prototype=Object.create(kr.prototype)).constructor=Pn,(Do.prototype=Object.create(hn.prototype)).constructor=Do,(Gi.prototype=Object.create(Pn.prototype)).constructor=Gi,(Qp.prototype=Object.create(Do.prototype)).constructor=Qp,(Ph.prototype=Object.create(kr.prototype)).constructor=Ph,(Du.prototype=Object.create(hn.prototype)).constructor=Du;var na=Object.freeze({__proto__:null,WireframeGeometry:hc,ParametricGeometry:hh,ParametricBufferGeometry:Fc,TetrahedronGeometry:Ru,TetrahedronBufferGeometry:ph,OctahedronGeometry:Bh,OctahedronBufferGeometry:zs,IcosahedronGeometry:Dl,IcosahedronBufferGeometry:xa,DodecahedronGeometry:Ul,DodecahedronBufferGeometry:zl,PolyhedronGeometry:Nu,PolyhedronBufferGeometry:bs,TubeGeometry:jl,TubeBufferGeometry:Is,TorusKnotGeometry:Nh,TorusKnotBufferGeometry:Co,TorusGeometry:rp,TorusBufferGeometry:ou,TextGeometry:eo,TextBufferGeometry:Mr,SphereGeometry:Yr,SphereBufferGeometry:Ou,RingGeometry:ku,RingBufferGeometry:lu,PlaneGeometry:Ka,PlaneBufferGeometry:Il,LatheGeometry:Fa,LatheBufferGeometry:Fu,ShapeGeometry:cu,ShapeBufferGeometry:Xn,ExtrudeGeometry:su,ExtrudeBufferGeometry:rl,EdgesGeometry:Rh,ConeGeometry:Gi,ConeBufferGeometry:Qp,CylinderGeometry:Pn,CylinderBufferGeometry:Do,CircleGeometry:Ph,CircleBufferGeometry:Du,BoxGeometry:Ls,BoxBufferGeometry:lh});function Qi(t){Ur.call(this),this.type="ShadowMaterial",this.color=new ar(0),this.transparent=!0,this.setValues(t)}function ra(t){co.call(this,t),this.type="RawShaderMaterial"}function yl(t){Ur.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ar(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new En(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function oo(t){yl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new En(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function Ko(t){Ur.call(this),this.type="MeshPhongMaterial",this.color=new ar(16777215),this.specular=new ar(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new En(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function xs(t){Ur.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ar(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new En(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function uo(t){Ur.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new En(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function qo(t){Ur.call(this),this.type="MeshLambertMaterial",this.color=new ar(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ar(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Kr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function rs(t){Ur.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ar(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Me,this.normalScale=new En(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function wa(t){$o.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(Qi.prototype=Object.create(Ur.prototype)).constructor=Qi,Qi.prototype.isShadowMaterial=!0,Qi.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this},(ra.prototype=Object.create(co.prototype)).constructor=ra,ra.prototype.isRawShaderMaterial=!0,(yl.prototype=Object.create(Ur.prototype)).constructor=yl,yl.prototype.isMeshStandardMaterial=!0,yl.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},(oo.prototype=Object.create(yl.prototype)).constructor=oo,oo.prototype.isMeshPhysicalMaterial=!0,oo.prototype.copy=function(t){return yl.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new ar).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},(Ko.prototype=Object.create(Ur.prototype)).constructor=Ko,Ko.prototype.isMeshPhongMaterial=!0,Ko.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(xs.prototype=Object.create(Ur.prototype)).constructor=xs,xs.prototype.isMeshToonMaterial=!0,xs.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(uo.prototype=Object.create(Ur.prototype)).constructor=uo,uo.prototype.isMeshNormalMaterial=!0,uo.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(qo.prototype=Object.create(Ur.prototype)).constructor=qo,qo.prototype.isMeshLambertMaterial=!0,qo.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(rs.prototype=Object.create(Ur.prototype)).constructor=rs,rs.prototype.isMeshMatcapMaterial=!0,rs.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(wa.prototype=Object.create($o.prototype)).constructor=wa,wa.prototype.isLineDashedMaterial=!0,wa.prototype.copy=function(t){return $o.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Ih=Object.freeze({__proto__:null,ShadowMaterial:Qi,SpriteMaterial:_i,RawShaderMaterial:ra,ShaderMaterial:co,PointsMaterial:kl,MeshPhysicalMaterial:oo,MeshStandardMaterial:yl,MeshPhongMaterial:Ko,MeshToonMaterial:xs,MeshNormalMaterial:uo,MeshLambertMaterial:qo,MeshDepthMaterial:np,MeshDistanceMaterial:Ks,MeshBasicMaterial:Ki,MeshMatcapMaterial:rs,LineDashedMaterial:wa,LineBasicMaterial:$o,Material:Ur});const so={arraySlice:function(t,u,m){return so.isTypedArray(t)?new t.constructor(t.subarray(u,void 0!==m?m:t.length)):t.slice(u,m)},convertArray:function(t,u,m){return!t||!m&&t.constructor===u?t:"number"==typeof u.BYTES_PER_ELEMENT?new u(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const u=t.length,m=new Array(u);for(let g=0;g!==u;++g)m[g]=g;return m.sort(function(g,E){return t[g]-t[E]}),m},sortedArray:function(t,u,m){const g=t.length,E=new t.constructor(g);for(let I=0,H=0;H!==g;++I){const J=m[I]*u;for(let Y=0;Y!==u;++Y)E[H++]=t[J+Y]}return E},flattenJSON:function(t,u,m,g){let E=1,I=t[0];for(;void 0!==I&&void 0===I[g];)I=t[E++];if(void 0===I)return;let H=I[g];if(void 0!==H)if(Array.isArray(H))do{H=I[g],void 0!==H&&(u.push(I.time),m.push.apply(m,H)),I=t[E++]}while(void 0!==I);else if(void 0!==H.toArray)do{H=I[g],void 0!==H&&(u.push(I.time),H.toArray(m,m.length)),I=t[E++]}while(void 0!==I);else do{H=I[g],void 0!==H&&(u.push(I.time),m.push(H)),I=t[E++]}while(void 0!==I)},subclip:function(t,u,m,g,E){E=E||30;const I=t.clone();I.name=u;const H=[];for(let Y=0;Y<I.tracks.length;++Y){const K=I.tracks[Y],me=K.getValueSize(),ge=[],Se=[];for(let w=0;w<K.times.length;++w){const e=K.times[w]*E;if(!(e<m||e>=g)){ge.push(K.times[w]);for(let c=0;c<me;++c)Se.push(K.values[w*me+c])}}0!==ge.length&&(K.times=so.convertArray(ge,K.times.constructor),K.values=so.convertArray(Se,K.values.constructor),H.push(K))}I.tracks=H;let J=1/0;for(let Y=0;Y<I.tracks.length;++Y)J>I.tracks[Y].times[0]&&(J=I.tracks[Y].times[0]);for(let Y=0;Y<I.tracks.length;++Y)I.tracks[Y].shift(-1*J);return I.resetDuration(),I},makeClipAdditive:function(t,u,m,g){void 0===u&&(u=0),void 0===m&&(m=t),(void 0===g||g<=0)&&(g=30);const E=t.tracks.length,I=u/g;for(let H=0;H<E;++H){const J=m.tracks[H],Y=J.ValueTypeName;if("bool"===Y||"string"===Y)continue;const K=t.tracks.find(function(e){return e.name===J.name&&e.ValueTypeName===Y});if(void 0===K)continue;const me=J.getValueSize(),ge=J.times.length-1;let Se;if(I<=J.times[0])Se=so.arraySlice(J.values,0,J.valueSize);else if(I>=J.times[ge])Se=so.arraySlice(J.values,ge*me);else{const e=J.createInterpolant();e.evaluate(I),Se=e.resultBuffer}"quaternion"===Y&&new vo(Se[0],Se[1],Se[2],Se[3]).normalize().conjugate().toArray(Se);const w=K.times.length;for(let e=0;e<w;++e){const c=e*me;if("quaternion"===Y)vo.multiplyQuaternionsFlat(K.values,c,Se,0,K.values,c);else for(let d=0;d<me;++d)K.values[c+d]-=Se[d]}}return t.blendMode=th,t}};function Sa(t,u,m,g){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==g?g:new u.constructor(m),this.sampleValues=u,this.valueSize=m}function xl(t,u,m,g){Sa.call(this,t,u,m,g),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function uu(t,u,m,g){Sa.call(this,t,u,m,g)}function Da(t,u,m,g){Sa.call(this,t,u,m,g)}function as(t,u,m,g){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===u||0===u.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=so.convertArray(u,this.TimeBufferType),this.values=so.convertArray(m,this.ValueBufferType),this.setInterpolation(g||this.DefaultInterpolation)}function Kp(t,u,m){as.call(this,t,u,m)}function wl(t,u,m,g){as.call(this,t,u,m,g)}function Gl(t,u,m,g){as.call(this,t,u,m,g)}function Uu(t,u,m,g){Sa.call(this,t,u,m,g)}function ho(t,u,m,g){as.call(this,t,u,m,g)}function dh(t,u,m,g){as.call(this,t,u,m,g)}function hu(t,u,m,g){as.call(this,t,u,m,g)}function ls(t,u,m,g){this.name=t,this.tracks=m,this.duration=void 0!==u?u:-1,this.blendMode=void 0!==g?g:eh,this.uuid=er.generateUUID(),this.duration<0&&this.resetDuration()}function Hi(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const u=function(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Gl;case"vector":case"vector2":case"vector3":case"vector4":return hu;case"color":return wl;case"quaternion":return ho;case"bool":case"boolean":return Kp;case"string":return dh}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}(t.type);if(void 0===t.times){const m=[],g=[];so.flattenJSON(t.keys,m,g,"value"),t.times=m,t.values=g}return void 0!==u.parse?u.parse(t):new u(t.name,t.times,t.values,t.interpolation)}Object.assign(Sa.prototype,{evaluate:function(t){let u=this.parameterPositions,m=this._cachedIndex,g=u[m],E=u[m-1];e:{t:{let I;n:{r:if(!(t<g)){for(let H=m+2;;){if(void 0===g){if(t<E)break r;return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,t,E)}if(m===H)break;if(E=g,g=u[++m],t<g)break t}I=u.length;break n}if(t>=E)break e;{const H=u[1];t<H&&(m=2,E=H);for(let J=m-2;;){if(void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(m===J)break;if(g=E,E=u[--m-1],t>=E)break t}I=m,m=0}}for(;m<I;){const H=m+I>>>1;t<u[H]?I=H:m=H+1}if(g=u[m],E=u[m-1],void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(void 0===g)return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,E,t)}this._cachedIndex=m,this.intervalChanged_(m,E,g)}return this.interpolate_(m,E,t,g)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const u=this.resultBuffer,m=this.sampleValues,g=this.valueSize,E=t*g;for(let I=0;I!==g;++I)u[I]=m[E+I];return u},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Sa.prototype,{beforeStart_:Sa.prototype.copySampleValue_,afterEnd_:Sa.prototype.copySampleValue_}),xl.prototype=Object.assign(Object.create(Sa.prototype),{constructor:xl,DefaultSettings_:{endingStart:$a,endingEnd:$a},intervalChanged_:function(t,u,m){let g=this.parameterPositions,E=t-2,I=t+1,H=g[E],J=g[I];if(void 0===H)switch(this.getSettings_().endingStart){case ua:E=t,H=2*u-m;break;case Al:E=g.length-2,H=u+g[E]-g[E+1];break;default:E=t,H=m}if(void 0===J)switch(this.getSettings_().endingEnd){case ua:I=t,J=2*m-u;break;case Al:I=1,J=m+g[1]-g[0];break;default:I=t-1,J=u}const Y=.5*(m-u),K=this.valueSize;this._weightPrev=Y/(u-H),this._weightNext=Y/(J-m),this._offsetPrev=E*K,this._offsetNext=I*K},interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,H=this.valueSize,J=t*H,Y=J-H,K=this._offsetPrev,me=this._offsetNext,ge=this._weightPrev,Se=this._weightNext,w=(m-u)/(g-u),e=w*w,c=e*w,d=-ge*c+2*ge*e-ge*w,_=(1+ge)*c+(-1.5-2*ge)*e+(-.5+ge)*w+1,S=(-1-Se)*c+(1.5+Se)*e+.5*w,L=Se*c-Se*e;for(let k=0;k!==H;++k)E[k]=d*I[K+k]+_*I[Y+k]+S*I[J+k]+L*I[me+k];return E}}),uu.prototype=Object.assign(Object.create(Sa.prototype),{constructor:uu,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,H=this.valueSize,J=t*H,Y=J-H,K=(m-u)/(g-u),me=1-K;for(let ge=0;ge!==H;++ge)E[ge]=I[Y+ge]*me+I[J+ge]*K;return E}}),Da.prototype=Object.assign(Object.create(Sa.prototype),{constructor:Da,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(as,{toJSON:function(t){const u=t.constructor;let m;if(void 0!==u.toJSON)m=u.toJSON(t);else{m={name:t.name,times:so.convertArray(t.times,Array),values:so.convertArray(t.values,Array)};const g=t.getInterpolation();g!==t.DefaultInterpolation&&(m.interpolation=g)}return m.type=t.ValueTypeName,m}}),Object.assign(as.prototype,{constructor:as,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Zl,InterpolantFactoryMethodDiscrete:function(t){return new Da(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new uu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new xl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let u;switch(t){case Jl:u=this.InterpolantFactoryMethodDiscrete;break;case Zl:u=this.InterpolantFactoryMethodLinear;break;case Ku:u=this.InterpolantFactoryMethodSmooth}if(void 0===u){const m="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(m);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",m),this}return this.createInterpolant=u,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jl;case this.InterpolantFactoryMethodLinear:return Zl;case this.InterpolantFactoryMethodSmooth:return Ku}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]+=t}return this},scale:function(t){if(1!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]*=t}return this},trim:function(t,u){const m=this.times,g=m.length;let E=0,I=g-1;for(;E!==g&&m[E]<t;)++E;for(;-1!==I&&m[I]>u;)--I;if(++I,0!==E||I!==g){E>=I&&(I=Math.max(I,1),E=I-1);const H=this.getValueSize();this.times=so.arraySlice(m,E,I),this.values=so.arraySlice(this.values,E*H,I*H)}return this},validate:function(){let t=!0;const u=this.getValueSize();u-Math.floor(u)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const m=this.times,g=this.values,E=m.length;0===E&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let I=null;for(let H=0;H!==E;H++){const J=m[H];if("number"==typeof J&&isNaN(J)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,H,J),t=!1;break}if(null!==I&&I>J){console.error("THREE.KeyframeTrack: Out of order keys.",this,H,J,I),t=!1;break}I=J}if(void 0!==g&&so.isTypedArray(g))for(let H=0,J=g.length;H!==J;++H){const Y=g[H];if(isNaN(Y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,H,Y),t=!1;break}}return t},optimize:function(){const t=so.arraySlice(this.times),u=so.arraySlice(this.values),m=this.getValueSize(),g=this.getInterpolation()===Ku,E=t.length-1;let I=1;for(let H=1;H<E;++H){let J=!1;const Y=t[H];if(Y!==t[H+1]&&(1!==H||Y!==Y[0]))if(g)J=!0;else{const K=H*m,me=K-m,ge=K+m;for(let Se=0;Se!==m;++Se){const w=u[K+Se];if(w!==u[me+Se]||w!==u[ge+Se]){J=!0;break}}}if(J){if(H!==I){t[I]=t[H];const K=H*m,me=I*m;for(let ge=0;ge!==m;++ge)u[me+ge]=u[K+ge]}++I}}if(E>0){t[I]=t[E];for(let H=E*m,J=I*m,Y=0;Y!==m;++Y)u[J+Y]=u[H+Y];++I}return I!==t.length?(this.times=so.arraySlice(t,0,I),this.values=so.arraySlice(u,0,I*m)):(this.times=t,this.values=u),this},clone:function(){const t=so.arraySlice(this.times,0),u=so.arraySlice(this.values,0),m=new this.constructor(this.name,t,u);return m.createInterpolant=this.createInterpolant,m}}),Kp.prototype=Object.assign(Object.create(as.prototype),{constructor:Kp,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Jl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),wl.prototype=Object.assign(Object.create(as.prototype),{constructor:wl,ValueTypeName:"color"}),Gl.prototype=Object.assign(Object.create(as.prototype),{constructor:Gl,ValueTypeName:"number"}),Uu.prototype=Object.assign(Object.create(Sa.prototype),{constructor:Uu,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,H=this.valueSize,J=(m-u)/(g-u);let Y=t*H;for(let K=Y+H;Y!==K;Y+=4)vo.slerpFlat(E,0,I,Y-H,I,Y,J);return E}}),ho.prototype=Object.assign(Object.create(as.prototype),{constructor:ho,ValueTypeName:"quaternion",DefaultInterpolation:Zl,InterpolantFactoryMethodLinear:function(t){return new Uu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),dh.prototype=Object.assign(Object.create(as.prototype),{constructor:dh,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Jl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),hu.prototype=Object.assign(Object.create(as.prototype),{constructor:hu,ValueTypeName:"vector"}),Object.assign(ls,{parse:function(t){const u=[],m=t.tracks,g=1/(t.fps||1);for(let E=0,I=m.length;E!==I;++E)u.push(Hi(m[E]).scale(g));return new ls(t.name,t.duration,u,t.blendMode)},toJSON:function(t){const u=[],m=t.tracks,g={name:t.name,duration:t.duration,tracks:u,uuid:t.uuid,blendMode:t.blendMode};for(let E=0,I=m.length;E!==I;++E)u.push(as.toJSON(m[E]));return g},CreateFromMorphTargetSequence:function(t,u,m,g){const E=u.length,I=[];for(let H=0;H<E;H++){let J=[],Y=[];J.push((H+E-1)%E,H,(H+1)%E),Y.push(0,1,0);const K=so.getKeyframeOrder(J);J=so.sortedArray(J,1,K),Y=so.sortedArray(Y,1,K),g||0!==J[0]||(J.push(E),Y.push(Y[0])),I.push(new Gl(".morphTargetInfluences["+u[H].name+"]",J,Y).scale(1/m))}return new ls(t,-1,I)},findByName:function(t,u){let m=t;Array.isArray(t)||(m=t.geometry&&t.geometry.animations||t.animations);for(let g=0;g<m.length;g++)if(m[g].name===u)return m[g];return null},CreateClipsFromMorphTargetSequences:function(t,u,m){const g={},E=/^([\w-]*?)([\d]+)$/;for(let H=0,J=t.length;H<J;H++){const Y=t[H],K=Y.name.match(E);if(K&&K.length>1){const me=K[1];let ge=g[me];ge||(g[me]=ge=[]),ge.push(Y)}}const I=[];for(const H in g)I.push(ls.CreateFromMorphTargetSequence(H,g[H],u,m));return I},parseAnimation:function(t,u){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const m=function(K,me,ge,Se,w){if(0!==ge.length){const e=[],c=[];so.flattenJSON(ge,e,c,Se),0!==e.length&&w.push(new K(me,e,c))}},g=[],E=t.name||"default",I=t.fps||30,H=t.blendMode;let J=t.length||-1;const Y=t.hierarchy||[];for(let K=0;K<Y.length;K++){const me=Y[K].keys;if(me&&0!==me.length)if(me[0].morphTargets){const ge={};let Se;for(Se=0;Se<me.length;Se++)if(me[Se].morphTargets)for(let w=0;w<me[Se].morphTargets.length;w++)ge[me[Se].morphTargets[w]]=-1;for(const w in ge){const e=[],c=[];for(let d=0;d!==me[Se].morphTargets.length;++d){const _=me[Se];e.push(_.time),c.push(_.morphTarget===w?1:0)}g.push(new Gl(".morphTargetInfluence["+w+"]",e,c))}J=ge.length*(I||1)}else{const ge=".bones["+u[K].name+"]";m(hu,ge+".position",me,"pos",g),m(ho,ge+".quaternion",me,"rot",g),m(hu,ge+".scale",me,"scl",g)}}return 0===g.length?null:new ls(E,J,g,H)}}),Object.assign(ls.prototype,{resetDuration:function(){let t=0;for(let u=0,m=this.tracks.length;u!==m;++u){const g=this.tracks[u];t=Math.max(t,g.times[g.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let u=0;u<this.tracks.length;u++)t=t&&this.tracks[u].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let u=0;u<this.tracks.length;u++)t.push(this.tracks[u].clone());return new ls(this.name,this.duration,t,this.blendMode)}});const ws={enabled:!1,files:{},add:function(t,u){!1!==this.enabled&&(this.files[t]=u)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Xd(t,u,m){const g=this;let E,I=!1,H=0,J=0;const Y=[];this.onStart=void 0,this.onLoad=t,this.onProgress=u,this.onError=m,this.itemStart=function(K){J++,!1===I&&void 0!==g.onStart&&g.onStart(K,H,J),I=!0},this.itemEnd=function(K){H++,void 0!==g.onProgress&&g.onProgress(K,H,J),H===J&&(I=!1,void 0!==g.onLoad&&g.onLoad())},this.itemError=function(K){void 0!==g.onError&&g.onError(K)},this.resolveURL=function(K){return E?E(K):K},this.setURLModifier=function(K){return E=K,this},this.addHandler=function(K,me){return Y.push(K,me),this},this.removeHandler=function(K){const me=Y.indexOf(K);return-1!==me&&Y.splice(me,2),this},this.getHandler=function(K){for(let me=0,ge=Y.length;me<ge;me+=2){const Se=Y[me],w=Y[me+1];if(Se.global&&(Se.lastIndex=0),Se.test(K))return w}return null}}const Yd=new Xd;function Ti(t){this.manager=void 0!==t?t:Yd,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ti.prototype,{load:function(){},loadAsync:function(t,u){const m=this;return new Promise(function(g,E){m.load(t,g,u,E)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const dc={};function Ss(t){Ti.call(this,t)}function ed(t){Ti.call(this,t)}function td(t){Ti.call(this,t)}function Ua(t){Ti.call(this,t)}function pu(t){Ti.call(this,t)}function sp(t){Ti.call(this,t)}function vi(t){Ti.call(this,t)}function xr(){this.type="Curve",this.arcLengthDivisions=200}function a(t,u,m,g,E,I,H,J){xr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=u||0,this.xRadius=m||1,this.yRadius=g||1,this.aStartAngle=E||0,this.aEndAngle=I||2*Math.PI,this.aClockwise=H||!1,this.aRotation=J||0}function r(t,u,m,g,E,I){a.call(this,t,u,m,m,g,E,I),this.type="ArcCurve"}function h(){let t=0,u=0,m=0,g=0;function E(I,H,J,Y){t=I,u=J,m=-3*I+3*H-2*J-Y,g=2*I-2*H+J+Y}return{initCatmullRom:function(I,H,J,Y,K){E(H,J,K*(J-I),K*(Y-H))},initNonuniformCatmullRom:function(I,H,J,Y,K,me,ge){let Se=(H-I)/K-(J-I)/(K+me)+(J-H)/me,w=(J-H)/me-(Y-H)/(me+ge)+(Y-J)/ge;Se*=me,w*=me,E(H,J,Se,w)},calc:function(I){const H=I*I;return t+u*I+m*H+g*(H*I)}}}Ss.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Ss,load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ws.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;if(void 0!==dc[t])return void dc[t].push({onLoad:u,onProgress:m,onError:g});const H=t.match(/^data:(.*?)(;base64)?,(.*)$/);let J;if(H){const Y=H[1],K=!!H[2];let me=H[3];me=decodeURIComponent(me),K&&(me=atob(me));try{let ge;const Se=(this.responseType||"").toLowerCase();switch(Se){case"arraybuffer":case"blob":const w=new Uint8Array(me.length);for(let c=0;c<me.length;c++)w[c]=me.charCodeAt(c);ge="blob"===Se?new Blob([w.buffer],{type:Y}):w.buffer;break;case"document":ge=(new DOMParser).parseFromString(me,Y);break;case"json":ge=JSON.parse(me);break;default:ge=me}setTimeout(function(){u&&u(ge),E.manager.itemEnd(t)},0)}catch(ge){setTimeout(function(){g&&g(ge),E.manager.itemError(t),E.manager.itemEnd(t)},0)}}else{dc[t]=[],dc[t].push({onLoad:u,onProgress:m,onError:g}),J=new XMLHttpRequest,J.open("GET",t,!0),J.addEventListener("load",function(Y){const K=this.response,me=dc[t];if(delete dc[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),ws.add(t,K);for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge];w.onLoad&&w.onLoad(K)}E.manager.itemEnd(t)}else{for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge];w.onError&&w.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)}},!1),J.addEventListener("progress",function(Y){const K=dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onProgress&&Se.onProgress(Y)}},!1),J.addEventListener("error",function(Y){const K=dc[t];delete dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onError&&Se.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),J.addEventListener("abort",function(Y){const K=dc[t];delete dc[t];for(let me=0,ge=K.length;me<ge;me++){const Se=K[me];Se.onError&&Se.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),void 0!==this.responseType&&(J.responseType=this.responseType),void 0!==this.withCredentials&&(J.withCredentials=this.withCredentials),J.overrideMimeType&&J.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const Y in this.requestHeader)J.setRequestHeader(Y,this.requestHeader[Y]);J.send(null)}return E.manager.itemStart(t),J},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),ed.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ed,load:function(t,u,m,g){const E=this,I=new Ss(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(H){try{u(E.parse(JSON.parse(H)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u=[];for(let m=0;m<t.length;m++){const g=ls.parse(t[m]);u.push(g)}return u}}),td.prototype=Object.assign(Object.create(Ti.prototype),{constructor:td,load:function(t,u,m,g){const E=this,I=[],H=new uc;H.image=I;const J=new Ss(this.manager);J.setPath(this.path),J.setResponseType("arraybuffer"),J.setRequestHeader(this.requestHeader);let Y=0;function K(me){J.load(t[me],function(ge){const Se=E.parse(ge,!0);I[me]={width:Se.width,height:Se.height,format:Se.format,mipmaps:Se.mipmaps},Y+=1,6===Y&&(1===Se.mipmapCount&&(H.minFilter=ai),H.format=Se.format,H.needsUpdate=!0,u&&u(H))},m,g)}if(Array.isArray(t))for(let me=0,ge=t.length;me<ge;++me)K(me);else J.load(t,function(me){const ge=E.parse(me,!0);if(ge.isCubemap){const Se=ge.mipmaps.length/ge.mipmapCount;for(let w=0;w<Se;w++){I[w]={mipmaps:[]};for(let e=0;e<ge.mipmapCount;e++)I[w].mipmaps.push(ge.mipmaps[w*ge.mipmapCount+e]),I[w].format=ge.format,I[w].width=ge.width,I[w].height=ge.height}}else H.image.width=ge.width,H.image.height=ge.height,H.mipmaps=ge.mipmaps;1===ge.mipmapCount&&(H.minFilter=ai),H.format=ge.format,H.needsUpdate=!0,u&&u(H)},m,g);return H}}),Ua.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Ua,load:function(t,u,m,g){const E=this,I=new gl,H=new Ss(this.manager);return H.setResponseType("arraybuffer"),H.setRequestHeader(this.requestHeader),H.setPath(this.path),H.load(t,function(J){const Y=E.parse(J);Y&&(void 0!==Y.image?I.image=Y.image:void 0!==Y.data&&(I.image.width=Y.width,I.image.height=Y.height,I.image.data=Y.data),I.wrapS=void 0!==Y.wrapS?Y.wrapS:Jr,I.wrapT=void 0!==Y.wrapT?Y.wrapT:Jr,I.magFilter=void 0!==Y.magFilter?Y.magFilter:ai,I.minFilter=void 0!==Y.minFilter?Y.minFilter:ai,I.anisotropy=void 0!==Y.anisotropy?Y.anisotropy:1,void 0!==Y.format&&(I.format=Y.format),void 0!==Y.type&&(I.type=Y.type),void 0!==Y.mipmaps&&(I.mipmaps=Y.mipmaps,I.minFilter=sl),1===Y.mipmapCount&&(I.minFilter=ai),I.needsUpdate=!0,u&&u(I,Y))},m,g),I}}),pu.prototype=Object.assign(Object.create(Ti.prototype),{constructor:pu,load:function(t,u,m,g){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ws.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;const H=document.createElementNS("http://www.w3.org/1999/xhtml","img");function J(){H.removeEventListener("load",J,!1),H.removeEventListener("error",Y,!1),ws.add(t,this),u&&u(this),E.manager.itemEnd(t)}function Y(K){H.removeEventListener("load",J,!1),H.removeEventListener("error",Y,!1),g&&g(K),E.manager.itemError(t),E.manager.itemEnd(t)}return H.addEventListener("load",J,!1),H.addEventListener("error",Y,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(H.crossOrigin=this.crossOrigin),E.manager.itemStart(t),H.src=t,H}}),sp.prototype=Object.assign(Object.create(Ti.prototype),{constructor:sp,load:function(t,u,m,g){const E=new Qs,I=new pu(this.manager);I.setCrossOrigin(this.crossOrigin),I.setPath(this.path);let H=0;function J(Y){I.load(t[Y],function(K){E.images[Y]=K,H++,6===H&&(E.needsUpdate=!0,u&&u(E))},void 0,g)}for(let Y=0;Y<t.length;++Y)J(Y);return E}}),vi.prototype=Object.assign(Object.create(Ti.prototype),{constructor:vi,load:function(t,u,m,g){const E=new di,I=new pu(this.manager);return I.setCrossOrigin(this.crossOrigin),I.setPath(this.path),I.load(t,function(H){E.image=H;const J=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);E.format=J?Os:ao,E.needsUpdate=!0,void 0!==u&&u(E)},m,g),E}}),Object.assign(xr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,u){const m=this.getUtoTmapping(t);return this.getPoint(m,u)},getPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return u},getSpacedPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPointAt(m/t));return u},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const u=[];let m,g=this.getPoint(0),E=0;u.push(0);for(let I=1;I<=t;I++)m=this.getPoint(I/t),E+=m.distanceTo(g),u.push(E),g=m;return this.cacheArcLengths=u,u},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,u){const m=this.getLengths();let g,E=0,I=m.length;g=u||t*m[I-1];let H,J=0,Y=I-1;for(;J<=Y;)if(E=Math.floor(J+(Y-J)/2),H=m[E]-g,H<0)J=E+1;else{if(!(H>0)){Y=E;break}Y=E-1}if(E=Y,m[E]===g)return E/(I-1);const K=m[E];return(E+(g-K)/(m[E+1]-K))/(I-1)},getTangent:function(t,u){let g=t-1e-4,E=t+1e-4;g<0&&(g=0),E>1&&(E=1);const I=this.getPoint(g),H=this.getPoint(E),J=u||(I.isVector2?new En:new lt);return J.copy(H).sub(I).normalize(),J},getTangentAt:function(t,u){const m=this.getUtoTmapping(t);return this.getTangent(m,u)},computeFrenetFrames:function(t,u){const m=new lt,g=[],E=[],I=[],H=new lt,J=new ri;for(let Se=0;Se<=t;Se++)g[Se]=this.getTangentAt(Se/t,new lt),g[Se].normalize();E[0]=new lt,I[0]=new lt;let Y=Number.MAX_VALUE;const K=Math.abs(g[0].x),me=Math.abs(g[0].y),ge=Math.abs(g[0].z);K<=Y&&(Y=K,m.set(1,0,0)),me<=Y&&(Y=me,m.set(0,1,0)),ge<=Y&&m.set(0,0,1),H.crossVectors(g[0],m).normalize(),E[0].crossVectors(g[0],H),I[0].crossVectors(g[0],E[0]);for(let Se=1;Se<=t;Se++){if(E[Se]=E[Se-1].clone(),I[Se]=I[Se-1].clone(),H.crossVectors(g[Se-1],g[Se]),H.length()>Number.EPSILON){H.normalize();const w=Math.acos(er.clamp(g[Se-1].dot(g[Se]),-1,1));E[Se].applyMatrix4(J.makeRotationAxis(H,w))}I[Se].crossVectors(g[Se],E[Se])}if(!0===u){let Se=Math.acos(er.clamp(E[0].dot(E[t]),-1,1));Se/=t,g[0].dot(H.crossVectors(E[0],E[t]))>0&&(Se=-Se);for(let w=1;w<=t;w++)E[w].applyMatrix4(J.makeRotationAxis(g[w],Se*w)),I[w].crossVectors(g[w],E[w])}return{tangents:g,normals:E,binormals:I}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(a.prototype=Object.create(xr.prototype)).constructor=a,a.prototype.isEllipseCurve=!0,a.prototype.getPoint=function(t,u){const m=u||new En,g=2*Math.PI;let E=this.aEndAngle-this.aStartAngle;const I=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=g;for(;E>g;)E-=g;E<Number.EPSILON&&(E=I?0:g),!0!==this.aClockwise||I||(E===g?E=-g:E-=g);const H=this.aStartAngle+t*E;let J=this.aX+this.xRadius*Math.cos(H),Y=this.aY+this.yRadius*Math.sin(H);if(0!==this.aRotation){const K=Math.cos(this.aRotation),me=Math.sin(this.aRotation),ge=J-this.aX,Se=Y-this.aY;J=ge*K-Se*me+this.aX,Y=ge*me+Se*K+this.aY}return m.set(J,Y)},a.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},a.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},a.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(r.prototype=Object.create(a.prototype)).constructor=r,r.prototype.isArcCurve=!0;const p=new lt,y=new h,b=new h,N=new h;function O(t,u,m,g){xr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=u||!1,this.curveType=m||"centripetal",this.tension=void 0!==g?g:.5}function T(t,u,m,g,E){const I=.5*(g-u),H=.5*(E-m),J=t*t;return(2*m-2*g+I+H)*(t*J)+(-3*m+3*g-2*I-H)*J+I*t+m}function z(t,u,m,g){return function(E,I){const H=1-E;return H*H*I}(t,u)+2*(1-(E=t))*E*m+function(E,I){return E*E*I}(t,g);var E}function ee(t,u,m,g,E){return function(I,H){const J=1-I;return J*J*J*H}(t,u)+function(I,H){const J=1-I;return 3*J*J*I*H}(t,m)+3*(1-(I=t))*I*I*g+function(I,H){return I*I*I*H}(t,E);var I}function oe(t,u,m,g){xr.call(this),this.type="CubicBezierCurve",this.v0=t||new En,this.v1=u||new En,this.v2=m||new En,this.v3=g||new En}function ne(t,u,m,g){xr.call(this),this.type="CubicBezierCurve3",this.v0=t||new lt,this.v1=u||new lt,this.v2=m||new lt,this.v3=g||new lt}function ve(t,u){xr.call(this),this.type="LineCurve",this.v1=t||new En,this.v2=u||new En}function xe(t,u){xr.call(this),this.type="LineCurve3",this.v1=t||new lt,this.v2=u||new lt}function Te(t,u,m){xr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new En,this.v1=u||new En,this.v2=m||new En}function Ce(t,u,m){xr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new lt,this.v1=u||new lt,this.v2=m||new lt}function Ie(t){xr.call(this),this.type="SplineCurve",this.points=t||[]}(O.prototype=Object.create(xr.prototype)).constructor=O,O.prototype.isCatmullRomCurve3=!0,O.prototype.getPoint=function(t,u){const m=u||new lt,g=this.points,E=g.length,I=(E-(this.closed?0:1))*t;let H,J,Y,K,me=Math.floor(I),ge=I-me;if(this.closed?me+=me>0?0:(Math.floor(Math.abs(me)/E)+1)*E:0===ge&&me===E-1&&(me=E-2,ge=1),this.closed||me>0?H=g[(me-1)%E]:(p.subVectors(g[0],g[1]).add(g[0]),H=p),J=g[me%E],Y=g[(me+1)%E],this.closed||me+2<E?K=g[(me+2)%E]:(p.subVectors(g[E-1],g[E-2]).add(g[E-1]),K=p),"centripetal"===this.curveType||"chordal"===this.curveType){const Se="chordal"===this.curveType?.5:.25;let w=Math.pow(H.distanceToSquared(J),Se),e=Math.pow(J.distanceToSquared(Y),Se),c=Math.pow(Y.distanceToSquared(K),Se);e<1e-4&&(e=1),w<1e-4&&(w=e),c<1e-4&&(c=e),y.initNonuniformCatmullRom(H.x,J.x,Y.x,K.x,w,e,c),b.initNonuniformCatmullRom(H.y,J.y,Y.y,K.y,w,e,c),N.initNonuniformCatmullRom(H.z,J.z,Y.z,K.z,w,e,c)}else"catmullrom"===this.curveType&&(y.initCatmullRom(H.x,J.x,Y.x,K.x,this.tension),b.initCatmullRom(H.y,J.y,Y.y,K.y,this.tension),N.initCatmullRom(H.z,J.z,Y.z,K.z,this.tension));return m.set(y.calc(ge),b.calc(ge),N.calc(ge)),m},O.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},O.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},O.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new lt).fromArray(g))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(oe.prototype=Object.create(xr.prototype)).constructor=oe,oe.prototype.isCubicBezierCurve=!0,oe.prototype.getPoint=function(t,u){const m=u||new En,g=this.v0,E=this.v1,I=this.v2,H=this.v3;return m.set(ee(t,g.x,E.x,I.x,H.x),ee(t,g.y,E.y,I.y,H.y)),m},oe.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},oe.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},oe.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ne.prototype=Object.create(xr.prototype)).constructor=ne,ne.prototype.isCubicBezierCurve3=!0,ne.prototype.getPoint=function(t,u){const m=u||new lt,g=this.v0,E=this.v1,I=this.v2,H=this.v3;return m.set(ee(t,g.x,E.x,I.x,H.x),ee(t,g.y,E.y,I.y,H.y),ee(t,g.z,E.z,I.z,H.z)),m},ne.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ne.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ne.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ve.prototype=Object.create(xr.prototype)).constructor=ve,ve.prototype.isLineCurve=!0,ve.prototype.getPoint=function(t,u){const m=u||new En;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},ve.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},ve.prototype.getTangent=function(t,u){const m=u||new En;return m.copy(this.v2).sub(this.v1).normalize(),m},ve.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ve.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ve.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(xe.prototype=Object.create(xr.prototype)).constructor=xe,xe.prototype.isLineCurve3=!0,xe.prototype.getPoint=function(t,u){const m=u||new lt;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},xe.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},xe.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},xe.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},xe.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Te.prototype=Object.create(xr.prototype)).constructor=Te,Te.prototype.isQuadraticBezierCurve=!0,Te.prototype.getPoint=function(t,u){const m=u||new En,g=this.v0,E=this.v1,I=this.v2;return m.set(z(t,g.x,E.x,I.x),z(t,g.y,E.y,I.y)),m},Te.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Te.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Te.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Ce.prototype=Object.create(xr.prototype)).constructor=Ce,Ce.prototype.isQuadraticBezierCurve3=!0,Ce.prototype.getPoint=function(t,u){const m=u||new lt,g=this.v0,E=this.v1,I=this.v2;return m.set(z(t,g.x,E.x,I.x),z(t,g.y,E.y,I.y),z(t,g.z,E.z,I.z)),m},Ce.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ce.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ce.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Ie.prototype=Object.create(xr.prototype)).constructor=Ie,Ie.prototype.isSplineCurve=!0,Ie.prototype.getPoint=function(t,u){const m=u||new En,g=this.points,E=(g.length-1)*t,I=Math.floor(E),H=E-I,J=g[0===I?I:I-1],Y=g[I],K=g[I>g.length-2?g.length-1:I+1],me=g[I>g.length-3?g.length-1:I+2];return m.set(T(H,J.x,Y.x,K.x,me.x),T(H,J.y,Y.y,K.y,me.y)),m},Ie.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this},Ie.prototype.toJSON=function(){const t=xr.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t},Ie.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new En).fromArray(g))}return this};var Oe=Object.freeze({__proto__:null,ArcCurve:r,CatmullRomCurve3:O,CubicBezierCurve:oe,CubicBezierCurve3:ne,EllipseCurve:a,LineCurve:ve,LineCurve3:xe,QuadraticBezierCurve:Te,QuadraticBezierCurve3:Ce,SplineCurve:Ie});function Fe(){xr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function je(t){Fe.call(this),this.type="Path",this.currentPoint=new En,t&&this.setFromPoints(t)}function Ue(t){je.call(this,t),this.uuid=er.generateUUID(),this.type="Shape",this.holes=[]}function Ye(t,u){Qn.call(this),this.type="Light",this.color=new ar(t),this.intensity=void 0!==u?u:1,this.receiveShadow=void 0}function at(t,u,m){Ye.call(this,t,m),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Qn.DefaultUp),this.updateMatrix(),this.groundColor=new ar(u)}function pt(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new En(512,512),this.map=null,this.mapPass=null,this.matrix=new ri,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new eu,this._frameExtents=new En(1,1),this._viewportCount=1,this._viewports=[new xi(0,0,1,1)]}function St(){pt.call(this,new Ns(50,1,.5,500))}function At(t,u,m,g,E,I){Ye.call(this,t,u),this.type="SpotLight",this.position.copy(Qn.DefaultUp),this.updateMatrix(),this.target=new Qn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(H){this.intensity=H/Math.PI}}),this.distance=void 0!==m?m:0,this.angle=void 0!==g?g:Math.PI/3,this.penumbra=void 0!==E?E:0,this.decay=void 0!==I?I:1,this.shadow=new St}function Jt(){pt.call(this,new Ns(90,1,.5,500)),this._frameExtents=new En(4,2),this._viewportCount=6,this._viewports=[new xi(2,1,1,1),new xi(0,1,1,1),new xi(3,1,1,1),new xi(1,1,1,1),new xi(3,0,1,1),new xi(1,0,1,1)],this._cubeDirections=[new lt(1,0,0),new lt(-1,0,0),new lt(0,0,1),new lt(0,0,-1),new lt(0,1,0),new lt(0,-1,0)],this._cubeUps=[new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,0,1),new lt(0,0,-1)]}function jt(t,u,m,g){Ye.call(this,t,u),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(E){this.intensity=E/(4*Math.PI)}}),this.distance=void 0!==m?m:0,this.decay=void 0!==g?g:1,this.shadow=new Jt}function Pt(t,u,m,g,E,I){Ai.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==u?u:1,this.top=void 0!==m?m:1,this.bottom=void 0!==g?g:-1,this.near=void 0!==E?E:.1,this.far=void 0!==I?I:2e3,this.updateProjectionMatrix()}function Nt(){pt.call(this,new Pt(-5,5,5,-5,.5,500))}function ft(t,u){Ye.call(this,t,u),this.type="DirectionalLight",this.position.copy(Qn.DefaultUp),this.updateMatrix(),this.target=new Qn,this.shadow=new Nt}function $t(t,u){Ye.call(this,t,u),this.type="AmbientLight",this.castShadow=void 0}function Zt(t,u,m,g){Ye.call(this,t,u),this.type="RectAreaLight",this.width=void 0!==m?m:10,this.height=void 0!==g?g:10}function _n(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new lt)}function xn(t,u){Ye.call(this,void 0,u),this.type="LightProbe",this.sh=void 0!==t?t:new _n}function wr(t){Ti.call(this,t),this.textures={}}Fe.prototype=Object.assign(Object.create(xr.prototype),{constructor:Fe,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);t.equals(u)||this.curves.push(new ve(u,t))},getPoint:function(t){const u=t*this.getLength(),m=this.getCurveLengths();let g=0;for(;g<m.length;){if(m[g]>=u){const E=m[g]-u,I=this.curves[g],H=I.getLength();return I.getPointAt(0===H?0:1-E/H)}g++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let u=0;for(let m=0,g=this.curves.length;m<g;m++)u+=this.curves[m].getLength(),t.push(u);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return this.autoClose&&u.push(u[0]),u},getPoints:function(t){t=t||12;const u=[];let m;for(let g=0,E=this.curves;g<E.length;g++){const I=E[g],J=I.getPoints(I&&I.isEllipseCurve?2*t:I&&(I.isLineCurve||I.isLineCurve3)?1:I&&I.isSplineCurve?t*I.points.length:t);for(let Y=0;Y<J.length;Y++){const K=J[Y];m&&m.equals(K)||(u.push(K),m=K)}}return this.autoClose&&u.length>1&&!u[u.length-1].equals(u[0])&&u.push(u[0]),u},copy:function(t){xr.prototype.copy.call(this,t),this.curves=[];for(let u=0,m=t.curves.length;u<m;u++)this.curves.push(t.curves[u].clone());return this.autoClose=t.autoClose,this},toJSON:function(){const t=xr.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let u=0,m=this.curves.length;u<m;u++)t.curves.push(this.curves[u].toJSON());return t},fromJSON:function(t){xr.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let u=0,m=t.curves.length;u<m;u++){const g=t.curves[u];this.curves.push((new Oe[g.type]).fromJSON(g))}return this}}),je.prototype=Object.assign(Object.create(Fe.prototype),{constructor:je,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let u=1,m=t.length;u<m;u++)this.lineTo(t[u].x,t[u].y);return this},moveTo:function(t,u){return this.currentPoint.set(t,u),this},lineTo:function(t,u){const m=new ve(this.currentPoint.clone(),new En(t,u));return this.curves.push(m),this.currentPoint.set(t,u),this},quadraticCurveTo:function(t,u,m,g){const E=new Te(this.currentPoint.clone(),new En(t,u),new En(m,g));return this.curves.push(E),this.currentPoint.set(m,g),this},bezierCurveTo:function(t,u,m,g,E,I){const H=new oe(this.currentPoint.clone(),new En(t,u),new En(m,g),new En(E,I));return this.curves.push(H),this.currentPoint.set(E,I),this},splineThru:function(t){const u=new Ie([this.currentPoint.clone()].concat(t));return this.curves.push(u),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,u,m,g,E,I){return this.absarc(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I),this},absarc:function(t,u,m,g,E,I){return this.absellipse(t,u,m,m,g,E,I),this},ellipse:function(t,u,m,g,E,I,H,J){return this.absellipse(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I,H,J),this},absellipse:function(t,u,m,g,E,I,H,J){const Y=new a(t,u,m,g,E,I,H,J);if(this.curves.length>0){const me=Y.getPoint(0);me.equals(this.currentPoint)||this.lineTo(me.x,me.y)}this.curves.push(Y);const K=Y.getPoint(1);return this.currentPoint.copy(K),this},copy:function(t){return Fe.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Fe.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Fe.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Ue.prototype=Object.assign(Object.create(je.prototype),{constructor:Ue,getPointsHoles:function(t){const u=[];for(let m=0,g=this.holes.length;m<g;m++)u[m]=this.holes[m].getPoints(t);return u},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){je.prototype.copy.call(this,t),this.holes=[];for(let u=0,m=t.holes.length;u<m;u++)this.holes.push(t.holes[u].clone());return this},toJSON:function(){const t=je.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let u=0,m=this.holes.length;u<m;u++)t.holes.push(this.holes[u].toJSON());return t},fromJSON:function(t){je.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let u=0,m=t.holes.length;u<m;u++){const g=t.holes[u];this.holes.push((new je).fromJSON(g))}return this}}),Ye.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Ye,isLight:!0,copy:function(t){return Qn.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const u=Qn.prototype.toJSON.call(this,t);return u.object.color=this.color.getHex(),u.object.intensity=this.intensity,void 0!==this.groundColor&&(u.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(u.object.distance=this.distance),void 0!==this.angle&&(u.object.angle=this.angle),void 0!==this.decay&&(u.object.decay=this.decay),void 0!==this.penumbra&&(u.object.penumbra=this.penumbra),void 0!==this.shadow&&(u.object.shadow=this.shadow.toJSON()),u}}),at.prototype=Object.assign(Object.create(Ye.prototype),{constructor:at,isHemisphereLight:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(pt.prototype,{_projScreenMatrix:new ri,_lightPositionWorld:new lt,_lookTarget:new lt,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const u=this.camera,m=this.matrix,g=this._projScreenMatrix,E=this._lookTarget,I=this._lightPositionWorld;I.setFromMatrixPosition(t.matrixWorld),u.position.copy(I),E.setFromMatrixPosition(t.target.matrixWorld),u.lookAt(E),u.updateMatrixWorld(),g.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(u.projectionMatrix),m.multiply(u.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),St.prototype=Object.assign(Object.create(pt.prototype),{constructor:St,isSpotLightShadow:!0,updateMatrices:function(t){const u=this.camera,m=2*er.RAD2DEG*t.angle,g=this.mapSize.width/this.mapSize.height,E=t.distance||u.far;m===u.fov&&g===u.aspect&&E===u.far||(u.fov=m,u.aspect=g,u.far=E,u.updateProjectionMatrix()),pt.prototype.updateMatrices.call(this,t)}}),At.prototype=Object.assign(Object.create(Ye.prototype),{constructor:At,isSpotLight:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Jt.prototype=Object.assign(Object.create(pt.prototype),{constructor:Jt,isPointLightShadow:!0,updateMatrices:function(t,u){void 0===u&&(u=0);const m=this.camera,g=this.matrix,E=this._lightPositionWorld,I=this._lookTarget,H=this._projScreenMatrix;E.setFromMatrixPosition(t.matrixWorld),m.position.copy(E),I.copy(m.position),I.add(this._cubeDirections[u]),m.up.copy(this._cubeUps[u]),m.lookAt(I),m.updateMatrixWorld(),g.makeTranslation(-E.x,-E.y,-E.z),H.multiplyMatrices(m.projectionMatrix,m.matrixWorldInverse),this._frustum.setFromProjectionMatrix(H)}}),jt.prototype=Object.assign(Object.create(Ye.prototype),{constructor:jt,isPointLight:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),Pt.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Pt,isOrthographicCamera:!0,copy:function(t,u){return Ai.prototype.copy.call(this,t,u),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,u,m,g,E,I){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),m=(this.right+this.left)/2,g=(this.top+this.bottom)/2;let E=m-t,I=m+t,H=g+u,J=g-u;if(null!==this.view&&this.view.enabled){const Y=(this.right-this.left)/this.view.fullWidth/this.zoom,K=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=Y*this.view.offsetX,I=E+Y*this.view.width,H-=K*this.view.offsetY,J=H-K*this.view.height}this.projectionMatrix.makeOrthographic(E,I,H,J,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=Qn.prototype.toJSON.call(this,t);return u.object.zoom=this.zoom,u.object.left=this.left,u.object.right=this.right,u.object.top=this.top,u.object.bottom=this.bottom,u.object.near=this.near,u.object.far=this.far,null!==this.view&&(u.object.view=Object.assign({},this.view)),u}}),Nt.prototype=Object.assign(Object.create(pt.prototype),{constructor:Nt,isDirectionalLightShadow:!0,updateMatrices:function(t){pt.prototype.updateMatrices.call(this,t)}}),ft.prototype=Object.assign(Object.create(Ye.prototype),{constructor:ft,isDirectionalLight:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),$t.prototype=Object.assign(Object.create(Ye.prototype),{constructor:$t,isAmbientLight:!0}),Zt.prototype=Object.assign(Object.create(Ye.prototype),{constructor:Zt,isRectAreaLight:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const u=Ye.prototype.toJSON.call(this,t);return u.object.width=this.width,u.object.height=this.height,u}}),Object.assign(_n.prototype,{isSphericalHarmonics3:!0,set:function(t){for(let u=0;u<9;u++)this.coefficients[u].copy(t[u]);return this},zero:function(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.282095),u.addScaledVector(I[1],.488603*g),u.addScaledVector(I[2],.488603*E),u.addScaledVector(I[3],.488603*m),u.addScaledVector(I[4],m*g*1.092548),u.addScaledVector(I[5],g*E*1.092548),u.addScaledVector(I[6],.315392*(3*E*E-1)),u.addScaledVector(I[7],m*E*1.092548),u.addScaledVector(I[8],.546274*(m*m-g*g)),u},getIrradianceAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.886227),u.addScaledVector(I[1],1.023328*g),u.addScaledVector(I[2],1.023328*E),u.addScaledVector(I[3],1.023328*m),u.addScaledVector(I[4],.858086*m*g),u.addScaledVector(I[5],.858086*g*E),u.addScaledVector(I[6],.743125*E*E-.247708),u.addScaledVector(I[7],.858086*m*E),u.addScaledVector(I[8],.429043*(m*m-g*g)),u},add:function(t){for(let u=0;u<9;u++)this.coefficients[u].add(t.coefficients[u]);return this},addScaledSH:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].addScaledVector(t.coefficients[m],u);return this},scale:function(t){for(let u=0;u<9;u++)this.coefficients[u].multiplyScalar(t);return this},lerp:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].lerp(t.coefficients[m],u);return this},equals:function(t){for(let u=0;u<9;u++)if(!this.coefficients[u].equals(t.coefficients[u]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,u){void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].fromArray(t,u+3*g);return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].toArray(t,u+3*g);return t}}),Object.assign(_n,{getBasisAt:function(t,u){const m=t.x,g=t.y,E=t.z;u[0]=.282095,u[1]=.488603*g,u[2]=.488603*E,u[3]=.488603*m,u[4]=1.092548*m*g,u[5]=1.092548*g*E,u[6]=.315392*(3*E*E-1),u[7]=1.092548*m*E,u[8]=.546274*(m*m-g*g)}}),xn.prototype=Object.assign(Object.create(Ye.prototype),{constructor:xn,isLightProbe:!0,copy:function(t){return Ye.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const u=Ye.prototype.toJSON.call(this,t);return u.object.sh=this.sh.toArray(),u}}),wr.prototype=Object.assign(Object.create(Ti.prototype),{constructor:wr,load:function(t,u,m,g){const E=this,I=new Ss(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(H){try{u(E.parse(JSON.parse(H)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u=this.textures;function m(E){return void 0===u[E]&&console.warn("THREE.MaterialLoader: Undefined texture",E),u[E]}const g=new Ih[t.type];if(void 0!==t.uuid&&(g.uuid=t.uuid),void 0!==t.name&&(g.name=t.name),void 0!==t.color&&g.color.setHex(t.color),void 0!==t.roughness&&(g.roughness=t.roughness),void 0!==t.metalness&&(g.metalness=t.metalness),void 0!==t.sheen&&(g.sheen=(new ar).setHex(t.sheen)),void 0!==t.emissive&&g.emissive.setHex(t.emissive),void 0!==t.specular&&g.specular.setHex(t.specular),void 0!==t.shininess&&(g.shininess=t.shininess),void 0!==t.clearcoat&&(g.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(g.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(g.fog=t.fog),void 0!==t.flatShading&&(g.flatShading=t.flatShading),void 0!==t.blending&&(g.blending=t.blending),void 0!==t.combine&&(g.combine=t.combine),void 0!==t.side&&(g.side=t.side),void 0!==t.opacity&&(g.opacity=t.opacity),void 0!==t.transparent&&(g.transparent=t.transparent),void 0!==t.alphaTest&&(g.alphaTest=t.alphaTest),void 0!==t.depthTest&&(g.depthTest=t.depthTest),void 0!==t.depthWrite&&(g.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(g.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(g.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(g.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(g.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(g.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(g.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(g.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(g.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(g.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(g.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(g.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(g.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(g.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(g.rotation=t.rotation),1!==t.linewidth&&(g.linewidth=t.linewidth),void 0!==t.dashSize&&(g.dashSize=t.dashSize),void 0!==t.gapSize&&(g.gapSize=t.gapSize),void 0!==t.scale&&(g.scale=t.scale),void 0!==t.polygonOffset&&(g.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(g.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(g.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(g.skinning=t.skinning),void 0!==t.morphTargets&&(g.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(g.morphNormals=t.morphNormals),void 0!==t.dithering&&(g.dithering=t.dithering),void 0!==t.vertexTangents&&(g.vertexTangents=t.vertexTangents),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.toneMapped&&(g.toneMapped=t.toneMapped),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.vertexColors&&(g.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const E in t.uniforms){const I=t.uniforms[E];switch(g.uniforms[E]={},I.type){case"t":g.uniforms[E].value=m(I.value);break;case"c":g.uniforms[E].value=(new ar).setHex(I.value);break;case"v2":g.uniforms[E].value=(new En).fromArray(I.value);break;case"v3":g.uniforms[E].value=(new lt).fromArray(I.value);break;case"v4":g.uniforms[E].value=(new xi).fromArray(I.value);break;case"m3":g.uniforms[E].value=(new Ho).fromArray(I.value);case"m4":g.uniforms[E].value=(new ri).fromArray(I.value);break;default:g.uniforms[E].value=I.value}}if(void 0!==t.defines&&(g.defines=t.defines),void 0!==t.vertexShader&&(g.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(g.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const E in t.extensions)g.extensions[E]=t.extensions[E];if(void 0!==t.shading&&(g.flatShading=1===t.shading),void 0!==t.size&&(g.size=t.size),void 0!==t.sizeAttenuation&&(g.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(g.map=m(t.map)),void 0!==t.matcap&&(g.matcap=m(t.matcap)),void 0!==t.alphaMap&&(g.alphaMap=m(t.alphaMap)),void 0!==t.bumpMap&&(g.bumpMap=m(t.bumpMap)),void 0!==t.bumpScale&&(g.bumpScale=t.bumpScale),void 0!==t.normalMap&&(g.normalMap=m(t.normalMap)),void 0!==t.normalMapType&&(g.normalMapType=t.normalMapType),void 0!==t.normalScale){let E=t.normalScale;!1===Array.isArray(E)&&(E=[E,E]),g.normalScale=(new En).fromArray(E)}return void 0!==t.displacementMap&&(g.displacementMap=m(t.displacementMap)),void 0!==t.displacementScale&&(g.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(g.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(g.roughnessMap=m(t.roughnessMap)),void 0!==t.metalnessMap&&(g.metalnessMap=m(t.metalnessMap)),void 0!==t.emissiveMap&&(g.emissiveMap=m(t.emissiveMap)),void 0!==t.emissiveIntensity&&(g.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(g.specularMap=m(t.specularMap)),void 0!==t.envMap&&(g.envMap=m(t.envMap)),void 0!==t.envMapIntensity&&(g.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(g.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(g.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(g.lightMap=m(t.lightMap)),void 0!==t.lightMapIntensity&&(g.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(g.aoMap=m(t.aoMap)),void 0!==t.aoMapIntensity&&(g.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(g.gradientMap=m(t.gradientMap)),void 0!==t.clearcoatMap&&(g.clearcoatMap=m(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap=m(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(g.clearcoatNormalMap=m(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(g.clearcoatNormalScale=(new En).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(g.transmission=t.transmission),void 0!==t.transmissionMap&&(g.transmissionMap=m(t.transmissionMap)),g},setTextures:function(t){return this.textures=t,this}});const ir={decodeText:function(t){if(typeof TextDecoder<"u")return(new TextDecoder).decode(t);let u="";for(let m=0,g=t.length;m<g;m++)u+=String.fromCharCode(t[m]);try{return decodeURIComponent(escape(u))}catch{return u}},extractUrlBase:function(t){const u=t.lastIndexOf("/");return-1===u?"./":t.substr(0,u+1)}};function Hn(){hn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function lr(t,u,m,g){"number"==typeof m&&(g=m,m=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Vr.call(this,t,u,m),this.meshPerAttribute=g||1}function Yn(t){Ti.call(this,t)}Hn.prototype=Object.assign(Object.create(hn.prototype),{constructor:Hn,isInstancedBufferGeometry:!0,copy:function(t){return hn.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=hn.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),lr.prototype=Object.assign(Object.create(Vr.prototype),{constructor:lr,isInstancedBufferAttribute:!0,copy:function(t){return Vr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Vr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Yn.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Yn,load:function(t,u,m,g){const E=this,I=new Ss(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(H){try{u(E.parse(JSON.parse(H)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u={},m={};function g(me,ge){if(void 0!==u[ge])return u[ge];const Se=me.interleavedBuffers[ge],w=function(c,d){if(void 0!==m[d])return m[d];const S=new Uint32Array(c.arrayBuffers[d]).buffer;return m[d]=S,S}(me,Se.buffer),e=new Pa(new fr[Se.type](w),Se.stride);return e.uuid=Se.uuid,u[ge]=e,e}const E=t.isInstancedBufferGeometry?new Hn:new hn,I=t.data.index;if(void 0!==I){const me=new fr[I.type](I.array);E.setIndex(new Vr(me,1))}const H=t.data.attributes;for(const me in H){const ge=H[me];let Se;if(ge.isInterleavedBufferAttribute)Se=new Lh(g(t.data,ge.data),ge.itemSize,ge.offset,ge.normalized);else{const w=new fr[ge.type](ge.array);Se=new(ge.isInstancedBufferAttribute?lr:Vr)(w,ge.itemSize,ge.normalized)}void 0!==ge.name&&(Se.name=ge.name),E.setAttribute(me,Se)}const J=t.data.morphAttributes;if(J)for(const me in J){const ge=J[me],Se=[];for(let w=0,e=ge.length;w<e;w++){const c=ge[w];let d;d=c.isInterleavedBufferAttribute?new Lh(g(t.data,c.data),c.itemSize,c.offset,c.normalized):new Vr(new fr[c.type](c.array),c.itemSize,c.normalized),void 0!==c.name&&(d.name=c.name),Se.push(d)}E.morphAttributes[me]=Se}t.data.morphTargetsRelative&&(E.morphTargetsRelative=!0);const Y=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==Y)for(let me=0,ge=Y.length;me!==ge;++me){const Se=Y[me];E.addGroup(Se.start,Se.count,Se.materialIndex)}const K=t.data.boundingSphere;if(void 0!==K){const me=new lt;void 0!==K.center&&me.fromArray(K.center),E.boundingSphere=new jn(me,K.radius)}return t.name&&(E.name=t.name),t.userData&&(E.userData=t.userData),E}});const fr={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function zr(t){Ti.call(this,t)}zr.prototype=Object.assign(Object.create(Ti.prototype),{constructor:zr,load:function(t,u,m,g){const E=this,I=""===this.path?ir.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||I;const H=new Ss(E.manager);H.setPath(this.path),H.setRequestHeader(this.requestHeader),H.load(t,function(J){let Y=null;try{Y=JSON.parse(J)}catch(me){return void 0!==g&&g(me),void console.error("THREE:ObjectLoader: Can't parse "+t+".",me.message)}const K=Y.metadata;void 0!==K&&void 0!==K.type&&"geometry"!==K.type.toLowerCase()?E.parse(Y,u):console.error("THREE.ObjectLoader: Can't load "+t)},m,g)},parse:function(t,u){const m=this.parseShape(t.shapes),g=this.parseGeometries(t.geometries,m),E=this.parseImages(t.images,function(){void 0!==u&&u(J)}),I=this.parseTextures(t.textures,E),H=this.parseMaterials(t.materials,I),J=this.parseObject(t.object,g,H);return t.animations&&(J.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==u&&u(J),J},parseShape:function(t){const u={};if(void 0!==t)for(let m=0,g=t.length;m<g;m++){const E=(new Ue).fromJSON(t[m]);u[E.uuid]=E}return u},parseGeometries:function(t,u){const m={};let g;if(void 0!==t){const E=new Yn;for(let I=0,H=t.length;I<H;I++){let J;const Y=t[I];switch(Y.type){case"PlaneGeometry":case"PlaneBufferGeometry":J=new na[Y.type](Y.width,Y.height,Y.widthSegments,Y.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":J=new na[Y.type](Y.width,Y.height,Y.depth,Y.widthSegments,Y.heightSegments,Y.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":J=new na[Y.type](Y.radius,Y.segments,Y.thetaStart,Y.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":J=new na[Y.type](Y.radiusTop,Y.radiusBottom,Y.height,Y.radialSegments,Y.heightSegments,Y.openEnded,Y.thetaStart,Y.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":J=new na[Y.type](Y.radius,Y.height,Y.radialSegments,Y.heightSegments,Y.openEnded,Y.thetaStart,Y.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":J=new na[Y.type](Y.radius,Y.widthSegments,Y.heightSegments,Y.phiStart,Y.phiLength,Y.thetaStart,Y.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":J=new na[Y.type](Y.radius,Y.detail);break;case"RingGeometry":case"RingBufferGeometry":J=new na[Y.type](Y.innerRadius,Y.outerRadius,Y.thetaSegments,Y.phiSegments,Y.thetaStart,Y.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":J=new na[Y.type](Y.radius,Y.tube,Y.radialSegments,Y.tubularSegments,Y.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":J=new na[Y.type](Y.radius,Y.tube,Y.tubularSegments,Y.radialSegments,Y.p,Y.q);break;case"TubeGeometry":case"TubeBufferGeometry":J=new na[Y.type]((new Oe[Y.path.type]).fromJSON(Y.path),Y.tubularSegments,Y.radius,Y.radialSegments,Y.closed);break;case"LatheGeometry":case"LatheBufferGeometry":J=new na[Y.type](Y.points,Y.segments,Y.phiStart,Y.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":J=new na[Y.type](Y.vertices,Y.indices,Y.radius,Y.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":g=[];for(let me=0,ge=Y.shapes.length;me<ge;me++)g.push(u[Y.shapes[me]]);J=new na[Y.type](g,Y.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":g=[];for(let me=0,ge=Y.shapes.length;me<ge;me++)g.push(u[Y.shapes[me]]);const K=Y.options.extrudePath;void 0!==K&&(Y.options.extrudePath=(new Oe[K.type]).fromJSON(K)),J=new na[Y.type](g,Y.options);break;case"BufferGeometry":case"InstancedBufferGeometry":J=E.parse(Y);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Y.type+'"');continue}J.uuid=Y.uuid,void 0!==Y.name&&(J.name=Y.name),!0===J.isBufferGeometry&&void 0!==Y.userData&&(J.userData=Y.userData),m[Y.uuid]=J}}return m},parseMaterials:function(t,u){const m={},g={};if(void 0!==t){const E=new wr;E.setTextures(u);for(let I=0,H=t.length;I<H;I++){const J=t[I];if("MultiMaterial"===J.type){const Y=[];for(let K=0;K<J.materials.length;K++){const me=J.materials[K];void 0===m[me.uuid]&&(m[me.uuid]=E.parse(me)),Y.push(m[me.uuid])}g[J.uuid]=Y}else void 0===m[J.uuid]&&(m[J.uuid]=E.parse(J)),g[J.uuid]=m[J.uuid]}}return g},parseAnimations:function(t){const u=[];for(let m=0;m<t.length;m++){const g=t[m],E=ls.parse(g);void 0!==g.uuid&&(E.uuid=g.uuid),u.push(E)}return u},parseImages:function(t,u){const m=this,g={};let E;function I(H){return m.manager.itemStart(H),E.load(H,function(){m.manager.itemEnd(H)},void 0,function(){m.manager.itemError(H),m.manager.itemEnd(H)})}if(void 0!==t&&t.length>0){const H=new Xd(u);E=new pu(H),E.setCrossOrigin(this.crossOrigin);for(let J=0,Y=t.length;J<Y;J++){const K=t[J],me=K.url;if(Array.isArray(me)){g[K.uuid]=[];for(let ge=0,Se=me.length;ge<Se;ge++){const w=me[ge],e=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:m.resourcePath+w;g[K.uuid].push(I(e))}}else{const ge=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(K.url)?K.url:m.resourcePath+K.url;g[K.uuid]=I(ge)}}}return g},parseTextures:function(t,u){function m(E,I){return"number"==typeof E?E:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",E),I[E])}const g={};if(void 0!==t)for(let E=0,I=t.length;E<I;E++){const H=t[E];let J;void 0===H.image&&console.warn('THREE.ObjectLoader: No "image" specified for',H.uuid),void 0===u[H.image]&&console.warn("THREE.ObjectLoader: Undefined image",H.image),J=Array.isArray(u[H.image])?new Qs(u[H.image]):new di(u[H.image]),J.needsUpdate=!0,J.uuid=H.uuid,void 0!==H.name&&(J.name=H.name),void 0!==H.mapping&&(J.mapping=m(H.mapping,xo)),void 0!==H.offset&&J.offset.fromArray(H.offset),void 0!==H.repeat&&J.repeat.fromArray(H.repeat),void 0!==H.center&&J.center.fromArray(H.center),void 0!==H.rotation&&(J.rotation=H.rotation),void 0!==H.wrap&&(J.wrapS=m(H.wrap[0],po),J.wrapT=m(H.wrap[1],po)),void 0!==H.format&&(J.format=H.format),void 0!==H.type&&(J.type=H.type),void 0!==H.encoding&&(J.encoding=H.encoding),void 0!==H.minFilter&&(J.minFilter=m(H.minFilter,wo)),void 0!==H.magFilter&&(J.magFilter=m(H.magFilter,wo)),void 0!==H.anisotropy&&(J.anisotropy=H.anisotropy),void 0!==H.flipY&&(J.flipY=H.flipY),void 0!==H.premultiplyAlpha&&(J.premultiplyAlpha=H.premultiplyAlpha),void 0!==H.unpackAlignment&&(J.unpackAlignment=H.unpackAlignment),g[H.uuid]=J}return g},parseObject:function(t,u,m){let g,E,I;function H(Y){return void 0===u[Y]&&console.warn("THREE.ObjectLoader: Undefined geometry",Y),u[Y]}function J(Y){if(void 0!==Y){if(Array.isArray(Y)){const K=[];for(let me=0,ge=Y.length;me<ge;me++){const Se=Y[me];void 0===m[Se]&&console.warn("THREE.ObjectLoader: Undefined material",Se),K.push(m[Se])}return K}return void 0===m[Y]&&console.warn("THREE.ObjectLoader: Undefined material",Y),m[Y]}}switch(t.type){case"Scene":g=new Cl,void 0!==t.background&&Number.isInteger(t.background)&&(g.background=new ar(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?g.fog=new Xp(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(g.fog=new hf(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":g=new Ns(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(g.focus=t.focus),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.filmGauge&&(g.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(g.filmOffset=t.filmOffset),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"OrthographicCamera":g=new Pt(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"AmbientLight":g=new $t(t.color,t.intensity);break;case"DirectionalLight":g=new ft(t.color,t.intensity);break;case"PointLight":g=new jt(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":g=new Zt(t.color,t.intensity,t.width,t.height);break;case"SpotLight":g=new At(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":g=new at(t.color,t.groundColor,t.intensity);break;case"LightProbe":g=(new xn).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":E=H(t.geometry),I=J(t.material),g=new Ci(E,I);break;case"InstancedMesh":E=H(t.geometry),I=J(t.material);const K=t.instanceMatrix;g=new Zo(E,I,t.count),g.instanceMatrix=new Vr(new Float32Array(K.array),16);break;case"LOD":g=new Op;break;case"Line":g=new Us(H(t.geometry),J(t.material),t.mode);break;case"LineLoop":g=new Jp(H(t.geometry),J(t.material));break;case"LineSegments":g=new Ii(H(t.geometry),J(t.material));break;case"PointCloud":case"Points":g=new kc(H(t.geometry),J(t.material));break;case"Sprite":g=new nl(J(t.material));break;case"Group":g=new ba;break;default:g=new Qn}if(g.uuid=t.uuid,void 0!==t.name&&(g.name=t.name),void 0!==t.matrix?(g.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(g.matrixAutoUpdate=t.matrixAutoUpdate),g.matrixAutoUpdate&&g.matrix.decompose(g.position,g.quaternion,g.scale)):(void 0!==t.position&&g.position.fromArray(t.position),void 0!==t.rotation&&g.rotation.fromArray(t.rotation),void 0!==t.quaternion&&g.quaternion.fromArray(t.quaternion),void 0!==t.scale&&g.scale.fromArray(t.scale)),void 0!==t.castShadow&&(g.castShadow=t.castShadow),void 0!==t.receiveShadow&&(g.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(g.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(g.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(g.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&g.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(g.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.frustumCulled&&(g.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(g.renderOrder=t.renderOrder),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.layers&&(g.layers.mask=t.layers),void 0!==t.children){const Y=t.children;for(let K=0;K<Y.length;K++)g.add(this.parseObject(Y[K],u,m))}if("LOD"===t.type){void 0!==t.autoUpdate&&(g.autoUpdate=t.autoUpdate);const Y=t.levels;for(let K=0;K<Y.length;K++){const me=Y[K],ge=g.getObjectByProperty("uuid",me.object);void 0!==ge&&g.addLevel(ge,me.distance)}}return g}});const xo={UVMapping:yi,CubeReflectionMapping:Ei,CubeRefractionMapping:So,EquirectangularReflectionMapping:Ws,EquirectangularRefractionMapping:la,CubeUVReflectionMapping:Ni,CubeUVRefractionMapping:Eo},po={RepeatWrapping:go,ClampToEdgeWrapping:Jr,MirroredRepeatWrapping:os},wo={NearestFilter:Ir,NearestMipmapNearestFilter:Va,NearestMipmapLinearFilter:us,LinearFilter:ai,LinearMipmapNearestFilter:Gc,LinearMipmapLinearFilter:sl};function Uo(t){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ti.call(this,t),this.options={premultiplyAlpha:"none"}}function Hs(){this.type="ShapePath",this.color=new ar,this.subPaths=[],this.currentPath=null}function Vs(t){this.type="Font",this.data=t}function za(t,u,m,g,E){const I=E.glyphs[t]||E.glyphs["?"];if(!I)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+E.familyName+".");const H=new Hs;let J,Y,K,me,ge,Se,w,e;if(I.o){const c=I._cachedOutline||(I._cachedOutline=I.o.split(" "));for(let d=0,_=c.length;d<_;)switch(c[d++]){case"m":J=c[d++]*u+m,Y=c[d++]*u+g,H.moveTo(J,Y);break;case"l":J=c[d++]*u+m,Y=c[d++]*u+g,H.lineTo(J,Y);break;case"q":K=c[d++]*u+m,me=c[d++]*u+g,ge=c[d++]*u+m,Se=c[d++]*u+g,H.quadraticCurveTo(ge,Se,K,me);break;case"b":K=c[d++]*u+m,me=c[d++]*u+g,ge=c[d++]*u+m,Se=c[d++]*u+g,w=c[d++]*u+m,e=c[d++]*u+g,H.bezierCurveTo(ge,Se,w,e,K,me)}}return{offsetX:I.ha*u,path:H}}function ja(t){Ti.call(this,t)}let Ga;Uo.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Uo,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=ws.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;fetch(t).then(function(H){return H.blob()}).then(function(H){return createImageBitmap(H,E.options)}).then(function(H){ws.add(t,H),u&&u(H),E.manager.itemEnd(t)}).catch(function(H){g&&g(H),E.manager.itemError(t),E.manager.itemEnd(t)}),E.manager.itemStart(t)}}),Object.assign(Hs.prototype,{moveTo:function(t,u){return this.currentPath=new je,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,u),this},lineTo:function(t,u){return this.currentPath.lineTo(t,u),this},quadraticCurveTo:function(t,u,m,g){return this.currentPath.quadraticCurveTo(t,u,m,g),this},bezierCurveTo:function(t,u,m,g,E,I){return this.currentPath.bezierCurveTo(t,u,m,g,E,I),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,u){function m(_){const S=[];for(let L=0,k=_.length;L<k;L++){const F=_[L],V=new Ue;V.curves=F.curves,S.push(V)}return S}function g(_,S){const L=S.length;let k=!1;for(let F=L-1,V=0;V<L;F=V++){let te=S[F],le=S[V],ue=le.x-te.x,_e=le.y-te.y;if(Math.abs(_e)>Number.EPSILON){if(_e<0&&(te=S[V],ue=-ue,le=S[F],_e=-_e),_.y<te.y||_.y>le.y)continue;if(_.y===te.y){if(_.x===te.x)return!0}else{const Ee=_e*(_.x-te.x)-ue*(_.y-te.y);if(0===Ee)return!0;if(Ee<0)continue;k=!k}}else{if(_.y!==te.y)continue;if(le.x<=_.x&&_.x<=te.x||te.x<=_.x&&_.x<=le.x)return!0}}return k}const E=Iu.isClockWise,I=this.subPaths;if(0===I.length)return[];if(!0===u)return m(I);let H,J,Y,K=[];if(1===I.length)return J=I[0],Y=new Ue,Y.curves=J.curves,K.push(Y),K;let me=!E(I[0].getPoints());me=t?!me:me;const ge=[],Se=[];let w,e,c=[],d=0;Se[d]=void 0,c[d]=[];for(let _=0,S=I.length;_<S;_++)J=I[_],w=J.getPoints(),H=E(w),H=t?!H:H,H?(!me&&Se[d]&&d++,Se[d]={s:new Ue,p:w},Se[d].s.curves=J.curves,me&&d++,c[d]=[]):c[d].push({h:J,p:w[0]});if(!Se[0])return m(I);if(Se.length>1){let _=!1;const S=[];for(let L=0,k=Se.length;L<k;L++)ge[L]=[];for(let L=0,k=Se.length;L<k;L++){const F=c[L];for(let V=0;V<F.length;V++){const te=F[V];let le=!0;for(let ue=0;ue<Se.length;ue++)g(te.p,Se[ue].p)&&(L!==ue&&S.push({froms:L,tos:ue,hole:V}),le?(le=!1,ge[ue].push(te)):_=!0);le&&ge[L].push(te)}}S.length>0&&(_||(c=ge))}for(let _=0,S=Se.length;_<S;_++){Y=Se[_].s,K.push(Y),e=c[_];for(let L=0,k=e.length;L<k;L++)Y.holes.push(e[L].h)}return K}}),Object.assign(Vs.prototype,{isFont:!0,generateShapes:function(t,u){void 0===u&&(u=100);const m=[],g=function(E,I,H){const J=Array.from?Array.from(E):String(E).split(""),Y=I/H.resolution,K=(H.boundingBox.yMax-H.boundingBox.yMin+H.underlineThickness)*Y,me=[];let ge=0,Se=0;for(let w=0;w<J.length;w++){const e=J[w];if("\n"===e)ge=0,Se-=K;else{const c=za(e,Y,ge,Se,H);ge+=c.offsetX,me.push(c.path)}}return me}(t,u,this.data);for(let E=0,I=g.length;E<I;E++)Array.prototype.push.apply(m,g[E].toShapes());return m}}),ja.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ja,load:function(t,u,m,g){const E=this,I=new Ss(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.load(t,function(H){let J;try{J=JSON.parse(H)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),J=JSON.parse(H.substring(65,H.length-2))}const Y=E.parse(J);u&&u(Y)},m,g)},parse:function(t){return new Vs(t)}});const Hl={getContext:function(){return void 0===Ga&&(Ga=new(window.AudioContext||window.webkitAudioContext)),Ga},setContext:function(t){Ga=t}};function ap(t){Ti.call(this,t)}function lp(t,u,m){xn.call(this,void 0,m);const g=(new ar).set(t),E=(new ar).set(u),I=new lt(g.r,g.g,g.b),H=new lt(E.r,E.g,E.b),J=Math.sqrt(Math.PI),Y=J*Math.sqrt(.75);this.sh.coefficients[0].copy(I).add(H).multiplyScalar(J),this.sh.coefficients[1].copy(I).sub(H).multiplyScalar(Y)}function Up(t,u){xn.call(this,void 0,u);const m=(new ar).set(t);this.sh.coefficients[0].set(m.r,m.g,m.b).multiplyScalar(2*Math.sqrt(Math.PI))}ap.prototype=Object.assign(Object.create(Ti.prototype),{constructor:ap,load:function(t,u,m,g){const E=this,I=new Ss(E.manager);I.setResponseType("arraybuffer"),I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(H){try{const J=H.slice(0);Hl.getContext().decodeAudioData(J,function(Y){u(Y)})}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)}}),lp.prototype=Object.assign(Object.create(xn.prototype),{constructor:lp,isHemisphereLightProbe:!0,copy:function(t){return xn.prototype.copy.call(this,t),this},toJSON:function(t){return xn.prototype.toJSON.call(this,t)}}),Up.prototype=Object.assign(Object.create(xn.prototype),{constructor:Up,isAmbientLightProbe:!0,copy:function(t){return xn.prototype.copy.call(this,t),this},toJSON:function(t){return xn.prototype.toJSON.call(this,t)}});const Sd=new ri,Uc=new ri;function up(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ns,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ns,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function fh(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(up.prototype,{update:function(t){const u=this._cache;if(u.focus!==t.focus||u.fov!==t.fov||u.aspect!==t.aspect*this.aspect||u.near!==t.near||u.far!==t.far||u.zoom!==t.zoom||u.eyeSep!==this.eyeSep){u.focus=t.focus,u.fov=t.fov,u.aspect=t.aspect*this.aspect,u.near=t.near,u.far=t.far,u.zoom=t.zoom,u.eyeSep=this.eyeSep;const m=t.projectionMatrix.clone(),g=u.eyeSep/2,E=g*u.near/u.focus,I=u.near*Math.tan(er.DEG2RAD*u.fov*.5)/u.zoom;let H,J;Uc.elements[12]=-g,Sd.elements[12]=g,H=-I*u.aspect+E,J=I*u.aspect+E,m.elements[0]=2*u.near/(J-H),m.elements[8]=(J+H)/(J-H),this.cameraL.projectionMatrix.copy(m),H=-I*u.aspect-E,J=I*u.aspect-E,m.elements[0]=2*u.near/(J-H),m.elements[8]=(J+H)/(J-H),this.cameraR.projectionMatrix.copy(m)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Uc),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Sd)}}),Object.assign(fh.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const u=(typeof performance>"u"?Date:performance).now();t=(u-this.oldTime)/1e3,this.oldTime=u,this.elapsedTime+=t}return t}});const il=new lt,hp=new vo,jm=new lt,Ed=new lt;function If(){Qn.call(this),this.type="AudioListener",this.context=Hl.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new fh}function Jd(t){Qn.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}If.prototype=Object.assign(Object.create(Qn.prototype),{constructor:If,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Qn.prototype.updateMatrixWorld.call(this,t);const u=this.context.listener,m=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(il,hp,jm),Ed.set(0,0,-1).applyQuaternion(hp),u.positionX){const g=this.context.currentTime+this.timeDelta;u.positionX.linearRampToValueAtTime(il.x,g),u.positionY.linearRampToValueAtTime(il.y,g),u.positionZ.linearRampToValueAtTime(il.z,g),u.forwardX.linearRampToValueAtTime(Ed.x,g),u.forwardY.linearRampToValueAtTime(Ed.y,g),u.forwardZ.linearRampToValueAtTime(Ed.z,g),u.upX.linearRampToValueAtTime(m.x,g),u.upY.linearRampToValueAtTime(m.y,g),u.upZ.linearRampToValueAtTime(m.z,g)}else u.setPosition(il.x,il.y,il.z),u.setOrientation(Ed.x,Ed.y,Ed.z,m.x,m.y,m.z)}}),Jd.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Jd,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const u=this.context.createBufferSource();return u.buffer=this.buffer,u.loop=this.loop,u.loopStart=this.loopStart,u.loopEnd=this.loopEnd,u.onended=this.onEnded.bind(this),u.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=u,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});const nd=new lt,am=new vo,Gm=new lt,rd=new lt;function Zd(t){Jd.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function lm(t,u){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==u?u:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function vf(t,u,m){let g,E,I;switch(this.binding=t,this.valueSize=m,u){case"quaternion":g=this._slerp,E=this._slerpAdditive,I=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*m),this._workIndex=5;break;case"string":case"bool":g=this._select,E=this._select,I=this._setAdditiveIdentityOther,this.buffer=new Array(5*m);break;default:g=this._lerp,E=this._lerpAdditive,I=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*m)}this._mixBufferRegion=g,this._mixBufferRegionAdditive=E,this._setIdentity=I,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Zd.prototype=Object.assign(Object.create(Jd.prototype),{constructor:Zd,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,u,m){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=u,this.panner.coneOuterGain=m,this},updateMatrixWorld:function(t){if(Qn.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(nd,am,Gm),rd.set(0,0,1).applyQuaternion(am);const u=this.panner;if(u.positionX){const m=this.context.currentTime+this.listener.timeDelta;u.positionX.linearRampToValueAtTime(nd.x,m),u.positionY.linearRampToValueAtTime(nd.y,m),u.positionZ.linearRampToValueAtTime(nd.z,m),u.orientationX.linearRampToValueAtTime(rd.x,m),u.orientationY.linearRampToValueAtTime(rd.y,m),u.orientationZ.linearRampToValueAtTime(rd.z,m)}else u.setPosition(nd.x,nd.y,nd.z),u.setOrientation(rd.x,rd.y,rd.z)}}),Object.assign(lm.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let t=0;const u=this.getFrequencyData();for(let m=0;m<u.length;m++)t+=u[m];return t/u.length}}),Object.assign(vf.prototype,{accumulate:function(t,u){const m=this.buffer,g=this.valueSize,E=t*g+g;let I=this.cumulativeWeight;if(0===I){for(let H=0;H!==g;++H)m[E+H]=m[H];I=u}else I+=u,this._mixBufferRegion(m,E,0,u/I,g);this.cumulativeWeight=I},accumulateAdditive:function(t){const u=this.buffer,m=this.valueSize,g=m*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(u,g,0,t,m),this.cumulativeWeightAdditive+=t},apply:function(t){const u=this.valueSize,m=this.buffer,g=t*u+u,E=this.cumulativeWeight,I=this.cumulativeWeightAdditive,H=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,E<1&&this._mixBufferRegion(m,g,u*this._origIndex,1-E,u),I>0&&this._mixBufferRegionAdditive(m,g,this._addIndex*u,1,u);for(let J=u,Y=u+u;J!==Y;++J)if(m[J]!==m[J+u]){H.setValue(m,g);break}},saveOriginalState:function(){const u=this.buffer,m=this.valueSize,g=m*this._origIndex;this.binding.getValue(u,g);for(let E=m,I=g;E!==I;++E)u[E]=u[g+E%m];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,u=t+this.valueSize;for(let m=t;m<u;m++)this.buffer[m]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,u=this._addIndex*this.valueSize;for(let m=0;m<this.valueSize;m++)this.buffer[u+m]=this.buffer[t+m]},_select:function(t,u,m,g,E){if(g>=.5)for(let I=0;I!==E;++I)t[u+I]=t[m+I]},_slerp:function(t,u,m,g){vo.slerpFlat(t,u,t,u,t,m,g)},_slerpAdditive:function(t,u,m,g,E){const I=this._workIndex*E;vo.multiplyQuaternionsFlat(t,I,t,u,t,m),vo.slerpFlat(t,u,t,u,t,I,g)},_lerp:function(t,u,m,g,E){const I=1-g;for(let H=0;H!==E;++H){const J=u+H;t[J]=t[J]*I+t[m+H]*g}},_lerpAdditive:function(t,u,m,g,E){for(let I=0;I!==E;++I){const H=u+I;t[H]=t[H]+t[m+I]*g}}});const Of="\\[\\]\\.:\\/",o_=new RegExp("["+Of+"]","g"),Hm="[^"+Of+"]",E_="[^"+Of.replace("\\.","")+"]",s_=/((?:WC+[\/:])*)/.source.replace("WC",Hm),a_=/(WCOD+)?/.source.replace("WCOD",E_),l_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Hm),c_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Hm),Vm=new RegExp("^"+s_+a_+l_+c_+"$"),T_=["material","materials","bones"];function u_(t,u,m){const g=m||Sl.parseTrackName(u);this._targetGroup=t,this._bindings=t.subscribe_(u,g)}function Sl(t,u,m){this.path=u,this.parsedPath=m||Sl.parseTrackName(u),this.node=Sl.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function cm(){this.uuid=er.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let m=0,g=arguments.length;m!==g;++m)t[arguments[m].uuid]=m;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const u=this;this.stats={objects:{get total(){return u._objects.length},get inUse(){return this.total-u.nCachedObjects_}},get bindingsPerObject(){return u._bindings.length}}}function Wm(t,u,m,g){this._mixer=t,this._clip=u,this._localRoot=m||null,this.blendMode=g||u.blendMode;const E=u.tracks,I=E.length,H=new Array(I),J={endingStart:$a,endingEnd:$a};for(let Y=0;Y!==I;++Y){const K=E[Y].createInterpolant(null);H[Y]=K,K.settings=J}this._interpolantSettings=J,this._interpolants=H,this._propertyBindings=new Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=qa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function um(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function kf(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function hm(t,u,m){Pa.call(this,t,u),this.meshPerAttribute=m||1}function pm(t,u,m,g){this.ray=new lo(t,u),this.near=m||0,this.far=g||1/0,this.camera=null,this.layers=new bu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function h_(t,u){return t.distance-u.distance}function dm(t,u,m,g){if(t.layers.test(u.layers)&&t.raycast(u,m),!0===g){const E=t.children;for(let I=0,H=E.length;I<H;I++)dm(E[I],u,m,!0)}}Object.assign(u_.prototype,{getValue:function(t,u){this.bind();const g=this._bindings[this._targetGroup.nCachedObjects_];void 0!==g&&g.getValue(t,u)},setValue:function(t,u){const m=this._bindings;for(let g=this._targetGroup.nCachedObjects_,E=m.length;g!==E;++g)m[g].setValue(t,u)},bind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].bind()},unbind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].unbind()}}),Object.assign(Sl,{Composite:u_,create:function(t,u,m){return t&&t.isAnimationObjectGroup?new Sl.Composite(t,u,m):new Sl(t,u,m)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(o_,"")},parseTrackName:function(t){const u=Vm.exec(t);if(!u)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const m={nodeName:u[2],objectName:u[3],objectIndex:u[4],propertyName:u[5],propertyIndex:u[6]},g=m.nodeName&&m.nodeName.lastIndexOf(".");if(void 0!==g&&-1!==g){const E=m.nodeName.substring(g+1);-1!==T_.indexOf(E)&&(m.nodeName=m.nodeName.substring(0,g),m.objectName=E)}if(null===m.propertyName||0===m.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return m},findNode:function(t,u){if(!u||""===u||"."===u||-1===u||u===t.name||u===t.uuid)return t;if(t.skeleton){const m=t.skeleton.getBoneByName(u);if(void 0!==m)return m}if(t.children){const m=function(E){for(let I=0;I<E.length;I++){const H=E[I];if(H.name===u||H.uuid===u)return H;const J=m(H.children);if(J)return J}return null},g=m(t.children);if(g)return g}return null}}),Object.assign(Sl.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,u){t[u]=this.node[this.propertyName]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)t[u++]=m[g]},function(t,u){t[u]=this.resolvedProperty[this.propertyIndex]},function(t,u){this.resolvedProperty.toArray(t,u)}],SetterByBindingTypeAndVersioning:[[function(t,u){this.targetObject[this.propertyName]=t[u]},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.needsUpdate=!0},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty[this.propertyIndex]=t[u]},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty.fromArray(t,u)},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,u){this.bind(),this.getValue(t,u)},setValue:function(t,u){this.bind(),this.setValue(t,u)},bind:function(){let t=this.node,u=this.parsedPath,m=u.objectName,g=u.propertyName,E=u.propertyIndex;if(t||(t=Sl.findNode(this.rootNode,u.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(m){let Y=u.objectIndex;switch(m){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let K=0;K<t.length;K++)if(t[K].name===Y){Y=K;break}break;default:if(void 0===t[m])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[m]}if(void 0!==Y){if(void 0===t[Y])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[Y]}}const I=t[g];if(void 0===I)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u.nodeName+"."+g+" but it wasn't found.",t);let H=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?H=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(H=this.Versioning.MatrixWorldNeedsUpdate);let J=this.BindingType.Direct;if(void 0!==E){if("morphTargetInfluences"===g){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[E]&&(E=t.morphTargetDictionary[E])}J=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=E}else void 0!==I.fromArray&&void 0!==I.toArray?(J=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(J=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=g;this.getValue=this.GetterByBindingType[J],this.setValue=this.SetterByBindingTypeAndVersioning[J][H]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Sl.prototype,{_getValue_unbound:Sl.prototype.getValue,_setValue_unbound:Sl.prototype.setValue}),Object.assign(cm.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,u=this._indicesByUUID,m=this._paths,g=this._parsedPaths,E=this._bindings,I=E.length;let H,J=t.length,Y=this.nCachedObjects_;for(let K=0,me=arguments.length;K!==me;++K){const ge=arguments[K],Se=ge.uuid;let w=u[Se];if(void 0===w){w=J++,u[Se]=w,t.push(ge);for(let e=0,c=I;e!==c;++e)E[e].push(new Sl(ge,m[e],g[e]))}else if(w<Y){H=t[w];const e=--Y,c=t[e];u[c.uuid]=w,t[w]=c,u[Se]=e,t[e]=ge;for(let d=0,_=I;d!==_;++d){const S=E[d];let k=S[w];S[w]=S[e],void 0===k&&(k=new Sl(ge,m[d],g[d])),S[e]=k}}else t[w]!==H&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Y},remove:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_;for(let I=0,H=arguments.length;I!==H;++I){const J=arguments[I],Y=J.uuid,K=u[Y];if(void 0!==K&&K>=E){const me=E++,ge=t[me];u[ge.uuid]=K,t[K]=ge,u[Y]=me,t[me]=J;for(let Se=0,w=g;Se!==w;++Se){const e=m[Se],d=e[K];e[K]=e[me],e[me]=d}}}this.nCachedObjects_=E},uncache:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_,I=t.length;for(let H=0,J=arguments.length;H!==J;++H){const Y=arguments[H].uuid,K=u[Y];if(void 0!==K)if(delete u[Y],K<E){const me=--E,ge=t[me],Se=--I,w=t[Se];u[ge.uuid]=K,t[K]=ge,u[w.uuid]=me,t[me]=w,t.pop();for(let e=0,c=g;e!==c;++e){const d=m[e],S=d[Se];d[K]=d[me],d[me]=S,d.pop()}}else{const me=--I,ge=t[me];u[ge.uuid]=K,t[K]=ge,t.pop();for(let Se=0,w=g;Se!==w;++Se){const e=m[Se];e[K]=e[me],e.pop()}}}this.nCachedObjects_=E},subscribe_:function(t,u){let m=this._bindingsIndicesByPath,g=m[t],E=this._bindings;if(void 0!==g)return E[g];const I=this._paths,H=this._parsedPaths,J=this._objects,K=this.nCachedObjects_,me=new Array(J.length);g=E.length,m[t]=g,I.push(t),H.push(u),E.push(me);for(let ge=K,Se=J.length;ge!==Se;++ge)me[ge]=new Sl(J[ge],t,u);return me},unsubscribe_:function(t){const u=this._bindingsIndicesByPath,m=u[t];if(void 0!==m){const g=this._paths,E=this._parsedPaths,I=this._bindings,H=I.length-1,J=I[H];u[t[H]]=m,I[m]=J,I.pop(),E[m]=E[H],E.pop(),g[m]=g[H],g.pop()}}}),Object.assign(Wm.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,u){return this.loop=t,this.repetitions=u,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,u,m){if(t.fadeOut(u),this.fadeIn(u),m){const g=this._clip.duration,E=t._clip.duration,H=g/E;t.warp(1,E/g,u),this.warp(H,1,u)}return this},crossFadeTo:function(t,u,m){return t.crossFadeFrom(this,u,m)},stopFading:function(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,u,m){const g=this._mixer,E=g.time,I=this.timeScale;let H=this._timeScaleInterpolant;null===H&&(H=g._lendControlInterpolant(),this._timeScaleInterpolant=H);const J=H.parameterPositions,Y=H.sampleValues;return J[0]=E,J[1]=E+m,Y[0]=t/I,Y[1]=u/I,this},stopWarping:function(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,u,m,g){if(!this.enabled)return void this._updateWeight(t);const E=this._startTime;if(null!==E){const J=(t-E)*m;if(J<0||0===m)return;this._startTime=null,u=m*J}u*=this._updateTimeScale(t);const I=this._updateTime(u),H=this._updateWeight(t);if(H>0){const J=this._interpolants,Y=this._propertyBindings;if(this.blendMode===th)for(let K=0,me=J.length;K!==me;++K)J[K].evaluate(I),Y[K].accumulateAdditive(H);else for(let K=0,me=J.length;K!==me;++K)J[K].evaluate(I),Y[K].accumulate(g,H)}},_updateWeight:function(t){let u=0;if(this.enabled){u=this.weight;const m=this._weightInterpolant;if(null!==m){const g=m.evaluate(t)[0];u*=g,t>m.parameterPositions[1]&&(this.stopFading(),0===g&&(this.enabled=!1))}}return this._effectiveWeight=u,u},_updateTimeScale:function(t){let u=0;if(!this.paused){u=this.timeScale;const m=this._timeScaleInterpolant;null!==m&&(u*=m.evaluate(t)[0],t>m.parameterPositions[1]&&(this.stopWarping(),0===u?this.paused=!0:this.timeScale=u))}return this._effectiveTimeScale=u,u},_updateTime:function(t){const u=this._clip.duration,m=this.loop;let g=this.time+t,E=this._loopCount;const I=m===bc;if(0===t)return-1===E?g:I&&1==(1&E)?u-g:g;if(m===gu){-1===E&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(g>=u)g=u;else{if(!(g<0)){this.time=g;break e}g=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===E&&(t>=0?(E=0,this._setEndings(!0,0===this.repetitions,I)):this._setEndings(0===this.repetitions,!0,I)),g>=u||g<0){const H=Math.floor(g/u);g-=u*H,E+=Math.abs(H);const J=this.repetitions-E;if(J<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=t>0?u:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===J){const Y=t<0;this._setEndings(Y,!Y,I)}else this._setEndings(!1,!1,I);this._loopCount=E,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:H})}}else this.time=g;if(I&&1==(1&E))return u-g}return g},_setEndings:function(t,u,m){const g=this._interpolantSettings;m?(g.endingStart=ua,g.endingEnd=ua):(g.endingStart=t?this.zeroSlopeAtStart?ua:$a:Al,g.endingEnd=u?this.zeroSlopeAtEnd?ua:$a:Al)},_scheduleFading:function(t,u,m){const g=this._mixer,E=g.time;let I=this._weightInterpolant;null===I&&(I=g._lendControlInterpolant(),this._weightInterpolant=I);const H=I.parameterPositions,J=I.sampleValues;return H[0]=E,J[0]=u,H[1]=E+t,J[1]=m,this}}),um.prototype=Object.assign(Object.create(da.prototype),{constructor:um,_bindAction:function(t,u){const m=t._localRoot||this._root,g=t._clip.tracks,E=g.length,I=t._propertyBindings,H=t._interpolants,J=m.uuid,Y=this._bindingsByRootAndName;let K=Y[J];void 0===K&&(K={},Y[J]=K);for(let me=0;me!==E;++me){const ge=g[me],Se=ge.name;let w=K[Se];if(void 0!==w)I[me]=w;else{if(w=I[me],void 0!==w){null===w._cacheIndex&&(++w.referenceCount,this._addInactiveBinding(w,J,Se));continue}w=new vf(Sl.create(m,Se,u&&u._propertyBindings[me].binding.parsedPath),ge.ValueTypeName,ge.getValueSize()),++w.referenceCount,this._addInactiveBinding(w,J,Se),I[me]=w}H[me].resultBuffer=w.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const m=(t._localRoot||this._root).uuid,g=t._clip.uuid,E=this._actionsByClip[g];this._bindAction(t,E&&E.knownActions[0]),this._addInactiveAction(t,g,m)}const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==E.useCount++&&(this._lendBinding(E),E.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.useCount&&(E.restoreOriginalState(),this._takeBackBinding(E))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const u=t._cacheIndex;return null!==u&&u<this._nActiveActions},_addInactiveAction:function(t,u,m){const g=this._actions,E=this._actionsByClip;let I=E[u];if(void 0===I)I={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,E[u]=I;else{const H=I.knownActions;t._byClipCacheIndex=H.length,H.push(t)}t._cacheIndex=g.length,g.push(t),I.actionByRoot[m]=t},_removeInactiveAction:function(t){const u=this._actions,m=u[u.length-1],g=t._cacheIndex;m._cacheIndex=g,u[g]=m,u.pop(),t._cacheIndex=null;const E=t._clip.uuid,I=this._actionsByClip,H=I[E],J=H.knownActions,Y=J[J.length-1],K=t._byClipCacheIndex;Y._byClipCacheIndex=K,J[K]=Y,J.pop(),t._byClipCacheIndex=null,delete H.actionByRoot[(t._localRoot||this._root).uuid],0===J.length&&delete I[E],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.referenceCount&&this._removeInactiveBinding(E)}},_lendAction:function(t){const u=this._actions,m=t._cacheIndex,g=this._nActiveActions++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackAction:function(t){const u=this._actions,m=t._cacheIndex,g=--this._nActiveActions,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_addInactiveBinding:function(t,u,m){const g=this._bindingsByRootAndName,E=this._bindings;let I=g[u];void 0===I&&(I={},g[u]=I),I[m]=t,t._cacheIndex=E.length,E.push(t)},_removeInactiveBinding:function(t){const u=this._bindings,m=t.binding,g=m.rootNode.uuid,E=m.path,I=this._bindingsByRootAndName,H=I[g],J=u[u.length-1],Y=t._cacheIndex;J._cacheIndex=Y,u[Y]=J,u.pop(),delete H[E],0===Object.keys(H).length&&delete I[g]},_lendBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=this._nActiveBindings++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=--this._nActiveBindings,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_lendControlInterpolant:function(){const t=this._controlInterpolants,u=this._nActiveControlInterpolants++;let m=t[u];return void 0===m&&(m=new uu(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),m.__cacheIndex=u,t[u]=m),m},_takeBackControlInterpolant:function(t){const u=this._controlInterpolants,m=t.__cacheIndex,g=--this._nActiveControlInterpolants,E=u[g];t.__cacheIndex=g,u[g]=t,E.__cacheIndex=m,u[m]=E},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,u,m){const g=u||this._root,E=g.uuid;let I="string"==typeof t?ls.findByName(g,t):t;const H=null!==I?I.uuid:t;let J=this._actionsByClip[H],Y=null;if(void 0===m&&(m=null!==I?I.blendMode:eh),void 0!==J){const me=J.actionByRoot[E];if(void 0!==me&&me.blendMode===m)return me;Y=J.knownActions[0],null===I&&(I=Y._clip)}if(null===I)return null;const K=new Wm(this,I,u,m);return this._bindAction(K,Y),this._addInactiveAction(K,H,E),K},existingAction:function(t,u){const m=u||this._root,g=m.uuid,E="string"==typeof t?ls.findByName(m,t):t,H=this._actionsByClip[E?E.uuid:t];return void 0!==H&&H.actionByRoot[g]||null},stopAllAction:function(){const t=this._actions;for(let u=this._nActiveActions-1;u>=0;--u)t[u].stop();return this},update:function(t){const u=this._actions,m=this._nActiveActions,g=this.time+=t*=this.timeScale,E=Math.sign(t),I=this._accuIndex^=1;for(let Y=0;Y!==m;++Y)u[Y]._update(g,t,E,I);const H=this._bindings,J=this._nActiveBindings;for(let Y=0;Y!==J;++Y)H[Y].apply(I);return this},setTime:function(t){this.time=0;for(let u=0;u<this._actions.length;u++)this._actions[u].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const u=this._actions,m=t.uuid,g=this._actionsByClip,E=g[m];if(void 0!==E){const I=E.knownActions;for(let H=0,J=I.length;H!==J;++H){const Y=I[H];this._deactivateAction(Y);const K=Y._cacheIndex,me=u[u.length-1];Y._cacheIndex=null,Y._byClipCacheIndex=null,me._cacheIndex=K,u[K]=me,u.pop(),this._removeInactiveBindingsForAction(Y)}delete g[m]}},uncacheRoot:function(t){const u=t.uuid,m=this._actionsByClip;for(const E in m){const I=m[E].actionByRoot[u];void 0!==I&&(this._deactivateAction(I),this._removeInactiveAction(I))}const g=this._bindingsByRootAndName[u];if(void 0!==g)for(const E in g){const I=g[E];I.restoreOriginalState(),this._removeInactiveBinding(I)}},uncacheAction:function(t,u){const m=this.existingAction(t,u);null!==m&&(this._deactivateAction(m),this._removeInactiveAction(m))}}),kf.prototype.clone=function(){return new kf(void 0===this.value.clone?this.value:this.value.clone())},hm.prototype=Object.assign(Object.create(Pa.prototype),{constructor:hm,isInstancedInterleavedBuffer:!0,copy:function(t){return Pa.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const u=Pa.prototype.clone.call(this,t);return u.meshPerAttribute=this.meshPerAttribute,u},toJSON:function(t){const u=Pa.prototype.toJSON.call(this,t);return u.isInstancedInterleavedBuffer=!0,u.meshPerAttribute=this.meshPerAttribute,u}}),Object.assign(pm.prototype,{set:function(t,u){this.ray.set(t,u)},setFromCamera:function(t,u){u&&u.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(u.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(u).sub(this.ray.origin).normalize(),this.camera=u):u&&u.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(u.near+u.far)/(u.near-u.far)).unproject(u),this.ray.direction.set(0,0,-1).transformDirection(u.matrixWorld),this.camera=u):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,u,m){const g=m||[];return dm(t,this,g,u),g.sort(h_),g},intersectObjects:function(t,u,m){const g=m||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(let E=0,I=t.length;E<I;E++)dm(t[E],this,g,u);return g.sort(h_),g}});class p_{constructor(u=1,m=0,g=0){return this.radius=u,this.phi=m,this.theta=g,this}set(u,m,g){return this.radius=u,this.phi=m,this.theta=g,this}clone(){return(new this.constructor).copy(this)}copy(u){return this.radius=u.radius,this.phi=u.phi,this.theta=u.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(u){return this.setFromCartesianCoords(u.x,u.y,u.z)}setFromCartesianCoords(u,m,g){return this.radius=Math.sqrt(u*u+m*m+g*g),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(u,g),this.phi=Math.acos(er.clamp(m/this.radius,-1,1))),this}}function Td(t,u,m){return this.radius=void 0!==t?t:1,this.theta=void 0!==u?u:0,this.y=void 0!==m?m:0,this}Object.assign(Td.prototype,{set:function(t,u,m){return this.radius=t,this.theta=u,this.y=m,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,u,m){return this.radius=Math.sqrt(t*t+m*m),this.theta=Math.atan2(t,m),this.y=u,this}});const qm=new En;function Xm(t,u){this.min=void 0!==t?t:new En(1/0,1/0),this.max=void 0!==u?u:new En(-1/0,-1/0)}Object.assign(Xm.prototype,{set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=qm.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new En),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new En),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .getParameter() target is now required"),u=new En),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .clampPoint() target is now required"),u=new En),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return qm.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const Md=new lt,fm=new lt;function Ff(t,u){this.start=void 0!==t?t:new lt,this.end=void 0!==u?u:new lt}function pp(t){Qn.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(Ff.prototype,{set:function(t,u){return this.start.copy(t),this.end.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new lt),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new lt),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,u){return void 0===u&&(console.warn("THREE.Line3: .at() target is now required"),u=new lt),this.delta(u).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,u){Md.subVectors(t,this.start),fm.subVectors(this.end,this.start);const m=fm.dot(fm);let g=fm.dot(Md)/m;return u&&(g=er.clamp(g,0,1)),g},closestPointToPoint:function(t,u,m){const g=this.closestPointToPointParameter(t,u);return void 0===m&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),m=new lt),this.delta(m).multiplyScalar(g).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(pp.prototype=Object.create(Qn.prototype)).constructor=pp,pp.prototype.isImmediateRenderObject=!0;const Ym=new lt;function yf(t,u){Qn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=u;const m=new hn,g=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let I=0,H=1,J=32;I<J;I++,H++){const Y=I/J*Math.PI*2,K=H/J*Math.PI*2;g.push(Math.cos(Y),Math.sin(Y),1,Math.cos(K),Math.sin(K),1)}m.setAttribute("position",new Un(g,3));const E=new $o({fog:!1,toneMapped:!1});this.cone=new Ii(m,E),this.add(this.cone),this.update()}(yf.prototype=Object.create(Qn.prototype)).constructor=yf,yf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},yf.prototype.update=function(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,u=t*Math.tan(this.light.angle);this.cone.scale.set(u,u,t),Ym.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Ym),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const zu=new lt,mm=new ri,_m=new ri;function Jm(t){const u=[];t&&t.isBone&&u.push(t);for(let m=0;m<t.children.length;m++)u.push.apply(u,Jm(t.children[m]));return u}function od(t){const u=Jm(t),m=new hn,g=[],E=[],I=new ar(0,0,1),H=new ar(0,1,0);for(let Y=0;Y<u.length;Y++){const K=u[Y];K.parent&&K.parent.isBone&&(g.push(0,0,0),g.push(0,0,0),E.push(I.r,I.g,I.b),E.push(H.r,H.g,H.b))}m.setAttribute("position",new Un(g,3)),m.setAttribute("color",new Un(E,3));const J=new $o({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Ii.call(this,m,J),this.type="SkeletonHelper",this.root=t,this.bones=u,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function bf(t,u,m){this.light=t,this.light.updateMatrixWorld(),this.color=m;const g=new Ou(u,4,2),E=new Ki({wireframe:!0,fog:!1,toneMapped:!1});Ci.call(this,g,E),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}(od.prototype=Object.create(Ii.prototype)).constructor=od,od.prototype.isSkeletonHelper=!0,od.prototype.updateMatrixWorld=function(t){const u=this.bones,m=this.geometry,g=m.getAttribute("position");_m.getInverse(this.root.matrixWorld);for(let E=0,I=0;E<u.length;E++){const H=u[E];H.parent&&H.parent.isBone&&(mm.multiplyMatrices(_m,H.matrixWorld),zu.setFromMatrixPosition(mm),g.setXYZ(I,zu.x,zu.y,zu.z),mm.multiplyMatrices(_m,H.parent.matrixWorld),zu.setFromMatrixPosition(mm),g.setXYZ(I+1,zu.x,zu.y,zu.z),I+=2)}m.getAttribute("position").needsUpdate=!0,Qn.prototype.updateMatrixWorld.call(this,t)},(bf.prototype=Object.create(Ci.prototype)).constructor=bf,bf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},bf.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const Zm=new lt,d_=new ar,f_=new ar;function xf(t,u,m){Qn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m;const g=new zs(u);g.rotateY(.5*Math.PI),this.material=new Ki({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const E=g.getAttribute("position"),I=new Float32Array(3*E.count);g.setAttribute("color",new Vr(I,3)),this.add(new Ci(g,this.material)),this.update()}function Df(t,u,m,g){t=t||10,u=u||10,m=new ar(void 0!==m?m:4473924),g=new ar(void 0!==g?g:8947848);const E=u/2,I=t/u,H=t/2,J=[],Y=[];for(let ge=0,Se=0,w=-H;ge<=u;ge++,w+=I){J.push(-H,0,w,H,0,w),J.push(w,0,-H,w,0,H);const e=ge===E?m:g;e.toArray(Y,Se),Se+=3,e.toArray(Y,Se),Se+=3,e.toArray(Y,Se),Se+=3,e.toArray(Y,Se),Se+=3}const K=new hn;K.setAttribute("position",new Un(J,3)),K.setAttribute("color",new Un(Y,3));const me=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,K,me),this.type="GridHelper"}function gm(t,u,m,g,E,I){t=t||10,u=u||16,m=m||8,g=g||64,E=new ar(void 0!==E?E:4473924),I=new ar(void 0!==I?I:8947848);const H=[],J=[];for(let me=0;me<=u;me++){const ge=me/u*(2*Math.PI),Se=Math.sin(ge)*t,w=Math.cos(ge)*t;H.push(0,0,0),H.push(Se,0,w);const e=1&me?E:I;J.push(e.r,e.g,e.b),J.push(e.r,e.g,e.b)}for(let me=0;me<=m;me++){const ge=1&me?E:I,Se=t-t/m*me;for(let w=0;w<g;w++){let e=w/g*(2*Math.PI),c=Math.sin(e)*Se,d=Math.cos(e)*Se;H.push(c,0,d),J.push(ge.r,ge.g,ge.b),e=(w+1)/g*(2*Math.PI),c=Math.sin(e)*Se,d=Math.cos(e)*Se,H.push(c,0,d),J.push(ge.r,ge.g,ge.b)}}const Y=new hn;Y.setAttribute("position",new Un(H,3)),Y.setAttribute("color",new Un(J,3));const K=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,Y,K),this.type="PolarGridHelper"}(xf.prototype=Object.create(Qn.prototype)).constructor=xf,xf.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},xf.prototype.update=function(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const u=t.geometry.getAttribute("color");d_.copy(this.light.color),f_.copy(this.light.groundColor);for(let m=0,g=u.count;m<g;m++){const E=m<g/2?d_:f_;u.setXYZ(m,E.r,E.g,E.b)}u.needsUpdate=!0}t.lookAt(Zm.setFromMatrixPosition(this.light.matrixWorld).negate())},(Df.prototype=Object.create(Ii.prototype)).constructor=Df,(gm.prototype=Object.create(Ii.prototype)).constructor=gm;const m_=new lt,vm=new lt,fo=new lt;function Qd(t,u,m){Qn.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,void 0===u&&(u=1);let g=new hn;g.setAttribute("position",new Un([-u,u,0,u,u,0,u,-u,0,-u,-u,0,-u,u,0],3));const E=new $o({fog:!1,toneMapped:!1});this.lightPlane=new Us(g,E),this.add(this.lightPlane),g=new hn,g.setAttribute("position",new Un([0,0,0,0,0,1],3)),this.targetLine=new Us(g,E),this.add(this.targetLine),this.update()}(Qd.prototype=Object.create(Qn.prototype)).constructor=Qd,Qd.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Qd.prototype.update=function(){m_.setFromMatrixPosition(this.light.matrixWorld),vm.setFromMatrixPosition(this.light.target.matrixWorld),fo.subVectors(vm,m_),this.lightPlane.lookAt(vm),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vm),this.targetLine.scale.z=fo.length()};const ym=new lt,ia=new Ai;function Ad(t){const u=new hn,m=new $o({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],E=[],I={},H=new ar(16755200),J=new ar(16711680),Y=new ar(43775),K=new ar(16777215),me=new ar(3355443);function ge(w,e,c){Se(w,c),Se(e,c)}function Se(w,e){g.push(0,0,0),E.push(e.r,e.g,e.b),void 0===I[w]&&(I[w]=[]),I[w].push(g.length/3-1)}ge("n1","n2",H),ge("n2","n4",H),ge("n4","n3",H),ge("n3","n1",H),ge("f1","f2",H),ge("f2","f4",H),ge("f4","f3",H),ge("f3","f1",H),ge("n1","f1",H),ge("n2","f2",H),ge("n3","f3",H),ge("n4","f4",H),ge("p","n1",J),ge("p","n2",J),ge("p","n3",J),ge("p","n4",J),ge("u1","u2",Y),ge("u2","u3",Y),ge("u3","u1",Y),ge("c","t",K),ge("p","c",me),ge("cn1","cn2",me),ge("cn3","cn4",me),ge("cf1","cf2",me),ge("cf3","cf4",me),u.setAttribute("position",new Un(g,3)),u.setAttribute("color",new Un(E,3)),Ii.call(this,u,m),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=I,this.update()}function Ea(t,u,m,g,E,I,H){ym.set(E,I,H).unproject(g);const J=u[t];if(void 0!==J){const Y=m.getAttribute("position");for(let K=0,me=J.length;K<me;K++)Y.setXYZ(J[K],ym.x,ym.y,ym.z)}}(Ad.prototype=Object.create(Ii.prototype)).constructor=Ad,Ad.prototype.update=function(){const t=this.geometry,u=this.pointMap;ia.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ea("c",u,t,ia,0,0,-1),Ea("t",u,t,ia,0,0,1),Ea("n1",u,t,ia,-1,-1,-1),Ea("n2",u,t,ia,1,-1,-1),Ea("n3",u,t,ia,-1,1,-1),Ea("n4",u,t,ia,1,1,-1),Ea("f1",u,t,ia,-1,-1,1),Ea("f2",u,t,ia,1,-1,1),Ea("f3",u,t,ia,-1,1,1),Ea("f4",u,t,ia,1,1,1),Ea("u1",u,t,ia,.7,1.1,-1),Ea("u2",u,t,ia,-.7,1.1,-1),Ea("u3",u,t,ia,0,2,-1),Ea("cf1",u,t,ia,-1,0,1),Ea("cf2",u,t,ia,1,0,1),Ea("cf3",u,t,ia,0,-1,1),Ea("cf4",u,t,ia,0,1,1),Ea("cn1",u,t,ia,-1,0,-1),Ea("cn2",u,t,ia,1,0,-1),Ea("cn3",u,t,ia,0,-1,-1),Ea("cn4",u,t,ia,0,1,-1),t.getAttribute("position").needsUpdate=!0};const Uf=new fn;function $d(t,u){this.object=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(24),E=new hn;E.setIndex(new Vr(m,1)),E.setAttribute("position",new Vr(g,3)),Ii.call(this,E,new $o({color:u,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function wf(t,u){this.type="Box3Helper",this.box=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new hn;g.setIndex(new Vr(m,1)),g.setAttribute("position",new Un([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Ii.call(this,g,new $o({color:u,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Kd(t,u,m){this.plane=t,this.size=void 0===u?1:u;const g=void 0!==m?m:16776960,E=new hn;E.setAttribute("position",new Un([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),E.computeBoundingSphere(),Us.call(this,E,new $o({color:g,toneMapped:!1})),this.type="PlaneHelper";const I=new hn;I.setAttribute("position",new Un([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),I.computeBoundingSphere(),this.add(new Ci(I,new Ki({color:g,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}($d.prototype=Object.create(Ii.prototype)).constructor=$d,$d.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Uf.setFromObject(this.object),Uf.isEmpty())return;const u=Uf.min,m=Uf.max,g=this.geometry.attributes.position,E=g.array;E[0]=m.x,E[1]=m.y,E[2]=m.z,E[3]=u.x,E[4]=m.y,E[5]=m.z,E[6]=u.x,E[7]=u.y,E[8]=m.z,E[9]=m.x,E[10]=u.y,E[11]=m.z,E[12]=m.x,E[13]=m.y,E[14]=u.z,E[15]=u.x,E[16]=m.y,E[17]=u.z,E[18]=u.x,E[19]=u.y,E[20]=u.z,E[21]=m.x,E[22]=u.y,E[23]=u.z,g.needsUpdate=!0,this.geometry.computeBoundingSphere()},$d.prototype.setFromObject=function(t){return this.object=t,this.update(),this},$d.prototype.copy=function(t){return Ii.prototype.copy.call(this,t),this.object=t.object,this},(wf.prototype=Object.create(Ii.prototype)).constructor=wf,wf.prototype.updateMatrixWorld=function(t){const u=this.box;u.isEmpty()||(u.getCenter(this.position),u.getSize(this.scale),this.scale.multiplyScalar(.5),Qn.prototype.updateMatrixWorld.call(this,t))},(Kd.prototype=Object.create(Us.prototype)).constructor=Kd,Kd.prototype.updateMatrixWorld=function(t){let u=-this.plane.constant;Math.abs(u)<1e-8&&(u=1e-8),this.scale.set(.5*this.size,.5*this.size,u),this.children[0].material.side=u<0?W:ae,this.lookAt(this.plane.normal),Qn.prototype.updateMatrixWorld.call(this,t)};const __=new lt;let bm,xm;function mh(t,u,m,g,E,I){Qn.call(this),this.type="ArrowHelper",void 0===t&&(t=new lt(0,0,1)),void 0===u&&(u=new lt(0,0,0)),void 0===m&&(m=1),void 0===g&&(g=16776960),void 0===E&&(E=.2*m),void 0===I&&(I=.2*E),void 0===bm&&(bm=new hn,bm.setAttribute("position",new Un([0,0,0,0,1,0],3)),xm=new Do(0,.5,1,5,1),xm.translate(0,-.5,0)),this.position.copy(u),this.line=new Us(bm,new $o({color:g,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ci(xm,new Ki({color:g,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(m,E,I)}function Sf(t){const u=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],m=new hn;m.setAttribute("position",new Un(u,3)),m.setAttribute("color",new Un([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const g=new $o({vertexColors:!0,toneMapped:!1});Ii.call(this,m,g),this.type="AxesHelper"}(mh.prototype=Object.create(Qn.prototype)).constructor=mh,mh.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{__.set(t.z,0,-t.x).normalize();const u=Math.acos(t.y);this.quaternion.setFromAxisAngle(__,u)}},mh.prototype.setLength=function(t,u,m){void 0===u&&(u=.2*t),void 0===m&&(m=.2*u),this.line.scale.set(1,Math.max(1e-4,t-u),1),this.line.updateMatrix(),this.cone.scale.set(m,u,m),this.cone.position.y=t,this.cone.updateMatrix()},mh.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},mh.prototype.copy=function(t){return Qn.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},(Sf.prototype=Object.create(Ii.prototype)).constructor=Sf;const _h=Math.pow(2,8),Qm=[.125,.215,.35,.446,.526,.582],Km=5+Qm.length,ef=20,zp={[Ji]:0,[hl]:1,[Yc]:2,[xc]:3,[nh]:4,[vu]:5,[Ql]:6},jp=new Pt,{_lodPlanes:Cd,_sizeLods:wm,_sigmas:zf}=function(){const t=[],u=[],m=[];let g=8;for(let E=0;E<Km;E++){const I=Math.pow(2,g);u.push(I);let H=1/I;E>4?H=Qm[E-8+4-1]:0==E&&(H=0),m.push(H);const J=1/(I-1),Y=-J/2,K=1+J/2,me=[Y,Y,K,Y,K,K,Y,Y,K,K,Y,K],ge=6,Se=6,w=3,e=2,c=1,d=new Float32Array(w*Se*ge),_=new Float32Array(e*Se*ge),S=new Float32Array(c*Se*ge);for(let k=0;k<ge;k++){const F=k%3*2/3-1,V=k>2?0:-1;d.set([F,V,0,F+2/3,V,0,F+2/3,V+1,0,F,V,0,F+2/3,V+1,0,F,V+1,0],w*Se*k),_.set(me,e*Se*k),S.set([k,k,k,k,k,k],c*Se*k)}const L=new hn;L.setAttribute("position",new Vr(d,w)),L.setAttribute("uv",new Vr(_,e)),L.setAttribute("faceIndex",new Vr(S,c)),t.push(L),g>4&&g--}return{_lodPlanes:t,_sizeLods:u,_sigmas:m}}();let Sm=null;const tf=(1+Math.sqrt(5))/2,Ef=1/tf,e_=[new lt(1,1,1),new lt(-1,1,1),new lt(1,1,-1),new lt(-1,1,-1),new lt(0,tf,Ef),new lt(0,tf,-Ef),new lt(Ef,0,tf),new lt(-Ef,0,tf),new lt(tf,Ef,0),new lt(-tf,Ef,0)];function Em(t){var u;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new ra({name:"SphericalGaussianBlur",defines:{n:u=ef},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(u)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new lt(0,1,0)},inputEncoding:{value:zp[Ji]},outputEncoding:{value:zp[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function M_(t){return void 0!==t&&t.type===ca&&(t.encoding===Ji||t.encoding===hl||t.encoding===Ql)}function t_(t){const u=new Fs(3*_h,3*_h,t);return u.texture.mapping=Ni,u.texture.name="PMREM.cubeUv",u.scissorTest=!0,u}function Tm(t,u,m,g,E){t.viewport.set(u,m,g,E),t.scissor.set(u,m,g,E)}function n_(){return new ra({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new En(1,1)},inputEncoding:{value:zp[Ji]},outputEncoding:{value:zp[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function jf(){return new ra({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:zp[Ji]},outputEncoding:{value:zp[Ji]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:X,depthTest:!1,depthWrite:!1})}function g_(t,u,m,g,E,I,H){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new ma(t,u,m,E,I,H)}Em.prototype={constructor:Em,fromScene:function(t,u=0,m=.1,g=100){Sm=this._renderer.getRenderTarget();const E=this._allocateTargets();return this._sceneToCubeUV(t,m,g,E),u>0&&this._blur(E,0,0,u),this._applyPMREM(E),this._cleanup(E),E},fromEquirectangular:function(t){return this._fromTexture(t)},fromCubemap:function(t){return this._fromTexture(t)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=jf(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=n_(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<Cd.length;t++)Cd[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Sm),t.scissorTest=!1,Tm(t,0,0,t.width,t.height)},_fromTexture:function(t){Sm=this._renderer.getRenderTarget();const u=this._allocateTargets(t);return this._textureToCubeUV(t,u),this._applyPMREM(u),this._cleanup(u),u},_allocateTargets:function(t){const u={magFilter:Ir,minFilter:Ir,generateMipmaps:!1,type:ca,format:vh,encoding:M_(t)?t.encoding:Yc,depthBuffer:!1,stencilBuffer:!1},m=t_(u);return m.depthBuffer=!t,this._pingPongRenderTarget=t_(u),m},_compileMaterial:function(t){const u=new Ci(Cd[0],t);this._renderer.compile(u,jp)},_sceneToCubeUV:function(t,u,m,g){const E=new Ns(90,1,u,m),I=[1,-1,1,1,1,1],H=[1,1,1,-1,-1,-1],J=this._renderer,Y=J.outputEncoding,K=J.toneMapping,me=J.getClearColor(),ge=J.getClearAlpha();J.toneMapping=vr,J.outputEncoding=Ji;let Se=t.background;if(Se&&Se.isColor){Se.convertSRGBToLinear();const w=Math.max(Se.r,Se.g,Se.b),e=Math.min(Math.max(Math.ceil(Math.log2(w)),-128),127);Se=Se.multiplyScalar(Math.pow(2,-e)),J.setClearColor(Se,(e+128)/255),t.background=null}for(let w=0;w<6;w++){const e=w%3;0==e?(E.up.set(0,I[w],0),E.lookAt(H[w],0,0)):1==e?(E.up.set(0,0,I[w]),E.lookAt(0,H[w],0)):(E.up.set(0,I[w],0),E.lookAt(0,0,H[w])),Tm(g,e*_h,w>2?_h:0,_h,_h),J.setRenderTarget(g),J.render(t,E)}J.toneMapping=K,J.outputEncoding=Y,J.setClearColor(me,ge)},_textureToCubeUV:function(t,u){const m=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=jf()):null==this._equirectShader&&(this._equirectShader=n_());const g=t.isCubeTexture?this._cubemapShader:this._equirectShader,E=new Ci(Cd[0],g),I=g.uniforms;I.envMap.value=t,t.isCubeTexture||I.texelSize.value.set(1/t.image.width,1/t.image.height),I.inputEncoding.value=zp[t.encoding],I.outputEncoding.value=zp[u.texture.encoding],Tm(u,0,0,3*_h,2*_h),m.setRenderTarget(u),m.render(E,jp)},_applyPMREM:function(t){const u=this._renderer,m=u.autoClear;u.autoClear=!1;for(let g=1;g<Km;g++){const E=Math.sqrt(zf[g]*zf[g]-zf[g-1]*zf[g-1]);this._blur(t,g-1,g,E,e_[(g-1)%e_.length])}u.autoClear=m},_blur:function(t,u,m,g,E){const I=this._pingPongRenderTarget;this._halfBlur(t,I,u,m,g,"latitudinal",E),this._halfBlur(I,t,m,m,g,"longitudinal",E)},_halfBlur:function(t,u,m,g,E,I,H){const J=this._renderer,Y=this._blurMaterial;"latitudinal"!==I&&"longitudinal"!==I&&console.error("blur direction must be either latitudinal or longitudinal!");const K=new Ci(Cd[g],Y),me=Y.uniforms,ge=wm[m]-1,Se=isFinite(E)?Math.PI/(2*ge):2*Math.PI/(2*ef-1),w=E/Se,e=isFinite(E)?1+Math.floor(3*w):ef;e>ef&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${e} samples when the maximum is set to ${ef}`);const c=[];let d=0;for(let S=0;S<ef;++S){const L=S/w,k=Math.exp(-L*L/2);c.push(k),0==S?d+=k:S<e&&(d+=2*k)}for(let S=0;S<c.length;S++)c[S]=c[S]/d;me.envMap.value=t.texture,me.samples.value=e,me.weights.value=c,me.latitudinal.value="latitudinal"===I,H&&(me.poleAxis.value=H),me.dTheta.value=Se,me.mipInt.value=8-m,me.inputEncoding.value=zp[t.texture.encoding],me.outputEncoding.value=zp[t.texture.encoding];const _=wm[g];Tm(u,3*Math.max(0,_h-2*_),(0===g?0:2*_h)+2*_*(g>4?g-8+4:0),3*_,2*_),J.setRenderTarget(u),J.render(K,jp)}};const A_=0,Mm=1,Ta=0,$_=1,Ha=2;function Am(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function v_(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function C_(t,u){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new kc(t,u)}function L_(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new nl(t)}function y_(t,u){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new kc(t,u)}function $m(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function r_(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function B_(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new kl(t)}function b_(t,u,m){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new lt(t,u,m)}function x_(t,u){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Vr(t,u).setUsage(Br)}function N_(t,u){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new dl(t,u)}function R_(t,u){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Cc(t,u)}function P_(t,u){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ih(t,u)}function I_(t,u){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Zh(t,u)}function O_(t,u){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Bl(t,u)}function k_(t,u){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Kn(t,u)}function F_(t,u){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new fl(t,u)}function D_(t,u){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Un(t,u)}function U_(t,u){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Nl(t,u)}function w_(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom",this.closed=!0}function S_(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom"}function i_(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),O.call(this,t),this.type="catmullrom"}function z_(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Sf(t)}function j_(t,u){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new $d(t,u)}function G_(t,u){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ii(new Rh(t.geometry),new $o({color:void 0!==u?u:16777215}))}function H_(t,u){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ii(new hc(t.geometry),new $o({color:void 0!==u?u:16777215}))}function V_(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ss(t)}function W_(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ua(t)}function q_(t,u,m){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Pl(t,m)}xr.create=function(t,u){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(xr.prototype),t.prototype.constructor=t,t.prototype.getPoint=u,t},Object.assign(Fe.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getPoints(t);return this.createGeometry(u)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getSpacedPoints(t);return this.createGeometry(u)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=new kr;for(let m=0,g=t.length;m<g;m++){const E=t[m];u.vertices.push(new lt(E.x,E.y,E.z||0))}return u}}),Object.assign(je.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),w_.prototype=Object.create(O.prototype),S_.prototype=Object.create(O.prototype),i_.prototype=Object.create(O.prototype),Object.assign(i_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Df.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},od.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ti.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ir.extractUrlBase(t)}}),Ti.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(zr.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Xm.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(fn.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(jn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),eu.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Ff.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(er,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),er.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),er.ceilPowerOfTwo(t)}}),Object.assign(Ho.prototype,{flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ri.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new lt).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,u,m,g,E,I){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,u,g,m,E,I)}}),Yo.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},vo.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(lo.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Pr.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,u)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Pr,{barycoordFromPoint:function(t,u,m,g,E){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Pr.getBarycoord(t,u,m,g,E)},normal:function(t,u,m,g){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Pr.getNormal(t,u,m,g)}}),Object.assign(Ue.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new su(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new cu(this,t)}}),Object.assign(En.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(lt.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,u){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(u,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,u,m){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(xi.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(kr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(Qn.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,u){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(u,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(Qn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Ci.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Ci.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Vh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Op.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(mf.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),ff.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(xr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Ns.prototype.setLens=function(t,u){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==u&&(this.filmGauge=u),this.setFocalLength(t)},Object.defineProperties(Ye.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Vr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Br},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Br)}}}),Object.assign(Vr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Br:bi),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(hn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,u){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),u&&u.isBufferAttribute||u&&u.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(u),this):this.setAttribute(t,u):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Vr(arguments[1],arguments[2])))},addDrawCall:function(t,u,m){void 0!==m&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,u)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(hn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Hn.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(pm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Pa.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Br},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Pa.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Br:bi),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(rl.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(kf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ur.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ar}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===A}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(Ko.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(oo.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(co.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(_d.prototype,{clearTarget:function(t,u,m,g){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(u,m,g)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(_d.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?hl:Ji}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(sc.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Fs.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Jd.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const u=this;return(new ap).load(t,function(m){u.setBuffer(m)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),lm.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Po.prototype.updateCubeMap=function(t,u){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,u)};const X_={merge:function(t,u,m){let g;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),u.isMesh&&(u.matrixAutoUpdate&&u.updateMatrix(),g=u.matrix,u=u.geometry),t.merge(u,g,m)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function Y_(){console.error("THREE.CanvasRenderer has been removed")}function J_(){console.error("THREE.JSONLoader has been removed.")}Zi.crossOrigin=void 0,Zi.loadTexture=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const E=new vi;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Zi.loadTextureCube=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const E=new sp;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Zi.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Zi.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Z_={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Q_(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}}))},759:(n,o,l)=>{"use strict";l.d(o,{U:()=>x}),n=l.hmd(n),function(B){"object"==typeof exports?n.exports=B():"function"==typeof define&&l.amdO?define([],B):(typeof window<"u"?window:void 0!==l.g?l.g:typeof self<"u"?self:this).opentype=B()}(function(){return function B(D,G,M){function P(ie,ce){if(!G[ie]){if(!D[ie]){if(de)return de(ie,!0);var fe=new Error("Cannot find module '"+ie+"'");throw fe.code="MODULE_NOT_FOUND",fe}var ae=G[ie]={exports:{}};D[ie][0].call(ae.exports,function(W){return P(D[ie][1][W]||W)},ae,ae.exports,B,D,G,M)}return G[ie].exports}for(var de=void 0,ye=0;ye<M.length;ye++)P(M[ye]);return P}({1:[function(B,D,G){function M(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function P(Ke,yt){this.source=Ke,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=yt,this.destLen=0,this.ltree=new M,this.dtree=new M}function de(Ke,yt,dt,It){var wt,Gt;for(wt=0;dt>wt;++wt)Ke[wt]=0;for(wt=0;30-dt>wt;++wt)Ke[wt+dt]=wt/dt|0;for(Gt=It,wt=0;30>wt;++wt)yt[wt]=Gt,Gt+=1<<Ke[wt]}function ye(Ke,yt,dt,It){var wt,Gt;for(wt=0;16>wt;++wt)Ke.table[wt]=0;for(wt=0;It>wt;++wt)Ke.table[yt[dt+wt]]++;for(Ke.table[0]=0,Gt=0,wt=0;16>wt;++wt)Xe[wt]=Gt,Gt+=Ke.table[wt];for(wt=0;It>wt;++wt)yt[dt+wt]&&(Ke.trans[Xe[yt[dt+wt]]++]=wt)}function ie(Ke){Ke.bitcount--||(Ke.tag=Ke.source[Ke.sourceIndex++],Ke.bitcount=7);var yt=1&Ke.tag;return Ke.tag>>>=1,yt}function ce(Ke,yt,dt){if(!yt)return dt;for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var It=Ke.tag&65535>>>16-yt;return Ke.tag>>>=yt,Ke.bitcount-=yt,It+dt}function fe(Ke,yt){for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var dt=0,It=0,wt=0,Gt=Ke.tag;do{It=2*It+(1&Gt),Gt>>>=1,++wt,dt+=yt.table[wt],It-=yt.table[wt]}while(It>=0);return Ke.tag=Gt,Ke.bitcount-=wt,yt.trans[dt+It]}function ae(Ke,yt,dt){var It,wt,Gt,Dt,sn,gt;for(It=ce(Ke,5,257),wt=ce(Ke,5,1),Gt=ce(Ke,4,4),Dt=0;19>Dt;++Dt)Ae[Dt]=0;for(Dt=0;Gt>Dt;++Dt){var An=ce(Ke,3,0);Ae[Pe[Dt]]=An}for(ye(Ge,Ae,0,19),sn=0;It+wt>sn;){var Bn=fe(Ke,Ge);switch(Bn){case 16:var dn=Ae[sn-1];for(gt=ce(Ke,2,3);gt;--gt)Ae[sn++]=dn;break;case 17:for(gt=ce(Ke,3,3);gt;--gt)Ae[sn++]=0;break;case 18:for(gt=ce(Ke,7,11);gt;--gt)Ae[sn++]=0;break;default:Ae[sn++]=Bn}}ye(yt,Ae,0,It),ye(dt,Ae,It,wt)}function W(Ke,yt,dt){for(;;){var It,wt,Gt,Dt,sn=fe(Ke,yt);if(256===sn)return A;if(256>sn)Ke.dest[Ke.destLen++]=sn;else for(It=ce(Ke,U[sn-=257],Re[sn]),wt=fe(Ke,dt),Dt=Gt=Ke.destLen-ce(Ke,Q[wt],be[wt]);Gt+It>Dt;++Dt)Ke.dest[Ke.destLen++]=Ke.dest[Dt]}}function Z(Ke){for(var yt,dt;Ke.bitcount>8;)Ke.sourceIndex--,Ke.bitcount-=8;if((yt=256*(yt=Ke.source[Ke.sourceIndex+1])+Ke.source[Ke.sourceIndex])!==(65535&~(256*Ke.source[Ke.sourceIndex+3]+Ke.source[Ke.sourceIndex+2])))return R;for(Ke.sourceIndex+=4,dt=yt;dt;--dt)Ke.dest[Ke.destLen++]=Ke.source[Ke.sourceIndex++];return Ke.bitcount=0,A}var A=0,R=-3,X=new M,he=new M,U=new Uint8Array(30),Re=new Uint16Array(30),Q=new Uint8Array(30),be=new Uint16Array(30),Pe=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ge=new M,Ae=new Uint8Array(320),Xe=new Uint16Array(16);(function(Ke,yt){var dt;for(dt=0;7>dt;++dt)Ke.table[dt]=0;for(Ke.table[7]=24,Ke.table[8]=152,Ke.table[9]=112,dt=0;24>dt;++dt)Ke.trans[dt]=256+dt;for(dt=0;144>dt;++dt)Ke.trans[24+dt]=dt;for(dt=0;8>dt;++dt)Ke.trans[168+dt]=280+dt;for(dt=0;112>dt;++dt)Ke.trans[176+dt]=144+dt;for(dt=0;5>dt;++dt)yt.table[dt]=0;for(yt.table[5]=32,dt=0;32>dt;++dt)yt.trans[dt]=dt})(X,he),de(U,Re,4,3),de(Q,be,2,1),U[28]=0,Re[28]=258,D.exports=function(Ke,yt){var dt,It,wt=new P(Ke,yt);do{switch(dt=ie(wt),ce(wt,2,0)){case 0:It=Z(wt);break;case 1:It=W(wt,X,he);break;case 2:ae(wt,wt.ltree,wt.dtree),It=W(wt,wt.ltree,wt.dtree);break;default:It=R}if(It!==A)throw new Error("Data error")}while(!dt);return wt.destLen<wt.dest.length?"function"==typeof wt.dest.slice?wt.dest.slice(0,wt.destLen):wt.dest.subarray(0,wt.destLen):wt.dest}},{}],2:[function(B,D,G){G.fail=function(M){throw new Error(M)},G.argument=function(M,P){M||G.fail(P)},G.assert=G.argument},{}],3:[function(B,D,G){G.line=function(M,P,de,ye,ie){M.beginPath(),M.moveTo(P,de),M.lineTo(ye,ie),M.stroke()}},{}],4:[function(B,D,G){function M(ie){this.font=ie}function P(ie){this.cmap=ie}function de(ie,ce){this.encoding=ie,this.charset=ce}function ye(ie){var ce;switch(ie.version){case 1:this.names=G.standardNames.slice();break;case 2:for(this.names=new Array(ie.numberOfGlyphs),ce=0;ce<ie.numberOfGlyphs;ce++)this.names[ce]=ie.glyphNameIndex[ce]<G.standardNames.length?G.standardNames[ie.glyphNameIndex[ce]]:ie.names[ie.glyphNameIndex[ce]-G.standardNames.length];break;case 2.5:for(this.names=new Array(ie.numberOfGlyphs),ce=0;ce<ie.numberOfGlyphs;ce++)this.names[ce]=G.standardNames[ce+ie.glyphNameIndex[ce]];break;case 3:this.names=[]}}M.prototype.charToGlyphIndex=function(ie){var ce=ie.charCodeAt(0),fe=this.font.glyphs;if(!fe)return null;for(var ae=0;ae<fe.length;ae+=1)for(var W=fe.get(ae),Z=0;Z<W.unicodes.length;Z+=1)if(W.unicodes[Z]===ce)return ae},P.prototype.charToGlyphIndex=function(ie){return this.cmap.glyphIndexMap[ie.charCodeAt(0)]||0},de.prototype.charToGlyphIndex=function(ie){var ce=ie.charCodeAt(0);return this.charset.indexOf(this.encoding[ce])},ye.prototype.nameToGlyphIndex=function(ie){return this.names.indexOf(ie)},ye.prototype.glyphIndexToName=function(ie){return this.names[ie]},G.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],G.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],G.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],G.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],G.DefaultEncoding=M,G.CmapEncoding=P,G.CffEncoding=de,G.GlyphNames=ye,G.addGlyphNames=function(ie){for(var ce,fe=ie.tables.cmap.glyphIndexMap,ae=Object.keys(fe),W=0;W<ae.length;W+=1){var Z=ae[W];(ce=ie.glyphs.get(fe[Z])).addUnicode(parseInt(Z))}for(W=0;W<ie.glyphs.length;W+=1)ce=ie.glyphs.get(W),ie.cffEncoding?ce.name=ie.cffEncoding.charset[W]:ie.glyphNames.names&&(ce.name=ie.glyphNames.glyphIndexToName(W))}},{}],5:[function(B,D,G){function M(ae){(ae=ae||{}).empty||(fe.checkArgument(ae.familyName,"When creating a new Font object, familyName is required."),fe.checkArgument(ae.styleName,"When creating a new Font object, styleName is required."),fe.checkArgument(ae.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),fe.checkArgument(ae.ascender,"When creating a new Font object, ascender is required."),fe.checkArgument(ae.descender,"When creating a new Font object, descender is required."),fe.checkArgument(ae.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:ae.familyName||" "},fontSubfamily:{en:ae.styleName||" "},fullName:{en:ae.fullName||ae.familyName+" "+ae.styleName},postScriptName:{en:ae.postScriptName||ae.familyName+ae.styleName},designer:{en:ae.designer||" "},designerURL:{en:ae.designerURL||" "},manufacturer:{en:ae.manufacturer||" "},manufacturerURL:{en:ae.manufacturerURL||" "},license:{en:ae.license||" "},licenseURL:{en:ae.licenseURL||" "},version:{en:ae.version||"Version 0.1"},description:{en:ae.description||" "},copyright:{en:ae.copyright||" "},trademark:{en:ae.trademark||" "}},this.unitsPerEm=ae.unitsPerEm||1e3,this.ascender=ae.ascender,this.descender=ae.descender,this.createdTimestamp=ae.createdTimestamp,this.tables={os2:{usWeightClass:ae.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:ae.widthClass||this.usWidthClasses.MEDIUM,fsSelection:ae.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new ie.GlyphSet(this,ae.glyphs||[]),this.encoding=new ye.DefaultEncoding(this),this.substitution=new ce(this),this.tables=this.tables||{}}var P=B("./path"),de=B("./tables/sfnt"),ye=B("./encoding"),ie=B("./glyphset"),ce=B("./substitution"),fe=B("./util");M.prototype.hasChar=function(ae){return null!==this.encoding.charToGlyphIndex(ae)},M.prototype.charToGlyphIndex=function(ae){return this.encoding.charToGlyphIndex(ae)},M.prototype.charToGlyph=function(ae){var W=this.charToGlyphIndex(ae),Z=this.glyphs.get(W);return Z||(Z=this.glyphs.get(0)),Z},M.prototype.stringToGlyphs=function(ae){for(var W=[],Z=0;Z<ae.length;Z+=1)W.push(this.charToGlyph(ae[Z]));return W},M.prototype.nameToGlyphIndex=function(ae){return this.glyphNames.nameToGlyphIndex(ae)},M.prototype.nameToGlyph=function(ae){var W=this.nametoGlyphIndex(ae),Z=this.glyphs.get(W);return Z||(Z=this.glyphs.get(0)),Z},M.prototype.glyphIndexToName=function(ae){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(ae):""},M.prototype.getKerningValue=function(ae,W){ae=ae.index||ae,W=W.index||W;var Z=this.getGposKerningValue;return Z?Z(ae,W):this.kerningPairs[ae+","+W]||0},M.prototype.forEachGlyph=function(ae,W,Z,A,R,X){W=void 0!==W?W:0,Z=void 0!==Z?Z:0;for(var he=void 0===(R=R||{}).kerning||R.kerning,U=1/this.unitsPerEm*(A=void 0!==A?A:72),Re=this.stringToGlyphs(ae),Q=0;Q<Re.length;Q+=1){var be=Re[Q];X(be,W,Z,A,R),be.advanceWidth&&(W+=be.advanceWidth*U),he&&Q<Re.length-1&&(W+=this.getKerningValue(be,Re[Q+1])*U)}},M.prototype.getPath=function(ae,W,Z,A,R){var X=new P.Path;return this.forEachGlyph(ae,W,Z,A,R,function(he,U,Re,Q){var be=he.getPath(U,Re,Q);X.extend(be)}),X},M.prototype.getPaths=function(ae,W,Z,A,R){var X=[];return this.forEachGlyph(ae,W,Z,A,R,function(he,U,Re,Q){var be=he.getPath(U,Re,Q);X.push(be)}),X},M.prototype.draw=function(ae,W,Z,A,R,X){this.getPath(W,Z,A,R,X).draw(ae)},M.prototype.drawPoints=function(ae,W,Z,A,R,X){this.forEachGlyph(W,Z,A,R,X,function(he,U,Re,Q){he.drawPoints(ae,U,Re,Q)})},M.prototype.drawMetrics=function(ae,W,Z,A,R,X){this.forEachGlyph(W,Z,A,R,X,function(he,U,Re,Q){he.drawMetrics(ae,U,Re,Q)})},M.prototype.getEnglishName=function(ae){var W=this.names[ae];return W?W.en:void 0},M.prototype.validate=function(){function ae(R,X){R||Z.push(X)}function W(R){var X=A.getEnglishName(R);ae(X&&X.trim().length>0,"No English "+R+" specified.")}var Z=[],A=this;W("fontFamily"),W("weightName"),W("manufacturer"),W("copyright"),W("version"),ae(this.unitsPerEm>0,"No unitsPerEm specified.")},M.prototype.toTables=function(){return de.fontToTable(this)},M.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},M.prototype.toArrayBuffer=function(){for(var ae=this.toTables().encode(),W=new ArrayBuffer(ae.length),Z=new Uint8Array(W),A=0;A<ae.length;A++)Z[A]=ae[A];return W},M.prototype.download=function(){var ae=this.getEnglishName("fontFamily"),W=this.getEnglishName("fontSubfamily"),Z=ae.replace(/\s/g,"")+"-"+W+".otf",A=this.toArrayBuffer();if(fe.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,A.byteLength,function(he){he.root.getFile(Z,{create:!0},function(U){U.createWriter(function(Re){var Q=new DataView(A),be=new Blob([Q],{type:"font/opentype"});Re.write(be),Re.addEventListener("writeend",function(){location.href=U.toURL()},!1)})})},function(he){throw new Error(he.name+": "+he.message)});else{var R=B("fs"),X=fe.arrayBufferToNodeBuffer(A);R.writeFileSync(Z,X)}},M.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},M.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},M.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},G.Font=M},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(B,D,G){function M(ie){this.bindConstructorValues(ie)}var P=B("./check"),de=B("./draw"),ye=B("./path");M.prototype.bindConstructorValues=function(ie){var fe;this.index=ie.index||0,this.name=ie.name||null,this.unicode=ie.unicode||void 0,this.unicodes=ie.unicodes||void 0!==ie.unicode?[ie.unicode]:[],ie.xMin&&(this.xMin=ie.xMin),ie.yMin&&(this.yMin=ie.yMin),ie.xMax&&(this.xMax=ie.xMax),ie.yMax&&(this.yMax=ie.yMax),ie.advanceWidth&&(this.advanceWidth=ie.advanceWidth),Object.defineProperty(this,"path",(fe=ie.path||{commands:[]},{configurable:!0,get:function(){return"function"==typeof fe&&(fe=fe()),fe},set:function(ae){fe=ae}}))},M.prototype.addUnicode=function(ie){0===this.unicodes.length&&(this.unicode=ie),this.unicodes.push(ie)},M.prototype.getPath=function(ie,ce,fe,ae){ie=void 0!==ie?ie:0,ce=void 0!==ce?ce:0;for(var W=1/this.path.unitsPerEm*(fe=void 0!==fe?fe:72),Z=(ae=void 0!==ae?ae:{xScale:1,yScale:1}).xScale*W,A=ae.yScale*W,R=new ye.Path,X=this.path.commands,he=0;he<X.length;he+=1){var U=X[he];"M"===U.type?R.moveTo(ie+U.x*Z,ce+-U.y*A):"L"===U.type?R.lineTo(ie+U.x*Z,ce+-U.y*A):"Q"===U.type?R.quadraticCurveTo(ie+U.x1*Z,ce+-U.y1*A,ie+U.x*Z,ce+-U.y*A):"C"===U.type?R.curveTo(ie+U.x1*Z,ce+-U.y1*A,ie+U.x2*Z,ce+-U.y2*A,ie+U.x*Z,ce+-U.y*A):"Z"===U.type&&R.closePath()}return R},M.prototype.getContours=function(){if(void 0===this.points)return[];for(var ie=[],ce=[],fe=0;fe<this.points.length;fe+=1){var ae=this.points[fe];ce.push(ae),ae.lastPointOfContour&&(ie.push(ce),ce=[])}return P.argument(0===ce.length,"There are still points left in the current contour."),ie},M.prototype.getMetrics=function(){for(var ie=this.path.commands,ce=[],fe=[],ae=0;ae<ie.length;ae+=1){var W=ie[ae];"Z"!==W.type&&(ce.push(W.x),fe.push(W.y)),("Q"===W.type||"C"===W.type)&&(ce.push(W.x1),fe.push(W.y1)),"C"===W.type&&(ce.push(W.x2),fe.push(W.y2))}var Z={xMin:Math.min.apply(null,ce),yMin:Math.min.apply(null,fe),xMax:Math.max.apply(null,ce),yMax:Math.max.apply(null,fe),leftSideBearing:this.leftSideBearing};return isFinite(Z.xMin)||(Z.xMin=0),isFinite(Z.xMax)||(Z.xMax=this.advanceWidth),isFinite(Z.yMin)||(Z.yMin=0),isFinite(Z.yMax)||(Z.yMax=0),Z.rightSideBearing=this.advanceWidth-Z.leftSideBearing-(Z.xMax-Z.xMin),Z},M.prototype.draw=function(ie,ce,fe,ae,W){this.getPath(ce,fe,ae,W).draw(ie)},M.prototype.drawPoints=function(ie,ce,fe,ae){function W(Re,Q,be,Pe){var Ge=2*Math.PI;ie.beginPath();for(var Ae=0;Ae<Re.length;Ae+=1)ie.moveTo(Q+Re[Ae].x*Pe,be+Re[Ae].y*Pe),ie.arc(Q+Re[Ae].x*Pe,be+Re[Ae].y*Pe,2,0,Ge,!1);ie.closePath(),ie.fill()}ce=void 0!==ce?ce:0,fe=void 0!==fe?fe:0;for(var Z=1/this.path.unitsPerEm*(ae=void 0!==ae?ae:24),A=[],R=[],X=this.path,he=0;he<X.commands.length;he+=1){var U=X.commands[he];void 0!==U.x&&A.push({x:U.x,y:-U.y}),void 0!==U.x1&&R.push({x:U.x1,y:-U.y1}),void 0!==U.x2&&R.push({x:U.x2,y:-U.y2})}ie.fillStyle="blue",W(A,ce,fe,Z),ie.fillStyle="red",W(R,ce,fe,Z)},M.prototype.drawMetrics=function(ie,ce,fe,ae){var W;ce=void 0!==ce?ce:0,fe=void 0!==fe?fe:0,W=1/this.path.unitsPerEm*(ae=void 0!==ae?ae:24),ie.lineWidth=1,ie.strokeStyle="black",de.line(ie,ce,-1e4,ce,1e4),de.line(ie,-1e4,fe,1e4,fe);var Z=this.xMin||0,A=this.yMin||0,R=this.xMax||0,X=this.yMax||0,he=this.advanceWidth||0;ie.strokeStyle="blue",de.line(ie,ce+Z*W,-1e4,ce+Z*W,1e4),de.line(ie,ce+R*W,-1e4,ce+R*W,1e4),de.line(ie,-1e4,fe+-A*W,1e4,fe+-A*W),de.line(ie,-1e4,fe+-X*W,1e4,fe+-X*W),ie.strokeStyle="green",de.line(ie,ce+he*W,-1e4,ce+he*W,1e4)},G.Glyph=M},{"./check":2,"./draw":3,"./path":11}],7:[function(B,D,G){function M(ye,ie,ce){Object.defineProperty(ye,ie,{get:function(){return ye[ce]},set:function(fe){ye[ce]=fe},enumerable:!0,configurable:!0})}function P(ye,ie){if(this.font=ye,this.glyphs={},Array.isArray(ie))for(var ce=0;ce<ie.length;ce++)this.glyphs[ce]=ie[ce];this.length=ie&&ie.length||0}var de=B("./glyph");P.prototype.get=function(ye){return"function"==typeof this.glyphs[ye]&&(this.glyphs[ye]=this.glyphs[ye]()),this.glyphs[ye]},P.prototype.push=function(ye,ie){this.glyphs[ye]=ie,this.length++},G.GlyphSet=P,G.glyphLoader=function(ye,ie){return new de.Glyph({index:ie,font:ye})},G.ttfGlyphLoader=function(ye,ie,ce,fe,ae,W){return function(){var Z=new de.Glyph({index:ie,font:ye});return Z.path=function(){ce(Z,fe,ae);var A=W(ye.glyphs,Z);return A.unitsPerEm=ye.unitsPerEm,A},M(Z,"xMin","_xMin"),M(Z,"xMax","_xMax"),M(Z,"yMin","_yMin"),M(Z,"yMax","_yMax"),Z}},G.cffGlyphLoader=function(ye,ie,ce,fe){return function(){var ae=new de.Glyph({index:ie,font:ye});return ae.path=function(){var W=ce(ye,ae,fe);return W.unitsPerEm=ye.unitsPerEm,W},ae}}},{"./glyph":6}],8:[function(B,D,G){function M(ye,ie){for(var ce=0,fe=ye.length-1;fe>=ce;){var ae=ce+fe>>>1,W=ye[ae].tag;if(W===ie)return ae;ie>W?ce=ae+1:fe=ae-1}return-ce-1}var P=B("./check");D.exports={searchTag:M,binSearch:function(ye,ie){for(var ce=0,fe=ye.length-1;fe>=ce;){var ae=ce+fe>>>1,W=ye[ae];if(W===ie)return ae;ie>W?ce=ae+1:fe=ae-1}return-ce-1},getScriptNames:function(){var ye=this.getGsubTable();return ye?ye.scripts.map(function(ie){return ie.tag}):[]},getScriptTable:function(ye,ie){var ce=this.getGsubTable(ie);if(ce){var fe=ce.scripts,ae=M(ce.scripts,ye);if(ae>=0)return fe[ae].script;var W={tag:ye,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return fe.splice(-1-ae,0,W.script),W}},getLangSysTable:function(ye,ie,ce){var fe=this.getScriptTable(ye,ce);if(fe){if("DFLT"===ie)return fe.defaultLangSys;var ae=M(fe.langSysRecords,ie);if(ae>=0)return fe.langSysRecords[ae].langSys;if(ce){var W={tag:ie,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return fe.langSysRecords.splice(-1-ae,0,W),W.langSys}}},getFeatureTable:function(ye,ie,ce,fe){var ae=this.getLangSysTable(ye,ie,fe);if(ae){for(var W,Z=ae.featureIndexes,A=this.font.tables.gsub.features,R=0;R<Z.length;R++)if((W=A[Z[R]]).tag===ce)return W.feature;if(fe){var X=A.length;return P.assert(0===X||ce>=A[X-1].tag,"Features must be added in alphabetical order."),A.push(W={tag:ce,feature:{params:0,lookupListIndexes:[]}}),Z.push(X),W.feature}}},getLookupTable:function(ye,ie,ce,fe,ae){var W=this.getFeatureTable(ye,ie,ce,ae);if(W){for(var Z,A=W.lookupListIndexes,R=this.font.tables.gsub.lookups,X=0;X<A.length;X++)if((Z=R[A[X]]).lookupType===fe)return Z;if(ae){var he=R.length;return R.push(Z={lookupType:fe,lookupFlag:0,subtables:[],markFilteringSet:void 0}),A.push(he),Z}}},expandCoverage:function(ye){if(1===ye.format)return ye.glyphs;for(var ie=[],ce=ye.ranges,fe=0;ce>fe;fe++)for(var ae=ce[fe],Z=ae.end,A=ae.start;Z>=A;A++)ie.push(A);return ie}}},{"./check":2}],9:[function(B,D,G){function M(sn,gt){B("fs").readFile(sn,function(An,Bn){return An?gt(An.message):void gt(null,R.nodeBufferToArrayBuffer(Bn))})}function P(sn,gt){var An=new XMLHttpRequest;An.open("get",sn,!0),An.responseType="arraybuffer",An.onload=function(){return 200!==An.status?gt("Font could not be loaded: "+An.statusText):gt(null,An.response)},An.send()}function de(sn,gt){for(var An=[],Bn=12,dn=0;gt>dn;dn+=1){var On=Z.getTag(sn,Bn),Ln=Z.getULong(sn,Bn+4),mn=Z.getULong(sn,Bn+8),cr=Z.getULong(sn,Bn+12);An.push({tag:On,checksum:Ln,offset:mn,length:cr,compression:!1}),Bn+=16}return An}function ye(sn,gt){if("WOFF"===gt.compression){var An=new Uint8Array(sn.buffer,gt.offset+2,gt.compressedLength-2),Bn=new Uint8Array(gt.originalLength);if(ce(An,Bn),Bn.byteLength!==gt.originalLength)throw new Error("Decompression error: "+gt.tag+" decompressed length doesn't match recorded length");return{data:new DataView(Bn.buffer,0),offset:0}}return{data:sn,offset:gt.offset}}function ie(sn){var gt,An,Bn,dn=new ae.Font({empty:!0}),On=new DataView(sn,0),Ln=[],mn=Z.getTag(On,0);if(mn===String.fromCharCode(0,1,0,0))dn.outlinesFormat="truetype",Ln=de(On,Bn=Z.getUShort(On,4));else if("OTTO"===mn)dn.outlinesFormat="cff",Ln=de(On,Bn=Z.getUShort(On,4));else{if("wOFF"!==mn)throw new Error("Unsupported OpenType signature "+mn);var cr=Z.getTag(On,4);if(cr===String.fromCharCode(0,1,0,0))dn.outlinesFormat="truetype";else{if("OTTO"!==cr)throw new Error("Unsupported OpenType flavor "+mn);dn.outlinesFormat="cff"}Ln=function(Hu,us){for(var qs=[],ai=44,Gc=0;us>Gc;Gc+=1){var sl=Z.getTag(Hu,ai),Gp=Z.getULong(Hu,ai+4),ca=Z.getULong(Hu,ai+8),Wl=Z.getULong(Hu,ai+12);qs.push({tag:sl,offset:Gp,compression:Wl>ca&&"WOFF",compressedLength:ca,originalLength:Wl}),ai+=20}return qs}(On,Bn=Z.getUShort(On,12))}for(var rr,ur,or,ni,Kr,pi,nr,vr,mi,_o,Nr=0;Bn>Nr;Nr+=1){var ei,Wr=Ln[Nr];switch(Wr.tag){case"cmap":ei=ye(On,Wr),dn.tables.cmap=X.parse(ei.data,ei.offset),dn.encoding=new fe.CmapEncoding(dn.tables.cmap);break;case"fvar":ur=Wr;break;case"head":ei=ye(On,Wr),dn.tables.head=Pe.parse(ei.data,ei.offset),dn.unitsPerEm=dn.tables.head.unitsPerEm,gt=dn.tables.head.indexToLocFormat;break;case"hhea":ei=ye(On,Wr),dn.tables.hhea=Ge.parse(ei.data,ei.offset),dn.ascender=dn.tables.hhea.ascender,dn.descender=dn.tables.hhea.descender,dn.numberOfHMetrics=dn.tables.hhea.numberOfHMetrics;break;case"hmtx":pi=Wr;break;case"ltag":ei=ye(On,Wr),An=Ke.parse(ei.data,ei.offset);break;case"maxp":ei=ye(On,Wr),dn.tables.maxp=dt.parse(ei.data,ei.offset),dn.numGlyphs=dn.tables.maxp.numGlyphs;break;case"name":mi=Wr;break;case"OS/2":ei=ye(On,Wr),dn.tables.os2=wt.parse(ei.data,ei.offset);break;case"post":ei=ye(On,Wr),dn.tables.post=Gt.parse(ei.data,ei.offset),dn.glyphNames=new fe.GlyphNames(dn.tables.post);break;case"glyf":or=Wr;break;case"loca":vr=Wr;break;case"CFF ":rr=Wr;break;case"kern":nr=Wr;break;case"GPOS":ni=Wr;break;case"GSUB":Kr=Wr;break;case"meta":_o=Wr}}var yi=ye(On,mi);if(dn.tables.name=It.parse(yi.data,yi.offset,An),dn.names=dn.tables.name,or&&vr){var Ei=0===gt,So=ye(On,vr),Ws=yt.parse(So.data,So.offset,dn.numGlyphs,Ei),la=ye(On,or);dn.glyphs=Re.parse(la.data,la.offset,Ws,dn)}else{if(!rr)throw new Error("Font doesn't contain TrueType or CFF outlines.");var Ni=ye(On,rr);he.parse(Ni.data,Ni.offset,dn)}var Eo=ye(On,pi);if(Ae.parse(Eo.data,Eo.offset,dn.numberOfHMetrics,dn.numGlyphs,dn.glyphs),fe.addGlyphNames(dn),nr){var go=ye(On,nr);dn.kerningPairs=Xe.parse(go.data,go.offset)}else dn.kerningPairs={};if(ni){var Jr=ye(On,ni);Q.parse(Jr.data,Jr.offset,dn)}if(Kr){var os=ye(On,Kr);dn.tables.gsub=be.parse(os.data,os.offset)}if(ur){var Ir=ye(On,ur);dn.tables.fvar=U.parse(Ir.data,Ir.offset,dn.names)}if(_o){var Va=ye(On,_o);dn.tables.meta=Dt.parse(Va.data,Va.offset),dn.metas=dn.tables.meta}return dn}var ce=B("tiny-inflate"),fe=B("./encoding"),ae=B("./font"),W=B("./glyph"),Z=B("./parse"),A=B("./path"),R=B("./util"),X=B("./tables/cmap"),he=B("./tables/cff"),U=B("./tables/fvar"),Re=B("./tables/glyf"),Q=B("./tables/gpos"),be=B("./tables/gsub"),Pe=B("./tables/head"),Ge=B("./tables/hhea"),Ae=B("./tables/hmtx"),Xe=B("./tables/kern"),Ke=B("./tables/ltag"),yt=B("./tables/loca"),dt=B("./tables/maxp"),It=B("./tables/name"),wt=B("./tables/os2"),Gt=B("./tables/post"),Dt=B("./tables/meta");G._parse=Z,G.Font=ae.Font,G.Glyph=W.Glyph,G.Path=A.Path,G.parse=ie,G.load=function(sn,gt){(typeof window>"u"?M:P)(sn,function(An,Bn){if(An)return gt(An);var dn;try{dn=ie(Bn)}catch(On){return gt(On,null)}return gt(null,dn)})},G.loadSync=function(sn){var gt=B("fs").readFileSync(sn);return ie(R.nodeBufferToArrayBuffer(gt))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(B,D,G){function M(ce,fe){return ce.getUint16(fe,!1)}function P(ce,fe){this.data=ce,this.offset=fe,this.relativeOffset=0}var de=B("./check");G.getByte=function(ce,fe){return ce.getUint8(fe)},G.getCard8=G.getByte,G.getUShort=G.getCard16=M,G.getShort=function(ce,fe){return ce.getInt16(fe,!1)},G.getULong=function(ce,fe){return ce.getUint32(fe,!1)},G.getFixed=function(ce,fe){return ce.getInt16(fe,!1)+ce.getUint16(fe+2,!1)/65535},G.getTag=function(ce,fe){for(var ae="",W=fe;fe+4>W;W+=1)ae+=String.fromCharCode(ce.getInt8(W));return ae},G.getOffset=function(ce,fe,ae){for(var W=0,Z=0;ae>Z;Z+=1)W<<=8,W+=ce.getUint8(fe+Z);return W},G.getBytes=function(ce,fe,ae){for(var W=[],Z=fe;ae>Z;Z+=1)W.push(ce.getUint8(Z));return W},G.bytesToString=function(ce){for(var fe="",ae=0;ae<ce.length;ae+=1)fe+=String.fromCharCode(ce[ae]);return fe};var ye={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};P.prototype.parseByte=function(){var ce=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ce},P.prototype.parseChar=function(){var ce=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ce},P.prototype.parseCard8=P.prototype.parseByte,P.prototype.parseCard16=P.prototype.parseUShort=function(){var ce=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ce},P.prototype.parseSID=P.prototype.parseUShort,P.prototype.parseOffset16=P.prototype.parseUShort,P.prototype.parseShort=function(){var ce=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ce},P.prototype.parseF2Dot14=function(){var ce=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,ce},P.prototype.parseULong=function(){var ce=G.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ce},P.prototype.parseFixed=function(){var ce=G.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ce},P.prototype.parseString=function(ce){var fe=this.data,ae=this.offset+this.relativeOffset,W="";this.relativeOffset+=ce;for(var Z=0;ce>Z;Z++)W+=String.fromCharCode(fe.getUint8(ae+Z));return W},P.prototype.parseTag=function(){return this.parseString(4)},P.prototype.parseLongDateTime=function(){var ce=G.getULong(this.data,this.offset+this.relativeOffset+4);return ce-=2082844800,this.relativeOffset+=8,ce},P.prototype.parseVersion=function(){var ce=M(this.data,this.offset+this.relativeOffset),fe=M(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,ce+fe/4096/10},P.prototype.skip=function(ce,fe){void 0===fe&&(fe=1),this.relativeOffset+=ye[ce]*fe},P.prototype.parseOffset16List=P.prototype.parseUShortList=function(ce){void 0===ce&&(ce=this.parseUShort());for(var fe=new Array(ce),ae=this.data,W=this.offset+this.relativeOffset,Z=0;ce>Z;Z++)fe[Z]=ae.getUint16(W),W+=2;return this.relativeOffset+=2*ce,fe},P.prototype.parseList=function(ce,fe){fe||(fe=ce,ce=this.parseUShort());for(var ae=new Array(ce),W=0;ce>W;W++)ae[W]=fe.call(this);return ae},P.prototype.parseRecordList=function(ce,fe){fe||(fe=ce,ce=this.parseUShort());for(var ae=new Array(ce),W=Object.keys(fe),Z=0;ce>Z;Z++){for(var A={},R=0;R<W.length;R++){var X=W[R];A[X]=fe[X].call(this)}ae[Z]=A}return ae},P.prototype.parseStruct=function(ce){if("function"==typeof ce)return ce.call(this);for(var fe=Object.keys(ce),ae={},W=0;W<fe.length;W++){var Z=fe[W];ae[Z]=ce[Z].call(this)}return ae},P.prototype.parsePointer=function(ce){var fe=this.parseOffset16();return fe>0?new P(this.data,this.offset+fe).parseStruct(ce):void 0},P.prototype.parseListOfLists=function(ce){for(var fe=this.parseOffset16List(),ae=fe.length,W=this.relativeOffset,Z=new Array(ae),A=0;ae>A;A++){var R=fe[A];if(0!==R)if(this.relativeOffset=R,ce){for(var X=this.parseOffset16List(),he=new Array(X.length),U=0;U<X.length;U++)this.relativeOffset=R+X[U],he[U]=ce.call(this);Z[A]=he}else Z[A]=this.parseUShortList();else Z[A]=void 0}return this.relativeOffset=W,Z},P.prototype.parseCoverage=function(){var ce=this.offset+this.relativeOffset,fe=this.parseUShort(),ae=this.parseUShort();if(1===fe)return{format:1,glyphs:this.parseUShortList(ae)};if(2===fe){for(var W=new Array(ae),Z=0;ae>Z;Z++)W[Z]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:W}}de.assert(!1,"0x"+ce.toString(16)+": Coverage format must be 1 or 2.")},P.prototype.parseClassDef=function(){var ce=this.offset+this.relativeOffset,fe=this.parseUShort();return 1===fe?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===fe?{format:2,ranges:this.parseRecordList({start:P.uShort,end:P.uShort,classId:P.uShort})}:void de.assert(!1,"0x"+ce.toString(16)+": ClassDef format must be 1 or 2.")},P.list=function(ce,fe){return function(){return this.parseList(ce,fe)}},P.recordList=function(ce,fe){return function(){return this.parseRecordList(ce,fe)}},P.pointer=function(ce){return function(){return this.parsePointer(ce)}},P.tag=P.prototype.parseTag,P.byte=P.prototype.parseByte,P.uShort=P.offset16=P.prototype.parseUShort,P.uShortList=P.prototype.parseUShortList,P.struct=P.prototype.parseStruct,P.coverage=P.prototype.parseCoverage,P.classDef=P.prototype.parseClassDef;var ie={reserved:P.uShort,reqFeatureIndex:P.uShort,featureIndexes:P.uShortList};P.prototype.parseScriptList=function(){return this.parsePointer(P.recordList({tag:P.tag,script:P.pointer({defaultLangSys:P.pointer(ie),langSysRecords:P.recordList({tag:P.tag,langSys:P.pointer(ie)})})}))},P.prototype.parseFeatureList=function(){return this.parsePointer(P.recordList({tag:P.tag,feature:P.pointer({featureParams:P.offset16,lookupListIndexes:P.uShortList})}))},P.prototype.parseLookupList=function(ce){return this.parsePointer(P.list(P.pointer(function(){var fe=this.parseUShort();de.argument(fe>=1&&8>=fe,"GSUB lookup type "+fe+" unknown.");var ae=this.parseUShort(),W=16&ae;return{lookupType:fe,lookupFlag:ae,subtables:this.parseList(P.pointer(ce[fe])),markFilteringSet:W?this.parseUShort():void 0}})))},G.Parser=P},{"./check":2}],11:[function(B,D,G){function M(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}M.prototype.moveTo=function(P,de){this.commands.push({type:"M",x:P,y:de})},M.prototype.lineTo=function(P,de){this.commands.push({type:"L",x:P,y:de})},M.prototype.curveTo=M.prototype.bezierCurveTo=function(P,de,ye,ie,ce,fe){this.commands.push({type:"C",x1:P,y1:de,x2:ye,y2:ie,x:ce,y:fe})},M.prototype.quadTo=M.prototype.quadraticCurveTo=function(P,de,ye,ie){this.commands.push({type:"Q",x1:P,y1:de,x:ye,y:ie})},M.prototype.close=M.prototype.closePath=function(){this.commands.push({type:"Z"})},M.prototype.extend=function(P){P.commands&&(P=P.commands),Array.prototype.push.apply(this.commands,P)},M.prototype.draw=function(P){P.beginPath();for(var de=0;de<this.commands.length;de+=1){var ye=this.commands[de];"M"===ye.type?P.moveTo(ye.x,ye.y):"L"===ye.type?P.lineTo(ye.x,ye.y):"C"===ye.type?P.bezierCurveTo(ye.x1,ye.y1,ye.x2,ye.y2,ye.x,ye.y):"Q"===ye.type?P.quadraticCurveTo(ye.x1,ye.y1,ye.x,ye.y):"Z"===ye.type&&P.closePath()}this.fill&&(P.fillStyle=this.fill,P.fill()),this.stroke&&(P.strokeStyle=this.stroke,P.lineWidth=this.strokeWidth,P.stroke())},M.prototype.toPathData=function(P){function de(ae){return Math.round(ae)===ae?""+Math.round(ae):ae.toFixed(P)}function ye(){for(var ae="",W=0;W<arguments.length;W+=1){var Z=arguments[W];Z>=0&&W>0&&(ae+=" "),ae+=de(Z)}return ae}P=void 0!==P?P:2;for(var ie="",ce=0;ce<this.commands.length;ce+=1){var fe=this.commands[ce];"M"===fe.type?ie+="M"+ye(fe.x,fe.y):"L"===fe.type?ie+="L"+ye(fe.x,fe.y):"C"===fe.type?ie+="C"+ye(fe.x1,fe.y1,fe.x2,fe.y2,fe.x,fe.y):"Q"===fe.type?ie+="Q"+ye(fe.x1,fe.y1,fe.x,fe.y):"Z"===fe.type&&(ie+="Z")}return ie},M.prototype.toSVG=function(P){var de='<path d="';return de+=this.toPathData(P),de+='"',this.fill&&"black"!==this.fill&&(de+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(de+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),de+"/>"},G.Path=M},{}],12:[function(B,D,G){function M(ce,fe){var ae=ce.length;if(ae!==fe.length)return!1;for(var W=0;ae>W;W++)if(ce[W]!==fe[W])return!1;return!0}function P(ce,fe,ae){for(var W=ce.subtables,Z=0;Z<W.length;Z++){var A=W[Z];if(A.substFormat===fe)return A}return ae?(W.push(ae),ae):void 0}var de=B("./check"),ye=B("./layout"),ie=function(ce){this.font=ce};(ie.prototype=ye).getGsubTable=function(ce){var fe=this.font.tables.gsub;return!fe&&ce&&(this.font.tables.gsub=fe={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),fe},ie.prototype.getSingle=function(ce,fe,ae){var W=[],Z=this.getLookupTable(fe,ae,ce,1);if(!Z)return W;for(var A=Z.subtables,R=0;R<A.length;R++){var X,he=A[R],U=this.expandCoverage(he.coverage);if(1===he.substFormat){var Re=he.deltaGlyphId;for(X=0;X<U.length;X++){var Q=U[X];W.push({sub:Q,by:Q+Re})}}else{var be=he.substitute;for(X=0;X<U.length;X++)W.push({sub:U[X],by:be[X]})}}return W},ie.prototype.getAlternates=function(ce,fe,ae){var W=[],Z=this.getLookupTable(fe,ae,ce,3);if(!Z)return W;for(var A=Z.subtables,R=0;R<A.length;R++)for(var X=A[R],he=this.expandCoverage(X.coverage),U=X.alternateSets,Re=0;Re<he.length;Re++)W.push({sub:he[Re],by:U[Re]});return W},ie.prototype.getLigatures=function(ce,fe,ae){var W=[],Z=this.getLookupTable(fe,ae,ce,4);if(!Z)return[];for(var A=Z.subtables,R=0;R<A.length;R++)for(var X=A[R],he=this.expandCoverage(X.coverage),U=X.ligatureSets,Re=0;Re<he.length;Re++)for(var Q=he[Re],be=U[Re],Pe=0;Pe<be.length;Pe++){var Ge=be[Pe];W.push({sub:[Q].concat(Ge.components),by:Ge.ligGlyph})}return W},ie.prototype.addSingle=function(ce,fe,ae,W){var Z=P(this.getLookupTable(ae,W,ce,1,!0),2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});de.assert(1===Z.coverage.format,"Ligature: unable to modify coverage table format "+Z.coverage.format);var A=fe.sub,R=this.binSearch(Z.coverage.glyphs,A);0>R&&(Z.coverage.glyphs.splice(R=-1-R,0,A),Z.substitute.splice(R,0,0)),Z.substitute[R]=fe.by},ie.prototype.addAlternate=function(ce,fe,ae,W){var Z=P(this.getLookupTable(ae,W,ce,3,!0),1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});de.assert(1===Z.coverage.format,"Ligature: unable to modify coverage table format "+Z.coverage.format);var A=fe.sub,R=this.binSearch(Z.coverage.glyphs,A);0>R&&(Z.coverage.glyphs.splice(R=-1-R,0,A),Z.alternateSets.splice(R,0,0)),Z.alternateSets[R]=fe.by},ie.prototype.addLigature=function(ce,fe,ae,W){var Z=this.getLookupTable(ae=ae||"DFLT",W=W||"DFLT",ce,4,!0),A=Z.subtables[0];A||(Z.subtables[0]=A={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),de.assert(1===A.coverage.format,"Ligature: unable to modify coverage table format "+A.coverage.format);var R=fe.sub[0],X=fe.sub.slice(1),he={ligGlyph:fe.by,components:X},U=this.binSearch(A.coverage.glyphs,R);if(U>=0){for(var Re=A.ligatureSets[U],Q=0;Q<Re.length;Q++)if(M(Re[Q].components,X))return;Re.push(he)}else A.coverage.glyphs.splice(U=-1-U,0,R),A.ligatureSets.splice(U,0,[he])},ie.prototype.getFeature=function(ce,fe,ae){if(fe=fe||"DFLT",ae=ae||"DFLT",/ss\d\d/.test(ce))return this.getSingle(ce,fe,ae);switch(ce){case"aalt":case"salt":return this.getSingle(ce,fe,ae).concat(this.getAlternates(ce,fe,ae));case"dlig":case"liga":case"rlig":return this.getLigatures(ce,fe,ae)}},ie.prototype.add=function(ce,fe,ae,W){if(ae=ae||"DFLT",W=W||"DFLT",/ss\d\d/.test(ce))return this.addSingle(ce,fe,ae,W);switch(ce){case"aalt":case"salt":return"number"==typeof fe.by?this.addSingle(ce,fe,ae,W):this.addAlternate(ce,fe,ae,W);case"dlig":case"liga":case"rlig":return this.addLigature(ce,fe,ae,W)}},D.exports=ie},{"./check":2,"./layout":8}],13:[function(B,D,G){function M(R,X,he){var U;for(U=0;U<X.length;U+=1){var Re=X[U];this[Re.name]=Re.value}if(this.tableName=R,this.fields=X,he){var Q=Object.keys(he);for(U=0;U<Q.length;U+=1){var be=Q[U];void 0!==this[be]&&(this[be]=he[be])}}}function P(R,X,he){void 0===he&&(he=X.length);var U=new Array(X.length+1);U[0]={name:R+"Count",type:"USHORT",value:he};for(var Re=0;Re<X.length;Re++)U[Re+1]={name:R+Re,type:"USHORT",value:X[Re]};return U}function de(R,X,he){var U=X.length,Re=new Array(U+1);Re[0]={name:R+"Count",type:"USHORT",value:U};for(var Q=0;U>Q;Q++)Re[Q+1]={name:R+Q,type:"TABLE",value:he(X[Q],Q)};return Re}function ye(R,X,he){var U=X.length,Re=[];Re[0]={name:R+"Count",type:"USHORT",value:U};for(var Q=0;U>Q;Q++)Re=Re.concat(he(X[Q],Q));return Re}function ie(R){1===R.format?M.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(P("glyph",R.glyphs))):W.assert(!1,"Can't create coverage table format 2 yet.")}function ce(R){M.call(this,"scriptListTable",ye("scriptRecord",R,function(X,he){var U=X.script,Re=U.defaultLangSys;return W.assert(!!Re,"Unable to write GSUB: script "+X.tag+" has no default language system."),[{name:"scriptTag"+he,type:"TAG",value:X.tag},{name:"script"+he,type:"TABLE",value:new M("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new M("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Re.reqFeatureIndex}].concat(P("featureIndex",Re.featureIndexes)))}].concat(ye("langSys",U.langSysRecords,function(Q,be){var Pe=Q.langSys;return[{name:"langSysTag"+be,type:"TAG",value:Q.tag},{name:"langSys"+be,type:"TABLE",value:new M("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Pe.reqFeatureIndex}].concat(P("featureIndex",Pe.featureIndexes)))}]})))}]}))}function fe(R){M.call(this,"featureListTable",ye("featureRecord",R,function(X,he){var U=X.feature;return[{name:"featureTag"+he,type:"TAG",value:X.tag},{name:"feature"+he,type:"TABLE",value:new M("featureTable",[{name:"featureParams",type:"USHORT",value:U.featureParams}].concat(P("lookupListIndex",U.lookupListIndexes)))}]}))}function ae(R,X){M.call(this,"lookupListTable",de("lookup",R,function(he){var U=X[he.lookupType];return W.assert(!!U,"Unable to write GSUB lookup type "+he.lookupType+" tables."),new M("lookupTable",[{name:"lookupType",type:"USHORT",value:he.lookupType},{name:"lookupFlag",type:"USHORT",value:he.lookupFlag}].concat(de("subtable",he.subtables,U)))}))}var W=B("./check"),Z=B("./types").encode,A=B("./types").sizeOf;M.prototype.encode=function(){return Z.TABLE(this)},M.prototype.sizeOf=function(){return A.TABLE(this)},(ie.prototype=Object.create(M.prototype)).constructor=ie,(ce.prototype=Object.create(M.prototype)).constructor=ce,(fe.prototype=Object.create(M.prototype)).constructor=fe,(ae.prototype=Object.create(M.prototype)).constructor=ae,G.Record=G.Table=M,G.Coverage=ie,G.ScriptList=ce,G.FeatureList=fe,G.LookupList=ae,G.ushortList=P,G.tableList=de,G.recordList=ye},{"./check":2,"./types":32}],14:[function(B,D,G){function M(Ae,Xe){if(Ae===Xe)return!0;if(Array.isArray(Ae)&&Array.isArray(Xe)){if(Ae.length!==Xe.length)return!1;for(var Ke=0;Ke<Ae.length;Ke+=1)if(!M(Ae[Ke],Xe[Ke]))return!1;return!0}return!1}function P(Ae,Xe,Ke){var yt,dt,It,wt=[],Gt=[],Dt=Re.getCard16(Ae,Xe);if(0!==Dt){var sn=Re.getByte(Ae,Xe+2);dt=Xe+(Dt+1)*sn+2;var gt=Xe+3;for(yt=0;Dt+1>yt;yt+=1)wt.push(Re.getOffset(Ae,gt,sn)),gt+=sn;It=dt+wt[Dt]}else It=Xe+2;for(yt=0;yt<wt.length-1;yt+=1){var An=Re.getBytes(Ae,dt+wt[yt],dt+wt[yt+1]);Ke&&(An=Ke(An)),Gt.push(An)}return{objects:Gt,startOffset:Xe,endOffset:It}}function de(Ae,Xe){if(28===Xe)return Ae.parseByte()<<8|Ae.parseByte();if(29===Xe)return Ae.parseByte()<<24|Ae.parseByte()<<16|Ae.parseByte()<<8|Ae.parseByte();if(30===Xe)return function(Ke){for(var yt="",dt=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var It=Ke.parseByte(),wt=It>>4,Gt=15&It;if(15===wt||(yt+=dt[wt],15===Gt))break;yt+=dt[Gt]}return parseFloat(yt)}(Ae);if(Xe>=32&&246>=Xe)return Xe-139;if(Xe>=247&&250>=Xe)return 256*(Xe-247)+Ae.parseByte()+108;if(Xe>=251&&254>=Xe)return 256*-(Xe-251)-Ae.parseByte()-108;throw new Error("Invalid b0 "+Xe)}function ye(Ae,Xe,Ke){var yt=new Re.Parser(Ae,Xe=void 0!==Xe?Xe:0),dt=[],It=[];for(Ke=void 0!==Ke?Ke:Ae.length;yt.relativeOffset<Ke;){var wt=yt.parseByte();21>=wt?(12===wt&&(wt=1200+yt.parseByte()),dt.push([wt,It]),It=[]):It.push(de(yt,wt))}return function(Gt){for(var Dt={},sn=0;sn<Gt.length;sn+=1){var gt,An=Gt[sn][0],Bn=Gt[sn][1];if(gt=1===Bn.length?Bn[0]:Bn,Dt.hasOwnProperty(An))throw new Error("Object "+Dt+" already has key "+An);Dt[An]=gt}return Dt}(dt)}function ie(Ae,Xe){return 390>=Xe?he.cffStandardStrings[Xe]:Ae[Xe-391]}function ce(Ae,Xe,Ke){for(var yt={},dt=0;dt<Xe.length;dt+=1){var It=Xe[dt],wt=Ae[It.op];void 0===wt&&(wt=void 0!==It.value?It.value:null),"SID"===It.type&&(wt=ie(Ke,wt)),yt[It.name]=wt}return yt}function fe(Ae,Xe,Ke){function yt(cr,rr){On&&sn.closePath(),sn.moveTo(cr,rr),On=!0}function dt(){gt.length%2!=0&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX),An+=gt.length>>1,gt.length=0,Bn=!0}var It,wt,Gt,Dt,sn=new Q.Path,gt=[],An=0,Bn=!1,dn=Ae.defaultWidthX,On=!1,Ln=0,mn=0;return function cr(rr){for(var ur,or,ni,Kr,pi,nr,vr,mi,_o,Nr,ei,Wr,yi=0;yi<rr.length;){var Ei=rr[yi];switch(yi+=1,Ei){case 1:case 3:case 18:case 23:dt();break;case 4:gt.length>1&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),mn+=gt.pop(),yt(Ln,mn);break;case 5:for(;gt.length>0;)Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 6:for(;gt.length>0&&(Ln+=gt.shift(),sn.lineTo(Ln,mn),0!==gt.length);)mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 7:for(;gt.length>0&&(mn+=gt.shift(),sn.lineTo(Ln,mn),0!==gt.length);)Ln+=gt.shift(),sn.lineTo(Ln,mn);break;case 8:for(;gt.length>0;)It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(It,wt,Gt,Dt,Ln,mn);break;case 10:pi=gt.pop()+Ae.subrsBias,(nr=Ae.subrs[pi])&&cr(nr);break;case 11:return;case 12:switch(Ei=rr[yi],yi+=1,Ei){case 35:It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt+gt.shift(),_o=vr+gt.shift(),Nr=mi+gt.shift(),ei=_o+gt.shift(),Wr=Nr+gt.shift(),Ln=ei+gt.shift(),mn=Wr+gt.shift(),gt.shift(),sn.curveTo(It,wt,Gt,Dt,vr,mi),sn.curveTo(_o,Nr,ei,Wr,Ln,mn);break;case 34:It=Ln+gt.shift(),wt=mn,Gt=It+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt,_o=vr+gt.shift(),Nr=Dt,ei=_o+gt.shift(),Wr=mn,Ln=ei+gt.shift(),sn.curveTo(It,wt,Gt,Dt,vr,mi),sn.curveTo(_o,Nr,ei,Wr,Ln,mn);break;case 36:It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt,_o=vr+gt.shift(),Nr=Dt,ei=_o+gt.shift(),Wr=Nr+gt.shift(),Ln=ei+gt.shift(),sn.curveTo(It,wt,Gt,Dt,vr,mi),sn.curveTo(_o,Nr,ei,Wr,Ln,mn);break;case 37:It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),vr=Gt+gt.shift(),mi=Dt+gt.shift(),_o=vr+gt.shift(),Nr=mi+gt.shift(),ei=_o+gt.shift(),Wr=Nr+gt.shift(),Math.abs(ei-Ln)>Math.abs(Wr-mn)?Ln=ei+gt.shift():mn=Wr+gt.shift(),sn.curveTo(It,wt,Gt,Dt,vr,mi),sn.curveTo(_o,Nr,ei,Wr,Ln,mn);break;default:console.log("Glyph "+Xe.index+": unknown operator 1200"+Ei),gt.length=0}break;case 14:gt.length>0&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),On&&(sn.closePath(),On=!1);break;case 19:case 20:dt(),yi+=An+7>>3;break;case 21:gt.length>2&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),mn+=gt.pop(),yt(Ln+=gt.pop(),mn);break;case 22:gt.length>1&&!Bn&&(dn=gt.shift()+Ae.nominalWidthX,Bn=!0),yt(Ln+=gt.pop(),mn);break;case 24:for(;gt.length>2;)It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(It,wt,Gt,Dt,Ln,mn);Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);break;case 25:for(;gt.length>6;)Ln+=gt.shift(),mn+=gt.shift(),sn.lineTo(Ln,mn);It=Ln+gt.shift(),wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+gt.shift(),sn.curveTo(It,wt,Gt,Dt,Ln,mn);break;case 26:for(gt.length%2&&(Ln+=gt.shift());gt.length>0;)It=Ln,wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt,mn=Dt+gt.shift(),sn.curveTo(It,wt,Gt,Dt,Ln,mn);break;case 27:for(gt.length%2&&(mn+=gt.shift());gt.length>0;)It=Ln+gt.shift(),wt=mn,Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),sn.curveTo(It,wt,Gt,Dt,Ln,mn=Dt);break;case 28:gt.push(((ur=rr[yi])<<24|(or=rr[yi+1])<<16)>>16),yi+=2;break;case 29:pi=gt.pop()+Ae.gsubrsBias,(nr=Ae.gsubrs[pi])&&cr(nr);break;case 30:for(;gt.length>0&&(It=Ln,wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+(1===gt.length?gt.shift():0),sn.curveTo(It,wt,Gt,Dt,Ln,mn),0!==gt.length);)It=Ln+gt.shift(),wt=mn,Gt=It+gt.shift(),Dt=wt+gt.shift(),mn=Dt+gt.shift(),Ln=Gt+(1===gt.length?gt.shift():0),sn.curveTo(It,wt,Gt,Dt,Ln,mn);break;case 31:for(;gt.length>0&&(It=Ln+gt.shift(),wt=mn,Gt=It+gt.shift(),Dt=wt+gt.shift(),mn=Dt+gt.shift(),Ln=Gt+(1===gt.length?gt.shift():0),sn.curveTo(It,wt,Gt,Dt,Ln,mn),0!==gt.length);)It=Ln,wt=mn+gt.shift(),Gt=It+gt.shift(),Dt=wt+gt.shift(),Ln=Gt+gt.shift(),mn=Dt+(1===gt.length?gt.shift():0),sn.curveTo(It,wt,Gt,Dt,Ln,mn);break;default:32>Ei?console.log("Glyph "+Xe.index+": unknown operator "+Ei):247>Ei?gt.push(Ei-139):251>Ei?(ur=rr[yi],yi+=1,gt.push(256*(Ei-247)+ur+108)):255>Ei?(ur=rr[yi],yi+=1,gt.push(256*-(Ei-251)-ur-108)):(ur=rr[yi],or=rr[yi+1],ni=rr[yi+2],Kr=rr[yi+3],yi+=4,gt.push((ur<<24|or<<16|ni<<8|Kr)/65536))}}}(Ke),Xe.advanceWidth=dn,sn}function ae(Ae){return Ae.length<1240?107:Ae.length<33900?1131:32768}function W(Ae,Xe){var Ke,yt=he.cffStandardStrings.indexOf(Ae);return yt>=0&&(Ke=yt),(yt=Xe.indexOf(Ae))>=0?Ke=yt+he.cffStandardStrings.length:(Ke=he.cffStandardStrings.length+Xe.length,Xe.push(Ae)),Ke}function Z(Ae,Xe,Ke){for(var yt={},dt=0;dt<Ae.length;dt+=1){var It=Ae[dt],wt=Xe[It.name];void 0===wt||M(wt,It.value)||("SID"===It.type&&(wt=W(wt,Ke)),yt[It.op]={name:It.name,type:It.type,value:wt})}return yt}function A(Ae,Xe){var Ke=new be.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Ke.dict=Z(Pe,Ae,Xe),Ke}function R(Ae){var Xe=new be.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return Xe.topDicts=[{name:"topDict_0",type:"TABLE",value:Ae}],Xe}function X(Ae){var Xe=[],Ke=Ae.path;Xe.push({name:"width",type:"NUMBER",value:Ae.advanceWidth});for(var yt=0,dt=0,It=0;It<Ke.commands.length;It+=1){var wt,Gt,Dt=Ke.commands[It];if("Q"===Dt.type){var sn=.3333333333333333,gt=2/3;Dt={type:"C",x:Dt.x,y:Dt.y,x1:sn*yt+gt*Dt.x1,y1:sn*dt+gt*Dt.y1,x2:sn*Dt.x+gt*Dt.x1,y2:sn*Dt.y+gt*Dt.y1}}if("M"===Dt.type)wt=Math.round(Dt.x-yt),Gt=Math.round(Dt.y-dt),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rmoveto",type:"OP",value:21}),yt=Math.round(Dt.x),dt=Math.round(Dt.y);else if("L"===Dt.type)wt=Math.round(Dt.x-yt),Gt=Math.round(Dt.y-dt),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rlineto",type:"OP",value:5}),yt=Math.round(Dt.x),dt=Math.round(Dt.y);else if("C"===Dt.type){var An=Math.round(Dt.x1-yt),Bn=Math.round(Dt.y1-dt),dn=Math.round(Dt.x2-Dt.x1),On=Math.round(Dt.y2-Dt.y1);wt=Math.round(Dt.x-Dt.x2),Gt=Math.round(Dt.y-Dt.y2),Xe.push({name:"dx1",type:"NUMBER",value:An}),Xe.push({name:"dy1",type:"NUMBER",value:Bn}),Xe.push({name:"dx2",type:"NUMBER",value:dn}),Xe.push({name:"dy2",type:"NUMBER",value:On}),Xe.push({name:"dx",type:"NUMBER",value:wt}),Xe.push({name:"dy",type:"NUMBER",value:Gt}),Xe.push({name:"rrcurveto",type:"OP",value:8}),yt=Math.round(Dt.x),dt=Math.round(Dt.y)}}return Xe.push({name:"endchar",type:"OP",value:14}),Xe}var he=B("../encoding"),U=B("../glyphset"),Re=B("../parse"),Q=B("../path"),be=B("../table"),Pe=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],Ge=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];G.parse=function(Ae,Xe,Ke){Ke.tables.cff={};var mn,cr,rr,dt=P(Ae,((rr={}).formatMajor=Re.getCard8(mn=Ae,cr=Xe),rr.formatMinor=Re.getCard8(mn,cr+1),rr.size=Re.getCard8(mn,cr+2),rr.offsetSize=Re.getCard8(mn,cr+3),rr.startOffset=cr,rr.endOffset=cr+4,rr).endOffset,Re.bytesToString),It=P(Ae,dt.endOffset),wt=P(Ae,It.endOffset,Re.bytesToString),Gt=P(Ae,wt.endOffset);Ke.gsubrs=Gt.objects,Ke.gsubrsBias=ae(Ke.gsubrs);var Dt=function(mn,cr){return ce(ye(mn,0,mn.byteLength),Pe,cr)}(new DataView(new Uint8Array(It.objects[0]).buffer),wt.objects);Ke.tables.cff.topDict=Dt;var sn=Xe+Dt.private[1],gt=function(mn,cr,rr,ur){return ce(ye(mn,cr,rr),Ge,ur)}(Ae,sn,Dt.private[0],wt.objects);if(Ke.defaultWidthX=gt.defaultWidthX,Ke.nominalWidthX=gt.nominalWidthX,0!==gt.subrs){var An=P(Ae,sn+gt.subrs);Ke.subrs=An.objects,Ke.subrsBias=ae(Ke.subrs)}else Ke.subrs=[],Ke.subrsBias=0;var Bn=P(Ae,Xe+Dt.charStrings);Ke.nGlyphs=Bn.objects.length;var dn=function(mn,cr,rr,ur){var or,ni,Kr,pi=new Re.Parser(mn,cr);rr-=1;var nr=[".notdef"],vr=pi.parseCard8();if(0===vr)for(or=0;rr>or;or+=1)ni=pi.parseSID(),nr.push(ie(ur,ni));else if(1===vr)for(;nr.length<=rr;)for(ni=pi.parseSID(),Kr=pi.parseCard8(),or=0;Kr>=or;or+=1)nr.push(ie(ur,ni)),ni+=1;else{if(2!==vr)throw new Error("Unknown charset format "+vr);for(;nr.length<=rr;)for(ni=pi.parseSID(),Kr=pi.parseCard16(),or=0;Kr>=or;or+=1)nr.push(ie(ur,ni)),ni+=1}return nr}(Ae,Xe+Dt.charset,Ke.nGlyphs,wt.objects);Ke.cffEncoding=0===Dt.encoding?new he.CffEncoding(he.cffStandardEncoding,dn):1===Dt.encoding?new he.CffEncoding(he.cffExpertEncoding,dn):function(mn,cr,rr){var ur,or,ni={},Kr=new Re.Parser(mn,cr),pi=Kr.parseCard8();if(0===pi){var nr=Kr.parseCard8();for(ur=0;nr>ur;ur+=1)ni[or=Kr.parseCard8()]=ur}else{if(1!==pi)throw new Error("Unknown encoding format "+pi);var vr=Kr.parseCard8();for(or=1,ur=0;vr>ur;ur+=1)for(var mi=Kr.parseCard8(),_o=Kr.parseCard8(),Nr=mi;mi+_o>=Nr;Nr+=1)ni[Nr]=or,or+=1}return new he.CffEncoding(ni,rr)}(Ae,Xe+Dt.encoding,dn),Ke.encoding=Ke.encoding||Ke.cffEncoding,Ke.glyphs=new U.GlyphSet(Ke);for(var On=0;On<Ke.nGlyphs;On+=1)Ke.glyphs.push(On,U.cffGlyphLoader(Ke,On,fe,Bn.objects[On]))},G.make=function(Ae,Xe){for(var Ke,yt=new be.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),dt=1/Xe.unitsPerEm,It={version:Xe.version,fullName:Xe.fullName,familyName:Xe.familyName,weight:Xe.weightName,fontBBox:Xe.fontBBox||[0,0,0,0],fontMatrix:[dt,0,0,dt,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},wt=[],Gt=1;Gt<Ae.length;Gt+=1)Ke=Ae.get(Gt),wt.push(Ke.name);var Dt=[];yt.header=new be.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),yt.nameIndex=function(An){var Bn=new be.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Bn.names=[];for(var dn=0;dn<An.length;dn+=1)Bn.names.push({name:"name_"+dn,type:"NAME",value:An[dn]});return Bn}([Xe.postScriptName]);var Bn,dn,sn=A(It,Dt);yt.topDictIndex=R(sn),yt.globalSubrIndex=new be.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),yt.charsets=function(An,Bn){for(var dn=new be.Record("Charsets",[{name:"format",type:"Card8",value:0}]),On=0;On<An.length;On+=1){var Ln=W(An[On],Bn);dn.fields.push({name:"glyph_"+On,type:"SID",value:Ln})}return dn}(wt,Dt),yt.charStringsIndex=function(An){for(var Bn=new be.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),dn=0;dn<An.length;dn+=1){var On=An.get(dn),Ln=X(On);Bn.charStrings.push({name:On.name,type:"CHARSTRING",value:Ln})}return Bn}(Ae),yt.privateDict=(Bn=Dt,(dn=new be.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=Z(Ge,{},Bn),dn),yt.stringIndex=function(An){var Bn=new be.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Bn.strings=[];for(var dn=0;dn<An.length;dn+=1)Bn.strings.push({name:"string_"+dn,type:"STRING",value:An[dn]});return Bn}(Dt);var gt=yt.header.sizeOf()+yt.nameIndex.sizeOf()+yt.topDictIndex.sizeOf()+yt.stringIndex.sizeOf()+yt.globalSubrIndex.sizeOf();return It.charset=gt,It.encoding=0,It.charStrings=It.charset+yt.charsets.sizeOf(),It.private[1]=It.charStrings+yt.charStringsIndex.sizeOf(),sn=A(It,Dt),yt.topDictIndex=R(sn),yt}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(B,D,G){function M(ie,ce,fe){ie.segments.push({end:ce,start:ce,delta:-(ce-fe),offset:0})}var P=B("../check"),de=B("../parse"),ye=B("../table");G.parse=function(ie,ce){var fe,ae={};ae.version=de.getUShort(ie,ce),P.argument(0===ae.version,"cmap table version should be 0."),ae.numTables=de.getUShort(ie,ce+2);var W=-1;for(fe=ae.numTables-1;fe>=0;fe-=1){var Z=de.getUShort(ie,ce+4+8*fe),A=de.getUShort(ie,ce+4+8*fe+2);if(3===Z&&(0===A||1===A||10===A)){W=de.getULong(ie,ce+4+8*fe+4);break}}if(-1===W)return null;var R=new de.Parser(ie,ce+W);if(ae.format=R.parseUShort(),12===ae.format)!function(X,he){var U,Re;for(he.parseUShort(),X.length=he.parseULong(),X.language=he.parseULong(),X.groupCount=Re=he.parseULong(),X.glyphIndexMap={},U=0;Re>U;U+=1)for(var Q=he.parseULong(),be=he.parseULong(),Pe=he.parseULong(),Ge=Q;be>=Ge;Ge+=1)X.glyphIndexMap[Ge]=Pe,Pe++}(ae,R);else{if(4!==ae.format)throw new Error("Only format 4 and 12 cmap tables are supported.");!function(X,he,U,Re,Q){var be,Pe;X.length=he.parseUShort(),X.language=he.parseUShort(),X.segCount=Pe=he.parseUShort()>>1,he.skip("uShort",3),X.glyphIndexMap={};var Ge=new de.Parser(U,Re+Q+14),Ae=new de.Parser(U,Re+Q+16+2*Pe),Xe=new de.Parser(U,Re+Q+16+4*Pe),Ke=new de.Parser(U,Re+Q+16+6*Pe),yt=Re+Q+16+8*Pe;for(be=0;Pe-1>be;be+=1)for(var dt,It=Ge.parseUShort(),wt=Ae.parseUShort(),Gt=Xe.parseShort(),Dt=Ke.parseUShort(),sn=wt;It>=sn;sn+=1)0!==Dt?(yt=Ke.offset+Ke.relativeOffset-2,yt+=Dt,0!==(dt=de.getUShort(U,yt+=2*(sn-wt)))&&(dt=dt+Gt&65535)):dt=sn+Gt&65535,X.glyphIndexMap[sn]=dt}(ae,R,ie,ce,W)}return ae},G.make=function(ie){var ce,fe,ae=new ye.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(ae.segments=[],ce=0;ce<ie.length;ce+=1){for(var W=ie.get(ce),Z=0;Z<W.unicodes.length;Z+=1)M(ae,W.unicodes[Z],ce);ae.segments=ae.segments.sort(function(Q,be){return Q.start-be.start})}ae.segments.push({end:65535,start:65535,delta:1,offset:0}),ae.segCountX2=2*(fe=ae.segments.length),ae.searchRange=2*Math.pow(2,Math.floor(Math.log(fe)/Math.log(2))),ae.entrySelector=Math.log(ae.searchRange/2)/Math.log(2),ae.rangeShift=ae.segCountX2-ae.searchRange;var A=[],R=[],X=[],he=[],U=[];for(ce=0;fe>ce;ce+=1){var Re=ae.segments[ce];A=A.concat({name:"end_"+ce,type:"USHORT",value:Re.end}),R=R.concat({name:"start_"+ce,type:"USHORT",value:Re.start}),X=X.concat({name:"idDelta_"+ce,type:"SHORT",value:Re.delta}),he=he.concat({name:"idRangeOffset_"+ce,type:"USHORT",value:Re.offset}),void 0!==Re.glyphId&&(U=U.concat({name:"glyph_"+ce,type:"USHORT",value:Re.glyphId}))}return ae.fields=ae.fields.concat(A),ae.fields.push({name:"reservedPad",type:"USHORT",value:0}),ae.fields=ae.fields.concat(R),ae.fields=ae.fields.concat(X),ae.fields=ae.fields.concat(he),ae.fields=ae.fields.concat(U),ae.length=14+2*A.length+2+2*R.length+2*X.length+2*he.length+2*U.length,ae}},{"../check":2,"../parse":10,"../table":13}],16:[function(B,D,G){function M(W,Z){var A=JSON.stringify(W),R=256;for(var X in Z){var he=parseInt(X);if(he&&!(256>he)){if(JSON.stringify(Z[X])===A)return he;he>=R&&(R=he+1)}}return Z[R]=W,R}function P(W,Z,A){var R=M(Z.name,A);return[{name:"tag_"+W,type:"TAG",value:Z.tag},{name:"minValue_"+W,type:"FIXED",value:Z.minValue<<16},{name:"defaultValue_"+W,type:"FIXED",value:Z.defaultValue<<16},{name:"maxValue_"+W,type:"FIXED",value:Z.maxValue<<16},{name:"flags_"+W,type:"USHORT",value:0},{name:"nameID_"+W,type:"USHORT",value:R}]}function de(W,Z,A){var R={},X=new fe.Parser(W,Z);return R.tag=X.parseTag(),R.minValue=X.parseFixed(),R.defaultValue=X.parseFixed(),R.maxValue=X.parseFixed(),X.skip("uShort",1),R.name=A[X.parseUShort()]||{},R}function ye(W,Z,A,R){for(var X=[{name:"nameID_"+W,type:"USHORT",value:M(Z.name,R)},{name:"flags_"+W,type:"USHORT",value:0}],he=0;he<A.length;++he){var U=A[he].tag;X.push({name:"axis_"+W+" "+U,type:"FIXED",value:Z.coordinates[U]<<16})}return X}function ie(W,Z,A,R){var X={},he=new fe.Parser(W,Z);X.name=R[he.parseUShort()]||{},he.skip("uShort",1),X.coordinates={};for(var U=0;U<A.length;++U)X.coordinates[A[U].tag]=he.parseFixed();return X}var ce=B("../check"),fe=B("../parse"),ae=B("../table");G.make=function(W,Z){var A=new ae.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:W.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:W.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*W.axes.length}]);A.offsetToData=A.sizeOf();for(var R=0;R<W.axes.length;R++)A.fields=A.fields.concat(P(R,W.axes[R],Z));for(var X=0;X<W.instances.length;X++)A.fields=A.fields.concat(ye(X,W.instances[X],W.axes,Z));return A},G.parse=function(W,Z,A){var R=new fe.Parser(W,Z),X=R.parseULong();ce.argument(65536===X,"Unsupported fvar table version.");var he=R.parseOffset16();R.skip("uShort",1);for(var U=R.parseUShort(),Re=R.parseUShort(),Q=R.parseUShort(),be=R.parseUShort(),Pe=[],Ge=0;U>Ge;Ge++)Pe.push(de(W,Z+he+Ge*Re,A));for(var Ae=[],Xe=Z+he+U*Re,Ke=0;Q>Ke;Ke++)Ae.push(ie(W,Xe+Ke*be,Pe,A));return{axes:Pe,instances:Ae}}},{"../check":2,"../parse":10,"../table":13}],17:[function(B,D,G){function M(W,Z,A,R,X){var he;return(Z&R)>0?(he=W.parseByte(),!(Z&X)&&(he=-he),he=A+he):he=(Z&X)>0?A:A+W.parseShort(),he}function P(W,Z,A){var R,X,he=new fe.Parser(Z,A);if(W.numberOfContours=he.parseShort(),W._xMin=he.parseShort(),W._yMin=he.parseShort(),W._xMax=he.parseShort(),W._yMax=he.parseShort(),W.numberOfContours>0){var U,Re=W.endPointIndices=[];for(U=0;U<W.numberOfContours;U+=1)Re.push(he.parseUShort());for(W.instructionLength=he.parseUShort(),W.instructions=[],U=0;U<W.instructionLength;U+=1)W.instructions.push(he.parseByte());var Q=Re[Re.length-1]+1;for(R=[],U=0;Q>U;U+=1)if(X=he.parseByte(),R.push(X),(8&X)>0)for(var be=he.parseByte(),Pe=0;be>Pe;Pe+=1)R.push(X),U+=1;if(ie.argument(R.length===Q,"Bad flags."),Re.length>0){var Ge,Ae=[];if(Q>0){for(U=0;Q>U;U+=1)(Ge={}).onCurve=!!(1&(X=R[U])),Ge.lastPointOfContour=Re.indexOf(U)>=0,Ae.push(Ge);var Xe=0;for(U=0;Q>U;U+=1)(Ge=Ae[U]).x=M(he,X=R[U],Xe,2,16),Xe=Ge.x;var Ke=0;for(U=0;Q>U;U+=1)(Ge=Ae[U]).y=M(he,X=R[U],Ke,4,32),Ke=Ge.y}W.points=Ae}else W.points=[]}else if(0===W.numberOfContours)W.points=[];else{W.isComposite=!0,W.points=[],W.components=[];for(var yt=!0;yt;){R=he.parseUShort();var dt={glyphIndex:he.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&R)>0?(2&R)>0?(dt.dx=he.parseShort(),dt.dy=he.parseShort()):dt.matchedPoints=[he.parseUShort(),he.parseUShort()]:(2&R)>0?(dt.dx=he.parseChar(),dt.dy=he.parseChar()):dt.matchedPoints=[he.parseByte(),he.parseByte()],(8&R)>0?dt.xScale=dt.yScale=he.parseF2Dot14():(64&R)>0?(dt.xScale=he.parseF2Dot14(),dt.yScale=he.parseF2Dot14()):(128&R)>0&&(dt.xScale=he.parseF2Dot14(),dt.scale01=he.parseF2Dot14(),dt.scale10=he.parseF2Dot14(),dt.yScale=he.parseF2Dot14()),W.components.push(dt),yt=!!(32&R)}}}function de(W,Z){for(var A=[],R=0;R<W.length;R+=1){var X=W[R];A.push({x:Z.xScale*X.x+Z.scale01*X.y+Z.dx,y:Z.scale10*X.x+Z.yScale*X.y+Z.dy,onCurve:X.onCurve,lastPointOfContour:X.lastPointOfContour})}return A}function ye(W,Z){if(Z.isComposite)for(var A=0;A<Z.components.length;A+=1){var R=Z.components[A],X=W.get(R.glyphIndex);if(X.getPath(),X.points){var he;if(void 0===R.matchedPoints)he=de(X.points,R);else{if(R.matchedPoints[0]>Z.points.length-1||R.matchedPoints[1]>X.points.length-1)throw Error("Matched points out of range in "+Z.name);var U=Z.points[R.matchedPoints[0]],Re=X.points[R.matchedPoints[1]],Q={xScale:R.xScale,scale01:R.scale01,scale10:R.scale10,yScale:R.yScale,dx:0,dy:0};Re=de([Re],Q)[0],Q.dx=U.x-Re.x,Q.dy=U.y-Re.y,he=de(X.points,Q)}Z.points=Z.points.concat(he)}}return function(be){var Pe=new ae.Path;if(!be)return Pe;for(var Ge=function(gt){for(var An=[],Bn=[],dn=0;dn<gt.length;dn+=1){var On=gt[dn];Bn.push(On),On.lastPointOfContour&&(An.push(Bn),Bn=[])}return ie.argument(0===Bn.length,"There are still points left in the current contour."),An}(be),Ae=0;Ae<Ge.length;Ae+=1){var Xe,Ke,yt=Ge[Ae],dt=yt[0],It=yt[yt.length-1];dt.onCurve?(Xe=null,Ke=!0):(Xe=dt=It.onCurve?It:{x:(dt.x+It.x)/2,y:(dt.y+It.y)/2},Ke=!1),Pe.moveTo(dt.x,dt.y);for(var wt=Ke?1:0;wt<yt.length;wt+=1){var Gt=yt[wt],Dt=0===wt?dt:yt[wt-1];if(Dt.onCurve&&Gt.onCurve)Pe.lineTo(Gt.x,Gt.y);else if(Dt.onCurve&&!Gt.onCurve)Xe=Gt;else if(Dt.onCurve||Gt.onCurve){if(Dt.onCurve||!Gt.onCurve)throw new Error("Invalid state.");Pe.quadraticCurveTo(Xe.x,Xe.y,Gt.x,Gt.y),Xe=null}else{var sn={x:(Dt.x+Gt.x)/2,y:(Dt.y+Gt.y)/2};Pe.quadraticCurveTo(Dt.x,Dt.y,sn.x,sn.y),Xe=Gt}}dt!==It&&(Xe?Pe.quadraticCurveTo(Xe.x,Xe.y,dt.x,dt.y):Pe.lineTo(dt.x,dt.y))}return Pe.closePath(),Pe}(Z.points)}var ie=B("../check"),ce=B("../glyphset"),fe=B("../parse"),ae=B("../path");G.parse=function(W,Z,A,R){var X,he=new ce.GlyphSet(R);for(X=0;X<A.length-1;X+=1){var U=A[X];he.push(X,U!==A[X+1]?ce.ttfGlyphLoader(R,X,P,W,Z+U,ye):ce.glyphLoader(R,X))}return he}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(B,D,G){function M(fe,ae){for(var W=new ce.Parser(fe,ae),Z=W.parseUShort(),A=[],R=0;Z>R;R++)A[W.parseTag()]={offset:W.parseUShort()};return A}function P(fe,ae){var W=new ce.Parser(fe,ae),Z=W.parseUShort();if(1===Z){var A=W.parseUShort(),R=W.parseUShort(),X=W.parseUShortList(R);return function(Pe){return X[Pe-A]||0}}if(2===Z){for(var he=W.parseUShort(),U=[],Re=[],Q=[],be=0;he>be;be++)U[be]=W.parseUShort(),Re[be]=W.parseUShort(),Q[be]=W.parseUShort();return function(Pe){for(var Ge=0,Ae=U.length-1;Ae>Ge;){var Xe=Ge+Ae+1>>1;Pe<U[Xe]?Ae=Xe-1:Ge=Xe}return U[Ge]<=Pe&&Pe<=Re[Ge]&&Q[Ge]||0}}}function de(fe,ae){var W,Z=new ce.Parser(fe,ae),A=Z.parseUShort(),R=function(On,Ln){var mn=new ce.Parser(On,Ln),cr=mn.parseUShort(),rr=mn.parseUShort();if(1===cr)return mn.parseUShortList(rr);if(2===cr){for(var ur=[];rr--;)for(var or=mn.parseUShort(),ni=mn.parseUShort(),Kr=mn.parseUShort(),pi=or;ni>=pi;pi++)ur[Kr++]=pi;return ur}}(fe,ae+Z.parseUShort()),X=Z.parseUShort(),he=Z.parseUShort();if(4===X&&0===he){var U={};if(1===A){for(var Re=Z.parseUShort(),Q=[],be=Z.parseOffset16List(Re),Pe=0;Re>Pe;Pe++){var Ge=be[Pe],Ae=U[Ge];if(!Ae){Ae={},Z.relativeOffset=Ge;for(var Xe=Z.parseUShort();Xe--;){var Ke=Z.parseUShort();X&&(W=Z.parseShort()),he&&Z.parseShort(),Ae[Ke]=W}}Q[R[Pe]]=Ae}return function(On,Ln){var mn=Q[On];return mn?mn[Ln]:void 0}}if(2===A){for(var yt=Z.parseUShort(),dt=Z.parseUShort(),It=Z.parseUShort(),wt=Z.parseUShort(),Gt=P(fe,ae+yt),Dt=P(fe,ae+dt),sn=[],gt=0;It>gt;gt++)for(var An=sn[gt]=[],Bn=0;wt>Bn;Bn++)X&&(W=Z.parseShort()),he&&Z.parseShort(),An[Bn]=W;var dn={};for(gt=0;gt<R.length;gt++)dn[R[gt]]=1;return function(On,Ln){if(dn[On]){var mn=Gt(On),cr=Dt(Ln),rr=sn[mn];return rr?rr[cr]:void 0}}}}}function ye(fe,ae){var W=new ce.Parser(fe,ae),Z=W.parseUShort(),A=W.parseUShort(),R=16&A,X=W.parseUShort(),he=W.parseOffset16List(X),U={lookupType:Z,lookupFlag:A,markFilteringSet:R?W.parseUShort():-1};if(2===Z){for(var Re=[],Q=0;X>Q;Q++)Re.push(de(fe,ae+he[Q]));U.getKerningValue=function(be,Pe){for(var Ge=Re.length;Ge--;){var Ae=Re[Ge](be,Pe);if(void 0!==Ae)return Ae}return 0}}return U}var ie=B("../check"),ce=B("../parse");G.parse=function(fe,ae,W){var Z=new ce.Parser(fe,ae),A=Z.parseFixed();ie.argument(1===A,"Unsupported GPOS table version."),M(fe,ae+Z.parseUShort()),M(fe,ae+Z.parseUShort());var R=Z.parseUShort();Z.relativeOffset=R;for(var X=Z.parseUShort(),he=Z.parseOffset16List(X),U=ae+R,Re=0;X>Re;Re++){var Q=ye(fe,U+he[Re]);2!==Q.lookupType||W.getGposKerningValue||(W.getGposKerningValue=Q.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(B,D,G){var M=B("../check"),P=B("../parse").Parser,de=new Array(9),ye=B("../table");de[1]=function(){var fe=this.offset+this.relativeOffset,ae=this.parseUShort();return 1===ae?{substFormat:1,coverage:this.parsePointer(P.coverage),deltaGlyphId:this.parseUShort()}:2===ae?{substFormat:2,coverage:this.parsePointer(P.coverage),substitute:this.parseOffset16List()}:void M.assert(!1,"0x"+fe.toString(16)+": lookup type 1 format must be 1 or 2.")},de[2]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),sequences:this.parseListOfLists()}},de[3]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),alternateSets:this.parseListOfLists()}},de[4]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB ligature table identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var ie={sequenceIndex:P.uShort,lookupListIndex:P.uShort};de[5]=function(){var fe=this.offset+this.relativeOffset,ae=this.parseUShort();if(1===ae)return{substFormat:ae,coverage:this.parsePointer(P.coverage),ruleSets:this.parseListOfLists(function(){var A=this.parseUShort(),R=this.parseUShort();return{input:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(R,ie)}})};if(2===ae)return{substFormat:ae,coverage:this.parsePointer(P.coverage),classDef:this.parsePointer(P.classDef),classSets:this.parseListOfLists(function(){var A=this.parseUShort(),R=this.parseUShort();return{classes:this.parseUShortList(A-1),lookupRecords:this.parseRecordList(R,ie)}})};if(3===ae){var W=this.parseUShort(),Z=this.parseUShort();return{substFormat:ae,coverages:this.parseList(W,P.pointer(P.coverage)),lookupRecords:this.parseRecordList(Z,ie)}}M.assert(!1,"0x"+fe.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},de[6]=function(){var fe=this.offset+this.relativeOffset,ae=this.parseUShort();return 1===ae?{substFormat:1,coverage:this.parsePointer(P.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ie)}})}:2===ae?{substFormat:2,coverage:this.parsePointer(P.coverage),backtrackClassDef:this.parsePointer(P.classDef),inputClassDef:this.parsePointer(P.classDef),lookaheadClassDef:this.parsePointer(P.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ie)}})}:3===ae?{substFormat:3,backtrackCoverage:this.parseList(P.pointer(P.coverage)),inputCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),lookupRecords:this.parseRecordList(ie)}:void M.assert(!1,"0x"+fe.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},de[7]=function(){var fe=this.parseUShort();M.argument(1===fe,"GSUB Extension Substitution subtable identifier-format must be 1");var ae=this.parseUShort(),W=new P(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:ae,extension:de[ae].call(W)}},de[8]=function(){var fe=this.parseUShort();return M.argument(1===fe,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),backtrackCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),substitutes:this.parseUShortList()}};var ce=new Array(9);ce[1]=function(fe){return new ye.Table("substitutionTable",1===fe.substFormat?[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)},{name:"deltaGlyphID",type:"USHORT",value:fe.deltaGlyphId}]:[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.ushortList("substitute",fe.substitute)))},ce[3]=function(fe){return M.assert(1===fe.substFormat,"Lookup type 3 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.tableList("altSet",fe.alternateSets,function(ae){return new ye.Table("alternateSetTable",ye.ushortList("alternate",ae))})))},ce[4]=function(fe){return M.assert(1===fe.substFormat,"Lookup type 4 substFormat must be 1."),new ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new ye.Coverage(fe.coverage)}].concat(ye.tableList("ligSet",fe.ligatureSets,function(ae){return new ye.Table("ligatureSetTable",ye.tableList("ligature",ae,function(W){return new ye.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:W.ligGlyph}].concat(ye.ushortList("component",W.components,W.components.length+1)))}))})))},G.parse=function(fe,ae){var W=new P(fe,ae=ae||0),Z=W.parseVersion();return M.argument(1===Z,"Unsupported GSUB table version."),{version:Z,scripts:W.parseScriptList(),features:W.parseFeatureList(),lookups:W.parseLookupList(de)}},G.make=function(fe){return new ye.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new ye.ScriptList(fe.scripts)},{name:"features",type:"TABLE",value:new ye.FeatureList(fe.features)},{name:"lookups",type:"TABLE",value:new ye.LookupList(fe.lookups,ce)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(B,D,G){var M=B("../check"),P=B("../parse"),de=B("../table");G.parse=function(ye,ie){var ce={},fe=new P.Parser(ye,ie);return ce.version=fe.parseVersion(),ce.fontRevision=Math.round(1e3*fe.parseFixed())/1e3,ce.checkSumAdjustment=fe.parseULong(),ce.magicNumber=fe.parseULong(),M.argument(1594834165===ce.magicNumber,"Font header has wrong magic number."),ce.flags=fe.parseUShort(),ce.unitsPerEm=fe.parseUShort(),ce.created=fe.parseLongDateTime(),ce.modified=fe.parseLongDateTime(),ce.xMin=fe.parseShort(),ce.yMin=fe.parseShort(),ce.xMax=fe.parseShort(),ce.yMax=fe.parseShort(),ce.macStyle=fe.parseUShort(),ce.lowestRecPPEM=fe.parseUShort(),ce.fontDirectionHint=fe.parseShort(),ce.indexToLocFormat=fe.parseShort(),ce.glyphDataFormat=fe.parseShort(),ce},G.make=function(ye){var ie=Math.round((new Date).getTime()/1e3)+2082844800,ce=ie;return ye.createdTimestamp&&(ce=ye.createdTimestamp+2082844800),new de.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:ce},{name:"modified",type:"LONGDATETIME",value:ie},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],ye)}},{"../check":2,"../parse":10,"../table":13}],21:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(de,ye){var ie={},ce=new M.Parser(de,ye);return ie.version=ce.parseVersion(),ie.ascender=ce.parseShort(),ie.descender=ce.parseShort(),ie.lineGap=ce.parseShort(),ie.advanceWidthMax=ce.parseUShort(),ie.minLeftSideBearing=ce.parseShort(),ie.minRightSideBearing=ce.parseShort(),ie.xMaxExtent=ce.parseShort(),ie.caretSlopeRise=ce.parseShort(),ie.caretSlopeRun=ce.parseShort(),ie.caretOffset=ce.parseShort(),ce.relativeOffset+=8,ie.metricDataFormat=ce.parseShort(),ie.numberOfHMetrics=ce.parseUShort(),ie},G.make=function(de){return new P.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],de)}},{"../parse":10,"../table":13}],22:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(de,ye,ie,ce,fe){for(var ae,W,Z=new M.Parser(de,ye),A=0;ce>A;A+=1){ie>A&&(ae=Z.parseUShort(),W=Z.parseShort());var R=fe.get(A);R.advanceWidth=ae,R.leftSideBearing=W}},G.make=function(de){for(var ye=new P.Table("hmtx",[]),ie=0;ie<de.length;ie+=1){var ce=de.get(ie),ae=ce.leftSideBearing||0;ye.fields.push({name:"advanceWidth_"+ie,type:"USHORT",value:ce.advanceWidth||0}),ye.fields.push({name:"leftSideBearing_"+ie,type:"SHORT",value:ae})}return ye}},{"../parse":10,"../table":13}],23:[function(B,D,G){var M=B("../check"),P=B("../parse");G.parse=function(de,ye){var ie={},ce=new P.Parser(de,ye),fe=ce.parseUShort();M.argument(0===fe,"Unsupported kern table version."),ce.skip("uShort",1);var ae=ce.parseUShort();M.argument(0===ae,"Unsupported kern sub-table version."),ce.skip("uShort",2);var W=ce.parseUShort();ce.skip("uShort",3);for(var Z=0;W>Z;Z+=1){var A=ce.parseUShort(),R=ce.parseUShort(),X=ce.parseShort();ie[A+","+R]=X}return ie}},{"../check":2,"../parse":10}],24:[function(B,D,G){var M=B("../parse");G.parse=function(P,de,ye,ie){for(var ce=new M.Parser(P,de),fe=ie?ce.parseUShort:ce.parseULong,ae=[],W=0;ye+1>W;W+=1){var Z=fe.call(ce);ie&&(Z*=2),ae.push(Z)}return ae}},{"../parse":10}],25:[function(B,D,G){var M=B("../check"),P=B("../parse"),de=B("../table");G.make=function(ye){for(var ie=new de.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:ye.length}]),ce="",fe=12+4*ye.length,ae=0;ae<ye.length;++ae){var W=ce.indexOf(ye[ae]);0>W&&(W=ce.length,ce+=ye[ae]),ie.fields.push({name:"offset "+ae,type:"USHORT",value:fe+W}),ie.fields.push({name:"length "+ae,type:"USHORT",value:ye[ae].length})}return ie.fields.push({name:"stringPool",type:"CHARARRAY",value:ce}),ie},G.parse=function(ye,ie){var ce=new P.Parser(ye,ie),fe=ce.parseULong();M.argument(1===fe,"Unsupported ltag table version."),ce.skip("uLong",1);for(var ae=ce.parseULong(),W=[],Z=0;ae>Z;Z++){for(var A="",R=ie+ce.parseUShort(),X=ce.parseUShort(),he=R;R+X>he;++he)A+=String.fromCharCode(ye.getInt8(he));W.push(A)}return W}},{"../check":2,"../parse":10,"../table":13}],26:[function(B,D,G){var M=B("../parse"),P=B("../table");G.parse=function(de,ye){var ie={},ce=new M.Parser(de,ye);return ie.version=ce.parseVersion(),ie.numGlyphs=ce.parseUShort(),1===ie.version&&(ie.maxPoints=ce.parseUShort(),ie.maxContours=ce.parseUShort(),ie.maxCompositePoints=ce.parseUShort(),ie.maxCompositeContours=ce.parseUShort(),ie.maxZones=ce.parseUShort(),ie.maxTwilightPoints=ce.parseUShort(),ie.maxStorage=ce.parseUShort(),ie.maxFunctionDefs=ce.parseUShort(),ie.maxInstructionDefs=ce.parseUShort(),ie.maxStackElements=ce.parseUShort(),ie.maxSizeOfInstructions=ce.parseUShort(),ie.maxComponentElements=ce.parseUShort(),ie.maxComponentDepth=ce.parseUShort()),ie},G.make=function(de){return new P.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:de}])}},{"../parse":10,"../table":13}],27:[function(B,D,G){var M=B("../types").decode,P=B("../check"),de=B("../parse"),ye=B("../table");G.parse=function(ie,ce){var fe=new de.Parser(ie,ce),ae=fe.parseULong();P.argument(1===ae,"Unsupported META table version."),fe.parseULong(),fe.parseULong();for(var W=fe.parseULong(),Z={},A=0;W>A;A++){var R=fe.parseTag(),X=fe.parseULong(),he=fe.parseULong(),U=M.UTF8(ie,ce+X,he);Z[R]=U}return Z},G.make=function(ie){var ce=Object.keys(ie).length,fe="",ae=16+12*ce,W=new ye.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:ae},{name:"numTags",type:"ULONG",value:ce}]);for(var Z in ie){var A=fe.length;fe+=ie[Z],W.fields.push({name:"tag "+Z,type:"TAG",value:Z}),W.fields.push({name:"offset "+Z,type:"ULONG",value:ae+A}),W.fields.push({name:"length "+Z,type:"ULONG",value:ie[Z].length})}return W.fields.push({name:"stringPool",type:"CHARARRAY",value:fe}),W}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(B,D,G){function M(be,Pe,Ge){switch(be){case 0:if(65535===Pe)return"und";if(Ge)return Ge[Pe];break;case 1:return R[Pe];case 3:return he[Pe]}}function P(be,Pe,Ge){switch(be){case 0:return U;case 1:return Q[Ge]||Re[Pe];case 3:if(1===Pe||10===Pe)return U}}function de(be){var Pe={};for(var Ge in be)Pe[be[Ge]]=parseInt(Ge);return Pe}function ye(be,Pe,Ge,Ae,Xe,Ke){return new Z.Record("NameRecord",[{name:"platformID",type:"USHORT",value:be},{name:"encodingID",type:"USHORT",value:Pe},{name:"languageID",type:"USHORT",value:Ge},{name:"nameID",type:"USHORT",value:Ae},{name:"length",type:"USHORT",value:Xe},{name:"offset",type:"USHORT",value:Ke}])}function ie(be,Pe){var Ge=function(Ke,yt){var dt=Ke.length,It=yt.length-dt+1;e:for(var wt=0;It>wt;wt++)for(;It>wt;wt++){for(var Gt=0;dt>Gt;Gt++)if(yt[wt+Gt]!==Ke[Gt])continue e;return wt}return-1}(be,Pe);if(0>Ge){Ge=Pe.length;for(var Ae=0,Xe=be.length;Xe>Ae;++Ae)Pe.push(be[Ae])}return Ge}var ce=B("../types"),fe=ce.decode,ae=ce.encode,W=B("../parse"),Z=B("../table"),A=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],R={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},X={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},he={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},U="utf-16",Re={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Q={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};G.parse=function(be,Pe,Ge){for(var Ae={},Xe=new W.Parser(be,Pe),Ke=Xe.parseUShort(),yt=Xe.parseUShort(),dt=Xe.offset+Xe.parseUShort(),It=0;yt>It;It++){var wt,Gt=Xe.parseUShort(),Dt=Xe.parseUShort(),sn=Xe.parseUShort(),gt=Xe.parseUShort(),An=A[gt]||gt,Bn=Xe.parseUShort(),dn=Xe.parseUShort(),On=M(Gt,sn,Ge),Ln=P(Gt,Dt,sn);if(void 0!==Ln&&void 0!==On&&(wt=Ln===U?fe.UTF16(be,dt+dn,Bn):fe.MACSTRING(be,dt+dn,Bn,Ln))){var mn=Ae[An];void 0===mn&&(mn=Ae[An]={}),mn[On]=wt}}return 1===Ke&&Xe.parseUShort(),Ae},G.make=function(be,Pe){var Ge,Ae=[],Xe={},Ke=de(A);for(var yt in be){var dt=Ke[yt];if(void 0===dt&&(dt=yt),Ge=parseInt(dt),isNaN(Ge))throw new Error('Name table entry "'+yt+'" does not exist, see nameTableNames for complete list.');Xe[Ge]=be[yt],Ae.push(Ge)}for(var It=de(R),wt=de(he),Gt=[],Dt=[],sn=0;sn<Ae.length;sn++){var gt=Xe[Ge=Ae[sn]];for(var An in gt){var Bn=gt[An],dn=1,On=It[An],Ln=X[On],mn=P(dn,Ln,On),cr=ae.MACSTRING(Bn,mn);void 0===cr&&(dn=0,0>(On=Pe.indexOf(An))&&(On=Pe.length,Pe.push(An)),Ln=4,cr=ae.UTF16(Bn));var rr=ie(cr,Dt);Gt.push(ye(dn,Ln,On,Ge,cr.length,rr));var ur=wt[An];if(void 0!==ur){var or=ae.UTF16(Bn),ni=ie(or,Dt);Gt.push(ye(3,1,ur,Ge,or.length,ni))}}}Gt.sort(function(nr,vr){return nr.platformID-vr.platformID||nr.encodingID-vr.encodingID||nr.languageID-vr.languageID||nr.nameID-vr.nameID});for(var Kr=new Z.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:Gt.length},{name:"stringOffset",type:"USHORT",value:6+12*Gt.length}]),pi=0;pi<Gt.length;pi++)Kr.fields.push({name:"record_"+pi,type:"RECORD",value:Gt[pi]});return Kr.fields.push({name:"strings",type:"LITERAL",value:Dt}),Kr}},{"../parse":10,"../table":13,"../types":32}],29:[function(B,D,G){var M=B("../parse"),P=B("../table"),de=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];G.unicodeRanges=de,G.getUnicodeRange=function(ye){for(var ie=0;ie<de.length;ie+=1){var ce=de[ie];if(ye>=ce.begin&&ye<ce.end)return ie}return-1},G.parse=function(ye,ie){var ce={},fe=new M.Parser(ye,ie);ce.version=fe.parseUShort(),ce.xAvgCharWidth=fe.parseShort(),ce.usWeightClass=fe.parseUShort(),ce.usWidthClass=fe.parseUShort(),ce.fsType=fe.parseUShort(),ce.ySubscriptXSize=fe.parseShort(),ce.ySubscriptYSize=fe.parseShort(),ce.ySubscriptXOffset=fe.parseShort(),ce.ySubscriptYOffset=fe.parseShort(),ce.ySuperscriptXSize=fe.parseShort(),ce.ySuperscriptYSize=fe.parseShort(),ce.ySuperscriptXOffset=fe.parseShort(),ce.ySuperscriptYOffset=fe.parseShort(),ce.yStrikeoutSize=fe.parseShort(),ce.yStrikeoutPosition=fe.parseShort(),ce.sFamilyClass=fe.parseShort(),ce.panose=[];for(var ae=0;10>ae;ae++)ce.panose[ae]=fe.parseByte();return ce.ulUnicodeRange1=fe.parseULong(),ce.ulUnicodeRange2=fe.parseULong(),ce.ulUnicodeRange3=fe.parseULong(),ce.ulUnicodeRange4=fe.parseULong(),ce.achVendID=String.fromCharCode(fe.parseByte(),fe.parseByte(),fe.parseByte(),fe.parseByte()),ce.fsSelection=fe.parseUShort(),ce.usFirstCharIndex=fe.parseUShort(),ce.usLastCharIndex=fe.parseUShort(),ce.sTypoAscender=fe.parseShort(),ce.sTypoDescender=fe.parseShort(),ce.sTypoLineGap=fe.parseShort(),ce.usWinAscent=fe.parseUShort(),ce.usWinDescent=fe.parseUShort(),ce.version>=1&&(ce.ulCodePageRange1=fe.parseULong(),ce.ulCodePageRange2=fe.parseULong()),ce.version>=2&&(ce.sxHeight=fe.parseShort(),ce.sCapHeight=fe.parseShort(),ce.usDefaultChar=fe.parseUShort(),ce.usBreakChar=fe.parseUShort(),ce.usMaxContent=fe.parseUShort()),ce},G.make=function(ye){return new P.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],ye)}},{"../parse":10,"../table":13}],30:[function(B,D,G){var M=B("../encoding"),P=B("../parse"),de=B("../table");G.parse=function(ye,ie){var ce,fe={},ae=new P.Parser(ye,ie);switch(fe.version=ae.parseVersion(),fe.italicAngle=ae.parseFixed(),fe.underlinePosition=ae.parseShort(),fe.underlineThickness=ae.parseShort(),fe.isFixedPitch=ae.parseULong(),fe.minMemType42=ae.parseULong(),fe.maxMemType42=ae.parseULong(),fe.minMemType1=ae.parseULong(),fe.maxMemType1=ae.parseULong(),fe.version){case 1:fe.names=M.standardNames.slice();break;case 2:for(fe.numberOfGlyphs=ae.parseUShort(),fe.glyphNameIndex=new Array(fe.numberOfGlyphs),ce=0;ce<fe.numberOfGlyphs;ce++)fe.glyphNameIndex[ce]=ae.parseUShort();for(fe.names=[],ce=0;ce<fe.numberOfGlyphs;ce++)if(fe.glyphNameIndex[ce]>=M.standardNames.length){var W=ae.parseChar();fe.names.push(ae.parseString(W))}break;case 2.5:for(fe.numberOfGlyphs=ae.parseUShort(),fe.offset=new Array(fe.numberOfGlyphs),ce=0;ce<fe.numberOfGlyphs;ce++)fe.offset[ce]=ae.parseChar()}return fe},G.make=function(){return new de.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(B,D,G){function M(Ae){return Math.log(Ae)/Math.log(2)|0}function P(Ae){for(;Ae.length%4!=0;)Ae.push(0);for(var Xe=0,Ke=0;Ke<Ae.length;Ke+=4)Xe+=(Ae[Ke]<<24)+(Ae[Ke+1]<<16)+(Ae[Ke+2]<<8)+Ae[Ke+3];return Xe%Math.pow(2,32)}function de(Ae,Xe,Ke,yt){return new ae.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==Ae?Ae:""},{name:"checkSum",type:"ULONG",value:void 0!==Xe?Xe:0},{name:"offset",type:"ULONG",value:void 0!==Ke?Ke:0},{name:"length",type:"ULONG",value:void 0!==yt?yt:0}])}function ye(Ae){var Xe=new ae.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);Xe.tables=Ae,Xe.numTables=Ae.length;var Ke=Math.pow(2,M(Xe.numTables));Xe.searchRange=16*Ke,Xe.entrySelector=M(Ke),Xe.rangeShift=16*Xe.numTables-Xe.searchRange;for(var yt=[],dt=[],It=Xe.sizeOf()+de().sizeOf()*Xe.numTables;It%4!=0;)It+=1,dt.push({name:"padding",type:"BYTE",value:0});for(var wt=0;wt<Ae.length;wt+=1){var Gt=Ae[wt];fe.argument(4===Gt.tableName.length,"Table name"+Gt.tableName+" is invalid.");var Dt=Gt.sizeOf(),sn=de(Gt.tableName,P(Gt.encode()),It,Dt);for(yt.push({name:sn.tag+" Table Record",type:"RECORD",value:sn}),dt.push({name:Gt.tableName+" table",type:"RECORD",value:Gt}),It+=Dt,fe.argument(!isNaN(It),"Something went wrong calculating the offset.");It%4!=0;)It+=1,dt.push({name:"padding",type:"BYTE",value:0})}return yt.sort(function(gt,An){return gt.value.tag>An.value.tag?1:-1}),Xe.fields=Xe.fields.concat(yt),Xe.fields=Xe.fields.concat(dt),Xe}function ie(Ae,Xe,Ke){for(var yt=0;yt<Xe.length;yt+=1){var dt=Ae.charToGlyphIndex(Xe[yt]);if(dt>0)return Ae.glyphs.get(dt).getMetrics()}return Ke}function ce(Ae){for(var Xe=0,Ke=0;Ke<Ae.length;Ke+=1)Xe+=Ae[Ke];return Xe/Ae.length}var fe=B("../check"),ae=B("../table"),W=B("./cmap"),Z=B("./cff"),A=B("./head"),R=B("./hhea"),X=B("./hmtx"),he=B("./ltag"),U=B("./maxp"),Re=B("./name"),Q=B("./os2"),be=B("./post"),Pe=B("./gsub"),Ge=B("./meta");G.computeCheckSum=P,G.make=ye,G.fontToTable=function(Ae){for(var Xe,Ke=[],yt=[],dt=[],It=[],wt=[],Gt=[],Dt=[],sn=0,gt=0,An=0,Bn=0,dn=0,On=0;On<Ae.glyphs.length;On+=1){var Ln=Ae.glyphs.get(On),mn=0|Ln.unicode;if(isNaN(Ln.advanceWidth))throw new Error("Glyph "+Ln.name+" ("+On+"): advanceWidth is not a number.");(Xe>mn||void 0===Xe)&&mn>0&&(Xe=mn),mn>sn&&(sn=mn);var cr=Q.getUnicodeRange(mn);if(32>cr)gt|=1<<cr;else if(64>cr)An|=1<<cr-32;else if(96>cr)Bn|=1<<cr-64;else{if(!(123>cr))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");dn|=1<<cr-96}if(".notdef"!==Ln.name){var rr=Ln.getMetrics();Ke.push(rr.xMin),yt.push(rr.yMin),dt.push(rr.xMax),It.push(rr.yMax),Gt.push(rr.leftSideBearing),Dt.push(rr.rightSideBearing),wt.push(Ln.advanceWidth)}}var ur={xMin:Math.min.apply(null,Ke),yMin:Math.min.apply(null,yt),xMax:Math.max.apply(null,dt),yMax:Math.max.apply(null,It),advanceWidthMax:Math.max.apply(null,wt),advanceWidthAvg:ce(wt),minLeftSideBearing:Math.min.apply(null,Gt),maxLeftSideBearing:Math.max.apply(null,Gt),minRightSideBearing:Math.min.apply(null,Dt)};ur.ascender=Ae.ascender,ur.descender=Ae.descender;var or=A.make({flags:3,unitsPerEm:Ae.unitsPerEm,xMin:ur.xMin,yMin:ur.yMin,xMax:ur.xMax,yMax:ur.yMax,lowestRecPPEM:3,createdTimestamp:Ae.createdTimestamp}),ni=R.make({ascender:ur.ascender,descender:ur.descender,advanceWidthMax:ur.advanceWidthMax,minLeftSideBearing:ur.minLeftSideBearing,minRightSideBearing:ur.minRightSideBearing,xMaxExtent:ur.maxLeftSideBearing+(ur.xMax-ur.xMin),numberOfHMetrics:Ae.glyphs.length}),Kr=U.make(Ae.glyphs.length),pi=Q.make({xAvgCharWidth:Math.round(ur.advanceWidthAvg),usWeightClass:Ae.tables.os2.usWeightClass,usWidthClass:Ae.tables.os2.usWidthClass,usFirstCharIndex:Xe,usLastCharIndex:sn,ulUnicodeRange1:gt,ulUnicodeRange2:An,ulUnicodeRange3:Bn,ulUnicodeRange4:dn,fsSelection:Ae.tables.os2.fsSelection,sTypoAscender:ur.ascender,sTypoDescender:ur.descender,sTypoLineGap:0,usWinAscent:ur.yMax,usWinDescent:Math.abs(ur.yMin),ulCodePageRange1:1,sxHeight:ie(Ae,"xyvw",{yMax:Math.round(ur.ascender/2)}).yMax,sCapHeight:ie(Ae,"HIKLEFJMNTZBDPRAGOQSUVWXY",ur).yMax,usDefaultChar:Ae.hasChar(" ")?32:0,usBreakChar:Ae.hasChar(" ")?32:0}),nr=X.make(Ae.glyphs),vr=W.make(Ae.glyphs),mi=Ae.getEnglishName("fontFamily"),_o=Ae.getEnglishName("fontSubfamily"),Nr=mi+" "+_o,ei=Ae.getEnglishName("postScriptName");ei||(ei=mi.replace(/\s/g,"")+"-"+_o);var Wr={};for(var yi in Ae.names)Wr[yi]=Ae.names[yi];Wr.uniqueID||(Wr.uniqueID={en:Ae.getEnglishName("manufacturer")+":"+Nr}),Wr.postScriptName||(Wr.postScriptName={en:ei}),Wr.preferredFamily||(Wr.preferredFamily=Ae.names.fontFamily),Wr.preferredSubfamily||(Wr.preferredSubfamily=Ae.names.fontSubfamily);var Ei=[],So=Re.make(Wr,Ei),Ws=Ei.length>0?he.make(Ei):void 0,la=be.make(),Ni=Z.make(Ae.glyphs,{version:Ae.getEnglishName("version"),fullName:Nr,familyName:mi,weightName:_o,postScriptName:ei,unitsPerEm:Ae.unitsPerEm,fontBBox:[0,ur.yMin,ur.ascender,ur.advanceWidthMax]}),Eo=Ae.metas&&Object.keys(Ae.metas).length>0?Ge.make(Ae.metas):void 0,go=[or,ni,Kr,pi,So,vr,la,Ni,nr];Ws&&go.push(Ws),Ae.tables.gsub&&go.push(Pe.make(Ae.tables.gsub)),Eo&&go.push(Eo);var Jr=ye(go),os=P(Jr.encode()),Ir=Jr.fields,Va=!1;for(On=0;On<Ir.length;On+=1)if("head table"===Ir[On].name){Ir[On].value.checkSumAdjustment=2981146554-os,Va=!0;break}if(!Va)throw new Error("Could not find head table with checkSum to adjust.");return Jr}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(B,D,G){function M(A){return function(){return A}}var P=B("./check"),de=2147483648,ye={},ie={},ce={};ie.BYTE=function(A){return P.argument(A>=0&&255>=A,"Byte value should be between 0 and 255."),[A]},ce.BYTE=M(1),ie.CHAR=function(A){return[A.charCodeAt(0)]},ce.CHAR=M(1),ie.CHARARRAY=function(A){for(var R=[],X=0;X<A.length;X+=1)R[X]=A.charCodeAt(X);return R},ce.CHARARRAY=function(A){return A.length},ie.USHORT=function(A){return[A>>8&255,255&A]},ce.USHORT=M(2),ie.SHORT=function(A){return A>=32768&&(A=-(65536-A)),[A>>8&255,255&A]},ce.SHORT=M(2),ie.UINT24=function(A){return[A>>16&255,A>>8&255,255&A]},ce.UINT24=M(3),ie.ULONG=function(A){return[A>>24&255,A>>16&255,A>>8&255,255&A]},ce.ULONG=M(4),ie.LONG=function(A){return A>=de&&(A=-(2*de-A)),[A>>24&255,A>>16&255,A>>8&255,255&A]},ce.LONG=M(4),ie.FIXED=ie.ULONG,ce.FIXED=ce.ULONG,ie.FWORD=ie.SHORT,ce.FWORD=ce.SHORT,ie.UFWORD=ie.USHORT,ce.UFWORD=ce.USHORT,ie.LONGDATETIME=function(A){return[0,0,0,0,A>>24&255,A>>16&255,A>>8&255,255&A]},ce.LONGDATETIME=M(8),ie.TAG=function(A){return P.argument(4===A.length,"Tag should be exactly 4 ASCII characters."),[A.charCodeAt(0),A.charCodeAt(1),A.charCodeAt(2),A.charCodeAt(3)]},ce.TAG=M(4),ie.Card8=ie.BYTE,ce.Card8=ce.BYTE,ie.Card16=ie.USHORT,ce.Card16=ce.USHORT,ie.OffSize=ie.BYTE,ce.OffSize=ce.BYTE,ie.SID=ie.USHORT,ce.SID=ce.USHORT,ie.NUMBER=function(A){return A>=-107&&107>=A?[A+139]:A>=108&&1131>=A?[247+((A-=108)>>8),255&A]:A>=-1131&&-108>=A?[251+((A=-A-108)>>8),255&A]:A>=-32768&&32767>=A?ie.NUMBER16(A):ie.NUMBER32(A)},ce.NUMBER=function(A){return ie.NUMBER(A).length},ie.NUMBER16=function(A){return[28,A>>8&255,255&A]},ce.NUMBER16=M(3),ie.NUMBER32=function(A){return[29,A>>24&255,A>>16&255,A>>8&255,255&A]},ce.NUMBER32=M(5),ie.REAL=function(A){var R=A.toString(),X=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(R);if(X){var he=parseFloat("1e"+((X[2]?+X[2]:0)+X[1].length));R=(Math.round(A*he)/he).toString()}var U,Re,Q="";for(U=0,Re=R.length;Re>U;U+=1){var be=R[U];Q+="e"===be?"-"===R[++U]?"c":"b":"."===be?"a":"-"===be?"e":be}var Pe=[30];for(U=0,Re=(Q+=1&Q.length?"f":"ff").length;Re>U;U+=2)Pe.push(parseInt(Q.substr(U,2),16));return Pe},ce.REAL=function(A){return ie.REAL(A).length},ie.NAME=ie.CHARARRAY,ce.NAME=ce.CHARARRAY,ie.STRING=ie.CHARARRAY,ce.STRING=ce.CHARARRAY,ye.UTF8=function(A,R,X){for(var he=[],U=X,Re=0;U>Re;Re++,R+=1)he[Re]=A.getUint8(R);return String.fromCharCode.apply(null,he)},ye.UTF16=function(A,R,X){for(var he=[],U=X/2,Re=0;U>Re;Re++,R+=2)he[Re]=A.getUint16(R);return String.fromCharCode.apply(null,he)},ie.UTF16=function(A){for(var R=[],X=0;X<A.length;X+=1){var he=A.charCodeAt(X);R[R.length]=he>>8&255,R[R.length]=255&he}return R},ce.UTF16=function(A){return 2*A.length};var fe={"x-mac-croatian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\u0160\u2122\xb4\xa8\u2260\u017d\xd8\u221e\xb1\u2264\u2265\u2206\xb5\u2202\u2211\u220f\u0161\u222b\xaa\xba\u03a9\u017e\xf8\xbf\xa1\xac\u221a\u0192\u2248\u0106\xab\u010c\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u0110\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\uf8ff\xa9\u2044\u20ac\u2039\u203a\xc6\xbb\u2013\xb7\u201a\u201e\u2030\xc2\u0107\xc1\u010d\xc8\xcd\xce\xcf\xcc\xd3\xd4\u0111\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u03c0\xcb\u02da\xb8\xca\xe6\u02c7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u2020\xb0\u0490\xa3\xa7\u2022\xb6\u0406\xae\xa9\u2122\u0402\u0452\u2260\u0403\u0453\u221e\xb1\u2264\u2265\u0456\xb5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040a\u045a\u0458\u0405\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\u040b\u045b\u040c\u045c\u0455\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u201e\u040e\u045e\u040f\u045f\u2116\u0401\u0451\u044f\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e","x-mac-gaelic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u1e02\xb1\u2264\u2265\u1e03\u010a\u010b\u1e0a\u1e0b\u1e1e\u1e1f\u0120\u0121\u1e40\xe6\xf8\u1e41\u1e56\u1e57\u027c\u0192\u017f\u1e60\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\u1e61\u1e9b\xff\u0178\u1e6a\u20ac\u2039\u203a\u0176\u0177\u1e6b\xb7\u1ef2\u1ef3\u204a\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\u2663\xd2\xda\xdb\xd9\u0131\xdd\xfd\u0174\u0175\u1e84\u1e85\u1e80\u1e81\u1e82\u1e83","x-mac-greek":"\xc4\xb9\xb2\xc9\xb3\xd6\xdc\u0385\xe0\xe2\xe4\u0384\xa8\xe7\xe9\xe8\xea\xeb\xa3\u2122\xee\xef\u2022\xbd\u2030\xf4\xf6\xa6\u20ac\xf9\xfb\xfc\u2020\u0393\u0394\u0398\u039b\u039e\u03a0\xdf\xae\xa9\u03a3\u03aa\xa7\u2260\xb0\xb7\u0391\xb1\u2264\u2265\xa5\u0392\u0395\u0396\u0397\u0399\u039a\u039c\u03a6\u03ab\u03a8\u03a9\u03ac\u039d\xac\u039f\u03a1\u2248\u03a4\xab\xbb\u2026\xa0\u03a5\u03a7\u0386\u0388\u0153\u2013\u2015\u201c\u201d\u2018\u2019\xf7\u0389\u038a\u038c\u038e\u03ad\u03ae\u03af\u03cc\u038f\u03cd\u03b1\u03b2\u03c8\u03b4\u03b5\u03c6\u03b3\u03b7\u03b9\u03be\u03ba\u03bb\u03bc\u03bd\u03bf\u03c0\u03ce\u03c1\u03c3\u03c4\u03b8\u03c9\u03c2\u03c7\u03c5\u03b6\u03ca\u03cb\u0390\u03b0\xad","x-mac-icelandic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\xdd\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\xd0\xf0\xde\xfe\xfd\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140a\u140b\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144e\u144f\u1450\u1451\u1455\u1456\u1466\u146d\u146e\u146f\u1470\u1472\u1473\u1483\u148b\u148c\u148d\u148e\u1490\u1491\xb0\u14a1\u14a5\u14a6\u2022\xb6\u14a7\xae\xa9\u2122\u14a8\u14aa\u14ab\u14bb\u14c2\u14c3\u14c4\u14c5\u14c7\u14c8\u14d0\u14ef\u14f0\u14f1\u14f2\u14f4\u14f5\u1505\u14d5\u14d6\u14d7\u14d8\u14da\u14db\u14ea\u1528\u1529\u152a\u152b\u152d\u2026\xa0\u152e\u153e\u1555\u1556\u1557\u2013\u2014\u201c\u201d\u2018\u2019\u1558\u1559\u155a\u155d\u1546\u1547\u1548\u1549\u154b\u154c\u1550\u157f\u1580\u1581\u1582\u1583\u1584\u1585\u158f\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15a0\u15a1\u15a2\u15a3\u15a4\u15a5\u15a6\u157c\u0141\u0142","x-mac-ce":"\xc4\u0100\u0101\xc9\u0104\xd6\xdc\xe1\u0105\u010c\xe4\u010d\u0106\u0107\xe9\u0179\u017a\u010e\xed\u010f\u0112\u0113\u0116\xf3\u0117\xf4\xf6\xf5\xfa\u011a\u011b\xfc\u2020\xb0\u0118\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\u0119\xa8\u2260\u0123\u012e\u012f\u012a\u2264\u2265\u012b\u0136\u2202\u2211\u0142\u013b\u013c\u013d\u013e\u0139\u013a\u0145\u0146\u0143\xac\u221a\u0144\u0147\u2206\xab\xbb\u2026\xa0\u0148\u0150\xd5\u0151\u014c\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\u014d\u0154\u0155\u0158\u2039\u203a\u0159\u0156\u0157\u0160\u201a\u201e\u0161\u015a\u015b\xc1\u0164\u0165\xcd\u017d\u017e\u016a\xd3\xd4\u016b\u016e\xda\u016f\u0170\u0171\u0172\u0173\xdd\xfd\u0137\u017b\u0141\u017c\u0122\u02c7",macintosh:"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\ufb01\ufb02\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-romanian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\u0102\u0218\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\u0103\u0219\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\u021a\u021b\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-turkish":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u011e\u011f\u0130\u0131\u015e\u015f\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\uf8a0\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7"};ye.MACSTRING=function(A,R,X,he){var U=fe[he];if(void 0!==U){for(var Re="",Q=0;X>Q;Q++){var be=A.getUint8(R+Q);Re+=127>=be?String.fromCharCode(be):U[127&be]}return Re}};var ae,W="function"==typeof WeakMap&&new WeakMap;ie.MACSTRING=function(A,R){var X=function(Q){if(!ae)for(var be in ae={},fe)ae[be]=new String(be);var Pe=ae[Q];if(void 0!==Pe){if(W){var Ge=W.get(Pe);if(void 0!==Ge)return Ge}var Ae=fe[Q];if(void 0!==Ae){for(var Xe={},Ke=0;Ke<Ae.length;Ke++)Xe[Ae.charCodeAt(Ke)]=Ke+128;return W&&W.set(Pe,Xe),Xe}}}(R);if(void 0!==X){for(var he=[],U=0;U<A.length;U++){var Re=A.charCodeAt(U);if(Re>=128&&void 0===(Re=X[Re]))return;he[U]=Re}return he}},ce.MACSTRING=function(A,R){var X=ie.MACSTRING(A,R);return void 0!==X?X.length:0},ie.INDEX=function(A){var R,X=1,he=[X],U=[];for(R=0;R<A.length;R+=1){var Re=ie.OBJECT(A[R]);Array.prototype.push.apply(U,Re),he.push(X+=Re.length)}if(0===U.length)return[0,0];var Q=[],be=1+Math.floor(Math.log(X)/Math.log(2))/8|0,Pe=[void 0,ie.BYTE,ie.USHORT,ie.UINT24,ie.ULONG][be];for(R=0;R<he.length;R+=1){var Ge=Pe(he[R]);Array.prototype.push.apply(Q,Ge)}return Array.prototype.concat(ie.Card16(A.length),ie.OffSize(be),Q,U)},ce.INDEX=function(A){return ie.INDEX(A).length},ie.DICT=function(A){for(var R=[],X=Object.keys(A),he=X.length,U=0;he>U;U+=1){var Re=parseInt(X[U],0),Q=A[Re];R=(R=R.concat(ie.OPERAND(Q.value,Q.type))).concat(ie.OPERATOR(Re))}return R},ce.DICT=function(A){return ie.DICT(A).length},ie.OPERATOR=function(A){return 1200>A?[A]:[12,A-1200]},ie.OPERAND=function(A,R){var X=[];if(Array.isArray(R))for(var he=0;he<R.length;he+=1)P.argument(A.length===R.length,"Not enough arguments given for type"+R),X=X.concat(ie.OPERAND(A[he],R[he]));else if("SID"===R)X=X.concat(ie.NUMBER(A));else if("offset"===R)X=X.concat(ie.NUMBER32(A));else if("number"===R)X=X.concat(ie.NUMBER(A));else{if("real"!==R)throw new Error("Unknown operand type "+R);X=X.concat(ie.REAL(A))}return X},ie.OP=ie.BYTE,ce.OP=ce.BYTE;var Z="function"==typeof WeakMap&&new WeakMap;ie.CHARSTRING=function(A){if(Z){var R=Z.get(A);if(void 0!==R)return R}for(var X=[],he=A.length,U=0;he>U;U+=1){var Re=A[U];X=X.concat(ie[Re.type](Re.value))}return Z&&Z.set(A,X),X},ce.CHARSTRING=function(A){return ie.CHARSTRING(A).length},ie.OBJECT=function(A){var R=ie[A.type];return P.argument(void 0!==R,"No encoding function for type "+A.type),R(A.value)},ce.OBJECT=function(A){var R=ce[A.type];return P.argument(void 0!==R,"No sizeOf function for type "+A.type),R(A.value)},ie.TABLE=function(A){var R,X=[],he=A.fields.length,U=[],Re=[];for(R=0;he>R;R+=1){var Q=A.fields[R],be=ie[Q.type];P.argument(void 0!==be,"No encoding function for field type "+Q.type+" ("+Q.name+")");var Pe=A[Q.name];void 0===Pe&&(Pe=Q.value);var Ge=be(Pe);"TABLE"===Q.type?(Re.push(X.length),X=X.concat([0,0]),U.push(Ge)):X=X.concat(Ge)}for(R=0;R<U.length;R+=1){var Ae=Re[R],Xe=X.length;P.argument(65536>Xe,"Table "+A.tableName+" too big."),X[Ae]=Xe>>8,X[Ae+1]=255&Xe,X=X.concat(U[R])}return X},ce.TABLE=function(A){for(var R=0,X=A.fields.length,he=0;X>he;he+=1){var U=A.fields[he],Re=ce[U.type];P.argument(void 0!==Re,"No sizeOf function for field type "+U.type+" ("+U.name+")");var Q=A[U.name];void 0===Q&&(Q=U.value),R+=Re(Q),"TABLE"===U.type&&(R+=2)}return R},ie.RECORD=ie.TABLE,ce.RECORD=ce.TABLE,ie.LITERAL=function(A){return A},ce.LITERAL=function(A){return A.length},G.decode=ye,G.encode=ie,G.sizeOf=ce},{"./check":2}],33:[function(B,D,G){G.isBrowser=function(){return typeof window<"u"},G.isNode=function(){return typeof window>"u"},G.nodeBufferToArrayBuffer=function(M){for(var P=new ArrayBuffer(M.length),de=new Uint8Array(P),ye=0;ye<M.length;++ye)de[ye]=M[ye];return P},G.arrayBufferToNodeBuffer=function(M){for(var P=new Buffer(M.byteLength),de=new Uint8Array(M),ye=0;ye<P.length;++ye)P[ye]=de[ye];return P},G.checkArgument=function(M,P){if(!M)throw P}},{}]},{},[9])(9)});var x=window.opentype},408:n=>{var o=/\n/,l="\n",x=/\s/;function B(M,P,de,ye){var ie=M.indexOf(P,de);return-1===ie||ie>ye?ye:ie}function D(M){return x.test(M)}function G(M,P,de,ye){return{start:P,end:P+Math.min(ye,de-P)}}n.exports=function(M,P){return n.exports.lines(M,P).map(function(de){return M.substring(de.start,de.end)}).join("\n")},n.exports.lines=function(M,P){if(0===(P=P||{}).width&&"nowrap"!==P.mode)return[];M=M||"";var de="number"==typeof P.width?P.width:Number.MAX_VALUE,ye=Math.max(0,P.start||0),ie="number"==typeof P.end?P.end:M.length,ce=P.mode,fe=P.measure||G;return"pre"===ce?function(ae,W,Z,A,R){for(var X=[],he=Z,U=Z;U<A&&U<W.length;U++){var Re=W.charAt(U),Q=o.test(Re);if(Q||U===A-1){var be=ae(W,he,Q?U:U+1,R);X.push(be),he=U+1}}return X}(fe,M,ye,ie,de):function(ae,W,Z,A,R,X){var he=[],U=R;for("nowrap"===X&&(U=Number.MAX_VALUE);Z<A&&Z<W.length;){for(var Re=B(W,l,Z,A);Z<Re&&D(W.charAt(Z));)Z++;var Q=ae(W,Z,Re,U),be=Z+(Q.end-Q.start),Pe=be+l.length;if(be<Re){for(;be>Z&&!D(W.charAt(be));)be--;if(be===Z)Pe>Z+l.length&&Pe--,be=Pe;else for(Pe=be;be>Z&&D(W.charAt(be-l.length));)be--}if(be>=Z){var Ge=ae(W,Z,be,U);he.push(Ge)}Z=Pe}return he}(fe,M,ye,ie,de,ce)}},720:n=>{n.exports=function(){for(var l={},x=0;x<arguments.length;x++){var B=arguments[x];for(var D in B)o.call(B,D)&&(l[D]=B[D])}return l};var o=Object.prototype.hasOwnProperty},500:(n,o,l)=>{var x=l(412);x.KeyframeTrack.prototype.color="#FF0000",x.KeyframeTrack.prototype.setColor=function(B){this.color=B},x.KeyframeTrack.prototype.sort=function(){for(var B=0;B<this.times.length;B++)for(var D=B+1;D<this.times.length;D++)if(this.times[B]>this.times[D]){var G=this.times[D];this.times[D]=this.times[B],this.times[B]=G;for(var M=this.getValueSize(),P=D*M,de=B*M,ye=0;ye<M;ye++)G=this.values[P+ye],this.values[P+ye]=this.values[de+ye],this.values[de+ye]=G}},x.KeyframeTrack._toJSON=x.KeyframeTrack.toJSON,x.KeyframeTrack.toJSON=function(B){var D=x.KeyframeTrack._toJSON.call(this,B);return D.color=B.color,D},x.KeyframeTrack._parse=x.KeyframeTrack.parse,x.KeyframeTrack.parse=function(B){var D=x.KeyframeTrack._parse.call(this,B);return void 0!==B.color&&(D.color=B.color),D}},10:(n,o,l)=>{l(412).Camera.prototype.render=function(x,B){x.render(B,this)}},939:(n,o,l)=>{l(412).BufferAttribute.prototype.toJSON=function(){return{type:"BufferAttribute",typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},itemSize:this.itemSize,normalized:this.normalized}}},12:(n,o,l)=>{l(412).InterleavedBuffer.prototype.toJSON=function(){return{typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},stride:this.stride,count:this.count,usage:this.usage}}},443:(n,o,l)=>{l(412).InterleavedBufferAttribute.prototype.toJSON=function(){return{type:"InterleavedBufferAttribute",data:this.data.toJSON(),itemSize:this.itemSize,offset:this.offset,normalized:this.normalized}}},870:(n,o,l)=>{var x=l(412);x.LightShadow.prototype.toJSON=function(){var B={};return B.bias=this.bias,B.radius=this.radius,B.mapSize={x:this.mapSize.x,y:this.mapSize.y},B.camera={top:this.camera.top,bottom:this.camera.bottom,far:this.camera.far,near:this.camera.near,left:this.camera.left,right:this.camera.right},B},x.LightShadow.prototype.fromJSON=function(B){if(void 0!==B.bias&&(this.bias=B.bias),void 0!==B.radius&&(this.radius=B.radius),void 0!==B.mapSize){var D=B.mapSize;this.mapSize.set(D.x,D.y)}if(void 0!==B.camera){var G=B.camera;this.camera.top=G.top,this.camera.bottom=G.bottom,this.camera.left=G.left,this.camera.right=G.right,this.camera.near=G.near,this.camera.far=G.far}}},819:(n,o,l)=>{var x=l(412);x.Fog.NONE=0,x.Fog.LINEAR=1,x.Fog.EXPONENTIAL=2}},__webpack_module_cache__={};function __webpack_require__(n){var o=__webpack_module_cache__[n];if(void 0!==o)return o.exports;var l=__webpack_module_cache__[n]={id:n,loaded:!1,exports:{}};return __webpack_modules__[n].call(l.exports,l,l.exports,__webpack_require__),l.loaded=!0,l.exports}__webpack_require__.amdO={},__webpack_require__.n=n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return __webpack_require__.d(o,{a:o}),o},__webpack_require__.d=(n,o)=>{for(var l in o)__webpack_require__.o(o,l)&&!__webpack_require__.o(n,l)&&Object.defineProperty(n,l,{enumerable:!0,get:o[l]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),__webpack_require__.hmd=n=>((n=Object.create(n)).children||(n.children=[]),Object.defineProperty(n,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+n.id)}}),n),__webpack_require__.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ARHandler:()=>Wo,AdaptiveToneMappingPass:()=>tu,AfterimagePass:()=>ui,AmbientLight:()=>Cs,AnimationMixer:()=>pc,AnimationTimer:()=>td,App:()=>Qo,ArraybufferUtils:()=>_a,Audio:()=>Ot,AudioEmitter:()=>ii,AudioLoader:()=>Bh,Base64Utils:()=>ci,BloomPass:()=>Fr,BokehPass:()=>Ka,BufferUtils:()=>Za,CSS3DObject:()=>vl,CSS3DRenderer:()=>ku,CSS3DSprite:()=>lu,CanvasSprite:()=>kc,CanvasTexture:()=>Oa,CapsuleBufferGeometry:()=>Fc,ColorifyPass:()=>Lp,CompressedTexture:()=>jl,CopyPass:()=>eu,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>zl,DirectionalLight:()=>ml,DotScreenPass:()=>Bc,EffectComposer:()=>Mo,EventManager:()=>hn,FXAAPass:()=>qp,FileSystem:()=>Rn,FilmPass:()=>gl,FirstPersonControls:()=>nu,Font:()=>Je,FontLoader:()=>ph,Gamepad:()=>Yr,GeometryLoader:()=>Ru,Group:()=>Tu,Gyroscope:()=>Ou,HTMLView:()=>rc,HemisphereLight:()=>Mu,HueSaturationPass:()=>Po,Image:()=>fs,ImageLoader:()=>Bu,InstancedMesh:()=>Qs,Key:()=>li,Keyboard:()=>Vn,LegacyGeometryLoader:()=>bs,LensFlare:()=>ch,LightProbe:()=>Rc,LocalStorage:()=>Ua,MaterialLoader:()=>iu,MathUtils:()=>Qc,Mesh:()=>uh,Model:()=>bt,Mouse:()=>Zr,NodeScript:()=>Ti,Nunu:()=>eo,ObjectLoader:()=>Co,ObjectUtils:()=>pu,OrbitControls:()=>va,OrthographicCamera:()=>Ps,ParametricBufferGeometry:()=>Nu,ParticleEmitter:()=>ko,ParticleEmitterControl:()=>ji,ParticleGroup:()=>Gs,ParticleShaders:()=>Pu,Pass:()=>mr,PerspectiveCamera:()=>ke,PhysicsGenerator:()=>vi,PhysicsObject:()=>De,PointLight:()=>He,PositionalAudio:()=>Wt,Program:()=>hi,RectAreaLight:()=>In,RenderPass:()=>_l,RendererConfiguration:()=>ka,RendererState:()=>Kh,Resource:()=>wi,ResourceContainer:()=>B,ResourceManager:()=>io,RoundedBoxBufferGeometry:()=>hh,SSAONOHPass:()=>Ai,SSAOPass:()=>Ro,SSAOShader:()=>Bs,Scene:()=>Fo,Script:()=>Tn,ShaderAttribute:()=>Lo,ShaderPass:()=>Jo,ShaderUtils:()=>kt,SkinnedMesh:()=>Gn,Sky:()=>Lr,SobelPass:()=>Rs,SpineAnimation:()=>Ia,SpineTexture:()=>Lu,SpotLight:()=>Us,Sprite:()=>Oc,SpriteSheetTexture:()=>Ul,TargetConfig:()=>ip,TechnicolorPass:()=>Kc,TerrainBufferGeometry:()=>hc,TextBitmap:()=>Vo,TextFile:()=>Fl,TextMesh:()=>ea,TextSprite:()=>cc,Texture:()=>ms,TextureLoader:()=>Is,Timer:()=>ed,TizenKeyboard:()=>Mr,TwistModifier:()=>Fu,TypedArrayHelper:()=>Oo,UnitConverter:()=>xr,UnrealBloomPass:()=>Ls,VRHandler:()=>gi,Video:()=>Dl,VideoLoader:()=>Nh,VideoStream:()=>Fa,VideoTexture:()=>xa,Viewport:()=>Io,WebcamTexture:()=>zs,WorkerPool:()=>Ss,WorkerTask:()=>dc});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{AABB:()=>ie,ArrayCollisionMatrix:()=>ae,BODY_SLEEP_STATES:()=>yt,BODY_TYPES:()=>Ke,Body:()=>dt,Box:()=>Ge,Broadphase:()=>rr,COLLISION_TYPES:()=>Ui,ConeTwistConstraint:()=>qu,Constraint:()=>du,ContactEquation:()=>To,ContactMaterial:()=>Yu,ConvexPolyhedron:()=>Q,Cylinder:()=>Xt,DistanceConstraint:()=>ps,Equation:()=>Ts,EventTarget:()=>W,FrictionEquation:()=>_c,GSSolver:()=>yu,GridBroadphase:()=>pi,Heightfield:()=>Sn,HingeConstraint:()=>_p,JacobianElement:()=>fu,LockConstraint:()=>Xl,Mat3:()=>G,Material:()=>Ju,NaiveBroadphase:()=>vr,Narrowphase:()=>Or,ObjectCollisionMatrix:()=>D,Particle:()=>pn,Plane:()=>Fn,PointToPointConstraint:()=>mc,Pool:()=>bu,Quaternion:()=>Z,RAY_MODES:()=>_o,Ray:()=>Nr,RaycastResult:()=>mi,RaycastVehicle:()=>Gh,RigidVehicle:()=>nh,RotationalEquation:()=>Tl,RotationalMotorEquation:()=>Xu,SAPBroadphase:()=>hs,SHAPE_TYPES:()=>X,SPHSystem:()=>pe,Shape:()=>he,Solver:()=>vo,Sphere:()=>xc,SplitSolver:()=>Ms,Spring:()=>cl,Transform:()=>U,Trimesh:()=>pl,Vec3:()=>M,Vec3Pool:()=>Mp,World:()=>Un});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{ARHandler:()=>Wo,AdaptiveToneMappingPass:()=>tu,AfterimagePass:()=>ui,AmbientLight:()=>Cs,AnimationMixer:()=>pc,AnimationTimer:()=>td,App:()=>Qo,ArraybufferUtils:()=>_a,Audio:()=>Ot,AudioEmitter:()=>ii,AudioLoader:()=>Bh,Base64Utils:()=>ci,BloomPass:()=>Fr,BokehPass:()=>Ka,BufferUtils:()=>Za,CSS3DObject:()=>vl,CSS3DRenderer:()=>ku,CSS3DSprite:()=>lu,CanvasSprite:()=>kc,CanvasTexture:()=>Oa,CapsuleBufferGeometry:()=>Fc,ColorifyPass:()=>Lp,CompressedTexture:()=>jl,CopyPass:()=>eu,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>zl,DirectionalLight:()=>ml,DotScreenPass:()=>Bc,EffectComposer:()=>Mo,EventManager:()=>hn,FXAAPass:()=>qp,FileSystem:()=>Rn,FilmPass:()=>gl,FirstPersonControls:()=>nu,Font:()=>Je,FontLoader:()=>ph,Gamepad:()=>Yr,GeometryLoader:()=>Ru,Group:()=>Tu,Gyroscope:()=>Ou,HTMLView:()=>rc,HemisphereLight:()=>Mu,HueSaturationPass:()=>Po,Image:()=>fs,ImageLoader:()=>Bu,InstancedMesh:()=>Qs,Key:()=>li,Keyboard:()=>Vn,LegacyGeometryLoader:()=>bs,LensFlare:()=>ch,LightProbe:()=>Rc,LocalStorage:()=>Ua,MaterialLoader:()=>iu,MathUtils:()=>Qc,Mesh:()=>uh,Model:()=>bt,Mouse:()=>Zr,NodeScript:()=>Ti,Nunu:()=>eo,ObjectLoader:()=>Co,ObjectUtils:()=>pu,OrbitControls:()=>va,OrthographicCamera:()=>Ps,ParametricBufferGeometry:()=>Nu,ParticleEmitter:()=>ko,ParticleEmitterControl:()=>ji,ParticleGroup:()=>Gs,ParticleShaders:()=>Pu,Pass:()=>mr,PerspectiveCamera:()=>ke,PhysicsGenerator:()=>vi,PhysicsObject:()=>De,PointLight:()=>He,PositionalAudio:()=>Wt,Program:()=>hi,RectAreaLight:()=>In,RenderPass:()=>_l,RendererConfiguration:()=>ka,RendererState:()=>Kh,Resource:()=>wi,ResourceContainer:()=>B,ResourceManager:()=>io,RoundedBoxBufferGeometry:()=>hh,SSAONOHPass:()=>Ai,SSAOPass:()=>Ro,SSAOShader:()=>Bs,Scene:()=>Fo,Script:()=>Tn,ShaderAttribute:()=>Lo,ShaderPass:()=>Jo,ShaderUtils:()=>kt,SkinnedMesh:()=>Gn,Sky:()=>Lr,SobelPass:()=>Rs,SpineAnimation:()=>Ia,SpineTexture:()=>Lu,SpotLight:()=>Us,Sprite:()=>Oc,SpriteSheetTexture:()=>Ul,TargetConfig:()=>ip,TechnicolorPass:()=>Kc,TerrainBufferGeometry:()=>hc,TextBitmap:()=>Vo,TextFile:()=>Fl,TextMesh:()=>ea,TextSprite:()=>cc,Texture:()=>ms,TextureLoader:()=>Is,Timer:()=>ed,TizenKeyboard:()=>Mr,TwistModifier:()=>Fu,TypedArrayHelper:()=>Oo,UnitConverter:()=>xr,UnrealBloomPass:()=>Ls,VRHandler:()=>gi,Video:()=>Dl,VideoLoader:()=>Nh,VideoStream:()=>Fa,VideoTexture:()=>xa,Viewport:()=>Io,WebcamTexture:()=>zs,WorkerPool:()=>Ss,WorkerTask:()=>dc});var l=__webpack_require__(412),x=__webpack_require__(412);function B(){this.images=[],this.videos=[],this.audio=[],this.fonts=[],this.materials=[],this.textures=[],this.geometries=[],this.resources=[],this.shapes=[],this.skeletons=[]}x.AnimationClip.prototype.enabled=!0,x.AnimationClip.prototype.loop=l.LoopRepeat,x.AnimationClip.prototype.timeScale=1,x.AnimationClip.prototype.weight=1,x.AnimationClip._toJSON=x.AnimationClip.toJSON,x.AnimationClip.toJSON=function(a){var r=x.AnimationClip._toJSON.call(this,a);return r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight,r},x.AnimationClip._parse=x.AnimationClip.parse,x.AnimationClip.parse=function(a){var r=x.AnimationClip._parse.call(this,a);return void 0!==a.enabled&&(r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight),r},__webpack_require__(500),__webpack_require__(10),__webpack_require__(939),__webpack_require__(412).InstancedBufferAttribute.prototype.toJSON=function(){var a=l.BufferAttribute.prototype.toJSON.call(this);return a.type="InstancedBufferAttribute",a.meshPerAttribute=this.meshPerAttribute,a},__webpack_require__(12),__webpack_require__(443),B.libraries=["images","videos","audio","fonts","materials","textures","geometries","resources","shapes","skeletons"],B.prototype.copyResources=function(a){this.materials=a.materials,this.textures=a.textures,this.resources=a.resources,this.fonts=a.fonts,this.audio=a.audio,this.geometries=a.geometries,this.images=a.images,this.videos=a.videos,this.shapes=a.shapes,this.skeletons=a.skeletons},B.prototype.getTexture=function(a){return void 0===this.textures[a]&&console.warn("nunuStudio: ResourceContainer, Undefined texture",a),this.textures[a]},B.prototype.getGeometry=function(a){return void 0===this.geometries[a]&&console.warn("nunuStudio: ResourceContainer, Undefined geometry",a),this.geometries[a]},B.prototype.getMaterial=function(a){if(a instanceof Array){for(var r=[],h=0;h<a.length;h++)void 0===this.materials[a[h]]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),r.push(this.materials[a[h]]);return r}return void 0===this.materials[a]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),this.materials[a]},B.prototype.getFont=function(a){return void 0===this.fonts[a]&&console.warn("nunuStudio: ResourceContainer, Undefined font",a),this.fonts[a]},B.prototype.getAudio=function(a){return void 0===this.audio[a]&&console.warn("nunuStudio: ResourceContainer, Undefined audio",a),this.audio[a]};class D{constructor(){this.matrix={}}get(r,h){let{id:p}=r,{id:y}=h;if(y>p){const b=y;y=p,p=b}return p+"-"+y in this.matrix}set(r,h,p){let{id:y}=r,{id:b}=h;if(b>y){const N=b;b=y,y=N}p?this.matrix[y+"-"+b]=!0:delete this.matrix[y+"-"+b]}reset(){this.matrix={}}setNumObjects(r){}}class G{constructor(r=[0,0,0,0,0,0,0,0,0]){this.elements=r}identity(){const r=this.elements;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1}setZero(){const r=this.elements;r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0}setTrace(r){const h=this.elements;h[0]=r.x,h[4]=r.y,h[8]=r.z}getTrace(r=new M){const h=this.elements;r.x=h[0],r.y=h[4],r.z=h[8]}vmult(r,h=new M){const p=this.elements,y=r.x,b=r.y,N=r.z;return h.x=p[0]*y+p[1]*b+p[2]*N,h.y=p[3]*y+p[4]*b+p[5]*N,h.z=p[6]*y+p[7]*b+p[8]*N,h}smult(r){for(let h=0;h<this.elements.length;h++)this.elements[h]*=r}mmult(r,h=new G){const{elements:p}=r;for(let y=0;y<3;y++)for(let b=0;b<3;b++){let N=0;for(let O=0;O<3;O++)N+=p[y+3*O]*this.elements[O+3*b];h.elements[y+3*b]=N}return h}scale(r,h=new G){const p=this.elements,y=h.elements;for(let b=0;3!==b;b++)y[3*b+0]=r.x*p[3*b+0],y[3*b+1]=r.y*p[3*b+1],y[3*b+2]=r.z*p[3*b+2];return h}solve(r,h=new M){const p=[];let y,b;for(y=0;y<12;y++)p.push(0);for(y=0;y<3;y++)for(b=0;b<3;b++)p[y+4*b]=this.elements[y+3*b];p[3]=r.x,p[7]=r.y,p[11]=r.z;let N=3;const O=N;let T,z;do{if(y=O-N,0===p[y+4*y])for(b=y+1;b<O;b++)if(0!==p[y+4*b]){T=4;do{z=4-T,p[z+4*y]+=p[z+4*b]}while(--T);break}if(0!==p[y+4*y])for(b=y+1;b<O;b++){const ee=p[y+4*b]/p[y+4*y];T=4;do{z=4-T,p[z+4*b]=z<=y?0:p[z+4*b]-p[z+4*y]*ee}while(--T)}}while(--N);if(h.z=p[11]/p[10],h.y=(p[7]-p[6]*h.z)/p[5],h.x=(p[3]-p[2]*h.z-p[1]*h.y)/p[0],isNaN(h.x)||isNaN(h.y)||isNaN(h.z)||h.x===1/0||h.y===1/0||h.z===1/0)throw"Could not solve equation! Got x=["+h.toString()+"], b=["+r.toString()+"], A=["+this.toString()+"]";return h}e(r,h,p){if(void 0===p)return this.elements[h+3*r];this.elements[h+3*r]=p}copy(r){for(let h=0;h<r.elements.length;h++)this.elements[h]=r.elements[h];return this}toString(){let r="";for(let h=0;h<9;h++)r+=this.elements[h]+",";return r}reverse(r=new G){const h=[];let p,y;for(p=0;p<18;p++)h.push(0);for(p=0;p<3;p++)for(y=0;y<3;y++)h[p+6*y]=this.elements[p+3*y];h[3]=1,h[9]=0,h[15]=0,h[4]=0,h[10]=1,h[16]=0,h[5]=0,h[11]=0,h[17]=1;let b=3;const N=b;let O,T;do{if(p=N-b,0===h[p+6*p])for(y=p+1;y<N;y++)if(0!==h[p+6*y]){O=6;do{T=6-O,h[T+6*p]+=h[T+6*y]}while(--O);break}if(0!==h[p+6*p])for(y=p+1;y<N;y++){const z=h[p+6*y]/h[p+6*p];O=6;do{T=6-O,h[T+6*y]=T<=p?0:h[T+6*y]-h[T+6*p]*z}while(--O)}}while(--b);p=2;do{y=p-1;do{const z=h[p+6*y]/h[p+6*p];O=6;do{T=6-O,h[T+6*y]=h[T+6*y]-h[T+6*p]*z}while(--O)}while(y--)}while(--p);p=2;do{const z=1/h[p+6*p];O=6;do{T=6-O,h[T+6*p]=h[T+6*p]*z}while(--O)}while(p--);p=2;do{y=2;do{if(T=h[3+y+6*p],isNaN(T)||T===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(p,y,T)}while(y--)}while(p--);return r}setRotationFromQuaternion(r){const h=r.x,p=r.y,y=r.z,b=r.w,N=h+h,O=p+p,T=y+y,z=h*N,ee=h*O,oe=h*T,ne=p*O,ve=p*T,xe=y*T,Te=b*N,Ce=b*O,Ie=b*T,Oe=this.elements;return Oe[0]=1-(ne+xe),Oe[1]=ee-Ie,Oe[2]=oe+Ce,Oe[3]=ee+Ie,Oe[4]=1-(z+xe),Oe[5]=ve-Te,Oe[6]=oe-Ce,Oe[7]=ve+Te,Oe[8]=1-(z+ne),this}transpose(r=new G){const h=r.elements,p=this.elements;for(let y=0;3!==y;y++)for(let b=0;3!==b;b++)h[3*y+b]=p[3*b+y];return r}}class M{constructor(r=0,h=0,p=0){this.x=r,this.y=h,this.z=p}cross(r,h=new M){const p=r.x,y=r.y,b=r.z,N=this.x,O=this.y,T=this.z;return h.x=O*b-T*y,h.y=T*p-N*b,h.z=N*y-O*p,h}set(r,h,p){return this.x=r,this.y=h,this.z=p,this}setZero(){this.x=this.y=this.z=0}vadd(r,h){if(!h)return new M(this.x+r.x,this.y+r.y,this.z+r.z);h.x=r.x+this.x,h.y=r.y+this.y,h.z=r.z+this.z}vsub(r,h){if(!h)return new M(this.x-r.x,this.y-r.y,this.z-r.z);h.x=this.x-r.x,h.y=this.y-r.y,h.z=this.z-r.z}crossmat(){return new G([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const r=this.x,h=this.y,p=this.z,y=Math.sqrt(r*r+h*h+p*p);if(y>0){const b=1/y;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return y}unit(r=new M){const h=this.x,p=this.y,y=this.z;let b=Math.sqrt(h*h+p*p+y*y);return b>0?(b=1/b,r.x=h*b,r.y=p*b,r.z=y*b):(r.x=1,r.y=0,r.z=0),r}length(){const r=this.x,h=this.y,p=this.z;return Math.sqrt(r*r+h*h+p*p)}lengthSquared(){return this.dot(this)}distanceTo(r){const h=this.x,p=this.y,y=this.z,b=r.x,N=r.y,O=r.z;return Math.sqrt((b-h)*(b-h)+(N-p)*(N-p)+(O-y)*(O-y))}distanceSquared(r){const h=this.x,p=this.y,y=this.z,b=r.x,N=r.y,O=r.z;return(b-h)*(b-h)+(N-p)*(N-p)+(O-y)*(O-y)}scale(r,h=new M){const y=this.y,b=this.z;return h.x=r*this.x,h.y=r*y,h.z=r*b,h}vmul(r,h=new M){return h.x=r.x*this.x,h.y=r.y*this.y,h.z=r.z*this.z,h}addScaledVector(r,h,p=new M){return p.x=this.x+r*h.x,p.y=this.y+r*h.y,p.z=this.z+r*h.z,p}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(r=new M){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r}tangents(r,h){const p=this.length();if(p>0){const y=P,b=1/p;y.set(this.x*b,this.y*b,this.z*b);const N=de;Math.abs(y.x)<.9?(N.set(1,0,0),y.cross(N,r)):(N.set(0,1,0),y.cross(N,r)),y.cross(r,h)}else r.set(1,0,0),h.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}lerp(r,h,p){const y=this.x,b=this.y,N=this.z;p.x=y+(r.x-y)*h,p.y=b+(r.y-b)*h,p.z=N+(r.z-N)*h}almostEquals(r,h=1e-6){return!(Math.abs(this.x-r.x)>h||Math.abs(this.y-r.y)>h||Math.abs(this.z-r.z)>h)}almostZero(r=1e-6){return!(Math.abs(this.x)>r||Math.abs(this.y)>r||Math.abs(this.z)>r)}isAntiparallelTo(r,h){return this.negate(ye),ye.almostEquals(r,h)}clone(){return new M(this.x,this.y,this.z)}}M.ZERO=new M(0,0,0),M.UNIT_X=new M(1,0,0),M.UNIT_Y=new M(0,1,0),M.UNIT_Z=new M(0,0,1);const P=new M,de=new M,ye=new M;class ie{constructor(r={}){this.lowerBound=new M,this.upperBound=new M,r.lowerBound&&this.lowerBound.copy(r.lowerBound),r.upperBound&&this.upperBound.copy(r.upperBound)}setFromPoints(r,h,p,y){const b=this.lowerBound,N=this.upperBound,O=p;b.copy(r[0]),O&&O.vmult(b,b),N.copy(b);for(let T=1;T<r.length;T++){let z=r[T];O&&(O.vmult(z,ce),z=ce),z.x>N.x&&(N.x=z.x),z.x<b.x&&(b.x=z.x),z.y>N.y&&(N.y=z.y),z.y<b.y&&(b.y=z.y),z.z>N.z&&(N.z=z.z),z.z<b.z&&(b.z=z.z)}return h&&(h.vadd(b,b),h.vadd(N,N)),y&&(b.x-=y,b.y-=y,b.z-=y,N.x+=y,N.y+=y,N.z+=y),this}copy(r){return this.lowerBound.copy(r.lowerBound),this.upperBound.copy(r.upperBound),this}clone(){return(new ie).copy(this)}extend(r){this.lowerBound.x=Math.min(this.lowerBound.x,r.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,r.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,r.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,r.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,r.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,r.upperBound.z)}overlaps(r){const h=this.lowerBound,p=this.upperBound,y=r.lowerBound,b=r.upperBound;return(y.x<=p.x&&p.x<=b.x||h.x<=b.x&&b.x<=p.x)&&(y.y<=p.y&&p.y<=b.y||h.y<=b.y&&b.y<=p.y)&&(y.z<=p.z&&p.z<=b.z||h.z<=b.z&&b.z<=p.z)}volume(){const r=this.lowerBound,h=this.upperBound;return(h.x-r.x)*(h.y-r.y)*(h.z-r.z)}contains(r){const h=this.lowerBound,p=this.upperBound,y=r.lowerBound,b=r.upperBound;return h.x<=y.x&&p.x>=b.x&&h.y<=y.y&&p.y>=b.y&&h.z<=y.z&&p.z>=b.z}getCorners(r,h,p,y,b,N,O,T){const z=this.lowerBound,ee=this.upperBound;r.copy(z),h.set(ee.x,z.y,z.z),p.set(ee.x,ee.y,z.z),y.set(z.x,ee.y,ee.z),b.set(ee.x,z.y,ee.z),N.set(z.x,ee.y,z.z),O.set(z.x,z.y,ee.z),T.copy(ee)}toLocalFrame(r,h){const p=fe;this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(let ne=0;8!==ne;ne++){const ve=p[ne];r.pointToLocal(ve,ve)}return h.setFromPoints(p)}toWorldFrame(r,h){const p=fe;this.getCorners(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7]);for(let ne=0;8!==ne;ne++){const ve=p[ne];r.pointToWorld(ve,ve)}return h.setFromPoints(p)}overlapsRay(r){const{direction:h,from:p}=r,y=1/h.x,b=1/h.y,N=1/h.z,O=(this.lowerBound.x-p.x)*y,T=(this.upperBound.x-p.x)*y,z=(this.lowerBound.y-p.y)*b,ee=(this.upperBound.y-p.y)*b,oe=(this.lowerBound.z-p.z)*N,ne=(this.upperBound.z-p.z)*N,ve=Math.max(Math.max(Math.min(O,T),Math.min(z,ee)),Math.min(oe,ne)),xe=Math.min(Math.min(Math.max(O,T),Math.max(z,ee)),Math.max(oe,ne));return!(xe<0||ve>xe)}}const ce=new M,fe=[new M,new M,new M,new M,new M,new M,new M,new M];class ae{constructor(){this.matrix=[]}get(r,h){let{index:p}=r,{index:y}=h;if(y>p){const b=y;y=p,p=b}return this.matrix[(p*(p+1)>>1)+y-1]}set(r,h,p){let{index:y}=r,{index:b}=h;if(b>y){const N=b;b=y,y=N}this.matrix[(y*(y+1)>>1)+b-1]=p?1:0}reset(){for(let r=0,h=this.matrix.length;r!==h;r++)this.matrix[r]=0}setNumObjects(r){this.matrix.length=r*(r-1)>>1}}class W{constructor(){}addEventListener(r,h){void 0===this._listeners&&(this._listeners={});const p=this._listeners;return void 0===p[r]&&(p[r]=[]),p[r].includes(h)||p[r].push(h),this}hasEventListener(r,h){if(void 0===this._listeners)return!1;const p=this._listeners;return!(void 0===p[r]||!p[r].includes(h))}hasAnyEventListener(r){return void 0!==this._listeners&&void 0!==this._listeners[r]}removeEventListener(r,h){if(void 0===this._listeners)return this;const p=this._listeners;if(void 0===p[r])return this;const y=p[r].indexOf(h);return-1!==y&&p[r].splice(y,1),this}dispatchEvent(r){if(void 0===this._listeners)return this;const h=this._listeners[r.type];if(void 0!==h){r.target=this;for(let p=0,y=h.length;p<y;p++)h[p].call(this,r)}return this}}class Z{constructor(r=0,h=0,p=0,y=1){this.x=r,this.y=h,this.z=p,this.w=y}set(r,h,p,y){return this.x=r,this.y=h,this.z=p,this.w=y,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(r,h){const p=Math.sin(.5*h);return this.x=r.x*p,this.y=r.y*p,this.z=r.z*p,this.w=Math.cos(.5*h),this}toAxisAngle(r=new M){this.normalize();const h=2*Math.acos(this.w),p=Math.sqrt(1-this.w*this.w);return p<.001?(r.x=this.x,r.y=this.y,r.z=this.z):(r.x=this.x/p,r.y=this.y/p,r.z=this.z/p),[r,h]}setFromVectors(r,h){if(r.isAntiparallelTo(h)){const p=A;r.tangents(p,R),this.setFromAxisAngle(p,Math.PI)}else{const p=r.cross(h);this.x=p.x,this.y=p.y,this.z=p.z,this.w=Math.sqrt(r.length()**2*h.length()**2)+r.dot(h),this.normalize()}return this}mult(r,h=new Z){const p=this.x,y=this.y,b=this.z,N=this.w,O=r.x,T=r.y,z=r.z,ee=r.w;return h.x=p*ee+N*O+y*z-b*T,h.y=y*ee+N*T+b*O-p*z,h.z=b*ee+N*z+p*T-y*O,h.w=N*ee-p*O-y*T-b*z,h}inverse(r=new Z){const h=this.x,p=this.y,y=this.z,b=this.w;this.conjugate(r);const N=1/(h*h+p*p+y*y+b*b);return r.x*=N,r.y*=N,r.z*=N,r.w*=N,r}conjugate(r=new Z){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r.w=this.w,r}normalize(){let r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(r=1/r,this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}normalizeFast(){const r=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}vmult(r,h=new M){const p=r.x,y=r.y,b=r.z,N=this.x,O=this.y,T=this.z,z=this.w,ee=z*p+O*b-T*y,oe=z*y+T*p-N*b,ne=z*b+N*y-O*p,ve=-N*p-O*y-T*b;return h.x=ee*z+ve*-N+oe*-T-ne*-O,h.y=oe*z+ve*-O+ne*-N-ee*-T,h.z=ne*z+ve*-T+ee*-O-oe*-N,h}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w,this}toEuler(r,h="YZX"){let p,y,b;const N=this.x,O=this.y,T=this.z,z=this.w;if("YZX"!==h)throw new Error("Euler order "+h+" not supported yet.");{const ee=N*O+T*z;if(ee>.499&&(p=2*Math.atan2(N,z),y=Math.PI/2,b=0),ee<-.499&&(p=-2*Math.atan2(N,z),y=-Math.PI/2,b=0),void 0===p){const oe=N*N,ve=T*T;p=Math.atan2(2*O*z-2*N*T,1-O*O*2-2*ve),y=Math.asin(2*ee),b=Math.atan2(2*N*z-2*O*T,1-2*oe-2*ve)}}r.y=p,r.z=y,r.x=b}setFromEuler(r,h,p,y="XYZ"){const b=Math.cos(r/2),N=Math.cos(h/2),O=Math.cos(p/2),T=Math.sin(r/2),z=Math.sin(h/2),ee=Math.sin(p/2);return"XYZ"===y?(this.x=T*N*O+b*z*ee,this.y=b*z*O-T*N*ee,this.z=b*N*ee+T*z*O,this.w=b*N*O-T*z*ee):"YXZ"===y?(this.x=T*N*O+b*z*ee,this.y=b*z*O-T*N*ee,this.z=b*N*ee-T*z*O,this.w=b*N*O+T*z*ee):"ZXY"===y?(this.x=T*N*O-b*z*ee,this.y=b*z*O+T*N*ee,this.z=b*N*ee+T*z*O,this.w=b*N*O-T*z*ee):"ZYX"===y?(this.x=T*N*O-b*z*ee,this.y=b*z*O+T*N*ee,this.z=b*N*ee-T*z*O,this.w=b*N*O+T*z*ee):"YZX"===y?(this.x=T*N*O+b*z*ee,this.y=b*z*O+T*N*ee,this.z=b*N*ee-T*z*O,this.w=b*N*O-T*z*ee):"XZY"===y&&(this.x=T*N*O-b*z*ee,this.y=b*z*O-T*N*ee,this.z=b*N*ee+T*z*O,this.w=b*N*O+T*z*ee),this}clone(){return new Z(this.x,this.y,this.z,this.w)}slerp(r,h,p=new Z){const y=this.x,b=this.y,N=this.z,O=this.w;let T,z,ee,oe,ne,ve=r.x,xe=r.y,Te=r.z,Ce=r.w;return z=y*ve+b*xe+N*Te+O*Ce,z<0&&(z=-z,ve=-ve,xe=-xe,Te=-Te,Ce=-Ce),1-z>1e-6?(T=Math.acos(z),ee=Math.sin(T),oe=Math.sin((1-h)*T)/ee,ne=Math.sin(h*T)/ee):(oe=1-h,ne=h),p.x=oe*y+ne*ve,p.y=oe*b+ne*xe,p.z=oe*N+ne*Te,p.w=oe*O+ne*Ce,p}integrate(r,h,p,y=new Z){const b=r.x*p.x,N=r.y*p.y,O=r.z*p.z,T=this.x,z=this.y,ee=this.z,oe=this.w,ne=.5*h;return y.x+=ne*(b*oe+N*ee-O*z),y.y+=ne*(N*oe+O*T-b*ee),y.z+=ne*(O*oe+b*z-N*T),y.w+=ne*(-b*T-N*z-O*ee),y}}const A=new M,R=new M,X={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class he{constructor(r={}){this.id=he.idCounter++,this.type=r.type||0,this.boundingSphereRadius=0,this.collisionResponse=!r.collisionResponse||r.collisionResponse,this.collisionFilterGroup=void 0!==r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask=void 0!==r.collisionFilterMask?r.collisionFilterMask:-1,this.material=r.material?r.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(r,h){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(r,h,p,y){throw"calculateWorldAABB() not implemented for shape type "+this.type}}he.idCounter=0,he.types=X;class U{constructor(r={}){this.position=new M,this.quaternion=new Z,r.position&&this.position.copy(r.position),r.quaternion&&this.quaternion.copy(r.quaternion)}pointToLocal(r,h){return U.pointToLocalFrame(this.position,this.quaternion,r,h)}pointToWorld(r,h){return U.pointToWorldFrame(this.position,this.quaternion,r,h)}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}static pointToLocalFrame(r,h,p,y=new M){return p.vsub(r,y),h.conjugate(Re),Re.vmult(y,y),y}static pointToWorldFrame(r,h,p,y=new M){return h.vmult(p,y),y.vadd(r,y),y}static vectorToWorldFrame(r,h,p=new M){return r.vmult(h,p),p}static vectorToLocalFrame(r,h,p,y=new M){return h.w*=-1,h.vmult(p,y),h.w*=-1,y}}const Re=new Z;class Q extends he{constructor(r={}){const{vertices:h=[],faces:p=[],normals:y=[],axes:b,boundingSphereRadius:N}=r;super({type:he.types.CONVEXPOLYHEDRON}),this.vertices=h,this.faces=p,this.faceNormals=y,0===this.faceNormals.length&&this.computeNormals(),N?this.boundingSphereRadius=N:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=b?b.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const r=this.faces,h=this.vertices,p=this.uniqueEdges;p.length=0;const y=new M;for(let b=0;b!==r.length;b++){const N=r[b],O=N.length;for(let T=0;T!==O;T++){h[N[T]].vsub(h[N[(T+1)%O]],y),y.normalize();let ee=!1;for(let oe=0;oe!==p.length;oe++)if(p[oe].almostEquals(y)||p[oe].almostEquals(y)){ee=!0;break}ee||p.push(y.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let r=0;r<this.faces.length;r++){for(let y=0;y<this.faces[r].length;y++)if(!this.vertices[this.faces[r][y]])throw new Error("Vertex "+this.faces[r][y]+" not found!");const h=this.faceNormals[r]||new M;if(this.getFaceNormal(r,h),h.negate(h),this.faceNormals[r]=h,h.dot(this.vertices[this.faces[r][0]])<0){console.error(".faceNormals["+r+"] = Vec3("+h.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let y=0;y<this.faces[r].length;y++)console.warn(".vertices["+this.faces[r][y]+"] = Vec3("+this.vertices[this.faces[r][y]].toString()+")")}}}getFaceNormal(r,h){const p=this.faces[r];Q.computeNormal(this.vertices[p[0]],this.vertices[p[1]],this.vertices[p[2]],h)}clipAgainstHull(r,h,p,y,b,N,O,T,z){const ee=new M;let oe=-1,ne=-Number.MAX_VALUE;for(let xe=0;xe<p.faces.length;xe++){ee.copy(p.faceNormals[xe]),b.vmult(ee,ee);const Te=ee.dot(N);Te>ne&&(ne=Te,oe=xe)}const ve=[];for(let xe=0;xe<p.faces[oe].length;xe++){const Te=p.vertices[p.faces[oe][xe]],Ce=new M;Ce.copy(Te),b.vmult(Ce,Ce),y.vadd(Ce,Ce),ve.push(Ce)}oe>=0&&this.clipFaceAgainstHull(N,r,h,ve,O,T,z)}findSeparatingAxis(r,h,p,y,b,N,O,T){const z=new M,ee=new M,oe=new M,ne=new M,ve=new M,xe=new M;let Te=Number.MAX_VALUE;const Ce=this;if(Ce.uniqueAxes)for(let Ie=0;Ie!==Ce.uniqueAxes.length;Ie++){p.vmult(Ce.uniqueAxes[Ie],z);const Oe=Ce.testSepAxis(z,r,h,p,y,b);if(!1===Oe)return!1;Oe<Te&&(Te=Oe,N.copy(z))}else{const Ie=O?O.length:Ce.faces.length;for(let Oe=0;Oe<Ie;Oe++){z.copy(Ce.faceNormals[O?O[Oe]:Oe]),p.vmult(z,z);const je=Ce.testSepAxis(z,r,h,p,y,b);if(!1===je)return!1;je<Te&&(Te=je,N.copy(z))}}if(r.uniqueAxes)for(let Ie=0;Ie!==r.uniqueAxes.length;Ie++){b.vmult(r.uniqueAxes[Ie],ee);const Oe=Ce.testSepAxis(ee,r,h,p,y,b);if(!1===Oe)return!1;Oe<Te&&(Te=Oe,N.copy(ee))}else{const Ie=T?T.length:r.faces.length;for(let Oe=0;Oe<Ie;Oe++){ee.copy(r.faceNormals[T?T[Oe]:Oe]),b.vmult(ee,ee);const je=Ce.testSepAxis(ee,r,h,p,y,b);if(!1===je)return!1;je<Te&&(Te=je,N.copy(ee))}}for(let Ie=0;Ie!==Ce.uniqueEdges.length;Ie++){p.vmult(Ce.uniqueEdges[Ie],ne);for(let Oe=0;Oe!==r.uniqueEdges.length;Oe++)if(b.vmult(r.uniqueEdges[Oe],ve),ne.cross(ve,xe),!xe.almostZero()){xe.normalize();const Fe=Ce.testSepAxis(xe,r,h,p,y,b);if(!1===Fe)return!1;Fe<Te&&(Te=Fe,N.copy(xe))}}return y.vsub(h,oe),oe.dot(N)>0&&N.negate(N),!0}testSepAxis(r,h,p,y,b,N){Q.project(this,r,p,y,be),Q.project(h,r,b,N,Pe);const O=be[0],T=be[1],z=Pe[0],ee=Pe[1];if(O<ee||z<T)return!1;const oe=O-ee,ne=z-T;return oe<ne?oe:ne}calculateLocalInertia(r,h){const p=new M,y=new M;this.computeLocalAABB(y,p);const b=p.x-y.x,N=p.y-y.y,O=p.z-y.z;h.x=1/12*r*(2*N*2*N+2*O*2*O),h.y=1/12*r*(2*b*2*b+2*O*2*O),h.z=1/12*r*(2*N*2*N+2*b*2*b)}getPlaneConstantOfFace(r){return-this.faceNormals[r].dot(this.vertices[this.faces[r][0]])}clipFaceAgainstHull(r,h,p,y,b,N,O){const T=new M,z=new M,ee=new M,oe=new M,ne=new M,ve=new M,xe=new M,Te=new M,Ce=this,Ie=y,Oe=[];let Fe=-1,je=Number.MAX_VALUE;for(let St=0;St<Ce.faces.length;St++){T.copy(Ce.faceNormals[St]),p.vmult(T,T);const At=T.dot(r);At<je&&(je=At,Fe=St)}if(Fe<0)return;const Ue=Ce.faces[Fe];Ue.connectedFaces=[];for(let St=0;St<Ce.faces.length;St++)for(let At=0;At<Ce.faces[St].length;At++)-1!==Ue.indexOf(Ce.faces[St][At])&&St!==Fe&&-1===Ue.connectedFaces.indexOf(St)&&Ue.connectedFaces.push(St);const Ye=Ue.length;for(let St=0;St<Ye;St++){const At=Ce.vertices[Ue[St]];At.vsub(Ce.vertices[Ue[(St+1)%Ye]],z),ee.copy(z),p.vmult(ee,ee),h.vadd(ee,ee),oe.copy(this.faceNormals[Fe]),p.vmult(oe,oe),h.vadd(oe,oe),ee.cross(oe,ne),ne.negate(ne),ve.copy(At),p.vmult(ve,ve),h.vadd(ve,ve);const jt=Ue.connectedFaces[St];xe.copy(this.faceNormals[jt]);const Pt=this.getPlaneConstantOfFace(jt);Te.copy(xe),p.vmult(Te,Te);const Nt=Pt-Te.dot(h);for(this.clipFaceAgainstPlane(Ie,Oe,Te,Nt);Ie.length;)Ie.shift();for(;Oe.length;)Ie.push(Oe.shift())}xe.copy(this.faceNormals[Fe]);const at=this.getPlaneConstantOfFace(Fe);Te.copy(xe),p.vmult(Te,Te);const pt=at-Te.dot(h);for(let St=0;St<Ie.length;St++){let At=Te.dot(Ie[St])+pt;At<=b&&(console.log("clamped: depth="+At+" to minDist="+b),At=b),At<=N&&At<=1e-6&&O.push({point:Ie[St],normal:Te,depth:At})}}clipFaceAgainstPlane(r,h,p,y){let b,N;const O=r.length;if(O<2)return h;let T=r[r.length-1],z=r[0];b=p.dot(T)+y;for(let ee=0;ee<O;ee++){if(z=r[ee],N=p.dot(z)+y,b<0)if(N<0){const oe=new M;oe.copy(z),h.push(oe)}else{const oe=new M;T.lerp(z,b/(b-N),oe),h.push(oe)}else if(N<0){const oe=new M;T.lerp(z,b/(b-N),oe),h.push(oe),h.push(z)}T=z,b=N}return h}computeWorldVertices(r,h){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new M);const p=this.vertices,y=this.worldVertices;for(let b=0;b!==this.vertices.length;b++)h.vmult(p[b],y[b]),r.vadd(y[b],y[b]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(r,h){const p=this.vertices;r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),h.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let y=0;y<this.vertices.length;y++){const b=p[y];b.x<r.x?r.x=b.x:b.x>h.x&&(h.x=b.x),b.y<r.y?r.y=b.y:b.y>h.y&&(h.y=b.y),b.z<r.z?r.z=b.z:b.z>h.z&&(h.z=b.z)}}computeWorldFaceNormals(r){const h=this.faceNormals.length;for(;this.worldFaceNormals.length<h;)this.worldFaceNormals.push(new M);const p=this.faceNormals,y=this.worldFaceNormals;for(let b=0;b!==h;b++)r.vmult(p[b],y[b]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let r=0;const h=this.vertices;for(let p=0;p!==h.length;p++){const y=h[p].lengthSquared();y>r&&(r=y)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,p,y){const b=this.vertices;let N,O,T,z,ee,oe,ne=new M;for(let ve=0;ve<b.length;ve++)ne.copy(b[ve]),h.vmult(ne,ne),r.vadd(ne,ne),(void 0===N||ne.x<N)&&(N=ne.x),(void 0===z||ne.x>z)&&(z=ne.x),(void 0===O||ne.y<O)&&(O=ne.y),(void 0===ee||ne.y>ee)&&(ee=ne.y),(void 0===T||ne.z<T)&&(T=ne.z),(void 0===oe||ne.z>oe)&&(oe=ne.z);p.set(N,O,T),y.set(z,ee,oe)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(r=new M){const h=this.vertices;for(let p=0;p<h.length;p++)r.vadd(h[p],r);return r.scale(1/h.length,r),r}transformAllPoints(r,h){const p=this.vertices.length,y=this.vertices;if(h){for(let b=0;b<p;b++){const N=y[b];h.vmult(N,N)}for(let b=0;b<this.faceNormals.length;b++){const N=this.faceNormals[b];h.vmult(N,N)}}if(r)for(let b=0;b<p;b++){const N=y[b];N.vadd(r,N)}}pointIsInside(r){const h=this.vertices,p=this.faces,y=this.faceNormals,b=new M;this.getAveragePointLocal(b);for(let N=0;N<this.faces.length;N++){let O=y[N];const T=h[p[N][0]],z=new M;r.vsub(T,z);const ee=O.dot(z),oe=new M;b.vsub(T,oe);const ne=O.dot(oe);if(ee<0&&ne>0||ee>0&&ne<0)return!1}return-1}}Q.computeNormal=(a,r,h,p)=>{const y=new M,b=new M;r.vsub(a,b),h.vsub(r,y),y.cross(b,p),p.isZero()||p.normalize()};const be=[],Pe=[];Q.project=(a,r,h,p,y)=>{const b=a.vertices.length,N=new M;let O=0,T=0;const z=new M,ee=a.vertices;z.setZero(),U.vectorToLocalFrame(h,p,r,N),U.pointToLocalFrame(h,p,z,z);const oe=z.dot(N);T=O=ee[0].dot(N);for(let ne=1;ne<b;ne++){const ve=ee[ne].dot(N);ve>O&&(O=ve),ve<T&&(T=ve)}if(T-=oe,O-=oe,T>O){const ne=T;T=O,O=ne}y[0]=O,y[1]=T};class Ge extends he{constructor(r){super({type:he.types.BOX}),this.halfExtents=r,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const r=this.halfExtents.x,h=this.halfExtents.y,p=this.halfExtents.z,y=M,b=[new y(-r,-h,-p),new y(r,-h,-p),new y(r,h,-p),new y(-r,h,-p),new y(-r,-h,p),new y(r,-h,p),new y(r,h,p),new y(-r,h,p)],N=[new y(0,0,1),new y(0,1,0),new y(1,0,0)],O=new Q({vertices:b,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:N});this.convexPolyhedronRepresentation=O,O.material=this.material}calculateLocalInertia(r,h=new M){return Ge.calculateInertia(this.halfExtents,r,h),h}getSideNormals(r,h){const p=r,y=this.halfExtents;if(p[0].set(y.x,0,0),p[1].set(0,y.y,0),p[2].set(0,0,y.z),p[3].set(-y.x,0,0),p[4].set(0,-y.y,0),p[5].set(0,0,-y.z),void 0!==h)for(let b=0;b!==p.length;b++)h.vmult(p[b],p[b]);return p}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(r,h,p){const y=this.halfExtents,b=[[y.x,y.y,y.z],[-y.x,y.y,y.z],[-y.x,-y.y,y.z],[-y.x,-y.y,-y.z],[y.x,-y.y,-y.z],[y.x,y.y,-y.z],[-y.x,y.y,-y.z],[y.x,-y.y,y.z]];for(let N=0;N<b.length;N++)Ae.set(b[N][0],b[N][1],b[N][2]),h.vmult(Ae,Ae),r.vadd(Ae,Ae),p(Ae.x,Ae.y,Ae.z)}calculateWorldAABB(r,h,p,y){const b=this.halfExtents;Xe[0].set(b.x,b.y,b.z),Xe[1].set(-b.x,b.y,b.z),Xe[2].set(-b.x,-b.y,b.z),Xe[3].set(-b.x,-b.y,-b.z),Xe[4].set(b.x,-b.y,-b.z),Xe[5].set(b.x,b.y,-b.z),Xe[6].set(-b.x,b.y,-b.z),Xe[7].set(b.x,-b.y,b.z);const N=Xe[0];h.vmult(N,N),r.vadd(N,N),y.copy(N),p.copy(N);for(let O=1;O<8;O++){const T=Xe[O];h.vmult(T,T),r.vadd(T,T);const z=T.x,ee=T.y,oe=T.z;z>y.x&&(y.x=z),ee>y.y&&(y.y=ee),oe>y.z&&(y.z=oe),z<p.x&&(p.x=z),ee<p.y&&(p.y=ee),oe<p.z&&(p.z=oe)}}}Ge.calculateInertia=(a,r,h)=>{const p=a;h.x=1/12*r*(2*p.y*2*p.y+2*p.z*2*p.z),h.y=1/12*r*(2*p.x*2*p.x+2*p.z*2*p.z),h.z=1/12*r*(2*p.y*2*p.y+2*p.x*2*p.x)};const Ae=new M,Xe=[new M,new M,new M,new M,new M,new M,new M,new M],Ke={DYNAMIC:1,STATIC:2,KINEMATIC:4},yt={AWAKE:0,SLEEPY:1,SLEEPING:2};class dt extends W{constructor(r={}){super(),this.id=dt.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new M,this.collisionFilterGroup="number"==typeof r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof r.collisionFilterMask?r.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof r.collisionResponse||r.collisionResponse,this.position=new M,this.previousPosition=new M,this.interpolatedPosition=new M,this.initPosition=new M,r.position&&(this.position.copy(r.position),this.previousPosition.copy(r.position),this.interpolatedPosition.copy(r.position),this.initPosition.copy(r.position)),this.velocity=new M,r.velocity&&this.velocity.copy(r.velocity),this.initVelocity=new M,this.force=new M;const h="number"==typeof r.mass?r.mass:0;this.mass=h,this.invMass=h>0?1/h:0,this.material=r.material||null,this.linearDamping="number"==typeof r.linearDamping?r.linearDamping:.01,this.type=h<=0?dt.STATIC:dt.DYNAMIC,typeof r.type==typeof dt.STATIC&&(this.type=r.type),this.allowSleep=void 0===r.allowSleep||r.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==r.sleepSpeedLimit?r.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==r.sleepTimeLimit?r.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new M,this.quaternion=new Z,this.initQuaternion=new Z,this.previousQuaternion=new Z,this.interpolatedQuaternion=new Z,r.quaternion&&(this.quaternion.copy(r.quaternion),this.initQuaternion.copy(r.quaternion),this.previousQuaternion.copy(r.quaternion),this.interpolatedQuaternion.copy(r.quaternion)),this.angularVelocity=new M,r.angularVelocity&&this.angularVelocity.copy(r.angularVelocity),this.initAngularVelocity=new M,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new M,this.invInertia=new M,this.invInertiaWorld=new G,this.invMassSolve=0,this.invInertiaSolve=new M,this.invInertiaWorldSolve=new G,this.fixedRotation=void 0!==r.fixedRotation&&r.fixedRotation,this.angularDamping=void 0!==r.angularDamping?r.angularDamping:.01,this.linearFactor=new M(1,1,1),r.linearFactor&&this.linearFactor.copy(r.linearFactor),this.angularFactor=new M(1,1,1),r.angularFactor&&this.angularFactor.copy(r.angularFactor),this.aabb=new ie,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new M,r.shape&&this.addShape(r.shape),this.updateMassProperties()}wakeUp(){const r=this.sleepState;this.sleepState=0,this.wakeUpAfterNarrowphase=!1,r===dt.SLEEPING&&this.dispatchEvent(dt.wakeupEvent)}sleep(){this.sleepState=dt.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(r){if(this.allowSleep){const h=this.sleepState,p=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),y=this.sleepSpeedLimit**2;h===dt.AWAKE&&p<y?(this.sleepState=dt.SLEEPY,this.timeLastSleepy=r,this.dispatchEvent(dt.sleepyEvent)):h===dt.SLEEPY&&p>y?this.wakeUp():h===dt.SLEEPY&&r-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(dt.sleepEvent))}}updateSolveMassProperties(){this.sleepState===dt.SLEEPING||this.type===dt.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(r,h=new M){return r.vsub(this.position,h),this.quaternion.conjugate().vmult(h,h),h}vectorToLocalFrame(r,h=new M){return this.quaternion.conjugate().vmult(r,h),h}pointToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h.vadd(this.position,h),h}vectorToWorldFrame(r,h=new M){return this.quaternion.vmult(r,h),h}addShape(r,h,p){const y=new M,b=new Z;return h&&y.copy(h),p&&b.copy(p),this.shapes.push(r),this.shapeOffsets.push(y),this.shapeOrientations.push(b),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,r.body=this,this}updateBoundingRadius(){const r=this.shapes,h=this.shapeOffsets,p=r.length;let y=0;for(let b=0;b!==p;b++){const N=r[b];N.updateBoundingSphereRadius();const O=h[b].length(),T=N.boundingSphereRadius;O+T>y&&(y=O+T)}this.boundingRadius=y}computeAABB(){const r=this.shapes,h=this.shapeOffsets,p=this.shapeOrientations,y=r.length,b=It,N=wt,O=this.quaternion,T=this.aabb,z=Gt;for(let ee=0;ee!==y;ee++){const oe=r[ee];O.vmult(h[ee],b),b.vadd(this.position,b),O.mult(p[ee],N),oe.calculateWorldAABB(b,N,z.lowerBound,z.upperBound),0===ee?T.copy(z):T.extend(z)}this.aabbNeedsUpdate=!1}updateInertiaWorld(r){const h=this.invInertia;if(h.x!==h.y||h.y!==h.z||r){const p=Dt,y=sn;p.setRotationFromQuaternion(this.quaternion),p.transpose(y),p.scale(h,p),p.mmult(y,this.invInertiaWorld)}}applyForce(r,h){if(this.type!==dt.DYNAMIC)return;const p=gt;h.cross(r,p),this.force.vadd(r,this.force),this.torque.vadd(p,this.torque)}applyLocalForce(r,h){if(this.type!==dt.DYNAMIC)return;const p=An,y=Bn;this.vectorToWorldFrame(r,p),this.vectorToWorldFrame(h,y),this.applyForce(p,y)}applyImpulse(r,h){if(this.type!==dt.DYNAMIC)return;const p=h,y=dn;y.copy(r),y.scale(this.invMass,y),this.velocity.vadd(y,this.velocity);const b=On;p.cross(r,b),this.invInertiaWorld.vmult(b,b),this.angularVelocity.vadd(b,this.angularVelocity)}applyLocalImpulse(r,h){if(this.type!==dt.DYNAMIC)return;const p=Ln,y=mn;this.vectorToWorldFrame(r,p),this.vectorToWorldFrame(h,y),this.applyImpulse(p,y)}updateMassProperties(){const r=cr;this.invMass=this.mass>0?1/this.mass:0;const h=this.inertia,p=this.fixedRotation;this.computeAABB(),r.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Ge.calculateInertia(r,this.mass,h),this.invInertia.set(h.x>0&&!p?1/h.x:0,h.y>0&&!p?1/h.y:0,h.z>0&&!p?1/h.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(r,h){const p=new M;return r.vsub(this.position,p),this.angularVelocity.cross(p,h),this.velocity.vadd(h,h),h}integrate(r,h,p){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==dt.DYNAMIC&&this.type!==dt.KINEMATIC||this.sleepState===dt.SLEEPING)return;const y=this.velocity,b=this.angularVelocity,N=this.position,O=this.force,T=this.torque,z=this.quaternion,oe=this.invInertiaWorld,ne=this.linearFactor,ve=this.invMass*r;y.x+=O.x*ve*ne.x,y.y+=O.y*ve*ne.y,y.z+=O.z*ve*ne.z;const xe=oe.elements,Te=this.angularFactor,Ce=T.x*Te.x,Ie=T.y*Te.y,Oe=T.z*Te.z;b.x+=r*(xe[0]*Ce+xe[1]*Ie+xe[2]*Oe),b.y+=r*(xe[3]*Ce+xe[4]*Ie+xe[5]*Oe),b.z+=r*(xe[6]*Ce+xe[7]*Ie+xe[8]*Oe),N.x+=y.x*r,N.y+=y.y*r,N.z+=y.z*r,z.integrate(this.angularVelocity,r,this.angularFactor,z),h&&(p?z.normalizeFast():z.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}dt.COLLIDE_EVENT_NAME="collide",dt.DYNAMIC=1,dt.STATIC=2,dt.KINEMATIC=4,dt.AWAKE=yt.AWAKE,dt.SLEEPY=yt.SLEEPY,dt.SLEEPING=yt.SLEEPING,dt.idCounter=0,dt.wakeupEvent={type:"wakeup"},dt.sleepyEvent={type:"sleepy"},dt.sleepEvent={type:"sleep"};const It=new M,wt=new Z,Gt=new ie,Dt=new G,sn=new G,gt=new M,An=new M,Bn=new M,dn=new M,On=new M,Ln=new M,mn=new M,cr=new M;class rr{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(r,h,p){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(r,h){return 0!=(r.collisionFilterGroup&h.collisionFilterMask)&&0!=(h.collisionFilterGroup&r.collisionFilterMask)&&(0==(r.type&dt.STATIC)&&r.sleepState!==dt.SLEEPING||0==(h.type&dt.STATIC)&&h.sleepState!==dt.SLEEPING)}intersectionTest(r,h,p,y){this.useBoundingBoxes?this.doBoundingBoxBroadphase(r,h,p,y):this.doBoundingSphereBroadphase(r,h,p,y)}doBoundingSphereBroadphase(r,h,p,y){const b=ur;h.position.vsub(r.position,b);const N=(r.boundingRadius+h.boundingRadius)**2;b.lengthSquared()<N&&(p.push(r),y.push(h))}doBoundingBoxBroadphase(r,h,p,y){r.aabbNeedsUpdate&&r.computeAABB(),h.aabbNeedsUpdate&&h.computeAABB(),r.aabb.overlaps(h.aabb)&&(p.push(r),y.push(h))}makePairsUnique(r,h){const p=or,y=ni,b=Kr,N=r.length;for(let O=0;O!==N;O++)y[O]=r[O],b[O]=h[O];r.length=0,h.length=0;for(let O=0;O!==N;O++){const T=y[O].id,z=b[O].id,ee=T<z?T+","+z:z+","+T;p[ee]=O,p.keys.push(ee)}for(let O=0;O!==p.keys.length;O++){const T=p.keys.pop(),z=p[T];r.push(y[z]),h.push(b[z]),delete p[T]}}setWorld(r){}aabbQuery(r,h,p){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const ur=new M,or={keys:[]},ni=[],Kr=[];rr.boundingSphereCheck=(a,r)=>{const h=new M;return a.position.vsub(r.position,h),Math.pow(a.shapes[0].boundingSphereRadius+r.shapes[0].boundingSphereRadius,2)>h.lengthSquared()};class pi extends rr{constructor(r=new M(100,100,100),h=new M(-100,-100,-100),p=10,y=10,b=10){super(),this.nx=p,this.ny=y,this.nz=b,this.aabbMin=r,this.aabbMax=h;const N=this.nx*this.ny*this.nz;if(N<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=N,this.binLengths.length=N;for(let O=0;O<N;O++)this.bins[O]=[],this.binLengths[O]=0}collisionPairs(r,h,p){const y=r.numObjects(),b=r.bodies,N=this.aabbMax,O=this.aabbMin,T=this.nx,z=this.ny,ee=this.nz,oe=z*ee,ne=ee,ve=N.x,xe=N.y,Te=N.z,Ce=O.x,Ie=O.y,Oe=O.z,Fe=T/(ve-Ce),je=z/(xe-Ie),Ue=ee/(Te-Oe),Ye=(ve-Ce)/T,at=(xe-Ie)/z,pt=(Te-Oe)/ee,St=.5*Math.sqrt(Ye*Ye+at*at+pt*pt),At=he.types,Jt=At.SPHERE,jt=At.PLANE,Pt=this.bins,Nt=this.binLengths,ft=this.bins.length;for(let _n=0;_n!==ft;_n++)Nt[_n]=0;const $t=Math.ceil;function Zt(_n,xn,wr,ir,Hn,lr,Yn){let fr=(_n-Ce)*Fe|0,zr=(xn-Ie)*je|0,xo=(wr-Oe)*Ue|0,po=$t((ir-Ce)*Fe),wo=$t((Hn-Ie)*je),Uo=$t((lr-Oe)*Ue);fr<0?fr=0:fr>=T&&(fr=T-1),zr<0?zr=0:zr>=z&&(zr=z-1),xo<0?xo=0:xo>=ee&&(xo=ee-1),po<0?po=0:po>=T&&(po=T-1),wo<0?wo=0:wo>=z&&(wo=z-1),Uo<0?Uo=0:Uo>=ee&&(Uo=ee-1),fr*=oe,zr*=ne,xo*=1,po*=oe,wo*=ne,Uo*=1;for(let Hs=fr;Hs<=po;Hs+=oe)for(let Vs=zr;Vs<=wo;Vs+=ne)for(let za=xo;za<=Uo;za+=1){const ja=Hs+Vs+za;Pt[ja][Nt[ja]++]=Yn}}for(let _n=0;_n!==y;_n++){const xn=b[_n],wr=xn.shapes[0];switch(wr.type){case Jt:{const Hn=xn.position.x,lr=xn.position.y,Yn=xn.position.z,fr=wr.radius;Zt(Hn-fr,lr-fr,Yn-fr,Hn+fr,lr+fr,Yn+fr,xn);break}case jt:{const ir=wr;ir.worldNormalNeedsUpdate&&ir.computeWorldNormal(xn.quaternion);const Hn=ir.worldNormal,Yn=Ie+.5*at-xn.position.y,fr=Oe+.5*pt-xn.position.z,zr=nr;zr.set(Ce+.5*Ye-xn.position.x,Yn,fr);for(let xo=0,po=0;xo!==T;xo++,po+=oe,zr.y=Yn,zr.x+=Ye)for(let wo=0,Uo=0;wo!==z;wo++,Uo+=ne,zr.z=fr,zr.y+=at)for(let Hs=0,Vs=0;Hs!==ee;Hs++,Vs+=1,zr.z+=pt)if(zr.dot(Hn)<St){const za=po+Uo+Vs;Pt[za][Nt[za]++]=xn}break}default:xn.aabbNeedsUpdate&&xn.computeAABB(),Zt(xn.aabb.lowerBound.x,xn.aabb.lowerBound.y,xn.aabb.lowerBound.z,xn.aabb.upperBound.x,xn.aabb.upperBound.y,xn.aabb.upperBound.z,xn)}}for(let _n=0;_n!==ft;_n++){const xn=Nt[_n];if(xn>1){const wr=Pt[_n];for(let ir=0;ir!==xn;ir++){const Hn=wr[ir];for(let lr=0;lr!==ir;lr++){const Yn=wr[lr];this.needBroadphaseCollision(Hn,Yn)&&this.intersectionTest(Hn,Yn,h,p)}}}}this.makePairsUnique(h,p)}}const nr=new M;class vr extends rr{constructor(){super()}collisionPairs(r,h,p){const y=r.bodies,b=y.length;let N,O;for(let T=0;T!==b;T++)for(let z=0;z!==T;z++)N=y[T],O=y[z],this.needBroadphaseCollision(N,O)&&this.intersectionTest(N,O,h,p)}aabbQuery(r,h,p=[]){for(let y=0;y<r.bodies.length;y++){const b=r.bodies[y];b.aabbNeedsUpdate&&b.computeAABB(),b.aabb.overlaps(h)&&p.push(b)}return p}}class mi{constructor(){this.rayFromWorld=new M,this.rayToWorld=new M,this.hitNormalWorld=new M,this.hitPointWorld=new M,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(r,h,p,y,b,N,O){this.rayFromWorld.copy(r),this.rayToWorld.copy(h),this.hitNormalWorld.copy(p),this.hitPointWorld.copy(y),this.shape=b,this.body=N,this.distance=O}}const _o={CLOSEST:1,ANY:2,ALL:4};class Nr{constructor(r=new M,h=new M){this.from=r.clone(),this.to=h.clone(),this.direction=new M,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Nr.ANY,this.result=new mi,this.hasHit=!1,this.callback=p=>{}}intersectWorld(r,h){return this.mode=h.mode||Nr.ANY,this.result=h.result||new mi,this.skipBackfaces=!!h.skipBackfaces,this.collisionFilterMask=void 0!==h.collisionFilterMask?h.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==h.collisionFilterGroup?h.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===h.checkCollisionResponse||h.checkCollisionResponse,h.from&&this.from.copy(h.from),h.to&&this.to.copy(h.to),this.callback=h.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(ei),Wr.length=0,r.broadphase.aabbQuery(r,ei,Wr),this.intersectBodies(Wr),this.hasHit}intersectBody(r,h){h&&(this.result=h,this.updateDirection());const p=this.checkCollisionResponse;if(p&&!r.collisionResponse||!(this.collisionFilterGroup&r.collisionFilterMask)||!(r.collisionFilterGroup&this.collisionFilterMask))return;const y=Ws,b=la;for(let N=0,O=r.shapes.length;N<O;N++){const T=r.shapes[N];if((!p||T.collisionResponse)&&(r.quaternion.mult(r.shapeOrientations[N],b),r.quaternion.vmult(r.shapeOffsets[N],y),y.vadd(r.position,y),this.intersectShape(T,b,y,r),this.result.shouldStop))break}}intersectBodies(r,h){h&&(this.result=h,this.updateDirection());for(let p=0,y=r.length;!this.result.shouldStop&&p<y;p++)this.intersectBody(r[p])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(r,h,p,y){if(function(O,T,z){z.vsub(O,Xs);const ee=Xs.dot(T);return T.scale(ee,Xo),Xo.vadd(O,Xo),z.distanceTo(Xo)}(this.from,this.direction,p)>r.boundingSphereRadius)return;const N=this[r.type];N&&N.call(this,r,h,p,y,r)}_intersectBox(r,h,p,y,b){return this._intersectConvex(r.convexPolyhedronRepresentation,h,p,y,b)}_intersectPlane(r,h,p,y,b){const N=this.from,O=this.to,T=this.direction,z=new M(0,0,1);h.vmult(z,z);const ee=new M;N.vsub(p,ee);const oe=ee.dot(z);if(O.vsub(p,ee),oe*ee.dot(z)>0||N.distanceTo(O)<oe)return;const ne=z.dot(T);if(Math.abs(ne)<this.precision)return;const ve=new M,xe=new M,Te=new M;N.vsub(p,ve);const Ce=-z.dot(ve)/ne;T.scale(Ce,xe),N.vadd(xe,Te),this.reportIntersection(z,Te,b,y,-1)}getAABB(r){const{lowerBound:h,upperBound:p}=r,y=this.to,b=this.from;h.x=Math.min(y.x,b.x),h.y=Math.min(y.y,b.y),h.z=Math.min(y.z,b.z),p.x=Math.max(y.x,b.x),p.y=Math.max(y.y,b.y),p.z=Math.max(y.z,b.z)}_intersectHeightfield(r,h,p,y,b){const N=Va;N.from.copy(this.from),N.to.copy(this.to),U.pointToLocalFrame(p,h,N.from,N.from),U.pointToLocalFrame(p,h,N.to,N.to),N.updateDirection();const O=Hu;let T,z,ee,oe;T=z=0,ee=oe=r.data.length-1;const ne=new ie;N.getAABB(ne),r.getIndexOfPosition(ne.lowerBound.x,ne.lowerBound.y,O,!0),T=Math.max(T,O[0]),z=Math.max(z,O[1]),r.getIndexOfPosition(ne.upperBound.x,ne.upperBound.y,O,!0),ee=Math.min(ee,O[0]+1),oe=Math.min(oe,O[1]+1);for(let ve=T;ve<ee;ve++)for(let xe=z;xe<oe;xe++){if(this.result.shouldStop)return;if(r.getAabbAtIndex(ve,xe,ne),ne.overlapsRay(N)){if(r.getConvexTrianglePillar(ve,xe,!1),U.pointToWorldFrame(p,h,r.pillarOffset,Ir),this._intersectConvex(r.pillarConvex,h,Ir,y,b,os),this.result.shouldStop)return;r.getConvexTrianglePillar(ve,xe,!0),U.pointToWorldFrame(p,h,r.pillarOffset,Ir),this._intersectConvex(r.pillarConvex,h,Ir,y,b,os)}}}_intersectSphere(r,h,p,y,b){const N=this.from,O=this.to,z=(O.x-N.x)**2+(O.y-N.y)**2+(O.z-N.z)**2,ee=2*((O.x-N.x)*(N.x-p.x)+(O.y-N.y)*(N.y-p.y)+(O.z-N.z)*(N.z-p.z)),oe=ee**2-4*z*((N.x-p.x)**2+(N.y-p.y)**2+(N.z-p.z)**2-r.radius**2),ne=us,ve=qs;if(!(oe<0))if(0===oe)N.lerp(O,oe,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1);else{const xe=(-ee-Math.sqrt(oe))/(2*z),Te=(-ee+Math.sqrt(oe))/(2*z);if(xe>=0&&xe<=1&&(N.lerp(O,xe,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1)),this.result.shouldStop)return;Te>=0&&Te<=1&&(N.lerp(O,Te,ne),ne.vsub(p,ve),ve.normalize(),this.reportIntersection(ve,ne,b,y,-1))}}_intersectConvex(r,h,p,y,b,N){const O=ai,T=Gc,z=N&&N.faceList||null,ee=r.faces,oe=r.vertices,ne=r.faceNormals,ve=this.direction,xe=this.from,Ce=xe.distanceTo(this.to),Ie=z?z.length:ee.length,Oe=this.result;for(let Fe=0;!Oe.shouldStop&&Fe<Ie;Fe++){const je=z?z[Fe]:Fe,Ue=ee[je],Ye=ne[je],at=h,pt=p;T.copy(oe[Ue[0]]),at.vmult(T,T),T.vadd(pt,T),T.vsub(xe,T),at.vmult(Ye,O);const St=ve.dot(O);if(Math.abs(St)<this.precision)continue;const At=O.dot(T)/St;if(!(At<0)){ve.scale(At,Ni),Ni.vadd(xe,Ni),Eo.copy(oe[Ue[0]]),at.vmult(Eo,Eo),pt.vadd(Eo,Eo);for(let Jt=1;!Oe.shouldStop&&Jt<Ue.length-1;Jt++){go.copy(oe[Ue[Jt]]),Jr.copy(oe[Ue[Jt+1]]),at.vmult(go,go),at.vmult(Jr,Jr),pt.vadd(go,go),pt.vadd(Jr,Jr);const jt=Ni.distanceTo(xe);!So(Ni,Eo,go,Jr)&&!So(Ni,go,Eo,Jr)||jt>Ce||this.reportIntersection(O,Ni,b,y,je)}}}}_intersectTrimesh(r,h,p,y,b,N){const O=kh,T=Hc,z=Hp,ee=Gc,oe=sl,ne=Gp,ve=ca,xe=Wa,Te=Wl,Ce=r.indices,Ie=this.from,Oe=this.to,Fe=this.direction;z.position.copy(p),z.quaternion.copy(h),U.vectorToLocalFrame(p,h,Fe,oe),U.pointToLocalFrame(p,h,Ie,ne),U.pointToLocalFrame(p,h,Oe,ve),ve.x*=r.scale.x,ve.y*=r.scale.y,ve.z*=r.scale.z,ne.x*=r.scale.x,ne.y*=r.scale.y,ne.z*=r.scale.z,ve.vsub(ne,oe),oe.normalize();const je=ne.distanceSquared(ve);r.tree.rayQuery(this,z,T);for(let Ue=0,Ye=T.length;!this.result.shouldStop&&Ue!==Ye;Ue++){const at=T[Ue];r.getNormal(at,O),r.getVertex(Ce[3*at],Eo),Eo.vsub(ne,ee);const pt=oe.dot(O),St=O.dot(ee)/pt;if(St<0)continue;oe.scale(St,Ni),Ni.vadd(ne,Ni),r.getVertex(Ce[3*at+1],go),r.getVertex(Ce[3*at+2],Jr);const At=Ni.distanceSquared(ne);!So(Ni,go,Eo,Jr)&&!So(Ni,Eo,go,Jr)||At>je||(U.vectorToWorldFrame(h,O,Te),U.pointToWorldFrame(p,h,Ni,xe),this.reportIntersection(Te,xe,b,y,at))}T.length=0}reportIntersection(r,h,p,y,b){const N=this.from,O=this.to,T=N.distanceTo(h),z=this.result;if(!(this.skipBackfaces&&r.dot(this.direction)>0))switch(z.hitFaceIndex=void 0!==b?b:-1,this.mode){case Nr.ALL:this.hasHit=!0,z.set(N,O,r,h,p,y,T),z.hasHit=!0,this.callback(z);break;case Nr.CLOSEST:(T<z.distance||!z.hasHit)&&(this.hasHit=!0,z.hasHit=!0,z.set(N,O,r,h,p,y,T));break;case Nr.ANY:this.hasHit=!0,z.hasHit=!0,z.set(N,O,r,h,p,y,T),z.shouldStop=!0}}}Nr.CLOSEST=1,Nr.ANY=2,Nr.ALL=4;const ei=new ie,Wr=[],yi=new M,Ei=new M;function So(a,r,h,p){p.vsub(r,Xs),h.vsub(r,yi),a.vsub(r,Ei);const y=Xs.dot(Xs),b=Xs.dot(yi),N=Xs.dot(Ei),O=yi.dot(yi),T=yi.dot(Ei);let z,ee;return(z=O*N-b*T)>=0&&(ee=y*T-b*N)>=0&&z+ee<y*O-b*b}Nr.pointInTriangle=So;const Ws=new M,la=new Z,Ni=new M,Eo=new M,go=new M,Jr=new M;Nr.prototype[he.types.BOX]=Nr.prototype._intersectBox,Nr.prototype[he.types.PLANE]=Nr.prototype._intersectPlane;const os={faceList:[0]},Ir=new M,Va=new Nr,Hu=[];Nr.prototype[he.types.HEIGHTFIELD]=Nr.prototype._intersectHeightfield;const us=new M,qs=new M;Nr.prototype[he.types.SPHERE]=Nr.prototype._intersectSphere;const ai=new M,Gc=new M;Nr.prototype[he.types.CONVEXPOLYHEDRON]=Nr.prototype._intersectConvex;const kh=new M,sl=new M,Gp=new M,ca=new M,Wl=new M,Wa=new M,Hc=(new ie,[]),Hp=new U;Nr.prototype[he.types.TRIMESH]=Nr.prototype._intersectTrimesh;const Xs=new M,Xo=new M;class hs extends rr{constructor(r){super(),this.axisList=[],this.world=null,this.axisIndex=0;const h=this.axisList;this._addBodyHandler=p=>{h.push(p.body)},this._removeBodyHandler=p=>{const y=h.indexOf(p.body);-1!==y&&h.splice(y,1)},r&&this.setWorld(r)}setWorld(r){this.axisList.length=0;for(let h=0;h<r.bodies.length;h++)this.axisList.push(r.bodies[h]);r.removeEventListener("addBody",this._addBodyHandler),r.removeEventListener("removeBody",this._removeBodyHandler),r.addEventListener("addBody",this._addBodyHandler),r.addEventListener("removeBody",this._removeBodyHandler),this.world=r,this.dirty=!0}collisionPairs(r,h,p){const y=this.axisList,b=y.length,N=this.axisIndex;let O,T;for(this.dirty&&(this.sortList(),this.dirty=!1),O=0;O!==b;O++){const z=y[O];for(T=O+1;T<b;T++){const ee=y[T];if(this.needBroadphaseCollision(z,ee)){if(!hs.checkBounds(z,ee,N))break;this.intersectionTest(z,ee,h,p)}}}}sortList(){const r=this.axisList,h=this.axisIndex,p=r.length;for(let y=0;y!==p;y++){const b=r[y];b.aabbNeedsUpdate&&b.computeAABB()}0===h?hs.insertionSortX(r):1===h?hs.insertionSortY(r):2===h&&hs.insertionSortZ(r)}autoDetectAxis(){let r=0,h=0,p=0,y=0,b=0,N=0;const O=this.axisList,T=O.length,z=1/T;for(let ve=0;ve!==T;ve++){const xe=O[ve],Te=xe.position.x;r+=Te,h+=Te*Te;const Ce=xe.position.y;p+=Ce,y+=Ce*Ce;const Ie=xe.position.z;b+=Ie,N+=Ie*Ie}const ee=h-r*r*z,oe=y-p*p*z,ne=N-b*b*z;this.axisIndex=ee>oe?ee>ne?0:2:oe>ne?1:2}aabbQuery(r,h,p=[]){this.dirty&&(this.sortList(),this.dirty=!1);const y=this.axisIndex;let b="x";1===y&&(b="y"),2===y&&(b="z");const N=this.axisList;for(let O=0;O<N.length;O++){const T=N[O];T.aabbNeedsUpdate&&T.computeAABB(),T.aabb.overlaps(h)&&p.push(T)}return p}}function Vu(){}hs.insertionSortX=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.x<=p.aabb.lowerBound.x);y--)a[y+1]=a[y];a[y+1]=p}return a},hs.insertionSortY=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.y<=p.aabb.lowerBound.y);y--)a[y+1]=a[y];a[y+1]=p}return a},hs.insertionSortZ=a=>{for(let r=1,h=a.length;r<h;r++){const p=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.z<=p.aabb.lowerBound.z);y--)a[y+1]=a[y];a[y+1]=p}return a},hs.checkBounds=(a,r,h)=>{let p,y;return 0===h?(p=a.position.x,y=r.position.x):1===h?(p=a.position.y,y=r.position.y):2===h&&(p=a.position.z,y=r.position.z),y-r.boundingRadius<p+a.boundingRadius},Vu.defaults=(a={},r)=>{for(let h in r)h in a||(a[h]=r[h]);return a};class du{constructor(r,h,p={}){p=Vu.defaults(p,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=r,this.bodyB=h,this.id=du.idCounter++,this.collideConnected=p.collideConnected,p.wakeUpBodies&&(r&&r.wakeUp(),h&&h.wakeUp())}update(){throw new Error("method update() not implmemented in this Constraint subclass!")}enable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!0}disable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!1}}du.idCounter=0;class fu{constructor(){this.spatial=new M,this.rotational=new M}multiplyElement(r){return r.spatial.dot(this.spatial)+r.rotational.dot(this.rotational)}multiplyVectors(r,h){return r.dot(this.spatial)+h.dot(this.rotational)}}class Ts{constructor(r,h,p=-1e6,y=1e6){this.id=Ts.id++,this.minForce=p,this.maxForce=y,this.bi=r,this.bj=h,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new fu,this.jacobianElementB=new fu,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(r,h,p){const y=h,b=r,N=p;this.a=4/(N*(1+4*y)),this.b=4*y/(1+4*y),this.eps=4/(N*N*b*(1+4*y))}computeB(r,h,p){const y=this.computeGW();return-this.computeGq()*r-y*h-this.computeGiMf()*p}computeGq(){const h=this.jacobianElementB,N=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+h.spatial.dot(N)}computeGW(){const h=this.jacobianElementB,p=this.bi,y=this.bj,N=y.velocity,T=y.angularVelocity;return this.jacobianElementA.multiplyVectors(p.velocity,p.angularVelocity)+h.multiplyVectors(N,T)}computeGWlambda(){const h=this.jacobianElementB,p=this.bi,y=this.bj,N=y.vlambda,T=y.wlambda;return this.jacobianElementA.multiplyVectors(p.vlambda,p.wlambda)+h.multiplyVectors(N,T)}computeGiMf(){const r=this.jacobianElementA,h=this.jacobianElementB,p=this.bi,y=this.bj,N=p.torque,O=y.force,T=y.torque,ee=y.invMassSolve;return p.force.scale(p.invMassSolve,dp),O.scale(ee,Os),p.invInertiaWorldSolve.vmult(N,ao),y.invInertiaWorldSolve.vmult(T,Vc),r.multiplyVectors(dp,ao)+h.multiplyVectors(Os,Vc)}computeGiMGt(){const r=this.jacobianElementA,h=this.jacobianElementB,p=this.bi,y=this.bj,T=y.invInertiaWorldSolve;let z=p.invMassSolve+y.invMassSolve;return p.invInertiaWorldSolve.vmult(r.rotational,Wu),z+=Wu.dot(r.rotational),T.vmult(h.rotational,Wu),z+=Wu.dot(h.rotational),z}addToWlambda(r){const h=this.jacobianElementA,p=this.jacobianElementB,y=this.bi,b=this.bj,N=vh;y.vlambda.addScaledVector(y.invMassSolve*r,h.spatial,y.vlambda),b.vlambda.addScaledVector(b.invMassSolve*r,p.spatial,b.vlambda),y.invInertiaWorldSolve.vmult(h.rotational,N),y.wlambda.addScaledVector(r,N,y.wlambda),b.invInertiaWorldSolve.vmult(p.rotational,N),b.wlambda.addScaledVector(r,N,b.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Ts.id=0;const dp=new M,Os=new M,ao=new M,Vc=new M,Wu=new M,vh=new M;class To extends Ts{constructor(r,h,p=1e6){super(r,h,0,p),this.restitution=0,this.ri=new M,this.rj=new M,this.ni=new M}computeB(r){const h=this.a,p=this.b,y=this.bi,b=this.bj,N=this.ri,O=this.rj,T=Ys,z=Vp,ee=y.velocity,oe=y.angularVelocity,ne=b.velocity,ve=b.angularVelocity,xe=ll,Te=this.jacobianElementA,Ce=this.jacobianElementB,Ie=this.ni;N.cross(Ie,T),O.cross(Ie,z),Ie.negate(Te.spatial),T.negate(Te.rotational),Ce.spatial.copy(Ie),Ce.rotational.copy(z),xe.copy(b.position),xe.vadd(O,xe),xe.vsub(y.position,xe),xe.vsub(N,xe);const Oe=Ie.dot(xe),Fe=this.restitution+1;return-Oe*h-(Fe*ne.dot(Ie)-Fe*ee.dot(Ie)+ve.dot(z)-oe.dot(T))*p-r*this.computeGiMf()}getImpactVelocityAlongNormal(){const r=mu,h=fp,p=mp,y=yh,b=Fh;return this.bi.position.vadd(this.ri,p),this.bj.position.vadd(this.rj,y),this.bi.getVelocityAtWorldPoint(p,r),this.bj.getVelocityAtWorldPoint(y,h),r.vsub(h,b),this.ni.dot(b)}}const Ys=new M,Vp=new M,ll=new M,mu=new M,fp=new M,mp=new M,yh=new M,Fh=new M;class mc extends du{constructor(r,h=new M,p,y=new M,b=1e6){super(r,p),this.pivotA=h.clone(),this.pivotB=y.clone();const N=this.equationX=new To(r,p),O=this.equationY=new To(r,p),T=this.equationZ=new To(r,p);this.equations.push(N,O,T),N.minForce=O.minForce=T.minForce=-b,N.maxForce=O.maxForce=T.maxForce=b,N.ni.set(1,0,0),O.ni.set(0,1,0),T.ni.set(0,0,1)}update(){const h=this.bodyB,p=this.equationX,y=this.equationY,b=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,p.ri),h.quaternion.vmult(this.pivotB,p.rj),y.ri.copy(p.ri),y.rj.copy(p.rj),b.ri.copy(p.ri),b.rj.copy(p.rj)}}class Dh extends Ts{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,h,-y,y),this.axisA=p.axisA?p.axisA.clone():new M(1,0,0),this.axisB=p.axisB?p.axisB.clone():new M(0,1,0),this.angle=void 0!==p.angle?p.angle:0}computeB(r){const h=this.a,p=this.b,y=this.axisA,b=this.axisB,N=bh,O=Uh,T=this.jacobianElementA,z=this.jacobianElementB;return y.cross(b,N),b.cross(y,O),T.rotational.copy(O),z.rotational.copy(N),-(Math.cos(this.angle)-y.dot(b))*h-this.computeGW()*p-r*this.computeGiMf()}}const bh=new M,Uh=new M;class Tl extends Ts{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,h,-y,y),this.axisA=p.axisA?p.axisA.clone():new M(1,0,0),this.axisB=p.axisB?p.axisB.clone():new M(0,1,0),this.maxAngle=Math.PI/2}computeB(r){const h=this.a,p=this.b,y=this.axisA,b=this.axisB,N=Ml,O=ql,T=this.jacobianElementA,z=this.jacobianElementB;return y.cross(b,N),b.cross(y,O),T.rotational.copy(O),z.rotational.copy(N),-(Math.cos(this.maxAngle)-y.dot(b))*h-this.computeGW()*p-r*this.computeGiMf()}}const Ml=new M,ql=new M;class qu extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,p.pivotA?p.pivotA.clone():new M,h,p.pivotB?p.pivotB.clone():new M,y),this.axisA=p.axisA?p.axisA.clone():new M,this.axisB=p.axisB?p.axisB.clone():new M,this.collideConnected=!!p.collideConnected,this.angle=void 0!==p.angle?p.angle:0;const b=this.coneEquation=new Dh(r,h,p),N=this.twistEquation=new Tl(r,h,p);this.twistAngle=void 0!==p.twistAngle?p.twistAngle:0,b.maxForce=0,b.minForce=-y,N.maxForce=0,N.minForce=-y,this.equations.push(b,N)}update(){const r=this.bodyA,h=this.bodyB,p=this.coneEquation,y=this.twistEquation;super.update(),r.vectorToWorldFrame(this.axisA,p.axisA),h.vectorToWorldFrame(this.axisB,p.axisB),this.axisA.tangents(y.axisA,y.axisA),r.vectorToWorldFrame(y.axisA,y.axisA),this.axisB.tangents(y.axisB,y.axisB),h.vectorToWorldFrame(y.axisB,y.axisB),p.angle=this.angle,y.maxAngle=this.twistAngle}}class ps extends du{constructor(r,h,p,y=1e6){super(r,h),void 0===p&&(p=r.position.distanceTo(h.position)),this.distance=p;const b=this.distanceEquation=new To(r,h);this.equations.push(b),b.minForce=-y,b.maxForce=y}update(){const p=this.distanceEquation,y=.5*this.distance,b=p.ni;this.bodyB.position.vsub(this.bodyA.position,b),b.normalize(),b.scale(y,p.ri),b.scale(-y,p.rj)}}class Xl extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6,b=new M,N=new M,O=new M;r.position.vadd(h.position,O),O.scale(.5,O),h.pointToLocalFrame(O,N),r.pointToLocalFrame(O,b),super(r,b,h,N,y),this.xA=r.vectorToLocalFrame(M.UNIT_X),this.xB=h.vectorToLocalFrame(M.UNIT_X),this.yA=r.vectorToLocalFrame(M.UNIT_Y),this.yB=h.vectorToLocalFrame(M.UNIT_Y),this.zA=r.vectorToLocalFrame(M.UNIT_Z),this.zB=h.vectorToLocalFrame(M.UNIT_Z);const T=this.rotationalEquation1=new Tl(r,h,p),z=this.rotationalEquation2=new Tl(r,h,p),ee=this.rotationalEquation3=new Tl(r,h,p);this.equations.push(T,z,ee)}update(){const r=this.bodyA,h=this.bodyB,p=this.rotationalEquation1,y=this.rotationalEquation2,b=this.rotationalEquation3;super.update(),r.vectorToWorldFrame(this.xA,p.axisA),h.vectorToWorldFrame(this.yB,p.axisB),r.vectorToWorldFrame(this.yA,y.axisA),h.vectorToWorldFrame(this.zB,y.axisB),r.vectorToWorldFrame(this.zA,b.axisA),h.vectorToWorldFrame(this.xB,b.axisB)}}class Xu extends Ts{constructor(r,h,p=1e6){super(r,h,-p,p),this.axisA=new M,this.axisB=new M,this.targetVelocity=0}computeB(r){const h=this.b,y=this.axisB,N=this.jacobianElementB;return this.jacobianElementA.rotational.copy(this.axisA),y.negate(N.rotational),-(this.computeGW()-this.targetVelocity)*h-r*this.computeGiMf()}}class _p extends mc{constructor(r,h,p={}){const y=void 0!==p.maxForce?p.maxForce:1e6;super(r,p.pivotA?p.pivotA.clone():new M,h,p.pivotB?p.pivotB.clone():new M,y),(this.axisA=p.axisA?p.axisA.clone():new M(1,0,0)).normalize(),(this.axisB=p.axisB?p.axisB.clone():new M(1,0,0)).normalize(),this.collideConnected=!!p.collideConnected;const b=this.rotationalEquation1=new Tl(r,h,p),N=this.rotationalEquation2=new Tl(r,h,p),O=this.motorEquation=new Xu(r,h,y);O.enabled=!1,this.equations.push(b,N,O)}enableMotor(){this.motorEquation.enabled=!0}disableMotor(){this.motorEquation.enabled=!1}setMotorSpeed(r){this.motorEquation.targetVelocity=r}setMotorMaxForce(r){this.motorEquation.maxForce=r,this.motorEquation.minForce=-r}update(){const r=this.bodyA,h=this.bodyB,p=this.motorEquation,y=this.rotationalEquation1,b=this.rotationalEquation2,N=gp,O=Wc,T=this.axisA,z=this.axisB;super.update(),r.quaternion.vmult(T,N),h.quaternion.vmult(z,O),N.tangents(y.axisA,b.axisA),y.axisB.copy(O),b.axisB.copy(O),this.motorEquation.enabled&&(r.quaternion.vmult(this.axisA,p.axisA),h.quaternion.vmult(this.axisB,p.axisB))}}const gp=new M,Wc=new M;class _c extends Ts{constructor(r,h,p){super(r,h,-p,p),this.ri=new M,this.rj=new M,this.t=new M}computeB(r){const h=this.b,y=this.rj,b=xh,N=vp,O=this.t;this.ri.cross(O,b),y.cross(O,N);const T=this.jacobianElementA,z=this.jacobianElementB;return O.negate(T.spatial),b.negate(T.rotational),z.spatial.copy(O),z.rotational.copy(N),-this.computeGW()*h-r*this.computeGiMf()}}const xh=new M,vp=new M;class Yu{constructor(r,h,p){p=Vu.defaults(p,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=Yu.idCounter++,this.materials=[r,h],this.friction=p.friction,this.restitution=p.restitution,this.contactEquationStiffness=p.contactEquationStiffness,this.contactEquationRelaxation=p.contactEquationRelaxation,this.frictionEquationStiffness=p.frictionEquationStiffness,this.frictionEquationRelaxation=p.frictionEquationRelaxation}}Yu.idCounter=0;class Ju{constructor(r={}){let h="";"string"==typeof r&&(h=r,r={}),this.name=h,this.id=Ju.idCounter++,this.friction=void 0!==r.friction?r.friction:-1,this.restitution=void 0!==r.restitution?r.restitution:-1}}Ju.idCounter=0;class cl{constructor(r,h,p={}){this.restLength="number"==typeof p.restLength?p.restLength:1,this.stiffness=p.stiffness||100,this.damping=p.damping||1,this.bodyA=r,this.bodyB=h,this.localAnchorA=new M,this.localAnchorB=new M,p.localAnchorA&&this.localAnchorA.copy(p.localAnchorA),p.localAnchorB&&this.localAnchorB.copy(p.localAnchorB),p.worldAnchorA&&this.setWorldAnchorA(p.worldAnchorA),p.worldAnchorB&&this.setWorldAnchorB(p.worldAnchorB)}setWorldAnchorA(r){this.bodyA.pointToLocalFrame(r,this.localAnchorA)}setWorldAnchorB(r){this.bodyB.pointToLocalFrame(r,this.localAnchorB)}getWorldAnchorA(r){this.bodyA.pointToWorldFrame(this.localAnchorA,r)}getWorldAnchorB(r){this.bodyB.pointToWorldFrame(this.localAnchorB,r)}applyForce(){const r=this.stiffness,h=this.damping,p=this.restLength,y=this.bodyA,b=this.bodyB,N=zh,O=ul,T=jh,z=Zu,ee=Xc,oe=vc,ne=yc,ve=wh,xe=_u,Te=qc,Ce=yp;this.getWorldAnchorA(oe),this.getWorldAnchorB(ne),oe.vsub(y.position,ve),ne.vsub(b.position,xe),ne.vsub(oe,N);const Ie=N.length();O.copy(N),O.normalize(),b.velocity.vsub(y.velocity,T),b.angularVelocity.cross(xe,ee),T.vadd(ee,T),y.angularVelocity.cross(ve,ee),T.vsub(ee,T),O.scale(-r*(Ie-p)-h*T.dot(O),z),y.force.vsub(z,y.force),b.force.vadd(z,b.force),ve.cross(z,Te),xe.cross(z,Ce),y.torque.vsub(Te,y.torque),b.torque.vadd(Ce,b.torque)}}const zh=new M,ul=new M,jh=new M,Zu=new M,vc=new M,yc=new M,wh=new M,_u=new M,qc=new M,yp=new M,Xc=new M;class Qu{constructor(r={}){r=Vu.defaults(r,{chassisConnectionPointLocal:new M,chassisConnectionPointWorld:new M,directionLocal:new M,directionWorld:new M,axleLocal:new M,axleWorld:new M,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,slipInfo:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=r.maxSuspensionTravel,this.customSlidingRotationalSpeed=r.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=r.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=r.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=r.chassisConnectionPointWorld.clone(),this.directionLocal=r.directionLocal.clone(),this.directionWorld=r.directionWorld.clone(),this.axleLocal=r.axleLocal.clone(),this.axleWorld=r.axleWorld.clone(),this.suspensionRestLength=r.suspensionRestLength,this.suspensionMaxLength=r.suspensionMaxLength,this.radius=r.radius,this.suspensionStiffness=r.suspensionStiffness,this.dampingCompression=r.dampingCompression,this.dampingRelaxation=r.dampingRelaxation,this.frictionSlip=r.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=r.rollInfluence,this.maxSuspensionForce=r.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=r.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.slipInfo=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new mi,this.worldTransform=new U,this.isInContact=!1}updateWheel(r){const h=this.raycastResult;if(this.isInContact){const p=h.hitNormalWorld.dot(h.directionWorld);h.hitPointWorld.vsub(r.position,bp),r.getVelocityAtWorldPoint(bp,Yl);const y=h.hitNormalWorld.dot(Yl);if(p>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{const b=-1/p;this.suspensionRelativeVelocity=y*b,this.clippedInvContactDotSuspension=b}}else h.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,h.directionWorld.scale(-1,h.hitNormalWorld),this.clippedInvContactDotSuspension=1}}const Yl=new M,bp=new M;class Gh{constructor(r){this.chassisBody=r.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==r.indexRightAxis?r.indexRightAxis:1,this.indexForwardAxis=void 0!==r.indexForwardAxis?r.indexForwardAxis:0,this.indexUpAxis=void 0!==r.indexUpAxis?r.indexUpAxis:2,this.constraints=[],this.preStepCallback=()=>{},this.currentVehicleSpeedKmHour=0}addWheel(r={}){const h=new Qu(r),p=this.wheelInfos.length;return this.wheelInfos.push(h),p}setSteeringValue(r,h){this.wheelInfos[h].steering=r}applyEngineForce(r,h){this.wheelInfos[h].engineForce=r}setBrake(r,h){this.wheelInfos[h].brake=r}addToWorld(r){r.addBody(this.chassisBody);const h=this;this.preStepCallback=()=>{h.updateVehicle(r.dt)},r.addEventListener("preStep",this.preStepCallback),this.world=r}getVehicleAxisWorld(r,h){h.set(0===r?1:0,1===r?1:0,2===r?1:0),this.chassisBody.vectorToWorldFrame(h,h)}updateVehicle(r){const h=this.wheelInfos,p=h.length,y=this.chassisBody;for(let oe=0;oe<p;oe++)this.updateWheelTransform(oe);this.currentVehicleSpeedKmHour=3.6*y.velocity.length();const b=new M;this.getVehicleAxisWorld(this.indexForwardAxis,b),b.dot(y.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(let oe=0;oe<p;oe++)this.castRay(h[oe]);this.updateSuspension(r);const N=new M,O=new M;for(let oe=0;oe<p;oe++){const ne=h[oe];let ve=ne.suspensionForce;ve>ne.maxSuspensionForce&&(ve=ne.maxSuspensionForce),ne.raycastResult.hitNormalWorld.scale(ve*r,N),ne.raycastResult.hitPointWorld.vsub(y.position,O),y.applyImpulse(N,O)}this.updateFriction(r);const T=new M,z=new M,ee=new M;for(let oe=0;oe<p;oe++){const ne=h[oe];y.getVelocityAtWorldPoint(ne.chassisConnectionPointWorld,ee);let ve=1;if(1===this.indexUpAxis&&(ve=-1),ne.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,z);const xe=z.dot(ne.raycastResult.hitNormalWorld);ne.raycastResult.hitNormalWorld.scale(xe,T),z.vsub(T,z);const Te=z.dot(ee);ne.deltaRotation=ve*Te*r/ne.radius}!ne.sliding&&ne.isInContact||0===ne.engineForce||!ne.useCustomSlidingRotationalSpeed||(ne.deltaRotation=(ne.engineForce>0?1:-1)*ne.customSlidingRotationalSpeed*r),Math.abs(ne.brake)>Math.abs(ne.engineForce)&&(ne.deltaRotation=0),ne.rotation+=ne.deltaRotation,ne.deltaRotation*=.99}}updateSuspension(r){const h=this.chassisBody.mass,p=this.wheelInfos,y=p.length;for(let b=0;b<y;b++){const N=p[b];if(N.isInContact){let O;O=N.suspensionStiffness*(N.suspensionRestLength-N.suspensionLength)*N.clippedInvContactDotSuspension;const z=N.suspensionRelativeVelocity;let ee;ee=z<0?N.dampingCompression:N.dampingRelaxation,O-=ee*z,N.suspensionForce=O*h,N.suspensionForce<0&&(N.suspensionForce=0)}else N.suspensionForce=0}}removeFromWorld(r){r.removeBody(this.chassisBody),r.removeEventListener("preStep",this.preStepCallback),this.world=null}castRay(r){const h=Wp,p=gu;this.updateWheelTransformWorld(r);const y=this.chassisBody;let b=-1;r.directionWorld.scale(r.suspensionRestLength+r.radius,h);const O=r.chassisConnectionPointWorld;O.vadd(h,p);const T=r.raycastResult;T.reset();const z=y.collisionResponse;y.collisionResponse=!1,this.world.rayTest(O,p,T),y.collisionResponse=z;const ee=T.body;if(r.raycastResult.groundObject=0,ee){b=T.distance,r.raycastResult.hitNormalWorld=T.hitNormalWorld,r.isInContact=!0,r.suspensionLength=T.distance-r.radius;const ne=r.suspensionRestLength-r.maxSuspensionTravel,ve=r.suspensionRestLength+r.maxSuspensionTravel;r.suspensionLength<ne&&(r.suspensionLength=ne),r.suspensionLength>ve&&(r.suspensionLength=ve,r.raycastResult.reset());const xe=r.raycastResult.hitNormalWorld.dot(r.directionWorld),Te=new M;y.getVelocityAtWorldPoint(r.raycastResult.hitPointWorld,Te);const Ce=r.raycastResult.hitNormalWorld.dot(Te);if(xe>=-.1)r.suspensionRelativeVelocity=0,r.clippedInvContactDotSuspension=10;else{const Ie=-1/xe;r.suspensionRelativeVelocity=Ce*Ie,r.clippedInvContactDotSuspension=Ie}}else r.suspensionLength=r.suspensionRestLength+0*r.maxSuspensionTravel,r.suspensionRelativeVelocity=0,r.directionWorld.scale(-1,r.raycastResult.hitNormalWorld),r.clippedInvContactDotSuspension=1;return b}updateWheelTransformWorld(r){r.isInContact=!1;const h=this.chassisBody;h.pointToWorldFrame(r.chassisConnectionPointLocal,r.chassisConnectionPointWorld),h.vectorToWorldFrame(r.directionLocal,r.directionWorld),h.vectorToWorldFrame(r.axleLocal,r.axleWorld)}updateWheelTransform(r){const h=xp,p=wp,y=Hh,b=this.wheelInfos[r];this.updateWheelTransformWorld(b),b.directionLocal.scale(-1,h),p.copy(b.axleLocal),h.cross(p,y),y.normalize(),p.normalize();const N=b.steering,O=new Z;O.setFromAxisAngle(h,N);const T=new Z;T.setFromAxisAngle(p,b.rotation);const z=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(O,z),z.mult(T,z),z.normalize();const ee=b.worldTransform.position;ee.copy(b.directionWorld),ee.scale(b.suspensionLength,ee),ee.vadd(b.chassisConnectionPointWorld,ee)}getWheelTransformWorld(r){return this.wheelInfos[r].worldTransform}updateFriction(r){const h=bc,p=this.wheelInfos,y=p.length,b=this.chassisBody,N=Zl,O=Jl;for(let T=0;T<y;T++){const z=p[T];z.sideImpulse=0,z.forwardImpulse=0,N[T]||(N[T]=new M),O[T]||(O[T]=new M)}for(let T=0;T<y;T++){const z=p[T],ee=z.raycastResult.body;if(ee){const oe=O[T];this.getWheelTransformWorld(T).vectorToWorldFrame(qa[this.indexRightAxis],oe);const ne=z.raycastResult.hitNormalWorld,ve=oe.dot(ne);ne.scale(ve,h),oe.vsub(h,oe),oe.normalize(),ne.cross(oe,N[T]),N[T].normalize(),z.sideImpulse=Wh(b,z.raycastResult.hitPointWorld,ee,z.raycastResult.hitPointWorld,oe),z.sideImpulse*=Ku}}this.sliding=!1;for(let T=0;T<y;T++){const z=p[T],ee=z.raycastResult.body;let oe=0;if(z.slipInfo=1,ee){const ve=z.brake?z.brake:0;oe=eh(b,ee,z.raycastResult.hitPointWorld,N[T],ve),oe+=z.engineForce*r,z.slipInfo*=ve/oe}if(z.forwardImpulse=0,z.skidInfo=1,ee){z.skidInfo=1;const ne=z.suspensionForce*r*z.frictionSlip,ve=ne*ne;z.forwardImpulse=oe;const xe=.5*z.forwardImpulse,Te=1*z.sideImpulse,Ce=xe*xe+Te*Te;if(z.sliding=!1,Ce>ve){this.sliding=!0,z.sliding=!0;const Ie=ne/Math.sqrt(Ce);z.skidInfo*=Ie}}}if(this.sliding)for(let T=0;T<y;T++){const z=p[T];0!==z.sideImpulse&&z.skidInfo<1&&(z.forwardImpulse*=z.skidInfo,z.sideImpulse*=z.skidInfo)}for(let T=0;T<y;T++){const z=p[T],ee=new M;if(z.raycastResult.hitPointWorld.vsub(b.position,ee),0!==z.forwardImpulse){const oe=new M;N[T].scale(z.forwardImpulse,oe),b.applyImpulse(oe,ee)}if(0!==z.sideImpulse){const oe=z.raycastResult.body,ne=new M;z.raycastResult.hitPointWorld.vsub(oe.position,ne);const ve=new M;O[T].scale(z.sideImpulse,ve),b.vectorToLocalFrame(ee,ee),ee["xyz"[this.indexUpAxis]]*=z.rollInfluence,b.vectorToWorldFrame(ee,ee),b.applyImpulse(ve,ee),ve.scale(-1,ve),oe.applyImpulse(ve,ne)}}}}const xp=new M,wp=new M,Hh=new M,Wp=(new Nr,new M),gu=new M,qa=[new M(1,0,0),new M(0,1,0),new M(0,0,1)],bc=new M,Jl=[],Zl=[],Ku=1,$a=new M,ua=new M,Al=new M;function eh(a,r,h,p,y){let b=0;const N=h,O=$a,T=ua,z=Al;return a.getVelocityAtWorldPoint(N,O),r.getVelocityAtWorldPoint(N,T),O.vsub(T,z),b=-p.dot(z)*(1/(Ji(a,h,p)+Ji(r,h,p))),y<b&&(b=y),b<-y&&(b=-y),b}const th=new M,Vh=new M,Sp=new M,Ep=new M;function Ji(a,r,h){const p=th,y=Vh,b=Sp,N=Ep;return r.vsub(a.position,p),p.cross(h,y),a.invInertiaWorld.vmult(y,N),N.cross(p,b),a.invMass+h.dot(b)}const hl=new M,Ql=new M,Yc=new M;function Wh(a,r,h,p,y){if(y.lengthSquared()>1.1)return 0;const b=hl,N=Ql,O=Yc;return a.getVelocityAtWorldPoint(r,b),h.getVelocityAtWorldPoint(p,N),b.vsub(N,O),-.2*y.dot(O)*(1/(a.invMass+h.invMass))}class xc extends he{constructor(r){if(super({type:he.types.SPHERE}),this.radius=void 0!==r?r:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(r,h=new M){const p=2*r*this.radius*this.radius/5;return h.x=p,h.y=p,h.z=p,h}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(r,h,p,y){const b=this.radius,N=["x","y","z"];for(let O=0;O<N.length;O++){const T=N[O];p[T]=r[T]-b,y[T]=r[T]+b}}}class nh{constructor(r={}){this.wheelBodies=[],this.coordinateSystem=void 0!==r.coordinateSystem?r.coordinateSystem.clone():new M(1,2,3),this.chassisBody=r.chassisBody?r.chassisBody:new dt({mass:1,shape:new Ge(new M(5,2,.5))}),this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}addWheel(r={}){let h;h=r.body?r.body:new dt({mass:1,shape:new xc(1.2)}),this.wheelBodies.push(h),this.wheelForces.push(0);const p=void 0!==r.position?r.position.clone():new M,y=new M;this.chassisBody.pointToWorldFrame(p,y),h.position.set(y.x,y.y,y.z);const b=void 0!==r.axis?r.axis.clone():new M(0,1,0);this.wheelAxes.push(b);const N=new _p(this.chassisBody,h,{pivotA:p,axisA:b,pivotB:M.ZERO,axisB:b,collideConnected:!1});return this.constraints.push(N),this.wheelBodies.length-1}setSteeringValue(r,h){const p=this.wheelAxes[h],y=Math.cos(r),b=Math.sin(r),N=p.x,O=p.y;this.constraints[h].axisA.set(y*N-b*O,b*N+y*O,0)}setMotorSpeed(r,h){const p=this.constraints[h];p.enableMotor(),p.motorTargetVelocity=r}disableMotor(r){this.constraints[r].disableMotor()}setWheelForce(r,h){this.wheelForces[h]=r}applyWheelForce(r,h){const y=this.wheelBodies[h],b=y.torque;this.wheelAxes[h].scale(r,vu),y.vectorToWorldFrame(vu,vu),b.vadd(vu,b)}addToWorld(r){const h=this.constraints,p=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<p.length;y++)r.addBody(p[y]);for(let y=0;y<h.length;y++)r.addConstraint(h[y]);r.addEventListener("preStep",this._update.bind(this))}_update(){const r=this.wheelForces;for(let h=0;h<r.length;h++)this.applyWheelForce(r[h],h)}removeFromWorld(r){const h=this.constraints,p=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<p.length;y++)r.removeBody(p[y]);for(let y=0;y<h.length;y++)r.removeConstraint(h[y])}getWheelSpeed(r){const p=this.wheelBodies[r].angularVelocity;return this.chassisBody.vectorToWorldFrame(this.wheelAxes[r],q),p.dot(q)}}const vu=new M,q=new M;class pe{constructor(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}add(r){this.particles.push(r),this.neighbors.length<this.particles.length&&this.neighbors.push([])}remove(r){const h=this.particles.indexOf(r);-1!==h&&(this.particles.splice(h,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())}getNeighbors(r,h){const p=this.particles.length,y=r.id,b=this.smoothingRadius*this.smoothingRadius,N=Me;for(let O=0;O!==p;O++){const T=this.particles[O];T.position.vsub(r.position,N),y!==T.id&&N.lengthSquared()<b&&h.push(T)}}update(){const r=this.particles.length,h=Be,p=this.speedOfSound,y=this.eps;for(let ee=0;ee!==r;ee++){const oe=this.particles[ee],ne=this.neighbors[ee];ne.length=0,this.getNeighbors(oe,ne),ne.push(this.particles[ee]);const ve=ne.length;let xe=0;for(let Te=0;Te!==ve;Te++){oe.position.vsub(ne[Te].position,h);const Ce=h.length(),Ie=this.w(Ce);xe+=ne[Te].mass*Ie}this.densities[ee]=xe,this.pressures[ee]=p*p*(this.densities[ee]-this.density)}const b=Ve,N=qe,O=et,T=Mt,z=Bt;for(let ee=0;ee!==r;ee++){const oe=this.particles[ee];let ne,ve;b.set(0,0,0),N.set(0,0,0);const xe=this.neighbors[ee],Te=xe.length;for(let Ce=0;Ce!==Te;Ce++){const Ie=xe[Ce];oe.position.vsub(Ie.position,T);const Oe=T.length();ne=-Ie.mass*(this.pressures[ee]/(this.densities[ee]*this.densities[ee]+y)+this.pressures[Ce]/(this.densities[Ce]*this.densities[Ce]+y)),this.gradw(T,O),O.scale(ne,O),b.vadd(O,b),Ie.velocity.vsub(oe.velocity,z),z.scale(1/(1e-4+this.densities[ee]*this.densities[Ce])*this.viscosity*Ie.mass,z),ve=this.nablaw(Oe),z.scale(ve,z),N.vadd(z,N)}N.scale(oe.mass,N),b.scale(oe.mass,b),oe.force.vadd(N,oe.force),oe.force.vadd(b,oe.force)}}w(r){const h=this.smoothingRadius;return 315/(64*Math.PI*h**9)*(h*h-r*r)**3}gradw(r,h){const p=r.length(),y=this.smoothingRadius;r.scale(945/(32*Math.PI*y**9)*(y*y-p*p)**2,h)}nablaw(r){const h=this.smoothingRadius;return 945/(32*Math.PI*h**9)*(h*h-r*r)*(7*r*r-3*h*h)}}const Me=new M,Be=new M,Ve=new M,qe=new M,et=new M,Mt=new M,Bt=new M;class Xt extends Q{constructor(r,h,p,y){const b=y,N=[],O=[],T=[],z=[],ee=[],oe=Math.cos,ne=Math.sin;N.push(new M(h*oe(0),h*ne(0),.5*-p)),z.push(0),N.push(new M(r*oe(0),r*ne(0),.5*p)),ee.push(1);for(let xe=0;xe<b;xe++){const Te=2*Math.PI/b*(xe+1),Ce=2*Math.PI/b*(xe+.5);xe<b-1?(N.push(new M(h*oe(Te),h*ne(Te),.5*-p)),z.push(2*xe+2),N.push(new M(r*oe(Te),r*ne(Te),.5*p)),ee.push(2*xe+3),T.push([2*xe+2,2*xe+3,2*xe+1,2*xe])):T.push([0,1,2*xe+1,2*xe]),(b%2==1||xe<b/2)&&O.push(new M(oe(Ce),ne(Ce),0))}T.push(ee),O.push(new M(0,0,1));const ve=[];for(let xe=0;xe<z.length;xe++)ve.push(z[z.length-xe-1]);T.push(ve),super({vertices:N,faces:T,axes:O})}}class pn extends he{constructor(){super({type:he.types.PARTICLE})}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return 0}updateBoundingSphereRadius(){this.boundingSphereRadius=0}calculateWorldAABB(r,h,p,y){p.copy(r),y.copy(r)}}class Fn extends he{constructor(){super({type:he.types.PLANE}),this.worldNormal=new M,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(r){const h=this.worldNormal;h.set(0,0,1),r.vmult(h,h),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(r,h=new M){return h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,p,y){on.set(0,0,1),h.vmult(on,on);const b=Number.MAX_VALUE;p.set(-b,-b,-b),y.set(b,b,b),1===on.x?y.x=r.x:-1===on.x&&(p.x=r.x),1===on.y?y.y=r.y:-1===on.y&&(p.y=r.y),1===on.z?y.z=r.z:-1===on.z&&(p.z=r.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const on=new M;class Sn extends he{constructor(r,h={}){h=Vu.defaults(h,{maxValue:null,minValue:null,elementSize:1}),super({type:he.types.HEIGHTFIELD}),this.data=r,this.maxValue=h.maxValue,this.minValue=h.minValue,this.elementSize=h.elementSize,null===h.minValue&&this.updateMinValue(),null===h.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,this.pillarConvex=new Q,this.pillarOffset=new M,this.updateBoundingSphereRadius(),this._cachedPillars={}}update(){this._cachedPillars={}}updateMinValue(){const r=this.data;let h=r[0][0];for(let p=0;p!==r.length;p++)for(let y=0;y!==r[p].length;y++){const b=r[p][y];b<h&&(h=b)}this.minValue=h}updateMaxValue(){const r=this.data;let h=r[0][0];for(let p=0;p!==r.length;p++)for(let y=0;y!==r[p].length;y++){const b=r[p][y];b>h&&(h=b)}this.maxValue=h}setHeightValueAtIndex(r,h,p){this.data[r][h]=p,this.clearCachedConvexTrianglePillar(r,h,!1),r>0&&(this.clearCachedConvexTrianglePillar(r-1,h,!0),this.clearCachedConvexTrianglePillar(r-1,h,!1)),h>0&&(this.clearCachedConvexTrianglePillar(r,h-1,!0),this.clearCachedConvexTrianglePillar(r,h-1,!1)),h>0&&r>0&&this.clearCachedConvexTrianglePillar(r-1,h-1,!0)}getRectMinMax(r,h,p,y,b=[]){const N=this.data;let O=this.minValue;for(let T=r;T<=p;T++)for(let z=h;z<=y;z++){const ee=N[T][z];ee>O&&(O=ee)}b[0]=this.minValue,b[1]=O}getIndexOfPosition(r,h,p,y){const b=this.elementSize,N=this.data;let O=Math.floor(r/b),T=Math.floor(h/b);return p[0]=O,p[1]=T,y&&(O<0&&(O=0),T<0&&(T=0),O>=N.length-1&&(O=N.length-1),T>=N[0].length-1&&(T=N[0].length-1)),!(O<0||T<0||O>=N.length-1||T>=N[0].length-1)}getTriangleAt(r,h,p,y,b,N){const O=Er;this.getIndexOfPosition(r,h,O,p);let T=O[0],z=O[1];const ee=this.data;p&&(T=Math.min(ee.length-2,Math.max(0,T)),z=Math.min(ee[0].length-2,Math.max(0,z)));const oe=this.elementSize,ne=(r/oe-T)**2+(h/oe-z)**2>(r/oe-(T+1))**2+(h/oe-(z+1))**2;return this.getTriangle(T,z,ne,y,b,N),ne}getNormalAt(r,h,p,y){const b=ha,N=bi,O=Br,T=Xa,z=Wi;this.getTriangleAt(r,h,p,b,N,O),N.vsub(b,T),O.vsub(b,z),T.cross(z,y),y.normalize()}getAabbAtIndex(r,h,{lowerBound:p,upperBound:y}){const b=this.data,N=this.elementSize;p.set(r*N,h*N,b[r][h]),y.set((r+1)*N,(h+1)*N,b[r+1][h+1])}getHeightAt(r,h,p){const y=this.data,b=Ar,N=ds,O=es,T=Er;this.getIndexOfPosition(r,h,T,p);let z=T[0],ee=T[1];p&&(z=Math.min(y.length-2,Math.max(0,z)),ee=Math.min(y[0].length-2,Math.max(0,ee)));const oe=this.getTriangleAt(r,h,p,b,N,O);var ve,xe,Te,Ce,Ie,Oe,Fe,je,Ue;return(Ue=ti).x=(((Oe=N.y)-(je=O.y))*((ve=r)-(Fe=O.x))+(Fe-(Ie=N.x))*((xe=h)-je))/((Oe-je)*((Te=b.x)-Fe)+(Fe-Ie)*((Ce=b.y)-je)),Ue.y=((je-Ce)*(ve-Fe)+(Te-Fe)*(xe-je))/((Oe-je)*(Te-Fe)+(Fe-Ie)*(Ce-je)),Ue.z=1-Ue.x-Ue.y,oe?y[z+1][ee+1]*ti.x+y[z][ee+1]*ti.y+y[z+1][ee]*ti.z:y[z][ee]*ti.x+y[z+1][ee]*ti.y+y[z][ee+1]*ti.z}getCacheConvexTrianglePillarKey(r,h,p){return r+"_"+h+"_"+(p?1:0)}getCachedConvexTrianglePillar(r,h,p){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]}setCachedConvexTrianglePillar(r,h,p,y,b){this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]={convex:y,offset:b}}clearCachedConvexTrianglePillar(r,h,p){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,p)]}getTriangle(r,h,p,y,b,N){const O=this.data,T=this.elementSize;p?(y.set((r+1)*T,(h+1)*T,O[r+1][h+1]),b.set(r*T,(h+1)*T,O[r][h+1]),N.set((r+1)*T,h*T,O[r+1][h])):(y.set(r*T,h*T,O[r][h]),b.set((r+1)*T,h*T,O[r+1][h]),N.set(r*T,(h+1)*T,O[r][h+1]))}getConvexTrianglePillar(r,h,p){let y=this.pillarConvex,b=this.pillarOffset;if(this.cacheEnabled){const oe=this.getCachedConvexTrianglePillar(r,h,p);if(oe)return this.pillarConvex=oe.convex,void(this.pillarOffset=oe.offset);y=new Q,b=new M,this.pillarConvex=y,this.pillarOffset=b}const N=this.data,O=this.elementSize,T=y.faces;y.vertices.length=6;for(let oe=0;oe<6;oe++)y.vertices[oe]||(y.vertices[oe]=new M);T.length=5;for(let oe=0;oe<5;oe++)T[oe]||(T[oe]=[]);const z=y.vertices,ee=(Math.min(N[r][h],N[r+1][h],N[r][h+1],N[r+1][h+1])-this.minValue)/2+this.minValue;p?(b.set((r+.75)*O,(h+.75)*O,ee),z[0].set(.25*O,.25*O,N[r+1][h+1]-ee),z[1].set(-.75*O,.25*O,N[r][h+1]-ee),z[2].set(.25*O,-.75*O,N[r+1][h]-ee),z[3].set(.25*O,.25*O,-ee-1),z[4].set(-.75*O,.25*O,-ee-1),z[5].set(.25*O,-.75*O,-ee-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=2,T[2][1]=5,T[2][2]=3,T[2][3]=0,T[3][0]=3,T[3][1]=4,T[3][2]=1,T[3][3]=0,T[4][0]=1,T[4][1]=4,T[4][2]=5,T[4][3]=2):(b.set((r+.25)*O,(h+.25)*O,ee),z[0].set(-.25*O,-.25*O,N[r][h]-ee),z[1].set(.75*O,-.25*O,N[r+1][h]-ee),z[2].set(-.25*O,.75*O,N[r][h+1]-ee),z[3].set(-.25*O,-.25*O,-ee-1),z[4].set(.75*O,-.25*O,-ee-1),z[5].set(-.25*O,.75*O,-ee-1),T[0][0]=0,T[0][1]=1,T[0][2]=2,T[1][0]=5,T[1][1]=4,T[1][2]=3,T[2][0]=0,T[2][1]=2,T[2][2]=5,T[2][3]=3,T[3][0]=1,T[3][1]=0,T[3][2]=3,T[3][3]=4,T[4][0]=4,T[4][1]=5,T[4][2]=2,T[4][3]=1),y.computeNormals(),y.computeEdges(),y.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(r,h,p,y,b)}calculateLocalInertia(r,h=new M){return h.set(0,0,0),h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,p,y){p.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),y.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}updateBoundingSphereRadius(){const r=this.data,h=this.elementSize;this.boundingSphereRadius=new M(r.length*h,r[0].length*h,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).length()}setHeightsFromImage(r,h){const{x:p,z:y,y:b}=h,N=document.createElement("canvas");N.width=r.width,N.height=r.height;const O=N.getContext("2d");O.drawImage(r,0,0);const T=O.getImageData(0,0,r.width,r.height),z=this.data;z.length=0,this.elementSize=Math.abs(p)/T.width;for(let ee=0;ee<T.height;ee++){const oe=[];for(let ne=0;ne<T.width;ne++){const ve=(T.data[4*(ee*T.height+ne)]+T.data[4*(ee*T.height+ne)+1]+T.data[4*(ee*T.height+ne)+2])/4/255*y;p<0?oe.push(ve):oe.unshift(ve)}b<0?z.unshift(oe):z.push(oe)}this.updateMaxValue(),this.updateMinValue(),this.update()}}const Er=[],ti=new M,Ar=new M,ds=new M,es=new M,ha=new M,bi=new M,Br=new M,Xa=new M,Wi=new M;class qi{constructor(r={}){this.root=r.root||null,this.aabb=r.aabb?r.aabb.clone():new ie,this.data=[],this.children=[]}reset(){this.children.length=this.data.length=0}insert(r,h,p=0){const y=this.data;if(!this.aabb.contains(r))return!1;const b=this.children;if(p<(this.maxDepth||this.root.maxDepth)){let N=!1;b.length||(this.subdivide(),N=!0);for(let O=0;8!==O;O++)if(b[O].insert(r,h,p+1))return!0;N&&(b.length=0)}return y.push(h),!0}subdivide(){const r=this.aabb,h=r.lowerBound,p=r.upperBound,y=this.children;y.push(new qi({aabb:new ie({lowerBound:new M(0,0,0)})}),new qi({aabb:new ie({lowerBound:new M(1,0,0)})}),new qi({aabb:new ie({lowerBound:new M(1,1,0)})}),new qi({aabb:new ie({lowerBound:new M(1,1,1)})}),new qi({aabb:new ie({lowerBound:new M(0,1,1)})}),new qi({aabb:new ie({lowerBound:new M(0,0,1)})}),new qi({aabb:new ie({lowerBound:new M(1,0,1)})}),new qi({aabb:new ie({lowerBound:new M(0,1,0)})})),p.vsub(h,wc),wc.scale(.5,wc);const b=this.root||this;for(let N=0;8!==N;N++){const O=y[N];O.root=b;const T=O.aabb.lowerBound;T.x*=wc.x,T.y*=wc.y,T.z*=wc.z,T.vadd(h,T),T.vadd(wc,O.aabb.upperBound)}}aabbQuery(r,h){const p=[this];for(;p.length;){const y=p.pop();y.aabb.overlaps(r)&&Array.prototype.push.apply(h,y.data),Array.prototype.push.apply(p,y.children)}return h}rayQuery(r,h,p){return r.getAABB(pa),pa.toLocalFrame(h,pa),this.aabbQuery(pa,p),p}removeEmptyNodes(){for(let r=this.children.length-1;r>=0;r--)this.children[r].removeEmptyNodes(),this.children[r].children.length||this.children[r].data.length||this.children.splice(r,1)}}class qh extends qi{constructor(r,h={}){super({root:null,aabb:r}),this.maxDepth=void 0!==h.maxDepth?h.maxDepth:8}}const wc=new M,pa=new ie;class pl extends he{constructor(r,h){super({type:he.types.TRIMESH}),this.vertices=new Float32Array(r),this.indices=new Int16Array(h),this.normals=new Float32Array(h.length),this.aabb=new ie,this.edges=null,this.scale=new M(1,1,1),this.tree=new qh,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}updateTree(){const r=this.tree;r.reset(),r.aabb.copy(this.aabb);const h=this.scale;r.aabb.lowerBound.x*=1/h.x,r.aabb.lowerBound.y*=1/h.y,r.aabb.lowerBound.z*=1/h.z,r.aabb.upperBound.x*=1/h.x,r.aabb.upperBound.y*=1/h.y,r.aabb.upperBound.z*=1/h.z;const p=new ie,y=new M,b=new M,N=new M,O=[y,b,N];for(let T=0;T<this.indices.length/3;T++){const z=3*T;this._getUnscaledVertex(this.indices[z],y),this._getUnscaledVertex(this.indices[z+1],b),this._getUnscaledVertex(this.indices[z+2],N),p.setFromPoints(O),r.insert(p,T)}r.removeEmptyNodes()}getTrianglesInAABB(r,h){Ri.copy(r);const p=this.scale,y=p.x,b=p.y,N=p.z,O=Ri.lowerBound,T=Ri.upperBound;return O.x/=y,O.y/=b,O.z/=N,T.x/=y,T.y/=b,T.z/=N,this.tree.aabbQuery(Ri,h)}setScale(r){this.scale.x===this.scale.y&&this.scale.y===this.scale.z&&r.x===r.y&&r.y===r.z||this.updateNormals(),this.scale.copy(r),this.updateAABB(),this.updateBoundingSphereRadius()}updateNormals(){const r=da,h=this.normals;for(let p=0;p<this.indices.length/3;p++){const y=3*p,N=this.indices[y+1],O=this.indices[y+2];this.getVertex(this.indices[y],ss),this.getVertex(N,Zi),this.getVertex(O,Hr),pl.computeNormal(Zi,ss,Hr,r),h[y]=r.x,h[y+1]=r.y,h[y+2]=r.z}}updateEdges(){const r={},h=(y,b)=>{r[y<b?y+"_"+b:b+"_"+y]=!0};for(let y=0;y<this.indices.length/3;y++){const b=3*y,N=this.indices[b],O=this.indices[b+1],T=this.indices[b+2];h(N,O),h(O,T),h(T,N)}const p=Object.keys(r);this.edges=new Int16Array(2*p.length);for(let y=0;y<p.length;y++){const b=p[y].split("_");this.edges[2*y]=parseInt(b[0],10),this.edges[2*y+1]=parseInt(b[1],10)}}getEdgeVertex(r,h,p){this.getVertex(this.edges[2*r+(h?1:0)],p)}getEdgeVector(r,h){const p=ks,y=er;this.getEdgeVertex(r,0,p),this.getEdgeVertex(r,1,y),y.vsub(p,h)}getVertex(r,h){const p=this.scale;return this._getUnscaledVertex(r,h),h.x*=p.x,h.y*=p.y,h.z*=p.z,h}_getUnscaledVertex(r,h){const p=3*r,y=this.vertices;return h.set(y[p],y[p+1],y[p+2])}getWorldVertex(r,h,p,y){return this.getVertex(r,y),U.pointToWorldFrame(h,p,y,y),y}getTriangleVertices(r,h,p,y){const b=3*r;this.getVertex(this.indices[b],h),this.getVertex(this.indices[b+1],p),this.getVertex(this.indices[b+2],y)}getNormal(r,h){const p=3*r;return h.set(this.normals[p],this.normals[p+1],this.normals[p+2])}calculateLocalInertia(r,h){this.computeLocalAABB(di);const p=di.upperBound.x-di.lowerBound.x,y=di.upperBound.y-di.lowerBound.y,b=di.upperBound.z-di.lowerBound.z;return h.set(1/12*r*(2*y*2*y+2*b*2*b),1/12*r*(2*p*2*p+2*b*2*b),1/12*r*(2*y*2*y+2*p*2*p))}computeLocalAABB(r){const h=r.lowerBound,p=r.upperBound,y=this.vertices.length,b=xi;this.getVertex(0,b),h.copy(b),p.copy(b);for(let N=0;N!==y;N++)this.getVertex(N,b),b.x<h.x?h.x=b.x:b.x>p.x&&(p.x=b.x),b.y<h.y?h.y=b.y:b.y>p.y&&(p.y=b.y),b.z<h.z?h.z=b.z:b.z>p.z&&(p.z=b.z)}updateAABB(){this.computeLocalAABB(this.aabb)}updateBoundingSphereRadius(){let r=0;const h=this.vertices,p=new M;for(let y=0,b=h.length/3;y!==b;y++){this.getVertex(y,p);const N=p.lengthSquared();N>r&&(r=N)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,p,y){const b=Fs,N=Xh;b.position=r,b.quaternion=h,this.aabb.toWorldFrame(b,N),p.copy(N.lowerBound),y.copy(N.upperBound)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}}const da=new M,Ri=new ie,ks=new M,er=new M,En=new M,Ho=new M;pl.computeNormal=(a,r,h,p)=>{r.vsub(a,Ho),h.vsub(r,En),En.cross(Ho,p),p.isZero()||p.normalize()};const ss=new M,Zi=new M,Hr=new M,di=new ie,xi=new M,Fs=new U,Xh=new ie;pl.createTorus=(a=1,r=.5,h=8,p=6,y=2*Math.PI)=>{const b=[],N=[];for(let O=0;O<=h;O++)for(let T=0;T<=p;T++){const z=T/p*y,ee=O/h*Math.PI*2,oe=(a+r*Math.cos(ee))*Math.cos(z),ne=(a+r*Math.cos(ee))*Math.sin(z),ve=r*Math.sin(ee);b.push(oe,ne,ve)}for(let O=1;O<=h;O++)for(let T=1;T<=p;T++){const ee=(p+1)*(O-1)+T-1,oe=(p+1)*(O-1)+T,ne=(p+1)*O+T;N.push((p+1)*O+T-1,ee,ne),N.push(ee,oe,ne)}return new pl(b,N)};class vo{constructor(){this.equations=[]}solve(r,h){return 0}addEquation(r){r.enabled&&this.equations.push(r)}removeEquation(r){const h=this.equations,p=h.indexOf(r);-1!==p&&h.splice(p,1)}removeAllEquations(){this.equations.length=0}}class yu extends vo{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(r,h){let p=0;const y=this.iterations,b=this.tolerance*this.tolerance,N=this.equations,O=N.length,T=h.bodies,z=T.length,ee=r;let oe,ne,ve,xe,Te,Ce;if(0!==O)for(let je=0;je!==z;je++)T[je].updateSolveMassProperties();const Ie=lt,Oe=$l,Fe=zn;Ie.length=O,Oe.length=O,Fe.length=O;for(let je=0;je!==O;je++){const Ue=N[je];Fe[je]=0,Oe[je]=Ue.computeB(ee),Ie[je]=1/Ue.computeC()}if(0!==O){for(let Ye=0;Ye!==z;Ye++){const at=T[Ye],St=at.wlambda;at.vlambda.set(0,0,0),St.set(0,0,0)}for(p=0;p!==y;p++){xe=0;for(let Ye=0;Ye!==O;Ye++){const at=N[Ye];oe=Oe[Ye],ne=Ie[Ye],Ce=Fe[Ye],Te=at.computeGWlambda(),ve=ne*(oe-Te-at.eps*Ce),Ce+ve<at.minForce?ve=at.minForce-Ce:Ce+ve>at.maxForce&&(ve=at.maxForce-Ce),Fe[Ye]+=ve,xe+=ve>0?ve:-ve,at.addToWlambda(ve)}if(xe*xe<b)break}for(let Ye=0;Ye!==z;Ye++){const at=T[Ye],pt=at.velocity,St=at.angularVelocity;at.vlambda.vmul(at.linearFactor,at.vlambda),pt.vadd(at.vlambda,pt),at.wlambda.vmul(at.angularFactor,at.wlambda),St.vadd(at.wlambda,St)}let je=N.length;const Ue=1/ee;for(;je--;)N[je].multiplier=Fe[je]*Ue}return p}}const zn=[],lt=[],$l=[];class Ms extends vo{constructor(r){for(super(),this.iterations=10,this.tolerance=1e-7,this.subsolver=r,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}createNode(){return{body:null,children:[],eqs:[],visited:!1}}solve(r,h){const p=Tp,y=this.nodePool,b=h.bodies,N=this.equations,O=N.length,T=b.length,z=this.subsolver;for(;y.length<T;)y.push(this.createNode());p.length=T;for(let xe=0;xe<T;xe++)p[xe]=y[xe];for(let xe=0;xe!==T;xe++){const Te=p[xe];Te.body=b[xe],Te.children.length=0,Te.eqs.length=0,Te.visited=!1}for(let xe=0;xe!==O;xe++){const Te=N[xe],Ce=b.indexOf(Te.bi),Ie=b.indexOf(Te.bj),Oe=p[Ce],Fe=p[Ie];Oe.children.push(Fe),Oe.eqs.push(Te),Fe.children.push(Oe),Fe.eqs.push(Te)}let ee,oe=0,ne=As;z.tolerance=this.tolerance,z.iterations=this.iterations;const ve=Sc;for(;ee=ro(p);){ne.length=0,ve.bodies.length=0,Jc(ee,$i,ve.bodies,ne);const xe=ne.length;ne=ne.sort(ht);for(let Te=0;Te!==xe;Te++)z.addEquation(ne[Te]);z.solve(r,ve),z.removeAllEquations(),oe++}return oe}}const Tp=[],As=[],Sc={bodies:[]},Di=dt.STATIC;function ro(a){const r=a.length;for(let h=0;h!==r;h++){const p=a[h];if(!(p.visited||p.body.type&Di))return p}return!1}const ri=[];function Jc(a,r,h,p){for(ri.push(a),a.visited=!0,r(a,h,p);ri.length;){const y=ri.pop();let b;for(;b=ro(y.children);)b.visited=!0,r(b,h,p),ri.push(b)}}function $i(a,r,h){r.push(a.body);const p=a.eqs.length;for(let y=0;y!==p;y++){const b=a.eqs[y];h.includes(b)||h.push(b)}}function ht(a,r){return r.id-a.id}class bu{constructor(){this.objects=[],this.type=Object}release(...r){const h=r.length;for(let p=0;p!==h;p++)this.objects.push(r[p]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(r){const h=this.objects;for(;h.length>r;)h.pop();for(;h.length<r;)h.push(this.constructObject());return this}}class Mp extends bu{constructor(){super(),this.type=M}constructObject(){return new M}}const Ui={sphereSphere:he.types.SPHERE,spherePlane:he.types.SPHERE|he.types.PLANE,boxBox:he.types.BOX|he.types.BOX,sphereBox:he.types.SPHERE|he.types.BOX,planeBox:he.types.PLANE|he.types.BOX,convexConvex:he.types.CONVEXPOLYHEDRON,sphereConvex:he.types.SPHERE|he.types.CONVEXPOLYHEDRON,planeConvex:he.types.PLANE|he.types.CONVEXPOLYHEDRON,boxConvex:he.types.BOX|he.types.CONVEXPOLYHEDRON,sphereHeightfield:he.types.SPHERE|he.types.HEIGHTFIELD,boxHeightfield:he.types.BOX|he.types.HEIGHTFIELD,convexHeightfield:he.types.CONVEXPOLYHEDRON|he.types.HEIGHTFIELD,sphereParticle:he.types.PARTICLE|he.types.SPHERE,planeParticle:he.types.PLANE|he.types.PARTICLE,boxParticle:he.types.BOX|he.types.PARTICLE,convexParticle:he.types.PARTICLE|he.types.CONVEXPOLYHEDRON,sphereTrimesh:he.types.SPHERE|he.types.TRIMESH,planeTrimesh:he.types.PLANE|he.types.TRIMESH};class Or{constructor(r){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new Mp,this.world=r,this.currentContactMaterial=r.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(r,h,p,y,b,N){let O;this.contactPointPool.length?(O=this.contactPointPool.pop(),O.bi=r,O.bj=h):O=new To(r,h),O.enabled=r.collisionResponse&&h.collisionResponse&&p.collisionResponse&&y.collisionResponse;const T=this.currentContactMaterial;O.restitution=T.restitution,O.setSpookParams(T.contactEquationStiffness,T.contactEquationRelaxation,this.world.dt);const z=p.material||r.material,ee=y.material||h.material;return z&&ee&&z.restitution>=0&&ee.restitution>=0&&(O.restitution=z.restitution*ee.restitution),O.si=b||p,O.sj=N||y,O}createFrictionEquationsFromContact(r,h){const p=r.bi,y=r.bj,O=this.world,T=this.currentContactMaterial;let z=T.friction;const ee=r.si.material||p.material,oe=r.sj.material||y.material;if(ee&&oe&&ee.friction>=0&&oe.friction>=0&&(z=ee.friction*oe.friction),z>0){const ne=z*O.gravity.length();let ve=p.invMass+y.invMass;ve>0&&(ve=1/ve);const xe=this.frictionEquationPool,Te=xe.length?xe.pop():new _c(p,y,ne*ve),Ce=xe.length?xe.pop():new _c(p,y,ne*ve);return Te.bi=Ce.bi=p,Te.bj=Ce.bj=y,Te.minForce=Ce.minForce=-ne*ve,Te.maxForce=Ce.maxForce=ne*ve,Te.ri.copy(r.ri),Te.rj.copy(r.rj),Ce.ri.copy(r.ri),Ce.rj.copy(r.rj),r.ni.tangents(Te.t,Ce.t),Te.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,O.dt),Ce.setSpookParams(T.frictionEquationStiffness,T.frictionEquationRelaxation,O.dt),Te.enabled=Ce.enabled=r.enabled,h.push(Te,Ce),!0}return!1}createFrictionFromAverage(r){let h=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(h,this.frictionResult)||1===r)return;const p=this.frictionResult[this.frictionResult.length-2],y=this.frictionResult[this.frictionResult.length-1];qr.setZero(),Ya.setZero(),yo.setZero();const b=h.bi;for(let O=0;O!==r;O++)h=this.result[this.result.length-1-O],h.bi!==b?(qr.vadd(h.ni,qr),Ya.vadd(h.ri,Ya),yo.vadd(h.rj,yo)):(qr.vsub(h.ni,qr),Ya.vadd(h.rj,Ya),yo.vadd(h.ri,yo));const N=1/r;Ya.scale(N,p.ri),yo.scale(N,p.rj),y.ri.copy(p.ri),y.rj.copy(p.rj),qr.normalize(),qr.tangents(p.t,y.t)}getContacts(r,h,p,y,b,N,O){this.contactPointPool=b,this.frictionEquationPool=O,this.result=y,this.frictionResult=N;const T=Ec,z=Zc,ee=fa,oe=xu;for(let ne=0,ve=r.length;ne!==ve;ne++){const xe=r[ne],Te=h[ne];let Ce=null;xe.material&&Te.material&&(Ce=p.getContactMaterial(xe.material,Te.material)||null);const Ie=xe.type&dt.KINEMATIC&&Te.type&dt.STATIC||xe.type&dt.STATIC&&Te.type&dt.KINEMATIC||xe.type&dt.KINEMATIC&&Te.type&dt.KINEMATIC;for(let Oe=0;Oe<xe.shapes.length;Oe++){xe.quaternion.mult(xe.shapeOrientations[Oe],T),xe.quaternion.vmult(xe.shapeOffsets[Oe],ee),ee.vadd(xe.position,ee);const Fe=xe.shapes[Oe];for(let je=0;je<Te.shapes.length;je++){Te.quaternion.mult(Te.shapeOrientations[je],z),Te.quaternion.vmult(Te.shapeOffsets[je],oe),oe.vadd(Te.position,oe);const Ue=Te.shapes[je];if(!(Fe.collisionFilterMask&Ue.collisionFilterGroup&&Ue.collisionFilterMask&Fe.collisionFilterGroup)||ee.distanceTo(oe)>Fe.boundingSphereRadius+Ue.boundingSphereRadius)continue;let Ye=null;Fe.material&&Ue.material&&(Ye=p.getContactMaterial(Fe.material,Ue.material)||null),this.currentContactMaterial=Ye||Ce||p.defaultContactMaterial;const at=this[Fe.type|Ue.type];if(at){let pt=!1;pt=Fe.type<Ue.type?at.call(this,Fe,Ue,ee,oe,T,z,xe,Te,Fe,Ue,Ie):at.call(this,Ue,Fe,oe,ee,z,T,Te,xe,Fe,Ue,Ie),pt&&Ie&&(p.shapeOverlapKeeper.set(Fe.id,Ue.id),p.bodyOverlapKeeper.set(xe.id,Te.id))}}}}}sphereSphere(r,h,p,y,b,N,O,T,z,ee,oe){if(oe)return p.distanceSquared(y)<(r.radius+h.radius)**2;const ne=this.createContactEquation(O,T,r,h,z,ee);y.vsub(p,ne.ni),ne.ni.normalize(),ne.ri.copy(ne.ni),ne.rj.copy(ne.ni),ne.ri.scale(r.radius,ne.ri),ne.rj.scale(-h.radius,ne.rj),ne.ri.vadd(p,ne.ri),ne.ri.vsub(O.position,ne.ri),ne.rj.vadd(y,ne.rj),ne.rj.vsub(T.position,ne.rj),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}spherePlane(r,h,p,y,b,N,O,T,z,ee,oe){const ne=this.createContactEquation(O,T,r,h,z,ee);if(ne.ni.set(0,0,1),N.vmult(ne.ni,ne.ni),ne.ni.negate(ne.ni),ne.ni.normalize(),ne.ni.scale(r.radius,ne.ri),p.vsub(y,fn),ne.ni.scale(ne.ni.dot(fn),tn),fn.vsub(tn,ne.rj),-fn.dot(ne.ni)<=r.radius){if(oe)return!0;const ve=ne.ri,xe=ne.rj;ve.vadd(p,ve),ve.vsub(O.position,ve),xe.vadd(y,xe),xe.vsub(T.position,xe),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}}boxBox(r,h,p,y,b,N,O,T,z,ee,oe){return r.convexPolyhedronRepresentation.material=r.material,h.convexPolyhedronRepresentation.material=h.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h.convexPolyhedronRepresentation,p,y,b,N,O,T,r,h,oe)}sphereBox(r,h,p,y,b,N,O,T,z,ee,oe){const ne=this.v3pool,ve=ts;p.vsub(y,yr),h.getSideNormals(ve,N);const xe=r.radius;let Te=!1;const Ce=Js,Ie=Bo,Oe=ec;let Fe=null,je=0,Ue=0,Ye=0,at=null;for(let $t=0,Zt=ve.length;$t!==Zt&&!1===Te;$t++){const _n=Xr;_n.copy(ve[$t]);const xn=_n.length();_n.normalize();const wr=yr.dot(_n);if(wr<xn+xe&&wr>0){const ir=fi,Hn=Rr;ir.copy(ve[($t+1)%3]),Hn.copy(ve[($t+2)%3]);const lr=ir.length(),Yn=Hn.length();ir.normalize(),Hn.normalize();const fr=yr.dot(ir),zr=yr.dot(Hn);if(fr<lr&&fr>-lr&&zr<Yn&&zr>-Yn){const xo=Math.abs(wr-xn-xe);if((null===at||xo<at)&&(at=xo,Ue=fr,Ye=zr,Fe=xn,Ce.copy(_n),Ie.copy(ir),Oe.copy(Hn),je++,oe))return!0}}}if(je){Te=!0;const $t=this.createContactEquation(O,T,r,h,z,ee);Ce.scale(-xe,$t.ri),$t.ni.copy(Ce),$t.ni.negate($t.ni),Ce.scale(Fe,Ce),Ie.scale(Ue,Ie),Ce.vadd(Ie,Ce),Oe.scale(Ye,Oe),Ce.vadd(Oe,$t.rj),$t.ri.vadd(p,$t.ri),$t.ri.vsub(O.position,$t.ri),$t.rj.vadd(y,$t.rj),$t.rj.vsub(T.position,$t.rj),this.result.push($t),this.createFrictionEquationsFromContact($t,this.frictionResult)}let pt=ne.get();const St=lo;for(let $t=0;2!==$t&&!Te;$t++)for(let Zt=0;2!==Zt&&!Te;Zt++)for(let _n=0;2!==_n&&!Te;_n++)if(pt.set(0,0,0),$t?pt.vadd(ve[0],pt):pt.vsub(ve[0],pt),Zt?pt.vadd(ve[1],pt):pt.vsub(ve[1],pt),_n?pt.vadd(ve[2],pt):pt.vsub(ve[2],pt),y.vadd(pt,St),St.vsub(p,St),St.lengthSquared()<xe*xe){if(oe)return!0;Te=!0;const xn=this.createContactEquation(O,T,r,h,z,ee);xn.ri.copy(St),xn.ri.normalize(),xn.ni.copy(xn.ri),xn.ri.scale(xe,xn.ri),xn.rj.copy(pt),xn.ri.vadd(p,xn.ri),xn.ri.vsub(O.position,xn.ri),xn.rj.vadd(y,xn.rj),xn.rj.vsub(T.position,xn.rj),this.result.push(xn),this.createFrictionEquationsFromContact(xn,this.frictionResult)}ne.release(pt),pt=null;const At=ne.get(),Jt=ne.get(),jt=ne.get(),Pt=ne.get(),Nt=ne.get(),ft=ve.length;for(let $t=0;$t!==ft&&!Te;$t++)for(let Zt=0;Zt!==ft&&!Te;Zt++)if($t%3!=Zt%3){ve[Zt].cross(ve[$t],At),At.normalize(),ve[$t].vadd(ve[Zt],Jt),jt.copy(p),jt.vsub(Jt,jt),jt.vsub(y,jt);const _n=jt.dot(At);At.scale(_n,Pt);let xn=0;for(;xn===$t%3||xn===Zt%3;)xn++;Nt.copy(p),Nt.vsub(Pt,Nt),Nt.vsub(Jt,Nt),Nt.vsub(y,Nt);const wr=Math.abs(_n),ir=Nt.length();if(wr<ve[xn].length()&&ir<xe){if(oe)return!0;Te=!0;const Hn=this.createContactEquation(O,T,r,h,z,ee);Jt.vadd(Pt,Hn.rj),Hn.rj.copy(Hn.rj),Nt.negate(Hn.ni),Hn.ni.normalize(),Hn.ri.copy(Hn.rj),Hn.ri.vadd(y,Hn.ri),Hn.ri.vsub(p,Hn.ri),Hn.ri.normalize(),Hn.ri.scale(xe,Hn.ri),Hn.ri.vadd(p,Hn.ri),Hn.ri.vsub(O.position,Hn.ri),Hn.rj.vadd(y,Hn.rj),Hn.rj.vsub(T.position,Hn.rj),this.result.push(Hn),this.createFrictionEquationsFromContact(Hn,this.frictionResult)}}ne.release(At,Jt,jt,Pt,Nt)}planeBox(r,h,p,y,b,N,O,T,z,ee,oe){return h.convexPolyhedronRepresentation.material=h.material,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,h.convexPolyhedronRepresentation.id=h.id,this.planeConvex(r,h.convexPolyhedronRepresentation,p,y,b,N,O,T,r,h,oe)}convexConvex(r,h,p,y,b,N,O,T,z,ee,oe,ne,ve){const xe=$p;if(!(p.distanceTo(y)>r.boundingSphereRadius+h.boundingSphereRadius)&&r.findSeparatingAxis(h,p,b,y,N,xe,ne,ve)){const Te=[],Ce=ar;r.clipAgainstHull(p,b,h,y,N,xe,-100,100,Te);let Ie=0;for(let Oe=0;Oe!==Te.length;Oe++){if(oe)return!0;const Fe=this.createContactEquation(O,T,r,h,z,ee),je=Fe.ri,Ue=Fe.rj;xe.negate(Fe.ni),Te[Oe].normal.negate(Ce),Ce.scale(Te[Oe].depth,Ce),Te[Oe].point.vadd(Ce,je),Ue.copy(Te[Oe].point),je.vsub(p,je),Ue.vsub(y,Ue),je.vadd(p,je),je.vsub(O.position,je),Ue.vadd(y,Ue),Ue.vsub(T.position,Ue),this.result.push(Fe),Ie++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Fe,this.frictionResult)}this.enableFrictionReduction&&Ie&&this.createFrictionFromAverage(Ie)}}sphereConvex(r,h,p,y,b,N,O,T,z,ee,oe){const ne=this.v3pool;p.vsub(y,Yo);const ve=h.faceNormals,xe=h.faces,Te=h.vertices,Ce=r.radius;let Ie=!1;for(let Oe=0;Oe!==Te.length;Oe++){const je=rh;N.vmult(Te[Oe],je),y.vadd(je,je);const Ue=Yh;if(je.vsub(p,Ue),Ue.lengthSquared()<Ce*Ce){if(oe)return!0;Ie=!0;const Ye=this.createContactEquation(O,T,r,h,z,ee);return Ye.ri.copy(Ue),Ye.ri.normalize(),Ye.ni.copy(Ye.ri),Ye.ri.scale(Ce,Ye.ri),je.vsub(y,Ye.rj),Ye.ri.vadd(p,Ye.ri),Ye.ri.vsub(O.position,Ye.ri),Ye.rj.vadd(y,Ye.rj),Ye.rj.vsub(T.position,Ye.rj),this.result.push(Ye),void this.createFrictionEquationsFromContact(Ye,this.frictionResult)}}for(let Oe=0,Fe=xe.length;Oe!==Fe&&!1===Ie;Oe++){const Ue=xe[Oe],Ye=Ap;N.vmult(ve[Oe],Ye);const at=Eh;N.vmult(Te[Ue[0]],at),at.vadd(y,at);const pt=cd;Ye.scale(-Ce,pt),p.vadd(pt,pt);const St=Th;pt.vsub(at,St);const At=St.dot(Ye),Jt=Rd;if(p.vsub(at,Jt),At<0&&Jt.dot(Ye)>0){const jt=[];for(let Pt=0,Nt=Ue.length;Pt!==Nt;Pt++){const ft=ne.get();N.vmult(Te[Ue[Pt]],ft),y.vadd(ft,ft),jt.push(ft)}if($r(jt,Ye,p)){if(oe)return!0;Ie=!0;const Pt=this.createContactEquation(O,T,r,h,z,ee);Ye.scale(-Ce,Pt.ri),Ye.negate(Pt.ni);const Nt=ne.get();Ye.scale(-At,Nt);const ft=ne.get();Ye.scale(-Ce,ft),p.vsub(y,Pt.rj),Pt.rj.vadd(ft,Pt.rj),Pt.rj.vadd(Nt,Pt.rj),Pt.rj.vadd(y,Pt.rj),Pt.rj.vsub(T.position,Pt.rj),Pt.ri.vadd(p,Pt.ri),Pt.ri.vsub(O.position,Pt.ri),ne.release(Nt),ne.release(ft),this.result.push(Pt),this.createFrictionEquationsFromContact(Pt,this.frictionResult);for(let $t=0,Zt=jt.length;$t!==Zt;$t++)ne.release(jt[$t]);return}for(let Pt=0;Pt!==Ue.length;Pt++){const Nt=ne.get(),ft=ne.get();N.vmult(Te[Ue[(Pt+1)%Ue.length]],Nt),N.vmult(Te[Ue[(Pt+2)%Ue.length]],ft),y.vadd(Nt,Nt),y.vadd(ft,ft);const $t=Xi;ft.vsub(Nt,$t);const Zt=Ac;$t.unit(Zt);const _n=ne.get(),xn=ne.get();p.vsub(Nt,xn);const wr=xn.dot(Zt);Zt.scale(wr,_n),_n.vadd(Nt,_n);const ir=ne.get();if(_n.vsub(p,ir),wr>0&&wr*wr<$t.lengthSquared()&&ir.lengthSquared()<Ce*Ce){if(oe)return!0;const Hn=this.createContactEquation(O,T,r,h,z,ee);_n.vsub(y,Hn.rj),_n.vsub(p,Hn.ni),Hn.ni.normalize(),Hn.ni.scale(Ce,Hn.ri),Hn.rj.vadd(y,Hn.rj),Hn.rj.vsub(T.position,Hn.rj),Hn.ri.vadd(p,Hn.ri),Hn.ri.vsub(O.position,Hn.ri),this.result.push(Hn),this.createFrictionEquationsFromContact(Hn,this.frictionResult);for(let lr=0,Yn=jt.length;lr!==Yn;lr++)ne.release(jt[lr]);return ne.release(Nt),ne.release(ft),ne.release(_n),ne.release(ir),void ne.release(xn)}ne.release(Nt),ne.release(ft),ne.release(_n),ne.release(ir),ne.release(xn)}for(let Pt=0,Nt=jt.length;Pt!==Nt;Pt++)ne.release(jt[Pt])}}}planeConvex(r,h,p,y,b,N,O,T,z,ee,oe){const ne=ud,ve=Pr;ve.set(0,0,1),b.vmult(ve,ve);let xe=0;const Te=$c;for(let Ce=0;Ce!==h.vertices.length;Ce++)if(ne.copy(h.vertices[Ce]),N.vmult(ne,ne),y.vadd(ne,ne),ne.vsub(p,Te),ve.dot(Te)<=0){if(oe)return!0;const Ie=this.createContactEquation(O,T,r,h,z,ee),Oe=Zs;ve.scale(ve.dot(Te),Oe),ne.vsub(Oe,Oe),Oe.vsub(p,Ie.ri),Ie.ni.copy(ve),ne.vsub(y,Ie.rj),Ie.ri.vadd(p,Ie.ri),Ie.ri.vsub(O.position,Ie.ri),Ie.rj.vadd(y,Ie.rj),Ie.rj.vsub(T.position,Ie.rj),this.result.push(Ie),xe++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Ie,this.frictionResult)}this.enableFrictionReduction&&xe&&this.createFrictionFromAverage(xe)}boxConvex(r,h,p,y,b,N,O,T,z,ee,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h,p,y,b,N,O,T,r,h,oe)}sphereHeightfield(r,h,p,y,b,N,O,T,z,ee,oe){const ne=h.data,ve=r.radius,xe=h.elementSize,Te=Zh,Ce=ih;U.pointToLocalFrame(y,N,p,Ce);let Ie=Math.floor((Ce.x-ve)/xe)-1,Oe=Math.ceil((Ce.x+ve)/xe)+1,Fe=Math.floor((Ce.y-ve)/xe)-1,je=Math.ceil((Ce.y+ve)/xe)+1;if(Oe<0||je<0||Ie>ne.length||Fe>ne[0].length)return;Ie<0&&(Ie=0),Oe<0&&(Oe=0),Fe<0&&(Fe=0),je<0&&(je=0),Ie>=ne.length&&(Ie=ne.length-1),Oe>=ne.length&&(Oe=ne.length-1),je>=ne[0].length&&(je=ne[0].length-1),Fe>=ne[0].length&&(Fe=ne[0].length-1);const Ue=[];if(h.getRectMinMax(Ie,Fe,Oe,je,Ue),Ce.z-ve>Ue[1]||Ce.z+ve<Ue[0])return;const pt=this.result;for(let St=Ie;St<Oe;St++)for(let At=Fe;At<je;At++){const Jt=pt.length;let jt=!1;if(h.getConvexTrianglePillar(St,At,!1),U.pointToWorldFrame(y,N,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(jt=this.sphereConvex(r,h.pillarConvex,p,Te,b,N,O,T,r,h,oe)),oe&&jt||(h.getConvexTrianglePillar(St,At,!0),U.pointToWorldFrame(y,N,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(jt=this.sphereConvex(r,h.pillarConvex,p,Te,b,N,O,T,r,h,oe)),oe&&jt))return!0;if(pt.length-Jt>2)return}}boxHeightfield(r,h,p,y,b,N,O,T,z,ee,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexHeightfield(r.convexPolyhedronRepresentation,h,p,y,b,N,O,T,r,h,oe)}convexHeightfield(r,h,p,y,b,N,O,T,z,ee,oe){const ne=h.data,ve=h.elementSize,xe=r.boundingSphereRadius,Te=dl,Ce=Cc,Ie=Vr;U.pointToLocalFrame(y,N,p,Ie);let Oe=Math.floor((Ie.x-xe)/ve)-1,Fe=Math.ceil((Ie.x+xe)/ve)+1,je=Math.floor((Ie.y-xe)/ve)-1,Ue=Math.ceil((Ie.y+xe)/ve)+1;if(Fe<0||Ue<0||Oe>ne.length||je>ne[0].length)return;Oe<0&&(Oe=0),Fe<0&&(Fe=0),je<0&&(je=0),Ue<0&&(Ue=0),Oe>=ne.length&&(Oe=ne.length-1),Fe>=ne.length&&(Fe=ne.length-1),Ue>=ne[0].length&&(Ue=ne[0].length-1),je>=ne[0].length&&(je=ne[0].length-1);const Ye=[];if(h.getRectMinMax(Oe,je,Fe,Ue,Ye),!(Ie.z-xe>Ye[1]||Ie.z+xe<Ye[0]))for(let St=Oe;St<Fe;St++)for(let At=je;At<Ue;At++){let Jt=!1;if(h.getConvexTrianglePillar(St,At,!1),U.pointToWorldFrame(y,N,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Jt=this.convexConvex(r,h.pillarConvex,p,Te,b,N,O,T,null,null,oe,Ce,null)),oe&&Jt||(h.getConvexTrianglePillar(St,At,!0),U.pointToWorldFrame(y,N,h.pillarOffset,Te),p.distanceTo(Te)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Jt=this.convexConvex(r,h.pillarConvex,p,Te,b,N,O,T,null,null,oe,Ce,null)),oe&&Jt))return!0}}sphereParticle(r,h,p,y,b,N,O,T,z,ee,oe){const ne=ma;if(ne.set(0,0,1),y.vsub(p,ne),ne.lengthSquared()<=r.radius*r.radius){if(oe)return!0;const ve=this.createContactEquation(T,O,h,r,z,ee);ne.normalize(),ve.rj.copy(ne),ve.rj.scale(r.radius,ve.rj),ve.ni.copy(ne),ve.ni.negate(ve.ni),ve.ri.set(0,0,0),this.result.push(ve),this.createFrictionEquationsFromContact(ve,this.frictionResult)}}planeParticle(r,h,p,y,b,N,O,T,z,ee,oe){const ne=Ll;ne.set(0,0,1),O.quaternion.vmult(ne,ne);const ve=Mh;if(y.vsub(O.position,ve),ne.dot(ve)<=0){if(oe)return!0;const xe=this.createContactEquation(T,O,h,r,z,ee);xe.ni.copy(ne),xe.ni.negate(xe.ni),xe.ri.set(0,0,0);const Te=Jh;ne.scale(ne.dot(y),Te),y.vsub(Te,Te),xe.rj.copy(Te),this.result.push(xe),this.createFrictionEquationsFromContact(xe,this.frictionResult)}}boxParticle(r,h,p,y,b,N,O,T,z,ee,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexParticle(r.convexPolyhedronRepresentation,h,p,y,b,N,O,T,r,h,oe)}convexParticle(r,h,p,y,b,N,O,T,z,ee,oe){let ne=-1;const ve=Ki,xe=$s;let Te=null;const Ce=Ur;if(Ce.copy(y),Ce.vsub(p,Ce),b.conjugate(hd),hd.vmult(Ce,Ce),r.pointIsInside(Ce)){r.worldVerticesNeedsUpdate&&r.computeWorldVertices(p,b),r.worldFaceNormalsNeedsUpdate&&r.computeWorldFaceNormals(b);for(let Ie=0,Oe=r.faces.length;Ie!==Oe;Ie++){const je=r.worldFaceNormals[Ie];y.vsub(r.worldVertices[r.faces[Ie][0]],No);const Ue=-je.dot(No);if(null===Te||Math.abs(Ue)<Math.abs(Te)){if(oe)return!0;Te=Ue,ne=Ie,ve.copy(je)}}if(-1!==ne){const Ie=this.createContactEquation(T,O,h,r,z,ee);ve.scale(Te,xe),xe.vadd(y,xe),xe.vsub(p,xe),Ie.rj.copy(xe),ve.negate(Ie.ni),Ie.ri.set(0,0,0);const Oe=Ie.ri,Fe=Ie.rj;Oe.vadd(y,Oe),Oe.vsub(T.position,Oe),Fe.vadd(p,Fe),Fe.vsub(O.position,Fe),this.result.push(Ie),this.createFrictionEquationsFromContact(Ie,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}sphereTrimesh(r,h,p,y,b,N,O,T,z,ee,oe){const ne=Kl,ve=Su,xe=La,Te=bo,Ce=Ds,Ie=Mc,Oe=bn,Fe=Ca,je=Cl,Ue=qt;U.pointToLocalFrame(y,N,p,Ce);const Ye=r.radius;Oe.lowerBound.set(Ce.x-Ye,Ce.y-Ye,Ce.z-Ye),Oe.upperBound.set(Ce.x+Ye,Ce.y+Ye,Ce.z+Ye),h.getTrianglesInAABB(Oe,Ue);const at=Ja,pt=r.radius*r.radius;for(let Pt=0;Pt<Ue.length;Pt++)for(let Nt=0;Nt<3;Nt++)if(h.getVertex(h.indices[3*Ue[Pt]+Nt],at),at.vsub(Ce,je),je.lengthSquared()<=pt){if(Fe.copy(at),U.pointToWorldFrame(y,N,Fe,at),at.vsub(p,je),oe)return!0;let ft=this.createContactEquation(O,T,r,h,z,ee);ft.ni.copy(je),ft.ni.normalize(),ft.ri.copy(ft.ni),ft.ri.scale(r.radius,ft.ri),ft.ri.vadd(p,ft.ri),ft.ri.vsub(O.position,ft.ri),ft.rj.copy(at),ft.rj.vsub(T.position,ft.rj),this.result.push(ft),this.createFrictionEquationsFromContact(ft,this.frictionResult)}for(let Pt=0;Pt<Ue.length;Pt++)for(let Nt=0;Nt<3;Nt++){h.getVertex(h.indices[3*Ue[Pt]+Nt],ne),h.getVertex(h.indices[3*Ue[Pt]+(Nt+1)%3],ve),ve.vsub(ne,xe),Ce.vsub(ve,Ie);const ft=Ie.dot(xe);Ce.vsub(ne,Ie);let $t=Ie.dot(xe);if($t>0&&ft<0&&(Ce.vsub(ne,Ie),Te.copy(xe),Te.normalize(),$t=Ie.dot(Te),Te.scale($t,Ie),Ie.vadd(ne,Ie),Ie.distanceTo(Ce)<r.radius)){if(oe)return!0;const Zt=this.createContactEquation(O,T,r,h,z,ee);Ie.vsub(Ce,Zt.ni),Zt.ni.normalize(),Zt.ni.scale(r.radius,Zt.ri),Zt.ri.vadd(p,Zt.ri),Zt.ri.vsub(O.position,Zt.ri),U.pointToWorldFrame(y,N,Ie,Ie),Ie.vsub(T.position,Zt.rj),U.vectorToWorldFrame(N,Zt.ni,Zt.ni),U.vectorToWorldFrame(N,Zt.ri,Zt.ri),this.result.push(Zt),this.createFrictionEquationsFromContact(Zt,this.frictionResult)}}const St=it,At=xt,Jt=Ut,jt=Qn;for(let Pt=0,Nt=Ue.length;Pt!==Nt;Pt++){h.getTriangleVertices(Ue[Pt],St,At,Jt),h.getNormal(Ue[Pt],jt),Ce.vsub(St,Ie);let ft=Ie.dot(jt);if(jt.scale(ft,Ie),Ce.vsub(Ie,Ie),ft=Ie.distanceTo(Ce),Nr.pointInTriangle(Ie,St,At,Jt)&&ft<r.radius){if(oe)return!0;let $t=this.createContactEquation(O,T,r,h,z,ee);Ie.vsub(Ce,$t.ni),$t.ni.normalize(),$t.ni.scale(r.radius,$t.ri),$t.ri.vadd(p,$t.ri),$t.ri.vsub(O.position,$t.ri),U.pointToWorldFrame(y,N,Ie,Ie),Ie.vsub(T.position,$t.rj),U.vectorToWorldFrame(N,$t.ni,$t.ni),U.vectorToWorldFrame(N,$t.ri,$t.ri),this.result.push($t),this.createFrictionEquationsFromContact($t,this.frictionResult)}}Ue.length=0}planeTrimesh(r,h,p,y,b,N,O,T,z,ee,oe){const ne=new M,ve=wu;ve.set(0,0,1),b.vmult(ve,ve);for(let xe=0;xe<h.vertices.length/3;xe++){h.getVertex(xe,ne);const Te=new M;Te.copy(ne),U.pointToWorldFrame(y,N,Te,ne);const Ce=Sh;if(ne.vsub(p,Ce),ve.dot(Ce)<=0){if(oe)return!0;const Ie=this.createContactEquation(O,T,r,h,z,ee);Ie.ni.copy(ve);const Oe=Tc;ve.scale(Ce.dot(ve),Oe),ne.vsub(Oe,Oe),Ie.ri.copy(Oe),Ie.ri.vsub(O.position,Ie.ri),Ie.rj.copy(ne),Ie.rj.vsub(T.position,Ie.rj),this.result.push(Ie),this.createFrictionEquationsFromContact(Ie,this.frictionResult)}}}}const qr=new M,Ya=new M,yo=new M,fa=new M,xu=new M,Ec=new Z,Zc=new Z;Or.prototype[Ui.boxBox]=Or.prototype.boxBox,Or.prototype[Ui.boxConvex]=Or.prototype.boxConvex,Or.prototype[Ui.boxParticle]=Or.prototype.boxParticle,Or.prototype[Ui.sphereSphere]=Or.prototype.sphereSphere;const wu=new M,Sh=new M,Tc=new M;Or.prototype[Ui.planeTrimesh]=Or.prototype.planeTrimesh;const Qn=new M,Cl=new M,Ja=new M,Ca=new M,Kl=new M,Su=new M,La=new M,bo=new M,Ds=new M,Mc=new M,it=new M,xt=new M,Ut=new M,bn=new ie,qt=[];Or.prototype[Ui.sphereTrimesh]=Or.prototype.sphereTrimesh;const fn=new M,tn=new M;Or.prototype[Ui.spherePlane]=Or.prototype.spherePlane;const qn=new M,jn=new M,Sr=new M;function $r(a,r,h){let p=null;const y=a.length;for(let b=0;b!==y;b++){const N=a[b],O=qn;a[(b+1)%y].vsub(N,O);const T=jn;O.cross(r,T);const z=Sr;h.vsub(N,z);const ee=T.dot(z);if(!(null===p||ee>0&&!0===p||ee<=0&&!1===p))return!1;null===p&&(p=ee>0)}return!0}const yr=new M,Xr=new M,fi=new M,Rr=new M,ts=[new M,new M,new M,new M,new M,new M],lo=new M,Js=new M,Bo=new M,ec=new M;Or.prototype[Ui.sphereBox]=Or.prototype.sphereBox;const Yo=new M,Xi=new M,Ac=new M,Yh=new M,rh=new M,Ap=new M,Eh=new M,cd=new M,Th=new M,Rd=new M;Or.prototype[Ui.sphereConvex]=Or.prototype.sphereConvex,Or.prototype[Ui.planeBox]=Or.prototype.planeBox;const ud=new M,Pr=new M,$c=new M,Zs=new M;Or.prototype[Ui.planeConvex]=Or.prototype.planeConvex;const $p=new M,ar=new M;Or.prototype[Ui.convexConvex]=Or.prototype.convexConvex;const Ll=new M,Mh=new M,Jh=new M;Or.prototype[Ui.planeParticle]=Or.prototype.planeParticle;const ma=new M;Or.prototype[Ui.sphereParticle]=Or.prototype.sphereParticle;const hd=new Z,Ur=new M,Ki=new M,No=new M,$s=new M;Or.prototype[Ui.convexParticle]=Or.prototype.convexParticle,Or.prototype[Ui.boxHeightfield]=Or.prototype.boxHeightfield;const Vr=new M,dl=new M,Cc=[0];Or.prototype[Ui.convexHeightfield]=Or.prototype.convexHeightfield;const ih=new M,Zh=new M;Or.prototype[Ui.sphereHeightfield]=Or.prototype.sphereHeightfield;class Bl{constructor(){this.current=[],this.previous=[]}getKey(r,h){if(h<r){const p=h;h=r,r=p}return r<<16|h}set(r,h){const p=this.getKey(r,h),y=this.current;let b=0;for(;p>y[b];)b++;if(p!==y[b]){for(let N=y.length-1;N>=b;N--)y[N+1]=y[N];y[b]=p}}tick(){const r=this.current;this.current=this.previous,this.previous=r,this.current.length=0}getDiff(r,h){const p=this.current,y=this.previous,b=p.length,N=y.length;let O=0;for(let T=0;T<b;T++){let z=!1;const ee=p[T];for(;ee>y[O];)O++;z=ee===y[O],z||Kn(r,ee)}O=0;for(let T=0;T<N;T++){let z=!1;const ee=y[T];for(;ee>p[O];)O++;z=p[O]===ee,z||Kn(h,ee)}}}function Kn(a,r){a.push((4294901760&r)>>16,65535&r)}class fl{constructor(){this.data={keys:[]}}get(r,h){if(r>h){const p=h;h=r,r=p}return this.data[r+"-"+h]}set(r,h,p){if(r>h){const b=h;h=r,r=b}const y=r+"-"+h;this.get(r,h)||this.data.keys.push(y),this.data[y]=p}reset(){const r=this.data,h=r.keys;for(;h.length>0;)delete r[h.pop()]}}class Un extends W{constructor(r={}){super(),this.dt=-1,this.allowSleep=!!r.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==r.quatNormalizeSkip?r.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==r.quatNormalizeFast&&r.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new M,r.gravity&&this.gravity.copy(r.gravity),this.broadphase=void 0!==r.broadphase?r.broadphase:new vr,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==r.solver?r.solver:new yu,this.constraints=[],this.narrowphase=new Or(this),this.collisionMatrix=new ae,this.collisionMatrixPrevious=new ae,this.bodyOverlapKeeper=new Bl,this.shapeOverlapKeeper=new Bl,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new fl,this.defaultMaterial=new Ju("default"),this.defaultContactMaterial=new Yu(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(r,h){return this.contactMaterialTable.get(r.id,h.id)}numObjects(){return this.bodies.length}collisionMatrixTick(){const r=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=r,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(r){this.constraints.push(r)}removeConstraint(r){const h=this.constraints.indexOf(r);-1!==h&&this.constraints.splice(h,1)}rayTest(r,h,p){p instanceof mi?this.raycastClosest(r,h,{skipBackfaces:!0},p):this.raycastAll(r,h,{skipBackfaces:!0},p)}raycastAll(r,h,p={},y){return p.mode=Nr.ALL,p.from=r,p.to=h,p.callback=y,Nl.intersectWorld(this,p)}raycastAny(r,h,p={},y){return p.mode=Nr.ANY,p.from=r,p.to=h,p.result=y,Nl.intersectWorld(this,p)}raycastClosest(r,h,p={},y){return p.mode=Nr.CLOSEST,p.from=r,p.to=h,p.result=y,Nl.intersectWorld(this,p)}addBody(r){this.bodies.includes(r)||(r.index=this.bodies.length,this.bodies.push(r),r.world=this,r.initPosition.copy(r.position),r.initVelocity.copy(r.velocity),r.timeLastSleepy=this.time,r instanceof dt&&(r.initAngularVelocity.copy(r.angularVelocity),r.initQuaternion.copy(r.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=r,this.idToBodyMap[r.id]=r,this.dispatchEvent(this.addBodyEvent))}removeBody(r){r.world=null;const h=this.bodies.length-1,p=this.bodies,y=p.indexOf(r);if(-1!==y){p.splice(y,1);for(let b=0;b!==p.length;b++)p[b].index=b;this.collisionMatrix.setNumObjects(h),this.removeBodyEvent.body=r,delete this.idToBodyMap[r.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(r){return this.idToBodyMap[r]}getShapeById(r){const h=this.bodies;for(let p=0,y=h.length;p<y;p++){const b=h[p].shapes;for(let N=0,O=b.length;N<O;N++){const T=b[N];if(T.id===r)return T}}}addMaterial(r){this.materials.push(r)}addContactMaterial(r){this.contactmaterials.push(r),this.contactMaterialTable.set(r.materials[0].id,r.materials[1].id,r)}step(r,h=0,p=10){if(0===h)this.internalStep(r),this.time+=r;else{this.accumulator+=h;let y=0;for(;this.accumulator>=r&&y<p;)this.internalStep(r),this.accumulator-=r,y++;const b=this.accumulator%r/r;for(let N=0;N!==this.bodies.length;N++){const O=this.bodies[N];O.previousPosition.lerp(O.position,b,O.interpolatedPosition),O.previousQuaternion.slerp(O.quaternion,b,O.interpolatedQuaternion),O.previousQuaternion.normalize()}this.time+=h}}internalStep(r){this.dt=r;const h=this.contacts,p=sh,y=Na,b=this.numObjects(),N=this.bodies,O=this.solver,T=this.gravity,z=this.doProfiling,ee=this.profile,oe=dt.DYNAMIC;let ne=-1/0;const ve=this.constraints,xe=oh,Te=(T.length(),T.x),Ce=T.y,Ie=T.z;let Oe=0;for(z&&(ne=performance.now()),Oe=0;Oe!==b;Oe++){const jt=N[Oe];if(jt.type===oe){const Pt=jt.force,Nt=jt.mass;Pt.x+=Nt*Te,Pt.y+=Nt*Ce,Pt.z+=Nt*Ie}}for(let jt=0,Pt=this.subsystems.length;jt!==Pt;jt++)this.subsystems[jt].update();z&&(ne=performance.now()),p.length=0,y.length=0,this.broadphase.collisionPairs(this,p,y),z&&(ee.broadphase=performance.now()-ne);let Fe=ve.length;for(Oe=0;Oe!==Fe;Oe++){const jt=ve[Oe];if(!jt.collideConnected)for(let Pt=p.length-1;Pt>=0;Pt-=1)(jt.bodyA===p[Pt]&&jt.bodyB===y[Pt]||jt.bodyB===p[Pt]&&jt.bodyA===y[Pt])&&(p.splice(Pt,1),y.splice(Pt,1))}this.collisionMatrixTick(),z&&(ne=performance.now());const je=Ba,Ue=h.length;for(Oe=0;Oe!==Ue;Oe++)je.push(h[Oe]);h.length=0;const Ye=this.frictionEquations.length;for(Oe=0;Oe!==Ye;Oe++)xe.push(this.frictionEquations[Oe]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(p,y,this,h,je,this.frictionEquations,xe),z&&(ee.narrowphase=performance.now()-ne),z&&(ne=performance.now()),Oe=0;Oe<this.frictionEquations.length;Oe++)O.addEquation(this.frictionEquations[Oe]);const at=h.length;for(let jt=0;jt!==at;jt++){const Pt=h[jt],Nt=Pt.bi,ft=Pt.bj,$t=Pt.si,Zt=Pt.sj;let _n;_n=Nt.material&&ft.material&&this.getContactMaterial(Nt.material,ft.material)||this.defaultContactMaterial;let xn=_n.friction;Nt.material&&ft.material&&(Nt.material.friction>=0&&ft.material.friction>=0&&(xn=Nt.material.friction*ft.material.friction),Nt.material.restitution>=0&&ft.material.restitution>=0&&(Pt.restitution=Nt.material.restitution*ft.material.restitution)),O.addEquation(Pt),Nt.allowSleep&&Nt.type===dt.DYNAMIC&&Nt.sleepState===dt.SLEEPING&&ft.sleepState===dt.AWAKE&&ft.type!==dt.STATIC&&ft.velocity.lengthSquared()+ft.angularVelocity.lengthSquared()>=2*ft.sleepSpeedLimit**2&&(Nt.wakeUpAfterNarrowphase=!0),ft.allowSleep&&ft.type===dt.DYNAMIC&&ft.sleepState===dt.SLEEPING&&Nt.sleepState===dt.AWAKE&&Nt.type!==dt.STATIC&&Nt.velocity.lengthSquared()+Nt.angularVelocity.lengthSquared()>=2*Nt.sleepSpeedLimit**2&&(ft.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set(Nt,ft,!0),this.collisionMatrixPrevious.get(Nt,ft)||(Cp.body=ft,Cp.contact=Pt,Nt.dispatchEvent(Cp),Cp.body=Nt,ft.dispatchEvent(Cp)),this.bodyOverlapKeeper.set(Nt.id,ft.id),this.shapeOverlapKeeper.set($t.id,Zt.id)}for(this.emitContactEvents(),z&&(ee.makeContactConstraints=performance.now()-ne,ne=performance.now()),Oe=0;Oe!==b;Oe++){const jt=N[Oe];jt.wakeUpAfterNarrowphase&&(jt.wakeUp(),jt.wakeUpAfterNarrowphase=!1)}for(Fe=ve.length,Oe=0;Oe!==Fe;Oe++){const jt=ve[Oe];jt.update();for(let Pt=0,Nt=jt.equations.length;Pt!==Nt;Pt++)O.addEquation(jt.equations[Pt])}O.solve(r,this),z&&(ee.solve=performance.now()-ne),O.removeAllEquations();const pt=Math.pow;for(Oe=0;Oe!==b;Oe++){const jt=N[Oe];if(jt.type&oe){const Pt=pt(1-jt.linearDamping,r),Nt=jt.velocity;Nt.scale(Pt,Nt);const ft=jt.angularVelocity;if(ft){const $t=pt(1-jt.angularDamping,r);ft.scale($t,ft)}}}for(this.dispatchEvent(Pd),Oe=0;Oe!==b;Oe++){const jt=N[Oe];jt.preStep&&jt.preStep.call(jt)}z&&(ne=performance.now());const St=this.stepnumber%(this.quatNormalizeSkip+1)==0,At=this.quatNormalizeFast;for(Oe=0;Oe!==b;Oe++)N[Oe].integrate(r,St,At);for(this.clearForces(),this.broadphase.dirty=!0,z&&(ee.integrate=performance.now()-ne),this.time+=r,this.stepnumber+=1,this.dispatchEvent(Pi),Oe=0;Oe!==b;Oe++){const jt=N[Oe],Pt=jt.postStep;Pt&&Pt.call(jt)}let Jt=!0;if(this.allowSleep)for(Jt=!1,Oe=0;Oe!==b;Oe++){const jt=N[Oe];jt.sleepTick(this.time),jt.sleepState!==dt.SLEEPING&&(Jt=!0)}this.hasActiveBodies=Jt}clearForces(){const r=this.bodies,h=r.length;for(let p=0;p!==h;p++){const y=r[p];y.force.set(0,0,0),y.torque.set(0,0,0)}}}new ie;const Nl=new Nr;if(typeof performance>"u"&&(performance={}),!performance.now){let a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),performance.now=()=>Date.now()-a}const Pi={type:"postStep"},Pd={type:"preStep"},Cp={type:dt.COLLIDE_EVENT_NAME,body:null,contact:null},Ba=[],oh=[],sh=[],Na=[];function li(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Zr(a,r){this._keys=new Array(5),this._position=new l.Vector2(0,0),this._positionUpdated=!1,this._delta=new l.Vector2(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new l.Vector2(0,0),this.delta=new l.Vector2(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,this.events=new hn;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new li,this.keys[h]=new li;var p=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){p._wheel=30*b.detail,p._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}),"ontouchstart"in window||navigator.msMaxTouchPoints>0){var y=new l.Vector2(0,0);this.events.add(this.domElement,"touchstart",function(b){var N=b.touches[0];p.updatePosition(N.screenX,N.screenY,0,0),p.updateKey(Zr.LEFT,li.DOWN),y.set(N.screenX,N.screenY)}),this.events.add(this.domElement,"touchend",function(b){p.updateKey(Zr.LEFT,li.UP)}),this.events.add(this.domElement,"touchcancel",function(b){p.updateKey(Zr.LEFT,li.UP)}),this.events.add(document.body,"touchmove",function(b){var N=b.touches[0];p.updatePosition(N.screenX,N.screenY,N.screenX-y.x,N.screenY-y.y),y.set(N.screenX,N.screenY)})}this.events.add(this.domElement,"mousemove",function(b){p.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){p.updateKey(b.which-1,li.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){p.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dragstart",function(b){p.updateKey(b.which-1,li.UP)}),this.events.add(this.domElement,"dblclick",function(b){p._doubleClicked[b.which-1]=!0}),!0!==r&&this.create()}function hn(){this.events=[]}function Qc(){}function ci(){}function _a(){}function Za(){}function Rn(){}Un.prototype.emitContactEvents=(()=>{const a=[],r=[],h={type:"beginContact",bodyA:null,bodyB:null},p={type:"endContact",bodyA:null,bodyB:null},y={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},b={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};return function(){const N=this.hasAnyEventListener("beginContact"),O=this.hasAnyEventListener("endContact");if((N||O)&&this.bodyOverlapKeeper.getDiff(a,r),N){for(let ee=0,oe=a.length;ee<oe;ee+=2)h.bodyA=this.getBodyById(a[ee]),h.bodyB=this.getBodyById(a[ee+1]),this.dispatchEvent(h);h.bodyA=h.bodyB=null}if(O){for(let ee=0,oe=r.length;ee<oe;ee+=2)p.bodyA=this.getBodyById(r[ee]),p.bodyB=this.getBodyById(r[ee+1]),this.dispatchEvent(p);p.bodyA=p.bodyB=null}a.length=r.length=0;const T=this.hasAnyEventListener("beginShapeContact"),z=this.hasAnyEventListener("endShapeContact");if((T||z)&&this.shapeOverlapKeeper.getDiff(a,r),T){for(let ee=0,oe=a.length;ee<oe;ee+=2){const ne=this.getShapeById(a[ee]),ve=this.getShapeById(a[ee+1]);y.shapeA=ne,y.shapeB=ve,y.bodyA=ne.body,y.bodyB=ve.body,this.dispatchEvent(y)}y.bodyA=y.bodyB=y.shapeA=y.shapeB=null}if(z){for(let ee=0,oe=r.length;ee<oe;ee+=2){const ne=this.getShapeById(r[ee]),ve=this.getShapeById(r[ee+1]);b.shapeA=ne,b.shapeB=ve,b.bodyA=ne.body,b.bodyB=ve.body,this.dispatchEvent(b)}b.bodyA=b.bodyB=b.shapeA=b.shapeB=null}}})(),li.DOWN=-1,li.UP=1,li.RESET=0,li.prototype.constructor=li,li.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===li.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===li.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===li.RESET&&(this.justReleased=!1,this.justPressed=!1)},li.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},li.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Zr.prototype=Zr).constructor=Zr,Zr.LEFT=0,Zr.MIDDLE=1,Zr.RIGHT=2,Zr.BACK=3,Zr.FORWARD=4,Zr.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Zr.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Zr.setLock=function(a){null!==this.canvas&&(a?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},Zr.buttonPressed=function(a){return this.keys[a].pressed},Zr.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Zr.buttonJustPressed=function(a){return this.keys[a].justPressed},Zr.buttonJustReleased=function(a){return this.keys[a].justReleased},Zr.updatePosition=function(a,r,h,p){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=p,this._positionUpdated=!0},Zr.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Zr.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Zr.create=function(){this.events.create()},Zr.dispose=function(){this.events.destroy()},hn.prototype.addAndCreate=function(a,r,h){var p=[a,r,h,!0];p[0].addEventListener(p[1],p[2]),p[3]=!0,this.events.push(p)},hn.prototype.remove=function(a,r){for(var h=this.events.length-1;h>=0;h--)this.events[h][0]===a&&this.events[h][1]===r&&(this.events[h][3]&&(this.events[h][0].removeEventListener(this.events[h][1],this.events[h][2]),this.events[h][3]=!1),this.events.splice(h,1))},hn.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},hn.prototype.clear=function(){this.destroy(),this.events=[]},hn.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},hn.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},hn.prototype.addScrollEvent=function(a,r){void 0!==window.onmousewheel?this.add(a,"mousewheel",r):void 0!==window.addEventListener?this.add(a,"DOMMouseScroll",function(h){h.deltaY=30*h.detail,r(h)}):this.add(a,"wheel",r)},Qc.PI2=2*Math.PI,Qc.PID3=Math.PI/3,Qc.PID2=Math.PI/2,Qc.randomColor=function(){for(var a="#",r=0;r<6;r++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a},ci.encoding="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ci.isBase64=function(a){if("string"!=typeof a)return!1;if(a.startsWith("data:"))return!0;for(var r=0;r<a.length;r++)if(!ci.encoding.includes(a.charAt(r)))return!1;return!0},ci.removeHeader=function(a){return a.slice(a.search(";base64,")+8)},ci.getFileFormat=function(a){var r=a.indexOf("/")+1,h=a.indexOf(";");return a.substr(r,h-r)},ci.fromArraybuffer=function(a){for(var r,b,N="",O=new Uint8Array(a),T=O.byteLength%3,z=O.byteLength-T,ee=0;ee<z;ee+=3)r=(16515072&(b=O[ee]<<16|O[ee+1]<<8|O[ee+2]))>>18,N+=ci.encoding[r]+ci.encoding[(258048&b)>>12]+ci.encoding[(4032&b)>>6]+ci.encoding[63&b];return 1===T?(r=(252&(b=O[z]))>>2,N+=ci.encoding[r]+ci.encoding[(3&b)<<4]+"=="):2===T&&(r=(64512&(b=O[z]<<8|O[z+1]))>>10,N+=ci.encoding[r]+ci.encoding[(1008&b)>>4]+ci.encoding[(15&b)<<2]+"="),N},ci.fromBinaryString=function(a){for(var r,h,p,y="",b=a.length%3,N=a.length-b,O=0;O<N;O+=3)r=255&a.charCodeAt(O),h=a.charCodeAt(O+1),p=a.charCodeAt(O+2),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2|(192&p)>>6),y+=ci.encoding.charAt(63&p);return 1===b?(r=255&a.charCodeAt(O),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4),y+="=="):2===b&&(r=255&a.charCodeAt(O),h=a.charCodeAt(O+1),y+=ci.encoding.charAt(r>>2),y+=ci.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ci.encoding.charAt((15&h)<<2),y+="="),y},_a.fromBinaryString=function(a){for(var r=a.length,h=new ArrayBuffer(r),p=new Uint8Array(h),y=0;y<r;y++)p[y]=a.charCodeAt(y);return h},_a.fromBase64=function(a){for(var r,h,p,y,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N=a.length/4*3,O=new ArrayBuffer(N),T=new Uint8Array(O),z=0,ee=0;z<N;z+=3)r=b.indexOf(a.charAt(ee++)),h=b.indexOf(a.charAt(ee++)),p=b.indexOf(a.charAt(ee++)),y=b.indexOf(a.charAt(ee++)),T[z]=r<<2|h>>4,64!==p&&(T[z+1]=(15&h)<<4|p>>2),64!==y&&(T[z+2]=(3&p)<<6|y);return O},_a.fromBuffer=function(a){for(var r=new ArrayBuffer(a.length),h=new Uint8Array(r),p=0;p<a.length;p++)h[p]=a[p];return r},Za.fromArrayBuffer=function(a){for(var r=new Buffer(a.byteLength),h=new Uint8Array(a),p=0;p<r.length;p++)r[p]=h[p];return r};try{Rn.fs=window.require?window.require("fs"):null}catch{}function wi(a,r){this.name=a,this.uuid=l.Math.generateUUID(),this.type=r,this.format="",this.encoding="",this.data=null}function fs(a,r){if(wi.call(this,"image","Image"),this.width=-1,this.height=-1,void 0!==a)if(a instanceof ArrayBuffer)this.loadArrayBufferData(a,r);else if(ci.isBase64(a))this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a;else if(a.startsWith("blob")){var h=Rn.readFileArrayBuffer(a,!0);this.loadArrayBufferData(h)}else this.encoding=Rn.getFileExtension(a),this.format="url",this.data=a;else this.createSolidColor()}function ms(a,r,h,p,y,b,N,O,T,z){this.source="string"==typeof a?new fs(a):void 0===a?new fs:a,l.Texture.call(this,document.createElement("img"),r,h,p,y,b,N,O,T,z);var ee=this;if(this.name="texture",this.category="Image",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.updateSource(),"gif"===this.source.encoding){let oe=function(){ee.disposed||(ee.needsUpdate=!0,requestAnimationFrame(oe))};this.generateMipmaps=!1,this.magFilter=l.LinearFilter,this.minFilter=l.LinearFilter,oe()}}function Cs(a){l.AmbientLight.call(this,a),this.name="ambient",this.matrixAutoUpdate=!1}function ii(a){l.Object3D.call(this),this.name="audio",this.type="Audio",this.listener=new l.AudioListener,this.context=this.listener.context,this.matrixAutoUpdate=!1,this.gain=this.context.createGain(),this.gain.connect(this.listener.getInput()),this.buffer=null,this.filters=[],this.sourceType="empty",this.audio=void 0!==a?a:null,this.autoplay=!0,this.volume=1,this.playbackRate=1,this.startTime=0,this.loop=!0,this.detune=0,this.isPlaying=!1,this.hasPlaybackControl=!0,this.filters=[]}function Tr(a,r,h,p,y,b,N,O,T,z){void 0===r&&(r=l.CubeReflectionMapping);for(var ee=[],oe=0;oe<6;oe++)ee.push(document.createElement("canvas"));l.Texture.call(this,ee,r,h,p,y,b,N,O,T,z),this.images=void 0!==a?a:[],this.size=512,this.flipY=!1,this.mode=6===this.images.length?Tr.CUBE:Tr.CROSS,this.images.length>0&&this.updateImages(),this.name="cubetexture",this.category="Cube"}function br(a,r,h,p){l.Object3D.call(this),this.name="cubecamera",this.type="CubeCamera",this.near=void 0!==a?a:.01,this.far=void 0!==r?r:1e4,this.resolution=void 0!==h?h:256,this.autoUpdate=void 0!==p&&p,this.cameras=[];for(var y=0;y<6;y++){var b=new l.PerspectiveCamera(90,1,this.near,this.far);b.parent=this,this.cameras.push(b)}this.cameras[0].up.set(0,-1,0),this.cameras[0].lookAt(new l.Vector3(1,0,0)),this.cameras[1].up.set(0,-1,0),this.cameras[1].lookAt(new l.Vector3(-1,0,0)),this.cameras[2].up.set(0,0,1),this.cameras[2].lookAt(new l.Vector3(0,1,0)),this.cameras[3].up.set(0,0,-1),this.cameras[3].lookAt(new l.Vector3(0,-1,0)),this.cameras[4].up.set(0,-1,0),this.cameras[4].lookAt(new l.Vector3(0,0,1)),this.cameras[5].up.set(0,-1,0),this.cameras[5].lookAt(new l.Vector3(0,0,-1)),this.renderTarget=new l.WebGLCubeRenderTarget(this.resolution,{format:l.RGBFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter,generateMipmaps:!1});var N=this;Object.defineProperties(this,{cube:{get:function(){return N.renderTarget.texture},set:function(){}}}),this.scene=null,this.renderer=null}function ml(a,r){l.DirectionalLight.call(this,a,r),this.name="directional",this.castShadow=!0,this.shadow.camera.near=.5,this.shadow.camera.far=1e4}Rn.isLocalFile=function(a){return!(a.startsWith("http")||a.startsWith("blob")||a.startsWith("data"))},Rn.readFile=function(a,r,h,p,y){if(void 0===r&&(r=!0),Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a,"utf8");return void 0!==h&&h(b),b}return Rn.fs.readFile(a,"utf8",function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(T)}),null}var N=new XMLHttpRequest;return N.overrideMimeType("text/plain"),N.open("GET",a,!r),void 0!==h&&(N.onload=function(){h(N.response)}),void 0!==p&&(N.onprogress=p),void 0!==y&&(N.onerror=y),N.send(null),!0===r?N.response:null},Rn.readFileArrayBuffer=function(a,r,h,p,y){if(void 0===r&&(r=!0),Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a);return _a.fromBuffer(b)}return Rn.fs.readFile(a,function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(_a.fromBuffer(T))}),null}var N=new XMLHttpRequest;return N.open("GET",a,!r),N.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(N.onload=function(){h(_a.fromBinaryString(N.response))}),void 0!==p&&(N.onprogress=p),void 0!==y&&(N.onerror=y),N.send(null),!0===r?_a.fromBinaryString(N.response):null},Rn.readFileBase64=function(a,r,h,p,y){if(void 0===r&&(r=!0),Rn.fs&&Rn.isLocalFile(a)){if(!0===r){var b=Rn.fs.readFileSync(a);return new Buffer(b).toString("base64")}return Rn.fs.readFile(a,function(O,T){null!==O?void 0!==y&&y(O):void 0!==h&&h(new Buffer(T).toString("base64"))}),null}var N=new XMLHttpRequest;return N.open("GET",a,!r),N.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(N.onload=function(){h(ci.fromBinaryString(N.response))}),void 0!==p&&(N.onprogress=p),void 0!==y&&(N.onerror=y),N.send(null),!0===r?ci.fromBinaryString(N.response):null},Rn.writeFile=function(a,r,h,p){if(Rn.fs)if(void 0!==Rn.fs.writeFileSync)!1!==h?(Rn.fs.writeFileSync(a,r,"utf8"),void 0!==p&&p()):Rn.fs.writeFile(a,r,"utf8",p);else{var y=Rn.fs.createWriteStream(a,"utf8");y.write(r),y.end()}else{var b=new Blob([r],{type:"octet/stream"}),N=document.createElement("a");N.download=a,N.href=window.URL.createObjectURL(b),N.style.display="none",N.onclick=function(){document.body.removeChild(this)},document.body.appendChild(N),N.click(),void 0!==p&&p()}},Rn.writeFileBase64=function(a,r,h,p){if(Rn.fs){var y=Buffer.from(ci.removeHeader(r),"base64");if(void 0!==Rn.fs.writeFile)!1!==h?(Rn.fs.writeFileSync(a,y),void 0!==p&&p()):Rn.fs.writeFile(a,y,p);else{var b=Rn.fs.createWriteStream(a);b.write(y),b.end()}}else{var N=_a.fromBase64(ci.removeHeader(r)),O=new Blob([N]),T=document.createElement("a");T.download=a,T.href=window.URL.createObjectURL(O),T.onclick=function(){document.body.removeChild(this)},T.style.display="none",document.body.appendChild(T),T.click(),void 0!==p&&p()}},Rn.writeFileArrayBuffer=function(a,r,h,p){if(Rn.fs){var y=Za.fromArrayBuffer(r);if(void 0!==Rn.fs.writeFileSync)!1!==h?(Rn.fs.writeFileSync(a,y),void 0!==p&&p()):Rn.fs.writeFile(a,y,p);else{var b=Rn.fs.createWriteStream(a);b.write(y),b.end()}}else{var N=new Blob([r]),O=document.createElement("a");O.download=a,O.href=window.URL.createObjectURL(N),O.onclick=function(){document.body.removeChild(this)},O.style.display="none",document.body.appendChild(O),O.click(),void 0!==p&&p()}},Rn.chooseFileWrite=function(a,r){eo.runningOnDesktop()?Rn.chooseFile(function(h){h.length>0&&a(h[0].path)},r,!0):Rn.chooseFileName(function(h){a(h)},r)},Rn.chooseDirectory=function(){return new Promise(function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",h.nwdirectory=!0,document.body.appendChild(h),h.onchange=function(){a(h.value),document.body.removeChild(h)},h.onerror=r,h.onabort=r,h.click()})},Rn.chooseFile=function(a,r,h,p){var y=document.createElement("input");y.type="file",y.style.display="none",document.body.appendChild(y),void 0!==r&&(y.accept=r),!0===p&&(y.multiple=!0),y.onchange=function(){void 0!==a&&a(y.files),document.body.removeChild(y)},void 0!==h&&(y.nwsaveas=!0!==h?h:"file"),y.click()},Rn.chooseFileName=function(a,r,h){var p=prompt("Save As",void 0!==h?h:"file");null!==p&&(void 0===r||p.endsWith(r)||(p+=r),void 0!==a&&a(p))},Rn.copyFile=function(a,r){Rn.fs&&(void 0!==Rn.fs.copyFileSync?Rn.fs.copyFileSync(a,r):(a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Rn.fs.createReadStream(a).pipe(Rn.fs.createWriteStream(r))))},Rn.makeDirectory=function(a){Rn.fs&&(a.replace(new RegExp("/","g"),"\\"),Rn.fs.mkdirSync(a,{recursive:!0}))},Rn.getFilesDirectory=function(a){if(Rn.fs)try{return a.replace(new RegExp("/","g"),"\\"),Rn.fs.readdirSync(a)}catch{return[]}return[]},Rn.deleteFolder=function(a){Rn.fs&&Rn.fs.existsSync(a)&&(Rn.fs.readdirSync(a).forEach(function(r){var h=a+"/"+r;Rn.fs.lstatSync(h).isDirectory()?Rn.deleteFolder(h):Rn.fs.unlinkSync(h)}),Rn.fs.rmdirSync(a))},Rn.copyFolder=function(a,r){if(Rn.fs){a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Rn.makeDirectory(r);for(var h=Rn.fs.readdirSync(a),p=0;p<h.length;p++){var y=a+"\\"+h[p],b=r+"\\"+h[p],N=Rn.fs.statSync(y);N.isDirectory()?Rn.copyFolder(y,b):N.isSymbolicLink()?Rn.fs.symlinkSync(Rn.fs.readlinkSync(y),b):Rn.copyFile(y,b)}}},Rn.fileExists=function(a){return!!Rn.fs&&(a.replace(new RegExp("/","g"),"\\"),Rn.fs.existsSync(a))},Rn.getFileName=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.lastIndexOf("."))}return""},Rn.getFileNameWithExtension=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.length)}return""},Rn.getNameWithoutExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(0,a.lastIndexOf("."))):""},Rn.getFilePath=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(0,r>h?r+1:h+1)}return""},Rn.getFileExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(a.lastIndexOf(".")+1,a.length).toLowerCase()):""},wi.prototype.export=function(a){"base64"===this.format?Rn.writeFileBase64(a,this.data):"arraybuffer"===this.format?Rn.writeFileArrayBuffer(a,void 0!==this.arraybuffer?this.arraybuffer:this.data):"string"===this.format?Rn.writeFile(a,this.data):"json"===this.format?Rn.writeFile(a,JSON.stringify(this.data)):"url"===this.format&&Rn.writeFileArrayBuffer(a,Rn.readFileArrayBuffer(this.data))},wi.prototype.dispose=function(){},wi.prototype.toJSON=function(a){var r={};return r.name=this.name,r.uuid=this.uuid,r.type=this.type,r},fs.prototype=Object.create(wi.prototype),fs.fileIsImage=function(a){return void 0!==a&&(!!a.type.startsWith("image")||(a=a.name.toLocaleLowerCase()).endsWith("tga")||a.endsWith("dds")||a.endsWith("pvr")||a.endsWith("ktx")||a.endsWith("basis"))},fs.prototype.getImageSize=function(a){if(this.width>-1&&this.height>-1)a(this.width,this.height);else{var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight,a(r.width,r.height)}}},fs.prototype.getImageData=function(a){var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight;var p=document.createElement("canvas");p.width=h.naturalWidth,p.height=h.naturalWidth;var y=p.getContext("2d");y.drawImage(h,0,0,h.width,h.height),a(y.getImageData(0,0,h.width,h.height),r.width,r.height)}},fs.prototype.createSolidColor=function(a){var r=document.createElement("canvas");r.width=1,r.height=1;var h=r.getContext("2d");h.fillStyle=void 0!==a?a:Qc.randomColor(),h.fillRect(0,0,1,1),this.data=r.toDataURL("image/png"),this.format="base64",this.encoding="png"},fs.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),p=new Blob([h],{type:"image/"+r});this.data=URL.createObjectURL(p),this.arraybuffer=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"},fs.prototype.hasTransparency=function(a){if(!0===a&&this.width>-1&&this.height>-1){var r=document.createElement("img"),h=document.createElement("canvas");h.width=r.width,h.height=r.height;var p=h.getContext("2d");p.drawImage(r,0,0,r.width,r.height);for(var y=p.getImageData(0,0,r.width,r.height).data,b=3;b<y.length;b+=4)if(255!==y[b])return!0;return!1}return"png"===this.encoding||"gif"===this.encoding},fs.prototype.compressJPEG=function(a){var r=document.createElement("img");r.src=this.data;var h=document.createElement("canvas");h.width=r.width,h.height=r.height,h.getContext("2d").drawImage(r,0,0,r.width,r.height);var p=this;h.toBlob(function(y){var b=new FileReader;b.onload=function(){p.encoding="jpeg",p.format="arraybuffer",p.data=b.result},b.readAsArrayBuffer(y)},"image/jpeg",void 0!==a?a:.7)},fs.prototype.dispose=function(){"arraybuffer"===this.format&&URL.revokeObjectURL(this.data)},fs.prototype.toJSON=function(a){if(void 0!==a.images[this.uuid])return a.images[this.uuid];var r=wi.prototype.toJSON.call(this,a);return"url"===this.format&&this.loadArrayBufferData(Rn.readFileArrayBuffer(this.data),this.encoding),r.width=this.width,r.height=this.height,r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=_a.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.images[this.uuid]=r,r},ms.prototype=Object.create(l.Texture.prototype),ms.isTexture=!0,ms.prototype.updateSource=function(){if(null!==this.source){var a=this;this.image.crossOrigin="anonymous",this.image.src=this.source.data,this.image.onload=function(){a.needsUpdate=!0},this.image.onerror=function(){console.log("nunuStudio: Failed to load image "+a.source.uuid+" data."),a.source.createSolidColor(),a.image.src=a.source.data,a.needsUpdate=!0}}else console.warn("nunuStudio: Texture source is null."),this.source.createSolidColor(),this.image.src=a.source.data,this.needsUpdate=!0},ms.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0},ms.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r},Cs.prototype=Object.create(l.AmbientLight.prototype),ii.prototype=Object.create(l.Object3D.prototype),ii.SOURCE={EMPTY:"empty",BUFFER:"buffer",NODE:"audioNode"},ii.prototype.onEnded=function(){this.isPlaying=!1},ii.prototype.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},ii.prototype.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},ii.prototype.initialize=function(){if(null!==this.audio){var a=this;this.audio.getAudioBuffer(this.context,function(r){a.setBuffer(r)})}else console.warn("nunuStudio: AudioEmitter audio is null.");this.setVolume(this.volume),this.setPlaybackRate(this.playbackRate),l.Object3D.prototype.initialize.call(this)},ii.prototype.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",!0===this.autoplay&&this.play(),this},ii.prototype.play=function(){if(null!==this.buffer){this.isPlaying&&console.warn("nunuStudio: Audio is already playing, its only possible to control the last playing instance.");var a=this.context.createBufferSource();return a.buffer=this.buffer,a.detune.value=this.detune,a.loop=this.loop,a.onended=this.onEnded.bind(this),a.playbackRate.setValueAtTime(this.playbackRate,this.startTime),a.start(0,this.startTime),this.isPlaying=!0,this.source=a,this.connect()}console.warn("nunuStudio: Audio buffer not ready, audio will not play.")},ii.prototype.pause=function(){return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this},ii.prototype.stop=function(){return this.source.stop(),this.startTime=0,this.isPlaying=!1,this},ii.prototype.setAudio=function(a){this.audio=a,null!==this.buffer&&(this.isPlaying&&this.stop(),this.disconnect());var r=this;this.audio.getAudioBuffer(this.context,function(h){r.setBuffer(h)})},ii.prototype.getVolume=function(){return this.gain.gain.value},ii.prototype.setVolume=function(a){return this.volume=a,this.gain.gain.value=a,this},ii.prototype.setLoop=function(a){return this.loop=a,this.isPlaying&&(this.source.loop=this.loop),this},ii.prototype.setDetune=function(a){return this.detune=a,!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},ii.prototype.getLoop=function(){return this.loop},ii.prototype.setPlaybackRate=function(a){return this.playbackRate=a,this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},ii.prototype.getPlaybackRate=function(){return this.playbackRate},ii.prototype.getFilters=function(){return this.filters},ii.prototype.setFilters=function(a){return a||(a=[]),this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},ii.prototype.getFilter=function(a){return this.getFilters()[void 0!==a?a:0]},ii.prototype.setFilter=function(a){return this.setFilters(a?[a]:[])},ii.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},ii.prototype.getOutput=function(){return this.gain},ii.prototype.dispose=function(){this.isPlaying&&(this.stop(),this.disconnect()),l.Object3D.prototype.dispose.call(this)},ii.prototype.toJSON=function(a){var r=this.audio,h=l.Object3D.prototype.toJSON.call(this,a,function(p,y){r=r.toJSON(p)});return h.object.audio=r.uuid,h.object.volume=this.volume,h.object.autoplay=this.autoplay,h.object.startTime=this.startTime,h.object.playbackRate=this.playbackRate,h.object.loop=this.loop,h},(Tr.prototype=Object.create(l.Texture.prototype)).constructor=Tr,Tr.prototype.isCubeTexture=!0,Tr.RIGHT=0,Tr.LEFT=1,Tr.TOP=2,Tr.BOTTOM=3,Tr.FRONT=4,Tr.BACK=5,Tr.CUBE=20,Tr.CROSS=21,Tr.EQUIRECTANGULAR=22,Tr.prototype.setSize=function(a){a&a-1?console.warn("nunuStudio: CubeTexture new size is not a power of two."):this.size=a},Tr.prototype.setImages=function(a,r){this.mode=void 0!==r?r:Tr.CUBE,this.images=a},Tr.prototype.updateImages=function(){var a=this;if(this.mode===Tr.CUBE)for(var r=0;r<this.images.length;r++)"string"==typeof this.images[r]&&(this.images[r]=new fs(this.images[r])),(h=document.createElement("img")).crossOrigin="anonymous",h.index=r,h.src=this.images[r].data,h.onload=function(){a.image[this.index].width=a.size,a.image[this.index].height=a.size,a.image[this.index].getContext("2d").drawImage(this,0,0,a.size,a.size),a.needsUpdate=!0};else if(this.mode===Tr.CROSS){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var p=this.naturalWidth/4,y=this.naturalHeight/3;a.image[Tr.LEFT].getContext("2d").drawImage(this,0,y,p,y,0,0,a.size,a.size),a.image[Tr.FRONT].getContext("2d").drawImage(this,p,y,p,y,0,0,a.size,a.size),a.image[Tr.RIGHT].getContext("2d").drawImage(this,2*p,y,p,y,0,0,a.size,a.size),a.image[Tr.BACK].getContext("2d").drawImage(this,3*p,y,p,y,0,0,a.size,a.size),a.image[Tr.TOP].getContext("2d").drawImage(this,p,0,p,y,0,0,a.size,a.size),a.image[Tr.BOTTOM].getContext("2d").drawImage(this,p,2*y,p,y,0,0,a.size,a.size),a.needsUpdate=!0}}else if(this.mode===Tr.EQUIRECTANGULAR){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;var h;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var p=document.createElement("canvas");p.width=h.naturalWidth,p.height=h.naturalHeight;var y=p.getContext("2d");y.drawImage(h,0,0);for(var b=y.getImageData(0,0,p.width,p.height),N=0;N<6;N++){var O=Tr.renderEquirectFace(b,N,Math.PI,a.size);a.image[N].getContext("2d").putImageData(O,0,0)}a.needsUpdate=!0}}},Tr.resampleBilinear=function(a,r,h,p,y){for(var b=a.width,N=a.height,O=a.data,T=l.Math.clamp(Math.floor(h),0,b-1),z=l.Math.clamp(Math.ceil(h),0,b-1),ee=h-T,oe=l.Math.clamp(Math.floor(p),0,N-1),ne=l.Math.clamp(Math.ceil(p),0,N-1),ve=p-oe,xe=4*(oe*b+T),Te=4*(oe*b+z),Ce=4*(ne*b+T),Ie=4*(ne*b+z),Oe=0;Oe<3;Oe++)r.data[y+Oe]=Math.ceil((O[xe+Oe]*(1-ee)+O[Te+Oe]*ee)*(1-ve)+(O[Ce+Oe]*(1-ee)+O[Ie+Oe]*ee)*ve)},Tr.renderEquirectFace=function(a,r,h,p){for(var y=new ImageData(p,p),b=Tr.faces[r],N=0;N<p;N++)for(var O=0;O<p;O++){var T=4*(O*p+N);y.data[T+3]=255;var z=b(2*(N+.5)/p-1,2*(O+.5)/p-1),ee=Math.sqrt(z.x*z.x+z.y*z.y+z.z*z.z),oe=l.Math.euclideanModulo(Math.atan2(z.y,z.x)+h,2*Math.PI),ne=Math.acos(z.z/ee),ve=a.width*oe/Math.PI/2-.5,xe=a.height*ne/Math.PI-.5;Tr.resampleBilinear(a,y,ve,xe,T)}return y},Tr.faces=[function(a,r){return new l.Vector3(a,-1,-r)},function(a,r){return new l.Vector3(-a,1,-r)},function(a,r){return new l.Vector3(-r,-a,1)},function(a,r){return new l.Vector3(r,-a,-1)},function(a,r){return new l.Vector3(-1,-a,-r)},function(a,r){return new l.Vector3(1,a,-r)}],Tr.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.size=this.size,r.mode=this.mode,r.images=[],this.mode===Tr.EQUIRECTANGULAR||this.mode===Tr.CROSS){var h=this.images[0].toJSON(a);r.images.push(h.uuid)}else for(var p=0;p<this.images.length;p++)h=this.images[p].toJSON(a),r.images.push(h.uuid);return r},(br.prototype=Object.create(l.Object3D.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.renderer=a.renderer);l.Object3D.prototype.initialize.call(this)},br.prototype.update=function(a){this.autoUpdate&&this.updateCubeMap(this.renderer,this.scene),l.Object3D.prototype.update.call(this,a)},br.prototype.setResolution=function(a){this.resolution=a,this.renderTarget.setSize(a,a)},br.prototype.clear=function(a,r,h,p){for(var y=a.getRenderTarget(),b=0;b<6;b++)a.setRenderTarget(this.renderTarget,b),a.clear(r,h,p);a.setRenderTarget(y)},br.prototype.updateCubeMap=function(a,r){var h=a.autoClear;a.autoClear=!1;var p=a.getRenderTarget(),y=this.renderTarget.texture.generateMipmaps;this.renderTarget.texture.generateMipmaps=!1;for(var b=0;b<6;b++)5===b&&(this.renderTarget.texture.generateMipmaps=y),this.cameras[b].updateMatrixWorld(),a.setRenderTarget(this.renderTarget,b),a.clear(!0,!0,!0),a.render(r,this.cameras[b]);a.autoClear=h,a.setRenderTarget(p)},br.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.near=this.near,r.object.far=this.far,r.object.resolution=this.resolution,r.object.autoUpdate=this.autoUpdate,r},(ml.prototype=Object.create(l.DirectionalLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var Lc,ah,Qa,ns={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function Ci(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Ci.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Ci.FullScreenQuad=(Lc=new l.OrthographicCamera(-1,1,1,-1,0,1),ah=new l.PlaneBufferGeometry(2,2),Qa=function(a){this._mesh=new l.Mesh(ah,a)},Object.defineProperty(Qa.prototype,"material",{get:function(){return this._mesh.material},set:function(a){this._mesh.material=a}}),Object.assign(Qa.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(a){a.render(this._mesh,Lc)}}),Qa);var Qh=function(a,r){Ci.call(this),this.scene=a,this.camera=r,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Qh.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Qh,render:function(a,r,h){var p,y,b=a.getContext(),N=a.state;N.buffers.color.setMask(!1),N.buffers.depth.setMask(!1),N.buffers.color.setLocked(!0),N.buffers.depth.setLocked(!0),this.inverse?(p=0,y=1):(p=1,y=0),N.buffers.stencil.setTest(!0),N.buffers.stencil.setOp(b.REPLACE,b.REPLACE,b.REPLACE),N.buffers.stencil.setFunc(b.ALWAYS,p,4294967295),N.buffers.stencil.setClear(y),N.buffers.stencil.setLocked(!0),a.setRenderTarget(h),this.clear&&a.clear(),a.render(this.scene,this.camera),a.setRenderTarget(r),this.clear&&a.clear(),a.render(this.scene,this.camera),N.buffers.color.setLocked(!1),N.buffers.depth.setLocked(!1),N.buffers.stencil.setLocked(!1),N.buffers.stencil.setFunc(b.EQUAL,1,4294967295),N.buffers.stencil.setOp(b.KEEP,b.KEEP,b.KEEP),N.buffers.stencil.setLocked(!0)}});var Ah=function(){Ci.call(this),this.needsSwap=!1};function Kh(){this.autoClear=!1,this.autoClearColor=!1,this.autoClearStencil=!1,this.autoClearDepth=!1,this.sortObjects=!0,this.clearColor=new l.Color,this.clearAlpha=1}function mr(){this.uuid=l.Math.generateUUID(),this.type="Pass",this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1,this.copyToScreen=!1}function Jo(a,r){mr.call(this),this.type="Shader",this.textureID=void 0!==r?r:"tDiffuse",a instanceof l.ShaderMaterial?(this.uniforms=a.uniforms,this.material=a):a&&(this.uniforms=l.UniformsUtils.clone(a.uniforms),this.material=new l.ShaderMaterial({defines:Object.assign({},a.defines),uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader})),this.createQuadScene()}function _l(){mr.call(this),this.type="Render",this.clear=!0}Ah.prototype=Object.create(Ci.prototype),Object.assign(Ah.prototype,{render:function(a){a.state.buffers.stencil.setLocked(!1),a.state.buffers.stencil.setTest(!1)}}),Kh.prototype.backup=function(a){this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearStencil=a.autoClearStencil,this.autoClearDepth=a.autoClearDepth,this.sortObjects=a.sortObjects,this.clearColor.copy(a.getClearColor()),this.clearAlpha=a.getClearAlpha()},Kh.prototype.restore=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearStencil=this.autoClearStencil,a.autoClearDepth=this.autoClearDepth,a.sortObjects=this.sortObjects,a.setClearColor(this.clearColor),a.setClearAlpha(this.clearAlpha)},mr.RGBALinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat},mr.RGBLinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBFormat},mr.RGBANearest={minFilter:l.NearestFilter,magFilter:l.NearestFilter,format:l.RGBAFormat},mr.prototype.createQuadScene=function(){this.camera=new l.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new l.Scene,this.quad=new l.Mesh(new l.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},mr.prototype.setSize=function(a,r){},mr.prototype.render=function(a,r,h,p,y,b,N){},mr.prototype.dispose=function(){},mr.prototype.toJSON=function(a){var r={};return r.uuid=this.uuid,r.type=this.type,r.clear=this.clear,r.enabled=this.enabled,r.needsSwap=this.needsSwap,r.renderToScreen=this.renderToScreen,r.copyToScreen=this.copyToScreen,r},(Jo.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=h.texture),this.quad.material=this.material,a.setRenderTarget(this.renderToScreen?null:r),this.clear&&a.clear(),a.render(this.scene,this.camera)},(_l.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(b,N)};var kr={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new l.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")};function Ls(a,r,h){mr.call(this),this.type="UnrealBloom",this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;for(var p=0;p<this.nMips;p++){var y;(y=new l.WebGLRenderTarget(0,0,mr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(y),(y=new l.WebGLRenderTarget(0,0,mr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsVertical.push(y)}this.renderTargetBright=new l.WebGLRenderTarget(0,0,mr.RGBALinear),this.renderTargetBright.texture.generateMipmaps=!1;var b=kr;this.highPassUniforms=l.UniformsUtils.clone(b.uniforms),this.materialHighPassFilter=new l.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var N=[3,5,7,9,11];for(p=0;p<this.nMips;p++)this.separableBlurMaterials.push(Ls.getSeperableBlurMaterial(N[p])),this.separableBlurMaterials[p].uniforms.texSize.value=new l.Vector2(0,0);this.compositeMaterial=Ls.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.highPassUniforms.luminosityThreshold.value=void 0!==h?h:.7,this.highPassUniforms.smoothWidth.value=.01,this.compositeMaterial.uniforms.bloomStrength.value=void 0!==a?a:.8,this.compositeMaterial.uniforms.bloomRadius.value=void 0!==r?r:.3,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.compositeMaterial.uniforms.bloomTintColors.value=[new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1)],this.compositeMaterial.needsUpdate=!0,this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.createQuadScene(),this.basic=new l.MeshBasicMaterial,Object.defineProperties(this,{strength:{get:function(){return this.compositeMaterial.uniforms.bloomStrength.value},set:function(O){this.compositeMaterial.uniforms.bloomStrength.value=O}},radius:{get:function(){return this.compositeMaterial.uniforms.bloomRadius.value},set:function(O){this.compositeMaterial.uniforms.bloomRadius.value=O}},threshold:{get:function(){return this.highPassUniforms.luminosityThreshold.value},set:function(O){}},smooth:{get:function(){return this.highPassUniforms.smoothWidth.value},set:function(O){}},bloomFactors:{get:function(){return this.compositeMaterial.uniforms.bloomFactors.value},set:function(O){}},bloomTintColors:{get:function(){return this.compositeMaterial.uniforms.bloomTintColors.value},set:function(O){this.compositeMaterial.uniforms.bloomTintColors.value=O}}})}Ls.prototype=Object.create(mr.prototype),Ls.BlurDirectionX=new l.Vector2(1,0),Ls.BlurDirectionY=new l.Vector2(0,1),Ls.prototype.dispose=function(){for(var a=0;a<this.renderTargetsHorizontal.length;a++)this.renderTargetsHorizontal[a].dispose();for(a=0;a<this.renderTargetsVertical.length;a++)this.renderTargetsVertical[a].dispose();this.renderTargetBright.dispose()},Ls.prototype.setSize=function(a,r){var h=Math.round(a/2),p=Math.round(r/2);this.renderTargetBright.setSize(h,p);for(var y=0;y<this.nMips;y++)this.renderTargetsHorizontal[y].setSize(h,p),this.renderTargetsVertical[y].setSize(h,p),this.separableBlurMaterials[y].uniforms.texSize.value.set(h,p),h=Math.round(h/2),p=Math.round(p/2)},Ls.prototype.render=function(a,r,h,p,y,b,N){a.autoClear=!1,a.setClearColor(new l.Color(0,0,0),0),y&&a.context.disable(a.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=h.texture,a.setRenderTarget(null),a.clear(),a.render(this.scene,this.camera)),this.highPassUniforms.tDiffuse.value=h.texture,this.quad.material=this.materialHighPassFilter,a.setRenderTarget(this.renderTargetBright),a.clear(),a.render(this.scene,this.camera);for(var O=this.renderTargetBright,T=0;T<this.nMips;T++)this.quad.material=this.separableBlurMaterials[T],this.separableBlurMaterials[T].uniforms.colorTexture.value=O.texture,this.separableBlurMaterials[T].uniforms.direction.value=Ls.BlurDirectionX,a.setRenderTarget(this.renderTargetsHorizontal[T]),a.clear(),a.render(this.scene,this.camera),this.separableBlurMaterials[T].uniforms.colorTexture.value=this.renderTargetsHorizontal[T].texture,this.separableBlurMaterials[T].uniforms.direction.value=Ls.BlurDirectionY,a.setRenderTarget(this.renderTargetsVertical[T]),a.clear(),a.render(this.scene,this.camera),O=this.renderTargetsVertical[T];this.quad.material=this.compositeMaterial,a.setRenderTarget(this.renderTargetsHorizontal[0]),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(this.renderToScreen?null:h),a.render(this.scene,this.camera)},Ls.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);r.strength=this.strength,r.radius=this.radius,r.threshold=this.threshold,r.bloomFactors=this.bloomFactors,r.bloomTintColors=[];for(var h=0;h<this.bloomTintColors.length;h++)r.bloomTintColors.push(this.bloomTintColors[h].toArray());return r},Ls.getSeperableBlurMaterial=function(a){return new l.ShaderMaterial({defines:{KERNEL_RADIUS:a,SIGMA:a},uniforms:{colorTexture:{value:null},texSize:{value:new l.Vector2(.5,.5)},direction:{value:new l.Vector2(.5,.5)}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\t#include <common>\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D colorTexture;\n\t\t\tuniform vec2 texSize;\n\t\t\tuniform vec2 direction;\n\t\t\t\n\t\t\tfloat gaussianPdf(in float x, in float sigma)\n\t\t\t{\n\t\t\t\treturn 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\tvec3 diffuseSum = texture2D(colorTexture, vUv).rgb * weightSum;\n\t\t\t\tfor(int i = 1; i < KERNEL_RADIUS; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\tvec3 sample1 = texture2D(colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\tvec3 sample2 = texture2D(colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t}\n\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t}"})},Ls.getCompositeMaterial=function(a){return new l.ShaderMaterial({defines:{NUM_MIPS:a},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D blurTexture1;\n\t\t\tuniform sampler2D blurTexture2;\n\t\t\tuniform sampler2D blurTexture3;\n\t\t\tuniform sampler2D blurTexture4;\n\t\t\tuniform sampler2D blurTexture5;\n\t\t\tuniform sampler2D dirtTexture;\n\t\t\tuniform float bloomStrength;\n\t\t\tuniform float bloomRadius;\n\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\t\t\t\n\t\t\tfloat lerpBloomFactor(const in float factor)\n\t\t\t{\n\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = bloomStrength * (lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv));\n\t\t\t}"})};var lh={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")};function Kc(){Jo.call(this,lh),this.type="Technicolor"}Kc.prototype=Object.create(Jo.prototype);var Bs={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new l.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:"varying vec2 vUv;\n\nvoid main()\n{\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"uniform float cameraNear;\nuniform float cameraFar;\n\n#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n#endif\n\nuniform float radius; // ao radius \nuniform bool onlyAO; // use only ambient occlusion pass?\n\nuniform vec2 size; // texture width, height\nuniform float aoClamp; // depth clamp - reduces haloing at screen edges\n\nuniform float lumInfluence; // how much luminance affects occlusion\n\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\n\nvarying vec2 vUv;\n\n#define DL 2.399963229728653 // PI *(3.0 - sqrt(5.0))\n#define EULER 2.718281828459045\n\n// user variables\nconst int samples = 64; // ao sample count\nconst bool useNoise = true; // use noise instead of pattern for sample dithering\nconst float noiseAmount = 0.0004; // dithering amount\nconst float diffArea = 0.4; // self-shadowing reduction\nconst float gDisplace = 0.4; // gauss bell center\n\n// RGBA depth\n#include <packing>\n\n// generating noise / pattern texture for dithering\nvec2 rand(const vec2 coord)\n{\n\tvec2 noise;\n\n\tif(useNoise)\n\t{\n\t\tfloat nx = dot(coord, vec2(12.9898, 78.233));\n\t\tfloat ny = dot(coord, vec2(12.9898, 78.233) * 2.0);\n\t\tnoise = clamp(fract(43758.5453 * sin(vec2(nx, ny))), 0.0, 1.0);\n\t}\n\telse\n\t{\n\t\tfloat ff = fract(1.0 - coord.s *(size.x / 2.0));\n\t\tfloat gg = fract(coord.t *(size.y / 2.0));\n\t\tnoise = vec2(0.25, 0.75) * vec2(ff) + vec2(0.75, 0.25) * gg;\n\t}\n\n\treturn(noise * 2.0  - 1.0) * noiseAmount;\n}\n\nfloat readDepth(const in vec2 coord) {\n\n\tfloat cameraFarPlusNear = cameraFar + cameraNear;\n\tfloat cameraFarMinusNear = cameraFar - cameraNear;\n\tfloat cameraCoef = 2.0 * cameraNear;\n\n\t#ifdef USE_LOGDEPTHBUF\n\t\tfloat logz = unpackRGBAToDepth(texture2D(tDepth, coord));\n\t\tfloat w = pow(2.0, (logz / logDepthBufFC)) - 1.0;\n\t\tfloat z = (logz / w) + 1.0;\n\t#else\n\t\tfloat z = unpackRGBAToDepth(texture2D(tDepth, coord));\n\t#endif\n\n\treturn cameraCoef /(cameraFarPlusNear - z * cameraFarMinusNear);\n}\n\nfloat compareDepths(const in float depth1, const in float depth2, inout int far)\n{\n\tfloat garea = 8.0; // gauss bell width\n\tfloat diff =(depth1 - depth2) * 100.0; // depth difference (0-100)\n\n\t// reduce left bell width to avoid self-shadowing\n\tif(diff < gDisplace)\n\t{\n\t\tgarea = diffArea;\n\n\t}\n\telse\n\t{\n\t\tfar = 1;\n\t}\n\n\tfloat dd = diff - gDisplace;\n\tfloat gauss = pow(EULER, -2.0 *(dd * dd) /(garea * garea));\n\treturn gauss;\n}\n\nfloat calcAO(float depth, float dw, float dh)\n{\n\tvec2 vv = vec2(dw, dh);\n\tvec2 coord1 = vUv + radius * vv;\n\tvec2 coord2 = vUv - radius * vv;\n\n\tfloat temp1 = 0.0;\n\tfloat temp2 = 0.0;\n\n\tint far = 0;\n\ttemp1 = compareDepths(depth, readDepth(coord1), far);\n\n\t// DEPTH EXTRAPOLATION\n\tif(far > 0)\n\t{\n\t\ttemp2 = compareDepths(readDepth(coord2), depth, far);\n\t\ttemp1 +=(1.0 - temp1) * temp2;\n\t}\n\n\treturn temp1;\n}\n\nvoid main()\n{\n\tvec2 noise = rand(vUv);\n\tfloat depth = readDepth(vUv);\n\n\tfloat tt = clamp(depth, aoClamp, 1.0);\n\n\tfloat w =(1.0 / size.x) / tt +(noise.x *(1.0 - noise.x));\n\tfloat h =(1.0 / size.y) / tt +(noise.y *(1.0 - noise.y));\n\n\tfloat ao = 0.0;\n\n\tfloat dz = 1.0 / float(samples);\n\tfloat l = 0.0;\n\tfloat z = 1.0 - dz / 2.0;\n\n\tfor(int i = 0; i <= samples; i ++)\n\t{\n\t\tfloat r = sqrt(1.0 - z);\n\n\t\tfloat pw = cos(l) * r;\n\t\tfloat ph = sin(l) * r;\n\t\tao += calcAO(depth, pw * w, ph * h);\n\t\tz = z - dz;\n\t\tl = l + DL;\n\t}\n\n\tao /= float(samples);\n\tao = 1.0 - ao;\n\n\tvec3 color = texture2D(tDiffuse, vUv).rgb;\n\n\tvec3 lumcoeff = vec3(0.299, 0.587, 0.114);\n\tfloat lum = dot(color.rgb, lumcoeff);\n\tvec3 luminance = vec3(lum);\n\n\tvec3 final = vec3(color * mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // mix(color * ao, white, luminance)\n\n\tif(onlyAO)\n\t{\n\t\tfinal = vec3(mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // ambient occlusion only\n\t}\n\n\tgl_FragColor = vec4(final, 1.0);\n}"};function Ro(){Jo.call(this,Bs),this.type="SSAO",this.depthMaterial=new l.MeshDepthMaterial,this.depthMaterial.depthPacking=l.RGBADepthPacking,this.depthMaterial.blending=l.NoBlending,this.depthRenderTarget=new l.WebGLRenderTarget(2,2,{minFilter:l.LinearFilter,magFilter:l.LinearFilter}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(2,2),Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(a){this.uniforms.onlyAO.value=a}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(a){this.uniforms.aoClamp.value=a}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(a){this.uniforms.lumInfluence.value=a}}}),this.radius=4,this.onlyAO=!1,this.aoClamp=.25,this.lumInfluence=.7}(Ro.prototype=Object.create(Jo.prototype)).render=function(a,r,h,p,y,b,N){this.uniforms.cameraNear.value=N.near,this.uniforms.cameraFar.value=N.far,b.overrideMaterial=this.depthMaterial,a.setRenderTarget(this.depthRenderTarget),a.clear(!0,!0,!0),a.render(b,N),b.overrideMaterial=null,Jo.prototype.render.call(this,a,r,h,p,y)},Ro.prototype.setSize=function(a,r){this.uniforms.size.value.set(a,r),this.depthRenderTarget.setSize(a,r)},Ro.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.onlyAO=this.onlyAO,r.radius=this.radius,r.aoClamp=this.aoClamp,r.lumInfluence=this.lumInfluence,r};var ep={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new l.Vector2},cameraProjectionMatrix:{value:new l.Matrix4},cameraInverseProjectionMatrix:{value:new l.Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},tc=(["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n"),{uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")});function co(a){void 0===a&&(a=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var r=0;r<256;r++)this.p[r]=Math.floor(256*a.random());for(this.perm=[],r=0;r<512;r++)this.perm[r]=this.p[255&r];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}function Ai(){mr.call(this),this.type="SSAONOH",this.kernel=[],this.noiseTexture=null,this.createQuadScene(),this.depthTexture=new l.DepthTexture,this.depthTexture.type=l.UnsignedShortType,this.depthTexture.minFilter=l.NearestFilter,this.depthTexture.maxFilter=l.NearestFilter,this.normalMaterial=new l.MeshNormalMaterial,this.normalMaterial.blending=l.NoBlending,this.normalRenderTarget=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,depthTexture:this.depthTexture,depthBuffer:!0}),this.ssaoRenderTarget=new l.WebGLRenderTarget(1,1,mr.RGBALinear),this.blurRenderTarget=new l.WebGLRenderTarget(1,1,mr.RGBALinear),this.blurMaterial=new l.ShaderMaterial({defines:Object.assign({},tc.defines),uniforms:l.UniformsUtils.clone(tc.uniforms),vertexShader:tc.vertexShader,fragmentShader:tc.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.ssaoMaterial=new l.ShaderMaterial({defines:Object.assign({},ep.defines),uniforms:l.UniformsUtils.clone(ep.uniforms),vertexShader:ep.vertexShader,fragmentShader:ep.fragmentShader,blending:l.NoBlending}),this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.copyMaterial=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(ns.uniforms),vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:l.DstColorFactor,blendDst:l.ZeroFactor,blendEquation:l.AddEquation,blendSrcAlpha:l.DstAlphaFactor,blendDstAlpha:l.ZeroFactor,blendEquationAlpha:l.AddEquation}),this._kernelSize=0;var a=this;Object.defineProperties(this,{kernelRadius:{get:function(){return a.ssaoMaterial.uniforms.kernelRadius.value},set:function(r){a.ssaoMaterial.uniforms.kernelRadius.value=r}},minDistance:{get:function(){return a.ssaoMaterial.uniforms.minDistance.value},set:function(r){a.ssaoMaterial.uniforms.minDistance.value=r}},maxDistance:{get:function(){return a.ssaoMaterial.uniforms.maxDistance.value},set:function(r){a.ssaoMaterial.uniforms.maxDistance.value=r}},kernelSize:{get:function(){return a._kernelSize},set:function(r){a._kernelSize=r,a.generateSampleKernel(),a.generateRandomKernelRotations(),a.ssaoMaterial.uniforms.tNoise.value=a.noiseTexture,a.ssaoMaterial.uniforms.kernel.value=a.kernel}}}),this.kernelSize=64,this.kernelRadius=8,this.minDistance=.1,this.maxDistance=1e3}co.prototype.dot=function(a,r,h){return a[0]*r+a[1]*h},co.prototype.dot3=function(a,r,h,p){return a[0]*r+a[1]*h+a[2]*p},co.prototype.dot4=function(a,r,h,p,y){return a[0]*r+a[1]*h+a[2]*p+a[3]*y},co.prototype.noise=function(a,r){var h,p,y=(a+r)*(.5*(Math.sqrt(3)-1)),b=Math.floor(a+y),N=Math.floor(r+y),O=(3-Math.sqrt(3))/6,T=(b+N)*O,z=a-(b-T),ee=r-(N-T);z>ee?(h=1,p=0):(h=0,p=1);var oe=z-h+O,ne=ee-p+O,ve=z-1+2*O,xe=ee-1+2*O,Te=255&b,Ce=255&N,Oe=this.perm[Te+h+this.perm[Ce+p]]%12,Fe=this.perm[Te+1+this.perm[Ce+1]]%12,je=.5-z*z-ee*ee,Ue=.5-oe*oe-ne*ne,Ye=.5-ve*ve-xe*xe;return 70*((je<0?0:(je*=je)*je*this.dot(this.grad3[this.perm[Te+this.perm[Ce]]%12],z,ee))+(Ue<0?0:(Ue*=Ue)*Ue*this.dot(this.grad3[Oe],oe,ne))+(Ye<0?0:(Ye*=Ye)*Ye*this.dot(this.grad3[Fe],ve,xe)))},co.prototype.noise3d=function(a,r,h){var p,y,b,N,O,T,z=.3333333333333333*(a+r+h),ee=Math.floor(a+z),oe=Math.floor(r+z),ne=Math.floor(h+z),ve=1/6,xe=(ee+oe+ne)*ve,Te=a-(ee-xe),Ce=r-(oe-xe),Ie=h-(ne-xe);Te>=Ce?Ce>=Ie?(p=1,y=0,b=0,N=1,O=1,T=0):Te>=Ie?(p=1,y=0,b=0,N=1,O=0,T=1):(p=0,y=0,b=1,N=1,O=0,T=1):Ce<Ie?(p=0,y=0,b=1,N=0,O=1,T=1):Te<Ie?(p=0,y=1,b=0,N=0,O=1,T=1):(p=0,y=1,b=0,N=1,O=1,T=0);var Oe=Te-p+ve,Fe=Ce-y+ve,je=Ie-b+ve,Ue=Te-N+2*ve,Ye=Ce-O+2*ve,at=Ie-T+2*ve,pt=Te-1+.5,St=Ce-1+.5,At=Ie-1+.5,Jt=255&ee,jt=255&oe,Pt=255&ne,ft=this.perm[Jt+p+this.perm[jt+y+this.perm[Pt+b]]]%12,$t=this.perm[Jt+N+this.perm[jt+O+this.perm[Pt+T]]]%12,Zt=this.perm[Jt+1+this.perm[jt+1+this.perm[Pt+1]]]%12,_n=.6-Te*Te-Ce*Ce-Ie*Ie,xn=.6-Oe*Oe-Fe*Fe-je*je,wr=.6-Ue*Ue-Ye*Ye-at*at,ir=.6-pt*pt-St*St-At*At;return 32*((_n<0?0:(_n*=_n)*_n*this.dot3(this.grad3[this.perm[Jt+this.perm[jt+this.perm[Pt]]]%12],Te,Ce,Ie))+(xn<0?0:(xn*=xn)*xn*this.dot3(this.grad3[ft],Oe,Fe,je))+(wr<0?0:(wr*=wr)*wr*this.dot3(this.grad3[$t],Ue,Ye,at))+(ir<0?0:(ir*=ir)*ir*this.dot3(this.grad3[Zt],pt,St,At)))},co.prototype.noise4d=function(a,r,h,p){var y,b,N,O,T,z,ee,oe,ne,ve,xe,Te,Ce=this.grad4,Ie=this.simplex,Oe=this.perm,Fe=(Math.sqrt(5)-1)/4,je=(5-Math.sqrt(5))/20,Ue=(a+r+h+p)*Fe,Ye=Math.floor(a+Ue),at=Math.floor(r+Ue),pt=Math.floor(h+Ue),St=Math.floor(p+Ue),At=(Ye+at+pt+St)*je,Jt=a-(Ye-At),jt=r-(at-At),Pt=h-(pt-At),Nt=p-(St-At),ft=(Jt>jt?32:0)+(Jt>Pt?16:0)+(jt>Pt?8:0)+(Jt>Nt?4:0)+(jt>Nt?2:0)+(Pt>Nt?1:0),$t=Jt-(y=Ie[ft][0]>=3?1:0)+je,Zt=jt-(b=Ie[ft][1]>=3?1:0)+je,_n=Pt-(N=Ie[ft][2]>=3?1:0)+je,xn=Nt-(O=Ie[ft][3]>=3?1:0)+je,wr=Jt-(T=Ie[ft][0]>=2?1:0)+2*je,ir=jt-(z=Ie[ft][1]>=2?1:0)+2*je,Hn=Pt-(ee=Ie[ft][2]>=2?1:0)+2*je,lr=Nt-(oe=Ie[ft][3]>=2?1:0)+2*je,Yn=Jt-(ne=Ie[ft][0]>=1?1:0)+3*je,fr=jt-(ve=Ie[ft][1]>=1?1:0)+3*je,zr=Pt-(xe=Ie[ft][2]>=1?1:0)+3*je,xo=Nt-(Te=Ie[ft][3]>=1?1:0)+3*je,po=Jt-1+4*je,wo=jt-1+4*je,Uo=Pt-1+4*je,Hs=Nt-1+4*je,Vs=255&Ye,za=255&at,ja=255&pt,Ga=255&St,ap=Oe[Vs+y+Oe[za+b+Oe[ja+N+Oe[Ga+O]]]]%32,lp=Oe[Vs+T+Oe[za+z+Oe[ja+ee+Oe[Ga+oe]]]]%32,Up=Oe[Vs+ne+Oe[za+ve+Oe[ja+xe+Oe[Ga+Te]]]]%32,Sd=Oe[Vs+1+Oe[za+1+Oe[ja+1+Oe[Ga+1]]]]%32,Uc=.6-Jt*Jt-jt*jt-Pt*Pt-Nt*Nt,up=.6-$t*$t-Zt*Zt-_n*_n-xn*xn,fh=.6-wr*wr-ir*ir-Hn*Hn-lr*lr,il=.6-Yn*Yn-fr*fr-zr*zr-xo*xo,hp=.6-po*po-wo*wo-Uo*Uo-Hs*Hs;return 27*((Uc<0?0:(Uc*=Uc)*Uc*this.dot4(Ce[Oe[Vs+Oe[za+Oe[ja+Oe[Ga]]]]%32],Jt,jt,Pt,Nt))+(up<0?0:(up*=up)*up*this.dot4(Ce[ap],$t,Zt,_n,xn))+(fh<0?0:(fh*=fh)*fh*this.dot4(Ce[lp],wr,ir,Hn,lr))+(il<0?0:(il*=il)*il*this.dot4(Ce[Up],Yn,fr,zr,xo))+(hp<0?0:(hp*=hp)*hp*this.dot4(Ce[Sd],po,wo,Uo,Hs)))},(Ai.prototype=Object.create(mr.prototype)).generateSampleKernel=function(){for(var a=0;a<this._kernelSize;a++){var r=new l.Vector3;r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random(),r.normalize();var h=a/this._kernelSize;h=l.Math.lerp(.1,1,h*h),r.multiplyScalar(h),this.kernel.push(r)}},Ai.prototype.generateRandomKernelRotations=function(){for(var a=new co,r=new Float32Array(16),h=0;h<16;h++){var p=2*Math.random()-1,y=2*Math.random()-1;r[h]=a.noise3d(p,y,0)}this.noiseTexture=new l.DataTexture(r,4,4,l.LuminanceFormat,l.FloatType),this.noiseTexture.wrapS=l.RepeatWrapping,this.noiseTexture.wrapT=l.RepeatWrapping,this.noiseTexture.needsUpdate=!0},Ai.prototype.render=function(a,r,h,p,y,b,N){a.autoClear=!1,a.setClearColor(7829503),a.setClearAlpha(1),b.overrideMaterial=this.normalMaterial,a.setRenderTarget(this.normalRenderTarget),a.clear(!0,!0,!0),a.render(b,N),b.overrideMaterial=null,this.ssaoMaterial.uniforms.tDepth.value=this.depthTexture,this.ssaoMaterial.uniforms.tDiffuse.value=h.texture,this.ssaoMaterial.uniforms.cameraNear.value=N.near,this.ssaoMaterial.uniforms.cameraFar.value=N.far,this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(N.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(N.projectionMatrix),this.renderPass(a,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(a,this.blurMaterial,this.blurRenderTarget),this.renderToScreen?(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,null,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,null,!1)):(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,r,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,r,!1))},Ai.prototype.renderPass=function(a,r,h,p){this.quad.material=r,a.autoClear=!1,a.setRenderTarget(h),p&&a.clear(!0,!0,!0),a.render(this.scene,this.camera)},Ai.prototype.dispose=function(){this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.quad.geometry.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose()},Ai.prototype.setSize=function(a,r){this.ssaoMaterial.uniforms.resolution.value.set(a,r),this.blurMaterial.uniforms.resolution.value.set(a,r),this.normalRenderTarget.setSize(a,r),this.ssaoRenderTarget.setSize(a,r),this.blurRenderTarget.setSize(a,r)},Ai.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.kernelSize=this.kernelSize,r.kernelRadius=this.kernelRadius,r.minDistance=this.minDistance,r.maxDistance=this.maxDistance,r};var Ns={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")};function Rs(){Jo.call(this,Ns),this.type="Sobel"}(Rs.prototype=Object.create(Jo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(a,r)};var Rl={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")};function Po(a,r){Jo.call(this,Rl),this.type="HueSaturation",Object.defineProperties(this,{hue:{get:function(){return this.uniforms.hue.value},set:function(h){this.uniforms.hue.value=h}},saturation:{get:function(){return this.uniforms.saturation.value},set:function(h){this.uniforms.saturation.value=h}}}),this.hue=void 0!==a?a:0,this.saturation=void 0!==r?r:0}(Po.prototype=Object.create(Jo.prototype)).toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.hue=this.hue,r.saturation=this.saturation,r};var Pl={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};function gl(a,r,h,p){mr.call(this),this.type="Film",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(Pl.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Pl.vertexShader,fragmentShader:Pl.fragmentShader});var y=this;Object.defineProperties(this,{grayscale:{get:function(){return y.uniforms.grayscale.value},set:function(b){y.uniforms.grayscale.value=b}},noiseIntensity:{get:function(){return y.uniforms.nIntensity.value},set:function(b){y.uniforms.nIntensity.value=b}},scanlinesIntensity:{get:function(){return y.uniforms.sIntensity.value},set:function(b){y.uniforms.sIntensity.value=b}},scanlinesCount:{get:function(){return y.uniforms.sCount.value},set:function(b){y.uniforms.sCount.value=b}}}),this.grayscale=void 0!==p&&p,this.noiseIntensity=void 0!==a?a:.35,this.scanlinesIntensity=void 0!==r?r:.5,this.scanlinesCount=void 0!==h?h:512}(gl.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){this.uniforms.time.value+=p,this.uniforms.tDiffuse.value=h.texture,this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},gl.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.grayscale=this.grayscale,r.noiseIntensity=this.noiseIntensity,r.scanlinesIntensity=this.scanlinesIntensity,r.scanlinesCount=this.scanlinesCount,r};var nc={uniforms:{tDiffuse:{value:null},tSize:{value:new l.Vector2(256,256)},center:{value:new l.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};function Bc(a,r,h){mr.call(this),this.type="DotScreen",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(nc.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:nc.vertexShader,fragmentShader:nc.fragmentShader}),Object.defineProperties(this,{center:{get:function(){return this.uniforms.center.value},set:function(p){this.uniforms.center.value=p}},angle:{get:function(){return this.uniforms.angle.value},set:function(p){this.uniforms.angle.value=p}},scale:{get:function(){return this.uniforms.scale.value},set:function(p){this.uniforms.scale.value=p}}}),void 0!==a&&this.center.copy(a),this.angle=void 0!==r?r:.5,this.scale=void 0!==h?h:.8}function eu(){Jo.call(this,ns),this.type="Copy"}(Bc.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){this.uniforms.tDiffuse.value=h.texture,this.uniforms.tSize.value.set(h.width,h.height),this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},Bc.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.center=this.center.toArray(),r.angle=this.angle,r.scale=this.scale,r},eu.prototype=Object.create(Jo.prototype);var hr={uniforms:{tDiffuse:{value:null},color:{value:new l.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")};function Lp(){Jo.call(this,hr),this.type="Colorify",Object.defineProperties(this,{color:{get:function(){return this.uniforms.color.value},set:function(a){this.uniforms.color.value=a}}})}(Lp.prototype=Object.create(Jo.prototype)).toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.color=this.color.getHex(),r};var Ra={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")};function Ka(a,r,h){mr.call(this),this.type="Bokeh",this.renderTargetColor=new l.WebGLRenderTarget(0,0,mr.RGBLinear),this.renderTargetDepth=this.renderTargetColor.clone(),this.materialDepth=new l.MeshDepthMaterial,this.materialDepth.depthPacking=l.RGBADepthPacking,this.materialDepth.blending=l.NoBlending,this.uniforms=l.UniformsUtils.clone(Ra.uniforms),this.uniforms.tDepth.value=this.renderTargetDepth.texture,this.materialBokeh=new l.ShaderMaterial({defines:Ra.defines,uniforms:this.uniforms,vertexShader:Ra.vertexShader,fragmentShader:Ra.fragmentShader}),this.createQuadScene(),this.quad.material=this.materialBokeh;var p=this;Object.defineProperties(this,{aperture:{get:function(){return p.uniforms.aperture.value},set:function(y){p.uniforms.aperture.value=y}},focus:{get:function(){return p.uniforms.focus.value},set:function(y){p.uniforms.focus.value=y}},maxblur:{get:function(){return p.uniforms.maxblur.value},set:function(y){p.uniforms.maxblur.value=y}}}),this.focus=void 0!==a?a:1,this.aperture=void 0!==r?r:1,this.maxblur=void 0!==h?h:.2}(Ka.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){b.overrideMaterial=this.materialDepth,a.autoClear=!1,a.setClearColor(16777215),a.setClearAlpha(1),a.setRenderTarget(this.renderTargetDepth),a.clear(!0,!0,!0),a.render(b,N),this.uniforms.tColor.value=h.texture,this.uniforms.nearClip.value=N.near,this.uniforms.farClip.value=N.far,this.uniforms.aspect.value=N.aspect,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera),b.overrideMaterial=null},Ka.prototype.setSize=function(a,r){this.renderTargetColor.setSize(a,r),this.renderTargetDepth.setSize(a,r)},Ka.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.aperture=this.aperture,r.focus=this.focus,r.maxblur=this.maxblur,r};var Il={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new l.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){var h,p,y,b,O,T,N=2*Math.ceil(3*a)+1;for(N>25&&(N=25),b=.5*(N-1),p=new Array(N),y=0,h=0;h<N;++h)p[h]=(O=h-b,T=a,Math.exp(-O*O/(2*T*T))),y+=p[h];for(h=0;h<N;++h)p[h]/=y;return p}};function Fr(a,r,h,p){mr.call(this),this.type="Bloom",this.copyToScreen=!0,this.createQuadScene(),a=void 0!==a?a:1,r=void 0!==r?r:25,h=void 0!==h?h:4,this.renderTargetX=new l.WebGLRenderTarget(p=void 0!==p?p:256,p,mr.RGBALinear),this.renderTargetY=new l.WebGLRenderTarget(p,p,mr.RGBALinear),this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.AdditiveBlending,transparent:!0}),this.convolutionUniforms=l.UniformsUtils.clone(Il.uniforms),this.convolutionUniforms.uImageIncrement.value=Fr.blurX,this.convolutionUniforms.cKernel.value=Il.buildKernel(h),this.materialConvolution=new l.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:Il.vertexShader,fragmentShader:Il.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}})}Fr.blurX=new l.Vector2(.001953125,0),Fr.blurY=new l.Vector2(0,.001953125),(Fr.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){y&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=h.texture,this.convolutionUniforms.uImageIncrement.value=Fr.blurX,a.setRenderTarget(this.renderTargetX),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Fr.blurY,a.setRenderTarget(this.renderTargetY),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(r),a.render(this.scene,this.camera)},Fr.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.strength=this.strength,r.kernelSize=this.kernelSize,r.sigma=this.sigma,r.resolution=this.resolution,r};var Nc={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function qp(){Jo.call(this,Nc),this.type="FXAA"}(qp.prototype=Object.create(Jo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(1/a,1/r)};var Eu={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")};function ui(a){mr.call(this),this.type="Afterimage",this.uniforms=l.UniformsUtils.clone(Eu.uniforms),this.textureComp=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.textureOld=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.shaderMaterial=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Eu.vertexShader,fragmentShader:Eu.fragmentShader}),this.basicMaterial=new l.MeshBasicMaterial,this.createQuadScene(),Object.defineProperties(this,{damp:{get:function(){return this.uniforms.damp.value},set:function(r){this.uniforms.damp.value=r}}}),this.damp=void 0!==a?a:.96}(ui.prototype=Object.create(mr.prototype)).render=function(a,r,h,p,y,b,N){var O=this.textureOld;this.textureOld=this.textureComp,this.textureComp=O,this.uniforms.tNew.value=h.texture,this.uniforms.tOld.value=this.textureOld.texture,this.quad.material=this.shaderMaterial,a.autoClear=!1,a.setRenderTarget(this.textureComp),a.render(this.scene,this.camera),this.basicMaterial.map=this.textureComp.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,this.quad.material=this.basicMaterial,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},ui.prototype.setSize=function(a,r){this.textureComp.setSize(a,r),this.textureOld.setSize(a,r)},ui.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.damp=this.damp,r};var sr={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},Ol={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")};function tu(a,r){mr.call(this);var h=this;this.type="AdaptiveToneMapping",this.needsInit=!0,this.resolution=void 0!==r?r:256,this._adaptive=void 0===a||a,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,this.copyUniforms=l.UniformsUtils.clone(ns.uniforms),this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ns.vertexShader,fragmentShader:ns.fragmentShader,blending:l.NoBlending,depthTest:!1}),this.materialLuminance=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(sr.uniforms),vertexShader:sr.vertexShader,fragmentShader:sr.fragmentShader,blending:l.NoBlending}),this.createShader(),void 0===Ol&&console.error("nunuStudio: AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(Ol.uniforms),vertexShader:Ol.vertexShader,fragmentShader:Ol.fragmentShader,blending:l.NoBlending}),this.createQuadScene(),Object.defineProperties(this,{minLuminance:{get:function(){return h.adaptLuminanceShader.uniforms.minLuminance.value},set:function(p){h.adaptLuminanceShader.uniforms.minLuminance.value=p}},tau:{get:function(){return h.adaptLuminanceShader.uniforms.tau.value},set:function(p){h.adaptLuminanceShader.uniforms.tau.value=p}},adaptive:{get:function(){return h._adaptive},set:function(p){p?(this._adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this._adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}}})}function Mo(){this.uuid=l.Math.generateUUID(),this.width=1,this.height=1,this.passes=[],this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.copyPass=new Jo(ns),this.rendererState=new Kh}function Vn(a){this.keys=[],this.actions=[];var r=this,h=this.actions;this.events=new hn,this.events.add(window,"keydown",function(p){h.push(p.keyCode),h.push(li.DOWN)}),this.events.add(window,"keyup",function(p){h.push(p.keyCode),h.push(li.UP)}),this.events.add(window,"focus",function(p){r.reset()}),!0!==a&&this.create()}function nu(){l.Group.call(this),this.name="controls",this.type="FirstPersonControls",this.sensitivity=.005,this.needsButtonPressed=!0,this.movementEnabled=!0,this.moveSpeed=.05,this.moveOnPlane=!1,this.moveKeys=[Vn.W,Vn.S,Vn.A,Vn.D],this.vector=new l.Vector2(0,0),this.mouse=null,this.keyboard=null,this.tempVector=new l.Vector3}function Tu(){l.Group.call(this),this.name="group",this.type="Group"}function vl(a){l.Object3D.call(this),this.element=a,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)});var r=this,h=!0;Object.defineProperties(this,{visible:{get:function(){return h},set:function(p){h=p,r.element.style.display=p?"block":"none"}}})}function rc(a){var r=document.createElement("iframe");r.style.border="none",vl.call(this,r),this.type="HTMLView",this.name="webview";var h,p,y=this;Object.defineProperties(this,{url:{get:function(){return a},set:function(b){a=void 0!==b?rc.processURL(b):"",y.element.src=a}},width:{get:function(){return h},set:function(b){y.element.style.width=(h=b)+"px"}},height:{get:function(){return p},set:function(b){y.element.style.height=(p=b)+"px"}}}),this.width=512,this.height=512,this.url=void 0!==a?a:""}function Mu(a,r,h){l.HemisphereLight.call(this,a,r,h),this.name="hemisphere"}function Qs(a,r,h){l.InstancedMesh.call(this,a,r,h),this.name="instanced",this.type="InstancedMesh",this.receiveShadow=!0,this.castShadow=!0,Object.defineProperties(this,{count:{get:function(){return h},set:function(p){p>h&&(this.instanceMatrix=new l.BufferAttribute(new Float32Array(16*p),16)),h=p}}})}(tu.prototype=Object.create(mr.prototype)).constructor=tu,tu.prototype.render=function(a,r,h,p,y){this.needsInit&&(this.reset(),this.luminanceRT.texture.type=h.texture.type,this.previousLuminanceRT.texture.type=h.texture.type,this.currentLuminanceRT.texture.type=h.texture.type,this.needsInit=!1),this._adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=h.texture,a.setRenderTarget(this.currentLuminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=p,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,a.setRenderTarget(this.luminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,a.setRenderTarget(this.previousLuminanceRT),a.render(this.scene,this.camera)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=h.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},tu.prototype.createShader=function(){this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\t\tvoid main(){\n\t\t\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\n\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\n\t\tuniform sampler2D lastLum;\n\t\tuniform sampler2D currentLum;\n\t\tuniform float minLuminance;\n\t\tuniform float delta;\n\t\tuniform float tau;\n\t\t\n\t\tvoid main()\n\t\t{\n\t\t\tvec4 lastLum = texture2D(lastLum, vUv, MIP_LEVEL_1X1);\n\t\t\tvec4 currentLum = texture2D(currentLum, vUv, MIP_LEVEL_1X1);\n\t\t\t\n\t\t\tfloat fLastLum = max(minLuminance, lastLum.r);\n\t\t\tfloat fCurrentLum = max(minLuminance, currentLum.r);\n\t\t\t\n\t\t\t// The adaption seems to work better in extreme lighting differences if the input luminance is squared.\t\t\tfCurrentLum *= fCurrentLum;\n\t\t\t\n\t\t\t// Adapt the luminance using Pattanaik's technique\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t}"},this.materialAdaptiveLum=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:this.adaptLuminanceShader.defines,blending:l.NoBlending})},tu.prototype.reset=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,mr.RGBALinear),this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,mr.RGBALinear),this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,{minFilter:l.LinearMipMapLinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat}),this._adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new l.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},tu.prototype.dispose=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()},tu.prototype.toJSON=function(a){var r=mr.prototype.toJSON.call(this,a);return r.minLuminance=this.minLuminance,r.tau=this.tau,r.adaptive=this._adaptive,r},Mo.bufferParameters={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,stencilBuffer:!1},Mo.prototype.swapBuffers=function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},Mo.prototype.addPass=function(a){this.passes.push(a)},Mo.prototype.moveBack=function(a){var r=this.passes.indexOf(a);if(r>0){for(var h=r;h!==r-1;h-=1)this.passes[h]=this.passes[h-1];return this.passes[r-1]=a,!0}return!1},Mo.prototype.moveForward=function(a){var r=this.passes.indexOf(a);if(-1!==r&&r<this.passes.length-1){for(var h=r;h!==r+1;h+=1)this.passes[h]=this.passes[h+1];return this.passes[r+1]=a,!0}return!1},Mo.prototype.removePass=function(a){var r=this.passes.indexOf(a);-1!==r&&this.passes.splice(r,1)},Mo.prototype.insertPass=function(a,r){this.passes.splice(r,0,a)},Mo.prototype.render=function(a,r,h,p){var y=!1;this.rendererState.backup(a);for(var b=0;b<this.passes.length;b++){var N=this.passes[b];if(N.enabled){if(N.render(a,this.writeBuffer,this.readBuffer,p,y,r,h),N.renderToScreen){N.copyToScreen&&(this.copyPass.renderToScreen=!0,this.copyPass.render(a,this.readBuffer,this.writeBuffer,p));break}N.needsSwap&&(y&&(a.context.stencilFunc(a.context.NOTEQUAL,1,4294967295),this.copyPass.renderToScreen=!1,this.copyPass.render(a,this.writeBuffer,this.readBuffer,p),a.context.stencilFunc(a.context.EQUAL,1,4294967295)),this.swapBuffers()),void 0!==Qh&&(N instanceof Qh?y=!0:N instanceof Ah&&(y=!1))}}this.rendererState.restore(a)},Mo.prototype.setSize=function(a,r){a=Math.floor(a),r=Math.floor(r),this.width=a,this.height=r,this.writeBuffer.setSize(a,r),this.readBuffer.setSize(a,r);for(var h=0;h<this.passes.length;h++)this.passes[h].setSize(a,r)},Mo.prototype.reset=function(){this.dispose(),this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters)},Mo.prototype.dispose=function(){this.writeBuffer.dispose(),this.readBuffer.dispose(),this.writeBuffer=null,this.readBuffer=null},Mo.prototype.toJSON=function(){var a={};a.uuid=this.uuid,a.passes=[];for(var r=0;r<this.passes.length;r++)a.passes.push(this.passes[r].toJSON());return a},Mo.fromJSON=function(a){var r=new Mo;r.uuid=a.uuid;for(var h=0;h<a.passes.length;h++){var p=a.passes[h],y=null;if("Render"===p.type)y=new _l;else if("UnrealBloom"===p.type)for((y=new Ls).strength=p.strength,y.radius=p.radius,y.threshold=p.threshold,y.bloomFactors=p.bloomFactors,h=0;h<y.bloomTintColors.length;h++)y.bloomTintColors[h].fromArray(p.bloomTintColors[h]);else"Bloom"===p.type?y=new Fr(p.strength,p.kernelSize,p.sigma,p.resolution):"SSAONOH"===p.type?((y=new Ai).kernelRadius=p.kernelRadius,y.minDistance=p.minDistance,y.maxDistance=p.maxDistance,y.kernelSize=p.kernelSize):"SSAO"===p.type?((y=new Ro).onlyAO=p.onlyAO,y.radius=p.radius,y.aoClamp=p.aoClamp,y.lumInfluence=p.lumInfluence):"Bokeh"===p.type?y=new Ka(p.focus,p.aperture,p.maxblur):"FXAA"===p.type?y=new qp:"Copy"===p.type?y=new eu:"Film"===p.type?((y=new gl).grayscale=p.grayscale,y.noiseIntensity=p.noiseIntensity,y.scanlinesIntensity=p.scanlinesIntensity,y.scanlinesCount=p.scanlinesCount):"DotScreen"===p.type?((y=new Bc).center.fromArray(p.center),y.angle=p.angle,y.scale=p.scale):"Colorify"===p.type?(y=new Lp).color.setHex(p.color):"Sobel"===p.type?y=new Rs:"Technicolor"===p.type?y=new Kc:"HueSaturation"===p.type?((y=new Po).hue=p.hue,y.saturation=p.saturation):"AdaptiveToneMapping"===p.type?((y=new tu(p.adaptive)).tau=p.tau,y.minLuminance=p.minLuminance):"Afterimage"===p.type?(y=new ui).damp=p.damp:y=new _l;y.uuid=p.uuid,y.enabled=p.enabled,y.needsSwap=p.needsSwap,y.renderToScreen=p.renderToScreen,y.clear=p.clear,y.copyToScreen=!0===p.copyToScreen,r.addPass(y)}return r},(Vn.prototype=Vn).constructor=Vn,Vn.update=function(){for(var a=0;this.actions.length>a;){var r=this.actions.shift(),h=this.actions.shift();void 0===this.keys[r]&&(this.keys[r]=new li),this.keys[r].update(h),(this.keys[r].justReleased||this.keys[r].justPressed)&&(this.actions.push(r),this.actions.push(li.RESET),a+=2)}},Vn.reset=function(){for(var a=0;a<this.keys.length;a++)void 0!==this.keys[a]&&this.keys[a].reset()},Vn.keyPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].pressed},Vn.keyJustPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].justPressed},Vn.keyJustReleased=function(a){return void 0!==this.keys[a]&&this.keys[a].justReleased},Vn.create=function(){this.events.create()},Vn.dispose=function(){this.events.destroy()},Vn.TAB=9,Vn.ENTER=13,Vn.SHIFT=16,Vn.CTRL=17,Vn.ALT=18,Vn.CAPS_LOCK=20,Vn.ESC=27,Vn.SPACEBAR=32,Vn.PAGE_UP=33,Vn.PAGE_DOWN=34,Vn.END=35,Vn.HOME=36,Vn.INSERT=45,Vn.DEL=46,Vn.LEFT=37,Vn.RIGHT=39,Vn.UP=38,Vn.DOWN=40,Vn.NUM0=48,Vn.NUM1=49,Vn.NUM2=50,Vn.NUM3=51,Vn.NUM4=52,Vn.NUM5=53,Vn.NUM6=54,Vn.NUM7=55,Vn.NUM8=56,Vn.NUM9=57,Vn.A=65,Vn.B=66,Vn.C=67,Vn.D=68,Vn.E=69,Vn.F=70,Vn.G=71,Vn.H=72,Vn.I=73,Vn.J=74,Vn.K=75,Vn.L=76,Vn.M=77,Vn.N=78,Vn.O=79,Vn.P=80,Vn.Q=81,Vn.R=82,Vn.S=83,Vn.T=84,Vn.U=85,Vn.V=86,Vn.W=87,Vn.X=88,Vn.Y=89,Vn.Z=90,Vn.F1=112,Vn.F2=113,Vn.F3=114,Vn.F4=115,Vn.F5=116,Vn.F6=117,Vn.F7=118,Vn.F8=119,Vn.F9=120,Vn.F10=121,Vn.F11=122,Vn.F12=123,nu.UP=new l.Vector3(0,1,0),(nu.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof hi&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.updateControls(),l.Group.prototype.initialize.call(this)},nu.prototype.update=function(a){if(this.needsButtonPressed&&!this.mouse.buttonPressed(Zr.LEFT)||(this.vector.y-=this.sensitivity*this.mouse.delta.y,this.vector.x-=this.sensitivity*this.mouse.delta.x,this.vector.y<-1.57?this.vector.y=-1.57:this.vector.y>1.57&&(this.vector.y=1.57),this.updateControls()),this.movementEnabled){if(this.keyboard.keyPressed(this.moveKeys[0])){var r=this.getWorldDirection(this.tempVector);this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)}this.keyboard.keyPressed(this.moveKeys[1])&&(r=this.getWorldDirection(this.tempVector),this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.add(r)),this.keyboard.keyPressed(this.moveKeys[2])&&((r=new l.Vector3(Math.sin(this.vector.x-1.57),0,Math.cos(this.vector.x-1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)),this.keyboard.keyPressed(this.moveKeys[3])&&((r=new l.Vector3(Math.sin(this.vector.x+1.57),0,Math.cos(this.vector.x+1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r))}l.Object3D.prototype.update.call(this,a)},nu.prototype.updateControls=function(){var a=Math.cos(this.vector.y),r=new l.Vector3(Math.sin(this.vector.x)*a,Math.sin(this.vector.y),Math.cos(this.vector.x)*a);r.add(this.position);var h=new l.Matrix4;h.lookAt(this.position,r,nu.UP),this.quaternion.setFromRotationMatrix(h)},nu.prototype.getDirection=function(){var a=this.getWorldDirection(this.tempVector);return a.normalize(),a},nu.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.moveSpeed=this.moveSpeed,r.object.sensitivity=this.sensitivity,r.object.needsButtonPressed=this.needsButtonPressed,r.object.movementEnabled=this.movementEnabled,r.object.moveOnPlane=this.moveOnPlane,r.object.moveKeys=this.moveKeys,r},(Tu.prototype=Object.create(l.Group.prototype)).constructor=Tu,(vl.prototype=Object.create(l.Object3D.prototype)).constructor=vl,vl.prototype.isCSS3DObject=!0,(rc.prototype=Object.create(vl.prototype)).constructor=rc,rc.processURL=function(a){return a.replace("watch?v=","embed/")},rc.prototype.toJSON=function(a){var r=vl.prototype.toJSON.call(this,a);return r.object.height=this.height,r.object.width=this.width,r.object.url=this.url,r},Mu.prototype=Object.create(l.HemisphereLight.prototype),(Qs.prototype=Object.create(l.InstancedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Qs.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.instanceMatrix=this.instanceMatrix.toJSON(),r.object.count=this.count,r};var gs=function(){l.Mesh.call(this,gs.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var a=new l.Vector3,r=new l.Vector3,h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping;var p=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);p.minFilter=l.NearestFilter,p.magFilter=l.NearestFilter,p.wrapS=l.ClampToEdgeWrapping,p.wrapT=l.ClampToEdgeWrapping;var y=gs.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),N=new l.RawShaderMaterial({uniforms:{map:{value:h},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),O=new l.Mesh(y,b),T=[],z=ga.Shader,ee=new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:p},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:z.vertexShader,fragmentShader:z.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1}),oe=new l.Mesh(y,ee);this.addElement=function(Ce){T.push(Ce)};var ne=new l.Vector2,ve=new l.Vector2,xe=new l.Box2,Te=new l.Vector4;this.onBeforeRender=function(Ce,Ie,Oe){Ce.getCurrentViewport(Te);var Fe=Te.w/Te.z,je=Te.z/2,Ue=Te.w/2,Ye=16/Te.w;if(ne.set(Ye*Fe,Ye),xe.min.set(Te.x,Te.y),xe.max.set(Te.x+(Te.z-16),Te.y+(Te.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(Oe.matrixWorldInverse),!(r.z>0)&&(a.copy(r).applyMatrix4(Oe.projectionMatrix),ve.x=Te.x+a.x*je+je-8,ve.y=Te.y+a.y*Ue+Ue-8,xe.containsPoint(ve))){Ce.copyFramebufferToTexture(ve,h),(Jt=b.uniforms).scale.value=ne,Jt.screenPosition.value=a,Ce.renderBufferDirect(Oe,null,y,b,O,null),Ce.copyFramebufferToTexture(ve,p),(Jt=N.uniforms).scale.value=ne,Jt.screenPosition.value=a,Ce.renderBufferDirect(Oe,null,y,N,O,null);for(var at=2*-a.x,pt=2*-a.y,St=0,At=T.length;St<At;St++){var Jt,jt=T[St];(Jt=ee.uniforms).color.value.copy(jt.color),Jt.map.value=jt.texture,Jt.screenPosition.value.x=a.x+at*jt.distance,Jt.screenPosition.value.y=a.y+pt*jt.distance,Jt.scale.value.set((Ye=jt.size/Te.w)*(Fe=Te.w/Te.z),Ye),ee.uniformsNeedUpdate=!0,Ce.renderBufferDirect(Oe,null,y,ee,oe,null)}}},this.dispose=function(){b.dispose(),N.dispose(),ee.dispose(),h.dispose(),p.dispose();for(var Ce=0,Ie=T.length;Ce<Ie;Ce++)T[Ce].texture.dispose()}};gs.prototype=Object.create(l.Mesh.prototype),gs.prototype.constructor=gs,gs.prototype.isLensflare=!0;var a,r,h,ga=function(a,r,h,p){this.texture=a,this.size=r||1,this.distance=h||0,this.color=p||new l.Color(16777215)};function ch(){l.Mesh.call(this,gs.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.name="lensflare",this.type="LensFlare",this.renderOrder=1/0,this.frustumCulled=!1,this.receiveShadow=!1,this.castShadow=!1,this.elements=[];var a=new l.Vector3,r=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);r.minFilter=l.NearestFilter,r.magFilter=l.NearestFilter,r.wrapS=l.ClampToEdgeWrapping,r.wrapT=l.ClampToEdgeWrapping,r.needsUpdate=!0;var h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping,h.needsUpdate=!0;var y,p=gs.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),N=new l.RawShaderMaterial({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUV = uv;\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tuniform sampler2D map;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = texture2D(map, vUV);\n\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),O=new l.Mesh(p,b),T=(y=ga.Shader,new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:h},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1})),z=new l.Mesh(p,T),ee=new l.Vector2,oe=new l.Vector2,ne=new l.Box2,ve=new l.Vector4;this.onBeforeRender=function(xe,Te,Ce){xe.getCurrentViewport(ve);var Ie=ve.w/ve.z,Oe=ve.z/2,Fe=ve.w/2,je=16/ve.w;if(ee.set(je*Ie,je),ne.min.set(ve.x,ve.y),ne.max.set(ve.x+(ve.z-16),ve.y+(ve.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4(Ce.matrixWorldInverse),a.applyMatrix4(Ce.projectionMatrix),oe.x=ve.x+a.x*Oe+Oe-8,oe.y=ve.y+a.y*Fe+Fe-8,ne.containsPoint(oe)){xe.copyFramebufferToTexture(oe,r),(St=b.uniforms).scale.value=ee,St.screenPosition.value=a,xe.renderBufferDirect(Ce,null,p,b,O,null),xe.copyFramebufferToTexture(oe,h),(St=N.uniforms).scale.value=ee,St.screenPosition.value=a,xe.renderBufferDirect(Ce,null,p,N,O,null);for(var Ue=2*-a.x,Ye=2*-a.y,at=0,pt=this.elements.length;at<pt;at++){var St,At=this.elements[at];(St=T.uniforms).color.value.copy(At.color),St.map.value=At.texture,St.screenPosition.value.x=a.x+Ue*At.distance,St.screenPosition.value.y=a.y+Ye*At.distance,St.scale.value.set((je=At.size/ve.w)*(Ie=ve.w/ve.z),je),T.uniformsNeedUpdate=!0,xe.renderBufferDirect(Ce,null,p,T,z,null)}}},this.dispose=function(){b.dispose(),N.dispose(),T.dispose(),r.dispose(),h.dispose();for(var xe=0;xe<this.elements.length;xe++)this.elements[xe].texture.dispose()}}ga.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},gs.Geometry=(a=new l.BufferGeometry,r=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),h=new l.InterleavedBuffer(r,5),a.setIndex([0,1,2,0,2,3]),a.setAttribute("position",new l.InterleavedBufferAttribute(h,3,0,!1)),a.setAttribute("uv",new l.InterleavedBufferAttribute(h,2,3,!1)),a),(ch.prototype=Object.create(l.Mesh.prototype)).addFlare=function(a,r,h,p){void 0===r&&(r=-1),void 0===h&&(h=0),void 0===p&&(p=new l.Color(16777215)),h=Math.min(h,Math.max(0,h)),this.addElement(new ga(a,r,h,p))},ch.prototype.addElement=function(a){this.elements.push(a)},ch.prototype.toJSON=function(a){var r=this,h=[],p=l.Object3D.prototype.toJSON.call(this,a,function(y,b){for(var N=0;N<r.elements.length;N++){var O={};O.texture=r.elements[N].texture.toJSON(y).uuid,O.size=r.elements[N].size,O.distance=r.elements[N].distance,O.color=r.elements[N].color.getHex(),h.push(O)}});return p.object.elements=h,p};var pd,ru=function(a,r){switch(r){case l.sRGBEncoding:a.convertSRGBToLinear();break;case l.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return a},$h=__webpack_require__(412);function Rc(a,r){l.LightProbe.call(this,a,r),this.type="LightProbe",this.name="probe"}function uh(a,r){l.Mesh.call(this,a,r),this.name="model",this.receiveShadow=!0,this.castShadow=!0}function va(){l.Group.call(this),this.name="orbit",this.type="OrbitControls",this.distance=4,this.maxDistance=20,this.minDistance=2,this.sensitivity=.002,this.zoomSensitivity=.001,this.limitUp=1.57,this.limitDown=-1.57,this.needsButtonPressed=!0,this.zoomEnabled=!0,this.movementEnabled=!0,this.center=new l.Vector3(0,0,0),this.vector=new l.Vector2(Math.PI/2,0),this.smooth=!0,this.friction=.8,this.speed=.3,this.invertNavigation=!1,this.mouse=null,this.keyboard=null,this.speedDistance=0,this.speedCenter=new l.Vector3(0,0,0),this.speedOrientation=new l.Vector2(0,0),this.tempVector=new l.Vector3}function Io(a){this.offset=new l.Vector2(0,0),this.size=new l.Vector2(1,1),this.mode=void 0!==a?a:Io.RELATIVE,this.anchor=Io.TOP_LEFT,this.width=1,this.height=1,this.viewport=new l.Vector4(0,0,1,1)}function Ps(a,r,h,p,y){l.OrthographicCamera.call(this,-1,1,1,-1,p,y),this.name="camera",this.size=void 0!==a?a:10,this.aspect=void 0!==r?r:1,this.mode=void 0!==h?h:Ps.RESIZE_HORIZONTAL,this.viewport=new Io,this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.updateProjectionMatrix(),this.composer=new Mo;var b=new _l;b.renderToScreen=!0,this.composer.addPass(b)}function ke(a,r,h,p){this.viewport=new Io,l.PerspectiveCamera.call(this,a,r,h,p),this.name="camera",this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.composer=new Mo;var y=new _l;y.renderToScreen=!0,this.composer.addPass(y)}function De(){l.Group.call(this),this.name="physics",this.type="Physics",this.body=new dt,this.body.type=dt.DYNAMIC,this.body.mass=1,this.mode=De.LOCAL,this.world=null}function He(a,r,h,p){l.PointLight.call(this,a,r,h,p),this.name="point",this.castShadow=!0,this.shadow.camera.near=.1,this.shadow.camera.far=1e3,this.shadow.bias=0}(Rc.prototype=Object.create(l.LightProbe.prototype)).generate=function(){var a=this.getScene();if(null!==a){var r=new OffscreenCanvas(256,256),h=new l.WebGLRenderer({canvas:r,alpha:!0}),p=new TCubeCamera(1,1e3,256,{format:l.RGBAFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter});p.matrixAutoUpdate=!1,p.matrix.copy(this.matrix),p.matrixWorld.copy(this.matrixWorld),p.renderTarget.texture.encoding=$h.sRGBEncoding,p.update(h,a);var y=function(b,N){for(var O,T,z,ee=0,oe=new l.Vector3,ne=new l.Vector3,ve=new l.Color,xe=[0,0,0,0,0,0,0,0,0],Te=new l.SphericalHarmonics3,Ce=Te.coefficients,Ie=0;Ie<6;Ie++){var Oe=N.width,Fe=new Uint8Array(Oe*Oe*4);b.readRenderTargetPixels(N,0,0,Oe,Oe,Fe,Ie);for(var je=2/Oe,Ue=0,Ye=Fe.length;Ue<Ye;Ue+=4){ve.setRGB(Fe[Ue]/255,Fe[Ue+1]/255,Fe[Ue+2]/255),ru(ve,N.texture.encoding);var at=Ue/4,pt=(at%Oe+.5)*je-1,St=1-(Math.floor(at/Oe)+.5)*je;switch(Ie){case 0:oe.set(1,St,-pt);break;case 1:oe.set(-1,St,pt);break;case 2:oe.set(pt,1,-St);break;case 3:oe.set(pt,-1,St);break;case 4:oe.set(pt,St,1);break;case 5:oe.set(-pt,St,-1)}T=oe.lengthSq(),ee+=z=4/(Math.sqrt(T)*T),ne.copy(oe).normalize(),l.SphericalHarmonics3.getBasisAt(ne,xe);for(var At=0;At<9;At++)Ce[At].x+=xe[At]*ve.r*z,Ce[At].y+=xe[At]*ve.g*z,Ce[At].z+=xe[At]*ve.b*z}}for(O=4*Math.PI/ee,At=0;At<9;At++)Ce[At].x*=O,Ce[At].y*=O,Ce[At].z*=O;return new l.LightProbe(Te)}(h,p.renderTarget);this.sh=y.sh}else console.warn("nunuStudio: LightProbe cannot generate, no scene.",this)},Rc.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.sh=this.sh.toArray(),r},(uh.prototype=Object.create(l.Mesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},va.UP=new l.Vector3(0,1,0),va.ZERO=new l.Vector3(0,0,0),(va.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof hi&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.center.copy(this.position),this.updateControls(),l.Group.prototype.initialize.call(this)},va.prototype.update=function(a){var r=!1;if(this.needsButtonPressed&&!this.mouse.buttonPressed(Zr.LEFT)||(!0===this.smooth?(this.speedOrientation.y+=this.speed*this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.speedOrientation.x-=this.speed*this.sensitivity*this.mouse.delta.x):(this.vector.y-=this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.vector.x-=this.sensitivity*this.mouse.delta.x),r=!0),this.zoomEnabled&&(this.mouse.buttonPressed(Zr.MIDDLE)&&(!0===this.smooth?this.speedCenter.y+=this.speed*this.sensitivity*this.mouse.delta.y*this.distance:this.center.y+=this.sensitivity*this.mouse.delta.y*this.distance,r=!0),0!==this.mouse.wheel&&(!0===this.smooth?this.speedDistance+=this.speed*this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity:this.distance+=this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity,r=!0)),this.movementEnabled&&this.mouse.buttonPressed(Zr.RIGHT)){var h=this.getWorldDirection(this.tempVector);if(h.y=0,h.normalize(),!0===this.smooth){var p=this.speed*this.mouse.delta.y*this.sensitivity*this.distance;this.speedCenter.x+=-h.x*p,this.speedCenter.z+=-h.z*p,h.applyAxisAngle(va.UP,Math.PI/2);var y=this.speed*this.mouse.delta.x*this.sensitivity*this.distance;this.speedCenter.x-=h.x*y,this.speedCenter.z-=h.z*y}else this.center.x+=-h.x*(p=this.mouse.delta.y*this.sensitivity*this.distance),this.center.z+=-h.z*p,h.applyAxisAngle(va.UP,Math.PI/2),this.center.x-=h.x*(y=this.mouse.delta.x*this.sensitivity*this.distance),this.center.z-=h.z*y;r=!0}if(!0===this.smooth)return this.distance+=this.speedDistance,this.center.add(this.speedCenter),this.vector.add(this.speedOrientation),this.speedDistance*=this.friction,this.speedOrientation.multiplyScalar(this.friction),this.speedCenter.multiplyScalar(this.friction),void this.updateControls();!0===r&&this.updateControls(),l.Object3D.prototype.update.call(this,a)},va.prototype.updateControls=function(){this.vector.y<this.limitDown?this.vector.y=this.limitDown:this.vector.y>this.limitUp&&(this.vector.y=this.limitUp),this.distance<this.minDistance?this.distance=this.minDistance:this.distance>this.maxDistance&&(this.distance=this.maxDistance);var a=this.distance*Math.cos(this.vector.y);this.position.set(Math.cos(this.vector.x)*a,this.distance*Math.sin(this.vector.y),Math.sin(this.vector.x)*a),this.position.add(this.center);var r=new l.Matrix4;r.lookAt(this.position,this.center,va.UP),this.quaternion.setFromRotationMatrix(r)},va.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.distance=this.distance,r.object.maxDistance=this.maxDistance,r.object.minDistance=this.minDistance,r.object.sensitivity=this.sensitivity,r.object.limitUp=this.limitUp,r.object.limitDown=this.limitDown,r.object.needsButtonPressed=this.needsButtonPressed,r.object.zoomEnabled=this.zoomEnabled,r.object.movementEnabled=this.movementEnabled,r.object.smooth=this.smooth,r.object.friction=this.friction,r.object.speed=this.speed,r.object.invertNavigation=this.invertNavigation,r.object.center=this.center.toArray(),r.object.vector=this.vector.toArray(),r},Io.RELATIVE=200,Io.ABSOLUTE=201,Io.TOP_LEFT=301,Io.TOP_RIGHT=302,Io.BOTTOM_LEFT=303,Io.BOTTOM_RIGHT=304,Io.prototype.update=function(a){var r,h,p,y,b,N;void 0===a?(p=0,y=0,r=this.width,h=this.height):(p=a.viewport.x,y=a.viewport.y,r=a.viewport.z,h=a.viewport.w),this.mode===Io.RELATIVE?(b=new l.Vector2(this.offset.x*r,this.offset.y*h),N=new l.Vector2(this.size.x*r,this.size.y*h)):this.mode===Io.ABSOLUTE&&(b=this.offset,N=this.size),this.anchor===Io.BOTTOM_LEFT?this.viewport.set(b.x+p,b.y+y,N.x,N.y):this.anchor===Io.BOTTOM_RIGHT?this.viewport.set(r-N.x-b.x+p,b.y+y,N.x,N.y):this.anchor===Io.TOP_LEFT?this.viewport.set(b.x+p,h-N.y-b.y+y,N.x,N.y):this.anchor===Io.TOP_RIGHT&&this.viewport.set(r-N.x-b.x+p,h-N.y-b.y+y,N.x,N.y)},Io.prototype.getAspectRatio=function(){return this.viewport.z/this.viewport.w},Io.prototype.isInside=function(a,r){return r.position.x>this.viewport.x&&r.position.x<this.viewport.x+this.viewport.z&&r.position.y<this.height-this.viewport.y&&r.position.y>this.height-this.viewport.y-this.viewport.w},Io.prototype.getNormalized=(pd=new l.Vector2,function(a,r){return pd.set((r.position.x-this.viewport.z-this.viewport.x)/this.viewport.z*2+1,-(r.position.y-(this.height-(this.viewport.y+this.viewport.w)))/this.viewport.w*2+1),pd}),Io.prototype.enable=function(a){a.setViewport(this.viewport),a.setScissor(this.viewport)},Io.prototype.toJSON=function(){return{offset:this.offset.toArray(),size:this.size.toArray(),mode:this.mode,anchor:this.anchor}},Io.prototype.fromJSON=function(a){this.offset.fromArray(a.offset),this.size.fromArray(a.size),this.mode=a.mode,this.anchor=a.anchor},Ps.prototype=Object.create(l.OrthographicCamera.prototype),Ps.RESIZE_HORIZONTAL=0,Ps.RESIZE_VERTICAL=1,Ps.prototype.resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},Ps.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},Ps.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},Ps.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},Ps.prototype.updateProjectionMatrix=function(){this.mode===Ps.RESIZE_HORIZONTAL?(this.top=this.size/2,this.bottom=-this.top,this.right=this.top*this.aspect,this.left=-this.right):this.mode===Ps.RESIZE_VERTICAL&&(this.right=this.size/2,this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top),l.OrthographicCamera.prototype.updateProjectionMatrix.call(this)},Ps.prototype.toJSON=function(a){var r=l.OrthographicCamera.prototype.toJSON.call(this,a);return r.object.size=this.size,r.object.aspect=this.aspect,r.object.mode=this.mode,r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},(ke.prototype=Object.create(l.PerspectiveCamera.prototype)).resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},ke.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},ke.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},ke.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},ke.prototype.updateProjectionMatrix=function(){var a=this.near*Math.tan(.5*l.Math.DEG2RAD*this.fov)/this.zoom,r=2*a,h=this.aspect*r,p=-.5*h;0!==this.filmOffset&&(p+=this.near*this.filmOffset/this.getFilmWidth()),this.projectionMatrix.makePerspective(p,p+h,a,a-r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},ke.prototype.toJSON=function(a){var r=l.PerspectiveCamera.prototype.toJSON.call(this,a);return r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},De.prototype=Object.create(l.Group.prototype),De.LOCAL=100,De.WORLD=101,De.prototype.initialize=function(){if(this.mode===De.LOCAL)this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion);else if(this.mode===De.WORLD){var a=new l.Vector3;this.getWorldPosition(a),this.body.position.copy(a);var r=new l.Quaternion;this.getWorldQuaternion(r),this.body.quaternion.copy(r)}for(var h=this;null!==h.parent;)(h=h.parent)instanceof Fo&&(this.world=h.world,this.world.addBody(this.body));l.Object3D.prototype.initialize.call(this)},De.prototype.update=function(a){if(this.mode===De.LOCAL)this.position.copy(this.body.position),this.body.fixedRotation||this.quaternion.copy(this.body.quaternion);else if(this.mode===De.WORLD){var r=new l.Matrix4;if(this.body.fixedRotation)r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z);else{var h=new l.Quaternion;h.copy(this.body.quaternion),r.makeRotationFromQuaternion(h),r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z)}var p=new l.Matrix4;p.getInverse(this.parent.matrixWorld);var y=new l.Vector3;p.multiply(r),p.decompose(this.position,this.quaternion,y)}l.Object3D.prototype.update.call(this,a)},De.prototype.addShape=function(a){a instanceof he&&this.body.addShape(a)},De.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.mode=this.mode,r.object.body={},r.object.body.type=this.body.type,r.object.body.mass=this.body.mass,r.object.body.linearDamping=this.body.linearDamping,r.object.body.angularDamping=this.body.angularDamping,r.object.body.allowSleep=this.body.allowSleep,r.object.body.sleepSpeedLimit=this.body.sleepSpeedLimit,r.object.body.sleepTimeLimit=this.body.sleepTimeLimit,r.object.body.collisionFilterGroup=this.body.collisionFilterGroup,r.object.body.collisionFilterMask=this.body.collisionFilterMask,r.object.body.fixedRotation=this.body.fixedRotation,r.object.body.shapes=[];for(var h=this.body.shapes,p=0;p<h.length;p++){var y=h[p],b={};b.type=y.type,y.type===he.types.SPHERE?b.radius=y.radius:y.type===he.types.BOX?(b.halfExtents={},b.halfExtents.x=y.halfExtents.x,b.halfExtents.y=y.halfExtents.y,b.halfExtents.z=y.halfExtents.z):y.type===he.types.CONVEXPOLYHEDRON?(b.vertices=y.vertices,b.faces=y.faces):y.type===he.types.HEIGHTFIELD?(b.data=y.data,b.maxValue=y.maxValue,b.minValue=y.minValue,b.elementSize=y.elementSize):y.type===he.types.TRIMESH&&(b.vertices=y.vertices,b.normals=y.normals,b.edges=y.edges,b.indices=y.indices),r.object.body.shapes[p]=b}return r},De.fromJSON=function(a){var r=new De;void 0!==a.mode&&(r.mode=a.mode),r.body.type=a.body.type,r.body.mass=a.body.mass,r.body.linearDamping=a.body.linearDamping,r.body.angularDamping=a.body.angularDamping,r.body.allowSleep=a.body.allowSleep,r.body.sleepSpeedLimit=a.body.sleepSpeedLimit,r.body.sleepTimeLimit=a.body.sleepTimeLimit,r.body.collisionFilterGroup=a.body.collisionFilterGroup,r.body.collisionFilterMask=a.body.collisionFilterMask,r.body.fixedRotation=a.body.fixedRotation;for(var h=a.body.shapes,p=0;p<h.length;p++){var y=h[p];if(y.type===he.types.SPHERE)r.body.addShape(new xc(y.radius));else if(y.type===he.types.BOX)r.body.addShape(new Ge(new M(y.halfExtents.x,y.halfExtents.y,y.halfExtents.z)));else if(y.type===he.types.PARTICLE)r.body.addShape(new pn);else if(y.type===he.types.PLANE)r.body.addShape(new Fn);else if(y.type===he.types.HEIGHTFIELD)r.body.addShape(new Sn(y.data,{maxValue:y.maxValue,minValue:y.minValue,elementSize:y.elementSize}));else if(y.type===he.types.CONVEXPOLYHEDRON){for(var b=0;b<y.vertices.length;b++)y.vertices[b]=new M(y.vertices[b].x,y.vertices[b].y,y.vertices[b].z);r.body.addShape(new Q(y.vertices,y.faces))}}return r},(He.prototype=Object.create(l.PointLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var we=__webpack_require__(759),ze=function(a){l.Loader.call(this,a),this.reversed=!1};function Je(a){wi.call(this,"font","Font"),this.reversed=!1,this.font=null,void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.format="arraybuffer",this.loadTTF()):"object"==typeof a?(this.data=a,this.font=a,this.format="json",this.encoding="json"):(this.encoding=Rn.getFileExtension(a),this.name=Rn.getFileName(a),"json"===this.encoding?(this.data=JSON.parse(Rn.readFile(a)),this.format="json",this.font=this.data):"ttf"!==this.encoding&&"otf"!==this.encoding&&"ttc"!==this.encoding&&"otc"!==this.encoding||(this.data=Rn.readFileArrayBuffer(a),this.format="arraybuffer",this.loadTTF())))}function bt(){wi.call(this,"model","Model")}function Ot(a,r){wi.call(this,"audio","Audio"),void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"):ci.isBase64(a)?(this.encoding=void 0!==r?r:"",this.data=_a.fromBase64(a),this.format="arraybuffer"):(this.data=Rn.readFileArrayBuffer(a),this.encoding=Rn.getFileExtension(a),this.format="arraybuffer"))}function Wt(a){ii.call(this,a),this.type="PositionalAudio",this.matrixAutoUpdate=!0,this.distanceModel="inverse",this.panningModel="HRTF",this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.panner.panningModel=this.panningModel,this.panner.distanceModel=this.distanceModel,this.panner.refDistance=1,this.panner.maxDistance=1e4,this.panner.rolloffFactor=1,this.panner.coneInnerAngle=360,this.panner.coneOuterAngle=0,this.panner.coneOuterGain=0,this.scene=null,this.tempPosition=new l.Vector3,this.tempPositionCamera=new l.Vector3,this.tempQuaternionCamera=new l.Quaternion}function In(a,r,h,p){l.RectAreaLight.call(this,a,r,h,p),this.name="rectarea"}function Tn(a,r){l.Group.call(this),this.type="Script",this.name="script",this.code=void 0!==a?a:Tn.DEFAULT,this.mode=void 0!==r?r:Tn.APPEND,this.script={},this.program=null,this.scene=null}function Gn(a,r){l.SkinnedMesh.call(this,a,r),this.name="skinned",this.receiveShadow=!0,this.castShadow=!0,this.skeleton=null}ze.prototype=Object.assign(Object.create(l.Loader.prototype),{constructor:ze,load:function(a,r,h,p){var y=this,b=new l.FileLoader(this.manager);b.setPath(this.path),b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.load(a,function(N){try{r(y.parse(N))}catch(O){p?p(O):console.error(O),y.manager.itemError(a)}},h,p)},parse:function(a){function r(h){var p,y=[];h.forEach(function(N){"m"===N.type.toLowerCase()?y.push(p=[N]):"z"!==N.type.toLowerCase()&&p.push(N)});var b=[];return y.forEach(function(N){var O={type:"m",x:N[N.length-1].x,y:N[N.length-1].y};b.push(O);for(var T=N.length-1;T>0;T--){var z=N[T];O={type:z.type},void 0!==z.x2&&void 0!==z.y2?(O.x1=z.x2,O.y1=z.y2,O.x2=z.x1,O.y2=z.y1):void 0!==z.x1&&void 0!==z.y1&&(O.x1=z.x1,O.y1=z.y1),O.x=N[T-1].x,O.y=N[T-1].y,b.push(O)}}),b}return void 0===we.U?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(h,p){for(var y=Math.round,b={},N=1e5/(72*(h.unitsPerEm||2048)),O=h.encoding.cmap.glyphIndexMap,T=Object.keys(O),z=0;z<T.length;z++){var ee=T[z],oe=h.glyphs.glyphs[O[ee]];if(void 0!==ee){var ne={ha:y(oe.advanceWidth*N),x_min:y(oe.xMin*N),x_max:y(oe.xMax*N),o:""};p&&(oe.path.commands=r(oe.path.commands)),oe.path.commands.forEach(function(ve){"c"===ve.type.toLowerCase()&&(ve.type="b"),ne.o+=ve.type.toLowerCase()+" ",void 0!==ve.x&&void 0!==ve.y&&(ne.o+=y(ve.x*N)+" "+y(ve.y*N)+" "),void 0!==ve.x1&&void 0!==ve.y1&&(ne.o+=y(ve.x1*N)+" "+y(ve.y1*N)+" "),void 0!==ve.x2&&void 0!==ve.y2&&(ne.o+=y(ve.x2*N)+" "+y(ve.y2*N)+" ")}),b[String.fromCodePoint(oe.unicode)]=ne}}return{glyphs:b,familyName:h.getEnglishName("fullName"),ascender:y(h.ascender*N),descender:y(h.descender*N),underlinePosition:h.tables.post.underlinePosition,underlineThickness:h.tables.post.underlineThickness,boundingBox:{xMin:h.tables.head.xMin,xMax:h.tables.head.xMax,yMin:h.tables.head.yMin,yMax:h.tables.head.yMax},resolution:1e3,original_font_information:h.tables.name}}(we.U.parse(a),this.reversed)}}),Je.prototype=Object.create(wi.prototype),Je.fileIsFont=function(a){return void 0!==a&&((a=a.name.toLocaleLowerCase()).endsWith("ttf")||a.endsWith("otf")||a.endsWith("ttc")||a.endsWith("otc")||a.endsWith("json"))},Je.prototype.isFont=!0,Je.prototype.reverseGlyphs=function(){this.reversed=!this.reversed,this.loadTTF()},Je.prototype.loadTTF=function(){var a=new ze;a.reversed=this.reversed,this.font=a.parse(this.data)},Je.prototype.toJSON=function(a){if(void 0!==a.fonts[this.uuid])return a.fonts[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.reversed=this.reversed,"arraybuffer"===this.format?(r.data=this.data,r.format=this.format):"base64"===this.format?(r.data=_a.fromBase64(this.data),r.format="arraybuffer"):(r.data=this.data,r.format=this.format),a.fonts[this.uuid]=r,r},Je.prototype.generateShapes=function(a,r,h){void 0===r&&(r=100),void 0===h&&(h=10);for(var p=this.font,y=function(T){for(var z=String(T).split(""),ee=r/p.resolution,oe=(p.boundingBox.yMax-p.boundingBox.yMin)*ee,ne=0,ve=0,xe=[],Te=0;Te<z.length;Te++){var Ce=z[Te];if("\n"===Ce)ve-=oe,ne=0;else{var Ie=O(Ce,ee,ne,ve);ne+=Ie.width,xe.push(Ie.path)}}return xe}(a),b=[],N=0;N<y.length;N++)Array.prototype.push.apply(b,y[N].toShapes());return b;function O(T,z,ee,oe){var ne=p.glyphs[T]||p.glyphs["?"];if(ne){var ve,xe,Te,Ce,Ie,Oe,Fe,je,Ue,Ye,at,pt=new l.ShapePath,St=[],At=l.ShapeUtils.b2,Jt=l.ShapeUtils.b3;if(ne.o)for(var jt=ne._cachedOutline||(ne._cachedOutline=ne.o.split(" ")),Pt=0,Nt=jt.length;Pt<Nt;){var ft=jt[Pt++];if("m"===ft&&(ve=jt[Pt++]*z+ee,xe=jt[Pt++]*z+oe,pt.moveTo(ve,xe)),"l"===ft)ve=jt[Pt++]*z+ee,xe=jt[Pt++]*z+oe,pt.lineTo(ve,xe);else if("q"===ft){if(Te=jt[Pt++]*z+ee,Ce=jt[Pt++]*z+oe,Fe=jt[Pt++]*z+ee,je=jt[Pt++]*z+oe,pt.quadraticCurveTo(Fe,je,Te,Ce),at=St[St.length-1]){Ie=at.x,Oe=at.y;for(var $t=1;$t<=h;$t++)At(Zt=$t/h,Ie,Fe,Te),At(Zt,Oe,je,Ce)}}else if("b"===ft&&(Te=jt[Pt++]*z+ee,Ce=jt[Pt++]*z+oe,Fe=jt[Pt++]*z+ee,je=jt[Pt++]*z+oe,Ue=jt[Pt++]*z+ee,Ye=jt[Pt++]*z+oe,pt.bezierCurveTo(Fe,je,Ue,Ye,Te,Ce),at=St[St.length-1]))for(Ie=at.x,Oe=at.y,$t=1;$t<=h;$t++){var Zt;Jt(Zt=$t/h,Ie,Fe,Ue,Te),Jt(Zt,Oe,je,Ye,Ce)}}return{width:ne.ha*z,path:pt}}}},bt.prototype=Object.create(wi.prototype),bt.extensions=["gcode","drc","assimp","assimp.json","blend","amf","babylon","prwm","svg","obj","3ds","dae","gltf","glb","3mf","awd","ply","vtk","vtp","wrl","vrml","fbx","pcd","stl","json","x"],bt.fileIsModel=function(a){if(void 0!==a){a=a.name.toLocaleLowerCase();for(var r=0;r<bt.extensions.length;r++)if(a.endsWith(bt.extensions[r]))return!0}return!1},Ot.prototype=Object.create(wi.prototype),Ot.fileIsAudio=function(a){return!(void 0===a||!a.type.startsWith("audio"))},Ot.prototype.getAudioBuffer=function(a,r){a.decodeAudioData(this.data.slice(0),r,function(h){console.error("nunuStudio: Cannot decode audio buffer ("+h+")")})},Ot.prototype.toJSON=function(a){if(void 0!==a.audio[this.uuid])return a.audio[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.audio[this.uuid]=r,r},(Wt.prototype=Object.create(ii.prototype)).initialize=function(){ii.prototype.initialize.call(this);for(var a=this.parent;null!==a;){if(a instanceof Fo){this.scene=a;break}a=a.parent}},Wt.prototype.update=function(a){if(this.scene.cameras.length>0){var r=this.scene.cameras[0];this.getWorldPosition(this.tempPosition),r.getWorldPosition(this.tempPositionCamera),r.getWorldQuaternion(this.tempQuaternionCamera),this.tempPosition.sub(this.tempPositionCamera),this.tempPosition.z=-this.tempPosition.z,this.tempPosition.applyQuaternion(this.tempQuaternionCamera),this.panner.setPosition(this.tempPosition.x,this.tempPosition.z,this.tempPosition.y)}else this.panner.setPosition(0,0,0),this.panner.setOrientation(0,0,0);l.Object3D.prototype.update.call(this,a)},Wt.prototype.getOutput=function(){return this.panner},Wt.prototype.getRefDistance=function(){return this.panner.refDistance},Wt.prototype.setRefDistance=function(a){this.panner.refDistance=a},Wt.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},Wt.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a},Wt.prototype.getDistanceModel=function(){return this.panner.distanceModel},Wt.prototype.setDistanceModel=function(a){this.panner.distanceModel=a},Wt.prototype.getMaxDistance=function(){return this.panner.maxDistance},Wt.prototype.setMaxDistance=function(a){this.panner.maxDistance=a},Wt.prototype.toJSON=function(a){var r=ii.prototype.toJSON.call(this,a);return r.object.distanceModel=this.distanceModel,r.object.panningModel=this.panningModel,r},(In.prototype=Object.create(l.RectAreaLight.prototype)).toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.width=this.width,r.object.height=this.height,r},Tn.prototype=Object.create(l.Group.prototype),Tn.includeRegex=/include[ ]*\([ \n]*["'].+?["'][ \n]*\);*/gi,Tn.includeRegexStart=/include[ ]*\([ \n]*["']/gi,Tn.includeRegexEnd=/["'][ \n]*\);*/gi,Tn.DEFAULT="function initialize() {\n\t// TODO ADD CODE\n}\n\nfunction update(delta) {\n\t// TODO ADD CODE\n}",Tn.METHODS=["initialize","update","dispose","onMouseOver","onResize","onAppData"],Tn.APPEND=100,Tn.EVALUATE=101,Tn.INCLUDE=102,Tn.getIncludes=function(a){for(var r=[],h=new RegExp(Tn.includeRegex,"gi");;){var p=h.exec(a);if(null===p)break;var y=p[0];y=(y=y.replace(Tn.includeRegexStart,"")).replace(Tn.includeRegexEnd,""),r.push(y)}return r},Tn.removeComments=function(a){return a.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")},Tn.removeIncludes=function(a){return a.replace(Tn.includeRegex,"")},Tn.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.program=a);l.Object3D.prototype.initialize.call(this);var r=this;this.compileCode(this.code,function(){void 0!==r.script.initialize&&r.script.initialize.call(r)})},Tn.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a),l.Object3D.prototype.update.call(this,a)},Tn.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this),l.Object3D.prototype.dispose.call(this)},Tn.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r)},Tn.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a)},Tn.prototype.compileCode=function(a,r){try{a=this.code;for(var h=0;h<Tn.METHODS.length;h++){var p=Tn.METHODS[h];a+="\nif(this."+p+" == undefined && typeof "+p+" !== 'undefined'){this."+p+" = "+p+";}"}if(this.mode===Tn.APPEND){a=Tn.removeComments(a);var y=Tn.getIncludes(a);for(a=Tn.removeIncludes(a),h=0;h<y.length;h++){var b=this.program.getResourceByName(y[h]);if(null===b){if(null===(b=Rn.readFile(y[h],!0)))throw new Error("Script include() library "+y[h]+" not found.");a=b+"\n"+a}else a=b.data+"\n"+a}a+='\nfunction include(name)\t\t\t{\t\t\t\tconsole.warn("nunuStudio: Script running in append mode, " + name + " cannot be included in runtime.");\t\t\t}'}else if(this.mode===Tn.EVALUATE)a+='\nfunction include(name)\t\t\t{\t\t\t\tvar text = program.getResourceByName(name);\t\t\t\tif(text === null)\t\t\t\t{\t\t\t\t\ttext = FileSystem.readFile(name, true);\t\t\t\t\tif(text !== null)\t\t\t\t\t{\t\t\t\t\t\tnew Function(text).call(this);\t\t\t\t\t}\t\t\t\t\telse\t\t\t\t\t{\t\t\t\t\t\tconsole.warn("nunuStudio: Javascript file " + name + " not found.");\t\t\t\t\t}\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\tnew Function(text.data).call(this);\t\t\t\t}\t\t\t}';else if(this.mode===Tn.INCLUDE){y=Tn.getIncludes(a),a=Tn.removeIncludes(a);var N=0,O=[];for(h=0;h<y.length;h++){var T=this.program.getResourceByName(y[h]);if(null!==T){var z=new Blob([T.data],{type:"text/plain"});O.push(URL.createObjectURL(z))}else{var ee=Rn.readFile(y[h],!0);if(null===ee)throw new Error("Script include() library "+y[h]+" not found.");z=new Blob([ee],{type:"text/plain"}),O.push(URL.createObjectURL(z))}}if(O.length>0)for(h=0;h<O.length;h++){var oe=document.createElement("script");oe.type="text/javascript",oe.async=!0,oe.src=url,oe.onload=function(){++N===O.length&&void 0!==r&&r()},oe.onerror=oe.onload,document.body.appendChild(oe)}else void 0!==r&&r()}var ne=new Function("__context__","for(var p in __context__){eval('var ' + p + ' = __context__[p];');}"+a);try{var ve=this.createContextObject();this.script=new ne(ve)}catch(xe){throw this.script={},console.warn("nunuStudio: Error initializing script code",xe),new Error("Error initializing script code")}this.mode!==Tn.INCLUDE&&r()}catch(xe){throw this.script={},console.warn("nunuStudio: Error compiling script code",xe),new Error("Error compiling script code")}},Tn.prototype.createContextObject=function(){var a={};Object.assign(a,n),Object.assign(a,l),Object.assign(a,o);var r={};for(var h of["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"])r[h]=window.Math[h];return Object.assign(r,l.Math),Object.assign(a,{self:this,program:this.program,scene:this.scene,THREE:l,CANNON:n,Math:r,Keyboard:this.program.keyboard,Mouse:this.program.mouse}),a},Tn.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r.object.mode=this.mode,r},(Gn.prototype=Object.create(l.SkinnedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Gn.prototype.toJSON=function(a){var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(p,y){null!==r.skeleton&&(void 0===p.skeletons[r.skeleton.uuid]&&(p.skeletons[r.skeleton.uuid]=r.skeleton.toJSON(p)),y.skeleton=r.skeleton.uuid)});return void 0!==this.bindMode&&(h.object.bindMode=this.bindMode),void 0!==this.bindMatrix&&(h.object.bindMatrix=this.bindMatrix.toArray()),h};const Cr="uniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float offset;\nuniform float exponent;\nvarying vec3 vWorldPosition;\n\nvoid main()\n{\n\tfloat h = normalize(vWorldPosition + offset).y;\n\tgl_FragColor = vec4(mix(bottomColor, topColor, max(pow(max(h , 0.0), exponent), 0.0)), 1.0);\n}\n",Dr="varying vec3 vWorldPosition;\n\nvoid main()\n{\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\n\tvWorldPosition = worldPosition.xyz;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}";function Lr(a,r,h,p){l.Group.call(this),this.name="sky",this.type="Sky",this.colorTop=[new l.Color(7844859),new l.Color(30463),new l.Color(220086),new l.Color(9273)],this.colorBottom=[new l.Color(15461606),new l.Color(16777215),new l.Color(16705495),new l.Color(26023)],this.sunColor=16777130,this.intensity=.3,this.moonColor=5592507,this.hemisphere=new l.HemisphereLight(3310847,16764031,.5),this.hemisphere.locked=!0,this.hemisphere.matrixAutoUpdate=!1,this.add(this.hemisphere),this.sun=new ml(this.sunColor,this.intensity),this.sun.castShadow=!0,this.sun.locked=!0,this.add(this.sun);var y={topColor:{type:"c",value:new l.Color(0,.46,1)},bottomColor:{type:"c",value:new l.Color(1,1,1)},offset:{type:"f",value:20},exponent:{type:"f",value:.2}};y.topColor.value.copy(this.hemisphere.color);var b=new l.SphereBufferGeometry(1500,16,16),N=new l.ShaderMaterial({vertexShader:Dr,fragmentShader:Cr,uniforms:y,side:l.BackSide});this.sky=new l.Mesh(b,N),this.sky.locked=!0,this.sky.matrixAutoUpdate=!1,this.add(this.sky),this.sky.raycast=function(){return null},this.autoUpdate=void 0===a||a,this.sunDistance=void 0!==h?h:100,this.dayTime=void 0!==r?r:120,this.time=void 0!==p?p:75,this.updateSky()}(Lr.prototype=Object.create(l.Group.prototype)).initialize=function(){this.updateSky(),l.Object3D.prototype.initialize.call(this)},Lr.prototype.update=function(a){this.autoUpdate&&(this.time+=a,this.time>this.dayTime&&(this.time-=this.dayTime),this.updateSky()),l.Object3D.prototype.update.call(this,a)},Lr.prototype.updateSky=function(){var a=this.time/this.dayTime;if(a<.25)this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b);else if(a<.292){var r=1-(h=23.81*(a-.25));this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[3].r+h*this.colorTop[0].r,r*this.colorTop[3].g+h*this.colorTop[0].g,r*this.colorTop[3].b+h*this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[3].r+h*this.colorBottom[0].r,r*this.colorBottom[3].g+h*this.colorBottom[0].g,r*this.colorBottom[3].b+h*this.colorBottom[0].b)}else a<.4167?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[0].r,this.colorTop[0].g,this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[0].r,this.colorBottom[0].g,this.colorBottom[0].b)):a<.5?(r=1-(h=12*(a-.4167)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[0].r+h*this.colorTop[1].r,r*this.colorTop[0].g+h*this.colorTop[1].g,r*this.colorTop[0].b+h*this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[0].r+h*this.colorBottom[1].r,r*this.colorBottom[0].g+h*this.colorBottom[1].g,r*this.colorBottom[0].b+h*this.colorBottom[1].b)):a<.708?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[1].r,this.colorTop[1].g,this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[1].r,this.colorBottom[1].g,this.colorBottom[1].b)):a<.75?(r=1-(h=23.81*(a-.708)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[1].r+h*this.colorTop[2].r,r*this.colorTop[1].g+h*this.colorTop[2].g,r*this.colorTop[1].b+h*this.colorTop[2].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[1].r+h*this.colorBottom[2].r,r*this.colorBottom[1].g+h*this.colorBottom[2].g,r*this.colorBottom[1].b+h*this.colorBottom[2].b)):a<.8333?(r=1-(h=12.048*(a-.75)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[2].r+h*this.colorTop[3].r,r*this.colorTop[2].g+h*this.colorTop[3].g,r*this.colorTop[2].b+h*this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[2].r+h*this.colorBottom[3].r,r*this.colorBottom[2].g+h*this.colorBottom[3].g,r*this.colorBottom[2].b+h*this.colorBottom[3].b)):(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b));if(a<.2)this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);else if(a<.3)r=1-(h=10*(a-.2)),h<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.moonColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.sunColor));else if(a<.7)this.sun.intensity=this.intensity,this.sun.color.setHex(this.sunColor);else if(a<.8){var h;(h=10*(a-.7))<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.sunColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.moonColor))}else this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);var p=Qc.PI2*a-Qc.PID2;a>.25&&a<.75?(this.sun.position.x=this.sunDistance*Math.cos(p),this.sun.position.y=this.sunDistance*Math.sin(p)):(this.sun.position.x=this.sunDistance*Math.cos(p+Math.PI),this.sun.position.y=this.sunDistance*Math.sin(p+Math.PI))},Lr.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.colorTop=[];for(var h=0;h<this.colorTop.length;h++)r.object.colorTop.push(this.colorTop[h].toJSON());for(r.object.colorBottom=[],h=0;h<this.colorBottom.length;h++)r.object.colorBottom.push(this.colorBottom[h].toJSON());return r.object.sunColor=this.sunColor,r.object.moonColor=this.moonColor,r.object.intensity=this.intensity,r.object.autoUpdate=this.autoUpdate,r.object.sunDistance=this.sunDistance,r.object.dayTime=this.dayTime,r.object.time=this.time,r.object.sun={},r.object.sun.castShadow=this.sun.castShadow,r.object.sun.shadow=this.sun.shadow.toJSON(),r};var Qt,Ao,Pc,ic=__webpack_require__(175);if(ic){let a=window.require;window.require=r=>a?a(r):"three"===r?ic:void 0}class el{constructor(){this.entries={},this.size=0}add(r){let h=this.entries[r];return this.entries[r]=!0,!h&&(this.size++,!0)}addAll(r){let h=this.size;for(var p=0,y=r.length;p<y;p++)this.add(r[p]);return h!=this.size}contains(r){return this.entries[r]}clear(){this.entries={},this.size=0}}class Qr{constructor(r=0,h=0,p=0,y=0){this.r=r,this.g=h,this.b=p,this.a=y}set(r,h,p,y){return this.r=r,this.g=h,this.b=p,this.a=y,this.clamp()}setFromColor(r){return this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this}setFromString(r){return r="#"==r.charAt(0)?r.substr(1):r,this.r=parseInt(r.substr(0,2),16)/255,this.g=parseInt(r.substr(2,2),16)/255,this.b=parseInt(r.substr(4,2),16)/255,this.a=8!=r.length?1:parseInt(r.substr(6,2),16)/255,this}add(r,h,p,y){return this.r+=r,this.g+=h,this.b+=p,this.a+=y,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(r,h){r.r=((4278190080&h)>>>24)/255,r.g=((16711680&h)>>>16)/255,r.b=((65280&h)>>>8)/255,r.a=(255&h)/255}static rgb888ToColor(r,h){r.r=((16711680&h)>>>16)/255,r.g=((65280&h)>>>8)/255,r.b=(255&h)/255}static fromString(r){return(new Qr).setFromString(r)}}Qr.WHITE=new Qr(1,1,1,1),Qr.RED=new Qr(1,0,0,1),Qr.GREEN=new Qr(0,1,0,1),Qr.BLUE=new Qr(0,0,1,1),Qr.MAGENTA=new Qr(1,0,1,1);class Cn{static clamp(r,h,p){return r<h?h:r>p?p:r}static cosDeg(r){return Math.cos(r*Cn.degRad)}static sinDeg(r){return Math.sin(r*Cn.degRad)}static signum(r){return r>0?1:r<0?-1:0}static toInt(r){return r>0?Math.floor(r):Math.ceil(r)}static cbrt(r){let h=Math.pow(Math.abs(r),.3333333333333333);return r<0?-h:h}static randomTriangular(r,h){return Cn.randomTriangularWith(r,h,.5*(r+h))}static randomTriangularWith(r,h,p){let y=Math.random(),b=h-r;return y<=(p-r)/b?r+Math.sqrt(y*b*(p-r)):h-Math.sqrt((1-y)*b*(h-p))}static isPowerOfTwo(r){return r&&0==(r&r-1)}}Cn.PI=3.1415927,Cn.PI2=2*Cn.PI,Cn.radiansToDegrees=180/Cn.PI,Cn.radDeg=Cn.radiansToDegrees,Cn.degreesToRadians=Cn.PI/180,Cn.degRad=Cn.degreesToRadians;class Id{apply(r,h,p){return r+(h-r)*this.applyInternal(p)}}class Cm extends Id{constructor(r){super(),this.power=2,this.power=r}applyInternal(r){return r<=.5?Math.pow(2*r,this.power)/2:Math.pow(2*(r-1),this.power)/(this.power%2==0?-2:2)+1}}class gr{static arrayCopy(r,h,p,y,b){for(let N=h,O=y;N<h+b;N++,O++)p[O]=r[N]}static arrayFill(r,h,p,y){for(let b=h;b<p;b++)r[b]=y}static setArraySize(r,h,p=0){let y=r.length;if(y==h)return r;if(r.length=h,y<h)for(let b=y;b<h;b++)r[b]=p;return r}static ensureArrayCapacity(r,h,p=0){return r.length>=h?r:gr.setArraySize(r,h,p)}static newArray(r,h){let p=new Array(r);for(let y=0;y<r;y++)p[y]=h;return p}static newFloatArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Float32Array(r);{let h=new Array(r);for(let p=0;p<h.length;p++)h[p]=0;return h}}static newShortArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Int16Array(r);{let h=new Array(r);for(let p=0;p<h.length;p++)h[p]=0;return h}}static toFloatArray(r){return gr.SUPPORTS_TYPED_ARRAYS?new Float32Array(r):r}static toSinglePrecision(r){return gr.SUPPORTS_TYPED_ARRAYS?Math.fround(r):r}static webkit602BugfixHelper(r,h){}static contains(r,h,p=!0){for(var y=0;y<r.length;y++)if(r[y]==h)return!0;return!1}static enumValue(r,h){return r[h[0].toUpperCase()+h.slice(1)]}}gr.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class rf{constructor(r){this.items=new Array,this.instantiator=r}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(r){r.reset&&r.reset(),this.items.push(r)}freeAll(r){for(let h=0;h<r.length;h++)this.free(r[h])}clear(){this.items.length=0}}class of{constructor(r=0,h=0){this.x=r,this.y=h}set(r,h){return this.x=r,this.y=h,this}length(){let r=this.x,h=this.y;return Math.sqrt(r*r+h*h)}normalize(){let r=this.length();return 0!=r&&(this.x/=r,this.y/=r),this}}class Af{constructor(r){if(!r)throw new Error("name cannot be null.");this.name=r}}class Au extends Af{constructor(r){super(r),this.id=Au.nextID++,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVertices(r,h,p,y,b,N){p=b+(p>>1)*N;let O=r.bone.skeleton,T=r.deform,z=this.vertices,ee=this.bones;if(!ee){T.length>0&&(z=T);let xe=r.bone,Te=xe.worldX,Ce=xe.worldY,Ie=xe.a,Oe=xe.b,Fe=xe.c,je=xe.d;for(let Ue=h,Ye=b;Ye<p;Ue+=2,Ye+=N){let at=z[Ue],pt=z[Ue+1];y[Ye]=at*Ie+pt*Oe+Te,y[Ye+1]=at*Fe+pt*je+Ce}return}let oe=0,ne=0;for(let xe=0;xe<h;xe+=2){let Te=ee[oe];oe+=Te+1,ne+=Te}let ve=O.bones;if(0==T.length)for(let xe=b,Te=3*ne;xe<p;xe+=N){let Ce=0,Ie=0,Oe=ee[oe++];for(Oe+=oe;oe<Oe;oe++,Te+=3){let Fe=ve[ee[oe]],je=z[Te],Ue=z[Te+1],Ye=z[Te+2];Ce+=(je*Fe.a+Ue*Fe.b+Fe.worldX)*Ye,Ie+=(je*Fe.c+Ue*Fe.d+Fe.worldY)*Ye}y[xe]=Ce,y[xe+1]=Ie}else{let xe=T;for(let Te=b,Ce=3*ne,Ie=ne<<1;Te<p;Te+=N){let Oe=0,Fe=0,je=ee[oe++];for(je+=oe;oe<je;oe++,Ce+=3,Ie+=2){let Ue=ve[ee[oe]],Ye=z[Ce]+xe[Ie],at=z[Ce+1]+xe[Ie+1],pt=z[Ce+2];Oe+=(Ye*Ue.a+at*Ue.b+Ue.worldX)*pt,Fe+=(Ye*Ue.c+at*Ue.d+Ue.worldY)*pt}y[Te]=Oe,y[Te+1]=Fe}}}copyTo(r){this.bones?(r.bones=new Array(this.bones.length),gr.arrayCopy(this.bones,0,r.bones,0,this.bones.length)):r.bones=null,this.vertices?(r.vertices=gr.newFloatArray(this.vertices.length),gr.arrayCopy(this.vertices,0,r.vertices,0,this.vertices.length)):r.vertices=null,r.worldVerticesLength=this.worldVerticesLength,r.deformAttachment=this.deformAttachment}}Au.nextID=0;class $f{constructor(r,h,p){if(!r)throw new Error("name cannot be null.");this.name=r,this.setTimelines(h),this.duration=p}setTimelines(r){if(!r)throw new Error("timelines cannot be null.");this.timelines=r,this.timelineIds=new el;for(var h=0;h<r.length;h++)this.timelineIds.addAll(r[h].getPropertyIds())}hasTimeline(r){for(let h=0;h<r.length;h++)if(this.timelineIds.contains(r[h]))return!0;return!1}apply(r,h,p,y,b,N,O,T){if(!r)throw new Error("skeleton cannot be null.");y&&0!=this.duration&&(p%=this.duration,h>0&&(h%=this.duration));let z=this.timelines;for(let ee=0,oe=z.length;ee<oe;ee++)z[ee].apply(r,h,p,b,N,O,T)}}(function(a){a[a.setup=0]="setup",a[a.first=1]="first",a[a.replace=2]="replace",a[a.add=3]="add"})(Qt||(Qt={})),function(a){a[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut"}(Ao||(Ao={}));class ya{constructor(r,h){this.propertyIds=h,this.frames=gr.newFloatArray(r*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(r,h){let p=r.length;for(let y=1;y<p;y++)if(r[y]>h)return y-1;return p-1}static search(r,h,p){let y=r.length;for(let b=p;b<y;b+=p)if(r[b]>h)return b-p;return y-p}}class oc extends ya{constructor(r,h,p){super(r,p),this.curves=gr.newFloatArray(r+18*h),this.curves[r-1]=1}setLinear(r){this.curves[r]=0}setStepped(r){this.curves[r]=1}shrink(r){let h=this.getFrameCount()+18*r;if(this.curves.length>h){let p=gr.newFloatArray(h);gr.arrayCopy(this.curves,0,p,0,h),this.curves=p}}setBezier(r,h,p,y,b,N,O,T,z,ee,oe){let ne=this.curves,ve=this.getFrameCount()+18*r;0==p&&(ne[h]=2+ve);let xe=.03*(y-2*N+T),Te=.03*(b-2*O+z),Ce=.006*(3*(N-T)-y+ee),Ie=.006*(3*(O-z)-b+oe),Oe=2*xe+Ce,Fe=2*Te+Ie,je=.3*(N-y)+xe+.16666667*Ce,Ue=.3*(O-b)+Te+.16666667*Ie,Ye=y+je,at=b+Ue;for(let pt=ve+18;ve<pt;ve+=2)ne[ve]=Ye,ne[ve+1]=at,je+=Oe,Ue+=Fe,Oe+=Ce,Fe+=Ie,Ye+=je,at+=Ue}getBezierValue(r,h,p,y){let b=this.curves;if(b[y]>r){let z=this.frames[h],ee=this.frames[h+p];return ee+(r-z)/(b[y]-z)*(b[y+1]-ee)}let N=y+18;for(y+=2;y<N;y+=2)if(b[y]>=r){let z=b[y-2],ee=b[y-1];return ee+(r-z)/(b[y]-z)*(b[y+1]-ee)}h+=this.getFrameEntries();let O=b[N-2],T=b[N-1];return T+(r-O)/(this.frames[h]-O)*(this.frames[h+p]-T)}}class vs extends oc{constructor(r,h,p){super(r,h,[p])}getFrameEntries(){return 2}setFrame(r,h,p){this.frames[r<<=1]=h,this.frames[r+1]=p}getCurveValue(r){let h=this.frames,p=h.length-2;for(let b=2;b<=p;b+=2)if(h[b]>r){p=b-2;break}let y=this.curves[p>>1];switch(y){case 0:let b=h[p],N=h[p+1];return N+(r-b)/(h[p+2]-b)*(h[p+2+1]-N);case 1:return h[p+1]}return this.getBezierValue(r,p,1,y-2)}}class tl extends oc{constructor(r,h,p,y){super(r,h,[p,y])}getFrameEntries(){return 3}setFrame(r,h,p,y){this.frames[r*=3]=h,this.frames[r+1]=p,this.frames[r+2]=y}}class sf extends vs{constructor(r,h,p){super(r,h,"0|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.rotation=T.data.rotation);case Qt.first:T.rotation+=(T.data.rotation-T.rotation)*b}return}let z=this.getCurveValue(p);switch(N){case Qt.setup:T.rotation=T.data.rotation+z*b;break;case Qt.first:case Qt.replace:z+=T.data.rotation-T.rotation;case Qt.add:T.rotation+=z*b}}}class Vf extends tl{constructor(r,h,p){super(r,h,"1|"+p,"2|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;let z=this.frames;if(p<z[0]){switch(N){case Qt.setup:return T.x=T.data.x,void(T.y=T.data.y);case Qt.first:T.x+=(T.data.x-T.x)*b,T.y+=(T.data.y-T.y)*b}return}let ee=0,oe=0,ne=ya.search(z,p,3),ve=this.curves[ne/3];switch(ve){case 0:let xe=z[ne];ee=z[ne+1],oe=z[ne+2];let Te=(p-xe)/(z[ne+3]-xe);ee+=(z[ne+3+1]-ee)*Te,oe+=(z[ne+3+2]-oe)*Te;break;case 1:ee=z[ne+1],oe=z[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),oe=this.getBezierValue(p,ne,2,ve+18-2)}switch(N){case Qt.setup:T.x=T.data.x+ee*b,T.y=T.data.y+oe*b;break;case Qt.first:case Qt.replace:T.x+=(T.data.x+ee-T.x)*b,T.y+=(T.data.y+oe-T.y)*b;break;case Qt.add:T.x+=ee*b,T.y+=oe*b}}}class Wf extends vs{constructor(r,h,p){super(r,h,"1|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.x=T.data.x);case Qt.first:T.x+=(T.data.x-T.x)*b}return}let z=this.getCurveValue(p);switch(N){case Qt.setup:T.x=T.data.x+z*b;break;case Qt.first:case Qt.replace:T.x+=(T.data.x+z-T.x)*b;break;case Qt.add:T.x+=z*b}}}class Cf extends vs{constructor(r,h,p){super(r,h,"2|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.y=T.data.y);case Qt.first:T.y+=(T.data.y-T.y)*b}return}let z=this.getCurveValue(p);switch(N){case Qt.setup:T.y=T.data.y+z*b;break;case Qt.first:case Qt.replace:T.y+=(T.data.y+z-T.y)*b;break;case Qt.add:T.y+=z*b}}}class qf extends tl{constructor(r,h,p){super(r,h,"3|"+p,"4|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;let z,ee,oe=this.frames;if(p<oe[0]){switch(N){case Qt.setup:return T.scaleX=T.data.scaleX,void(T.scaleY=T.data.scaleY);case Qt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b,T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let ne=ya.search(oe,p,3),ve=this.curves[ne/3];switch(ve){case 0:let xe=oe[ne];z=oe[ne+1],ee=oe[ne+2];let Te=(p-xe)/(oe[ne+3]-xe);z+=(oe[ne+3+1]-z)*Te,ee+=(oe[ne+3+2]-ee)*Te;break;case 1:z=oe[ne+1],ee=oe[ne+2];break;default:z=this.getBezierValue(p,ne,1,ve-2),ee=this.getBezierValue(p,ne,2,ve+18-2)}if(z*=T.data.scaleX,ee*=T.data.scaleY,1==b)N==Qt.add?(T.scaleX+=z-T.data.scaleX,T.scaleY+=ee-T.data.scaleY):(T.scaleX=z,T.scaleY=ee);else{let xe=0,Te=0;if(O==Ao.mixOut)switch(N){case Qt.setup:xe=T.data.scaleX,Te=T.data.scaleY,T.scaleX=xe+(Math.abs(z)*Cn.signum(xe)-xe)*b,T.scaleY=Te+(Math.abs(ee)*Cn.signum(Te)-Te)*b;break;case Qt.first:case Qt.replace:xe=T.scaleX,Te=T.scaleY,T.scaleX=xe+(Math.abs(z)*Cn.signum(xe)-xe)*b,T.scaleY=Te+(Math.abs(ee)*Cn.signum(Te)-Te)*b;break;case Qt.add:T.scaleX=(z-T.data.scaleX)*b,T.scaleY=(ee-T.data.scaleY)*b}else switch(N){case Qt.setup:xe=Math.abs(T.data.scaleX)*Cn.signum(z),Te=Math.abs(T.data.scaleY)*Cn.signum(ee),T.scaleX=xe+(z-xe)*b,T.scaleY=Te+(ee-Te)*b;break;case Qt.first:case Qt.replace:xe=Math.abs(T.scaleX)*Cn.signum(z),Te=Math.abs(T.scaleY)*Cn.signum(ee),T.scaleX=xe+(z-xe)*b,T.scaleY=Te+(ee-Te)*b;break;case Qt.add:T.scaleX+=(z-T.data.scaleX)*b,T.scaleY+=(ee-T.data.scaleY)*b}}}}class Lm extends vs{constructor(r,h,p){super(r,h,"3|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.scaleX=T.data.scaleX);case Qt.first:T.scaleX+=(T.data.scaleX-T.scaleX)*b}return}let z=this.getCurveValue(p)*T.data.scaleX;if(1==b)N==Qt.add?T.scaleX+=z-T.data.scaleX:T.scaleX=z;else{let ee=0;if(O==Ao.mixOut)switch(N){case Qt.setup:ee=T.data.scaleX,T.scaleX=ee+(Math.abs(z)*Cn.signum(ee)-ee)*b;break;case Qt.first:case Qt.replace:ee=T.scaleX,T.scaleX=ee+(Math.abs(z)*Cn.signum(ee)-ee)*b;break;case Qt.add:T.scaleX=(z-T.data.scaleX)*b}else switch(N){case Qt.setup:ee=Math.abs(T.data.scaleX)*Cn.signum(z),T.scaleX=ee+(z-ee)*b;break;case Qt.first:case Qt.replace:ee=Math.abs(T.scaleX)*Cn.signum(z),T.scaleX=ee+(z-ee)*b;break;case Qt.add:T.scaleX+=(z-T.data.scaleX)*b}}}}class Bp extends vs{constructor(r,h,p){super(r,h,"4|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.scaleY=T.data.scaleY);case Qt.first:T.scaleY+=(T.data.scaleY-T.scaleY)*b}return}let z=this.getCurveValue(p)*T.data.scaleY;if(1==b)N==Qt.add?T.scaleY+=z-T.data.scaleY:T.scaleY=z;else{let ee=0;if(O==Ao.mixOut)switch(N){case Qt.setup:ee=T.data.scaleY,T.scaleY=ee+(Math.abs(z)*Cn.signum(ee)-ee)*b;break;case Qt.first:case Qt.replace:ee=T.scaleY,T.scaleY=ee+(Math.abs(z)*Cn.signum(ee)-ee)*b;break;case Qt.add:T.scaleY=(z-T.data.scaleY)*b}else switch(N){case Qt.setup:ee=Math.abs(T.data.scaleY)*Cn.signum(z),T.scaleY=ee+(z-ee)*b;break;case Qt.first:case Qt.replace:ee=Math.abs(T.scaleY)*Cn.signum(z),T.scaleY=ee+(z-ee)*b;break;case Qt.add:T.scaleY+=(z-T.data.scaleY)*b}}}}class Xf extends tl{constructor(r,h,p){super(r,h,"5|"+p,"6|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;let z=this.frames;if(p<z[0]){switch(N){case Qt.setup:return T.shearX=T.data.shearX,void(T.shearY=T.data.shearY);case Qt.first:T.shearX+=(T.data.shearX-T.shearX)*b,T.shearY+=(T.data.shearY-T.shearY)*b}return}let ee=0,oe=0,ne=ya.search(z,p,3),ve=this.curves[ne/3];switch(ve){case 0:let xe=z[ne];ee=z[ne+1],oe=z[ne+2];let Te=(p-xe)/(z[ne+3]-xe);ee+=(z[ne+3+1]-ee)*Te,oe+=(z[ne+3+2]-oe)*Te;break;case 1:ee=z[ne+1],oe=z[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),oe=this.getBezierValue(p,ne,2,ve+18-2)}switch(N){case Qt.setup:T.shearX=T.data.shearX+ee*b,T.shearY=T.data.shearY+oe*b;break;case Qt.first:case Qt.replace:T.shearX+=(T.data.shearX+ee-T.shearX)*b,T.shearY+=(T.data.shearY+oe-T.shearY)*b;break;case Qt.add:T.shearX+=ee*b,T.shearY+=oe*b}}}class Bm extends vs{constructor(r,h,p){super(r,h,"5|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.shearX=T.data.shearX);case Qt.first:T.shearX+=(T.data.shearX-T.shearX)*b}return}let z=this.getCurveValue(p);switch(N){case Qt.setup:T.shearX=T.data.shearX+z*b;break;case Qt.first:case Qt.replace:T.shearX+=(T.data.shearX+z-T.shearX)*b;break;case Qt.add:T.shearX+=z*b}}}class Yf extends vs{constructor(r,h,p){super(r,h,"6|"+p),this.boneIndex=0,this.boneIndex=p}apply(r,h,p,y,b,N,O){let T=r.bones[this.boneIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.shearY=T.data.shearY);case Qt.first:T.shearY+=(T.data.shearY-T.shearY)*b}return}let z=this.getCurveValue(p);switch(N){case Qt.setup:T.shearY=T.data.shearY+z*b;break;case Qt.first:case Qt.replace:T.shearY+=(T.data.shearY+z-T.shearY)*b;break;case Qt.add:T.shearY+=z*b}}}class Jf extends oc{constructor(r,h,p){super(r,h,["7|"+p,"8|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 5}setFrame(r,h,p,y,b,N){this.frames[r*=5]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=this.frames,ee=T.color;if(p<z[0]){let Ie=T.data.color;switch(N){case Qt.setup:return void ee.setFromColor(Ie);case Qt.first:ee.add((Ie.r-ee.r)*b,(Ie.g-ee.g)*b,(Ie.b-ee.b)*b,(Ie.a-ee.a)*b)}return}let oe=0,ne=0,ve=0,xe=0,Te=ya.search(z,p,5),Ce=this.curves[Te/5];switch(Ce){case 0:let Ie=z[Te];oe=z[Te+1],ne=z[Te+2],ve=z[Te+3],xe=z[Te+4];let Oe=(p-Ie)/(z[Te+5]-Ie);oe+=(z[Te+5+1]-oe)*Oe,ne+=(z[Te+5+2]-ne)*Oe,ve+=(z[Te+5+3]-ve)*Oe,xe+=(z[Te+5+4]-xe)*Oe;break;case 1:oe=z[Te+1],ne=z[Te+2],ve=z[Te+3],xe=z[Te+4];break;default:oe=this.getBezierValue(p,Te,1,Ce-2),ne=this.getBezierValue(p,Te,2,Ce+18-2),ve=this.getBezierValue(p,Te,3,Ce+36-2),xe=this.getBezierValue(p,Te,4,Ce+54-2)}1==b?ee.set(oe,ne,ve,xe):(N==Qt.setup&&ee.setFromColor(T.data.color),ee.add((oe-ee.r)*b,(ne-ee.g)*b,(ve-ee.b)*b,(xe-ee.a)*b))}}class Od extends oc{constructor(r,h,p){super(r,h,["7|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 4}setFrame(r,h,p,y,b){this.frames[r<<=2]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=this.frames,ee=T.color;if(p<z[0]){let Ce=T.data.color;switch(N){case Qt.setup:return ee.r=Ce.r,ee.g=Ce.g,void(ee.b=Ce.b);case Qt.first:ee.r+=(Ce.r-ee.r)*b,ee.g+=(Ce.g-ee.g)*b,ee.b+=(Ce.b-ee.b)*b}return}let oe=0,ne=0,ve=0,xe=ya.search(z,p,4),Te=this.curves[xe>>2];switch(Te){case 0:let Ce=z[xe];oe=z[xe+1],ne=z[xe+2],ve=z[xe+3];let Ie=(p-Ce)/(z[xe+4]-Ce);oe+=(z[xe+4+1]-oe)*Ie,ne+=(z[xe+4+2]-ne)*Ie,ve+=(z[xe+4+3]-ve)*Ie;break;case 1:oe=z[xe+1],ne=z[xe+2],ve=z[xe+3];break;default:oe=this.getBezierValue(p,xe,1,Te-2),ne=this.getBezierValue(p,xe,2,Te+18-2),ve=this.getBezierValue(p,xe,3,Te+36-2)}if(1==b)ee.r=oe,ee.g=ne,ee.b=ve;else{if(N==Qt.setup){let Ce=T.data.color;ee.r=Ce.r,ee.g=Ce.g,ee.b=Ce.b}ee.r+=(oe-ee.r)*b,ee.g+=(ne-ee.g)*b,ee.b+=(ve-ee.b)*b}}}class Nm extends vs{constructor(r,h,p){super(r,h,"8|"+p),this.slotIndex=0,this.slotIndex=p}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=T.color;if(p<this.frames[0]){let oe=T.data.color;switch(N){case Qt.setup:return void(z.a=oe.a);case Qt.first:z.a+=(oe.a-z.a)*b}return}let ee=this.getCurveValue(p);1==b?z.a=ee:(N==Qt.setup&&(z.a=T.data.color.a),z.a+=(ee-z.a)*b)}}class Rm extends oc{constructor(r,h,p){super(r,h,["7|"+p,"8|"+p,"9|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 8}setFrame(r,h,p,y,b,N,O,T,z){this.frames[r<<=3]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N,this.frames[r+5]=O,this.frames[r+6]=T,this.frames[r+7]=z}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=this.frames,ee=T.color,oe=T.darkColor;if(p<z[0]){let Ue=T.data.color,Ye=T.data.darkColor;switch(N){case Qt.setup:return ee.setFromColor(Ue),oe.r=Ye.r,oe.g=Ye.g,void(oe.b=Ye.b);case Qt.first:ee.add((Ue.r-ee.r)*b,(Ue.g-ee.g)*b,(Ue.b-ee.b)*b,(Ue.a-ee.a)*b),oe.r+=(Ye.r-oe.r)*b,oe.g+=(Ye.g-oe.g)*b,oe.b+=(Ye.b-oe.b)*b}return}let ne=0,ve=0,xe=0,Te=0,Ce=0,Ie=0,Oe=0,Fe=ya.search(z,p,8),je=this.curves[Fe>>3];switch(je){case 0:let Ue=z[Fe];ne=z[Fe+1],ve=z[Fe+2],xe=z[Fe+3],Te=z[Fe+4],Ce=z[Fe+5],Ie=z[Fe+6],Oe=z[Fe+7];let Ye=(p-Ue)/(z[Fe+8]-Ue);ne+=(z[Fe+8+1]-ne)*Ye,ve+=(z[Fe+8+2]-ve)*Ye,xe+=(z[Fe+8+3]-xe)*Ye,Te+=(z[Fe+8+4]-Te)*Ye,Ce+=(z[Fe+8+5]-Ce)*Ye,Ie+=(z[Fe+8+6]-Ie)*Ye,Oe+=(z[Fe+8+7]-Oe)*Ye;break;case 1:ne=z[Fe+1],ve=z[Fe+2],xe=z[Fe+3],Te=z[Fe+4],Ce=z[Fe+5],Ie=z[Fe+6],Oe=z[Fe+7];break;default:ne=this.getBezierValue(p,Fe,1,je-2),ve=this.getBezierValue(p,Fe,2,je+18-2),xe=this.getBezierValue(p,Fe,3,je+36-2),Te=this.getBezierValue(p,Fe,4,je+54-2),Ce=this.getBezierValue(p,Fe,5,je+72-2),Ie=this.getBezierValue(p,Fe,6,je+90-2),Oe=this.getBezierValue(p,Fe,7,je+108-2)}if(1==b)ee.set(ne,ve,xe,Te),oe.r=Ce,oe.g=Ie,oe.b=Oe;else{if(N==Qt.setup){ee.setFromColor(T.data.color);let Ue=T.data.darkColor;oe.r=Ue.r,oe.g=Ue.g,oe.b=Ue.b}ee.add((ne-ee.r)*b,(ve-ee.g)*b,(xe-ee.b)*b,(Te-ee.a)*b),oe.r+=(Ce-oe.r)*b,oe.g+=(Ie-oe.g)*b,oe.b+=(Oe-oe.b)*b}}}class kd extends oc{constructor(r,h,p){super(r,h,["7|"+p,"9|"+p]),this.slotIndex=0,this.slotIndex=p}getFrameEntries(){return 7}setFrame(r,h,p,y,b,N,O,T){this.frames[r*=7]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N,this.frames[r+5]=O,this.frames[r+6]=T}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=this.frames,ee=T.color,oe=T.darkColor;if(p<z[0]){let je=T.data.color,Ue=T.data.darkColor;switch(N){case Qt.setup:return ee.r=je.r,ee.g=je.g,ee.b=je.b,oe.r=Ue.r,oe.g=Ue.g,void(oe.b=Ue.b);case Qt.first:ee.r+=(je.r-ee.r)*b,ee.g+=(je.g-ee.g)*b,ee.b+=(je.b-ee.b)*b,oe.r+=(Ue.r-oe.r)*b,oe.g+=(Ue.g-oe.g)*b,oe.b+=(Ue.b-oe.b)*b}return}let ne=0,ve=0,xe=0,Te=0,Ce=0,Ie=0,Oe=ya.search(z,p,7),Fe=this.curves[Oe/7];switch(Fe){case 0:let je=z[Oe];ne=z[Oe+1],ve=z[Oe+2],xe=z[Oe+3],Te=z[Oe+4],Ce=z[Oe+5],Ie=z[Oe+6];let Ue=(p-je)/(z[Oe+7]-je);ne+=(z[Oe+7+1]-ne)*Ue,ve+=(z[Oe+7+2]-ve)*Ue,xe+=(z[Oe+7+3]-xe)*Ue,Te+=(z[Oe+7+4]-Te)*Ue,Ce+=(z[Oe+7+5]-Ce)*Ue,Ie+=(z[Oe+7+6]-Ie)*Ue;break;case 1:ne=z[Oe+1],ve=z[Oe+2],xe=z[Oe+3],Te=z[Oe+4],Ce=z[Oe+5],Ie=z[Oe+6];break;default:ne=this.getBezierValue(p,Oe,1,Fe-2),ve=this.getBezierValue(p,Oe,2,Fe+18-2),xe=this.getBezierValue(p,Oe,3,Fe+36-2),Te=this.getBezierValue(p,Oe,4,Fe+54-2),Ce=this.getBezierValue(p,Oe,5,Fe+72-2),Ie=this.getBezierValue(p,Oe,6,Fe+90-2)}if(1==b)ee.r=ne,ee.g=ve,ee.b=xe,oe.r=Te,oe.g=Ce,oe.b=Ie;else{if(N==Qt.setup){let je=T.data.color,Ue=T.data.darkColor;ee.r=je.r,ee.g=je.g,ee.b=je.b,oe.r=Ue.r,oe.g=Ue.g,oe.b=Ue.b}ee.r+=(ne-ee.r)*b,ee.g+=(ve-ee.g)*b,ee.b+=(xe-ee.b)*b,oe.r+=(Te-oe.r)*b,oe.g+=(Ce-oe.g)*b,oe.b+=(Ie-oe.b)*b}}}class dd extends ya{constructor(r,h){super(r,["10|"+h]),this.slotIndex=0,this.slotIndex=h,this.attachmentNames=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.attachmentNames[r]=p}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];T.bone.active&&(O!=Ao.mixOut?p<this.frames[0]?N!=Qt.setup&&N!=Qt.first||this.setAttachment(r,T,T.data.attachmentName):this.setAttachment(r,T,this.attachmentNames[ya.search1(this.frames,p)]):N==Qt.setup&&this.setAttachment(r,T,T.data.attachmentName))}setAttachment(r,h,p){h.setAttachment(p?r.getAttachment(this.slotIndex,p):null)}}class Zf extends oc{constructor(r,h,p,y){super(r,h,["11|"+p+"|"+y.id]),this.slotIndex=0,this.slotIndex=p,this.attachment=y,this.vertices=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.vertices[r]=p}setBezier(r,h,p,y,b,N,O,T,z,ee,oe){let ne=this.curves,ve=this.getFrameCount()+18*r;0==p&&(ne[h]=2+ve);let xe=.03*(y-2*N+T),Te=.03*z-.06*O,Ce=.006*(3*(N-T)-y+ee),Ie=.018*(O-z+.33333333),Oe=2*xe+Ce,Fe=2*Te+Ie,je=.3*(N-y)+xe+.16666667*Ce,Ue=.3*O+Te+.16666667*Ie,Ye=y+je,at=Ue;for(let pt=ve+18;ve<pt;ve+=2)ne[ve]=Ye,ne[ve+1]=at,je+=Oe,Ue+=Fe,Oe+=Ce,Fe+=Ie,Ye+=je,at+=Ue}getCurvePercent(r,h){let p=this.curves,y=p[h];switch(y){case 0:let T=this.frames[h];return(r-T)/(this.frames[h+this.getFrameEntries()]-T);case 1:return 0}if(y-=2,p[y]>r){let T=this.frames[h];return p[y+1]*(r-T)/(p[y]-T)}let b=y+18;for(y+=2;y<b;y+=2)if(p[y]>=r){let T=p[y-2],z=p[y-1];return z+(r-T)/(p[y]-T)*(p[y+1]-z)}let N=p[b-2],O=p[b-1];return O+(1-O)*(r-N)/(this.frames[h+this.getFrameEntries()]-N)}apply(r,h,p,y,b,N,O){let T=r.slots[this.slotIndex];if(!T.bone.active)return;let z=T.getAttachment();if(!(z instanceof Au)||z.deformAttachment!=this.attachment)return;let ee=T.deform;0==ee.length&&(N=Qt.setup);let oe=this.vertices,ne=oe[0].length,ve=this.frames;if(p<ve[0]){let Fe=z;switch(N){case Qt.setup:return void(ee.length=0);case Qt.first:if(1==b)return void(ee.length=0);if(ee.length=ne,Fe.bones)for(b=1-b,xe=0;xe<ne;xe++)ee[xe]*=b;else{let je=Fe.vertices;for(var xe=0;xe<ne;xe++)ee[xe]+=(je[xe]-ee[xe])*b}}return}if(ee.length=ne,p>=ve[ve.length-1]){let Fe=oe[ve.length-1];if(1==b)if(N==Qt.add){let je=z;if(je.bones)for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=Fe[Ue];else{let Ue=je.vertices;for(let Ye=0;Ye<ne;Ye++)ee[Ye]+=Fe[Ye]-Ue[Ye]}}else gr.arrayCopy(Fe,0,ee,0,ne);else switch(N){case Qt.setup:{let Ue=z;if(Ue.bones)for(let Ye=0;Ye<ne;Ye++)ee[Ye]=Fe[Ye]*b;else{let Ye=Ue.vertices;for(let at=0;at<ne;at++){let pt=Ye[at];ee[at]=pt+(Fe[at]-pt)*b}}break}case Qt.first:case Qt.replace:for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=(Fe[Ue]-ee[Ue])*b;break;case Qt.add:let je=z;if(je.bones)for(let Ue=0;Ue<ne;Ue++)ee[Ue]+=Fe[Ue]*b;else{let Ue=je.vertices;for(let Ye=0;Ye<ne;Ye++)ee[Ye]+=(Fe[Ye]-Ue[Ye])*b}}return}let Te=ya.search1(ve,p),Ce=this.getCurvePercent(p,Te),Ie=oe[Te],Oe=oe[Te+1];if(1==b)if(N==Qt.add){let Fe=z;if(Fe.bones)for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=Ue+(Oe[je]-Ue)*Ce}else{let je=Fe.vertices;for(let Ue=0;Ue<ne;Ue++){let Ye=Ie[Ue];ee[Ue]+=Ye+(Oe[Ue]-Ye)*Ce-je[Ue]}}}else for(let Fe=0;Fe<ne;Fe++){let je=Ie[Fe];ee[Fe]=je+(Oe[Fe]-je)*Ce}else switch(N){case Qt.setup:{let je=z;if(je.bones)for(let Ue=0;Ue<ne;Ue++){let Ye=Ie[Ue];ee[Ue]=(Ye+(Oe[Ue]-Ye)*Ce)*b}else{let Ue=je.vertices;for(let Ye=0;Ye<ne;Ye++){let at=Ie[Ye],pt=Ue[Ye];ee[Ye]=pt+(at+(Oe[Ye]-at)*Ce-pt)*b}}break}case Qt.first:case Qt.replace:for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=(Ue+(Oe[je]-Ue)*Ce-ee[je])*b}break;case Qt.add:let Fe=z;if(Fe.bones)for(let je=0;je<ne;je++){let Ue=Ie[je];ee[je]+=(Ue+(Oe[je]-Ue)*Ce)*b}else{let je=Fe.vertices;for(let Ue=0;Ue<ne;Ue++){let Ye=Ie[Ue];ee[Ue]+=(Ye+(Oe[Ue]-Ye)*Ce-je[Ue])*b}}}}}class Fd extends ya{constructor(r){super(r,Fd.propertyIds),this.events=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h){this.frames[r]=h.time,this.events[r]=h}apply(r,h,p,y,b,N,O){if(!y)return;let T=this.frames,z=this.frames.length;if(h>p)this.apply(r,h,Number.MAX_VALUE,y,b,N,O),h=-1;else if(h>=T[z-1])return;if(p<T[0])return;let ee=0;if(h<T[0])ee=0;else{ee=ya.search1(T,h)+1;let oe=T[ee];for(;ee>0&&T[ee-1]==oe;)ee--}for(;ee<z&&p>=T[ee];ee++)y.push(this.events[ee])}}Fd.propertyIds=["12"];class tp extends ya{constructor(r){super(r,tp.propertyIds),this.drawOrders=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,p){this.frames[r]=h,this.drawOrders[r]=p}apply(r,h,p,y,b,N,O){if(O==Ao.mixOut)return void(N==Qt.setup&&gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));if(p<this.frames[0])return void(N!=Qt.setup&&N!=Qt.first||gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));let T=this.drawOrders[ya.search1(this.frames,p)];if(T){let z=r.drawOrder,ee=r.slots;for(let oe=0,ne=T.length;oe<ne;oe++)z[oe]=ee[T[oe]]}else gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length)}}tp.propertyIds=["13"];class Pm extends oc{constructor(r,h,p){super(r,h,["14|"+p]),this.ikConstraintIndex=p}getFrameEntries(){return 6}setFrame(r,h,p,y,b,N,O){this.frames[r*=6]=h,this.frames[r+1]=p,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=N?1:0,this.frames[r+5]=O?1:0}apply(r,h,p,y,b,N,O){let T=r.ikConstraints[this.ikConstraintIndex];if(!T.active)return;let z=this.frames;if(p<z[0]){switch(N){case Qt.setup:return T.mix=T.data.mix,T.softness=T.data.softness,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,void(T.stretch=T.data.stretch);case Qt.first:T.mix+=(T.data.mix-T.mix)*b,T.softness+=(T.data.softness-T.softness)*b,T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch}return}let ee=0,oe=0,ne=ya.search(z,p,6),ve=this.curves[ne/6];switch(ve){case 0:let xe=z[ne];ee=z[ne+1],oe=z[ne+2];let Te=(p-xe)/(z[ne+6]-xe);ee+=(z[ne+6+1]-ee)*Te,oe+=(z[ne+6+2]-oe)*Te;break;case 1:ee=z[ne+1],oe=z[ne+2];break;default:ee=this.getBezierValue(p,ne,1,ve-2),oe=this.getBezierValue(p,ne,2,ve+18-2)}N==Qt.setup?(T.mix=T.data.mix+(ee-T.data.mix)*b,T.softness=T.data.softness+(oe-T.data.softness)*b,O==Ao.mixOut?(T.bendDirection=T.data.bendDirection,T.compress=T.data.compress,T.stretch=T.data.stretch):(T.bendDirection=z[ne+3],T.compress=0!=z[ne+4],T.stretch=0!=z[ne+5])):(T.mix+=(ee-T.mix)*b,T.softness+=(oe-T.softness)*b,O==Ao.mixIn&&(T.bendDirection=z[ne+3],T.compress=0!=z[ne+4],T.stretch=0!=z[ne+5]))}}class Im extends oc{constructor(r,h,p){super(r,h,["15|"+p]),this.transformConstraintIndex=p}getFrameEntries(){return 7}setFrame(r,h,p,y,b,N,O,T){let z=this.frames;z[r*=7]=h,z[r+1]=p,z[r+2]=y,z[r+3]=b,z[r+4]=N,z[r+5]=O,z[r+6]=T}apply(r,h,p,y,b,N,O){let T=r.transformConstraints[this.transformConstraintIndex];if(!T.active)return;let z,ee,oe,ne,ve,xe,Te=this.frames;if(p<Te[0]){let Oe=T.data;switch(N){case Qt.setup:return T.mixRotate=Oe.mixRotate,T.mixX=Oe.mixX,T.mixY=Oe.mixY,T.mixScaleX=Oe.mixScaleX,T.mixScaleY=Oe.mixScaleY,void(T.mixShearY=Oe.mixShearY);case Qt.first:T.mixRotate+=(Oe.mixRotate-T.mixRotate)*b,T.mixX+=(Oe.mixX-T.mixX)*b,T.mixY+=(Oe.mixY-T.mixY)*b,T.mixScaleX+=(Oe.mixScaleX-T.mixScaleX)*b,T.mixScaleY+=(Oe.mixScaleY-T.mixScaleY)*b,T.mixShearY+=(Oe.mixShearY-T.mixShearY)*b}return}let Ce=ya.search(Te,p,7),Ie=this.curves[Ce/7];switch(Ie){case 0:let Oe=Te[Ce];z=Te[Ce+1],ee=Te[Ce+2],oe=Te[Ce+3],ne=Te[Ce+4],ve=Te[Ce+5],xe=Te[Ce+6];let Fe=(p-Oe)/(Te[Ce+7]-Oe);z+=(Te[Ce+7+1]-z)*Fe,ee+=(Te[Ce+7+2]-ee)*Fe,oe+=(Te[Ce+7+3]-oe)*Fe,ne+=(Te[Ce+7+4]-ne)*Fe,ve+=(Te[Ce+7+5]-ve)*Fe,xe+=(Te[Ce+7+6]-xe)*Fe;break;case 1:z=Te[Ce+1],ee=Te[Ce+2],oe=Te[Ce+3],ne=Te[Ce+4],ve=Te[Ce+5],xe=Te[Ce+6];break;default:z=this.getBezierValue(p,Ce,1,Ie-2),ee=this.getBezierValue(p,Ce,2,Ie+18-2),oe=this.getBezierValue(p,Ce,3,Ie+36-2),ne=this.getBezierValue(p,Ce,4,Ie+54-2),ve=this.getBezierValue(p,Ce,5,Ie+72-2),xe=this.getBezierValue(p,Ce,6,Ie+90-2)}if(N==Qt.setup){let Oe=T.data;T.mixRotate=Oe.mixRotate+(z-Oe.mixRotate)*b,T.mixX=Oe.mixX+(ee-Oe.mixX)*b,T.mixY=Oe.mixY+(oe-Oe.mixY)*b,T.mixScaleX=Oe.mixScaleX+(ne-Oe.mixScaleX)*b,T.mixScaleY=Oe.mixScaleY+(ve-Oe.mixScaleY)*b,T.mixShearY=Oe.mixShearY+(xe-Oe.mixShearY)*b}else T.mixRotate+=(z-T.mixRotate)*b,T.mixX+=(ee-T.mixX)*b,T.mixY+=(oe-T.mixY)*b,T.mixScaleX+=(ne-T.mixScaleX)*b,T.mixScaleY+=(ve-T.mixScaleY)*b,T.mixShearY+=(xe-T.mixShearY)*b}}class Om extends vs{constructor(r,h,p){super(r,h,"16|"+p),this.pathConstraintIndex=p}apply(r,h,p,y,b,N,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.position=T.data.position);case Qt.first:T.position+=(T.data.position-T.position)*b}return}let z=this.getCurveValue(p);N==Qt.setup?T.position=T.data.position+(z-T.data.position)*b:T.position+=(z-T.position)*b}}class Qf extends vs{constructor(r,h,p){super(r,h,"17|"+p),this.pathConstraintIndex=0,this.pathConstraintIndex=p}apply(r,h,p,y,b,N,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;if(p<this.frames[0]){switch(N){case Qt.setup:return void(T.spacing=T.data.spacing);case Qt.first:T.spacing+=(T.data.spacing-T.spacing)*b}return}let z=this.getCurveValue(p);N==Qt.setup?T.spacing=T.data.spacing+(z-T.data.spacing)*b:T.spacing+=(z-T.spacing)*b}}class km extends oc{constructor(r,h,p){super(r,h,["18|"+p]),this.pathConstraintIndex=0,this.pathConstraintIndex=p}getFrameEntries(){return 4}setFrame(r,h,p,y,b){let N=this.frames;N[r<<=2]=h,N[r+1]=p,N[r+2]=y,N[r+3]=b}apply(r,h,p,y,b,N,O){let T=r.pathConstraints[this.pathConstraintIndex];if(!T.active)return;let z,ee,oe,ne=this.frames;if(p<ne[0]){switch(N){case Qt.setup:return T.mixRotate=T.data.mixRotate,T.mixX=T.data.mixX,void(T.mixY=T.data.mixY);case Qt.first:T.mixRotate+=(T.data.mixRotate-T.mixRotate)*b,T.mixX+=(T.data.mixX-T.mixX)*b,T.mixY+=(T.data.mixY-T.mixY)*b}return}let ve=ya.search(ne,p,4),xe=this.curves[ve>>2];switch(xe){case 0:let Te=ne[ve];z=ne[ve+1],ee=ne[ve+2],oe=ne[ve+3];let Ce=(p-Te)/(ne[ve+4]-Te);z+=(ne[ve+4+1]-z)*Ce,ee+=(ne[ve+4+2]-ee)*Ce,oe+=(ne[ve+4+3]-oe)*Ce;break;case 1:z=ne[ve+1],ee=ne[ve+2],oe=ne[ve+3];break;default:z=this.getBezierValue(p,ve,1,xe-2),ee=this.getBezierValue(p,ve,2,xe+18-2),oe=this.getBezierValue(p,ve,3,xe+36-2)}if(N==Qt.setup){let Te=T.data;T.mixRotate=Te.mixRotate+(z-Te.mixRotate)*b,T.mixX=Te.mixX+(ee-Te.mixX)*b,T.mixY=Te.mixY+(oe-Te.mixY)*b}else T.mixRotate+=(z-T.mixRotate)*b,T.mixX+=(ee-T.mixX)*b,T.mixY+=(oe-T.mixY)*b}}class Dd{constructor(r){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Fm(this),this.propertyIDs=new el,this.animationsChanged=!1,this.trackEntryPool=new rf(()=>new Kf),this.data=r}static emptyAnimation(){return Bf||(Bf=new $f("<empty>",[],0)),Bf}update(r){r*=this.timeScale;let h=this.tracks;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(!b)continue;b.animationLast=b.nextAnimationLast,b.trackLast=b.nextTrackLast;let N=r*b.timeScale;if(b.delay>0){if(b.delay-=N,b.delay>0)continue;N=-b.delay,b.delay=0}let O=b.next;if(O){let T=b.trackLast-O.delay;if(T>=0){for(O.delay=0,O.trackTime+=0==b.timeScale?0:(T/b.timeScale+r)*O.timeScale,b.trackTime+=N,this.setCurrent(p,O,!0);O.mixingFrom;)O.mixTime+=r,O=O.mixingFrom;continue}}else if(b.trackLast>=b.trackEnd&&!b.mixingFrom){h[p]=null,this.queue.end(b),this.clearNext(b);continue}if(b.mixingFrom&&this.updateMixingFrom(b,r)){let T=b.mixingFrom;for(b.mixingFrom=null,T&&(T.mixingTo=null);T;)this.queue.end(T),T=T.mixingFrom}b.trackTime+=N}this.queue.drain()}updateMixingFrom(r,h){let p=r.mixingFrom;if(!p)return!0;let y=this.updateMixingFrom(p,h);return p.animationLast=p.nextAnimationLast,p.trackLast=p.nextTrackLast,r.mixTime>0&&r.mixTime>=r.mixDuration?(0!=p.totalAlpha&&0!=r.mixDuration||(r.mixingFrom=p.mixingFrom,p.mixingFrom&&(p.mixingFrom.mixingTo=r),r.interruptAlpha=p.interruptAlpha,this.queue.end(p)),y):(p.trackTime+=h*p.timeScale,r.mixTime+=h,!1)}apply(r){if(!r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let h=this.events,p=this.tracks,y=!1;for(let ne=0,ve=p.length;ne<ve;ne++){let xe=p[ne];if(!xe||xe.delay>0)continue;y=!0;let Te=0==ne?Qt.first:xe.mixBlend,Ce=xe.alpha;xe.mixingFrom?Ce*=this.applyMixingFrom(xe,r,Te):xe.trackTime>=xe.trackEnd&&!xe.next&&(Ce=0);let Ie=xe.animationLast,Oe=xe.getAnimationTime(),Fe=Oe,je=h;xe.reverse&&(Fe=xe.animation.duration-Fe,je=null);let Ue=xe.animation.timelines,Ye=Ue.length;if(0==ne&&1==Ce||Te==Qt.add)for(let at=0;at<Ye;at++){gr.webkit602BugfixHelper(Ce,Te);var b=Ue[at];b instanceof dd?this.applyAttachmentTimeline(b,r,Fe,Te,!0):b.apply(r,Ie,Fe,je,Ce,Te,Ao.mixIn)}else{let at=xe.timelineMode,pt=xe.timelinesRotation.length!=Ye<<1;pt&&(xe.timelinesRotation.length=Ye<<1);for(let St=0;St<Ye;St++){let At=Ue[St],Jt=at[St]==Lf?Te:Qt.setup;At instanceof sf?this.applyRotateTimeline(At,r,Fe,Ce,Jt,xe.timelinesRotation,St<<1,pt):At instanceof dd?this.applyAttachmentTimeline(At,r,Fe,Te,!0):(gr.webkit602BugfixHelper(Ce,Te),At.apply(r,Ie,Fe,je,Ce,Jt,Ao.mixIn))}}this.queueEvents(xe,Oe),h.length=0,xe.nextAnimationLast=Oe,xe.nextTrackLast=xe.trackTime}for(var N=this.unkeyedState+nm,O=r.slots,T=0,z=r.slots.length;T<z;T++){var ee=O[T];if(ee.attachmentState==N){var oe=ee.data.attachmentName;ee.setAttachment(oe?r.getAttachment(ee.data.index,oe):null)}}return this.unkeyedState+=2,this.queue.drain(),y}applyMixingFrom(r,h,p){let y=r.mixingFrom;y.mixingFrom&&this.applyMixingFrom(y,h,p);let b=0;0==r.mixDuration?(b=1,p==Qt.first&&(p=Qt.setup)):(b=r.mixTime/r.mixDuration,b>1&&(b=1),p!=Qt.first&&(p=y.mixBlend));let N=b<y.attachmentThreshold,O=b<y.drawOrderThreshold,T=y.animation.timelines,z=T.length,ee=y.alpha*r.interruptAlpha,oe=ee*(1-b),ne=y.animationLast,ve=y.getAnimationTime(),xe=ve,Te=null;if(y.reverse?xe=y.animation.duration-xe:b<y.eventThreshold&&(Te=this.events),p==Qt.add)for(let Ce=0;Ce<z;Ce++)T[Ce].apply(h,ne,xe,Te,oe,p,Ao.mixOut);else{let Ce=y.timelineMode,Ie=y.timelineHoldMix,Oe=y.timelinesRotation.length!=z<<1;Oe&&(y.timelinesRotation.length=z<<1),y.totalAlpha=0;for(let Fe=0;Fe<z;Fe++){let je,Ue=T[Fe],Ye=Ao.mixOut,at=0;switch(Ce[Fe]){case Lf:if(!O&&Ue instanceof tp)continue;je=p,at=oe;break;case em:je=Qt.setup,at=oe;break;case tm:je=p,at=ee;break;case af:je=Qt.setup,at=ee;break;default:je=Qt.setup;let pt=Ie[Fe];at=ee*Math.max(0,1-pt.mixTime/pt.mixDuration)}y.totalAlpha+=at,Ue instanceof sf?this.applyRotateTimeline(Ue,h,xe,at,je,y.timelinesRotation,Fe<<1,Oe):Ue instanceof dd?this.applyAttachmentTimeline(Ue,h,xe,je,N):(gr.webkit602BugfixHelper(at,p),O&&Ue instanceof tp&&je==Qt.setup&&(Ye=Ao.mixIn),Ue.apply(h,ne,xe,Te,at,je,Ye))}}return r.mixDuration>0&&this.queueEvents(y,ve),this.events.length=0,y.nextAnimationLast=ve,y.nextTrackLast=y.trackTime,b}applyAttachmentTimeline(r,h,p,y,b){var N=h.slots[r.slotIndex];N.bone.active&&(p<r.frames[0]?y!=Qt.setup&&y!=Qt.first||this.setAttachment(h,N,N.data.attachmentName,b):this.setAttachment(h,N,r.attachmentNames[ya.search1(r.frames,p)],b),N.attachmentState<=this.unkeyedState&&(N.attachmentState=this.unkeyedState+nm))}setAttachment(r,h,p,y){h.setAttachment(p?r.getAttachment(h.data.index,p):null),y&&(h.attachmentState=this.unkeyedState+Um)}applyRotateTimeline(r,h,p,y,b,N,O,T){if(T&&(N[O]=0),1==y)return void r.apply(h,0,p,null,1,b,Ao.mixIn);let z=h.bones[r.boneIndex];if(!z.active)return;let ee=0,oe=0;if(p<r.frames[0])switch(b){case Qt.setup:z.rotation=z.data.rotation;default:return;case Qt.first:ee=z.rotation,oe=z.data.rotation}else ee=b==Qt.setup?z.data.rotation:z.rotation,oe=z.data.rotation+r.getCurveValue(p);let ne=0,ve=oe-ee;if(ve-=360*(16384-(16384.499999999996-ve/360|0)),0==ve)ne=N[O];else{let xe=0,Te=0;T?(xe=0,Te=ve):(xe=N[O],Te=N[O+1]);let Ce=ve>0,Ie=xe>=0;Cn.signum(Te)!=Cn.signum(ve)&&Math.abs(Te)<=90&&(Math.abs(xe)>180&&(xe+=360*Cn.signum(xe)),Ie=Ce),ne=ve+xe-xe%360,Ie!=Ce&&(ne+=360*Cn.signum(xe)),N[O]=ne}N[O+1]=ve,z.rotation=ee+ne*y}queueEvents(r,h){let p=r.animationStart,y=r.animationEnd,b=y-p,N=r.trackLast%b,O=this.events,T=0,z=O.length;for(;T<z;T++){let oe=O[T];if(oe.time<N)break;oe.time>y||this.queue.event(r,oe)}let ee=!1;for(ee=r.loop?0==b||N>r.trackTime%b:h>=y&&r.animationLast<y,ee&&this.queue.complete(r);T<z;T++){let oe=O[T];oe.time<p||this.queue.event(r,oe)}}clearTracks(){let r=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let h=0,p=this.tracks.length;h<p;h++)this.clearTrack(h);this.tracks.length=0,this.queue.drainDisabled=r,this.queue.drain()}clearTrack(r){if(r>=this.tracks.length)return;let h=this.tracks[r];if(!h)return;this.queue.end(h),this.clearNext(h);let p=h;for(;;){let y=p.mixingFrom;if(!y)break;this.queue.end(y),p.mixingFrom=null,p.mixingTo=null,p=y}this.tracks[h.trackIndex]=null,this.queue.drain()}setCurrent(r,h,p){let y=this.expandToIndex(r);this.tracks[r]=h,h.previous=null,y&&(p&&this.queue.interrupt(y),h.mixingFrom=y,y.mixingTo=h,h.mixTime=0,y.mixingFrom&&y.mixDuration>0&&(h.interruptAlpha*=Math.min(1,y.mixTime/y.mixDuration)),y.timelinesRotation.length=0),this.queue.start(h)}setAnimation(r,h,p=!1){let y=this.data.skeletonData.findAnimation(h);if(!y)throw new Error("Animation not found: "+h);return this.setAnimationWith(r,y,p)}setAnimationWith(r,h,p=!1){if(!h)throw new Error("animation cannot be null.");let y=!0,b=this.expandToIndex(r);b&&(-1==b.nextTrackLast?(this.tracks[r]=b.mixingFrom,this.queue.interrupt(b),this.queue.end(b),this.clearNext(b),b=b.mixingFrom,y=!1):this.clearNext(b));let N=this.trackEntry(r,h,p,b);return this.setCurrent(r,N,y),this.queue.drain(),N}addAnimation(r,h,p=!1,y=0){let b=this.data.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);return this.addAnimationWith(r,b,p,y)}addAnimationWith(r,h,p=!1,y=0){if(!h)throw new Error("animation cannot be null.");let b=this.expandToIndex(r);if(b)for(;b.next;)b=b.next;let N=this.trackEntry(r,h,p,b);return b?(b.next=N,N.previous=b,y<=0&&(y+=b.getTrackComplete()-N.mixDuration)):(this.setCurrent(r,N,!0),this.queue.drain()),N.delay=y,N}setEmptyAnimation(r,h=0){let p=this.setAnimationWith(r,Dd.emptyAnimation(),!1);return p.mixDuration=h,p.trackEnd=h,p}addEmptyAnimation(r,h=0,p=0){let y=this.addAnimationWith(r,Dd.emptyAnimation(),!1,p);return p<=0&&(y.delay+=y.mixDuration-h),y.mixDuration=h,y.trackEnd=h,y}setEmptyAnimations(r=0){let h=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let p=0,y=this.tracks.length;p<y;p++){let b=this.tracks[p];b&&this.setEmptyAnimation(b.trackIndex,r)}this.queue.drainDisabled=h,this.queue.drain()}expandToIndex(r){return r<this.tracks.length?this.tracks[r]:(gr.ensureArrayCapacity(this.tracks,r+1,null),this.tracks.length=r+1,null)}trackEntry(r,h,p,y){let b=this.trackEntryPool.obtain();return b.trackIndex=r,b.animation=h,b.loop=p,b.holdPrevious=!1,b.eventThreshold=0,b.attachmentThreshold=0,b.drawOrderThreshold=0,b.animationStart=0,b.animationEnd=h.duration,b.animationLast=-1,b.nextAnimationLast=-1,b.delay=0,b.trackTime=0,b.trackLast=-1,b.nextTrackLast=-1,b.trackEnd=Number.MAX_VALUE,b.timeScale=1,b.alpha=1,b.interruptAlpha=1,b.mixTime=0,b.mixDuration=y?this.data.getMix(y.animation,h):0,b.mixBlend=Qt.replace,b}clearNext(r){let h=r.next;for(;h;)this.queue.dispose(h),h=h.next;r.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let r=this.tracks;for(let h=0,p=r.length;h<p;h++){let y=r[h];if(y){for(;y.mixingFrom;)y=y.mixingFrom;do{y.mixingTo&&y.mixBlend==Qt.add||this.computeHold(y),y=y.mixingTo}while(y)}}}computeHold(r){let h=r.mixingTo,p=r.animation.timelines,y=r.animation.timelines.length,b=r.timelineMode;b.length=y;let N=r.timelineHoldMix;N.length=0;let O=this.propertyIDs;if(h&&h.holdPrevious)for(let T=0;T<y;T++)b[T]=O.addAll(p[T].getPropertyIds())?af:tm;else e:for(let T=0;T<y;T++){let z=p[T],ee=z.getPropertyIds();if(O.addAll(ee))if(!h||z instanceof dd||z instanceof tp||z instanceof Fd||!h.animation.hasTimeline(ee))b[T]=em;else{for(let oe=h.mixingTo;oe;oe=oe.mixingTo)if(!oe.animation.hasTimeline(ee)){if(r.mixDuration>0){b[T]=Dm,N[T]=oe;continue e}break}b[T]=af}else b[T]=Lf}}getCurrent(r){return r>=this.tracks.length?null:this.tracks[r]}addListener(r){if(!r)throw new Error("listener cannot be null.");this.listeners.push(r)}removeListener(r){let h=this.listeners.indexOf(r);h>=0&&this.listeners.splice(h,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class Kf{constructor(){this.mixBlend=Qt.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let r=this.animationEnd-this.animationStart;return 0==r?this.animationStart:this.trackTime%r+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(r){this.animationLast=r,this.nextAnimationLast=r}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let r=this.animationEnd-this.animationStart;if(0!=r){if(this.loop)return r*(1+(this.trackTime/r|0));if(this.trackTime<r)return r}return this.trackTime}}class Fm{constructor(r){this.objects=[],this.drainDisabled=!1,this.animState=r}start(r){this.objects.push(Pc.start),this.objects.push(r),this.animState.animationsChanged=!0}interrupt(r){this.objects.push(Pc.interrupt),this.objects.push(r)}end(r){this.objects.push(Pc.end),this.objects.push(r),this.animState.animationsChanged=!0}dispose(r){this.objects.push(Pc.dispose),this.objects.push(r)}complete(r){this.objects.push(Pc.complete),this.objects.push(r)}event(r,h){this.objects.push(Pc.event),this.objects.push(r),this.objects.push(h)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let r=this.objects,h=this.animState.listeners;for(let p=0;p<r.length;p+=2){let b=r[p+1];switch(r[p]){case Pc.start:b.listener&&b.listener.start&&b.listener.start(b);for(let O=0;O<h.length;O++)h[O].start&&h[O].start(b);break;case Pc.interrupt:b.listener&&b.listener.interrupt&&b.listener.interrupt(b);for(let O=0;O<h.length;O++)h[O].interrupt&&h[O].interrupt(b);break;case Pc.end:b.listener&&b.listener.end&&b.listener.end(b);for(let O=0;O<h.length;O++)h[O].end&&h[O].end(b);case Pc.dispose:b.listener&&b.listener.dispose&&b.listener.dispose(b);for(let O=0;O<h.length;O++)h[O].dispose&&h[O].dispose(b);this.animState.trackEntryPool.free(b);break;case Pc.complete:b.listener&&b.listener.complete&&b.listener.complete(b);for(let O=0;O<h.length;O++)h[O].complete&&h[O].complete(b);break;case Pc.event:let N=r[2+p++];b.listener&&b.listener.event&&b.listener.event(b,N);for(let O=0;O<h.length;O++)h[O].event&&h[O].event(b,N)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}!function(a){a[a.start=0]="start",a[a.interrupt=1]="interrupt",a[a.end=2]="end",a[a.dispose=3]="dispose",a[a.complete=4]="complete",a[a.event=5]="event"}(Pc||(Pc={}));const Lf=0,em=1,tm=2,af=3,Dm=4,nm=1,Um=2;let Bf=null;class zm{constructor(r){if(this.animationToMixTime={},this.defaultMix=0,!r)throw new Error("skeletonData cannot be null.");this.skeletonData=r}setMix(r,h,p){let y=this.skeletonData.findAnimation(r);if(!y)throw new Error("Animation not found: "+r);let b=this.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);this.setMixWith(y,b,p)}setMixWith(r,h,p){if(!r)throw new Error("from cannot be null.");if(!h)throw new Error("to cannot be null.");this.animationToMixTime[r.name+"."+h.name]=p}getMix(r,h){let y=this.animationToMixTime[r.name+"."+h.name];return void 0===y?this.defaultMix:y}}class lf extends Au{constructor(r){super(r),this.color=new Qr(1,1,1,1)}copy(){let r=new lf(this.name);return this.copyTo(r),r.color.setFromColor(this.color),r}}class Ud extends Au{constructor(r){super(r),this.color=new Qr(.2275,.2275,.8078,1)}copy(){let r=new Ud(this.name);return this.copyTo(r),r.endSlot=this.endSlot,r.color.setFromColor(this.color),r}}class np{constructor(r){this._image=r}getImage(){return this._image}}var Ks,Ch,Ic,sc,ac,fd,zd,md,ba,Np,cf;(function(a){a[a.Nearest=9728]="Nearest",a[a.Linear=9729]="Linear",a[a.MipMap=9987]="MipMap",a[a.MipMapNearestNearest=9984]="MipMapNearestNearest",a[a.MipMapLinearNearest=9985]="MipMapLinearNearest",a[a.MipMapNearestLinear=9986]="MipMapNearestLinear",a[a.MipMapLinearLinear=9987]="MipMapLinearLinear"})(Ks||(Ks={})),function(a){a[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat"}(Ch||(Ch={}));class jd{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}class _d{constructor(r){this.pages=new Array,this.regions=new Array;let h=new uf(r),p=new Array(4),y=null,b=null,N={size:()=>{y.width=parseInt(p[1]),y.height=parseInt(p[2])},format:()=>{},filter:()=>{y.minFilter=gr.enumValue(Ks,p[1]),y.magFilter=gr.enumValue(Ks,p[2])},repeat:()=>{-1!=p[1].indexOf("x")&&(y.uWrap=Ch.Repeat),-1!=p[1].indexOf("y")&&(y.vWrap=Ch.Repeat)},pma:()=>{y.pma="true"==p[1]}};var O={xy:()=>{b.x=parseInt(p[1]),b.y=parseInt(p[2])},size:()=>{b.width=parseInt(p[1]),b.height=parseInt(p[2])},bounds:()=>{b.x=parseInt(p[1]),b.y=parseInt(p[2]),b.width=parseInt(p[3]),b.height=parseInt(p[4])},offset:()=>{b.offsetX=parseInt(p[1]),b.offsetY=parseInt(p[2])},orig:()=>{b.originalWidth=parseInt(p[1]),b.originalHeight=parseInt(p[2])},offsets:()=>{b.offsetX=parseInt(p[1]),b.offsetY=parseInt(p[2]),b.originalWidth=parseInt(p[3]),b.originalHeight=parseInt(p[4])},rotate:()=>{let oe=p[1];"true"==oe?b.degrees=90:"false"!=oe&&(b.degrees=parseInt(oe))},index:()=>{b.index=parseInt(p[1])}};let T=h.readLine();for(;T&&0==T.trim().length;)T=h.readLine();for(;T&&0!=T.trim().length&&0!=h.readEntry(p,T);)T=h.readLine();let z=null,ee=null;for(;null!==T;)if(0==T.trim().length)y=null,T=h.readLine();else if(y){for(b=new Xp,b.page=y,b.name=T;;){let oe=h.readEntry(p,T=h.readLine());if(0==oe)break;let ne=O[p[0]];if(ne)ne();else{z||(z=[],ee=[]),z.push(p[0]);let ve=[];for(let xe=0;xe<oe;xe++)ve.push(parseInt(p[xe+1]));ee.push(ve)}}0==b.originalWidth&&0==b.originalHeight&&(b.originalWidth=b.width,b.originalHeight=b.height),z&&z.length>0&&(b.names=z,b.values=ee,z=null,ee=null),b.u=b.x/y.width,b.v=b.y/y.height,90==b.degrees?(b.u2=(b.x+b.height)/y.width,b.v2=(b.y+b.width)/y.height):(b.u2=(b.x+b.width)/y.width,b.v2=(b.y+b.height)/y.height),this.regions.push(b)}else{for(y=new hf,y.name=T.trim();0!=h.readEntry(p,T=h.readLine());){let oe=N[p[0]];oe&&oe()}this.pages.push(y)}}findRegion(r){for(let h=0;h<this.regions.length;h++)if(this.regions[h].name==r)return this.regions[h];return null}setTextures(r,h=""){for(let p of this.pages)p.setTexture(r.get(h+p.name))}dispose(){for(let r=0;r<this.pages.length;r++)this.pages[r].texture.dispose()}}class uf{constructor(r){this.index=0,this.lines=r.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(r,h){if(!h||0==(h=h.trim()).length)return 0;let p=h.indexOf(":");if(-1==p)return 0;r[0]=h.substr(0,p).trim();for(let y=1,b=p+1;;y++){let N=h.indexOf(",",b);if(-1==N)return r[y]=h.substr(b).trim(),y;if(r[y]=h.substr(b,N-b).trim(),b=N+1,4==y)return 4}}}class hf{constructor(){this.minFilter=Ks.Nearest,this.magFilter=Ks.Nearest,this.uWrap=Ch.ClampToEdge,this.vWrap=Ch.ClampToEdge}setTexture(r){this.texture=r,r.setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap)}}class Xp extends jd{}class Pa extends Au{constructor(r){super(r),this.color=new Qr(1,1,1,1),this.tempColor=new Qr(0,0,0,0)}updateUVs(){let r=this.regionUVs;this.uvs&&this.uvs.length==r.length||(this.uvs=gr.newFloatArray(r.length));let h=this.uvs,p=this.uvs.length,y=this.region.u,b=this.region.v,N=0,O=0;if(this.region instanceof Xp){let T=this.region,z=T.page.texture.getImage(),ee=z.width,oe=z.height;switch(T.degrees){case 90:y-=(T.originalHeight-T.offsetY-T.height)/ee,b-=(T.originalWidth-T.offsetX-T.width)/oe,N=T.originalHeight/ee,O=T.originalWidth/oe;for(let ne=0;ne<p;ne+=2)h[ne]=y+r[ne+1]*N,h[ne+1]=b+(1-r[ne])*O;return;case 180:y-=(T.originalWidth-T.offsetX-T.width)/ee,b-=T.offsetY/oe,N=T.originalWidth/ee,O=T.originalHeight/oe;for(let ne=0;ne<p;ne+=2)h[ne]=y+(1-r[ne])*N,h[ne+1]=b+(1-r[ne+1])*O;return;case 270:y-=T.offsetY/ee,b-=T.offsetX/oe,N=T.originalHeight/ee,O=T.originalWidth/oe;for(let ne=0;ne<p;ne+=2)h[ne]=y+(1-r[ne+1])*N,h[ne+1]=b+r[ne]*O;return}y-=T.offsetX/ee,b-=(T.originalHeight-T.offsetY-T.height)/oe,N=T.originalWidth/ee,O=T.originalHeight/oe}else this.region?(N=this.region.u2-y,O=this.region.v2-b):(y=b=0,N=O=1);for(let T=0;T<p;T+=2)h[T]=y+r[T]*N,h[T+1]=b+r[T+1]*O}getParentMesh(){return this.parentMesh}setParentMesh(r){this.parentMesh=r,r&&(this.bones=r.bones,this.vertices=r.vertices,this.worldVerticesLength=r.worldVerticesLength,this.regionUVs=r.regionUVs,this.triangles=r.triangles,this.hullLength=r.hullLength,this.worldVerticesLength=r.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let r=new Pa(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),this.copyTo(r),r.regionUVs=new Array(this.regionUVs.length),gr.arrayCopy(this.regionUVs,0,r.regionUVs,0,this.regionUVs.length),r.uvs=new Array(this.uvs.length),gr.arrayCopy(this.uvs,0,r.uvs,0,this.uvs.length),r.triangles=new Array(this.triangles.length),gr.arrayCopy(this.triangles,0,r.triangles,0,this.triangles.length),r.hullLength=this.hullLength,this.edges&&(r.edges=new Array(this.edges.length),gr.arrayCopy(this.edges,0,r.edges,0,this.edges.length)),r.width=this.width,r.height=this.height,r}newLinkedMesh(){let r=new Pa(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),r.deformAttachment=this.deformAttachment,r.setParentMesh(this.parentMesh?this.parentMesh:this),r.updateUVs(),r}}class $u extends Au{constructor(r){super(r),this.closed=!1,this.constantSpeed=!1,this.color=new Qr(1,1,1,1)}copy(){let r=new $u(this.name);return this.copyTo(r),r.lengths=new Array(this.lengths.length),gr.arrayCopy(this.lengths,0,r.lengths,0,this.lengths.length),r.closed=closed,r.constantSpeed=this.constantSpeed,r.color.setFromColor(this.color),r}}class Lh extends Au{constructor(r){super(r),this.color=new Qr(.38,.94,0,1)}computeWorldPosition(r,h){return h.x=this.x*r.a+this.y*r.b+r.worldX,h.y=this.x*r.c+this.y*r.d+r.worldY,h}computeWorldRotation(r){let h=Cn.cosDeg(this.rotation),p=Cn.sinDeg(this.rotation);return Math.atan2(h*r.c+p*r.d,h*r.a+p*r.b)*Cn.radDeg}copy(){let r=new Lh(this.name);return r.x=this.x,r.y=this.y,r.rotation=this.rotation,r.color.setFromColor(this.color),r}}class _i extends Af{constructor(r){super(r),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new Qr(1,1,1,1),this.offset=gr.newFloatArray(8),this.uvs=gr.newFloatArray(8),this.tempColor=new Qr(1,1,1,1)}updateOffset(){let r=this.width/this.region.originalWidth*this.scaleX,h=this.height/this.region.originalHeight*this.scaleY,p=-this.width/2*this.scaleX+this.region.offsetX*r,y=-this.height/2*this.scaleY+this.region.offsetY*h,b=p+this.region.width*r,N=y+this.region.height*h,O=this.rotation*Math.PI/180,T=Math.cos(O),z=Math.sin(O),ee=this.x,oe=this.y,ne=p*T+ee,ve=p*z,xe=y*T+oe,Te=y*z,Ce=b*T+ee,Ie=b*z,Oe=N*T+oe,Fe=N*z,je=this.offset;je[0]=ne-Te,je[1]=xe+ve,je[2]=ne-Fe,je[3]=Oe+ve,je[4]=Ce-Fe,je[5]=Oe+Ie,je[6]=Ce-Te,je[7]=xe+Ie}setRegion(r){this.region=r;let h=this.uvs;90==r.degrees?(h[2]=r.u,h[3]=r.v2,h[4]=r.u,h[5]=r.v,h[6]=r.u2,h[7]=r.v,h[0]=r.u2,h[1]=r.v2):(h[0]=r.u,h[1]=r.v2,h[2]=r.u,h[3]=r.v,h[4]=r.u2,h[5]=r.v,h[6]=r.u2,h[7]=r.v2)}computeWorldVertices(r,h,p,y){let b=this.offset,N=r.worldX,O=r.worldY,T=r.a,z=r.b,ee=r.c,oe=r.d,ne=0,ve=0;ne=b[0],ve=b[1],h[p]=ne*T+ve*z+N,h[p+1]=ne*ee+ve*oe+O,ne=b[2],ve=b[3],h[p+=y]=ne*T+ve*z+N,h[p+1]=ne*ee+ve*oe+O,ne=b[4],ve=b[5],h[p+=y]=ne*T+ve*z+N,h[p+1]=ne*ee+ve*oe+O,ne=b[6],ve=b[7],h[p+=y]=ne*T+ve*z+N,h[p+1]=ne*ee+ve*oe+O}copy(){let r=new _i(this.name);return r.region=this.region,r.rendererObject=this.rendererObject,r.path=this.path,r.x=this.x,r.y=this.y,r.scaleX=this.scaleX,r.scaleY=this.scaleY,r.rotation=this.rotation,r.width=this.width,r.height=this.height,gr.arrayCopy(this.uvs,0,r.uvs,0,8),gr.arrayCopy(this.offset,0,r.offset,0,8),r.color.setFromColor(this.color),r}}_i.X1=0,_i.Y1=1,_i.C1R=2,_i.C1G=3,_i.C1B=4,_i.C1A=5,_i.U1=6,_i.V1=7,_i.X2=8,_i.Y2=9,_i.C2R=10,_i.C2G=11,_i.C2B=12,_i.C2A=13,_i.U2=14,_i.V2=15,_i.X3=16,_i.Y3=17,_i.C3R=18,_i.C3G=19,_i.C3B=20,_i.C3A=21,_i.U3=22,_i.V3=23,_i.X4=24,_i.Y4=25,_i.C4R=26,_i.C4G=27,_i.C4B=28,_i.C4A=29,_i.U4=30,_i.V4=31;class gd{constructor(r){this.atlas=r}newRegionAttachment(r,h,p){let y=this.atlas.findRegion(p);if(!y)throw new Error("Region not found in atlas: "+p+" (region attachment: "+h+")");y.renderObject=y;let b=new _i(h);return b.setRegion(y),b}newMeshAttachment(r,h,p){let y=this.atlas.findRegion(p);if(!y)throw new Error("Region not found in atlas: "+p+" (mesh attachment: "+h+")");y.renderObject=y;let b=new Pa(h);return b.region=y,b}newBoundingBoxAttachment(r,h){return new lf(h)}newPathAttachment(r,h){return new $u(h)}newPointAttachment(r,h){return new Lh(h)}newClippingAttachment(r,h){return new Ud(h)}}class vd{constructor(r,h,p){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=Ic.Normal,this.skinRequired=!1,this.color=new Qr,r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");this.index=r,this.name=h,this.parent=p}}!function(a){a[a.Normal=0]="Normal",a[a.OnlyTranslation=1]="OnlyTranslation",a[a.NoRotationOrReflection=2]="NoRotationOrReflection",a[a.NoScale=3]="NoScale",a[a.NoScaleOrReflection=4]="NoScaleOrReflection"}(Ic||(Ic={}));class Rp{constructor(r,h,p){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.skeleton=h,this.parent=p,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(r,h,p,y,b,N,O){this.ax=r,this.ay=h,this.arotation=p,this.ascaleX=y,this.ascaleY=b,this.ashearX=N,this.ashearY=O;let T=this.parent;if(!T){let ve=this.skeleton,xe=p+90+O,Te=ve.scaleX,Ce=ve.scaleY;return this.a=Cn.cosDeg(p+N)*y*Te,this.b=Cn.cosDeg(xe)*b*Te,this.c=Cn.sinDeg(p+N)*y*Ce,this.d=Cn.sinDeg(xe)*b*Ce,this.worldX=r*Te+ve.x,void(this.worldY=h*Ce+ve.y)}let z=T.a,ee=T.b,oe=T.c,ne=T.d;switch(this.worldX=z*r+ee*h+T.worldX,this.worldY=oe*r+ne*h+T.worldY,this.data.transformMode){case Ic.Normal:{let ve=p+90+O,xe=Cn.cosDeg(p+N)*y,Te=Cn.cosDeg(ve)*b,Ce=Cn.sinDeg(p+N)*y,Ie=Cn.sinDeg(ve)*b;return this.a=z*xe+ee*Ce,this.b=z*Te+ee*Ie,this.c=oe*xe+ne*Ce,void(this.d=oe*Te+ne*Ie)}case Ic.OnlyTranslation:{let ve=p+90+O;this.a=Cn.cosDeg(p+N)*y,this.b=Cn.cosDeg(ve)*b,this.c=Cn.sinDeg(p+N)*y,this.d=Cn.sinDeg(ve)*b;break}case Ic.NoRotationOrReflection:{let ve=z*z+oe*oe,xe=0;ve>1e-4?(ve=Math.abs(z*ne-ee*oe)/ve,z/=this.skeleton.scaleX,oe/=this.skeleton.scaleY,ee=oe*ve,ne=z*ve,xe=Math.atan2(oe,z)*Cn.radDeg):(z=0,oe=0,xe=90-Math.atan2(ne,ee)*Cn.radDeg);let Te=p+N-xe,Ce=p+O-xe+90,Ie=Cn.cosDeg(Te)*y,Oe=Cn.cosDeg(Ce)*b,Fe=Cn.sinDeg(Te)*y,je=Cn.sinDeg(Ce)*b;this.a=z*Ie-ee*Fe,this.b=z*Oe-ee*je,this.c=oe*Ie+ne*Fe,this.d=oe*Oe+ne*je;break}case Ic.NoScale:case Ic.NoScaleOrReflection:{let ve=Cn.cosDeg(p),xe=Cn.sinDeg(p),Te=(z*ve+ee*xe)/this.skeleton.scaleX,Ce=(oe*ve+ne*xe)/this.skeleton.scaleY,Ie=Math.sqrt(Te*Te+Ce*Ce);Ie>1e-5&&(Ie=1/Ie),Te*=Ie,Ce*=Ie,Ie=Math.sqrt(Te*Te+Ce*Ce),this.data.transformMode==Ic.NoScale&&z*ne-ee*oe<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(Ie=-Ie);let Oe=Math.PI/2+Math.atan2(Ce,Te),Fe=Math.cos(Oe)*Ie,je=Math.sin(Oe)*Ie,Ue=Cn.cosDeg(N)*y,Ye=Cn.cosDeg(90+O)*b,at=Cn.sinDeg(N)*y,pt=Cn.sinDeg(90+O)*b;this.a=Te*Ue+Fe*at,this.b=Te*Ye+Fe*pt,this.c=Ce*Ue+je*at,this.d=Ce*Ye+je*pt;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let r=this.data;this.x=r.x,this.y=r.y,this.rotation=r.rotation,this.scaleX=r.scaleX,this.scaleY=r.scaleY,this.shearX=r.shearX,this.shearY=r.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*Cn.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*Cn.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){let r=this.parent;if(!r)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*Cn.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*Cn.radDeg);let h=r.a,p=r.b,y=r.c,b=r.d,N=1/(h*b-p*y),O=this.worldX-r.worldX,T=this.worldY-r.worldY;this.ax=O*b*N-T*p*N,this.ay=T*h*N-O*y*N;let z=N*b,ee=N*h,oe=N*p,ne=N*y,ve=z*this.a-oe*this.c,xe=z*this.b-oe*this.d,Te=ee*this.c-ne*this.a,Ce=ee*this.d-ne*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(ve*ve+Te*Te),this.ascaleX>1e-4){let Ie=ve*Ce-xe*Te;this.ascaleY=Ie/this.ascaleX,this.ashearY=Math.atan2(ve*xe+Te*Ce,Ie)*Cn.radDeg,this.arotation=Math.atan2(Te,ve)*Cn.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(xe*xe+Ce*Ce),this.ashearY=0,this.arotation=90-Math.atan2(Ce,xe)*Cn.radDeg}worldToLocal(r){let h=1/(this.a*this.d-this.b*this.c),p=r.x-this.worldX,y=r.y-this.worldY;return r.x=p*this.d*h-y*this.b*h,r.y=y*this.a*h-p*this.c*h,r}localToWorld(r){let h=r.x,p=r.y;return r.x=h*this.a+p*this.b+this.worldX,r.y=h*this.c+p*this.d+this.worldY,r}worldToLocalRotation(r){let h=Cn.sinDeg(r),p=Cn.cosDeg(r);return Math.atan2(this.a*h-this.c*p,this.d*p-this.b*h)*Cn.radDeg+this.rotation-this.shearX}localToWorldRotation(r){let h=Cn.sinDeg(r-=this.rotation-this.shearX),p=Cn.cosDeg(r);return Math.atan2(p*this.c+h*this.d,p*this.a+h*this.b)*Cn.radDeg}rotateWorld(r){let h=this.a,p=this.b,y=this.c,b=this.d,N=Cn.cosDeg(r),O=Cn.sinDeg(r);this.a=N*h-O*y,this.b=N*p-O*b,this.c=O*h+N*y,this.d=O*p+N*b}}class yd{constructor(r,h){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mix=r.mix,this.softness=r.softness,this.bendDirection=r.bendDirection,this.compress=r.compress,this.stretch=r.stretch,this.bones=new Array;for(let p=0;p<r.bones.length;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){if(0==this.mix)return;let r=this.target,h=this.bones;switch(h.length){case 1:this.apply1(h[0],r.worldX,r.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(h[0],h[1],r.worldX,r.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(r,h,p,y,b,N,O){let T=r.parent,z=T.a,ee=T.b,oe=T.c,ne=T.d,ve=-r.ashearX-r.arotation,xe=0,Te=0;switch(r.data.transformMode){case Ic.OnlyTranslation:xe=h-r.worldX,Te=p-r.worldY;break;case Ic.NoRotationOrReflection:let Oe=Math.abs(z*ne-ee*oe)/(z*z+oe*oe),Fe=z/r.skeleton.scaleX,je=oe/r.skeleton.scaleY;ee=-je*Oe*r.skeleton.scaleX,ne=Fe*Oe*r.skeleton.scaleY,ve+=Math.atan2(je,Fe)*Cn.radDeg;default:let Ue=h-T.worldX,Ye=p-T.worldY,at=z*ne-ee*oe;xe=(Ue*ne-Ye*ee)/at-r.ax,Te=(Ye*z-Ue*oe)/at-r.ay}ve+=Math.atan2(Te,xe)*Cn.radDeg,r.ascaleX<0&&(ve+=180),ve>180?ve-=360:ve<-180&&(ve+=360);let Ce=r.ascaleX,Ie=r.ascaleY;if(y||b){switch(r.data.transformMode){case Ic.NoScale:case Ic.NoScaleOrReflection:xe=h-r.worldX,Te=p-r.worldY}let Oe=r.data.length*Ce,Fe=Math.sqrt(xe*xe+Te*Te);if(y&&Fe<Oe||b&&Fe>Oe&&Oe>1e-4){let je=(Fe/Oe-1)*O+1;Ce*=je,N&&(Ie*=je)}}r.updateWorldTransformWith(r.ax,r.ay,r.arotation+ve*O,Ce,Ie,r.ashearX,r.ashearY)}apply2(r,h,p,y,b,N,O,T,z){let ee=r.ax,oe=r.ay,ne=r.ascaleX,ve=r.ascaleY,xe=ne,Te=ve,Ce=h.ascaleX,Ie=0,Oe=0,Fe=0;ne<0?(ne=-ne,Ie=180,Fe=-1):(Ie=0,Fe=1),ve<0&&(ve=-ve,Fe=-Fe),Ce<0?(Ce=-Ce,Oe=180):Oe=0;let je=h.ax,Ue=0,Ye=0,at=0,pt=r.a,St=r.b,At=r.c,Jt=r.d,jt=Math.abs(ne-ve)<=1e-4;!jt||N?(Ue=0,Ye=pt*je+r.worldX,at=At*je+r.worldY):(Ue=h.ay,Ye=pt*je+St*Ue+r.worldX,at=At*je+Jt*Ue+r.worldY);let Pt=r.parent;pt=Pt.a,St=Pt.b,At=Pt.c,Jt=Pt.d;let Nt,ft,$t=1/(pt*Jt-St*At),Zt=Ye-Pt.worldX,_n=at-Pt.worldY,xn=(Zt*Jt-_n*St)*$t-ee,wr=(_n*pt-Zt*At)*$t-oe,ir=Math.sqrt(xn*xn+wr*wr),Hn=h.data.length*Ce;if(ir<1e-4)return this.apply1(r,p,y,!1,N,!1,z),void h.updateWorldTransformWith(je,Ue,0,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY);Zt=p-Pt.worldX,_n=y-Pt.worldY;let lr=(Zt*Jt-_n*St)*$t-ee,Yn=(_n*pt-Zt*At)*$t-oe,fr=lr*lr+Yn*Yn;if(0!=T){T*=ne*(Ce+1)*.5;let po=Math.sqrt(fr),wo=po-ir-Hn*ne+T;if(wo>0){let Uo=Math.min(1,wo/(2*T))-1;Uo=(wo-T*(1-Uo*Uo))/po,lr-=Uo*lr,Yn-=Uo*Yn,fr=lr*lr+Yn*Yn}}e:if(jt){Hn*=ne;let po=(fr-ir*ir-Hn*Hn)/(2*ir*Hn);po<-1?(po=-1,ft=Math.PI*b):po>1?(po=1,ft=0,N&&(pt=(Math.sqrt(fr)/(ir+Hn)-1)*z+1,xe*=pt,O&&(Te*=pt))):ft=Math.acos(po)*b,pt=ir+Hn*po,St=Hn*Math.sin(ft),Nt=Math.atan2(Yn*pt-lr*St,lr*pt+Yn*St)}else{pt=ne*Hn,St=ve*Hn;let po=pt*pt,wo=St*St,Uo=Math.atan2(Yn,lr);At=wo*ir*ir+po*fr-po*wo;let Hs=-2*wo*ir,Vs=wo-po;if(Jt=Hs*Hs-4*Vs*At,Jt>=0){let Uc=Math.sqrt(Jt);Hs<0&&(Uc=-Uc),Uc=.5*-(Hs+Uc);let up=Uc/Vs,fh=At/Uc,il=Math.abs(up)<Math.abs(fh)?up:fh;if(il*il<=fr){_n=Math.sqrt(fr-il*il)*b,Nt=Uo-Math.atan2(_n,il),ft=Math.atan2(_n/ve,(il-ir)/ne);break e}}let za=Cn.PI,ja=ir-pt,Ga=ja*ja,Hl=0,ap=0,lp=ir+pt,Up=lp*lp,Sd=0;At=-pt*ir/(po-wo),At>=-1&&At<=1&&(At=Math.acos(At),Zt=pt*Math.cos(At)+ir,_n=St*Math.sin(At),Jt=Zt*Zt+_n*_n,Jt<Ga&&(za=At,Ga=Jt,ja=Zt,Hl=_n),Jt>Up&&(ap=At,Up=Jt,lp=Zt,Sd=_n)),fr<=.5*(Ga+Up)?(Nt=Uo-Math.atan2(Hl*b,ja),ft=za*b):(Nt=Uo-Math.atan2(Sd*b,lp),ft=ap*b)}let zr=Math.atan2(Ue,je)*Fe,xo=r.arotation;Nt=(Nt-zr)*Cn.radDeg+Ie-xo,Nt>180?Nt-=360:Nt<-180&&(Nt+=360),r.updateWorldTransformWith(ee,oe,xo+Nt*z,xe,Te,0,0),xo=h.arotation,ft=((ft+zr)*Cn.radDeg-h.ashearX)*Fe+Oe-xo,ft>180?ft-=360:ft<-180&&(ft+=360),h.updateWorldTransformWith(je,Ue,xo+ft*z,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY)}}class Pp{constructor(r,h,p){this.name=r,this.order=h,this.skinRequired=p}}class Gd extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0}}(Np=sc||(sc={}))[Np.Fixed=0]="Fixed",Np[Np.Percent=1]="Percent",(ba=ac||(ac={}))[ba.Length=0]="Length",ba[ba.Fixed=1]="Fixed",ba[ba.Percent=2]="Percent",ba[ba.Proportional=3]="Proportional",function(a){a[a.Tangent=0]="Tangent",a[a.Chain=1]="Chain",a[a.ChainScale=2]="ChainScale"}(fd||(fd={}));class lc{constructor(r,h){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.bones=new Array;for(let p=0,y=r.bones.length;p<y;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findSlot(r.target.name),this.position=r.position,this.spacing=r.spacing,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY}isActive(){return this.active}update(){let r=this.target.getAttachment();if(!(r instanceof $u))return;let h=this.mixRotate,p=this.mixX,y=this.mixY;if(0==h&&0==p&&0==y)return;let b=this.data,N=b.rotateMode==fd.Tangent,O=b.rotateMode==fd.ChainScale,T=this.bones,z=T.length,ee=N?z:z+1,oe=gr.setArraySize(this.spaces,ee),ne=O?this.lengths=gr.setArraySize(this.lengths,z):null,ve=this.spacing;switch(b.spacingMode){case ac.Percent:if(O)for(let Ue=0,Ye=ee-1;Ue<Ye;Ue++){let at=T[Ue],pt=at.data.length;if(pt<lc.epsilon)ne[Ue]=0;else{let St=pt*at.a,At=pt*at.c;ne[Ue]=Math.sqrt(St*St+At*At)}}gr.arrayFill(oe,1,ee,ve);break;case ac.Proportional:let Fe=0;for(let Ue=0,Ye=ee-1;Ue<Ye;){let at=T[Ue],pt=at.data.length;if(pt<lc.epsilon)O&&(ne[Ue]=0),oe[++Ue]=ve;else{let St=pt*at.a,At=pt*at.c,Jt=Math.sqrt(St*St+At*At);O&&(ne[Ue]=Jt),oe[++Ue]=Jt,Fe+=Jt}}if(Fe>0){Fe=ee/Fe*ve;for(let Ue=1;Ue<ee;Ue++)oe[Ue]*=Fe}break;default:let je=b.spacingMode==ac.Length;for(let Ue=0,Ye=ee-1;Ue<Ye;){let at=T[Ue],pt=at.data.length;if(pt<lc.epsilon)O&&(ne[Ue]=0),oe[++Ue]=ve;else{let St=pt*at.a,At=pt*at.c,Jt=Math.sqrt(St*St+At*At);O&&(ne[Ue]=Jt),oe[++Ue]=(je?pt+ve:ve)*Jt/pt}}}let xe=this.computeWorldPositions(r,ee,N),Te=xe[0],Ce=xe[1],Ie=b.offsetRotation,Oe=!1;if(0==Ie)Oe=b.rotateMode==fd.Chain;else{Oe=!1;let Fe=this.target.bone;Ie*=Fe.a*Fe.d-Fe.b*Fe.c>0?Cn.degRad:-Cn.degRad}for(let Fe=0,je=3;Fe<z;Fe++,je+=3){let Ue=T[Fe];Ue.worldX+=(Te-Ue.worldX)*p,Ue.worldY+=(Ce-Ue.worldY)*y;let Ye=xe[je],at=xe[je+1],pt=Ye-Te,St=at-Ce;if(O){let At=ne[Fe];if(0!=At){let Jt=(Math.sqrt(pt*pt+St*St)/At-1)*h+1;Ue.a*=Jt,Ue.c*=Jt}}if(Te=Ye,Ce=at,h>0){let At=Ue.a,Jt=Ue.b,jt=Ue.c,Pt=Ue.d,Nt=0,ft=0,$t=0;if(Nt=N?xe[je-1]:0==oe[Fe+1]?xe[je+2]:Math.atan2(St,pt),Nt-=Math.atan2(jt,At),Oe){ft=Math.cos(Nt),$t=Math.sin(Nt);let Zt=Ue.data.length;Te+=(Zt*(ft*At-$t*jt)-pt)*h,Ce+=(Zt*($t*At+ft*jt)-St)*h}else Nt+=Ie;Nt>Cn.PI?Nt-=Cn.PI2:Nt<-Cn.PI&&(Nt+=Cn.PI2),Nt*=h,ft=Math.cos(Nt),$t=Math.sin(Nt),Ue.a=ft*At-$t*jt,Ue.b=ft*Jt-$t*Pt,Ue.c=$t*At+ft*jt,Ue.d=$t*Jt+ft*Pt}Ue.updateAppliedTransform()}}computeWorldPositions(r,h,p){let y=this.target,b=this.position,N=this.spaces,O=gr.setArraySize(this.positions,3*h+2),T=null,z=r.closed,ee=r.worldVerticesLength,oe=ee/6,ne=lc.NONE;if(!r.constantSpeed){let _n=r.lengths;oe-=z?1:2;let xn,wr=_n[oe];switch(this.data.positionMode==sc.Percent&&(b*=wr),this.data.spacingMode){case ac.Percent:xn=wr;break;case ac.Proportional:xn=wr/h;break;default:xn=1}T=gr.setArraySize(this.world,8);for(let ir=0,Hn=0,lr=0;ir<h;ir++,Hn+=3){let Yn=N[ir]*xn;b+=Yn;let fr=b;if(z)fr%=wr,fr<0&&(fr+=wr),lr=0;else{if(fr<0){ne!=lc.BEFORE&&(ne=lc.BEFORE,r.computeWorldVertices(y,2,4,T,0,2)),this.addBeforePosition(fr,T,0,O,Hn);continue}if(fr>wr){ne!=lc.AFTER&&(ne=lc.AFTER,r.computeWorldVertices(y,ee-6,4,T,0,2)),this.addAfterPosition(fr-wr,T,0,O,Hn);continue}}for(;;lr++){let zr=_n[lr];if(!(fr>zr)){if(0==lr)fr/=zr;else{let xo=_n[lr-1];fr=(fr-xo)/(zr-xo)}break}}lr!=ne&&(ne=lr,z&&lr==oe?(r.computeWorldVertices(y,ee-4,4,T,0,2),r.computeWorldVertices(y,0,4,T,4,2)):r.computeWorldVertices(y,6*lr+2,8,T,0,2)),this.addCurvePosition(fr,T[0],T[1],T[2],T[3],T[4],T[5],T[6],T[7],O,Hn,p||ir>0&&0==Yn)}return O}z?(ee+=2,T=gr.setArraySize(this.world,ee),r.computeWorldVertices(y,2,ee-4,T,0,2),r.computeWorldVertices(y,0,2,T,ee-4,2),T[ee-2]=T[0],T[ee-1]=T[1]):(oe--,ee-=4,T=gr.setArraySize(this.world,ee),r.computeWorldVertices(y,2,ee,T,0,2));let ve,xe=gr.setArraySize(this.curves,oe),Te=0,Ce=T[0],Ie=T[1],Oe=0,Fe=0,je=0,Ue=0,Ye=0,at=0,pt=0,St=0,At=0,Jt=0,jt=0,Pt=0,Nt=0,ft=0;for(let _n=0,xn=2;_n<oe;_n++,xn+=6)Oe=T[xn],Fe=T[xn+1],je=T[xn+2],Ue=T[xn+3],Ye=T[xn+4],at=T[xn+5],pt=.1875*(Ce-2*Oe+je),St=.1875*(Ie-2*Fe+Ue),At=.09375*(3*(Oe-je)-Ce+Ye),Jt=.09375*(3*(Fe-Ue)-Ie+at),jt=2*pt+At,Pt=2*St+Jt,Nt=.75*(Oe-Ce)+pt+.16666667*At,ft=.75*(Fe-Ie)+St+.16666667*Jt,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt,ft+=Pt,jt+=At,Pt+=Jt,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt,ft+=Pt,Te+=Math.sqrt(Nt*Nt+ft*ft),Nt+=jt+At,ft+=Pt+Jt,Te+=Math.sqrt(Nt*Nt+ft*ft),xe[_n]=Te,Ce=Ye,Ie=at;switch(this.data.positionMode==sc.Percent&&(b*=Te),this.data.spacingMode){case ac.Percent:ve=Te;break;case ac.Proportional:ve=Te/h;break;default:ve=1}let $t=this.segments,Zt=0;for(let _n=0,xn=0,wr=0,ir=0;_n<h;_n++,xn+=3){let Hn=N[_n]*ve;b+=Hn;let lr=b;if(z)lr%=Te,lr<0&&(lr+=Te),wr=0;else{if(lr<0){this.addBeforePosition(lr,T,0,O,xn);continue}if(lr>Te){this.addAfterPosition(lr-Te,T,ee-4,O,xn);continue}}for(;;wr++){let Yn=xe[wr];if(!(lr>Yn)){if(0==wr)lr/=Yn;else{let fr=xe[wr-1];lr=(lr-fr)/(Yn-fr)}break}}if(wr!=ne){ne=wr;let Yn=6*wr;for(Ce=T[Yn],Ie=T[Yn+1],Oe=T[Yn+2],Fe=T[Yn+3],je=T[Yn+4],Ue=T[Yn+5],Ye=T[Yn+6],at=T[Yn+7],pt=.03*(Ce-2*Oe+je),St=.03*(Ie-2*Fe+Ue),At=.006*(3*(Oe-je)-Ce+Ye),Jt=.006*(3*(Fe-Ue)-Ie+at),jt=2*pt+At,Pt=2*St+Jt,Nt=.3*(Oe-Ce)+pt+.16666667*At,ft=.3*(Fe-Ie)+St+.16666667*Jt,Zt=Math.sqrt(Nt*Nt+ft*ft),$t[0]=Zt,Yn=1;Yn<8;Yn++)Nt+=jt,ft+=Pt,jt+=At,Pt+=Jt,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[Yn]=Zt;Nt+=jt,ft+=Pt,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[8]=Zt,Nt+=jt+At,ft+=Pt+Jt,Zt+=Math.sqrt(Nt*Nt+ft*ft),$t[9]=Zt,ir=0}for(lr*=Zt;;ir++){let Yn=$t[ir];if(!(lr>Yn)){if(0==ir)lr/=Yn;else{let fr=$t[ir-1];lr=ir+(lr-fr)/(Yn-fr)}break}}this.addCurvePosition(.1*lr,Ce,Ie,Oe,Fe,je,Ue,Ye,at,O,xn,p||_n>0&&0==Hn)}return O}addBeforePosition(r,h,p,y,b){let N=h[p],O=h[p+1],ee=Math.atan2(h[p+3]-O,h[p+2]-N);y[b]=N+r*Math.cos(ee),y[b+1]=O+r*Math.sin(ee),y[b+2]=ee}addAfterPosition(r,h,p,y,b){let N=h[p+2],O=h[p+3],ee=Math.atan2(O-h[p+1],N-h[p]);y[b]=N+r*Math.cos(ee),y[b+1]=O+r*Math.sin(ee),y[b+2]=ee}addCurvePosition(r,h,p,y,b,N,O,T,z,ee,oe,ne){if(0==r||isNaN(r))return ee[oe]=h,ee[oe+1]=p,void(ee[oe+2]=Math.atan2(b-p,y-h));let ve=r*r,xe=ve*r,Te=1-r,Ce=Te*Te,Ie=Ce*Te,Oe=Te*r,Fe=3*Oe,je=Te*Fe,Ue=Fe*r,Ye=h*Ie+y*je+N*Ue+T*xe,at=p*Ie+b*je+O*Ue+z*xe;ee[oe]=Ye,ee[oe+1]=at,ne&&(ee[oe+2]=r<.001?Math.atan2(b-p,y-h):Math.atan2(at-(p*Ce+b*Oe*2+O*ve),Ye-(h*Ce+y*Oe*2+N*ve)))}}lc.NONE=-1,lc.BEFORE=-2,lc.AFTER=-3,lc.epsilon=1e-5;class Hd{constructor(r,h){if(this.deform=new Array,!r)throw new Error("data cannot be null.");if(!h)throw new Error("bone cannot be null.");this.data=r,this.bone=h,this.color=new Qr,this.darkColor=r.darkColor?new Qr:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(r){this.attachment!=r&&(r instanceof Au&&this.attachment instanceof Au&&r.deformAttachment==this.attachment.deformAttachment||(this.deform.length=0),this.attachment=r,this.attachmentTime=this.bone.skeleton.time)}setAttachmentTime(r){this.attachmentTime=this.bone.skeleton.time-r}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class bd{constructor(r,h){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new of,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY,this.mixScaleX=r.mixScaleX,this.mixScaleY=r.mixScaleY,this.mixShearY=r.mixShearY,this.bones=new Array;for(let p=0;p<r.bones.length;p++)this.bones.push(h.findBone(r.bones[p].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,O=0!=h||0!=p,T=this.target,z=T.a,ee=T.b,oe=T.c,ne=T.d,ve=z*ne-ee*oe>0?Cn.degRad:-Cn.degRad,xe=this.data.offsetRotation*ve,Te=this.data.offsetShearY*ve,Ce=this.bones;for(let Ie=0,Oe=Ce.length;Ie<Oe;Ie++){let Fe=Ce[Ie];if(0!=r){let je=Fe.a,Ue=Fe.b,Ye=Fe.c,at=Fe.d,pt=Math.atan2(oe,z)-Math.atan2(Ye,je)+xe;pt>Cn.PI?pt-=Cn.PI2:pt<-Cn.PI&&(pt+=Cn.PI2),pt*=r;let St=Math.cos(pt),At=Math.sin(pt);Fe.a=St*je-At*Ye,Fe.b=St*Ue-At*at,Fe.c=At*je+St*Ye,Fe.d=At*Ue+St*at}if(O){let je=this.temp;T.localToWorld(je.set(this.data.offsetX,this.data.offsetY)),Fe.worldX+=(je.x-Fe.worldX)*h,Fe.worldY+=(je.y-Fe.worldY)*p}if(0!=y){let je=Math.sqrt(Fe.a*Fe.a+Fe.c*Fe.c);0!=je&&(je=(je+(Math.sqrt(z*z+oe*oe)-je+this.data.offsetScaleX)*y)/je),Fe.a*=je,Fe.c*=je}if(0!=b){let je=Math.sqrt(Fe.b*Fe.b+Fe.d*Fe.d);0!=je&&(je=(je+(Math.sqrt(ee*ee+ne*ne)-je+this.data.offsetScaleY)*b)/je),Fe.b*=je,Fe.d*=je}if(N>0){let je=Fe.b,Ue=Fe.d,Ye=Math.atan2(Ue,je),at=Math.atan2(ne,ee)-Math.atan2(oe,z)-(Ye-Math.atan2(Fe.c,Fe.a));at>Cn.PI?at-=Cn.PI2:at<-Cn.PI&&(at+=Cn.PI2),at=Ye+(at+Te)*N;let pt=Math.sqrt(je*je+Ue*Ue);Fe.b=Math.cos(at)*pt,Fe.d=Math.sin(at)*pt}Fe.updateAppliedTransform()}}applyRelativeWorld(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,O=0!=h||0!=p,T=this.target,z=T.a,ee=T.b,oe=T.c,ne=T.d,ve=z*ne-ee*oe>0?Cn.degRad:-Cn.degRad,xe=this.data.offsetRotation*ve,Te=this.data.offsetShearY*ve,Ce=this.bones;for(let Ie=0,Oe=Ce.length;Ie<Oe;Ie++){let Fe=Ce[Ie];if(0!=r){let je=Fe.a,Ue=Fe.b,Ye=Fe.c,at=Fe.d,pt=Math.atan2(oe,z)+xe;pt>Cn.PI?pt-=Cn.PI2:pt<-Cn.PI&&(pt+=Cn.PI2),pt*=r;let St=Math.cos(pt),At=Math.sin(pt);Fe.a=St*je-At*Ye,Fe.b=St*Ue-At*at,Fe.c=At*je+St*Ye,Fe.d=At*Ue+St*at}if(O){let je=this.temp;T.localToWorld(je.set(this.data.offsetX,this.data.offsetY)),Fe.worldX+=je.x*h,Fe.worldY+=je.y*p}if(0!=y){let je=(Math.sqrt(z*z+oe*oe)-1+this.data.offsetScaleX)*y+1;Fe.a*=je,Fe.c*=je}if(0!=b){let je=(Math.sqrt(ee*ee+ne*ne)-1+this.data.offsetScaleY)*b+1;Fe.b*=je,Fe.d*=je}if(N>0){let je=Math.atan2(ne,ee)-Math.atan2(oe,z);je>Cn.PI?je-=Cn.PI2:je<-Cn.PI&&(je+=Cn.PI2);let Ue=Fe.b,Ye=Fe.d;je=Math.atan2(Ye,Ue)+(je-Cn.PI/2+Te)*N;let at=Math.sqrt(Ue*Ue+Ye*Ye);Fe.b=Math.cos(je)*at,Fe.d=Math.sin(je)*at}Fe.updateAppliedTransform()}}applyAbsoluteLocal(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,O=this.target,T=this.bones;for(let z=0,ee=T.length;z<ee;z++){let oe=T[z],ne=oe.arotation;if(0!=r){let Oe=O.arotation-ne+this.data.offsetRotation;Oe-=360*(16384-(16384.499999999996-Oe/360|0)),ne+=Oe*r}let ve=oe.ax,xe=oe.ay;ve+=(O.ax-ve+this.data.offsetX)*h,xe+=(O.ay-xe+this.data.offsetY)*p;let Te=oe.ascaleX,Ce=oe.ascaleY;0!=y&&0!=Te&&(Te=(Te+(O.ascaleX-Te+this.data.offsetScaleX)*y)/Te),0!=b&&0!=Ce&&(Ce=(Ce+(O.ascaleY-Ce+this.data.offsetScaleY)*b)/Ce);let Ie=oe.ashearY;if(0!=N){let Oe=O.ashearY-Ie+this.data.offsetShearY;Oe-=360*(16384-(16384.499999999996-Oe/360|0)),Ie+=Oe*N}oe.updateWorldTransformWith(ve,xe,ne,Te,Ce,oe.ashearX,Ie)}}applyRelativeLocal(){let r=this.mixRotate,h=this.mixX,p=this.mixY,y=this.mixScaleX,b=this.mixScaleY,N=this.mixShearY,O=this.target,T=this.bones;for(let z=0,ee=T.length;z<ee;z++){let oe=T[z];oe.updateWorldTransformWith(oe.ax+(O.ax+this.data.offsetX)*h,oe.ay+(O.ay+this.data.offsetY)*p,oe.arotation+(O.arotation+this.data.offsetRotation)*r,oe.ascaleX*((O.ascaleX-1+this.data.offsetScaleX)*y+1),oe.ascaleY*((O.ascaleY-1+this.data.offsetScaleY)*b+1),oe.ashearX,oe.ashearY+(O.ashearY+this.data.offsetShearY)*N)}}}class pf{constructor(r){if(this._updateCache=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!r)throw new Error("data cannot be null.");this.data=r,this.bones=new Array;for(let h=0;h<r.bones.length;h++){let p,y=r.bones[h];if(y.parent){let b=this.bones[y.parent.index];p=new Rp(y,this,b),b.children.push(p)}else p=new Rp(y,this,null);this.bones.push(p)}this.slots=new Array,this.drawOrder=new Array;for(let h=0;h<r.slots.length;h++){let p=r.slots[h],b=new Hd(p,this.bones[p.boneData.index]);this.slots.push(b),this.drawOrder.push(b)}this.ikConstraints=new Array;for(let h=0;h<r.ikConstraints.length;h++)this.ikConstraints.push(new yd(r.ikConstraints[h],this));this.transformConstraints=new Array;for(let h=0;h<r.transformConstraints.length;h++)this.transformConstraints.push(new bd(r.transformConstraints[h],this));this.pathConstraints=new Array;for(let h=0;h<r.pathConstraints.length;h++)this.pathConstraints.push(new lc(r.pathConstraints[h],this));this.color=new Qr(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let r=this.bones;for(let z=0,ee=r.length;z<ee;z++){let oe=r[z];oe.sorted=oe.data.skinRequired,oe.active=!oe.sorted}if(this.skin){let z=this.skin.bones;for(let ee=0,oe=this.skin.bones.length;ee<oe;ee++){let ne=this.bones[z[ee].index];do{ne.sorted=!1,ne.active=!0,ne=ne.parent}while(ne)}}let h=this.ikConstraints,p=this.transformConstraints,y=this.pathConstraints,b=h.length,N=p.length,O=y.length,T=b+N+O;e:for(let z=0;z<T;z++){for(let ee=0;ee<b;ee++){let oe=h[ee];if(oe.data.order==z){this.sortIkConstraint(oe);continue e}}for(let ee=0;ee<N;ee++){let oe=p[ee];if(oe.data.order==z){this.sortTransformConstraint(oe);continue e}}for(let ee=0;ee<O;ee++){let oe=y[ee];if(oe.data.order==z){this.sortPathConstraint(oe);continue e}}}for(let z=0,ee=r.length;z<ee;z++)this.sortBone(r[z])}sortIkConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let p=r.bones,y=p[0];if(this.sortBone(y),1==p.length)this._updateCache.push(r),this.sortReset(y.children);else{let b=p[p.length-1];this.sortBone(b),this._updateCache.push(r),this.sortReset(y.children),b.sorted=!0}}sortPathConstraint(r){if(r.active=r.target.bone.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;let h=r.target,p=h.data.index,y=h.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,p,y),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,p,y);for(let T=0,z=this.data.skins.length;T<z;T++)this.sortPathConstraintAttachment(this.data.skins[T],p,y);let b=h.getAttachment();b instanceof $u&&this.sortPathConstraintAttachmentWith(b,y);let N=r.bones,O=N.length;for(let T=0;T<O;T++)this.sortBone(N[T]);this._updateCache.push(r);for(let T=0;T<O;T++)this.sortReset(N[T].children);for(let T=0;T<O;T++)N[T].sorted=!0}sortTransformConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let h=r.bones,p=h.length;if(r.data.local)for(let y=0;y<p;y++){let b=h[y];this.sortBone(b.parent),this.sortBone(b)}else for(let y=0;y<p;y++)this.sortBone(h[y]);this._updateCache.push(r);for(let y=0;y<p;y++)this.sortReset(h[y].children);for(let y=0;y<p;y++)h[y].sorted=!0}sortPathConstraintAttachment(r,h,p){let y=r.attachments[h];if(y)for(let b in y)this.sortPathConstraintAttachmentWith(y[b],p)}sortPathConstraintAttachmentWith(r,h){if(!(r instanceof $u))return;let p=r.bones;if(p){let y=this.bones;for(let b=0,N=p.length;b<N;){let O=p[b++];for(O+=b;b<O;)this.sortBone(y[p[b++]])}}else this.sortBone(h)}sortBone(r){if(r.sorted)return;let h=r.parent;h&&this.sortBone(h),r.sorted=!0,this._updateCache.push(r)}sortReset(r){for(let h=0,p=r.length;h<p;h++){let y=r[h];y.active&&(y.sorted&&this.sortReset(y.children),y.sorted=!1)}}updateWorldTransform(){let r=this.bones;for(let p=0,y=r.length;p<y;p++){let b=r[p];b.ax=b.x,b.ay=b.y,b.arotation=b.rotation,b.ascaleX=b.scaleX,b.ascaleY=b.scaleY,b.ashearX=b.shearX,b.ashearY=b.shearY}let h=this._updateCache;for(let p=0,y=h.length;p<y;p++)h[p].update()}updateWorldTransformWith(r){let h=this.getRootBone(),p=r.a,y=r.b,b=r.c,N=r.d;h.worldX=p*this.x+y*this.y+r.worldX,h.worldY=b*this.x+N*this.y+r.worldY;let O=h.rotation+90+h.shearY,T=Cn.cosDeg(h.rotation+h.shearX)*h.scaleX,z=Cn.cosDeg(O)*h.scaleY,ee=Cn.sinDeg(h.rotation+h.shearX)*h.scaleX,oe=Cn.sinDeg(O)*h.scaleY;h.a=(p*T+y*ee)*this.scaleX,h.b=(p*z+y*oe)*this.scaleX,h.c=(b*T+N*ee)*this.scaleY,h.d=(b*z+N*oe)*this.scaleY;let ne=this._updateCache;for(let ve=0,xe=ne.length;ve<xe;ve++){let Te=ne[ve];Te!=h&&Te.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let r=this.bones;for(let b=0,N=r.length;b<N;b++)r[b].setToSetupPose();let h=this.ikConstraints;for(let b=0,N=h.length;b<N;b++){let O=h[b];O.mix=O.data.mix,O.softness=O.data.softness,O.bendDirection=O.data.bendDirection,O.compress=O.data.compress,O.stretch=O.data.stretch}let p=this.transformConstraints;for(let b=0,N=p.length;b<N;b++){let O=p[b],T=O.data;O.mixRotate=T.mixRotate,O.mixX=T.mixX,O.mixY=T.mixY,O.mixScaleX=T.mixScaleX,O.mixScaleY=T.mixScaleY,O.mixShearY=T.mixShearY}let y=this.pathConstraints;for(let b=0,N=y.length;b<N;b++){let O=y[b],T=O.data;O.position=T.position,O.spacing=T.spacing,O.mixRotate=T.mixRotate,O.mixX=T.mixX,O.mixY=T.mixY}}setSlotsToSetupPose(){let r=this.slots;gr.arrayCopy(r,0,this.drawOrder,0,r.length);for(let h=0,p=r.length;h<p;h++)r[h].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}setSkinByName(r){let h=this.data.findSkin(r);if(!h)throw new Error("Skin not found: "+r);this.setSkin(h)}setSkin(r){if(r!=this.skin){if(r)if(this.skin)r.attachAll(this,this.skin);else{let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p],N=b.data.attachmentName;if(N){let O=r.getAttachment(p,N);O&&b.setAttachment(O)}}}this.skin=r,this.updateCache()}}getAttachmentByName(r,h){return this.getAttachment(this.data.findSlot(r).index,h)}getAttachment(r,h){if(!h)throw new Error("attachmentName cannot be null.");if(this.skin){let p=this.skin.getAttachment(r,h);if(p)return p}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(r,h):null}setAttachment(r,h){if(!r)throw new Error("slotName cannot be null.");let p=this.slots;for(let y=0,b=p.length;y<b;y++){let N=p[y];if(N.data.name==r){let O=null;if(h&&(O=this.getAttachment(y,h),!O))throw new Error("Attachment not found: "+h+", for slot: "+r);return void N.setAttachment(O)}}throw new Error("Slot not found: "+r)}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.data.name==r)return b}return null}getBounds(r,h,p=new Array(2)){if(!r)throw new Error("offset cannot be null.");if(!h)throw new Error("size cannot be null.");let y=this.drawOrder,b=Number.POSITIVE_INFINITY,N=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY,T=Number.NEGATIVE_INFINITY;for(let z=0,ee=y.length;z<ee;z++){let oe=y[z];if(!oe.bone.active)continue;let ne=0,ve=null,xe=oe.getAttachment();if(xe instanceof _i)ne=8,ve=gr.setArraySize(p,ne,0),xe.computeWorldVertices(oe.bone,ve,0,2);else if(xe instanceof Pa){let Te=xe;ne=Te.worldVerticesLength,ve=gr.setArraySize(p,ne,0),Te.computeWorldVertices(oe,0,ne,ve,0,2)}if(ve)for(let Te=0,Ce=ve.length;Te<Ce;Te+=2){let Ie=ve[Te],Oe=ve[Te+1];b=Math.min(b,Ie),N=Math.min(N,Oe),O=Math.max(O,Ie),T=Math.max(T,Oe)}}r.set(b,N),h.set(O-b,T-N)}update(r){this.time+=r}}class Nf{constructor(r,h,p){this.slotIndex=r,this.name=h,this.attachment=p}}class Rf{constructor(r){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!r)throw new Error("name cannot be null.");this.name=r}setAttachment(r,h,p){if(!p)throw new Error("attachment cannot be null.");let y=this.attachments;r>=y.length&&(y.length=r+1),y[r]||(y[r]={}),y[r][h]=p}addSkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],N=!1;for(let O=0;O<this.bones.length;O++)if(this.bones[O]==b){N=!0;break}N||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],N=!1;for(let O=0;O<this.constraints.length;O++)if(this.constraints[O]==b){N=!0;break}N||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var p=h[y];this.setAttachment(p.slotIndex,p.name,p.attachment)}}copySkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],N=!1;for(let O=0;O<this.bones.length;O++)if(this.bones[O]==b){N=!0;break}N||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],N=!1;for(let O=0;O<this.constraints.length;O++)if(this.constraints[O]==b){N=!0;break}N||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var p=h[y];p.attachment&&(p.attachment instanceof Pa?(p.attachment=p.attachment.newLinkedMesh(),this.setAttachment(p.slotIndex,p.name,p.attachment)):(p.attachment=p.attachment.copy(),this.setAttachment(p.slotIndex,p.name,p.attachment)))}}getAttachment(r,h){let p=this.attachments[r];return p?p[h]:null}removeAttachment(r,h){let p=this.attachments[r];p&&(p[h]=null)}getAttachments(){let r=new Array;for(var h=0;h<this.attachments.length;h++){let p=this.attachments[h];if(p)for(let y in p){let b=p[y];b&&r.push(new Nf(h,y,b))}}return r}getAttachmentsForSlot(r,h){let p=this.attachments[r];if(p)for(let y in p){let b=p[y];b&&h.push(new Nf(r,y,b))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(r,h){let p=0;for(let y=0;y<r.slots.length;y++){let b=r.slots[y],N=b.getAttachment();if(N&&p<h.attachments.length){let O=h.attachments[p];for(let T in O)if(N==O[T]){let z=this.getAttachment(p,T);z&&b.setAttachment(z);break}}p++}}}class rm{constructor(r,h,p){if(this.color=new Qr(1,1,1,1),r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");if(!p)throw new Error("boneData cannot be null.");this.index=r,this.name=h,this.boneData=p}}(function(a){a[a.Normal=0]="Normal",a[a.Additive=1]="Additive",a[a.Multiply=2]="Multiply",a[a.Screen=3]="Screen"})(zd||(zd={})),function(a){a[a.Region=0]="Region",a[a.BoundingBox=1]="BoundingBox",a[a.Mesh=2]="Mesh",a[a.LinkedMesh=3]="LinkedMesh",a[a.Path=4]="Path",a[a.Point=5]="Point",a[a.Clipping=6]="Clipping"}(md||(md={}));class nl{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new rf(()=>new Array),this.polygonIndicesPool=new rf(()=>new Array)}triangulate(r){let h=r,p=r.length>>1,y=this.indicesArray;y.length=0;for(let O=0;O<p;O++)y[O]=O;let b=this.isConcaveArray;b.length=0;for(let O=0,T=p;O<T;++O)b[O]=nl.isConcave(O,p,h,y);let N=this.triangles;for(N.length=0;p>3;){let O=p-1,T=0,z=1;for(;;){e:if(!b[T]){let ne=y[O]<<1,ve=y[T]<<1,xe=y[z]<<1,Te=h[ne],Ce=h[ne+1],Ie=h[ve],Oe=h[ve+1],Fe=h[xe],je=h[xe+1];for(let Ue=(z+1)%p;Ue!=O;Ue=(Ue+1)%p){if(!b[Ue])continue;let Ye=y[Ue]<<1,at=h[Ye],pt=h[Ye+1];if(nl.positiveArea(Fe,je,Te,Ce,at,pt)&&nl.positiveArea(Te,Ce,Ie,Oe,at,pt)&&nl.positiveArea(Ie,Oe,Fe,je,at,pt))break e}break}if(0==z){do{if(!b[T])break;T--}while(T>0);break}O=T,T=z,z=(z+1)%p}N.push(y[(p+T-1)%p]),N.push(y[T]),N.push(y[(T+1)%p]),y.splice(T,1),b.splice(T,1),p--;let ee=(p+T-1)%p,oe=T==p?0:T;b[ee]=nl.isConcave(ee,p,h,y),b[oe]=nl.isConcave(oe,p,h,y)}return 3==p&&(N.push(y[2]),N.push(y[0]),N.push(y[1])),N}decompose(r,h){let p=r,y=this.convexPolygons;this.polygonPool.freeAll(y),y.length=0;let b=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(b),b.length=0;let N=this.polygonIndicesPool.obtain();N.length=0;let O=this.polygonPool.obtain();O.length=0;let T=-1,z=0;for(let ee=0,oe=h.length;ee<oe;ee+=3){let ne=h[ee]<<1,ve=h[ee+1]<<1,xe=h[ee+2]<<1,Te=p[ne],Ce=p[ne+1],Ie=p[ve],Oe=p[ve+1],Fe=p[xe],je=p[xe+1],Ue=!1;if(T==ne){let Ye=O.length-4,at=nl.winding(O[Ye],O[Ye+1],O[Ye+2],O[Ye+3],Fe,je),pt=nl.winding(Fe,je,O[0],O[1],O[2],O[3]);at==z&&pt==z&&(O.push(Fe),O.push(je),N.push(xe),Ue=!0)}Ue||(O.length>0?(y.push(O),b.push(N)):(this.polygonPool.free(O),this.polygonIndicesPool.free(N)),O=this.polygonPool.obtain(),O.length=0,O.push(Te),O.push(Ce),O.push(Ie),O.push(Oe),O.push(Fe),O.push(je),N=this.polygonIndicesPool.obtain(),N.length=0,N.push(ne),N.push(ve),N.push(xe),z=nl.winding(Te,Ce,Ie,Oe,Fe,je),T=ne)}O.length>0&&(y.push(O),b.push(N));for(let ee=0,oe=y.length;ee<oe;ee++){if(N=b[ee],0==N.length)continue;let ne=N[0],ve=N[N.length-1];O=y[ee];let xe=O.length-4,Te=O[xe],Ce=O[xe+1],Ie=O[xe+2],Oe=O[xe+3],Fe=O[0],je=O[1],Ue=O[2],Ye=O[3],at=nl.winding(Te,Ce,Ie,Oe,Fe,je);for(let pt=0;pt<oe;pt++){if(pt==ee)continue;let St=b[pt];if(3!=St.length)continue;let jt=St[2],Pt=y[pt],Nt=Pt[Pt.length-2],ft=Pt[Pt.length-1];if(St[0]!=ne||St[1]!=ve)continue;let $t=nl.winding(Te,Ce,Ie,Oe,Nt,ft),Zt=nl.winding(Nt,ft,Fe,je,Ue,Ye);$t==at&&Zt==at&&(Pt.length=0,St.length=0,O.push(Nt),O.push(ft),N.push(jt),Te=Ie,Ce=Oe,Ie=Nt,Oe=ft,pt=0)}}for(let ee=y.length-1;ee>=0;ee--)O=y[ee],0==O.length&&(y.splice(ee,1),this.polygonPool.free(O),N=b[ee],b.splice(ee,1),this.polygonIndicesPool.free(N));return y}static isConcave(r,h,p,y){let b=y[(h+r-1)%h]<<1,N=y[r]<<1,O=y[(r+1)%h]<<1;return!this.positiveArea(p[b],p[b+1],p[N],p[N+1],p[O],p[O+1])}static positiveArea(r,h,p,y,b,N){return r*(N-y)+p*(h-N)+b*(y-h)>=0}static winding(r,h,p,y,b,N){let O=p-r,T=y-h;return b*T-N*O+O*h-r*T>=0?1:-1}}class Ip{constructor(){this.triangulator=new nl,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}clipStart(r,h){if(this.clipAttachment)return 0;this.clipAttachment=h;let p=h.worldVerticesLength,y=gr.setArraySize(this.clippingPolygon,p);h.computeWorldVertices(r,0,p,y,0,2);let b=this.clippingPolygon;Ip.makeClockwise(b);let N=this.clippingPolygons=this.triangulator.decompose(b,this.triangulator.triangulate(b));for(let O=0,T=N.length;O<T;O++){let z=N[O];Ip.makeClockwise(z),z.push(z[0]),z.push(z[1])}return N.length}clipEndWithSlot(r){this.clipAttachment&&this.clipAttachment.endSlot==r.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(r,h,p,y,b,N,O,T){let z=this.clipOutput,ee=this.clippedVertices,oe=this.clippedTriangles,ne=this.clippingPolygons,ve=this.clippingPolygons.length,xe=T?12:8,Te=0;ee.length=0,oe.length=0;e:for(let Ce=0;Ce<y;Ce+=3){let Ie=p[Ce]<<1,Oe=r[Ie],Fe=r[Ie+1],je=b[Ie],Ue=b[Ie+1];Ie=p[Ce+1]<<1;let Ye=r[Ie],at=r[Ie+1],pt=b[Ie],St=b[Ie+1];Ie=p[Ce+2]<<1;let At=r[Ie],Jt=r[Ie+1],jt=b[Ie],Pt=b[Ie+1];for(let Nt=0;Nt<ve;Nt++){let ft=ee.length;if(!this.clip(Oe,Fe,Ye,at,At,Jt,ne[Nt],z)){let $t=gr.setArraySize(ee,ft+3*xe);$t[ft]=Oe,$t[ft+1]=Fe,$t[ft+2]=N.r,$t[ft+3]=N.g,$t[ft+4]=N.b,$t[ft+5]=N.a,T?($t[ft+6]=je,$t[ft+7]=Ue,$t[ft+8]=O.r,$t[ft+9]=O.g,$t[ft+10]=O.b,$t[ft+11]=O.a,$t[ft+12]=Ye,$t[ft+13]=at,$t[ft+14]=N.r,$t[ft+15]=N.g,$t[ft+16]=N.b,$t[ft+17]=N.a,$t[ft+18]=pt,$t[ft+19]=St,$t[ft+20]=O.r,$t[ft+21]=O.g,$t[ft+22]=O.b,$t[ft+23]=O.a,$t[ft+24]=At,$t[ft+25]=Jt,$t[ft+26]=N.r,$t[ft+27]=N.g,$t[ft+28]=N.b,$t[ft+29]=N.a,$t[ft+30]=jt,$t[ft+31]=Pt,$t[ft+32]=O.r,$t[ft+33]=O.g,$t[ft+34]=O.b,$t[ft+35]=O.a):($t[ft+6]=je,$t[ft+7]=Ue,$t[ft+8]=Ye,$t[ft+9]=at,$t[ft+10]=N.r,$t[ft+11]=N.g,$t[ft+12]=N.b,$t[ft+13]=N.a,$t[ft+14]=pt,$t[ft+15]=St,$t[ft+16]=At,$t[ft+17]=Jt,$t[ft+18]=N.r,$t[ft+19]=N.g,$t[ft+20]=N.b,$t[ft+21]=N.a,$t[ft+22]=jt,$t[ft+23]=Pt),ft=oe.length;let Zt=gr.setArraySize(oe,ft+3);Zt[ft]=Te,Zt[ft+1]=Te+1,Zt[ft+2]=Te+2,Te+=3;continue e}{let $t=z.length;if(0==$t)continue;let Zt=at-Jt,_n=At-Ye,xn=Oe-At,wr=Jt-Fe,ir=1/(Zt*xn+_n*(Fe-Jt)),Hn=$t>>1,lr=this.clipOutput,Yn=gr.setArraySize(ee,ft+Hn*xe);for(let zr=0;zr<$t;zr+=2){let xo=lr[zr],po=lr[zr+1];Yn[ft]=xo,Yn[ft+1]=po,Yn[ft+2]=N.r,Yn[ft+3]=N.g,Yn[ft+4]=N.b,Yn[ft+5]=N.a;let wo=xo-At,Uo=po-Jt,Hs=(Zt*wo+_n*Uo)*ir,Vs=(wr*wo+xn*Uo)*ir,za=1-Hs-Vs;Yn[ft+6]=je*Hs+pt*Vs+jt*za,Yn[ft+7]=Ue*Hs+St*Vs+Pt*za,T&&(Yn[ft+8]=O.r,Yn[ft+9]=O.g,Yn[ft+10]=O.b,Yn[ft+11]=O.a),ft+=xe}ft=oe.length;let fr=gr.setArraySize(oe,ft+3*(Hn-2));Hn--;for(let zr=1;zr<Hn;zr++)fr[ft]=Te,fr[ft+1]=Te+zr,fr[ft+2]=Te+zr+1,ft+=3;Te+=Hn+1}}}}clip(r,h,p,y,b,N,O,T){let z=T,ee=!1,oe=null;O.length%4>=2?(oe=T,T=this.scratch):oe=this.scratch,oe.length=0,oe.push(r),oe.push(h),oe.push(p),oe.push(y),oe.push(b),oe.push(N),oe.push(r),oe.push(h),T.length=0;let ne=O,ve=O.length-4;for(let xe=0;;xe+=2){let Te=ne[xe],Ce=ne[xe+1],Ie=ne[xe+2],Oe=ne[xe+3],Fe=Te-Ie,je=Ce-Oe,Ue=oe,Ye=oe.length-2,at=T.length;for(let St=0;St<Ye;St+=2){let At=Ue[St],Jt=Ue[St+1],jt=Ue[St+2],Pt=Ue[St+3],Nt=Fe*(Pt-Oe)-je*(jt-Ie)>0;if(Fe*(Jt-Oe)-je*(At-Ie)>0){if(Nt){T.push(jt),T.push(Pt);continue}let ft=Pt-Jt,$t=jt-At,Zt=ft*(Ie-Te)-$t*(Oe-Ce);if(Math.abs(Zt)>1e-6){let _n=($t*(Ce-Jt)-ft*(Te-At))/Zt;T.push(Te+(Ie-Te)*_n),T.push(Ce+(Oe-Ce)*_n)}else T.push(Te),T.push(Ce)}else if(Nt){let ft=Pt-Jt,$t=jt-At,Zt=ft*(Ie-Te)-$t*(Oe-Ce);if(Math.abs(Zt)>1e-6){let _n=($t*(Ce-Jt)-ft*(Te-At))/Zt;T.push(Te+(Ie-Te)*_n),T.push(Ce+(Oe-Ce)*_n)}else T.push(Te),T.push(Ce);T.push(jt),T.push(Pt)}ee=!0}if(at==T.length)return z.length=0,!0;if(T.push(T[0]),T.push(T[1]),xe==ve)break;let pt=T;(T=oe).length=0,oe=pt}if(z!=T){z.length=0;for(let xe=0,Te=T.length-2;xe<Te;xe++)z[xe]=T[xe]}else z.length=z.length-2;return ee}static makeClockwise(r){let h=r,p=r.length,y=h[p-2]*h[1]-h[0]*h[p-1],b=0,N=0,O=0,T=0;for(let z=0,ee=p-3;z<ee;z+=2)b=h[z],N=h[z+1],O=h[z+2],T=h[z+3],y+=b*T-O*N;if(!(y<0))for(let z=0,ee=p-2,oe=p>>1;z<oe;z+=2){let ne=h[z],ve=h[z+1],xe=ee-z;h[z]=h[xe],h[z+1]=h[xe+1],h[xe]=ne,h[xe+1]=ve}}}class df{constructor(r){this.name=r}}class Vd{constructor(r,h){if(!h)throw new Error("data cannot be null.");this.time=r,this.data=h}}class Op extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}}class ff{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findSkin(r){if(!r)throw new Error("skinName cannot be null.");let h=this.skins;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findEvent(r){if(!r)throw new Error("eventDataName cannot be null.");let h=this.events;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findAnimation(r){if(!r)throw new Error("animationName cannot be null.");let h=this.animations;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let p=0,y=h.length;p<y;p++){let b=h[p];if(b.name==r)return b}return null}}class im extends Pp{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}}class om{constructor(r){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=r}readSkeletonData(r){let h=this.scale,p=new ff,y="string"==typeof r?JSON.parse(r):r,b=y.skeleton;if(b&&(p.hash=b.hash,p.version=b.spine,p.x=b.x,p.y=b.y,p.width=b.width,p.height=b.height,p.fps=b.fps,p.imagesPath=b.images),y.bones)for(let N=0;N<y.bones.length;N++){let O=y.bones[N],T=null,z=ln(O,"parent",null);z&&(T=p.findBone(z));let ee=new vd(p.bones.length,O.name,T);ee.length=ln(O,"length",0)*h,ee.x=ln(O,"x",0)*h,ee.y=ln(O,"y",0)*h,ee.rotation=ln(O,"rotation",0),ee.scaleX=ln(O,"scaleX",1),ee.scaleY=ln(O,"scaleY",1),ee.shearX=ln(O,"shearX",0),ee.shearY=ln(O,"shearY",0),ee.transformMode=gr.enumValue(Ic,ln(O,"transform","Normal")),ee.skinRequired=ln(O,"skin",!1);let oe=ln(O,"color",null);oe&&ee.color.setFromString(oe),p.bones.push(ee)}if(y.slots)for(let N=0;N<y.slots.length;N++){let O=y.slots[N],T=p.findBone(O.bone),z=new rm(p.slots.length,O.name,T),ee=ln(O,"color",null);ee&&z.color.setFromString(ee);let oe=ln(O,"dark",null);oe&&(z.darkColor=Qr.fromString(oe)),z.attachmentName=ln(O,"attachment",null),z.blendMode=gr.enumValue(zd,ln(O,"blend","normal")),p.slots.push(z)}if(y.ik)for(let N=0;N<y.ik.length;N++){let O=y.ik[N],T=new Op(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let z=0;z<O.bones.length;z++)T.bones.push(p.findBone(O.bones[z]));T.target=p.findBone(O.target),T.mix=ln(O,"mix",1),T.softness=ln(O,"softness",0)*h,T.bendDirection=ln(O,"bendPositive",!0)?1:-1,T.compress=ln(O,"compress",!1),T.stretch=ln(O,"stretch",!1),T.uniform=ln(O,"uniform",!1),p.ikConstraints.push(T)}if(y.transform)for(let N=0;N<y.transform.length;N++){let O=y.transform[N],T=new im(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let ee=0;ee<O.bones.length;ee++)T.bones.push(p.findBone(O.bones[ee]));T.target=p.findBone(O.target),T.local=ln(O,"local",!1),T.relative=ln(O,"relative",!1),T.offsetRotation=ln(O,"rotation",0),T.offsetX=ln(O,"x",0)*h,T.offsetY=ln(O,"y",0)*h,T.offsetScaleX=ln(O,"scaleX",0),T.offsetScaleY=ln(O,"scaleY",0),T.offsetShearY=ln(O,"shearY",0),T.mixRotate=ln(O,"mixRotate",1),T.mixX=ln(O,"mixX",1),T.mixY=ln(O,"mixY",T.mixX),T.mixScaleX=ln(O,"mixScaleX",1),T.mixScaleY=ln(O,"mixScaleY",T.mixScaleX),T.mixShearY=ln(O,"mixShearY",1),p.transformConstraints.push(T)}if(y.path)for(let N=0;N<y.path.length;N++){let O=y.path[N],T=new Gd(O.name);T.order=ln(O,"order",0),T.skinRequired=ln(O,"skin",!1);for(let ee=0;ee<O.bones.length;ee++)T.bones.push(p.findBone(O.bones[ee]));T.target=p.findSlot(O.target),T.positionMode=gr.enumValue(sc,ln(O,"positionMode","Percent")),T.spacingMode=gr.enumValue(ac,ln(O,"spacingMode","Length")),T.rotateMode=gr.enumValue(fd,ln(O,"rotateMode","Tangent")),T.offsetRotation=ln(O,"rotation",0),T.position=ln(O,"position",0),T.positionMode==sc.Fixed&&(T.position*=h),T.spacing=ln(O,"spacing",0),T.spacingMode!=ac.Length&&T.spacingMode!=ac.Fixed||(T.spacing*=h),T.mixRotate=ln(O,"mixRotate",1),T.mixX=ln(O,"mixX",1),T.mixY=ln(O,"mixY",T.mixX),p.pathConstraints.push(T)}if(y.skins)for(let N=0;N<y.skins.length;N++){let O=y.skins[N],T=new Rf(O.name);if(O.bones)for(let z=0;z<O.bones.length;z++)T.bones.push(p.findBone(O.bones[z]));if(O.ik)for(let z=0;z<O.ik.length;z++)T.constraints.push(p.findIkConstraint(O.ik[z]));if(O.transform)for(let z=0;z<O.transform.length;z++)T.constraints.push(p.findTransformConstraint(O.transform[z]));if(O.path)for(let z=0;z<O.path.length;z++)T.constraints.push(p.findPathConstraint(O.path[z]));for(let z in O.attachments){let ee=p.findSlot(z),oe=O.attachments[z];for(let ne in oe){let ve=this.readAttachment(oe[ne],T,ee.index,ne,p);ve&&T.setAttachment(ee.index,ne,ve)}}p.skins.push(T),"default"==T.name&&(p.defaultSkin=T)}for(let N=0,O=this.linkedMeshes.length;N<O;N++){let T=this.linkedMeshes[N],z=(T.skin?p.findSkin(T.skin):p.defaultSkin).getAttachment(T.slotIndex,T.parent);T.mesh.deformAttachment=T.inheritDeform?z:T.mesh,T.mesh.setParentMesh(z),T.mesh.updateUVs()}if(this.linkedMeshes.length=0,y.events)for(let N in y.events){let O=y.events[N],T=new df(N);T.intValue=ln(O,"int",0),T.floatValue=ln(O,"float",0),T.stringValue=ln(O,"string",""),T.audioPath=ln(O,"audio",null),T.audioPath&&(T.volume=ln(O,"volume",1),T.balance=ln(O,"balance",0)),p.events.push(T)}if(y.animations)for(let N in y.animations)this.readAnimation(y.animations[N],N,p);return p}readAttachment(r,h,p,y,b){let N=this.scale;switch(y=ln(r,"name",y),ln(r,"type","region")){case"region":{let O=ln(r,"path",y),T=this.attachmentLoader.newRegionAttachment(h,y,O);if(!T)return null;T.path=O,T.x=ln(r,"x",0)*N,T.y=ln(r,"y",0)*N,T.scaleX=ln(r,"scaleX",1),T.scaleY=ln(r,"scaleY",1),T.rotation=ln(r,"rotation",0),T.width=r.width*N,T.height=r.height*N;let z=ln(r,"color",null);return z&&T.color.setFromString(z),T.updateOffset(),T}case"boundingbox":{let O=this.attachmentLoader.newBoundingBoxAttachment(h,y);if(!O)return null;this.readVertices(r,O,r.vertexCount<<1);let T=ln(r,"color",null);return T&&O.color.setFromString(T),O}case"mesh":case"linkedmesh":{let O=ln(r,"path",y),T=this.attachmentLoader.newMeshAttachment(h,y,O);if(!T)return null;T.path=O;let z=ln(r,"color",null);z&&T.color.setFromString(z),T.width=ln(r,"width",0)*N,T.height=ln(r,"height",0)*N;let ee=ln(r,"parent",null);if(ee)return this.linkedMeshes.push(new mf(T,ln(r,"skin",null),p,ee,ln(r,"deform",!0))),T;let oe=r.uvs;return this.readVertices(r,T,oe.length),T.triangles=r.triangles,T.regionUVs=oe,T.updateUVs(),T.edges=ln(r,"edges",null),T.hullLength=2*ln(r,"hull",0),T}case"path":{let O=this.attachmentLoader.newPathAttachment(h,y);if(!O)return null;O.closed=ln(r,"closed",!1),O.constantSpeed=ln(r,"constantSpeed",!0);let T=r.vertexCount;this.readVertices(r,O,T<<1);let z=gr.newArray(T/3,0);for(let oe=0;oe<r.lengths.length;oe++)z[oe]=r.lengths[oe]*N;O.lengths=z;let ee=ln(r,"color",null);return ee&&O.color.setFromString(ee),O}case"point":{let O=this.attachmentLoader.newPointAttachment(h,y);if(!O)return null;O.x=ln(r,"x",0)*N,O.y=ln(r,"y",0)*N,O.rotation=ln(r,"rotation",0);let T=ln(r,"color",null);return T&&O.color.setFromString(T),O}case"clipping":{let O=this.attachmentLoader.newClippingAttachment(h,y);if(!O)return null;let T=ln(r,"end",null);T&&(O.endSlot=b.findSlot(T)),this.readVertices(r,O,r.vertexCount<<1);let ee=ln(r,"color",null);return ee&&O.color.setFromString(ee),O}}return null}readVertices(r,h,p){let y=this.scale;h.worldVerticesLength=p;let b=r.vertices;if(p==b.length){let T=gr.toFloatArray(b);if(1!=y)for(let z=0,ee=b.length;z<ee;z++)T[z]*=y;return void(h.vertices=T)}let N=new Array,O=new Array;for(let T=0,z=b.length;T<z;){let ee=b[T++];O.push(ee);for(let oe=T+4*ee;T<oe;T+=4)O.push(b[T]),N.push(b[T+1]*y),N.push(b[T+2]*y),N.push(b[T+3])}h.bones=O,h.vertices=gr.toFloatArray(N)}readAnimation(r,h,p){let y=this.scale,b=new Array;if(r.slots)for(let O in r.slots){let T=r.slots[O],z=p.findSlot(O).index;for(let ee in T){let oe=T[ee];if(!oe)continue;let ne=oe.length;if("attachment"==ee){let ve=new dd(ne,z);for(let xe=0;xe<ne;xe++){let Te=oe[xe];ve.setFrame(xe,ln(Te,"time",0),Te.name)}b.push(ve)}else if("rgba"==ee){let ve=new Jf(ne,ne<<2,z),xe=oe[0],Te=ln(xe,"time",0),Ce=Qr.fromString(xe.color);for(let Ie=0,Oe=0;;Ie++){ve.setFrame(Ie,Te,Ce.r,Ce.g,Ce.b,Ce.a);let Fe=oe[Ie+1];if(!Fe){ve.shrink(Oe);break}let je=ln(Fe,"time",0),Ue=Qr.fromString(Fe.color),Ye=xe.curve;Ye&&(Oe=zi(Ye,ve,Oe,Ie,0,Te,je,Ce.r,Ue.r,1),Oe=zi(Ye,ve,Oe,Ie,1,Te,je,Ce.g,Ue.g,1),Oe=zi(Ye,ve,Oe,Ie,2,Te,je,Ce.b,Ue.b,1),Oe=zi(Ye,ve,Oe,Ie,3,Te,je,Ce.a,Ue.a,1)),Te=je,Ce=Ue,xe=Fe}b.push(ve)}else if("rgb"==ee){let ve=new Od(ne,3*ne,z),xe=oe[0],Te=ln(xe,"time",0),Ce=Qr.fromString(xe.color);for(let Ie=0,Oe=0;;Ie++){ve.setFrame(Ie,Te,Ce.r,Ce.g,Ce.b);let Fe=oe[Ie+1];if(!Fe){ve.shrink(Oe);break}let je=ln(Fe,"time",0),Ue=Qr.fromString(Fe.color),Ye=xe.curve;Ye&&(Oe=zi(Ye,ve,Oe,Ie,0,Te,je,Ce.r,Ue.r,1),Oe=zi(Ye,ve,Oe,Ie,1,Te,je,Ce.g,Ue.g,1),Oe=zi(Ye,ve,Oe,Ie,2,Te,je,Ce.b,Ue.b,1)),Te=je,Ce=Ue,xe=Fe}b.push(ve)}else if("alpha"==ee)b.push(Cu(oe,new Nm(ne,ne,z),0,1));else if("rgba2"==ee){let ve=new Rm(ne,7*ne,z),xe=oe[0],Te=ln(xe,"time",0),Ce=Qr.fromString(xe.light),Ie=Qr.fromString(xe.dark);for(let Oe=0,Fe=0;;Oe++){ve.setFrame(Oe,Te,Ce.r,Ce.g,Ce.b,Ce.a,Ie.r,Ie.g,Ie.b);let je=oe[Oe+1];if(!je){ve.shrink(Fe);break}let Ue=ln(je,"time",0),Ye=Qr.fromString(je.light),at=Qr.fromString(je.dark),pt=xe.curve;pt&&(Fe=zi(pt,ve,Fe,Oe,0,Te,Ue,Ce.r,Ye.r,1),Fe=zi(pt,ve,Fe,Oe,1,Te,Ue,Ce.g,Ye.g,1),Fe=zi(pt,ve,Fe,Oe,2,Te,Ue,Ce.b,Ye.b,1),Fe=zi(pt,ve,Fe,Oe,3,Te,Ue,Ce.a,Ye.a,1),Fe=zi(pt,ve,Fe,Oe,4,Te,Ue,Ie.r,at.r,1),Fe=zi(pt,ve,Fe,Oe,5,Te,Ue,Ie.g,at.g,1),Fe=zi(pt,ve,Fe,Oe,6,Te,Ue,Ie.b,at.b,1)),Te=Ue,Ce=Ye,Ie=at,xe=je}b.push(ve)}else if("rgb2"==ee){let ve=new kd(ne,6*ne,z),xe=oe[0],Te=ln(xe,"time",0),Ce=Qr.fromString(xe.light),Ie=Qr.fromString(xe.dark);for(let Oe=0,Fe=0;;Oe++){ve.setFrame(Oe,Te,Ce.r,Ce.g,Ce.b,Ie.r,Ie.g,Ie.b);let je=oe[Oe+1];if(!je){ve.shrink(Fe);break}let Ue=ln(je,"time",0),Ye=Qr.fromString(je.light),at=Qr.fromString(je.dark),pt=xe.curve;pt&&(Fe=zi(pt,ve,Fe,Oe,0,Te,Ue,Ce.r,Ye.r,1),Fe=zi(pt,ve,Fe,Oe,1,Te,Ue,Ce.g,Ye.g,1),Fe=zi(pt,ve,Fe,Oe,2,Te,Ue,Ce.b,Ye.b,1),Fe=zi(pt,ve,Fe,Oe,3,Te,Ue,Ie.r,at.r,1),Fe=zi(pt,ve,Fe,Oe,4,Te,Ue,Ie.g,at.g,1),Fe=zi(pt,ve,Fe,Oe,5,Te,Ue,Ie.b,at.b,1)),Te=Ue,Ce=Ye,Ie=at,xe=je}b.push(ve)}}}if(r.bones)for(let O in r.bones){let T=r.bones[O],z=p.findBone(O).index;for(let ee in T){let oe=T[ee],ne=oe.length;if(0!=ne)if("rotate"===ee)b.push(Cu(oe,new sf(ne,ne,z),0,1));else if("translate"===ee){let ve=new Vf(ne,ne<<1,z);b.push(Wd(oe,ve,"x","y",0,y))}else if("translatex"===ee){let ve=new Wf(ne,ne,z);b.push(Cu(oe,ve,0,y))}else if("translatey"===ee){let ve=new Cf(ne,ne,z);b.push(Cu(oe,ve,0,y))}else if("scale"===ee){let ve=new qf(ne,ne<<1,z);b.push(Wd(oe,ve,"x","y",1,1))}else if("scalex"===ee){let ve=new Lm(ne,ne,z);b.push(Cu(oe,ve,1,1))}else if("scaley"===ee){let ve=new Bp(ne,ne,z);b.push(Cu(oe,ve,1,1))}else if("shear"===ee){let ve=new Xf(ne,ne<<1,z);b.push(Wd(oe,ve,"x","y",0,1))}else if("shearx"===ee){let ve=new Bm(ne,ne,z);b.push(Cu(oe,ve,0,1))}else if("sheary"===ee){let ve=new Yf(ne,ne,z);b.push(Cu(oe,ve,0,1))}}}if(r.ik)for(let O in r.ik){let T=r.ik[O],z=T[0];if(!z)continue;let ee=p.findIkConstraint(O),oe=p.ikConstraints.indexOf(ee),ne=new Pm(T.length,T.length<<1,oe),ve=ln(z,"time",0),xe=ln(z,"mix",1),Te=ln(z,"softness",0)*y;for(let Ce=0,Ie=0;;Ce++){ne.setFrame(Ce,ve,xe,Te,ln(z,"bendPositive",!0)?1:-1,ln(z,"compress",!1),ln(z,"stretch",!1));let Oe=T[Ce+1];if(!Oe){ne.shrink(Ie);break}let Fe=ln(Oe,"time",0),je=ln(Oe,"mix",1),Ue=ln(Oe,"softness",0)*y,Ye=z.curve;Ye&&(Ie=zi(Ye,ne,Ie,Ce,0,ve,Fe,xe,je,1),Ie=zi(Ye,ne,Ie,Ce,1,ve,Fe,Te,Ue,y)),ve=Fe,xe=je,Te=Ue,z=Oe}b.push(ne)}if(r.transform)for(let O in r.transform){let T=r.transform[O],z=T[0];if(!z)continue;let ee=p.findTransformConstraint(O),oe=p.transformConstraints.indexOf(ee),ne=new Im(T.length,6*T.length,oe),ve=ln(z,"time",0),xe=ln(z,"mixRotate",1),Te=ln(z,"mixX",1),Ce=ln(z,"mixY",Te),Ie=ln(z,"mixScaleX",1),Oe=ln(z,"mixScaleY",Ie),Fe=ln(z,"mixShearY",1);for(let je=0,Ue=0;;je++){ne.setFrame(je,ve,xe,Te,Ce,Ie,Oe,Fe);let Ye=T[je+1];if(!Ye){ne.shrink(Ue);break}let at=ln(Ye,"time",0),pt=ln(Ye,"mixRotate",1),St=ln(Ye,"mixX",1),At=ln(Ye,"mixY",St),Jt=ln(Ye,"mixScaleX",1),jt=ln(Ye,"mixScaleY",Jt),Pt=ln(Ye,"mixShearY",1),Nt=z.curve;Nt&&(Ue=zi(Nt,ne,Ue,je,0,ve,at,xe,pt,1),Ue=zi(Nt,ne,Ue,je,1,ve,at,Te,St,1),Ue=zi(Nt,ne,Ue,je,2,ve,at,Ce,At,1),Ue=zi(Nt,ne,Ue,je,3,ve,at,Ie,Jt,1),Ue=zi(Nt,ne,Ue,je,4,ve,at,Oe,jt,1),Ue=zi(Nt,ne,Ue,je,5,ve,at,Fe,Pt,1)),ve=at,xe=pt,Te=St,Ce=At,Ie=Jt,Oe=jt,Ie=Jt,z=Ye}b.push(ne)}if(r.path)for(let O in r.path){let T=r.path[O],z=p.findPathConstraint(O),ee=p.pathConstraints.indexOf(z);for(let oe in T){let ne=T[oe],ve=ne[0];if(!ve)continue;let xe=ne.length;if("position"===oe){let Te=new Om(xe,xe,ee);b.push(Cu(ne,Te,0,z.positionMode==sc.Fixed?y:1))}else if("spacing"===oe){let Te=new Qf(xe,xe,ee);b.push(Cu(ne,Te,0,z.spacingMode==ac.Length||z.spacingMode==ac.Fixed?y:1))}else if("mix"===oe){let Te=new km(xe,3*xe,ee),Ce=ln(ve,"time",0),Ie=ln(ve,"mixRotate",1),Oe=ln(ve,"mixX",1),Fe=ln(ve,"mixY",Oe);for(let je=0,Ue=0;;je++){Te.setFrame(je,Ce,Ie,Oe,Fe);let Ye=ne[je+1];if(!Ye){Te.shrink(Ue);break}let at=ln(Ye,"time",0),pt=ln(Ye,"mixRotate",1),St=ln(Ye,"mixX",1),At=ln(Ye,"mixY",St),Jt=ve.curve;Jt&&(Ue=zi(Jt,Te,Ue,je,0,Ce,at,Ie,pt,1),Ue=zi(Jt,Te,Ue,je,1,Ce,at,Oe,St,1),Ue=zi(Jt,Te,Ue,je,2,Ce,at,Fe,At,1)),Ce=at,Ie=pt,Oe=St,Fe=At,ve=Ye}b.push(Te)}}}if(r.deform)for(let O in r.deform){let T=r.deform[O],z=p.findSkin(O);for(let ee in T){let oe=T[ee],ne=p.findSlot(ee).index;for(let ve in oe){let xe=oe[ve],Te=xe[0];if(!Te)continue;let Ce=z.getAttachment(ne,ve),Ie=Ce.bones,Oe=Ce.vertices,Fe=Ie?Oe.length/3*2:Oe.length,je=new Zf(xe.length,xe.length,ne,Ce),Ue=ln(Te,"time",0);for(let Ye=0,at=0;;Ye++){let pt,St=ln(Te,"vertices",null);if(St){pt=gr.newFloatArray(Fe);let Pt=ln(Te,"offset",0);if(gr.arrayCopy(St,0,pt,Pt,St.length),1!=y)for(let Nt=Pt,ft=Nt+St.length;Nt<ft;Nt++)pt[Nt]*=y;if(!Ie)for(let Nt=0;Nt<Fe;Nt++)pt[Nt]+=Oe[Nt]}else pt=Ie?gr.newFloatArray(Fe):Oe;je.setFrame(Ye,Ue,pt);let At=xe[Ye+1];if(!At){je.shrink(at);break}let Jt=ln(At,"time",0),jt=Te.curve;jt&&(at=zi(jt,je,at,Ye,0,Ue,Jt,0,1,1)),Ue=Jt,Te=At}b.push(je)}}}if(r.drawOrder){let O=new tp(r.drawOrder.length),T=p.slots.length,z=0;for(let ee=0;ee<r.drawOrder.length;ee++,z++){let oe=r.drawOrder[ee],ne=null,ve=ln(oe,"offsets",null);if(ve){ne=gr.newArray(T,-1);let xe=gr.newArray(T-ve.length,0),Te=0,Ce=0;for(let Ie=0;Ie<ve.length;Ie++){let Oe=ve[Ie],Fe=p.findSlot(Oe.slot).index;for(;Te!=Fe;)xe[Ce++]=Te++;ne[Te+Oe.offset]=Te++}for(;Te<T;)xe[Ce++]=Te++;for(let Ie=T-1;Ie>=0;Ie--)-1==ne[Ie]&&(ne[Ie]=xe[--Ce])}O.setFrame(z,ln(oe,"time",0),ne)}b.push(O)}if(r.events){let O=new Fd(r.events.length),T=0;for(let z=0;z<r.events.length;z++,T++){let ee=r.events[z],oe=p.findEvent(ee.name),ne=new Vd(gr.toSinglePrecision(ln(ee,"time",0)),oe);ne.intValue=ln(ee,"int",oe.intValue),ne.floatValue=ln(ee,"float",oe.floatValue),ne.stringValue=ln(ee,"string",oe.stringValue),ne.data.audioPath&&(ne.volume=ln(ee,"volume",1),ne.balance=ln(ee,"balance",0)),O.setFrame(T,ne)}b.push(O)}let N=0;for(let O=0,T=b.length;O<T;O++)N=Math.max(N,b[O].getDuration());p.animations.push(new $f(h,b,N))}}class mf{constructor(r,h,p,y,b){this.mesh=r,this.skin=h,this.slotIndex=p,this.parent=y,this.inheritDeform=b}}function Cu(a,r,h,p){let y=a[0],b=ln(y,"time",0),N=ln(y,"value",h)*p,O=0;for(let T=0;;T++){r.setFrame(T,b,N);let z=a[T+1];if(!z)return r.shrink(O),r;let ee=ln(z,"time",0),oe=ln(z,"value",h)*p;y.curve&&(O=zi(y.curve,r,O,T,0,b,ee,N,oe,p)),b=ee,N=oe,y=z}}function Wd(a,r,h,p,y,b){let N=a[0],O=ln(N,"time",0),T=ln(N,h,y)*b,z=ln(N,p,y)*b,ee=0;for(let oe=0;;oe++){r.setFrame(oe,O,T,z);let ne=a[oe+1];if(!ne)return r.shrink(ee),r;let ve=ln(ne,"time",0),xe=ln(ne,h,y)*b,Te=ln(ne,p,y)*b,Ce=N.curve;Ce&&(ee=zi(Ce,r,ee,oe,0,O,ve,T,xe,b),ee=zi(Ce,r,ee,oe,1,O,ve,z,Te,b)),O=ve,T=xe,z=Te,N=ne}}function zi(a,r,h,p,y,b,N,O,T,z){if("stepped"==a)return r.setStepped(p),h;let ee=y<<2;return r.setBezier(h,p,y,b,O,a[ee],a[ee+1]*z,a[ee+2],a[ee+3]*z,N,T),h+1}function ln(a,r,h){return void 0!==a[r]?a[r]:h}void 0===Math.fround&&(Math.fround=(cf=new Float32Array(1),function(a){return cf[0]=a,cf[0]}));class Yp{constructor(r){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=r}begin(r){this.worldX=r.x+this.centerX,this.worldY=r.y+this.centerY}transform(r,h,p,y){let b=this.angle*Cn.degreesToRadians,N=r.x-this.worldX,O=r.y-this.worldY,T=Math.sqrt(N*N+O*O);if(T<this.radius){let z=Yp.interpolation.apply(0,b,(this.radius-T)/this.radius),ee=Math.cos(z),oe=Math.sin(z);r.x=ee*N-oe*O+this.worldX,r.y=oe*N+ee*O+this.worldY}}end(){}}Yp.interpolation=new class extends Cm{constructor(a){super(a)}applyInternal(a){return Math.pow(a-1,this.power)*(this.power%2==0?-1:1)+1}}(2);var Zo=__webpack_require__(175);class $o extends np{constructor(r){super(r),this.texture=new Zo.Texture(r),this.texture.flipY=!1,this.texture.needsUpdate=!0}setFilters(r,h){this.texture.minFilter=$o.toThreeJsTextureFilter(r),this.texture.magFilter=$o.toThreeJsTextureFilter(h)}setWraps(r,h){this.texture.wrapS=$o.toThreeJsTextureWrap(r),this.texture.wrapT=$o.toThreeJsTextureWrap(h)}dispose(){this.texture.dispose()}static toThreeJsTextureFilter(r){if(r===Ks.Linear)return Zo.LinearFilter;if(r===Ks.MipMap)return Zo.LinearMipMapLinearFilter;if(r===Ks.MipMapLinearNearest)return Zo.LinearMipMapNearestFilter;if(r===Ks.MipMapNearestLinear)return Zo.NearestMipMapLinearFilter;if(r===Ks.MipMapNearestNearest)return Zo.NearestMipMapNearestFilter;if(r===Ks.Nearest)return Zo.NearestFilter;throw new Error("Unknown texture filter: "+r)}static toThreeJsTextureWrap(r){if(r===Ch.ClampToEdge)return Zo.ClampToEdgeWrapping;if(r===Ch.MirroredRepeat)return Zo.MirroredRepeatWrapping;if(r===Ch.Repeat)return Zo.RepeatWrapping;throw new Error("Unknown texture wrap: "+r)}}class sm extends Zo.ShaderMaterial{constructor(r){let h={uniforms:{map:{type:"t",value:null}},vertexShader:"\n\t\t\t\tattribute vec4 color;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tvColor = color;\n\t\t\t\t\tgl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tuniform sampler2D map;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main(void) {\n\t\t\t\t\tgl_FragColor = texture2D(map, vUv)*vColor;\n\t\t\t\t}\n\t\t\t",side:Zo.DoubleSide,transparent:!0,alphaTest:.5};r(h),super(h)}}class Yi extends Zo.Object3D{constructor(r,h=(p=>{})){super(),this.tempPos=new of,this.tempUv=new of,this.tempLight=new Qr,this.tempDark=new Qr,this.zOffset=.1,this.batches=new Array,this.nextBatchIndex=0,this.clipper=new Ip,this.vertices=gr.newFloatArray(1024),this.tempColor=new Qr,this.materialCustomizer=h,this.skeleton=new pf(r);let p=new zm(r);this.state=new Dd(p)}update(r){let h=this.state,p=this.skeleton;h.update(r),h.apply(p),p.updateWorldTransform(),this.updateGeometry()}dispose(){for(var r=0;r<this.batches.length;r++)this.batches[r].dispose()}clearBatches(){for(var r=0;r<this.batches.length;r++)this.batches[r].clear(),this.batches[r].visible=!1;this.nextBatchIndex=0}nextBatch(){if(this.batches.length==this.nextBatchIndex){let h=new kp(10920,this.materialCustomizer);this.add(h),this.batches.push(h)}let r=this.batches[this.nextBatchIndex++];return r.visible=!0,r}updateGeometry(){this.clearBatches();let r=this.tempPos,h=this.tempUv,p=this.tempLight,y=this.tempDark,b=this.clipper,N=this.vertices,O=null,T=null,z=this.skeleton.drawOrder,ee=this.nextBatch();ee.begin();let oe=0,ne=this.zOffset;for(let ve=0,xe=z.length;ve<xe;ve++){let Te=b.isClipping()?2:Yi.VERTEX_SIZE,Ce=z[ve];if(!Ce.bone.active){b.clipEndWithSlot(Ce);continue}let Ie=Ce.getAttachment(),Oe=null,Fe=null,je=0;if(Ie instanceof _i){let Ue=Ie;Oe=Ue.color,N=this.vertices,je=4*Te,Ue.computeWorldVertices(Ce.bone,N,0,Te),O=Yi.QUAD_TRIANGLES,T=Ue.uvs,Fe=Ue.region.renderObject.page.texture}else{if(!(Ie instanceof Pa)){if(Ie instanceof Ud){b.clipStart(Ce,Ie);continue}b.clipEndWithSlot(Ce);continue}{let Ue=Ie;Oe=Ue.color,N=this.vertices,je=(Ue.worldVerticesLength>>1)*Te,je>N.length&&(N=this.vertices=gr.newFloatArray(je)),Ue.computeWorldVertices(Ce,0,Ue.worldVerticesLength,N,0,Te),O=Ue.triangles,T=Ue.uvs,Fe=Ue.region.renderObject.page.texture}}if(Fe){let Ue,Ye,at,pt,St=Ce.bone.skeleton.color,At=Ce.color,jt=this.tempColor;if(jt.set(St.r*At.r*Oe.r,St.g*At.g*Oe.g,St.b*At.b*Oe.b,St.a*At.a*Oe.a),b.isClipping()){b.clipTriangles(N,je,O,O.length,T,jt,null,!1);let Nt=b.clippedVertices,ft=b.clippedTriangles;if(this.vertexEffect){let $t=this.vertexEffect,Zt=Nt;for(let _n=0,xn=Nt.length;_n<xn;_n+=Te)r.x=Zt[_n],r.y=Zt[_n+1],p.setFromColor(jt),y.set(0,0,0,0),h.x=Zt[_n+6],h.y=Zt[_n+7],$t.transform(r,h,p,y),Zt[_n]=r.x,Zt[_n+1]=r.y,Zt[_n+2]=p.r,Zt[_n+3]=p.g,Zt[_n+4]=p.b,Zt[_n+5]=p.a,Zt[_n+6]=h.x,Zt[_n+7]=h.y}Ue=Nt,Ye=Nt.length,at=ft,pt=ft.length}else{let Nt=N;if(this.vertexEffect){let ft=this.vertexEffect;for(let $t=0,Zt=0,_n=je;$t<_n;$t+=Te,Zt+=2)r.x=Nt[$t],r.y=Nt[$t+1],p.setFromColor(jt),y.set(0,0,0,0),h.x=T[Zt],h.y=T[Zt+1],ft.transform(r,h,p,y),Nt[$t]=r.x,Nt[$t+1]=r.y,Nt[$t+2]=p.r,Nt[$t+3]=p.g,Nt[$t+4]=p.b,Nt[$t+5]=p.a,Nt[$t+6]=h.x,Nt[$t+7]=h.y}else for(let ft=2,$t=0,Zt=je;ft<Zt;ft+=Te,$t+=2)Nt[ft]=jt.r,Nt[ft+1]=jt.g,Nt[ft+2]=jt.b,Nt[ft+3]=jt.a,Nt[ft+4]=T[$t],Nt[ft+5]=T[$t+1];Ue=N,Ye=je,at=O,pt=O.length}if(0==Ye||0==pt){b.clipEndWithSlot(Ce);continue}ee.canBatch(Ye,pt)||(ee.end(),ee=this.nextBatch(),ee.begin());let Pt=ee.material;Pt.uniforms.map.value||(Pt.uniforms.map.value=Fe.texture),Pt.uniforms.map.value!=Fe.texture&&(ee.end(),ee=this.nextBatch(),ee.begin(),Pt=ee.material,Pt.uniforms.map.value=Fe.texture),Pt.needsUpdate=!0,ee.batch(Ue,Ye,at,pt,oe),oe+=ne}b.clipEndWithSlot(Ce)}b.clipEnd(),ee.end()}}Yi.QUAD_TRIANGLES=[0,1,2,2,3,0],Yi.VERTEX_SIZE=8;class kp extends Zo.Mesh{constructor(r=10920,h=(p=>{})){if(super(),this.verticesLength=0,this.indicesLength=0,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);let p=this.vertices=new Float32Array(r*kp.VERTEX_SIZE),y=this.indices=new Uint16Array(3*r),b=new Zo.BufferGeometry,N=this.vertexBuffer=new Zo.InterleavedBuffer(p,kp.VERTEX_SIZE);N.usage=WebGLRenderingContext.DYNAMIC_DRAW,b.setAttribute("position",new Zo.InterleavedBufferAttribute(N,3,0,!1)),b.setAttribute("color",new Zo.InterleavedBufferAttribute(N,4,3,!1)),b.setAttribute("uv",new Zo.InterleavedBufferAttribute(N,2,7,!1)),b.setIndex(new Zo.BufferAttribute(y,1)),b.getIndex().usage=WebGLRenderingContext.DYNAMIC_DRAW,b.drawRange.start=0,b.drawRange.count=0,this.geometry=b,this.material=new sm(h)}dispose(){if(this.geometry.dispose(),this.material instanceof Zo.Material)this.material.dispose();else if(this.material)for(let r=0;r<this.material.length;r++){let h=this.material[r];h instanceof Zo.Material&&h.dispose()}}clear(){let r=this.geometry;return r.drawRange.start=0,r.drawRange.count=0,this.material.uniforms.map.value=null,this}begin(){this.verticesLength=0,this.indicesLength=0}canBatch(r,h){return!(this.indicesLength+h>=this.indices.byteLength/2||this.verticesLength+r>=this.vertices.byteLength/2)}batch(r,h,p,y,b=0){let N=this.verticesLength/kp.VERTEX_SIZE,O=this.vertices,T=this.verticesLength,z=0;for(;z<h;)O[T++]=r[z++],O[T++]=r[z++],O[T++]=b,O[T++]=r[z++],O[T++]=r[z++],O[T++]=r[z++],O[T++]=r[z++],O[T++]=r[z++],O[T++]=r[z++];this.verticesLength=T;let ee=this.indices;for(T=this.indicesLength,z=0;z<y;T++,z++)ee[T]=p[z]+N;this.indicesLength+=y}end(){this.vertexBuffer.needsUpdate=this.verticesLength>0,this.vertexBuffer.updateRange.offset=0,this.vertexBuffer.updateRange.count=this.verticesLength;let r=this.geometry;r.getIndex().needsUpdate=this.indicesLength>0,r.getIndex().updateRange.offset=0,r.getIndex().updateRange.count=this.indicesLength,r.drawRange.start=0,r.drawRange.count=this.indicesLength}}function Lu(a){$o.call(this,a.image),this.texture=a,this.texture.flipY=!1}function Ia(a,r,h,p){void 0===p&&(p=[]);var y=new _d(r,function(O){for(var T=0;T<p.length;T++)if(p[T].name===O){var z=new Lu(p[T].texture);break}T===p.length&&(z=new Lu(new ms(new fs(h+"/"+O))),p.push({name:O,texture:z.texture}));var ee=z.texture.image,oe=z.texture.source;if(oe.width>0&&oe.height>0)ee.width=oe.width,ee.height=oe.height;else if(0!==ee.naturalWidth&&0!==ee.naturalHeight)ee.width=ee.naturalWidth,ee.height=ee.naturalHeight,oe.width=ee.width,oe.height=ee.height;else{var ne=r.search("size: "),ve=r.search("\nformat"),xe=r.substring(ne+6,ve);xe=xe.split(","),ee.width=parseInt(xe[0]),ee.height=parseInt(xe[1])}return z}),b=new gd(y),N=new om(b).readSkeletonData(a);Yi.call(this,N),this.name="spine",this.type="SpineAnimation",this.scale.set(.01,.01,.01),this.json=a,this.atlas=r,this.textures=p,this.skin=this.getSkins().length>0?this.getSkins()[0].name:null,this.animation=this.getAnimations().length>0?this.getAnimations()[0].name:null,this.track=0,this.loop=!0,this.clock=new l.Clock,this.play()}function Us(a,r,h,p,y,b){l.SpotLight.call(this,a,r,h,p,y,b),this.name="spotlight",this.castShadow=!0,this.shadow.camera.near=.05,this.shadow.camera.far=5e3,this.shadow.mapSize.width=512,this.shadow.mapSize.height=512}function Oc(a){l.Sprite.call(this,a),this.name="sprite"}kp.VERTEX_SIZE=9,Lu.prototype=Object.create($o.prototype),(Ia.prototype=Object.create(Yi.prototype)).update=function(a){Yi.prototype.update.call(this,a),l.Object3D.prototype.update.call(this)},Ia.prototype.onBeforeRender=function(){this.state.update(this.clock.getDelta()),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform(),this.updateGeometry()},Ia.prototype.play=function(){null!==this.animation&&this.setAnimation(this.track,this.animation,this.loop),null!==this.skin&&this.setSkin(this.skin)},Ia.prototype.getAnimations=function(){return this.state.data.skeletonData.animations},Ia.prototype.setAnimation=function(a,r,h){try{void 0!==a&&(this.track=a),void 0!==r&&(this.animation=r),void 0!==h&&(this.loop=h),this.state.setAnimation(this.track,this.animation,this.loop)}catch{this.animation=null,console.warn("nunuStudio: Error setting spine animation "+name+" on track "+a)}},Ia.prototype.getSkins=function(){return this.state.data.skeletonData.skins},Ia.prototype.setSkin=function(a){try{this.skeleton.setSkinByName(a),this.skin=a}catch{this.skin=null,console.warn("nunuStudio: Error setting spine skin "+a)}},Ia.prototype.toJSON=function(a){var r=[],h=this,p=l.Object3D.prototype.toJSON.call(this,a,function(y){for(var b=0;b<h.textures.length;b++){var N=h.textures[b].texture.toJSON(y);r.push({name:h.textures[b].name,texture:N.uuid})}});return p.object.json=this.json,p.object.atlas=this.atlas,p.object.textures=r,null!==this.animation&&(p.object.animation=this.animation,p.object.track=this.track,p.object.loop=this.loop),null!==this.skin&&(p.object.skin=this.skin),p},(Us.prototype=Object.create(l.SpotLight.prototype)).setTarget=function(a){this.target=a},Us.prototype.updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()},Us.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.target=this.target.uuid,r},(Oc.prototype=Object.create(l.Sprite.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),l.Object3D.prototype.dispose.call(this)};var ys=__webpack_require__(980);function Ii(a){l.Group.call(this),this.type="PythonScript",this.name="script",this.code=void 0!==a?a:Ii.DEFAULT,this.script={},this.program=null,this.scene=null}Ii.prototype=Object.create(l.Group.prototype),Ii.DEFAULT="def initialize(obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass\n\ndef update(delta, obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass",Ii.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Fo?this.scene=a:a instanceof hi&&(this.program=a);l.Object3D.prototype.initialize.call(this),this.compileCode(this.code),void 0!==this.script.initialize&&this.script.initialize.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.update.call(this,a)},Ii.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.dispose.call(this)},Ii.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ii.prototype.compileCode=function(a){var r;try{r=(r=ys.python_to_js(a)).substring(r.indexOf("\n")+1,r.lastIndexOf("\n"))}catch(b){throw new Error("Failed to transpile python into javascript code.",b)}for(var h=0;h<Tn.METHODS.length;h++){var p=Tn.METHODS[h];r+="\nif(this."+p+' == undefined && typeof $locals___main__["'+p+"\"] !== 'undefined'){this."+p+' = $locals___main__["'+p+'"];}'}var y=new Function(r);try{this.script=new y}catch(b){throw this.script={},console.warn("nunuStudio: Error initializing script code",b),new Error("Error initializing script code")}},Ii.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r};var Jp=__webpack_require__(573),kl=__webpack_require__.n(Jp);function Vo(a,r,h,p){if(void 0===a.font)throw new Error("TextBitmap configuration font is required.");void 0===a.width&&(a.width=500),void 0===a.align&&(a.align=Vo.CENTER),void 0===a.lineHeight&&(a.lineHeight=a.font.common.lineHeight),void 0===a.letterSpacing&&(a.letterSpacing=5),void 0===a.text&&(a.text=""),this.config=a,this.uniforms={map:{type:"t",value:r},color:{type:"v3",value:new l.Color(void 0!==p?p:16777215)},smoothing:{type:"f",value:0},threshold:{type:"f",value:.4}},l.Mesh.call(this,kl()(this.config),null),this.name="text",this.type="TextBitmap",h=void 0!==h?h:Vo.BITMAP;var y=.01;Object.defineProperties(this,{fontScale:{get:function(){return y},set:function(b){y=b,this.updateGeometry()}},shader:{get:function(){return h},set:function(b){h=b,this.updateShader()}},texture:{get:function(){return this.uniforms.map.value},set:function(b){this.uniforms.map.value=b,this.material.needsUpdate=!0}},font:{get:function(){return this.config.font},set:function(b){this.config.font=b,this.updateGeometry()}},text:{get:function(){return this.config.text},set:function(b){this.config.text!==b&&(this.config.text=b,this.updateGeometry())}},lineHeight:{get:function(){return this.config.lineHeight},set:function(b){this.config.lineHeight=b,this.updateGeometry()}},letterSpacing:{get:function(){return this.config.letterSpacing},set:function(b){this.config.letterSpacing=b,this.updateGeometry()}},align:{get:function(){return this.config.align},set:function(b){this.config.align=b,this.updateGeometry()}},width:{get:function(){return this.config.width},set:function(b){this.config.width=b,this.updateGeometry()}},color:{get:function(){return this.uniforms.color.value},set:function(b){this.uniforms.color.value=b}},threshold:{get:function(){return this.uniforms.threshold.value},set:function(b){this.uniforms.threshold.value=b}},smoothing:{get:function(){return this.uniforms.smoothing.value},set:function(b){this.uniforms.smoothing.value=b}}}),this.updateGeometry(),this.updateShader(r)}function Fl(a,r){wi.call(this,"text","TextFile"),this.format="string",this.encoding=void 0!==r?r:"txt",this.data=void 0!==a?a:""}function ea(a,r,h,p,y,b,N,O,T,z){uh.call(this,ea.EMPTY_GEOMETRY,r),this.name="text",this.type="TextMesh",this.font=void 0!==h?h:null,this.extruded=void 0===z||z,this.size=void 0!==O?O:1,this.height=void 0!==p?p:.5,this.curveSegments=void 0!==T?T:15,this.bevel=void 0!==y&&y,this.bevelThickness=void 0!==b?b:.1,this.bevelSize=void 0!==N?N:.05,void 0!==a&&(a="text"),Object.defineProperties(this,{text:{get:function(){return a},set:function(ee){a!==ee&&(a=ee,this.updateGeometry())}}}),this.updateGeometry()}function Oa(a,r,h,p,y,b,N,O,T,z,ee){l.Texture.call(this,document.createElement("canvas"),h,p,y,b,N,O,T,z,ee),this.name="canvas",this.category="Canvas",this.format=l.RGBAFormat,Object.defineProperties(this,{width:{get:function(){return this.image.width},set:function(oe){this.image.width=oe}},height:{get:function(){return this.image.height},set:function(oe){this.image.height=oe}}}),this.width=void 0!==a?a:1,this.height=void 0!==r?r:1,this.context=this.image.getContext("2d")}function kc(){this.texture=new Oa,this.canvas=this.texture.image;var a=new l.SpriteMaterial({map:this.texture,color:16777215,transparent:!0,alphaTest:.4,depthTest:!0,depthWrite:!0,sizeAttenuation:!0});l.Sprite.call(this,a),this.name="sprite",this.type="CanvasSprite",Object.defineProperties(this,{sizeAttenuation:{get:function(){return this.material.sizeAttenuation},set:function(r){this.material.sizeAttenuation=r,this.material.needsUpdate=!0}}})}function cc(){kc.call(this),this.name="text",this.type="TextSprite";var a="",r="#FFFFFF",h=!0,p="#000000",y=1,b=32,N=cc.CENTER,O="arial";Object.defineProperties(this,{font:{get:function(){return O},set:function(T){O=T,this.drawText()}},align:{get:function(){return N},set:function(T){N=T,this.drawText()}},color:{get:function(){return r},set:function(T){r=T,this.drawText()}},text:{get:function(){return a},set:function(T){T!==a&&(a=T,this.drawText())}},outline:{get:function(){return h},set:function(T){h=T,this.drawText()}},outlineColor:{get:function(){return p},set:function(T){p=T,this.drawText()}},outlineWidth:{get:function(){return y},set:function(T){y=T,this.drawText()}},resolution:{get:function(){return b},set:function(T){b=T,this.drawText()}}}),this.text="text"}(Vo.prototype=Object.create(l.Mesh.prototype)).constructor=Vo,Vo.BITMAP=100,Vo.SDF=101,Vo.MSDF=102,Vo.LEFT="left",Vo.CENTER="center",Vo.RIGHT="right",Vo.prototype.setText=function(a){this.text=a},Vo.prototype.updateShader=function(){this.material=new l.ShaderMaterial({uniforms:this.uniforms,fragmentShader:this.shader===Vo.SDF?"/**\n * Shader object used to render single channel SDF data.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n * \n * Details about signed distance fields for vetorial shapes rendering.\n *    - https:// steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\n */\nvarying vec2 vUv;\nuniform sampler2D map;\nuniform vec3 color;\nuniform float smoothing;\nuniform float threshold;\n\nvoid main()\n{\n\tfloat distance = texture2D(map, vUv).a;\n\tfloat alpha = smoothstep(threshold - smoothing, threshold + smoothing, distance);\n\tgl_FragColor = vec4(color, alpha);\n}":this.shader===Vo.MSDF?"/*\n * Shader object used to render single channel MSDF data.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n * \n * Details about Multi\u2010Channel Signed Distance Fields for vetorial shapes rendering.\n *    - https:// onlinelibrary.wiley.com/doi/full/10.1111/cgf.13265\n */\n\nvarying vec2 vUv;\nuniform sampler2D map;\nuniform vec3 color;\nuniform float smoothing;\nuniform float threshold;\n\nfloat median(float r, float g, float b)\n{\n\treturn max(min(r, g), min(max(r, g), b));\n}\n\nvoid main()\n{\n\tvec3 smpl = texture2D(map, vUv).rgb;\n\tfloat sigDist = median(smpl.r, smpl.g, smpl.b) - 0.5;\n\tfloat alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\n\tgl_FragColor = vec4(color, 1.0 - alpha);\n}\n":"/**\n * Shader object used to render the bitmap directly without any processing.\n *\n * Contains only the fragment shader code, the vertex is the same for every render mode.\n */\nvarying vec2 vUv;\nuniform sampler2D map;\n\nvoid main()\n{\n\tgl_FragColor = texture2D(map, vUv);\n}\n",vertexShader:"/**\n * Vertex shader used to draw the text, is responsible for applying the billboard effect by removing the rotation from the transformation matrix.\n */\n#define BILLBOARD 0 \n\nvarying vec2 vUv;\n\nvoid main()\n{\n\tvUv = uv;\n\t\n\t#if BILLBOARD\n\t\tmat4 model = modelViewMatrix; \n\t\tmodel[0][0] = 1.0;\n\t\tmodel[0][1] = 0.0;\n\t\tmodel[0][2] = 0.0;\n\t\t\n\t\tmodel[1][0] = 0.0;\n\t\tmodel[1][1] = 1.0;\n\t\tmodel[1][2] = 0.0;\n\t\t\n\t\tmodel[2][0] = 0.0;\n\t\tmodel[2][1] = 0.0;\n\t\tmodel[2][2] = 1.0;\n\t\t\n\t\tgl_Position = projectionMatrix * model * vec4(position, 1.0);\n\t#else\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t#endif\n\t\n}",side:l.DoubleSide,transparent:!0,depthTest:!0}),this.material.extensions.derivatives=this.shader===Vo.MSDF},Vo.prototype.updateGeometry=function(){if(this.geometry.update(this.config),1!==this.fontScale)for(var a=this.geometry.attributes.position.array,r=0;r<a.length;r++)a[r]*=this.fontScale},Vo.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.texture=this.texture.toJSON(a).uuid,r.object.fontScale=this.fontScale,r.object.shader=this.shader,r.object.text=this.text,r.object.font=this.font,r.object.lineHeight=this.lineHeight,r.object.letterSpacing=this.letterSpacing,r.object.align=this.align,r.object.width=this.width,r.object.color=this.color,r.object.threshold=this.threshold,r.object.smoothing=this.smoothing,r},Vo.fromJSON=function(a,r){var h=new Vo(a,r,a.shader);return h.color=a.color,h.threshold=a.threshold,h.smoothing=a.smoothing,h.fontScale=a.fontScale,h},Fl.prototype=Object.create(wi.prototype),Fl.extensions=[".js",".txt",".glsl",".json",".xml",".yaml",".csv",".css",".html"],Fl.fileIsText=function(a){a=a.name.toLocaleLowerCase();for(var r=0;r<Fl.extensions.length;r++)if(a.endsWith(Fl.extensions[r]))return!0;return!1},Fl.prototype.toJSON=function(a){if(void 0!==a.resources[this.uuid])return a.resources[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.resources[this.uuid]=r,r},ea.prototype=Object.create(uh.prototype),ea.EMPTY_GEOMETRY=new l.Geometry,ea.prototype.setFont=function(a){this.font!==a&&(this.font=a,this.updateGeometry())},ea.prototype.setText=function(a){this.text=a},ea.prototype.updateGeometry=function(){if(null!==this.font){if(void 0!==this.geometry&&this.geometry.dispose(),!0!==this.font.isFont)return console.warn("nunuStudio: Font parameter is not an instance of Font."),void(this.geometry=ea.EMPTY_GEOMETRY);var a=this.font.generateShapes(this.text,this.size);this.extruded?(this.geometry=new l.ExtrudeBufferGeometry(a,{curveSegments:this.curveSegments,depth:this.height,bevelEnabled:this.bevel,bevelSize:this.bevelSize,bevelThickness:this.bevelThickness}),this.geometry.computeVertexNormals()):this.geometry=new l.ShapeBufferGeometry(a,this.curveSegments)}},ea.prototype.clone=function(){return new ea(this.text,this.material,this.font,this.height,this.bevel,this.bevelThickness,this.bevelSize,this.size,this.curveSegments)},ea.prototype.toJSON=function(a){var r=this.geometry;this.geometry=void 0;var h=this.font,p=l.Object3D.prototype.toJSON.call(this,a,function(y,b){h=h.toJSON(y)});return p.object.text=this.text,p.object.font=h.uuid,p.object.size=this.size,p.object.curveSegments=this.curveSegments,p.object.height=this.height,p.object.bevel=this.bevel,p.object.bevelThickness=this.bevelThickness,p.object.bevelSize=this.bevelSize,p.object.extruded=this.extruded,this.geometry=r,p},(Oa.prototype=Object.create(l.Texture.prototype)).constructor=Oa,Oa.prototype.isCanvasTexture=!0,Oa.prototype.placeholder=function(){this.context.fillStyle="#000000",this.context.fillRect(0,0,this.width,this.height),this.context.font="Normal "+Math.round(this.width/12)+"px Arial",this.context.textAlign="center",this.context.fillStyle="#FF0000",this.context.fillText("Canvas Texture",this.width/2,this.height/2),this.needsUpdate=!0},Oa.prototype.clear=function(a){void 0===a?this.context.clearRect(0,0,width,height):(this.context.fillStyle=a,this.context.fillRect(0,0,this.width,this.height))},Oa.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.width=this.width,r.height=this.height,r},kc.prototype=Object.create(l.Sprite.prototype),cc.prototype=Object.create(kc.prototype),cc.LEFT="left",cc.CENTER="center",cc.RIGHT="right",cc.prototype.drawText=function(){var a=this.resolution,r=.8*a,h=this.texture.context;h.font=r+"px "+this.font;var p=h.measureText(this.text).width,y=l.Math.ceilPowerOfTwo(p),b=y/a;this.texture.width=y,this.texture.height=a,h.clearRect(0,0,y,a),0!==this.text.length&&(h.font=r+"px "+this.font,h.textAlign=this.align,h.textBaseline="middle",h.fillStyle=this.color,h.fillText(this.text,y/2,a/2),!0===this.outline&&(h.lineWidth=this.outlineWidth,h.strokeStyle=this.outlineColor,h.strokeText(this.text,y/2,a/2)),this.scale.x=b*this.scale.y,this.texture.needsUpdate=!0)},cc.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.text=this.text,r.object.color=this.color,r.object.outline=this.outline,r.object.outlineColor=this.outlineColor,r.object.outlineWidth=this.outlineWidth,r.object.resolution=this.resolution,r.object.align=this.align,r.object.font=this.font,r},cc.fromJSON=function(a){var r=new cc;return r.text=a.text,r.color=a.color,r.outline=a.outline,r.outlineColor=a.outlineColor,r.outlineWidth=a.outlineWidth,r.resolution=a.resolution,r.align=a.align,r.font=a.font,r};var xd=__webpack_require__(412);function uc(){l.Mesh.call(this,new l.BufferGeometry,new l.MeshBasicMaterial({depthWrite:!1,colorWrite:!1})),this.name="billboard",this.type="BillboardGroup"}function iu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.textures={}}function Bu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="Anonymous"}function hc(a,r,h,p,y,b){l.BufferGeometry.call(this),this.type="TerrainBufferGeometry",this.parameters={width:a||1,height:r||1,widthSegments:h||10,heightSegments:p||10,scale:y||1},this.image=b,this.generate()}function hh(a,r,h,p,y){l.BufferGeometry.call(this),this.type="RoundedBoxBufferGeometry",y=isNaN(y)?1:Math.max(1,Math.floor(y)),a=isNaN(a)?1:a,r=isNaN(r)?1:r,h=isNaN(h)?1:h,p=isNaN(p)?.15:p;var b=a/2-(p=Math.min(p,Math.min(a,Math.min(r,Math.min(h)))/2)),N=r/2-p,O=h/2-p;this.parameters={width:a,height:r,depth:h,radius:p,radiusSegments:y};var Ye,at,pt,T=y+1,z=T*y+1<<3,ee=new l.BufferAttribute(new Float32Array(3*z),3),oe=new l.BufferAttribute(new Float32Array(3*z),3),ne=[],ve=[],xe=(new l.Vector3,new l.Vector3),Te=[],Ce=[],Ie=[],Oe=T*y,Fe=Oe+1;(function(){for(var Ye=[new l.Vector3(1,1,1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,1,1),new l.Vector3(1,-1,1),new l.Vector3(1,-1,-1),new l.Vector3(-1,-1,-1),new l.Vector3(-1,-1,1)],at=0;at<8;at++)ne.push([]),ve.push([]);for(var pt=Math.PI/2,St=new l.Vector3(b,N,O),At=0;At<=y;At++){var Jt=At/y*pt,jt=Math.cos(Jt),Pt=Math.sin(Jt);if(At!==y)for(var Nt=0;Nt<=y;Nt++){var ft=Nt/y*pt;xe.x=jt*Math.cos(ft),xe.y=Pt,xe.z=jt*Math.sin(ft),$t=xe.clone().multiplyScalar(p).add(St),ne[0].push($t),Te.push($t),Zt=xe.clone().normalize(),ve[0].push(Zt),Ce.push(Zt)}else{xe.set(0,1,0);var $t=xe.clone().multiplyScalar(p).add(St);ne[0].push($t),Te.push($t);var Zt=xe.clone();ve[0].push(Zt),Ce.push(Zt)}}for(var _n=1;_n<8;_n++)for(at=0;at<ne[0].length;at++)$t=ne[0][at].clone().multiply(Ye[_n]),ne[_n].push($t),Te.push($t),Zt=ve[0][at].clone().multiply(Ye[_n]),ve[_n].push(Zt),Ce.push(Zt)})(),Ie.push(Ye=Oe,at=Oe+Fe,pt=Oe+2*Fe,Ye,pt,Oe+3*Fe),Ie.push(Ye=Oe+4*Fe,pt=Oe+6*Fe,at=Oe+5*Fe,Ye,Oe+7*Fe,pt),Ie.push(Ye=0,pt=4*Fe,at=Fe,at,pt,5*Fe),Ie.push(Ye=2*Fe,pt=6*Fe,at=3*Fe,at,pt,7*Fe),Ie.push(Ye=y,at=y+3*Fe,pt=y+4*Fe,at,y+7*Fe,pt),Ie.push(Ye=y+Fe,pt=y+5*Fe,at=y+2*Fe,at,pt,y+6*Fe),function(){for(var Ye=[!0,!1,!0,!1,!1,!0,!1,!0],at=T*(y-1),pt=0;pt<8;pt++){for(var St=Fe*pt,At=0;At<y-1;At++)for(var Jt=At*T,jt=(At+1)*T,Pt=0;Pt<y;Pt++){var Nt=Pt+1,ft=St+Jt+Pt,$t=St+Jt+Nt,Zt=St+jt+Pt,_n=St+jt+Nt;Ye[pt]?Ie.push(ft,Zt,$t,$t,Zt,_n):Ie.push(ft,$t,Zt,$t,_n,Zt)}for(Pt=0;Pt<y;Pt++)ft=St+at+Pt,$t=St+at+Pt+1,Zt=St+Oe,Ye[pt]?Ie.push(ft,Zt,$t):Ie.push(ft,$t,Zt)}}(),function(){for(var Ye=0;Ye<4;Ye++)for(var at=Ye*Fe,pt=4*Fe+at,St=!0&Ye,At=0;At<y;At++){var Jt=At+1,jt=at+At,Pt=at+Jt,Nt=pt+At,ft=pt+Jt;St?Ie.push(jt,Nt,Pt,Pt,Nt,ft):Ie.push(jt,Pt,Nt,Pt,ft,Nt)}}(),function(){for(var Ye=y-1,at=[0,1,4,5],pt=[3,2,7,6],St=[0,1,1,0],At=0;At<4;At++)for(var Jt=at[At]*Fe,jt=pt[At]*Fe,Pt=0;Pt<=Ye;Pt++){var Nt=Jt+y+Pt*T,ft=Jt+(Pt!==Ye?y+(Pt+1)*T:Fe-1),$t=jt+y+Pt*T,Zt=jt+(Pt!==Ye?y+(Pt+1)*T:Fe-1);St[At]?Ie.push(Nt,$t,ft,ft,$t,Zt):Ie.push(Nt,ft,$t,ft,Zt,$t)}}(),function(){for(var Ye=[0,2,4,6],at=[1,3,5,7],pt=0;pt<4;pt++)for(var St=Fe*Ye[pt],At=Fe*at[pt],Jt=1>=pt,jt=0;jt<y;jt++){var Pt=jt*T,Nt=(jt+1)*T,ft=St+Pt,$t=St+Nt,Zt=At+Pt,_n=At+Nt;Jt?Ie.push(ft,Zt,$t,$t,Zt,_n):Ie.push(ft,$t,Zt,$t,_n,Zt)}}();for(var je=0,Ue=0;Ue<Te.length;Ue++)ee.setXYZ(je,Te[Ue].x,Te[Ue].y,Te[Ue].z),oe.setXYZ(je,Ce[Ue].x,Ce[Ue].y,Ce[Ue].z),je++;this.setIndex(new l.BufferAttribute(new Uint16Array(Ie),1)),this.addAttribute("position",ee),this.addAttribute("normal",oe)}function Fc(a,r,h,p,y,b,N,O,T){l.BufferGeometry.call(this),this.type="CapsuleBufferGeometry",this.parameters={radiusTop:a,radiusBottom:r,height:h,radialSegments:p,heightSegments:y,capsTopSegments:b,capsBottomSegments:N,thetaStart:O,thetaLength:T},a=void 0!==a?a:1,r=void 0!==r?r:1,h=void 0!==h?h:2,p=Math.floor(p)||8,y=Math.floor(y)||1,b=Math.floor(b)||2,N=Math.floor(N)||2,O=void 0!==O?O:0,T=void 0!==T?T:2*Math.PI;var z=Math.acos((r-a)/h),ee=(p+1)*(y+1+N+b),oe=p*(y+N+b)*2*3,ne=new l.BufferAttribute(new(oe>65535?Uint32Array:Uint16Array)(oe),1),ve=new l.BufferAttribute(new Float32Array(3*ee),3),xe=new l.BufferAttribute(new Float32Array(3*ee),3),Te=new l.BufferAttribute(new Float32Array(2*ee),2),Ce=0,Ie=0,Oe=[],Fe=h/2;(function(){var je,Ue,Ye=new l.Vector3,at=new l.Vector3,pt=Math.cos(z),St=Math.sin(z),At=new l.Vector2(a*St,Fe+a*pt).sub(new l.Vector2(r*St,r*pt-Fe)).length(),Jt=a*z+At+r*(Math.PI/2-z),jt=0;for(Ue=0;Ue<=b;Ue++){var Pt=[],Nt=Math.PI/2-z*(Ue/b);jt+=a*z/b;var ft=Math.cos(Nt),$t=Math.sin(Nt),Zt=ft*a;for(je=0;je<=p;je++){var _n=(lr=je/p)*T+O,xn=Math.sin(_n),wr=Math.cos(_n);at.x=Zt*xn,at.y=Fe+$t*a,at.z=Zt*wr,ve.setXYZ(Ce,at.x,at.y,at.z),Ye.set(ft*xn,$t,ft*wr),xe.setXYZ(Ce,Ye.x,Ye.y,Ye.z),Te.setXY(Ce,lr,1-jt/Jt),Pt.push(Ce),Ce++}Oe.push(Pt)}var ir=h+pt*a-pt*r,Hn=St*(r-a)/ir;for(Ue=1;Ue<=y;Ue++){for(Pt=[],jt+=At/y,Zt=St*(Ue*(r-a)/y+a),je=0;je<=p;je++)_n=(lr=je/p)*T+O,xn=Math.sin(_n),wr=Math.cos(_n),at.x=Zt*xn,at.y=Fe+pt*a-Ue*ir/y,at.z=Zt*wr,ve.setXYZ(Ce,at.x,at.y,at.z),Ye.set(xn,Hn,wr).normalize(),xe.setXYZ(Ce,Ye.x,Ye.y,Ye.z),Te.setXY(Ce,lr,1-jt/Jt),Pt.push(Ce),Ce++;Oe.push(Pt)}for(Ue=1;Ue<=N;Ue++){for(Pt=[],Nt=Math.PI/2-z-(Math.PI-z)*(Ue/N),jt+=r*z/N,ft=Math.cos(Nt),$t=Math.sin(Nt),Zt=ft*r,je=0;je<=p;je++){var lr;_n=(lr=je/p)*T+O,xn=Math.sin(_n),wr=Math.cos(_n),at.x=Zt*xn,at.y=$t*r-Fe,at.z=Zt*wr,ve.setXYZ(Ce,at.x,at.y,at.z),Ye.set(ft*xn,$t,ft*wr),xe.setXYZ(Ce,Ye.x,Ye.y,Ye.z),Te.setXY(Ce,lr,1-jt/Jt),Pt.push(Ce),Ce++}Oe.push(Pt)}for(je=0;je<p;je++)for(Ue=0;Ue<b+y+N;Ue++){var fr=Oe[Ue+1][je],zr=Oe[Ue+1][je+1],xo=Oe[Ue][je+1];ne.setX(Ie,Oe[Ue][je]),Ie++,ne.setX(Ie,fr),Ie++,ne.setX(Ie,xo),Ie++,ne.setX(Ie,fr),Ie++,ne.setX(Ie,zr),Ie++,ne.setX(Ie,xo),Ie++}})(),this.setIndex(ne),this.setAttribute("position",ve),this.setAttribute("normal",xe),this.setAttribute("uv",Te)}function Nu(a,r,h){var p=this.compile(a);l.ParametricBufferGeometry.call(this,p,r,h),this.type="ParametricBufferGeometry",this.parameters={code:a,slices:r,stacks:h}}function bs(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.withCredentials=!1}function Ru(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.shapes={},this.images={}}function ph(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Bh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function zs(a,r,h,p,y){var b=document.createElement("video");b.autoplay=!0,b.loop=!0,l.Texture.call(this,b,a,r,h,l.LinearFilter,l.LinearFilter,l.RGBFormat,p,y);var N=this;this.generateMipmaps=!1,this.disposed=!1,this.name="webcam",this.category="Webcam",this.mode=zs.USER,this.stream=null,this.connect(),requestAnimationFrame(function O(){b.readyState>=b.HAVE_CURRENT_DATA&&(N.needsUpdate=!0),N.disposed||requestAnimationFrame(O)})}function Dl(a,r){wi.call(this,"video","Video"),void 0!==a&&(a instanceof ArrayBuffer?this.loadArrayBufferData(a,r):ci.isBase64(a)?(this.encoding=ci.getFileFormat(a),this.format="base64",this.data=a):this.loadArrayBufferData(Rn.readFileArrayBuffer(a),Rn.getFileExtension(a)))}function xa(a,r,h,p,y,b){l.Texture.call(this,document.createElement("video"),r,h,p,l.LinearFilter,l.LinearFilter,l.RGBFormat,y,b),this.disposed=!1,this.generateMipmaps=!1,this.name="video",this.category="Video",this.autoplay=!0,this.loop=!0,this.playbackRate=1,this.volume=1,this.image.crossOrigin="anonymous",this.image.autoplay=this.autoplay,this.image.playbackRate=this.playbackRate,this.image.loop=this.loop,this.image.volume=this.volume,this.video=null,this.setVideo(a);var N=this;!function O(){N.disposed||(N.image.readyState>=N.image.HAVE_CURRENT_DATA&&(N.needsUpdate=!0),requestAnimationFrame(O))}()}function Ul(a,r,h,p,y,b,N){ms.call(this,a,y,l.RepeatWrapping,l.RepeatWrapping,l.LinearFilter,l.LinearFilter,l.RGBFormat,b,N),this.name="animation",this.category="SpriteSheet",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.repeat.set(1/r,1/h),this.loop=!0,this.animationSpeed=.1,this._totalFrames=p,this._beginFrame=0,this._endFrame=0,this._framesHorizontal=r,this._framesVertical=h;var O=this;Object.defineProperties(this,{framesHorizontal:{get:function(){return this._framesHorizontal},set:function(T){this._framesHorizontal=T,this.repeat.x=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},framesVertical:{get:function(){return this._framesVertical},set:function(T){this._framesVertical=T,this.repeat.y=1/T,this.totalFrames=this._framesHorizontal*this._framesVertical}},endFrame:{get:function(){return this._endFrame},set:function(T){T>this._totalFrames&&(T=this._totalFrames),this._endFrame=T}},beginFrame:{get:function(){return this._beginFrame},set:function(T){T<0&&(T=0),this.currentFrame=T,this._beginFrame=T}},totalFrames:{get:function(){return this._totalFrames},set:function(T){this._beginFrame=0,this._endFrame=T,this._totalFrames=T}}}),this.currentFrame=0,function T(){O.disposed||(O.step(),setTimeout(T,1e3*O.animationSpeed))}()}function zl(a,r,h,p,y,b,N,O,T,z,ee,oe){l.Texture.call(this,null,b,N,O,T,z,p,y,ee,oe),this.category="DataTexture",this.image={data:a||null,width:r||1,height:h||1},this.magFilter=void 0!==T?T:NearestFilter,this.minFilter=void 0!==z?z:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}function jl(a,r,h,p,y,b,N,O,T,z,ee,oe){l.Texture.call(this,null,b,N,O,T,z,p,y,ee,oe),this.category="Compressed",this.image={width:r,height:h},this.mipmaps=a,this.isCubeTexture=!1,this.flipY=!1,this.generateMipmaps=!1}function Is(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="anonymous",this.images=[],this.videos=[],this.fonts=[]}function Nh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Co(a){B.call(this),this.manager=void 0!==a?a:l.DefaultLoadingManager,this.texturePath=""}(uc.prototype=Object.create(l.Mesh.prototype)).constructor=uc,uc.prototype.isScene=!0,uc.prototype.onBeforeRender=function(a,r,h,p,y,b){var N=new xd.Quaternion;h.getWorldQuaternion(N),this.quaternion.copy(N)},iu.prototype.load=function(a,r,h,p){var y=this;new FileLoader(y.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},iu.prototype.setTextures=function(a){this.textures=a},iu.prototype.parse=function(a){var r=l.MaterialLoader.prototype.parse.call(this,a);if(void 0!==a.materials)for(var h=0,p=a.materials.length;h<p;h++)r.materials.push(this.parse(a.materials[h]));return r},Bu.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Bu.prototype.setPath=function(a){return this.path=a,this},Bu.prototype.loadJSON=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},Bu.prototype.parse=function(a){var r=new fs(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,void 0!==a.width&&(r.width=a.width,r.height=a.height),r},hc.prototype=Object.create(l.BufferGeometry.prototype),hc.constructor=hc,hc.prototype.generate=function(){var a=this.parameters.width,r=this.parameters.height,h=this.parameters.widthSegments,p=this.parameters.heightSegments,y=this.parameters.scale,b=this;this.image.getImageData(function(N,O,T){for(var Zt,_n,xn,z=a/2,ee=r/2,oe=Math.floor(h)||1,ne=oe+1,ve=Math.floor(p)||1,xe=a/oe,Te=r/ve,Ce=[],Ie=[],Oe=[],Fe=[],je=O/(a+1),Ue=T/(r+1),at=0;at<=ve;at++)for(var pt=at*Te-ee,St=0;St<=oe;St++){var At=St*xe-z,Jt=(Zt=pt,void 0,void 0,_n=Math.round((At+z)*je),xn=Math.round((Zt+ee)*Ue)*(4*O)+4*_n,N.data[xn]/255*y);Ie.push(At,Jt,pt),Oe.push(0,1,0),Fe.push(St/oe),Fe.push(1-at/ve)}for(at=0;at<ve;at++)for(St=0;St<oe;St++){var Pt=St+ne*(at+1),Nt=St+1+ne*(at+1),ft=St+1+ne*at;Ce.push(St+ne*at,Pt,ft),Ce.push(Pt,Nt,ft)}b.setIndex(Ce),b.setAttribute("position",new l.Float32BufferAttribute(Ie,3)),b.setAttribute("normal",new l.Float32BufferAttribute(Oe,3)),b.setAttribute("uv",new l.Float32BufferAttribute(Fe,2)),b.computeVertexNormals(),b.boundingBox=null,b.boundingSphere=null})},hc.prototype.toJSON=function(){var a=l.BufferGeometry.prototype.toJSON.call(this);return a.image=this.image.uuid,a},hh.prototype=Object.create(l.BufferGeometry.prototype),hh.constructor=hh,(Fc.prototype=Object.create(l.BufferGeometry.prototype)).constructor=Fc,(Nu.prototype=Object.create(l.ParametricBufferGeometry.prototype)).compile=function(a){try{return new Function("u, v, target","target = target || new Vector3();\n"+a)}catch(r){console.error("nunuStudio: Error occured while compiling ParametricBufferGeometry code.",r)}return function(r,h,p){return p||new l.Vector3}},bs.prototype.load=function(a,r,h,p){var y=this,b=void 0===this.path?LoaderUtils.extractUrlBase(a):this.path,N=new l.FileLoader(this.manager);N.setPath(this.path),N.setWithCredentials(this.withCredentials),N.load(a,function(O){var T=JSON.parse(O),z=T.metadata;if(void 0!==z){var ee=z.type;if(void 0!==ee&&"object"===ee.toLowerCase())return void console.error("nunuStudio: LegacyGeometryLoader: "+a+" should be loaded with ObjectLoader instead.")}var oe=y.parse(T,b);r(oe.geometry,oe.materials)},h,p)},bs.prototype.setPath=function(a){return this.path=a,this},bs.prototype.setResourcePath=function(a){return this.resourcePath=a,this},bs.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},bs.prototype.parse=function(a,r){void 0!==a.data&&(a=a.data),a.scale=void 0!==a.scale?1/a.scale:1;var h=new l.Geometry;return function(p,y){function b(lr,Yn){return lr&1<<Yn}var N,O,T,z,ee,oe,ne,ve,xe,Te,Ce,Ie,Oe,Fe,je,Ue,Ye,at,pt,St,At,Jt,jt,Pt,Nt,ft,Zt=p.faces,_n=p.vertices,xn=p.normals,wr=p.colors,ir=p.scale,Hn=0;if(void 0!==p.uvs){for(N=0;N<p.uvs.length;N++)p.uvs[N].length&&Hn++;for(N=0;N<Hn;N++)y.faceVertexUvs[N]=[]}for(z=0,ee=_n.length;z<ee;)(at=new l.Vector3).x=_n[z++]*ir,at.y=_n[z++]*ir,at.z=_n[z++]*ir,y.vertices.push(at);for(z=0,ee=Zt.length;z<ee;)if(Ce=b(Te=Zt[z++],0),Ie=b(Te,1),Oe=b(Te,3),Fe=b(Te,4),je=b(Te,5),Ue=b(Te,6),Ye=b(Te,7),Ce){if((St=new l.Face3).a=Zt[z],St.b=Zt[z+1],St.c=Zt[z+3],(At=new l.Face3).a=Zt[z+1],At.b=Zt[z+2],At.c=Zt[z+3],z+=4,Ie&&(xe=Zt[z++],St.materialIndex=xe,At.materialIndex=xe),T=y.faces.length,Oe)for(N=0;N<Hn;N++)for(Pt=p.uvs[N],y.faceVertexUvs[N][T]=[],y.faceVertexUvs[N][T+1]=[],O=0;O<4;O++)ft=Pt[2*(ve=Zt[z++])],Nt=new l.Vector2(ft,Pt[2*ve+1]),2!==O&&y.faceVertexUvs[N][T].push(Nt),0!==O&&y.faceVertexUvs[N][T+1].push(Nt);if(Fe&&(ne=3*Zt[z++],St.normal.set(xn[ne++],xn[ne++],xn[ne]),At.normal.copy(St.normal)),je)for(N=0;N<4;N++)ne=3*Zt[z++],jt=new l.Vector3(xn[ne++],xn[ne++],xn[ne]),2!==N&&St.vertexNormals.push(jt),0!==N&&At.vertexNormals.push(jt);if(Ue&&(Jt=wr[oe=Zt[z++]],St.color.setHex(Jt),At.color.setHex(Jt)),Ye)for(N=0;N<4;N++)Jt=wr[oe=Zt[z++]],2!==N&&St.vertexColors.push(new Color(Jt)),0!==N&&At.vertexColors.push(new Color(Jt));y.faces.push(St),y.faces.push(At)}else{if((pt=new l.Face3).a=Zt[z++],pt.b=Zt[z++],pt.c=Zt[z++],Ie&&(xe=Zt[z++],pt.materialIndex=xe),T=y.faces.length,Oe)for(N=0;N<Hn;N++)for(Pt=p.uvs[N],y.faceVertexUvs[N][T]=[],O=0;O<3;O++)ft=Pt[2*(ve=Zt[z++])],Nt=new l.Vector2(ft,Pt[2*ve+1]),y.faceVertexUvs[N][T].push(Nt);if(Fe&&(ne=3*Zt[z++],pt.normal.set(xn[ne++],xn[ne++],xn[ne])),je)for(N=0;N<3;N++)ne=3*Zt[z++],jt=new l.Vector3(xn[ne++],xn[ne++],xn[ne]),pt.vertexNormals.push(jt);if(Ue&&(oe=Zt[z++],pt.color.setHex(wr[oe])),Ye)for(N=0;N<3;N++)oe=Zt[z++],pt.vertexColors.push(new Color(wr[oe]));y.faces.push(pt)}}(a,h),function(p,y){var b=void 0!==p.influencesPerVertex?p.influencesPerVertex:2;if(p.skinWeights)for(var N=0,O=p.skinWeights.length;N<O;N+=b)y.skinWeights.push(new Vector4(p.skinWeights[N],b>1?p.skinWeights[N+1]:0,b>2?p.skinWeights[N+2]:0,b>3?p.skinWeights[N+3]:0));if(p.skinIndices)for(N=0,O=p.skinIndices.length;N<O;N+=b)y.skinIndices.push(new Vector4(p.skinIndices[N],b>1?p.skinIndices[N+1]:0,b>2?p.skinIndices[N+2]:0,b>3?p.skinIndices[N+3]:0));y.bones=p.bones,y.bones&&y.bones.length>0&&(y.skinWeights.length!==y.skinIndices.length||y.skinIndices.length!==y.vertices.length)&&console.warn("nunuStudio: When skinning, number of vertices ("+y.vertices.length+"), skinIndices ("+y.skinIndices.length+"), and skinWeights ("+y.skinWeights.length+") should match.")}(a,h),function(p,y){var b=p.scale;if(void 0!==p.morphTargets)for(var N=0,O=p.morphTargets.length;N<O;N++){y.morphTargets[N]={},y.morphTargets[N].name=p.morphTargets[N].name,y.morphTargets[N].vertices=[];for(var T=y.morphTargets[N].vertices,z=p.morphTargets[N].vertices,ee=0,oe=z.length;ee<oe;ee+=3){var ne=new l.Vector3;ne.x=z[ee]*b,ne.y=z[ee+1]*b,ne.z=z[ee+2]*b,T.push(ne)}}if(void 0!==p.morphColors&&p.morphColors.length>0){var ve=y.faces,xe=p.morphColors[0].colors;for(N=0,O=ve.length;N<O;N++)ve[N].color.fromArray(xe,3*N)}}(a,h),function(p,y){var b=[],N=[];void 0!==p.animation&&N.push(p.animation),void 0!==p.animations&&(p.animations.length?N=N.concat(p.animations):N.push(p.animations));for(var O=0;O<N.length;O++){var T=l.AnimationClip.parseAnimation(N[O],y.bones);T&&b.push(T)}if(y.morphTargets){var z=l.AnimationClip.CreateClipsFromMorphTargetSequences(y.morphTargets,10);b=b.concat(z)}b.length>0&&(y.animations=b)}(a,h),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===a.materials||0===a.materials.length?{geometry:h}:{geometry:h,materials:Loader.prototype.initMaterials(a.materials,this.resourcePath||r,this.crossOrigin)}},Ru.prototype.setImages=function(a){return this.images=a,this},Ru.prototype.setShapes=function(a){return this.shapes=a,this},Ru.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,p)},Ru.prototype.parse=function(a){var r=null;if("CapsuleBufferGeometry"===a.type)r=new Fc(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.capsTopSegments,a.capsBottomSegments,a.thetaStart,a.thetaLength);else if("RoundedBoxBufferGeometry"===a.type)r=new hh(a.width,a.height,a.depth,a.radius,a.radiusSegments);else if("TerrainBufferGeometry"===a.type)r=new hc(a.width,a.height,a.widthSegments,a.heightSegments,a.scale,this.images[a.image]);else if("ParametricBufferGeometry"===a.type)r=new Nu(a.code,a.slices,a.stacks);else if("Geometry"===a.type)r=(new bs).parse(a.data).geometry;else{var h=l.ObjectLoader.prototype.parseGeometries([a],this.shapes);for(var p in h){r=h[p];break}}return r.uuid=a.uuid,r.name=void 0!==a.name?a.name:"geometry",r},ph.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(new Je(JSON.parse(y)))},h,p)},ph.prototype.parse=function(a){if(void 0!==a.data){var r=new Je;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,void 0!==a.reversed&&(r.reversed=a.reversed),"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,r.loadTTF()):"base64"===a.format?(r.format="arraybuffer",r.data=_a.fromBase64(a.data),r.loadTTF()):(r.format=a.format,r.data=a.data,r.font=a.data),r}return new Je(a)},Bh.prototype.load=function(a,r,h,p){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,p)},Bh.prototype.parse=function(a){var r=new Ot;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,"base64"===a.format?(r.format="arraybuffer",r.data=_a.fromBase64(a.data)):"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data):(r.format=a.format,r.data=a.data),r},zs.USER=21,zs.ENVIRONMENT=22,(zs.prototype=Object.create(l.Texture.prototype)).constructor=zs,zs.isTexture=!0,zs.prototype.connect=function(){var a={facingMode:this.mode===zs.USER?"user":{exact:"environment"}},r=this;void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:a}).then(function(h){r.stream=h,r.image.srcObject=h,r.image.play()}).catch(function(h){console.warn("nunuStudio: No webcam available")}):navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(h){r.stream=h,r.image.src=URL.createObjectURL(h)},function(h){console.warn("nunuStudio: No webcam available")})},zs.prototype.disconnect=function(){if(null!==this.stream)for(var a=this.stream.getTracks(),r=0;r<a.length;r++)a[r].stop()},zs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disconnect(),this.disposed=!0,this.image.paused||this.image.pause()},zs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.mode=this.mode,r},Dl.prototype=Object.create(wi.prototype),Dl.fileIsVideo=function(a){return!(void 0===a||!a.type.startsWith("video"))},Dl.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),p=new Blob([h],{type:"video/"+r});this.data=URL.createObjectURL(p),this.arraybuffer=a,this.encoding=r,this.format="arraybuffer"},Dl.prototype.toJSON=function(a){if(void 0!==a.videos[this.uuid])return a.videos[this.uuid];var r=wi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=_a.fromBase64(ci.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.videos[this.uuid]=r,r},xa.prototype=Object.create(l.Texture.prototype),xa.isVideoTexture=!0,xa.prototype.setVideo=function(a){if(null==a)return this.video=null,void(this.image.src=null);this.video="string"==typeof a?new Dl(a):a,this.image.src=this.video.data},xa.prototype.setTime=function(a){this.image.currentTime=a},xa.prototype.setLoop=function(a){this.loop=a,this.image.loop=a},xa.prototype.setVolume=function(a){this.volume=a>=0&&a<=1?a:a>=0?1:0,this.image.volume=this.volume},xa.prototype.setAutoPlay=function(a){this.autoplay=a,this.image.autoplay=this.autoplay},xa.prototype.setPlaybackRate=function(a){this.playbackRate=a,this.image.playbackRate=a},xa.prototype.pause=function(){this.image.paused||this.image.pause()},xa.prototype.play=function(){this.image.paused&&this.image.play()},xa.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0,this.image.pause(),this.image.src="",this.image.load()},xa.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.video.toJSON(a);return r.video=h.uuid,r.loop=this.loop,r.autoplay=this.autoplay,r.playbackRate=this.playbackRate,r.volume=this.volume,r},Ul.prototype=Object.create(ms.prototype),Ul.isTexture=!0,Ul.prototype.step=function(){this.currentFrame++,this.currentFrame>=this._endFrame&&(this.currentFrame=this._beginFrame),this.offset.x=this.currentFrame%this.framesHorizontal/this.framesHorizontal,this.offset.y=1-this.repeat.y-Math.floor(this.currentFrame/this.framesHorizontal)/this.framesVertical},Ul.prototype.setAnimationSpeed=function(a){this.animationSpeed=a},Ul.prototype.setFrameGrid=function(a,r){this._framesHorizontal=a,this._framesVertical=r,this._totalFrames=a*r,this.repeat.set(1/a,1/r)},Ul.prototype.setAnimationFrames=function(a,r){this.beginFrame=a,this.endFrame=r},Ul.prototype.dispose=function(){ms.prototype.dispose.call(this),this.disposed=!0},Ul.prototype.toJSON=function(a){var r=ms.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r.loop=this.loop,r.animationSpeed=this.animationSpeed,r.framesHorizontal=this._framesHorizontal,r.framesVertical=this._framesVertical,r.totalFrames=this._totalFrames,r.beginFrame=this._beginFrame,r.endFrame=this._endFrame,r},(zl.prototype=Object.create(l.Texture.prototype)).constructor=zl,zl.prototype.isDataTexture=!0,zl.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.image={height:this.image.height,width:this.image.width,data:Array.from(this.image.data)},r},(jl.prototype=Object.create(l.Texture.prototype)).constructor=jl,jl.prototype.isCompressedTexture=!0,jl.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.isCubeTexture=this.isCubeTexture,this.isCubeTexture){r.image=[];for(var h=0;h<this.image.length;h++){for(var p={mipmaps:[],format:this.image[h].format,width:this.image[h].width,height:this.image[h].height},y=0;y<this.image[h].mipmaps.length;y++)p.mipmaps.push({width:this.image[h].mipmaps[y].width,height:this.image[h].mipmaps[y].height,data:this.image[h].mipmaps[y].data});r.image.push(p)}}else for(r.mipmaps=[],r.width=this.image.width,r.height=this.image.height,y=0;y<this.mipmaps.length;y++)r.mipmaps.push({width:this.mipmaps[y].width,height:this.mipmaps[y].height,data:this.mipmaps[y].data});return r},Is.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Is.prototype.setPath=function(a){return this.path=a,this},Is.prototype.setImages=function(a){return this.images=a,this},Is.prototype.setVideos=function(a){return this.videos=a,this},Is.prototype.setFonts=function(a){return this.fonts=a,this},Is.prototype.load=function(a,r,h,p){try{var y=new ms(this.path+a);return void 0!==r&&r(y),y}catch(b){return void 0!==p&&p(b),console.warn("nunuStudio: Texture not found",b),new ms}},Is.prototype.loadJSON=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,p)},Is.prototype.parse=function(a,r){var h=null,p=a.category;if("Video"===p)void 0===a.video&&console.warn("nunuStudio: TextureLoader, No video specified for",a.uuid),void 0===this.videos[a.video]&&console.warn("nunuStudio: TextureLoader, Undefined video",a.video),(h=new xa(this.videos[a.video])).setLoop(a.loop),h.setAutoPlay(a.autoplay),h.setPlaybackRate(a.playbackRate),h.setVolume(a.volume);else if("Webcam"===p)h=new zs,void 0!==a.mode&&(h.mode=a.mode);else if("Compressed"===p)if(a.isCubeTexture){(h=new jl).image=[],h.isCubeTexture=!0;for(var y=0;y<a.image.length;y++){for(var b=0;b<a.image[y].mipmaps.length;b++)void 0!==a.image[y].mipmaps[b].data.toArrayBuffer&&(a.image[y].mipmaps[b].data=new Uint8Array(a.image[y].mipmaps[b].data.toArrayBuffer()));h.image.push(a.image[y])}}else{for(b=0;b<a.mipmaps.length;b++)void 0!==a.mipmaps[b].data.toArrayBuffer&&(a.mipmaps[b].data=new Uint8Array(a.mipmaps[b].data.toArrayBuffer()));h=new jl(a.mipmaps,a.width,a.height)}else if("Cube"===p){var N=[];for(b=0;b<a.images.length;b++)void 0===this.images[a.images[b]]&&console.warn("nunuStudio: TextureLoader, undefined image",a.images[b]),N.push(this.images[a.images[b]]);(h=new Tr).setImages(N,a.mode),h.setSize(a.size),h.updateImages()}else"Canvas"===p?h=new Oa(a.width,a.height):"DataTexture"===p?h=new zl(new Float32Array(a.image.data),a.image.width,a.image.height):(void 0===a.image&&console.warn("nunuStudio: TextureLoader, no image specified for",a.uuid),void 0===this.images[a.image]&&console.warn("nunuStudio: TextureLoader, undefined image",a.image),"SpriteSheet"===p?((h=new Ul(this.images[a.image],a.framesHorizontal,a.framesVertical,a.totalFrames)).loop=a.loop,h.animationSpeed=a.animationSpeed,h.beginFrame=a.beginFrame,h.endFrame=a.endFrame):h=new ms(this.images[a.image]));return h.needsUpdate=!0,h.uuid=a.uuid,h.name=a.name,h.mapping=a.mapping,h.repeat.set(a.repeat[0],a.repeat[1]),h.offset.set(a.offset[0],a.offset[1]),void 0!==a.center&&h.center.set(a.center[0],a.center[1]),void 0!==a.rotation&&(h.rotation=a.rotation),h.wrapS=a.wrap[0],h.wrapT=a.wrap[1],void 0!==a.format&&(h.format=a.format),void 0!==a.type&&(h.type=a.type),void 0!==a.encoding&&(h.encoding=a.encoding),h.minFilter=a.minFilter,h.magFilter=a.magFilter,h.anisotropy=a.anisotropy,h.flipY=a.flipY,void 0!==a.premultiplyAlpha&&(h.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(h.unpackAlignment=a.unpackAlignment),void 0!==r&&r(h),h},Nh.prototype.load=function(a,r,h,p){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,p)},Nh.prototype.parse=function(a){var r=new Dl(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,r},(Co.prototype=Object.create(B.prototype)).load=function(a,r,h,p){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,p)},Co.prototype.parse=function(a,r){this.parseResources(a.resources),this.parseShape(a.shapes),this.parseImages(a.images),this.parseGeometries(a.geometries),this.parseVideos(a.videos),this.parseAudio(a.audio),this.parseFonts(a.fonts),this.parseTextures(a.textures),this.parseMaterials(a.materials);var h=this.parseObject(a.object);return void 0!==a.skeletons&&(this.parseSkeletons(a.skeletons,h),this.bindSkeletons(h)),void 0!==a.images&&0!==a.images.length||void 0!==r&&r(h),h},Co.prototype.setTexturePath=function(a){this.texturePath=a},Co.prototype.setCrossOrigin=function(a){this.crossOrigin=a},Co.prototype.parseResources=function(a){if(void 0!==a)for(var r in a){var h=new Fl(a[r].data,a[r].encoding);h.format=a[r].format,h.name=a[r].name,h.uuid=a[r].uuid,this.resources[h.uuid]=h}return this.resources},Co.prototype.parseShape=function(a){if(void 0!==a)for(var r=0,h=a.length;r<h;r++){var p=(new Shape).fromJSON(a[r]);this.shapes[p.uuid]=p}return this.shapes},Co.prototype.parseGeometries=function(a){if(void 0!==a){var r=new Ru;r.setShapes(this.shapes),r.setImages(this.images);for(var h=0;h<a.length;h++)this.geometries[a[h].uuid]=r.parse(a[h])}return this.geometries},Co.prototype.parseMaterials=function(a){if(void 0!==a){var r=new iu;for(var h in r.setTextures(this.textures),a)this.materials[a[h].uuid]=r.parse(a[h])}return this.materials},Co.prototype.parseImages=function(a){if(void 0!==a){var r=new Bu;for(var h in a)this.images[a[h].uuid]=r.parse(a[h])}return this.images},Co.prototype.parseVideos=function(a){if(void 0!==a){var r=new Nh;for(var h in a)this.videos[a[h].uuid]=r.parse(a[h])}return this.videos},Co.prototype.parseAudio=function(a){if(void 0!==a){var r=new Bh;for(var h in a)this.audio[a[h].uuid]=r.parse(a[h])}return this.audio},Co.prototype.parseFonts=function(a){if(void 0!==a){var r=new ph;for(var h in a)this.fonts[a[h].uuid]=r.parse(a[h])}return this.fonts},Co.prototype.parseTextures=function(a){if(void 0!==a){var r=new Is;for(var h in r.setImages(this.images),r.setVideos(this.videos),a)this.textures[a[h].uuid]=r.parse(a[h])}return this.textures},Co.prototype.parseSkeletons=function(a,r){if(void 0!==a)for(var h=0;h<a.length;h++)this.skeletons[a[h].uuid]=l.Skeleton.fromJSON(a[h],r,this);return this.skeletons},Co.prototype.bindSkeletons=function(a){var r=this;a.traverse(function(h){if(h.isSkinnedMesh&&void 0!==h.skeletonUUID){var p=r.skeletons[h.skeletonUUID];if(void 0===p)return void console.warn("nunuStudio: ObjectLoader Skeleton not found.",h.skeletonUUID);delete h.skeletonUUID,h.bind(p,h.bindMatrix)}})},Co.prototype.parseObject=function(a){var r;try{switch(a.type){case"SpineAnimation":for(var h=0;h<a.textures.length;h++)a.textures[h].texture=this.getTexture(a.textures[h].texture);r=new Ia(a.json,a.atlas,"",a.textures),void 0!==a.animation&&(r.animation=a.animation,r.track=a.track,r.loop=a.loop),void 0!==a.skin&&(r.skin=a.skin);break;case"Audio":(r=new ii(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume);break;case"PositionalAudio":(r=new Wt(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume),r.distanceModel=a.distanceModel,r.panningModel=a.panningModel;break;case"Physics":r=De.fromJSON(a);break;case"ParticleEmiter":r=ko.fromJSON(a,this);break;case"LensFlare":for(r=new ch,void 0!==a.lensFlares&&(a.elements=a.lensFlares),h=0;h<a.elements.length;h++)r.addFlare(this.getTexture(a.elements[h].texture),a.elements[h].size,a.elements[h].distance,new l.Color(a.elements[h].color));break;case"TextMesh":case"Text3D":r=new ea(a.text,this.getMaterial(a.material),this.getFont(a.font),a.height,a.bevel,a.bevelThickness,a.bevelSize,a.size,a.curveSegments,a.extruded);break;case"Program":(r=new hi(a.name)).description=a.description,r.author=a.author,r.version=a.version,r.ar=!0===a.ar,r.vr=a.vr,r.vrScale=a.vrScale,void 0!==a.rendererConfig?r.rendererConfig.fromJSON(a.rendererConfig):(r.rendererConfig.antialiasing=a.antialiasing,r.rendererConfig.shadows=a.shadows,r.rendererConfig.shadowsType=a.shadowsType,r.rendererConfig.toneMapping=a.toneMapping,r.rendererConfig.toneMappingExposure=a.toneMappingExposure),void 0!==a.lockPointer&&(r.lockPointer=a.lockPointer),void 0!==a.defaultScene&&(r.defaultScene=a.defaultScene),void 0!==a.handlePixelRatio&&(r.handlePixelRatio=a.handlePixelRatio);break;case"Sky":if(r=new Lr(a.autoUpdate,a.dayTime,a.sunDistance,a.time),void 0!==a.sun&&(r.sun.shadow.fromJSON(a.sun.shadow),void 0!==a.sun.castShadow&&(r.sun.castShadow=a.sun.castShadow)),void 0!==a.colorTop)for(r.colorTop=[],h=0;h<a.colorTop.length;h++)r.colorTop.push(new l.Color(a.colorTop[h]));if(void 0!==a.colorBottom)for(r.colorBottom=[],h=0;h<a.colorBottom.length;h++)r.colorBottom.push(new l.Color(a.colorBottom[h]));void 0!==a.sunColor&&(r.sunColor=a.sunColor),void 0!==a.moonColor&&(r.moonColor=a.moonColor),void 0!==a.intensity&&(r.intensity=a.intensity);break;case"CubeCamera":r=new br(a.near,a.far,a.resolution,a.autoUpdate);break;case"FirstPersonControls":(r=new nu).sensitivity=a.sensitivity,r.needsButtonPressed=a.needsButtonPressed,r.movementEnabled=a.movementEnabled,r.moveSpeed=a.moveSpeed,r.moveOnPlane=a.moveOnPlane,r.moveKeys=a.moveKeys;break;case"OrbitControls":(r=new va).distance=a.distance,r.maxDistance=a.maxDistance,r.minDistance=a.minDistance,r.sensitivity=a.sensitivity,r.limitUp=a.limitUp,r.limitDown=a.limitDown,r.needsButtonPressed=a.needsButtonPressed,r.zoomEnabled=a.zoomEnabled,r.movementEnabled=a.movementEnabled,void 0!==a.smooth&&(r.smooth=a.smooth,r.friction=a.friction,r.speed=a.speed,r.invertNavigation=a.invertNavigation),void 0!==a.center&&(r.center.fromArray(a.center),r.vector.fromArray(a.vector));break;case"Scene":r=new Fo,void 0!==a.background&&(r.background=Number.isInteger(a.background)?new l.Color(a.background):this.getTexture(a.background)),void 0!==a.environment&&(r.environment=this.getTexture(a.environment)),void 0!==a.fog&&("Fog"===a.fog.type?r.fog=new l.Fog(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(r.fog=new l.FogExp2(a.fog.color,a.fog.density))),void 0!==a.defaultCamera&&(r.defaultCamera=this.parse(a.defaultCamera)),void 0!==a.cameras&&(r.cameras=a.cameras),void 0!==a.usePhysics&&(r.usePhysics=a.usePhysics),void 0!==a.world&&(r.world.gravity.set(a.world.gravity.x,a.world.gravity.y,a.world.gravity.z),r.world.quatNormalizeSkip=a.world.quatNormalizeSkip,r.world.quatNormalizeFast=a.world.quatNormalizeFast,r.world.solver.tolerance=a.world.solver.tolerance,r.world.solver.iterations=a.world.solver.iterations);break;case"PerspectiveCamera":r=new ke(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(r.focus=a.focus),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.filmGauge&&(r.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(r.filmOffset=a.filmOffset),void 0!==a.view&&(r.view=Object.assign({},a.view)),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer));break;case"OrthographicCamera":r=new Ps(a.size,a.aspect,a.mode,a.near,a.far),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer)),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.view&&(r.view=Object.assign({},a.view));break;case"Script":r=new Tn(a.code,a.mode);break;case"PythonScript":r=new Ii(a.code);break;case"NodeScript":(r=new NodeScript).graph=Object2D.parse(a.graph);break;case"RectAreaLight":r=new In(a.color,a.intensity,a.width,a.height);break;case"AmbientLight":r=new Cs(a.color,a.intensity);break;case"DirectionalLight":r=new ml(a.color,a.intensity);break;case"PointLight":r=new He(a.color,a.intensity,a.distance,a.decay);break;case"SpotLight":r=new Us(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":r=new Mu(a.color,a.groundColor,a.intensity);break;case"HTMLView":(r=new rc).height=a.height,r.width=a.width,r.url=a.url;break;case"LightProbe":(r=new Rc).sh.fromArray(a.sh);break;case"InstancedMesh":(r=new Qs(this.getGeometry(a.geometry),this.getMaterial(a.material),a.count)).instanceMatrix=new l.BufferAttribute(new Float32Array(a.instanceMatrix.array),16);break;case"SkinnedMesh":r=new Gn(this.getGeometry(a.geometry),this.getMaterial(a.material)),void 0!==a.skeleton&&(r.skeletonUUID=a.skeleton),void 0!==a.bindMode&&(r.bindMode=a.bindMode),void 0!==a.bindMatrix&&r.bindMatrix.fromArray(a.bindMatrix);break;case"Mesh":r=new uh(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"TextBitmap":r=Vo.fromJSON(a,this.getTexture(a.texture));break;case"TextSprite":r=cc.fromJSON(a);break;case"LOD":r=new l.LOD;break;case"Line":r=new l.Line(this.getGeometry(a.geometry),this.getMaterial(a.material),a.mode);break;case"LineLoop":r=new l.LineLoop(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"LineSegments":r=new l.LineSegments(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"PointCloud":case"Points":r=new l.Points(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"Sprite":r=new Oc(this.getMaterial(a.material));break;case"Group":default:r=new Tu;break;case"BillboardGroup":r=new uc;break;case"Bone":r=new l.Bone}}catch(z){console.error("nunuStudio: Error parsing and creating object "+a.uuid+", object skiped.",z,a),r=new Tu}if(r.uuid=a.uuid,r.name=a.name,r.locked=!0===a.locked||!0===a.hidden,r.folded=!0===a.folded,void 0!==a.frustumCulled&&(r.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(r.renderOrder=a.renderOrder),void 0!==a.animations)for(r.animations=[],h=0;h<a.animations.length;h++){var p=l.AnimationClip.parse(a.animations[h]);void 0!==a.animations[h].uuid&&(p.uuid=a.animations[h].uuid),r.animations.push(p)}if(void 0!==a.matrix&&(r.matrix.fromArray(a.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),void 0!==a.position&&r.position.fromArray(a.position),void 0!==a.rotation&&r.rotation.fromArray(a.rotation),void 0!==a.quaternion&&r.quaternion.fromArray(a.quaternion),void 0!==a.scale&&r.scale.fromArray(a.scale),r.castShadow=!0===a.castShadow,r.receiveShadow=!0===a.receiveShadow,void 0!==a.shadow&&r.shadow.fromJSON(a.shadow),r.visible=!0===a.visible,void 0!==a.userData&&(r.userData=a.userData),void 0!==a.layers&&(r.layers.mask=a.layers),void 0!==a.children)for(var y in a.children)r.add(this.parseObject(a.children[y]));if(void 0!==a.matrixAutoUpdate&&(r.matrixAutoUpdate=a.matrixAutoUpdate,r.matrixAutoUpdate||(r.updateMatrix(),r.updateMatrixWorld(!0))),"Program"===a.type)r.copyResources(this);else if("Scene"===a.type)for(h=0;h<r.cameras.length;h++){var b=r.getCamera(r.cameras[h]);null!==b?r.cameras[h]=b:r.cameras.splice(h,1)}else if("LOD"===a.type)for(var N=a.levels,O=0;O<N.length;O++){var T=N[O];void 0!==(y=r.getObjectByProperty("uuid",T.object))&&r.addLevel(y,T.distance)}return r};const rp="// All uniforms used by vertex / fragment shaders\nuniform float deltaTime;\nuniform float runTime;\nuniform sampler2D textureSampler;\nuniform vec4 textureAnimation;\nuniform float scale;\n",ou="varying vec4 vColor;\n\n#ifdef SHOULD_ROTATE_TEXTURE\n    varying float vAngle;\n#endif\n\n#ifdef SHOULD_CALCULATE_SPRITE\n    varying vec4 vSpriteSheet;\n#endif",_f="// Branch-avoiding comparison fns\n//- http:// theorangeduck.com/page/avoiding-shader-conditionals\nfloat when_gt(float x, float y) {\n    return max(sign(x - y), 0.0);\n}\n\nfloat when_lt(float x, float y) {\n    return min(max(1.0 - sign(x - y), 0.0), 1.0);\n}\n\nfloat when_eq(float x, float y) {\n    return 1.0 - abs(sign(x - y));\n}\n\nfloat when_ge(float x, float y) {\n  return 1.0 - when_lt(x, y);\n}\n\nfloat when_le(float x, float y) {\n  return 1.0 - when_gt(x, y);\n}\n\n// Branch-avoiding logical operators (to be used with above comparison fns)\nfloat and(float a, float b) {\n    return a * b;\n}\n\nfloat or(float a, float b) {\n    return min(a + b, 1.0);\n}";var Pu={vertex:["// Register color-packing define statements.\n#define PACKED_COLOR_SIZE 256.0\n#define PACKED_COLOR_DIVISOR 255.0",rp,"// All attributes used by the vertex shader.\n//\n// Note that some attributes are squashed into other ones\n//\n// Drag is stored in acceleration.w\nattribute vec4 acceleration;\nattribute vec3 velocity;\nattribute vec4 rotation;\nattribute vec3 rotationCenter;\nattribute vec4 params;\nattribute vec4 size;\nattribute vec4 angle;\nattribute vec4 color;\nattribute vec4 opacity;",ou,l.ShaderChunk.common,l.ShaderChunk.logdepthbuf_pars_vertex,l.ShaderChunk.fog_pars_vertex,_f,"// From:\n//- http:// stackoverflow.com/a/12553149\n//- https:// stackoverflow.com/questions/22895237/hexadecimal-to-rgb-values-in-webgl-shader\n// unpackColor\nvec3 unpackColor(in float hex) {\n    vec3 c = vec3(0.0);\n\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float b = mod(hex, PACKED_COLOR_SIZE);\n\n    c.r = r / PACKED_COLOR_DIVISOR;\n    c.g = g / PACKED_COLOR_DIVISOR;\n    c.b = b / PACKED_COLOR_DIVISOR;\n\n    return c;\n}\n\n// unpackRotationAxis\nvec3 unpackRotationAxis(in float hex) {\n    vec3 c = vec3(0.0);\n\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\n    float b = mod(hex, PACKED_COLOR_SIZE);\n\n    c.r = r / PACKED_COLOR_DIVISOR;\n    c.g = g / PACKED_COLOR_DIVISOR;\n    c.b = b / PACKED_COLOR_DIVISOR;\n\n    c *= vec3(2.0);\n    c -= vec3(1.0);\n\n    return c;\n}\n\n// floatOverLifetime:\nfloat getFloatOverLifetime(in float positionInTime, in vec4 attr) {\n    highp float value = 0.0;\n    float deltaAge = positionInTime * float(VALUE_OVER_LIFETIME_LENGTH - 1);\n    float fIndex = 0.0;\n    float shouldApplyValue = 0.0;\n\n    // This might look a little odd, but it's faster in the testing I\"ve done than using branches. Uses basic maths to avoid branching.\n    //\n    // Take a look at the branch-avoidance functions defined above, and be sure to check out The Orange Duck site where I got this from (link above).\n    //\n    // Fix for static emitters (age is always zero).\n    value += attr[0] * when_eq(deltaAge, 0.0);\n\n    for(int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i) {\n        fIndex = float(i);\n        shouldApplyValue = and(when_gt(deltaAge, fIndex), when_le(deltaAge, fIndex + 1.0));\n        value += shouldApplyValue * mix(attr[i], attr[i + 1], deltaAge - fIndex);\n    }\n\n    return value;\n}\n\n// colorOverLifetime\nvec3 getColorOverLifetime(in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4) {\n    vec3 value = vec3(0.0);\n    value.x = getFloatOverLifetime(positionInTime, vec4(color1.x, color2.x, color3.x, color4.x));\n    value.y = getFloatOverLifetime(positionInTime, vec4(color1.y, color2.y, color3.y, color4.y));\n    value.z = getFloatOverLifetime(positionInTime, vec4(color1.z, color2.z, color3.z, color4.z));\n    return value;\n}\n\n// paramFetchingFunctions\nfloat getAlive() {\n    return params.x;\n}\n\nfloat getAge() {\n    return params.y;\n}\n\nfloat getMaxAge() {\n    return params.z;\n}\n\nfloat getWiggle() {\n    return params.w;\n}\n\n// forceFetchingFunctions\nvec4 getPosition(in float age) {\n    return modelViewMatrix * vec4(position, 1.0);\n}\n\nvec3 getVelocity(in float age) {\n    return velocity * age;\n}\n\nvec3 getAcceleration(in float age) {\n    return acceleration.xyz * age;\n}\n\n\n// rotationFunctions\n// Huge thanks to:\n//- http:// www.neilmendoza.com/glsl-rotation-about-an-arbitrary-axis/\n#ifdef SHOULD_ROTATE_PARTICLES\nmat4 getRotationMatrix(in vec3 axis, in float angle) {\n   axis = normalize(axis);\n   float s = sin(angle);\n   float c = cos(angle);\n   float oc = 1.0 - c;\n\n   return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n               oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n               oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n               0.0,                                0.0,                                0.0,                                1.0);\n}\n\nvec3 getRotation(in vec3 pos, in float positionInTime) {\n  if(rotation.y == 0.0) {\n       return pos;\n  }\n\n  vec3 axis = unpackRotationAxis(rotation.x);\n  vec3 center = rotationCenter;\n  vec3 translated;\n  mat4 rotationMatrix;\n\n  float angle = 0.0;\n  angle += when_eq(rotation.z, 0.0) * rotation.y;\n  angle += when_gt(rotation.z, 0.0) * mix(0.0, rotation.y, positionInTime);\n  translated = rotationCenter - pos;\n  rotationMatrix = getRotationMatrix(axis, angle);\n  return center - vec3(rotationMatrix * vec4(translated, 0.0));\n}\n#endif\n","void main() {","// Setup\nhighp float age = getAge();\nhighp float alive = getAlive();\nhighp float maxAge = getMaxAge();\nhighp float positionInTime = (age / maxAge);\nhighp float isAlive = when_gt(alive, 0.0);\n#ifdef SHOULD_WIGGLE_PARTICLES\n\tfloat wiggleAmount = positionInTime * getWiggle();\n\tfloat wiggleSin = isAlive * sin(wiggleAmount);\n\tfloat wiggleCos = isAlive * cos(wiggleAmount);\n#endif\n\n// Forces\n// Get forces & position\nvec3 vel = getVelocity(age);\nvec3 accel = getAcceleration(age);\nvec3 force = vec3(0.0);\nvec3 pos = vec3(position);\n\n// Calculate the required drag to apply to the forces.\nfloat drag = 1.0 - (positionInTime * 0.5) * acceleration.w;\n\n// Integrate forces\nforce += vel;\nforce *= drag;\nforce += accel * age;\npos += force;\n\n// Wiggly wiggly wiggle!\n#ifdef SHOULD_WIGGLE_PARTICLES\n\tpos.x += wiggleSin;\n\tpos.y += wiggleCos;\n\tpos.z += wiggleSin;\n#endif\n\n// Rotate the emitter around it's central point\n#ifdef SHOULD_ROTATE_PARTICLES\n\tpos = getRotation(pos, positionInTime);\n#endif\n\n// Convert pos to a world-space value\nvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\n\n// Determine point size.\nhighp float pointSize = getFloatOverLifetime(positionInTime, size) * isAlive;\n\n// Determine perspective\n#ifdef HAS_PERSPECTIVE\n\tfloat perspective = scale / length(mvPosition.xyz);\n#else\n\tfloat perspective = 1.0;\n#endif\n\n// Apply perpective to pointSize value\nfloat pointSizePerspective = pointSize * perspective;\n\n// Determine color and opacity for this particle\n#ifdef COLORIZE\n\tvec3 c = isAlive * getColorOverLifetime(\n\t\tpositionInTime,\n\t\tunpackColor(color.x),\n\t\tunpackColor(color.y),\n\t\tunpackColor(color.z),\n\t\tunpackColor(color.w)\n\t);\n#else\n\tvec3 c = vec3(1.0);\n#endif\n\nfloat o = isAlive * getFloatOverLifetime(positionInTime, opacity);\n\n// Assign color to vColor varying.\nvColor = vec4(c, o);\n\n// Determine angle\n#ifdef SHOULD_ROTATE_TEXTURE\n\tvAngle = isAlive * getFloatOverLifetime(positionInTime, angle);\n#endif\n\n// If this particle is using a sprite-sheet as a texture, we\"ll have to figure out what frame of the texture the particle is using at it's current position in time.\n#ifdef SHOULD_CALCULATE_SPRITE\n\tfloat framesX = textureAnimation.x;\n\tfloat framesY = textureAnimation.y;\n\tfloat loopCount = textureAnimation.w;\n\tfloat totalFrames = textureAnimation.z;\n\tfloat frameNumber = mod((positionInTime * loopCount) * totalFrames, totalFrames);\n\n\tfloat column = floor(mod(frameNumber, framesX));\n\tfloat row = floor((frameNumber - column) / framesX);\n\n\tfloat columnNorm = column / framesX;\n\tfloat rowNorm = row / framesY;\n\n\tvSpriteSheet.x = 1.0 / framesX;\n\tvSpriteSheet.y = 1.0 / framesY;\n\tvSpriteSheet.z = columnNorm;\n\tvSpriteSheet.w = rowNorm;\n#endif\n\n// Write values\n// Set PointSize according to size at current point in time.\ngl_PointSize = pointSizePerspective;\ngl_Position = projectionMatrix * mvPosition;",l.ShaderChunk.logdepthbuf_vertex,l.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[rp,l.ShaderChunk.common,l.ShaderChunk.fog_pars_fragment,l.ShaderChunk.logdepthbuf_pars_fragment,ou,_f,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if(vColor.w < float(ALPHATEST)) discard;","    #endif","// Rotate Texture\nvec2 vUv = vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y);\n\n#ifdef SHOULD_ROTATE_TEXTURE\n   float x = gl_PointCoord.x - 0.5;\n   float y = 1.0 - gl_PointCoord.y - 0.5;\n   float c = cos(-vAngle);\n   float s = sin(-vAngle);\n\n   vUv = vec2(c * x + s * y + 0.5, c * y - s * x + 0.5);\n#endif\n\n// Spritesheets overwrite angle calculations.\n#ifdef SHOULD_CALCULATE_SPRITE\n    float framesX = vSpriteSheet.x;\n    float framesY = vSpriteSheet.y;\n    float columnNorm = vSpriteSheet.z;\n    float rowNorm = vSpriteSheet.w;\n\n    vUv.x = gl_PointCoord.x * framesX + columnNorm;\n    vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);\n#endif\n\nvec4 rotatedTexture = texture2D(textureSampler, vUv);\n",l.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4(outgoingLight.xyz, rotatedTexture.w * vColor.w);",l.ShaderChunk.fog_fragment,"}"].join("\n")};function Oo(a,r,h,p){this.componentSize=h||1,this.size=r||1,this.TypedArrayConstructor=a||Float32Array,this.array=new a(r*this.componentSize),this.indexOffset=p||0}function Lo(a,r,h){this.type="string"==typeof a&&Lo.typeSizeMap.hasOwnProperty(a)?a:"f",this.componentSize=Lo.typeSizeMap[this.type],this.arrayType=h||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=Boolean(r),this.updateMin=0,this.updateMax=0}Oo.constructor=Oo,Oo.prototype.setSize=function(a,r){var h=this.array.length;return r||(a*=this.componentSize),a<h?this.shrink(a):a>h?this.grow(a):void 0},Oo.prototype.shrink=function(a){return this.array=this.array.subarray(0,a),this.size=a,this},Oo.prototype.grow=function(a){var r=this.array,h=new this.TypedArrayConstructor(a);return h.set(r),this.array=h,this.size=a,this},Oo.prototype.splice=function(a,r){a*=this.componentSize,r*=this.componentSize;for(var h=[],p=this.array,y=p.length,b=0;b<y;++b)(b<a||b>=r)&&h.push(p[b]);return this.setFromArray(0,h),this},Oo.prototype.setFromArray=function(a,r){var h=a+r.length;return h>this.array.length?this.grow(h):h<this.array.length&&this.shrink(h),this.array.set(r,this.indexOffset+a),this},Oo.prototype.setVec2=function(a,r){return this.setVec2Components(a,r.x,r.y)},Oo.prototype.setVec2Components=function(a,r,h){var p=this.array,y=this.indexOffset+a*this.componentSize;return p[y]=r,p[y+1]=h,this},Oo.prototype.setVec3=function(a,r){return this.setVec3Components(a,r.x,r.y,r.z)},Oo.prototype.setVec3Components=function(a,r,h,p){var y=this.array,b=this.indexOffset+a*this.componentSize;return y[b]=r,y[b+1]=h,y[b+2]=p,this},Oo.prototype.setVec4=function(a,r){return this.setVec4Components(a,r.x,r.y,r.z,r.w)},Oo.prototype.setVec4Components=function(a,r,h,p,y){var b=this.array,N=this.indexOffset+a*this.componentSize;return b[N]=r,b[N+1]=h,b[N+2]=p,b[N+3]=y,this},Oo.prototype.setMat3=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Oo.prototype.setMat4=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},Oo.prototype.setColor=function(a,r){return this.setVec3Components(a,r.r,r.g,r.b)},Oo.prototype.setNumber=function(a,r){return this.array[this.indexOffset+a*this.componentSize]=r,this},Oo.prototype.getValueAtIndex=function(a){return this.array[this.indexOffset+a]},Oo.prototype.getComponentValueAtIndex=function(a){return this.array.subarray(this.indexOffset+a*this.componentSize)},Lo.constructor=Lo,Lo.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},Lo.prototype.setUpdateRange=function(a,r){this.updateMin=Math.min(a*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(r*this.componentSize,this.updateMax*this.componentSize)},Lo.prototype.flagUpdate=function(){var a=this.bufferAttribute.updateRange;a.offset=this.updateMin,a.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),this.bufferAttribute.needsUpdate=!0},Lo.prototype.resetUpdateRange=function(){this.updateMin=0,this.updateMax=0},Lo.prototype.resetDynamic=function(){this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Lo.prototype.splice=function(a,r){this.typedArray.splice(a,r),this.forceUpdateAll()},Lo.prototype.forceUpdateAll=function(){this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.usage=l.StaticDrawUsage,this.bufferAttribute.needsUpdate=!0},Lo.prototype._ensureTypedArray=function(a){null!==this.typedArray&&this.typedArray.size===a*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==a?this.typedArray.setSize(a):null===this.typedArray&&(this.typedArray=new Oo(this.arrayType,a,this.componentSize)))},Lo.prototype._createBufferAttribute=function(a){if(this._ensureTypedArray(a),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize,void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new l.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Lo.prototype.getLength=function(){return null===this.typedArray?0:this.typedArray.array.length};var Dc,kt={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(a,r,h){return typeof a===r?a:h},ensureArrayTypedArg:function(a,r,h){if(Array.isArray(a)){for(var p=a.length-1;p>=0;--p)if(typeof a[p]!==r)return h;return a}return this.ensureTypedArg(a,r,h)},ensureInstanceOf:function(a,r,h){return void 0!==r&&a instanceof r?a:h},ensureArrayInstanceOf:function(a,r,h){if(Array.isArray(a)){for(var p=a.length-1;p>=0;--p)if(void 0!==r&&a[p]instanceof r==0)return h;return a}return this.ensureInstanceOf(a,r,h)},ensureValueOverLifetimeCompliance:function(a,r,h){r=r||3,h=h||3,!1===Array.isArray(a._value)&&(a._value=[a._value]),!1===Array.isArray(a._spread)&&(a._spread=[a._spread]);var p=this.clamp(a._value.length,r,h),y=this.clamp(a._spread.length,r,h),b=Math.max(p,y);a._value.length!==b&&(a._value=this.interpolateArray(a._value,b)),a._spread.length!==b&&(a._spread=this.interpolateArray(a._spread,b))},interpolateArray:function(a,r){for(var h=a.length,p=["function"==typeof a[0].clone?a[0].clone():a[0]],y=(h-1)/(r-1),b=1;b<r-1;++b){var N=b*y,O=Math.floor(N),T=Math.ceil(N);p[b]=this.lerpTypeAgnostic(a[O],a[T],N-O)}return p.push("function"==typeof a[h-1].clone?a[h-1].clone():a[h-1]),p},clamp:function(a,r,h){return Math.max(r,Math.min(a,h))},zeroToEpsilon:function(a,r){var h=1e-5,p=a;return p=r?Math.random()*h*10:h,a<0&&a>-1e-5&&(p=-p),p},lerpTypeAgnostic:function(a,r,h){var p,y=this.types;return typeof a===y.NUMBER&&typeof r===y.NUMBER?a+(r-a)*h:a instanceof l.Vector2&&r instanceof l.Vector2?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p):a instanceof l.Vector3&&r instanceof l.Vector3?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p.z=this.lerp(a.z,r.z,h),p):a instanceof l.Vector4&&r instanceof l.Vector4?((p=a.clone()).x=this.lerp(a.x,r.x,h),p.y=this.lerp(a.y,r.y,h),p.z=this.lerp(a.z,r.z,h),p.w=this.lerp(a.w,r.w,h),p):a instanceof l.Color&&r instanceof l.Color?((p=a.clone()).r=this.lerp(a.r,r.r,h),p.g=this.lerp(a.g,r.g,h),p.b=this.lerp(a.b,r.b,h),p):void console.warn("nunuStudio: Invalid argument types, or argument types do not match.",a,r)},lerp:function(a,r,h){return a+(r-a)*h},roundToNearestMultiple:function(a,r){var h;return 0===r||0==(h=Math.abs(a)%r)?a:a<0?-(Math.abs(a)-h):a+r-h},arrayValuesAreEqual:function(a){for(var r=0;r<a.length-1;++r)if(a[r]!==a[r+1])return!1;return!0},randomFloat:function(a,r){return a+r*(Math.random()-.5)},randomVector3:function(a,r,h,p,y){var b=h.x+(Math.random()*p.x-.5*p.x),N=h.y+(Math.random()*p.y-.5*p.y),O=h.z+(Math.random()*p.z-.5*p.z);y&&(b=.5*-y.x+this.roundToNearestMultiple(b,y.x),N=.5*-y.y+this.roundToNearestMultiple(N,y.y),O=.5*-y.z+this.roundToNearestMultiple(O,y.z)),a.typedArray.setVec3Components(r,b,N,O)},randomColor:function(a,r,h,p){var y=h.r+Math.random()*p.x,b=h.g+Math.random()*p.y,N=h.b+Math.random()*p.z;y=this.clamp(y,0,1),b=this.clamp(b,0,1),N=this.clamp(N,0,1),a.typedArray.setVec3Components(r,y,b,N)},randomColorAsHex:(Dc=new l.Color,function(a,r,h,p){for(var y=h.length,b=[],N=0;N<y;++N){var O=p[N];Dc.copy(h[N]),Dc.r+=Math.random()*O.x-.5*O.x,Dc.g+=Math.random()*O.y-.5*O.y,Dc.b+=Math.random()*O.z-.5*O.z,Dc.r=this.clamp(Dc.r,0,1),Dc.g=this.clamp(Dc.g,0,1),Dc.b=this.clamp(Dc.b,0,1),b.push(Dc.getHex())}a.typedArray.setVec4Components(r,b[0],b[1],b[2],b[3])}),randomVector3OnSphere:function(a,r,h,p,y,b,N,O){var T=2*Math.random()-1,z=6.2832*Math.random(),ee=Math.sqrt(1-T*T),oe=this.randomFloat(p,y),ne=0,ve=0,xe=0;N&&(oe=Math.round(oe/N)*N),ne=ee*Math.cos(z)*oe,ve=ee*Math.sin(z)*oe,xe=T*oe,ne*=b.x,ve*=b.y,xe*=b.z,a.typedArray.setVec3Components(r,ne+=h.x,ve+=h.y,xe+=h.z)},seededRandom:function(a){var r=1e4*Math.sin(a);return r-(0|r)},randomVector3OnDisc:function(a,r,h,p,y,b,N){var O=6.2832*Math.random(),T=Math.abs(this.randomFloat(p,y)),z=0,ee=0,oe=0;N&&(T=Math.round(T/N)*N),z=Math.cos(O)*T,ee=Math.sin(O)*T,z*=b.x,ee*=b.y,a.typedArray.setVec3Components(r,z+=h.x,ee+=h.y,oe+=h.z)},randomDirectionVector3OnSphere:function(){var a=new l.Vector3;return function(r,h,p,y,b,N,O,T){a.copy(N),a.x-=p,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(O,T)),r.typedArray.setVec3Components(h,a.x,a.y,a.z)}}(),randomDirectionVector3OnDisc:function(){var a=new l.Vector3;return function(r,h,p,y,b,N,O,T){a.copy(N),a.x-=p,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(O,T)),r.typedArray.setVec3Components(h,a.x,a.y,0)}}(),getPackedRotationAxis:function(){var a=new l.Vector3,r=new l.Vector3,h=new l.Color,p=new l.Vector3(1,1,1);return function(y,b){return a.copy(y).normalize(),r.copy(b).normalize(),a.x+=.5*-b.x+Math.random()*b.x,a.y+=.5*-b.y+Math.random()*b.y,a.z+=.5*-b.z+Math.random()*b.z,a.normalize().add(p).multiplyScalar(.5),h.setRGB(a.x,a.y,a.z),h.getHex()}}()},Fp={BOX:1,SPHERE:2,DISC:3};function ji(a){for(var r in(a=kt.ensureTypedArg(a,kt.types.OBJECT,{})).position=kt.ensureTypedArg(a.position,kt.types.OBJECT,{}),a.velocity=kt.ensureTypedArg(a.velocity,kt.types.OBJECT,{}),a.acceleration=kt.ensureTypedArg(a.acceleration,kt.types.OBJECT,{}),a.radius=kt.ensureTypedArg(a.radius,kt.types.OBJECT,{}),a.drag=kt.ensureTypedArg(a.drag,kt.types.OBJECT,{}),a.rotation=kt.ensureTypedArg(a.rotation,kt.types.OBJECT,{}),a.color=kt.ensureTypedArg(a.color,kt.types.OBJECT,{}),a.opacity=kt.ensureTypedArg(a.opacity,kt.types.OBJECT,{}),a.size=kt.ensureTypedArg(a.size,kt.types.OBJECT,{}),a.angle=kt.ensureTypedArg(a.angle,kt.types.OBJECT,{}),a.wiggle=kt.ensureTypedArg(a.wiggle,kt.types.OBJECT,{}),a.maxAge=kt.ensureTypedArg(a.maxAge,kt.types.OBJECT,{}),a.onParticleSpawn&&console.warn("nunuStudio: onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=l.Math.generateUUID(),this.type=kt.ensureTypedArg(a.type,kt.types.NUMBER,Fp.BOX),this.position={_value:kt.ensureInstanceOf(a.position.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.position.spread,l.Vector3,new l.Vector3),_spreadClamp:kt.ensureInstanceOf(a.position.spreadClamp,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.position.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1),_radius:kt.ensureTypedArg(a.position.radius,kt.types.NUMBER,10),_radiusScale:kt.ensureInstanceOf(a.position.radiusScale,l.Vector3,new l.Vector3(1,1,1)),_distributionClamp:kt.ensureTypedArg(a.position.distributionClamp,kt.types.NUMBER,0)},this.velocity={_value:kt.ensureInstanceOf(a.velocity.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.velocity.spread,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.velocity.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.acceleration={_value:kt.ensureInstanceOf(a.acceleration.value,l.Vector3,new l.Vector3),_spread:kt.ensureInstanceOf(a.acceleration.spread,l.Vector3,new l.Vector3),_distribution:kt.ensureTypedArg(a.acceleration.distribution,kt.types.NUMBER,this.type),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.drag={_value:kt.ensureTypedArg(a.drag.value,kt.types.NUMBER,0),_spread:kt.ensureTypedArg(a.drag.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.wiggle={_value:kt.ensureTypedArg(a.wiggle.value,kt.types.NUMBER,0),_spread:kt.ensureTypedArg(a.wiggle.spread,kt.types.NUMBER,0)},this.rotation={_axis:kt.ensureInstanceOf(a.rotation.axis,l.Vector3,new l.Vector3(0,1,0)),_axisSpread:kt.ensureInstanceOf(a.rotation.axisSpread,l.Vector3,new l.Vector3),_angle:kt.ensureTypedArg(a.rotation.angle,kt.types.NUMBER,0),_angleSpread:kt.ensureTypedArg(a.rotation.angleSpread,kt.types.NUMBER,0),_static:kt.ensureTypedArg(a.rotation.static,kt.types.BOOLEAN,!1),_center:kt.ensureInstanceOf(a.rotation.center,l.Vector3,this.position._value.clone()),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.maxAge={_value:kt.ensureTypedArg(a.maxAge.value,kt.types.NUMBER,2),_spread:kt.ensureTypedArg(a.maxAge.spread,kt.types.NUMBER,0)},this.color={_value:kt.ensureArrayInstanceOf(a.color.value,l.Color,new l.Color),_spread:kt.ensureArrayInstanceOf(a.color.spread,l.Vector3,new l.Vector3),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.opacity={_value:kt.ensureArrayTypedArg(a.opacity.value,kt.types.NUMBER,1),_spread:kt.ensureArrayTypedArg(a.opacity.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.size={_value:kt.ensureArrayTypedArg(a.size.value,kt.types.NUMBER,1),_spread:kt.ensureArrayTypedArg(a.size.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.angle={_value:kt.ensureArrayTypedArg(a.angle.value,kt.types.NUMBER,0),_spread:kt.ensureArrayTypedArg(a.angle.spread,kt.types.NUMBER,0),_randomise:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)},this.particleCount=kt.ensureTypedArg(a.particleCount,kt.types.NUMBER,100),this.duration=kt.ensureTypedArg(a.duration,kt.types.NUMBER,null),this.isStatic=kt.ensureTypedArg(a.isStatic,kt.types.BOOLEAN,!1),this.activeMultiplier=kt.ensureTypedArg(a.activeMultiplier,kt.types.NUMBER,1),this.direction=kt.ensureTypedArg(a.direction,kt.types.NUMBER,1),this.alive=kt.ensureTypedArg(a.alive,kt.types.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:kt.ensureTypedArg(a.position.randomise,kt.types.BOOLEAN,!1)||kt.ensureTypedArg(a.radius.randomise,kt.types.BOOLEAN,!1),velocity:kt.ensureTypedArg(a.velocity.randomise,kt.types.BOOLEAN,!1),acceleration:kt.ensureTypedArg(a.acceleration.randomise,kt.types.BOOLEAN,!1)||kt.ensureTypedArg(a.drag.randomise,kt.types.BOOLEAN,!1),rotation:kt.ensureTypedArg(a.rotation.randomise,kt.types.BOOLEAN,!1),rotationCenter:kt.ensureTypedArg(a.rotation.randomise,kt.types.BOOLEAN,!1),size:kt.ensureTypedArg(a.size.randomise,kt.types.BOOLEAN,!1),color:kt.ensureTypedArg(a.color.randomise,kt.types.BOOLEAN,!1),opacity:kt.ensureTypedArg(a.opacity.randomise,kt.types.BOOLEAN,!1),angle:kt.ensureTypedArg(a.angle.randomise,kt.types.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(r)&&(this.updateCounts[this.updateMap[r]]=0,this.updateFlags[this.updateMap[r]]=!1,this._createGetterSetters(this[r],r));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,kt.ensureValueOverLifetimeCompliance(this.color,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.opacity,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.size,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength),kt.ensureValueOverLifetimeCompliance(this.angle,ko.valueOverLifetimeLength,ko.valueOverLifetimeLength)}function Gs(a){(a=kt.ensureTypedArg(a,kt.types.OBJECT,{})).texture=kt.ensureTypedArg(a.texture,kt.types.OBJECT,{}),this.uuid=l.Math.generateUUID(),this.fixedTimeStep=kt.ensureTypedArg(a.fixedTimeStep,kt.types.NUMBER,.016),this.texture=kt.ensureInstanceOf(a.texture.value,l.Texture,null),this.textureFrames=kt.ensureInstanceOf(a.texture.frames,l.Vector2,new l.Vector2(1,1)),this.textureFrameCount=kt.ensureTypedArg(a.texture.frameCount,kt.types.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=kt.ensureTypedArg(a.texture.loop,kt.types.NUMBER,1),this.textureFrames.max(new l.Vector2(1,1)),this.hasPerspective=kt.ensureTypedArg(a.hasPerspective,kt.types.BOOLEAN,!0),this.colorize=kt.ensureTypedArg(a.colorize,kt.types.BOOLEAN,!0),this.maxParticleCount=kt.ensureTypedArg(a.maxParticleCount,kt.types.NUMBER,null),this.blending=kt.ensureTypedArg(a.blending,kt.types.NUMBER,l.AdditiveBlending),this.transparent=kt.ensureTypedArg(a.transparent,kt.types.BOOLEAN,!0),this.alphaTest=parseFloat(kt.ensureTypedArg(a.alphaTest,kt.types.NUMBER,0)),this.depthWrite=kt.ensureTypedArg(a.depthWrite,kt.types.BOOLEAN,!1),this.depthTest=kt.ensureTypedArg(a.depthTest,kt.types.BOOLEAN,!0),this.fog=kt.ensureTypedArg(a.fog,kt.types.BOOLEAN,!0),this.scale=kt.ensureTypedArg(a.scale,kt.types.NUMBER,300),this.emitters=[],this.emitterIDs=[],this.pool=[],this.poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={textureSampler:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new l.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:ko.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1},this.attributes={position:new Lo("v3",!0),acceleration:new Lo("v4",!0),velocity:new Lo("v3",!0),rotation:new Lo("v4",!0),rotationCenter:new Lo("v3",!0),params:new Lo("v4",!0),size:new Lo("v4",!0),angle:new Lo("v4",!0),color:new Lo("v4",!0),opacity:new Lo("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Pu.vertex,fragmentShader:Pu.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new l.BufferGeometry,this.mesh=new l.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("nunuStudio: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")}function ko(a,r){this.group=new Gs(void 0!==a?a:ko.defaultGroup),this.emitter=new ji(void 0!==r?r:ko.defaultEmitter),this.group.addEmitter(this.emitter),l.Points.call(this,this.group.geometry,this.group.material),this.type="ParticleEmiter",this.name="particle",this.frustumCulled=!1,this.dynamicEmitter=!1,this.clock=new l.Clock,this.temp=new l.Vector4;var h=this;Object.defineProperties(this,{texture:{get:function(){return h.group.texture},set:function(p){h.group.texture=p}}})}function io(){l.Object3D.call(this),B.call(this)}function ka(a){if(this.backgroundColor=null,this.backend=ka.WEBGL2,this.autoClear=!1,this.autoClearColor=!1,this.autoClearDepth=!1,this.autoClearStencil=!1,this.antialiasing=!0,this.shadows=!0,this.stencil=!0,this.shadowsType=l.PCFSoftShadowMap,this.shadowsAutoUpdate=!0,this.toneMapping=l.NoToneMapping,this.toneMappingExposure=1,this.sortObjects=!0,this.gammaFactor=2,this.precision="highp",this.alpha=!0,this.premultipliedAlpha=!0,this.preserveDrawingBuffer=!1,this.powerPreference="high-performance",this.logarithmicDepthBuffer=!1,this.physicallyCorrectLights=!1,this.checkShaderErrors=!0,this.maxMorphTargets=8,this.maxMorphNormals=4,void 0!==a)for(var r in this)void 0!==a[r]&&(this[r]=a[r])}function ip(){this.desktop={fullscreen:!1,frame:!0,resizable:!0}}ji.constructor=ji,ji.prototype._createGetterSetters=function(a,r){var h=this;for(var p in a)if(a.hasOwnProperty(p)){var y=p.replace("_","");Object.defineProperty(a,y,{get:function(b){return function(){return this[b]}}(p),set:function(b){return function(N){var O=h.updateMap[r],T=this[b],z=ko.valueOverLifetimeLength;"_rotationCenter"===b?(h.updateFlags.rotationCenter=!0,h.updateCounts.rotationCenter=0):"_randomise"===b?h.resetFlags[O]=N:(h.updateFlags[O]=!0,h.updateCounts[O]=0),h.group._updateDefines(),this[b]=N,Array.isArray(T)&&kt.ensureValueOverLifetimeCompliance(h[r],z,z)}}(p)})}},ji.prototype._setBufferUpdateRanges=function(a){this.attributeKeys=a,this.attributeCount=a.length;for(var r=this.attributeCount-1;r>=0;--r)this.bufferUpdateRanges[a[r]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},ji.prototype._calculatePPSValue=function(a){var r=this.particleCount;this.particlesPerSecond=this.duration?r/(a<this.duration?a:this.duration):r/a},ji.prototype._setAttributeOffset=function(a){this.attributeOffset=a,this.activationIndex=a,this.activationEnd=a+this.particleCount},ji.prototype._assignValue=function(a,r){switch(a){case"position":this._assignPositionValue(r);break;case"velocity":case"acceleration":this._assignForceValue(r,a);break;case"size":case"opacity":this._assignAbsLifetimeValue(r,a);break;case"angle":this._assignAngleValue(r);break;case"params":this._assignParamsValue(r);break;case"rotation":this._assignRotationValue(r);break;case"color":this._assignColorValue(r)}},ji.prototype._assignPositionValue=function(a){var r=this.position,h=this.attributes.position,p=r._value,y=r._spread;switch(r._distribution){case Fp.BOX:kt.randomVector3(h,a,p,y,r._spreadClamp);break;case Fp.SPHERE:kt.randomVector3OnSphere(h,a,p,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x,r._distributionClamp||this.particleCount);break;case Fp.DISC:kt.randomVector3OnDisc(h,a,p,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x)}},ji.prototype._assignForceValue=function(a,r){var h,p,N,O=this[r],T=O._value,z=O._spread;switch(O._distribution){case Fp.BOX:kt.randomVector3(this.attributes[r],a,T,z);break;case Fp.SPHERE:p=(h=this.attributes.position.typedArray.array)[N=3*a],kt.randomDirectionVector3OnSphere(this.attributes[r],a,p,h[N+1],h[N+2],this.position._value,O._value.x,O._spread.x);break;case Fp.DISC:p=(h=this.attributes.position.typedArray.array)[N=3*a],kt.randomDirectionVector3OnDisc(this.attributes[r],a,p,h[N+1],h[N+2],this.position._value,O._value.x,O._spread.x)}if("acceleration"===r){var ee=kt.clamp(kt.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*a+3]=ee}},ji.prototype._assignAbsLifetimeValue=function(a,r){var h,p=this.attributes[r].typedArray,y=this[r];kt.arrayValuesAreEqual(y._value)&&kt.arrayValuesAreEqual(y._spread)?(h=Math.abs(kt.randomFloat(y._value[0],y._spread[0])),p.setVec4Components(a,h,h,h,h)):p.setVec4Components(a,Math.abs(kt.randomFloat(y._value[0],y._spread[0])),Math.abs(kt.randomFloat(y._value[1],y._spread[1])),Math.abs(kt.randomFloat(y._value[2],y._spread[2])),Math.abs(kt.randomFloat(y._value[3],y._spread[3])))},ji.prototype._assignAngleValue=function(a){var r,h=this.attributes.angle.typedArray,p=this.angle;kt.arrayValuesAreEqual(p._value)&&kt.arrayValuesAreEqual(p._spread)?(r=kt.randomFloat(p._value[0],p._spread[0]),h.setVec4Components(a,r,r,r,r)):h.setVec4Components(a,kt.randomFloat(p._value[0],p._spread[0]),kt.randomFloat(p._value[1],p._spread[1]),kt.randomFloat(p._value[2],p._spread[2]),kt.randomFloat(p._value[3],p._spread[3]))},ji.prototype._assignParamsValue=function(a){this.attributes.params.typedArray.setVec4Components(a,this.isStatic?1:0,0,Math.abs(kt.randomFloat(this.maxAge._value,this.maxAge._spread)),kt.randomFloat(this.wiggle._value,this.wiggle._spread))},ji.prototype._assignRotationValue=function(a){this.attributes.rotation.typedArray.setVec3Components(a,kt.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),kt.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(a,this.rotation._center)},ji.prototype._assignColorValue=function(a){kt.randomColorAsHex(this.attributes.color,a,this.color._value,this.color._spread)},ji.prototype._resetParticle=function(a){for(var r,h,p=this.resetFlags,y=this.updateFlags,b=this.updateCounts,N=this.attributeKeys,O=this.attributeCount-1;O>=0;--O)h=y[r=N[O]],!0!==p[r]&&!0!==h||(this._assignValue(r,a),this._updateAttributeUpdateRange(r,a),!0===h&&b[r]===this.particleCount?(y[r]=!1,b[r]=0):!0===h&&++b[r])},ji.prototype._updateAttributeUpdateRange=function(a,r){var h=this.bufferUpdateRanges[a];h.min=Math.min(r,h.min),h.max=Math.max(r,h.max)},ji.prototype._resetBufferRanges=function(){for(var a=this.bufferUpdateRanges,r=this.bufferUpdateKeys,h=this.bufferUpdateCount-1;h>=0;--h){var p=r[h];a[p].min=Number.POSITIVE_INFINITY,a[p].max=Number.NEGATIVE_INFINITY}},ji.prototype._onRemove=function(){this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},ji.prototype._decrementParticleCount=function(){--this.activeParticleCount},ji.prototype._incrementParticleCount=function(){++this.activeParticleCount},ji.prototype._checkParticleAges=function(a,r,h,p){for(var y,b,N,O,T=r-1;T>=a;--T)0!==(O=h[y=4*T])&&(N=h[y+1],b=h[y+2],1===this.direction?(N+=p)>=b&&(N=0,O=0,this._decrementParticleCount()):(N-=p)<=0&&(N=b,O=0,this._decrementParticleCount()),h[y]=O,h[y+1]=N,this._updateAttributeUpdateRange("params",T))},ji.prototype._activateParticles=function(a,r,h,p){for(var y,b,N=this.direction,O=a;O<r;++O)0!==h[y=4*O]&&1!==this.particleCount||(this._incrementParticleCount(),h[y]=1,this._resetParticle(O),b=p*(O-a),h[y+1]=-1===N?h[y+2]-b:b,this._updateAttributeUpdateRange("params",O))},ji.prototype.tick=function(a){if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var r=this.attributeOffset,h=r+this.particleCount,p=this.paramsArray,y=this.particlesPerSecond*this.activeMultiplier*a,b=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(r,h,p,a),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var N=1===this.particleCount?b:0|b,O=Math.min(N+y,this.activationEnd),T=O-this.activationIndex|0;this._activateParticles(N,O,p,T>0?a/T:0),this.activationIndex+=y,this.activationIndex>h&&(this.activationIndex=r),this.age+=a}else this.age=0}},ji.prototype.reset=function(a){if(this.age=0,this.alive=!1,!0===a){for(var r,h=this.attributeOffset,y=this.paramsArray,b=this.attributes.params.bufferAttribute,N=h+this.particleCount-1;N>=h;--N)y[r=4*N]=0,y[r+1]=0;b.updateRange.offset=0,b.updateRange.count=-1,b.needsUpdate=!0}return this},ji.prototype.enable=function(){return this.alive=!0,this},ji.prototype.disable=function(){return this.alive=!1,this},ji.prototype.remove=function(){return null!==this.group?this.group.removeEmitter(this):console.error("nunuStudio: ParticleEmitterControl does not belong to a group, cannot remove."),this},ji.prototype.toJSON=function(a){var r={};r.uuid=this.uuid,r.type=this.type,r.direction=this.direction,r.particleCount=this.particleCount,r.duration=this.duration,r.isStatic=this.isStatic,r.maxAge={},r.maxAge.value=this.maxAge.value,r.maxAge.spread=this.maxAge.spread,r.position={},r.position.value=this.position.value.toArray(),r.position.spread=this.position.spread.toArray(),r.position.radius=this.position.radius,r.position.radiusScale=this.position.radiusScale.toArray(),r.velocity={},r.velocity.value=this.velocity.value.toArray(),r.velocity.spread=this.velocity.spread.toArray(),r.acceleration={},r.acceleration.value=this.acceleration.value.toArray(),r.acceleration.spread=this.acceleration.spread.toArray(),r.wiggle={},r.wiggle.value=this.wiggle.value,r.wiggle.spread=this.wiggle.spread,r.opacity={},r.opacity.value=this.opacity.value.slice(0),r.opacity.spread=this.opacity.spread,r.size={},r.size.value=this.size.value.slice(0),r.size.spread=this.size.spread,r.angle={},r.angle.value=this.angle.value.slice(0),r.angle.spread=this.angle.spread,r.color={},r.color.value=[];for(var h=0;h<this.color.value.length;h++)r.color.value.push(this.color.value[h].getHex());for(r.color.spread=[],h=0;h<this.color.spread.length;h++)r.color.spread.push(this.color.spread[h].toArray());return r},Gs.constructor=Gs,Gs.prototype._updateDefines=function(){for(var a,r=this.emitters,h=this.defines,p=r.length-1;p>=0;--p)a=r[p],h.SHOULD_CALCULATE_SPRITE||(h.SHOULD_ROTATE_TEXTURE=h.SHOULD_ROTATE_TEXTURE||Boolean(Math.max(Math.max.apply(null,a.angle.value),Math.max.apply(null,a.angle.spread)))),h.SHOULD_ROTATE_PARTICLES=h.SHOULD_ROTATE_PARTICLES||Boolean(Math.max(a.rotation.angle,a.rotation.angleSpread)),h.SHOULD_WIGGLE_PARTICLES=h.SHOULD_WIGGLE_PARTICLES||Boolean(Math.max(a.wiggle.value,a.wiggle.spread));this.material.needsUpdate=!0},Gs.prototype._applyAttributesToGeometry=function(){var a,r,h=this.attributes,p=this.geometry,y=p.attributes;for(var b in h)h.hasOwnProperty(b)&&(a=h[b],(r=y[b])?r.array=a.typedArray.array:p.setAttribute(b,a.bufferAttribute),a.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},Gs.prototype.addEmitter=function(a){if(a instanceof ji!=0)if(this.emitterIDs.indexOf(a.uuid)>-1)console.error("nunuStudio: ParticleEmitterControl already exists in this group.");else{if(null===a.group){var r=this.attributes,h=this.particleCount,p=h+a.particleCount;for(var y in this.particleCount=p,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("nunuStudio: ParticleGroup maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),a._calculatePPSValue(a.maxAge._value+a.maxAge._spread),a._setBufferUpdateRanges(this.attributeKeys),a._setAttributeOffset(h),a.group=this,a.attributes=this.attributes,r)r.hasOwnProperty(y)&&r[y]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var b=h;b<p;++b)a._assignPositionValue(b),a._assignForceValue(b,"velocity"),a._assignForceValue(b,"acceleration"),a._assignAbsLifetimeValue(b,"opacity"),a._assignAbsLifetimeValue(b,"size"),a._assignAngleValue(b),a._assignRotationValue(b),a._assignParamsValue(b),a._assignColorValue(b);return this._applyAttributesToGeometry(),this.emitters.push(a),this.emitterIDs.push(a.uuid),this._updateDefines(a),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("nunuStudio: ParticleEmitterControl already belongs to another group.")}else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl.",a)},Gs.prototype.removeEmitter=function(a){var r=this.emitterIDs.indexOf(a.uuid);if(a instanceof ji!=0)if(-1!==r){for(var h=a.attributeOffset,p=h+a.particleCount,y=this.attributes.params.typedArray,b=h;b<p;++b)y.array[4*b]=0,y.array[4*b+1]=0;for(var N in this.emitters.splice(r,1),this.emitterIDs.splice(r,1),this.attributes)this.attributes.hasOwnProperty(N)&&this.attributes[N].splice(h,p);this.particleCount-=a.particleCount,a._onRemove(),this._attributesNeedRefresh=!0}else console.error("nunuStudio: ParticleEmitterControl does not exist in this group. Will not remove.");else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl. Was provided with:",a)},Gs.prototype.getFromPool=function(){var a=this.pool,r=this._createNewWhenPoolEmpty;if(a.length)return a.pop();if(r){var h=new ji(this.poolCreationSettings);return this.addEmitter(h),h}return null},Gs.prototype.releaseIntoPool=function(a){if(a instanceof ji!=0)return a.reset(),this.pool.unshift(a),this;console.error("nunuStudio: Argument is not instanceof ParticleEmitterControl:",a)},Gs.prototype.getPool=function(){return this.pool},Gs.prototype.addPool=function(a,r,h){var p;this.poolCreationSettings=r,this._createNewWhenPoolEmpty=Boolean(h);for(var y=0;y<a;++y)p=Array.isArray(r)?new ji(r[y]):new ji(r),this.addEmitter(p),this.releaseIntoPool(p);return this},Gs.prototype._triggerSingleEmitter=function(a){var r=this.getFromPool(),h=this;if(null!==r)return a instanceof l.Vector3&&(r.position.value.copy(a),r.position.value=r.position.value),r.enable(),setTimeout(function(){r.disable(),h.releaseIntoPool(r)},1e3*Math.max(r.duration,r.maxAge.value+r.maxAge.spread)),this;console.log("nunuStudio: ParticleGroup pool ran out.")},Gs.prototype.triggerEmitter=function(a,r){if("number"==typeof a&&a>1)for(var h=0;h<a;++h)this._triggerSingleEmitter(r);else this._triggerSingleEmitter(r);return this},Gs.prototype._updateUniforms=function(a){this.uniforms.runTime.value+=a,this.uniforms.deltaTime.value=a},Gs.prototype._resetBufferRanges=function(){for(var a=this.attributeKeys,r=this.attributeCount-1;r>=0;--r)this.attributes[a[r]].resetUpdateRange()},Gs.prototype._updateBuffers=function(a){for(var r,h,p,y=this.attributeKeys,b=this.attributes,N=a.bufferUpdateRanges,O=this.attributeCount-1;O>=0;--O)h=N[r=y[O]],(p=b[r]).setUpdateRange(h.min,h.max),p.flagUpdate()},Gs.prototype.tick=function(a){var r=this.emitters,h=r.length,p=a||this.fixedTimeStep,y=this.attributeKeys,b=this.attributes;if(this._updateUniforms(p),this._resetBufferRanges(),0!==h||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var N,O=0;O<h;++O)(N=r[O]).tick(p),this._updateBuffers(N);if(!0===this._attributesNeedDynamicReset){for(O=this.attributeCount-1;O>=0;--O)b[y[O]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(O=this.attributeCount-1;O>=0;--O)b[y[O]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},Gs.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this},Gs.prototype.toJSON=function(a){var r={texture:{}};return r.texture.value=this.texture.uuid,r.texture.frames=this.textureFrames.toArray(),r.texture.frameCount=this.textureFrameCount,r.texture.loop=this.textureLoop,r.fixedTimeStep=this.fixedTimeStep,r.hasPerspective=this.hasPerspective,r.colorize=this.colorize,r.maxParticleCount=this.maxParticleCount,r.transparent=this.transparent,r.blending=this.blending,r.alphaTest=this.alphaTest,r.depthWrite=this.depthWrite,r.depthTest=this.depthTest,r.fog=this.fog,r.scale=this.scale,r},ko.valueOverLifetimeLength=4,ko.prototype=Object.create(l.Points.prototype),ko.defaultEmitter={particleCount:200,velocity:{value:new l.Vector3(0,0,0),spread:new l.Vector3(3,3,3)},acceleration:{value:new l.Vector3(0,0,0),spread:new l.Vector3(0,0,0)}},ko.defaultGroup={texture:{value:null},maxParticleCount:200,blending:l.AdditiveBlending,fog:!1,depthWrite:!1,depthTest:!0,transparent:!0,hasPerspective:!0},ko.prototype.reload=function(){this.dispose();var a=this.children;this.children=[];var r=(new Co).parse(this.toJSON());this.children=a,this.group=r.group,this.emitter=r.emitter,this.geometry=this.group.geometry,this.material=this.group.material},ko.prototype.updateMatrix=function(){this.dynamicEmitter?(this.matrix.makeRotationFromQuaternion(this.quaternion),this.matrix.scale(this.scale)):this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},ko.prototype.onBeforeRender=function(a,r,h,p){this.group.uniforms.scale.value=a.getCurrentViewport(this.temp).w,this.group.tick(this.clock.getDelta()),!0===this.dynamicEmitter&&(this.emitter.position.value=this.position)},ko.prototype.dispose=function(){this.group.dispose(),l.Object3D.prototype.dispose.call(this)},ko.prototype.toJSON=function(a){var r=this.material,h=this.geometry;this.material=void 0,this.geometry=void 0;var p=this.group.texture,y=l.Object3D.prototype.toJSON.call(this,a,function(b,N){p=p.toJSON(b)});return this.material=r,this.geometry=h,y.object.group=this.group.toJSON(a),y.object.emitter=this.emitter.toJSON(a),y},ko.fromJSON=function(a,r){function h(N){return Array.isArray(N)?(new l.Vector3).fromArray(N):new l.Vector3(N.x,N.y,N.z)}if(void 0!==a.group){var p=a.group;p.texture.value=r.getTexture(p.texture.value),p.texture.frames=(new l.Vector2).fromArray(p.texture.frames||[1,1])}if(void 0!==a.emitter){var y=a.emitter;y.position.value=h(y.position.value),y.position.spread=h(y.position.spread),y.velocity.value=h(y.velocity.value),y.velocity.spread=h(y.velocity.spread),y.acceleration.value=h(y.acceleration.value),y.acceleration.spread=h(y.acceleration.spread);for(var b=0;b<y.color.value.length;b++)y.color.value[b]=new l.Color(y.color.value[b]),y.color.spread[b]=h(y.color.spread[b])}return new ko(a.group,a.emitter)},io.prototype=Object.create(l.Object3D.prototype),Object.assign(io.prototype,B.prototype),io.prototype.dispose=function(){for(var a=0;a<B.libraries.length;a++){var r=B.libraries[a];for(var h in this[r])this[r][h].dispose instanceof Function&&this[r][h].dispose()}},io.prototype.removeGeometry=function(a,r){this.traverse(function(h){void 0!==h.geometry&&h.geometry.uuid===a.uuid&&(h.geometry=r)}),delete this.geometries[a.uuid]},io.prototype.getResourceByName=function(a){for(var r in this.resources)if(this.resources[r].name===a)return this.resources[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.addResource=function(a){a instanceof wi&&(this.resources[a.uuid]=a)},io.prototype.removeResource=function(a){delete this.resources[a.uuid]},io.prototype.getImageByName=function(a){for(var r in this.images)if(this.images[r].name===a)return this.images[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.removeImage=function(a){a instanceof fs&&delete this.images[a.uuid]},io.prototype.getVideoByName=function(a){for(var r in this.videos)if(this.videos[r].name===a)return this.videos[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.removeVideo=function(a){a instanceof Dl&&delete this.videos[a.uuid]},io.prototype.getMaterialByName=function(a){for(var r in this.materials)if(this.materials[r].name===a)return this.materials[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.addMaterial=function(a){a instanceof l.Material&&(this.materials[a.uuid]=a)},io.prototype.removeMaterial=function(a,r,h){void 0===r&&(r=new l.MeshBasicMaterial),void 0===h&&(h=new l.SpriteMaterial),a instanceof l.Material&&(delete this.materials[a.uuid],this.traverse(function(p){void 0!==p.material&&p.material.uuid===a.uuid&&(p.material=p instanceof l.Sprite?h:r)}))},io.prototype.getTextureByName=function(a){for(var r in this.textures)if(this.textures[r].name===a)return this.textures[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.addTexture=function(a){material instanceof l.Texture&&(this.textures[a.uuid]=a)},io.prototype.removeTexture=function(a,r){void 0===r&&(r=new l.Texture),a instanceof l.Texture&&(delete this.textures[a.uuid],this.traverse(function(h){if(void 0!==h.material){var p=h.material;p.map&&p.map.uuid===a.uuid&&(p.map=r,p.needsUpdate=!0),p.bumpMap&&p.bumpMap.uuid===a.uuid&&(p.bumpMap=r,p.needsUpdate=!0),p.normalMap&&p.normalMap.uuid===a.uuid&&(p.normalMap=r,p.needsUpdate=!0),p.displacementMap&&p.displacementMap.uuid===a.uuid&&(p.displacementMap=r,p.needsUpdate=!0),p.specularMap&&p.specularMap.uuid===a.uuid&&(p.specularMap=r,p.needsUpdate=!0),p.emissiveMap&&p.emissiveMap.uuid===a.uuid&&(p.emissiveMap=r,p.needsUpdate=!0),p.alphaMap&&p.alphaMap.uuid===a.uuid&&(p.alphaMap=r,p.needsUpdate=!0),p.roughnessMap&&p.roughnessMap.uuid===a.uuid&&(p.roughnessMap=r,p.needsUpdate=!0),p.metalnessMap&&p.metalnessMap.uuid===a.uuid&&(p.metalnessMap=r,p.needsUpdate=!0),p.envMap&&p.envMap.uuid===a.uuid&&(p.envMap=null,p.needsUpdate=!0)}else h instanceof ko&&h.group.texture.uuid===a.uuid&&(h.group.texture=r)}))},io.prototype.getFontByName=function(a){for(var r in this.fonts)if(this.fonts[r].name===a)return this.fonts[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.addFont=function(a){a instanceof Je&&(this.fonts[a.uuid]=a)},io.prototype.removeFont=function(a,r){void 0===r&&(r=new Je),a instanceof Je&&(delete this.fonts[a.uuid],this.traverse(function(h){void 0!==h.font&&h.font.uuid===a.uuid&&h.setFont(r)}))},io.prototype.getAudioByName=function(a){for(var r in this.audio)if(this.audio[r].name===a)return this.audio[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},io.prototype.addAudio=function(a){a instanceof Ot&&(this.audio[a.uuid]=a)},io.prototype.removeAudio=function(a,r){void 0===r&&(r=new Ot),a instanceof Ot&&(delete this.audio[a.uuid],this.traverse(function(h){void 0!==h.audio&&h.audio.uuid===a.uuid&&h.setAudio(r)}))},ka.WEBGL=1,ka.WEBGL2=2,ka.prototype.createRenderer=function(a){var r=null;if(this.backend===ka.WEBGL2)try{r=a.getContext("webgl2",{xrCompatible:!0})}catch(y){console.warn("nunuStudio: Failed to create WebGL2 context",y)}var p=new l.WebGLRenderer({canvas:a,context:r,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialiasing,stencil:this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer});return this.apply(p),null!==this.backgroundColor&&(a.style.backgroundColor=this.backgroundColor),p},ka.prototype.apply=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearDepth=this.autoClearDepth,a.autoClearStencil=this.autoClearStencil,a.shadowMap.enabled=this.shadows,a.shadowMap.type=this.shadowsType,a.shadowMap.autoUpdate=this.shadowsAutoUpdate,a.shadowMap.needsUpdate=!0,a.toneMapping=this.toneMapping,a.toneMappingExposure=this.toneMappingExposure,a.debug.checkShaderErrors=this.checkShaderErrors,a.sortObjects=this.sortObjects,a.gammaFactor=this.gammaFactor,a.physicallyCorrectLights=this.physicallyCorrectLights,a.maxMorphTargets=this.maxMorphTargets,a.maxMorphNormals=this.maxMorphNormals},ka.prototype.toJSON=function(){return{backgroundColor:this.backgroundColor,backend:this.backend,autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,antialiasing:this.antialiasing,shadows:this.shadows,stencil:this.stencil,shadowsType:this.shadowsType,shadowsAutoUpdate:this.shadowsAutoUpdate,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure,sortObjects:this.sortObjects,checkShaderErrors:this.checkShaderErrors,gammaFactor:this.gammaFactor,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer,physicallyCorrectLights:this.physicallyCorrectLights,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals}},ka.prototype.fromJSON=function(a){this.backgroundColor=a.backgroundColor,this.backend=a.backend,this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearDepth=a.autoClearDepth,this.autoClearStencil=a.autoClearStencil,this.antialiasing=a.antialiasing,this.shadows=a.shadows,this.stencil=a.stencil,this.shadowsType=a.shadowsType,this.shadowsAutoUpdate=a.shadowsAutoUpdate,this.toneMapping=a.toneMapping,this.toneMappingExposure=a.toneMappingExposure,this.sortObjects=a.sortObjects,this.checkShaderErrors=a.checkShaderErrors,this.gammaFactor=a.gammaFactor,this.precision=a.precision,this.alpha=a.alpha,this.premultipliedAlpha=a.premultipliedAlpha,this.preserveDrawingBuffer=a.preserveDrawingBuffer,this.powerPreference=a.powerPreference,this.logarithmicDepthBuffer=a.logarithmicDepthBuffer,this.physicallyCorrectLights=a.physicallyCorrectLights,this.maxMorphTargets=a.maxMorphTargets,this.maxMorphNormals=a.maxMorphNormals};var Pf=__webpack_require__(872);function dr(a,r){this.element=document.createElement(void 0!==r?r:"div"),this.element.style.position="absolute",this.element.style.overflow="hidden",this.event=new hn,this.parent=null,void 0!==a&&this.attachTo(a),this.visible=!0,this.size=new l.Vector2(0,0),this.position=new l.Vector2(0,0),this._mode=dr.TOP_LEFT}function Qo(a){this.program=null,this.renderer=null,this.running=!1,this.canvasFitWindow=!1,this.canvas=a,this.events=new hn,void 0===a&&(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvasFitWindow=!0,document.body.appendChild(this.canvas))}function gi(){}function Wo(){}function hi(){io.call(this),this.type="Program",this.matrixAutoUpdate=!1,this.app=null,this.name="program",this.description="",this.author="",this.version="0.0.0",this.lockPointer=!1,this.handlePixelRatio=!0,this.ar=!0,this.vr=!0,this.vrScale=1,this.rendererConfig=new ka,this.targetConfig=new ip,this.defaultScene=null,this.defaultCamera=null,this.scene=null,this.keyboard=null,this.mouse=null,this.renderer=null,this.canvas=null,this.division=null,this.manager=new hn,this.clock=new l.Clock,this.xrEnabled=!1,this.xrMode=hi.XR_NONE}function Fo(){l.Scene.call(this),this.name="scene",this.matrixAutoUpdate=!1,this.usePhysics=!0,this.world=new Un,this.world.defaultContactMaterial.contactEquationStiffness=1e9,this.world.defaultContactMaterial.contactEquationRelaxation=4,this.world.quatNormalizeSkip=0,this.world.quatNormalizeFast=!1,this.world.gravity.set(0,-9.8,0),this.world.broadphase=new vr,this.world.solver=new Ms(new yu),this.world.solver.tolerance=.05,this.world.solver.iterations=7,this.background=null,this.alpha=1,this.cameras=[],this.defaultCamera=null,this.delta=0,this.raycaster=new l.Raycaster,this.useOctree=!1,this.octree=null,this.octreeUpdateScheduled=!1,this.octreeMatches=[],this.program=null,this.canvas=null,this.mouse=new l.Vector2(0,0)}function pc(a){l.AnimationMixer.call(this,a),this.playing=!1}dr.prototype.constructor=dr,dr.prototype.isComponent=!0,dr.TOP_LEFT=0,dr.TOP_RIGHT=1,dr.BOTTOM_LEFT=2,dr.BOTTOM_RIGHT=3,dr.preventDefault=function(a){a.preventDefault()},dr.prototype.addEvent=function(a,r){this.event.addAndCreate(this.element,a,r)},dr.prototype.removeEvent=function(a){this.event.remove(this.element,a)},dr.prototype.replaceEvent=function(a,r){this.event.remove(this.element,a),this.event.addAndCreate(this.element,a,r)},dr.prototype.addClass=function(a){this.element.classList.add(a)},dr.prototype.removeClass=function(a){this.element.classList.contains(a)&&this.element.classList.remove(a)},dr.prototype.setStyle=function(a,r){this.element.style[a]=r},dr.prototype.setStyles=function(a){for(var r in a)this.element.style[r]=a[r]},dr.prototype.preventDragEvents=function(){this.element.ondrop=dr.preventDefault,this.element.ondragover=dr.preventDefault},dr.prototype.setAltText=function(a){var r=document.createElement("div");r.style.position="absolute",r.style.display="none",r.style.alignItems="center",r.style.zIndex="10000",r.style.border="3px solid",r.style.borderRadius="5px",r.style.color="var(--color-light)",r.style.backgroundColor="var(--bar-color)",r.style.borderColor="var(--bar-color)",r.style.height="fit-content",document.body.appendChild(r);var h=document.createTextNode(a);r.appendChild(h);var p=this.destroy;return this.destroy=function(){p.call(this),document.body.contains(r)&&document.body.removeChild(r)},this.element.style.pointerEvents="auto",this.addEvent("mousemove",function(y){r.style.display="flex",r.style.left=y.clientX+8+"px",r.style.top=y.clientY-20+"px"}),this.addEvent("mouseout",function(){r.style.display="none"}),r},dr.prototype.setOnClick=function(a){this.addEvent("click",a)},dr.prototype.removeAllChildren=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)},dr.prototype.attachTo=function(a){this.parent!==a&&void 0!==a&&(null!==this.parent&&dr.prototype.destroy.call(this),this.parent=a,!0===a.isComponent?a.element.appendChild(this.element):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.appendChild(this.element)))},dr.prototype.watchPointer=function(){var a=this;this.pointerInside=!1,this.element.addEventListener("mouseenter",function(){a.pointerInside=!0}),this.element.addEventListener("mouseleave",function(){a.pointerInside=!1})},dr.prototype.destroy=function(){null!==this.parent&&(!0===this.parent.isComponent?this.parent.element.contains(this.element)&&(this.parent.element.removeChild(this.element),this.parent=null):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.contains(this.element)&&(this.parent.removeChild(this.element),this.parent=null)))},dr.prototype.setMode=function(a){this._mode=a,this.element.style.bottom=null,this.element.style.top=null,this.element.style.right=null,this.element.style.left=null},dr.prototype.center=function(){this.position.set((this.parent.size.x-this.size.x)/2,(this.parent.size.y-this.size.y)/2)},dr.prototype.setVisibility=function(a){this.visible=a,this.updateVisibility()},dr.prototype.updateVisibility=function(){this.element.style.display=this.visible?"block":"none"},dr.prototype.updatePosition=function(a){void 0!==a&&(this._mode=a),this._mode===dr.TOP_LEFT||this._mode===dr.TOP_RIGHT?this.element.style.top=this.position.y+"px":this.element.style.bottom=this.position.y+"px",this._mode===dr.TOP_LEFT||this._mode===dr.BOTTOM_LEFT?this.element.style.left=this.position.x+"px":this.element.style.right=this.position.x+"px"},dr.prototype.updateSize=function(){this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px"},dr.prototype.updateInterface=function(){this.updateVisibility(),this.visible&&(this.updateSize(),this.updatePosition())},Qo.loadApp=function(a,r){"string"==typeof r&&(r=document.getElementById(r));var h=new Qo(r);h.loadRunProgram(a),window.addEventListener("resize",function(){eo.isFullscreen()?(h.canvas.width=window.innerWidth,h.canvas.height=window.innerHeight):h.canvas.parentElement&&(h.canvas.width=h.canvas.parentElement.offsetWidth,h.canvas.height=h.canvas.parentElement.offsetHeight),h.resize()})},Qo.prototype.run=function(){if(null!==this.program){if(this.renderer=this.program.rendererConfig.createRenderer(this.canvas),this.program.app=this,this.program.defaultCamera=new ke(60,1,.1,1e5),this.program.defaultCamera.position.set(0,5,-5),this.program.setRenderer(this.renderer),this.program.initialize(),this.program.lockPointer){var r=this.mouse;this.events.add(this.canvas,"click",function(){r.setLock(!0)})}var h=this;this.events.add(window,"beforeunload",function(){h.exit()}),this.events.create(),this.resize(),this.resume()}else console.warn("nunuStudio: no program is loaded [app.loadPogram(fname)]")},Qo.prototype.loadRunProgram=function(a,r,h){this.loadProgramAsync(a,function(p){p.run(),void 0!==r&&r(p)},h)},Qo.prototype.loadProgram=function(a){if(a.endsWith(".isp")){var r=new Co,h=Rn.readFile(a);this.program=r.parse(JSON.parse(h))}else if(a.endsWith(".nsp")){r=new Co,h=Rn.readFileArrayBuffer(a);var p=new Pf.fG}this.program=r.parse(p.decode(h))},Qo.prototype.loadProgramAsync=function(a,r,h){var p=this;a.endsWith(".isp")?Rn.readFile(a,!1,function(y){var b=new Co;p.program=b.parse(JSON.parse(y)),void 0!==r&&r(p)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)}):a.endsWith(".nsp")&&Rn.readFileArrayBuffer(a,!1,function(y){var b=new Co,N=new Pf.fG;p.program=b.parse(N.decode(y)),void 0!==r&&r(p)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)})},Qo.prototype.update=function(){this.program.update(),this.program.render(this.renderer)},Qo.prototype.exit=function(){this.events.destroy(),null!==this.program&&(this.program.dispose(),this.program=null),null!==this.renderer&&(this.renderer.dispose(),this.renderer=null),void 0!==this.onExit&&this.onExit()},Qo.prototype.resume=function(){if(null!==this.program&&!this.running){var a=this;this.renderer.setAnimationLoop(function(){a.update()}),this.running=!0}},Qo.prototype.pause=function(){this.running=!1,this.renderer.setAnimationLoop(null)},Qo.prototype.setCanvas=function(a){this.canvas=a,this.canvasFitWindow=!1},Qo.prototype.resize=function(){if(null!==this.canvas&&null!==this.program&&null!==this.renderer){var a=1,r=1;this.canvasFitWindow?(this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px",a=window.innerWidth,r=window.innerHeight):(a=this.canvas.offsetWidth,r=this.canvas.offsetHeight),this.program.handlePixelRatio&&(a*=window.devicePixelRatio,r*=window.devicePixelRatio),this.renderer.setSize(a,r,!1),this.program.resize(a,r)}},Qo.prototype.sendData=function(a){null!==this.program&&this.program.receiveDataApp(a)},Qo.prototype.setOnDataReceived=function(a){this.onDataReceived=a},Qo.prototype.setOnExit=function(a){this.onExit=a},Qo.prototype.vrAvailable=function(){return null!==this.program&&this.program.vrAvailable()},Qo.prototype.toggleVR=function(){this.vrAvailable()?this.program.xrEnabled?this.program.exitVR():this.program.enterVR():console.warn("nunuStudio: Loaded program is not VR enabled.")},Qo.prototype.arAvailable=function(){return null!==this.program&&this.program.arAvailable()},Qo.prototype.toggleAR=function(){this.arAvailable()?this.program.xrEnabled?this.program.exitAR():this.program.enterAR():console.warn("nunuStudio: Loaded program is not AR enabled.")},Qo.prototype.toggleFullscreen=function(a){var r=eo.isFullscreen();void 0===a&&(a=this.canvas),eo.setFullscreen(!r,a)},gi.webXRAvailable=!1,gi.webXRSession=null,gi.webVRAvailable=!1,gi.webVRDisplay=null,gi.vrAvailable=function(){return gi.webXRAvailable||gi.webVRAvailable},gi.enterVR=function(a,r){gi.webXRAvailable?gi.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setSession(h),gi.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebXR session.",h)}):gi.webVRAvailable?gi.getWebVRDisplay().then(function(h){displays.length>0&&((gi.webVRDisplay=displays[0]).isPresenting||(a.xr.enabled=!0,a.xr.setDevice(gi.webVRDisplay),gi.webVRDisplay.requestPresent([{source:a.domElement}]),void 0!==r&&r()))}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebVR session.",h)}):console.warn("nunuStudio: VR support is not available.")},gi.exitVR=function(a){gi.webXRAvailable&&null!==gi.webXRSession?(a.xr.enabled=!1,a.xr.setSession(null),gi.webXRSession.end(),gi.webXRSession=null):gi.webVRAvailable&&null!==gi.webVRDisplay&&gi.webVRDisplay.isPresenting&&(a.xr.enabled=!1,a.xr.setDevice(null),gi.webVRDisplay.exitPresent(),gi.webVRDisplay=null)},gi.getWebXRSession=function(){return gi.webXRAvailable?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}):Promise.reject("WebXR support is not available.")},gi.getWebVRDisplay=function(a){return gi.webVRAvailable?navigator.getVRDisplays():Promise.reject("WebVR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported?navigator.xr.isSessionSupported("immersive-vr").then(function(a){gi.webXRAvailable=a}):void 0!==navigator.getVRDisplays&&navigator.getVRDisplays().then(function(a){gi.webVRAvailable=a.length>0}),Wo.OPAQUE="opaque",Wo.ADDITIVE="additive",Wo.ALPHA_BLEND="alpha-blend",Wo.webXRAvailable=!1,Wo.webXRSession=null,Wo.arAvailable=function(){return Wo.webXRAvailable},Wo.enterAR=function(a,r){Wo.webXRAvailable?Wo.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setReferenceSpaceType("local"),a.xr.setSession(h),console.log("nunuStudio: New AR WebXR session created",h),Wo.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start AR WebXR session.",h)}):console.warn("nunuStudio: AR support is not available.")},Wo.exitAR=function(a){Wo.webXRAvailable&&null!==Wo.webXRSession&&(a.xr.enabled=!1,a.xr.setSession(null),Wo.webXRSession.end(),Wo.webXRSession=null)},Wo.getWebXRSession=function(){return Wo.webXRAvailable?navigator.xr.requestSession("immersive-ar",{}):Promise.reject("WebXR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported&&navigator.xr.isSessionSupported("immersive-ar").then(function(a){Wo.webXRAvailable=a}),hi.XR_NONE=0,hi.XR_VR=1,hi.XR_AR=2,(hi.prototype=Object.create(io.prototype)).initialize=function(){if(null===this.mouse&&(this.mouse=new Zr,this.mouse.setCanvas(this.canvas),this.mouse.create()),null===this.keyboard&&(this.keyboard=new Vn,this.keyboard.create()),this.manager.create(),null!==this.defaultScene){for(var a=0;a<this.children.length;a++)if(this.children[a].uuid===this.defaultScene){this.setScene(this.children[a]);break}}else this.children.length>0&&this.setScene(this.children[0]);this.lockPointer&&null!==this.mouse&&this.mouse.setLock(!0),this.clock.start()},hi.prototype.setMouseKeyboard=function(a,r){this.mouse!==a&&(null!==this.mouse&&this.mouse.dispose(),this.mouse=a),this.keyboard!==r&&(null!==this.keyboard&&this.keyboard.dispose(),this.keyboard=r)},hi.prototype.setRenderer=function(a,r){this.renderer=a,this.renderer.autoClear=!1,this.canvas=a.domElement,this.division=this.canvas.parentElement,r&&this.updateRenderer()},hi.prototype.update=function(){var a=this.clock.getDelta();this.mouse.update(),this.keyboard.update(),this.scene.update(a)},hi.prototype.render=function(a){this.scene.render(a)},hi.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r),this.scene.resize(a,r)},hi.prototype.updateRenderer=function(){null!==this.renderer&&this.rendererConfig.apply(this.renderer)},hi.prototype.arAvailable=function(){return this.ar&&Wo.arAvailable()},hi.prototype.enterAR=function(){if(this.arAvailable()&&!this.xrEnabled){var a=this;Wo.enterAR(this.renderer,function(){a.xrMode=hi.XR_AR,a.xrEnabled=!0})}},hi.prototype.exitAR=function(){this.xrEnabled&&(Wo.exitAR(this.renderer),this.xrMode=hi.XR_NONE,this.xrEnabled=!1)},hi.prototype.vrAvailable=function(){return this.vr&&gi.vrAvailable()},hi.prototype.enterVR=function(){if(this.vrAvailable()&&!this.xrEnabled){var a=this;gi.enterVR(this.renderer,function(){a.xrMode=hi.XR_VR,a.xrEnabled=!0})}},hi.prototype.exitVR=function(){this.vr&&(gi.exitVR(this.renderer),this.xrMode=hi.XR_NONE,this.xrEnabled=!1)},hi.prototype.setScene=function(a){"string"==typeof a&&(a=this.getObjectByName(a)),null!==this.scene&&this.scene.dispose(),this.scene=a,null!==this.scene?(null===this.scene.defaultCamera&&(this.scene.defaultCamera=this.defaultCamera),this.scene.initialize(),null!==this.canvas&&this.scene.resize(this.canvas.width,this.canvas.height)):console.warn("nunuStudio: Program setScene scene is null.")},hi.prototype.remove=function(a){if(a instanceof l.Scene){var r=this.children.indexOf(a);r>-1&&(this.children.splice(r,1),a.parent=null),a===this.scene&&(this.scene.dispose(),this.scene=null),0===this.children.length&&(this.scene=null)}else console.warn("nunuStudio: Trying to remove Object3D from program, only Scene objects allowed.")},hi.prototype.add=function(a){a instanceof l.Scene?(a.parent=this,this.children.push(a)):console.warn("nunuStudio: Trying to add Object3D to program, only Scene objects allowed.")},hi.prototype.clone=function(){return(new Co).parse(this.toJSON())},hi.prototype.setInitialScene=function(a){this.defaultScene=a.uuid},hi.prototype.dispose=function(){null!==this.mouse&&(this.lockPointer&&this.mouse.setLock(!1),this.mouse.dispose()),null!==this.keyboard&&this.keyboard.dispose(),this.manager.destroy(),null!==this.scene?this.scene.dispose():console.warn("nunuStudio: Program dispose() scene is null.",this),io.prototype.dispose.call(this),l.Object3D.prototype.dispose.call(this)},hi.prototype.receiveDataApp=function(a){var r=!1;this.traverse(function(h){h instanceof Tn&&(h.appData(a),r=!0)}),r||console.warn("nunuStudio: No script with onAppData found",a)},hi.prototype.sendDataApp=function(a){null!==this.app?void 0!==this.app.onDataReceived?this.app.onDataReceived(a):console.warn("nunuStudio: Send app data communication",a):console.warn("nunuStudio: Data sent to app",a)},hi.prototype.toJSON=function(a,r){var h=this,p=l.Object3D.prototype.toJSON.call(this,a,function(y){if(!1!==r)for(var b=0;b<B.libraries.length;b++){var N=h[B.libraries[b]];for(var O in N){var T=N[O];void 0===y[B.libraries[b]][T.uuid]&&(y[B.libraries[b]][T.uuid]=T.toJSON(y))}}});return null!==this.defaultScene&&(p.object.defaultScene=this.defaultScene),p.object.author=this.author,p.object.description=this.description,p.object.version=this.version,p.object.lockPointer=this.lockPointer,p.object.handlePixelRatio=this.handlePixelRatio,p.object.ar=this.ar,p.object.vr=this.vr,p.object.vrScale=this.vrScale,p.object.rendererConfig=this.rendererConfig.toJSON(),p},(Fo.prototype=Object.create(l.Scene.prototype)).initialize=function(){this.program=this.parent,this.canvas=this.parent.canvas,l.Object3D.prototype.initialize.call(this);for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.initialize()})},Fo.prototype.update=function(a){this.mouse.set(this.program.mouse.position.x/this.canvas.width*2-1,-2*this.program.mouse.position.y/this.canvas.height+1),this.cameras.length>0?this.raycaster.setFromCamera(this.mouse,this.cameras[0]):null!==this.defaultCamera&&this.raycaster.setFromCamera(this.mouse,this.defaultCamera),this.usePhysics&&this.world.step(a<.05?a:.05);for(var r=0;r<this.children.length;r++)this.children[r].traverse(function(h){h.update(a)})},Fo.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r);for(var h=0;h<this.cameras.length;h++)this.cameras[h].resize(a,r);for(h=0;h<this.children.length;h++)this.children[h].traverse(function(p){p.resize(a,r)})},Fo.prototype.dispose=function(){for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.dispose()})},Fo.prototype.render=function(a){if(a.setClearColor(this.background,this.alpha),this.cameras.length>0)if(this.program.xrEnabled){if(this.program.xrMode===hi.XR_VR)for(var r=0;r<this.cameras.length;r++)this.cameras[r].render(a,this);else if(this.program.xrMode===hi.XR_AR)for(a.setClearColor(null),r=0;r<this.cameras.length;r++)a.render(this,this.cameras[r])}else{for(a.setScissorTest(!0),r=0;r<this.cameras.length;r++)this.cameras[r].setupRenderer(a),this.cameras[r].render(a,this);a.setScissorTest(!1)}else null!==this.defaultCamera&&(this.program.xrMode===hi.XR_AR?(a.setClearColor(null),a.render(this,this.defaultCamera)):this.defaultCamera.render(a,this))},Fo.prototype.getCamera=function(a,r){if(void 0===r&&(r=this),a===r.uuid)return r;for(var h=r.children,p=0;p<h.length;p++){var y=this.getCamera(a,h[p]);if(null!==y)return y}return null},Fo.prototype.addCamera=function(a){-1===this.cameras.indexOf(a)&&(this.cameras.push(a),this.updateCameraOrder())},Fo.prototype.updateCameraOrder=function(){this.cameras.sort(function(a,r){return a.order>r.order})},Fo.prototype.removeCamera=function(a){var r=this.cameras.indexOf(a);r>-1&&this.cameras.splice(r,1)},Fo.prototype.isCameraActive=function(a){return this.cameras.indexOf(a)>-1},Fo.prototype.setFogMode=function(a){var r=null!==this.fog?this.fog.color.getHex():"#FFFFFF";a===l.Fog.LINEAR?this.fog=new l.Fog(r,5,20):a===l.Fog.EXPONENTIAL?this.fog=new l.FogExp2(r,.01):a===l.Fog.NONE&&(this.fog=null)},Fo.prototype.toJSON=function(a){if(!this.parent||"Program"!==this.parent.type)return console.warn("nunuStudio: Scene is not on top level serializing as Group."),this.type="Group",l.Object3D.prototype.toJSON.call(this,a);var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(T,z){r.background instanceof l.Color?z.background=r.background.toJSON(T):r.background instanceof l.Texture&&(z.background=r.background.toJSON(T).uuid),r.environment instanceof l.Texture&&(z.environment=r.environment.toJSON(T).uuid)});if(null!==this.defaultCamera){var p=new l.Vector3,y=new l.Quaternion,b=new l.Vector3;this.defaultCamera.matrixWorld.decompose(p,y,b);var N=this.defaultCamera.toJSON(a);N.object.position=p.toArray(),N.object.quaternion=y.toArray(),N.object.scale=b.toArray(),h.object.defaultCamera=N}null!==this.fog&&(h.object.fog=this.fog.toJSON()),h.object.usePhysics=this.usePhysics,h.object.cameras=[];for(var O=0;O<this.cameras.length;O++)h.object.cameras.push(this.cameras[O].uuid);return h.object.world={},h.object.world.gravity=this.world.gravity,h.object.world.quatNormalizeSkip=this.world.quatNormalizeSkip,h.object.world.quatNormalizeFast=this.world.quatNormalizeFast,h.object.world.solver={},h.object.world.solver.tolerance=this.world.solver.tolerance,h.object.world.solver.iterations=this.world.solver.iterations,h},(pc.prototype=Object.create(l.AnimationMixer.prototype)).createActions=function(a){for(var r=0;r<a.length;r++){var h=this.clipAction(a[r]);h.setLoop(a[r].loop),h.weight=a[r].weight,h.timeScale=a[r].timeScale,h.enabled=a[r].enabled,h.play()}return this._actions},pc.prototype.setTime=function(a){this.time=a;for(var r=0;r<this._actions.length;r++)this._actions[r].time=a;this.update(0,!0)},pc.prototype.play=function(){this.playing=!0},pc.prototype.stop=function(){this.setTime(0),this.playing=!1},pc.prototype.pause=function(){this.playing=!1},pc.prototype.dispose=function(){this.stopAllAction(),this.uncacheRoot(this._root)},pc.prototype.update=function(a,r){if(this.playing||r){this.time+=a;for(var h=Math.sign(a),p=0;p<this._actions.length;p++)this._actions[p]._update(this.time,a,h,this._accuIndex);for(p=0;p<this._bindings.length;p++)this._bindings[p].apply(this._accuIndex)}return this};var ta=__webpack_require__(412);ta.Object3D.prototype.folded=!1,ta.Object3D.prototype.locked=!1,ta.Object3D.prototype.contains=function(a){for(var r=0;r<this.children.length;r++)if(this.children[r].uuid===a.uuid||this.children[r].contains(a))return!0;return!1},ta.Object3D.prototype.playAnimation=function(){void 0!==this.mixer&&this.mixer.play()},ta.Object3D.prototype.stopAnimation=function(){void 0!==this.mixer&&this.mixer.stop()},ta.Object3D.prototype.initialize=function(){void 0!==this.animations&&(this.mixer=new pc(this),this.mixer.createActions(this.animations),this.mixer.play())},ta.Object3D.prototype.update=function(a){void 0!==this.mixer&&this.mixer.update(a)},ta.Object3D.prototype.resize=function(a,r){},ta.Object3D.prototype.dispose=function(){void 0!==this.mixer&&this.mixer.dispose()},ta.Object3D.prototype.addAbove=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r);this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},ta.Object3D.prototype.addBellow=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r)+1;this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},ta.Object3D.prototype.getScene=function(){for(var a=this;null!==a.parent;)if((a=a.parent)instanceof Fo)return a;return null},ta.Object3D.prototype.removeAll=function(){for(;this.children.length>0;)this.remove(this.children[0])},ta.Object3D.prototype.isEmpty=function(){return 0===this.children.length},ta.Object3D.prototype.destroy=function(){for(;this.children.length>0;)this.children[0].destroy();null!==this.parent&&(this.dispose&&this.dispose(),this.parent.remove(this),this.parent=null)},ta.Object3D.prototype.toJSON=function(a,r,h){var p=void 0===a,y={};p&&(a=new B,y.metadata={version:VERSION,type:"Object3D"});var b={};if(b.uuid=this.uuid,b.type=this.type,b.name=this.name,b.folded=this.folded,b.locked=this.locked,b.castShadow=this.castShadow,b.receiveShadow=this.receiveShadow,b.visible=this.visible,b.matrixAutoUpdate=this.matrixAutoUpdate,b.frustumCulled=this.frustumCulled,b.renderOrder=this.renderOrder,b.position=this.position.toArray(),b.quaternion=this.quaternion.toArray(),b.scale=this.scale.toArray(),b.layers=this.layers.mask,b.userData=this.userData,void 0!==this.geometry){b.geometry=ne(a.geometries,this.geometry);var N=this.geometry.parameters;if(void 0!==N&&void 0!==N.shapes){var O=N.shapes;if(Array.isArray(O))for(var T=0,z=O.length;T<z;T++)ne(a.shapes,O[T]);else ne(a.shapes,O)}}if(void 0!==this.material)if(this.material instanceof l.Material)b.material=ne(a.materials,this.material);else if(this.material instanceof Array){var oe=[];for(T=0;T<this.material.length;T++)oe.push(ne(a.materials,this.material[T]));b.material=oe}if(void 0!==this.animations&&this.animations.length>0)for(b.animations=[],T=0;T<this.animations.length;T++)b.animations.push(l.AnimationClip.toJSON(this.animations[T]));if(y.object=b,void 0!==r&&r(a,b,y),!1!==h&&this.children.length>0)for(b.children=[],T=0;T<this.children.length;T++)this.children[T].locked||b.children.push(this.children[T].toJSON(a).object);return p&&(y.geometries=ve(a.geometries),y.materials=ve(a.materials),y.textures=ve(a.textures),y.images=ve(a.images),y.videos=ve(a.videos),y.audio=ve(a.audio),y.fonts=ve(a.fonts),y.skeletons=ve(a.skeletons),y.resources=ve(a.resources),y.shapes=ve(a.shapes)),y;function ne(xe,Te){return void 0===xe[Te.uuid]&&(xe[Te.uuid]=Te.toJSON(a)),Te.uuid}function ve(xe){var Te=[];for(var Ce in xe){var Ie=xe[Ce];delete Ie.metadata,Te.push(Ie)}return Te}},__webpack_require__(870);var wd=__webpack_require__(412),Dp={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Iu=function(a){if(void 0!==a.array){var r=new Dp[a.type](a.array),h=new(a.isInstancedBufferAttribute?l.InstancedBufferAttribute:l.BufferAttribute)(r,a.itemSize,a.normalized);return void 0!==a.name&&(h.name=a.name),h}if("BufferAttribute"===a.type)r=new Dp[a.typedArray.type](a.typedArray.array),h=new l.BufferAttribute(r,a.itemSize,a.normalized);else if("InstancedBufferAttribute"===a.type)r=new Dp[a.typedArray.type](a.typedArray.array),h=new l.InstancedBufferAttribute(r,a.itemSize,a.normalized,a.meshPerAttribute);else if("InterleavedBufferAttribute"===a.type){r=new Dp[a.data.typedArray.type](a.data.typedArray.array);var p=new l.InterleavedBuffer(r,a.data.stride);p.setUsage(a.data.usage),p.count=a.data.count,h=new l.InterleavedBufferAttribute(p,a.itemSize,a.offset,a.normalized)}return void 0!==a.name&&(h.name=a.name),h};wd.BufferGeometryLoader.prototype.parse=function(a){var r=a.isInstancedBufferGeometry?new l.InstancedBufferGeometry:new l.BufferGeometry,h=a.data.index;if(void 0!==h){var p=new Dp[h.type](h.array);r.setIndex(new l.BufferAttribute(p,1))}var y=a.data.attributes;for(var b in y)r.setAttribute(b,Iu(y[b]));var N=a.data.morphAttributes;if(N)for(var b in N){for(var O=N[b],T=[],z=0,ee=O.length;z<ee;z++)T.push(Iu(O[z]));r.morphAttributes[b]=T}a.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);var oe=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==oe){z=0;for(var ne=oe.length;z!==ne;++z){var ve=oe[z];r.addGroup(ve.start,ve.count,ve.materialIndex)}}var xe=a.data.boundingSphere;if(void 0!==xe){var Te=new l.Vector3;void 0!==xe.center&&Te.fromArray(xe.center),r.boundingSphere=new l.Sphere(Te,xe.radius)}return a.name&&(r.name=a.name),a.userData&&(r.userData=a.userData),r};var gf=__webpack_require__(412);gf.Material.prototype.dispose=function(){function a(r){r?.dispose()}this.dispatchEvent({type:"dispose"}),a(this.map),a(this.bumpMap),a(this.normalMap),a(this.displacementMap),a(this.specularMap),a(this.emissiveMap),a(this.alphaMap),a(this.roughnessMap),a(this.metalnessMap),a(this.envMap)},gf.Material.prototype.toJSON=function(a){void 0===a&&(a={textures:{},images:{},videos:{}});var r={};function h(N){var O=[];for(var T in N){var z=N[T];delete z.metadata,O.push(z)}return O}if(r.uuid=this.uuid,r.type=this.type,r.name=this.name,r.toneMapped=this.toneMapped,r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),void 0!==this.transmission&&(r.transmission=this.transmission),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(a).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(a).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(a).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(a).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(a).uuid),this.aoMapIntensity&&(r.aoMapIntensity=this.aoMapIntensity),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(a).uuid,r.reflectivity=this.reflectivity,this.combine&&(r.combine=this.combine),this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),this.refractionRatio&&(r.refractionRatio=this.refractionRatio)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.rotation&&(r.rotation=this.rotation),void 0!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),this.blending!==l.NormalBlending&&(r.blending=this.blending),this.side!==l.FrontSide&&(r.side=this.side),this.vertexColors!==l.NoColors&&(r.vertexColors=this.vertexColors),r.flatShading=this.flatShading,this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,void 0!==this.morphNormals&&(r.morphNormals=this.morphNormals),void 0===a){var p=h(a.textures),y=h(a.images),b=h(a.videos);p.length>0&&(r.textures=p),y.length>0&&(r.images=y),b.length>0&&(r.videos=b)}return r},__webpack_require__(412).Points.prototype.raycast=function(a,r){null===this.geometry.boundingBox&&this.geometry.computeBoundingBox();var h=new l.Box3;h.copy(this.geometry.boundingBox),h.applyMatrix4(this.matrixWorld),null!==a.ray.intersectBox(h,new l.Vector3)&&r.push({object:this})};var qd,su,rl,Zp,au=__webpack_require__(412);function eo(){}function Mr(){}function Yr(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var a=navigator.getGamepads(),r=0;r<a.length;r++)if(null!==a[r]){this.setGamepad(a[r]);break}null===this.gamepad&&console.warn("nunuStudio: No gamepad found")}function Ou(){this.alpha=0,this.beta=0,this.gamma=0,this.orientation=0,this.events=new hn;var a=this;this.events.add(window,"orientationchange",function(r){a.orientation=l.Math.degToRad(window.orientation)}),this.events.add(window,"deviceorientation",function(r){a.alpha=l.Math.degToRad(r.alpha),a.beta=l.Math.degToRad(r.beta),a.gamma=l.Math.degToRad(r.gamma)}),this.events.create()}function ku(a){this.size=new l.Vector2(2,2),this.halfSize=new l.Vector2(1,1),this.matrix=new l.Matrix4,this.cache={camera:{fov:0,style:""},objects:new WeakMap},this.domElement=void 0!==a?a:document.createElement("div"),this.domElement.style.overflow="hidden",this.domElement.style.pointerEvents="none",this.cameraElement=document.createElement("div"),this.cameraElement.style.WebkitTransformStyle="preserve-3d",this.cameraElement.style.transformStyle="preserve-3d",this.domElement.appendChild(this.cameraElement)}function lu(a){vl.call(this,a)}function Fa(a){Dl.call(this),this.format="url",this.encoding=Rn.getFileExtension(a),this.data=a}function Fu(a,r,h){this.bufferGeometry=!1,this.direction=new l.Vector3(0,1,0),this.angle=void 0!==a?a:Math.PI,this.start=void 0!==r?r:0,this.end=void 0!==h?h:1}function cu(){this.events=[]}function Xn(a,r){this.x=a||0,this.y=r||0}function Oi(a){void 0!==a?this.m=a:this.identity()}function Rh(){}function Pn(){this.uuid=Rh.generate(),this.children=[],this.parent=null,this.level=0,this.position=new Xn(0,0),this.origin=new Xn(0,0),this.scale=new Xn(1,1),this.rotation=0,this.visible=!0,this.layer=0,this.matrix=new Oi,this.globalMatrix=new Oi,this.inverseGlobalMatrix=new Oi,this.masks=[],this.matrixAutoUpdate=!0,this.matrixNeedsUpdate=!0,this.draggable=!1,this.pointerEvents=!0,this.ignoreViewport=!1,this.saveContextState=!0,this.restoreContextState=!0,this.pointerInside=!1,this.beingDragged=!1,this.serializable=!0}function Do(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Gi(a,r){this._keys=new Array(5),this._position=new Xn(0,0),this._positionUpdated=!1,this._delta=new Xn(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new Xn(0,0),this.delta=new Xn(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,void 0!==r&&this.setCanvas(r),this.events=new cu;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new Do,this.keys[h]=new Do;var p=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){p._wheel=30*b.detail,p._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){p._wheel=b.deltaY,p._wheelUpdated=!0}),void 0!==window.ontouchstart||navigator.msMaxTouchPoints>0){var y=new Xn(0,0);this.events.add(this.domElement,"touchstart",function(b){var N=b.touches[0];p.updatePosition(N.clientX,N.clientY,0,0),p.updateKey(Gi.LEFT,Do.DOWN),y.set(N.clientX,N.clientY)}),this.events.add(this.domElement,"touchend",function(b){p.updateKey(Gi.LEFT,Do.UP)}),this.events.add(this.domElement,"touchcancel",function(b){p.updateKey(Gi.LEFT,Do.UP)}),this.events.add(document.body,"touchmove",function(b){var N=b.touches[0];p.updatePosition(N.clientX,N.clientY,N.clientX-y.x,N.clientY-y.y),y.set(N.clientX,N.clientY)})}this.events.add(this.domElement,"mousemove",function(b){p.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){p.updateKey(b.which-1,Do.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){p.updateKey(b.which-1,Do.UP)}),this.events.add(this.domElement,"dragstart",function(b){p.updateKey(b.which-1,Do.UP)}),this.events.add(this.domElement,"dblclick",function(b){p._doubleClicked[b.which-1]=!0}),this.create()}function Qp(a){this.uuid=Rh.generate(),this.canvas=a,this.position=new Xn(0,0),this.scale=1,this.rotation=0,this.matrix=new Oi,this.inverseMatrix=new Oi,this.matrixNeedsUpdate=!0,this.moveOnScale=!1,this.rotationPoint=null}function Ph(a){this.viewport=a,this.dragButton=Gi.RIGHT,this.allowScale=!0,this.moveOnScale=!1,this.allowRotation=!0,this.rotationPoint=null,this.rotationInitial=0}function Du(a){this.callback=a,this.running=!1,this.id=-1}function na(a,r){void 0===r&&(r={alpha:!0,imageSmoothingEnabled:!0,imageSmoothingQuality:"low",globalCompositeOperation:"source-over"}),this.canvas=a,this.container=null,this.context=this.canvas.getContext("2d",{alpha:r.alpha}),this.context.imageSmoothingEnabled=r.imageSmoothingEnabled,this.context.imageSmoothingQuality=r.imageSmoothingQuality,this.context.globalCompositeOperation=r.globalCompositeOperation,this.pointer=new Gi(window,this.canvas),this.autoClear=!0}function Qi(a,r){this.min=void 0!==a?a:new Xn,this.max=void 0!==r?r:new Xn}function ra(){Pn.call(this)}function yl(){ra.call(this),this.box=new Qi(new Xn(-50,-35),new Xn(50,35)),this.invert=!1}function oo(){this.cache=null,this.needsUpdate=!0}function Ko(a){oo.call(this),this.color=a||"#000000"}function xs(){Pn.call(this),this.box=new Qi(new Xn(-50,-50),new Xn(50,50)),this.strokeStyle=new Ko("#000000"),this.lineWidth=1,this.fillStyle=new Ko("#FFFFFF")}function uo(){Pn.call(this),this.radius=10,this.strokeStyle=new Ko("#000000"),this.lineWidth=1,this.fillStyle=new Ko("#FFFFFF")}function qo(){Pn.call(this),this.from=new Xn,this.to=new Xn,this.dashPattern=[5,5],this.strokeStyle=new Ko("#000000"),this.lineWidth=1}function rs(){Pn.call(this),this.text="",this.font="16px Arial",this.strokeStyle=null,this.lineWidth=1,this.fillStyle=new Ko("#000000"),this.textAlign="center",this.textBaseline="middle"}function wa(a){Pn.call(this),this.box=new Qi,this.image=document.createElement("img"),void 0!==a&&this.setImage(a)}function Ih(a){Pn.call(this),this.parentElement=null,this.element=document.createElement(a||"div"),this.element.style.transformStyle="preserve-3d",this.element.style.position="absolute",this.element.style.top="0px",this.element.style.bottom="0px",this.element.style.transformOrigin="0px 0px",this.element.style.overflow="auto",this.element.style.pointerEvents="none",this.size=new Xn(100,100)}function so(a){Pn.call(this),this.box=new Qi,this.image=document.createElement("img"),this.repetition="repeat",void 0!==a&&this.setImage(a)}function Sa(){rs.call(this),this.maxWidth=null,this.lineHeight=null}function xl(){qo.call(this),this.fromCp=new Xn,this.toCp=new Xn}function uu(){qo.call(this),this.controlPoint=new Xn}function Da(){xs.call(this),this.radius=5}function as(){Pn.call(this),this.box=new Qi(new Xn(-50,-35),new Xn(50,35)),this.strokeStyle=new Ko("rgb(0, 153, 255)"),this.lineWidth=1,this.fillStyle=new Ko("rgba(0, 153, 255, 0.3)"),this.min=0,this.max=10,this.data=[]}function Kp(a,r){this.offset=a,this.color=r}function wl(){oo.call(this),this.colors=[]}function Gl(){wl.call(this),this.start=new Xn(-100,0),this.end=new Xn(100,0)}function Uu(){Pn.call(this),this.value=50,this.min=0,this.max=100,this.radius=80,this.lineWidth=10,this.startAngle=Math.PI,this.endAngle=2*Math.PI,this.dial=!1,this.baseStyle=new Ko("#e9ecf1"),this.barStyle=new Gl,this.barStyle.start.set(-100,0),this.barStyle.end.set(100,0),this.barStyle.addColorStop(0,"#e5ff50"),this.barStyle.addColorStop(.5,"#50ff67"),this.barStyle.addColorStop(1,"#32adff")}function ho(a){oo.call(this),this.source=a||document.createElement("img"),this.repetition="repeat",this.matrix=new Oi}function dh(){wl.call(this),this.start=new Xn(0,0),this.startRadius=10,this.end=new Xn(0,0),this.endRadius=50}function hu(){Pn.call(this)}function ls(){xl.call(this),this.lineWidth=2,this.outputSocket=null,this.inputSocket=null}function Hi(a,r,h,p){uo.call(this),this.draggable=!0,this.radius=6,this.layer=1,this.name=void 0!==p?p:"",this.category=void 0!==h?h:"",this.multiple=!0,this.direction=r,this.node=a,this.connectors=[],this.creatingConnection=!1,this.text=new rs,this.text.text=this.name,this.direction===Hi.INPUT?(this.text.position.x-=10,this.text.textAlign="right"):this.direction===Hi.OUTPUT&&(this.text.position.x+=10,this.text.textAlign="left"),this.add(this.text)}function ws(){Da.call(this),this.draggable=!0,this.inputs=[],this.outputs=[]}function Xd(){}function Yd(){}function Ti(){l.Group.call(this),this.type="NodeScript",this.name="script",this.graph=new hu}function dc(a,r){this.uuid=l.Math.generateUUID(),this.data=a,this.callback=r}function Ss(a,r){this.size=r,this.file=a,this.workers=[],this.next=0,this.createWorkers(),this.tasks={}}function ed(a,r){this.callback=a,this.time=r,this.running=!1,this.id=-1}function td(a){this.callback=a,this.running=!1,this.id=-1}function Ua(){}function pu(){}au.Skeleton.prototype.toJSON=function(){var a={};void 0===this.uuid&&(this.uuid=l.Math.generateUUID()),a.uuid=this.uuid,a.bones=[];for(var r=0;r<this.bones.length;r++)a.bones.push(this.bones[r].uuid);for(a.boneInverses=[],r=0;r<this.boneInverses.length;r++)a.boneInverses.push(this.boneInverses[r].toArray());return a},au.Skeleton.fromJSON=function(a,r){for(var h=[],p=[],y=0;y<a.bones.length;y++){var b=r.getObjectByProperty("uuid",a.bones[y]);void 0===b&&(console.warn("Skeleton.fromJSON: Not found Bone with uuid "+a.bones[y]),b=new l.Bone),h.push(b),p.push((new l.Matrix4).fromArray(a.boneInverses[y]))}var N=new au.Skeleton(h,p);return N.uuid=a.uuid,N},__webpack_require__(819),__webpack_require__(412).Texture.prototype.toJSON=function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var r={metadata:{version:VERSION,type:"Texture"},uuid:this.uuid,name:this.name,category:this.category,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return a.textures[this.uuid]=r,r},eo.NAME="nunuStudio",eo.NWJS=200,eo.BROWSER=201,eo.CORDOVA=202,eo.copyNamespace=function(a,r){for(var h in void 0===r&&(r=window),a)h in r||(r[h]=a[h])},eo.getQueryParameters=function(){for(var a=location.search.substring(1).split("&"),r={},h=0;h<a.length;h++){var p=a[h].split("=");if(p.length>1){var y=unescape(p[0]).replace(new RegExp('"',"g"),""),b=unescape(p[1]).replace(new RegExp('"',"g"),"");r[y]=b}}return r},eo.createWorker=function(a,r){var h=new Blob([a],{type:"application/javascript"}),p=new Worker(URL.createObjectURL(h));return void 0!==r&&(p.onmessage=r),p},eo.webAudioAvailable=function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext},eo.webGLAvailable=function(){try{var a=document.createElement("canvas");return(a.getContext("webgl")||a.getContext("experimental-webgl")).getSupportedExtensions(),!0}catch{}return!1},eo.getPlatform=function(){return void 0!==window.nw?eo.NWJS:void 0!==window.cordova?eo.CORDOVA:eo.BROWSER},eo.runningOnDesktop=function(){return void 0!==window.nw},eo.openWebpage=function(a){eo.runningOnDesktop()?window.require("nw.gui").Shell.openExternal(a):window.open(a)},eo.isFullscreen=function(){return!0===document.webkitIsFullScreen||!0===document.mozFullScreen||!0===document.webkitIsFullScreen||!0===document.webkitIsFullScreen||!0===document.fullscreen||!1},eo.setFullscreen=function(a,r){var h=eo.isFullscreen();void 0===a&&(a=!h),!0===a?(void 0===r&&(r=document.body),!1===h&&(r.requestFullscreen=r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullscreen||r.msRequestFullscreen,void 0!==r.requestFullscreen&&r.requestFullscreen())):!0===h&&(document.exitFullscreen=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen,void 0!==document.exitFullscreen&&document.exitFullscreen())},Mr.ARROW_LEFT=37,Mr.ARROW_UP=38,Mr.ARROW_RIGHT=39,Mr.ARROW_DOWN=40,Mr.ENTER=13,Mr.BACK=10009,Mr.VOLUME_UP=447,Mr.VOLUME_DOWN=448,Mr.VOLUME_MUTE=449,Mr.CHANNEL_UP=427,Mr.CHANNEL_DOWN=428,Mr.F0_RED=403,Mr.F1_GREEN=404,Mr.F2_YELLOW=405,Mr.F3_BLUE=406,Mr.NUM_0=48,Mr.NUM_1=49,Mr.NUM_2=50,Mr.NUM_3=51,Mr.NUM_4=52,Mr.NUM_5=53,Mr.NUM_6=54,Mr.NUM_7=55,Mr.NUM_8=56,Mr.NUM_9=57,Mr.MINUS=189,Mr.E_MANUAL=10146,Mr.PREVIOUS_CHANNEL=10190,Mr.PICTURE_SIZE=10140,Mr.SOCCER=10228,Mr.TELETEXT=10200,Mr.SEARCH=10225,Mr.GUIDE=458,Mr.SOURCE=10072,Mr.EXTRA=10253,Mr.MTS=10195,Mr.MEDIA_PLAY_PAUSE=10252,Mr.MENU=18,Mr.MEDIA_REWIND=412,Mr.TOOLS=10135,Mr.MEDIA_FAST_FORWARD=417,Mr.INFO=457,Mr.MEDIA_PLAY=415,Mr.EXIT=10182,Mr.MEDIA_PAUSE=19,Mr.MEDIA_STOP=413,Mr.CAPTION=10221,Mr.MEDIA_RECORD=416,Mr.CHANNEL_LIST=10073,Mr.MEDIA_TRACK_PREVIOUS=10232,Mr.MEDIA_TRACK_NEXT=10233,Mr.MEDIA_3D=10199,(Yr.prototype=Yr).constructor=Yr,Yr.prototype.setGamepad=function(a){if(null!=a){this.index=a.index,this.gamepad=a,this.buttons=[];for(var r=0;r<a.buttons.length;r++)this.buttons.push(new li);this.setProductVendor(a),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},Yr.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},Yr.prototype.setProductVendor=function(a){try{var r=a.id.split(":");return this.vendor=r[1].split(" ")[1],void(this.product=r[2].replace(" ","").replace(")",""))}catch{}try{return r=a.id.split("-"),this.vendor=r[0],void(this.product=r[1])}catch{}},Yr.prototype.update=function(a){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var r=0;r<this.buttons.length;r++)this.buttons[r].update(this.gamepad.buttons[r].pressed?li.DOWN:li.UP)},Yr.prototype.getAnalogueButton=function(a){return a>this.buttons.length||a<0?0:this.gamepad.buttons[a].value},Yr.prototype.getAxis=function(a){return a>this.gamepad.axes.length||a<0?0:this.gamepad.axes[a]},Yr.prototype.buttonExists=function(a){return a>=0&&a<this.buttons.length},Yr.prototype.buttonPressed=function(a){return!!this.buttons[a]&&this.buttons[a].pressed},Yr.prototype.buttonJustPressed=function(a){return!!this.buttons[a]&&this.buttons[a].justPressed},Yr.prototype.buttonJustReleased=function(a){return!!this.buttons[a]&&this.buttons[a].justReleased},Yr.LEFT=14,Yr.RIGHT=15,Yr.DOWN=13,Yr.UP=12,Yr.SELECT=8,Yr.START=9,Yr.HOME=16,Yr.LEFT_TRIGGER_A=4,Yr.LEFT_TRIGGER_B=6,Yr.RIGHT_TRIGGER_A=5,Yr.RIGHT_TRIGGER_B=7,Yr.L1=4,Yr.L2=6,Yr.L3=6,Yr.R1=5,Yr.R2=7,Yr.R3=11,Yr.A=0,Yr.B=1,Yr.C=2,Yr.D=3,Yr.X=2,Yr.Y=3,Yr.LEFT_ANALOGUE_BUT=10,Yr.LEFT_ANALOGUE_HOR=0,Yr.LEFT_ANALOGUE_VERT=1,Yr.RIGHT_ANALOGUE_BUT=11,Yr.RIGHT_ANALOGUE_HOR=2,Yr.RIGHT_ANALOGUE_VERT=3,Ou.prototype.setObjectQuaternion=(qd=new l.Euler,su=new l.Quaternion,rl=new l.Vector3(0,0,1),Zp=new l.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(a){qd.set(this.beta,this.alpha,-this.gamma,"YXZ"),a.quaternion.setFromEuler(qd),a.quaternion.multiply(Zp),a.quaternion.multiply(su.setFromAxisAngle(rl,-this.orientation))}),Ou.prototype.dispose=function(){this.events.destroy()},ku.prototype.getSize=function(){return{width:this.size.x,height:this.size.y}},ku.prototype.setSize=function(a,r){this.size.set(a,r),this.halfSize.set(a/2,r/2),this.domElement.style.width=a+"px",this.domElement.style.height=r+"px",this.cameraElement.style.width=a+"px",this.cameraElement.style.height=r+"px"},ku.prototype.render=function(a,r){function h(T){var z=T.elements;return"matrix3d("+z[0]+","+-z[1]+","+z[2]+","+z[3]+","+z[4]+","+-z[5]+","+z[6]+","+z[7]+","+z[8]+","+-z[9]+","+z[10]+","+z[11]+","+z[12]+","+-z[13]+","+z[14]+","+z[15]+")"}function p(T,z){var ee=T.elements;return"translate(-50%,-50%)matrix3d("+ee[0]+","+ee[1]+","+ee[2]+","+ee[3]+","+-ee[4]+","+-ee[5]+","+-ee[6]+","+-ee[7]+","+ee[8]+","+ee[9]+","+ee[10]+","+ee[11]+","+ee[12]+","+ee[13]+","+ee[14]+","+ee[15]+")"}var y,b=this,N=r.projectionMatrix.elements[5]*this.halfSize.y;this.cache.camera.fov!==N&&(r.isPerspectiveCamera&&(this.domElement.style.WebkitPerspective=N+"px",this.domElement.style.perspective=N+"px"),this.cache.camera.fov=N),a.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld();var O=(y=r.isOrthographicCamera?"scale("+N+")translate("+-(r.right+r.left)/2+"px,"+(r.top+r.bottom)/2+"px)"+h(r.matrixWorldInverse):"translateZ("+N+"px)"+h(r.matrixWorldInverse))+"translate("+this.halfSize.x+"px,"+this.halfSize.y+"px)";this.cache.camera.style!==O&&(this.cameraElement.style.WebkitTransform=O,this.cameraElement.style.transform=O,this.cache.camera.style=O),function T(z,ee,oe){if(!0===z.isCSS3DObject){var ne;!0===z.isCSS3DSprite?(matrix.copy(ee.matrixWorldInverse),matrix.transpose(),matrix.copyPosition(z.matrixWorld),matrix.scale(z.scale),matrix.elements[3]=0,matrix.elements[7]=0,matrix.elements[11]=0,matrix.elements[15]=1,ne=p(matrix)):ne=p(z.matrixWorld);var ve=z.element,xe=b.cache.objects.get(z);void 0!==xe&&xe.style===ne||(ve.style.WebkitTransform=ne,ve.style.transform=ne,b.cache.objects.set(z,{style:ne})),ve.parentNode!==b.cameraElement&&b.cameraElement.appendChild(ve)}for(var Te=0,Ce=z.children.length;Te<Ce;Te++)T(z.children[Te],ee,oe)}(a,r,y)},(lu.prototype=Object.create(vl.prototype)).constructor=lu,lu.prototype.isCSS3DSprite=!0,Fa.prototype=Object.create(Dl.prototype),Fu.prototype.modify=function(a){a instanceof l.BufferGeometry?((a=new l.Geometry).fromBufferGeometry(Editor.selection[0].geometry),a.mergeVertices()):a=a.clone();for(var r=new l.Quaternion,h=0;h<a.vertices.length;h++){var p=a.vertices[h].y;p>=this.start&&p<=this.end?(r.setFromAxisAngle(this.direction,this.angle*((p-this.start)/(this.end-this.start))),a.vertices[h].applyQuaternion(r)):p>this.end&&(r.setFromAxisAngle(this.direction,this.angle),a.vertices[h].applyQuaternion(r))}if(a.computeVertexNormals(),a.verticesNeedUpdate=!0,this.bufferGeometry){var b=new l.BufferGeometry;return b.fromGeometry(a),b}return a},cu.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},cu.prototype.clear=function(){this.destroy(),this.events=[]},cu.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},cu.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},Xn.prototype.set=function(a,r){this.x=a,this.y=r},Xn.prototype.setScalar=function(a){this.x=a,this.y=a},Xn.prototype.clone=function(){return new Xn(this.x,this.y)},Xn.prototype.copy=function(a){this.x=a.x,this.y=a.y},Xn.prototype.add=function(a){this.x+=a.x,this.y+=a.y},Xn.prototype.addScalar=function(a){this.x+=a,this.y+=a},Xn.prototype.addVectors=function(a,r){this.x=a.x+r.x,this.y=a.y+r.y},Xn.prototype.addScaledVector=function(a,r){this.x+=a.x*r,this.y+=a.y*r},Xn.prototype.sub=function(a){this.x-=a.x,this.y-=a.y},Xn.prototype.subScalar=function(a){this.x-=a,this.y-=a},Xn.prototype.subVectors=function(a,r){this.x=a.x-r.x,this.y=a.y-r.y},Xn.prototype.multiply=function(a){this.x*=a.x,this.y*=a.y},Xn.prototype.multiplyScalar=function(a){this.x*=a,this.y*=a},Xn.prototype.divide=function(a){this.x/=a.x,this.y/=a.y},Xn.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},Xn.prototype.min=function(a){this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y)},Xn.prototype.max=function(a){this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y)},Xn.prototype.clamp=function(a,r){this.x=Math.max(a.x,Math.min(r.x,this.x)),this.y=Math.max(a.y,Math.min(r.y,this.y))},Xn.prototype.clampScalar=function(a,r){this.x=Math.max(a,Math.min(r,this.x)),this.y=Math.max(a,Math.min(r,this.y))},Xn.prototype.clampLength=function(a,r){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(r,h)))},Xn.prototype.floor=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},Xn.prototype.ceil=function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},Xn.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},Xn.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},Xn.prototype.dot=function(a){return this.x*a.x+this.y*a.y},Xn.prototype.cross=function(a){return this.x*a.y-this.y*a.x},Xn.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Xn.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Xn.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},Xn.prototype.normalize=function(){return this.divideScalar(this.length()||1)},Xn.prototype.angle=function(){var a=Math.atan2(this.y,this.x);return a<0&&(a+=2*Math.PI),a},Xn.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},Xn.prototype.distanceToSquared=function(a){var r=this.x-a.x,h=this.y-a.y;return r*r+h*h},Xn.prototype.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},Xn.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)},Xn.prototype.lerp=function(a,r){this.x+=(a.x-this.x)*r,this.y+=(a.y-this.y)*r},Xn.prototype.lerpVectors=function(a,r,h){return this.subVectors(r,a).multiplyScalar(h).add(a)},Xn.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},Xn.prototype.fromArray=function(a){this.set(a[0],a[1])},Xn.prototype.toArray=function(){return[this.x,this.y]},Xn.prototype.rotateAround=function(a,r){var h=Math.cos(r),p=Math.sin(r),y=this.x-a.x,b=this.y-a.y;this.x=y*h-b*p+a.x,this.y=y*p+b*h+a.y},Oi.prototype.copy=function(a){this.m=a.m.slice(0)},Oi.prototype.clone=function(){return new Oi(this.m.slice(0))},Oi.prototype.identity=function(){this.m=[1,0,0,1,0,0]},Oi.prototype.multiply=function(a){this.m=[this.m[0]*a.m[0]+this.m[2]*a.m[1],this.m[1]*a.m[0]+this.m[3]*a.m[1],this.m[0]*a.m[2]+this.m[2]*a.m[3],this.m[1]*a.m[2]+this.m[3]*a.m[3],this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5]]},Oi.prototype.premultiply=function(a){this.m=[a.m[0]*this.m[0]+a.m[2]*this.m[1],a.m[1]*this.m[0]+a.m[3]*this.m[1],a.m[0]*this.m[2]+a.m[2]*this.m[3],a.m[1]*this.m[2]+a.m[3]*this.m[3],a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5]]},Oi.prototype.compose=function(a,r,h,p,y,b,N){if(this.m=[1,0,0,1,a,r],0!==N){var O=Math.cos(N),T=Math.sin(N);this.multiply(new Oi([O,T,-T,O,0,0]))}1===h&&1===p||this.scale(h,p),0===y&&0===b||this.multiply(new Oi([1,0,0,1,-y,-b]))},Oi.prototype.translate=function(a,r){this.m[4]+=this.m[0]*a+this.m[2]*r,this.m[5]+=this.m[1]*a+this.m[3]*r},Oi.prototype.rotate=function(a){var r=Math.cos(a),h=Math.sin(a),y=this.m[1]*r+this.m[3]*h,b=this.m[0]*-h+this.m[2]*r,N=this.m[1]*-h+this.m[3]*r;this.m[0]=this.m[0]*r+this.m[2]*h,this.m[1]=y,this.m[2]=b,this.m[3]=N},Oi.prototype.scale=function(a,r){this.m[0]*=a,this.m[1]*=a,this.m[2]*=r,this.m[3]*=r},Oi.prototype.setPosition=function(a,r){this.m[4]=a,this.m[5]=r},Oi.prototype.getScale=function(){return new Xn(this.m[0],this.m[3])},Oi.prototype.getPosition=function(){return new Xn(this.m[4],this.m[5])},Oi.prototype.skew=function(a,r){this.multiply(new Oi([1,Math.tan(r),Math.tan(a),1,0,0]))},Oi.prototype.determinant=function(){return 1/(this.m[0]*this.m[3]-this.m[1]*this.m[2])},Oi.prototype.getInverse=function(){var a=this.determinant();return new Oi([this.m[3]*a,-this.m[1]*a,-this.m[2]*a,this.m[0]*a,a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a*(this.m[1]*this.m[4]-this.m[0]*this.m[5])])},Oi.prototype.transformPoint=function(a){return new Xn(a.x*this.m[0]+a.y*this.m[2]+this.m[4],a.x*this.m[1]+a.y*this.m[3]+this.m[5])},Oi.prototype.setContextTransform=function(a){a.setTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Oi.prototype.tranformContext=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Oi.prototype.cssTransform=function(){return"matrix("+this.m[0]+","+this.m[1]+","+this.m[2]+","+this.m[3]+","+this.m[4]+","+this.m[5]+")"},Rh.generate=function(){for(var a=[],r=0;r<256;r++)a[r]=(r<16?"0":"")+r.toString(16);return function(){var h=4294967295*Math.random()|0,p=4294967295*Math.random()|0,y=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return(a[255&h]+a[h>>8&255]+a[h>>16&255]+a[h>>24&255]+"-"+a[255&p]+a[p>>8&255]+"-"+a[p>>16&15|64]+a[p>>24&255]+"-"+a[63&y|128]+a[y>>8&255]+"-"+a[y>>16&255]+a[y>>24&255]+a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]).toUpperCase()}}(),Pn.prototype.constructor=Pn,Pn.prototype.type="Object2D",Pn.types=new Map([[Pn.prototype.type,Pn]]),Pn.register=function(a,r){Pn.types.set(r,a)},Pn.prototype.getWorldPointIntersections=function(a,r){void 0===r&&(r=[]);var h=this.inverseGlobalMatrix.transformPoint(a);this.isInside(h)&&r.push(this);for(var p=0;p<this.children.length;p++)this.children[p].getWorldPointIntersections(a,r);return r},Pn.prototype.isWorldPointInside=function(a,r){var h=this.inverseGlobalMatrix.transformPoint(a);if(this.isInside(h))return!0;if(r)for(var p=0;p<this.children.length;p++)if(this.children[p].isWorldPointInside(a,!0))return!0;return!1},Pn.prototype.destroy=function(){null!==this.parent&&this.parent.remove(this)},Pn.prototype.traverse=function(a){a(this);for(var r=0;r<this.children.length;r++)this.children[r].traverse(a)},Pn.prototype.getChildByUUID=function(a){var r=null;return this.traverse(function(h){h.uuid===a&&(r=h)}),r},Pn.prototype.add=function(a){a.parent=this,a.level=this.level+1,a.traverse(function(r){null!==r.onAdd&&r.onAdd(this)}),this.children.push(a)},Pn.prototype.remove=function(a){var r=this.children.indexOf(a);if(-1!==r){var h=this.children[r];h.parent=null,h.level=0,h.traverse(function(p){null!==p.onRemove&&p.onRemove(this)}),this.children.splice(r,1)}},Pn.prototype.isInside=function(a){return!1},Pn.prototype.updateMatrix=function(a){(this.matrixAutoUpdate||this.matrixNeedsUpdate)&&(this.matrix.compose(this.position.x,this.position.y,this.scale.x,this.scale.y,this.origin.x,this.origin.y,this.rotation),this.globalMatrix.copy(this.matrix),null!==this.parent&&this.globalMatrix.premultiply(this.parent.globalMatrix),this.inverseGlobalMatrix=this.globalMatrix.getInverse(),this.matrixNeedsUpdate=!1)},Pn.prototype.transform=function(a,r,h,p){this.globalMatrix.tranformContext(a)},Pn.prototype.style=null,Pn.prototype.draw=null,Pn.prototype.onPointerDrag=function(a,r,h,p){this.position.add(h)},Pn.prototype.onPointerDragStart=null,Pn.prototype.onPointerDragEnd=null,Pn.prototype.onAdd=null,Pn.prototype.onRemove=null,Pn.prototype.onUpdate=null,Pn.prototype.onPointerEnter=null,Pn.prototype.onPointerLeave=null,Pn.prototype.onPointerOver=null,Pn.prototype.onButtonPressed=null,Pn.prototype.onDoubleClick=null,Pn.prototype.onButtonDown=null,Pn.prototype.onButtonUp=null,Pn.prototype.serialize=function(a){var r={uuid:this.uuid,type:this.type,position:this.position.toArray(),origin:this.origin.toArray(),scale:this.scale.toArray(),rotation:this.rotation,visible:this.visible,layer:this.layer,matrix:this.matrix.m,globalMatrix:this.globalMatrix.m,inverseGlobalMatrix:this.inverseGlobalMatrix.m,matrixAutoUpdate:this.matrixAutoUpdate,draggable:this.draggable,pointerEvents:this.pointerEvents,ignoreViewport:this.ignoreViewport,saveContextState:this.saveContextState,restoreContextState:this.restoreContextState,children:[],masks:[]};if(!1!==a)for(var h=0;h<this.children.length;h++)this.children[h].serializable&&r.children.push(this.children[h].serialize());for(h=0;h<this.masks.length;h++)r.masks.push(this.masks[h].uuid);return r},Pn.prototype.parse=function(a,r){this.uuid=a.uuid,this.position.fromArray(a.position),this.origin.fromArray(a.origin),this.scale.fromArray(a.scale),this.rotation=a.rotation,this.visible=a.visible,this.layer=a.layer,this.matrix=new Oi(a.matrix),this.globalMatrix=new Oi(a.globalMatrix),this.inverseGlobalMatrix=new Oi(a.inverseGlobalMatrix),this.matrixAutoUpdate=a.matrixAutoUpdate,this.draggable=a.draggable,this.pointerEvents=a.pointerEvents,this.ignoreViewport=a.ignoreViewport,this.saveContextState=a.saveContextState,this.restoreContextState=a.restoreContextState;for(var h=0;h<this.masks.length;h++)a.masks.push(r.getChildByUUID(a.masks[h]))},Pn.parse=function(a){for(var r=[],h=function y(b){if(!Pn.types.has(b.type))throw new Error("Object type "+b.type+" unknown. Cannot parse data.");var N=new(Pn.types.get(b.type));N.uuid=b.uuid,r.push({object:N,data:b});for(var O=0;O<b.children.length;O++)N.add(y(b.children[O]));return N}(a),p=0;p<r.length;p++)r[p].object.parse(r[p].data,h);return h},Do.DOWN=-1,Do.UP=1,Do.RESET=0,Do.prototype.constructor=Do,Do.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===Do.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===Do.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===Do.RESET&&(this.justReleased=!1,this.justPressed=!1)},Do.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},Do.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Gi.prototype=Gi).constructor=Gi,Gi.LEFT=0,Gi.MIDDLE=1,Gi.RIGHT=2,Gi.BACK=3,Gi.FORWARD=4,Gi.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Gi.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Gi.buttonPressed=function(a){return this.keys[a].pressed},Gi.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Gi.buttonJustPressed=function(a){return this.keys[a].justPressed},Gi.buttonJustReleased=function(a){return this.keys[a].justReleased},Gi.updatePosition=function(a,r,h,p){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=p,this._positionUpdated=!0},Gi.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Gi.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Gi.create=function(){this.events.create()},Gi.dispose=function(){this.events.destroy()},Qp.prototype.updateMatrix=function(){if(this.matrixNeedsUpdate){if(this.matrix.m=[1,0,0,1,this.position.x,this.position.y],0!==this.rotation){var a=Math.cos(this.rotation),r=Math.sin(this.rotation);this.matrix.multiply(new Oi([a,r,-r,a,0,0]))}1!==this.scale&&this.matrix.scale(this.scale,this.scale),this.inverseMatrix=this.matrix.getInverse(),this.matrixNeedsUpdate=!1}},Qp.prototype.centerObject=function(a,r){var h=a.globalMatrix.transformPoint(new Xn);h.multiplyScalar(-this.scale),h.x+=r.width/2,h.y+=r.height/2,this.position.copy(h),this.matrixNeedsUpdate=!0},Ph.prototype.update=function(a){if(this.allowScale&&0!==a.wheel&&(this.viewport.scale-=.001*a.wheel*this.viewport.scale,this.viewport.matrixNeedsUpdate=!0,this.moveOnScale&&null!==a.canvas)){this.viewport.updateMatrix();var h=this.viewport.inverseMatrix.transformPoint(a.position),p=new Xn(a.canvas.width/2,a.canvas.height/2);p=this.viewport.inverseMatrix.transformPoint(p);var y=h.clone();y.sub(p),y.multiplyScalar(.1),this.viewport.position.sub(y),this.viewport.matrixNeedsUpdate=!0}if(this.allowRotation&&a.buttonPressed(Gi.RIGHT)&&a.buttonPressed(Gi.LEFT))if(null===this.rotationPoint)this.rotationPoint=a.position.clone(),this.rotationInitial=this.viewport.rotation;else{var b=a.position.clone();b.sub(this.rotationPoint),this.viewport.rotation=this.rotationInitial+b.angle(),this.viewport.matrixNeedsUpdate=!0}else this.rotationPoint=null,a.buttonPressed(this.dragButton)&&(this.viewport.position.x+=a.delta.x,this.viewport.position.y+=a.delta.y,this.viewport.matrixNeedsUpdate=!0)},Du.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Du.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},na.prototype.getDomContainer=function(){return null!==this.container?this.container:this.canvas.parentElement},na.prototype.createRenderLoop=function(a,r,h){var p=this,y=new Ph(r),b=new Du(function(){void 0!==h&&h(),y.update(p.pointer),p.update(a,r)});return b.start(),b},na.prototype.dispose=function(a,r,h){this.pointer.dispose()},na.prototype.update=function(a,r){var h=[];a.traverse(function(Te){Te.visible&&h.push(Te)}),h.sort(function(Te,Ce){return Ce.layer===Te.layer?Ce.level-Te.level:Ce.layer-Te.layer});var p=this.pointer;p.update(),r.updateMatrix();for(var y=p.position.clone(),b=r.inverseMatrix.transformPoint(y),N=0;N<h.length;N++)if((T=h[N]).pointerEvents){var O=T.inverseGlobalMatrix.transformPoint(T.ignoreViewport?y:b);if(T.isInside(O)){if(T.pointerInside||null===T.onPointerEnter||T.onPointerEnter(p,r),null!==T.onPointerOver&&T.onPointerOver(p,r),p.buttonDoubleClicked(Gi.LEFT)&&null!==T.onDoubleClick&&T.onDoubleClick(p,r),p.buttonPressed(Gi.LEFT)&&null!==T.onButtonPressed&&T.onButtonPressed(p,r),p.buttonJustReleased(Gi.LEFT)&&null!==T.onButtonUp&&T.onButtonUp(p,r),p.buttonJustPressed(Gi.LEFT)&&(null!==T.onButtonDown&&T.onButtonDown(p,r),T.draggable)){T.beingDragged=!0,null!==T.onPointerDragStart&&T.onPointerDragStart(p,r);break}T.pointerInside=!0}else T.pointerInside&&(null!==T.onPointerLeave&&T.onPointerLeave(p,r),T.pointerInside=!1);p.buttonJustReleased(Gi.LEFT)&&T.draggable&&(!0===T.beingDragged&&null!==T.onPointerDragEnd&&T.onPointerDragEnd(p,r),T.beingDragged=!1)}for(N=0;N<h.length;N++){var T;if((T=h[N]).beingDragged&&null!==T.onPointerDrag){var z=p.position.clone();z.sub(p.delta);var ee=r.inverseMatrix.transformPoint(p.position),oe=r.inverseMatrix.transformPoint(z),ne=ee.clone();ne.sub(oe),T.onPointerDrag(p,r,ne,ee)}null!==T.onUpdate&&T.onUpdate()}for(a.traverse(function(Te){Te.updateMatrix()}),this.context.setTransform(1,0,0,1,0,0),this.autoClear&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),N=h.length-1;N>=0;N--)if(!h[N].isMask){h[N].saveContextState&&this.context.save();for(var ve=h[N].masks,xe=0;xe<ve.length;xe++)ve[xe].ignoreViewport||r.matrix.setContextTransform(this.context),ve[xe].transform(this.context,r,this.canvas,this),ve[xe].clip(this.context,r,this.canvas);h[N].ignoreViewport?ve.length>0&&this.context.setTransform(1,0,0,1,0,0):r.matrix.setContextTransform(this.context),h[N].transform(this.context,r,this.canvas,this),null!==h[N].style&&h[N].style(this.context,r,this.canvas),null!==h[N].draw&&h[N].draw(this.context,r,this.canvas),h[N].restoreContextState&&this.context.restore()}},Qi.prototype.set=function(a,r){return this.min.copy(a),this.max.copy(r),this},Qi.prototype.setFromPoints=function(a){this.min=new Xn(1/0,1/0),this.max=new Xn(-1/0,-1/0);for(var r=0,h=a.length;r<h;r++)this.expandByPoint(a[r]);return this},Qi.prototype.setFromCenterAndSize=function(a,r){var h=(new Xn).copy(r).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this},Qi.prototype.clone=function(){var a=new Qi;return a.copy(this),a},Qi.prototype.copy=function(a){this.min.copy(a.min),this.max.copy(a.max)},Qi.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},Qi.prototype.getCenter=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5),a},Qi.prototype.getSize=function(a){return void 0===a&&(a=new Xn),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min),a},Qi.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},Qi.prototype.expandByVector=function(a){this.min.sub(a),this.max.add(a)},Qi.prototype.expandByScalar=function(a){this.min.addScalar(-a),this.max.addScalar(a)},Qi.prototype.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},Qi.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},Qi.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},Qi.prototype.distanceToPoint=function(a){return(new Xn).copy(a).clamp(this.min,this.max).sub(a).length()},Qi.prototype.intersect=function(a){this.min.max(a.min),this.max.min(a.max)},Qi.prototype.union=function(a){this.min.min(a.min),this.max.max(a.max)},Qi.prototype.translate=function(a){this.min.add(a),this.max.add(a)},Qi.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},Qi.prototype.toArray=function(){return[this.min.x,this.min.y,this.max.x,this.max.y]},Qi.prototype.fromArray=function(a){this.min.set(a[0],a[1]),this.max.set(a[2],a[3])},(ra.prototype=Object.create(Pn.prototype)).constructor=ra,ra.prototype.type="Mask",Pn.register(ra,"Mask"),ra.prototype.isMask=!0,ra.prototype.clip=function(a,r,h){},(yl.prototype=Object.create(ra.prototype)).constructor=yl,yl.prototype.type="BoxMask",Pn.register(yl,"BoxMask"),yl.prototype.isInside=function(a){return this.box.containsPoint(a)},yl.prototype.clip=function(a,r,h){a.beginPath();var p=this.box.max.x-this.box.min.x;this.invert?(a.rect(this.box.min.x-1e4,-5e3,1e4,1e4),a.rect(this.box.max.x,-5e3,1e4,1e4),a.rect(this.box.min.x,this.box.min.y-1e4,p,1e4),a.rect(this.box.min.x,this.box.max.y,p,1e4)):a.fillRect(this.box.min.x,this.box.min.y,p,this.box.max.y-this.box.min.y),a.clip()},oo.prototype.get=function(a){},oo.prototype.serialize=function(){},oo.prototype.parse=function(a){},oo.types=new Map([]),oo.register=function(a,r){oo.types.set(r,a)},oo.parse=function(a){var r=new(oo.types.get(a.type));return r.parse(a),r},Ko.prototype=Object.create(oo.prototype),oo.register(Ko,"Color"),Ko.prototype.get=function(a){return this.color},Ko.prototype.serialize=function(){return{type:"Color",color:this.color}},Ko.prototype.parse=function(a){this.color=a.color},(xs.prototype=Object.create(Pn.prototype)).constructor=xs,xs.prototype.type="Box",Pn.register(xs,"Box"),xs.prototype.onPointerEnter=function(a,r){this.fillStyle=new Ko("#CCCCCC")},xs.prototype.onPointerLeave=function(a,r){this.fillStyle=new Ko("#FFFFFF")},xs.prototype.isInside=function(a){return this.box.containsPoint(a)},xs.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillRect(this.box.min.x,this.box.min.y,p,y)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeRect(this.box.min.x,this.box.min.y,p,y))},xs.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},xs.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?oo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?oo.parse(a.fillStyle):null},(uo.prototype=Object.create(Pn.prototype)).constructor=uo,uo.prototype.type="Circle",Pn.register(uo,"Circle"),uo.prototype.isInside=function(a){return a.length()<=this.radius},uo.prototype.onPointerEnter=function(a,r){this.fillStyle=new Ko("#CCCCCC")},uo.prototype.onPointerLeave=function(a,r){this.fillStyle=new Ko("#FFFFFF")},uo.prototype.draw=function(a,r,h){a.beginPath(),a.arc(0,0,this.radius,0,2*Math.PI),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.stroke())},uo.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.radius=this.radius,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},uo.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.radius=a.radius,this.strokeStyle=null!==a.strokeStyle?oo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?oo.parse(a.fillStyle):null},(qo.prototype=Object.create(Pn.prototype)).constructor=qo,qo.prototype.type="Line",Pn.register(qo,"Line"),qo.prototype.style=function(a,r,h){a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.setLineDash(this.dashPattern)},qo.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.lineTo(this.to.x,this.to.y),a.stroke()},qo.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.from=this.from.toArray(),r.to=this.to.toArray(),r.dashPattern=this.dashPattern,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r},qo.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.to.fromArray(a.to),this.from.fromArray(a.from),this.dashPattern=a.dashPattern,this.strokeStyle=null!==a.strokeStyle?oo.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth},(rs.prototype=Object.create(Pn.prototype)).constructor=rs,rs.prototype.type="Text",Pn.register(rs,"Text"),rs.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(this.text,0,0)),null!==this.strokeStyle&&(a.strokeStyle=this.strokeStyle.get(a),a.strokeText(this.text,0,0))},rs.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.text=this.text,r.font=this.font,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.textAlign=this.textAlign,r.textBaseline=this.textBaseline,r},rs.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.text=a.text,this.font=a.font,this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.textAlign=a.textAlign,this.textBaseline=a.textBaseline},(wa.prototype=Object.create(Pn.prototype)).constructor=wa,wa.prototype.type="Image",Pn.register(wa,"Image"),wa.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},wa.prototype.isInside=function(a){return this.box.containsPoint(a)},wa.prototype.draw=function(a,r,h){this.image.src.length>0&&a.drawImage(this.image,0,0,this.image.naturalWidth,this.image.naturalHeight,this.box.min.x,this.box.min.y,this.box.max.x-this.box.min.x,this.box.max.y-this.box.min.y)},wa.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r},wa.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image},(Ih.prototype=Object.create(Pn.prototype)).constructor=Ih,Ih.prototype.type="DOM",Pn.register(Ih,"DOM"),Ih.prototype.onAdd=function(){null!==this.parentElement&&this.parentElement.appendChild(this.element)},Ih.prototype.onRemove=function(){null!==this.parentElement&&this.parentElement.removeChild(this.element)},Ih.prototype.transform=function(a,r,h,p){if(null===this.parentElement&&(this.parentElement=p.getDomContainer(),this.parentElement.appendChild(this.element)),this.ignoreViewport)this.element.style.transform=this.globalMatrix.cssTransform();else{var y=r.matrix.clone();y.multiply(this.globalMatrix),this.element.style.transform=y.cssTransform()}this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px",this.element.style.display=this.visible?"block":"none"},Ih.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.size=this.size.toArray(),r.element=this.element.outerHTML,r},Ih.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.size.fromArray(a.size);var h=(new DOMParser).parseFromString(this.element.outerHTML,"text/html");this.element=h.body.children[0]},(so.prototype=Object.create(Pn.prototype)).constructor=so,so.prototype.type="Pattern",Pn.register(so,"Pattern"),so.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},so.prototype.isInside=function(a){return this.box.containsPoint(a)},so.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;if(this.image.src.length>0){var b=a.createPattern(this.image,this.repetition);a.fillStyle=b,a.fillRect(this.box.min.x,this.box.min.y,p,y)}},so.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r.repetition=this.repetition,r},so.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image,this.repetition=a.repetition},(Sa.prototype=Object.create(rs.prototype)).constructor=Sa,Sa.prototype.type="MultiLineText",Pn.register(Sa,"MultiLineText"),Sa.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline;for(var p=this.lineHeight||Number.parseFloat(this.font),y=this.text.split("\n"),b=0,N=0;N<y.length;N++){var O=y[N],T=a.measureText(O),z=[];if(null!==this.maxWidth&&T.width>this.maxWidth)for(;O.length>0;){for(var ee="",oe=a.measureText(ee+O[0]);oe.width<this.maxWidth&&O.length>0;)ee+=O[0],O=O.substr(1),oe=a.measureText(ee+O[0]);z.push(ee)}else z=[O];for(var ne=0;ne<z.length;ne++)null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(z[ne],this.position.x,this.position.y+b)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeText(z[ne],this.position.x,this.position.y+b)),b+=p}},Sa.prototype.serialize=function(a){var r=rs.prototype.serialize.call(this,a);return r.maxWidth=this.maxWidth,r.lineHeight=this.lineHeight,r},Sa.prototype.parse=function(a,r){rs.prototype.parse.call(this,a,r),this.maxWidth=a.maxWidth,this.lineHeight=a.lineHeight},(xl.prototype=Object.create(qo.prototype)).constructor=xl,xl.prototype.type="BezierCurve",Pn.register(xl,"BezierCurve"),xl.curveHelper=function(a){var r=new uo;r.radius=3,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(b,N,O){Pn.prototype.onPointerDrag.call(this,b,N,O),a.fromCp.copy(r.position)},a.parent.add(r);var h=new qo;h.from=a.from,h.to=a.fromCp,a.parent.add(h);var p=new uo;p.radius=3,p.layer=a.layer+1,p.draggable=!0,p.onPointerDrag=function(b,N,O){Pn.prototype.onPointerDrag.call(this,b,N,O),a.toCp.copy(p.position)},a.parent.add(p);var y=new qo;y.from=a.to,y.to=a.toCp,a.parent.add(y)},xl.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.bezierCurveTo(this.fromCp.x,this.fromCp.y,this.toCp.x,this.toCp.y,this.to.x,this.to.y),a.stroke()},xl.prototype.serialize=function(a){var r=qo.prototype.serialize.call(this,a);return r.fromCp=this.fromCp.toArray(),r.toCp=this.toCp.toArray(),r},xl.prototype.parse=function(a,r){qo.prototype.parse.call(this,a,r),this.fromCp.fromArray(a.fromCp),this.toCp.fromArray(a.toCp)},(uu.prototype=Object.create(qo.prototype)).constructor=uu,uu.prototype.type="QuadraticCurve",Pn.register(uu,"QuadraticCurve"),uu.curveHelper=function(a){var r=new qo;r.from=a.from,r.to=a.controlPoint,a.parent.add(r);var h=new uo;h.radius=3,h.layer=a.layer+1,h.draggable=!0,h.position=a.controlPoint,h.onPointerDrag=function(y,b,N){Pn.prototype.onPointerDrag.call(this,y,b,N),a.controlPoint.copy(h.position)},a.parent.add(h);var p=new qo;p.from=a.to,p.to=a.controlPoint,a.parent.add(p)},uu.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.to.x,this.to.y),a.stroke()},uu.prototype.serialize=function(a){var r=qo.prototype.serialize.call(this,a);return r.controlPoint=this.controlPoint.toArray(),r},uu.prototype.parse=function(a,r){qo.prototype.parse.call(this,a,r),this.controlPoint.fromArray(a.controlPoint)},(Da.prototype=Object.create(xs.prototype)).constructor=Da,Da.prototype.type="RoundedBox",Pn.register(Da,"RoundedBox"),Da.roundRect=function(a,r,h,p,y,b){a.beginPath(),a.moveTo(r+b,h),a.lineTo(r+p-b,h),a.quadraticCurveTo(r+p,h,r+p,h+b),a.lineTo(r+p,h+y-b),a.quadraticCurveTo(r+p,h+y,r+p-b,h+y),a.lineTo(r+b,h+y),a.quadraticCurveTo(r,h+y,r,h+y-b),a.lineTo(r,h+b),a.quadraticCurveTo(r,h,r+b,h),a.closePath()},Da.prototype.draw=function(a,r,h){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),Da.roundRect(a,this.box.min.x,this.box.min.y,p,y,this.radius),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),Da.roundRect(a,this.box.min.x,this.box.min.y,p,y,this.radius),a.stroke())},Da.prototype.serialize=function(a){var r=xs.prototype.serialize.call(this,a);return r.radius=this.radius,r},Da.prototype.parse=function(a,r){xs.prototype.parse.call(this,a,r),this.radius=a.radius},(as.prototype=Object.create(Pn.prototype)).constructor=as,as.prototype.type="Graph",Pn.register(as,"Graph"),as.prototype.isInside=function(a){return this.box.containsPoint(a)},as.prototype.draw=function(a,r,h){if(0!==this.data.length){var p=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.beginPath();var b=p/(this.data.length-1),N=this.max-this.min;a.moveTo(this.box.min.x,this.box.max.y-(this.data[0]-this.min)/N*y);for(var O=1,T=b;O<this.data.length;T+=b,O++)a.lineTo(this.box.min.x+T,this.box.max.y-(this.data[O]-this.min)/N*y);a.stroke(),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.lineTo(this.box.max.x,this.box.max.y),a.lineTo(this.box.min.x,this.box.max.y),a.fill())}},as.prototype.serialize=function(a){var r=Pn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.min=this.min,r.max=this.max,r.data=this.data,r},as.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.min=a.min,this.max=a.max,this.data=a.data},(wl.prototype=Object.create(oo.prototype)).addColorStop=function(a,r){this.colors.push(new Kp(a,r))},wl.prototype.serialize=function(){return{colors:this.colors}},wl.prototype.parse=function(a){for(var r=[],h=0;h<a.colors.length;h++)r.push(new Kp(a.colors[h].offset,a.colors[h].color));this.colors=r},Gl.prototype=Object.create(wl.prototype),oo.register(Gl,"LinearGradient"),Gl.prototype.get=function(a){for(var r=a.createLinearGradient(this.start.x,this.start.y,this.end.x,this.end.y),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},Gl.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"LinearGradient",start:this.start.toArray(),end:this.end.toArray()}),a},Gl.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end)},(Uu.prototype=Object.create(Pn.prototype)).constructor=Uu,Uu.prototype.type="Gauge",Pn.register(Uu,"Gauge"),Uu.prototype.isInside=function(a){return a.length()<=this.radius},Uu.prototype.draw=function(a,r,h){var p=this.value/(this.max-this.min),y=[this.startAngle,this.endAngle],b=y[0]+(y[1]-y[0])*p,N=[0,0];a.lineWidth=this.lineWidth,a.lineCap="round",a.strokeStyle=this.baseStyle.get(a),a.beginPath(),a.arc(N[0],N[1],this.radius,y[0],y[1]),a.stroke();var O=a.createLinearGradient(-this.radius,0,this.radius,0);if(a.strokeStyle=this.barStyle.get(a),a.lineWidth=this.lineWidth,a.beginPath(),a.arc(N[0],N[1],this.radius,y[0],b),a.stroke(),this.dial){var T=(this.startAngle-this.endAngle)*p,z=[Math.cos(T)*this.radius,Math.sin(T)*this.radius];z[0]=z[0]-N[0],z[1]=z[1]-N[1],a.fillStyle="#FFFFFF",a.beginPath(),a.arc(z[0],z[1],this.lineWidth/2,0,2*Math.PI),a.fill(),a.fillStyle=O,a.beginPath(),a.arc(z[0],z[1],this.lineWidth/3,0,2*Math.PI),a.fill()}},Uu.prototype.serialize=function(a){return Pn.prototype.serialize.call(this,a)},Uu.prototype.parse=function(a,r){Pn.prototype.parse.call(this,a,r)},ho.prototype=Object.create(oo.prototype),oo.register(ho,"Pattern"),ho.prototype.setTransform=function(a){this.matrix.m=a,this.needsUpdate=!0},ho.prototype.get=function(a){return(this.needsUpdate||null===this.cache)&&(this.cache=a.createPattern(this.source,this.repetition),this.cache.setTransform(this.matrix.cssTransform()),this.needsUpdate=!1),this.cache},ho.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"Pattern",matrix:this.matrix.m,repetition:this.repetition,source:this.source}),a},ho.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.matrix=new Oi(a.matrix),this.repetition=a.repetition,this.source=a.source},dh.prototype=Object.create(wl.prototype),oo.register(dh,"RadialGradient"),dh.prototype.get=function(a){for(var r=a.createRadialGradient(this.start.x,this.start.y,this.startRadius,this.end.x,this.end.y,this.endRadius),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},dh.prototype.serialize=function(){var a=wl.prototype.serialize.call(this);return Object.assign(a,{type:"RadialGradient",start:this.start.toArray(),end:this.end.toArray(),startRadius:this.startRadius,endRadius:this.endRadius}),a},dh.prototype.parse=function(a){wl.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end),this.startRadius=a.startRadius,this.endRadius=a.endRadius},(hu.prototype=Object.create(Pn.prototype)).constructor=hu,hu.prototype.type="NodeGraph",Pn.register(hu,"NodeGraph"),hu.prototype.addNode=function(a){for(var r=0,h=0,p=0;p<this.children.length;p++)this.children[p].position.x>r&&(r=this.children[p].position.x),this.children[p].position.y>h&&(h=this.children[p].position.y);return a.position.set(r+200,h/2),this.add(a),null!==a.registerSockets&&a.registerSockets(),a},(ls.prototype=Object.create(xl.prototype)).constructor=ls,ls.prototype.type="NodeConnector",Pn.register(ls,"NodeConnector"),ls.prototype.destroy=function(){xl.prototype.destroy.call(this),null!==this.outputSocket&&(this.outputSocket.removeConnector(this),this.outputSocket=null),null!==this.inputSocket&&(this.inputSocket.removeConnector(this),this.inputSocket=null)},ls.prototype.onUpdate=function(){null!==this.outputSocket&&this.from.copy(this.outputSocket.position),null!==this.inputSocket&&this.to.copy(this.inputSocket.position),this.fromCp.copy(this.from),this.fromCp.add(this.to),this.fromCp.multiplyScalar(.5),this.toCp.copy(this.fromCp);var a=.5,r=this.to.y-this.from.y,h=this.to.x-this.from.x;Math.abs(h)>Math.abs(r)?(this.toCp.x+=h*a,this.fromCp.x-=h*a):(this.toCp.y+=r*a,this.fromCp.y-=r*a)},ls.prototype.serialize=function(a){var r=xl.prototype.serialize.call(this,a);return r.outputSocket=null!==this.outputSocket?this.outputSocket.uuid:null,r.inputSocket=null!==this.inputSocket?this.inputSocket.uuid:null,r},ls.prototype.parse=function(a,r){xl.prototype.parse.call(this,a,r),null!==a.outputSocket&&(this.outputSocket=r.getChildByUUID(a.outputSocket)),null!==a.inputSocket&&(this.inputSocket=r.getChildByUUID(a.inputSocket))},(Hi.prototype=Object.create(uo.prototype)).constructor=Hi,Hi.prototype.type="NodeSocket",Pn.register(Hi,"NodeSocket"),Hi.INPUT=1,Hi.OUTPUT=2,Hi.prototype.getValue=function(){return this.direction===Hi.INPUT&&this.connectors.length>0&&null!==this.connectors[0].outputSocket?this.connectors[0].outputSocket.getValue():null},Hi.prototype.connectTo=function(a){if(!this.isCompatible(a))throw new Error("Sockets are not compatible they cannot be connected.");var r=new ls;return this.attachConnector(r),a.attachConnector(r),r},Hi.prototype.attachConnector=function(a){this.canAddConnector()||this.destroyConnectors(),this.direction===Hi.INPUT?a.inputSocket=this:this.direction===Hi.OUTPUT&&(a.outputSocket=this),this.connectors.push(a),null===a.parent&&this.parent.add(a)},Hi.prototype.isCompatible=function(a){return this.direction!==a.direction&&this.category===a.category},Hi.prototype.canAddConnector=function(){return!(this.connectors.length>0&&(this.direction===Hi.INPUT||this.direction===Hi.OUTPUT&&!this.multiple))},Hi.prototype.canConnect=function(a){return this.isCompatible(a)&&this.canAddConnector()},Hi.prototype.removeConnector=function(a){var r=this.connectors.indexOf(a);-1!==r&&(this.connectors.splice(r,1),a.destroy())},Hi.prototype.destroyConnectors=function(){for(var a=0;a<this.connectors.length;a++)this.connectors[a].destroy()},Hi.prototype.destroy=function(){uo.prototype.destroy.call(this),this.destroyConnectors()},Hi.prototype.onPointerDragStart=function(a,r){this.creatingConnection=!0,this.attachConnector(new ls)},Hi.prototype.onPointerDrag=function(a,r,h,p){this.creatingConnection&&(this.direction===Hi.INPUT?this.connectors[this.connectors.length-1].from.copy(p):this.direction===Hi.OUTPUT&&this.connectors[this.connectors.length-1].to.copy(p))},Hi.prototype.onPointerDragEnd=function(a,r){if(this.creatingConnection){for(var h=r.inverseMatrix.transformPoint(a.position),p=this.parent.getWorldPointIntersections(h),y=!1,b=0;b<p.length;b++)if(p[b]instanceof Hi&&this.isCompatible(p[b])){p[b].attachConnector(this.connectors[this.connectors.length-1]),y=!0;break}y||this.connectors[this.connectors.length-1].destroy()}this.creatingConnection=!1},Hi.prototype.serialize=function(a){var r=uo.prototype.serialize.call(this,a);r.name=this.name,r.category=this.category,r.multiple=this.multiple,r.direction=this.direction,r.node=this.node.uuid,r.connectors=[];for(var h=0;h<this.connectors.length;h++)r.connectors.push(this.connectors[h].uuid);return r},Hi.prototype.parse=function(a,r){uo.prototype.parse.call(this,a,r),this.name=a.name,this.category=a.category,this.multiple=a.multiple,this.direction=a.direction,this.node=r.getChildByUUID(a.node);for(var h=0;h<a.connectors.length;h++)this.connectors.push(r.getChildByUUID(a.connectors[h]))},(ws.prototype=Object.create(Da.prototype)).constructor=ws,ws.prototype.type="Node",Pn.register(ws,"Node"),ws.prototype.registerSockets=null,ws.prototype.addInput=function(a,r){var h=new Hi(this,Hi.INPUT,a,r);return this.inputs.push(h),this.parent.add(h),h},ws.prototype.addOutput=function(a,r){var h=new Hi(this,Hi.OUTPUT,a,r);return this.outputs.push(h),this.parent.add(h),h},ws.prototype.getOutput=function(a){for(var r=0;r<this.outputs.length;r++)if(this.outputs[r].name===a)return this.outputs[r];return null},ws.prototype.getInput=function(a){for(var r=0;r<this.inputs.length;r++)if(this.inputs[r].name===a)return this.inputs[r];return null},ws.prototype.destroy=function(){Da.prototype.destroy.call(this);for(var a=0;a<this.inputs.length;a++)this.inputs[a].destroy();for(a=0;a<this.outputs.length;a++)this.outputs[a].destroy()},ws.prototype.onUpdate=function(){for(var a=this.box.max.y-this.box.min.y,r=a/(this.inputs.length+1),h=this.box.min.y+r,p=0;p<this.inputs.length;p++)this.inputs[p].position.set(this.position.x+this.box.min.x,this.position.y+(h+r*p));for(h=this.box.min.y+(r=a/(this.outputs.length+1)),p=0;p<this.outputs.length;p++)this.outputs[p].position.set(this.position.x+this.box.max.x,this.position.y+(h+r*p))},ws.prototype.serialize=function(a){var r=Da.prototype.serialize.call(this,a);r.inputs=[];for(var h=0;h<this.inputs.length;h++)r.inputs.push(this.inputs[h].uuid);for(r.outputs=[],h=0;h<this.outputs.length;h++)r.outputs.push(this.outputs[h].uuid);return r},ws.prototype.parse=function(a,r){Da.prototype.parse.call(this,a,r);for(var h=0;h<a.inputs.length;h++)this.inputs.push(r.getChildByUUID(a.inputs[h]));for(h=0;h<a.outputs.length;h++)this.outputs.push(r.getChildByUUID(a.outputs[h]))},Xd.rotateTool=function(a){var r=new uo;r.radius=4,r.layer=a.layer+1,r.onPointerDrag=function(h,p,y){a.rotation+=.001*y.x},a.add(r)},Xd.boxResizeTool=function(a){if(void 0!==a.box){var r=new uo;r.radius=4,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(N,O,T){Pn.prototype.onPointerDrag.call(this,N,O,T),a.box.min.copy(r.position),b()},a.add(r);var h=new uo;h.radius=4,h.layer=a.layer+1,h.draggable=!0,h.onPointerDrag=function(N,O,T){Pn.prototype.onPointerDrag.call(this,N,O,T),a.box.max.x=h.position.x,a.box.min.y=h.position.y,b()},a.add(h);var p=new uo;p.radius=4,p.layer=a.layer+1,p.draggable=!0,p.onPointerDrag=function(N,O,T){Pn.prototype.onPointerDrag.call(this,N,O,T),a.box.max.copy(p.position),b()},a.add(p);var y=new uo;y.radius=4,y.layer=a.layer+1,y.draggable=!0,y.onPointerDrag=function(N,O,T){Pn.prototype.onPointerDrag.call(this,N,O,T),a.box.min.x=y.position.x,a.box.max.y=y.position.y,b()},a.add(y),b()}else console.warn("escher.js: Helpers.boxResizeTool(), object box property missing.");function b(){r.position.copy(a.box.min),p.position.copy(a.box.max),h.position.set(a.box.max.x,a.box.min.y),y.position.set(a.box.min.x,a.box.max.y)}},Yd.read=function(a,r,h){var p=new XMLHttpRequest;p.overrideMimeType("text/plain"),p.open("GET",a,!0),void 0!==r&&(p.onload=function(){r(p.response)}),void 0!==h&&(p.onerror=h),p.send(null)},Yd.write=function(a,r){var h=new Blob([r],{type:"octet/stream"}),p=document.createElement("a");p.download=a,p.href=window.URL.createObjectURL(h),p.style.display="none",p.onclick=function(){document.body.removeChild(this)},document.body.appendChild(p),p.click()},Yd.select=function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",document.body.appendChild(h),void 0!==r&&(h.accept=r),h.onchange=function(p){void 0!==a&&a(h.files),document.body.removeChild(h)},h.click()},(Ti.prototype=Object.create(l.Group.prototype)).addNode=function(a){this.graph.addNode(a)},Ti.prototype.initialize=function(){l.Object3D.prototype.initialize.call(this)},Ti.prototype.update=function(a){l.Object3D.prototype.update.call(this,a)},Ti.prototype.dispose=function(){l.Object3D.prototype.dispose.call(this)},Ti.prototype.resize=function(a,r){},Ti.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.graph=this.graph.serialize(),r},Ss.prototype.createWorkers=function(){for(var a=0;a<this.workers.length;a++)this.workers[a].terminate();var r=this;function h(y){var b=y.data.uuid;if(void 0===r.tasks[b])throw new Error("Unknown worker task "+b);r.tasks[b].callback(y.data.data),delete r.tasks[b]}for(this.workers=[],this.next=0,a=0;a<this.size;a++){var p=new Worker(this.file);p.onmessage=h,this.workers.push(p)}},Ss.prototype.runTask=function(a,r){var h=new dc(a,r);this.tasks[h.uuid]=h,this.workers[this.next].postMessage({data:h.data,uuid:h.uuid}),this.next++,this.next>=this.workers.length&&(this.next=0)},ed.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=setTimeout(r,a.time))}()}},ed.prototype.stop=function(){this.running=!1,clearTimeout(self.id)},td.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},td.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},Ua.set=function(a,r){"object"==typeof r?window.localStorage.setItem(a,JSON.stringify(r)):window.localStorage.setItem(a,r)},Ua.get=function(a){var r=window.localStorage.getItem(a);try{return JSON.parse(r)}catch{return r}},Ua.exists=function(a){return null!==window.localStorage.getItem(a)},Ua.delete=function(a){return window.localStorage.removeItem(a)},pu.getRoot=function(a){for(var r=a;null!==r.parent;)r=r.parent;return r},pu.centerUnitary=function(a){var r=pu.calculateBoundingBox(a);if(null!==r){var h=new l.Vector3;r.getSize(h);var p=1/(h.x>h.y?h.x>h.z?h.x:h.z:h.y>h.z?h.y:h.z),y=new l.Vector3;r.getCenter(y),y.multiplyScalar(p),a.scale.set(p,p,p),a.position.set(-y.x,-p*r.min.y,-y.z)}},pu.calculateBoundingBox=function(a){var r=null;return a.traverse(function(h){var p=null;if(!0===h.isSprite){var y=new l.Vector3;h.getWorldPosition(y),p=new l.Box3(y.clone().subScalar(.5),y.clone().addScalar(.5))}else void 0!==h.geometry&&(h.geometry.computeBoundingBox(),(p=h.geometry.boundingBox.clone()).applyMatrix4(h.matrixWorld),h.geometry.computeBoundingBox(),p=h.geometry.boundingBox);null!==p&&(null===r?r=p:(p.min.x<r.min.x&&(r.min.x=p.min.x),p.max.x>r.max.x&&(r.max.x=p.max.x),p.min.y<r.min.y&&(r.min.y=p.min.y),p.max.y>r.max.y&&(r.max.y=p.max.y),p.min.z<r.min.z&&(r.min.z=p.min.z),p.max.z>r.max.z&&(r.max.z=p.max.z)))}),r},pu.centerGeometryOrigin=function(a){a.traverse(function(r){if(void 0!==r.geometry){r.geometry.computeBoundingBox();var h=r.geometry.boundingBox.clone().getCenter(new l.Vector3);r.position.add(h);var p=new l.Matrix4;p.makeTranslation(-h.x,-h.y,-h.z),r.geometry.applyMatrix4(p)}})},pu.convertToBufferGeometry=function(a){a.traverse(function(r){void 0!==r.geometry&&!0===r.geometry.isGeometry&&(r.geometry=(new l.BufferGeometry).fromGeometry(r.geometry))})};var sp=function(){var a,r,h,p,y=0,b=new l.Vector3;function N(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new ee,this.unassigned=new ee,this.vertices=[]}function O(){this.normal=new l.Vector3,this.midpoint=new l.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=y,this.edge=null}function T(oe,ne){this.vertex=oe,this.prev=null,this.next=null,this.twin=null,this.face=ne}function z(oe){this.point=oe,this.prev=null,this.next=null,this.face=null}function ee(){this.head=null,this.tail=null}return Object.assign(N.prototype,{setFromPoints:function(oe){!0!==Array.isArray(oe)&&console.error("THREE.ConvexHull: Points parameter is not an array."),oe.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var ne=0,ve=oe.length;ne<ve;ne++)this.vertices.push(new z(oe[ne]));return this.compute(),this},setFromObject:function(oe){var ne=[];return oe.updateMatrixWorld(!0),oe.traverse(function(ve){var xe,Te,Ce,Ie=ve.geometry;if(void 0!==Ie)if(Ie.isGeometry){var Oe=Ie.vertices;for(xe=0,Te=Oe.length;xe<Te;xe++)(Ce=Oe[xe].clone()).applyMatrix4(ve.matrixWorld),ne.push(Ce)}else if(Ie.isBufferGeometry){var Fe=Ie.attributes.position;if(void 0!==Fe)for(xe=0,Te=Fe.count;xe<Te;xe++)(Ce=new l.Vector3).fromBufferAttribute(Fe,xe).applyMatrix4(ve.matrixWorld),ne.push(Ce)}}),this.setFromPoints(ne)},containsPoint:function(oe){for(var ne=this.faces,ve=0,xe=ne.length;ve<xe;ve++)if(ne[ve].distanceToPoint(oe)>this.tolerance)return!1;return!0},intersectRay:function(oe,ne){for(var ve=this.faces,xe=-1/0,Te=1/0,Ce=0,Ie=ve.length;Ce<Ie;Ce++){var Oe=ve[Ce],Fe=Oe.distanceToPoint(oe.origin),je=Oe.normal.dot(oe.direction);if(Fe>0&&je>=0)return null;var Ue=0!==je?-Fe/je:0;if(!(Ue<=0)&&(je>0?Te=Math.min(Ue,Te):xe=Math.max(Ue,xe),xe>Te))return null}return oe.at(xe!==-1/0?xe:Te,ne),ne},intersectsRay:function(oe){return null!==this.intersectRay(oe,b)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(oe,ne){return oe.face=ne,null===ne.outside?this.assigned.append(oe):this.assigned.insertBefore(ne.outside,oe),ne.outside=oe,this},removeVertexFromFace:function(oe,ne){return oe===ne.outside&&(ne.outside=null!==oe.next&&oe.next.face===ne?oe.next:null),this.assigned.remove(oe),this},removeAllVerticesFromFace:function(oe){if(null!==oe.outside){for(var ne=oe.outside,ve=oe.outside;null!==ve.next&&ve.next.face===oe;)ve=ve.next;return this.assigned.removeSubList(ne,ve),ne.prev=ve.next=null,oe.outside=null,ne}},deleteFaceVertices:function(oe,ne){var ve=this.removeAllVerticesFromFace(oe);if(void 0!==ve)if(void 0===ne)this.unassigned.appendChain(ve);else{var xe=ve;do{var Te=xe.next;ne.distanceToPoint(xe.point)>this.tolerance?this.addVertexToFace(xe,ne):this.unassigned.append(xe),xe=Te}while(null!==xe)}return this},resolveUnassignedPoints:function(oe){if(!1===this.unassigned.isEmpty()){var ne=this.unassigned.first();do{for(var ve=ne.next,xe=this.tolerance,Te=null,Ce=0;Ce<oe.length;Ce++){var Ie=oe[Ce];if(Ie.mark===y){var Oe=Ie.distanceToPoint(ne.point);if(Oe>xe&&(xe=Oe,Te=Ie),xe>1e3*this.tolerance)break}}null!==Te&&this.addVertexToFace(ne,Te),ne=ve}while(null!==ne)}return this},computeExtremes:function(){var oe,ne,ve,xe=new l.Vector3,Te=new l.Vector3,Ce=[],Ie=[];for(oe=0;oe<3;oe++)Ce[oe]=Ie[oe]=this.vertices[0];for(xe.copy(this.vertices[0].point),Te.copy(this.vertices[0].point),oe=0,ne=this.vertices.length;oe<ne;oe++){var Oe=this.vertices[oe],Fe=Oe.point;for(ve=0;ve<3;ve++)Fe.getComponent(ve)<xe.getComponent(ve)&&(xe.setComponent(ve,Fe.getComponent(ve)),Ce[ve]=Oe);for(ve=0;ve<3;ve++)Fe.getComponent(ve)>Te.getComponent(ve)&&(Te.setComponent(ve,Fe.getComponent(ve)),Ie[ve]=Oe)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(xe.x),Math.abs(Te.x))+Math.max(Math.abs(xe.y),Math.abs(Te.y))+Math.max(Math.abs(xe.z),Math.abs(Te.z))),{min:Ce,max:Ie}},computeInitialHull:function(){void 0===a&&(a=new l.Line3,r=new l.Plane,h=new l.Vector3);var oe,ne,ve,xe,Te,Ce,Ie,Oe,Fe,je=this.vertices,Ue=this.computeExtremes(),Ye=Ue.min,at=Ue.max,pt=0,St=0;for(Ce=0;Ce<3;Ce++)(Fe=at[Ce].point.getComponent(Ce)-Ye[Ce].point.getComponent(Ce))>pt&&(pt=Fe,St=Ce);for(pt=0,a.set((ne=Ye[St]).point,(ve=at[St]).point),Ce=0,Ie=this.vertices.length;Ce<Ie;Ce++)(oe=je[Ce])!==ne&&oe!==ve&&(a.closestPointToPoint(oe.point,!0,h),(Fe=h.distanceToSquared(oe.point))>pt&&(pt=Fe,xe=oe));for(pt=-1,r.setFromCoplanarPoints(ne.point,ve.point,xe.point),Ce=0,Ie=this.vertices.length;Ce<Ie;Ce++)(oe=je[Ce])!==ne&&oe!==ve&&oe!==xe&&(Fe=Math.abs(r.distanceToPoint(oe.point)))>pt&&(pt=Fe,Te=oe);var At=[];if(r.distanceToPoint(Te.point)<0)for(At.push(O.create(ne,ve,xe),O.create(Te,ve,ne),O.create(Te,xe,ve),O.create(Te,ne,xe)),Ce=0;Ce<3;Ce++)Oe=(Ce+1)%3,At[Ce+1].getEdge(2).setTwin(At[0].getEdge(Oe)),At[Ce+1].getEdge(1).setTwin(At[Oe+1].getEdge(0));else for(At.push(O.create(ne,xe,ve),O.create(Te,ne,ve),O.create(Te,ve,xe),O.create(Te,xe,ne)),Ce=0;Ce<3;Ce++)Oe=(Ce+1)%3,At[Ce+1].getEdge(2).setTwin(At[0].getEdge((3-Ce)%3)),At[Ce+1].getEdge(0).setTwin(At[Oe+1].getEdge(1));for(Ce=0;Ce<4;Ce++)this.faces.push(At[Ce]);for(Ce=0,Ie=je.length;Ce<Ie;Ce++)if((oe=je[Ce])!==ne&&oe!==ve&&oe!==xe&&oe!==Te){pt=this.tolerance;var Jt=null;for(Oe=0;Oe<4;Oe++)(Fe=this.faces[Oe].distanceToPoint(oe.point))>pt&&(pt=Fe,Jt=this.faces[Oe]);null!==Jt&&this.addVertexToFace(oe,Jt)}return this},reindexFaces:function(){for(var oe=[],ne=0;ne<this.faces.length;ne++){var ve=this.faces[ne];ve.mark===y&&oe.push(ve)}return this.faces=oe,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var oe,ne=0,ve=this.assigned.first().face,xe=ve.outside;do{var Te=ve.distanceToPoint(xe.point);Te>ne&&(ne=Te,oe=xe),xe=xe.next}while(null!==xe&&xe.face===ve);return oe}},computeHorizon:function(oe,ne,ve,xe){var Te;this.deleteFaceVertices(ve),ve.mark=1,Te=null===ne?ne=ve.getEdge(0):ne.next;do{var Ce=Te.twin,Ie=Ce.face;Ie.mark===y&&(Ie.distanceToPoint(oe)>this.tolerance?this.computeHorizon(oe,Ce,Ie,xe):xe.push(Te)),Te=Te.next}while(Te!==ne);return this},addAdjoiningFace:function(oe,ne){var ve=O.create(oe,ne.tail(),ne.head());return this.faces.push(ve),ve.getEdge(-1).setTwin(ne.twin),ve.getEdge(0)},addNewFaces:function(oe,ne){this.newFaces=[];for(var ve=null,xe=null,Te=0;Te<ne.length;Te++){var Ie=this.addAdjoiningFace(oe,ne[Te]);null===ve?ve=Ie:Ie.next.setTwin(xe),this.newFaces.push(Ie.face),xe=Ie}return ve.next.setTwin(xe),this},addVertexToHull:function(oe){var ne=[];return this.unassigned.clear(),this.removeVertexFromFace(oe,oe.face),this.computeHorizon(oe.point,null,oe.face,ne),this.addNewFaces(oe,ne),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var oe;for(this.computeInitialHull();void 0!==(oe=this.nextVertexToAdd());)this.addVertexToHull(oe);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(O,{create:function(oe,ne,ve){var xe=new O,Te=new T(oe,xe),Ce=new T(ne,xe),Ie=new T(ve,xe);return Te.next=Ie.prev=Ce,Ce.next=Te.prev=Ie,Ie.next=Ce.prev=Te,xe.edge=Te,xe.compute()}}),Object.assign(O.prototype,{getEdge:function(oe){for(var ne=this.edge;oe>0;)ne=ne.next,oe--;for(;oe<0;)ne=ne.prev,oe++;return ne},compute:function(){void 0===p&&(p=new l.Triangle);var oe=this.edge.tail(),ne=this.edge.head(),ve=this.edge.next.head();return p.set(oe.point,ne.point,ve.point),p.getNormal(this.normal),p.getMidpoint(this.midpoint),this.area=p.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(oe){return this.normal.dot(oe)-this.constant}}),Object.assign(T.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var oe=this.head(),ne=this.tail();return null!==ne?ne.point.distanceTo(oe.point):-1},lengthSquared:function(){var oe=this.head(),ne=this.tail();return null!==ne?ne.point.distanceToSquared(oe.point):-1},setTwin:function(oe){return this.twin=oe,oe.twin=this,this}}),Object.assign(ee.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(oe,ne){return ne.prev=oe.prev,ne.next=oe,null===ne.prev?this.head=ne:ne.prev.next=ne,oe.prev=ne,this},insertAfter:function(oe,ne){return ne.prev=oe,ne.next=oe.next,null===ne.next?this.tail=ne:ne.next.prev=ne,oe.next=ne,this},append:function(oe){return null===this.head?this.head=oe:this.tail.next=oe,oe.prev=this.tail,oe.next=null,this.tail=oe,this},appendChain:function(oe){for(null===this.head?this.head=oe:this.tail.next=oe,oe.prev=this.tail;null!==oe.next;)oe=oe.next;return this.tail=oe,this},remove:function(oe){return null===oe.prev?this.head=oe.next:oe.prev.next=oe.next,null===oe.next?this.tail=oe.prev:oe.next.prev=oe.prev,this},removeSubList:function(oe,ne){return null===oe.prev?this.head=ne.next:oe.prev.next=ne.next,null===ne.next?this.tail=oe.prev:ne.next.prev=oe.prev,this},isEmpty:function(){return null===this.head}}),N}();function vi(){}function xr(){}vi.Type={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron"},vi.createShape=function(a,r){if(void 0!==r)return r===vi.Type.BOX?vi.createBoundingBoxShape(a):r===vi.Type.CYLINDER?vi.createBoundingCylinderShape(a):r===vi.Type.SPHERE?vi.createBoundingSphereShape(a):r===vi.Type.HULL?vi.createConvexPolyhedron(a):null;var h=vi.getGeometry(a);if(!h)return null;switch(h.type){case"BoxGeometry":case"BoxBufferGeometry":default:return vi.createBoxShape(h);case"CylinderGeometry":case"CylinderBufferGeometry":return vi.createCylinderShape(h);case"PlaneGeometry":case"PlaneBufferGeometry":return vi.createPlaneShape(h);case"SphereGeometry":case"SphereBufferGeometry":return vi.createSphereShape(h);case"TubeGeometry":return vi.createTubeShape(h);case"Geometry":case"BufferGeometry":return vi.createConvexPolyhedron(a)}},vi.createBoxShape=function(a){if(!vi.getVertices(a).length)return null;a.computeBoundingBox();var r=a.boundingBox;return new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},vi.createBoundingBoxShape=function(a){var r=new Box3;if(r.setFromObject(a),!isFinite(r.min.lengthSq()))return null;var h=new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2));return a.updateMatrixWorld(),(new l.Vector3).setFromMatrixPosition(a.matrixWorld),h},vi.createConvexPolyhedron=function(a){var r=new sp;r.setFromObject(a);for(var h=[],p=[],y=[],b=0;b<r.faces.length;b++){var N=r.faces[b],O=N.edge;do{var T=O.head().point;h.push(new M(T.x,T.y,T.z)),O=O.next}while(O!==N.edge);p.push([h.length-3,h.length-2,h.length-1]),y.push(new M(N.normal.x,N.normal.y,N.normal.z))}return new Q(h,p,y)},vi.createCylinderShape=function(a){var r=a.parameters,h=new Xt(r.radiusTop,r.radiusBottom,r.height,r.radialSegments);return h.orientation=new Z,h.orientation.setFromEuler(0,0,0,"XYZ").normalize(),h},vi.createBoundingCylinderShape=function(a){var r=["x","y","z"],h=r.splice(r.indexOf("y"),1)&&r,p=vi.getGeometry(a);p.computeBoundingBox(),p.computeBoundingSphere();var y=p.boundingBox.max.y-p.boundingBox.min.y,b=.5*Math.max(p.boundingBox.max[h[0]]-p.boundingBox.min[h[0]],p.boundingBox.max[h[1]]-p.boundingBox.min[h[1]]),N=new Xt(b,b,y,12);return N.orientation=new Z,N.orientation.setFromEuler(Math.PI/2,0,0,"XYZ").normalize(),N},vi.createPlaneShape=function(a){a.computeBoundingBox();var r=a.boundingBox;return new Ge(new M((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},vi.createSphereShape=function(a){return new xc(a.parameters.radius)},vi.createBoundingSphereShape=function(a){var r=vi.getGeometry(a);return r.computeBoundingSphere(),new xc(r.boundingSphere.radius)},vi.createTubeShape=function(a){var r=new l.BufferGeometry;return r.fromGeometry(a),createTrimeshShape(r)},vi.createTrimeshShape=function(a){var r=vi.getVertices(a);if(!r||0===r.length)return null;var h=Object.keys(r).map(Number);return new pl(r,h)},vi.getGeometry=function(a){var r=vi.getMeshes(a);if(0===r.length)return null;var h=new l.Geometry;if(1===r.length){var p=new l.Vector3,y=new l.Quaternion,b=new l.Vector3(1,1,1);return h=r[0].geometry.clone(),r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(p,y,b),h.scale(b.x,b.y,b.z)}for(var N=new l.Geometry,O=r.pop();void 0!==O;)O.updateMatrixWorld(),O.geometry instanceof l.BufferGeometry?(h.fromBufferGeometry(O.geometry),N.merge(h,O.matrixWorld)):N.merge(O.geometry,O.matrixWorld),O=r.pop();var T=new l.Matrix4;return T.scale(a.scale),N.applyMatrix4(T),N},vi.getVertices=function(a){return a instanceof l.Geometry&&(a=(new l.BufferGeometry).fromGeometry(a)),a.attributes.position.array},vi.getMeshes=function(a){var r=[];return a.traverse(function(h){h instanceof l.Mesh&&r.push(h)}),r},xr.scales=new Map([["Y",1e24],["Z",1e21],["E",1e18],["P",1e15],["T",1e12],["G",1e9],["M",1e6],["k",1e3],["m",.001],["u",1e-6],["n",1e-9],["p",1e-12],["f",1e-15],["a",1e-18],["z",1e-21],["y",1e-24]]),xr.units=new Map([["m",new Map([["i",function(a){return a/39.3701}]])],["i",new Map([["m",function(a){return 39.3701*a}]])],["g",null],["s",null],["c",new Map([["k",function(a){return a-273.15}],["f",function(a){return(a-32)/1.8}]])],["k",new Map([["c",function(a){return a+273.15}],["f",function(a){return(a-32)/1.8+273.15}]])],["f",new Map([["c",function(a){return 1.8*a+32}],["k",function(a){return 1.8*a-459.67}]])],["d",new Map([["r",function(a){return a*(180/Math.PI)}]])],["r",new Map([["d",function(a){return a/(180/Math.PI)}]])]]),xr.convert=function(a,r,h){r.length>1&&(a*=xr.scales.get(r.charAt(0)),r=r.slice(1));var p=1;return h.length>1&&(p=xr.scales.get(h.charAt(0)),h=h.slice(1)),r===h?a/p:xr.units.get(h).get(r)(a)/p}})(),__webpack_exports__})()),function(n,o){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?o(n,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return o(l)}:o(n)}(typeof window<"u"?window:this,function(n,o){"use strict";var l=[],x=Object.getPrototypeOf,B=l.slice,D=l.flat?function(q){return l.flat.call(q)}:function(q){return l.concat.apply([],q)},G=l.push,M=l.indexOf,P={},de=P.toString,ye=P.hasOwnProperty,ie=ye.toString,ce=ie.call(Object),fe={},ae=function(pe){return"function"==typeof pe&&"number"!=typeof pe.nodeType},W=function(pe){return null!=pe&&pe===pe.window},Z=n.document,A={type:!0,src:!0,nonce:!0,noModule:!0};function R(q,pe,Me){var Be,Ve,qe=(Me=Me||Z).createElement("script");if(qe.text=q,pe)for(Be in A)(Ve=pe[Be]||pe.getAttribute&&pe.getAttribute(Be))&&qe.setAttribute(Be,Ve);Me.head.appendChild(qe).parentNode.removeChild(qe)}function X(q){return null==q?q+"":"object"==typeof q||"function"==typeof q?P[de.call(q)]||"object":typeof q}var U=function(q,pe){return new U.fn.init(q,pe)};function Re(q){var pe=!!q&&"length"in q&&q.length,Me=X(q);return!ae(q)&&!W(q)&&("array"===Me||0===pe||"number"==typeof pe&&pe>0&&pe-1 in q)}U.fn=U.prototype={jquery:"3.5.1",constructor:U,length:0,toArray:function(){return B.call(this)},get:function(q){return null==q?B.call(this):q<0?this[q+this.length]:this[q]},pushStack:function(q){var pe=U.merge(this.constructor(),q);return pe.prevObject=this,pe},each:function(q){return U.each(this,q)},map:function(q){return this.pushStack(U.map(this,function(pe,Me){return q.call(pe,Me,pe)}))},slice:function(){return this.pushStack(B.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(U.grep(this,function(q,pe){return(pe+1)%2}))},odd:function(){return this.pushStack(U.grep(this,function(q,pe){return pe%2}))},eq:function(q){var pe=this.length,Me=+q+(q<0?pe:0);return this.pushStack(Me>=0&&Me<pe?[this[Me]]:[])},end:function(){return this.prevObject||this.constructor()},push:G,sort:l.sort,splice:l.splice},U.extend=U.fn.extend=function(){var q,pe,Me,Be,Ve,qe,et=arguments[0]||{},Mt=1,Bt=arguments.length,Xt=!1;for("boolean"==typeof et&&(Xt=et,et=arguments[Mt]||{},Mt++),"object"!=typeof et&&!ae(et)&&(et={}),Mt===Bt&&(et=this,Mt--);Mt<Bt;Mt++)if(null!=(q=arguments[Mt]))for(pe in q)Be=q[pe],"__proto__"!==pe&&et!==Be&&(Xt&&Be&&(U.isPlainObject(Be)||(Ve=Array.isArray(Be)))?(Me=et[pe],qe=Ve&&!Array.isArray(Me)?[]:Ve||U.isPlainObject(Me)?Me:{},Ve=!1,et[pe]=U.extend(Xt,qe,Be)):void 0!==Be&&(et[pe]=Be));return et},U.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(q){throw new Error(q)},noop:function(){},isPlainObject:function(q){var pe,Me;return!(!q||"[object Object]"!==de.call(q)||(pe=x(q))&&("function"!=typeof(Me=ye.call(pe,"constructor")&&pe.constructor)||ie.call(Me)!==ce))},isEmptyObject:function(q){var pe;for(pe in q)return!1;return!0},globalEval:function(q,pe,Me){R(q,{nonce:pe&&pe.nonce},Me)},each:function(q,pe){var Me,Be=0;if(Re(q))for(Me=q.length;Be<Me&&!1!==pe.call(q[Be],Be,q[Be]);Be++);else for(Be in q)if(!1===pe.call(q[Be],Be,q[Be]))break;return q},makeArray:function(q,pe){var Me=pe||[];return null!=q&&(Re(Object(q))?U.merge(Me,"string"==typeof q?[q]:q):G.call(Me,q)),Me},inArray:function(q,pe,Me){return null==pe?-1:M.call(pe,q,Me)},merge:function(q,pe){for(var Me=+pe.length,Be=0,Ve=q.length;Be<Me;Be++)q[Ve++]=pe[Be];return q.length=Ve,q},grep:function(q,pe,Me){for(var Ve=[],qe=0,et=q.length,Mt=!Me;qe<et;qe++)!pe(q[qe],qe)!==Mt&&Ve.push(q[qe]);return Ve},map:function(q,pe,Me){var Be,Ve,qe=0,et=[];if(Re(q))for(Be=q.length;qe<Be;qe++)null!=(Ve=pe(q[qe],qe,Me))&&et.push(Ve);else for(qe in q)null!=(Ve=pe(q[qe],qe,Me))&&et.push(Ve);return D(et)},guid:1,support:fe}),"function"==typeof Symbol&&(U.fn[Symbol.iterator]=l[Symbol.iterator]),U.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(q,pe){P["[object "+pe+"]"]=pe.toLowerCase()});var Q=
/*!
     * Sizzle CSS Selector Engine v2.3.5
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2020-03-14
     */function(q){var pe,Me,Be,Ve,qe,et,Mt,Bt,Xt,pn,Fn,on,Sn,Er,ti,Ar,ds,es,ha,bi="sizzle"+1*new Date,Br=q.document,Xa=0,Wi=0,qi=Ya(),qh=Ya(),wc=Ya(),pa=Ya(),pl=function(it,xt){return it===xt&&(Fn=!0),0},da={}.hasOwnProperty,Ri=[],ks=Ri.pop,er=Ri.push,En=Ri.push,Ho=Ri.slice,ss=function(it,xt){for(var Ut=0,bn=it.length;Ut<bn;Ut++)if(it[Ut]===xt)return Ut;return-1},Zi="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Hr="[\\x20\\t\\r\\n\\f]",di="(?:\\\\[\\da-fA-F]{1,6}"+Hr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",xi="\\["+Hr+"*("+di+")(?:"+Hr+"*([*^$|!~]?=)"+Hr+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+di+"))|)"+Hr+"*\\]",Fs=":("+di+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+xi+")*)|.*)\\)|)",Xh=new RegExp(Hr+"+","g"),vo=new RegExp("^"+Hr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Hr+"+$","g"),yu=new RegExp("^"+Hr+"*,"+Hr+"*"),zn=new RegExp("^"+Hr+"*([>+~]|"+Hr+")"+Hr+"*"),lt=new RegExp(Hr+"|>"),$l=new RegExp(Fs),Ms=new RegExp("^"+di+"$"),Tp={ID:new RegExp("^#("+di+")"),CLASS:new RegExp("^\\.("+di+")"),TAG:new RegExp("^("+di+"|[*])"),ATTR:new RegExp("^"+xi),PSEUDO:new RegExp("^"+Fs),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Hr+"*(even|odd|(([+-]|)(\\d*)n|)"+Hr+"*(?:([+-]|)"+Hr+"*(\\d+)|))"+Hr+"*\\)|)","i"),bool:new RegExp("^(?:"+Zi+")$","i"),needsContext:new RegExp("^"+Hr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Hr+"*((?:-\\d)?\\d*)"+Hr+"*\\)|)(?=[^-]|$)","i")},As=/HTML$/i,Sc=/^(?:input|select|textarea|button)$/i,Di=/^h\d$/i,ro=/^[^{]+\{\s*\[native \w/,ri=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Jc=/[+~]/,$i=new RegExp("\\\\[\\da-fA-F]{1,6}"+Hr+"?|\\\\([^\\r\\n\\f])","g"),ht=function(it,xt){var Ut="0x"+it.slice(1)-65536;return xt||(Ut<0?String.fromCharCode(Ut+65536):String.fromCharCode(Ut>>10|55296,1023&Ut|56320))},bu=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Mp=function(it,xt){return xt?"\0"===it?"\ufffd":it.slice(0,-1)+"\\"+it.charCodeAt(it.length-1).toString(16)+" ":"\\"+it},Ui=function(){on()},Or=Ca(function(it){return!0===it.disabled&&"fieldset"===it.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{En.apply(Ri=Ho.call(Br.childNodes),Br.childNodes)}catch{En={apply:Ri.length?function(xt,Ut){er.apply(xt,Ho.call(Ut))}:function(xt,Ut){for(var bn=xt.length,qt=0;xt[bn++]=Ut[qt++];);xt.length=bn-1}}}function qr(it,xt,Ut,bn){var qt,fn,tn,qn,jn,Sr,$r,yr=xt&&xt.ownerDocument,Xr=xt?xt.nodeType:9;if(Ut=Ut||[],"string"!=typeof it||!it||1!==Xr&&9!==Xr&&11!==Xr)return Ut;if(!bn&&(on(xt),xt=xt||Sn,ti)){if(11!==Xr&&(jn=ri.exec(it)))if(qt=jn[1]){if(9===Xr){if(!(tn=xt.getElementById(qt)))return Ut;if(tn.id===qt)return Ut.push(tn),Ut}else if(yr&&(tn=yr.getElementById(qt))&&ha(xt,tn)&&tn.id===qt)return Ut.push(tn),Ut}else{if(jn[2])return En.apply(Ut,xt.getElementsByTagName(it)),Ut;if((qt=jn[3])&&Me.getElementsByClassName&&xt.getElementsByClassName)return En.apply(Ut,xt.getElementsByClassName(qt)),Ut}if(Me.qsa&&!pa[it+" "]&&(!Ar||!Ar.test(it))&&(1!==Xr||"object"!==xt.nodeName.toLowerCase())){if($r=it,yr=xt,1===Xr&&(lt.test(it)||zn.test(it))){for(((yr=Jc.test(it)&&Qn(xt.parentNode)||xt)!==xt||!Me.scope)&&((qn=xt.getAttribute("id"))?qn=qn.replace(bu,Mp):xt.setAttribute("id",qn=bi)),fn=(Sr=et(it)).length;fn--;)Sr[fn]=(qn?"#"+qn:":scope")+" "+Ja(Sr[fn]);$r=Sr.join(",")}try{return En.apply(Ut,yr.querySelectorAll($r)),Ut}catch{pa(it,!0)}finally{qn===bi&&xt.removeAttribute("id")}}}return Bt(it.replace(vo,"$1"),xt,Ut,bn)}function Ya(){var it=[];return function xt(Ut,bn){return it.push(Ut+" ")>Be.cacheLength&&delete xt[it.shift()],xt[Ut+" "]=bn}}function yo(it){return it[bi]=!0,it}function fa(it){var xt=Sn.createElement("fieldset");try{return!!it(xt)}catch{return!1}finally{xt.parentNode&&xt.parentNode.removeChild(xt),xt=null}}function xu(it,xt){for(var Ut=it.split("|"),bn=Ut.length;bn--;)Be.attrHandle[Ut[bn]]=xt}function Ec(it,xt){var Ut=xt&&it,bn=Ut&&1===it.nodeType&&1===xt.nodeType&&it.sourceIndex-xt.sourceIndex;if(bn)return bn;if(Ut)for(;Ut=Ut.nextSibling;)if(Ut===xt)return-1;return it?1:-1}function Zc(it){return function(xt){return"input"===xt.nodeName.toLowerCase()&&xt.type===it}}function wu(it){return function(xt){var Ut=xt.nodeName.toLowerCase();return("input"===Ut||"button"===Ut)&&xt.type===it}}function Sh(it){return function(xt){return"form"in xt?xt.parentNode&&!1===xt.disabled?"label"in xt?"label"in xt.parentNode?xt.parentNode.disabled===it:xt.disabled===it:xt.isDisabled===it||xt.isDisabled!==!it&&Or(xt)===it:xt.disabled===it:"label"in xt&&xt.disabled===it}}function Tc(it){return yo(function(xt){return xt=+xt,yo(function(Ut,bn){for(var qt,fn=it([],Ut.length,xt),tn=fn.length;tn--;)Ut[qt=fn[tn]]&&(Ut[qt]=!(bn[qt]=Ut[qt]))})})}function Qn(it){return it&&typeof it.getElementsByTagName<"u"&&it}for(pe in Me=qr.support={},qe=qr.isXML=function(it){var Ut=(it.ownerDocument||it).documentElement;return!As.test(it.namespaceURI||Ut&&Ut.nodeName||"HTML")},on=qr.setDocument=function(it){var xt,Ut,bn=it?it.ownerDocument||it:Br;return bn==Sn||9!==bn.nodeType||!bn.documentElement||(Er=(Sn=bn).documentElement,ti=!qe(Sn),Br!=Sn&&(Ut=Sn.defaultView)&&Ut.top!==Ut&&(Ut.addEventListener?Ut.addEventListener("unload",Ui,!1):Ut.attachEvent&&Ut.attachEvent("onunload",Ui)),Me.scope=fa(function(qt){return Er.appendChild(qt).appendChild(Sn.createElement("div")),typeof qt.querySelectorAll<"u"&&!qt.querySelectorAll(":scope fieldset div").length}),Me.attributes=fa(function(qt){return qt.className="i",!qt.getAttribute("className")}),Me.getElementsByTagName=fa(function(qt){return qt.appendChild(Sn.createComment("")),!qt.getElementsByTagName("*").length}),Me.getElementsByClassName=ro.test(Sn.getElementsByClassName),Me.getById=fa(function(qt){return Er.appendChild(qt).id=bi,!Sn.getElementsByName||!Sn.getElementsByName(bi).length}),Me.getById?(Be.filter.ID=function(qt){var fn=qt.replace($i,ht);return function(tn){return tn.getAttribute("id")===fn}},Be.find.ID=function(qt,fn){if(typeof fn.getElementById<"u"&&ti){var tn=fn.getElementById(qt);return tn?[tn]:[]}}):(Be.filter.ID=function(qt){var fn=qt.replace($i,ht);return function(tn){var qn=typeof tn.getAttributeNode<"u"&&tn.getAttributeNode("id");return qn&&qn.value===fn}},Be.find.ID=function(qt,fn){if(typeof fn.getElementById<"u"&&ti){var tn,qn,jn,Sr=fn.getElementById(qt);if(Sr){if((tn=Sr.getAttributeNode("id"))&&tn.value===qt)return[Sr];for(jn=fn.getElementsByName(qt),qn=0;Sr=jn[qn++];)if((tn=Sr.getAttributeNode("id"))&&tn.value===qt)return[Sr]}return[]}}),Be.find.TAG=Me.getElementsByTagName?function(qt,fn){return typeof fn.getElementsByTagName<"u"?fn.getElementsByTagName(qt):Me.qsa?fn.querySelectorAll(qt):void 0}:function(qt,fn){var tn,qn=[],jn=0,Sr=fn.getElementsByTagName(qt);if("*"===qt){for(;tn=Sr[jn++];)1===tn.nodeType&&qn.push(tn);return qn}return Sr},Be.find.CLASS=Me.getElementsByClassName&&function(qt,fn){if(typeof fn.getElementsByClassName<"u"&&ti)return fn.getElementsByClassName(qt)},ds=[],Ar=[],(Me.qsa=ro.test(Sn.querySelectorAll))&&(fa(function(qt){var fn;Er.appendChild(qt).innerHTML="<a id='"+bi+"'></a><select id='"+bi+"-\r\\' msallowcapture=''><option selected=''></option></select>",qt.querySelectorAll("[msallowcapture^='']").length&&Ar.push("[*^$]="+Hr+"*(?:''|\"\")"),qt.querySelectorAll("[selected]").length||Ar.push("\\["+Hr+"*(?:value|"+Zi+")"),qt.querySelectorAll("[id~="+bi+"-]").length||Ar.push("~="),(fn=Sn.createElement("input")).setAttribute("name",""),qt.appendChild(fn),qt.querySelectorAll("[name='']").length||Ar.push("\\["+Hr+"*name"+Hr+"*="+Hr+"*(?:''|\"\")"),qt.querySelectorAll(":checked").length||Ar.push(":checked"),qt.querySelectorAll("a#"+bi+"+*").length||Ar.push(".#.+[+~]"),qt.querySelectorAll("\\\f"),Ar.push("[\\r\\n\\f]")}),fa(function(qt){qt.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var fn=Sn.createElement("input");fn.setAttribute("type","hidden"),qt.appendChild(fn).setAttribute("name","D"),qt.querySelectorAll("[name=d]").length&&Ar.push("name"+Hr+"*[*^$|!~]?="),2!==qt.querySelectorAll(":enabled").length&&Ar.push(":enabled",":disabled"),Er.appendChild(qt).disabled=!0,2!==qt.querySelectorAll(":disabled").length&&Ar.push(":enabled",":disabled"),qt.querySelectorAll("*,:x"),Ar.push(",.*:")})),(Me.matchesSelector=ro.test(es=Er.matches||Er.webkitMatchesSelector||Er.mozMatchesSelector||Er.oMatchesSelector||Er.msMatchesSelector))&&fa(function(qt){Me.disconnectedMatch=es.call(qt,"*"),es.call(qt,"[s!='']:x"),ds.push("!=",Fs)}),Ar=Ar.length&&new RegExp(Ar.join("|")),ds=ds.length&&new RegExp(ds.join("|")),xt=ro.test(Er.compareDocumentPosition),ha=xt||ro.test(Er.contains)?function(qt,fn){var tn=9===qt.nodeType?qt.documentElement:qt,qn=fn&&fn.parentNode;return qt===qn||!(!qn||1!==qn.nodeType||!(tn.contains?tn.contains(qn):qt.compareDocumentPosition&&16&qt.compareDocumentPosition(qn)))}:function(qt,fn){if(fn)for(;fn=fn.parentNode;)if(fn===qt)return!0;return!1},pl=xt?function(qt,fn){if(qt===fn)return Fn=!0,0;var tn=!qt.compareDocumentPosition-!fn.compareDocumentPosition;return tn||(1&(tn=(qt.ownerDocument||qt)==(fn.ownerDocument||fn)?qt.compareDocumentPosition(fn):1)||!Me.sortDetached&&fn.compareDocumentPosition(qt)===tn?qt==Sn||qt.ownerDocument==Br&&ha(Br,qt)?-1:fn==Sn||fn.ownerDocument==Br&&ha(Br,fn)?1:pn?ss(pn,qt)-ss(pn,fn):0:4&tn?-1:1)}:function(qt,fn){if(qt===fn)return Fn=!0,0;var tn,qn=0,jn=qt.parentNode,Sr=fn.parentNode,$r=[qt],yr=[fn];if(!jn||!Sr)return qt==Sn?-1:fn==Sn?1:jn?-1:Sr?1:pn?ss(pn,qt)-ss(pn,fn):0;if(jn===Sr)return Ec(qt,fn);for(tn=qt;tn=tn.parentNode;)$r.unshift(tn);for(tn=fn;tn=tn.parentNode;)yr.unshift(tn);for(;$r[qn]===yr[qn];)qn++;return qn?Ec($r[qn],yr[qn]):$r[qn]==Br?-1:yr[qn]==Br?1:0}),Sn},qr.matches=function(it,xt){return qr(it,null,null,xt)},qr.matchesSelector=function(it,xt){if(on(it),Me.matchesSelector&&ti&&!pa[xt+" "]&&(!ds||!ds.test(xt))&&(!Ar||!Ar.test(xt)))try{var Ut=es.call(it,xt);if(Ut||Me.disconnectedMatch||it.document&&11!==it.document.nodeType)return Ut}catch{pa(xt,!0)}return qr(xt,Sn,null,[it]).length>0},qr.contains=function(it,xt){return(it.ownerDocument||it)!=Sn&&on(it),ha(it,xt)},qr.attr=function(it,xt){(it.ownerDocument||it)!=Sn&&on(it);var Ut=Be.attrHandle[xt.toLowerCase()],bn=Ut&&da.call(Be.attrHandle,xt.toLowerCase())?Ut(it,xt,!ti):void 0;return void 0!==bn?bn:Me.attributes||!ti?it.getAttribute(xt):(bn=it.getAttributeNode(xt))&&bn.specified?bn.value:null},qr.escape=function(it){return(it+"").replace(bu,Mp)},qr.error=function(it){throw new Error("Syntax error, unrecognized expression: "+it)},qr.uniqueSort=function(it){var xt,Ut=[],bn=0,qt=0;if(Fn=!Me.detectDuplicates,pn=!Me.sortStable&&it.slice(0),it.sort(pl),Fn){for(;xt=it[qt++];)xt===it[qt]&&(bn=Ut.push(qt));for(;bn--;)it.splice(Ut[bn],1)}return pn=null,it},Ve=qr.getText=function(it){var xt,Ut="",bn=0,qt=it.nodeType;if(qt){if(1===qt||9===qt||11===qt){if("string"==typeof it.textContent)return it.textContent;for(it=it.firstChild;it;it=it.nextSibling)Ut+=Ve(it)}else if(3===qt||4===qt)return it.nodeValue}else for(;xt=it[bn++];)Ut+=Ve(xt);return Ut},(Be=qr.selectors={cacheLength:50,createPseudo:yo,match:Tp,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(it){return it[1]=it[1].replace($i,ht),it[3]=(it[3]||it[4]||it[5]||"").replace($i,ht),"~="===it[2]&&(it[3]=" "+it[3]+" "),it.slice(0,4)},CHILD:function(it){return it[1]=it[1].toLowerCase(),"nth"===it[1].slice(0,3)?(it[3]||qr.error(it[0]),it[4]=+(it[4]?it[5]+(it[6]||1):2*("even"===it[3]||"odd"===it[3])),it[5]=+(it[7]+it[8]||"odd"===it[3])):it[3]&&qr.error(it[0]),it},PSEUDO:function(it){var xt,Ut=!it[6]&&it[2];return Tp.CHILD.test(it[0])?null:(it[3]?it[2]=it[4]||it[5]||"":Ut&&$l.test(Ut)&&(xt=et(Ut,!0))&&(xt=Ut.indexOf(")",Ut.length-xt)-Ut.length)&&(it[0]=it[0].slice(0,xt),it[2]=Ut.slice(0,xt)),it.slice(0,3))}},filter:{TAG:function(it){var xt=it.replace($i,ht).toLowerCase();return"*"===it?function(){return!0}:function(Ut){return Ut.nodeName&&Ut.nodeName.toLowerCase()===xt}},CLASS:function(it){var xt=qi[it+" "];return xt||(xt=new RegExp("(^|"+Hr+")"+it+"("+Hr+"|$)"))&&qi(it,function(Ut){return xt.test("string"==typeof Ut.className&&Ut.className||typeof Ut.getAttribute<"u"&&Ut.getAttribute("class")||"")})},ATTR:function(it,xt,Ut){return function(bn){var qt=qr.attr(bn,it);return null==qt?"!="===xt:!xt||(qt+="","="===xt?qt===Ut:"!="===xt?qt!==Ut:"^="===xt?Ut&&0===qt.indexOf(Ut):"*="===xt?Ut&&qt.indexOf(Ut)>-1:"$="===xt?Ut&&qt.slice(-Ut.length)===Ut:"~="===xt?(" "+qt.replace(Xh," ")+" ").indexOf(Ut)>-1:"|="===xt&&(qt===Ut||qt.slice(0,Ut.length+1)===Ut+"-"))}},CHILD:function(it,xt,Ut,bn,qt){var fn="nth"!==it.slice(0,3),tn="last"!==it.slice(-4),qn="of-type"===xt;return 1===bn&&0===qt?function(jn){return!!jn.parentNode}:function(jn,Sr,$r){var yr,Xr,fi,Rr,ts,lo,Js=fn!==tn?"nextSibling":"previousSibling",Bo=jn.parentNode,ec=qn&&jn.nodeName.toLowerCase(),Yo=!$r&&!qn,Xi=!1;if(Bo){if(fn){for(;Js;){for(Rr=jn;Rr=Rr[Js];)if(qn?Rr.nodeName.toLowerCase()===ec:1===Rr.nodeType)return!1;lo=Js="only"===it&&!lo&&"nextSibling"}return!0}if(lo=[tn?Bo.firstChild:Bo.lastChild],tn&&Yo){for(Xi=(ts=(yr=(Xr=(fi=(Rr=Bo)[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]||[])[0]===Xa&&yr[1])&&yr[2],Rr=ts&&Bo.childNodes[ts];Rr=++ts&&Rr&&Rr[Js]||(Xi=ts=0)||lo.pop();)if(1===Rr.nodeType&&++Xi&&Rr===jn){Xr[it]=[Xa,ts,Xi];break}}else if(Yo&&(Xi=ts=(yr=(Xr=(fi=(Rr=jn)[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]||[])[0]===Xa&&yr[1]),!1===Xi)for(;(Rr=++ts&&Rr&&Rr[Js]||(Xi=ts=0)||lo.pop())&&((qn?Rr.nodeName.toLowerCase()!==ec:1!==Rr.nodeType)||!++Xi||(Yo&&((Xr=(fi=Rr[bi]||(Rr[bi]={}))[Rr.uniqueID]||(fi[Rr.uniqueID]={}))[it]=[Xa,Xi]),Rr!==jn)););return(Xi-=qt)===bn||Xi%bn==0&&Xi/bn>=0}}},PSEUDO:function(it,xt){var Ut,bn=Be.pseudos[it]||Be.setFilters[it.toLowerCase()]||qr.error("unsupported pseudo: "+it);return bn[bi]?bn(xt):bn.length>1?(Ut=[it,it,"",xt],Be.setFilters.hasOwnProperty(it.toLowerCase())?yo(function(qt,fn){for(var tn,qn=bn(qt,xt),jn=qn.length;jn--;)qt[tn=ss(qt,qn[jn])]=!(fn[tn]=qn[jn])}):function(qt){return bn(qt,0,Ut)}):bn}},pseudos:{not:yo(function(it){var xt=[],Ut=[],bn=Mt(it.replace(vo,"$1"));return bn[bi]?yo(function(qt,fn,tn,qn){for(var jn,Sr=bn(qt,null,qn,[]),$r=qt.length;$r--;)(jn=Sr[$r])&&(qt[$r]=!(fn[$r]=jn))}):function(qt,fn,tn){return xt[0]=qt,bn(xt,null,tn,Ut),xt[0]=null,!Ut.pop()}}),has:yo(function(it){return function(xt){return qr(it,xt).length>0}}),contains:yo(function(it){return it=it.replace($i,ht),function(xt){return(xt.textContent||Ve(xt)).indexOf(it)>-1}}),lang:yo(function(it){return Ms.test(it||"")||qr.error("unsupported lang: "+it),it=it.replace($i,ht).toLowerCase(),function(xt){var Ut;do{if(Ut=ti?xt.lang:xt.getAttribute("xml:lang")||xt.getAttribute("lang"))return(Ut=Ut.toLowerCase())===it||0===Ut.indexOf(it+"-")}while((xt=xt.parentNode)&&1===xt.nodeType);return!1}}),target:function(it){var xt=q.location&&q.location.hash;return xt&&xt.slice(1)===it.id},root:function(it){return it===Er},focus:function(it){return it===Sn.activeElement&&(!Sn.hasFocus||Sn.hasFocus())&&!!(it.type||it.href||~it.tabIndex)},enabled:Sh(!1),disabled:Sh(!0),checked:function(it){var xt=it.nodeName.toLowerCase();return"input"===xt&&!!it.checked||"option"===xt&&!!it.selected},selected:function(it){return!0===it.selected},empty:function(it){for(it=it.firstChild;it;it=it.nextSibling)if(it.nodeType<6)return!1;return!0},parent:function(it){return!Be.pseudos.empty(it)},header:function(it){return Di.test(it.nodeName)},input:function(it){return Sc.test(it.nodeName)},button:function(it){var xt=it.nodeName.toLowerCase();return"input"===xt&&"button"===it.type||"button"===xt},text:function(it){var xt;return"input"===it.nodeName.toLowerCase()&&"text"===it.type&&(null==(xt=it.getAttribute("type"))||"text"===xt.toLowerCase())},first:Tc(function(){return[0]}),last:Tc(function(it,xt){return[xt-1]}),eq:Tc(function(it,xt,Ut){return[Ut<0?Ut+xt:Ut]}),even:Tc(function(it,xt){for(var Ut=0;Ut<xt;Ut+=2)it.push(Ut);return it}),odd:Tc(function(it,xt){for(var Ut=1;Ut<xt;Ut+=2)it.push(Ut);return it}),lt:Tc(function(it,xt,Ut){for(var bn=Ut<0?Ut+xt:Ut>xt?xt:Ut;--bn>=0;)it.push(bn);return it}),gt:Tc(function(it,xt,Ut){for(var bn=Ut<0?Ut+xt:Ut;++bn<xt;)it.push(bn);return it})}}).pseudos.nth=Be.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Be.pseudos[pe]=Zc(pe);for(pe in{submit:!0,reset:!0})Be.pseudos[pe]=wu(pe);function Cl(){}function Ja(it){for(var xt=0,Ut=it.length,bn="";xt<Ut;xt++)bn+=it[xt].value;return bn}function Ca(it,xt,Ut){var bn=xt.dir,qt=xt.next,fn=qt||bn,tn=Ut&&"parentNode"===fn,qn=Wi++;return xt.first?function(jn,Sr,$r){for(;jn=jn[bn];)if(1===jn.nodeType||tn)return it(jn,Sr,$r);return!1}:function(jn,Sr,$r){var yr,Xr,fi,Rr=[Xa,qn];if($r){for(;jn=jn[bn];)if((1===jn.nodeType||tn)&&it(jn,Sr,$r))return!0}else for(;jn=jn[bn];)if(1===jn.nodeType||tn)if(Xr=(fi=jn[bi]||(jn[bi]={}))[jn.uniqueID]||(fi[jn.uniqueID]={}),qt&&qt===jn.nodeName.toLowerCase())jn=jn[bn]||jn;else{if((yr=Xr[fn])&&yr[0]===Xa&&yr[1]===qn)return Rr[2]=yr[2];if(Xr[fn]=Rr,Rr[2]=it(jn,Sr,$r))return!0}return!1}}function Kl(it){return it.length>1?function(xt,Ut,bn){for(var qt=it.length;qt--;)if(!it[qt](xt,Ut,bn))return!1;return!0}:it[0]}function La(it,xt,Ut,bn,qt){for(var fn,tn=[],qn=0,jn=it.length,Sr=null!=xt;qn<jn;qn++)(fn=it[qn])&&(!Ut||Ut(fn,bn,qt))&&(tn.push(fn),Sr&&xt.push(qn));return tn}function bo(it,xt,Ut,bn,qt,fn){return bn&&!bn[bi]&&(bn=bo(bn)),qt&&!qt[bi]&&(qt=bo(qt,fn)),yo(function(tn,qn,jn,Sr){var $r,yr,Xr,fi=[],Rr=[],ts=qn.length,lo=tn||function Su(it,xt,Ut){for(var bn=0,qt=xt.length;bn<qt;bn++)qr(it,xt[bn],Ut);return Ut}(xt||"*",jn.nodeType?[jn]:jn,[]),Js=!it||!tn&&xt?lo:La(lo,fi,it,jn,Sr),Bo=Ut?qt||(tn?it:ts||bn)?[]:qn:Js;if(Ut&&Ut(Js,Bo,jn,Sr),bn)for($r=La(Bo,Rr),bn($r,[],jn,Sr),yr=$r.length;yr--;)(Xr=$r[yr])&&(Bo[Rr[yr]]=!(Js[Rr[yr]]=Xr));if(tn){if(qt||it){if(qt){for($r=[],yr=Bo.length;yr--;)(Xr=Bo[yr])&&$r.push(Js[yr]=Xr);qt(null,Bo=[],$r,Sr)}for(yr=Bo.length;yr--;)(Xr=Bo[yr])&&($r=qt?ss(tn,Xr):fi[yr])>-1&&(tn[$r]=!(qn[$r]=Xr))}}else Bo=La(Bo===qn?Bo.splice(ts,Bo.length):Bo),qt?qt(null,qn,Bo,Sr):En.apply(qn,Bo)})}function Ds(it){for(var xt,Ut,bn,qt=it.length,fn=Be.relative[it[0].type],tn=fn||Be.relative[" "],qn=fn?1:0,jn=Ca(function(yr){return yr===xt},tn,!0),Sr=Ca(function(yr){return ss(xt,yr)>-1},tn,!0),$r=[function(yr,Xr,fi){var Rr=!fn&&(fi||Xr!==Xt)||((xt=Xr).nodeType?jn(yr,Xr,fi):Sr(yr,Xr,fi));return xt=null,Rr}];qn<qt;qn++)if(Ut=Be.relative[it[qn].type])$r=[Ca(Kl($r),Ut)];else{if((Ut=Be.filter[it[qn].type].apply(null,it[qn].matches))[bi]){for(bn=++qn;bn<qt&&!Be.relative[it[bn].type];bn++);return bo(qn>1&&Kl($r),qn>1&&Ja(it.slice(0,qn-1).concat({value:" "===it[qn-2].type?"*":""})).replace(vo,"$1"),Ut,qn<bn&&Ds(it.slice(qn,bn)),bn<qt&&Ds(it=it.slice(bn)),bn<qt&&Ja(it))}$r.push(Ut)}return Kl($r)}return Cl.prototype=Be.filters=Be.pseudos,Be.setFilters=new Cl,et=qr.tokenize=function(it,xt){var Ut,bn,qt,fn,tn,qn,jn,Sr=qh[it+" "];if(Sr)return xt?0:Sr.slice(0);for(tn=it,qn=[],jn=Be.preFilter;tn;){for(fn in(!Ut||(bn=yu.exec(tn)))&&(bn&&(tn=tn.slice(bn[0].length)||tn),qn.push(qt=[])),Ut=!1,(bn=zn.exec(tn))&&(Ut=bn.shift(),qt.push({value:Ut,type:bn[0].replace(vo," ")}),tn=tn.slice(Ut.length)),Be.filter)(bn=Tp[fn].exec(tn))&&(!jn[fn]||(bn=jn[fn](bn)))&&(Ut=bn.shift(),qt.push({value:Ut,type:fn,matches:bn}),tn=tn.slice(Ut.length));if(!Ut)break}return xt?tn.length:tn?qr.error(it):qh(it,qn).slice(0)},Mt=qr.compile=function(it,xt){var Ut,bn=[],qt=[],fn=wc[it+" "];if(!fn){for(xt||(xt=et(it)),Ut=xt.length;Ut--;)(fn=Ds(xt[Ut]))[bi]?bn.push(fn):qt.push(fn);fn=wc(it,function Mc(it,xt){var Ut=xt.length>0,bn=it.length>0,qt=function(fn,tn,qn,jn,Sr){var $r,yr,Xr,fi=0,Rr="0",ts=fn&&[],lo=[],Js=Xt,Bo=fn||bn&&Be.find.TAG("*",Sr),ec=Xa+=null==Js?1:Math.random()||.1,Yo=Bo.length;for(Sr&&(Xt=tn==Sn||tn||Sr);Rr!==Yo&&null!=($r=Bo[Rr]);Rr++){if(bn&&$r){for(yr=0,!tn&&$r.ownerDocument!=Sn&&(on($r),qn=!ti);Xr=it[yr++];)if(Xr($r,tn||Sn,qn)){jn.push($r);break}Sr&&(Xa=ec)}Ut&&(($r=!Xr&&$r)&&fi--,fn&&ts.push($r))}if(fi+=Rr,Ut&&Rr!==fi){for(yr=0;Xr=xt[yr++];)Xr(ts,lo,tn,qn);if(fn){if(fi>0)for(;Rr--;)ts[Rr]||lo[Rr]||(lo[Rr]=ks.call(jn));lo=La(lo)}En.apply(jn,lo),Sr&&!fn&&lo.length>0&&fi+xt.length>1&&qr.uniqueSort(jn)}return Sr&&(Xa=ec,Xt=Js),ts};return Ut?yo(qt):qt}(qt,bn)),fn.selector=it}return fn},Bt=qr.select=function(it,xt,Ut,bn){var qt,fn,tn,qn,jn,Sr="function"==typeof it&&it,$r=!bn&&et(it=Sr.selector||it);if(Ut=Ut||[],1===$r.length){if((fn=$r[0]=$r[0].slice(0)).length>2&&"ID"===(tn=fn[0]).type&&9===xt.nodeType&&ti&&Be.relative[fn[1].type]){if(!(xt=(Be.find.ID(tn.matches[0].replace($i,ht),xt)||[])[0]))return Ut;Sr&&(xt=xt.parentNode),it=it.slice(fn.shift().value.length)}for(qt=Tp.needsContext.test(it)?0:fn.length;qt--&&!Be.relative[qn=(tn=fn[qt]).type];)if((jn=Be.find[qn])&&(bn=jn(tn.matches[0].replace($i,ht),Jc.test(fn[0].type)&&Qn(xt.parentNode)||xt))){if(fn.splice(qt,1),!(it=bn.length&&Ja(fn)))return En.apply(Ut,bn),Ut;break}}return(Sr||Mt(it,$r))(bn,xt,!ti,Ut,!xt||Jc.test(it)&&Qn(xt.parentNode)||xt),Ut},Me.sortStable=bi.split("").sort(pl).join("")===bi,Me.detectDuplicates=!!Fn,on(),Me.sortDetached=fa(function(it){return 1&it.compareDocumentPosition(Sn.createElement("fieldset"))}),fa(function(it){return it.innerHTML="<a href='#'></a>","#"===it.firstChild.getAttribute("href")})||xu("type|href|height|width",function(it,xt,Ut){if(!Ut)return it.getAttribute(xt,"type"===xt.toLowerCase()?1:2)}),(!Me.attributes||!fa(function(it){return it.innerHTML="<input/>",it.firstChild.setAttribute("value",""),""===it.firstChild.getAttribute("value")}))&&xu("value",function(it,xt,Ut){if(!Ut&&"input"===it.nodeName.toLowerCase())return it.defaultValue}),fa(function(it){return null==it.getAttribute("disabled")})||xu(Zi,function(it,xt,Ut){var bn;if(!Ut)return!0===it[xt]?xt.toLowerCase():(bn=it.getAttributeNode(xt))&&bn.specified?bn.value:null}),qr}(n);U.find=Q,U.expr=Q.selectors,U.expr[":"]=U.expr.pseudos,U.uniqueSort=U.unique=Q.uniqueSort,U.text=Q.getText,U.isXMLDoc=Q.isXML,U.contains=Q.contains,U.escapeSelector=Q.escape;var be=function(q,pe,Me){for(var Be=[],Ve=void 0!==Me;(q=q[pe])&&9!==q.nodeType;)if(1===q.nodeType){if(Ve&&U(q).is(Me))break;Be.push(q)}return Be},Pe=function(q,pe){for(var Me=[];q;q=q.nextSibling)1===q.nodeType&&q!==pe&&Me.push(q);return Me},Ge=U.expr.match.needsContext;function Ae(q,pe){return q.nodeName&&q.nodeName.toLowerCase()===pe.toLowerCase()}var Xe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ke(q,pe,Me){return ae(pe)?U.grep(q,function(Be,Ve){return!!pe.call(Be,Ve,Be)!==Me}):pe.nodeType?U.grep(q,function(Be){return Be===pe!==Me}):"string"!=typeof pe?U.grep(q,function(Be){return M.call(pe,Be)>-1!==Me}):U.filter(pe,q,Me)}U.filter=function(q,pe,Me){var Be=pe[0];return Me&&(q=":not("+q+")"),1===pe.length&&1===Be.nodeType?U.find.matchesSelector(Be,q)?[Be]:[]:U.find.matches(q,U.grep(pe,function(Ve){return 1===Ve.nodeType}))},U.fn.extend({find:function(q){var pe,Me,Be=this.length,Ve=this;if("string"!=typeof q)return this.pushStack(U(q).filter(function(){for(pe=0;pe<Be;pe++)if(U.contains(Ve[pe],this))return!0}));for(Me=this.pushStack([]),pe=0;pe<Be;pe++)U.find(q,Ve[pe],Me);return Be>1?U.uniqueSort(Me):Me},filter:function(q){return this.pushStack(Ke(this,q||[],!1))},not:function(q){return this.pushStack(Ke(this,q||[],!0))},is:function(q){return!!Ke(this,"string"==typeof q&&Ge.test(q)?U(q):q||[],!1).length}});var yt,dt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,It=U.fn.init=function(q,pe,Me){var Be,Ve;if(!q)return this;if(Me=Me||yt,"string"==typeof q){if(!(Be="<"===q[0]&&">"===q[q.length-1]&&q.length>=3?[null,q,null]:dt.exec(q))||!Be[1]&&pe)return!pe||pe.jquery?(pe||Me).find(q):this.constructor(pe).find(q);if(Be[1]){if(U.merge(this,U.parseHTML(Be[1],(pe=pe instanceof U?pe[0]:pe)&&pe.nodeType?pe.ownerDocument||pe:Z,!0)),Xe.test(Be[1])&&U.isPlainObject(pe))for(Be in pe)ae(this[Be])?this[Be](pe[Be]):this.attr(Be,pe[Be]);return this}return(Ve=Z.getElementById(Be[2]))&&(this[0]=Ve,this.length=1),this}return q.nodeType?(this[0]=q,this.length=1,this):ae(q)?void 0!==Me.ready?Me.ready(q):q(U):U.makeArray(q,this)};It.prototype=U.fn,yt=U(Z);var wt=/^(?:parents|prev(?:Until|All))/,Gt={children:!0,contents:!0,next:!0,prev:!0};function Dt(q,pe){for(;(q=q[pe])&&1!==q.nodeType;);return q}U.fn.extend({has:function(q){var pe=U(q,this),Me=pe.length;return this.filter(function(){for(var Be=0;Be<Me;Be++)if(U.contains(this,pe[Be]))return!0})},closest:function(q,pe){var Me,Be=0,Ve=this.length,qe=[],et="string"!=typeof q&&U(q);if(!Ge.test(q))for(;Be<Ve;Be++)for(Me=this[Be];Me&&Me!==pe;Me=Me.parentNode)if(Me.nodeType<11&&(et?et.index(Me)>-1:1===Me.nodeType&&U.find.matchesSelector(Me,q))){qe.push(Me);break}return this.pushStack(qe.length>1?U.uniqueSort(qe):qe)},index:function(q){return q?"string"==typeof q?M.call(U(q),this[0]):M.call(this,q.jquery?q[0]:q):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(q,pe){return this.pushStack(U.uniqueSort(U.merge(this.get(),U(q,pe))))},addBack:function(q){return this.add(null==q?this.prevObject:this.prevObject.filter(q))}}),U.each({parent:function(q){var pe=q.parentNode;return pe&&11!==pe.nodeType?pe:null},parents:function(q){return be(q,"parentNode")},parentsUntil:function(q,pe,Me){return be(q,"parentNode",Me)},next:function(q){return Dt(q,"nextSibling")},prev:function(q){return Dt(q,"previousSibling")},nextAll:function(q){return be(q,"nextSibling")},prevAll:function(q){return be(q,"previousSibling")},nextUntil:function(q,pe,Me){return be(q,"nextSibling",Me)},prevUntil:function(q,pe,Me){return be(q,"previousSibling",Me)},siblings:function(q){return Pe((q.parentNode||{}).firstChild,q)},children:function(q){return Pe(q.firstChild)},contents:function(q){return null!=q.contentDocument&&x(q.contentDocument)?q.contentDocument:(Ae(q,"template")&&(q=q.content||q),U.merge([],q.childNodes))}},function(q,pe){U.fn[q]=function(Me,Be){var Ve=U.map(this,pe,Me);return"Until"!==q.slice(-5)&&(Be=Me),Be&&"string"==typeof Be&&(Ve=U.filter(Be,Ve)),this.length>1&&(Gt[q]||U.uniqueSort(Ve),wt.test(q)&&Ve.reverse()),this.pushStack(Ve)}});var sn=/[^\x20\t\r\n\f]+/g;function An(q){return q}function Bn(q){throw q}function dn(q,pe,Me,Be){var Ve;try{q&&ae(Ve=q.promise)?Ve.call(q).done(pe).fail(Me):q&&ae(Ve=q.then)?Ve.call(q,pe,Me):pe.apply(void 0,[q].slice(Be))}catch(qe){Me.apply(void 0,[qe])}}U.Callbacks=function(q){q="string"==typeof q?function gt(q){var pe={};return U.each(q.match(sn)||[],function(Me,Be){pe[Be]=!0}),pe}(q):U.extend({},q);var pe,Me,Be,Ve,qe=[],et=[],Mt=-1,Bt=function(){for(Ve=Ve||q.once,Be=pe=!0;et.length;Mt=-1)for(Me=et.shift();++Mt<qe.length;)!1===qe[Mt].apply(Me[0],Me[1])&&q.stopOnFalse&&(Mt=qe.length,Me=!1);q.memory||(Me=!1),pe=!1,Ve&&(qe=Me?[]:"")},Xt={add:function(){return qe&&(Me&&!pe&&(Mt=qe.length-1,et.push(Me)),function pn(Fn){U.each(Fn,function(on,Sn){ae(Sn)?(!q.unique||!Xt.has(Sn))&&qe.push(Sn):Sn&&Sn.length&&"string"!==X(Sn)&&pn(Sn)})}(arguments),Me&&!pe&&Bt()),this},remove:function(){return U.each(arguments,function(pn,Fn){for(var on;(on=U.inArray(Fn,qe,on))>-1;)qe.splice(on,1),on<=Mt&&Mt--}),this},has:function(pn){return pn?U.inArray(pn,qe)>-1:qe.length>0},empty:function(){return qe&&(qe=[]),this},disable:function(){return Ve=et=[],qe=Me="",this},disabled:function(){return!qe},lock:function(){return Ve=et=[],!Me&&!pe&&(qe=Me=""),this},locked:function(){return!!Ve},fireWith:function(pn,Fn){return Ve||(Fn=[pn,(Fn=Fn||[]).slice?Fn.slice():Fn],et.push(Fn),pe||Bt()),this},fire:function(){return Xt.fireWith(this,arguments),this},fired:function(){return!!Be}};return Xt},U.extend({Deferred:function(q){var pe=[["notify","progress",U.Callbacks("memory"),U.Callbacks("memory"),2],["resolve","done",U.Callbacks("once memory"),U.Callbacks("once memory"),0,"resolved"],["reject","fail",U.Callbacks("once memory"),U.Callbacks("once memory"),1,"rejected"]],Me="pending",Be={state:function(){return Me},always:function(){return Ve.done(arguments).fail(arguments),this},catch:function(qe){return Be.then(null,qe)},pipe:function(){var qe=arguments;return U.Deferred(function(et){U.each(pe,function(Mt,Bt){var Xt=ae(qe[Bt[4]])&&qe[Bt[4]];Ve[Bt[1]](function(){var pn=Xt&&Xt.apply(this,arguments);pn&&ae(pn.promise)?pn.promise().progress(et.notify).done(et.resolve).fail(et.reject):et[Bt[0]+"With"](this,Xt?[pn]:arguments)})}),qe=null}).promise()},then:function(qe,et,Mt){var Bt=0;function Xt(pn,Fn,on,Sn){return function(){var Er=this,ti=arguments,Ar=function(){var es,ha;if(!(pn<Bt)){if((es=on.apply(Er,ti))===Fn.promise())throw new TypeError("Thenable self-resolution");ae(ha=es&&("object"==typeof es||"function"==typeof es)&&es.then)?Sn?ha.call(es,Xt(Bt,Fn,An,Sn),Xt(Bt,Fn,Bn,Sn)):(Bt++,ha.call(es,Xt(Bt,Fn,An,Sn),Xt(Bt,Fn,Bn,Sn),Xt(Bt,Fn,An,Fn.notifyWith))):(on!==An&&(Er=void 0,ti=[es]),(Sn||Fn.resolveWith)(Er,ti))}},ds=Sn?Ar:function(){try{Ar()}catch(es){U.Deferred.exceptionHook&&U.Deferred.exceptionHook(es,ds.stackTrace),pn+1>=Bt&&(on!==Bn&&(Er=void 0,ti=[es]),Fn.rejectWith(Er,ti))}};pn?ds():(U.Deferred.getStackHook&&(ds.stackTrace=U.Deferred.getStackHook()),n.setTimeout(ds))}}return U.Deferred(function(pn){pe[0][3].add(Xt(0,pn,ae(Mt)?Mt:An,pn.notifyWith)),pe[1][3].add(Xt(0,pn,ae(qe)?qe:An)),pe[2][3].add(Xt(0,pn,ae(et)?et:Bn))}).promise()},promise:function(qe){return null!=qe?U.extend(qe,Be):Be}},Ve={};return U.each(pe,function(qe,et){var Mt=et[2],Bt=et[5];Be[et[1]]=Mt.add,Bt&&Mt.add(function(){Me=Bt},pe[3-qe][2].disable,pe[3-qe][3].disable,pe[0][2].lock,pe[0][3].lock),Mt.add(et[3].fire),Ve[et[0]]=function(){return Ve[et[0]+"With"](this===Ve?void 0:this,arguments),this},Ve[et[0]+"With"]=Mt.fireWith}),Be.promise(Ve),q&&q.call(Ve,Ve),Ve},when:function(q){var pe=arguments.length,Me=pe,Be=Array(Me),Ve=B.call(arguments),qe=U.Deferred(),et=function(Mt){return function(Bt){Be[Mt]=this,Ve[Mt]=arguments.length>1?B.call(arguments):Bt,--pe||qe.resolveWith(Be,Ve)}};if(pe<=1&&(dn(q,qe.done(et(Me)).resolve,qe.reject,!pe),"pending"===qe.state()||ae(Ve[Me]&&Ve[Me].then)))return qe.then();for(;Me--;)dn(Ve[Me],et(Me),qe.reject);return qe.promise()}});var On=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;U.Deferred.exceptionHook=function(q,pe){n.console&&n.console.warn&&q&&On.test(q.name)&&n.console.warn("jQuery.Deferred exception: "+q.message,q.stack,pe)},U.readyException=function(q){n.setTimeout(function(){throw q})};var Ln=U.Deferred();function mn(){Z.removeEventListener("DOMContentLoaded",mn),n.removeEventListener("load",mn),U.ready()}U.fn.ready=function(q){return Ln.then(q).catch(function(pe){U.readyException(pe)}),this},U.extend({isReady:!1,readyWait:1,ready:function(q){(!0===q?--U.readyWait:U.isReady)||(U.isReady=!0,!(!0!==q&&--U.readyWait>0)&&Ln.resolveWith(Z,[U]))}}),U.ready.then=Ln.then,"complete"===Z.readyState||"loading"!==Z.readyState&&!Z.documentElement.doScroll?n.setTimeout(U.ready):(Z.addEventListener("DOMContentLoaded",mn),n.addEventListener("load",mn));var cr=function(q,pe,Me,Be,Ve,qe,et){var Mt=0,Bt=q.length,Xt=null==Me;if("object"===X(Me))for(Mt in Ve=!0,Me)cr(q,pe,Mt,Me[Mt],!0,qe,et);else if(void 0!==Be&&(Ve=!0,ae(Be)||(et=!0),Xt&&(et?(pe.call(q,Be),pe=null):(Xt=pe,pe=function(pn,Fn,on){return Xt.call(U(pn),on)})),pe))for(;Mt<Bt;Mt++)pe(q[Mt],Me,et?Be:Be.call(q[Mt],Mt,pe(q[Mt],Me)));return Ve?q:Xt?pe.call(q):Bt?pe(q[0],Me):qe},rr=/^-ms-/,ur=/-([a-z])/g;function or(q,pe){return pe.toUpperCase()}function ni(q){return q.replace(rr,"ms-").replace(ur,or)}var Kr=function(q){return 1===q.nodeType||9===q.nodeType||!+q.nodeType};function pi(){this.expando=U.expando+pi.uid++}pi.uid=1,pi.prototype={cache:function(q){var pe=q[this.expando];return pe||(pe={},Kr(q)&&(q.nodeType?q[this.expando]=pe:Object.defineProperty(q,this.expando,{value:pe,configurable:!0}))),pe},set:function(q,pe,Me){var Be,Ve=this.cache(q);if("string"==typeof pe)Ve[ni(pe)]=Me;else for(Be in pe)Ve[ni(Be)]=pe[Be];return Ve},get:function(q,pe){return void 0===pe?this.cache(q):q[this.expando]&&q[this.expando][ni(pe)]},access:function(q,pe,Me){return void 0===pe||pe&&"string"==typeof pe&&void 0===Me?this.get(q,pe):(this.set(q,pe,Me),void 0!==Me?Me:pe)},remove:function(q,pe){var Me,Be=q[this.expando];if(void 0!==Be){if(void 0!==pe)for((Me=(pe=Array.isArray(pe)?pe.map(ni):(pe=ni(pe))in Be?[pe]:pe.match(sn)||[]).length);Me--;)delete Be[pe[Me]];(void 0===pe||U.isEmptyObject(Be))&&(q.nodeType?q[this.expando]=void 0:delete q[this.expando])}},hasData:function(q){var pe=q[this.expando];return void 0!==pe&&!U.isEmptyObject(pe)}};var nr=new pi,vr=new pi,mi=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,_o=/[A-Z]/g;function ei(q,pe,Me){var Be;if(void 0===Me&&1===q.nodeType)if(Be="data-"+pe.replace(_o,"-$&").toLowerCase(),"string"==typeof(Me=q.getAttribute(Be))){try{Me=function Nr(q){return"true"===q||"false"!==q&&("null"===q?null:q===+q+""?+q:mi.test(q)?JSON.parse(q):q)}(Me)}catch{}vr.set(q,pe,Me)}else Me=void 0;return Me}U.extend({hasData:function(q){return vr.hasData(q)||nr.hasData(q)},data:function(q,pe,Me){return vr.access(q,pe,Me)},removeData:function(q,pe){vr.remove(q,pe)},_data:function(q,pe,Me){return nr.access(q,pe,Me)},_removeData:function(q,pe){nr.remove(q,pe)}}),U.fn.extend({data:function(q,pe){var Me,Be,Ve,qe=this[0],et=qe&&qe.attributes;if(void 0===q){if(this.length&&(Ve=vr.get(qe),1===qe.nodeType&&!nr.get(qe,"hasDataAttrs"))){for(Me=et.length;Me--;)et[Me]&&0===(Be=et[Me].name).indexOf("data-")&&(Be=ni(Be.slice(5)),ei(qe,Be,Ve[Be]));nr.set(qe,"hasDataAttrs",!0)}return Ve}return"object"==typeof q?this.each(function(){vr.set(this,q)}):cr(this,function(Mt){var Bt;if(qe&&void 0===Mt)return void 0!==(Bt=vr.get(qe,q))||void 0!==(Bt=ei(qe,q))?Bt:void 0;this.each(function(){vr.set(this,q,Mt)})},null,pe,arguments.length>1,null,!0)},removeData:function(q){return this.each(function(){vr.remove(this,q)})}}),U.extend({queue:function(q,pe,Me){var Be;if(q)return Be=nr.get(q,pe=(pe||"fx")+"queue"),Me&&(!Be||Array.isArray(Me)?Be=nr.access(q,pe,U.makeArray(Me)):Be.push(Me)),Be||[]},dequeue:function(q,pe){var Me=U.queue(q,pe=pe||"fx"),Be=Me.length,Ve=Me.shift(),qe=U._queueHooks(q,pe);"inprogress"===Ve&&(Ve=Me.shift(),Be--),Ve&&("fx"===pe&&Me.unshift("inprogress"),delete qe.stop,Ve.call(q,function(){U.dequeue(q,pe)},qe)),!Be&&qe&&qe.empty.fire()},_queueHooks:function(q,pe){var Me=pe+"queueHooks";return nr.get(q,Me)||nr.access(q,Me,{empty:U.Callbacks("once memory").add(function(){nr.remove(q,[pe+"queue",Me])})})}}),U.fn.extend({queue:function(q,pe){var Me=2;return"string"!=typeof q&&(pe=q,q="fx",Me--),arguments.length<Me?U.queue(this[0],q):void 0===pe?this:this.each(function(){var Be=U.queue(this,q,pe);U._queueHooks(this,q),"fx"===q&&"inprogress"!==Be[0]&&U.dequeue(this,q)})},dequeue:function(q){return this.each(function(){U.dequeue(this,q)})},clearQueue:function(q){return this.queue(q||"fx",[])},promise:function(q,pe){var Me,Be=1,Ve=U.Deferred(),qe=this,et=this.length,Mt=function(){--Be||Ve.resolveWith(qe,[qe])};for("string"!=typeof q&&(pe=q,q=void 0),q=q||"fx";et--;)(Me=nr.get(qe[et],q+"queueHooks"))&&Me.empty&&(Be++,Me.empty.add(Mt));return Mt(),Ve.promise(pe)}});var Wr=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,yi=new RegExp("^(?:([+-])=|)("+Wr+")([a-z%]*)$","i"),Ei=["Top","Right","Bottom","Left"],So=Z.documentElement,Ws=function(q){return U.contains(q.ownerDocument,q)},la={composed:!0};So.getRootNode&&(Ws=function(q){return U.contains(q.ownerDocument,q)||q.getRootNode(la)===q.ownerDocument});var Ni=function(q,pe){return"none"===(q=pe||q).style.display||""===q.style.display&&Ws(q)&&"none"===U.css(q,"display")};function Eo(q,pe,Me,Be){var Ve,qe,et=20,Mt=Be?function(){return Be.cur()}:function(){return U.css(q,pe,"")},Bt=Mt(),Xt=Me&&Me[3]||(U.cssNumber[pe]?"":"px"),pn=q.nodeType&&(U.cssNumber[pe]||"px"!==Xt&&+Bt)&&yi.exec(U.css(q,pe));if(pn&&pn[3]!==Xt){for(Xt=Xt||pn[3],pn=+(Bt/=2)||1;et--;)U.style(q,pe,pn+Xt),(1-qe)*(1-(qe=Mt()/Bt||.5))<=0&&(et=0),pn/=qe;U.style(q,pe,(pn*=2)+Xt),Me=Me||[]}return Me&&(pn=+pn||+Bt||0,Ve=Me[1]?pn+(Me[1]+1)*Me[2]:+Me[2],Be&&(Be.unit=Xt,Be.start=pn,Be.end=Ve)),Ve}var go={};function Jr(q){var pe,Me=q.ownerDocument,Be=q.nodeName,Ve=go[Be];return Ve||(pe=Me.body.appendChild(Me.createElement(Be)),Ve=U.css(pe,"display"),pe.parentNode.removeChild(pe),"none"===Ve&&(Ve="block"),go[Be]=Ve,Ve)}function os(q,pe){for(var Me,Be,Ve=[],qe=0,et=q.length;qe<et;qe++)(Be=q[qe]).style&&(Me=Be.style.display,pe?("none"===Me&&(Ve[qe]=nr.get(Be,"display")||null,Ve[qe]||(Be.style.display="")),""===Be.style.display&&Ni(Be)&&(Ve[qe]=Jr(Be))):"none"!==Me&&(Ve[qe]="none",nr.set(Be,"display",Me)));for(qe=0;qe<et;qe++)null!=Ve[qe]&&(q[qe].style.display=Ve[qe]);return q}U.fn.extend({show:function(){return os(this,!0)},hide:function(){return os(this)},toggle:function(q){return"boolean"==typeof q?q?this.show():this.hide():this.each(function(){Ni(this)?U(this).show():U(this).hide()})}});var pe,Me,Ir=/^(?:checkbox|radio)$/i,Va=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Hu=/^$|^module$|\/(?:java|ecma)script/i;pe=Z.createDocumentFragment().appendChild(Z.createElement("div")),(Me=Z.createElement("input")).setAttribute("type","radio"),Me.setAttribute("checked","checked"),Me.setAttribute("name","t"),pe.appendChild(Me),fe.checkClone=pe.cloneNode(!0).cloneNode(!0).lastChild.checked,pe.innerHTML="<textarea>x</textarea>",fe.noCloneChecked=!!pe.cloneNode(!0).lastChild.defaultValue,pe.innerHTML="<option></option>",fe.option=!!pe.lastChild;var us={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function qs(q,pe){var Me;return Me=typeof q.getElementsByTagName<"u"?q.getElementsByTagName(pe||"*"):typeof q.querySelectorAll<"u"?q.querySelectorAll(pe||"*"):[],void 0===pe||pe&&Ae(q,pe)?U.merge([q],Me):Me}function ai(q,pe){for(var Me=0,Be=q.length;Me<Be;Me++)nr.set(q[Me],"globalEval",!pe||nr.get(pe[Me],"globalEval"))}us.tbody=us.tfoot=us.colgroup=us.caption=us.thead,us.th=us.td,fe.option||(us.optgroup=us.option=[1,"<select multiple='multiple'>","</select>"]);var Gc=/<|&#?\w+;/;function kh(q,pe,Me,Be,Ve){for(var qe,et,Mt,Bt,Xt,pn,Fn=pe.createDocumentFragment(),on=[],Sn=0,Er=q.length;Sn<Er;Sn++)if((qe=q[Sn])||0===qe)if("object"===X(qe))U.merge(on,qe.nodeType?[qe]:qe);else if(Gc.test(qe)){for(et=et||Fn.appendChild(pe.createElement("div")),Mt=(Va.exec(qe)||["",""])[1].toLowerCase(),et.innerHTML=(Bt=us[Mt]||us._default)[1]+U.htmlPrefilter(qe)+Bt[2],pn=Bt[0];pn--;)et=et.lastChild;U.merge(on,et.childNodes),(et=Fn.firstChild).textContent=""}else on.push(pe.createTextNode(qe));for(Fn.textContent="",Sn=0;qe=on[Sn++];)if(Be&&U.inArray(qe,Be)>-1)Ve&&Ve.push(qe);else if(Xt=Ws(qe),et=qs(Fn.appendChild(qe),"script"),Xt&&ai(et),Me)for(pn=0;qe=et[pn++];)Hu.test(qe.type||"")&&Me.push(qe);return Fn}var sl=/^key/,Gp=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ca=/^([^.]*)(?:\.(.+)|)/;function Wl(){return!0}function Wa(){return!1}function Hc(q,pe){return q===function Hp(){try{return Z.activeElement}catch{}}()==("focus"===pe)}function Xs(q,pe,Me,Be,Ve,qe){var et,Mt;if("object"==typeof pe){for(Mt in"string"!=typeof Me&&(Be=Be||Me,Me=void 0),pe)Xs(q,Mt,Me,Be,pe[Mt],qe);return q}if(null==Be&&null==Ve?(Ve=Me,Be=Me=void 0):null==Ve&&("string"==typeof Me?(Ve=Be,Be=void 0):(Ve=Be,Be=Me,Me=void 0)),!1===Ve)Ve=Wa;else if(!Ve)return q;return 1===qe&&(et=Ve,Ve=function(Bt){return U().off(Bt),et.apply(this,arguments)},Ve.guid=et.guid||(et.guid=U.guid++)),q.each(function(){U.event.add(this,pe,Ve,Be,Me)})}function Xo(q,pe,Me){Me?(nr.set(q,pe,!1),U.event.add(q,pe,{namespace:!1,handler:function(Be){var Ve,qe,et=nr.get(this,pe);if(1&Be.isTrigger&&this[pe]){if(et.length)(U.event.special[pe]||{}).delegateType&&Be.stopPropagation();else if(et=B.call(arguments),nr.set(this,pe,et),Ve=Me(this,pe),this[pe](),et!==(qe=nr.get(this,pe))||Ve?nr.set(this,pe,!1):qe={},et!==qe)return Be.stopImmediatePropagation(),Be.preventDefault(),qe.value}else et.length&&(nr.set(this,pe,{value:U.event.trigger(U.extend(et[0],U.Event.prototype),et.slice(1),this)}),Be.stopImmediatePropagation())}})):void 0===nr.get(q,pe)&&U.event.add(q,pe,Wl)}U.event={global:{},add:function(q,pe,Me,Be,Ve){var qe,et,Mt,Bt,Xt,pn,Fn,on,Sn,Er,ti,Ar=nr.get(q);if(Kr(q))for(Me.handler&&(Me=(qe=Me).handler,Ve=qe.selector),Ve&&U.find.matchesSelector(So,Ve),Me.guid||(Me.guid=U.guid++),(Bt=Ar.events)||(Bt=Ar.events=Object.create(null)),(et=Ar.handle)||(et=Ar.handle=function(ds){return typeof U<"u"&&U.event.triggered!==ds.type?U.event.dispatch.apply(q,arguments):void 0}),Xt=(pe=(pe||"").match(sn)||[""]).length;Xt--;)Sn=ti=(Mt=ca.exec(pe[Xt])||[])[1],Er=(Mt[2]||"").split(".").sort(),Sn&&(Fn=U.event.special[Sn]||{},Fn=U.event.special[Sn=(Ve?Fn.delegateType:Fn.bindType)||Sn]||{},pn=U.extend({type:Sn,origType:ti,data:Be,handler:Me,guid:Me.guid,selector:Ve,needsContext:Ve&&U.expr.match.needsContext.test(Ve),namespace:Er.join(".")},qe),(on=Bt[Sn])||((on=Bt[Sn]=[]).delegateCount=0,(!Fn.setup||!1===Fn.setup.call(q,Be,Er,et))&&q.addEventListener&&q.addEventListener(Sn,et)),Fn.add&&(Fn.add.call(q,pn),pn.handler.guid||(pn.handler.guid=Me.guid)),Ve?on.splice(on.delegateCount++,0,pn):on.push(pn),U.event.global[Sn]=!0)},remove:function(q,pe,Me,Be,Ve){var qe,et,Mt,Bt,Xt,pn,Fn,on,Sn,Er,ti,Ar=nr.hasData(q)&&nr.get(q);if(Ar&&(Bt=Ar.events)){for(Xt=(pe=(pe||"").match(sn)||[""]).length;Xt--;)if(Sn=ti=(Mt=ca.exec(pe[Xt])||[])[1],Er=(Mt[2]||"").split(".").sort(),Sn){for(Fn=U.event.special[Sn]||{},on=Bt[Sn=(Be?Fn.delegateType:Fn.bindType)||Sn]||[],Mt=Mt[2]&&new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"),et=qe=on.length;qe--;)pn=on[qe],(Ve||ti===pn.origType)&&(!Me||Me.guid===pn.guid)&&(!Mt||Mt.test(pn.namespace))&&(!Be||Be===pn.selector||"**"===Be&&pn.selector)&&(on.splice(qe,1),pn.selector&&on.delegateCount--,Fn.remove&&Fn.remove.call(q,pn));et&&!on.length&&((!Fn.teardown||!1===Fn.teardown.call(q,Er,Ar.handle))&&U.removeEvent(q,Sn,Ar.handle),delete Bt[Sn])}else for(Sn in Bt)U.event.remove(q,Sn+pe[Xt],Me,Be,!0);U.isEmptyObject(Bt)&&nr.remove(q,"handle events")}},dispatch:function(q){var pe,Me,Be,Ve,qe,et,Mt=new Array(arguments.length),Bt=U.event.fix(q),Xt=(nr.get(this,"events")||Object.create(null))[Bt.type]||[],pn=U.event.special[Bt.type]||{};for(Mt[0]=Bt,pe=1;pe<arguments.length;pe++)Mt[pe]=arguments[pe];if(Bt.delegateTarget=this,!pn.preDispatch||!1!==pn.preDispatch.call(this,Bt)){for(et=U.event.handlers.call(this,Bt,Xt),pe=0;(Ve=et[pe++])&&!Bt.isPropagationStopped();)for(Bt.currentTarget=Ve.elem,Me=0;(qe=Ve.handlers[Me++])&&!Bt.isImmediatePropagationStopped();)(!Bt.rnamespace||!1===qe.namespace||Bt.rnamespace.test(qe.namespace))&&(Bt.handleObj=qe,Bt.data=qe.data,void 0!==(Be=((U.event.special[qe.origType]||{}).handle||qe.handler).apply(Ve.elem,Mt))&&!1===(Bt.result=Be)&&(Bt.preventDefault(),Bt.stopPropagation()));return pn.postDispatch&&pn.postDispatch.call(this,Bt),Bt.result}},handlers:function(q,pe){var Me,Be,Ve,qe,et,Mt=[],Bt=pe.delegateCount,Xt=q.target;if(Bt&&Xt.nodeType&&!("click"===q.type&&q.button>=1))for(;Xt!==this;Xt=Xt.parentNode||this)if(1===Xt.nodeType&&("click"!==q.type||!0!==Xt.disabled)){for(qe=[],et={},Me=0;Me<Bt;Me++)void 0===et[Ve=(Be=pe[Me]).selector+" "]&&(et[Ve]=Be.needsContext?U(Ve,this).index(Xt)>-1:U.find(Ve,this,null,[Xt]).length),et[Ve]&&qe.push(Be);qe.length&&Mt.push({elem:Xt,handlers:qe})}return Xt=this,Bt<pe.length&&Mt.push({elem:Xt,handlers:pe.slice(Bt)}),Mt},addProp:function(q,pe){Object.defineProperty(U.Event.prototype,q,{enumerable:!0,configurable:!0,get:ae(pe)?function(){if(this.originalEvent)return pe(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[q]},set:function(Me){Object.defineProperty(this,q,{enumerable:!0,configurable:!0,writable:!0,value:Me})}})},fix:function(q){return q[U.expando]?q:new U.Event(q)},special:{load:{noBubble:!0},click:{setup:function(q){var pe=this||q;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&Xo(pe,"click",Wl),!1},trigger:function(q){var pe=this||q;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&Xo(pe,"click"),!0},_default:function(q){var pe=q.target;return Ir.test(pe.type)&&pe.click&&Ae(pe,"input")&&nr.get(pe,"click")||Ae(pe,"a")}},beforeunload:{postDispatch:function(q){void 0!==q.result&&q.originalEvent&&(q.originalEvent.returnValue=q.result)}}}},U.removeEvent=function(q,pe,Me){q.removeEventListener&&q.removeEventListener(pe,Me)},U.Event=function(q,pe){if(!(this instanceof U.Event))return new U.Event(q,pe);q&&q.type?(this.originalEvent=q,this.type=q.type,this.isDefaultPrevented=q.defaultPrevented||void 0===q.defaultPrevented&&!1===q.returnValue?Wl:Wa,this.target=q.target&&3===q.target.nodeType?q.target.parentNode:q.target,this.currentTarget=q.currentTarget,this.relatedTarget=q.relatedTarget):this.type=q,pe&&U.extend(this,pe),this.timeStamp=q&&q.timeStamp||Date.now(),this[U.expando]=!0},U.Event.prototype={constructor:U.Event,isDefaultPrevented:Wa,isPropagationStopped:Wa,isImmediatePropagationStopped:Wa,isSimulated:!1,preventDefault:function(){var q=this.originalEvent;this.isDefaultPrevented=Wl,q&&!this.isSimulated&&q.preventDefault()},stopPropagation:function(){var q=this.originalEvent;this.isPropagationStopped=Wl,q&&!this.isSimulated&&q.stopPropagation()},stopImmediatePropagation:function(){var q=this.originalEvent;this.isImmediatePropagationStopped=Wl,q&&!this.isSimulated&&q.stopImmediatePropagation(),this.stopPropagation()}},U.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(q){var pe=q.button;return null==q.which&&sl.test(q.type)?null!=q.charCode?q.charCode:q.keyCode:!q.which&&void 0!==pe&&Gp.test(q.type)?1&pe?1:2&pe?3:4&pe?2:0:q.which}},U.event.addProp),U.each({focus:"focusin",blur:"focusout"},function(q,pe){U.event.special[q]={setup:function(){return Xo(this,q,Hc),!1},trigger:function(){return Xo(this,q),!0},delegateType:pe}}),U.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(q,pe){U.event.special[q]={delegateType:pe,bindType:pe,handle:function(Me){var Be,qe=Me.relatedTarget,et=Me.handleObj;return(!qe||qe!==this&&!U.contains(this,qe))&&(Me.type=et.origType,Be=et.handler.apply(this,arguments),Me.type=pe),Be}}}),U.fn.extend({on:function(q,pe,Me,Be){return Xs(this,q,pe,Me,Be)},one:function(q,pe,Me,Be){return Xs(this,q,pe,Me,Be,1)},off:function(q,pe,Me){var Be,Ve;if(q&&q.preventDefault&&q.handleObj)return Be=q.handleObj,U(q.delegateTarget).off(Be.namespace?Be.origType+"."+Be.namespace:Be.origType,Be.selector,Be.handler),this;if("object"==typeof q){for(Ve in q)this.off(Ve,pe,q[Ve]);return this}return(!1===pe||"function"==typeof pe)&&(Me=pe,pe=void 0),!1===Me&&(Me=Wa),this.each(function(){U.event.remove(this,q,Me,pe)})}});var hs=/<script|<style|<link/i,Vu=/checked\s*(?:[^=]|=\s*.checked.)/i,du=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function fu(q,pe){return Ae(q,"table")&&Ae(11!==pe.nodeType?pe:pe.firstChild,"tr")&&U(q).children("tbody")[0]||q}function Ts(q){return q.type=(null!==q.getAttribute("type"))+"/"+q.type,q}function dp(q){return"true/"===(q.type||"").slice(0,5)?q.type=q.type.slice(5):q.removeAttribute("type"),q}function Os(q,pe){var Me,Be,Ve,et,Mt,Bt;if(1===pe.nodeType){if(nr.hasData(q)&&(Bt=nr.get(q).events))for(Ve in nr.remove(pe,"handle events"),Bt)for(Me=0,Be=Bt[Ve].length;Me<Be;Me++)U.event.add(pe,Ve,Bt[Ve][Me]);vr.hasData(q)&&(et=vr.access(q),Mt=U.extend({},et),vr.set(pe,Mt))}}function ao(q,pe){var Me=pe.nodeName.toLowerCase();"input"===Me&&Ir.test(q.type)?pe.checked=q.checked:("input"===Me||"textarea"===Me)&&(pe.defaultValue=q.defaultValue)}function Vc(q,pe,Me,Be){pe=D(pe);var Ve,qe,et,Mt,Bt,Xt,pn=0,Fn=q.length,on=Fn-1,Sn=pe[0],Er=ae(Sn);if(Er||Fn>1&&"string"==typeof Sn&&!fe.checkClone&&Vu.test(Sn))return q.each(function(ti){var Ar=q.eq(ti);Er&&(pe[0]=Sn.call(this,ti,Ar.html())),Vc(Ar,pe,Me,Be)});if(Fn&&(qe=(Ve=kh(pe,q[0].ownerDocument,!1,q,Be)).firstChild,1===Ve.childNodes.length&&(Ve=qe),qe||Be)){for(Mt=(et=U.map(qs(Ve,"script"),Ts)).length;pn<Fn;pn++)Bt=Ve,pn!==on&&(Bt=U.clone(Bt,!0,!0),Mt&&U.merge(et,qs(Bt,"script"))),Me.call(q[pn],Bt,pn);if(Mt)for(Xt=et[et.length-1].ownerDocument,U.map(et,dp),pn=0;pn<Mt;pn++)Hu.test((Bt=et[pn]).type||"")&&!nr.access(Bt,"globalEval")&&U.contains(Xt,Bt)&&(Bt.src&&"module"!==(Bt.type||"").toLowerCase()?U._evalUrl&&!Bt.noModule&&U._evalUrl(Bt.src,{nonce:Bt.nonce||Bt.getAttribute("nonce")},Xt):R(Bt.textContent.replace(du,""),Bt,Xt))}return q}function Wu(q,pe,Me){for(var Be,Ve=pe?U.filter(pe,q):q,qe=0;null!=(Be=Ve[qe]);qe++)!Me&&1===Be.nodeType&&U.cleanData(qs(Be)),Be.parentNode&&(Me&&Ws(Be)&&ai(qs(Be,"script")),Be.parentNode.removeChild(Be));return q}U.extend({htmlPrefilter:function(q){return q},clone:function(q,pe,Me){var Be,Ve,qe,et,Mt=q.cloneNode(!0),Bt=Ws(q);if(!(fe.noCloneChecked||1!==q.nodeType&&11!==q.nodeType||U.isXMLDoc(q)))for(et=qs(Mt),Be=0,Ve=(qe=qs(q)).length;Be<Ve;Be++)ao(qe[Be],et[Be]);if(pe)if(Me)for(qe=qe||qs(q),et=et||qs(Mt),Be=0,Ve=qe.length;Be<Ve;Be++)Os(qe[Be],et[Be]);else Os(q,Mt);return(et=qs(Mt,"script")).length>0&&ai(et,!Bt&&qs(q,"script")),Mt},cleanData:function(q){for(var pe,Me,Be,Ve=U.event.special,qe=0;void 0!==(Me=q[qe]);qe++)if(Kr(Me)){if(pe=Me[nr.expando]){if(pe.events)for(Be in pe.events)Ve[Be]?U.event.remove(Me,Be):U.removeEvent(Me,Be,pe.handle);Me[nr.expando]=void 0}Me[vr.expando]&&(Me[vr.expando]=void 0)}}}),U.fn.extend({detach:function(q){return Wu(this,q,!0)},remove:function(q){return Wu(this,q)},text:function(q){return cr(this,function(pe){return void 0===pe?U.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=pe)})},null,q,arguments.length)},append:function(){return Vc(this,arguments,function(q){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||fu(this,q).appendChild(q)})},prepend:function(){return Vc(this,arguments,function(q){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var pe=fu(this,q);pe.insertBefore(q,pe.firstChild)}})},before:function(){return Vc(this,arguments,function(q){this.parentNode&&this.parentNode.insertBefore(q,this)})},after:function(){return Vc(this,arguments,function(q){this.parentNode&&this.parentNode.insertBefore(q,this.nextSibling)})},empty:function(){for(var q,pe=0;null!=(q=this[pe]);pe++)1===q.nodeType&&(U.cleanData(qs(q,!1)),q.textContent="");return this},clone:function(q,pe){return q=q??!1,pe=pe??q,this.map(function(){return U.clone(this,q,pe)})},html:function(q){return cr(this,function(pe){var Me=this[0]||{},Be=0,Ve=this.length;if(void 0===pe&&1===Me.nodeType)return Me.innerHTML;if("string"==typeof pe&&!hs.test(pe)&&!us[(Va.exec(pe)||["",""])[1].toLowerCase()]){pe=U.htmlPrefilter(pe);try{for(;Be<Ve;Be++)1===(Me=this[Be]||{}).nodeType&&(U.cleanData(qs(Me,!1)),Me.innerHTML=pe);Me=0}catch{}}Me&&this.empty().append(pe)},null,q,arguments.length)},replaceWith:function(){var q=[];return Vc(this,arguments,function(pe){var Me=this.parentNode;U.inArray(this,q)<0&&(U.cleanData(qs(this)),Me&&Me.replaceChild(pe,this))},q)}}),U.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(q,pe){U.fn[q]=function(Me){for(var Be,Ve=[],qe=U(Me),et=qe.length-1,Mt=0;Mt<=et;Mt++)Be=Mt===et?this:this.clone(!0),U(qe[Mt])[pe](Be),G.apply(Ve,Be.get());return this.pushStack(Ve)}});var vh=new RegExp("^("+Wr+")(?!px)[a-z%]+$","i"),To=function(q){var pe=q.ownerDocument.defaultView;return(!pe||!pe.opener)&&(pe=n),pe.getComputedStyle(q)},Ys=function(q,pe,Me){var Be,Ve,qe={};for(Ve in pe)qe[Ve]=q.style[Ve],q.style[Ve]=pe[Ve];for(Ve in Be=Me.call(q),pe)q.style[Ve]=qe[Ve];return Be},Vp=new RegExp(Ei.join("|"),"i");function ll(q,pe,Me){var Be,Ve,qe,et,Mt=q.style;return(Me=Me||To(q))&&(""===(et=Me.getPropertyValue(pe)||Me[pe])&&!Ws(q)&&(et=U.style(q,pe)),!fe.pixelBoxStyles()&&vh.test(et)&&Vp.test(pe)&&(Be=Mt.width,Ve=Mt.minWidth,qe=Mt.maxWidth,Mt.minWidth=Mt.maxWidth=Mt.width=et,et=Me.width,Mt.width=Be,Mt.minWidth=Ve,Mt.maxWidth=qe)),void 0!==et?et+"":et}function mu(q,pe){return{get:function(){if(!q())return(this.get=pe).apply(this,arguments);delete this.get}}}!function(){function q(){if(Xt){Bt.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Xt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",So.appendChild(Bt).appendChild(Xt);var pn=n.getComputedStyle(Xt);Me="1%"!==pn.top,Mt=12===pe(pn.marginLeft),Xt.style.right="60%",qe=36===pe(pn.right),Be=36===pe(pn.width),Xt.style.position="absolute",Ve=12===pe(Xt.offsetWidth/3),So.removeChild(Bt),Xt=null}}function pe(pn){return Math.round(parseFloat(pn))}var Me,Be,Ve,qe,et,Mt,Bt=Z.createElement("div"),Xt=Z.createElement("div");Xt.style&&(Xt.style.backgroundClip="content-box",Xt.cloneNode(!0).style.backgroundClip="",fe.clearCloneStyle="content-box"===Xt.style.backgroundClip,U.extend(fe,{boxSizingReliable:function(){return q(),Be},pixelBoxStyles:function(){return q(),qe},pixelPosition:function(){return q(),Me},reliableMarginLeft:function(){return q(),Mt},scrollboxSize:function(){return q(),Ve},reliableTrDimensions:function(){var pn,Fn,on,Sn;return null==et&&(pn=Z.createElement("table"),Fn=Z.createElement("tr"),on=Z.createElement("div"),pn.style.cssText="position:absolute;left:-11111px",Fn.style.height="1px",on.style.height="9px",So.appendChild(pn).appendChild(Fn).appendChild(on),Sn=n.getComputedStyle(Fn),et=parseInt(Sn.height)>3,So.removeChild(pn)),et}}))}();var fp=["Webkit","Moz","ms"],mp=Z.createElement("div").style,yh={};function mc(q){return U.cssProps[q]||yh[q]||(q in mp?q:yh[q]=function Fh(q){for(var pe=q[0].toUpperCase()+q.slice(1),Me=fp.length;Me--;)if((q=fp[Me]+pe)in mp)return q}(q)||q)}var Dh=/^(none|table(?!-c[ea]).+)/,bh=/^--/,Uh={position:"absolute",visibility:"hidden",display:"block"},Tl={letterSpacing:"0",fontWeight:"400"};function Ml(q,pe,Me){var Be=yi.exec(pe);return Be?Math.max(0,Be[2]-(Me||0))+(Be[3]||"px"):pe}function ql(q,pe,Me,Be,Ve,qe){var et="width"===pe?1:0,Mt=0,Bt=0;if(Me===(Be?"border":"content"))return 0;for(;et<4;et+=2)"margin"===Me&&(Bt+=U.css(q,Me+Ei[et],!0,Ve)),Be?("content"===Me&&(Bt-=U.css(q,"padding"+Ei[et],!0,Ve)),"margin"!==Me&&(Bt-=U.css(q,"border"+Ei[et]+"Width",!0,Ve))):(Bt+=U.css(q,"padding"+Ei[et],!0,Ve),"padding"!==Me?Bt+=U.css(q,"border"+Ei[et]+"Width",!0,Ve):Mt+=U.css(q,"border"+Ei[et]+"Width",!0,Ve));return!Be&&qe>=0&&(Bt+=Math.max(0,Math.ceil(q["offset"+pe[0].toUpperCase()+pe.slice(1)]-qe-Bt-Mt-.5))||0),Bt}function qu(q,pe,Me){var Be=To(q),qe=(!fe.boxSizingReliable()||Me)&&"border-box"===U.css(q,"boxSizing",!1,Be),et=qe,Mt=ll(q,pe,Be),Bt="offset"+pe[0].toUpperCase()+pe.slice(1);if(vh.test(Mt)){if(!Me)return Mt;Mt="auto"}return(!fe.boxSizingReliable()&&qe||!fe.reliableTrDimensions()&&Ae(q,"tr")||"auto"===Mt||!parseFloat(Mt)&&"inline"===U.css(q,"display",!1,Be))&&q.getClientRects().length&&(qe="border-box"===U.css(q,"boxSizing",!1,Be),(et=Bt in q)&&(Mt=q[Bt])),(Mt=parseFloat(Mt)||0)+ql(q,pe,Me||(qe?"border":"content"),et,Be,Mt)+"px"}function ps(q,pe,Me,Be,Ve){return new ps.prototype.init(q,pe,Me,Be,Ve)}U.extend({cssHooks:{opacity:{get:function(q,pe){if(pe){var Me=ll(q,"opacity");return""===Me?"1":Me}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(q,pe,Me,Be){if(q&&3!==q.nodeType&&8!==q.nodeType&&q.style){var Ve,qe,et,Mt=ni(pe),Bt=bh.test(pe),Xt=q.style;if(Bt||(pe=mc(Mt)),et=U.cssHooks[pe]||U.cssHooks[Mt],void 0===Me)return et&&"get"in et&&void 0!==(Ve=et.get(q,!1,Be))?Ve:Xt[pe];if("string"==(qe=typeof Me)&&(Ve=yi.exec(Me))&&Ve[1]&&(Me=Eo(q,pe,Ve),qe="number"),null==Me||Me!=Me)return;"number"===qe&&!Bt&&(Me+=Ve&&Ve[3]||(U.cssNumber[Mt]?"":"px")),!fe.clearCloneStyle&&""===Me&&0===pe.indexOf("background")&&(Xt[pe]="inherit"),(!et||!("set"in et)||void 0!==(Me=et.set(q,Me,Be)))&&(Bt?Xt.setProperty(pe,Me):Xt[pe]=Me)}},css:function(q,pe,Me,Be){var Ve,qe,et,Mt=ni(pe);return bh.test(pe)||(pe=mc(Mt)),(et=U.cssHooks[pe]||U.cssHooks[Mt])&&"get"in et&&(Ve=et.get(q,!0,Me)),void 0===Ve&&(Ve=ll(q,pe,Be)),"normal"===Ve&&pe in Tl&&(Ve=Tl[pe]),""===Me||Me?(qe=parseFloat(Ve),!0===Me||isFinite(qe)?qe||0:Ve):Ve}}),U.each(["height","width"],function(q,pe){U.cssHooks[pe]={get:function(Me,Be,Ve){if(Be)return!Dh.test(U.css(Me,"display"))||Me.getClientRects().length&&Me.getBoundingClientRect().width?qu(Me,pe,Ve):Ys(Me,Uh,function(){return qu(Me,pe,Ve)})},set:function(Me,Be,Ve){var qe,et=To(Me),Mt=!fe.scrollboxSize()&&"absolute"===et.position,Xt=(Mt||Ve)&&"border-box"===U.css(Me,"boxSizing",!1,et),pn=Ve?ql(Me,pe,Ve,Xt,et):0;return Xt&&Mt&&(pn-=Math.ceil(Me["offset"+pe[0].toUpperCase()+pe.slice(1)]-parseFloat(et[pe])-ql(Me,pe,"border",!1,et)-.5)),pn&&(qe=yi.exec(Be))&&"px"!==(qe[3]||"px")&&(Me.style[pe]=Be,Be=U.css(Me,pe)),Ml(0,Be,pn)}}}),U.cssHooks.marginLeft=mu(fe.reliableMarginLeft,function(q,pe){if(pe)return(parseFloat(ll(q,"marginLeft"))||q.getBoundingClientRect().left-Ys(q,{marginLeft:0},function(){return q.getBoundingClientRect().left}))+"px"}),U.each({margin:"",padding:"",border:"Width"},function(q,pe){U.cssHooks[q+pe]={expand:function(Me){for(var Be=0,Ve={},qe="string"==typeof Me?Me.split(" "):[Me];Be<4;Be++)Ve[q+Ei[Be]+pe]=qe[Be]||qe[Be-2]||qe[0];return Ve}},"margin"!==q&&(U.cssHooks[q+pe].set=Ml)}),U.fn.extend({css:function(q,pe){return cr(this,function(Me,Be,Ve){var qe,et,Mt={},Bt=0;if(Array.isArray(Be)){for(qe=To(Me),et=Be.length;Bt<et;Bt++)Mt[Be[Bt]]=U.css(Me,Be[Bt],!1,qe);return Mt}return void 0!==Ve?U.style(Me,Be,Ve):U.css(Me,Be)},q,pe,arguments.length>1)}}),U.Tween=ps,ps.prototype={constructor:ps,init:function(q,pe,Me,Be,Ve,qe){this.elem=q,this.prop=Me,this.easing=Ve||U.easing._default,this.options=pe,this.start=this.now=this.cur(),this.end=Be,this.unit=qe||(U.cssNumber[Me]?"":"px")},cur:function(){var q=ps.propHooks[this.prop];return q&&q.get?q.get(this):ps.propHooks._default.get(this)},run:function(q){var pe,Me=ps.propHooks[this.prop];return this.pos=pe=this.options.duration?U.easing[this.easing](q,this.options.duration*q,0,1,this.options.duration):q,this.now=(this.end-this.start)*pe+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Me&&Me.set?Me.set(this):ps.propHooks._default.set(this),this}},ps.prototype.init.prototype=ps.prototype,ps.propHooks={_default:{get:function(q){var pe;return 1!==q.elem.nodeType||null!=q.elem[q.prop]&&null==q.elem.style[q.prop]?q.elem[q.prop]:(pe=U.css(q.elem,q.prop,""))&&"auto"!==pe?pe:0},set:function(q){U.fx.step[q.prop]?U.fx.step[q.prop](q):1!==q.elem.nodeType||!U.cssHooks[q.prop]&&null==q.elem.style[mc(q.prop)]?q.elem[q.prop]=q.now:U.style(q.elem,q.prop,q.now+q.unit)}}},ps.propHooks.scrollTop=ps.propHooks.scrollLeft={set:function(q){q.elem.nodeType&&q.elem.parentNode&&(q.elem[q.prop]=q.now)}},U.easing={linear:function(q){return q},swing:function(q){return.5-Math.cos(q*Math.PI)/2},_default:"swing"},U.fx=ps.prototype.init,U.fx.step={};var Xl,Xu,_p=/^(?:toggle|show|hide)$/,gp=/queueHooks$/;function Wc(){Xu&&(!1===Z.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(Wc):n.setTimeout(Wc,U.fx.interval),U.fx.tick())}function _c(){return n.setTimeout(function(){Xl=void 0}),Xl=Date.now()}function xh(q,pe){var Me,Be=0,Ve={height:q};for(pe=pe?1:0;Be<4;Be+=2-pe)Ve["margin"+(Me=Ei[Be])]=Ve["padding"+Me]=q;return pe&&(Ve.opacity=Ve.width=q),Ve}function vp(q,pe,Me){for(var Be,Ve=(cl.tweeners[pe]||[]).concat(cl.tweeners["*"]),qe=0,et=Ve.length;qe<et;qe++)if(Be=Ve[qe].call(Me,pe,q))return Be}function cl(q,pe,Me){var Be,Ve,qe=0,et=cl.prefilters.length,Mt=U.Deferred().always(function(){delete Bt.elem}),Bt=function(){if(Ve)return!1;for(var Fn=Xl||_c(),on=Math.max(0,Xt.startTime+Xt.duration-Fn),Er=1-(on/Xt.duration||0),ti=0,Ar=Xt.tweens.length;ti<Ar;ti++)Xt.tweens[ti].run(Er);return Mt.notifyWith(q,[Xt,Er,on]),Er<1&&Ar?on:(Ar||Mt.notifyWith(q,[Xt,1,0]),Mt.resolveWith(q,[Xt]),!1)},Xt=Mt.promise({elem:q,props:U.extend({},pe),opts:U.extend(!0,{specialEasing:{},easing:U.easing._default},Me),originalProperties:pe,originalOptions:Me,startTime:Xl||_c(),duration:Me.duration,tweens:[],createTween:function(Fn,on){var Sn=U.Tween(q,Xt.opts,Fn,on,Xt.opts.specialEasing[Fn]||Xt.opts.easing);return Xt.tweens.push(Sn),Sn},stop:function(Fn){var on=0,Sn=Fn?Xt.tweens.length:0;if(Ve)return this;for(Ve=!0;on<Sn;on++)Xt.tweens[on].run(1);return Fn?(Mt.notifyWith(q,[Xt,1,0]),Mt.resolveWith(q,[Xt,Fn])):Mt.rejectWith(q,[Xt,Fn]),this}}),pn=Xt.props;for(function Ju(q,pe){var Me,Be,Ve,qe,et;for(Me in q)if(Ve=pe[Be=ni(Me)],qe=q[Me],Array.isArray(qe)&&(Ve=qe[1],qe=q[Me]=qe[0]),Me!==Be&&(q[Be]=qe,delete q[Me]),(et=U.cssHooks[Be])&&"expand"in et)for(Me in qe=et.expand(qe),delete q[Be],qe)Me in q||(q[Me]=qe[Me],pe[Me]=Ve);else pe[Be]=Ve}(pn,Xt.opts.specialEasing);qe<et;qe++)if(Be=cl.prefilters[qe].call(Xt,q,pn,Xt.opts))return ae(Be.stop)&&(U._queueHooks(Xt.elem,Xt.opts.queue).stop=Be.stop.bind(Be)),Be;return U.map(pn,vp,Xt),ae(Xt.opts.start)&&Xt.opts.start.call(q,Xt),Xt.progress(Xt.opts.progress).done(Xt.opts.done,Xt.opts.complete).fail(Xt.opts.fail).always(Xt.opts.always),U.fx.timer(U.extend(Bt,{elem:q,anim:Xt,queue:Xt.opts.queue})),Xt}U.Animation=U.extend(cl,{tweeners:{"*":[function(q,pe){var Me=this.createTween(q,pe);return Eo(Me.elem,q,yi.exec(pe),Me),Me}]},tweener:function(q,pe){ae(q)?(pe=q,q=["*"]):q=q.match(sn);for(var Me,Be=0,Ve=q.length;Be<Ve;Be++)(cl.tweeners[Me=q[Be]]=cl.tweeners[Me]||[]).unshift(pe)},prefilters:[function Yu(q,pe,Me){var Be,Ve,qe,et,Mt,Bt,Xt,pn,Fn="width"in pe||"height"in pe,on=this,Sn={},Er=q.style,ti=q.nodeType&&Ni(q),Ar=nr.get(q,"fxshow");for(Be in Me.queue||(null==(et=U._queueHooks(q,"fx")).unqueued&&(et.unqueued=0,Mt=et.empty.fire,et.empty.fire=function(){et.unqueued||Mt()}),et.unqueued++,on.always(function(){on.always(function(){et.unqueued--,U.queue(q,"fx").length||et.empty.fire()})})),pe)if(_p.test(Ve=pe[Be])){if(delete pe[Be],qe=qe||"toggle"===Ve,Ve===(ti?"hide":"show")){if("show"!==Ve||!Ar||void 0===Ar[Be])continue;ti=!0}Sn[Be]=Ar&&Ar[Be]||U.style(q,Be)}if((Bt=!U.isEmptyObject(pe))||!U.isEmptyObject(Sn))for(Be in Fn&&1===q.nodeType&&(Me.overflow=[Er.overflow,Er.overflowX,Er.overflowY],null==(Xt=Ar&&Ar.display)&&(Xt=nr.get(q,"display")),"none"===(pn=U.css(q,"display"))&&(Xt?pn=Xt:(os([q],!0),Xt=q.style.display||Xt,pn=U.css(q,"display"),os([q]))),("inline"===pn||"inline-block"===pn&&null!=Xt)&&"none"===U.css(q,"float")&&(Bt||(on.done(function(){Er.display=Xt}),null==Xt&&(Xt="none"===(pn=Er.display)?"":pn)),Er.display="inline-block")),Me.overflow&&(Er.overflow="hidden",on.always(function(){Er.overflow=Me.overflow[0],Er.overflowX=Me.overflow[1],Er.overflowY=Me.overflow[2]})),Bt=!1,Sn)Bt||(Ar?"hidden"in Ar&&(ti=Ar.hidden):Ar=nr.access(q,"fxshow",{display:Xt}),qe&&(Ar.hidden=!ti),ti&&os([q],!0),on.done(function(){for(Be in ti||os([q]),nr.remove(q,"fxshow"),Sn)U.style(q,Be,Sn[Be])})),Bt=vp(ti?Ar[Be]:0,Be,on),Be in Ar||(Ar[Be]=Bt.start,ti&&(Bt.end=Bt.start,Bt.start=0))}],prefilter:function(q,pe){pe?cl.prefilters.unshift(q):cl.prefilters.push(q)}}),U.speed=function(q,pe,Me){var Be=q&&"object"==typeof q?U.extend({},q):{complete:Me||!Me&&pe||ae(q)&&q,duration:q,easing:Me&&pe||pe&&!ae(pe)&&pe};return U.fx.off?Be.duration=0:"number"!=typeof Be.duration&&(Be.duration=Be.duration in U.fx.speeds?U.fx.speeds[Be.duration]:U.fx.speeds._default),(null==Be.queue||!0===Be.queue)&&(Be.queue="fx"),Be.old=Be.complete,Be.complete=function(){ae(Be.old)&&Be.old.call(this),Be.queue&&U.dequeue(this,Be.queue)},Be},U.fn.extend({fadeTo:function(q,pe,Me,Be){return this.filter(Ni).css("opacity",0).show().end().animate({opacity:pe},q,Me,Be)},animate:function(q,pe,Me,Be){var Ve=U.isEmptyObject(q),qe=U.speed(pe,Me,Be),et=function(){var Mt=cl(this,U.extend({},q),qe);(Ve||nr.get(this,"finish"))&&Mt.stop(!0)};return et.finish=et,Ve||!1===qe.queue?this.each(et):this.queue(qe.queue,et)},stop:function(q,pe,Me){var Be=function(Ve){var qe=Ve.stop;delete Ve.stop,qe(Me)};return"string"!=typeof q&&(Me=pe,pe=q,q=void 0),pe&&this.queue(q||"fx",[]),this.each(function(){var Ve=!0,qe=null!=q&&q+"queueHooks",et=U.timers,Mt=nr.get(this);if(qe)Mt[qe]&&Mt[qe].stop&&Be(Mt[qe]);else for(qe in Mt)Mt[qe]&&Mt[qe].stop&&gp.test(qe)&&Be(Mt[qe]);for(qe=et.length;qe--;)et[qe].elem===this&&(null==q||et[qe].queue===q)&&(et[qe].anim.stop(Me),Ve=!1,et.splice(qe,1));(Ve||!Me)&&U.dequeue(this,q)})},finish:function(q){return!1!==q&&(q=q||"fx"),this.each(function(){var pe,Me=nr.get(this),Be=Me[q+"queue"],Ve=Me[q+"queueHooks"],qe=U.timers,et=Be?Be.length:0;for(Me.finish=!0,U.queue(this,q,[]),Ve&&Ve.stop&&Ve.stop.call(this,!0),pe=qe.length;pe--;)qe[pe].elem===this&&qe[pe].queue===q&&(qe[pe].anim.stop(!0),qe.splice(pe,1));for(pe=0;pe<et;pe++)Be[pe]&&Be[pe].finish&&Be[pe].finish.call(this);delete Me.finish})}}),U.each(["toggle","show","hide"],function(q,pe){var Me=U.fn[pe];U.fn[pe]=function(Be,Ve,qe){return null==Be||"boolean"==typeof Be?Me.apply(this,arguments):this.animate(xh(pe,!0),Be,Ve,qe)}}),U.each({slideDown:xh("show"),slideUp:xh("hide"),slideToggle:xh("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(q,pe){U.fn[q]=function(Me,Be,Ve){return this.animate(pe,Me,Be,Ve)}}),U.timers=[],U.fx.tick=function(){var q,pe=0,Me=U.timers;for(Xl=Date.now();pe<Me.length;pe++)!(q=Me[pe])()&&Me[pe]===q&&Me.splice(pe--,1);Me.length||U.fx.stop(),Xl=void 0},U.fx.timer=function(q){U.timers.push(q),U.fx.start()},U.fx.interval=13,U.fx.start=function(){Xu||(Xu=!0,Wc())},U.fx.stop=function(){Xu=null},U.fx.speeds={slow:600,fast:200,_default:400},U.fn.delay=function(q,pe){return q=U.fx&&U.fx.speeds[q]||q,this.queue(pe=pe||"fx",function(Me,Be){var Ve=n.setTimeout(Me,q);Be.stop=function(){n.clearTimeout(Ve)}})},function(){var q=Z.createElement("input"),Me=Z.createElement("select").appendChild(Z.createElement("option"));q.type="checkbox",fe.checkOn=""!==q.value,fe.optSelected=Me.selected,(q=Z.createElement("input")).value="t",q.type="radio",fe.radioValue="t"===q.value}();var zh,ul=U.expr.attrHandle;U.fn.extend({attr:function(q,pe){return cr(this,U.attr,q,pe,arguments.length>1)},removeAttr:function(q){return this.each(function(){U.removeAttr(this,q)})}}),U.extend({attr:function(q,pe,Me){var Be,Ve,qe=q.nodeType;if(3!==qe&&8!==qe&&2!==qe)return typeof q.getAttribute>"u"?U.prop(q,pe,Me):((1!==qe||!U.isXMLDoc(q))&&(Ve=U.attrHooks[pe.toLowerCase()]||(U.expr.match.bool.test(pe)?zh:void 0)),void 0!==Me?null===Me?void U.removeAttr(q,pe):Ve&&"set"in Ve&&void 0!==(Be=Ve.set(q,Me,pe))?Be:(q.setAttribute(pe,Me+""),Me):Ve&&"get"in Ve&&null!==(Be=Ve.get(q,pe))?Be:(Be=U.find.attr(q,pe))??void 0)},attrHooks:{type:{set:function(q,pe){if(!fe.radioValue&&"radio"===pe&&Ae(q,"input")){var Me=q.value;return q.setAttribute("type",pe),Me&&(q.value=Me),pe}}}},removeAttr:function(q,pe){var Me,Be=0,Ve=pe&&pe.match(sn);if(Ve&&1===q.nodeType)for(;Me=Ve[Be++];)q.removeAttribute(Me)}}),zh={set:function(q,pe,Me){return!1===pe?U.removeAttr(q,Me):q.setAttribute(Me,Me),Me}},U.each(U.expr.match.bool.source.match(/\w+/g),function(q,pe){var Me=ul[pe]||U.find.attr;ul[pe]=function(Be,Ve,qe){var et,Mt,Bt=Ve.toLowerCase();return qe||(Mt=ul[Bt],ul[Bt]=et,et=null!=Me(Be,Ve,qe)?Bt:null,ul[Bt]=Mt),et}});var jh=/^(?:input|select|textarea|button)$/i,Zu=/^(?:a|area)$/i;function vc(q){return(q.match(sn)||[]).join(" ")}function yc(q){return q.getAttribute&&q.getAttribute("class")||""}function wh(q){return Array.isArray(q)?q:"string"==typeof q&&q.match(sn)||[]}U.fn.extend({prop:function(q,pe){return cr(this,U.prop,q,pe,arguments.length>1)},removeProp:function(q){return this.each(function(){delete this[U.propFix[q]||q]})}}),U.extend({prop:function(q,pe,Me){var Be,Ve,qe=q.nodeType;if(3!==qe&&8!==qe&&2!==qe)return(1!==qe||!U.isXMLDoc(q))&&(Ve=U.propHooks[pe=U.propFix[pe]||pe]),void 0!==Me?Ve&&"set"in Ve&&void 0!==(Be=Ve.set(q,Me,pe))?Be:q[pe]=Me:Ve&&"get"in Ve&&null!==(Be=Ve.get(q,pe))?Be:q[pe]},propHooks:{tabIndex:{get:function(q){var pe=U.find.attr(q,"tabindex");return pe?parseInt(pe,10):jh.test(q.nodeName)||Zu.test(q.nodeName)&&q.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),fe.optSelected||(U.propHooks.selected={get:function(q){return null},set:function(q){}}),U.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){U.propFix[this.toLowerCase()]=this}),U.fn.extend({addClass:function(q){var pe,Me,Be,Ve,qe,et,Mt,Bt=0;if(ae(q))return this.each(function(Xt){U(this).addClass(q.call(this,Xt,yc(this)))});if((pe=wh(q)).length)for(;Me=this[Bt++];)if(Ve=yc(Me),Be=1===Me.nodeType&&" "+vc(Ve)+" "){for(et=0;qe=pe[et++];)Be.indexOf(" "+qe+" ")<0&&(Be+=qe+" ");Ve!==(Mt=vc(Be))&&Me.setAttribute("class",Mt)}return this},removeClass:function(q){var pe,Me,Be,Ve,qe,et,Mt,Bt=0;if(ae(q))return this.each(function(Xt){U(this).removeClass(q.call(this,Xt,yc(this)))});if(!arguments.length)return this.attr("class","");if((pe=wh(q)).length)for(;Me=this[Bt++];)if(Ve=yc(Me),Be=1===Me.nodeType&&" "+vc(Ve)+" "){for(et=0;qe=pe[et++];)for(;Be.indexOf(" "+qe+" ")>-1;)Be=Be.replace(" "+qe+" "," ");Ve!==(Mt=vc(Be))&&Me.setAttribute("class",Mt)}return this},toggleClass:function(q,pe){var Me=typeof q,Be="string"===Me||Array.isArray(q);return"boolean"==typeof pe&&Be?pe?this.addClass(q):this.removeClass(q):ae(q)?this.each(function(Ve){U(this).toggleClass(q.call(this,Ve,yc(this),pe),pe)}):this.each(function(){var Ve,qe,et,Mt;if(Be)for(qe=0,et=U(this),Mt=wh(q);Ve=Mt[qe++];)et.hasClass(Ve)?et.removeClass(Ve):et.addClass(Ve);else(void 0===q||"boolean"===Me)&&((Ve=yc(this))&&nr.set(this,"__className__",Ve),this.setAttribute&&this.setAttribute("class",Ve||!1===q?"":nr.get(this,"__className__")||""))})},hasClass:function(q){var pe,Me,Be=0;for(pe=" "+q+" ";Me=this[Be++];)if(1===Me.nodeType&&(" "+vc(yc(Me))+" ").indexOf(pe)>-1)return!0;return!1}});var _u=/\r/g;U.fn.extend({val:function(q){var pe,Me,Be,Ve=this[0];return arguments.length?(Be=ae(q),this.each(function(qe){var et;1===this.nodeType&&(null==(et=Be?q.call(this,qe,U(this).val()):q)?et="":"number"==typeof et?et+="":Array.isArray(et)&&(et=U.map(et,function(Mt){return null==Mt?"":Mt+""})),(!(pe=U.valHooks[this.type]||U.valHooks[this.nodeName.toLowerCase()])||!("set"in pe)||void 0===pe.set(this,et,"value"))&&(this.value=et))})):Ve?(pe=U.valHooks[Ve.type]||U.valHooks[Ve.nodeName.toLowerCase()])&&"get"in pe&&void 0!==(Me=pe.get(Ve,"value"))?Me:"string"==typeof(Me=Ve.value)?Me.replace(_u,""):Me??"":void 0}}),U.extend({valHooks:{option:{get:function(q){return U.find.attr(q,"value")??vc(U.text(q))}},select:{get:function(q){var pe,Me,Be,Ve=q.options,qe=q.selectedIndex,et="select-one"===q.type,Mt=et?null:[],Bt=et?qe+1:Ve.length;for(Be=qe<0?Bt:et?qe:0;Be<Bt;Be++)if(((Me=Ve[Be]).selected||Be===qe)&&!Me.disabled&&(!Me.parentNode.disabled||!Ae(Me.parentNode,"optgroup"))){if(pe=U(Me).val(),et)return pe;Mt.push(pe)}return Mt},set:function(q,pe){for(var Me,Be,Ve=q.options,qe=U.makeArray(pe),et=Ve.length;et--;)((Be=Ve[et]).selected=U.inArray(U.valHooks.option.get(Be),qe)>-1)&&(Me=!0);return Me||(q.selectedIndex=-1),qe}}}}),U.each(["radio","checkbox"],function(){U.valHooks[this]={set:function(q,pe){if(Array.isArray(pe))return q.checked=U.inArray(U(q).val(),pe)>-1}},fe.checkOn||(U.valHooks[this].get=function(q){return null===q.getAttribute("value")?"on":q.value})}),fe.focusin="onfocusin"in n;var qc=/^(?:focusinfocus|focusoutblur)$/,yp=function(q){q.stopPropagation()};U.extend(U.event,{trigger:function(q,pe,Me,Be){var Ve,qe,et,Mt,Bt,Xt,pn,Fn,on=[Me||Z],Sn=ye.call(q,"type")?q.type:q,Er=ye.call(q,"namespace")?q.namespace.split("."):[];if(qe=Fn=et=Me=Me||Z,3!==Me.nodeType&&8!==Me.nodeType&&!qc.test(Sn+U.event.triggered)&&(Sn.indexOf(".")>-1&&(Er=Sn.split("."),Sn=Er.shift(),Er.sort()),Bt=Sn.indexOf(":")<0&&"on"+Sn,(q=q[U.expando]?q:new U.Event(Sn,"object"==typeof q&&q)).isTrigger=Be?2:3,q.namespace=Er.join("."),q.rnamespace=q.namespace?new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,q.result=void 0,q.target||(q.target=Me),pe=null==pe?[q]:U.makeArray(pe,[q]),pn=U.event.special[Sn]||{},Be||!pn.trigger||!1!==pn.trigger.apply(Me,pe))){if(!Be&&!pn.noBubble&&!W(Me)){for(qc.test((Mt=pn.delegateType||Sn)+Sn)||(qe=qe.parentNode);qe;qe=qe.parentNode)on.push(qe),et=qe;et===(Me.ownerDocument||Z)&&on.push(et.defaultView||et.parentWindow||n)}for(Ve=0;(qe=on[Ve++])&&!q.isPropagationStopped();)Fn=qe,q.type=Ve>1?Mt:pn.bindType||Sn,(Xt=(nr.get(qe,"events")||Object.create(null))[q.type]&&nr.get(qe,"handle"))&&Xt.apply(qe,pe),(Xt=Bt&&qe[Bt])&&Xt.apply&&Kr(qe)&&(q.result=Xt.apply(qe,pe),!1===q.result&&q.preventDefault());return q.type=Sn,!Be&&!q.isDefaultPrevented()&&(!pn._default||!1===pn._default.apply(on.pop(),pe))&&Kr(Me)&&Bt&&ae(Me[Sn])&&!W(Me)&&((et=Me[Bt])&&(Me[Bt]=null),U.event.triggered=Sn,q.isPropagationStopped()&&Fn.addEventListener(Sn,yp),Me[Sn](),q.isPropagationStopped()&&Fn.removeEventListener(Sn,yp),U.event.triggered=void 0,et&&(Me[Bt]=et)),q.result}},simulate:function(q,pe,Me){var Be=U.extend(new U.Event,Me,{type:q,isSimulated:!0});U.event.trigger(Be,null,pe)}}),U.fn.extend({trigger:function(q,pe){return this.each(function(){U.event.trigger(q,pe,this)})},triggerHandler:function(q,pe){var Me=this[0];if(Me)return U.event.trigger(q,pe,Me,!0)}}),fe.focusin||U.each({focus:"focusin",blur:"focusout"},function(q,pe){var Me=function(Be){U.event.simulate(pe,Be.target,U.event.fix(Be))};U.event.special[pe]={setup:function(){var Be=this.ownerDocument||this.document||this,Ve=nr.access(Be,pe);Ve||Be.addEventListener(q,Me,!0),nr.access(Be,pe,(Ve||0)+1)},teardown:function(){var Be=this.ownerDocument||this.document||this,Ve=nr.access(Be,pe)-1;Ve?nr.access(Be,pe,Ve):(Be.removeEventListener(q,Me,!0),nr.remove(Be,pe))}}});var Xc=n.location,Qu={guid:Date.now()},Yl=/\?/;U.parseXML=function(q){var pe;if(!q||"string"!=typeof q)return null;try{pe=(new n.DOMParser).parseFromString(q,"text/xml")}catch{pe=void 0}return(!pe||pe.getElementsByTagName("parsererror").length)&&U.error("Invalid XML: "+q),pe};var bp=/\[\]$/,Gh=/\r?\n/g,xp=/^(?:submit|button|image|reset|file)$/i,wp=/^(?:input|select|textarea|keygen)/i;function Hh(q,pe,Me,Be){var Ve;if(Array.isArray(pe))U.each(pe,function(qe,et){Me||bp.test(q)?Be(q,et):Hh(q+"["+("object"==typeof et&&null!=et?qe:"")+"]",et,Me,Be)});else if(Me||"object"!==X(pe))Be(q,pe);else for(Ve in pe)Hh(q+"["+Ve+"]",pe[Ve],Me,Be)}U.param=function(q,pe){var Me,Be=[],Ve=function(qe,et){var Mt=ae(et)?et():et;Be[Be.length]=encodeURIComponent(qe)+"="+encodeURIComponent(Mt??"")};if(null==q)return"";if(Array.isArray(q)||q.jquery&&!U.isPlainObject(q))U.each(q,function(){Ve(this.name,this.value)});else for(Me in q)Hh(Me,q[Me],pe,Ve);return Be.join("&")},U.fn.extend({serialize:function(){return U.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var q=U.prop(this,"elements");return q?U.makeArray(q):this}).filter(function(){var q=this.type;return this.name&&!U(this).is(":disabled")&&wp.test(this.nodeName)&&!xp.test(q)&&(this.checked||!Ir.test(q))}).map(function(q,pe){var Me=U(this).val();return null==Me?null:Array.isArray(Me)?U.map(Me,function(Be){return{name:pe.name,value:Be.replace(Gh,"\r\n")}}):{name:pe.name,value:Me.replace(Gh,"\r\n")}}).get()}});var Wp=/%20/g,gu=/#.*$/,qa=/([?&])_=[^&]*/,bc=/^(.*?):[ \t]*([^\r\n]*)$/gm,Zl=/^(?:GET|HEAD)$/,Ku=/^\/\//,$a={},ua={},Al="*/".concat("*"),eh=Z.createElement("a");function th(q){return function(pe,Me){"string"!=typeof pe&&(Me=pe,pe="*");var Be,Ve=0,qe=pe.toLowerCase().match(sn)||[];if(ae(Me))for(;Be=qe[Ve++];)"+"===Be[0]?(Be=Be.slice(1)||"*",(q[Be]=q[Be]||[]).unshift(Me)):(q[Be]=q[Be]||[]).push(Me)}}function Vh(q,pe,Me,Be){var Ve={},qe=q===ua;function et(Mt){var Bt;return Ve[Mt]=!0,U.each(q[Mt]||[],function(Xt,pn){var Fn=pn(pe,Me,Be);return"string"!=typeof Fn||qe||Ve[Fn]?qe?!(Bt=Fn):void 0:(pe.dataTypes.unshift(Fn),et(Fn),!1)}),Bt}return et(pe.dataTypes[0])||!Ve["*"]&&et("*")}function Sp(q,pe){var Me,Be,Ve=U.ajaxSettings.flatOptions||{};for(Me in pe)void 0!==pe[Me]&&((Ve[Me]?q:Be||(Be={}))[Me]=pe[Me]);return Be&&U.extend(!0,q,Be),q}eh.href=Xc.href,U.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Xc.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Xc.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Al,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":U.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(q,pe){return pe?Sp(Sp(q,U.ajaxSettings),pe):Sp(U.ajaxSettings,q)},ajaxPrefilter:th($a),ajaxTransport:th(ua),ajax:function(q,pe){"object"==typeof q&&(pe=q,q=void 0);var Me,Be,Ve,qe,et,Mt,Bt,Xt,pn,Fn,on=U.ajaxSetup({},pe=pe||{}),Sn=on.context||on,Er=on.context&&(Sn.nodeType||Sn.jquery)?U(Sn):U.event,ti=U.Deferred(),Ar=U.Callbacks("once memory"),ds=on.statusCode||{},es={},ha={},bi="canceled",Br={readyState:0,getResponseHeader:function(Wi){var qi;if(Bt){if(!qe)for(qe={};qi=bc.exec(Ve);)qe[qi[1].toLowerCase()+" "]=(qe[qi[1].toLowerCase()+" "]||[]).concat(qi[2]);qi=qe[Wi.toLowerCase()+" "]}return null==qi?null:qi.join(", ")},getAllResponseHeaders:function(){return Bt?Ve:null},setRequestHeader:function(Wi,qi){return null==Bt&&(Wi=ha[Wi.toLowerCase()]=ha[Wi.toLowerCase()]||Wi,es[Wi]=qi),this},overrideMimeType:function(Wi){return null==Bt&&(on.mimeType=Wi),this},statusCode:function(Wi){var qi;if(Wi)if(Bt)Br.always(Wi[Br.status]);else for(qi in Wi)ds[qi]=[ds[qi],Wi[qi]];return this},abort:function(Wi){var qi=Wi||bi;return Me&&Me.abort(qi),Xa(0,qi),this}};if(ti.promise(Br),on.url=((q||on.url||Xc.href)+"").replace(Ku,Xc.protocol+"//"),on.type=pe.method||pe.type||on.method||on.type,on.dataTypes=(on.dataType||"*").toLowerCase().match(sn)||[""],null==on.crossDomain){Mt=Z.createElement("a");try{Mt.href=on.url,Mt.href=Mt.href,on.crossDomain=eh.protocol+"//"+eh.host!=Mt.protocol+"//"+Mt.host}catch{on.crossDomain=!0}}if(on.data&&on.processData&&"string"!=typeof on.data&&(on.data=U.param(on.data,on.traditional)),Vh($a,on,pe,Br),Bt)return Br;for(pn in(Xt=U.event&&on.global)&&0==U.active++&&U.event.trigger("ajaxStart"),on.type=on.type.toUpperCase(),on.hasContent=!Zl.test(on.type),Be=on.url.replace(gu,""),on.hasContent?on.data&&on.processData&&0===(on.contentType||"").indexOf("application/x-www-form-urlencoded")&&(on.data=on.data.replace(Wp,"+")):(Fn=on.url.slice(Be.length),on.data&&(on.processData||"string"==typeof on.data)&&(Be+=(Yl.test(Be)?"&":"?")+on.data,delete on.data),!1===on.cache&&(Be=Be.replace(qa,"$1"),Fn=(Yl.test(Be)?"&":"?")+"_="+Qu.guid+++Fn),on.url=Be+Fn),on.ifModified&&(U.lastModified[Be]&&Br.setRequestHeader("If-Modified-Since",U.lastModified[Be]),U.etag[Be]&&Br.setRequestHeader("If-None-Match",U.etag[Be])),(on.data&&on.hasContent&&!1!==on.contentType||pe.contentType)&&Br.setRequestHeader("Content-Type",on.contentType),Br.setRequestHeader("Accept",on.dataTypes[0]&&on.accepts[on.dataTypes[0]]?on.accepts[on.dataTypes[0]]+("*"!==on.dataTypes[0]?", "+Al+"; q=0.01":""):on.accepts["*"]),on.headers)Br.setRequestHeader(pn,on.headers[pn]);if(on.beforeSend&&(!1===on.beforeSend.call(Sn,Br,on)||Bt))return Br.abort();if(bi="abort",Ar.add(on.complete),Br.done(on.success),Br.fail(on.error),Me=Vh(ua,on,pe,Br)){if(Br.readyState=1,Xt&&Er.trigger("ajaxSend",[Br,on]),Bt)return Br;on.async&&on.timeout>0&&(et=n.setTimeout(function(){Br.abort("timeout")},on.timeout));try{Bt=!1,Me.send(es,Xa)}catch(Wi){if(Bt)throw Wi;Xa(-1,Wi)}}else Xa(-1,"No Transport");function Xa(Wi,qi,qh,wc){var pa,pl,da,Ri,ks,er=qi;Bt||(Bt=!0,et&&n.clearTimeout(et),Me=void 0,Ve=wc||"",Br.readyState=Wi>0?4:0,pa=Wi>=200&&Wi<300||304===Wi,qh&&(Ri=function Ep(q,pe,Me){for(var Be,Ve,qe,et,Mt=q.contents,Bt=q.dataTypes;"*"===Bt[0];)Bt.shift(),void 0===Be&&(Be=q.mimeType||pe.getResponseHeader("Content-Type"));if(Be)for(Ve in Mt)if(Mt[Ve]&&Mt[Ve].test(Be)){Bt.unshift(Ve);break}if(Bt[0]in Me)qe=Bt[0];else{for(Ve in Me){if(!Bt[0]||q.converters[Ve+" "+Bt[0]]){qe=Ve;break}et||(et=Ve)}qe=qe||et}if(qe)return qe!==Bt[0]&&Bt.unshift(qe),Me[qe]}(on,Br,qh)),!pa&&U.inArray("script",on.dataTypes)>-1&&(on.converters["text script"]=function(){}),Ri=function Ji(q,pe,Me,Be){var Ve,qe,et,Mt,Bt,Xt={},pn=q.dataTypes.slice();if(pn[1])for(et in q.converters)Xt[et.toLowerCase()]=q.converters[et];for(qe=pn.shift();qe;)if(q.responseFields[qe]&&(Me[q.responseFields[qe]]=pe),!Bt&&Be&&q.dataFilter&&(pe=q.dataFilter(pe,q.dataType)),Bt=qe,qe=pn.shift())if("*"===qe)qe=Bt;else if("*"!==Bt&&Bt!==qe){if(!(et=Xt[Bt+" "+qe]||Xt["* "+qe]))for(Ve in Xt)if((Mt=Ve.split(" "))[1]===qe&&(et=Xt[Bt+" "+Mt[0]]||Xt["* "+Mt[0]])){!0===et?et=Xt[Ve]:!0!==Xt[Ve]&&(qe=Mt[0],pn.unshift(Mt[1]));break}if(!0!==et)if(et&&q.throws)pe=et(pe);else try{pe=et(pe)}catch(Fn){return{state:"parsererror",error:et?Fn:"No conversion from "+Bt+" to "+qe}}}return{state:"success",data:pe}}(on,Ri,Br,pa),pa?(on.ifModified&&((ks=Br.getResponseHeader("Last-Modified"))&&(U.lastModified[Be]=ks),(ks=Br.getResponseHeader("etag"))&&(U.etag[Be]=ks)),204===Wi||"HEAD"===on.type?er="nocontent":304===Wi?er="notmodified":(er=Ri.state,pl=Ri.data,pa=!(da=Ri.error))):(da=er,(Wi||!er)&&(er="error",Wi<0&&(Wi=0))),Br.status=Wi,Br.statusText=(qi||er)+"",pa?ti.resolveWith(Sn,[pl,er,Br]):ti.rejectWith(Sn,[Br,er,da]),Br.statusCode(ds),ds=void 0,Xt&&Er.trigger(pa?"ajaxSuccess":"ajaxError",[Br,on,pa?pl:da]),Ar.fireWith(Sn,[Br,er]),Xt&&(Er.trigger("ajaxComplete",[Br,on]),--U.active||U.event.trigger("ajaxStop")))}return Br},getJSON:function(q,pe,Me){return U.get(q,pe,Me,"json")},getScript:function(q,pe){return U.get(q,void 0,pe,"script")}}),U.each(["get","post"],function(q,pe){U[pe]=function(Me,Be,Ve,qe){return ae(Be)&&(qe=qe||Ve,Ve=Be,Be=void 0),U.ajax(U.extend({url:Me,type:pe,dataType:qe,data:Be,success:Ve},U.isPlainObject(Me)&&Me))}}),U.ajaxPrefilter(function(q){var pe;for(pe in q.headers)"content-type"===pe.toLowerCase()&&(q.contentType=q.headers[pe]||"")}),U._evalUrl=function(q,pe,Me){return U.ajax({url:q,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(Be){U.globalEval(Be,pe,Me)}})},U.fn.extend({wrapAll:function(q){var pe;return this[0]&&(ae(q)&&(q=q.call(this[0])),pe=U(q,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&pe.insertBefore(this[0]),pe.map(function(){for(var Me=this;Me.firstElementChild;)Me=Me.firstElementChild;return Me}).append(this)),this},wrapInner:function(q){return ae(q)?this.each(function(pe){U(this).wrapInner(q.call(this,pe))}):this.each(function(){var pe=U(this),Me=pe.contents();Me.length?Me.wrapAll(q):pe.append(q)})},wrap:function(q){var pe=ae(q);return this.each(function(Me){U(this).wrapAll(pe?q.call(this,Me):q)})},unwrap:function(q){return this.parent(q).not("body").each(function(){U(this).replaceWith(this.childNodes)}),this}}),U.expr.pseudos.hidden=function(q){return!U.expr.pseudos.visible(q)},U.expr.pseudos.visible=function(q){return!!(q.offsetWidth||q.offsetHeight||q.getClientRects().length)},U.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var hl={0:200,1223:204},Ql=U.ajaxSettings.xhr();fe.cors=!!Ql&&"withCredentials"in Ql,fe.ajax=Ql=!!Ql,U.ajaxTransport(function(q){var pe,Me;if(fe.cors||Ql&&!q.crossDomain)return{send:function(Be,Ve){var qe,et=q.xhr();if(et.open(q.type,q.url,q.async,q.username,q.password),q.xhrFields)for(qe in q.xhrFields)et[qe]=q.xhrFields[qe];for(qe in q.mimeType&&et.overrideMimeType&&et.overrideMimeType(q.mimeType),!q.crossDomain&&!Be["X-Requested-With"]&&(Be["X-Requested-With"]="XMLHttpRequest"),Be)et.setRequestHeader(qe,Be[qe]);pe=function(Mt){return function(){pe&&(pe=Me=et.onload=et.onerror=et.onabort=et.ontimeout=et.onreadystatechange=null,"abort"===Mt?et.abort():"error"===Mt?"number"!=typeof et.status?Ve(0,"error"):Ve(et.status,et.statusText):Ve(hl[et.status]||et.status,et.statusText,"text"!==(et.responseType||"text")||"string"!=typeof et.responseText?{binary:et.response}:{text:et.responseText},et.getAllResponseHeaders()))}},et.onload=pe(),Me=et.onerror=et.ontimeout=pe("error"),void 0!==et.onabort?et.onabort=Me:et.onreadystatechange=function(){4===et.readyState&&n.setTimeout(function(){pe&&Me()})},pe=pe("abort");try{et.send(q.hasContent&&q.data||null)}catch(Mt){if(pe)throw Mt}},abort:function(){pe&&pe()}}}),U.ajaxPrefilter(function(q){q.crossDomain&&(q.contents.script=!1)}),U.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(q){return U.globalEval(q),q}}}),U.ajaxPrefilter("script",function(q){void 0===q.cache&&(q.cache=!1),q.crossDomain&&(q.type="GET")}),U.ajaxTransport("script",function(q){var pe,Me;if(q.crossDomain||q.scriptAttrs)return{send:function(Be,Ve){pe=U("<script>").attr(q.scriptAttrs||{}).prop({charset:q.scriptCharset,src:q.url}).on("load error",Me=function(qe){pe.remove(),Me=null,qe&&Ve("error"===qe.type?404:200,qe.type)}),Z.head.appendChild(pe[0])},abort:function(){Me&&Me()}}});var q,Yc=[],Wh=/(=)\?(?=&|$)|\?\?/;U.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var q=Yc.pop()||U.expando+"_"+Qu.guid++;return this[q]=!0,q}}),U.ajaxPrefilter("json jsonp",function(q,pe,Me){var Be,Ve,qe,et=!1!==q.jsonp&&(Wh.test(q.url)?"url":"string"==typeof q.data&&0===(q.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wh.test(q.data)&&"data");if(et||"jsonp"===q.dataTypes[0])return Be=q.jsonpCallback=ae(q.jsonpCallback)?q.jsonpCallback():q.jsonpCallback,et?q[et]=q[et].replace(Wh,"$1"+Be):!1!==q.jsonp&&(q.url+=(Yl.test(q.url)?"&":"?")+q.jsonp+"="+Be),q.converters["script json"]=function(){return qe||U.error(Be+" was not called"),qe[0]},q.dataTypes[0]="json",Ve=n[Be],n[Be]=function(){qe=arguments},Me.always(function(){void 0===Ve?U(n).removeProp(Be):n[Be]=Ve,q[Be]&&(q.jsonpCallback=pe.jsonpCallback,Yc.push(Be)),qe&&ae(Ve)&&Ve(qe[0]),qe=Ve=void 0}),"script"}),fe.createHTMLDocument=((q=Z.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===q.childNodes.length),U.parseHTML=function(q,pe,Me){return"string"!=typeof q?[]:("boolean"==typeof pe&&(Me=pe,pe=!1),pe||(fe.createHTMLDocument?((Be=(pe=Z.implementation.createHTMLDocument("")).createElement("base")).href=Z.location.href,pe.head.appendChild(Be)):pe=Z),qe=!Me&&[],(Ve=Xe.exec(q))?[pe.createElement(Ve[1])]:(Ve=kh([q],pe,qe),qe&&qe.length&&U(qe).remove(),U.merge([],Ve.childNodes)));var Be,Ve,qe},U.fn.load=function(q,pe,Me){var Be,Ve,qe,et=this,Mt=q.indexOf(" ");return Mt>-1&&(Be=vc(q.slice(Mt)),q=q.slice(0,Mt)),ae(pe)?(Me=pe,pe=void 0):pe&&"object"==typeof pe&&(Ve="POST"),et.length>0&&U.ajax({url:q,type:Ve||"GET",dataType:"html",data:pe}).done(function(Bt){qe=arguments,et.html(Be?U("<div>").append(U.parseHTML(Bt)).find(Be):Bt)}).always(Me&&function(Bt,Xt){et.each(function(){Me.apply(this,qe||[Bt.responseText,Xt,Bt])})}),this},U.expr.pseudos.animated=function(q){return U.grep(U.timers,function(pe){return q===pe.elem}).length},U.offset={setOffset:function(q,pe,Me){var Be,Ve,qe,et,Mt,Bt,pn=U.css(q,"position"),Fn=U(q),on={};"static"===pn&&(q.style.position="relative"),Mt=Fn.offset(),qe=U.css(q,"top"),Bt=U.css(q,"left"),("absolute"===pn||"fixed"===pn)&&(qe+Bt).indexOf("auto")>-1?(et=(Be=Fn.position()).top,Ve=Be.left):(et=parseFloat(qe)||0,Ve=parseFloat(Bt)||0),ae(pe)&&(pe=pe.call(q,Me,U.extend({},Mt))),null!=pe.top&&(on.top=pe.top-Mt.top+et),null!=pe.left&&(on.left=pe.left-Mt.left+Ve),"using"in pe?pe.using.call(q,on):("number"==typeof on.top&&(on.top+="px"),"number"==typeof on.left&&(on.left+="px"),Fn.css(on))}},U.fn.extend({offset:function(q){if(arguments.length)return void 0===q?this:this.each(function(Ve){U.offset.setOffset(this,q,Ve)});var pe,Me,Be=this[0];return Be?Be.getClientRects().length?{top:(pe=Be.getBoundingClientRect()).top+(Me=Be.ownerDocument.defaultView).pageYOffset,left:pe.left+Me.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var q,pe,Me,Be=this[0],Ve={top:0,left:0};if("fixed"===U.css(Be,"position"))pe=Be.getBoundingClientRect();else{for(pe=this.offset(),Me=Be.ownerDocument,q=Be.offsetParent||Me.documentElement;q&&(q===Me.body||q===Me.documentElement)&&"static"===U.css(q,"position");)q=q.parentNode;q&&q!==Be&&1===q.nodeType&&((Ve=U(q).offset()).top+=U.css(q,"borderTopWidth",!0),Ve.left+=U.css(q,"borderLeftWidth",!0))}return{top:pe.top-Ve.top-U.css(Be,"marginTop",!0),left:pe.left-Ve.left-U.css(Be,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var q=this.offsetParent;q&&"static"===U.css(q,"position");)q=q.offsetParent;return q||So})}}),U.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(q,pe){var Me="pageYOffset"===pe;U.fn[q]=function(Be){return cr(this,function(Ve,qe,et){var Mt;if(W(Ve)?Mt=Ve:9===Ve.nodeType&&(Mt=Ve.defaultView),void 0===et)return Mt?Mt[pe]:Ve[qe];Mt?Mt.scrollTo(Me?Mt.pageXOffset:et,Me?et:Mt.pageYOffset):Ve[qe]=et},q,Be,arguments.length)}}),U.each(["top","left"],function(q,pe){U.cssHooks[pe]=mu(fe.pixelPosition,function(Me,Be){if(Be)return Be=ll(Me,pe),vh.test(Be)?U(Me).position()[pe]+"px":Be})}),U.each({Height:"height",Width:"width"},function(q,pe){U.each({padding:"inner"+q,content:pe,"":"outer"+q},function(Me,Be){U.fn[Be]=function(Ve,qe){var et=arguments.length&&(Me||"boolean"!=typeof Ve),Mt=Me||(!0===Ve||!0===qe?"margin":"border");return cr(this,function(Bt,Xt,pn){var Fn;return W(Bt)?0===Be.indexOf("outer")?Bt["inner"+q]:Bt.document.documentElement["client"+q]:9===Bt.nodeType?(Fn=Bt.documentElement,Math.max(Bt.body["scroll"+q],Fn["scroll"+q],Bt.body["offset"+q],Fn["offset"+q],Fn["client"+q])):void 0===pn?U.css(Bt,Xt,Mt):U.style(Bt,Xt,pn,Mt)},pe,et?Ve:void 0,et)}})}),U.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(q,pe){U.fn[pe]=function(Me){return this.on(pe,Me)}}),U.fn.extend({bind:function(q,pe,Me){return this.on(q,null,pe,Me)},unbind:function(q,pe){return this.off(q,null,pe)},delegate:function(q,pe,Me,Be){return this.on(pe,q,Me,Be)},undelegate:function(q,pe,Me){return 1===arguments.length?this.off(q,"**"):this.off(pe,q||"**",Me)},hover:function(q,pe){return this.mouseenter(q).mouseleave(pe||q)}}),U.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(q,pe){U.fn[pe]=function(Me,Be){return arguments.length>0?this.on(pe,null,Me,Be):this.trigger(pe)}});var xc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;U.proxy=function(q,pe){var Me,Be,Ve;if("string"==typeof pe&&(Me=q[pe],pe=q,q=Me),ae(q))return Be=B.call(arguments,2),Ve=function(){return q.apply(pe||this,Be.concat(B.call(arguments)))},Ve.guid=q.guid=q.guid||U.guid++,Ve},U.holdReady=function(q){q?U.readyWait++:U.ready(!0)},U.isArray=Array.isArray,U.parseJSON=JSON.parse,U.nodeName=Ae,U.isFunction=ae,U.isWindow=W,U.camelCase=ni,U.type=X,U.now=Date.now,U.isNumeric=function(q){var pe=U.type(q);return("number"===pe||"string"===pe)&&!isNaN(q-parseFloat(q))},U.trim=function(q){return null==q?"":(q+"").replace(xc,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return U});var nh=n.jQuery,vu=n.$;return U.noConflict=function(q){return n.$===U&&(n.$=vu),q&&n.jQuery===U&&(n.jQuery=nh),U},typeof o>"u"&&(n.jQuery=n.$=U),U}),function(n,o){"object"==typeof exports&&typeof module<"u"?o(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],o):o((n=typeof globalThis<"u"?globalThis:n||self).bootstrap={},n.jQuery)}(this,function(n,o){"use strict";function l(ke){return ke&&"object"==typeof ke&&"default"in ke?ke:{default:ke}}var x=l(o);function B(ke,De){for(var He=0;He<De.length;He++){var we=De[He];we.enumerable=we.enumerable||!1,we.configurable=!0,"value"in we&&(we.writable=!0),Object.defineProperty(ke,we.key,we)}}function D(ke,De,He){return De&&B(ke.prototype,De),He&&B(ke,He),ke}function G(){return G=Object.assign||function(ke){for(var De=1;De<arguments.length;De++){var He=arguments[De];for(var we in He)Object.prototype.hasOwnProperty.call(He,we)&&(ke[we]=He[we])}return ke},G.apply(this,arguments)}var P="transitionend";function fe(ke){var De=this,He=!1;return x.default(this).one(W.TRANSITION_END,function(){He=!0}),setTimeout(function(){He||W.triggerTransitionEnd(De)},ke),this}var W={TRANSITION_END:"bsTransitionEnd",getUID:function(De){do{De+=~~(1e6*Math.random())}while(document.getElementById(De));return De},getSelectorFromElement:function(De){var He=De.getAttribute("data-target");if(!He||"#"===He){var we=De.getAttribute("href");He=we&&"#"!==we?we.trim():""}try{return document.querySelector(He)?He:null}catch{return null}},getTransitionDurationFromElement:function(De){if(!De)return 0;var He=x.default(De).css("transition-duration"),we=x.default(De).css("transition-delay"),ze=parseFloat(He),Je=parseFloat(we);return ze||Je?(He=He.split(",")[0],we=we.split(",")[0],1e3*(parseFloat(He)+parseFloat(we))):0},reflow:function(De){return De.offsetHeight},triggerTransitionEnd:function(De){x.default(De).trigger(P)},supportsTransitionEnd:function(){return Boolean(P)},isElement:function(De){return(De[0]||De).nodeType},typeCheckConfig:function(De,He,we){for(var ze in we)if(Object.prototype.hasOwnProperty.call(we,ze)){var Je=we[ze],bt=He[ze],Ot=bt&&W.isElement(bt)?"element":null===(ke=bt)||typeof ke>"u"?""+ke:{}.toString.call(ke).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Je).test(Ot))throw new Error(De.toUpperCase()+': Option "'+ze+'" provided type "'+Ot+'" but expected type "'+Je+'".')}var ke},findShadowRoot:function(De){if(!document.documentElement.attachShadow)return null;if("function"==typeof De.getRootNode){var He=De.getRootNode();return He instanceof ShadowRoot?He:null}return De instanceof ShadowRoot?De:De.parentNode?W.findShadowRoot(De.parentNode):null},jQueryDetection:function(){if(typeof x.default>"u")throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var De=x.default.fn.jquery.split(" ")[0].split(".");if(De[0]<2&&De[1]<9||1===De[0]&&9===De[1]&&De[2]<1||De[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};W.jQueryDetection(),function ae(){x.default.fn.emulateTransitionEnd=fe,x.default.event.special[W.TRANSITION_END]=function ce(){return{bindType:P,delegateType:P,handle:function(De){if(x.default(De.target).is(this))return De.handleObj.handler.apply(this,arguments)}}}()}();var Z="alert",R="bs.alert",X="."+R,U=x.default.fn[Z],Q="close"+X,be="closed"+X,Pe="click"+X+".data-api",Ke=function(){function ke(He){this._element=He}var De=ke.prototype;return De.close=function(we){var ze=this._element;we&&(ze=this._getRootElement(we)),this._triggerCloseEvent(ze).isDefaultPrevented()||this._removeElement(ze)},De.dispose=function(){x.default.removeData(this._element,R),this._element=null},De._getRootElement=function(we){var ze=W.getSelectorFromElement(we),Je=!1;return ze&&(Je=document.querySelector(ze)),Je||(Je=x.default(we).closest(".alert")[0]),Je},De._triggerCloseEvent=function(we){var ze=x.default.Event(Q);return x.default(we).trigger(ze),ze},De._removeElement=function(we){var ze=this;if(x.default(we).removeClass("show"),x.default(we).hasClass("fade")){var Je=W.getTransitionDurationFromElement(we);x.default(we).one(W.TRANSITION_END,function(bt){return ze._destroyElement(we,bt)}).emulateTransitionEnd(Je)}else this._destroyElement(we)},De._destroyElement=function(we){x.default(we).detach().trigger(be).remove()},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Je=ze.data(R);Je||(Je=new ke(this),ze.data(R,Je)),"close"===we&&Je[we](this)})},ke._handleDismiss=function(we){return function(ze){ze&&ze.preventDefault(),we.close(this)}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(Pe,'[data-dismiss="alert"]',Ke._handleDismiss(new Ke)),x.default.fn[Z]=Ke._jQueryInterface,x.default.fn[Z].Constructor=Ke,x.default.fn[Z].noConflict=function(){return x.default.fn[Z]=U,Ke._jQueryInterface};var yt="button",It="bs.button",wt="."+It,Gt=".data-api",Dt=x.default.fn[yt],sn="active",Bn='[data-toggle^="button"]',mn='input:not([type="hidden"])',ur="click"+wt+Gt,or="focus"+wt+Gt+" blur"+wt+Gt,ni="load"+wt+Gt,Kr=function(){function ke(He){this._element=He,this.shouldAvoidTriggerChange=!1}var De=ke.prototype;return De.toggle=function(){var we=!0,ze=!0,Je=x.default(this._element).closest('[data-toggle="buttons"]')[0];if(Je){var bt=this._element.querySelector(mn);if(bt){if("radio"===bt.type)if(bt.checked&&this._element.classList.contains(sn))we=!1;else{var Ot=Je.querySelector(".active");Ot&&x.default(Ot).removeClass(sn)}we&&(("checkbox"===bt.type||"radio"===bt.type)&&(bt.checked=!this._element.classList.contains(sn)),this.shouldAvoidTriggerChange||x.default(bt).trigger("change")),bt.focus(),ze=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(ze&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(sn)),we&&x.default(this._element).toggleClass(sn))},De.dispose=function(){x.default.removeData(this._element,It),this._element=null},ke._jQueryInterface=function(we,ze){return this.each(function(){var Je=x.default(this),bt=Je.data(It);bt||(bt=new ke(this),Je.data(It,bt)),bt.shouldAvoidTriggerChange=ze,"toggle"===we&&bt[we]()})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(ur,Bn,function(ke){var De=ke.target,He=De;if(x.default(De).hasClass("btn")||(De=x.default(De).closest(".btn")[0]),!De||De.hasAttribute("disabled")||De.classList.contains("disabled"))ke.preventDefault();else{var we=De.querySelector(mn);if(we&&(we.hasAttribute("disabled")||we.classList.contains("disabled")))return void ke.preventDefault();("INPUT"===He.tagName||"LABEL"!==De.tagName)&&Kr._jQueryInterface.call(x.default(De),"toggle","INPUT"===He.tagName)}}).on(or,Bn,function(ke){var De=x.default(ke.target).closest(".btn")[0];x.default(De).toggleClass("focus",/^focus(in)?$/.test(ke.type))}),x.default(window).on(ni,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),De=0,He=ke.length;De<He;De++){var we=ke[De],ze=we.querySelector(mn);ze.checked||ze.hasAttribute("checked")?we.classList.add(sn):we.classList.remove(sn)}for(var Je=0,bt=(ke=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;Je<bt;Je++){var Ot=ke[Je];"true"===Ot.getAttribute("aria-pressed")?Ot.classList.add(sn):Ot.classList.remove(sn)}}),x.default.fn[yt]=Kr._jQueryInterface,x.default.fn[yt].Constructor=Kr,x.default.fn[yt].noConflict=function(){return x.default.fn[yt]=Dt,Kr._jQueryInterface};var pi="carousel",vr="bs.carousel",mi="."+vr,_o=".data-api",Nr=x.default.fn[pi],So={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Ws={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},la="next",Ni="prev",Jr="slide"+mi,os="slid"+mi,Ir="keydown"+mi,Va="mouseenter"+mi,Hu="mouseleave"+mi,us="touchstart"+mi,qs="touchmove"+mi,ai="touchend"+mi,Gc="pointerdown"+mi,kh="pointerup"+mi,sl="dragstart"+mi,Gp="load"+mi+_o,ca="click"+mi+_o,Wa="active",fu=".active.carousel-item",ao=".carousel-indicators",vh={TOUCH:"touch",PEN:"pen"},To=function(){function ke(He,we){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(we),this._element=He,this._indicatorsElement=this._element.querySelector(ao),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var De=ke.prototype;return De.next=function(){this._isSliding||this._slide(la)},De.nextWhenVisible=function(){var we=x.default(this._element);!document.hidden&&we.is(":visible")&&"hidden"!==we.css("visibility")&&this.next()},De.prev=function(){this._isSliding||this._slide(Ni)},De.pause=function(we){we||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(W.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},De.cycle=function(we){we||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},De.to=function(we){var ze=this;this._activeElement=this._element.querySelector(fu);var Je=this._getItemIndex(this._activeElement);if(!(we>this._items.length-1||we<0)){if(this._isSliding)return void x.default(this._element).one(os,function(){return ze.to(we)});if(Je===we)return this.pause(),void this.cycle();this._slide(we>Je?la:Ni,this._items[we])}},De.dispose=function(){x.default(this._element).off(mi),x.default.removeData(this._element,vr),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},De._getConfig=function(we){return we=G({},So,we),W.typeCheckConfig(pi,we,Ws),we},De._handleSwipe=function(){var we=Math.abs(this.touchDeltaX);if(!(we<=40)){var ze=we/this.touchDeltaX;this.touchDeltaX=0,ze>0&&this.prev(),ze<0&&this.next()}},De._addEventListeners=function(){var we=this;this._config.keyboard&&x.default(this._element).on(Ir,function(ze){return we._keydown(ze)}),"hover"===this._config.pause&&x.default(this._element).on(Va,function(ze){return we.pause(ze)}).on(Hu,function(ze){return we.cycle(ze)}),this._config.touch&&this._addTouchEventListeners()},De._addTouchEventListeners=function(){var we=this;if(this._touchSupported){var ze=function(Wt){we._pointerEvent&&vh[Wt.originalEvent.pointerType.toUpperCase()]?we.touchStartX=Wt.originalEvent.clientX:we._pointerEvent||(we.touchStartX=Wt.originalEvent.touches[0].clientX)},bt=function(Wt){we._pointerEvent&&vh[Wt.originalEvent.pointerType.toUpperCase()]&&(we.touchDeltaX=Wt.originalEvent.clientX-we.touchStartX),we._handleSwipe(),"hover"===we._config.pause&&(we.pause(),we.touchTimeout&&clearTimeout(we.touchTimeout),we.touchTimeout=setTimeout(function(In){return we.cycle(In)},500+we._config.interval))};x.default(this._element.querySelectorAll(".carousel-item img")).on(sl,function(Ot){return Ot.preventDefault()}),this._pointerEvent?(x.default(this._element).on(Gc,function(Ot){return ze(Ot)}),x.default(this._element).on(kh,function(Ot){return bt(Ot)}),this._element.classList.add("pointer-event")):(x.default(this._element).on(us,function(Ot){return ze(Ot)}),x.default(this._element).on(qs,function(Ot){var Wt;we.touchDeltaX=(Wt=Ot).originalEvent.touches&&Wt.originalEvent.touches.length>1?0:Wt.originalEvent.touches[0].clientX-we.touchStartX}),x.default(this._element).on(ai,function(Ot){return bt(Ot)}))}},De._keydown=function(we){if(!/input|textarea/i.test(we.target.tagName))switch(we.which){case 37:we.preventDefault(),this.prev();break;case 39:we.preventDefault(),this.next()}},De._getItemIndex=function(we){return this._items=we&&we.parentNode?[].slice.call(we.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(we)},De._getItemByDirection=function(we,ze){var Je=we===la,bt=we===Ni,Ot=this._getItemIndex(ze);if((bt&&0===Ot||Je&&Ot===this._items.length-1)&&!this._config.wrap)return ze;var Gn=(Ot+(we===Ni?-1:1))%this._items.length;return-1===Gn?this._items[this._items.length-1]:this._items[Gn]},De._triggerSlideEvent=function(we,ze){var Je=this._getItemIndex(we),bt=this._getItemIndex(this._element.querySelector(fu)),Ot=x.default.Event(Jr,{relatedTarget:we,direction:ze,from:bt,to:Je});return x.default(this._element).trigger(Ot),Ot},De._setActiveIndicatorElement=function(we){if(this._indicatorsElement){var ze=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));x.default(ze).removeClass(Wa);var Je=this._indicatorsElement.children[this._getItemIndex(we)];Je&&x.default(Je).addClass(Wa)}},De._slide=function(we,ze){var Gn,Cr,Dr,Je=this,bt=this._element.querySelector(fu),Ot=this._getItemIndex(bt),Wt=ze||bt&&this._getItemByDirection(we,bt),In=this._getItemIndex(Wt),Tn=Boolean(this._interval);if(we===la?(Gn="carousel-item-left",Cr="carousel-item-next",Dr="left"):(Gn="carousel-item-right",Cr="carousel-item-prev",Dr="right"),Wt&&x.default(Wt).hasClass(Wa))this._isSliding=!1;else if(!this._triggerSlideEvent(Wt,Dr).isDefaultPrevented()&&bt&&Wt){this._isSliding=!0,Tn&&this.pause(),this._setActiveIndicatorElement(Wt);var Qt=x.default.Event(os,{relatedTarget:Wt,direction:Dr,from:Ot,to:In});if(x.default(this._element).hasClass("slide")){x.default(Wt).addClass(Cr),W.reflow(Wt),x.default(bt).addClass(Gn),x.default(Wt).addClass(Gn);var Ao=parseInt(Wt.getAttribute("data-interval"),10);Ao?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=Ao):this._config.interval=this._config.defaultInterval||this._config.interval;var ic=W.getTransitionDurationFromElement(bt);x.default(bt).one(W.TRANSITION_END,function(){x.default(Wt).removeClass(Gn+" "+Cr).addClass(Wa),x.default(bt).removeClass(Wa+" "+Cr+" "+Gn),Je._isSliding=!1,setTimeout(function(){return x.default(Je._element).trigger(Qt)},0)}).emulateTransitionEnd(ic)}else x.default(bt).removeClass(Wa),x.default(Wt).addClass(Wa),this._isSliding=!1,x.default(this._element).trigger(Qt);Tn&&this.cycle()}},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(vr),Je=G({},So,x.default(this).data());"object"==typeof we&&(Je=G({},Je,we));var bt="string"==typeof we?we:Je.slide;if(ze||(ze=new ke(this,Je),x.default(this).data(vr,ze)),"number"==typeof we)ze.to(we);else if("string"==typeof bt){if(typeof ze[bt]>"u")throw new TypeError('No method named "'+bt+'"');ze[bt]()}else Je.interval&&Je.ride&&(ze.pause(),ze.cycle())})},ke._dataApiClickHandler=function(we){var ze=W.getSelectorFromElement(this);if(ze){var Je=x.default(ze)[0];if(Je&&x.default(Je).hasClass("carousel")){var bt=G({},x.default(Je).data(),x.default(this).data()),Ot=this.getAttribute("data-slide-to");Ot&&(bt.interval=!1),ke._jQueryInterface.call(x.default(Je),bt),Ot&&x.default(Je).data(vr).to(Ot),we.preventDefault()}}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return So}}]),ke}();x.default(document).on(ca,"[data-slide], [data-slide-to]",To._dataApiClickHandler),x.default(window).on(Gp,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),De=0,He=ke.length;De<He;De++){var we=x.default(ke[De]);To._jQueryInterface.call(we,we.data())}}),x.default.fn[pi]=To._jQueryInterface,x.default.fn[pi].Constructor=To,x.default.fn[pi].noConflict=function(){return x.default.fn[pi]=Nr,To._jQueryInterface};var Ys="collapse",ll="bs.collapse",mu="."+ll,mp=x.default.fn[Ys],yh={toggle:!0,parent:""},Fh={toggle:"boolean",parent:"(string|element)"},mc="show"+mu,Dh="shown"+mu,bh="hide"+mu,Uh="hidden"+mu,Tl="click"+mu+".data-api",Ml="show",ql="collapse",qu="collapsing",ps="collapsed",gp='[data-toggle="collapse"]',Wc=function(){function ke(He,we){this._isTransitioning=!1,this._element=He,this._config=this._getConfig(we),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+He.id+'"],[data-toggle="collapse"][data-target="#'+He.id+'"]'));for(var ze=[].slice.call(document.querySelectorAll(gp)),Je=0,bt=ze.length;Je<bt;Je++){var Ot=ze[Je],Wt=W.getSelectorFromElement(Ot),In=[].slice.call(document.querySelectorAll(Wt)).filter(function(Tn){return Tn===He});null!==Wt&&In.length>0&&(this._selector=Wt,this._triggerArray.push(Ot))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var De=ke.prototype;return De.toggle=function(){x.default(this._element).hasClass(Ml)?this.hide():this.show()},De.show=function(){var ze,Je,we=this;if(!(this._isTransitioning||x.default(this._element).hasClass(Ml)||(this._parent&&0===(ze=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(Cr){return"string"==typeof we._config.parent?Cr.getAttribute("data-parent")===we._config.parent:Cr.classList.contains(ql)})).length&&(ze=null),ze&&(Je=x.default(ze).not(this._selector).data(ll),Je&&Je._isTransitioning)))){var bt=x.default.Event(mc);if(x.default(this._element).trigger(bt),!bt.isDefaultPrevented()){ze&&(ke._jQueryInterface.call(x.default(ze).not(this._selector),"hide"),Je||x.default(ze).data(ll,null));var Ot=this._getDimension();x.default(this._element).removeClass(ql).addClass(qu),this._element.style[Ot]=0,this._triggerArray.length&&x.default(this._triggerArray).removeClass(ps).attr("aria-expanded",!0),this.setTransitioning(!0);var Tn="scroll"+(Ot[0].toUpperCase()+Ot.slice(1)),Gn=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(){x.default(we._element).removeClass(qu).addClass(ql+" "+Ml),we._element.style[Ot]="",we.setTransitioning(!1),x.default(we._element).trigger(Dh)}).emulateTransitionEnd(Gn),this._element.style[Ot]=this._element[Tn]+"px"}}},De.hide=function(){var we=this;if(!this._isTransitioning&&x.default(this._element).hasClass(Ml)){var ze=x.default.Event(bh);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){var Je=this._getDimension();this._element.style[Je]=this._element.getBoundingClientRect()[Je]+"px",W.reflow(this._element),x.default(this._element).addClass(qu).removeClass(ql+" "+Ml);var bt=this._triggerArray.length;if(bt>0)for(var Ot=0;Ot<bt;Ot++){var Wt=this._triggerArray[Ot],In=W.getSelectorFromElement(Wt);null!==In&&(x.default([].slice.call(document.querySelectorAll(In))).hasClass(Ml)||x.default(Wt).addClass(ps).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[Je]="";var Cr=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(){we.setTransitioning(!1),x.default(we._element).removeClass(qu).addClass(ql).trigger(Uh)}).emulateTransitionEnd(Cr)}}},De.setTransitioning=function(we){this._isTransitioning=we},De.dispose=function(){x.default.removeData(this._element,ll),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},De._getConfig=function(we){return(we=G({},yh,we)).toggle=Boolean(we.toggle),W.typeCheckConfig(Ys,we,Fh),we},De._getDimension=function(){return x.default(this._element).hasClass("width")?"width":"height"},De._getParent=function(){var ze,we=this;W.isElement(this._config.parent)?(ze=this._config.parent,typeof this._config.parent.jquery<"u"&&(ze=this._config.parent[0])):ze=document.querySelector(this._config.parent);var bt=[].slice.call(ze.querySelectorAll('[data-toggle="collapse"][data-parent="'+this._config.parent+'"]'));return x.default(bt).each(function(Ot,Wt){we._addAriaAndCollapsedClass(ke._getTargetFromElement(Wt),[Wt])}),ze},De._addAriaAndCollapsedClass=function(we,ze){var Je=x.default(we).hasClass(Ml);ze.length&&x.default(ze).toggleClass(ps,!Je).attr("aria-expanded",Je)},ke._getTargetFromElement=function(we){var ze=W.getSelectorFromElement(we);return ze?document.querySelector(ze):null},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Je=ze.data(ll),bt=G({},yh,ze.data(),"object"==typeof we&&we?we:{});if(!Je&&bt.toggle&&"string"==typeof we&&/show|hide/.test(we)&&(bt.toggle=!1),Je||(Je=new ke(this,bt),ze.data(ll,Je)),"string"==typeof we){if(typeof Je[we]>"u")throw new TypeError('No method named "'+we+'"');Je[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return yh}}]),ke}();x.default(document).on(Tl,gp,function(ke){"A"===ke.currentTarget.tagName&&ke.preventDefault();var De=x.default(this),He=W.getSelectorFromElement(this),we=[].slice.call(document.querySelectorAll(He));x.default(we).each(function(){var ze=x.default(this),bt=ze.data(ll)?"toggle":De.data();Wc._jQueryInterface.call(ze,bt)})}),x.default.fn[Ys]=Wc._jQueryInterface,x.default.fn[Ys].Constructor=Wc,x.default.fn[Ys].noConflict=function(){return x.default.fn[Ys]=mp,Wc._jQueryInterface};var _c=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",xh=function(){for(var ke=["Edge","Trident","Firefox"],De=0;De<ke.length;De+=1)if(_c&&navigator.userAgent.indexOf(ke[De])>=0)return 1;return 0}(),cl=_c&&window.Promise?function vp(ke){var De=!1;return function(){De||(De=!0,window.Promise.resolve().then(function(){De=!1,ke()}))}}:function Yu(ke){var De=!1;return function(){De||(De=!0,setTimeout(function(){De=!1,ke()},xh))}};function zh(ke){return ke&&"[object Function]"==={}.toString.call(ke)}function ul(ke,De){if(1!==ke.nodeType)return[];var we=ke.ownerDocument.defaultView.getComputedStyle(ke,null);return De?we[De]:we}function jh(ke){return"HTML"===ke.nodeName?ke:ke.parentNode||ke.host}function Zu(ke){if(!ke)return document.body;switch(ke.nodeName){case"HTML":case"BODY":return ke.ownerDocument.body;case"#document":return ke.body}var De=ul(ke);return/(auto|scroll|overlay)/.test(De.overflow+De.overflowY+De.overflowX)?ke:Zu(jh(ke))}function vc(ke){return ke&&ke.referenceNode?ke.referenceNode:ke}var yc=_c&&!(!window.MSInputMethodContext||!document.documentMode),wh=_c&&/MSIE 10/.test(navigator.userAgent);function _u(ke){return 11===ke?yc:10===ke?wh:yc||wh}function qc(ke){if(!ke)return document.documentElement;for(var De=_u(10)?document.body:null,He=ke.offsetParent||null;He===De&&ke.nextElementSibling;)He=(ke=ke.nextElementSibling).offsetParent;var we=He&&He.nodeName;return we&&"BODY"!==we&&"HTML"!==we?-1!==["TH","TD","TABLE"].indexOf(He.nodeName)&&"static"===ul(He,"position")?qc(He):He:ke?ke.ownerDocument.documentElement:document.documentElement}function Xc(ke){return null!==ke.parentNode?Xc(ke.parentNode):ke}function Qu(ke,De){if(!(ke&&ke.nodeType&&De&&De.nodeType))return document.documentElement;var He=ke.compareDocumentPosition(De)&Node.DOCUMENT_POSITION_FOLLOWING,we=He?ke:De,ze=He?De:ke,Je=document.createRange();Je.setStart(we,0),Je.setEnd(ze,0);var bt=Je.commonAncestorContainer;if(ke!==bt&&De!==bt||we.contains(ze))return function yp(ke){var De=ke.nodeName;return"BODY"!==De&&("HTML"===De||qc(ke.firstElementChild)===ke)}(bt)?bt:qc(bt);var Ot=Xc(ke);return Ot.host?Qu(Ot.host,De):Qu(ke,Xc(De).host)}function Yl(ke){var He="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",we=ke.nodeName;return"BODY"===we||"HTML"===we?(ke.ownerDocument.scrollingElement||ke.ownerDocument.documentElement)[He]:ke[He]}function Gh(ke,De){var He="x"===De?"Left":"Top",we="Left"===He?"Right":"Bottom";return parseFloat(ke["border"+He+"Width"])+parseFloat(ke["border"+we+"Width"])}function xp(ke,De,He,we){return Math.max(De["offset"+ke],De["scroll"+ke],He["client"+ke],He["offset"+ke],He["scroll"+ke],_u(10)?parseInt(He["offset"+ke])+parseInt(we["margin"+("Height"===ke?"Top":"Left")])+parseInt(we["margin"+("Height"===ke?"Bottom":"Right")]):0)}function wp(ke){var De=ke.body,He=ke.documentElement,we=_u(10)&&getComputedStyle(He);return{height:xp("Height",De,He,we),width:xp("Width",De,He,we)}}var Hh=function(ke,De){if(!(ke instanceof De))throw new TypeError("Cannot call a class as a function")},Wp=function(){function ke(De,He){for(var we=0;we<He.length;we++){var ze=He[we];ze.enumerable=ze.enumerable||!1,ze.configurable=!0,"value"in ze&&(ze.writable=!0),Object.defineProperty(De,ze.key,ze)}}return function(De,He,we){return He&&ke(De.prototype,He),we&&ke(De,we),De}}(),gu=function(ke,De,He){return De in ke?Object.defineProperty(ke,De,{value:He,enumerable:!0,configurable:!0,writable:!0}):ke[De]=He,ke},qa=Object.assign||function(ke){for(var De=1;De<arguments.length;De++){var He=arguments[De];for(var we in He)Object.prototype.hasOwnProperty.call(He,we)&&(ke[we]=He[we])}return ke};function bc(ke){return qa({},ke,{right:ke.left+ke.width,bottom:ke.top+ke.height})}function Jl(ke){var De={};try{if(_u(10)){De=ke.getBoundingClientRect();var He=Yl(ke,"top"),we=Yl(ke,"left");De.top+=He,De.left+=we,De.bottom+=He,De.right+=we}else De=ke.getBoundingClientRect()}catch{}var ze={left:De.left,top:De.top,width:De.right-De.left,height:De.bottom-De.top},Je="HTML"===ke.nodeName?wp(ke.ownerDocument):{},Wt=ke.offsetWidth-(Je.width||ke.clientWidth||ze.width),In=ke.offsetHeight-(Je.height||ke.clientHeight||ze.height);if(Wt||In){var Tn=ul(ke);Wt-=Gh(Tn,"x"),In-=Gh(Tn,"y"),ze.width-=Wt,ze.height-=In}return bc(ze)}function Zl(ke,De){var He=arguments.length>2&&void 0!==arguments[2]&&arguments[2],we=_u(10),ze="HTML"===De.nodeName,Je=Jl(ke),bt=Jl(De),Ot=Zu(ke),Wt=ul(De),In=parseFloat(Wt.borderTopWidth),Tn=parseFloat(Wt.borderLeftWidth);He&&ze&&(bt.top=Math.max(bt.top,0),bt.left=Math.max(bt.left,0));var Gn=bc({top:Je.top-bt.top-In,left:Je.left-bt.left-Tn,width:Je.width,height:Je.height});if(Gn.marginTop=0,Gn.marginLeft=0,!we&&ze){var Cr=parseFloat(Wt.marginTop),Dr=parseFloat(Wt.marginLeft);Gn.top-=In-Cr,Gn.bottom-=In-Cr,Gn.left-=Tn-Dr,Gn.right-=Tn-Dr,Gn.marginTop=Cr,Gn.marginLeft=Dr}return(we&&!He?De.contains(Ot):De===Ot&&"BODY"!==Ot.nodeName)&&(Gn=function bp(ke,De){var He=arguments.length>2&&void 0!==arguments[2]&&arguments[2],we=Yl(De,"top"),ze=Yl(De,"left"),Je=He?-1:1;return ke.top+=we*Je,ke.bottom+=we*Je,ke.left+=ze*Je,ke.right+=ze*Je,ke}(Gn,De)),Gn}function $a(ke){var De=ke.nodeName;if("BODY"===De||"HTML"===De)return!1;if("fixed"===ul(ke,"position"))return!0;var He=jh(ke);return!!He&&$a(He)}function ua(ke){if(!ke||!ke.parentElement||_u())return document.documentElement;for(var De=ke.parentElement;De&&"none"===ul(De,"transform");)De=De.parentElement;return De||document.documentElement}function Al(ke,De,He,we){var ze=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Je={top:0,left:0},bt=ze?ua(ke):Qu(ke,vc(De));if("viewport"===we)Je=function Ku(ke){var De=arguments.length>1&&void 0!==arguments[1]&&arguments[1],He=ke.ownerDocument.documentElement,we=Zl(ke,He),ze=Math.max(He.clientWidth,window.innerWidth||0),Je=Math.max(He.clientHeight,window.innerHeight||0),bt=De?0:Yl(He),Ot=De?0:Yl(He,"left");return bc({top:bt-we.top+we.marginTop,left:Ot-we.left+we.marginLeft,width:ze,height:Je})}(bt,ze);else{var Ot=void 0;"scrollParent"===we?"BODY"===(Ot=Zu(jh(De))).nodeName&&(Ot=ke.ownerDocument.documentElement):Ot="window"===we?ke.ownerDocument.documentElement:we;var Wt=Zl(Ot,bt,ze);if("HTML"!==Ot.nodeName||$a(bt))Je=Wt;else{var In=wp(ke.ownerDocument),Tn=In.height,Gn=In.width;Je.top+=Wt.top-Wt.marginTop,Je.bottom=Tn+Wt.top,Je.left+=Wt.left-Wt.marginLeft,Je.right=Gn+Wt.left}}var Cr="number"==typeof(He=He||0);return Je.left+=Cr?He:He.left||0,Je.top+=Cr?He:He.top||0,Je.right-=Cr?He:He.right||0,Je.bottom-=Cr?He:He.bottom||0,Je}function eh(ke){return ke.width*ke.height}function th(ke,De,He,we,ze){var Je=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===ke.indexOf("auto"))return ke;var bt=Al(He,we,Je,ze),Ot={top:{width:bt.width,height:De.top-bt.top},right:{width:bt.right-De.right,height:bt.height},bottom:{width:bt.width,height:bt.bottom-De.bottom},left:{width:De.left-bt.left,height:bt.height}},Wt=Object.keys(Ot).map(function(Cr){return qa({key:Cr},Ot[Cr],{area:eh(Ot[Cr])})}).sort(function(Cr,Dr){return Dr.area-Cr.area}),In=Wt.filter(function(Cr){return Cr.width>=He.clientWidth&&Cr.height>=He.clientHeight}),Tn=In.length>0?In[0].key:Wt[0].key,Gn=ke.split("-")[1];return Tn+(Gn?"-"+Gn:"")}function Vh(ke,De,He){var we=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return Zl(He,we?ua(De):Qu(De,vc(He)),we)}function Sp(ke){var He=ke.ownerDocument.defaultView.getComputedStyle(ke),we=parseFloat(He.marginTop||0)+parseFloat(He.marginBottom||0),ze=parseFloat(He.marginLeft||0)+parseFloat(He.marginRight||0);return{width:ke.offsetWidth+ze,height:ke.offsetHeight+we}}function Ep(ke){var De={left:"right",right:"left",bottom:"top",top:"bottom"};return ke.replace(/left|right|bottom|top/g,function(He){return De[He]})}function Ji(ke,De,He){He=He.split("-")[0];var we=Sp(ke),ze={width:we.width,height:we.height},Je=-1!==["right","left"].indexOf(He),bt=Je?"top":"left",Ot=Je?"left":"top",Wt=Je?"height":"width",In=Je?"width":"height";return ze[bt]=De[bt]+De[Wt]/2-we[Wt]/2,ze[Ot]=He===Ot?De[Ot]-we[In]:De[Ep(Ot)],ze}function hl(ke,De){return Array.prototype.find?ke.find(De):ke.filter(De)[0]}function Yc(ke,De,He){var we=void 0===He?ke:ke.slice(0,function Ql(ke,De,He){if(Array.prototype.findIndex)return ke.findIndex(function(ze){return ze[De]===He});var we=hl(ke,function(ze){return ze[De]===He});return ke.indexOf(we)}(ke,"name",He));return we.forEach(function(ze){ze.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Je=ze.function||ze.fn;ze.enabled&&zh(Je)&&(De.offsets.popper=bc(De.offsets.popper),De.offsets.reference=bc(De.offsets.reference),De=Je(De,ze))}),De}function Wh(){if(!this.state.isDestroyed){var ke={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};ke.offsets.reference=Vh(this.state,this.popper,this.reference,this.options.positionFixed),ke.placement=th(this.options.placement,ke.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),ke.originalPlacement=ke.placement,ke.positionFixed=this.options.positionFixed,ke.offsets.popper=Ji(this.popper,ke.offsets.reference,ke.placement),ke.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",ke=Yc(this.modifiers,ke),this.state.isCreated?this.options.onUpdate(ke):(this.state.isCreated=!0,this.options.onCreate(ke))}}function xc(ke,De){return ke.some(function(He){return He.enabled&&He.name===De})}function nh(ke){for(var De=[!1,"ms","Webkit","Moz","O"],He=ke.charAt(0).toUpperCase()+ke.slice(1),we=0;we<De.length;we++){var ze=De[we],Je=ze?""+ze+He:ke;if(typeof document.body.style[Je]<"u")return Je}return null}function vu(){return this.state.isDestroyed=!0,xc(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[nh("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function q(ke){var De=ke.ownerDocument;return De?De.defaultView:window}function pe(ke,De,He,we){var ze="BODY"===ke.nodeName,Je=ze?ke.ownerDocument.defaultView:ke;Je.addEventListener(De,He,{passive:!0}),ze||pe(Zu(Je.parentNode),De,He,we),we.push(Je)}function Me(ke,De,He,we){He.updateBound=we,q(ke).addEventListener("resize",He.updateBound,{passive:!0});var ze=Zu(ke);return pe(ze,"scroll",He.updateBound,He.scrollParents),He.scrollElement=ze,He.eventsEnabled=!0,He}function Be(){this.state.eventsEnabled||(this.state=Me(this.reference,0,this.state,this.scheduleUpdate))}function qe(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function Ve(ke,De){return q(ke).removeEventListener("resize",De.updateBound),De.scrollParents.forEach(function(He){He.removeEventListener("scroll",De.updateBound)}),De.updateBound=null,De.scrollParents=[],De.scrollElement=null,De.eventsEnabled=!1,De}(this.reference,this.state))}function et(ke){return""!==ke&&!isNaN(parseFloat(ke))&&isFinite(ke)}function Mt(ke,De){Object.keys(De).forEach(function(He){var we="";-1!==["width","height","top","right","bottom","left"].indexOf(He)&&et(De[He])&&(we="px"),ke.style[He]=De[He]+we})}var on=_c&&/Firefox/i.test(navigator.userAgent);function Er(ke,De,He){var we=hl(ke,function(Ot){return Ot.name===De}),ze=!!we&&ke.some(function(Ot){return Ot.name===He&&Ot.enabled&&Ot.order<we.order});if(!ze){var Je="`"+De+"`";console.warn("`"+He+"` modifier is required by "+Je+" modifier in order to work, be sure to include it before "+Je+"!")}return ze}var ds=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],es=ds.slice(3);function ha(ke){var De=arguments.length>1&&void 0!==arguments[1]&&arguments[1],He=es.indexOf(ke),we=es.slice(He+1).concat(es.slice(0,He));return De?we.reverse():we}var bi_FLIP="flip",bi_CLOCKWISE="clockwise",bi_COUNTERCLOCKWISE="counterclockwise";var ks={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function pa(ke){var De=ke.placement,He=De.split("-")[0],we=De.split("-")[1];if(we){var ze=ke.offsets,Je=ze.reference,bt=ze.popper,Ot=-1!==["bottom","top"].indexOf(He),Wt=Ot?"left":"top",In=Ot?"width":"height",Tn={start:gu({},Wt,Je[Wt]),end:gu({},Wt,Je[Wt]+Je[In]-bt[In])};ke.offsets.popper=qa({},bt,Tn[we])}return ke}},offset:{order:200,enabled:!0,fn:function qh(ke,De){var Wt,He=De.offset,ze=ke.offsets,Je=ze.popper,bt=ze.reference,Ot=ke.placement.split("-")[0];return Wt=et(+He)?[+He,0]:function qi(ke,De,He,we){var ze=[0,0],Je=-1!==["right","left"].indexOf(we),bt=ke.split(/(\+|\-)/).map(function(Tn){return Tn.trim()}),Ot=bt.indexOf(hl(bt,function(Tn){return-1!==Tn.search(/,|\s/)}));bt[Ot]&&-1===bt[Ot].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var Wt=/\s*,\s*|\s+/,In=-1!==Ot?[bt.slice(0,Ot).concat([bt[Ot].split(Wt)[0]]),[bt[Ot].split(Wt)[1]].concat(bt.slice(Ot+1))]:[bt];return In=In.map(function(Tn,Gn){var Cr=(1===Gn?!Je:Je)?"height":"width",Dr=!1;return Tn.reduce(function(Lr,Qt){return""===Lr[Lr.length-1]&&-1!==["+","-"].indexOf(Qt)?(Lr[Lr.length-1]=Qt,Dr=!0,Lr):Dr?(Lr[Lr.length-1]+=Qt,Dr=!1,Lr):Lr.concat(Qt)},[]).map(function(Lr){return function Wi(ke,De,He,we){var ze=ke.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Je=+ze[1],bt=ze[2];return Je?0===bt.indexOf("%")?bc("%p"===bt?He:we)[De]/100*Je:"vh"===bt||"vw"===bt?("vh"===bt?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*Je:Je:ke}(Lr,Cr,De,He)})}),In.forEach(function(Tn,Gn){Tn.forEach(function(Cr,Dr){et(Cr)&&(ze[Gn]+=Cr*("-"===Tn[Dr-1]?-1:1))})}),ze}(He,Je,bt,Ot),"left"===Ot?(Je.top+=Wt[0],Je.left-=Wt[1]):"right"===Ot?(Je.top+=Wt[0],Je.left+=Wt[1]):"top"===Ot?(Je.left+=Wt[0],Je.top-=Wt[1]):"bottom"===Ot&&(Je.left+=Wt[0],Je.top+=Wt[1]),ke.popper=Je,ke},offset:0},preventOverflow:{order:300,enabled:!0,fn:function wc(ke,De){var He=De.boundariesElement||qc(ke.instance.popper);ke.instance.reference===He&&(He=qc(He));var we=nh("transform"),ze=ke.instance.popper.style,Je=ze.top,bt=ze.left,Ot=ze[we];ze.top="",ze.left="",ze[we]="";var Wt=Al(ke.instance.popper,ke.instance.reference,De.padding,He,ke.positionFixed);ze.top=Je,ze.left=bt,ze[we]=Ot,De.boundaries=Wt;var Tn=ke.offsets.popper,Gn={primary:function(Dr){var Lr=Tn[Dr];return Tn[Dr]<Wt[Dr]&&!De.escapeWithReference&&(Lr=Math.max(Tn[Dr],Wt[Dr])),gu({},Dr,Lr)},secondary:function(Dr){var Lr="right"===Dr?"left":"top",Qt=Tn[Lr];return Tn[Dr]>Wt[Dr]&&!De.escapeWithReference&&(Qt=Math.min(Tn[Lr],Wt[Dr]-("right"===Dr?Tn.width:Tn.height))),gu({},Lr,Qt)}};return De.priority.forEach(function(Cr){var Dr=-1!==["left","top"].indexOf(Cr)?"primary":"secondary";Tn=qa({},Tn,Gn[Dr](Cr))}),ke.offsets.popper=Tn,ke},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function Xa(ke){var De=ke.offsets,He=De.popper,we=De.reference,ze=ke.placement.split("-")[0],Je=Math.floor,bt=-1!==["top","bottom"].indexOf(ze),Ot=bt?"right":"bottom",Wt=bt?"left":"top",In=bt?"width":"height";return He[Ot]<Je(we[Wt])&&(ke.offsets.popper[Wt]=Je(we[Wt])-He[In]),He[Wt]>Je(we[Ot])&&(ke.offsets.popper[Wt]=Je(we[Ot])),ke}},arrow:{order:500,enabled:!0,fn:function ti(ke,De){var He;if(!Er(ke.instance.modifiers,"arrow","keepTogether"))return ke;var we=De.element;if("string"==typeof we){if(!(we=ke.instance.popper.querySelector(we)))return ke}else if(!ke.instance.popper.contains(we))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),ke;var ze=ke.placement.split("-")[0],Je=ke.offsets,bt=Je.popper,Ot=Je.reference,Wt=-1!==["left","right"].indexOf(ze),In=Wt?"height":"width",Tn=Wt?"Top":"Left",Gn=Tn.toLowerCase(),Cr=Wt?"left":"top",Dr=Wt?"bottom":"right",Lr=Sp(we)[In];Ot[Dr]-Lr<bt[Gn]&&(ke.offsets.popper[Gn]-=bt[Gn]-(Ot[Dr]-Lr)),Ot[Gn]+Lr>bt[Dr]&&(ke.offsets.popper[Gn]+=Ot[Gn]+Lr-bt[Dr]),ke.offsets.popper=bc(ke.offsets.popper);var Qt=Ot[Gn]+Ot[In]/2-Lr/2,Ao=ul(ke.instance.popper),ic=parseFloat(Ao["margin"+Tn]),el=parseFloat(Ao["border"+Tn+"Width"]),Qr=Qt-ke.offsets.popper[Gn]-ic-el;return Qr=Math.max(Math.min(bt[In]-Lr,Qr),0),ke.arrowElement=we,ke.offsets.arrow=(gu(He={},Gn,Math.round(Qr)),gu(He,Cr,""),He),ke},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function Br(ke,De){if(xc(ke.instance.modifiers,"inner")||ke.flipped&&ke.placement===ke.originalPlacement)return ke;var He=Al(ke.instance.popper,ke.instance.reference,De.padding,De.boundariesElement,ke.positionFixed),we=ke.placement.split("-")[0],ze=Ep(we),Je=ke.placement.split("-")[1]||"",bt=[];switch(De.behavior){case bi_FLIP:bt=[we,ze];break;case bi_CLOCKWISE:bt=ha(we);break;case bi_COUNTERCLOCKWISE:bt=ha(we,!0);break;default:bt=De.behavior}return bt.forEach(function(Ot,Wt){if(we!==Ot||bt.length===Wt+1)return ke;we=ke.placement.split("-")[0],ze=Ep(we);var In=ke.offsets.popper,Tn=ke.offsets.reference,Gn=Math.floor,Cr="left"===we&&Gn(In.right)>Gn(Tn.left)||"right"===we&&Gn(In.left)<Gn(Tn.right)||"top"===we&&Gn(In.bottom)>Gn(Tn.top)||"bottom"===we&&Gn(In.top)<Gn(Tn.bottom),Dr=Gn(In.left)<Gn(He.left),Lr=Gn(In.right)>Gn(He.right),Qt=Gn(In.top)<Gn(He.top),Ao=Gn(In.bottom)>Gn(He.bottom),ic="left"===we&&Dr||"right"===we&&Lr||"top"===we&&Qt||"bottom"===we&&Ao,el=-1!==["top","bottom"].indexOf(we),Id=!!De.flipVariations&&(el&&"start"===Je&&Dr||el&&"end"===Je&&Lr||!el&&"start"===Je&&Qt||!el&&"end"===Je&&Ao)||!!De.flipVariationsByContent&&(el&&"start"===Je&&Lr||el&&"end"===Je&&Dr||!el&&"start"===Je&&Ao||!el&&"end"===Je&&Qt);(Cr||ic||Id)&&(ke.flipped=!0,(Cr||ic)&&(we=bt[Wt+1]),Id&&(Je=function Ar(ke){return"end"===ke?"start":"start"===ke?"end":ke}(Je)),ke.placement=we+(Je?"-"+Je:""),ke.offsets.popper=qa({},ke.offsets.popper,Ji(ke.instance.popper,ke.offsets.reference,ke.placement)),ke=Yc(ke.instance.modifiers,ke,"flip"))}),ke},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function da(ke){var De=ke.placement,He=De.split("-")[0],we=ke.offsets,ze=we.popper,Je=we.reference,bt=-1!==["left","right"].indexOf(He),Ot=-1===["top","left"].indexOf(He);return ze[bt?"left":"top"]=Je[He]-(Ot?ze[bt?"width":"height"]:0),ke.placement=Ep(De),ke.offsets.popper=bc(ze),ke}},hide:{order:800,enabled:!0,fn:function pl(ke){if(!Er(ke.instance.modifiers,"hide","preventOverflow"))return ke;var De=ke.offsets.reference,He=hl(ke.instance.modifiers,function(we){return"preventOverflow"===we.name}).boundaries;if(De.bottom<He.top||De.left>He.right||De.top>He.bottom||De.right<He.left){if(!0===ke.hide)return ke;ke.hide=!0,ke.attributes["x-out-of-boundaries"]=""}else{if(!1===ke.hide)return ke;ke.hide=!1,ke.attributes["x-out-of-boundaries"]=!1}return ke}},computeStyle:{order:850,enabled:!0,fn:function Sn(ke,De){var He=De.x,we=De.y,ze=ke.offsets.popper,Je=hl(ke.instance.modifiers,function(Qr){return"applyStyle"===Qr.name}).gpuAcceleration;void 0!==Je&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var Lr,Qt,bt=void 0!==Je?Je:De.gpuAcceleration,Ot=qc(ke.instance.popper),Wt=Jl(Ot),In={position:ze.position},Tn=function Fn(ke,De){var He=ke.offsets,we=He.popper,Je=Math.round,bt=Math.floor,Ot=function(ic){return ic},Wt=Je(He.reference.width),In=Je(we.width),Tn=-1!==["left","right"].indexOf(ke.placement),Gn=-1!==ke.placement.indexOf("-"),Lr=De?Tn||Gn||Wt%2==In%2?Je:bt:Ot,Qt=De?Je:Ot;return{left:Lr(Wt%2==1&&In%2==1&&!Gn&&De?we.left-1:we.left),top:Qt(we.top),bottom:Qt(we.bottom),right:Lr(we.right)}}(ke,window.devicePixelRatio<2||!on),Gn="bottom"===He?"top":"bottom",Cr="right"===we?"left":"right",Dr=nh("transform");if(Qt="bottom"===Gn?"HTML"===Ot.nodeName?-Ot.clientHeight+Tn.bottom:-Wt.height+Tn.bottom:Tn.top,Lr="right"===Cr?"HTML"===Ot.nodeName?-Ot.clientWidth+Tn.right:-Wt.width+Tn.right:Tn.left,bt&&Dr)In[Dr]="translate3d("+Lr+"px, "+Qt+"px, 0)",In[Gn]=0,In[Cr]=0,In.willChange="transform";else{var ic="right"===Cr?-1:1;In[Gn]=Qt*("bottom"===Gn?-1:1),In[Cr]=Lr*ic,In.willChange=Gn+", "+Cr}return ke.attributes=qa({},{"x-placement":ke.placement},ke.attributes),ke.styles=qa({},In,ke.styles),ke.arrowStyles=qa({},ke.offsets.arrow,ke.arrowStyles),ke},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function Xt(ke){return Mt(ke.instance.popper,ke.styles),function Bt(ke,De){Object.keys(De).forEach(function(He){!1!==De[He]?ke.setAttribute(He,De[He]):ke.removeAttribute(He)})}(ke.instance.popper,ke.attributes),ke.arrowElement&&Object.keys(ke.arrowStyles).length&&Mt(ke.arrowElement,ke.arrowStyles),ke},onLoad:function pn(ke,De,He,we,ze){var Je=Vh(ze,De,ke,He.positionFixed),bt=th(He.placement,Je,De,ke,He.modifiers.flip.boundariesElement,He.modifiers.flip.padding);return De.setAttribute("x-placement",bt),Mt(De,{position:He.positionFixed?"fixed":"absolute"}),He},gpuAcceleration:void 0}}},er=function(){function ke(De,He){var we=this,ze=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Hh(this,ke),this.scheduleUpdate=function(){return requestAnimationFrame(we.update)},this.update=cl(this.update.bind(this)),this.options=qa({},ke.Defaults,ze),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=De&&De.jquery?De[0]:De,this.popper=He&&He.jquery?He[0]:He,this.options.modifiers={},Object.keys(qa({},ke.Defaults.modifiers,ze.modifiers)).forEach(function(bt){we.options.modifiers[bt]=qa({},ke.Defaults.modifiers[bt]||{},ze.modifiers?ze.modifiers[bt]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(bt){return qa({name:bt},we.options.modifiers[bt])}).sort(function(bt,Ot){return bt.order-Ot.order}),this.modifiers.forEach(function(bt){bt.enabled&&zh(bt.onLoad)&&bt.onLoad(we.reference,we.popper,we.options,bt,we.state)}),this.update();var Je=this.options.eventsEnabled;Je&&this.enableEventListeners(),this.state.eventsEnabled=Je}return Wp(ke,[{key:"update",value:function(){return Wh.call(this)}},{key:"destroy",value:function(){return vu.call(this)}},{key:"enableEventListeners",value:function(){return Be.call(this)}},{key:"disableEventListeners",value:function(){return qe.call(this)}}]),ke}();er.Utils=(typeof window<"u"?window:global).PopperUtils,er.placements=ds,er.Defaults=ks;var En="dropdown",ss="bs.dropdown",Zi="."+ss,Hr=".data-api",di=x.default.fn[En],lt=new RegExp("38|40|27"),$l="hide"+Zi,Ms="hidden"+Zi,Tp="show"+Zi,As="shown"+Zi,Sc="click"+Zi,Di="click"+Zi+Hr,ro="keydown"+Zi+Hr,ri="keyup"+Zi+Hr,Jc="disabled",$i="show",Ui="dropdown-menu-right",qr='[data-toggle="dropdown"]',yo=".dropdown-menu",Cl={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},Ja={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},Ca=function(){function ke(He,we){this._element=He,this._popper=null,this._config=this._getConfig(we),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var De=ke.prototype;return De.toggle=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Jc)){var we=x.default(this._menu).hasClass($i);ke._clearMenus(),!we&&this.show(!0)}},De.show=function(we){if(void 0===we&&(we=!1),!(this._element.disabled||x.default(this._element).hasClass(Jc)||x.default(this._menu).hasClass($i))){var ze={relatedTarget:this._element},Je=x.default.Event(Tp,ze),bt=ke._getParentFromElement(this._element);if(x.default(bt).trigger(Je),!Je.isDefaultPrevented()){if(!this._inNavbar&&we){if(typeof er>"u")throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var Ot=this._element;"parent"===this._config.reference?Ot=bt:W.isElement(this._config.reference)&&(Ot=this._config.reference,typeof this._config.reference.jquery<"u"&&(Ot=this._config.reference[0])),"scrollParent"!==this._config.boundary&&x.default(bt).addClass("position-static"),this._popper=new er(Ot,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===x.default(bt).closest(".navbar-nav").length&&x.default(document.body).children().on("mouseover",null,x.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),x.default(this._menu).toggleClass($i),x.default(bt).toggleClass($i).trigger(x.default.Event(As,ze))}}},De.hide=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(Jc)&&x.default(this._menu).hasClass($i)){var we={relatedTarget:this._element},ze=x.default.Event($l,we),Je=ke._getParentFromElement(this._element);x.default(Je).trigger(ze),!ze.isDefaultPrevented()&&(this._popper&&this._popper.destroy(),x.default(this._menu).toggleClass($i),x.default(Je).toggleClass($i).trigger(x.default.Event(Ms,we)))}},De.dispose=function(){x.default.removeData(this._element,ss),x.default(this._element).off(Zi),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},De.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},De._addEventListeners=function(){var we=this;x.default(this._element).on(Sc,function(ze){ze.preventDefault(),ze.stopPropagation(),we.toggle()})},De._getConfig=function(we){return we=G({},this.constructor.Default,x.default(this._element).data(),we),W.typeCheckConfig(En,we,this.constructor.DefaultType),we},De._getMenuElement=function(){if(!this._menu){var we=ke._getParentFromElement(this._element);we&&(this._menu=we.querySelector(yo))}return this._menu},De._getPlacement=function(){var we=x.default(this._element.parentNode),ze="bottom-start";return we.hasClass("dropup")?ze=x.default(this._menu).hasClass(Ui)?"top-end":"top-start":we.hasClass("dropright")?ze="right-start":we.hasClass("dropleft")?ze="left-start":x.default(this._menu).hasClass(Ui)&&(ze="bottom-end"),ze},De._detectNavbar=function(){return x.default(this._element).closest(".navbar").length>0},De._getOffset=function(){var we=this,ze={};return"function"==typeof this._config.offset?ze.fn=function(Je){return Je.offsets=G({},Je.offsets,we._config.offset(Je.offsets,we._element)||{}),Je}:ze.offset=this._config.offset,ze},De._getPopperConfig=function(){var we={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(we.modifiers.applyStyle={enabled:!1}),G({},we,this._config.popperConfig)},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(ss);if(ze||(ze=new ke(this,"object"==typeof we?we:null),x.default(this).data(ss,ze)),"string"==typeof we){if(typeof ze[we]>"u")throw new TypeError('No method named "'+we+'"');ze[we]()}})},ke._clearMenus=function(we){if(!we||3!==we.which&&("keyup"!==we.type||9===we.which))for(var ze=[].slice.call(document.querySelectorAll(qr)),Je=0,bt=ze.length;Je<bt;Je++){var Ot=ke._getParentFromElement(ze[Je]),Wt=x.default(ze[Je]).data(ss),In={relatedTarget:ze[Je]};if(we&&"click"===we.type&&(In.clickEvent=we),Wt){var Tn=Wt._menu;if(x.default(Ot).hasClass($i)&&!(we&&("click"===we.type&&/input|textarea/i.test(we.target.tagName)||"keyup"===we.type&&9===we.which)&&x.default.contains(Ot,we.target))){var Gn=x.default.Event($l,In);x.default(Ot).trigger(Gn),!Gn.isDefaultPrevented()&&("ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),ze[Je].setAttribute("aria-expanded","false"),Wt._popper&&Wt._popper.destroy(),x.default(Tn).removeClass($i),x.default(Ot).removeClass($i).trigger(x.default.Event(Ms,In)))}}}},ke._getParentFromElement=function(we){var ze,Je=W.getSelectorFromElement(we);return Je&&(ze=document.querySelector(Je)),ze||we.parentNode},ke._dataApiKeydownHandler=function(we){if(!(/input|textarea/i.test(we.target.tagName)?32===we.which||27!==we.which&&(40!==we.which&&38!==we.which||x.default(we.target).closest(yo).length):!lt.test(we.which))&&!this.disabled&&!x.default(this).hasClass(Jc)){var ze=ke._getParentFromElement(this),Je=x.default(ze).hasClass($i);if(Je||27!==we.which){if(we.preventDefault(),we.stopPropagation(),!Je||27===we.which||32===we.which)return 27===we.which&&x.default(ze.querySelector(qr)).trigger("focus"),void x.default(this).trigger("click");var bt=[].slice.call(ze.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(Wt){return x.default(Wt).is(":visible")});if(0!==bt.length){var Ot=bt.indexOf(we.target);38===we.which&&Ot>0&&Ot--,40===we.which&&Ot<bt.length-1&&Ot++,Ot<0&&(Ot=0),bt[Ot].focus()}}}},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Cl}},{key:"DefaultType",get:function(){return Ja}}]),ke}();x.default(document).on(ro,qr,Ca._dataApiKeydownHandler).on(ro,yo,Ca._dataApiKeydownHandler).on(Di+" "+ri,Ca._clearMenus).on(Di,qr,function(ke){ke.preventDefault(),ke.stopPropagation(),Ca._jQueryInterface.call(x.default(this),"toggle")}).on(Di,".dropdown form",function(ke){ke.stopPropagation()}),x.default.fn[En]=Ca._jQueryInterface,x.default.fn[En].Constructor=Ca,x.default.fn[En].noConflict=function(){return x.default.fn[En]=di,Ca._jQueryInterface};var Kl="modal",La="bs.modal",bo="."+La,Mc=x.default.fn[Kl],xt={backdrop:!0,keyboard:!0,focus:!0,show:!0},Ut={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},bn="hide"+bo,qt="hidePrevented"+bo,fn="hidden"+bo,tn="show"+bo,qn="shown"+bo,jn="focusin"+bo,Sr="resize"+bo,$r="click.dismiss"+bo,yr="keydown.dismiss"+bo,Xr="mouseup.dismiss"+bo,fi="mousedown.dismiss"+bo,Rr="click"+bo+".data-api",Bo="modal-open",ec="fade",Yo="show",Xi="modal-static",Ac=".modal-dialog",Eh=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",cd=".sticky-top",Th=function(){function ke(He,we){this._config=this._getConfig(we),this._element=He,this._dialog=He.querySelector(Ac),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var De=ke.prototype;return De.toggle=function(we){return this._isShown?this.hide():this.show(we)},De.show=function(we){var ze=this;if(!this._isShown&&!this._isTransitioning){x.default(this._element).hasClass(ec)&&(this._isTransitioning=!0);var Je=x.default.Event(tn,{relatedTarget:we});x.default(this._element).trigger(Je),!this._isShown&&!Je.isDefaultPrevented()&&(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),x.default(this._element).on($r,'[data-dismiss="modal"]',function(bt){return ze.hide(bt)}),x.default(this._dialog).on(fi,function(){x.default(ze._element).one(Xr,function(bt){x.default(bt.target).is(ze._element)&&(ze._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return ze._showElement(we)}))}},De.hide=function(we){var ze=this;if(we&&we.preventDefault(),this._isShown&&!this._isTransitioning){var Je=x.default.Event(bn);if(x.default(this._element).trigger(Je),this._isShown&&!Je.isDefaultPrevented()){this._isShown=!1;var bt=x.default(this._element).hasClass(ec);if(bt&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),x.default(document).off(jn),x.default(this._element).removeClass(Yo),x.default(this._element).off($r),x.default(this._dialog).off(fi),bt){var Ot=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,function(Wt){return ze._hideModal(Wt)}).emulateTransitionEnd(Ot)}else this._hideModal()}}},De.dispose=function(){[window,this._element,this._dialog].forEach(function(we){return x.default(we).off(bo)}),x.default(document).off(jn),x.default.removeData(this._element,La),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},De.handleUpdate=function(){this._adjustDialog()},De._getConfig=function(we){return we=G({},xt,we),W.typeCheckConfig(Kl,we,Ut),we},De._triggerBackdropTransition=function(){var we=this;if("static"===this._config.backdrop){var ze=x.default.Event(qt);if(x.default(this._element).trigger(ze),ze.isDefaultPrevented())return;var Je=this._element.scrollHeight>document.documentElement.clientHeight;Je||(this._element.style.overflowY="hidden"),this._element.classList.add(Xi);var bt=W.getTransitionDurationFromElement(this._dialog);x.default(this._element).off(W.TRANSITION_END),x.default(this._element).one(W.TRANSITION_END,function(){we._element.classList.remove(Xi),Je||x.default(we._element).one(W.TRANSITION_END,function(){we._element.style.overflowY=""}).emulateTransitionEnd(we._element,bt)}).emulateTransitionEnd(bt),this._element.focus()}else this.hide()},De._showElement=function(we){var ze=this,Je=x.default(this._element).hasClass(ec),bt=this._dialog?this._dialog.querySelector(".modal-body"):null;(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE)&&document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),x.default(this._dialog).hasClass("modal-dialog-scrollable")&&bt?bt.scrollTop=0:this._element.scrollTop=0,Je&&W.reflow(this._element),x.default(this._element).addClass(Yo),this._config.focus&&this._enforceFocus();var Ot=x.default.Event(qn,{relatedTarget:we}),Wt=function(){ze._config.focus&&ze._element.focus(),ze._isTransitioning=!1,x.default(ze._element).trigger(Ot)};if(Je){var In=W.getTransitionDurationFromElement(this._dialog);x.default(this._dialog).one(W.TRANSITION_END,Wt).emulateTransitionEnd(In)}else Wt()},De._enforceFocus=function(){var we=this;x.default(document).off(jn).on(jn,function(ze){document!==ze.target&&we._element!==ze.target&&0===x.default(we._element).has(ze.target).length&&we._element.focus()})},De._setEscapeEvent=function(){var we=this;this._isShown?x.default(this._element).on(yr,function(ze){we._config.keyboard&&27===ze.which?(ze.preventDefault(),we.hide()):!we._config.keyboard&&27===ze.which&&we._triggerBackdropTransition()}):this._isShown||x.default(this._element).off(yr)},De._setResizeEvent=function(){var we=this;this._isShown?x.default(window).on(Sr,function(ze){return we.handleUpdate(ze)}):x.default(window).off(Sr)},De._hideModal=function(){var we=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){x.default(document.body).removeClass(Bo),we._resetAdjustments(),we._resetScrollbar(),x.default(we._element).trigger(fn)})},De._removeBackdrop=function(){this._backdrop&&(x.default(this._backdrop).remove(),this._backdrop=null)},De._showBackdrop=function(we){var ze=this,Je=x.default(this._element).hasClass(ec)?ec:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",Je&&this._backdrop.classList.add(Je),x.default(this._backdrop).appendTo(document.body),x.default(this._element).on($r,function(In){ze._ignoreBackdropClick?ze._ignoreBackdropClick=!1:In.target===In.currentTarget&&ze._triggerBackdropTransition()}),Je&&W.reflow(this._backdrop),x.default(this._backdrop).addClass(Yo),!we)return;if(!Je)return void we();var bt=W.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(W.TRANSITION_END,we).emulateTransitionEnd(bt)}else if(!this._isShown&&this._backdrop){x.default(this._backdrop).removeClass(Yo);var Ot=function(){ze._removeBackdrop(),we&&we()};if(x.default(this._element).hasClass(ec)){var Wt=W.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(W.TRANSITION_END,Ot).emulateTransitionEnd(Wt)}else Ot()}else we&&we()},De._adjustDialog=function(){var we=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&we&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!we&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},De._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},De._checkScrollbar=function(){var we=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(we.left+we.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},De._setScrollbar=function(){var we=this;if(this._isBodyOverflowing){var ze=[].slice.call(document.querySelectorAll(Eh)),Je=[].slice.call(document.querySelectorAll(cd));x.default(ze).each(function(Wt,In){var Tn=In.style.paddingRight,Gn=x.default(In).css("padding-right");x.default(In).data("padding-right",Tn).css("padding-right",parseFloat(Gn)+we._scrollbarWidth+"px")}),x.default(Je).each(function(Wt,In){var Tn=In.style.marginRight,Gn=x.default(In).css("margin-right");x.default(In).data("margin-right",Tn).css("margin-right",parseFloat(Gn)-we._scrollbarWidth+"px")});var bt=document.body.style.paddingRight,Ot=x.default(document.body).css("padding-right");x.default(document.body).data("padding-right",bt).css("padding-right",parseFloat(Ot)+this._scrollbarWidth+"px")}x.default(document.body).addClass(Bo)},De._resetScrollbar=function(){var we=[].slice.call(document.querySelectorAll(Eh));x.default(we).each(function(bt,Ot){var Wt=x.default(Ot).data("padding-right");x.default(Ot).removeData("padding-right"),Ot.style.paddingRight=Wt||""});var ze=[].slice.call(document.querySelectorAll(""+cd));x.default(ze).each(function(bt,Ot){var Wt=x.default(Ot).data("margin-right");typeof Wt<"u"&&x.default(Ot).css("margin-right",Wt).removeData("margin-right")});var Je=x.default(document.body).data("padding-right");x.default(document.body).removeData("padding-right"),document.body.style.paddingRight=Je||""},De._getScrollbarWidth=function(){var we=document.createElement("div");we.className="modal-scrollbar-measure",document.body.appendChild(we);var ze=we.getBoundingClientRect().width-we.clientWidth;return document.body.removeChild(we),ze},ke._jQueryInterface=function(we,ze){return this.each(function(){var Je=x.default(this).data(La),bt=G({},xt,x.default(this).data(),"object"==typeof we&&we?we:{});if(Je||(Je=new ke(this,bt),x.default(this).data(La,Je)),"string"==typeof we){if(typeof Je[we]>"u")throw new TypeError('No method named "'+we+'"');Je[we](ze)}else bt.show&&Je.show(ze)})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return xt}}]),ke}();x.default(document).on(Rr,'[data-toggle="modal"]',function(ke){var He,De=this,we=W.getSelectorFromElement(this);we&&(He=document.querySelector(we));var ze=x.default(He).data(La)?"toggle":G({},x.default(He).data(),x.default(this).data());("A"===this.tagName||"AREA"===this.tagName)&&ke.preventDefault();var Je=x.default(He).one(tn,function(bt){bt.isDefaultPrevented()||Je.one(fn,function(){x.default(De).is(":visible")&&De.focus()})});Th._jQueryInterface.call(x.default(He),ze,this)}),x.default.fn[Kl]=Th._jQueryInterface,x.default.fn[Kl].Constructor=Th,x.default.fn[Kl].noConflict=function(){return x.default.fn[Kl]=Mc,Th._jQueryInterface};var Rd=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],$c=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,Zs=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function ar(ke,De,He){if(0===ke.length)return ke;if(He&&"function"==typeof He)return He(ke);for(var ze=(new window.DOMParser).parseFromString(ke,"text/html"),Je=Object.keys(De),bt=[].slice.call(ze.body.querySelectorAll("*")),Ot=function(Cr,Dr){var Lr=bt[Cr],Qt=Lr.nodeName.toLowerCase();if(-1===Je.indexOf(Lr.nodeName.toLowerCase()))return Lr.parentNode.removeChild(Lr),"continue";var Ao=[].slice.call(Lr.attributes),ic=[].concat(De["*"]||[],De[Qt]||[]);Ao.forEach(function(el){(function $p(ke,De){var He=ke.nodeName.toLowerCase();if(-1!==De.indexOf(He))return-1===Rd.indexOf(He)||Boolean(ke.nodeValue.match($c)||ke.nodeValue.match(Zs));for(var we=De.filter(function(bt){return bt instanceof RegExp}),ze=0,Je=we.length;ze<Je;ze++)if(He.match(we[ze]))return!0;return!1})(el,ic)||Lr.removeAttribute(el.nodeName)})},Wt=0,In=bt.length;Wt<In;Wt++)Ot(Wt);return ze.body.innerHTML}var Ll="tooltip",Jh="bs.tooltip",ma="."+Jh,hd=x.default.fn[Ll],Ur="bs-tooltip",Ki=new RegExp("(^|\\s)"+Ur+"\\S+","g"),No=["sanitize","whiteList","sanitizeFn"],$s={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Vr={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},dl={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},Cc="show",Zh={HIDE:"hide"+ma,HIDDEN:"hidden"+ma,SHOW:"show"+ma,SHOWN:"shown"+ma,INSERTED:"inserted"+ma,CLICK:"click"+ma,FOCUSIN:"focusin"+ma,FOCUSOUT:"focusout"+ma,MOUSEENTER:"mouseenter"+ma,MOUSELEAVE:"mouseleave"+ma},Bl="fade",Kn="show",Nl="hover",Pi="focus",Ba=function(){function ke(He,we){if(typeof er>"u")throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=He,this.config=this._getConfig(we),this.tip=null,this._setListeners()}var De=ke.prototype;return De.enable=function(){this._isEnabled=!0},De.disable=function(){this._isEnabled=!1},De.toggleEnabled=function(){this._isEnabled=!this._isEnabled},De.toggle=function(we){if(this._isEnabled)if(we){var ze=this.constructor.DATA_KEY,Je=x.default(we.currentTarget).data(ze);Je||(Je=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(ze,Je)),Je._activeTrigger.click=!Je._activeTrigger.click,Je._isWithActiveTrigger()?Je._enter(null,Je):Je._leave(null,Je)}else{if(x.default(this.getTipElement()).hasClass(Kn))return void this._leave(null,this);this._enter(null,this)}},De.dispose=function(){clearTimeout(this._timeout),x.default.removeData(this.element,this.constructor.DATA_KEY),x.default(this.element).off(this.constructor.EVENT_KEY),x.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&x.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},De.show=function(){var we=this;if("none"===x.default(this.element).css("display"))throw new Error("Please use show on visible elements");var ze=x.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){x.default(this.element).trigger(ze);var Je=W.findShadowRoot(this.element),bt=x.default.contains(null!==Je?Je:this.element.ownerDocument.documentElement,this.element);if(ze.isDefaultPrevented()||!bt)return;var Ot=this.getTipElement(),Wt=W.getUID(this.constructor.NAME);Ot.setAttribute("id",Wt),this.element.setAttribute("aria-describedby",Wt),this.setContent(),this.config.animation&&x.default(Ot).addClass(Bl);var In="function"==typeof this.config.placement?this.config.placement.call(this,Ot,this.element):this.config.placement,Tn=this._getAttachment(In);this.addAttachmentClass(Tn);var Gn=this._getContainer();x.default(Ot).data(this.constructor.DATA_KEY,this),x.default.contains(this.element.ownerDocument.documentElement,this.tip)||x.default(Ot).appendTo(Gn),x.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new er(this.element,Ot,this._getPopperConfig(Tn)),x.default(Ot).addClass(Kn),"ontouchstart"in document.documentElement&&x.default(document.body).children().on("mouseover",null,x.default.noop);var Cr=function(){we.config.animation&&we._fixTransition();var Qt=we._hoverState;we._hoverState=null,x.default(we.element).trigger(we.constructor.Event.SHOWN),"out"===Qt&&we._leave(null,we)};if(x.default(this.tip).hasClass(Bl)){var Dr=W.getTransitionDurationFromElement(this.tip);x.default(this.tip).one(W.TRANSITION_END,Cr).emulateTransitionEnd(Dr)}else Cr()}},De.hide=function(we){var ze=this,Je=this.getTipElement(),bt=x.default.Event(this.constructor.Event.HIDE),Ot=function(){ze._hoverState!==Cc&&Je.parentNode&&Je.parentNode.removeChild(Je),ze._cleanTipClass(),ze.element.removeAttribute("aria-describedby"),x.default(ze.element).trigger(ze.constructor.Event.HIDDEN),null!==ze._popper&&ze._popper.destroy(),we&&we()};if(x.default(this.element).trigger(bt),!bt.isDefaultPrevented()){if(x.default(Je).removeClass(Kn),"ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),this._activeTrigger.click=!1,this._activeTrigger[Pi]=!1,this._activeTrigger[Nl]=!1,x.default(this.tip).hasClass(Bl)){var Wt=W.getTransitionDurationFromElement(Je);x.default(Je).one(W.TRANSITION_END,Ot).emulateTransitionEnd(Wt)}else Ot();this._hoverState=""}},De.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},De.isWithContent=function(){return Boolean(this.getTitle())},De.addAttachmentClass=function(we){x.default(this.getTipElement()).addClass(Ur+"-"+we)},De.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},De.setContent=function(){var we=this.getTipElement();this.setElementContent(x.default(we.querySelectorAll(".tooltip-inner")),this.getTitle()),x.default(we).removeClass(Bl+" "+Kn)},De.setElementContent=function(we,ze){"object"!=typeof ze||!ze.nodeType&&!ze.jquery?this.config.html?(this.config.sanitize&&(ze=ar(ze,this.config.whiteList,this.config.sanitizeFn)),we.html(ze)):we.text(ze):this.config.html?x.default(ze).parent().is(we)||we.empty().append(ze):we.text(x.default(ze).text())},De.getTitle=function(){var we=this.element.getAttribute("data-original-title");return we||(we="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),we},De._getPopperConfig=function(we){var ze=this;return G({},{placement:we,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(Ot){Ot.originalPlacement!==Ot.placement&&ze._handlePopperPlacementChange(Ot)},onUpdate:function(Ot){return ze._handlePopperPlacementChange(Ot)}},this.config.popperConfig)},De._getOffset=function(){var we=this,ze={};return"function"==typeof this.config.offset?ze.fn=function(Je){return Je.offsets=G({},Je.offsets,we.config.offset(Je.offsets,we.element)||{}),Je}:ze.offset=this.config.offset,ze},De._getContainer=function(){return!1===this.config.container?document.body:W.isElement(this.config.container)?x.default(this.config.container):x.default(document).find(this.config.container)},De._getAttachment=function(we){return Vr[we.toUpperCase()]},De._setListeners=function(){var we=this;this.config.trigger.split(" ").forEach(function(Je){if("click"===Je)x.default(we.element).on(we.constructor.Event.CLICK,we.config.selector,function(Wt){return we.toggle(Wt)});else if("manual"!==Je){var bt=Je===Nl?we.constructor.Event.MOUSEENTER:we.constructor.Event.FOCUSIN,Ot=Je===Nl?we.constructor.Event.MOUSELEAVE:we.constructor.Event.FOCUSOUT;x.default(we.element).on(bt,we.config.selector,function(Wt){return we._enter(Wt)}).on(Ot,we.config.selector,function(Wt){return we._leave(Wt)})}}),this._hideModalHandler=function(){we.element&&we.hide()},x.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=G({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},De._fixTitle=function(){var we=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==we)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},De._enter=function(we,ze){var Je=this.constructor.DATA_KEY;(ze=ze||x.default(we.currentTarget).data(Je))||(ze=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(Je,ze)),we&&(ze._activeTrigger["focusin"===we.type?Pi:Nl]=!0),x.default(ze.getTipElement()).hasClass(Kn)||ze._hoverState===Cc?ze._hoverState=Cc:(clearTimeout(ze._timeout),ze._hoverState=Cc,ze.config.delay&&ze.config.delay.show?ze._timeout=setTimeout(function(){ze._hoverState===Cc&&ze.show()},ze.config.delay.show):ze.show())},De._leave=function(we,ze){var Je=this.constructor.DATA_KEY;if((ze=ze||x.default(we.currentTarget).data(Je))||(ze=new this.constructor(we.currentTarget,this._getDelegateConfig()),x.default(we.currentTarget).data(Je,ze)),we&&(ze._activeTrigger["focusout"===we.type?Pi:Nl]=!1),!ze._isWithActiveTrigger()){if(clearTimeout(ze._timeout),ze._hoverState="out",!ze.config.delay||!ze.config.delay.hide)return void ze.hide();ze._timeout=setTimeout(function(){"out"===ze._hoverState&&ze.hide()},ze.config.delay.hide)}},De._isWithActiveTrigger=function(){for(var we in this._activeTrigger)if(this._activeTrigger[we])return!0;return!1},De._getConfig=function(we){var ze=x.default(this.element).data();return Object.keys(ze).forEach(function(Je){-1!==No.indexOf(Je)&&delete ze[Je]}),"number"==typeof(we=G({},this.constructor.Default,ze,"object"==typeof we&&we?we:{})).delay&&(we.delay={show:we.delay,hide:we.delay}),"number"==typeof we.title&&(we.title=we.title.toString()),"number"==typeof we.content&&(we.content=we.content.toString()),W.typeCheckConfig(Ll,we,this.constructor.DefaultType),we.sanitize&&(we.template=ar(we.template,we.whiteList,we.sanitizeFn)),we},De._getDelegateConfig=function(){var we={};if(this.config)for(var ze in this.config)this.constructor.Default[ze]!==this.config[ze]&&(we[ze]=this.config[ze]);return we},De._cleanTipClass=function(){var we=x.default(this.getTipElement()),ze=we.attr("class").match(Ki);null!==ze&&ze.length&&we.removeClass(ze.join(""))},De._handlePopperPlacementChange=function(we){this.tip=we.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(we.placement))},De._fixTransition=function(){var we=this.getTipElement(),ze=this.config.animation;null===we.getAttribute("x-placement")&&(x.default(we).removeClass(Bl),this.config.animation=!1,this.hide(),this.show(),this.config.animation=ze)},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Je=ze.data(Jh),bt="object"==typeof we&&we;if((Je||!/dispose|hide/.test(we))&&(Je||(Je=new ke(this,bt),ze.data(Jh,Je)),"string"==typeof we)){if(typeof Je[we]>"u")throw new TypeError('No method named "'+we+'"');Je[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return dl}},{key:"NAME",get:function(){return Ll}},{key:"DATA_KEY",get:function(){return Jh}},{key:"Event",get:function(){return Zh}},{key:"EVENT_KEY",get:function(){return ma}},{key:"DefaultType",get:function(){return $s}}]),ke}();x.default.fn[Ll]=Ba._jQueryInterface,x.default.fn[Ll].Constructor=Ba,x.default.fn[Ll].noConflict=function(){return x.default.fn[Ll]=hd,Ba._jQueryInterface};var oh="popover",Na="bs.popover",li="."+Na,Zr=x.default.fn[oh],hn="bs-popover",Qc=new RegExp("(^|\\s)"+hn+"\\S+","g"),ci=G({},Ba.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),_a=G({},Ba.DefaultType,{content:"(string|element|function)"}),ms={HIDE:"hide"+li,HIDDEN:"hidden"+li,SHOW:"show"+li,SHOWN:"shown"+li,INSERTED:"inserted"+li,CLICK:"click"+li,FOCUSIN:"focusin"+li,FOCUSOUT:"focusout"+li,MOUSEENTER:"mouseenter"+li,MOUSELEAVE:"mouseleave"+li},Cs=function(ke){function De(){return ke.apply(this,arguments)||this}!function M(ke,De){ke.prototype=Object.create(De.prototype),ke.prototype.constructor=ke,ke.__proto__=De}(De,ke);var He=De.prototype;return He.isWithContent=function(){return this.getTitle()||this._getContent()},He.addAttachmentClass=function(ze){x.default(this.getTipElement()).addClass(hn+"-"+ze)},He.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},He.setContent=function(){var ze=x.default(this.getTipElement());this.setElementContent(ze.find(".popover-header"),this.getTitle());var Je=this._getContent();"function"==typeof Je&&(Je=Je.call(this.element)),this.setElementContent(ze.find(".popover-body"),Je),ze.removeClass("fade show")},He._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},He._cleanTipClass=function(){var ze=x.default(this.getTipElement()),Je=ze.attr("class").match(Qc);null!==Je&&Je.length>0&&ze.removeClass(Je.join(""))},De._jQueryInterface=function(ze){return this.each(function(){var Je=x.default(this).data(Na),bt="object"==typeof ze?ze:null;if((Je||!/dispose|hide/.test(ze))&&(Je||(Je=new De(this,bt),x.default(this).data(Na,Je)),"string"==typeof ze)){if(typeof Je[ze]>"u")throw new TypeError('No method named "'+ze+'"');Je[ze]()}})},D(De,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return ci}},{key:"NAME",get:function(){return oh}},{key:"DATA_KEY",get:function(){return Na}},{key:"Event",get:function(){return ms}},{key:"EVENT_KEY",get:function(){return li}},{key:"DefaultType",get:function(){return _a}}]),De}(Ba);x.default.fn[oh]=Cs._jQueryInterface,x.default.fn[oh].Constructor=Cs,x.default.fn[oh].noConflict=function(){return x.default.fn[oh]=Zr,Cs._jQueryInterface};var ii="scrollspy",br="bs.scrollspy",ml="."+br,ah=x.default.fn[ii],Qa={offset:10,method:"auto",target:""},ns={offset:"number",method:"string",target:"(string|element)"},Ci="activate"+ml,Qh="scroll"+ml,Ah="load"+ml+".data-api",mr="active",_l=".nav, .list-group",kr=".nav-link",lh=".list-group-item",Bs=".dropdown-item",tc="position",co=function(){function ke(He,we){var ze=this;this._element=He,this._scrollElement="BODY"===He.tagName?window:He,this._config=this._getConfig(we),this._selector=this._config.target+" "+kr+","+this._config.target+" "+lh+","+this._config.target+" "+Bs,this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,x.default(this._scrollElement).on(Qh,function(Je){return ze._process(Je)}),this.refresh(),this._process()}var De=ke.prototype;return De.refresh=function(){var we=this,Je="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":tc:this._config.method,bt=Je===tc?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(Wt){var In,Tn=W.getSelectorFromElement(Wt);if(Tn&&(In=document.querySelector(Tn)),In){var Gn=In.getBoundingClientRect();if(Gn.width||Gn.height)return[x.default(In)[Je]().top+bt,Tn]}return null}).filter(function(Wt){return Wt}).sort(function(Wt,In){return Wt[0]-In[0]}).forEach(function(Wt){we._offsets.push(Wt[0]),we._targets.push(Wt[1])})},De.dispose=function(){x.default.removeData(this._element,br),x.default(this._scrollElement).off(ml),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},De._getConfig=function(we){if("string"!=typeof(we=G({},Qa,"object"==typeof we&&we?we:{})).target&&W.isElement(we.target)){var ze=x.default(we.target).attr("id");ze||(ze=W.getUID(ii),x.default(we.target).attr("id",ze)),we.target="#"+ze}return W.typeCheckConfig(ii,we,ns),we},De._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},De._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},De._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},De._process=function(){var we=this._getScrollTop()+this._config.offset,ze=this._getScrollHeight(),Je=this._config.offset+ze-this._getOffsetHeight();if(this._scrollHeight!==ze&&this.refresh(),we>=Je){var bt=this._targets[this._targets.length-1];this._activeTarget!==bt&&this._activate(bt)}else{if(this._activeTarget&&we<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var Ot=this._offsets.length;Ot--;)this._activeTarget!==this._targets[Ot]&&we>=this._offsets[Ot]&&(typeof this._offsets[Ot+1]>"u"||we<this._offsets[Ot+1])&&this._activate(this._targets[Ot])}},De._activate=function(we){this._activeTarget=we,this._clear();var ze=this._selector.split(",").map(function(bt){return bt+'[data-target="'+we+'"],'+bt+'[href="'+we+'"]'}),Je=x.default([].slice.call(document.querySelectorAll(ze.join(","))));Je.hasClass("dropdown-item")?(Je.closest(".dropdown").find(".dropdown-toggle").addClass(mr),Je.addClass(mr)):(Je.addClass(mr),Je.parents(_l).prev(kr+", "+lh).addClass(mr),Je.parents(_l).prev(".nav-item").children(kr).addClass(mr)),x.default(this._scrollElement).trigger(Ci,{relatedTarget:we})},De._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(we){return we.classList.contains(mr)}).forEach(function(we){return we.classList.remove(mr)})},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this).data(br);if(ze||(ze=new ke(this,"object"==typeof we&&we),x.default(this).data(br,ze)),"string"==typeof we){if(typeof ze[we]>"u")throw new TypeError('No method named "'+we+'"');ze[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Qa}}]),ke}();x.default(window).on(Ah,function(){for(var ke=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),He=ke.length;He--;){var we=x.default(ke[He]);co._jQueryInterface.call(we,we.data())}}),x.default.fn[ii]=co._jQueryInterface,x.default.fn[ii].Constructor=co,x.default.fn[ii].noConflict=function(){return x.default.fn[ii]=ah,co._jQueryInterface};var Ai="tab",Rs="bs.tab",Rl="."+Rs,Pl=x.default.fn[Ai],gl="hide"+Rl,nc="hidden"+Rl,Bc="show"+Rl,eu="shown"+Rl,hr="click"+Rl+".data-api",Ra="active",Eu=".active",ui="> li > .active",Mo=function(){function ke(He){this._element=He}var De=ke.prototype;return De.show=function(){var we=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&x.default(this._element).hasClass(Ra)||x.default(this._element).hasClass("disabled"))){var ze,Je,bt=x.default(this._element).closest(".nav, .list-group")[0],Ot=W.getSelectorFromElement(this._element);if(bt){var Wt="UL"===bt.nodeName||"OL"===bt.nodeName?ui:Eu;Je=(Je=x.default.makeArray(x.default(bt).find(Wt)))[Je.length-1]}var In=x.default.Event(gl,{relatedTarget:this._element}),Tn=x.default.Event(Bc,{relatedTarget:Je});if(Je&&x.default(Je).trigger(In),x.default(this._element).trigger(Tn),!Tn.isDefaultPrevented()&&!In.isDefaultPrevented()){Ot&&(ze=document.querySelector(Ot)),this._activate(this._element,bt);var Gn=function(){var Dr=x.default.Event(nc,{relatedTarget:we._element}),Lr=x.default.Event(eu,{relatedTarget:Je});x.default(Je).trigger(Dr),x.default(we._element).trigger(Lr)};ze?this._activate(ze,ze.parentNode,Gn):Gn()}}},De.dispose=function(){x.default.removeData(this._element,Rs),this._element=null},De._activate=function(we,ze,Je){var bt=this,Wt=(!ze||"UL"!==ze.nodeName&&"OL"!==ze.nodeName?x.default(ze).children(Eu):x.default(ze).find(ui))[0],In=Je&&Wt&&x.default(Wt).hasClass("fade"),Tn=function(){return bt._transitionComplete(we,Wt,Je)};if(Wt&&In){var Gn=W.getTransitionDurationFromElement(Wt);x.default(Wt).removeClass("show").one(W.TRANSITION_END,Tn).emulateTransitionEnd(Gn)}else Tn()},De._transitionComplete=function(we,ze,Je){if(ze){x.default(ze).removeClass(Ra);var bt=x.default(ze.parentNode).find("> .dropdown-menu .active")[0];bt&&x.default(bt).removeClass(Ra),"tab"===ze.getAttribute("role")&&ze.setAttribute("aria-selected",!1)}if(x.default(we).addClass(Ra),"tab"===we.getAttribute("role")&&we.setAttribute("aria-selected",!0),W.reflow(we),we.classList.contains("fade")&&we.classList.add("show"),we.parentNode&&x.default(we.parentNode).hasClass("dropdown-menu")){var Ot=x.default(we).closest(".dropdown")[0];if(Ot){var Wt=[].slice.call(Ot.querySelectorAll(".dropdown-toggle"));x.default(Wt).addClass(Ra)}we.setAttribute("aria-expanded",!0)}Je&&Je()},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Je=ze.data(Rs);if(Je||(Je=new ke(this),ze.data(Rs,Je)),"string"==typeof we){if(typeof Je[we]>"u")throw new TypeError('No method named "'+we+'"');Je[we]()}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),ke}();x.default(document).on(hr,'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(ke){ke.preventDefault(),Mo._jQueryInterface.call(x.default(this),"show")}),x.default.fn[Ai]=Mo._jQueryInterface,x.default.fn[Ai].Constructor=Mo,x.default.fn[Ai].noConflict=function(){return x.default.fn[Ai]=Pl,Mo._jQueryInterface};var Vn="toast",Tu="bs.toast",vl="."+Tu,rc=x.default.fn[Vn],Mu="click.dismiss"+vl,Qs="hide"+vl,gs="hidden"+vl,ga="show"+vl,ch="shown"+vl,$h="show",Rc="showing",uh={animation:"boolean",autohide:"boolean",delay:"number"},va={animation:!0,autohide:!0,delay:500},Ps=function(){function ke(He,we){this._element=He,this._config=this._getConfig(we),this._timeout=null,this._setListeners()}var De=ke.prototype;return De.show=function(){var we=this,ze=x.default.Event(ga);if(x.default(this._element).trigger(ze),!ze.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var Je=function(){we._element.classList.remove(Rc),we._element.classList.add($h),x.default(we._element).trigger(ch),we._config.autohide&&(we._timeout=setTimeout(function(){we.hide()},we._config.delay))};if(this._element.classList.remove("hide"),W.reflow(this._element),this._element.classList.add(Rc),this._config.animation){var bt=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,Je).emulateTransitionEnd(bt)}else Je()}},De.hide=function(){if(this._element.classList.contains($h)){var we=x.default.Event(Qs);x.default(this._element).trigger(we),!we.isDefaultPrevented()&&this._close()}},De.dispose=function(){this._clearTimeout(),this._element.classList.contains($h)&&this._element.classList.remove($h),x.default(this._element).off(Mu),x.default.removeData(this._element,Tu),this._element=null,this._config=null},De._getConfig=function(we){return we=G({},va,x.default(this._element).data(),"object"==typeof we&&we?we:{}),W.typeCheckConfig(Vn,we,this.constructor.DefaultType),we},De._setListeners=function(){var we=this;x.default(this._element).on(Mu,'[data-dismiss="toast"]',function(){return we.hide()})},De._close=function(){var we=this,ze=function(){we._element.classList.add("hide"),x.default(we._element).trigger(gs)};if(this._element.classList.remove($h),this._config.animation){var Je=W.getTransitionDurationFromElement(this._element);x.default(this._element).one(W.TRANSITION_END,ze).emulateTransitionEnd(Je)}else ze()},De._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},ke._jQueryInterface=function(we){return this.each(function(){var ze=x.default(this),Je=ze.data(Tu);if(Je||(Je=new ke(this,"object"==typeof we&&we),ze.data(Tu,Je)),"string"==typeof we){if(typeof Je[we]>"u")throw new TypeError('No method named "'+we+'"');Je[we](this)}})},D(ke,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"DefaultType",get:function(){return uh}},{key:"Default",get:function(){return va}}]),ke}();x.default.fn[Vn]=Ps._jQueryInterface,x.default.fn[Vn].Constructor=Ps,x.default.fn[Vn].noConflict=function(){return x.default.fn[Vn]=rc,Ps._jQueryInterface},n.Alert=Ke,n.Button=Kr,n.Carousel=To,n.Collapse=Wc,n.Dropdown=Ca,n.Modal=Th,n.Popover=Cs,n.Scrollspy=co,n.Tab=Mo,n.Toast=Ps,n.Tooltip=Ba,n.Util=W,Object.defineProperty(n,"__esModule",{value:!0})});